<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>CTFshow 菜鸡杯 | Lazzaro</title><meta name="description" content="​     https:&#x2F;&#x2F;hub.ctfer.com&#x2F; 任务：打败五大派高手的围攻，最后挑战邪恶BOSS【没技术是菜鸡】 比赛：CTFshow 菜鸡杯 (简称：鸡杯) 开始：2020&#x2F;8&#x2F;29 9:00 结束：2020&#x2F;8&#x2F;30 9:00 题目： web 杂项 密码 逆向 pwn 若干道 规则：1 比赛期间可以随意讨论，wp须在比赛结束后发布，wp统一发布地址：https:&#x2F;&#x2F;wp.ctf.sh"><meta property="og:type" content="article"><meta property="og:title" content="CTFshow 菜鸡杯"><meta property="og:url" content="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="​     https:&#x2F;&#x2F;hub.ctfer.com&#x2F; 任务：打败五大派高手的围攻，最后挑战邪恶BOSS【没技术是菜鸡】 比赛：CTFshow 菜鸡杯 (简称：鸡杯) 开始：2020&#x2F;8&#x2F;29 9:00 结束：2020&#x2F;8&#x2F;30 9:00 题目： web 杂项 密码 逆向 pwn 若干道 规则：1 比赛期间可以随意讨论，wp须在比赛结束后发布，wp统一发布地址：https:&#x2F;&#x2F;wp.ctf.sh"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829182442890.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829182543241.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829183349306.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829184303503.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829223106703.png"><meta property="article:published_time" content="2020-08-29T09:58:28.000Z"><meta property="article:modified_time" content="2020-08-30T04:35:41.960Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2020赛"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829182442890.png"><link rel="canonical" href="https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF弱鸡自进阶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">总览</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">汇总</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">类别</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">关键词</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">来留个言 👉👉👉</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">类别</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">关键词云</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020赛</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021赛</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022赛</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023赛</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024赛</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13px">2025赛</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">内网</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">反序列化</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">反编译</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">反调试</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">取证</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">后量子密码</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">命令行</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">图像</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">块密码</a> <a href="/tags/%E5%A0%86/" style="font-size:13px">堆</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">密码</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">文件上传</a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">曲线</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">栈</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">格密码</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">格式化字符串</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">注入</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">流密码</a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">流量</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">混淆</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">渗透</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">离散对数</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">算法</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">绕过</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">编码</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">自动化</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">逃逸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">隐写</a></div></div><div class="widget"><h3 class="widget-title">汇总</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">八月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">六月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%85%B3-Web%E6%B4%BE%E7%9A%84%E6%8C%91%E6%88%98"><span class="toc-number">1.</span> <span class="toc-text">第一关 Web派的挑战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%87%E5%8F%B7%E5%85%A5%E5%9B%AD"><span class="toc-number">1.1.</span> <span class="toc-text">摇号入园</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%85%B3-%E6%9D%82%E9%A1%B9%E6%B4%BE%E7%9A%84%E6%8C%91%E6%88%98"><span class="toc-number">2.</span> <span class="toc-text">第二关 杂项派的挑战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8C%8E%E5%85%94"><span class="toc-number">2.1.</span> <span class="toc-text">猎兔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A5-%E5%9C%86%E5%91%A8%E7%8E%87%E4%B9%8B%E6%AD%8C"><span class="toc-number">2.2.</span> <span class="toc-text">初音未来-圆周率之歌</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%AE%E4%B8%80%E7%82%B9"><span class="toc-number">2.3.</span> <span class="toc-text">差一点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%85%B3-CRYPTO%E6%B4%BE%E7%9A%84%E6%8C%91%E6%88%98"><span class="toc-number">3.</span> <span class="toc-text">第三关 CRYPTO派的挑战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E4%BB%AC%E4%B8%8D%E5%90%83%E8%8D%A4"><span class="toc-number">3.1.</span> <span class="toc-text">我们不吃荤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A9%E4%BB%99%E9%87%91%E4%B8%B9%E5%BF%83%E6%B3%95"><span class="toc-number">3.2.</span> <span class="toc-text">天仙金丹心法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Knapsack-My-Number-Theory-Book"><span class="toc-number">3.3.</span> <span class="toc-text">Knapsack My Number Theory Book</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%85%B3-%E9%80%86%E5%90%91%E6%B4%BE%E7%9A%84%E6%8C%91%E6%88%98"><span class="toc-number">4.</span> <span class="toc-text">第四关 逆向派的挑战</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E5%85%B3-%E8%83%96%E6%B4%BE%E7%9A%84%E6%8C%91%E6%88%98"><span class="toc-number">5.</span> <span class="toc-text">第五关 胖派的挑战</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E5%85%B3-%E6%B2%A1%E6%8A%80%E6%9C%AF%E6%98%AF%E8%8F%9C%E9%B8%A1%E5%A4%A7%E9%AD%94%E7%8E%8B"><span class="toc-number">6.</span> <span class="toc-text">第六关 没技术是菜鸡大魔王</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E8%8F%9C%E7%9A%84boss"><span class="toc-number">6.1.</span> <span class="toc-text">最菜的boss</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-CTFshow-菜鸡杯" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">CTFshow 菜鸡杯</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/" class="article-date"><time datetime="2020-08-29T09:58:28.000Z" itemprop="datePublished">2020-08-29</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2020%E8%B5%9B/" rel="tag">2020赛</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/" class="leancloud_visitors" data-flag-title="CTFshow 菜鸡杯"><span class="leancloud-visitors-count">∞</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​</p><p><a target="_blank" rel="noopener" href="https://hub.ctfer.com/">https://hub.ctfer.com/</a></p><p>任务：打败五大派高手的围攻，最后挑战邪恶BOSS【没技术是菜鸡】</p><p>比赛：CTFshow 菜鸡杯 (简称：鸡杯)</p><p>开始：2020/8/29 9:00</p><p>结束：2020/8/30 9:00</p><p>题目： web 杂项 密码 逆向 pwn 若干道</p><p>规则：<br>1 比赛期间可以随意讨论，wp须在比赛结束后发布，wp统一发布地址：<a target="_blank" rel="noopener" href="https://wp.ctf.show">https://wp.ctf.show</a><br>2 公平竞技，独立比赛<br>3 服务器不要爆破，不要攻击服务器，不要扫描!!!<br>4 奖品：rank最高的师傅获得武林神器：上古鸡杯 x 1 ，获得称号：鸡杯王</p><hr><h2 id="第一关-Web派的挑战"><a href="#第一关-Web派的挑战" class="headerlink" title="第一关 Web派的挑战"></a>第一关 Web派的挑战</h2><h3 id="摇号入园"><a href="#摇号入园" class="headerlink" title="摇号入园"></a>摇号入园</h3><blockquote><p><a target="_blank" rel="noopener" href="http://119.28.74.193:28066/">http://119.28.74.193:28066/</a></p><p>hint:后台里面找邮箱</p></blockquote><p>发现页面有报错，<code>index.php</code>含一句话马<code>eval($_POST[1]);</code></p><p>直接上蚁剑，使用密码<code>1</code>连接<code>http://119.28.74.193:28066/index.php</code>，拿到webshell，接下来找flag；</p><p>查看目录列表查看最近修改的文件未发现flag，根据修改日期，进入命令行用<code>find</code>命令按内容搜索<code>config</code>和<code>runtime</code>目录：</p><p><code>find /var/www/html/config | xargs grep &quot;flag&#123;&quot;</code></p><p><code>find /var/www/html/runtime | xargs grep &quot;flag&#123;&quot;</code></p><p>在<code>/var/www/html/rumtime/log/202008/22.log</code>中找到flag：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(www-data:/var/www/html/runtime) $ find . | xargs grep <span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line">grep: .: Is a directory</span><br><span class="line">grep: ./cache: Is a directory</span><br><span class="line">grep: ./cache/4e: Is a directory</span><br><span class="line">grep: ./temp: Is a directory</span><br><span class="line">grep: ./log: Is a directory</span><br><span class="line">grep: ./log/202008: Is a directory</span><br><span class="line">./log/202008/22.<span class="built_in">log</span>:  <span class="string">&#x27;email_password&#x27;</span> =&gt; <span class="string">&#x27;flag&#123;ctf_show_boy&#125;&#x27;</span>,</span><br><span class="line">./log/202008/22.<span class="built_in">log</span>:[ sql ] [ SQL ] UPDATE `kite_site_config`  SET `v` = <span class="string">&#x27;flag&#123;ctf_show_boy&#125;&#x27;</span>  WHERE  `site_id` = 1  AND `k` = <span class="string">&#x27;email_password&#x27;</span> [ RunTime:0.000250s ]</span><br></pre></td></tr></table></figure><p>​</p><h2 id="第二关-杂项派的挑战"><a href="#第二关-杂项派的挑战" class="headerlink" title="第二关 杂项派的挑战"></a>第二关 杂项派的挑战</h2><h3 id="猎兔"><a href="#猎兔" class="headerlink" title="猎兔"></a>猎兔</h3><blockquote><p><a target="_blank" rel="noopener" href="https://ctfshow.lanzous.com/imJj4g62dwj">https://ctfshow.lanzous.com/imJj4g62dwj</a></p><p>png文件</p><p>hint: 兔兔数列</p></blockquote><p>查看16进制发现crc值不匹配，用png图片宽高爆破脚本得到正确高度（或直接改大高度），修改得到提示：</p><p><img src="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829182442890.png" alt="image-20200829182442890"></p><p>结合hint，兔子数列即为斐波那契数列。</p><p>用zsteg查看png图有无隐写内容，发现lsb按列提取的green最低位有一串接近flag的字符串：</p><p><img src="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829182543241.png" alt="image-20200829182543241"></p><p>看到其中<code>flag&#123;</code>五个字符串分别对应着0,1,2,4,7位（反斜杠转义），差值为1,1,2,3刚好对应斐波那契数列前四项；</p><p>用stegsolve.jar取出lsb按列提取的green最低位完整字符串，存bin文件：</p><p><img src="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829183349306.png" alt="image-20200829183349306"></p><p>最后用脚本按斐波那契数列方式提取字符拼接：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="built_in">open</span>(<span class="string">&#x27;out.bin&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">t=[<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100</span>):</span><br><span class="line">	t.append(t[i-<span class="number">1</span>]+t[i-<span class="number">2</span>])</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> j&lt;<span class="built_in">len</span>(s):</span><br><span class="line">	<span class="keyword">if</span> j&gt;=<span class="built_in">len</span>(s):</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	ss+=s[j]</span><br><span class="line">	j+=t[i]</span><br><span class="line">	i+=<span class="number">1</span></span><br><span class="line">	</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>​</p><h3 id="初音未来-圆周率之歌"><a href="#初音未来-圆周率之歌" class="headerlink" title="初音未来-圆周率之歌"></a>初音未来-圆周率之歌</h3><blockquote><p><a target="_blank" rel="noopener" href="https://ctfshow.lanzous.com/iq64Jg62egj">https://ctfshow.lanzous.com/iq64Jg62egj</a></p><p>mp3文件</p><p>hint1: 歌词，看看那首歌最后</p><p>hint2: 福尔摩斯有一章说过，这种形式的密文 一般都需要一个字典。这种组合，一般表示 要么是 多少页的第多几个单词。但是因为 xxxx 比较大，一般没有这么厚的书。所以我们可以认为，他是一个灰常长的字典，然后？表示顺序截取？个字符。</p></blockquote><p>audacity查看mp3音频没什么发现，后放出两个hint，思路很明显了。</p><p>mp3文件最后内容：</p><p><img src="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829184303503.png" alt="image-20200829184303503"></p><p>歌词为10000+位 $\pi$ 的值，按照其中的<code>(a,b)</code>组合分别从歌词提取<code>a</code>位置开始<code>b</code>长度的数字，再转成字符即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#f=open(&#x27;pi.mp3&#x27;,&#x27;rb&#x27;).read()[-250:]</span></span><br><span class="line">dic=&#123;<span class="number">2750</span>:<span class="number">3</span>,<span class="number">2535</span>:<span class="number">3</span>,<span class="number">739</span>:<span class="number">2</span>,<span class="number">3487</span>:<span class="number">3</span>,<span class="number">1925</span>:<span class="number">3</span>,<span class="number">451</span>:<span class="number">2</span>,<span class="number">898</span>:<span class="number">2</span>,<span class="number">1479</span>:<span class="number">2</span>,<span class="number">1623</span>:<span class="number">2</span>,<span class="number">1541</span>:<span class="number">2</span>,<span class="number">1232</span>:<span class="number">2</span>,<span class="number">1118</span>:<span class="number">2</span>,<span class="number">1780</span>:<span class="number">2</span>,<span class="number">594</span>:<span class="number">2</span>,<span class="number">2033</span>:<span class="number">2</span>,<span class="number">79</span>:<span class="number">2</span>,<span class="number">1193</span>:<span class="number">2</span>,<span class="number">406</span>:<span class="number">2</span>,<span class="number">1623</span>:<span class="number">2</span>,<span class="number">774</span>:<span class="number">2</span>,<span class="number">1223</span>:<span class="number">2</span>,<span class="number">1351</span>:<span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196442881097566593344612847564823378678316527120190914564856692346034861045432664821339360726024914127372458700660631558817488152092096282925409171536436789259036001133053054882046652138414695194151160943305727036575959195309218611738193261179310511854807446237996274956735188575272489122793818301194912983367336244065664308602139494639522473719070217986094370277053921717629317675238467481846766940513200056812714526356082778577134275778960917363717872146844090122495343014654958537105079227968925892354201995611212902196086403441815981362977477130996051870721134999999837297804995105973173281609631859502445945534690830264252230825334468503526193118817101000313783875288658753320838142061717766914730359825349042875546873115956286388235378759375195778185778053217122680661300192787661119590921642019893809525720106548586327886593615338182796823030195203530185296899577362259941389124972177528347913151557485724245415069595082953311686172785588907509838175463746493931925506040092770167113900984882401285836160356370766010471018194295559619894676783744944825537977472684710404753464620804668425906949129331367702898915210475216205696602405803815019351125338243003558764024749647326391419927260426992279678235478163600934172164121992458631503028618297455570674983850549458858692699569092721079750930295532116534498720275596023648066549911988183479775356636980742654252786255181841757467289097777279380008164706001614524919217321721477235014144197356854816136115735255213347574184946843852332390739414333454776241686251898356948556209921922218427255025425688767179049460165346680498862723279178608578438382796797668145410095388378636095068006422512520511739298489608412848862694560424196528502221066118630674427862203919494504712371378696095636437191728746776465757396241389086583264599581339047802759009946576407895126946839835259570982582262052248940772671947826848260147699090264013639443745530506820349625245174939965143142980919065925093722169646151570985838741059788595977297549893016175392846813826868386894277415599185592524595395943104997252468084598727364469584865383673622262609912460805124388439045124413654976278079771569143599770012961608944169486855584840635342207222582848864815845602850601684273945226746767889525213852254995466672782398645659611635488623057745649803559363456817432411251507606947945109659609402522887971089314566913686722874894056010150330861792868092087476091782493858900971490967598526136554978189312978482168299894872265880485756401427047755513237964145152374623436454285844479526586782105114135473573952311342716610213596953623144295248493718711014576540359027993440374200731057853906219838744780847848968332144571386875194350643021845319104848100537061468067491927819119793995206141966342875444064374512371819217999839101591956181467514269123974894090718649423196156794520809514655022523160388193014209376213785595663893778708303906979207734672217256259966150142150306803844773454920260541466592520149744285073251866600213243408819071048633173464965145390579626856100550810665879699816357473638405257145910289706414011097120628043903975951567715770042033786993600723055876317635942187312514712053292819182618612586732157919841484882916447060957527069572209175671167229109816909152801735067127485832228718352093539657251210835791513698820914442100675103346711031412671113699086585163983150197016515116851714376576183515565088490998985998238734552833163550764791853589322618548963213293308985706420467525907091548141654985946163718027098199430992448895757128289059232332609729971208443357326548938239119325974636673058360414281388303203824903758985243744170291327656180937734440307074692112019130203303801976211011004492932151608424448596376698389522868478312355265821314495768572624334418930396864262434107732269780280731891544110104468232527162010526522721116603966655730925471105578537634668206531098965269186205647693125705863566201855810072936065987648611791045334885034611365768675324944166803962657978771855608455296541266540853061434443185867697514566140680070023787765913440171274947042056223053899456131407112700040785473326993908145466464588079727082668306343285878569830523580893306575740679545716377525420211495576158140025012622859413021647155097925923099079654737612551765675135751782966645477917450112996148903046399471329621073404375189573596145890193897131117904297828564750320319869151402870808599048010941214722131794764777262241425485454033215718530614228813758504306332175182979866223717215916077166925474873898665494945011465406284336639379003976926567214638530673609657120918076383271664162748888007869256029022847210403172118608204190004229661711963779213375751149595015660496318629472654736425230817703675159067350235072835405670403867435136222247715891504953098444893330963408780769325993978054193414473774418426312986080998886874132604721569516239658645730216315981931951673538129741677294786724229246543668009806769282382806899640048243540370141631496589794092432378969070697794223625082216889573837986230015937764716512289357860158816175578297352334460428151262720373431465319777741603199066554187639792933441952154134189948544473456738316249934191318148092777710386387734317720754565453220777092120190516609628049092636019759882816133231666365286193266863360627356763035447762803504507772355471058595487027908143562401451718062464362679456127531813407833033625423278394497538243720583531147711992606381334677687969597030983391307710987040859133746414428227726346594704745878477872019277152807317679077071572134447306057007334924369311383504931631284042512192565179806941135280131470130478164378851852909285452011658393419656213491434159562586586557055269049652098580338507224264829397285847831630577775606888764462482468579260395352773480304802900587607582510474709164396136267604492562742042083208566119062545433721315359584506877246029016187667952406163425225771954291629919306455377991403734043287526288896399587947572917464263574552540790914513571113694109119393251910760208252026187985318877058429725916778131496990090192116971737278476847268608490033770242429165130050051683233643503895170298939223345172201381280696501178440874519601212285993716231301711444846409038906449544400619869075485160263275052983491874078668088183385102283345085048608250393021332197155184306354550076682829493041377655279397517546139539846833936383047461199665385815384205685338621867252334028308711232827892125077126294632295639898989358211674562701021835646220134967151881909730381198004973407239610368540664319395097901906996395524530054505806855019567302292191393391856803449039820595510022635353619204199474553859381023439554495977837790237421617271117236434354394782218185286240851400666044332588856986705431547069657474585503323233421073015459405165537906866273337995851156257843229882737231989875714159578111963583300594087306812160287649628674460477464915995054973742562690104903778198683593814657412680492564879855614537234786733039046883834363465537949864192705638729317487233208376011230299113679386270894387993620162951541337142489283072201269014754668476535761647737946752004907571555278196536213239264061601363581559074220202031872776052772190055614842555187925303435139844253223415762336106425063904975008656271095359194658975141310348227693062474353632569160781547818115284366795706110861533150445212747392454494542368288606134084148637767009612071512491404302725386076482363414334623518975766452164137679690314950191085759844239198629164219399490723623464684411739403265918404437805133389452574239950829659122850855582157250310712570126683024029295252201187267675622041542051618416348475651699981161410100299607838690929160302884002691041407928862150784245167090870006992821206604183718065355672525325675328612910424877618258297651579598470356222629348600341587229805349896502262917487882027342092222453398562647669149055628425039127577102840279980663658254889264880254566101729670266407655904290994568150652653053718294127033693137851786090407086671149655834343476933857817113864558736781230145876871266034891390956200993936103102916161528813843790990423174733639480457593149314052976347574811935670911013775172100803155902485309066920376719220332290943346768514221447737939375170344366199104033751117354719185504644902636551281622882446257591633303910722538374218214088350865739177150968288747826569959957449066175834413752239709683408005355984917541738188399944697486762655165827658483588453142775687900290951702835297163445621296404352311760066510124120065975585127617858382920419748442360800719304576189323492292796501987518721272675079812554709589045563579212210333466974992356302549478024901141952123828153091140790738602515227429958180724716259166854513331239480494707911915326734302824418604142636395480004480026704962482017928964766975831832713142517029692348896276684403232609275249603579964692565049368183609003238092934595889706953653494060340216654437558900456328822505452556405644824651518754711962184439658253375438856909411303150952617937800297412076651479394259029896959469955657612186561967337862362561252163208628692221032748892186543648022967807057656151446320469279068212073883778142335628236089632080682224680122482611771858963814091839036736722208883215137556003727983940041529700287830766709444745601345564172543709069793961225714298946715435784687886144458123145935719849225284716050492212424701412147805734551050080190869960330276347870810817545011930714122339086639383395294257869050764310063835198343893415961318543475464955697810382930971646514384070070736041123735998434522516105070270562352660127648483084076118301305279320542746286540360367453286510570658748822569815793678976697422057505968344086973502014102067235850200724522563265134105592401902742162484391403599895353945909440704691209140938700126456001623742880210927645793106579229552498872758461012648369998922569596881592056001016552563756785667227966198857827948488558343975187445455129656344348039664205579829368043522027709842942325330225763418070394769941597915945300697521482933665556615678736400536665641654732170439035213295435291694145990416087532018683793702348886894791&#x27;</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> dic.items():</span><br><span class="line">	flag+=<span class="built_in">chr</span>(<span class="built_in">int</span>(s[k:k+v]))</span><br><span class="line">	</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>​</p><h3 id="差一点"><a href="#差一点" class="headerlink" title="差一点"></a>差一点</h3><blockquote><p><a target="_blank" rel="noopener" href="https://ctfshow.lanzous.com/iNbACg62edg">https://ctfshow.lanzous.com/iNbACg62edg</a></p><p>It’s so easy,you can trytrysee.</p></blockquote><p>JSFUCK编码，去掉最后的<code>()</code>，在浏览器Console中运行得flag。</p><p>​</p><h2 id="第三关-CRYPTO派的挑战"><a href="#第三关-CRYPTO派的挑战" class="headerlink" title="第三关 CRYPTO派的挑战"></a>第三关 CRYPTO派的挑战</h2><h3 id="我们不吃荤"><a href="#我们不吃荤" class="headerlink" title="我们不吃荤"></a>我们不吃荤</h3><blockquote><p><a target="_blank" rel="noopener" href="https://hub.ctfer.com/file/crypto1.zip">https://hub.ctfer.com/file/crypto1.zip</a></p><p>只有二进制的世界是不是有些无聊</p></blockquote><p>查看文件，只有0,1,2三种数字，猜测为3进制，转换为16进制后，出现多个3X模式的子串，猜测转为字符；转换后又有0,1,2,3,4四中数字，猜测为5进制，转换为16进制后，又出现多个3X模式的子串……</p><p>不断尝试发现规律，需要转换的进制均为素数进制（不吃荤？）。中间需要不断尝试输出结果以确定进制数，注意<code>int()</code>函数的第二参数仅支持36及以下数值的转换，大于36的情况需要自行实现进制转换函数<code>change()</code>。脚本解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="built_in">open</span>(<span class="string">&#x27;c.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">3</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">5</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">7</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">11</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">13</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">17</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">19</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">23</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">29</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">31</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line"><span class="comment">#int不支持k&gt;36</span></span><br><span class="line">dic=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">	dic[<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)+i)]=i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">	dic[<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)+i)]=i+<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">	dic[<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)+i)]=i+<span class="number">10</span>+<span class="number">26</span></span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">s,k</span>):</span><br><span class="line">	j=<span class="number">0</span></span><br><span class="line">	res=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">		res+=dic[s[<span class="built_in">len</span>(s)-i-<span class="number">1</span>]]*<span class="built_in">pow</span>(k,j)</span><br><span class="line">		j+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">	</span><br><span class="line">s=change(s,<span class="number">37</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=change(s,<span class="number">41</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=change(s,<span class="number">43</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=change(s,<span class="number">47</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=change(s,<span class="number">53</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=change(s,<span class="number">59</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line">s=change(s,<span class="number">61</span>)</span><br><span class="line">s=<span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(s).decode()</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag</span></span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure><p>​</p><h3 id="天仙金丹心法"><a href="#天仙金丹心法" class="headerlink" title="天仙金丹心法"></a>天仙金丹心法</h3><blockquote><p><a target="_blank" rel="noopener" href="https://hub.ctfer.com/file/crypto2.zip">https://hub.ctfer.com/file/crypto2.zip</a></p><p>道在屎溺</p><p>○ 须要：次想把常面知本用都部道文哈是用已本连希无来比净题续即用凑如妙道密进可的字真法在海码行：○ 数灭自屎凡器只三后全而神然溺鼎归心</p></blockquote><p>查询知此为中文栅栏解密，且每一栏递增，还原：</p><p><img src="/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/image-20200829223106703.png" alt="image-20200829223106703"></p><p>竖着读，用常见md5计算三次即为flag。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">open</span>(<span class="string">&#x27;题目.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">s=md5(s).hexdigest()</span><br><span class="line">s=md5(s.encode()).hexdigest()</span><br><span class="line">s=md5(s.encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>).write(s)</span><br></pre></td></tr></table></figure><p>​</p><h3 id="Knapsack-My-Number-Theory-Book"><a href="#Knapsack-My-Number-Theory-Book" class="headerlink" title="Knapsack My Number Theory Book"></a>Knapsack My Number Theory Book</h3><blockquote><p><a target="_blank" rel="noopener" href="https://hub.ctfer.com/file/crypto3.zip">https://hub.ctfer.com/file/crypto3.zip</a></p><p>hint1: 1112222333333 mod (10^7)=2333333<br>hint2: Knapsack Cryptosystem</p></blockquote><p>有机会参与Crypto的压轴题出题~~ 不过好像没有人碰= =</p><p>其实这题是一个数论题与背包加密系统的套娃题。</p><p>源代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> dump</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> SystemRandom</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">random = SystemRandom()</span><br><span class="line"></span><br><span class="line">k, n, d = <span class="number">15</span>, <span class="number">40</span>, <span class="number">0.4</span></span><br><span class="line"></span><br><span class="line">B = <span class="number">2</span>**(n//d)</span><br><span class="line">A = [random.randint(<span class="number">1</span>, B) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">s = <span class="built_in">sum</span>(A[index] <span class="keyword">for</span> index <span class="keyword">in</span> random.sample(<span class="built_in">range</span>(n), k))</span><br><span class="line">part = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">int</span>.from_bytes(<span class="built_in">str</span>(s).encode(), byteorder=<span class="string">&#x27;little&#x27;</span>) &lt;&lt; <span class="number">10000</span>)[-<span class="number">175</span>:])</span><br><span class="line"></span><br><span class="line">dump((A,part), <span class="built_in">open</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;w&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(part)</span><br><span class="line"></span><br><span class="line">inp = <span class="built_in">input</span>(<span class="string">&quot;Please input the solution (0, 1, 0, 1, ...): &quot;</span>)</span><br><span class="line">sol = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> inp.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">sum</span>(i == <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> sol) == k</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(sol) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(i == <span class="number">0</span> <span class="keyword">or</span> i == <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> sol)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">sum</span>(x*a <span class="keyword">for</span> x, a <span class="keyword">in</span> <span class="built_in">zip</span>(sol, A)) == s:</span><br><span class="line">	m = md5(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span>  sol).encode()).hexdigest()</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;TQL!! flag is <span class="subst">&#123;m.join([<span class="string">&#x27;flag&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>])&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>外层是 $n=40,k=15,d=0.4$ 的<a href="https://lazzzaro.github.io/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/#Merkle-Hellman%E8%83%8C%E5%8C%85%E5%8A%A0%E5%AF%86%EF%BC%88Knapsack%EF%BC%89">背包密码系统</a>，即40维子集和问题，解向量重量为15，背包密度为0.4（40长度的<code>01</code>解向量数组中含15个<code>1</code>）；</p><p>内层是需要一点数论知识才能从<code>part</code>求解出的<code>s</code>，即子集和的值；</p><p>求解出<code>01</code>解向量组成的字符串md5哈希值即为flag。</p><ul><li><p><strong>内层</strong></p><blockquote><p><code>int.from_bytes(bytes, byteorder, *, signed=False)</code></p><p>可实现不固定长度的bytes类型数据转int类型数据，<code>byteorder</code>标志小字节顺序还是大字节顺序</p></blockquote><p>根据<code>part</code>值还原<code>s</code>值，其中<code>byteorder=&#39;little&#39;</code>代表小端序（反序），假设 $t$ 为 $s$ 反序字符串对应的int值，$p$ 为<code>part</code>值，根据已知关系有：</p><p><code>t</code>左移10000位后后175位值为<code>part</code>。</p><p>因 $a&lt;&lt;b \Rightarrow a\cdot 2^b$ ，故 $t&lt;&lt;10000 \Rightarrow t\cdot 2^{10000}$，又 $t\cdot 2^{10000}$ 以 175位的 $p$ 结尾，即：</p><p>$p = (t\cdot 2^{10000}) \bmod (10^{175})$</p><p>但此时不能直接应用模逆运算计算出 $t$ ，因为 $\gcd(2^{10000},10^{175}) \neq 1$；</p><p>做一下转换：</p><p>$p \equiv (t\cdot 2^{10000}) \pmod {10^{175}} \ \Rightarrow t\cdot 2^{10000}=x\cdot 10^{175}+p$</p><p>分解 $p$ 发现：</p><p>$p=2^{176} \cdot 3 \cdot 43973 \cdot 69653 \cdot 6642192645148709014118321101167435034612406484841133642520224597359790421504311588434603251039359463852561066413$</p><p>设 $y=\cfrac{p}{2^{175}}$，则</p><p>$t\cdot 2^{10000}=x\cdot 10^{175}+2^{175}\cdot y \ \Rightarrow t\cdot 2^{9825}=x\cdot 5^{175}+ y \ \Rightarrow y \equiv t \cdot 2^{9825} \pmod {5^{175}} \ \Rightarrow y \cdot (2^{9825})^{-1} \equiv t \pmod {5^{175}}$</p><p>通过求模逆可还原 $t$ ，再还原出 $s$。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">pow</span>(<span class="number">5</span>,<span class="number">175</span>)</span><br><span class="line">p = <span class="number">5845718273413614238047854434058144506973237928951593664100212455023083304425941087047510727554535833686148194478724602632928856425119454505382766186798132132909079456410238976</span></span><br><span class="line"></span><br><span class="line">y = p // <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">175</span>)</span><br><span class="line">k = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">9825</span>, n)</span><br><span class="line">kinv = <span class="built_in">int</span>(invert(k, n))</span><br><span class="line">t = (y * kinv) % n</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment">#t=int.from_bytes(str(s).encode(), byteorder=&#x27;little&#x27;)</span></span><br><span class="line"></span><br><span class="line">s = <span class="built_in">int</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(t)[<span class="number">2</span>:])[::-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment">#sum</span></span><br></pre></td></tr></table></figure></li><li><p><strong>外层</strong></p><p>小规模的背包密码系统，可以直接用常见LLL算法攻击，参考：</p><p><a target="_blank" rel="noopener" href="https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/knapsack/knapsack-zh/">https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/knapsack/knapsack-zh/</a></p><p>Sage脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="comment"># open the public key and strip the spaces so we have a decent array</span></span><br><span class="line">pubKey = [<span class="number">291261609902039997017727282042</span>, <span class="number">323900844596016068072642445649</span>, <span class="number">266988452026099177894210813748</span>, <span class="number">408729576966214254532209048947</span>, <span class="number">437048374902001262457529358416</span>, <span class="number">45441859606116873131092743344</span>, <span class="number">51312372228432799205402860932</span>, <span class="number">446894113383896613780223791057</span>, <span class="number">387275979896657368942582580348</span>, <span class="number">106191812735537081768832792472</span>, <span class="number">314442025322217482482346876963</span>, <span class="number">458938676660836185669115411856</span>, <span class="number">624514817837775109409742774239</span>, <span class="number">223466848034665041761802574065</span>, <span class="number">317380931967330048573366834100</span>, <span class="number">305525458686341075758884485721</span>, <span class="number">477363540414430757340867483621</span>, <span class="number">538724147876064506850294590869</span>, <span class="number">147986153711350097748394541291</span>, <span class="number">237604431565908226570207609923</span>, <span class="number">168061497374145289079315904395</span>, <span class="number">226257393036905506618868519191</span>, <span class="number">606131084939410793557726750445</span>, <span class="number">229847073637282132507525425264</span>, <span class="number">189589107972678036785075475201</span>, <span class="number">258811229764745601613575317649</span>, <span class="number">188968262675983804863009858052</span>, <span class="number">594623692847436704500625622597</span>, <span class="number">494291994428984378953385211372</span>, <span class="number">602493249658184503910046469358</span>, <span class="number">196950288482747513670119067849</span>, <span class="number">300975486828861896159703499663</span>, <span class="number">606100573531309594132334686576</span>, <span class="number">330763266814750730387569732411</span>, <span class="number">169247067050997623804446808122</span>, <span class="number">488060887558585221461996453780</span>, <span class="number">235957723689777110563629411239</span>, <span class="number">617280674032071480762572507845</span>, <span class="number">1187994588804681817349174099</span>, <span class="number">286948311141611416450158085330</span>]</span><br><span class="line">nbit = <span class="built_in">len</span>(pubKey)</span><br><span class="line"><span class="comment"># open the encoded message</span></span><br><span class="line">encoded = <span class="number">4823023867810203947898718813977</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;start&quot;</span>)</span><br><span class="line"><span class="comment"># create a large matrix of 0&#x27;s (dimensions are public key length +1)</span></span><br><span class="line">A = Matrix(ZZ, nbit + <span class="number">1</span>, nbit + <span class="number">1</span>)</span><br><span class="line"><span class="comment"># fill in the identity matrix</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">    A[i, i] = <span class="number">1</span></span><br><span class="line"><span class="comment"># replace the bottom row with your public key</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">    A[i, nbit] = pubKey[i]</span><br><span class="line"><span class="comment"># last element is the encoded message</span></span><br><span class="line">A[nbit, nbit] = -<span class="built_in">int</span>(encoded)</span><br><span class="line"></span><br><span class="line">res = A.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, nbit + <span class="number">1</span>):</span><br><span class="line">    <span class="comment"># print solution</span></span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(i, M)</span><br><span class="line">        M = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> M)</span><br><span class="line">        <span class="comment"># remove the last bit</span></span><br><span class="line">        M = M[:-<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> M]))</span><br></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="第四关-逆向派的挑战"><a href="#第四关-逆向派的挑战" class="headerlink" title="第四关 逆向派的挑战"></a>第四关 逆向派的挑战</h2><h2 id="第五关-胖派的挑战"><a href="#第五关-胖派的挑战" class="headerlink" title="第五关 胖派的挑战"></a>第五关 胖派的挑战</h2><p>弱鸡略过Hard Re+PWN~</p><p>​</p><h2 id="第六关-没技术是菜鸡大魔王"><a href="#第六关-没技术是菜鸡大魔王" class="headerlink" title="第六关 没技术是菜鸡大魔王"></a>第六关 没技术是菜鸡大魔王</h2><h3 id="最菜的boss"><a href="#最菜的boss" class="headerlink" title="最菜的boss"></a>最菜的boss</h3><blockquote><p><a target="_blank" rel="noopener" href="https://hub.ctfer.com/file/boss.zip">https://hub.ctfer.com/file/boss.zip</a></p><p>菜鸡中的战斗机</p></blockquote><p>源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wmi</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;N&#x27;</span>]: </span><br><span class="line">	wmi.WMI(namespace=<span class="string">&#x27;root\WMI&#x27;</span>).WmiMonitorBrightnessMethods()[<span class="number">0</span>].WmiSetBrightness(Brightness=<span class="built_in">ord</span>(i), Timeout=<span class="number">500</span>)</span><br><span class="line">	time.sleep(char(<span class="string">&#x27;!&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#菜鸡中的BOSS，简称菜包丝</span></span><br></pre></td></tr></table></figure><p>无需知道wmi包及其函数（设置LCD背光亮度）的含义，<code>N</code>和<code>B</code>两字符替换为<code>0</code>和<code>1</code>，转16进制再转字符，简单粗暴。</p></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2020/09/01/other-CTFshow%E4%BE%9B%E9%A2%98-unusualrsa%E7%B3%BB%E5%88%97/" title="CTFshow供题 unusualrsa系列"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2020/08/27/match-2020%E9%A6%96%E5%B1%8A%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AF%E5%9B%BD%E9%99%85%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/" title="2020首届钓鱼城杯国际网络安全创新大赛"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>这篇文章对你有用，赏一杯咖啡☕~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开微信扫一扫即可扫码打赏他一波哦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开支付宝扫一扫即可扫码打赏他一波哦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> 微信支付</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> 支付宝</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>总访问 - <span id="busuanzi_value_site_pv"></span>次</span><br><span>访客数 - <span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"类别",TAGS:"关键词",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"来来来说点啥~~\r\n对你有用？赏一波！↘↘",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* 复制并使用代码请注明引用出处哦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})})</script></body></html>