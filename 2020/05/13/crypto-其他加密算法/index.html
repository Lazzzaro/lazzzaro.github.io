<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>å…¶ä»–åŠ å¯†ç®—æ³• | Lazzaro</title><meta name="description" content="â€‹     GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†Goldwasser-Micali (GM) åŠ å¯†æ–¹æ¡ˆæ˜¯ç¬¬ä¸€ä¸ªè¯æ˜ä¸º CPA å®‰å…¨çš„å…¬é’¥åŠ å¯†æ–¹æ¡ˆï¼Œå…¶å®‰å…¨æ€§ä¾èµ–äºä»åˆæ•°æ¨¡çš„äºŒæ¬¡éå‰©ä½™ä¸­åŒºåˆ†äºŒæ¬¡å‰©ä½™å›°éš¾æ€§å‡è®¾ã€‚  å¯†é’¥ç”Ÿæˆ ç”¨æˆ·éšæœºç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•° $p$ å’Œ $q$ï¼Œè®¡ç®— $n&#x3D;pq$ï¼Œ$z$ æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡éå‰©ä½™ä¸­çš„éšæœºæ•°ã€‚ç³»ç»Ÿå…¬é’¥ $pk&#x3D;(n,z)$ï¼Œç³»ç»Ÿç§é’¥ $sk&#x3D;(p,"><meta property="og:type" content="article"><meta property="og:title" content="å…¶ä»–åŠ å¯†ç®—æ³•"><meta property="og:url" content="https://lazzzaro.github.io/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="â€‹     GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†Goldwasser-Micali (GM) åŠ å¯†æ–¹æ¡ˆæ˜¯ç¬¬ä¸€ä¸ªè¯æ˜ä¸º CPA å®‰å…¨çš„å…¬é’¥åŠ å¯†æ–¹æ¡ˆï¼Œå…¶å®‰å…¨æ€§ä¾èµ–äºä»åˆæ•°æ¨¡çš„äºŒæ¬¡éå‰©ä½™ä¸­åŒºåˆ†äºŒæ¬¡å‰©ä½™å›°éš¾æ€§å‡è®¾ã€‚  å¯†é’¥ç”Ÿæˆ ç”¨æˆ·éšæœºç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•° $p$ å’Œ $q$ï¼Œè®¡ç®— $n&#x3D;pq$ï¼Œ$z$ æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡éå‰©ä½™ä¸­çš„éšæœºæ•°ã€‚ç³»ç»Ÿå…¬é’¥ $pk&#x3D;(n,z)$ï¼Œç³»ç»Ÿç§é’¥ $sk&#x3D;(p,"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-05-13T12:21:19.000Z"><meta property="article:modified_time" content="2025-07-30T11:14:37.770Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="ç®—æ³•"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://lazzzaro.github.io/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTFå¼±é¸¡è‡ªè¿›é˜¶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="æœç´¢"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">æ€»è§ˆ</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">æ±‡æ€»</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">ç±»åˆ«</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">å…³é”®è¯</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">æ¥ç•™ä¸ªè¨€ ğŸ‘‰ğŸ‘‰ğŸ‘‰</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">ç±»åˆ«</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">51</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">å…³é”®è¯äº‘</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020èµ›</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021èµ›</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022èµ›</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023èµ›</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024èµ›</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13.14px">2025èµ›</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">å†…ç½‘</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">ååºåˆ—åŒ–</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">åç¼–è¯‘</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">åè°ƒè¯•</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">å–è¯</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">åé‡å­å¯†ç </a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">å‘½ä»¤è¡Œ</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">å›¾åƒ</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">å—å¯†ç </a> <a href="/tags/%E5%A0%86/" style="font-size:13px">å †</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">å¯†ç </a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">ææƒ</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">æ–‡ä»¶ä¸Šä¼ </a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">æ›²çº¿</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">æ ˆ</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">æ ¼å¯†ç </a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">æ ¼å¼åŒ–å­—ç¬¦ä¸²</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">æ³¨å…¥</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">æµå¯†ç </a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">æµé‡</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">æ··æ·†</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">æ¸—é€</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">ç¦»æ•£å¯¹æ•°</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">ç®—æ³•</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">ç»•è¿‡</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">ç¼–ç </a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">è„šæœ¬</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">è‡ªåŠ¨åŒ–</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">é€ƒé€¸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">éšå†™</a></div></div><div class="widget"><h3 class="widget-title">æ±‡æ€»</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">åæœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">å…«æœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">å…­æœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">åäºŒæœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">åä¸€æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">ä¸‰æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">åä¸€æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">ä¹æœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">äº”æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">äºŒæœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">ä¸€æœˆ 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">åäºŒæœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">åä¸€æœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">ä¹æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">ä¸ƒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">å…­æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">äº”æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">äºŒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">ä¸€æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">åäºŒæœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">åä¸€æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">åæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">ä¹æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">å…«æœˆ 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">å…­æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">äº”æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">å››æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">ä¸‰æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">äºŒæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">ä¸€æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">åäºŒæœˆ 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">åä¸€æœˆ 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">åæœˆ 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">ä¹æœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">å…«æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">ä¸ƒæœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">å…­æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#GM%EF%BC%88Goldwasser-Micali%EF%BC%89%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86"><span class="toc-number">1.</span> <span class="toc-text">GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ElGamal%E5%8A%A0%E5%AF%86"><span class="toc-number">2.</span> <span class="toc-text">ElGamalåŠ å¯†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Paillier%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86"><span class="toc-number">3.</span> <span class="toc-text">PaillieråŒæ€åŠ å¯†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Merkle-Hellman%E8%83%8C%E5%8C%85%E5%8A%A0%E5%AF%86%EF%BC%88Knapsack%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">Merkle-HellmanèƒŒåŒ…åŠ å¯†ï¼ˆKnapsackï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%84%E8%A7%A3%E5%AF%86"><span class="toc-number">4.1.</span> <span class="toc-text">å¸¸è§„è§£å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%84%E9%9C%B2%E9%83%A8%E5%88%86%E6%98%8E%E6%96%87%E7%A9%BA%E9%97%B4%E7%9A%84%E9%99%8D%E7%BB%B4%E5%A4%84%E7%90%86"><span class="toc-number">4.2.</span> <span class="toc-text">æ³„éœ²éƒ¨åˆ†æ˜æ–‡ç©ºé—´çš„é™ç»´å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E9%9B%86%E5%90%88%E9%97%AE%E9%A2%98-%E8%BD%AC%E5%8C%96%E4%B8%BA-%E6%B1%82%E8%A7%A3SVP-CVP-Lattice-Reduction-Algorithm"><span class="toc-number">4.3.</span> <span class="toc-text">å­é›†åˆé—®é¢˜ è½¬åŒ–ä¸º æ±‚è§£SVP&#x2F;CVP+Lattice Reduction Algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Benaloh%E5%8A%A0%E5%AF%86"><span class="toc-number">5.</span> <span class="toc-text">BenalohåŠ å¯†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LUC-RSA%E5%8A%A0%E5%AF%86"><span class="toc-number">6.</span> <span class="toc-text">LUC-RSAåŠ å¯†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DSA%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="toc-number">7.</span> <span class="toc-text">DSAæ•°å­—ç­¾å</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Elgamal%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="toc-number">8.</span> <span class="toc-text">Elgamalæ•°å­—ç­¾å</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shamir%E5%AF%86%E9%92%A5%E5%88%86%E4%BA%AB%E7%AE%97%E6%B3%95"><span class="toc-number">9.</span> <span class="toc-text">Shamirå¯†é’¥åˆ†äº«ç®—æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Okamoto-Uchiyama%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F"><span class="toc-number">10.</span> <span class="toc-text">Okamoto-Uchiyamaå¯†ç ç³»ç»Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Schmidt-Samoa%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F"><span class="toc-number">11.</span> <span class="toc-text">Schmidt-Samoaå¯†ç ç³»ç»Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F"><span class="toc-number">12.</span> <span class="toc-text">å¤šé¡¹å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%B0%8F%E5%A4%9A%E9%A1%B9%E5%BC%8F"><span class="toc-number">12.1.</span> <span class="toc-text">æå°å¤šé¡¹å¼</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-crypto-å…¶ä»–åŠ å¯†ç®—æ³•" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">å…¶ä»–åŠ å¯†ç®—æ³•</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" class="article-date"><time datetime="2020-05-13T12:21:19.000Z" itemprop="datePublished">2020-05-13</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/crypto/">crypto</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" class="leancloud_visitors" data-flag-title="å…¶ä»–åŠ å¯†ç®—æ³•"><span class="leancloud-visitors-count">âˆ</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/#comments" class="article-comment-link">è¯„è®º</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>â€‹</p><h2 id="GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†"><a href="#GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†" class="headerlink" title="GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†"></a>GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†</h2><p>Goldwasser-Micali (GM) åŠ å¯†æ–¹æ¡ˆæ˜¯ç¬¬ä¸€ä¸ªè¯æ˜ä¸º CPA å®‰å…¨çš„å…¬é’¥åŠ å¯†æ–¹æ¡ˆï¼Œå…¶å®‰å…¨æ€§ä¾èµ–äºä»åˆæ•°æ¨¡çš„äºŒæ¬¡éå‰©ä½™ä¸­åŒºåˆ†äºŒæ¬¡å‰©ä½™å›°éš¾æ€§å‡è®¾ã€‚</p><ul><li><p><strong>å¯†é’¥ç”Ÿæˆ</strong></p><p>ç”¨æˆ·éšæœºç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•° $p$ å’Œ $q$ï¼Œè®¡ç®— $n=pq$ï¼Œ$z$ æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡éå‰©ä½™ä¸­çš„éšæœºæ•°ã€‚ç³»ç»Ÿå…¬é’¥ $pk=(n,z)$ï¼Œç³»ç»Ÿç§é’¥ $sk=(p,q)$ã€‚</p></li><li><p><strong>åŠ å¯†</strong></p><p>æ˜æ–‡ç©ºé—´æ˜¯ $\{0,1\}$ï¼Œå¯¹äºæ˜æ–‡ $x\in\{0,1\}$ï¼ŒåŠ å¯†æ–¹é€‰å–ç§˜å¯†éšæœºæ•° $r\in Z_n^{*}$ï¼Œåˆ©ç”¨ç³»ç»Ÿå…¬é’¥ $pk$ è®¡ç®—å¯†æ–‡$E(x)=r^2z^x\bmod n$ã€‚</p></li><li><p><strong>è§£å¯†</strong></p><p>å¯¹äºå¯†æ–‡ $E(x)$ï¼Œåˆ¤æ–­ $E(x)$ æ˜¯å¦ä¸ºæ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™ï¼Œè‹¥ $E(x)$ æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™ï¼Œåˆ™æ˜æ–‡ $D(E(x))=0$ï¼› è‹¥ $E(x)$ ä¸æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™ï¼Œåˆ™ $D(E(x))=1$ã€‚</p></li></ul><p>GMåŠ å¯†ç³»ç»Ÿçš„å®‰å…¨æ€§æ˜¯åŸºäºæ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™é—®é¢˜ã€‚å¯¹äºç§é’¥çš„æ‹¥æœ‰è€…ï¼ŒçŸ¥é“å¤§æ•´æ•° $n$ çš„å› å­åˆ†è§£ï¼Œæ±‚è§£æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™é—®é¢˜æ˜¯å®¹æ˜“çš„ï¼›è€Œå¯¹äºæ”»å‡»è€…ï¼Œæ— æ³•è·çŸ¥ $n$ çš„å› å­åˆ†è§£ï¼Œæ±‚è§£æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™é—®é¢˜æ˜¯å›°éš¾çš„ï¼Œç»§è€Œä¿è¯äº†è¯¥åŠ å¯†æ–¹æ¡ˆçš„å®‰å…¨æ€§ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	n = <span class="built_in">int</span>(f.readline())</span><br><span class="line">	<span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">		cipher = <span class="built_in">int</span>(line)</span><br><span class="line">		<span class="keyword">if</span> gmpy2.jacobi(cipher,n) == -<span class="number">1</span>:</span><br><span class="line">			plaintext += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			plaintext += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">		<span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(plaintext,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="ElGamalåŠ å¯†"><a href="#ElGamalåŠ å¯†" class="headerlink" title="ElGamalåŠ å¯†"></a>ElGamalåŠ å¯†</h2><p>ElGamalåŠ å¯†ç®—æ³•æ˜¯ä¸€ä¸ªåŸºäºè¿ªè²-èµ«å°”æ›¼å¯†é’¥äº¤æ¢çš„éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚å®ƒåœ¨1985å¹´ç”±å¡”å¸Œå°”Â·ç›–è«å°”æå‡ºã€‚GnuPGå’ŒPGPç­‰å¾ˆå¤šå¯†ç å­¦ç³»ç»Ÿä¸­éƒ½åº”ç”¨åˆ°äº†ElGamalç®—æ³•ã€‚ElGamalåŠ å¯†ç®—æ³•å¯ä»¥å®šä¹‰åœ¨ä»»ä½•å¾ªç¯ç¾¤Gä¸Šã€‚å®ƒçš„å®‰å…¨æ€§å–å†³äºGä¸Šçš„ç¦»æ•£å¯¹æ•°éš¾é¢˜ã€‚</p><ul><li><p><strong>å¯†é’¥ç”Ÿæˆ</strong></p><ol><li><p>éšæœºé€‰æ‹©ä¸€ä¸ªæ»¡è¶³å®‰å…¨è¦æ±‚çš„å¤§ç´ æ•° $p$ï¼Œå¹¶ç”Ÿæˆæœ‰é™åŸŸ $Z_{p}$ã€‚çš„ä¸€ä¸ªç”Ÿæˆå…ƒ $g\in Z_{p}^{*}$ï¼›</p></li><li><p>é€‰ä¸€ä¸ªéšæœºæ•° $x\;(1&lt;x&lt;p-1)$ï¼Œè®¡ç®— $y\equiv g^{x} \pmod p$ï¼Œåˆ™å…¬é’¥ä¸º $(y,g,p)$ï¼Œç§é’¥ä¸º $x$ã€‚</p></li></ol></li><li><p><strong>åŠ å¯†</strong></p><p>ä¸RSAå¯†ç ä½“åˆ¶ç›¸åŒï¼ŒåŠ å¯†æ—¶é¦–å…ˆå°†æ˜æ–‡æ¯”ç‰¹ä¸²åˆ†ç»„ï¼Œä½¿å¾—æ¯ä¸ªåˆ†ç»„å¯¹åº”çš„åè¿›åˆ¶æ•°å°äº$p$ï¼Œå³åˆ†ç»„é•¿åº¦å°äº$\log_2p$ï¼Œç„¶åå¯¹æ¯ä¸ªæ˜æ–‡åˆ†ç»„åˆ†åˆ«åŠ å¯†ã€‚å…·ä½“è¿‡ç¨‹åˆ†ä¸ºå¦‚ä¸‹å‡ æ­¥ï¼š</p><ol><li>å¾—åˆ°æ¥æ”¶æ–¹çš„å…¬é’¥ $(y,g,p)$ï¼›</li><li>æŠŠæ¶ˆæ¯ $m$ åˆ†ç»„ä¸ºé•¿åº¦ä¸º $L\;(L&lt;\log_2 p)$ çš„æ¶ˆæ¯åˆ†ç»„ $m=m_1m_2\dots m_t$ï¼›</li><li>å¯¹ç¬¬ $i$ å—æ¶ˆæ¯ $(1\leq i\leq t)$ éšæœºé€‰æ‹©æ•´æ•° $r_i\;(1&lt;r_i&lt;p-1)$ï¼›</li><li>è®¡ç®— $c_i\equiv g^{r_i}\pmod p,\;c_i^\prime\equiv m_iy^{r_i} \pmod p\;(1\leq i\leq t)$ï¼›</li><li>å°†å¯†æ–‡ $C=(c_1,c_1^\prime)(c_2,c_2^\prime)\dots(c_t,c_t^\prime)$ å‘é€ç»™æ¥æ”¶æ–¹ã€‚</li></ol></li><li><p><strong>è§£å¯†</strong></p><ol><li>æ¥æ”¶æ–¹æ”¶åˆ°çš„å¯†æ–‡ $C=(c_1,c_1^\prime)(c_2,c_2^\prime)\dots(c_t,c_t^\prime)$ï¼›</li><li>ä½¿ç”¨ç§é’¥ $x$ å’Œè§£å¯†ç®—æ³• $m_i \equiv ({c_i^\prime}({c_i^x})^{-1}) \pmod p \; (1\leq i\leq t)$ è¿›è¡Œè®¡ç®—ï¼›</li><li>å¾—åˆ°æ˜æ–‡ $m=m_1m_2\dots m_t$ã€‚</li></ol></li></ul><p>ElGamalåŠ å¯†è¿‡ç¨‹éœ€è¦ä¸¤æ¬¡æ¨¡æŒ‡æ•°è¿ç®—å’Œä¸€æ¬¡æ¨¡ä¹˜ç§¯è¿ç®—ï¼Œè§£å¯†è¿‡ç¨‹éœ€è¦æ¨¡æŒ‡æ•°è¿ç®—ï¼Œæ±‚é€†è¿ç®—å’Œæ¨¡ä¹˜ç§¯è¿ç®—å„ä¸€æ¬¡ã€‚æ¯æ¬¡åŠ å¯†è¿ç®—éœ€è¦é€‰æ‹©ä¸€ä¸ªéšæœºæ•°ï¼Œæ‰€ä»¥å¯†æ–‡æ—¢ä¾èµ–äºæ˜æ–‡ï¼Œåˆä¾èµ–äºé€‰æ‹©çš„éšæœºæ•°ï¼Œæ•…å¯¹äºåŒä¸€ä¸ªæ˜æ–‡ï¼Œä¸åŒçš„æ—¶åˆ»ç”Ÿæˆçš„å¯†æ–‡ä¸åŒã€‚å¦å¤–ï¼ŒElGamalåŠ å¯†ä½¿å¾—æ¶ˆæ¯æ‰©å±•äº†ä¸¤å€ï¼Œå³å¯†æ–‡çš„é•¿åº¦æ˜¯å¯¹åº”æ˜æ–‡é•¿åº¦çš„ä¸¤å€ã€‚</p><p>â€‹</p><h2 id="PaillieråŒæ€åŠ å¯†"><a href="#PaillieråŒæ€åŠ å¯†" class="headerlink" title="PaillieråŒæ€åŠ å¯†"></a>PaillieråŒæ€åŠ å¯†</h2><p>Paillierå¯†ç ï¼Œäº1999å¹´ç”±Pascal Paillierå‘æ˜ï¼Œæ˜¯ä¸€ç§ç”¨äºå…¬é’¥åŠ å¯†çš„æ¦‚ç‡éå¯¹ç§°ç®—æ³•ã€‚è¯¥ç®—æ³•å…·æœ‰åŠ æ³•åŒæ€çš„æ€§è´¨ï¼›è¿™æ„å‘³ç€ï¼Œä»…ç»™å‡ºå…¬é’¥å’Œ $m_1,m_2$ åŠ å¯†ï¼Œå¯ä»¥è®¡ç®—å‡º $m_1 + m_2$ ã€‚</p><ul><li><p><strong>å¯†é’¥ç”Ÿæˆ</strong></p><ol><li>éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•° $p,q$ æ»¡è¶³ $\gcd(pq,(p-1)(q-1))=1$ã€‚æ­¤å±æ€§ä¿è¯ä¸¤ä¸ªè´¨æ•°é•¿åº¦ç›¸ç­‰ï¼›</li><li>è®¡ç®— $n=pq$ å’Œ $\lambda=\text{lcm}(p-1,q-1)$ï¼›</li><li>é€‰æ‹©éšæœºæ•´æ•° $g(g\in \mathbb{Z}_{n^2}^{*}) $ï¼Œä½¿å¾—æ»¡è¶³ $n$ æ•´é™¤ $g$ çš„é˜¶ï¼ˆ$0\lt g \lt n^2$ï¼‰ï¼›</li><li>å®šä¹‰ $L(x)=\cfrac{x-1}{n}$ï¼›</li><li>è®¡ç®— $\mu=(L(g^\lambda \bmod n^2))^{-1} \bmod n$ï¼›</li><li>å…¬é’¥ä¸º $(n,g)$ï¼Œç§é’¥ä¸º $(\lambda,\mu)$ã€‚</li></ol><ul><li><p><strong>ç®€åŒ–ç‰ˆ</strong></p><p>$g=n+1$</p><p>$\lambda=\varphi(n)=(p-1)(q-1)$</p><p>$\mu=\varphi(n)^{-1}\bmod n$</p></li></ul></li><li><p><strong>åŠ å¯†</strong></p><ol><li>$m$ ä¸ºåŸæ–‡ï¼ˆ$0\leq m \lt n$ï¼‰ï¼›</li><li><p>é€‰æ‹©éšæœºæ•° $r(0 \lt r \lt n,r \in \mathbb{Z}_{n^2}^{*})$ï¼Œä¸” $\gcd(r,n)=1$ï¼›</p></li><li><p>åŠ å¯†ï¼š$c=g^m \cdot r^n\bmod n^2$ã€‚</p></li></ol></li><li><p><strong>è§£å¯†</strong></p><p>è§£å¯†ï¼š$m=L(c^\lambda \bmod n^2)\cdot \mu \bmod n$ã€‚</p></li><li><p><strong>æ€§è´¨</strong></p><p>$D(E(m_1,r_1) \cdot E(m_2,r_2) \bmod {n^2})=m_1+m_2 \bmod n$</p><p>$D(E(m_1,r_1) \cdot g^{m_2} \bmod {n^2})=m_1+m_2 \bmod n$</p><p>$D(E(m_1,r_1)^{m_2} \bmod {n^2})=m_1m_2 \bmod n$</p><p>$D(E(m_2,r_2)^{m_1} \bmod {n^2})=m_1m_2 \bmod n$</p><p>$D(E(m,r)^{k} \bmod {n^2})=km \bmod n$</p><p>$D(E(m,r) \cdot (1+n)^k \bmod {n^2})=m+k \bmod n$</p></li></ul><p>â€‹</p><h2 id="Merkle-HellmanèƒŒåŒ…åŠ å¯†ï¼ˆKnapsackï¼‰"><a href="#Merkle-HellmanèƒŒåŒ…åŠ å¯†ï¼ˆKnapsackï¼‰" class="headerlink" title="Merkle-HellmanèƒŒåŒ…åŠ å¯†ï¼ˆKnapsackï¼‰"></a>Merkle-HellmanèƒŒåŒ…åŠ å¯†ï¼ˆKnapsackï¼‰</h2><p>1977å¹´ï¼ŒMerkleä¸Hellmanåˆä½œè®¾è®¡äº†ä½¿ç”¨èƒŒåŒ…ç®—æ³•ï¼Œè¯¥ç®—æ³•æå‡ºåå¯†ç å­¦ç•Œæå‡ºäº†å¾ˆå¤šèƒŒåŒ…å‹åŠ å¯†ç®—æ³•ã€‚</p><p>å…¶å·¥ä½œåŸç†æ˜¯ï¼šå‡å®šç”²æƒ³åŠ å¯†ï¼Œåˆ™å…ˆäº§ç”Ÿä¸€ä¸ªè¾ƒæ˜“æ±‚è§£çš„èƒŒåŒ…é—®é¢˜ï¼Œå¹¶ç”¨å®ƒçš„è§£ä½œä¸ºä¸“ç”¨å¯†é’¥ï¼›ç„¶åä»è¿™ä¸ªé—®é¢˜å‡ºå‘ï¼Œç”Ÿæˆå¦ä¸€ä¸ªéš¾è§£çš„èƒŒåŒ…é—®é¢˜ï¼Œå¹¶ä½œä¸ºå…¬å…±å¯†é’¥ã€‚å¦‚æœä¹™æƒ³å‘ç”²å‘é€æŠ¥æ–‡ï¼Œä¹™å°±å¯ä»¥ä½¿ç”¨éš¾è§£çš„èƒŒåŒ…é—®é¢˜å¯¹æŠ¥æ–‡è¿›è¡ŒåŠ å¯†ï¼Œç”±äºè¿™ä¸ªé—®é¢˜ååˆ†éš¾è§£ï¼Œæ‰€ä»¥ä¸€èˆ¬æ²¡æœ‰äººèƒ½å¤Ÿç ´è¯‘å¯†æ–‡ï¼›ç”²æ”¶åˆ°å¯†æ–‡åï¼Œå¯ä»¥ä½¿ç”¨æ˜“è§£çš„ä¸“ç”¨å¯†é’¥è§£å¯†ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨å®ƒå‘è¡¨å‡ å¹´åï¼Œå°±æ‰¾åˆ°äº†æ”»ç ´å®ƒçš„æ–¹æ³•ã€‚å³ä½¿å¦‚æ­¤ï¼Œå®ƒä»ç„¶ä»£è¡¨ç€ä¸€ç±»å¾ˆéš¾é—®é¢˜çš„ç®—æ³•ã€‚</p><p><strong>åŠ å¯†</strong></p><p>é€‰æ‹©ä»»ä½•ä¸€ä¸ª<strong>è¶…é€’å¢é›†</strong> $\{s_1,s_2,â€¦,s_n\}$ã€‚</p><p>é™·é—¨ç”±ä»»æ„å¤§äº $\sum_{i}s_i$ çš„ç´ æ•° $p$ å’Œä»»æ„å°äº $p$ çš„æ•´æ•° $a$ ç»„æˆï¼Œè¿™ä¸¤ä¸ªæ•°å’Œé›†åˆ $\{s_1,s_2,â€¦,s_n\}$ éƒ½æ˜¯ä¿å¯†çš„ã€‚</p><p>å…¬å¼€çš„æ•´æ•°é›†æ˜¯ $\{t_1,t_2,â€¦,t_n\}$ ï¼Œå…¶ä¸­ $t_i=a_i \cdot s_i \pmod p$ã€‚</p><p>äºŒè¿›åˆ¶æ˜æ–‡ $(b_1,b_2,â€¦,b_n)$ çš„åŠ å¯†æ“ä½œä¸º $y=\sum_{i}b_it_i$ï¼Œæ•´æ•° $y$ æ˜¯å¯†æ–‡ã€‚</p><p><strong>è§£å¯†</strong></p><p>æ‰¾åˆ° $a^{-1} \pmod p$ã€‚å› ä¸º $p$ æ˜¯è´¨æ•°ï¼Œ $a^{-1} \pmod p$ ä¸€å®šå­˜åœ¨ã€‚è®¡ç®— $a^{-1}y \pmod p$ã€‚</p><p>å¾—åˆ° $a^{-1}y \pmod p$ è¿™ä½¿å¾—ï¼š</p><p>$a^{-1}y=a^{-1}\sum_{i}b_it_i \pmod p=\sum_{i}b_i(a^{-1}as_i) \pmod p=\sum_{i}b_is_i$</p><p>å› ä¸ºé›†åˆ $\{s_1,s_2,â€¦,s_n\}$æ˜¯è¶…é€’å¢é›†ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å®šä½æ˜æ–‡ä½ã€‚</p><p><strong>â˜…æ³¨ï¼š</strong></p><p>Knapsackç³»ç»Ÿçš„<strong><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2007/066.pdf">å¯†åº¦</a></strong>ä¸ºï¼š</p><p>$d = \cfrac{n}{\log_2(max\{a_i\})}$</p><p>åŸºäºå­é›†å’Œé—®é¢˜ï¼Œ<strong>MHå¯†ç ç³»ç»Ÿ</strong>æ˜¯æœ€å¼€å§‹å‡ºç°çš„ä¸€ç§å¯†åº¦æ¯”è¾ƒä½çš„Knapsackå¯†ç ç³»ç»Ÿã€‚å¾ˆå¿«Shamirç­‰äººæå‡ºäº†ä¸€ç³»åˆ—çš„æ”»å‡»æ–¹å¼ï¼ŒåŒ…æ‹¬ä¸¢ç•ªå›¾é€¼è¿‘ï¼ŒLLLç­‰æ–¹æ³•ï¼ˆ$d&lt;0.9408$ï¼‰ã€‚è™½ç„¶è¿™ä¸ªå¯†ç ç³»ç»Ÿè¢«æ”»ç ´äº†ï¼Œæ–°çš„Knapsackç³»ç»Ÿè¯ç”Ÿäº†ï¼Œè¿™ç§å¯†ç ç³»ç»Ÿçš„å¯†åº¦å˜é«˜äº†ï¼Œ$a_i$ å€¼å˜å°äº†ï¼Œè€Œä¸”åŠ å¯†çš„æ˜æ–‡çš„äºŒè¿›åˆ¶ä½ä¸­<code>1</code>çš„æ•°é‡ä¹Ÿå¾ˆå°ã€‚</p><p>æ–°çš„å¯†ç ç³»ç»Ÿæ›´åŠ éš¾ä»¥ç ´è§£ï¼Œä¹Ÿç§°ä¹‹ä¸º<strong>HardKnapsack</strong>ç³»ç»Ÿï¼Œä¸è¿‡åæ¥å¯†ç å­¦å®¶ä»¬è¿˜æ˜¯å‘ç°äº†æ”»å‡»æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºlow-weight attackã€‚</p><ul><li><p><strong>Schroeppel-Shamir Algorithm</strong></p><p>æ—¶é—´å¤æ‚åº¦,ç©ºé—´å¤æ‚åº¦å‡ä¸º $O(\cfrac{n}{2})$</p></li><li><p><strong>The Howgrave-Grahamâ€“Joux Algorithm</strong></p><p>æ—¶é—´å¤æ‚åº¦ $O(0.337n)$ï¼Œç©ºé—´å¤æ‚åº¦ $O(0.256n)$</p></li></ul><p>æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸¤ç§ç®—æ³•æ˜¯åŸºäºåˆ†æ²»å’Œmitmçš„æ€æƒ³è¿›è¡Œæ”»å‡»çš„ã€‚</p><ul><li><p><strong>Lagarias and Odlyzkoâ€™s Method / CJLOSS Method</strong></p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.ieice.org/publications/conference-FIT-DVDs/FIT2018/data/pdf/A-022.pdf">Lattice Reduction Attack on the Knapsack Type Cryptosystem</a></p><p>æ„é€ æ ¼ï¼š</p><p>$\left(\begin {array}{c} b_0 \newline b_1 \newline \vdots \newline b_n \newline b_{n+1} \end{array} \right) =\left(\begin {array}{c} 1 &amp; 0 &amp; \cdots &amp; 0 &amp; Nk_0 \newline 0 &amp; 1 &amp; \cdots &amp; 0 &amp; Nk_1 \newline \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \newline 0 &amp; 0 &amp; \cdots &amp; 1 &amp; Nk_n \newline 0 &amp; 0 &amp; \cdots &amp; 0 &amp; Nk_{n+1} \end{array} \right) $</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">M = Matrix.identity(n)</span><br><span class="line"></span><br><span class="line">last_row = [<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> keys]</span><br><span class="line">M_last_row = Matrix(ZZ, <span class="number">1</span>, <span class="built_in">len</span>(last_row), last_row)</span><br><span class="line"></span><br><span class="line">ct = </span><br><span class="line">last_col = keys[:]</span><br><span class="line">last_col.append(ct)</span><br><span class="line">M_last_col = Matrix(ZZ, <span class="built_in">len</span>(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">M = M.stack(M_last_row)</span><br><span class="line">M = M.augment(M_last_col)</span><br><span class="line"></span><br><span class="line">X = M.LLL()</span><br><span class="line">target = X[<span class="number">0</span>][:-<span class="number">1</span>]</span><br><span class="line">ans = [-k <span class="keyword">for</span> k <span class="keyword">in</span> target]</span><br></pre></td></tr></table></figure></li></ul><p>å¯¹äºå¯†åº¦æ¯”è¾ƒé«˜çš„Knapsackå¯†ç ç³»ç»Ÿï¼Œåœ¨<code>1</code>çš„æ•°é‡ç¡®å®šæƒ…å†µä¸‹ï¼Œå¯ä»¥å°è¯•åˆ†æ®µçˆ†ç ´ã€‚</p><p>å‚è€ƒè®ºæ–‡ï¼š<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2011/474.pdf">Improved Generic Algorithms for Hard Knapsacks</a></p><h3 id="å¸¸è§„è§£å¯†"><a href="#å¸¸è§„è§£å¯†" class="headerlink" title="å¸¸è§„è§£å¯†"></a>å¸¸è§„è§£å¯†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">pk =  <span class="comment"># public key</span></span><br><span class="line">ct =  <span class="comment"># ciphertext</span></span><br><span class="line"><span class="built_in">print</span>(ct)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pk))</span><br><span class="line">n = <span class="built_in">len</span>(pk)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sanity check for application of low density attack</span></span><br><span class="line">d = n / log(<span class="built_in">max</span>(pk), <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(CDF(d))</span><br><span class="line"><span class="keyword">assert</span> CDF(d) &lt; <span class="number">0.9408</span></span><br><span class="line"></span><br><span class="line">M = Matrix.identity(n) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">last_row = [<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> pk]</span><br><span class="line">M_last_row = Matrix(ZZ, <span class="number">1</span>, <span class="built_in">len</span>(last_row), last_row)</span><br><span class="line"></span><br><span class="line">last_col = pk</span><br><span class="line">last_col.append(ct)</span><br><span class="line">M_last_col = Matrix(ZZ, <span class="built_in">len</span>(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">M = M.stack(M_last_row)</span><br><span class="line">M = M.augment(M_last_col)</span><br><span class="line"></span><br><span class="line">X = M.BKZ()</span><br><span class="line"></span><br><span class="line">sol = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">    testrow = X.row(i).<span class="built_in">list</span>()[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">set</span>(testrow).issubset([-<span class="number">1</span>, <span class="number">1</span>]):</span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> testrow:</span><br><span class="line">            <span class="keyword">if</span> v == <span class="number">1</span>:</span><br><span class="line">                sol += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> v == -<span class="number">1</span>:</span><br><span class="line">                sol += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sol)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(sol, <span class="number">2</span>)))</span><br></pre></td></tr></table></figure><h3 id="æ³„éœ²éƒ¨åˆ†æ˜æ–‡ç©ºé—´çš„é™ç»´å¤„ç†"><a href="#æ³„éœ²éƒ¨åˆ†æ˜æ–‡ç©ºé—´çš„é™ç»´å¤„ç†" class="headerlink" title="æ³„éœ²éƒ¨åˆ†æ˜æ–‡ç©ºé—´çš„é™ç»´å¤„ç†"></a>æ³„éœ²éƒ¨åˆ†æ˜æ–‡ç©ºé—´çš„é™ç»´å¤„ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###Sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">pubkey =  </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line"><span class="comment">#å‰ç¼€ flag&#123;</span></span><br><span class="line">prefix = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">bin</span>(bytes_to_long(<span class="string">b&#x27;flag&#123;&#x27;</span>))[<span class="number">2</span>:]]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(prefix)):</span><br><span class="line">    c -= prefix[i] * pubkey[i]</span><br><span class="line"></span><br><span class="line"><span class="comment">#åç¼€ &#125;</span></span><br><span class="line">suffix = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">bin</span>(<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>))[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)]</span><br><span class="line">n = <span class="built_in">len</span>(pubkey)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    c -= pubkey[n - <span class="number">8</span> + i] * suffix[i]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸­éƒ¨md5èŒƒå›´ 0-f</span></span><br><span class="line">elements = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(prefix), <span class="built_in">len</span>(pubkey) - <span class="number">8</span>, <span class="number">8</span>):</span><br><span class="line">    elements.append(pubkey[i + <span class="number">1</span>])</span><br><span class="line">    c -= <span class="number">1</span> * pubkey[i + <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">8</span>):</span><br><span class="line">        elements.append(pubkey[i + j])</span><br><span class="line">        </span><br><span class="line">n = <span class="built_in">len</span>(elements)</span><br><span class="line">A = Matrix(ZZ, n + <span class="number">1</span>, n + <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    A[i, <span class="number">0</span>] = elements[i]</span><br><span class="line">    A[i, i + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">A[n, <span class="number">0</span>] = c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">    A[n, i] = <span class="number">1</span></span><br><span class="line">AL = A.BKZ()</span><br><span class="line">mid = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> AL:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(line[i] == <span class="number">1</span> <span class="keyword">or</span> line[i] == -<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>)):</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">            line = -line</span><br><span class="line">        mid = line[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">mid_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> mid:</span><br><span class="line">    <span class="keyword">if</span> _ == -<span class="number">1</span>:</span><br><span class="line">        mid_str += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mid_str += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    flag += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    flag += mid_str[j]</span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line">    flag += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        flag += mid_str[j]</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag, <span class="number">2</span>)))</span><br></pre></td></tr></table></figure><h3 id="å­é›†åˆé—®é¢˜-è½¬åŒ–ä¸º-æ±‚è§£SVP-CVP-Lattice-Reduction-Algorithm"><a href="#å­é›†åˆé—®é¢˜-è½¬åŒ–ä¸º-æ±‚è§£SVP-CVP-Lattice-Reduction-Algorithm" class="headerlink" title="å­é›†åˆé—®é¢˜ è½¬åŒ–ä¸º æ±‚è§£SVP/CVP+Lattice Reduction Algorithm"></a>å­é›†åˆé—®é¢˜ è½¬åŒ–ä¸º æ±‚è§£SVP/CVP+Lattice Reduction Algorithm</h3><p>å‚è€ƒï¼š</p><p><a target="_blank" rel="noopener" href="https://0xdktb.top/2020/08/02/WriteUp-WMCTF2020-Crypto/">WMCTF 2020 - babySum + Sum</a></p><p><a target="_blank" rel="noopener" href="https://soreatu.com/posts/crypto-research-subset-sum-problem/">Crypto Research: Solving Subset Sum Problem by Lattice Reduction</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> multiprocessing <span class="keyword">as</span> mp</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">sol, A, s</span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot;Check whether *sol* is a solution to the subset-sum problem.</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">sum</span>(x*a <span class="keyword">for</span> x, a <span class="keyword">in</span> <span class="built_in">zip</span>(sol, A)) == s</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">A, n, k, s, ID=<span class="literal">None</span>, BS=<span class="number">22</span></span>):</span><br><span class="line">	N = ceil(sqrt(n)) <span class="comment"># parameter used in the construction of lattice</span></span><br><span class="line">	rand = random.Random(x=ID) <span class="comment"># seed</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment"># 1. Construct the lattice</span></span><br><span class="line">	<span class="comment"># (n+1) * (n+2)</span></span><br><span class="line">	<span class="comment"># 1 0 ... 0 a_0*N N</span></span><br><span class="line">	<span class="comment"># 0 1 ... 0 a_1*N N</span></span><br><span class="line">	<span class="comment"># . . ... . ... .</span></span><br><span class="line">	<span class="comment"># 0 0 ... 1 a_n*N N</span></span><br><span class="line">	<span class="comment"># 0 0 ... 0 s*N k*N</span></span><br><span class="line">	lat = []</span><br><span class="line">	<span class="keyword">for</span> i, a <span class="keyword">in</span> <span class="built_in">enumerate</span>(A):</span><br><span class="line">		lat.append([<span class="number">1</span>*(j == i) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)] + [N*a] + [N])</span><br><span class="line">	lat.append([<span class="number">0</span>]*n + [N*s] + [k*N])</span><br><span class="line">	</span><br><span class="line">	<span class="comment"># main loop</span></span><br><span class="line">	itr = <span class="number">0</span></span><br><span class="line">	start_time = cputime()</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		itr += <span class="number">1</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment"># 2. Randomly shuffle</span></span><br><span class="line">		l = lat[::]</span><br><span class="line">		shuffle(l, random=rand.random)</span><br><span class="line">		</span><br><span class="line">		<span class="comment"># 3. BKZ!!!</span></span><br><span class="line">		m = matrix(ZZ, l)</span><br><span class="line">		t_BKZ = cputime()</span><br><span class="line">		m_BKZ = m.BKZ(block_size=BS)</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span> <span class="subst">&#123;itr&#125;</span> runs. BKZ running time: <span class="subst">&#123;cputime(t_BKZ):<span class="number">.3</span>f&#125;</span>s&quot;</span>)</span><br><span class="line">		</span><br><span class="line">		<span class="comment"># 4. Check the result</span></span><br><span class="line">		<span class="keyword">for</span> i, row <span class="keyword">in</span> <span class="built_in">enumerate</span>(m_BKZ):</span><br><span class="line">			<span class="keyword">if</span> check(row, A, s):</span><br><span class="line">					<span class="keyword">if</span> row.norm()^<span class="number">2</span> == k:</span><br><span class="line">						<span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span> After <span class="subst">&#123;itr&#125;</span> runs. FIND SVP!!! <span class="subst">&#123;row&#125;</span>\n&quot;</span></span><br><span class="line">						<span class="string">f&quot;Single core time used: <span class="subst">&#123;cputime(start_time):<span class="number">.3</span>f&#125;</span>s&quot;</span>)</span><br><span class="line">						<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">s = </span><br><span class="line">A = []</span><br><span class="line"><span class="comment">#choose k numbers from n</span></span><br><span class="line">k = </span><br><span class="line">n = </span><br><span class="line">solve_n = partial(solve, A, n, k, s)</span><br><span class="line">CPU_CORE_NUM = <span class="number">8</span></span><br><span class="line"><span class="keyword">with</span> mp.Pool(CPU_CORE_NUM) <span class="keyword">as</span> pool:</span><br><span class="line">	reslist = pool.imap_unordered(solve_n, <span class="built_in">range</span>(CPU_CORE_NUM))</span><br><span class="line">	<span class="comment"># terminate all processes once one process returns</span></span><br><span class="line">	<span class="keyword">for</span> res <span class="keyword">in</span> reslist:</span><br><span class="line">		<span class="keyword">if</span> res:</span><br><span class="line">			pool.terminate()</span><br><span class="line">			<span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="BenalohåŠ å¯†"><a href="#BenalohåŠ å¯†" class="headerlink" title="BenalohåŠ å¯†"></a>BenalohåŠ å¯†</h2><ul><li><p><strong>å¯†é’¥ç”Ÿæˆ</strong></p><p>å‡å®šå—å¤§å°ä¸º $r$ï¼Œæ¯ä¸ªæ˜æ–‡ä¿¡æ¯å—å¤§å°åœ¨ $[0,r)$ èŒƒå›´å†…ã€‚</p><ol><li>é€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•° $p=rpâ€™+1$ å’Œ $q$ ï¼Œæ»¡è¶³ $\gcd(pâ€™,r)=\gcd(q-1,r)=1$ï¼›</li><li>è®¡ç®— $n=pq$ åŠ $\varphi(n)=(p-1)(q-1)$ï¼›</li><li>é€‰æ‹© $0 \leq y \lt n$ï¼Œæ»¡è¶³ $y^{\varphi(n)/r} \not\equiv 1 \pmod n$ï¼›</li><li>è®¡ç®— $x=y^{\varphi(n)/r} \bmod n$ï¼Œå…¬é’¥ä¸º $(y,n)$ï¼Œç§é’¥ä¸º $(\varphi,x)$ã€‚</li></ol></li><li><p><strong>åŠ å¯†</strong></p><p>å‡è®¾è¦åŠ å¯†çš„ä¿¡æ¯ $m \in [0,r)$ï¼š</p><ol><li>é€‰æ‹©ä¸€ä¸ªæ•° $u \in [0,n)$ï¼›</li><li>è®¡ç®— $c=y^mu^r \bmod n$ å³ä¸º $m$ çš„å¯†æ–‡ã€‚</li></ol></li><li><p><strong>è§£å¯†</strong></p><p>å‡è®¾è¦è§£å¯†çš„ä¿¡æ¯ $c$ï¼š</p><ol><li>è®¡ç®— $a=c^{\varphi(n)/r} \bmod n$ï¼›</li><li>DLPæ±‚è§£æ»¡è¶³ $x^m \equiv a \pmod n$ çš„ $m$ï¼Œå³ $m=\log_x(a)$ã€‚</li></ol></li><li><p><strong>å‚è€ƒ</strong></p><p><a target="_blank" rel="noopener" href="https://mystiz.hk/posts/2021-02-15-dicectf-1/">https://mystiz.hk/posts/2021-02-15-dicectf-1/</a></p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">y = </span><br><span class="line">e = </span><br><span class="line">C = []</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">tmp = phi // e</span><br><span class="line"></span><br><span class="line">bounds = (<span class="number">1</span>, e)</span><br><span class="line">F = IntegerModRing(n)</span><br><span class="line">result = []</span><br><span class="line"></span><br><span class="line">x = F(<span class="built_in">pow</span>(y, tmp, n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> tqdm(C):</span><br><span class="line">    a = F(<span class="built_in">pow</span>(c, tmp, n))</span><br><span class="line">    result.append(bsgs(x, a, bounds))</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result[::-<span class="number">1</span>]:</span><br><span class="line">    flag = flag*e + i</span><br><span class="line">flag = long_to_bytes(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="LUC-RSAåŠ å¯†"><a href="#LUC-RSAåŠ å¯†" class="headerlink" title="LUC-RSAåŠ å¯†"></a>LUC-RSAåŠ å¯†</h2><ul><li><p><strong>Lucasæ•°åˆ—ï¼ˆå¢å¡æ–¯æ•°åˆ—ï¼‰</strong></p><ul><li><p><strong>é€’æ¨å…³ç³»</strong></p><p>ç»™å®šä¸¤ä¸ªæ•´æ•° $P$ å’Œ $Q$ï¼Œæ»¡è¶³ï¼š$P^2-4Q \ne 0$ï¼Œ</p><p>ç¬¬ä¸€ç±»å¢å¡æ–¯æ•°åˆ— $U_n(P,Q)$ å®šä¹‰ï¼š</p><p>$U_0(P,Q)=0 \\ U_1(P,Q)=1 \\ U_n(P,Q)=P \cdot U_{n-1}(P,Q) - Q \cdot U_{n-2}(P,Q), n&gt;1$</p><p>ç¬¬äºŒç±»å¢å¡æ–¯æ•°åˆ— $V_n(P,Q)$ å®šä¹‰ï¼š</p><p>$V_0(P,Q)=2 \\ V_1(P,Q)=P \\ V_n(P,Q)=P \cdot V_{n-1}(P,Q) - Q \cdot V_{n-2}(P,Q), n&gt;1$</p></li><li><p><strong>ä»£æ•°å…³ç³»</strong></p><p>ç‰¹å¾æ–¹ç¨‹ï¼š$x^2-Px+Q=0$ï¼Œåˆ¤åˆ«å¼ï¼š$D=P^2-4Q$ï¼Œæ ¹ï¼š$a=\cfrac{P+\sqrt{D}}{2},b=\cfrac{P-\sqrt{D}}{2}$ã€‚</p><p>å¢å¡æ–¯æ•°åˆ—çš„é¡¹å¯ç”¨ $a$ å’Œ $b$ çš„é¡¹å®šä¹‰ï¼š</p><p>$U_n = \cfrac{a^n-b^n}{a-b} = \cfrac{a^n-b^n}{\sqrt{D}}$</p><p>$V_n = a^n + b^n$</p></li></ul></li><li><p><strong>å¯†é’¥ç”Ÿæˆ</strong></p><p>è®¾ $p,q$ æ˜¯ä¸¤ä¸ªå¥‡ç´ æ•°ï¼Œ$N=pq$ã€‚</p><p>$e \in \mathbb{Z}_N$ï¼Œä¸” $\gcd(e,(p-1)(p+1)(q-1)(q-1))=1$ã€‚</p><p>å¢å¡æ–¯æ•°åˆ— $V_n(M,1) = M \cdot V_{n-1} - V_{n-2}$ï¼Œå³ $P=M,Q=1$ã€‚ï¼ˆæ›´ä¸€èˆ¬æƒ…å†µè§paperï¼‰</p><p>å…¬é’¥ä¸ºï¼š$(N,e)$ã€‚</p></li><li><p><strong>åŠ å¯†</strong></p><p>$C=V_e(M,1) \pmod N$ï¼Œå¯¹ä»»æ„ä¿¡æ¯ $M \in \mathbb{Z}_N$ã€‚</p></li><li><p><strong>è§£å¯†</strong></p><p>è§£å¯†å¯†é’¥ $d$ï¼Œ$ed \equiv 1 \pmod {S(N)}$ï¼Œ</p><p>$S(N)=\text{lcm}\left(p-\left (\cfrac{D}{p} \right),p-\left (\cfrac{D}{q} \right)\right)$ï¼Œ$D=C^2-4$ï¼Œ</p><p>å…¶ä¸­ $\left(\cfrac{D}{p} \right)= \begin{cases} 1,&amp; \exists x, x^2 \equiv D \pmod {p} \\ 0,&amp; p \mid D \\ -1, &amp; \text{other} \end{cases}$ ä¸ºå‹’è®©å¾·(Legendre)ç¬¦å·ã€‚</p><p>$M=V_d(C,1) \pmod N$ã€‚</p></li><li><p><strong>å‚è€ƒ</strong></p><p><a target="_blank" rel="noopener" href="http://jeit.ie.ac.cn/fileDZYXXXB/journal/article/dzyxxxb/2007/1/PDF/20070144.pdf">ä¸€ç§æ–°çš„åŸºäº Lucas åºåˆ—çš„å…¬é’¥å¯†ç ä½“åˆ¶</a></p><p><a target="_blank" rel="noopener" href="https://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=5140063BDB10AB1388C9AAB52A8071A1?doi=10.1.1.32.1835&amp;rep=rep1&amp;type=pdf">LUC: A New Public Key System</a></p><p><a target="_blank" rel="noopener" href="https://n00bcak.github.io/writeups/2021/03/27/UMass-CTF.html">UMassCTF 2021 - Weird RSA</a></p><p>LUC-RSA:</p><p><a target="_blank" rel="noopener" href="https://ro.uow.edu.au/cgi/viewcontent.cgi?article=6676&amp;context=eispapers">A new attack on three variants of the RSA cryptosystem</a><br><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/abs/pii/S2214212616302678">Cryptanalysis of RSA-type cryptosystems based on Lucas sequences, Gaussian integers and elliptic curves</a></p><p><a target="_blank" rel="noopener" href="https://miaotony.xyz/2022/03/25/CTF_2022HFCTF/2022HFCTF-%E7%BA%BF%E4%B8%8A%E8%B5%9B%E5%AE%98%E6%96%B9Writeup.pdf">HFCTF 2022 - RRSSAA</a></p><p><a target="_blank" rel="noopener" href="https://github.com/b3f0re-team/Write-up/blob/main/RCTF/RCTF.md#easyrsa">RCTF 2022 - easyRSA</a></p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ³•1ï¼Œå¿«é€ŸçŸ©é˜µå¹‚</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">N=</span><br><span class="line">C=</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ffm</span>(<span class="params">num</span>): <span class="comment"># Fermat&#x27;s Factorization Method.</span></span><br><span class="line">    <span class="keyword">if</span> num%<span class="number">2</span>==<span class="number">0</span>: <span class="keyword">return</span> (<span class="number">2</span>,num/<span class="number">2</span>)</span><br><span class="line">    a=ceil(sqrt(num))</span><br><span class="line">    c=a**<span class="number">2</span>-num</span><br><span class="line">    <span class="keyword">while</span> is_square(c)==<span class="number">0</span>: a+=<span class="number">1</span></span><br><span class="line">    b=sqrt(c)</span><br><span class="line">    <span class="keyword">return</span> (a-b,a+b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matpow</span>(<span class="params">mat,power</span>): <span class="comment"># Matrix Square-And-Multiply Exponentiation.</span></span><br><span class="line">    power_rep=<span class="built_in">bin</span>(power)[<span class="number">3</span>:]</span><br><span class="line">    result=mat</span><br><span class="line">    pcnt=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> power_rep:     </span><br><span class="line">        result=result*result</span><br><span class="line">        pcnt*=<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> i==<span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            result=mat*result</span><br><span class="line">            pcnt+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(pcnt)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">d</span>): <span class="comment"># Decryption.</span></span><br><span class="line">    Mat=Matrix(Zmod(N),[[C,-<span class="number">1</span>],[<span class="number">1</span>,<span class="number">0</span>]])</span><br><span class="line">    ori=vector(Zmod(N),[C,<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> matpow(Mat,d-<span class="number">1</span>)*ori</span><br><span class="line"></span><br><span class="line">p,q=ffm(N) </span><br><span class="line"><span class="keyword">assert</span> p*q==N</span><br><span class="line">D=(C**<span class="number">2</span>-<span class="number">4</span>)%N</span><br><span class="line">p_leg,q_leg=<span class="built_in">int</span>((p-kronecker(D,p))%N),<span class="built_in">int</span>((q-kronecker(D,q))%N)</span><br><span class="line">tn=lcm((p_leg),(q_leg))</span><br><span class="line">d=inverse_mod(<span class="number">0x10001</span>,tn)</span><br><span class="line"><span class="keyword">assert</span> (<span class="number">0x10001</span>*d)%tn==<span class="number">1</span></span><br><span class="line">decc,_=decrypt(d)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(decc))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ³•2ï¼Œå­˜å‚¨vd</span></span><br><span class="line"><span class="comment">#vd(2n)=vd(n)^2-2</span></span><br><span class="line"><span class="comment">#vd(2n+1)=c*vd(n)^2-vd(n)*vd(n-1)+c</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">v</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>: <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>: <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> v_dict.keys(): <span class="keyword">return</span> v_dict[n]</span><br><span class="line">    <span class="keyword">if</span>(n % <span class="number">2</span> == <span class="number">0</span>): ret = (<span class="built_in">pow</span>(v(n // <span class="number">2</span>), <span class="number">2</span>, N) - <span class="number">2</span>) % N</span><br><span class="line">    <span class="keyword">else</span>: ret = (c * <span class="built_in">pow</span>(v(n // <span class="number">2</span>), <span class="number">2</span>, N) -  v(n // <span class="number">2</span>) * v((n // <span class="number">2</span>) - <span class="number">1</span>) - c) % N</span><br><span class="line">    v_dict[n] = ret</span><br><span class="line">    <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ³•3ï¼ŒWilliam&#x27;s p+1ç®—æ³•ä¼˜åŒ–vd</span></span><br><span class="line"><span class="comment"># Williams&#x27;s p + 1 algorithm</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LUC</span>(<span class="params">c, d, N</span>):</span><br><span class="line">	x = c</span><br><span class="line">	y = (c**<span class="number">2</span> - <span class="number">2</span>) % N</span><br><span class="line">	<span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">bin</span>(d)[<span class="number">3</span>:]:</span><br><span class="line">		<span class="keyword">if</span> bit == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">			x = (x*y - c) % N</span><br><span class="line">			y = (y**<span class="number">2</span> - <span class="number">2</span>) % N</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			y = (x*y - c) % N</span><br><span class="line">			x = (x**<span class="number">2</span> - <span class="number">2</span>) % N</span><br><span class="line">	<span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="DSAæ•°å­—ç­¾å"><a href="#DSAæ•°å­—ç­¾å" class="headerlink" title="DSAæ•°å­—ç­¾å"></a>DSAæ•°å­—ç­¾å</h2><ul><li><p><strong>å¯†é’¥ç”Ÿæˆ</strong></p><ol><li>é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å“ˆå¸Œå‡½æ•°ï¼Œç›®å‰ä¸€èˆ¬é€‰æ‹©SHA1ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å¼ºåº¦æ›´é«˜çš„å“ˆå¸Œå‡½æ•° $H$ï¼›</li><li>é€‰æ‹©å¯†é’¥çš„é•¿åº¦ $L$ å’Œ $N$ï¼Œè¿™ä¸¤ä¸ªå€¼å†³å®šäº†ç­¾åçš„å®‰å…¨ç¨‹åº¦ã€‚åœ¨æœ€åˆçš„DSSï¼ˆDigital Signature Standard ï¼‰ä¸­å»ºè®® $L$ å¿…é¡»ä¸º64çš„å€æ•°ï¼Œå¹¶ä¸” $512â‰¤Lâ‰¤1024$ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ›´å¤§ã€‚$N$ å¤§å°å¿…é¡»ä¸å¤§äºå“ˆå¸Œå‡½æ•° $H$ è¾“å‡ºçš„é•¿åº¦ã€‚FIPS 186-3ç»™å‡ºäº†ä¸€äº›å»ºè®®çš„ $L$ å’Œ $N$ çš„å–å€¼ä¾‹å­ï¼š$(1024, 160),(2048, 224), (2048, 256),(3072, 256)$ã€‚</li><li>é€‰æ‹© $N$ æ¯”ç‰¹çš„ç´ æ•° $q$ï¼›</li><li>é€‰æ‹© $L$ æ¯”ç‰¹çš„ç´ æ•° $p$ï¼Œä½¿å¾— $p-1$ æ˜¯ $q$ çš„å€æ•°ï¼›</li><li>é€‰æ‹©æ»¡è¶³ $g^k \equiv 1 \pmod p$ çš„æœ€å°æ­£æ•´æ•° $k$ ä¸º $q$ çš„ $g$ï¼Œå³åœ¨æ¨¡ $p$ çš„èƒŒæ™¯ä¸‹ï¼Œ$\mathrm{ord}(g)=q$ çš„ $g$ã€‚å³ $g$ åœ¨æ¨¡ $p$ çš„æ„ä¹‰ä¸‹ï¼Œå…¶æŒ‡æ•°æ¬¡å¹‚å¯ä»¥ç”Ÿæˆå…·æœ‰ $q$ ä¸ªå…ƒç´ çš„å­ç¾¤ã€‚è¿™é‡Œå¯ä»¥é€šè¿‡è®¡ç®— $g \equiv h^{\frac{pâˆ’1}{q}} \pmod p$ æ¥å¾—åˆ° $g$ï¼Œå…¶ä¸­ $h \in (1,pâˆ’1)$ ã€‚</li><li>é€‰æ‹©ç§é’¥ $x \in (0,q)$ï¼Œè®¡ç®— $y \equiv g^x \pmod p$ã€‚</li><li>å…¬é’¥ä¸º $(p,q,g,y)$ï¼Œç§é’¥ä¸º $(x)$ã€‚</li></ol></li><li><p><strong>ç­¾å</strong></p><ol><li><p>é€‰æ‹©éšæœºæ•´æ•°æ•° $k \in (0,q)$ ä½œä¸ºä¸´æ—¶å¯†é’¥ï¼›</p></li><li><p>è®¡ç®— $r \equiv (g^k \bmod p) \pmod q$ï¼›</p></li><li><p>è®¡ç®— $s \equiv (H(m)+xr)k^{-1} \pmod q$ã€‚</p></li></ol><p>ç­¾åç»“æœä¸º $(r,s)$ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä½¿ç”¨äº†å“ˆå¸Œå‡½æ•°å¯¹æ¶ˆæ¯è¿›è¡Œäº†å“ˆå¸Œå¤„ç†ã€‚</p></li><li><p><strong>éªŒè¯</strong></p><ol><li>è®¡ç®—è¾…åŠ©å€¼ $w \equiv s^{-1} \pmod q$ï¼›</li><li>è®¡ç®—è¾…åŠ©å€¼ $u_1 \equiv H(m)\cdot w \pmod q$ï¼›</li><li>è®¡ç®—è¾…åŠ©å€¼ $u_2 \equiv r\cdot w \pmod q$ï¼›</li><li>è®¡ç®— $v \equiv (g^{u_1}y^{u_2} \bmod p) \pmod q$ï¼›</li><li>å¦‚æœ $v$ ä¸ $r$ ç›¸ç­‰ï¼Œåˆ™æ ¡éªŒæˆåŠŸã€‚</li></ol></li><li><p><strong>æ”»å‡»</strong></p><ul><li><p><strong>$k$ å¤ç”¨ï¼ˆå…±äº« $k$ï¼‰</strong></p><p>å¦‚æœåœ¨ä¸¤æ¬¡ç­¾åçš„è¿‡ç¨‹ä¸­å…±äº«äº† $k$ï¼Œå°±å¯ä»¥è¿›è¡Œæ”»å‡»ã€‚</p><p>å‡è®¾ç­¾åçš„æ¶ˆæ¯ä¸º $m_1,m_2$ï¼Œæ˜¾ç„¶ä¸¤è€…çš„ $r$ çš„å€¼ä¸€æ ·ï¼Œæ­¤å¤–</p><p>$s_1 \equiv (H(m_1)+xr)k^{-1} \pmod q$</p><p>$s_2 \equiv (H(m_2)+xr)k^{-1} \pmod q$</p><p>è¿™é‡Œé™¤äº† $x$ å’Œ $k$ ä¸çŸ¥é“å‰©ä¸‹çš„å‡çŸ¥é“ï¼Œè”ç«‹æœ‰ $k(s_1-s_2) \equiv (H(m_1)-H(m_2)) \pmod q$ï¼Œ</p><p>æ­¤æ—¶å³å¯è§£å‡º $k$ï¼Œè¿›ä¸€æ­¥å¯ä»¥è§£å‡º $x$ã€‚</p></li><li><p><strong>$k$ éƒ¨åˆ†æ³„éœ²</strong></p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2020/1506.pdf">Recovering cryptographic keys from partial information, by example</a></p></li></ul><p>â€‹</p></li></ul><h2 id="Elgamalæ•°å­—ç­¾å"><a href="#Elgamalæ•°å­—ç­¾å" class="headerlink" title="Elgamalæ•°å­—ç­¾å"></a>Elgamalæ•°å­—ç­¾å</h2><ul><li><p><strong>å¯†é’¥ç”Ÿæˆ</strong></p><ol><li>é€‰å–ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç´ æ•° $p$ï¼ˆåè¿›åˆ¶ä½æ•°ä¸ä½äº160ï¼‰ï¼Œä¾¿äºåœ¨ $\mathbb{Z}_p$ ä¸Šæ±‚è§£DLPæ˜¯å›°éš¾çš„ï¼›</li><li>é€‰å–ç”Ÿæˆå…ƒ $g \in (0,p)$ï¼›</li><li>éšæœºé€‰å–æ•´æ•° $d \in [0,p-2]$ï¼Œå¹¶è®¡ç®— $g^d \equiv y \pmod p$ï¼›</li><li>å…¬é’¥ä¸º $(p,g,y)$ï¼Œç§é’¥ä¸º $(d)$ã€‚</li></ol></li><li><p><strong>ç­¾å</strong></p><p>Aé€‰å–éšæœºæ•° $k \in (0,p-1)$ï¼Œä¸” $\gcd(k,p-1)=1$ï¼Œå¯¹æ¶ˆæ¯è¿›è¡Œç­¾åï¼š</p><p>$\mathrm{sig}(m,k)=(r,s)$</p><p>å…¶ä¸­ï¼š</p><p>$r \equiv g^k \pmod p$</p><p>$s \equiv (m-dr)k^{-1} \pmod {p-1}$ã€‚</p></li><li><p><strong>éªŒè¯</strong></p><p>å¦‚æœ $g^m \equiv y^rr^s \pmod p$ï¼Œé‚£ä¹ˆéªŒè¯æˆåŠŸï¼Œå¦åˆ™éªŒè¯å¤±è´¥ã€‚</p></li><li><p><strong>æ”»å‡»</strong></p><ul><li><p><strong>$k$ å¤ç”¨ï¼ˆå…±äº« $k$ï¼‰</strong></p><p>å¦‚æœç­¾åè€…å¤ç”¨äº†éšæœºæ•° $k$ ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥è½»è€Œæ˜“ä¸¾åœ°è®¡ç®—å‡ºç§é’¥ã€‚</p><p>å‡è®¾ç›®å‰æœ‰ä¸¤ä¸ªç­¾åéƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªéšæœºæ•°è¿›è¡Œç­¾åçš„ã€‚é‚£ä¹ˆæœ‰ï¼š</p><p>$r \equiv g^k \pmod p$</p><p>$s_1 \equiv (m_1-dr)k^{-1} \pmod {p-1}$</p><p>$s_2 \equiv (m_2-dr)k^{-1} \pmod {p-1}$,</p><p>è¿›è€Œæœ‰ $k(s_1-s_2) \equiv (m_1-m_2) \pmod {p-1}$ï¼Œ</p><p>$s_1,s_2,m_1,m_2,p$ å‡å·²çŸ¥ï¼Œå®¹æ˜“ç®—å‡º $k$ï¼Œè¿›è€Œæ ¹æ® $s$ çš„è®¡ç®—æ–¹æ³•å¾—åˆ°ç§é’¥ $d \equiv (m-ks)r^{-1} \pmod {p-1}$ã€‚</p></li><li><p><strong>æ„é€ éªŒè¯</strong></p><ul><li><p>å•å‚æ•°</p><p>é€‰æ‹© $e \in (1,p-1)$ï¼Œä»¤ $r=g^ey \bmod p$ï¼Œ$s=-r \bmod (p-1)$ï¼Œæœ‰ $m=es \bmod (p-1)$ æ»¡è¶³éªŒè¯ã€‚</p></li><li><p>åŒå‚æ•°</p><p>é€‰æ‹© $e,v \in (1,p-1),\gcd(v,p-1)=1$ï¼Œä»¤ $r=g^ey^v \bmod p$ï¼Œ$s=-rv^{-1} \bmod (p-1)$ï¼Œæœ‰ $m=es \bmod (p-1)$ æ»¡è¶³éªŒè¯ã€‚</p></li></ul></li></ul><p>â€‹</p></li></ul><h2 id="Shamirå¯†é’¥åˆ†äº«ç®—æ³•"><a href="#Shamirå¯†é’¥åˆ†äº«ç®—æ³•" class="headerlink" title="Shamirå¯†é’¥åˆ†äº«ç®—æ³•"></a>Shamirå¯†é’¥åˆ†äº«ç®—æ³•</h2><p>Shamir å¯†é’¥åˆ†äº«ç®—æ³•æœ€æ—©æ˜¯ç”± Shamir å’Œ Blackly åœ¨ 1970 å¹´åŸºäº Lagrange æ’å€¼å’ŒçŸ¢é‡æ–¹æ³•æå‡ºçš„ã€‚</p><p>ç®—æ³•æœ‰ 2 ä¸ªé‡è¦å‚æ•°ï¼š$k$ å’Œ $n$ã€‚$n$ è¡¨ç¤ºå°†æ˜æ–‡åŠ å¯†ä¸º $n$ ä¸ª $\text{Shadow}$ï¼Œ$k$ è¡¨ç¤º è‡³å°‘éœ€è¦ $k$ ä¸ª $\text{Shadow}$ æ‰å¯ä»¥æ¢å¤å‡ºæ˜æ–‡ã€‚</p><ul><li><p><strong>åŠ å¯†</strong></p><p>è‹¥æ˜æ–‡ä¸º $s$ï¼Œ$s \in \mathbb{Z}_p$ï¼Œ$p$ ä¸ºä¸€ä¸ªå¤§ç´ æ•°ã€‚åœ¨ $\text{GF}(p)$ ä»»å– $k-1$ ä¸ªéšæœºæ•°ï¼š $a_1,a_2,\cdots,a_{k-1}$ï¼Œæ„é€ å¦‚ä¸‹å¤šé¡¹å¼ï¼š</p><p>$f(x)=s+a_1x+a_2x^2+\cdots+a_{k-1}x^{k-1} \pmod p$</p><p>ä»»å– $n$ ä¸ªä¸åŒçš„æ•°ï¼š$x_1,x_2,\cdots,x_n$ï¼Œåˆ†åˆ«ä»£å…¥å¤šé¡¹å¼å¾—åˆ° $n$ ä¸ªå¯†é’¥å¯¹ï¼š</p><p>$(x_1,f(x_1)),(x_2,f(x_2)),\cdots,(x_n,f(x_n))$</p><p>å°†è¿™ $n$ ä¸ªå¯†é’¥å¯¹åˆ†å‘ç»™ $n$ ä¸ªæŒæœ‰è€…ã€‚</p></li><li><p><strong>è§£å¯†</strong></p><p>å¾—åˆ°äº† $n$ ä¸ªå¯†é’¥å¯¹ $(x_1,f(x_1)),(x_2,f(x_2)),\cdots,(x_n,f(x_n))$ åï¼Œå¯ä»¥åˆ—å‡ºä»¥ä¸‹åœ¨ $\text{GF}(p)$ ä¸Šçš„æ–¹ç¨‹ç»„ï¼š</p><p>$\left\{\begin{array}{c} s+a_1x_1+a_2x_1^2+\cdots+a_{k-1}x_1^{k-1}=f(x_1) \\ s+a_1x_2+a_2x_2^2+\cdots+a_{k-1}x_2^{k-1}=f(x_2) \\ \vdots \\ s+a_1x_n+a_2x_n^2+\cdots+a_{k-1}x_n^{k-1}=f(x_n) \end{array}\right.$</p><p>ç„¶åå°±å¯ç”¨ Lagrange æ’å€¼ç®—æ³•æ±‚å‡º $s$ äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python-1</span></span><br><span class="line"><span class="keyword">from</span> sslib <span class="keyword">import</span> shamir</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;required_shares&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;prime_mod&#x27;</span>: <span class="string">&#x27;AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEp&#x27;</span>, <span class="string">&#x27;shares&#x27;</span>: [<span class="string">&#x27;1-MEwx7cz+C01rL8H0Hhz2EIgHjWYXVcL81uITmRha674=&#x27;</span>, <span class="string">&#x27;2-YJhj22+ntS1s80CT9b6Y7ayc52baTFGNRpPUyLxtaf8=&#x27;</span>, <span class="string">&#x27;3-4SRZDcshiZTVRJ7nVY8NDq83JOsnZtPm&#x27;</span>, <span class="string">&#x27;4-wTDHtrT7CO1wej3TpQHep/XHm2hgOW6uJfdXKASSZoE=&#x27;</span>, <span class="string">&#x27;5-8Xz5pFekss1yPbxzfKOBhRpc9WkjL/0+lakYV6ik5MI=&#x27;</span>]&#125;</span><br><span class="line"><span class="built_in">print</span>(shamir.recover_secret(shamir.from_base64(data)).decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python-2</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">product</span>(<span class="params">vals, p</span>):</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x * y % p, vals)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lagrange_interpolate</span>(<span class="params">x, x_s, y_s, p</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(x_s)</span><br><span class="line">    <span class="keyword">assert</span> n == <span class="built_in">len</span>(<span class="built_in">set</span>(x_s))  <span class="comment"># x_s must be distinct</span></span><br><span class="line">    num = []</span><br><span class="line">    den = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        others = x_s[:i] + x_s[i+<span class="number">1</span>:]</span><br><span class="line">        num.append(product((x - o <span class="keyword">for</span> o <span class="keyword">in</span> others), p))</span><br><span class="line">        den.append(product((x_s[i] - o <span class="keyword">for</span> o <span class="keyword">in</span> others), p))</span><br><span class="line">    dens = product(den, p)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        tmp1 = ((num[i] * dens % p) * y_s[i]) % p</span><br><span class="line">        tmp2 = tmp1 * gmpy2.invert(den[i], p) % p</span><br><span class="line">        res = (res + tmp2) % p </span><br><span class="line">    res = res * gmpy2.invert(dens, p) % p</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shamir_sharing_encode</span>(<span class="params">s, k, n, p</span>):</span><br><span class="line">    a = [getRandomInteger(Nbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k-<span class="number">1</span>)]</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        x = getRandomInteger(Nbits)</span><br><span class="line">        fx = s</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k-<span class="number">1</span>):</span><br><span class="line">            fx = (fx + a[i] * <span class="built_in">pow</span>(x, i+<span class="number">1</span>, p)) % p</span><br><span class="line">        res.append((x, fx))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shamir_sharing_decode</span>(<span class="params">shares, p</span>):</span><br><span class="line">    x_s, y_s = <span class="built_in">zip</span>(*shares)</span><br><span class="line">    <span class="keyword">return</span> lagrange_interpolate(<span class="number">0</span>, x_s, y_s, p)</span><br><span class="line"></span><br><span class="line">Nbits = <span class="number">1024</span></span><br><span class="line">secret = bytes_to_long(<span class="string">&#x27;it_is_the_top_secret&#x27;</span>)</span><br><span class="line">p = getPrime(Nbits)</span><br><span class="line">k = <span class="number">513</span></span><br><span class="line">n = <span class="number">513</span></span><br><span class="line"></span><br><span class="line">shares = shamir_sharing_encode(secret, k, n, p)</span><br><span class="line"></span><br><span class="line">s = shamir_sharing_decode(shares, p)</span><br><span class="line"><span class="built_in">print</span> long_to_bytes(s)</span><br><span class="line"><span class="comment"># 2s</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">P = PolynomialRing(GF(p), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">ret = P(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> x, y <span class="keyword">in</span> shares:</span><br><span class="line">    r = P(<span class="number">1</span>) * y</span><br><span class="line">    <span class="keyword">for</span> xx, yy <span class="keyword">in</span> shares:</span><br><span class="line">        <span class="keyword">if</span> x != xx:</span><br><span class="line">            r = r * P((<span class="number">0</span> - xx) / (x - xx))</span><br><span class="line">    ret = ret + r</span><br><span class="line"><span class="built_in">print</span> ret</span><br><span class="line"><span class="comment"># 19s</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Sageç®—ç³»æ•°</span></span><br><span class="line">P = PolynomialRing(GF(p), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">ret = P(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> x, y <span class="keyword">in</span> shares:</span><br><span class="line">    r = P(<span class="number">1</span>) * y</span><br><span class="line">    <span class="keyword">for</span> xx, yy <span class="keyword">in</span> shares:</span><br><span class="line">        <span class="keyword">if</span> x != xx:</span><br><span class="line">            r = r * P(<span class="string">&#x27;(x - %d) / (%d - %d)&#x27;</span> % (xx, x, xx))</span><br><span class="line">    ret = ret + r</span><br><span class="line"><span class="built_in">print</span> ret[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># 154s</span></span><br></pre></td></tr></table></figure><p>é™¤äº† Lagrange æ’å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨çŸ©é˜µã€‚</p><p>å¯ä»¥å°†ä¸Šé¢çš„æ–¹ç¨‹ç»„åŒ–ä¸ºä»¥ä¸‹åœ¨ $\text{GF}(p)$ ä¸Šçš„çŸ©é˜µä¹˜æ³•ï¼š</p><p>$\left(\begin {array}{c} 1 &amp; x_1 &amp; x_1^2 &amp; \cdots &amp; x_1^{k-1} \\ 1 &amp; x_2 &amp; x_2^2 &amp; \cdots &amp; x_2^{k-1} \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; x_n &amp; x_n^2 &amp; \cdots &amp; x_n^{k-1} \end{array} \right) \times \left(\begin {array}{c} s \\ a_1 \\ \vdots \\ a_{k-1} \end{array} \right) = \left(\begin {array}{c} f(x_1) \\ f(x_2) \\ \vdots \\ f{x_n} \end{array} \right)$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SageçŸ©é˜µä¹˜æ³•</span></span><br><span class="line">k = <span class="number">513</span></span><br><span class="line">n = <span class="number">513</span></span><br><span class="line"></span><br><span class="line">x, y = <span class="built_in">zip</span>(*shares)</span><br><span class="line"></span><br><span class="line">array_1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        array_1.append(<span class="built_in">pow</span>(x[i], j, p))</span><br><span class="line">A = matrix(GF(p), n, k, array_1)</span><br><span class="line"></span><br><span class="line">array_2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    array_2.append(y[i])</span><br><span class="line">B = matrix(GF(p), n, <span class="number">1</span>, array_2)</span><br><span class="line"></span><br><span class="line">a = A.solve_right(B)</span><br><span class="line"><span class="built_in">print</span> a[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="comment"># 266s</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å°†ä¹‹è§†ä¸ºå¤šå…ƒåŒä½™æ–¹ç¨‹ç»„ï¼š</p><p>$\left\{\begin{array}{c} s+a_1x_1+a_2x_1^2+\cdots+a_{k-1}x_1^{k-1} \equiv f(x_1) \pmod p \\ s+a_1x_2+a_2x_2^2+\cdots+a_{k-1}x_2^{k-1} \equiv f(x_2) \pmod p \\ \vdots \\ s+a_1x_n+a_2x_n^2+\cdots+a_{k-1}x_n^{k-1} \equiv f(x_n) \pmod p \end{array}\right.$</p><p>è®°ç³»æ•°çŸ©é˜µçš„è¡Œåˆ—å¼ä¸ºï¼š</p><p>$\Delta = \left \vert \begin {array}{c} 1 &amp; x_1 &amp; x_1^2 &amp; \cdots &amp; x_1^{k-1} \\ 1 &amp; x_2 &amp; x_2^2 &amp; \cdots &amp; x_2^{k-1} \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; x_n &amp; x_n^2 &amp; \cdots &amp; x_n^{k-1} \end{array} \right \vert \neq 0$</p><p>è¦æ±‚çš„æ˜¯ $s$ï¼Œå› æ­¤å°†è¡Œåˆ—å¼ç¬¬ä¸€åˆ—æ¢ä¸ºåŒä½™æ–¹ç¨‹çš„å€¼ï¼š</p><p>$\Delta_0 = \left \vert \begin {array}{c} f(x_1) &amp; x_1 &amp; x_1^2 &amp; \cdots &amp; x_1^{k-1} \\ f(x_2) &amp; x_2 &amp; x_2^2 &amp; \cdots &amp; x_2^{k-1} \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ f(x_n) &amp; x_n &amp; x_n^2 &amp; \cdots &amp; x_n^{k-1} \end{array} \right \vert \neq 0$</p><p>ç”±å…‹æ‹‰é»˜æ³•åˆ™å¾—ï¼š</p><p>$s \equiv \Delta^{-1}\Delta_0 \pmod p$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">fx_num = <span class="number">513</span></span><br><span class="line"></span><br><span class="line">x, y = <span class="built_in">zip</span>(*shares)</span><br><span class="line"></span><br><span class="line">array_1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(fx_num):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(fx_num):</span><br><span class="line">        array_1.append(<span class="built_in">pow</span>(x[i], j, p))</span><br><span class="line">delta = matrix(GF(p), fx_num, fx_num, array_1).determinant()</span><br><span class="line"></span><br><span class="line">array_2 = [_ <span class="keyword">for</span> _ <span class="keyword">in</span> array_1]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(fx_num):</span><br><span class="line">    array_2[i*fx_num] = y[i]</span><br><span class="line">delta_0 = matrix(GF(p), fx_num, fx_num, array_2).determinant() % p</span><br><span class="line"></span><br><span class="line">delta_inverse = inverse_mod(<span class="built_in">int</span>(delta), p)</span><br><span class="line">res = delta_inverse * delta_0 % p</span><br><span class="line"><span class="built_in">print</span> res</span><br><span class="line"><span class="comment"># 1200s</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœç»´æ•°å¾ˆå¤§ï¼Œç›´æ¥è§£è¡Œåˆ—å¼ä¼šå¾ˆæ…¢ã€‚è§‚å¯Ÿå‘ç° $\Delta$ å…¶å®æ˜¯æ—‹è½¬åçš„èŒƒå¾·è’™è¡Œåˆ—å¼ã€‚$\Delta_0$ æ˜¯æ—‹è½¬åçš„èŒƒå¾·è’™è¡Œåˆ—å¼çš„å˜å½¢ï¼Œç¬¬ä¸€è¡Œä¸æ˜¯å…¨ 1ï¼Œè€Œæ˜¯ $f(x)$ã€‚å¯ä»¥æŒ‰ç¬¬ä¸€è¡Œå±•å¼€ï¼Œä½™å­å¼ä¸­å°†æ¯ä¸€åˆ—é™¤ä»¥è¯¥åˆ—å…ƒçš„ä¸€æ¬¡æ–¹ï¼Œå¯åŒ–ä¸ºèŒƒå¾·è’™è¡Œåˆ—å¼ã€‚è®¡ç®—é€Ÿåº¦ä¼šå¿«éå¸¸å¤šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">fx_num = <span class="number">513</span></span><br><span class="line"></span><br><span class="line">x, y = <span class="built_in">zip</span>(*shares)</span><br><span class="line"></span><br><span class="line">delta = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, fx_num):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, i):</span><br><span class="line">        t = x[i] - x[j]</span><br><span class="line">        delta = (delta * t) % p</span><br><span class="line"></span><br><span class="line">delta_0 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(fx_num):</span><br><span class="line">    tmp_x = [_ <span class="keyword">for</span> _ <span class="keyword">in</span> x]</span><br><span class="line">    tmp_x.pop(i)</span><br><span class="line">    yuzishi = -y[i] <span class="keyword">if</span> (i+<span class="number">1</span>+<span class="number">1</span>) % <span class="number">2</span> <span class="keyword">else</span> y[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(fx_num-<span class="number">1</span>):</span><br><span class="line">        yuzishi = (yuzishi * tmp_x[j]) % p</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, fx_num-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, j):</span><br><span class="line">            t = tmp_x[j] - tmp_x[k]</span><br><span class="line">            yuzishi = (yuzishi * t) % p</span><br><span class="line">    delta_0 = (delta_0 + yuzishi) % p</span><br><span class="line"></span><br><span class="line">delta_inverse = gmpy2.invert(delta, p)</span><br><span class="line">res = delta_inverse * delta_0 % p</span><br><span class="line"><span class="built_in">print</span> res</span><br><span class="line"><span class="comment"># 224s</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ”»å‡»</strong></p><p>å¦‚æœåœ¨åŠ å¯† 2 æ®µæ˜æ–‡ $s_1,s_2$ è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ç›¸åŒçš„éšæœºæ•° $a$ ä»¥åŠå¤§ç´ æ•° $p$ï¼Œè¿˜èƒ½å¾—åˆ°åŒä¸€ä¸ª $x$ å¯¹åº”çš„ä¸¤ä¸ª $f(x)$ï¼Œå¦‚æœçŸ¥é“ä¸€ä¸ªæ˜æ–‡ $s_1$ çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç®—å‡ºå¦ä¸€ä¸ªæ˜æ–‡ã€‚</p><p>åœ¨ $\text{GF}(p)$ ä¸Šï¼š$s_1 + a_1x + a_2x^2 + a_3x^3 + â€¦ + a_{k-1}x^{k-1} = f(x)_1$</p><p>è®¾ï¼š$A = a_1x + a_2x^2 + a_3x^3 + â€¦ + a_{k-1}x^{k-1}$</p><p>å³ï¼š</p><p>$s_1 + A = f(x)_1 \\ s_2 + A = f(x)_2$</p><p>å› æ­¤ï¼š $s_2 = f(x)_2 - f(x)_1 + s_1$</p><p>å¦‚æœä¸çŸ¥é“ä¸¤ä¸ªæ˜æ–‡çš„æƒ…å†µä¸‹ï¼Œä½†ä¸¤æ˜æ–‡æœ‰ä¸€å®šçš„çº¿æ€§å…³ç³»ï¼Œä¹Ÿå¯ä»¥ç®—å‡ºä¸¤æ˜æ–‡ã€‚</p><p>è‹¥ $s_2 = as_1 + b$ï¼Œåˆ™æœ‰åŒä½™æ–¹ç¨‹ç»„ï¼š</p><p>$\left\{ \begin{array}{c} s_1 + A - f(x)_1 \equiv 0 \pmod p \\ s_2 + A - f(x)_2 \equiv 0 \pmod p\\ as_1 + b - s_2 \equiv 0 \pmod p \end{array}\right.$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">a = <span class="number">99999999</span></span><br><span class="line">b = <span class="number">123456</span></span><br><span class="line"></span><br><span class="line">PR.&lt;s1,s2,A&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f1 = s1 + A - y1</span><br><span class="line">f2 = s2 + A - y2</span><br><span class="line">f3 = a * s1 + b - s2</span><br><span class="line">Fs = [f1, f2, f3]</span><br><span class="line">I = Ideal(Fs)</span><br><span class="line">B = I.groebner_basis()</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;s1 =&#x27;</span>, ZZ(-B[<span class="number">0</span>](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;s2 =&#x27;</span>, ZZ(-B[<span class="number">1</span>](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br></pre></td></tr></table></figure></li></ul><p>â€‹</p><h2 id="Okamoto-Uchiyamaå¯†ç ç³»ç»Ÿ"><a href="#Okamoto-Uchiyamaå¯†ç ç³»ç»Ÿ" class="headerlink" title="Okamoto-Uchiyamaå¯†ç ç³»ç»Ÿ"></a>Okamoto-Uchiyamaå¯†ç ç³»ç»Ÿ</h2><p>1998å¹´ç”±Tatsuaki Okamotoå’ŒShigenori Uchiyamaæå‡ºçš„å…¬é’¥åŠ å¯†ç®—æ³•ã€‚</p><p><strong>æ¡ä»¶</strong>ï¼š$n=p^2q$</p><ul><li><p>å¯†é’¥ç”Ÿæˆ</p><ol><li>ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•° $p$ å’Œ $q$ï¼›</li><li>è®¡ç®— $n=p^2q$ï¼›</li><li>é€‰æ‹©ä¸€ä¸ªéšæœºæ•´æ•° $g \in \{2, \cdots ,n-1\}$ æ»¡è¶³ $g^{p-1} \not\equiv 1 \pmod {p^2}$ï¼›</li><li>è®¡ç®— $h=g^n \bmod n$ã€‚</li></ol><p>å…¬é’¥ä¸º $(n,g,h)$ï¼Œç§é’¥ä¸º $(p,q)$ã€‚</p></li><li><p>åŠ å¯†</p><p>æ˜æ–‡ $m&lt;p$ å¯ä»¥é€šè¿‡å…¬é’¥ $(n,g,h)$ åŠ å¯†ï¼š</p><ol><li>é€‰æ‹©ä¸€ä¸ªéšæœºæ•´æ•° $r \in \{1,\cdots,n-1\}$ï¼›</li><li>è®¡ç®— $c=g^m h^r \bmod n$ã€‚</li></ol><p>$c$ å³ä¸º $m$ çš„å¯†æ–‡ã€‚</p></li><li><p>è§£å¯†</p><p>å¯†æ–‡ $c$ å¯ä»¥é€šè¿‡ç§é’¥ $(p,q)$ è§£å¯†ï¼š</p><ol><li>è®¡ç®— $a=\cfrac{(c^{p-1} \bmod {p^2})-1}{p}$ï¼›</li><li>è®¡ç®— $b=\cfrac{(g^{p-1} \bmod {p^2})-1}{p}$ï¼›</li><li>ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®— $b$ çš„æ¨¡ $p$ é€†å…ƒ $bâ€™=b^{-1} \bmod p$ï¼›</li><li>è®¡ç®— $m=abâ€™ \bmod p$ã€‚</li></ol><p>$m$ å³ä¸º $c$ çš„æ˜æ–‡ã€‚</p></li></ul><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.josephsurin.me/posts/2020-08-09-poseidonctf-2020-writeups#triplet-bits-encryption">PoseidonCTF 1st Edition 2020 - discrete log</a></p><p>â€‹</p><h2 id="Schmidt-Samoaå¯†ç ç³»ç»Ÿ"><a href="#Schmidt-Samoaå¯†ç ç³»ç»Ÿ" class="headerlink" title="Schmidt-Samoaå¯†ç ç³»ç»Ÿ"></a>Schmidt-Samoaå¯†ç ç³»ç»Ÿ</h2><p>2005å¹´ï¼ŒKatja Schmidt-Samoa åˆ›å»ºäº† Schmidt-Samoa å…¬é’¥å¯†ç ä½“ç³»ã€‚</p><p>ä¸ Rabin ç±»ä¼¼ï¼Œå®ƒçš„å®‰å…¨æ€§åŸºäºå¤§æ•´æ•°åˆ†è§£çš„å›°éš¾æ€§ã€‚ä½† Rabin è§£å¯†æ—¶ä¼šå¾—åˆ°å››ä¸ªè§£ï¼Œè€Œ Schmidt-Samor å¾—åˆ°çš„æ˜¯å”¯ä¸€è§£ã€‚</p><ul><li><p>å¯†é’¥ç”Ÿæˆ</p><p>é€‰å–å¤§æ•´æ•° $p,q$ï¼Œè®¡ç®— $N=p^2q$ ä½œä¸ºå…¬é’¥ã€‚</p><p>è®¡ç®— $d=\text{inv}(N,\varphi(pq))$ ä½œä¸ºç§é’¥ã€‚</p></li><li><p>åŠ å¯†</p><p>å¯¹äºå°äº $pq$ çš„æ˜æ–‡ $m$ï¼Œè®¡ç®— $c=m^N \bmod N$ ä½œä¸ºå¯†æ–‡ã€‚</p></li><li><p>è§£å¯†</p><p>å¯¹äºå¯†æ–‡ $c$ï¼Œè®¡ç®— $c^d \bmod pq$ï¼Œå¾—åˆ°å¯†æ–‡ã€‚</p><p>å¯¹äº $d$ï¼Œå½“ $d=\text{inv}(N,\text{lcm}(p-1,q-1))$ æ—¶ï¼Œå¯ä»¥è¯æ˜ä»ç„¶æœ‰æå¤§æ¦‚ç‡ $2^{N \cdot d} \equiv 2 \pmod {pq}$ã€‚</p><p>å› ä¸º $\text{lcm}(p-1,q-1)$ å·²ç»æ˜¯ $(p-1)(q-1)$ éå¸¸å¤§çš„å› å­ï¼Œç”±æ‹‰æ ¼æœ—æ—¥å®šç†ï¼Œ2ç”Ÿæˆçš„å­ç¾¤çš„é˜¶åº”è¯¥æ˜¯ $(p-1)(q-1)$ çš„å› æ•°ï¼Œæ‰€æœ‰æ¦‚ç‡è¿˜æŒºé«˜çš„ã€‚</p><blockquote><p><strong>è¯æ˜</strong></p><p>é¦–å…ˆï¼Œè®¡ç®— $\varphi(N)$ï¼Œç”±æ¬§æ‹‰å‡½æ•°çš„æ€§è´¨ï¼Œæ˜¾ç„¶æœ‰ $\varphi(N)=\varphi(p^2q)=p(p-1)(q-1)$</p><p>äºæ˜¯ $x^{p(p-1)(q-1)} \equiv 1 \pmod N$</p><p>å°½ç®¡å…¬é’¥ã€ç§é’¥éƒ½ä¸åŒ…å« $pq$ï¼Œä½†å¯ä»¥é€šè¿‡ $(N,d)$ æ¨å‡º $pq$ï¼Œæœ‰ $N \cdot d \equiv 1 \pmod {\big((p-1)(q-1)\big)}$</p><p>éšä¾¿é€‰ä¸€ä¸ªæ•°2ï¼Œæ¥è€ƒå¯Ÿ $2^{N \cdot d}$ åœ¨æ¨¡ $pq$ æ—¶çš„è¡¨ç°ï¼Œæœ‰ $2^{N \cdot d} \equiv 2^{N \cdot d \bmod {\big((p-1)(q-1)\big)}} \equiv 2 \pmod {pq}$</p><p>ä»è€Œ $pq \mid 2^{N \cdot d}-2$ï¼Œäºæ˜¯è®¡ç®— $\gcd(2^{N \cdot d}-2,N)$ï¼Œå³å¾—åˆ° $pq$ã€‚</p><p>å®¹æ˜“å‘ç°ï¼Œè¿™äº›å¹‚å¯ä»¥åœ¨æ¨¡ $N$ æ„ä¹‰ä¸‹è®¡ç®—ï¼Œä»¥èŠ‚çœå¤æ‚åº¦ã€‚ç°åœ¨ $pq$ åˆ°æ‰‹ï¼Œåœ¨æ¨¡ $pq$ æ„ä¹‰ä¸‹è®¡ç®— $c^d$ï¼Œå³</p><p>$c^d \equiv m^{N \cdot d} \equiv m^{N \cdot d \bmod {\big((p-1)(q-1)\big)}} \equiv m \pmod {pq}$</p><p>è‡³æ­¤å®Œæˆè§£å¯†ã€‚</p></blockquote></li></ul><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2005/278.pdf">A New Rabin-type Trapdoor Permutation Equivalent to Factoring and Its Applications</a></p><p>â€‹</p><h2 id="å¤šé¡¹å¼"><a href="#å¤šé¡¹å¼" class="headerlink" title="å¤šé¡¹å¼"></a>å¤šé¡¹å¼</h2><h3 id="æå°å¤šé¡¹å¼"><a href="#æå°å¤šé¡¹å¼" class="headerlink" title="æå°å¤šé¡¹å¼"></a>æå°å¤šé¡¹å¼</h3><p>ä¸€ä¸ªåŸŸä¸Šçš„ä»£æ•°å…ƒ $\alpha$ çš„æå°å¤šé¡¹å¼ï¼ˆæˆ–æœ€å°å¤šé¡¹å¼ï¼‰æ˜¯æ»¡è¶³ $P(\alpha)=0$ çš„æœ€ä½æ¬¡é¦–ä¸€å¤šé¡¹å¼ï¼ˆå¤šé¡¹å¼å†…æœ€é«˜æ¬¡é¡¹ä¹‹ç³»æ•°ä¸º1ï¼‰$P$ã€‚</p><p>è®¾ $k$ ä¸ºä¸€ä¸ªåŸŸï¼Œ$A$ ä¸ºæœ‰é™ç»´ $k$-ä»£æ•°ã€‚å¯¹ä»»ä¸€å…ƒç´  $\alpha \in A$ï¼Œé›†åˆ $\{1,\alpha,\alpha^2,\cdots\}$ å¼ å‡ºæœ‰é™ç»´å‘é‡ç©ºé—´ï¼Œæ‰€ä»¥å­˜åœ¨éå¹³å‡¡çš„çº¿æ€§å…³ç³» ï¼š</p><p>$\sum\limits_{i=0}^n c_i\alpha^i=0 \quad (c_i \in k)$</p><p>å¯ä»¥å‡è®¾ $c_n=1$ï¼Œæ­¤æ—¶å¤šé¡¹å¼ $f(X):= \sum\limits_{i=0}^n c_iX^i$ æ»¡è¶³ $f(\alpha)=0$ã€‚æ ¹æ®å¤šé¡¹å¼ç¯é‡Œçš„é™¤æ³•ï¼Œå¯çŸ¥è¿™ç±»å¤šé¡¹å¼ä¸­åªæœ‰ä¸€ä¸ªæ¬¡æ•°æœ€å°è€…ï¼Œç§°ä¹‹ä¸º $\alpha$ çš„æå°å¤šé¡¹å¼ã€‚</p><p><strong>æ„é€ </strong></p><p>ä»¥3æ¬¡ä¸ºä¾‹ï¼Œå·²çŸ¥ï¼š</p><p>$\alpha^3 + a_2\alpha^2 + a_1\alpha + a_0 = 0$</p><p>è¿™é‡Œ $a_i$ éƒ½æ˜¯æ•´æ•°ï¼Œæ„é€ å¦‚ä¸‹æ ¼ï¼š</p><p>$(1, a_2, a_1, a_0)<br>\begin{pmatrix}<br>\alpha^3C &amp; 1 &amp; 0 &amp; 0 \\<br>\alpha^2C &amp; 0 &amp; 1 &amp; 0 \\<br>\alpha C &amp; 0 &amp; 0 &amp; 1 \\<br>C &amp; 0 &amp; 0 &amp; 0 \\<br>\end{pmatrix}=(\epsilon C, 1,a_2, a_1)$</p><p>ç”±äº $\alpha$ ç²¾åº¦æœ‰é™ï¼Œæ‰€ä»¥ $\epsilon$ æ˜¯ä¸€ä¸ªéå¸¸æ¥è¿‘0çš„æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">alpha = </span><br><span class="line">alpha = QQ(alpha)</span><br><span class="line">M = matrix(QQ, [</span><br><span class="line">    [alpha**<span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">    [alpha**<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">    [alpha**<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [alpha**<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">])</span><br><span class="line">M[:, <span class="number">0</span>] *= getrandbits(<span class="number">32</span>)</span><br><span class="line">L = M.LLL()</span><br><span class="line">v = L[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> v[<span class="number">1</span>] == -<span class="number">1</span>:</span><br><span class="line">    v *= -<span class="number">1</span></span><br><span class="line">a2, a1 = v[<span class="number">2</span>], v[<span class="number">3</span>]</span><br><span class="line">a0 = -(alpha**<span class="number">3</span> + a2 * alpha**<span class="number">2</span> + a1 * alpha)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alpha = </span><br><span class="line">f = algdep(alpha, <span class="number">3</span>)</span><br><span class="line">a0 = f(<span class="number">0</span>)</span><br></pre></td></tr></table></figure></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2020/05/15/web-SSTI/" title="SSTI"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;ä¸Šä¸€ç¯‡</span></a></li><li class="next"><a href="/2020/05/13/pwn-pwn%E5%B7%A5%E5%85%B7/" title="pwnå·¥å…·"><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button"><span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>èµ</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œèµä¸€æ¯å’–å•¡â˜•~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€æ”¯ä»˜å®æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> å¾®ä¿¡æ”¯ä»˜</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> æ”¯ä»˜å®</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>æ€»è®¿é—® - <span id="busuanzi_value_site_pv"></span>æ¬¡</span><br><span>è®¿å®¢æ•° - <span id="busuanzi_value_site_uv"></span>äºº</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"æ–‡ç« ",PAGES:"é¡µé¢",CATEGORIES:"ç±»åˆ«",TAGS:"å…³é”®è¯",UNTITLED:"(æœªå‘½å)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"æ¥æ¥æ¥è¯´ç‚¹å•¥~~\r\nå¯¹ä½ æœ‰ç”¨ï¼Ÿèµä¸€æ³¢ï¼â†˜â†˜",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("å¤åˆ¶").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("å¤åˆ¶æˆåŠŸ"):$(this).text("å¤åˆ¶å¤±è´¥"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("å¤åˆ¶")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>